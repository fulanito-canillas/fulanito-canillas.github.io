{
  "version": 3,
  "sources": [
    "node_modules/browser-pack/_prelude.js",
    "node_modules/Backbone.Mutators/backbone.mutators.js",
    "node_modules/Backbone.Mutators/node_modules/underscore/underscore.js",
    "node_modules/backbone.babysitter/lib/backbone.babysitter.js",
    "node_modules/backbone.native/backbone.native.js",
    "node_modules/backbone/backbone.js",
    "node_modules/color/index.js",
    "node_modules/color/node_modules/color-convert/conversions.js",
    "node_modules/color/node_modules/color-convert/index.js",
    "node_modules/color/node_modules/color-string/color-string.js",
    "node_modules/color/node_modules/color-string/node_modules/color-name/index.json",
    "node_modules/cookies-js/dist/cookies.js",
    "node_modules/hammerjs/hammer.js",
    "node_modules/handlebars/lib/handlebars.runtime.js",
    "node_modules/handlebars/lib/handlebars/base.js",
    "node_modules/handlebars/lib/handlebars/decorators.js",
    "node_modules/handlebars/lib/handlebars/decorators/inline.js",
    "node_modules/handlebars/lib/handlebars/exception.js",
    "node_modules/handlebars/lib/handlebars/helpers.js",
    "node_modules/handlebars/lib/handlebars/helpers/block-helper-missing.js",
    "node_modules/handlebars/lib/handlebars/helpers/each.js",
    "node_modules/handlebars/lib/handlebars/helpers/helper-missing.js",
    "node_modules/handlebars/lib/handlebars/helpers/if.js",
    "node_modules/handlebars/lib/handlebars/helpers/log.js",
    "node_modules/handlebars/lib/handlebars/helpers/lookup.js",
    "node_modules/handlebars/lib/handlebars/helpers/with.js",
    "node_modules/handlebars/lib/handlebars/logger.js",
    "node_modules/handlebars/dist/cjs/handlebars/node_modules/handlebars/lib/handlebars/no-conflict.js",
    "node_modules/handlebars/lib/handlebars/runtime.js",
    "node_modules/handlebars/lib/handlebars/safe-string.js",
    "node_modules/handlebars/lib/handlebars/utils.js",
    "node_modules/handlebars/runtime.js",
    "node_modules/hbsfy/runtime.js",
    "node_modules/process/browser.js",
    "node_modules/setimmediate/setImmediate.js",
    "node_modules/underscore.string/capitalize.js",
    "node_modules/underscore.string/dasherize.js",
    "node_modules/underscore.string/helper/defaultToWhiteSpace.js",
    "node_modules/underscore.string/helper/escapeRegExp.js",
    "node_modules/underscore.string/helper/makeString.js",
    "node_modules/underscore.string/helper/strRepeat.js",
    "node_modules/underscore.string/lpad.js",
    "node_modules/underscore.string/pad.js",
    "node_modules/underscore.string/rpad.js",
    "node_modules/underscore.string/trim.js",
    "node_modules/underscore/underscore.js",
    "node_modules/webfontloader/webfontloader.js",
    "src/js/app/App.js",
    "src/js/app/View/template/svg/CogSymbol.hbs",
    "src/js/app/control/Controller.js",
    "src/js/app/control/Globals.js",
    "src/js/app/debug/DebugToolbar.js",
    "src/js/app/debug/template/DebugToolbar.SVGGrid.hbs",
    "src/js/app/debug/template/DebugToolbar.hbs",
    "src/js/app/model/AppState.js",
    "src/js/app/model/BaseItem.js",
    "src/js/app/model/BaseModel.js",
    "src/js/app/model/SelectableCollection.js",
    "src/js/app/model/collection/ArticleCollection.js",
    "src/js/app/model/collection/BundleCollection.js",
    "src/js/app/model/collection/KeywordCollection.js",
    "src/js/app/model/collection/TypeCollection.js",
    "src/js/app/model/helper/bootstrap.js",
    "src/js/app/model/item/ArticleItem.js",
    "src/js/app/model/item/BundleItem.js",
    "src/js/app/model/item/KeywordItem.js",
    "src/js/app/model/item/MediaItem.js",
    "src/js/app/model/item/SourceItem.js",
    "src/js/app/model/item/TypeItem.js",
    "src/js/app/view/AppView.js",
    "src/js/app/view/ContentView.js",
    "src/js/app/view/NavigationView.js",
    "src/js/app/view/base/CallbackQueue.js",
    "src/js/app/view/base/CanvasView.js",
    "src/js/app/view/base/Interpolator.js",
    "src/js/app/view/base/PrefixedEvents.js",
    "src/js/app/view/base/TouchManager.js",
    "src/js/app/view/base/View.js",
    "src/js/app/view/base/ViewError.js",
    "src/js/app/view/component/ArticleButton.hbs",
    "src/js/app/view/component/ArticleButton.js",
    "src/js/app/view/component/ArticleView.js",
    "src/js/app/view/component/CanvasProgressMeter.js",
    "src/js/app/view/component/Carousel.js",
    "src/js/app/view/component/CollectionStack.hbs",
    "src/js/app/view/component/CollectionStack.js",
    "src/js/app/view/component/FilterableListView.js",
    "src/js/app/view/component/GraphView.js",
    "src/js/app/view/component/GroupingListView.js",
    "src/js/app/view/component/PlayToggleSymbol.js",
    "src/js/app/view/component/SelectableListView.js",
    "src/js/app/view/helper/createColorStyleSheet.js",
    "src/js/app/view/promise/_loadImageAsObjectURL.js",
    "src/js/app/view/promise/_whenImageLoads.js",
    "src/js/app/view/promise/whenDefaultImageLoads.js",
    "src/js/app/view/promise/whenScrollingEnds.js",
    "src/js/app/view/promise/whenSelectionDistanceIs.js",
    "src/js/app/view/promise/whenSelectionIsContiguous.js",
    "src/js/app/view/promise/whenViewIsAttached.js",
    "src/js/app/view/promise/whenViewIsRendered.js",
    "src/js/app/view/render/CarouselRenderer.js",
    "src/js/app/view/render/ClickableRenderer.js",
    "src/js/app/view/render/DefaultSelectableRenderer.hbs",
    "src/js/app/view/render/DefaultSelectableRenderer.js",
    "src/js/app/view/render/DotNavigationRenderer.hbs",
    "src/js/app/view/render/DotNavigationRenderer.js",
    "src/js/app/view/render/ImageRenderer.hbs",
    "src/js/app/view/render/ImageRenderer.js",
    "src/js/app/view/render/LabelRenderer.js",
    "src/js/app/view/render/MediaRenderer.js",
    "src/js/app/view/render/PlayableRenderer.js",
    "src/js/app/view/render/SequenceRenderer.hbs",
    "src/js/app/view/render/SequenceRenderer.js",
    "src/js/app/view/render/VideoRenderer.hbs",
    "src/js/app/view/render/VideoRenderer.js",
    "src/js/app/view/template/Carousel.EmptyRenderer.Bundle.hbs",
    "src/js/app/view/template/CollectionStack.Media.hbs",
    "src/js/app/view/template/ErrorBlock.hbs",
    "src/js/app/view/template/_helpers.js",
    "src/js/app/view/template/svg/FullscreenSymbol.hbs",
    "src/js/utils/Timer.js",
    "src/js/utils/TransformHelper.js",
    "src/js/utils/TransformItem.js",
    "src/js/utils/array/difference.js",
    "src/js/utils/canvas/CanvasHelper.js",
    "src/js/utils/canvas/bitmap/BlurStack.js",
    "src/js/utils/canvas/bitmap/desaturate.js",
    "src/js/utils/canvas/bitmap/getAverageRGB.js",
    "src/js/utils/canvas/bitmap/mul_table.js",
    "src/js/utils/canvas/bitmap/multiply.js",
    "src/js/utils/canvas/bitmap/shg_table.js",
    "src/js/utils/canvas/bitmap/stackBlurRGB.js",
    "src/js/utils/canvas/calcArcHConnector.js",
    "src/js/utils/css/getBoxEdgeStyles.js",
    "src/js/utils/ease/fn/easeInQuad.js",
    "src/js/utils/ease/fn/easeOutQuad.js",
    "src/js/utils/ease/fn/linear.js",
    "src/js/utils/event/mediaEventsEnum.js",
    "src/js/utils/geom/inflateRect.js",
    "src/js/utils/prefixedEvent.js",
    "src/js/utils/prefixedProperty.js",
    "src/js/utils/prefixedStyleName.js",
    "src/js/utils/prefixes.js",
    "src/js/utils/promise/rejectAll.js",
    "src/js/utils/promise/resolveAll.js",
    "src/js/utils/strings/camelToDashed.js",
    "src/js/utils/strings/stripTags.js",
    "src/js/utils/touch/SmoothPanRecognizer.js",
    "src/sass/variables.json"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1sCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxkDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1rBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;8BCnlFsB,mBAAmB;;IAA7B,IAAI;;;;;oCAIO,0BAA0B;;;;mCAC3B,wBAAwB;;;;+BACvB,oBAAoB;;IAA/B,KAAK;;iCACQ,sBAAsB;;IAAnC,OAAO;;oCAEI,0BAA0B;;;;;AAGjD,SAAS,MAAM,GAAG;AAChB,MAAI,EAAE,GAAG,IAAI,IAAI,CAAC,qBAAqB,EAAE,CAAC;;AAE1C,OAAK,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;AACvB,IAAE,CAAC,UAAU,oCAAa,CAAC;AAC3B,IAAE,CAAC,SAAS,mCAAY,CAAC;AACzB,IAAE,CAAC,KAAK,GAAG,KAAK,CAAC;AACjB,IAAE,CAAC,gBAAgB,GAAG,KAAK,CAAC,gBAAgB,CAAC;;AAE7C,IAAE,CAAC,EAAE,GAAG,OAAO,CAAC;AAChB,IAAE,CAAC,QAAQ,GAAG,UAAS,IAAI,EAAE;AAC3B,WAAO,OAAO,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;GACnC,CAAC;;AAEF,SAAO,EAAE,CAAC;CACX;;AAED,IAAI,IAAI,GAAG,MAAM,EAAE,CAAC;AACpB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;AAErB,kCAAW,IAAI,CAAC,CAAC;;AAEjB,IAAI,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC;;qBAER,IAAI;;;;;;;;;;;;;qBCpCyB,SAAS;;yBAC/B,aAAa;;;;uBACE,WAAW;;0BACR,cAAc;;sBACnC,UAAU;;;;AAEtB,IAAM,OAAO,GAAG,QAAQ,CAAC;;AACzB,IAAM,iBAAiB,GAAG,CAAC,CAAC;;;AAE5B,IAAM,gBAAgB,GAAG;AAC9B,GAAC,EAAE,aAAa;AAChB,GAAC,EAAE,eAAe;AAClB,GAAC,EAAE,eAAe;AAClB,GAAC,EAAE,UAAU;AACb,GAAC,EAAE,kBAAkB;AACrB,GAAC,EAAE,iBAAiB;AACpB,GAAC,EAAE,UAAU;CACd,CAAC;;;AAEF,IAAM,UAAU,GAAG,iBAAiB,CAAC;;AAE9B,SAAS,qBAAqB,CAAC,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE;AACnE,MAAI,CAAC,OAAO,GAAG,OAAO,IAAI,EAAE,CAAC;AAC7B,MAAI,CAAC,QAAQ,GAAG,QAAQ,IAAI,EAAE,CAAC;AAC/B,MAAI,CAAC,UAAU,GAAG,UAAU,IAAI,EAAE,CAAC;;AAEnC,kCAAuB,IAAI,CAAC,CAAC;AAC7B,wCAA0B,IAAI,CAAC,CAAC;CACjC;;AAED,qBAAqB,CAAC,SAAS,GAAG;AAChC,aAAW,EAAE,qBAAqB;;AAElC,QAAM,qBAAQ;AACd,KAAG,EAAE,oBAAO,GAAG;;AAEf,gBAAc,EAAE,wBAAS,IAAI,EAAE,EAAE,EAAE;AACjC,QAAI,gBAAS,IAAI,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;AACtC,UAAI,EAAE,EAAE;AAAE,cAAM,2BAAc,yCAAyC,CAAC,CAAC;OAAE;AAC3E,oBAAO,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;KAC5B,MAAM;AACL,UAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;KACzB;GACF;AACD,kBAAgB,EAAE,0BAAS,IAAI,EAAE;AAC/B,WAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;GAC3B;;AAED,iBAAe,EAAE,yBAAS,IAAI,EAAE,OAAO,EAAE;AACvC,QAAI,gBAAS,IAAI,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;AACtC,oBAAO,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;KAC7B,MAAM;AACL,UAAI,OAAO,OAAO,KAAK,WAAW,EAAE;AAClC,cAAM,yEAA0D,IAAI,oBAAiB,CAAC;OACvF;AACD,UAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;KAC/B;GACF;AACD,mBAAiB,EAAE,2BAAS,IAAI,EAAE;AAChC,WAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;GAC5B;;AAED,mBAAiB,EAAE,2BAAS,IAAI,EAAE,EAAE,EAAE;AACpC,QAAI,gBAAS,IAAI,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;AACtC,UAAI,EAAE,EAAE;AAAE,cAAM,2BAAc,4CAA4C,CAAC,CAAC;OAAE;AAC9E,oBAAO,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;KAC/B,MAAM;AACL,UAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;KAC5B;GACF;AACD,qBAAmB,EAAE,6BAAS,IAAI,EAAE;AAClC,WAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;GAC9B;CACF,CAAC;;AAEK,IAAI,GAAG,GAAG,oBAAO,GAAG,CAAC;;;QAEpB,WAAW;QAAE,MAAM;;;;;;;;;;;;gCC7EA,qBAAqB;;;;AAEzC,SAAS,yBAAyB,CAAC,QAAQ,EAAE;AAClD,gCAAe,QAAQ,CAAC,CAAC;CAC1B;;;;;;;;qBCJoB,UAAU;;qBAEhB,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,iBAAiB,CAAC,QAAQ,EAAE,UAAS,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE;AAC3E,QAAI,GAAG,GAAG,EAAE,CAAC;AACb,QAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;AACnB,WAAK,CAAC,QAAQ,GAAG,EAAE,CAAC;AACpB,SAAG,GAAG,UAAS,OAAO,EAAE,OAAO,EAAE;;AAE/B,YAAI,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAC;AAClC,iBAAS,CAAC,QAAQ,GAAG,cAAO,EAAE,EAAE,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;AAC1D,YAAI,GAAG,GAAG,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;AAC/B,iBAAS,CAAC,QAAQ,GAAG,QAAQ,CAAC;AAC9B,eAAO,GAAG,CAAC;OACZ,CAAC;KACH;;AAED,SAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,EAAE,CAAC;;AAE7C,WAAO,GAAG,CAAC;GACZ,CAAC,CAAC;CACJ;;;;;;;;;;ACpBD,IAAM,UAAU,GAAG,CAAC,aAAa,EAAE,UAAU,EAAE,YAAY,EAAE,SAAS,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;;AAEnG,SAAS,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE;AAChC,MAAI,GAAG,GAAG,IAAI,IAAI,IAAI,CAAC,GAAG;MACtB,IAAI,YAAA;MACJ,MAAM,YAAA,CAAC;AACX,MAAI,GAAG,EAAE;AACP,QAAI,GAAG,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC;AACtB,UAAM,GAAG,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC;;AAE1B,WAAO,IAAI,KAAK,GAAG,IAAI,GAAG,GAAG,GAAG,MAAM,CAAC;GACxC;;AAED,MAAI,GAAG,GAAG,KAAK,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;;;AAG1D,OAAK,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,UAAU,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE;AAChD,QAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;GAC9C;;;AAGD,MAAI,KAAK,CAAC,iBAAiB,EAAE;AAC3B,SAAK,CAAC,iBAAiB,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;GAC1C;;AAED,MAAI;AACF,QAAI,GAAG,EAAE;AACP,UAAI,CAAC,UAAU,GAAG,IAAI,CAAC;;;;AAIvB,UAAI,MAAM,CAAC,cAAc,EAAE;AACzB,cAAM,CAAC,cAAc,CAAC,IAAI,EAAE,QAAQ,EAAE;AACpC,eAAK,EAAE,MAAM;AACb,oBAAU,EAAE,IAAI;SACjB,CAAC,CAAC;OACJ,MAAM;AACL,YAAI,CAAC,MAAM,GAAG,MAAM,CAAC;OACtB;KACF;GACF,CAAC,OAAO,GAAG,EAAE;;GAEb;CACF;;AAED,SAAS,CAAC,SAAS,GAAG,IAAI,KAAK,EAAE,CAAC;;qBAEnB,SAAS;;;;;;;;;;;;;yCChDe,gCAAgC;;;;2BAC9C,gBAAgB;;;;oCACP,0BAA0B;;;;yBACrC,cAAc;;;;0BACb,eAAe;;;;6BACZ,kBAAkB;;;;2BACpB,gBAAgB;;;;AAElC,SAAS,sBAAsB,CAAC,QAAQ,EAAE;AAC/C,yCAA2B,QAAQ,CAAC,CAAC;AACrC,2BAAa,QAAQ,CAAC,CAAC;AACvB,oCAAsB,QAAQ,CAAC,CAAC;AAChC,yBAAW,QAAQ,CAAC,CAAC;AACrB,0BAAY,QAAQ,CAAC,CAAC;AACtB,6BAAe,QAAQ,CAAC,CAAC;AACzB,2BAAa,QAAQ,CAAC,CAAC;CACxB;;;;;;;;qBChBqD,UAAU;;qBAEjD,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,oBAAoB,EAAE,UAAS,OAAO,EAAE,OAAO,EAAE;AACvE,QAAI,OAAO,GAAG,OAAO,CAAC,OAAO;QACzB,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;;AAEpB,QAAI,OAAO,KAAK,IAAI,EAAE;AACpB,aAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB,MAAM,IAAI,OAAO,KAAK,KAAK,IAAI,OAAO,IAAI,IAAI,EAAE;AAC/C,aAAO,OAAO,CAAC,IAAI,CAAC,CAAC;KACtB,MAAM,IAAI,eAAQ,OAAO,CAAC,EAAE;AAC3B,UAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;AACtB,YAAI,OAAO,CAAC,GAAG,EAAE;AACf,iBAAO,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;SAC9B;;AAED,eAAO,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;OAChD,MAAM;AACL,eAAO,OAAO,CAAC,IAAI,CAAC,CAAC;OACtB;KACF,MAAM;AACL,UAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,GAAG,EAAE;AAC/B,YAAI,IAAI,GAAG,mBAAY,OAAO,CAAC,IAAI,CAAC,CAAC;AACrC,YAAI,CAAC,WAAW,GAAG,yBAAkB,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC;AAC7E,eAAO,GAAG,EAAC,IAAI,EAAE,IAAI,EAAC,CAAC;OACxB;;AAED,aAAO,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;KAC7B;GACF,CAAC,CAAC;CACJ;;;;;;;;;;;;;qBC/B8E,UAAU;;yBACnE,cAAc;;;;qBAErB,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,MAAM,EAAE,UAAS,OAAO,EAAE,OAAO,EAAE;AACzD,QAAI,CAAC,OAAO,EAAE;AACZ,YAAM,2BAAc,6BAA6B,CAAC,CAAC;KACpD;;AAED,QAAI,EAAE,GAAG,OAAO,CAAC,EAAE;QACf,OAAO,GAAG,OAAO,CAAC,OAAO;QACzB,CAAC,GAAG,CAAC;QACL,GAAG,GAAG,EAAE;QACR,IAAI,YAAA;QACJ,WAAW,YAAA,CAAC;;AAEhB,QAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,GAAG,EAAE;AAC/B,iBAAW,GAAG,yBAAkB,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;KACjF;;AAED,QAAI,kBAAW,OAAO,CAAC,EAAE;AAAE,aAAO,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAAE;;AAE1D,QAAI,OAAO,CAAC,IAAI,EAAE;AAChB,UAAI,GAAG,mBAAY,OAAO,CAAC,IAAI,CAAC,CAAC;KAClC;;AAED,aAAS,aAAa,CAAC,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE;AACzC,UAAI,IAAI,EAAE;AACR,YAAI,CAAC,GAAG,GAAG,KAAK,CAAC;AACjB,YAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACnB,YAAI,CAAC,KAAK,GAAG,KAAK,KAAK,CAAC,CAAC;AACzB,YAAI,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC;;AAEnB,YAAI,WAAW,EAAE;AACf,cAAI,CAAC,WAAW,GAAG,WAAW,GAAG,KAAK,CAAC;SACxC;OACF;;AAED,SAAG,GAAG,GAAG,GAAG,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;AAC7B,YAAI,EAAE,IAAI;AACV,mBAAW,EAAE,mBAAY,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,CAAC,WAAW,GAAG,KAAK,EAAE,IAAI,CAAC,CAAC;OAC/E,CAAC,CAAC;KACJ;;AAED,QAAI,OAAO,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;AAC1C,UAAI,eAAQ,OAAO,CAAC,EAAE;AACpB,aAAK,IAAI,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACvC,cAAI,CAAC,IAAI,OAAO,EAAE;AAChB,yBAAa,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;WAC/C;SACF;OACF,MAAM;AACL,YAAI,QAAQ,YAAA,CAAC;;AAEb,aAAK,IAAI,GAAG,IAAI,OAAO,EAAE;AACvB,cAAI,OAAO,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;;;;AAI/B,gBAAI,QAAQ,KAAK,SAAS,EAAE;AAC1B,2BAAa,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;aAChC;AACD,oBAAQ,GAAG,GAAG,CAAC;AACf,aAAC,EAAE,CAAC;WACL;SACF;AACD,YAAI,QAAQ,KAAK,SAAS,EAAE;AAC1B,uBAAa,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;SACtC;OACF;KACF;;AAED,QAAI,CAAC,KAAK,CAAC,EAAE;AACX,SAAG,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;KACrB;;AAED,WAAO,GAAG,CAAC;GACZ,CAAC,CAAC;CACJ;;;;;;;;;;;;;yBC9EqB,cAAc;;;;qBAErB,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,eAAe,EAAE,iCAAgC;AACvE,QAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;;AAE1B,aAAO,SAAS,CAAC;KAClB,MAAM;;AAEL,YAAM,2BAAc,mBAAmB,GAAG,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,IAAI,GAAG,GAAG,CAAC,CAAC;KACvF;GACF,CAAC,CAAC;CACJ;;;;;;;;;;qBCZiC,UAAU;;qBAE7B,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,IAAI,EAAE,UAAS,WAAW,EAAE,OAAO,EAAE;AAC3D,QAAI,kBAAW,WAAW,CAAC,EAAE;AAAE,iBAAW,GAAG,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAAE;;;;;AAKtE,QAAI,AAAC,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,WAAW,IAAK,eAAQ,WAAW,CAAC,EAAE;AACvE,aAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KAC9B,MAAM;AACL,aAAO,OAAO,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;KACzB;GACF,CAAC,CAAC;;AAEH,UAAQ,CAAC,cAAc,CAAC,QAAQ,EAAE,UAAS,WAAW,EAAE,OAAO,EAAE;AAC/D,WAAO,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,WAAW,EAAE,EAAC,EAAE,EAAE,OAAO,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,EAAE,EAAE,IAAI,EAAE,OAAO,CAAC,IAAI,EAAC,CAAC,CAAC;GACvH,CAAC,CAAC;CACJ;;;;;;;;;;qBCnBc,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,KAAK,EAAE,kCAAiC;AAC9D,QAAI,IAAI,GAAG,CAAC,SAAS,CAAC;QAClB,OAAO,GAAG,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;AAC9C,SAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AAC7C,UAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;KACzB;;AAED,QAAI,KAAK,GAAG,CAAC,CAAC;AACd,QAAI,OAAO,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,EAAE;AAC9B,WAAK,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC;KAC5B,MAAM,IAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,EAAE;AACrD,WAAK,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC;KAC5B;AACD,QAAI,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;;AAEhB,YAAQ,CAAC,GAAG,MAAA,CAAZ,QAAQ,EAAS,IAAI,CAAC,CAAC;GACxB,CAAC,CAAC;CACJ;;;;;;;;;;qBClBc,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,QAAQ,EAAE,UAAS,GAAG,EAAE,KAAK,EAAE;AACrD,WAAO,GAAG,IAAI,GAAG,CAAC,KAAK,CAAC,CAAC;GAC1B,CAAC,CAAC;CACJ;;;;;;;;;;qBCJ8E,UAAU;;qBAE1E,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,MAAM,EAAE,UAAS,OAAO,EAAE,OAAO,EAAE;AACzD,QAAI,kBAAW,OAAO,CAAC,EAAE;AAAE,aAAO,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAAE;;AAE1D,QAAI,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;;AAEpB,QAAI,CAAC,eAAQ,OAAO,CAAC,EAAE;AACrB,UAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;AACxB,UAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,GAAG,EAAE;AAC/B,YAAI,GAAG,mBAAY,OAAO,CAAC,IAAI,CAAC,CAAC;AACjC,YAAI,CAAC,WAAW,GAAG,yBAAkB,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;OAChF;;AAED,aAAO,EAAE,CAAC,OAAO,EAAE;AACjB,YAAI,EAAE,IAAI;AACV,mBAAW,EAAE,mBAAY,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC;OAChE,CAAC,CAAC;KACJ,MAAM;AACL,aAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KAC9B;GACF,CAAC,CAAC;CACJ;;;;;;;;;;qBCvBqB,SAAS;;AAE/B,IAAI,MAAM,GAAG;AACX,WAAS,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC;AAC7C,OAAK,EAAE,MAAM;;;AAGb,aAAW,EAAE,qBAAS,KAAK,EAAE;AAC3B,QAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;AAC7B,UAAI,QAAQ,GAAG,eAAQ,MAAM,CAAC,SAAS,EAAE,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;AAC9D,UAAI,QAAQ,IAAI,CAAC,EAAE;AACjB,aAAK,GAAG,QAAQ,CAAC;OAClB,MAAM;AACL,aAAK,GAAG,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;OAC7B;KACF;;AAED,WAAO,KAAK,CAAC;GACd;;;AAGD,KAAG,EAAE,aAAS,KAAK,EAAc;AAC/B,SAAK,GAAG,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;;AAElC,QAAI,OAAO,OAAO,KAAK,WAAW,IAAI,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,KAAK,EAAE;AAC/E,UAAI,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;AACrC,UAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;;AACpB,cAAM,GAAG,KAAK,CAAC;OAChB;;wCAPmB,OAAO;AAAP,eAAO;;;AAQ3B,aAAO,CAAC,MAAM,OAAC,CAAf,OAAO,EAAY,OAAO,CAAC,CAAC;KAC7B;GACF;CACF,CAAC;;qBAEa,MAAM;;;;;;;;;;;qBCjCN,UAAS,UAAU,EAAE;;AAElC,MAAI,IAAI,GAAG,OAAO,MAAM,KAAK,WAAW,GAAG,MAAM,GAAG,MAAM;MACtD,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC;;AAElC,YAAU,CAAC,UAAU,GAAG,YAAW;AACjC,QAAI,IAAI,CAAC,UAAU,KAAK,UAAU,EAAE;AAClC,UAAI,CAAC,UAAU,GAAG,WAAW,CAAC;KAC/B;AACD,WAAO,UAAU,CAAC;GACnB,CAAC;CACH;;;;;;;;;;;;;;;;;;;;;;;;;qBCZsB,SAAS;;IAApB,KAAK;;yBACK,aAAa;;;;oBAC8B,QAAQ;;AAElE,SAAS,aAAa,CAAC,YAAY,EAAE;AAC1C,MAAM,gBAAgB,GAAG,YAAY,IAAI,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC;MACvD,eAAe,0BAAoB,CAAC;;AAE1C,MAAI,gBAAgB,KAAK,eAAe,EAAE;AACxC,QAAI,gBAAgB,GAAG,eAAe,EAAE;AACtC,UAAM,eAAe,GAAG,uBAAiB,eAAe,CAAC;UACnD,gBAAgB,GAAG,uBAAiB,gBAAgB,CAAC,CAAC;AAC5D,YAAM,2BAAc,yFAAyF,GACvG,qDAAqD,GAAG,eAAe,GAAG,mDAAmD,GAAG,gBAAgB,GAAG,IAAI,CAAC,CAAC;KAChK,MAAM;;AAEL,YAAM,2BAAc,wFAAwF,GACtG,iDAAiD,GAAG,YAAY,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC;KACnF;GACF;CACF;;AAEM,SAAS,QAAQ,CAAC,YAAY,EAAE,GAAG,EAAE;;AAE1C,MAAI,CAAC,GAAG,EAAE;AACR,UAAM,2BAAc,mCAAmC,CAAC,CAAC;GAC1D;AACD,MAAI,CAAC,YAAY,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE;AACvC,UAAM,2BAAc,2BAA2B,GAAG,OAAO,YAAY,CAAC,CAAC;GACxE;;AAED,cAAY,CAAC,IAAI,CAAC,SAAS,GAAG,YAAY,CAAC,MAAM,CAAC;;;;AAIlD,KAAG,CAAC,EAAE,CAAC,aAAa,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;;AAE5C,WAAS,oBAAoB,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;AACvD,QAAI,OAAO,CAAC,IAAI,EAAE;AAChB,aAAO,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC;AAClD,UAAI,OAAO,CAAC,GAAG,EAAE;AACf,eAAO,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;OACvB;KACF;;AAED,WAAO,GAAG,GAAG,CAAC,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;AACtE,QAAI,MAAM,GAAG,GAAG,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;;AAExE,QAAI,MAAM,IAAI,IAAI,IAAI,GAAG,CAAC,OAAO,EAAE;AACjC,aAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,OAAO,EAAE,YAAY,CAAC,eAAe,EAAE,GAAG,CAAC,CAAC;AACzF,YAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;KAC3D;AACD,QAAI,MAAM,IAAI,IAAI,EAAE;AAClB,UAAI,OAAO,CAAC,MAAM,EAAE;AAClB,YAAI,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AAC/B,aAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AAC5C,cAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;AAC5B,kBAAM;WACP;;AAED,eAAK,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;SACtC;AACD,cAAM,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;OAC3B;AACD,aAAO,MAAM,CAAC;KACf,MAAM;AACL,YAAM,2BAAc,cAAc,GAAG,OAAO,CAAC,IAAI,GAAG,0DAA0D,CAAC,CAAC;KACjH;GACF;;;AAGD,MAAI,SAAS,GAAG;AACd,UAAM,EAAE,gBAAS,GAAG,EAAE,IAAI,EAAE;AAC1B,UAAI,EAAE,IAAI,IAAI,GAAG,CAAA,AAAC,EAAE;AAClB,cAAM,2BAAc,GAAG,GAAG,IAAI,GAAG,mBAAmB,GAAG,GAAG,CAAC,CAAC;OAC7D;AACD,aAAO,GAAG,CAAC,IAAI,CAAC,CAAC;KAClB;AACD,UAAM,EAAE,gBAAS,MAAM,EAAE,IAAI,EAAE;AAC7B,UAAM,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC;AAC1B,WAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;AAC5B,YAAI,MAAM,CAAC,CAAC,CAAC,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE;AACxC,iBAAO,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;SACxB;OACF;KACF;AACD,UAAM,EAAE,gBAAS,OAAO,EAAE,OAAO,EAAE;AACjC,aAAO,OAAO,OAAO,KAAK,UAAU,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC;KACxE;;AAED,oBAAgB,EAAE,KAAK,CAAC,gBAAgB;AACxC,iBAAa,EAAE,oBAAoB;;AAEnC,MAAE,EAAE,YAAS,CAAC,EAAE;AACd,UAAI,GAAG,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC;AAC1B,SAAG,CAAC,SAAS,GAAG,YAAY,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC;AACvC,aAAO,GAAG,CAAC;KACZ;;AAED,YAAQ,EAAE,EAAE;AACZ,WAAO,EAAE,iBAAS,CAAC,EAAE,IAAI,EAAE,mBAAmB,EAAE,WAAW,EAAE,MAAM,EAAE;AACnE,UAAI,cAAc,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;UACjC,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACpB,UAAI,IAAI,IAAI,MAAM,IAAI,WAAW,IAAI,mBAAmB,EAAE;AACxD,sBAAc,GAAG,WAAW,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,mBAAmB,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;OAC3F,MAAM,IAAI,CAAC,cAAc,EAAE;AAC1B,sBAAc,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,WAAW,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;OAC9D;AACD,aAAO,cAAc,CAAC;KACvB;;AAED,QAAI,EAAE,cAAS,KAAK,EAAE,KAAK,EAAE;AAC3B,aAAO,KAAK,IAAI,KAAK,EAAE,EAAE;AACvB,aAAK,GAAG,KAAK,CAAC,OAAO,CAAC;OACvB;AACD,aAAO,KAAK,CAAC;KACd;AACD,SAAK,EAAE,eAAS,KAAK,EAAE,MAAM,EAAE;AAC7B,UAAI,GAAG,GAAG,KAAK,IAAI,MAAM,CAAC;;AAE1B,UAAI,KAAK,IAAI,MAAM,IAAK,KAAK,KAAK,MAAM,AAAC,EAAE;AACzC,WAAG,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;OACvC;;AAED,aAAO,GAAG,CAAC;KACZ;;AAED,eAAW,EAAE,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC;;AAE5B,QAAI,EAAE,GAAG,CAAC,EAAE,CAAC,IAAI;AACjB,gBAAY,EAAE,YAAY,CAAC,QAAQ;GACpC,CAAC;;AAEF,WAAS,GAAG,CAAC,OAAO,EAAgB;QAAd,OAAO,yDAAG,EAAE;;AAChC,QAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;;AAExB,OAAG,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AACpB,QAAI,CAAC,OAAO,CAAC,OAAO,IAAI,YAAY,CAAC,OAAO,EAAE;AAC5C,UAAI,GAAG,QAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;KAChC;AACD,QAAI,MAAM,YAAA;QACN,WAAW,GAAG,YAAY,CAAC,cAAc,GAAG,EAAE,GAAG,SAAS,CAAC;AAC/D,QAAI,YAAY,CAAC,SAAS,EAAE;AAC1B,UAAI,OAAO,CAAC,MAAM,EAAE;AAClB,cAAM,GAAG,OAAO,IAAI,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC,MAAM,CAAC;OAC3F,MAAM;AACL,cAAM,GAAG,CAAC,OAAO,CAAC,CAAC;OACpB;KACF;;AAED,aAAS,IAAI,CAAC,OAAO,gBAAe;AAClC,aAAO,EAAE,GAAG,YAAY,CAAC,IAAI,CAAC,SAAS,EAAE,OAAO,EAAE,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,QAAQ,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;KACrH;AACD,QAAI,GAAG,iBAAiB,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,CAAC,MAAM,IAAI,EAAE,EAAE,IAAI,EAAE,WAAW,CAAC,CAAC;AACtG,WAAO,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;GAC/B;AACD,KAAG,CAAC,KAAK,GAAG,IAAI,CAAC;;AAEjB,KAAG,CAAC,MAAM,GAAG,UAAS,OAAO,EAAE;AAC7B,QAAI,CAAC,OAAO,CAAC,OAAO,EAAE;AACpB,eAAS,CAAC,OAAO,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;;AAElE,UAAI,YAAY,CAAC,UAAU,EAAE;AAC3B,iBAAS,CAAC,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC;OACtE;AACD,UAAI,YAAY,CAAC,UAAU,IAAI,YAAY,CAAC,aAAa,EAAE;AACzD,iBAAS,CAAC,UAAU,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,UAAU,CAAC,CAAC;OAC5E;KACF,MAAM;AACL,eAAS,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;AACpC,eAAS,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;AACtC,eAAS,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC;KAC3C;GACF,CAAC;;AAEF,KAAG,CAAC,MAAM,GAAG,UAAS,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM,EAAE;AAClD,QAAI,YAAY,CAAC,cAAc,IAAI,CAAC,WAAW,EAAE;AAC/C,YAAM,2BAAc,wBAAwB,CAAC,CAAC;KAC/C;AACD,QAAI,YAAY,CAAC,SAAS,IAAI,CAAC,MAAM,EAAE;AACrC,YAAM,2BAAc,yBAAyB,CAAC,CAAC;KAChD;;AAED,WAAO,WAAW,CAAC,SAAS,EAAE,CAAC,EAAE,YAAY,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;GACjF,CAAC;AACF,SAAO,GAAG,CAAC;CACZ;;AAEM,SAAS,WAAW,CAAC,SAAS,EAAE,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,mBAAmB,EAAE,WAAW,EAAE,MAAM,EAAE;AAC5F,WAAS,IAAI,CAAC,OAAO,EAAgB;QAAd,OAAO,yDAAG,EAAE;;AACjC,QAAI,aAAa,GAAG,MAAM,CAAC;AAC3B,QAAI,MAAM,IAAI,OAAO,IAAI,MAAM,CAAC,CAAC,CAAC,IAAI,EAAE,OAAO,KAAK,SAAS,CAAC,WAAW,IAAI,MAAM,CAAC,CAAC,CAAC,KAAK,IAAI,CAAA,AAAC,EAAE;AAChG,mBAAa,GAAG,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;KAC1C;;AAED,WAAO,EAAE,CAAC,SAAS,EACf,OAAO,EACP,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,QAAQ,EACrC,OAAO,CAAC,IAAI,IAAI,IAAI,EACpB,WAAW,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC,EACxD,aAAa,CAAC,CAAC;GACpB;;AAED,MAAI,GAAG,iBAAiB,CAAC,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,MAAM,EAAE,IAAI,EAAE,WAAW,CAAC,CAAC;;AAEzE,MAAI,CAAC,OAAO,GAAG,CAAC,CAAC;AACjB,MAAI,CAAC,KAAK,GAAG,MAAM,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;AACxC,MAAI,CAAC,WAAW,GAAG,mBAAmB,IAAI,CAAC,CAAC;AAC5C,SAAO,IAAI,CAAC;CACb;;AAEM,SAAS,cAAc,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;AACxD,MAAI,CAAC,OAAO,EAAE;AACZ,QAAI,OAAO,CAAC,IAAI,KAAK,gBAAgB,EAAE;AACrC,aAAO,GAAG,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;KACzC,MAAM;AACL,aAAO,GAAG,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KAC1C;GACF,MAAM,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE;;AAEzC,WAAO,CAAC,IAAI,GAAG,OAAO,CAAC;AACvB,WAAO,GAAG,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;GACrC;AACD,SAAO,OAAO,CAAC;CAChB;;AAEM,SAAS,aAAa,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;;AAEvD,MAAM,mBAAmB,GAAG,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;AAC1E,SAAO,CAAC,OAAO,GAAG,IAAI,CAAC;AACvB,MAAI,OAAO,CAAC,GAAG,EAAE;AACf,WAAO,CAAC,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC;GACvE;;AAED,MAAI,YAAY,YAAA,CAAC;AACjB,MAAI,OAAO,CAAC,EAAE,IAAI,OAAO,CAAC,EAAE,KAAK,IAAI,EAAE;;AACrC,aAAO,CAAC,IAAI,GAAG,kBAAY,OAAO,CAAC,IAAI,CAAC,CAAC;;AAEzC,UAAI,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;AACpB,kBAAY,GAAG,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,SAAS,mBAAmB,CAAC,OAAO,EAAgB;YAAd,OAAO,yDAAG,EAAE;;;;AAI/F,eAAO,CAAC,IAAI,GAAG,kBAAY,OAAO,CAAC,IAAI,CAAC,CAAC;AACzC,eAAO,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,mBAAmB,CAAC;AACpD,eAAO,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;OAC7B,CAAC;AACF,UAAI,EAAE,CAAC,QAAQ,EAAE;AACf,eAAO,CAAC,QAAQ,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,CAAC,QAAQ,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC;OACpE;;GACF;;AAED,MAAI,OAAO,KAAK,SAAS,IAAI,YAAY,EAAE;AACzC,WAAO,GAAG,YAAY,CAAC;GACxB;;AAED,MAAI,OAAO,KAAK,SAAS,EAAE;AACzB,UAAM,2BAAc,cAAc,GAAG,OAAO,CAAC,IAAI,GAAG,qBAAqB,CAAC,CAAC;GAC5E,MAAM,IAAI,OAAO,YAAY,QAAQ,EAAE;AACtC,WAAO,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;GAClC;CACF;;AAEM,SAAS,IAAI,GAAG;AAAE,SAAO,EAAE,CAAC;CAAE;;AAErC,SAAS,QAAQ,CAAC,OAAO,EAAE,IAAI,EAAE;AAC/B,MAAI,CAAC,IAAI,IAAI,EAAE,MAAM,IAAI,IAAI,CAAA,AAAC,EAAE;AAC9B,QAAI,GAAG,IAAI,GAAG,kBAAY,IAAI,CAAC,GAAG,EAAE,CAAC;AACrC,QAAI,CAAC,IAAI,GAAG,OAAO,CAAC;GACrB;AACD,SAAO,IAAI,CAAC;CACb;;AAED,SAAS,iBAAiB,CAAC,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE;AACzE,MAAI,EAAE,CAAC,SAAS,EAAE;AAChB,QAAI,KAAK,GAAG,EAAE,CAAC;AACf,QAAI,GAAG,EAAE,CAAC,SAAS,CAAC,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,MAAM,IAAI,MAAM,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;AAC5F,SAAK,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;GAC3B;AACD,SAAO,IAAI,CAAC;CACb;;;;;;;;ACvRD,SAAS,UAAU,CAAC,MAAM,EAAE;AAC1B,MAAI,CAAC,MAAM,GAAG,MAAM,CAAC;CACtB;;AAED,UAAU,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,CAAC,SAAS,CAAC,MAAM,GAAG,YAAW;AACvE,SAAO,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC;CACzB,CAAC;;qBAEa,UAAU;;;;;;;;;;;;;;;ACTzB,IAAM,MAAM,GAAG;AACb,KAAG,EAAE,OAAO;AACZ,KAAG,EAAE,MAAM;AACX,KAAG,EAAE,MAAM;AACX,KAAG,EAAE,QAAQ;AACb,KAAG,EAAE,QAAQ;AACb,KAAG,EAAE,QAAQ;AACb,KAAG,EAAE,QAAQ;CACd,CAAC;;AAEF,IAAM,QAAQ,GAAG,YAAY;IACvB,QAAQ,GAAG,WAAW,CAAC;;AAE7B,SAAS,UAAU,CAAC,GAAG,EAAE;AACvB,SAAO,MAAM,CAAC,GAAG,CAAC,CAAC;CACpB;;AAEM,SAAS,MAAM,CAAC,GAAG,oBAAmB;AAC3C,OAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACzC,SAAK,IAAI,GAAG,IAAI,SAAS,CAAC,CAAC,CAAC,EAAE;AAC5B,UAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE;AAC3D,WAAG,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;OAC9B;KACF;GACF;;AAED,SAAO,GAAG,CAAC;CACZ;;AAEM,IAAI,QAAQ,GAAG,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC;;;;;;AAKhD,IAAI,UAAU,GAAG,oBAAS,KAAK,EAAE;AAC/B,SAAO,OAAO,KAAK,KAAK,UAAU,CAAC;CACpC,CAAC;;;AAGF,IAAI,UAAU,CAAC,GAAG,CAAC,EAAE;AACnB,UAIM,UAAU,GAJhB,UAAU,GAAG,UAAS,KAAK,EAAE;AAC3B,WAAO,OAAO,KAAK,KAAK,UAAU,IAAI,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,mBAAmB,CAAC;GACpF,CAAC;CACH;QACO,UAAU,GAAV,UAAU;;;;;AAIX,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,IAAI,UAAS,KAAK,EAAE;AACtD,SAAO,AAAC,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ,GAAI,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,gBAAgB,GAAG,KAAK,CAAC;CACjG,CAAC;;;;;AAGK,SAAS,OAAO,CAAC,KAAK,EAAE,KAAK,EAAE;AACpC,OAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;AAChD,QAAI,KAAK,CAAC,CAAC,CAAC,KAAK,KAAK,EAAE;AACtB,aAAO,CAAC,CAAC;KACV;GACF;AACD,SAAO,CAAC,CAAC,CAAC;CACX;;AAGM,SAAS,gBAAgB,CAAC,MAAM,EAAE;AACvC,MAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;;AAE9B,QAAI,MAAM,IAAI,MAAM,CAAC,MAAM,EAAE;AAC3B,aAAO,MAAM,CAAC,MAAM,EAAE,CAAC;KACxB,MAAM,IAAI,MAAM,IAAI,IAAI,EAAE;AACzB,aAAO,EAAE,CAAC;KACX,MAAM,IAAI,CAAC,MAAM,EAAE;AAClB,aAAO,MAAM,GAAG,EAAE,CAAC;KACpB;;;;;AAKD,UAAM,GAAG,EAAE,GAAG,MAAM,CAAC;GACtB;;AAED,MAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;AAAE,WAAO,MAAM,CAAC;GAAE;AAC9C,SAAO,MAAM,CAAC,OAAO,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;CAC7C;;AAEM,SAAS,OAAO,CAAC,KAAK,EAAE;AAC7B,MAAI,CAAC,KAAK,IAAI,KAAK,KAAK,CAAC,EAAE;AACzB,WAAO,IAAI,CAAC;GACb,MAAM,IAAI,OAAO,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;AAC/C,WAAO,IAAI,CAAC;GACb,MAAM;AACL,WAAO,KAAK,CAAC;GACd;CACF;;AAEM,SAAS,WAAW,CAAC,MAAM,EAAE;AAClC,MAAI,KAAK,GAAG,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;AAC/B,OAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AACvB,SAAO,KAAK,CAAC;CACd;;AAEM,SAAS,WAAW,CAAC,MAAM,EAAE,GAAG,EAAE;AACvC,QAAM,CAAC,IAAI,GAAG,GAAG,CAAC;AAClB,SAAO,MAAM,CAAC;CACf;;AAEM,SAAS,iBAAiB,CAAC,WAAW,EAAE,EAAE,EAAE;AACjD,SAAO,CAAC,WAAW,GAAG,WAAW,GAAG,GAAG,GAAG,EAAE,CAAA,GAAI,EAAE,CAAC;CACpD;;;;AC3GD;AACA;AACA;AACA;;ACHA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACxLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC1LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5gDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACpLA;AACA;AACA;AACA;AACA;AACA;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC5OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC/NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AChNA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACpIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC/EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC9IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC9DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC/GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC/IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACvlBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC3jBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC//BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC3MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AChWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AChRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACzNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACp2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACldA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC5gCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACnGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC3lBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACr4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC5MA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC3WA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACtKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC3NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACtEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AChHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACrXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC1sBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACxyBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AChjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/FA;AACA;AACA;AACA;AACA;AACA;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC5IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC5iBA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACrEA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "file": "generated.js",
  "sourceRoot": "../",
  "sourcesContent": [
    "(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()",
    "/*! Backbone.Mutators - v0.4.4\n------------------------------\nBuild @ 2015-02-03\nDocumentation and Full License Available at:\nhttp://asciidisco.github.com/Backbone.Mutators/index.html\ngit://github.com/asciidisco/Backbone.Mutators.git\nCopyright (c) 2015 Sebastian Golasch <public@asciidisco.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a\ncopy of this software and associated documentation files (the \"Software\"),\nto deal in the Software without restriction, including without limitation\nthe rights to use, copy, modify, merge, publish, distribute, sublicense,\nand/or sell copies of the Software, and to permit persons to whom the\n\nSoftware is furnished to do so, subject to the following conditions:\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\nDAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\nARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\nIN THE SOFTWARE.*/\n(function (root, factory, undef) {\n    'use strict';\n\n    if (typeof exports === 'object') {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like enviroments that support module.exports,\n        // like Node.\n        module.exports = factory(require('underscore'), require('backbone'));\n    } else if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['underscore', 'backbone'], function (_, Backbone) {\n            // Check if we use the AMD branch of Back\n            _ = _ === undef ? root._ : _;\n            Backbone = Backbone === undef ? root.Backbone : Backbone;\n            return (root.returnExportsGlobal = factory(_, Backbone, root));\n        });\n    } else {\n        // Browser globals\n        root.returnExportsGlobal = factory(root._, root.Backbone);\n    }\n\n// Usage:\n//\n// Note: This plugin is UMD compatible, you can use it in node, amd and vanilla js envs\n//\n// Vanilla JS:\n// <script src=\"underscore.js\"></script>\n// <script src=\"backbone.js\"></script>\n// <script src=\"backbone.mutators.js\"></script>\n//\n// Node:\n// var _ = require('underscore');\n// var Backbone = require('backbone');\n// var Mutators = require('backbone.mutators');\n//\n//\n// AMD:\n// define(['underscore', 'backbone', 'backbone.mutators'], function (_, Backbone, Mutators) {\n//    // insert sample from below\n//    return User;\n// });\n//\n// var User = Backbone.Model.extend({\n//    mutators: {\n//        fullname: function () {\n//            return this.firstname + ' ' + this.lastname;\n//        }\n//    },\n//\n//    defaults: {\n//        firstname: 'Sebastian',\n//        lastname: 'Golasch'\n//    }\n// });\n//\n// var user = new User();\n// user.get('fullname') // returns 'Sebastian Golasch'\n// user.toJSON() // return '{firstname: 'Sebastian', lastname: 'Golasch', fullname: 'Sebastian Golasch'}'\n\n}(this, function (_, Backbone, root, undef) {\n    'use strict';\n\n    // check if we use the amd branch of backbone and underscore\n    Backbone = Backbone === undef ? root.Backbone : Backbone;\n    _ = _ === undef ? root._ : _;\n\n    // extend backbones model prototype with the mutator functionality\n    var Mutator     = function () {},\n        oldGet      = Backbone.Model.prototype.get,\n        oldSet      = Backbone.Model.prototype.set,\n        oldToJson   = Backbone.Model.prototype.toJSON;\n\n    // This is necessary to ensure that Models declared without the mutators object do not throw and error\n    Mutator.prototype.mutators = {};\n\n    // override get functionality to fetch the mutator props\n    Mutator.prototype.get = function (attr) {\n        var isMutator = this.mutators !== undef;\n\n        // check if we have a getter mutation\n        if (isMutator === true && _.isFunction(this.mutators[attr]) === true) {\n            return this.mutators[attr].call(this);\n        }\n\n        // check if we have a deeper nested getter mutation\n        if (isMutator === true && _.isObject(this.mutators[attr]) === true && _.isFunction(this.mutators[attr].get) === true) {\n            return this.mutators[attr].get.call(this);\n        }\n\n        return oldGet.call(this, attr);\n    };\n\n    // override set functionality to set the mutator props\n    Mutator.prototype.set = function (key, value, options) {\n        var isMutator = this.mutators !== undef,\n            ret = null,\n            attrs = null;\n\n\t\tret = oldSet.call(this, key, value, options);\n\n        // seamleassly stolen from backbone core\n        // check if the setter action is triggered\n        // using key <-> value or object\n        if (_.isObject(key) || key === null) {\n            attrs = key;\n            options = value;\n        } else {\n            attrs = {};\n            attrs[key] = value;\n        }\n\n        // check if we have a deeper nested setter mutation\n        if (isMutator === true && _.isObject(this.mutators[key]) === true) {\n\n            // check if we need to set a single value\n            if (_.isFunction(this.mutators[key].set) === true) {\n                ret = this.mutators[key].set.call(this, key, attrs[key], options, _.bind(oldSet, this));\n            } else if(_.isFunction(this.mutators[key])){\n                ret = this.mutators[key].call(this, key, attrs[key], options, _.bind(oldSet, this));\n            }\n        }\n\n        if (isMutator === true && _.isObject(attrs)) {\n            _.each(attrs, _.bind(function (attr, attrKey) {\n                if (_.isObject(this.mutators[attrKey]) === true) {\n                    // check if we need to set a single value\n\n                    var meth = this.mutators[attrKey];\n                    if(_.isFunction(meth.set)){\n                        meth = meth.set;\n                    }\n\n                    if(_.isFunction(meth)){\n                        if (options === undef || (_.isObject(options) === true && options.silent !== true && (options.mutators !== undef && options.mutators.silent !== true))) {\n                            this.trigger('mutators:set:' + attrKey);\n                        }\n                        meth.call(this, attrKey, attr, options, _.bind(oldSet, this));\n                    }\n\n                }\n            }, this));\n        }\n\n        return ret;\n    };\n\n    // override toJSON functionality to serialize mutator properties\n    Mutator.prototype.toJSON = function (options) {\n        // fetch ye olde values\n        var attr = oldToJson.call(this),\n            isSaving,\n            isTransient;\n        // iterate over all mutators (if there are some)\n        _.each(this.mutators, _.bind(function (mutator, name) {\n            // check if we have some getter mutations\n            if (_.isObject(this.mutators[name]) === true && _.isFunction(this.mutators[name].get)) {\n                isSaving = (this.isSaving) ? this.isSaving(options, mutator, name) : _.has(options || {}, 'emulateHTTP');\n                isTransient = this.mutators[name].transient;\n                if (!isSaving || !isTransient) {\n                  attr[name] = _.bind(this.mutators[name].get, this)();\n                }\n            } else if (_.isFunction(this.mutators[name])) {\n                attr[name] = _.bind(this.mutators[name], this)();\n            }\n        }, this));\n\n        return attr;\n    };\n\n    // override get functionality to get HTML-escaped the mutator props\n    Mutator.prototype.escape = function (attr){\n        var val = this.get(attr);\n        return _.escape(val == null ? '' : '' + val);\n    };\n\n    // extend the models prototype\n    _.extend(Backbone.Model.prototype, Mutator.prototype);\n\n    // make mutators globally available under the Backbone namespace\n    Backbone.Mutators = Mutator;\n    return Mutator;\n}));\n",
    "//     Underscore.js 1.4.4\n//     http://underscorejs.org\n//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud Inc.\n//     Underscore may be freely distributed under the MIT license.\n\n(function() {\n\n  // Baseline setup\n  // --------------\n\n  // Establish the root object, `window` in the browser, or `global` on the server.\n  var root = this;\n\n  // Save the previous value of the `_` variable.\n  var previousUnderscore = root._;\n\n  // Establish the object that gets returned to break out of a loop iteration.\n  var breaker = {};\n\n  // Save bytes in the minified (but not gzipped) version:\n  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;\n\n  // Create quick reference variables for speed access to core prototypes.\n  var push             = ArrayProto.push,\n      slice            = ArrayProto.slice,\n      concat           = ArrayProto.concat,\n      toString         = ObjProto.toString,\n      hasOwnProperty   = ObjProto.hasOwnProperty;\n\n  // All **ECMAScript 5** native function implementations that we hope to use\n  // are declared here.\n  var\n    nativeForEach      = ArrayProto.forEach,\n    nativeMap          = ArrayProto.map,\n    nativeReduce       = ArrayProto.reduce,\n    nativeReduceRight  = ArrayProto.reduceRight,\n    nativeFilter       = ArrayProto.filter,\n    nativeEvery        = ArrayProto.every,\n    nativeSome         = ArrayProto.some,\n    nativeIndexOf      = ArrayProto.indexOf,\n    nativeLastIndexOf  = ArrayProto.lastIndexOf,\n    nativeIsArray      = Array.isArray,\n    nativeKeys         = Object.keys,\n    nativeBind         = FuncProto.bind;\n\n  // Create a safe reference to the Underscore object for use below.\n  var _ = function(obj) {\n    if (obj instanceof _) return obj;\n    if (!(this instanceof _)) return new _(obj);\n    this._wrapped = obj;\n  };\n\n  // Export the Underscore object for **Node.js**, with\n  // backwards-compatibility for the old `require()` API. If we're in\n  // the browser, add `_` as a global object via a string identifier,\n  // for Closure Compiler \"advanced\" mode.\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = _;\n    }\n    exports._ = _;\n  } else {\n    root._ = _;\n  }\n\n  // Current version.\n  _.VERSION = '1.4.4';\n\n  // Collection Functions\n  // --------------------\n\n  // The cornerstone, an `each` implementation, aka `forEach`.\n  // Handles objects with the built-in `forEach`, arrays, and raw objects.\n  // Delegates to **ECMAScript 5**'s native `forEach` if available.\n  var each = _.each = _.forEach = function(obj, iterator, context) {\n    if (obj == null) return;\n    if (nativeForEach && obj.forEach === nativeForEach) {\n      obj.forEach(iterator, context);\n    } else if (obj.length === +obj.length) {\n      for (var i = 0, l = obj.length; i < l; i++) {\n        if (iterator.call(context, obj[i], i, obj) === breaker) return;\n      }\n    } else {\n      for (var key in obj) {\n        if (_.has(obj, key)) {\n          if (iterator.call(context, obj[key], key, obj) === breaker) return;\n        }\n      }\n    }\n  };\n\n  // Return the results of applying the iterator to each element.\n  // Delegates to **ECMAScript 5**'s native `map` if available.\n  _.map = _.collect = function(obj, iterator, context) {\n    var results = [];\n    if (obj == null) return results;\n    if (nativeMap && obj.map === nativeMap) return obj.map(iterator, context);\n    each(obj, function(value, index, list) {\n      results[results.length] = iterator.call(context, value, index, list);\n    });\n    return results;\n  };\n\n  var reduceError = 'Reduce of empty array with no initial value';\n\n  // **Reduce** builds up a single result from a list of values, aka `inject`,\n  // or `foldl`. Delegates to **ECMAScript 5**'s native `reduce` if available.\n  _.reduce = _.foldl = _.inject = function(obj, iterator, memo, context) {\n    var initial = arguments.length > 2;\n    if (obj == null) obj = [];\n    if (nativeReduce && obj.reduce === nativeReduce) {\n      if (context) iterator = _.bind(iterator, context);\n      return initial ? obj.reduce(iterator, memo) : obj.reduce(iterator);\n    }\n    each(obj, function(value, index, list) {\n      if (!initial) {\n        memo = value;\n        initial = true;\n      } else {\n        memo = iterator.call(context, memo, value, index, list);\n      }\n    });\n    if (!initial) throw new TypeError(reduceError);\n    return memo;\n  };\n\n  // The right-associative version of reduce, also known as `foldr`.\n  // Delegates to **ECMAScript 5**'s native `reduceRight` if available.\n  _.reduceRight = _.foldr = function(obj, iterator, memo, context) {\n    var initial = arguments.length > 2;\n    if (obj == null) obj = [];\n    if (nativeReduceRight && obj.reduceRight === nativeReduceRight) {\n      if (context) iterator = _.bind(iterator, context);\n      return initial ? obj.reduceRight(iterator, memo) : obj.reduceRight(iterator);\n    }\n    var length = obj.length;\n    if (length !== +length) {\n      var keys = _.keys(obj);\n      length = keys.length;\n    }\n    each(obj, function(value, index, list) {\n      index = keys ? keys[--length] : --length;\n      if (!initial) {\n        memo = obj[index];\n        initial = true;\n      } else {\n        memo = iterator.call(context, memo, obj[index], index, list);\n      }\n    });\n    if (!initial) throw new TypeError(reduceError);\n    return memo;\n  };\n\n  // Return the first value which passes a truth test. Aliased as `detect`.\n  _.find = _.detect = function(obj, iterator, context) {\n    var result;\n    any(obj, function(value, index, list) {\n      if (iterator.call(context, value, index, list)) {\n        result = value;\n        return true;\n      }\n    });\n    return result;\n  };\n\n  // Return all the elements that pass a truth test.\n  // Delegates to **ECMAScript 5**'s native `filter` if available.\n  // Aliased as `select`.\n  _.filter = _.select = function(obj, iterator, context) {\n    var results = [];\n    if (obj == null) return results;\n    if (nativeFilter && obj.filter === nativeFilter) return obj.filter(iterator, context);\n    each(obj, function(value, index, list) {\n      if (iterator.call(context, value, index, list)) results[results.length] = value;\n    });\n    return results;\n  };\n\n  // Return all the elements for which a truth test fails.\n  _.reject = function(obj, iterator, context) {\n    return _.filter(obj, function(value, index, list) {\n      return !iterator.call(context, value, index, list);\n    }, context);\n  };\n\n  // Determine whether all of the elements match a truth test.\n  // Delegates to **ECMAScript 5**'s native `every` if available.\n  // Aliased as `all`.\n  _.every = _.all = function(obj, iterator, context) {\n    iterator || (iterator = _.identity);\n    var result = true;\n    if (obj == null) return result;\n    if (nativeEvery && obj.every === nativeEvery) return obj.every(iterator, context);\n    each(obj, function(value, index, list) {\n      if (!(result = result && iterator.call(context, value, index, list))) return breaker;\n    });\n    return !!result;\n  };\n\n  // Determine if at least one element in the object matches a truth test.\n  // Delegates to **ECMAScript 5**'s native `some` if available.\n  // Aliased as `any`.\n  var any = _.some = _.any = function(obj, iterator, context) {\n    iterator || (iterator = _.identity);\n    var result = false;\n    if (obj == null) return result;\n    if (nativeSome && obj.some === nativeSome) return obj.some(iterator, context);\n    each(obj, function(value, index, list) {\n      if (result || (result = iterator.call(context, value, index, list))) return breaker;\n    });\n    return !!result;\n  };\n\n  // Determine if the array or object contains a given value (using `===`).\n  // Aliased as `include`.\n  _.contains = _.include = function(obj, target) {\n    if (obj == null) return false;\n    if (nativeIndexOf && obj.indexOf === nativeIndexOf) return obj.indexOf(target) != -1;\n    return any(obj, function(value) {\n      return value === target;\n    });\n  };\n\n  // Invoke a method (with arguments) on every item in a collection.\n  _.invoke = function(obj, method) {\n    var args = slice.call(arguments, 2);\n    var isFunc = _.isFunction(method);\n    return _.map(obj, function(value) {\n      return (isFunc ? method : value[method]).apply(value, args);\n    });\n  };\n\n  // Convenience version of a common use case of `map`: fetching a property.\n  _.pluck = function(obj, key) {\n    return _.map(obj, function(value){ return value[key]; });\n  };\n\n  // Convenience version of a common use case of `filter`: selecting only objects\n  // containing specific `key:value` pairs.\n  _.where = function(obj, attrs, first) {\n    if (_.isEmpty(attrs)) return first ? null : [];\n    return _[first ? 'find' : 'filter'](obj, function(value) {\n      for (var key in attrs) {\n        if (attrs[key] !== value[key]) return false;\n      }\n      return true;\n    });\n  };\n\n  // Convenience version of a common use case of `find`: getting the first object\n  // containing specific `key:value` pairs.\n  _.findWhere = function(obj, attrs) {\n    return _.where(obj, attrs, true);\n  };\n\n  // Return the maximum element or (element-based computation).\n  // Can't optimize arrays of integers longer than 65,535 elements.\n  // See: https://bugs.webkit.org/show_bug.cgi?id=80797\n  _.max = function(obj, iterator, context) {\n    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n      return Math.max.apply(Math, obj);\n    }\n    if (!iterator && _.isEmpty(obj)) return -Infinity;\n    var result = {computed : -Infinity, value: -Infinity};\n    each(obj, function(value, index, list) {\n      var computed = iterator ? iterator.call(context, value, index, list) : value;\n      computed >= result.computed && (result = {value : value, computed : computed});\n    });\n    return result.value;\n  };\n\n  // Return the minimum element (or element-based computation).\n  _.min = function(obj, iterator, context) {\n    if (!iterator && _.isArray(obj) && obj[0] === +obj[0] && obj.length < 65535) {\n      return Math.min.apply(Math, obj);\n    }\n    if (!iterator && _.isEmpty(obj)) return Infinity;\n    var result = {computed : Infinity, value: Infinity};\n    each(obj, function(value, index, list) {\n      var computed = iterator ? iterator.call(context, value, index, list) : value;\n      computed < result.computed && (result = {value : value, computed : computed});\n    });\n    return result.value;\n  };\n\n  // Shuffle an array.\n  _.shuffle = function(obj) {\n    var rand;\n    var index = 0;\n    var shuffled = [];\n    each(obj, function(value) {\n      rand = _.random(index++);\n      shuffled[index - 1] = shuffled[rand];\n      shuffled[rand] = value;\n    });\n    return shuffled;\n  };\n\n  // An internal function to generate lookup iterators.\n  var lookupIterator = function(value) {\n    return _.isFunction(value) ? value : function(obj){ return obj[value]; };\n  };\n\n  // Sort the object's values by a criterion produced by an iterator.\n  _.sortBy = function(obj, value, context) {\n    var iterator = lookupIterator(value);\n    return _.pluck(_.map(obj, function(value, index, list) {\n      return {\n        value : value,\n        index : index,\n        criteria : iterator.call(context, value, index, list)\n      };\n    }).sort(function(left, right) {\n      var a = left.criteria;\n      var b = right.criteria;\n      if (a !== b) {\n        if (a > b || a === void 0) return 1;\n        if (a < b || b === void 0) return -1;\n      }\n      return left.index < right.index ? -1 : 1;\n    }), 'value');\n  };\n\n  // An internal function used for aggregate \"group by\" operations.\n  var group = function(obj, value, context, behavior) {\n    var result = {};\n    var iterator = lookupIterator(value || _.identity);\n    each(obj, function(value, index) {\n      var key = iterator.call(context, value, index, obj);\n      behavior(result, key, value);\n    });\n    return result;\n  };\n\n  // Groups the object's values by a criterion. Pass either a string attribute\n  // to group by, or a function that returns the criterion.\n  _.groupBy = function(obj, value, context) {\n    return group(obj, value, context, function(result, key, value) {\n      (_.has(result, key) ? result[key] : (result[key] = [])).push(value);\n    });\n  };\n\n  // Counts instances of an object that group by a certain criterion. Pass\n  // either a string attribute to count by, or a function that returns the\n  // criterion.\n  _.countBy = function(obj, value, context) {\n    return group(obj, value, context, function(result, key) {\n      if (!_.has(result, key)) result[key] = 0;\n      result[key]++;\n    });\n  };\n\n  // Use a comparator function to figure out the smallest index at which\n  // an object should be inserted so as to maintain order. Uses binary search.\n  _.sortedIndex = function(array, obj, iterator, context) {\n    iterator = iterator == null ? _.identity : lookupIterator(iterator);\n    var value = iterator.call(context, obj);\n    var low = 0, high = array.length;\n    while (low < high) {\n      var mid = (low + high) >>> 1;\n      iterator.call(context, array[mid]) < value ? low = mid + 1 : high = mid;\n    }\n    return low;\n  };\n\n  // Safely convert anything iterable into a real, live array.\n  _.toArray = function(obj) {\n    if (!obj) return [];\n    if (_.isArray(obj)) return slice.call(obj);\n    if (obj.length === +obj.length) return _.map(obj, _.identity);\n    return _.values(obj);\n  };\n\n  // Return the number of elements in an object.\n  _.size = function(obj) {\n    if (obj == null) return 0;\n    return (obj.length === +obj.length) ? obj.length : _.keys(obj).length;\n  };\n\n  // Array Functions\n  // ---------------\n\n  // Get the first element of an array. Passing **n** will return the first N\n  // values in the array. Aliased as `head` and `take`. The **guard** check\n  // allows it to work with `_.map`.\n  _.first = _.head = _.take = function(array, n, guard) {\n    if (array == null) return void 0;\n    return (n != null) && !guard ? slice.call(array, 0, n) : array[0];\n  };\n\n  // Returns everything but the last entry of the array. Especially useful on\n  // the arguments object. Passing **n** will return all the values in\n  // the array, excluding the last N. The **guard** check allows it to work with\n  // `_.map`.\n  _.initial = function(array, n, guard) {\n    return slice.call(array, 0, array.length - ((n == null) || guard ? 1 : n));\n  };\n\n  // Get the last element of an array. Passing **n** will return the last N\n  // values in the array. The **guard** check allows it to work with `_.map`.\n  _.last = function(array, n, guard) {\n    if (array == null) return void 0;\n    if ((n != null) && !guard) {\n      return slice.call(array, Math.max(array.length - n, 0));\n    } else {\n      return array[array.length - 1];\n    }\n  };\n\n  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\n  // Especially useful on the arguments object. Passing an **n** will return\n  // the rest N values in the array. The **guard**\n  // check allows it to work with `_.map`.\n  _.rest = _.tail = _.drop = function(array, n, guard) {\n    return slice.call(array, (n == null) || guard ? 1 : n);\n  };\n\n  // Trim out all falsy values from an array.\n  _.compact = function(array) {\n    return _.filter(array, _.identity);\n  };\n\n  // Internal implementation of a recursive `flatten` function.\n  var flatten = function(input, shallow, output) {\n    each(input, function(value) {\n      if (_.isArray(value)) {\n        shallow ? push.apply(output, value) : flatten(value, shallow, output);\n      } else {\n        output.push(value);\n      }\n    });\n    return output;\n  };\n\n  // Return a completely flattened version of an array.\n  _.flatten = function(array, shallow) {\n    return flatten(array, shallow, []);\n  };\n\n  // Return a version of the array that does not contain the specified value(s).\n  _.without = function(array) {\n    return _.difference(array, slice.call(arguments, 1));\n  };\n\n  // Produce a duplicate-free version of the array. If the array has already\n  // been sorted, you have the option of using a faster algorithm.\n  // Aliased as `unique`.\n  _.uniq = _.unique = function(array, isSorted, iterator, context) {\n    if (_.isFunction(isSorted)) {\n      context = iterator;\n      iterator = isSorted;\n      isSorted = false;\n    }\n    var initial = iterator ? _.map(array, iterator, context) : array;\n    var results = [];\n    var seen = [];\n    each(initial, function(value, index) {\n      if (isSorted ? (!index || seen[seen.length - 1] !== value) : !_.contains(seen, value)) {\n        seen.push(value);\n        results.push(array[index]);\n      }\n    });\n    return results;\n  };\n\n  // Produce an array that contains the union: each distinct element from all of\n  // the passed-in arrays.\n  _.union = function() {\n    return _.uniq(concat.apply(ArrayProto, arguments));\n  };\n\n  // Produce an array that contains every item shared between all the\n  // passed-in arrays.\n  _.intersection = function(array) {\n    var rest = slice.call(arguments, 1);\n    return _.filter(_.uniq(array), function(item) {\n      return _.every(rest, function(other) {\n        return _.indexOf(other, item) >= 0;\n      });\n    });\n  };\n\n  // Take the difference between one array and a number of other arrays.\n  // Only the elements present in just the first array will remain.\n  _.difference = function(array) {\n    var rest = concat.apply(ArrayProto, slice.call(arguments, 1));\n    return _.filter(array, function(value){ return !_.contains(rest, value); });\n  };\n\n  // Zip together multiple lists into a single array -- elements that share\n  // an index go together.\n  _.zip = function() {\n    var args = slice.call(arguments);\n    var length = _.max(_.pluck(args, 'length'));\n    var results = new Array(length);\n    for (var i = 0; i < length; i++) {\n      results[i] = _.pluck(args, \"\" + i);\n    }\n    return results;\n  };\n\n  // Converts lists into objects. Pass either a single array of `[key, value]`\n  // pairs, or two parallel arrays of the same length -- one of keys, and one of\n  // the corresponding values.\n  _.object = function(list, values) {\n    if (list == null) return {};\n    var result = {};\n    for (var i = 0, l = list.length; i < l; i++) {\n      if (values) {\n        result[list[i]] = values[i];\n      } else {\n        result[list[i][0]] = list[i][1];\n      }\n    }\n    return result;\n  };\n\n  // If the browser doesn't supply us with indexOf (I'm looking at you, **MSIE**),\n  // we need this function. Return the position of the first occurrence of an\n  // item in an array, or -1 if the item is not included in the array.\n  // Delegates to **ECMAScript 5**'s native `indexOf` if available.\n  // If the array is large and already in sort order, pass `true`\n  // for **isSorted** to use binary search.\n  _.indexOf = function(array, item, isSorted) {\n    if (array == null) return -1;\n    var i = 0, l = array.length;\n    if (isSorted) {\n      if (typeof isSorted == 'number') {\n        i = (isSorted < 0 ? Math.max(0, l + isSorted) : isSorted);\n      } else {\n        i = _.sortedIndex(array, item);\n        return array[i] === item ? i : -1;\n      }\n    }\n    if (nativeIndexOf && array.indexOf === nativeIndexOf) return array.indexOf(item, isSorted);\n    for (; i < l; i++) if (array[i] === item) return i;\n    return -1;\n  };\n\n  // Delegates to **ECMAScript 5**'s native `lastIndexOf` if available.\n  _.lastIndexOf = function(array, item, from) {\n    if (array == null) return -1;\n    var hasIndex = from != null;\n    if (nativeLastIndexOf && array.lastIndexOf === nativeLastIndexOf) {\n      return hasIndex ? array.lastIndexOf(item, from) : array.lastIndexOf(item);\n    }\n    var i = (hasIndex ? from : array.length);\n    while (i--) if (array[i] === item) return i;\n    return -1;\n  };\n\n  // Generate an integer Array containing an arithmetic progression. A port of\n  // the native Python `range()` function. See\n  // [the Python documentation](http://docs.python.org/library/functions.html#range).\n  _.range = function(start, stop, step) {\n    if (arguments.length <= 1) {\n      stop = start || 0;\n      start = 0;\n    }\n    step = arguments[2] || 1;\n\n    var len = Math.max(Math.ceil((stop - start) / step), 0);\n    var idx = 0;\n    var range = new Array(len);\n\n    while(idx < len) {\n      range[idx++] = start;\n      start += step;\n    }\n\n    return range;\n  };\n\n  // Function (ahem) Functions\n  // ------------------\n\n  // Create a function bound to a given object (assigning `this`, and arguments,\n  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if\n  // available.\n  _.bind = function(func, context) {\n    if (func.bind === nativeBind && nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));\n    var args = slice.call(arguments, 2);\n    return function() {\n      return func.apply(context, args.concat(slice.call(arguments)));\n    };\n  };\n\n  // Partially apply a function by creating a version that has had some of its\n  // arguments pre-filled, without changing its dynamic `this` context.\n  _.partial = function(func) {\n    var args = slice.call(arguments, 1);\n    return function() {\n      return func.apply(this, args.concat(slice.call(arguments)));\n    };\n  };\n\n  // Bind all of an object's methods to that object. Useful for ensuring that\n  // all callbacks defined on an object belong to it.\n  _.bindAll = function(obj) {\n    var funcs = slice.call(arguments, 1);\n    if (funcs.length === 0) funcs = _.functions(obj);\n    each(funcs, function(f) { obj[f] = _.bind(obj[f], obj); });\n    return obj;\n  };\n\n  // Memoize an expensive function by storing its results.\n  _.memoize = function(func, hasher) {\n    var memo = {};\n    hasher || (hasher = _.identity);\n    return function() {\n      var key = hasher.apply(this, arguments);\n      return _.has(memo, key) ? memo[key] : (memo[key] = func.apply(this, arguments));\n    };\n  };\n\n  // Delays a function for the given number of milliseconds, and then calls\n  // it with the arguments supplied.\n  _.delay = function(func, wait) {\n    var args = slice.call(arguments, 2);\n    return setTimeout(function(){ return func.apply(null, args); }, wait);\n  };\n\n  // Defers a function, scheduling it to run after the current call stack has\n  // cleared.\n  _.defer = function(func) {\n    return _.delay.apply(_, [func, 1].concat(slice.call(arguments, 1)));\n  };\n\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time.\n  _.throttle = function(func, wait) {\n    var context, args, timeout, result;\n    var previous = 0;\n    var later = function() {\n      previous = new Date;\n      timeout = null;\n      result = func.apply(context, args);\n    };\n    return function() {\n      var now = new Date;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0) {\n        clearTimeout(timeout);\n        timeout = null;\n        previous = now;\n        result = func.apply(context, args);\n      } else if (!timeout) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  };\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds. If `immediate` is passed, trigger the function on the\n  // leading edge, instead of the trailing.\n  _.debounce = function(func, wait, immediate) {\n    var timeout, result;\n    return function() {\n      var context = this, args = arguments;\n      var later = function() {\n        timeout = null;\n        if (!immediate) result = func.apply(context, args);\n      };\n      var callNow = immediate && !timeout;\n      clearTimeout(timeout);\n      timeout = setTimeout(later, wait);\n      if (callNow) result = func.apply(context, args);\n      return result;\n    };\n  };\n\n  // Returns a function that will be executed at most one time, no matter how\n  // often you call it. Useful for lazy initialization.\n  _.once = function(func) {\n    var ran = false, memo;\n    return function() {\n      if (ran) return memo;\n      ran = true;\n      memo = func.apply(this, arguments);\n      func = null;\n      return memo;\n    };\n  };\n\n  // Returns the first function passed as an argument to the second,\n  // allowing you to adjust arguments, run code before and after, and\n  // conditionally execute the original function.\n  _.wrap = function(func, wrapper) {\n    return function() {\n      var args = [func];\n      push.apply(args, arguments);\n      return wrapper.apply(this, args);\n    };\n  };\n\n  // Returns a function that is the composition of a list of functions, each\n  // consuming the return value of the function that follows.\n  _.compose = function() {\n    var funcs = arguments;\n    return function() {\n      var args = arguments;\n      for (var i = funcs.length - 1; i >= 0; i--) {\n        args = [funcs[i].apply(this, args)];\n      }\n      return args[0];\n    };\n  };\n\n  // Returns a function that will only be executed after being called N times.\n  _.after = function(times, func) {\n    if (times <= 0) return func();\n    return function() {\n      if (--times < 1) {\n        return func.apply(this, arguments);\n      }\n    };\n  };\n\n  // Object Functions\n  // ----------------\n\n  // Retrieve the names of an object's properties.\n  // Delegates to **ECMAScript 5**'s native `Object.keys`\n  _.keys = nativeKeys || function(obj) {\n    if (obj !== Object(obj)) throw new TypeError('Invalid object');\n    var keys = [];\n    for (var key in obj) if (_.has(obj, key)) keys[keys.length] = key;\n    return keys;\n  };\n\n  // Retrieve the values of an object's properties.\n  _.values = function(obj) {\n    var values = [];\n    for (var key in obj) if (_.has(obj, key)) values.push(obj[key]);\n    return values;\n  };\n\n  // Convert an object into a list of `[key, value]` pairs.\n  _.pairs = function(obj) {\n    var pairs = [];\n    for (var key in obj) if (_.has(obj, key)) pairs.push([key, obj[key]]);\n    return pairs;\n  };\n\n  // Invert the keys and values of an object. The values must be serializable.\n  _.invert = function(obj) {\n    var result = {};\n    for (var key in obj) if (_.has(obj, key)) result[obj[key]] = key;\n    return result;\n  };\n\n  // Return a sorted list of the function names available on the object.\n  // Aliased as `methods`\n  _.functions = _.methods = function(obj) {\n    var names = [];\n    for (var key in obj) {\n      if (_.isFunction(obj[key])) names.push(key);\n    }\n    return names.sort();\n  };\n\n  // Extend a given object with all the properties in passed-in object(s).\n  _.extend = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (source) {\n        for (var prop in source) {\n          obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  };\n\n  // Return a copy of the object only containing the whitelisted properties.\n  _.pick = function(obj) {\n    var copy = {};\n    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n    each(keys, function(key) {\n      if (key in obj) copy[key] = obj[key];\n    });\n    return copy;\n  };\n\n   // Return a copy of the object without the blacklisted properties.\n  _.omit = function(obj) {\n    var copy = {};\n    var keys = concat.apply(ArrayProto, slice.call(arguments, 1));\n    for (var key in obj) {\n      if (!_.contains(keys, key)) copy[key] = obj[key];\n    }\n    return copy;\n  };\n\n  // Fill in a given object with default properties.\n  _.defaults = function(obj) {\n    each(slice.call(arguments, 1), function(source) {\n      if (source) {\n        for (var prop in source) {\n          if (obj[prop] == null) obj[prop] = source[prop];\n        }\n      }\n    });\n    return obj;\n  };\n\n  // Create a (shallow-cloned) duplicate of an object.\n  _.clone = function(obj) {\n    if (!_.isObject(obj)) return obj;\n    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\n  };\n\n  // Invokes interceptor with the obj, and then returns obj.\n  // The primary purpose of this method is to \"tap into\" a method chain, in\n  // order to perform operations on intermediate results within the chain.\n  _.tap = function(obj, interceptor) {\n    interceptor(obj);\n    return obj;\n  };\n\n  // Internal recursive comparison function for `isEqual`.\n  var eq = function(a, b, aStack, bStack) {\n    // Identical objects are equal. `0 === -0`, but they aren't identical.\n    // See the Harmony `egal` proposal: http://wiki.ecmascript.org/doku.php?id=harmony:egal.\n    if (a === b) return a !== 0 || 1 / a == 1 / b;\n    // A strict comparison is necessary because `null == undefined`.\n    if (a == null || b == null) return a === b;\n    // Unwrap any wrapped objects.\n    if (a instanceof _) a = a._wrapped;\n    if (b instanceof _) b = b._wrapped;\n    // Compare `[[Class]]` names.\n    var className = toString.call(a);\n    if (className != toString.call(b)) return false;\n    switch (className) {\n      // Strings, numbers, dates, and booleans are compared by value.\n      case '[object String]':\n        // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\n        // equivalent to `new String(\"5\")`.\n        return a == String(b);\n      case '[object Number]':\n        // `NaN`s are equivalent, but non-reflexive. An `egal` comparison is performed for\n        // other numeric values.\n        return a != +a ? b != +b : (a == 0 ? 1 / a == 1 / b : a == +b);\n      case '[object Date]':\n      case '[object Boolean]':\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\n        // millisecond representations. Note that invalid dates with millisecond representations\n        // of `NaN` are not equivalent.\n        return +a == +b;\n      // RegExps are compared by their source patterns and flags.\n      case '[object RegExp]':\n        return a.source == b.source &&\n               a.global == b.global &&\n               a.multiline == b.multiline &&\n               a.ignoreCase == b.ignoreCase;\n    }\n    if (typeof a != 'object' || typeof b != 'object') return false;\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\n    var length = aStack.length;\n    while (length--) {\n      // Linear search. Performance is inversely proportional to the number of\n      // unique nested structures.\n      if (aStack[length] == a) return bStack[length] == b;\n    }\n    // Add the first object to the stack of traversed objects.\n    aStack.push(a);\n    bStack.push(b);\n    var size = 0, result = true;\n    // Recursively compare objects and arrays.\n    if (className == '[object Array]') {\n      // Compare array lengths to determine if a deep comparison is necessary.\n      size = a.length;\n      result = size == b.length;\n      if (result) {\n        // Deep compare the contents, ignoring non-numeric properties.\n        while (size--) {\n          if (!(result = eq(a[size], b[size], aStack, bStack))) break;\n        }\n      }\n    } else {\n      // Objects with different constructors are not equivalent, but `Object`s\n      // from different frames are.\n      var aCtor = a.constructor, bCtor = b.constructor;\n      if (aCtor !== bCtor && !(_.isFunction(aCtor) && (aCtor instanceof aCtor) &&\n                               _.isFunction(bCtor) && (bCtor instanceof bCtor))) {\n        return false;\n      }\n      // Deep compare objects.\n      for (var key in a) {\n        if (_.has(a, key)) {\n          // Count the expected number of properties.\n          size++;\n          // Deep compare each member.\n          if (!(result = _.has(b, key) && eq(a[key], b[key], aStack, bStack))) break;\n        }\n      }\n      // Ensure that both objects contain the same number of properties.\n      if (result) {\n        for (key in b) {\n          if (_.has(b, key) && !(size--)) break;\n        }\n        result = !size;\n      }\n    }\n    // Remove the first object from the stack of traversed objects.\n    aStack.pop();\n    bStack.pop();\n    return result;\n  };\n\n  // Perform a deep comparison to check if two objects are equal.\n  _.isEqual = function(a, b) {\n    return eq(a, b, [], []);\n  };\n\n  // Is a given array, string, or object empty?\n  // An \"empty\" object has no enumerable own-properties.\n  _.isEmpty = function(obj) {\n    if (obj == null) return true;\n    if (_.isArray(obj) || _.isString(obj)) return obj.length === 0;\n    for (var key in obj) if (_.has(obj, key)) return false;\n    return true;\n  };\n\n  // Is a given value a DOM element?\n  _.isElement = function(obj) {\n    return !!(obj && obj.nodeType === 1);\n  };\n\n  // Is a given value an array?\n  // Delegates to ECMA5's native Array.isArray\n  _.isArray = nativeIsArray || function(obj) {\n    return toString.call(obj) == '[object Array]';\n  };\n\n  // Is a given variable an object?\n  _.isObject = function(obj) {\n    return obj === Object(obj);\n  };\n\n  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp.\n  each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp'], function(name) {\n    _['is' + name] = function(obj) {\n      return toString.call(obj) == '[object ' + name + ']';\n    };\n  });\n\n  // Define a fallback version of the method in browsers (ahem, IE), where\n  // there isn't any inspectable \"Arguments\" type.\n  if (!_.isArguments(arguments)) {\n    _.isArguments = function(obj) {\n      return !!(obj && _.has(obj, 'callee'));\n    };\n  }\n\n  // Optimize `isFunction` if appropriate.\n  if (typeof (/./) !== 'function') {\n    _.isFunction = function(obj) {\n      return typeof obj === 'function';\n    };\n  }\n\n  // Is a given object a finite number?\n  _.isFinite = function(obj) {\n    return isFinite(obj) && !isNaN(parseFloat(obj));\n  };\n\n  // Is the given value `NaN`? (NaN is the only number which does not equal itself).\n  _.isNaN = function(obj) {\n    return _.isNumber(obj) && obj != +obj;\n  };\n\n  // Is a given value a boolean?\n  _.isBoolean = function(obj) {\n    return obj === true || obj === false || toString.call(obj) == '[object Boolean]';\n  };\n\n  // Is a given value equal to null?\n  _.isNull = function(obj) {\n    return obj === null;\n  };\n\n  // Is a given variable undefined?\n  _.isUndefined = function(obj) {\n    return obj === void 0;\n  };\n\n  // Shortcut function for checking if an object has a given property directly\n  // on itself (in other words, not on a prototype).\n  _.has = function(obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  // Utility Functions\n  // -----------------\n\n  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\n  // previous owner. Returns a reference to the Underscore object.\n  _.noConflict = function() {\n    root._ = previousUnderscore;\n    return this;\n  };\n\n  // Keep the identity function around for default iterators.\n  _.identity = function(value) {\n    return value;\n  };\n\n  // Run a function **n** times.\n  _.times = function(n, iterator, context) {\n    var accum = Array(n);\n    for (var i = 0; i < n; i++) accum[i] = iterator.call(context, i);\n    return accum;\n  };\n\n  // Return a random integer between min and max (inclusive).\n  _.random = function(min, max) {\n    if (max == null) {\n      max = min;\n      min = 0;\n    }\n    return min + Math.floor(Math.random() * (max - min + 1));\n  };\n\n  // List of HTML entities for escaping.\n  var entityMap = {\n    escape: {\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#x27;',\n      '/': '&#x2F;'\n    }\n  };\n  entityMap.unescape = _.invert(entityMap.escape);\n\n  // Regexes containing the keys and values listed immediately above.\n  var entityRegexes = {\n    escape:   new RegExp('[' + _.keys(entityMap.escape).join('') + ']', 'g'),\n    unescape: new RegExp('(' + _.keys(entityMap.unescape).join('|') + ')', 'g')\n  };\n\n  // Functions for escaping and unescaping strings to/from HTML interpolation.\n  _.each(['escape', 'unescape'], function(method) {\n    _[method] = function(string) {\n      if (string == null) return '';\n      return ('' + string).replace(entityRegexes[method], function(match) {\n        return entityMap[method][match];\n      });\n    };\n  });\n\n  // If the value of the named property is a function then invoke it;\n  // otherwise, return it.\n  _.result = function(object, property) {\n    if (object == null) return null;\n    var value = object[property];\n    return _.isFunction(value) ? value.call(object) : value;\n  };\n\n  // Add your own custom functions to the Underscore object.\n  _.mixin = function(obj) {\n    each(_.functions(obj), function(name){\n      var func = _[name] = obj[name];\n      _.prototype[name] = function() {\n        var args = [this._wrapped];\n        push.apply(args, arguments);\n        return result.call(this, func.apply(_, args));\n      };\n    });\n  };\n\n  // Generate a unique integer id (unique within the entire client session).\n  // Useful for temporary DOM ids.\n  var idCounter = 0;\n  _.uniqueId = function(prefix) {\n    var id = ++idCounter + '';\n    return prefix ? prefix + id : id;\n  };\n\n  // By default, Underscore uses ERB-style template delimiters, change the\n  // following template settings to use alternative delimiters.\n  _.templateSettings = {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g\n  };\n\n  // When customizing `templateSettings`, if you don't want to define an\n  // interpolation, evaluation or escaping regex, we need one that is\n  // guaranteed not to match.\n  var noMatch = /(.)^/;\n\n  // Certain characters need to be escaped so that they can be put into a\n  // string literal.\n  var escapes = {\n    \"'\":      \"'\",\n    '\\\\':     '\\\\',\n    '\\r':     'r',\n    '\\n':     'n',\n    '\\t':     't',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  var escaper = /\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;\n\n  // JavaScript micro-templating, similar to John Resig's implementation.\n  // Underscore templating handles arbitrary delimiters, preserves whitespace,\n  // and correctly escapes quotes within interpolated code.\n  _.template = function(text, data, settings) {\n    var render;\n    settings = _.defaults({}, settings, _.templateSettings);\n\n    // Combine delimiters into one regular expression via alternation.\n    var matcher = new RegExp([\n      (settings.escape || noMatch).source,\n      (settings.interpolate || noMatch).source,\n      (settings.evaluate || noMatch).source\n    ].join('|') + '|$', 'g');\n\n    // Compile the template source, escaping string literals appropriately.\n    var index = 0;\n    var source = \"__p+='\";\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n      source += text.slice(index, offset)\n        .replace(escaper, function(match) { return '\\\\' + escapes[match]; });\n\n      if (escape) {\n        source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\n      }\n      if (interpolate) {\n        source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\n      }\n      if (evaluate) {\n        source += \"';\\n\" + evaluate + \"\\n__p+='\";\n      }\n      index = offset + match.length;\n      return match;\n    });\n    source += \"';\\n\";\n\n    // If a variable is not specified, place data values in local scope.\n    if (!settings.variable) source = 'with(obj||{}){\\n' + source + '}\\n';\n\n    source = \"var __t,__p='',__j=Array.prototype.join,\" +\n      \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\n      source + \"return __p;\\n\";\n\n    try {\n      render = new Function(settings.variable || 'obj', '_', source);\n    } catch (e) {\n      e.source = source;\n      throw e;\n    }\n\n    if (data) return render(data, _);\n    var template = function(data) {\n      return render.call(this, data, _);\n    };\n\n    // Provide the compiled function source as a convenience for precompilation.\n    template.source = 'function(' + (settings.variable || 'obj') + '){\\n' + source + '}';\n\n    return template;\n  };\n\n  // Add a \"chain\" function, which will delegate to the wrapper.\n  _.chain = function(obj) {\n    return _(obj).chain();\n  };\n\n  // OOP\n  // ---------------\n  // If Underscore is called as a function, it returns a wrapped object that\n  // can be used OO-style. This wrapper holds altered versions of all the\n  // underscore functions. Wrapped objects may be chained.\n\n  // Helper function to continue chaining intermediate results.\n  var result = function(obj) {\n    return this._chain ? _(obj).chain() : obj;\n  };\n\n  // Add all of the Underscore functions to the wrapper object.\n  _.mixin(_);\n\n  // Add all mutator Array functions to the wrapper.\n  each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      var obj = this._wrapped;\n      method.apply(obj, arguments);\n      if ((name == 'shift' || name == 'splice') && obj.length === 0) delete obj[0];\n      return result.call(this, obj);\n    };\n  });\n\n  // Add all accessor Array functions to the wrapper.\n  each(['concat', 'join', 'slice'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      return result.call(this, method.apply(this._wrapped, arguments));\n    };\n  });\n\n  _.extend(_.prototype, {\n\n    // Start chaining a wrapped Underscore object.\n    chain: function() {\n      this._chain = true;\n      return this;\n    },\n\n    // Extracts the result from a wrapped and chained object.\n    value: function() {\n      return this._wrapped;\n    }\n\n  });\n\n}).call(this);\n",
    "// Backbone.BabySitter\n// -------------------\n// v0.1.11\n//\n// Copyright (c)2016 Derick Bailey, Muted Solutions, LLC.\n// Distributed under MIT license\n//\n// http://github.com/marionettejs/backbone.babysitter\n\n(function(root, factory) {\n\n  if (typeof define === 'function' && define.amd) {\n    define(['backbone', 'underscore'], function(Backbone, _) {\n      return factory(Backbone, _);\n    });\n  } else if (typeof exports !== 'undefined') {\n    var Backbone = require('backbone');\n    var _ = require('underscore');\n    module.exports = factory(Backbone, _);\n  } else {\n    factory(root.Backbone, root._);\n  }\n\n}(this, function(Backbone, _) {\n  'use strict';\n\n  var previousChildViewContainer = Backbone.ChildViewContainer;\n\n  // BabySitter.ChildViewContainer\n  // -----------------------------\n  //\n  // Provide a container to store, retrieve and\n  // shut down child views.\n  \n  Backbone.ChildViewContainer = (function (Backbone, _) {\n  \n    // Container Constructor\n    // ---------------------\n  \n    var Container = function(views){\n      this._views = {};\n      this._indexByModel = {};\n      this._indexByCustom = {};\n      this._updateLength();\n  \n      _.each(views, this.add, this);\n    };\n  \n    // Container Methods\n    // -----------------\n  \n    _.extend(Container.prototype, {\n  \n      // Add a view to this container. Stores the view\n      // by `cid` and makes it searchable by the model\n      // cid (and model itself). Optionally specify\n      // a custom key to store an retrieve the view.\n      add: function(view, customIndex){\n        var viewCid = view.cid;\n  \n        // store the view\n        this._views[viewCid] = view;\n  \n        // index it by model\n        if (view.model){\n          this._indexByModel[view.model.cid] = viewCid;\n        }\n  \n        // index by custom\n        if (customIndex){\n          this._indexByCustom[customIndex] = viewCid;\n        }\n  \n        this._updateLength();\n        return this;\n      },\n  \n      // Find a view by the model that was attached to\n      // it. Uses the model's `cid` to find it.\n      findByModel: function(model){\n        return this.findByModelCid(model.cid);\n      },\n  \n      // Find a view by the `cid` of the model that was attached to\n      // it. Uses the model's `cid` to find the view `cid` and\n      // retrieve the view using it.\n      findByModelCid: function(modelCid){\n        var viewCid = this._indexByModel[modelCid];\n        return this.findByCid(viewCid);\n      },\n  \n      // Find a view by a custom indexer.\n      findByCustom: function(index){\n        var viewCid = this._indexByCustom[index];\n        return this.findByCid(viewCid);\n      },\n  \n      // Find by index. This is not guaranteed to be a\n      // stable index.\n      findByIndex: function(index){\n        return _.values(this._views)[index];\n      },\n  \n      // retrieve a view by its `cid` directly\n      findByCid: function(cid){\n        return this._views[cid];\n      },\n  \n      // Remove a view\n      remove: function(view){\n        var viewCid = view.cid;\n  \n        // delete model index\n        if (view.model){\n          delete this._indexByModel[view.model.cid];\n        }\n  \n        // delete custom index\n        _.any(this._indexByCustom, function(cid, key) {\n          if (cid === viewCid) {\n            delete this._indexByCustom[key];\n            return true;\n          }\n        }, this);\n  \n        // remove the view from the container\n        delete this._views[viewCid];\n  \n        // update the length\n        this._updateLength();\n        return this;\n      },\n  \n      // Call a method on every view in the container,\n      // passing parameters to the call method one at a\n      // time, like `function.call`.\n      call: function(method){\n        this.apply(method, _.tail(arguments));\n      },\n  \n      // Apply a method on every view in the container,\n      // passing parameters to the call method one at a\n      // time, like `function.apply`.\n      apply: function(method, args){\n        _.each(this._views, function(view){\n          if (_.isFunction(view[method])){\n            view[method].apply(view, args || []);\n          }\n        });\n      },\n  \n      // Update the `.length` attribute on this container\n      _updateLength: function(){\n        this.length = _.size(this._views);\n      }\n    });\n  \n    // Borrowing this code from Backbone.Collection:\n    // http://backbonejs.org/docs/backbone.html#section-106\n    //\n    // Mix in methods from Underscore, for iteration, and other\n    // collection related features.\n    var methods = ['forEach', 'each', 'map', 'find', 'detect', 'filter',\n      'select', 'reject', 'every', 'all', 'some', 'any', 'include',\n      'contains', 'invoke', 'toArray', 'first', 'initial', 'rest',\n      'last', 'without', 'isEmpty', 'pluck', 'reduce'];\n  \n    _.each(methods, function(method) {\n      Container.prototype[method] = function() {\n        var views = _.values(this._views);\n        var args = [views].concat(_.toArray(arguments));\n        return _[method].apply(_, args);\n      };\n    });\n  \n    // return the public API\n    return Container;\n  })(Backbone, _);\n  \n\n  Backbone.ChildViewContainer.VERSION = '0.1.11';\n\n  Backbone.ChildViewContainer.noConflict = function () {\n    Backbone.ChildViewContainer = previousChildViewContainer;\n    return this;\n  };\n\n  return Backbone.ChildViewContainer;\n\n}));\n",
    "/**\n * Backbone.Native\n *\n * For all details and documentation:\n * http://github.com/inkling/backbone.native\n *\n * Copyright 2013 Inkling Systems, Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * The purpose of this library is to allow Backbone to work without needing to load jQuery or Zepto.\n * This file provides a basic jQuery-like implementation for Backbone, implementing the\n * minimum functionality for Backbone to function. We assume that Backbone applications using\n * this will not expect the standard jQuery API to work, and will instead use native JS functions.\n *\n * Keep in mind that due to the APIs in this, it will likely only work on recent browsers.\n *\n * Note:\n *  - Core Backbone only needs collections with single members, so that is all that has been\n *      supported in this library. It is expected that you will just use querySelectorAll instead.\n *      This will be most obvious if you make heavy use of 'view.$'.\n *  - Events delegated with selectors starting with '>' are not supported.\n *  - Due to 'currentTarget' being read-only on standard DOM events, we cannot make standard\n *      events behave identically to jQuery's events when delegation is used. The element matching\n *      the delegate selector is instead passed as the second argument to event handlers.\n *  - The '$.ajax' implementation is very simple and likely needs to be expanded to better support\n *      standard use-cases.\n *\n * Tested with Backbone v0.9.2 and 1.0.0.\n */\n(function(){\n    \"use strict\";\n\n    // Regular expression to match an event name and/or a namespace.\n    var namespaceRE = /^([^.]+)?(?:\\.([^.]+))?$/;\n\n    var matchesSelector = Element.prototype.matchesSelector || null;\n    if (!matchesSelector){\n        ['webkit', 'moz', 'o', 'ms'].forEach(function(prefix){\n            var func = Element.prototype[prefix + 'MatchesSelector'];\n            if (func) matchesSelector = func;\n        });\n    }\n\n    // The element property to save the cache key on.\n    var cacheKeyProp = 'backboneNativeKey' + Math.random();\n    var id = 1;\n    var handlers = {};\n    var unusedKeys = [];\n\n    /**\n     * Get the event handlers for a given element, creating an empty set if one doesn't exist.\n     *\n     * To avoid constantly filling the handlers object with null values, we reuse old IDs that\n     * have been created and then cleared.\n     *\n     * @param {Element} el The element to get handlers for.\n     *\n     * @return {Array} An array of handlers.\n     */\n    function handlersFor(el){\n        if (!el[cacheKeyProp]){\n            // Pick a new key, from the unused pool, or make a new one.\n            el[cacheKeyProp] = unusedKeys.length === 0 ? ++id : unusedKeys.pop();\n        }\n\n        var cacheKey = el[cacheKeyProp];\n        return handlers[cacheKey] || (handlers[cacheKey] = []);\n    }\n\n    /**\n     * Clear the event handlers for a given element.\n     *\n     * @param {Element} el The element to clear.\n     */\n    function clearHandlers(el){\n        var cacheKey = el[cacheKeyProp];\n        if (handlers[cacheKey]){\n            handlers[cacheKey] = null;\n            el[cacheKeyProp] = null;\n            unusedKeys.push(cacheKey);\n        }\n    }\n\n    /**\n     * Add event handlers to an element.\n     *\n     * @param {Element} parentElement The element to bind event handlers to.\n     * @param {string} eventName The event to bind, e.g. 'click'.\n     * @param {string} selector (Optional) The selector to match when an event propagates up.\n     * @param {function(Event, Element)} callback The function to call when the event is fired.\n     */\n    function on(parentElement, eventName, selector, callback){\n        // Adjust arguments if selector was not provided.\n        if (typeof selector === 'function'){\n            callback = selector;\n            selector = null;\n        }\n\n        var parts = namespaceRE.exec(eventName);\n        eventName = parts[1] || null;\n        var namespace = parts[2] || null;\n\n        if (!eventName) return;\n\n        var handler = callback;\n        var originalCallback = callback;\n        if (selector){\n            // Event delegation handler to match a selector for child element events.\n            handler = function(event){\n                for (var el = event.target; el && el !== parentElement; el = el.parentElement){\n                    if (matchesSelector.call(el, selector)){\n                        // jQuery does not include the second argument, but we have included it\n                        // for simplicity because 'this' will likely be bound to the view inside\n                        // the callback, and as noted above, we cannot override 'currentTarget'.\n                        var result = originalCallback.call(el, event, el);\n                        if (result === false){\n                            event.stopPropagation();\n                            event.preventDefault();\n                        }\n                        return result;\n                    }\n                }\n            };\n        } else {\n            // Standard event handler bound directly to the element.\n            handler = function(event){\n                var result = originalCallback.call(parentElement, event, parentElement);\n                if (result === false){\n                    event.stopPropagation();\n                    event.preventDefault();\n                }\n                return result;\n            };\n        }\n\n        parentElement.addEventListener(eventName, handler, false);\n\n        // Save event handler metadata so that the handler can be unbound later.\n        handlersFor(parentElement).push({\n            eventName: eventName,\n            callback: callback,\n            handler: handler,\n            namespace: namespace,\n            selector: selector\n        });\n    }\n\n    /**\n     * Remove an event handler from an element.\n     *\n     * @param {Element} parentElement The element to unbind event handlers from.\n     * @param {string} eventName (Optional) The event to unbind, e.g. 'click'.\n     * @param {string} selector (Optional) The selector to unbind.\n     * @param {function(Event, Element)} callback (Optional) The function to unbind.\n     */\n    function off(parentElement, eventName, selector, callback){\n        if (typeof selector === 'function'){\n            callback = selector;\n            selector = null;\n        }\n\n        var parts = namespaceRE.exec(eventName || '');\n        eventName = parts[1];\n        var namespace = parts[2];\n        var handlers = handlersFor(parentElement) || [];\n\n        if (!eventName && !namespace && !selector && !callback){\n            // Fastpath to remove all handlers.\n            handlers.forEach(function(item){\n                parentElement.removeEventListener(item.eventName, item.handler, false);\n            });\n            clearHandlers(parentElement);\n        } else {\n            var matchedHandlers = handlers.filter(function(item){\n                return ((!namespace || item.namespace === namespace) &&\n                    (!eventName || item.eventName === eventName) &&\n                    (!callback || item.callback === callback) &&\n                    (!selector || item.selector === selector));\n            });\n\n            matchedHandlers.forEach(function(item){\n                parentElement.removeEventListener(item.eventName, item.handler, false);\n\n                handlers.splice(handlers.indexOf(item), 1);\n            });\n\n            if (handlers.length === 0) clearHandlers(parentElement);\n        }\n    }\n\n    /**\n     * Construct a new jQuery-style element representation.\n     *\n     * @param {string|Element|Window} element There are several different possible values for this\n     *      argument:\n     *      - {string} A snippet of HTML, if it starts with a '<', or a selector to find.\n     *      - {Element} An existing element to wrap.\n     *      - {Window} The window object to wrap.\n     * @param {Element} context The context to search within, if a selector was given.\n     *      Defaults to document.\n     */\n    function $(element, context){\n        context = context || document;\n\n        // Call as a constructor if it was used as a function.\n        if (!(this instanceof $)) return new $(element, context);\n\n        if (!element){\n            this.length = 0;\n        } else if (typeof element === 'string'){\n            if (/^\\s*</.test(element)){\n                // Parse arbitrary HTML into an element.\n                var div = document.createElement('div');\n                div.innerHTML = element;\n                this[0] = div.firstChild;\n                div.removeChild(div.firstChild);\n                this.length = 1;\n            } else {\n                this[0] = context.querySelector(element);\n                this.length = 1;\n            }\n        } else {\n            // This handles both the 'Element' and 'Window' case, as both support\n            // event binding via 'addEventListener'.\n            this[0] = element;\n            this.length = 1;\n        }\n    }\n\n    $.prototype = {\n        /**\n         * The following methods are used by Backbone, but only in code-paths for IE 6/7 support.\n         * Since none of this will work for old IE anyway, they are not implemented, and\n         * instead left for documentation purposes.\n         *\n         * Used in Backbone.History.prototype.start.\n         */\n        hide: null,\n        appendTo: null,\n\n        /**\n         * Find is not supported to encourage the use of querySelector(All) as an alternative.\n         *\n         * e.g.\n         * Instead of 'this.$(sel)', use 'this.el.querySelectorAll(sel)'.\n         *\n         * Used in Backbone.View.prototype.$, but not actually called internally.\n         */\n        find: null,\n\n        /**\n         * Add attributes to the element.\n         *\n         * Used in Backbone.View.prototype.make.\n         *\n         * @param {Object} attributes A set of attributes to apply to the element.\n         *\n         * @return {$} This instance.\n         */\n        attr: function(attrs){\n            Object.keys(attrs).forEach(function(attr){\n                switch (attr){\n                    case 'html':\n                        this[0].innerHTML = attrs[attr];\n                        break;\n                    case 'text':\n                        this[0].textContent = attrs[attr];\n                        break;\n                    case 'class':\n                        this[0].className = attrs[attr];\n                        break;\n                    default:\n                        this[0].setAttribute(attr, attrs[attr]);\n                        break;\n                }\n            }, this);\n            return this;\n        },\n\n        /**\n         * Set the HTML content of the element. Backbone does not use the no-argument version\n         * to read innerHTML, so that has not been implemented.\n         *\n         * Used in Backbone.View.prototype.make.\n         *\n         * @param {string} html The HTML to set as the element content.\n         *\n         * @return {$} This instance.\n         */\n        html: function(html){\n            this[0].innerHTML = html;\n            return this;\n        },\n\n        /**\n         * Remove an element from the DOM and remove all event handlers bound to it and\n         * its child elements.\n         *\n         * Used in Backbone.View.prototype.remove.\n         *\n         * @return {$} This instance.\n         */\n        remove: function(){\n            var el = this[0];\n            if (el.parentElement) el.parentElement.removeChild(el);\n\n            // Unbind all event handlers on the element and children.\n            (function removeChildEvents(element){\n                off(element);\n\n                for (var i = 0, len = element.childNodes.length; i < len; i++){\n                    if (element.childNodes[i].nodeType !== Node.TEXT_NODE){\n                        removeChildEvents(element.childNodes[i]);\n                    }\n                }\n            })(el);\n\n            return this;\n        },\n\n        /**\n         * Bind an event handler to this element.\n         *\n         * @param {string} eventName The event to bind, e.g. 'click'.\n         * @param {string} selector (Optional) The selector to match when an event propagates up.\n         * @param {function(Event, Element)} callback The function to call when the event is fired.\n         */\n        on: function(eventName, selector, callback){\n            on(this[0], eventName, selector, callback);\n            return this;\n        },\n\n        /**\n         * Unbind an event handler to this element.\n         *\n         * @param {string} eventName (Optional) The event to unbind, e.g. 'click'.\n         * @param {string} selector (Optional) The selector to unbind.\n         * @param {function(Event, Element)} callback (Optional) The function to unbind.\n         */\n        off: function(eventName, selector, callback){\n            off(this[0], eventName, selector, callback);\n            return this;\n        },\n\n        // Backbone v0.9.2 support.\n        bind: function(eventName, callback){\n            return this.on(eventName, callback);\n        },\n        unbind: function(eventName, callback){\n            return this.off(eventName, callback);\n        },\n        delegate: function(selector, eventName, callback){\n            return this.on(eventName, selector, callback);\n        },\n        undelegate: function(selector, eventName, callback){\n            return this.off(eventName, selector, callback);\n        }\n    };\n\n    /**\n     * Send an AJAX request.\n     *\n     * @param {Object} options The options to use for the connection:\n     *      - {string} url The URL to connect to.\n     *      - {string} type The type of request, e.g. 'GET', or 'POST'.\n     *      - {string} dataType The type of data expected, 'json'.\n     *      - {string} contentType The content-type of the data.\n     *      - {string|object} data The content to send.\n     *      - {function(XMLHttpRequest)} beforeSend A callback to call before sending.\n     *      - {boolean} processData True if 'data' should be converted\n     *          to a query string from an object.\n     *      - {function({string|object}, {string}, {XMLHttpRequest})} success The success callback.\n     *      - {function({XMLHttpRequest})} error The error callback.\n     */\n    $.ajax = function(options){\n        options = options || {};\n        var type = options.type || 'GET';\n        var url = options.url;\n        var processData = options.processData === undefined ? true : !!options.processData;\n\n        // Process the data for sending.\n        var data = options.data;\n        if (processData && typeof data === 'object'){\n            var params = Object.keys(data).map(function(prop){\n                return encodeURIComponent(prop) + '=' + encodeURIComponent(data[prop]);\n            });\n            data = params.join('&');\n        }\n\n        // Data for GET and HEAD goes in the URL.\n        if (data && (type === 'GET' || type === 'HEAD')){\n            url += (url.indexOf('?') === -1 ? '?' : '&') + data;\n            data = undefined;\n        }\n\n        var xhr = new XMLHttpRequest();\n        xhr.open(type, url, true);\n\n        if (options.contentType) xhr.setRequestHeader('Content-Type', options.contentType);\n        if (options.beforeSend) options.beforeSend(xhr);\n\n        xhr.onload = function(){\n            var error = false;\n            var content = xhr.responseText;\n\n            // Parse the JSON before calling success.\n            if (options.dataType === 'json'){\n                try {\n                    content = JSON.parse(content);\n                } catch (e){\n                    error = true\n                }\n            }\n\n            if (!error && (xhr.status >= 200 && xhr.status < 300)){\n                // The last two arguments only apply to v0.9.2.\n                if (options.success) options.success(content, xhr.statusText, xhr);\n            } else {\n                // This signature is inconsistent with v0.9.2, but is correct for 1.0.0.\n                if (options.error) options.error(xhr);\n            }\n        }.bind(this);\n\n        xhr.onerror = xhr.onabort = function(){\n            if (options.error) options.error(xhr);\n        };\n\n        xhr.send(data);\n\n        return xhr;\n    };\n\n    // Expose on/off for external use with having to instantiate a wrapper.\n    $.on = on;\n    $.off = off;\n\n    if(typeof exports !== 'undefined') {\n      return module.exports = $;\n    }\n\n    var root = this;\n    var originalBackboneNative = root.Backbone ? root.Backbone.Native : null;\n    var original$ = root.$;\n    if (root.Backbone) root.Backbone.Native = $;\n    root.$ = $;\n\n    $.noConflict = function(deep){\n        root.$ = original$;\n        if (deep) root.Backbone.Native = originalBackboneNative;\n        return $;\n    };\n\n    if (root.Backbone){\n        if (root.Backbone.setDomLibrary){ // v0.9.2\n            root.Backbone.setDomLibrary($);\n        } else { // v1.0.0\n            root.Backbone.$ = $;\n        }\n    }\n}).call(this);\n",
    "//     Backbone.js 1.1.2\n\n//     (c) 2010-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n//     Backbone may be freely distributed under the MIT license.\n//     For all details and documentation:\n//     http://backbonejs.org\n\n(function(root, factory) {\n\n  // Set up Backbone appropriately for the environment. Start with AMD.\n  if (typeof define === 'function' && define.amd) {\n    define(['underscore', 'jquery', 'exports'], function(_, $, exports) {\n      // Export global even in AMD case in case this script is loaded with\n      // others that may still expect a global Backbone.\n      root.Backbone = factory(root, exports, _, $);\n    });\n\n  // Next for Node.js or CommonJS. jQuery may not be needed as a module.\n  } else if (typeof exports !== 'undefined') {\n    var _ = require('underscore');\n    factory(root, exports, _);\n\n  // Finally, as a browser global.\n  } else {\n    root.Backbone = factory(root, {}, root._, (root.jQuery || root.Zepto || root.ender || root.$));\n  }\n\n}(this, function(root, Backbone, _, $) {\n\n  // Initial Setup\n  // -------------\n\n  // Save the previous value of the `Backbone` variable, so that it can be\n  // restored later on, if `noConflict` is used.\n  var previousBackbone = root.Backbone;\n\n  // Create local references to array methods we'll want to use later.\n  var array = [];\n  var push = array.push;\n  var slice = array.slice;\n  var splice = array.splice;\n\n  // Current version of the library. Keep in sync with `package.json`.\n  Backbone.VERSION = '1.1.2';\n\n  // For Backbone's purposes, jQuery, Zepto, Ender, or My Library (kidding) owns\n  // the `$` variable.\n  Backbone.$ = $;\n\n  // Runs Backbone.js in *noConflict* mode, returning the `Backbone` variable\n  // to its previous owner. Returns a reference to this Backbone object.\n  Backbone.noConflict = function() {\n    root.Backbone = previousBackbone;\n    return this;\n  };\n\n  // Turn on `emulateHTTP` to support legacy HTTP servers. Setting this option\n  // will fake `\"PATCH\"`, `\"PUT\"` and `\"DELETE\"` requests via the `_method` parameter and\n  // set a `X-Http-Method-Override` header.\n  Backbone.emulateHTTP = false;\n\n  // Turn on `emulateJSON` to support legacy servers that can't deal with direct\n  // `application/json` requests ... will encode the body as\n  // `application/x-www-form-urlencoded` instead and will send the model in a\n  // form param named `model`.\n  Backbone.emulateJSON = false;\n\n  // Backbone.Events\n  // ---------------\n\n  // A module that can be mixed in to *any object* in order to provide it with\n  // custom events. You may bind with `on` or remove with `off` callback\n  // functions to an event; `trigger`-ing an event fires all callbacks in\n  // succession.\n  //\n  //     var object = {};\n  //     _.extend(object, Backbone.Events);\n  //     object.on('expand', function(){ alert('expanded'); });\n  //     object.trigger('expand');\n  //\n  var Events = Backbone.Events = {\n\n    // Bind an event to a `callback` function. Passing `\"all\"` will bind\n    // the callback to all events fired.\n    on: function(name, callback, context) {\n      if (!eventsApi(this, 'on', name, [callback, context]) || !callback) return this;\n      this._events || (this._events = {});\n      var events = this._events[name] || (this._events[name] = []);\n      events.push({callback: callback, context: context, ctx: context || this});\n      return this;\n    },\n\n    // Bind an event to only be triggered a single time. After the first time\n    // the callback is invoked, it will be removed.\n    once: function(name, callback, context) {\n      if (!eventsApi(this, 'once', name, [callback, context]) || !callback) return this;\n      var self = this;\n      var once = _.once(function() {\n        self.off(name, once);\n        callback.apply(this, arguments);\n      });\n      once._callback = callback;\n      return this.on(name, once, context);\n    },\n\n    // Remove one or many callbacks. If `context` is null, removes all\n    // callbacks with that function. If `callback` is null, removes all\n    // callbacks for the event. If `name` is null, removes all bound\n    // callbacks for all events.\n    off: function(name, callback, context) {\n      var retain, ev, events, names, i, l, j, k;\n      if (!this._events || !eventsApi(this, 'off', name, [callback, context])) return this;\n      if (!name && !callback && !context) {\n        this._events = void 0;\n        return this;\n      }\n      names = name ? [name] : _.keys(this._events);\n      for (i = 0, l = names.length; i < l; i++) {\n        name = names[i];\n        if (events = this._events[name]) {\n          this._events[name] = retain = [];\n          if (callback || context) {\n            for (j = 0, k = events.length; j < k; j++) {\n              ev = events[j];\n              if ((callback && callback !== ev.callback && callback !== ev.callback._callback) ||\n                  (context && context !== ev.context)) {\n                retain.push(ev);\n              }\n            }\n          }\n          if (!retain.length) delete this._events[name];\n        }\n      }\n\n      return this;\n    },\n\n    // Trigger one or many events, firing all bound callbacks. Callbacks are\n    // passed the same arguments as `trigger` is, apart from the event name\n    // (unless you're listening on `\"all\"`, which will cause your callback to\n    // receive the true name of the event as the first argument).\n    trigger: function(name) {\n      if (!this._events) return this;\n      var args = slice.call(arguments, 1);\n      if (!eventsApi(this, 'trigger', name, args)) return this;\n      var events = this._events[name];\n      var allEvents = this._events.all;\n      if (events) triggerEvents(events, args);\n      if (allEvents) triggerEvents(allEvents, arguments);\n      return this;\n    },\n\n    // Tell this object to stop listening to either specific events ... or\n    // to every object it's currently listening to.\n    stopListening: function(obj, name, callback) {\n      var listeningTo = this._listeningTo;\n      if (!listeningTo) return this;\n      var remove = !name && !callback;\n      if (!callback && typeof name === 'object') callback = this;\n      if (obj) (listeningTo = {})[obj._listenId] = obj;\n      for (var id in listeningTo) {\n        obj = listeningTo[id];\n        obj.off(name, callback, this);\n        if (remove || _.isEmpty(obj._events)) delete this._listeningTo[id];\n      }\n      return this;\n    }\n\n  };\n\n  // Regular expression used to split event strings.\n  var eventSplitter = /\\s+/;\n\n  // Implement fancy features of the Events API such as multiple event\n  // names `\"change blur\"` and jQuery-style event maps `{change: action}`\n  // in terms of the existing API.\n  var eventsApi = function(obj, action, name, rest) {\n    if (!name) return true;\n\n    // Handle event maps.\n    if (typeof name === 'object') {\n      for (var key in name) {\n        obj[action].apply(obj, [key, name[key]].concat(rest));\n      }\n      return false;\n    }\n\n    // Handle space separated event names.\n    if (eventSplitter.test(name)) {\n      var names = name.split(eventSplitter);\n      for (var i = 0, l = names.length; i < l; i++) {\n        obj[action].apply(obj, [names[i]].concat(rest));\n      }\n      return false;\n    }\n\n    return true;\n  };\n\n  // A difficult-to-believe, but optimized internal dispatch function for\n  // triggering events. Tries to keep the usual cases speedy (most internal\n  // Backbone events have 3 arguments).\n  var triggerEvents = function(events, args) {\n    var ev, i = -1, l = events.length, a1 = args[0], a2 = args[1], a3 = args[2];\n    switch (args.length) {\n      case 0: while (++i < l) (ev = events[i]).callback.call(ev.ctx); return;\n      case 1: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1); return;\n      case 2: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2); return;\n      case 3: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2, a3); return;\n      default: while (++i < l) (ev = events[i]).callback.apply(ev.ctx, args); return;\n    }\n  };\n\n  var listenMethods = {listenTo: 'on', listenToOnce: 'once'};\n\n  // Inversion-of-control versions of `on` and `once`. Tell *this* object to\n  // listen to an event in another object ... keeping track of what it's\n  // listening to.\n  _.each(listenMethods, function(implementation, method) {\n    Events[method] = function(obj, name, callback) {\n      var listeningTo = this._listeningTo || (this._listeningTo = {});\n      var id = obj._listenId || (obj._listenId = _.uniqueId('l'));\n      listeningTo[id] = obj;\n      if (!callback && typeof name === 'object') callback = this;\n      obj[implementation](name, callback, this);\n      return this;\n    };\n  });\n\n  // Aliases for backwards compatibility.\n  Events.bind   = Events.on;\n  Events.unbind = Events.off;\n\n  // Allow the `Backbone` object to serve as a global event bus, for folks who\n  // want global \"pubsub\" in a convenient place.\n  _.extend(Backbone, Events);\n\n  // Backbone.Model\n  // --------------\n\n  // Backbone **Models** are the basic data object in the framework --\n  // frequently representing a row in a table in a database on your server.\n  // A discrete chunk of data and a bunch of useful, related methods for\n  // performing computations and transformations on that data.\n\n  // Create a new model with the specified attributes. A client id (`cid`)\n  // is automatically generated and assigned for you.\n  var Model = Backbone.Model = function(attributes, options) {\n    var attrs = attributes || {};\n    options || (options = {});\n    this.cid = _.uniqueId('c');\n    this.attributes = {};\n    if (options.collection) this.collection = options.collection;\n    if (options.parse) attrs = this.parse(attrs, options) || {};\n    attrs = _.defaults({}, attrs, _.result(this, 'defaults'));\n    this.set(attrs, options);\n    this.changed = {};\n    this.initialize.apply(this, arguments);\n  };\n\n  // Attach all inheritable methods to the Model prototype.\n  _.extend(Model.prototype, Events, {\n\n    // A hash of attributes whose current and previous value differ.\n    changed: null,\n\n    // The value returned during the last failed validation.\n    validationError: null,\n\n    // The default name for the JSON `id` attribute is `\"id\"`. MongoDB and\n    // CouchDB users may want to set this to `\"_id\"`.\n    idAttribute: 'id',\n\n    // Initialize is an empty function by default. Override it with your own\n    // initialization logic.\n    initialize: function(){},\n\n    // Return a copy of the model's `attributes` object.\n    toJSON: function(options) {\n      return _.clone(this.attributes);\n    },\n\n    // Proxy `Backbone.sync` by default -- but override this if you need\n    // custom syncing semantics for *this* particular model.\n    sync: function() {\n      return Backbone.sync.apply(this, arguments);\n    },\n\n    // Get the value of an attribute.\n    get: function(attr) {\n      return this.attributes[attr];\n    },\n\n    // Get the HTML-escaped value of an attribute.\n    escape: function(attr) {\n      return _.escape(this.get(attr));\n    },\n\n    // Returns `true` if the attribute contains a value that is not null\n    // or undefined.\n    has: function(attr) {\n      return this.get(attr) != null;\n    },\n\n    // Set a hash of model attributes on the object, firing `\"change\"`. This is\n    // the core primitive operation of a model, updating the data and notifying\n    // anyone who needs to know about the change in state. The heart of the beast.\n    set: function(key, val, options) {\n      var attr, attrs, unset, changes, silent, changing, prev, current;\n      if (key == null) return this;\n\n      // Handle both `\"key\", value` and `{key: value}` -style arguments.\n      if (typeof key === 'object') {\n        attrs = key;\n        options = val;\n      } else {\n        (attrs = {})[key] = val;\n      }\n\n      options || (options = {});\n\n      // Run validation.\n      if (!this._validate(attrs, options)) return false;\n\n      // Extract attributes and options.\n      unset           = options.unset;\n      silent          = options.silent;\n      changes         = [];\n      changing        = this._changing;\n      this._changing  = true;\n\n      if (!changing) {\n        this._previousAttributes = _.clone(this.attributes);\n        this.changed = {};\n      }\n      current = this.attributes, prev = this._previousAttributes;\n\n      // Check for changes of `id`.\n      if (this.idAttribute in attrs) this.id = attrs[this.idAttribute];\n\n      // For each `set` attribute, update or delete the current value.\n      for (attr in attrs) {\n        val = attrs[attr];\n        if (!_.isEqual(current[attr], val)) changes.push(attr);\n        if (!_.isEqual(prev[attr], val)) {\n          this.changed[attr] = val;\n        } else {\n          delete this.changed[attr];\n        }\n        unset ? delete current[attr] : current[attr] = val;\n      }\n\n      // Trigger all relevant attribute changes.\n      if (!silent) {\n        if (changes.length) this._pending = options;\n        for (var i = 0, l = changes.length; i < l; i++) {\n          this.trigger('change:' + changes[i], this, current[changes[i]], options);\n        }\n      }\n\n      // You might be wondering why there's a `while` loop here. Changes can\n      // be recursively nested within `\"change\"` events.\n      if (changing) return this;\n      if (!silent) {\n        while (this._pending) {\n          options = this._pending;\n          this._pending = false;\n          this.trigger('change', this, options);\n        }\n      }\n      this._pending = false;\n      this._changing = false;\n      return this;\n    },\n\n    // Remove an attribute from the model, firing `\"change\"`. `unset` is a noop\n    // if the attribute doesn't exist.\n    unset: function(attr, options) {\n      return this.set(attr, void 0, _.extend({}, options, {unset: true}));\n    },\n\n    // Clear all attributes on the model, firing `\"change\"`.\n    clear: function(options) {\n      var attrs = {};\n      for (var key in this.attributes) attrs[key] = void 0;\n      return this.set(attrs, _.extend({}, options, {unset: true}));\n    },\n\n    // Determine if the model has changed since the last `\"change\"` event.\n    // If you specify an attribute name, determine if that attribute has changed.\n    hasChanged: function(attr) {\n      if (attr == null) return !_.isEmpty(this.changed);\n      return _.has(this.changed, attr);\n    },\n\n    // Return an object containing all the attributes that have changed, or\n    // false if there are no changed attributes. Useful for determining what\n    // parts of a view need to be updated and/or what attributes need to be\n    // persisted to the server. Unset attributes will be set to undefined.\n    // You can also pass an attributes object to diff against the model,\n    // determining if there *would be* a change.\n    changedAttributes: function(diff) {\n      if (!diff) return this.hasChanged() ? _.clone(this.changed) : false;\n      var val, changed = false;\n      var old = this._changing ? this._previousAttributes : this.attributes;\n      for (var attr in diff) {\n        if (_.isEqual(old[attr], (val = diff[attr]))) continue;\n        (changed || (changed = {}))[attr] = val;\n      }\n      return changed;\n    },\n\n    // Get the previous value of an attribute, recorded at the time the last\n    // `\"change\"` event was fired.\n    previous: function(attr) {\n      if (attr == null || !this._previousAttributes) return null;\n      return this._previousAttributes[attr];\n    },\n\n    // Get all of the attributes of the model at the time of the previous\n    // `\"change\"` event.\n    previousAttributes: function() {\n      return _.clone(this._previousAttributes);\n    },\n\n    // Fetch the model from the server. If the server's representation of the\n    // model differs from its current attributes, they will be overridden,\n    // triggering a `\"change\"` event.\n    fetch: function(options) {\n      options = options ? _.clone(options) : {};\n      if (options.parse === void 0) options.parse = true;\n      var model = this;\n      var success = options.success;\n      options.success = function(resp) {\n        if (!model.set(model.parse(resp, options), options)) return false;\n        if (success) success(model, resp, options);\n        model.trigger('sync', model, resp, options);\n      };\n      wrapError(this, options);\n      return this.sync('read', this, options);\n    },\n\n    // Set a hash of model attributes, and sync the model to the server.\n    // If the server returns an attributes hash that differs, the model's\n    // state will be `set` again.\n    save: function(key, val, options) {\n      var attrs, method, xhr, attributes = this.attributes;\n\n      // Handle both `\"key\", value` and `{key: value}` -style arguments.\n      if (key == null || typeof key === 'object') {\n        attrs = key;\n        options = val;\n      } else {\n        (attrs = {})[key] = val;\n      }\n\n      options = _.extend({validate: true}, options);\n\n      // If we're not waiting and attributes exist, save acts as\n      // `set(attr).save(null, opts)` with validation. Otherwise, check if\n      // the model will be valid when the attributes, if any, are set.\n      if (attrs && !options.wait) {\n        if (!this.set(attrs, options)) return false;\n      } else {\n        if (!this._validate(attrs, options)) return false;\n      }\n\n      // Set temporary attributes if `{wait: true}`.\n      if (attrs && options.wait) {\n        this.attributes = _.extend({}, attributes, attrs);\n      }\n\n      // After a successful server-side save, the client is (optionally)\n      // updated with the server-side state.\n      if (options.parse === void 0) options.parse = true;\n      var model = this;\n      var success = options.success;\n      options.success = function(resp) {\n        // Ensure attributes are restored during synchronous saves.\n        model.attributes = attributes;\n        var serverAttrs = model.parse(resp, options);\n        if (options.wait) serverAttrs = _.extend(attrs || {}, serverAttrs);\n        if (_.isObject(serverAttrs) && !model.set(serverAttrs, options)) {\n          return false;\n        }\n        if (success) success(model, resp, options);\n        model.trigger('sync', model, resp, options);\n      };\n      wrapError(this, options);\n\n      method = this.isNew() ? 'create' : (options.patch ? 'patch' : 'update');\n      if (method === 'patch') options.attrs = attrs;\n      xhr = this.sync(method, this, options);\n\n      // Restore attributes.\n      if (attrs && options.wait) this.attributes = attributes;\n\n      return xhr;\n    },\n\n    // Destroy this model on the server if it was already persisted.\n    // Optimistically removes the model from its collection, if it has one.\n    // If `wait: true` is passed, waits for the server to respond before removal.\n    destroy: function(options) {\n      options = options ? _.clone(options) : {};\n      var model = this;\n      var success = options.success;\n\n      var destroy = function() {\n        model.trigger('destroy', model, model.collection, options);\n      };\n\n      options.success = function(resp) {\n        if (options.wait || model.isNew()) destroy();\n        if (success) success(model, resp, options);\n        if (!model.isNew()) model.trigger('sync', model, resp, options);\n      };\n\n      if (this.isNew()) {\n        options.success();\n        return false;\n      }\n      wrapError(this, options);\n\n      var xhr = this.sync('delete', this, options);\n      if (!options.wait) destroy();\n      return xhr;\n    },\n\n    // Default URL for the model's representation on the server -- if you're\n    // using Backbone's restful methods, override this to change the endpoint\n    // that will be called.\n    url: function() {\n      var base =\n        _.result(this, 'urlRoot') ||\n        _.result(this.collection, 'url') ||\n        urlError();\n      if (this.isNew()) return base;\n      return base.replace(/([^\\/])$/, '$1/') + encodeURIComponent(this.id);\n    },\n\n    // **parse** converts a response into the hash of attributes to be `set` on\n    // the model. The default implementation is just to pass the response along.\n    parse: function(resp, options) {\n      return resp;\n    },\n\n    // Create a new model with identical attributes to this one.\n    clone: function() {\n      return new this.constructor(this.attributes);\n    },\n\n    // A model is new if it has never been saved to the server, and lacks an id.\n    isNew: function() {\n      return !this.has(this.idAttribute);\n    },\n\n    // Check if the model is currently in a valid state.\n    isValid: function(options) {\n      return this._validate({}, _.extend(options || {}, { validate: true }));\n    },\n\n    // Run validation against the next complete set of model attributes,\n    // returning `true` if all is well. Otherwise, fire an `\"invalid\"` event.\n    _validate: function(attrs, options) {\n      if (!options.validate || !this.validate) return true;\n      attrs = _.extend({}, this.attributes, attrs);\n      var error = this.validationError = this.validate(attrs, options) || null;\n      if (!error) return true;\n      this.trigger('invalid', this, error, _.extend(options, {validationError: error}));\n      return false;\n    }\n\n  });\n\n  // Underscore methods that we want to implement on the Model.\n  var modelMethods = ['keys', 'values', 'pairs', 'invert', 'pick', 'omit'];\n\n  // Mix in each Underscore method as a proxy to `Model#attributes`.\n  _.each(modelMethods, function(method) {\n    Model.prototype[method] = function() {\n      var args = slice.call(arguments);\n      args.unshift(this.attributes);\n      return _[method].apply(_, args);\n    };\n  });\n\n  // Backbone.Collection\n  // -------------------\n\n  // If models tend to represent a single row of data, a Backbone Collection is\n  // more analagous to a table full of data ... or a small slice or page of that\n  // table, or a collection of rows that belong together for a particular reason\n  // -- all of the messages in this particular folder, all of the documents\n  // belonging to this particular author, and so on. Collections maintain\n  // indexes of their models, both in order, and for lookup by `id`.\n\n  // Create a new **Collection**, perhaps to contain a specific type of `model`.\n  // If a `comparator` is specified, the Collection will maintain\n  // its models in sort order, as they're added and removed.\n  var Collection = Backbone.Collection = function(models, options) {\n    options || (options = {});\n    if (options.model) this.model = options.model;\n    if (options.comparator !== void 0) this.comparator = options.comparator;\n    this._reset();\n    this.initialize.apply(this, arguments);\n    if (models) this.reset(models, _.extend({silent: true}, options));\n  };\n\n  // Default options for `Collection#set`.\n  var setOptions = {add: true, remove: true, merge: true};\n  var addOptions = {add: true, remove: false};\n\n  // Define the Collection's inheritable methods.\n  _.extend(Collection.prototype, Events, {\n\n    // The default model for a collection is just a **Backbone.Model**.\n    // This should be overridden in most cases.\n    model: Model,\n\n    // Initialize is an empty function by default. Override it with your own\n    // initialization logic.\n    initialize: function(){},\n\n    // The JSON representation of a Collection is an array of the\n    // models' attributes.\n    toJSON: function(options) {\n      return this.map(function(model){ return model.toJSON(options); });\n    },\n\n    // Proxy `Backbone.sync` by default.\n    sync: function() {\n      return Backbone.sync.apply(this, arguments);\n    },\n\n    // Add a model, or list of models to the set.\n    add: function(models, options) {\n      return this.set(models, _.extend({merge: false}, options, addOptions));\n    },\n\n    // Remove a model, or a list of models from the set.\n    remove: function(models, options) {\n      var singular = !_.isArray(models);\n      models = singular ? [models] : _.clone(models);\n      options || (options = {});\n      var i, l, index, model;\n      for (i = 0, l = models.length; i < l; i++) {\n        model = models[i] = this.get(models[i]);\n        if (!model) continue;\n        delete this._byId[model.id];\n        delete this._byId[model.cid];\n        index = this.indexOf(model);\n        this.models.splice(index, 1);\n        this.length--;\n        if (!options.silent) {\n          options.index = index;\n          model.trigger('remove', model, this, options);\n        }\n        this._removeReference(model, options);\n      }\n      return singular ? models[0] : models;\n    },\n\n    // Update a collection by `set`-ing a new list of models, adding new ones,\n    // removing models that are no longer present, and merging models that\n    // already exist in the collection, as necessary. Similar to **Model#set**,\n    // the core operation for updating the data contained by the collection.\n    set: function(models, options) {\n      options = _.defaults({}, options, setOptions);\n      if (options.parse) models = this.parse(models, options);\n      var singular = !_.isArray(models);\n      models = singular ? (models ? [models] : []) : _.clone(models);\n      var i, l, id, model, attrs, existing, sort;\n      var at = options.at;\n      var targetModel = this.model;\n      var sortable = this.comparator && (at == null) && options.sort !== false;\n      var sortAttr = _.isString(this.comparator) ? this.comparator : null;\n      var toAdd = [], toRemove = [], modelMap = {};\n      var add = options.add, merge = options.merge, remove = options.remove;\n      var order = !sortable && add && remove ? [] : false;\n\n      // Turn bare objects into model references, and prevent invalid models\n      // from being added.\n      for (i = 0, l = models.length; i < l; i++) {\n        attrs = models[i] || {};\n        if (attrs instanceof Model) {\n          id = model = attrs;\n        } else {\n          id = attrs[targetModel.prototype.idAttribute || 'id'];\n        }\n\n        // If a duplicate is found, prevent it from being added and\n        // optionally merge it into the existing model.\n        if (existing = this.get(id)) {\n          if (remove) modelMap[existing.cid] = true;\n          if (merge) {\n            attrs = attrs === model ? model.attributes : attrs;\n            if (options.parse) attrs = existing.parse(attrs, options);\n            existing.set(attrs, options);\n            if (sortable && !sort && existing.hasChanged(sortAttr)) sort = true;\n          }\n          models[i] = existing;\n\n        // If this is a new, valid model, push it to the `toAdd` list.\n        } else if (add) {\n          model = models[i] = this._prepareModel(attrs, options);\n          if (!model) continue;\n          toAdd.push(model);\n          this._addReference(model, options);\n        }\n\n        // Do not add multiple models with the same `id`.\n        model = existing || model;\n        if (order && (model.isNew() || !modelMap[model.id])) order.push(model);\n        modelMap[model.id] = true;\n      }\n\n      // Remove nonexistent models if appropriate.\n      if (remove) {\n        for (i = 0, l = this.length; i < l; ++i) {\n          if (!modelMap[(model = this.models[i]).cid]) toRemove.push(model);\n        }\n        if (toRemove.length) this.remove(toRemove, options);\n      }\n\n      // See if sorting is needed, update `length` and splice in new models.\n      if (toAdd.length || (order && order.length)) {\n        if (sortable) sort = true;\n        this.length += toAdd.length;\n        if (at != null) {\n          for (i = 0, l = toAdd.length; i < l; i++) {\n            this.models.splice(at + i, 0, toAdd[i]);\n          }\n        } else {\n          if (order) this.models.length = 0;\n          var orderedModels = order || toAdd;\n          for (i = 0, l = orderedModels.length; i < l; i++) {\n            this.models.push(orderedModels[i]);\n          }\n        }\n      }\n\n      // Silently sort the collection if appropriate.\n      if (sort) this.sort({silent: true});\n\n      // Unless silenced, it's time to fire all appropriate add/sort events.\n      if (!options.silent) {\n        for (i = 0, l = toAdd.length; i < l; i++) {\n          (model = toAdd[i]).trigger('add', model, this, options);\n        }\n        if (sort || (order && order.length)) this.trigger('sort', this, options);\n      }\n\n      // Return the added (or merged) model (or models).\n      return singular ? models[0] : models;\n    },\n\n    // When you have more items than you want to add or remove individually,\n    // you can reset the entire set with a new list of models, without firing\n    // any granular `add` or `remove` events. Fires `reset` when finished.\n    // Useful for bulk operations and optimizations.\n    reset: function(models, options) {\n      options || (options = {});\n      for (var i = 0, l = this.models.length; i < l; i++) {\n        this._removeReference(this.models[i], options);\n      }\n      options.previousModels = this.models;\n      this._reset();\n      models = this.add(models, _.extend({silent: true}, options));\n      if (!options.silent) this.trigger('reset', this, options);\n      return models;\n    },\n\n    // Add a model to the end of the collection.\n    push: function(model, options) {\n      return this.add(model, _.extend({at: this.length}, options));\n    },\n\n    // Remove a model from the end of the collection.\n    pop: function(options) {\n      var model = this.at(this.length - 1);\n      this.remove(model, options);\n      return model;\n    },\n\n    // Add a model to the beginning of the collection.\n    unshift: function(model, options) {\n      return this.add(model, _.extend({at: 0}, options));\n    },\n\n    // Remove a model from the beginning of the collection.\n    shift: function(options) {\n      var model = this.at(0);\n      this.remove(model, options);\n      return model;\n    },\n\n    // Slice out a sub-array of models from the collection.\n    slice: function() {\n      return slice.apply(this.models, arguments);\n    },\n\n    // Get a model from the set by id.\n    get: function(obj) {\n      if (obj == null) return void 0;\n      return this._byId[obj] || this._byId[obj.id] || this._byId[obj.cid];\n    },\n\n    // Get the model at the given index.\n    at: function(index) {\n      return this.models[index];\n    },\n\n    // Return models with matching attributes. Useful for simple cases of\n    // `filter`.\n    where: function(attrs, first) {\n      if (_.isEmpty(attrs)) return first ? void 0 : [];\n      return this[first ? 'find' : 'filter'](function(model) {\n        for (var key in attrs) {\n          if (attrs[key] !== model.get(key)) return false;\n        }\n        return true;\n      });\n    },\n\n    // Return the first model with matching attributes. Useful for simple cases\n    // of `find`.\n    findWhere: function(attrs) {\n      return this.where(attrs, true);\n    },\n\n    // Force the collection to re-sort itself. You don't need to call this under\n    // normal circumstances, as the set will maintain sort order as each item\n    // is added.\n    sort: function(options) {\n      if (!this.comparator) throw new Error('Cannot sort a set without a comparator');\n      options || (options = {});\n\n      // Run sort based on type of `comparator`.\n      if (_.isString(this.comparator) || this.comparator.length === 1) {\n        this.models = this.sortBy(this.comparator, this);\n      } else {\n        this.models.sort(_.bind(this.comparator, this));\n      }\n\n      if (!options.silent) this.trigger('sort', this, options);\n      return this;\n    },\n\n    // Pluck an attribute from each model in the collection.\n    pluck: function(attr) {\n      return _.invoke(this.models, 'get', attr);\n    },\n\n    // Fetch the default set of models for this collection, resetting the\n    // collection when they arrive. If `reset: true` is passed, the response\n    // data will be passed through the `reset` method instead of `set`.\n    fetch: function(options) {\n      options = options ? _.clone(options) : {};\n      if (options.parse === void 0) options.parse = true;\n      var success = options.success;\n      var collection = this;\n      options.success = function(resp) {\n        var method = options.reset ? 'reset' : 'set';\n        collection[method](resp, options);\n        if (success) success(collection, resp, options);\n        collection.trigger('sync', collection, resp, options);\n      };\n      wrapError(this, options);\n      return this.sync('read', this, options);\n    },\n\n    // Create a new instance of a model in this collection. Add the model to the\n    // collection immediately, unless `wait: true` is passed, in which case we\n    // wait for the server to agree.\n    create: function(model, options) {\n      options = options ? _.clone(options) : {};\n      if (!(model = this._prepareModel(model, options))) return false;\n      if (!options.wait) this.add(model, options);\n      var collection = this;\n      var success = options.success;\n      options.success = function(model, resp) {\n        if (options.wait) collection.add(model, options);\n        if (success) success(model, resp, options);\n      };\n      model.save(null, options);\n      return model;\n    },\n\n    // **parse** converts a response into a list of models to be added to the\n    // collection. The default implementation is just to pass it through.\n    parse: function(resp, options) {\n      return resp;\n    },\n\n    // Create a new collection with an identical list of models as this one.\n    clone: function() {\n      return new this.constructor(this.models);\n    },\n\n    // Private method to reset all internal state. Called when the collection\n    // is first initialized or reset.\n    _reset: function() {\n      this.length = 0;\n      this.models = [];\n      this._byId  = {};\n    },\n\n    // Prepare a hash of attributes (or other model) to be added to this\n    // collection.\n    _prepareModel: function(attrs, options) {\n      if (attrs instanceof Model) return attrs;\n      options = options ? _.clone(options) : {};\n      options.collection = this;\n      var model = new this.model(attrs, options);\n      if (!model.validationError) return model;\n      this.trigger('invalid', this, model.validationError, options);\n      return false;\n    },\n\n    // Internal method to create a model's ties to a collection.\n    _addReference: function(model, options) {\n      this._byId[model.cid] = model;\n      if (model.id != null) this._byId[model.id] = model;\n      if (!model.collection) model.collection = this;\n      model.on('all', this._onModelEvent, this);\n    },\n\n    // Internal method to sever a model's ties to a collection.\n    _removeReference: function(model, options) {\n      if (this === model.collection) delete model.collection;\n      model.off('all', this._onModelEvent, this);\n    },\n\n    // Internal method called every time a model in the set fires an event.\n    // Sets need to update their indexes when models change ids. All other\n    // events simply proxy through. \"add\" and \"remove\" events that originate\n    // in other collections are ignored.\n    _onModelEvent: function(event, model, collection, options) {\n      if ((event === 'add' || event === 'remove') && collection !== this) return;\n      if (event === 'destroy') this.remove(model, options);\n      if (model && event === 'change:' + model.idAttribute) {\n        delete this._byId[model.previous(model.idAttribute)];\n        if (model.id != null) this._byId[model.id] = model;\n      }\n      this.trigger.apply(this, arguments);\n    }\n\n  });\n\n  // Underscore methods that we want to implement on the Collection.\n  // 90% of the core usefulness of Backbone Collections is actually implemented\n  // right here:\n  var methods = ['forEach', 'each', 'map', 'collect', 'reduce', 'foldl',\n    'inject', 'reduceRight', 'foldr', 'find', 'detect', 'filter', 'select',\n    'reject', 'every', 'all', 'some', 'any', 'include', 'contains', 'invoke',\n    'max', 'min', 'toArray', 'size', 'first', 'head', 'take', 'initial', 'rest',\n    'tail', 'drop', 'last', 'without', 'difference', 'indexOf', 'shuffle',\n    'lastIndexOf', 'isEmpty', 'chain', 'sample'];\n\n  // Mix in each Underscore method as a proxy to `Collection#models`.\n  _.each(methods, function(method) {\n    Collection.prototype[method] = function() {\n      var args = slice.call(arguments);\n      args.unshift(this.models);\n      return _[method].apply(_, args);\n    };\n  });\n\n  // Underscore methods that take a property name as an argument.\n  var attributeMethods = ['groupBy', 'countBy', 'sortBy', 'indexBy'];\n\n  // Use attributes instead of properties.\n  _.each(attributeMethods, function(method) {\n    Collection.prototype[method] = function(value, context) {\n      var iterator = _.isFunction(value) ? value : function(model) {\n        return model.get(value);\n      };\n      return _[method](this.models, iterator, context);\n    };\n  });\n\n  // Backbone.View\n  // -------------\n\n  // Backbone Views are almost more convention than they are actual code. A View\n  // is simply a JavaScript object that represents a logical chunk of UI in the\n  // DOM. This might be a single item, an entire list, a sidebar or panel, or\n  // even the surrounding frame which wraps your whole app. Defining a chunk of\n  // UI as a **View** allows you to define your DOM events declaratively, without\n  // having to worry about render order ... and makes it easy for the view to\n  // react to specific changes in the state of your models.\n\n  // Creating a Backbone.View creates its initial element outside of the DOM,\n  // if an existing element is not provided...\n  var View = Backbone.View = function(options) {\n    this.cid = _.uniqueId('view');\n    options || (options = {});\n    _.extend(this, _.pick(options, viewOptions));\n    this._ensureElement();\n    this.initialize.apply(this, arguments);\n    this.delegateEvents();\n  };\n\n  // Cached regex to split keys for `delegate`.\n  var delegateEventSplitter = /^(\\S+)\\s*(.*)$/;\n\n  // List of view options to be merged as properties.\n  var viewOptions = ['model', 'collection', 'el', 'id', 'attributes', 'className', 'tagName', 'events'];\n\n  // Set up all inheritable **Backbone.View** properties and methods.\n  _.extend(View.prototype, Events, {\n\n    // The default `tagName` of a View's element is `\"div\"`.\n    tagName: 'div',\n\n    // jQuery delegate for element lookup, scoped to DOM elements within the\n    // current view. This should be preferred to global lookups where possible.\n    $: function(selector) {\n      return this.$el.find(selector);\n    },\n\n    // Initialize is an empty function by default. Override it with your own\n    // initialization logic.\n    initialize: function(){},\n\n    // **render** is the core function that your view should override, in order\n    // to populate its element (`this.el`), with the appropriate HTML. The\n    // convention is for **render** to always return `this`.\n    render: function() {\n      return this;\n    },\n\n    // Remove this view by taking the element out of the DOM, and removing any\n    // applicable Backbone.Events listeners.\n    remove: function() {\n      this.$el.remove();\n      this.stopListening();\n      return this;\n    },\n\n    // Change the view's element (`this.el` property), including event\n    // re-delegation.\n    setElement: function(element, delegate) {\n      if (this.$el) this.undelegateEvents();\n      this.$el = element instanceof Backbone.$ ? element : Backbone.$(element);\n      this.el = this.$el[0];\n      if (delegate !== false) this.delegateEvents();\n      return this;\n    },\n\n    // Set callbacks, where `this.events` is a hash of\n    //\n    // *{\"event selector\": \"callback\"}*\n    //\n    //     {\n    //       'mousedown .title':  'edit',\n    //       'click .button':     'save',\n    //       'click .open':       function(e) { ... }\n    //     }\n    //\n    // pairs. Callbacks will be bound to the view, with `this` set properly.\n    // Uses event delegation for efficiency.\n    // Omitting the selector binds the event to `this.el`.\n    // This only works for delegate-able events: not `focus`, `blur`, and\n    // not `change`, `submit`, and `reset` in Internet Explorer.\n    delegateEvents: function(events) {\n      if (!(events || (events = _.result(this, 'events')))) return this;\n      this.undelegateEvents();\n      for (var key in events) {\n        var method = events[key];\n        if (!_.isFunction(method)) method = this[events[key]];\n        if (!method) continue;\n\n        var match = key.match(delegateEventSplitter);\n        var eventName = match[1], selector = match[2];\n        method = _.bind(method, this);\n        eventName += '.delegateEvents' + this.cid;\n        if (selector === '') {\n          this.$el.on(eventName, method);\n        } else {\n          this.$el.on(eventName, selector, method);\n        }\n      }\n      return this;\n    },\n\n    // Clears all callbacks previously bound to the view with `delegateEvents`.\n    // You usually don't need to use this, but may wish to if you have multiple\n    // Backbone views attached to the same DOM element.\n    undelegateEvents: function() {\n      this.$el.off('.delegateEvents' + this.cid);\n      return this;\n    },\n\n    // Ensure that the View has a DOM element to render into.\n    // If `this.el` is a string, pass it through `$()`, take the first\n    // matching element, and re-assign it to `el`. Otherwise, create\n    // an element from the `id`, `className` and `tagName` properties.\n    _ensureElement: function() {\n      if (!this.el) {\n        var attrs = _.extend({}, _.result(this, 'attributes'));\n        if (this.id) attrs.id = _.result(this, 'id');\n        if (this.className) attrs['class'] = _.result(this, 'className');\n        var $el = Backbone.$('<' + _.result(this, 'tagName') + '>').attr(attrs);\n        this.setElement($el, false);\n      } else {\n        this.setElement(_.result(this, 'el'), false);\n      }\n    }\n\n  });\n\n  // Backbone.sync\n  // -------------\n\n  // Override this function to change the manner in which Backbone persists\n  // models to the server. You will be passed the type of request, and the\n  // model in question. By default, makes a RESTful Ajax request\n  // to the model's `url()`. Some possible customizations could be:\n  //\n  // * Use `setTimeout` to batch rapid-fire updates into a single request.\n  // * Send up the models as XML instead of JSON.\n  // * Persist models via WebSockets instead of Ajax.\n  //\n  // Turn on `Backbone.emulateHTTP` in order to send `PUT` and `DELETE` requests\n  // as `POST`, with a `_method` parameter containing the true HTTP method,\n  // as well as all requests with the body as `application/x-www-form-urlencoded`\n  // instead of `application/json` with the model in a param named `model`.\n  // Useful when interfacing with server-side languages like **PHP** that make\n  // it difficult to read the body of `PUT` requests.\n  Backbone.sync = function(method, model, options) {\n    var type = methodMap[method];\n\n    // Default options, unless specified.\n    _.defaults(options || (options = {}), {\n      emulateHTTP: Backbone.emulateHTTP,\n      emulateJSON: Backbone.emulateJSON\n    });\n\n    // Default JSON-request options.\n    var params = {type: type, dataType: 'json'};\n\n    // Ensure that we have a URL.\n    if (!options.url) {\n      params.url = _.result(model, 'url') || urlError();\n    }\n\n    // Ensure that we have the appropriate request data.\n    if (options.data == null && model && (method === 'create' || method === 'update' || method === 'patch')) {\n      params.contentType = 'application/json';\n      params.data = JSON.stringify(options.attrs || model.toJSON(options));\n    }\n\n    // For older servers, emulate JSON by encoding the request into an HTML-form.\n    if (options.emulateJSON) {\n      params.contentType = 'application/x-www-form-urlencoded';\n      params.data = params.data ? {model: params.data} : {};\n    }\n\n    // For older servers, emulate HTTP by mimicking the HTTP method with `_method`\n    // And an `X-HTTP-Method-Override` header.\n    if (options.emulateHTTP && (type === 'PUT' || type === 'DELETE' || type === 'PATCH')) {\n      params.type = 'POST';\n      if (options.emulateJSON) params.data._method = type;\n      var beforeSend = options.beforeSend;\n      options.beforeSend = function(xhr) {\n        xhr.setRequestHeader('X-HTTP-Method-Override', type);\n        if (beforeSend) return beforeSend.apply(this, arguments);\n      };\n    }\n\n    // Don't process data on a non-GET request.\n    if (params.type !== 'GET' && !options.emulateJSON) {\n      params.processData = false;\n    }\n\n    // If we're sending a `PATCH` request, and we're in an old Internet Explorer\n    // that still has ActiveX enabled by default, override jQuery to use that\n    // for XHR instead. Remove this line when jQuery supports `PATCH` on IE8.\n    if (params.type === 'PATCH' && noXhrPatch) {\n      params.xhr = function() {\n        return new ActiveXObject(\"Microsoft.XMLHTTP\");\n      };\n    }\n\n    // Make the request, allowing the user to override any Ajax options.\n    var xhr = options.xhr = Backbone.ajax(_.extend(params, options));\n    model.trigger('request', model, xhr, options);\n    return xhr;\n  };\n\n  var noXhrPatch =\n    typeof window !== 'undefined' && !!window.ActiveXObject &&\n      !(window.XMLHttpRequest && (new XMLHttpRequest).dispatchEvent);\n\n  // Map from CRUD to HTTP for our default `Backbone.sync` implementation.\n  var methodMap = {\n    'create': 'POST',\n    'update': 'PUT',\n    'patch':  'PATCH',\n    'delete': 'DELETE',\n    'read':   'GET'\n  };\n\n  // Set the default implementation of `Backbone.ajax` to proxy through to `$`.\n  // Override this if you'd like to use a different library.\n  Backbone.ajax = function() {\n    return Backbone.$.ajax.apply(Backbone.$, arguments);\n  };\n\n  // Backbone.Router\n  // ---------------\n\n  // Routers map faux-URLs to actions, and fire events when routes are\n  // matched. Creating a new one sets its `routes` hash, if not set statically.\n  var Router = Backbone.Router = function(options) {\n    options || (options = {});\n    if (options.routes) this.routes = options.routes;\n    this._bindRoutes();\n    this.initialize.apply(this, arguments);\n  };\n\n  // Cached regular expressions for matching named param parts and splatted\n  // parts of route strings.\n  var optionalParam = /\\((.*?)\\)/g;\n  var namedParam    = /(\\(\\?)?:\\w+/g;\n  var splatParam    = /\\*\\w+/g;\n  var escapeRegExp  = /[\\-{}\\[\\]+?.,\\\\\\^$|#\\s]/g;\n\n  // Set up all inheritable **Backbone.Router** properties and methods.\n  _.extend(Router.prototype, Events, {\n\n    // Initialize is an empty function by default. Override it with your own\n    // initialization logic.\n    initialize: function(){},\n\n    // Manually bind a single named route to a callback. For example:\n    //\n    //     this.route('search/:query/p:num', 'search', function(query, num) {\n    //       ...\n    //     });\n    //\n    route: function(route, name, callback) {\n      if (!_.isRegExp(route)) route = this._routeToRegExp(route);\n      if (_.isFunction(name)) {\n        callback = name;\n        name = '';\n      }\n      if (!callback) callback = this[name];\n      var router = this;\n      Backbone.history.route(route, function(fragment) {\n        var args = router._extractParameters(route, fragment);\n        router.execute(callback, args);\n        router.trigger.apply(router, ['route:' + name].concat(args));\n        router.trigger('route', name, args);\n        Backbone.history.trigger('route', router, name, args);\n      });\n      return this;\n    },\n\n    // Execute a route handler with the provided parameters.  This is an\n    // excellent place to do pre-route setup or post-route cleanup.\n    execute: function(callback, args) {\n      if (callback) callback.apply(this, args);\n    },\n\n    // Simple proxy to `Backbone.history` to save a fragment into the history.\n    navigate: function(fragment, options) {\n      Backbone.history.navigate(fragment, options);\n      return this;\n    },\n\n    // Bind all defined routes to `Backbone.history`. We have to reverse the\n    // order of the routes here to support behavior where the most general\n    // routes can be defined at the bottom of the route map.\n    _bindRoutes: function() {\n      if (!this.routes) return;\n      this.routes = _.result(this, 'routes');\n      var route, routes = _.keys(this.routes);\n      while ((route = routes.pop()) != null) {\n        this.route(route, this.routes[route]);\n      }\n    },\n\n    // Convert a route string into a regular expression, suitable for matching\n    // against the current location hash.\n    _routeToRegExp: function(route) {\n      route = route.replace(escapeRegExp, '\\\\$&')\n                   .replace(optionalParam, '(?:$1)?')\n                   .replace(namedParam, function(match, optional) {\n                     return optional ? match : '([^/?]+)';\n                   })\n                   .replace(splatParam, '([^?]*?)');\n      return new RegExp('^' + route + '(?:\\\\?([\\\\s\\\\S]*))?$');\n    },\n\n    // Given a route, and a URL fragment that it matches, return the array of\n    // extracted decoded parameters. Empty or unmatched parameters will be\n    // treated as `null` to normalize cross-browser behavior.\n    _extractParameters: function(route, fragment) {\n      var params = route.exec(fragment).slice(1);\n      return _.map(params, function(param, i) {\n        // Don't decode the search params.\n        if (i === params.length - 1) return param || null;\n        return param ? decodeURIComponent(param) : null;\n      });\n    }\n\n  });\n\n  // Backbone.History\n  // ----------------\n\n  // Handles cross-browser history management, based on either\n  // [pushState](http://diveintohtml5.info/history.html) and real URLs, or\n  // [onhashchange](https://developer.mozilla.org/en-US/docs/DOM/window.onhashchange)\n  // and URL fragments. If the browser supports neither (old IE, natch),\n  // falls back to polling.\n  var History = Backbone.History = function() {\n    this.handlers = [];\n    _.bindAll(this, 'checkUrl');\n\n    // Ensure that `History` can be used outside of the browser.\n    if (typeof window !== 'undefined') {\n      this.location = window.location;\n      this.history = window.history;\n    }\n  };\n\n  // Cached regex for stripping a leading hash/slash and trailing space.\n  var routeStripper = /^[#\\/]|\\s+$/g;\n\n  // Cached regex for stripping leading and trailing slashes.\n  var rootStripper = /^\\/+|\\/+$/g;\n\n  // Cached regex for detecting MSIE.\n  var isExplorer = /msie [\\w.]+/;\n\n  // Cached regex for removing a trailing slash.\n  var trailingSlash = /\\/$/;\n\n  // Cached regex for stripping urls of hash.\n  var pathStripper = /#.*$/;\n\n  // Has the history handling already been started?\n  History.started = false;\n\n  // Set up all inheritable **Backbone.History** properties and methods.\n  _.extend(History.prototype, Events, {\n\n    // The default interval to poll for hash changes, if necessary, is\n    // twenty times a second.\n    interval: 50,\n\n    // Are we at the app root?\n    atRoot: function() {\n      return this.location.pathname.replace(/[^\\/]$/, '$&/') === this.root;\n    },\n\n    // Gets the true hash value. Cannot use location.hash directly due to bug\n    // in Firefox where location.hash will always be decoded.\n    getHash: function(window) {\n      var match = (window || this).location.href.match(/#(.*)$/);\n      return match ? match[1] : '';\n    },\n\n    // Get the cross-browser normalized URL fragment, either from the URL,\n    // the hash, or the override.\n    getFragment: function(fragment, forcePushState) {\n      if (fragment == null) {\n        if (this._hasPushState || !this._wantsHashChange || forcePushState) {\n          fragment = decodeURI(this.location.pathname + this.location.search);\n          var root = this.root.replace(trailingSlash, '');\n          if (!fragment.indexOf(root)) fragment = fragment.slice(root.length);\n        } else {\n          fragment = this.getHash();\n        }\n      }\n      return fragment.replace(routeStripper, '');\n    },\n\n    // Start the hash change handling, returning `true` if the current URL matches\n    // an existing route, and `false` otherwise.\n    start: function(options) {\n      if (History.started) throw new Error(\"Backbone.history has already been started\");\n      History.started = true;\n\n      // Figure out the initial configuration. Do we need an iframe?\n      // Is pushState desired ... is it available?\n      this.options          = _.extend({root: '/'}, this.options, options);\n      this.root             = this.options.root;\n      this._wantsHashChange = this.options.hashChange !== false;\n      this._wantsPushState  = !!this.options.pushState;\n      this._hasPushState    = !!(this.options.pushState && this.history && this.history.pushState);\n      var fragment          = this.getFragment();\n      var docMode           = document.documentMode;\n      var oldIE             = (isExplorer.exec(navigator.userAgent.toLowerCase()) && (!docMode || docMode <= 7));\n\n      // Normalize root to always include a leading and trailing slash.\n      this.root = ('/' + this.root + '/').replace(rootStripper, '/');\n\n      if (oldIE && this._wantsHashChange) {\n        var frame = Backbone.$('<iframe src=\"javascript:0\" tabindex=\"-1\">');\n        this.iframe = frame.hide().appendTo('body')[0].contentWindow;\n        this.navigate(fragment);\n      }\n\n      // Depending on whether we're using pushState or hashes, and whether\n      // 'onhashchange' is supported, determine how we check the URL state.\n      if (this._hasPushState) {\n        Backbone.$(window).on('popstate', this.checkUrl);\n      } else if (this._wantsHashChange && ('onhashchange' in window) && !oldIE) {\n        Backbone.$(window).on('hashchange', this.checkUrl);\n      } else if (this._wantsHashChange) {\n        this._checkUrlInterval = setInterval(this.checkUrl, this.interval);\n      }\n\n      // Determine if we need to change the base url, for a pushState link\n      // opened by a non-pushState browser.\n      this.fragment = fragment;\n      var loc = this.location;\n\n      // Transition from hashChange to pushState or vice versa if both are\n      // requested.\n      if (this._wantsHashChange && this._wantsPushState) {\n\n        // If we've started off with a route from a `pushState`-enabled\n        // browser, but we're currently in a browser that doesn't support it...\n        if (!this._hasPushState && !this.atRoot()) {\n          this.fragment = this.getFragment(null, true);\n          this.location.replace(this.root + '#' + this.fragment);\n          // Return immediately as browser will do redirect to new url\n          return true;\n\n        // Or if we've started out with a hash-based route, but we're currently\n        // in a browser where it could be `pushState`-based instead...\n        } else if (this._hasPushState && this.atRoot() && loc.hash) {\n          this.fragment = this.getHash().replace(routeStripper, '');\n          this.history.replaceState({}, document.title, this.root + this.fragment);\n        }\n\n      }\n\n      if (!this.options.silent) return this.loadUrl();\n    },\n\n    // Disable Backbone.history, perhaps temporarily. Not useful in a real app,\n    // but possibly useful for unit testing Routers.\n    stop: function() {\n      Backbone.$(window).off('popstate', this.checkUrl).off('hashchange', this.checkUrl);\n      if (this._checkUrlInterval) clearInterval(this._checkUrlInterval);\n      History.started = false;\n    },\n\n    // Add a route to be tested when the fragment changes. Routes added later\n    // may override previous routes.\n    route: function(route, callback) {\n      this.handlers.unshift({route: route, callback: callback});\n    },\n\n    // Checks the current URL to see if it has changed, and if it has,\n    // calls `loadUrl`, normalizing across the hidden iframe.\n    checkUrl: function(e) {\n      var current = this.getFragment();\n      if (current === this.fragment && this.iframe) {\n        current = this.getFragment(this.getHash(this.iframe));\n      }\n      if (current === this.fragment) return false;\n      if (this.iframe) this.navigate(current);\n      this.loadUrl();\n    },\n\n    // Attempt to load the current URL fragment. If a route succeeds with a\n    // match, returns `true`. If no defined routes matches the fragment,\n    // returns `false`.\n    loadUrl: function(fragment) {\n      fragment = this.fragment = this.getFragment(fragment);\n      return _.any(this.handlers, function(handler) {\n        if (handler.route.test(fragment)) {\n          handler.callback(fragment);\n          return true;\n        }\n      });\n    },\n\n    // Save a fragment into the hash history, or replace the URL state if the\n    // 'replace' option is passed. You are responsible for properly URL-encoding\n    // the fragment in advance.\n    //\n    // The options object can contain `trigger: true` if you wish to have the\n    // route callback be fired (not usually desirable), or `replace: true`, if\n    // you wish to modify the current URL without adding an entry to the history.\n    navigate: function(fragment, options) {\n      if (!History.started) return false;\n      if (!options || options === true) options = {trigger: !!options};\n\n      var url = this.root + (fragment = this.getFragment(fragment || ''));\n\n      // Strip the hash for matching.\n      fragment = fragment.replace(pathStripper, '');\n\n      if (this.fragment === fragment) return;\n      this.fragment = fragment;\n\n      // Don't include a trailing slash on the root.\n      if (fragment === '' && url !== '/') url = url.slice(0, -1);\n\n      // If pushState is available, we use it to set the fragment as a real URL.\n      if (this._hasPushState) {\n        this.history[options.replace ? 'replaceState' : 'pushState']({}, document.title, url);\n\n      // If hash changes haven't been explicitly disabled, update the hash\n      // fragment to store history.\n      } else if (this._wantsHashChange) {\n        this._updateHash(this.location, fragment, options.replace);\n        if (this.iframe && (fragment !== this.getFragment(this.getHash(this.iframe)))) {\n          // Opening and closing the iframe tricks IE7 and earlier to push a\n          // history entry on hash-tag change.  When replace is true, we don't\n          // want this.\n          if(!options.replace) this.iframe.document.open().close();\n          this._updateHash(this.iframe.location, fragment, options.replace);\n        }\n\n      // If you've told us that you explicitly don't want fallback hashchange-\n      // based history, then `navigate` becomes a page refresh.\n      } else {\n        return this.location.assign(url);\n      }\n      if (options.trigger) return this.loadUrl(fragment);\n    },\n\n    // Update the hash location, either replacing the current entry, or adding\n    // a new one to the browser history.\n    _updateHash: function(location, fragment, replace) {\n      if (replace) {\n        var href = location.href.replace(/(javascript:|#).*$/, '');\n        location.replace(href + '#' + fragment);\n      } else {\n        // Some browsers require that `hash` contains a leading #.\n        location.hash = '#' + fragment;\n      }\n    }\n\n  });\n\n  // Create the default Backbone.history.\n  Backbone.history = new History;\n\n  // Helpers\n  // -------\n\n  // Helper function to correctly set up the prototype chain, for subclasses.\n  // Similar to `goog.inherits`, but uses a hash of prototype properties and\n  // class properties to be extended.\n  var extend = function(protoProps, staticProps) {\n    var parent = this;\n    var child;\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (protoProps && _.has(protoProps, 'constructor')) {\n      child = protoProps.constructor;\n    } else {\n      child = function(){ return parent.apply(this, arguments); };\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    _.extend(child, parent, staticProps);\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function(){ this.constructor = child; };\n    Surrogate.prototype = parent.prototype;\n    child.prototype = new Surrogate;\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) _.extend(child.prototype, protoProps);\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = parent.prototype;\n\n    return child;\n  };\n\n  // Set up inheritance for the model, collection, router, view and history.\n  Model.extend = Collection.extend = Router.extend = View.extend = History.extend = extend;\n\n  // Throw an error when a URL is needed, and none is supplied.\n  var urlError = function() {\n    throw new Error('A \"url\" property or function must be specified');\n  };\n\n  // Wrap an optional error callback with a fallback error event.\n  var wrapError = function(model, options) {\n    var error = options.error;\n    options.error = function(resp) {\n      if (error) error(model, resp, options);\n      model.trigger('error', model, resp, options);\n    };\n  };\n\n  return Backbone;\n\n}));\n",
    "/* MIT license */\nvar convert = require(\"color-convert\"),\n    string = require(\"color-string\");\n\nvar Color = function(obj) {\n  if (obj instanceof Color) return obj;\n  if (! (this instanceof Color)) return new Color(obj);\n\n   this.values = {\n      rgb: [0, 0, 0],\n      hsl: [0, 0, 0],\n      hsv: [0, 0, 0],\n      hwb: [0, 0, 0],\n      cmyk: [0, 0, 0, 0],\n      alpha: 1\n   }\n\n   // parse Color() argument\n   if (typeof obj == \"string\") {\n      var vals = string.getRgba(obj);\n      if (vals) {\n         this.setValues(\"rgb\", vals);\n      }\n      else if(vals = string.getHsla(obj)) {\n         this.setValues(\"hsl\", vals);\n      }\n      else if(vals = string.getHwb(obj)) {\n         this.setValues(\"hwb\", vals);\n      }\n      else {\n        throw new Error(\"Unable to parse color from string \\\"\" + obj + \"\\\"\");\n      }\n   }\n   else if (typeof obj == \"object\") {\n      var vals = obj;\n      if(vals[\"r\"] !== undefined || vals[\"red\"] !== undefined) {\n         this.setValues(\"rgb\", vals)\n      }\n      else if(vals[\"l\"] !== undefined || vals[\"lightness\"] !== undefined) {\n         this.setValues(\"hsl\", vals)\n      }\n      else if(vals[\"v\"] !== undefined || vals[\"value\"] !== undefined) {\n         this.setValues(\"hsv\", vals)\n      }\n      else if(vals[\"w\"] !== undefined || vals[\"whiteness\"] !== undefined) {\n         this.setValues(\"hwb\", vals)\n      }\n      else if(vals[\"c\"] !== undefined || vals[\"cyan\"] !== undefined) {\n         this.setValues(\"cmyk\", vals)\n      }\n      else {\n        throw new Error(\"Unable to parse color from object \" + JSON.stringify(obj));\n      }\n   }\n}\n\nColor.prototype = {\n   rgb: function (vals) {\n      return this.setSpace(\"rgb\", arguments);\n   },\n   hsl: function(vals) {\n      return this.setSpace(\"hsl\", arguments);\n   },\n   hsv: function(vals) {\n      return this.setSpace(\"hsv\", arguments);\n   },\n   hwb: function(vals) {\n      return this.setSpace(\"hwb\", arguments);\n   },\n   cmyk: function(vals) {\n      return this.setSpace(\"cmyk\", arguments);\n   },\n\n   rgbArray: function() {\n      return this.values.rgb;\n   },\n   hslArray: function() {\n      return this.values.hsl;\n   },\n   hsvArray: function() {\n      return this.values.hsv;\n   },\n   hwbArray: function() {\n      if (this.values.alpha !== 1) {\n        return this.values.hwb.concat([this.values.alpha])\n      }\n      return this.values.hwb;\n   },\n   cmykArray: function() {\n      return this.values.cmyk;\n   },\n   rgbaArray: function() {\n      var rgb = this.values.rgb;\n      return rgb.concat([this.values.alpha]);\n   },\n   hslaArray: function() {\n      var hsl = this.values.hsl;\n      return hsl.concat([this.values.alpha]);\n   },\n   alpha: function(val) {\n      if (val === undefined) {\n         return this.values.alpha;\n      }\n      this.setValues(\"alpha\", val);\n      return this;\n   },\n\n   red: function(val) {\n      return this.setChannel(\"rgb\", 0, val);\n   },\n   green: function(val) {\n      return this.setChannel(\"rgb\", 1, val);\n   },\n   blue: function(val) {\n      return this.setChannel(\"rgb\", 2, val);\n   },\n   hue: function(val) {\n      return this.setChannel(\"hsl\", 0, val);\n   },\n   saturation: function(val) {\n      return this.setChannel(\"hsl\", 1, val);\n   },\n   lightness: function(val) {\n      return this.setChannel(\"hsl\", 2, val);\n   },\n   saturationv: function(val) {\n      return this.setChannel(\"hsv\", 1, val);\n   },\n   whiteness: function(val) {\n      return this.setChannel(\"hwb\", 1, val);\n   },\n   blackness: function(val) {\n      return this.setChannel(\"hwb\", 2, val);\n   },\n   value: function(val) {\n      return this.setChannel(\"hsv\", 2, val);\n   },\n   cyan: function(val) {\n      return this.setChannel(\"cmyk\", 0, val);\n   },\n   magenta: function(val) {\n      return this.setChannel(\"cmyk\", 1, val);\n   },\n   yellow: function(val) {\n      return this.setChannel(\"cmyk\", 2, val);\n   },\n   black: function(val) {\n      return this.setChannel(\"cmyk\", 3, val);\n   },\n\n   hexString: function() {\n      return string.hexString(this.values.rgb);\n   },\n   rgbString: function() {\n      return string.rgbString(this.values.rgb, this.values.alpha);\n   },\n   rgbaString: function() {\n      return string.rgbaString(this.values.rgb, this.values.alpha);\n   },\n   percentString: function() {\n      return string.percentString(this.values.rgb, this.values.alpha);\n   },\n   hslString: function() {\n      return string.hslString(this.values.hsl, this.values.alpha);\n   },\n   hslaString: function() {\n      return string.hslaString(this.values.hsl, this.values.alpha);\n   },\n   hwbString: function() {\n      return string.hwbString(this.values.hwb, this.values.alpha);\n   },\n   keyword: function() {\n      return string.keyword(this.values.rgb, this.values.alpha);\n   },\n\n   rgbNumber: function() {\n      return (this.values.rgb[0] << 16) | (this.values.rgb[1] << 8) | this.values.rgb[2];\n   },\n\n   luminosity: function() {\n      // http://www.w3.org/TR/WCAG20/#relativeluminancedef\n      var rgb = this.values.rgb;\n      var lum = [];\n      for (var i = 0; i < rgb.length; i++) {\n         var chan = rgb[i] / 255;\n         lum[i] = (chan <= 0.03928) ? chan / 12.92\n                  : Math.pow(((chan + 0.055) / 1.055), 2.4)\n      }\n      return 0.2126 * lum[0] + 0.7152 * lum[1] + 0.0722 * lum[2];\n   },\n\n   contrast: function(color2) {\n      // http://www.w3.org/TR/WCAG20/#contrast-ratiodef\n      var lum1 = this.luminosity();\n      var lum2 = color2.luminosity();\n      if (lum1 > lum2) {\n         return (lum1 + 0.05) / (lum2 + 0.05)\n      };\n      return (lum2 + 0.05) / (lum1 + 0.05);\n   },\n\n   level: function(color2) {\n     var contrastRatio = this.contrast(color2);\n     return (contrastRatio >= 7.1)\n       ? 'AAA'\n       : (contrastRatio >= 4.5)\n        ? 'AA'\n        : '';\n   },\n\n   dark: function() {\n      // YIQ equation from http://24ways.org/2010/calculating-color-contrast\n      var rgb = this.values.rgb,\n          yiq = (rgb[0] * 299 + rgb[1] * 587 + rgb[2] * 114) / 1000;\n      return yiq < 128;\n   },\n\n   light: function() {\n      return !this.dark();\n   },\n\n   negate: function() {\n      var rgb = []\n      for (var i = 0; i < 3; i++) {\n         rgb[i] = 255 - this.values.rgb[i];\n      }\n      this.setValues(\"rgb\", rgb);\n      return this;\n   },\n\n   lighten: function(ratio) {\n      this.values.hsl[2] += this.values.hsl[2] * ratio;\n      this.setValues(\"hsl\", this.values.hsl);\n      return this;\n   },\n\n   darken: function(ratio) {\n      this.values.hsl[2] -= this.values.hsl[2] * ratio;\n      this.setValues(\"hsl\", this.values.hsl);\n      return this;\n   },\n\n   saturate: function(ratio) {\n      this.values.hsl[1] += this.values.hsl[1] * ratio;\n      this.setValues(\"hsl\", this.values.hsl);\n      return this;\n   },\n\n   desaturate: function(ratio) {\n      this.values.hsl[1] -= this.values.hsl[1] * ratio;\n      this.setValues(\"hsl\", this.values.hsl);\n      return this;\n   },\n\n   whiten: function(ratio) {\n      this.values.hwb[1] += this.values.hwb[1] * ratio;\n      this.setValues(\"hwb\", this.values.hwb);\n      return this;\n   },\n\n   blacken: function(ratio) {\n      this.values.hwb[2] += this.values.hwb[2] * ratio;\n      this.setValues(\"hwb\", this.values.hwb);\n      return this;\n   },\n\n   greyscale: function() {\n      var rgb = this.values.rgb;\n      // http://en.wikipedia.org/wiki/Grayscale#Converting_color_to_grayscale\n      var val = rgb[0] * 0.3 + rgb[1] * 0.59 + rgb[2] * 0.11;\n      this.setValues(\"rgb\", [val, val, val]);\n      return this;\n   },\n\n   clearer: function(ratio) {\n      this.setValues(\"alpha\", this.values.alpha - (this.values.alpha * ratio));\n      return this;\n   },\n\n   opaquer: function(ratio) {\n      this.setValues(\"alpha\", this.values.alpha + (this.values.alpha * ratio));\n      return this;\n   },\n\n   rotate: function(degrees) {\n      var hue = this.values.hsl[0];\n      hue = (hue + degrees) % 360;\n      hue = hue < 0 ? 360 + hue : hue;\n      this.values.hsl[0] = hue;\n      this.setValues(\"hsl\", this.values.hsl);\n      return this;\n   },\n\n   /**\n    * Ported from sass implementation in C\n    * https://github.com/sass/libsass/blob/0e6b4a2850092356aa3ece07c6b249f0221caced/functions.cpp#L209\n    */\n   mix: function(mixinColor, weight) {\n      var color1 = this;\n      var color2 = mixinColor;\n      var p = weight !== undefined ? weight : 0.5;\n\n      var w = 2 * p - 1;\n      var a = color1.alpha() - color2.alpha();\n\n      var w1 = (((w * a == -1) ? w : (w + a)/(1 + w*a)) + 1) / 2.0;\n      var w2 = 1 - w1;\n\n      return this\n        .rgb(\n          w1 * color1.red() + w2 * color2.red(),\n          w1 * color1.green() + w2 * color2.green(),\n          w1 * color1.blue() + w2 * color2.blue()\n        )\n        .alpha(color1.alpha() * p + color2.alpha() * (1 - p));\n   },\n\n   toJSON: function() {\n     return this.rgb();\n   },\n\n   clone: function() {\n     return new Color(this.rgb());\n   }\n}\n\n\nColor.prototype.getValues = function(space) {\n   var vals = {};\n   for (var i = 0; i < space.length; i++) {\n      vals[space.charAt(i)] = this.values[space][i];\n   }\n   if (this.values.alpha != 1) {\n      vals[\"a\"] = this.values.alpha;\n   }\n   // {r: 255, g: 255, b: 255, a: 0.4}\n   return vals;\n}\n\nColor.prototype.setValues = function(space, vals) {\n   var spaces = {\n      \"rgb\": [\"red\", \"green\", \"blue\"],\n      \"hsl\": [\"hue\", \"saturation\", \"lightness\"],\n      \"hsv\": [\"hue\", \"saturation\", \"value\"],\n      \"hwb\": [\"hue\", \"whiteness\", \"blackness\"],\n      \"cmyk\": [\"cyan\", \"magenta\", \"yellow\", \"black\"]\n   };\n\n   var maxes = {\n      \"rgb\": [255, 255, 255],\n      \"hsl\": [360, 100, 100],\n      \"hsv\": [360, 100, 100],\n      \"hwb\": [360, 100, 100],\n      \"cmyk\": [100, 100, 100, 100]\n   };\n\n   var alpha = 1;\n   if (space == \"alpha\") {\n      alpha = vals;\n   }\n   else if (vals.length) {\n      // [10, 10, 10]\n      this.values[space] = vals.slice(0, space.length);\n      alpha = vals[space.length];\n   }\n   else if (vals[space.charAt(0)] !== undefined) {\n      // {r: 10, g: 10, b: 10}\n      for (var i = 0; i < space.length; i++) {\n        this.values[space][i] = vals[space.charAt(i)];\n      }\n      alpha = vals.a;\n   }\n   else if (vals[spaces[space][0]] !== undefined) {\n      // {red: 10, green: 10, blue: 10}\n      var chans = spaces[space];\n      for (var i = 0; i < space.length; i++) {\n        this.values[space][i] = vals[chans[i]];\n      }\n      alpha = vals.alpha;\n   }\n   this.values.alpha = Math.max(0, Math.min(1, (alpha !== undefined ? alpha : this.values.alpha) ));\n   if (space == \"alpha\") {\n      return;\n   }\n\n   // cap values of the space prior converting all values\n   for (var i = 0; i < space.length; i++) {\n      var capped = Math.max(0, Math.min(maxes[space][i], this.values[space][i]));\n      this.values[space][i] = Math.round(capped);\n   }\n\n   // convert to all the other color spaces\n   for (var sname in spaces) {\n      if (sname != space) {\n         this.values[sname] = convert[space][sname](this.values[space])\n      }\n\n      // cap values\n      for (var i = 0; i < sname.length; i++) {\n         var capped = Math.max(0, Math.min(maxes[sname][i], this.values[sname][i]));\n         this.values[sname][i] = Math.round(capped);\n      }\n   }\n   return true;\n}\n\nColor.prototype.setSpace = function(space, args) {\n   var vals = args[0];\n   if (vals === undefined) {\n      // color.rgb()\n      return this.getValues(space);\n   }\n   // color.rgb(10, 10, 10)\n   if (typeof vals == \"number\") {\n      vals = Array.prototype.slice.call(args);\n   }\n   this.setValues(space, vals);\n   return this;\n}\n\nColor.prototype.setChannel = function(space, index, val) {\n   if (val === undefined) {\n      // color.red()\n      return this.values[space][index];\n   }\n   // color.red(100)\n   this.values[space][index] = val;\n   this.setValues(space, this.values[space]);\n   return this;\n}\n\nmodule.exports = Color;\n",
    "/* MIT license */\n\nmodule.exports = {\n  rgb2hsl: rgb2hsl,\n  rgb2hsv: rgb2hsv,\n  rgb2hwb: rgb2hwb,\n  rgb2cmyk: rgb2cmyk,\n  rgb2keyword: rgb2keyword,\n  rgb2xyz: rgb2xyz,\n  rgb2lab: rgb2lab,\n  rgb2lch: rgb2lch,\n\n  hsl2rgb: hsl2rgb,\n  hsl2hsv: hsl2hsv,\n  hsl2hwb: hsl2hwb,\n  hsl2cmyk: hsl2cmyk,\n  hsl2keyword: hsl2keyword,\n\n  hsv2rgb: hsv2rgb,\n  hsv2hsl: hsv2hsl,\n  hsv2hwb: hsv2hwb,\n  hsv2cmyk: hsv2cmyk,\n  hsv2keyword: hsv2keyword,\n\n  hwb2rgb: hwb2rgb,\n  hwb2hsl: hwb2hsl,\n  hwb2hsv: hwb2hsv,\n  hwb2cmyk: hwb2cmyk,\n  hwb2keyword: hwb2keyword,\n\n  cmyk2rgb: cmyk2rgb,\n  cmyk2hsl: cmyk2hsl,\n  cmyk2hsv: cmyk2hsv,\n  cmyk2hwb: cmyk2hwb,\n  cmyk2keyword: cmyk2keyword,\n\n  keyword2rgb: keyword2rgb,\n  keyword2hsl: keyword2hsl,\n  keyword2hsv: keyword2hsv,\n  keyword2hwb: keyword2hwb,\n  keyword2cmyk: keyword2cmyk,\n  keyword2lab: keyword2lab,\n  keyword2xyz: keyword2xyz,\n\n  xyz2rgb: xyz2rgb,\n  xyz2lab: xyz2lab,\n  xyz2lch: xyz2lch,\n\n  lab2xyz: lab2xyz,\n  lab2rgb: lab2rgb,\n  lab2lch: lab2lch,\n\n  lch2lab: lch2lab,\n  lch2xyz: lch2xyz,\n  lch2rgb: lch2rgb\n}\n\n\nfunction rgb2hsl(rgb) {\n  var r = rgb[0]/255,\n      g = rgb[1]/255,\n      b = rgb[2]/255,\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      delta = max - min,\n      h, s, l;\n\n  if (max == min)\n    h = 0;\n  else if (r == max)\n    h = (g - b) / delta;\n  else if (g == max)\n    h = 2 + (b - r) / delta;\n  else if (b == max)\n    h = 4 + (r - g)/ delta;\n\n  h = Math.min(h * 60, 360);\n\n  if (h < 0)\n    h += 360;\n\n  l = (min + max) / 2;\n\n  if (max == min)\n    s = 0;\n  else if (l <= 0.5)\n    s = delta / (max + min);\n  else\n    s = delta / (2 - max - min);\n\n  return [h, s * 100, l * 100];\n}\n\nfunction rgb2hsv(rgb) {\n  var r = rgb[0],\n      g = rgb[1],\n      b = rgb[2],\n      min = Math.min(r, g, b),\n      max = Math.max(r, g, b),\n      delta = max - min,\n      h, s, v;\n\n  if (max == 0)\n    s = 0;\n  else\n    s = (delta/max * 1000)/10;\n\n  if (max == min)\n    h = 0;\n  else if (r == max)\n    h = (g - b) / delta;\n  else if (g == max)\n    h = 2 + (b - r) / delta;\n  else if (b == max)\n    h = 4 + (r - g) / delta;\n\n  h = Math.min(h * 60, 360);\n\n  if (h < 0)\n    h += 360;\n\n  v = ((max / 255) * 1000) / 10;\n\n  return [h, s, v];\n}\n\nfunction rgb2hwb(rgb) {\n  var r = rgb[0],\n      g = rgb[1],\n      b = rgb[2],\n      h = rgb2hsl(rgb)[0],\n      w = 1/255 * Math.min(r, Math.min(g, b)),\n      b = 1 - 1/255 * Math.max(r, Math.max(g, b));\n\n  return [h, w * 100, b * 100];\n}\n\nfunction rgb2cmyk(rgb) {\n  var r = rgb[0] / 255,\n      g = rgb[1] / 255,\n      b = rgb[2] / 255,\n      c, m, y, k;\n\n  k = Math.min(1 - r, 1 - g, 1 - b);\n  c = (1 - r - k) / (1 - k) || 0;\n  m = (1 - g - k) / (1 - k) || 0;\n  y = (1 - b - k) / (1 - k) || 0;\n  return [c * 100, m * 100, y * 100, k * 100];\n}\n\nfunction rgb2keyword(rgb) {\n  return reverseKeywords[JSON.stringify(rgb)];\n}\n\nfunction rgb2xyz(rgb) {\n  var r = rgb[0] / 255,\n      g = rgb[1] / 255,\n      b = rgb[2] / 255;\n\n  // assume sRGB\n  r = r > 0.04045 ? Math.pow(((r + 0.055) / 1.055), 2.4) : (r / 12.92);\n  g = g > 0.04045 ? Math.pow(((g + 0.055) / 1.055), 2.4) : (g / 12.92);\n  b = b > 0.04045 ? Math.pow(((b + 0.055) / 1.055), 2.4) : (b / 12.92);\n\n  var x = (r * 0.4124) + (g * 0.3576) + (b * 0.1805);\n  var y = (r * 0.2126) + (g * 0.7152) + (b * 0.0722);\n  var z = (r * 0.0193) + (g * 0.1192) + (b * 0.9505);\n\n  return [x * 100, y *100, z * 100];\n}\n\nfunction rgb2lab(rgb) {\n  var xyz = rgb2xyz(rgb),\n        x = xyz[0],\n        y = xyz[1],\n        z = xyz[2],\n        l, a, b;\n\n  x /= 95.047;\n  y /= 100;\n  z /= 108.883;\n\n  x = x > 0.008856 ? Math.pow(x, 1/3) : (7.787 * x) + (16 / 116);\n  y = y > 0.008856 ? Math.pow(y, 1/3) : (7.787 * y) + (16 / 116);\n  z = z > 0.008856 ? Math.pow(z, 1/3) : (7.787 * z) + (16 / 116);\n\n  l = (116 * y) - 16;\n  a = 500 * (x - y);\n  b = 200 * (y - z);\n\n  return [l, a, b];\n}\n\nfunction rgb2lch(args) {\n  return lab2lch(rgb2lab(args));\n}\n\nfunction hsl2rgb(hsl) {\n  var h = hsl[0] / 360,\n      s = hsl[1] / 100,\n      l = hsl[2] / 100,\n      t1, t2, t3, rgb, val;\n\n  if (s == 0) {\n    val = l * 255;\n    return [val, val, val];\n  }\n\n  if (l < 0.5)\n    t2 = l * (1 + s);\n  else\n    t2 = l + s - l * s;\n  t1 = 2 * l - t2;\n\n  rgb = [0, 0, 0];\n  for (var i = 0; i < 3; i++) {\n    t3 = h + 1 / 3 * - (i - 1);\n    t3 < 0 && t3++;\n    t3 > 1 && t3--;\n\n    if (6 * t3 < 1)\n      val = t1 + (t2 - t1) * 6 * t3;\n    else if (2 * t3 < 1)\n      val = t2;\n    else if (3 * t3 < 2)\n      val = t1 + (t2 - t1) * (2 / 3 - t3) * 6;\n    else\n      val = t1;\n\n    rgb[i] = val * 255;\n  }\n\n  return rgb;\n}\n\nfunction hsl2hsv(hsl) {\n  var h = hsl[0],\n      s = hsl[1] / 100,\n      l = hsl[2] / 100,\n      sv, v;\n\n  if(l === 0) {\n      // no need to do calc on black\n      // also avoids divide by 0 error\n      return [0, 0, 0];\n  }\n\n  l *= 2;\n  s *= (l <= 1) ? l : 2 - l;\n  v = (l + s) / 2;\n  sv = (2 * s) / (l + s);\n  return [h, sv * 100, v * 100];\n}\n\nfunction hsl2hwb(args) {\n  return rgb2hwb(hsl2rgb(args));\n}\n\nfunction hsl2cmyk(args) {\n  return rgb2cmyk(hsl2rgb(args));\n}\n\nfunction hsl2keyword(args) {\n  return rgb2keyword(hsl2rgb(args));\n}\n\n\nfunction hsv2rgb(hsv) {\n  var h = hsv[0] / 60,\n      s = hsv[1] / 100,\n      v = hsv[2] / 100,\n      hi = Math.floor(h) % 6;\n\n  var f = h - Math.floor(h),\n      p = 255 * v * (1 - s),\n      q = 255 * v * (1 - (s * f)),\n      t = 255 * v * (1 - (s * (1 - f))),\n      v = 255 * v;\n\n  switch(hi) {\n    case 0:\n      return [v, t, p];\n    case 1:\n      return [q, v, p];\n    case 2:\n      return [p, v, t];\n    case 3:\n      return [p, q, v];\n    case 4:\n      return [t, p, v];\n    case 5:\n      return [v, p, q];\n  }\n}\n\nfunction hsv2hsl(hsv) {\n  var h = hsv[0],\n      s = hsv[1] / 100,\n      v = hsv[2] / 100,\n      sl, l;\n\n  l = (2 - s) * v;\n  sl = s * v;\n  sl /= (l <= 1) ? l : 2 - l;\n  sl = sl || 0;\n  l /= 2;\n  return [h, sl * 100, l * 100];\n}\n\nfunction hsv2hwb(args) {\n  return rgb2hwb(hsv2rgb(args))\n}\n\nfunction hsv2cmyk(args) {\n  return rgb2cmyk(hsv2rgb(args));\n}\n\nfunction hsv2keyword(args) {\n  return rgb2keyword(hsv2rgb(args));\n}\n\n// http://dev.w3.org/csswg/css-color/#hwb-to-rgb\nfunction hwb2rgb(hwb) {\n  var h = hwb[0] / 360,\n      wh = hwb[1] / 100,\n      bl = hwb[2] / 100,\n      ratio = wh + bl,\n      i, v, f, n;\n\n  // wh + bl cant be > 1\n  if (ratio > 1) {\n    wh /= ratio;\n    bl /= ratio;\n  }\n\n  i = Math.floor(6 * h);\n  v = 1 - bl;\n  f = 6 * h - i;\n  if ((i & 0x01) != 0) {\n    f = 1 - f;\n  }\n  n = wh + f * (v - wh);  // linear interpolation\n\n  switch (i) {\n    default:\n    case 6:\n    case 0: r = v; g = n; b = wh; break;\n    case 1: r = n; g = v; b = wh; break;\n    case 2: r = wh; g = v; b = n; break;\n    case 3: r = wh; g = n; b = v; break;\n    case 4: r = n; g = wh; b = v; break;\n    case 5: r = v; g = wh; b = n; break;\n  }\n\n  return [r * 255, g * 255, b * 255];\n}\n\nfunction hwb2hsl(args) {\n  return rgb2hsl(hwb2rgb(args));\n}\n\nfunction hwb2hsv(args) {\n  return rgb2hsv(hwb2rgb(args));\n}\n\nfunction hwb2cmyk(args) {\n  return rgb2cmyk(hwb2rgb(args));\n}\n\nfunction hwb2keyword(args) {\n  return rgb2keyword(hwb2rgb(args));\n}\n\nfunction cmyk2rgb(cmyk) {\n  var c = cmyk[0] / 100,\n      m = cmyk[1] / 100,\n      y = cmyk[2] / 100,\n      k = cmyk[3] / 100,\n      r, g, b;\n\n  r = 1 - Math.min(1, c * (1 - k) + k);\n  g = 1 - Math.min(1, m * (1 - k) + k);\n  b = 1 - Math.min(1, y * (1 - k) + k);\n  return [r * 255, g * 255, b * 255];\n}\n\nfunction cmyk2hsl(args) {\n  return rgb2hsl(cmyk2rgb(args));\n}\n\nfunction cmyk2hsv(args) {\n  return rgb2hsv(cmyk2rgb(args));\n}\n\nfunction cmyk2hwb(args) {\n  return rgb2hwb(cmyk2rgb(args));\n}\n\nfunction cmyk2keyword(args) {\n  return rgb2keyword(cmyk2rgb(args));\n}\n\n\nfunction xyz2rgb(xyz) {\n  var x = xyz[0] / 100,\n      y = xyz[1] / 100,\n      z = xyz[2] / 100,\n      r, g, b;\n\n  r = (x * 3.2406) + (y * -1.5372) + (z * -0.4986);\n  g = (x * -0.9689) + (y * 1.8758) + (z * 0.0415);\n  b = (x * 0.0557) + (y * -0.2040) + (z * 1.0570);\n\n  // assume sRGB\n  r = r > 0.0031308 ? ((1.055 * Math.pow(r, 1.0 / 2.4)) - 0.055)\n    : r = (r * 12.92);\n\n  g = g > 0.0031308 ? ((1.055 * Math.pow(g, 1.0 / 2.4)) - 0.055)\n    : g = (g * 12.92);\n\n  b = b > 0.0031308 ? ((1.055 * Math.pow(b, 1.0 / 2.4)) - 0.055)\n    : b = (b * 12.92);\n\n  r = Math.min(Math.max(0, r), 1);\n  g = Math.min(Math.max(0, g), 1);\n  b = Math.min(Math.max(0, b), 1);\n\n  return [r * 255, g * 255, b * 255];\n}\n\nfunction xyz2lab(xyz) {\n  var x = xyz[0],\n      y = xyz[1],\n      z = xyz[2],\n      l, a, b;\n\n  x /= 95.047;\n  y /= 100;\n  z /= 108.883;\n\n  x = x > 0.008856 ? Math.pow(x, 1/3) : (7.787 * x) + (16 / 116);\n  y = y > 0.008856 ? Math.pow(y, 1/3) : (7.787 * y) + (16 / 116);\n  z = z > 0.008856 ? Math.pow(z, 1/3) : (7.787 * z) + (16 / 116);\n\n  l = (116 * y) - 16;\n  a = 500 * (x - y);\n  b = 200 * (y - z);\n\n  return [l, a, b];\n}\n\nfunction xyz2lch(args) {\n  return lab2lch(xyz2lab(args));\n}\n\nfunction lab2xyz(lab) {\n  var l = lab[0],\n      a = lab[1],\n      b = lab[2],\n      x, y, z, y2;\n\n  if (l <= 8) {\n    y = (l * 100) / 903.3;\n    y2 = (7.787 * (y / 100)) + (16 / 116);\n  } else {\n    y = 100 * Math.pow((l + 16) / 116, 3);\n    y2 = Math.pow(y / 100, 1/3);\n  }\n\n  x = x / 95.047 <= 0.008856 ? x = (95.047 * ((a / 500) + y2 - (16 / 116))) / 7.787 : 95.047 * Math.pow((a / 500) + y2, 3);\n\n  z = z / 108.883 <= 0.008859 ? z = (108.883 * (y2 - (b / 200) - (16 / 116))) / 7.787 : 108.883 * Math.pow(y2 - (b / 200), 3);\n\n  return [x, y, z];\n}\n\nfunction lab2lch(lab) {\n  var l = lab[0],\n      a = lab[1],\n      b = lab[2],\n      hr, h, c;\n\n  hr = Math.atan2(b, a);\n  h = hr * 360 / 2 / Math.PI;\n  if (h < 0) {\n    h += 360;\n  }\n  c = Math.sqrt(a * a + b * b);\n  return [l, c, h];\n}\n\nfunction lab2rgb(args) {\n  return xyz2rgb(lab2xyz(args));\n}\n\nfunction lch2lab(lch) {\n  var l = lch[0],\n      c = lch[1],\n      h = lch[2],\n      a, b, hr;\n\n  hr = h / 360 * 2 * Math.PI;\n  a = c * Math.cos(hr);\n  b = c * Math.sin(hr);\n  return [l, a, b];\n}\n\nfunction lch2xyz(args) {\n  return lab2xyz(lch2lab(args));\n}\n\nfunction lch2rgb(args) {\n  return lab2rgb(lch2lab(args));\n}\n\nfunction keyword2rgb(keyword) {\n  return cssKeywords[keyword];\n}\n\nfunction keyword2hsl(args) {\n  return rgb2hsl(keyword2rgb(args));\n}\n\nfunction keyword2hsv(args) {\n  return rgb2hsv(keyword2rgb(args));\n}\n\nfunction keyword2hwb(args) {\n  return rgb2hwb(keyword2rgb(args));\n}\n\nfunction keyword2cmyk(args) {\n  return rgb2cmyk(keyword2rgb(args));\n}\n\nfunction keyword2lab(args) {\n  return rgb2lab(keyword2rgb(args));\n}\n\nfunction keyword2xyz(args) {\n  return rgb2xyz(keyword2rgb(args));\n}\n\nvar cssKeywords = {\n  aliceblue:  [240,248,255],\n  antiquewhite: [250,235,215],\n  aqua: [0,255,255],\n  aquamarine: [127,255,212],\n  azure:  [240,255,255],\n  beige:  [245,245,220],\n  bisque: [255,228,196],\n  black:  [0,0,0],\n  blanchedalmond: [255,235,205],\n  blue: [0,0,255],\n  blueviolet: [138,43,226],\n  brown:  [165,42,42],\n  burlywood:  [222,184,135],\n  cadetblue:  [95,158,160],\n  chartreuse: [127,255,0],\n  chocolate:  [210,105,30],\n  coral:  [255,127,80],\n  cornflowerblue: [100,149,237],\n  cornsilk: [255,248,220],\n  crimson:  [220,20,60],\n  cyan: [0,255,255],\n  darkblue: [0,0,139],\n  darkcyan: [0,139,139],\n  darkgoldenrod:  [184,134,11],\n  darkgray: [169,169,169],\n  darkgreen:  [0,100,0],\n  darkgrey: [169,169,169],\n  darkkhaki:  [189,183,107],\n  darkmagenta:  [139,0,139],\n  darkolivegreen: [85,107,47],\n  darkorange: [255,140,0],\n  darkorchid: [153,50,204],\n  darkred:  [139,0,0],\n  darksalmon: [233,150,122],\n  darkseagreen: [143,188,143],\n  darkslateblue:  [72,61,139],\n  darkslategray:  [47,79,79],\n  darkslategrey:  [47,79,79],\n  darkturquoise:  [0,206,209],\n  darkviolet: [148,0,211],\n  deeppink: [255,20,147],\n  deepskyblue:  [0,191,255],\n  dimgray:  [105,105,105],\n  dimgrey:  [105,105,105],\n  dodgerblue: [30,144,255],\n  firebrick:  [178,34,34],\n  floralwhite:  [255,250,240],\n  forestgreen:  [34,139,34],\n  fuchsia:  [255,0,255],\n  gainsboro:  [220,220,220],\n  ghostwhite: [248,248,255],\n  gold: [255,215,0],\n  goldenrod:  [218,165,32],\n  gray: [128,128,128],\n  green:  [0,128,0],\n  greenyellow:  [173,255,47],\n  grey: [128,128,128],\n  honeydew: [240,255,240],\n  hotpink:  [255,105,180],\n  indianred:  [205,92,92],\n  indigo: [75,0,130],\n  ivory:  [255,255,240],\n  khaki:  [240,230,140],\n  lavender: [230,230,250],\n  lavenderblush:  [255,240,245],\n  lawngreen:  [124,252,0],\n  lemonchiffon: [255,250,205],\n  lightblue:  [173,216,230],\n  lightcoral: [240,128,128],\n  lightcyan:  [224,255,255],\n  lightgoldenrodyellow: [250,250,210],\n  lightgray:  [211,211,211],\n  lightgreen: [144,238,144],\n  lightgrey:  [211,211,211],\n  lightpink:  [255,182,193],\n  lightsalmon:  [255,160,122],\n  lightseagreen:  [32,178,170],\n  lightskyblue: [135,206,250],\n  lightslategray: [119,136,153],\n  lightslategrey: [119,136,153],\n  lightsteelblue: [176,196,222],\n  lightyellow:  [255,255,224],\n  lime: [0,255,0],\n  limegreen:  [50,205,50],\n  linen:  [250,240,230],\n  magenta:  [255,0,255],\n  maroon: [128,0,0],\n  mediumaquamarine: [102,205,170],\n  mediumblue: [0,0,205],\n  mediumorchid: [186,85,211],\n  mediumpurple: [147,112,219],\n  mediumseagreen: [60,179,113],\n  mediumslateblue:  [123,104,238],\n  mediumspringgreen:  [0,250,154],\n  mediumturquoise:  [72,209,204],\n  mediumvioletred:  [199,21,133],\n  midnightblue: [25,25,112],\n  mintcream:  [245,255,250],\n  mistyrose:  [255,228,225],\n  moccasin: [255,228,181],\n  navajowhite:  [255,222,173],\n  navy: [0,0,128],\n  oldlace:  [253,245,230],\n  olive:  [128,128,0],\n  olivedrab:  [107,142,35],\n  orange: [255,165,0],\n  orangered:  [255,69,0],\n  orchid: [218,112,214],\n  palegoldenrod:  [238,232,170],\n  palegreen:  [152,251,152],\n  paleturquoise:  [175,238,238],\n  palevioletred:  [219,112,147],\n  papayawhip: [255,239,213],\n  peachpuff:  [255,218,185],\n  peru: [205,133,63],\n  pink: [255,192,203],\n  plum: [221,160,221],\n  powderblue: [176,224,230],\n  purple: [128,0,128],\n  rebeccapurple: [102, 51, 153],\n  red:  [255,0,0],\n  rosybrown:  [188,143,143],\n  royalblue:  [65,105,225],\n  saddlebrown:  [139,69,19],\n  salmon: [250,128,114],\n  sandybrown: [244,164,96],\n  seagreen: [46,139,87],\n  seashell: [255,245,238],\n  sienna: [160,82,45],\n  silver: [192,192,192],\n  skyblue:  [135,206,235],\n  slateblue:  [106,90,205],\n  slategray:  [112,128,144],\n  slategrey:  [112,128,144],\n  snow: [255,250,250],\n  springgreen:  [0,255,127],\n  steelblue:  [70,130,180],\n  tan:  [210,180,140],\n  teal: [0,128,128],\n  thistle:  [216,191,216],\n  tomato: [255,99,71],\n  turquoise:  [64,224,208],\n  violet: [238,130,238],\n  wheat:  [245,222,179],\n  white:  [255,255,255],\n  whitesmoke: [245,245,245],\n  yellow: [255,255,0],\n  yellowgreen:  [154,205,50]\n};\n\nvar reverseKeywords = {};\nfor (var key in cssKeywords) {\n  reverseKeywords[JSON.stringify(cssKeywords[key])] = key;\n}\n",
    "var conversions = require(\"./conversions\");\n\nvar convert = function() {\n   return new Converter();\n}\n\nfor (var func in conversions) {\n  // export Raw versions\n  convert[func + \"Raw\"] =  (function(func) {\n    // accept array or plain args\n    return function(arg) {\n      if (typeof arg == \"number\")\n        arg = Array.prototype.slice.call(arguments);\n      return conversions[func](arg);\n    }\n  })(func);\n\n  var pair = /(\\w+)2(\\w+)/.exec(func),\n      from = pair[1],\n      to = pair[2];\n\n  // export rgb2hsl and [\"rgb\"][\"hsl\"]\n  convert[from] = convert[from] || {};\n\n  convert[from][to] = convert[func] = (function(func) { \n    return function(arg) {\n      if (typeof arg == \"number\")\n        arg = Array.prototype.slice.call(arguments);\n      \n      var val = conversions[func](arg);\n      if (typeof val == \"string\" || val === undefined)\n        return val; // keyword\n\n      for (var i = 0; i < val.length; i++)\n        val[i] = Math.round(val[i]);\n      return val;\n    }\n  })(func);\n}\n\n\n/* Converter does lazy conversion and caching */\nvar Converter = function() {\n   this.convs = {};\n};\n\n/* Either get the values for a space or\n  set the values for a space, depending on args */\nConverter.prototype.routeSpace = function(space, args) {\n   var values = args[0];\n   if (values === undefined) {\n      // color.rgb()\n      return this.getValues(space);\n   }\n   // color.rgb(10, 10, 10)\n   if (typeof values == \"number\") {\n      values = Array.prototype.slice.call(args);        \n   }\n\n   return this.setValues(space, values);\n};\n  \n/* Set the values for a space, invalidating cache */\nConverter.prototype.setValues = function(space, values) {\n   this.space = space;\n   this.convs = {};\n   this.convs[space] = values;\n   return this;\n};\n\n/* Get the values for a space. If there's already\n  a conversion for the space, fetch it, otherwise\n  compute it */\nConverter.prototype.getValues = function(space) {\n   var vals = this.convs[space];\n   if (!vals) {\n      var fspace = this.space,\n          from = this.convs[fspace];\n      vals = convert[fspace][space](from);\n\n      this.convs[space] = vals;\n   }\n  return vals;\n};\n\n[\"rgb\", \"hsl\", \"hsv\", \"cmyk\", \"keyword\"].forEach(function(space) {\n   Converter.prototype[space] = function(vals) {\n      return this.routeSpace(space, arguments);\n   }\n});\n\nmodule.exports = convert;",
    "/* MIT license */\nvar colorNames = require('color-name');\n\nmodule.exports = {\n   getRgba: getRgba,\n   getHsla: getHsla,\n   getRgb: getRgb,\n   getHsl: getHsl,\n   getHwb: getHwb,\n   getAlpha: getAlpha,\n\n   hexString: hexString,\n   rgbString: rgbString,\n   rgbaString: rgbaString,\n   percentString: percentString,\n   percentaString: percentaString,\n   hslString: hslString,\n   hslaString: hslaString,\n   hwbString: hwbString,\n   keyword: keyword\n}\n\nfunction getRgba(string) {\n   if (!string) {\n      return;\n   }\n   var abbr =  /^#([a-fA-F0-9]{3})$/,\n       hex =  /^#([a-fA-F0-9]{6})$/,\n       rgba = /^rgba?\\(\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*,\\s*([+-]?\\d+)\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/,\n       per = /^rgba?\\(\\s*([+-]?[\\d\\.]+)\\%\\s*,\\s*([+-]?[\\d\\.]+)\\%\\s*,\\s*([+-]?[\\d\\.]+)\\%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)$/,\n       keyword = /(\\D+)/;\n\n   var rgb = [0, 0, 0],\n       a = 1,\n       match = string.match(abbr);\n   if (match) {\n      match = match[1];\n      for (var i = 0; i < rgb.length; i++) {\n         rgb[i] = parseInt(match[i] + match[i], 16);\n      }\n   }\n   else if (match = string.match(hex)) {\n      match = match[1];\n      for (var i = 0; i < rgb.length; i++) {\n         rgb[i] = parseInt(match.slice(i * 2, i * 2 + 2), 16);\n      }\n   }\n   else if (match = string.match(rgba)) {\n      for (var i = 0; i < rgb.length; i++) {\n         rgb[i] = parseInt(match[i + 1]);\n      }\n      a = parseFloat(match[4]);\n   }\n   else if (match = string.match(per)) {\n      for (var i = 0; i < rgb.length; i++) {\n         rgb[i] = Math.round(parseFloat(match[i + 1]) * 2.55);\n      }\n      a = parseFloat(match[4]);\n   }\n   else if (match = string.match(keyword)) {\n      if (match[1] == \"transparent\") {\n         return [0, 0, 0, 0];\n      }\n      rgb = colorNames[match[1]];\n      if (!rgb) {\n         return;\n      }\n   }\n\n   for (var i = 0; i < rgb.length; i++) {\n      rgb[i] = scale(rgb[i], 0, 255);\n   }\n   if (!a && a != 0) {\n      a = 1;\n   }\n   else {\n      a = scale(a, 0, 1);\n   }\n   rgb[3] = a;\n   return rgb;\n}\n\nfunction getHsla(string) {\n   if (!string) {\n      return;\n   }\n   var hsl = /^hsla?\\(\\s*([+-]?\\d+)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)/;\n   var match = string.match(hsl);\n   if (match) {\n      var alpha = parseFloat(match[4]);\n      var h = scale(parseInt(match[1]), 0, 360),\n          s = scale(parseFloat(match[2]), 0, 100),\n          l = scale(parseFloat(match[3]), 0, 100),\n          a = scale(isNaN(alpha) ? 1 : alpha, 0, 1);\n      return [h, s, l, a];\n   }\n}\n\nfunction getHwb(string) {\n   if (!string) {\n      return;\n   }\n   var hwb = /^hwb\\(\\s*([+-]?\\d+)(?:deg)?\\s*,\\s*([+-]?[\\d\\.]+)%\\s*,\\s*([+-]?[\\d\\.]+)%\\s*(?:,\\s*([+-]?[\\d\\.]+)\\s*)?\\)/;\n   var match = string.match(hwb);\n   if (match) {\n    var alpha = parseFloat(match[4]);\n      var h = scale(parseInt(match[1]), 0, 360),\n          w = scale(parseFloat(match[2]), 0, 100),\n          b = scale(parseFloat(match[3]), 0, 100),\n          a = scale(isNaN(alpha) ? 1 : alpha, 0, 1);\n      return [h, w, b, a];\n   }\n}\n\nfunction getRgb(string) {\n   var rgba = getRgba(string);\n   return rgba && rgba.slice(0, 3);\n}\n\nfunction getHsl(string) {\n  var hsla = getHsla(string);\n  return hsla && hsla.slice(0, 3);\n}\n\nfunction getAlpha(string) {\n   var vals = getRgba(string);\n   if (vals) {\n      return vals[3];\n   }\n   else if (vals = getHsla(string)) {\n      return vals[3];\n   }\n   else if (vals = getHwb(string)) {\n      return vals[3];\n   }\n}\n\n// generators\nfunction hexString(rgb) {\n   return \"#\" + hexDouble(rgb[0]) + hexDouble(rgb[1])\n              + hexDouble(rgb[2]);\n}\n\nfunction rgbString(rgba, alpha) {\n   if (alpha < 1 || (rgba[3] && rgba[3] < 1)) {\n      return rgbaString(rgba, alpha);\n   }\n   return \"rgb(\" + rgba[0] + \", \" + rgba[1] + \", \" + rgba[2] + \")\";\n}\n\nfunction rgbaString(rgba, alpha) {\n   if (alpha === undefined) {\n      alpha = (rgba[3] !== undefined ? rgba[3] : 1);\n   }\n   return \"rgba(\" + rgba[0] + \", \" + rgba[1] + \", \" + rgba[2]\n           + \", \" + alpha + \")\";\n}\n\nfunction percentString(rgba, alpha) {\n   if (alpha < 1 || (rgba[3] && rgba[3] < 1)) {\n      return percentaString(rgba, alpha);\n   }\n   var r = Math.round(rgba[0]/255 * 100),\n       g = Math.round(rgba[1]/255 * 100),\n       b = Math.round(rgba[2]/255 * 100);\n\n   return \"rgb(\" + r + \"%, \" + g + \"%, \" + b + \"%)\";\n}\n\nfunction percentaString(rgba, alpha) {\n   var r = Math.round(rgba[0]/255 * 100),\n       g = Math.round(rgba[1]/255 * 100),\n       b = Math.round(rgba[2]/255 * 100);\n   return \"rgba(\" + r + \"%, \" + g + \"%, \" + b + \"%, \" + (alpha || rgba[3] || 1) + \")\";\n}\n\nfunction hslString(hsla, alpha) {\n   if (alpha < 1 || (hsla[3] && hsla[3] < 1)) {\n      return hslaString(hsla, alpha);\n   }\n   return \"hsl(\" + hsla[0] + \", \" + hsla[1] + \"%, \" + hsla[2] + \"%)\";\n}\n\nfunction hslaString(hsla, alpha) {\n   if (alpha === undefined) {\n      alpha = (hsla[3] !== undefined ? hsla[3] : 1);\n   }\n   return \"hsla(\" + hsla[0] + \", \" + hsla[1] + \"%, \" + hsla[2] + \"%, \"\n           + alpha + \")\";\n}\n\n// hwb is a bit different than rgb(a) & hsl(a) since there is no alpha specific syntax\n// (hwb have alpha optional & 1 is default value)\nfunction hwbString(hwb, alpha) {\n   if (alpha === undefined) {\n      alpha = (hwb[3] !== undefined ? hwb[3] : 1);\n   }\n   return \"hwb(\" + hwb[0] + \", \" + hwb[1] + \"%, \" + hwb[2] + \"%\"\n           + (alpha !== undefined && alpha !== 1 ? \", \" + alpha : \"\") + \")\";\n}\n\nfunction keyword(rgb) {\n  return reverseNames[rgb.slice(0, 3)];\n}\n\n// helpers\nfunction scale(num, min, max) {\n   return Math.min(Math.max(min, num), max);\n}\n\nfunction hexDouble(num) {\n  var str = num.toString(16).toUpperCase();\n  return (str.length < 2) ? \"0\" + str : str;\n}\n\n\n//create a list of reverse color names\nvar reverseNames = {};\nfor (var name in colorNames) {\n   reverseNames[colorNames[name]] = name;\n}\n",
    "module.exports={\r\n\t\"aliceblue\": [240, 248, 255],\r\n\t\"antiquewhite\": [250, 235, 215],\r\n\t\"aqua\": [0, 255, 255],\r\n\t\"aquamarine\": [127, 255, 212],\r\n\t\"azure\": [240, 255, 255],\r\n\t\"beige\": [245, 245, 220],\r\n\t\"bisque\": [255, 228, 196],\r\n\t\"black\": [0, 0, 0],\r\n\t\"blanchedalmond\": [255, 235, 205],\r\n\t\"blue\": [0, 0, 255],\r\n\t\"blueviolet\": [138, 43, 226],\r\n\t\"brown\": [165, 42, 42],\r\n\t\"burlywood\": [222, 184, 135],\r\n\t\"cadetblue\": [95, 158, 160],\r\n\t\"chartreuse\": [127, 255, 0],\r\n\t\"chocolate\": [210, 105, 30],\r\n\t\"coral\": [255, 127, 80],\r\n\t\"cornflowerblue\": [100, 149, 237],\r\n\t\"cornsilk\": [255, 248, 220],\r\n\t\"crimson\": [220, 20, 60],\r\n\t\"cyan\": [0, 255, 255],\r\n\t\"darkblue\": [0, 0, 139],\r\n\t\"darkcyan\": [0, 139, 139],\r\n\t\"darkgoldenrod\": [184, 134, 11],\r\n\t\"darkgray\": [169, 169, 169],\r\n\t\"darkgreen\": [0, 100, 0],\r\n\t\"darkgrey\": [169, 169, 169],\r\n\t\"darkkhaki\": [189, 183, 107],\r\n\t\"darkmagenta\": [139, 0, 139],\r\n\t\"darkolivegreen\": [85, 107, 47],\r\n\t\"darkorange\": [255, 140, 0],\r\n\t\"darkorchid\": [153, 50, 204],\r\n\t\"darkred\": [139, 0, 0],\r\n\t\"darksalmon\": [233, 150, 122],\r\n\t\"darkseagreen\": [143, 188, 143],\r\n\t\"darkslateblue\": [72, 61, 139],\r\n\t\"darkslategray\": [47, 79, 79],\r\n\t\"darkslategrey\": [47, 79, 79],\r\n\t\"darkturquoise\": [0, 206, 209],\r\n\t\"darkviolet\": [148, 0, 211],\r\n\t\"deeppink\": [255, 20, 147],\r\n\t\"deepskyblue\": [0, 191, 255],\r\n\t\"dimgray\": [105, 105, 105],\r\n\t\"dimgrey\": [105, 105, 105],\r\n\t\"dodgerblue\": [30, 144, 255],\r\n\t\"firebrick\": [178, 34, 34],\r\n\t\"floralwhite\": [255, 250, 240],\r\n\t\"forestgreen\": [34, 139, 34],\r\n\t\"fuchsia\": [255, 0, 255],\r\n\t\"gainsboro\": [220, 220, 220],\r\n\t\"ghostwhite\": [248, 248, 255],\r\n\t\"gold\": [255, 215, 0],\r\n\t\"goldenrod\": [218, 165, 32],\r\n\t\"gray\": [128, 128, 128],\r\n\t\"green\": [0, 128, 0],\r\n\t\"greenyellow\": [173, 255, 47],\r\n\t\"grey\": [128, 128, 128],\r\n\t\"honeydew\": [240, 255, 240],\r\n\t\"hotpink\": [255, 105, 180],\r\n\t\"indianred\": [205, 92, 92],\r\n\t\"indigo\": [75, 0, 130],\r\n\t\"ivory\": [255, 255, 240],\r\n\t\"khaki\": [240, 230, 140],\r\n\t\"lavender\": [230, 230, 250],\r\n\t\"lavenderblush\": [255, 240, 245],\r\n\t\"lawngreen\": [124, 252, 0],\r\n\t\"lemonchiffon\": [255, 250, 205],\r\n\t\"lightblue\": [173, 216, 230],\r\n\t\"lightcoral\": [240, 128, 128],\r\n\t\"lightcyan\": [224, 255, 255],\r\n\t\"lightgoldenrodyellow\": [250, 250, 210],\r\n\t\"lightgray\": [211, 211, 211],\r\n\t\"lightgreen\": [144, 238, 144],\r\n\t\"lightgrey\": [211, 211, 211],\r\n\t\"lightpink\": [255, 182, 193],\r\n\t\"lightsalmon\": [255, 160, 122],\r\n\t\"lightseagreen\": [32, 178, 170],\r\n\t\"lightskyblue\": [135, 206, 250],\r\n\t\"lightslategray\": [119, 136, 153],\r\n\t\"lightslategrey\": [119, 136, 153],\r\n\t\"lightsteelblue\": [176, 196, 222],\r\n\t\"lightyellow\": [255, 255, 224],\r\n\t\"lime\": [0, 255, 0],\r\n\t\"limegreen\": [50, 205, 50],\r\n\t\"linen\": [250, 240, 230],\r\n\t\"magenta\": [255, 0, 255],\r\n\t\"maroon\": [128, 0, 0],\r\n\t\"mediumaquamarine\": [102, 205, 170],\r\n\t\"mediumblue\": [0, 0, 205],\r\n\t\"mediumorchid\": [186, 85, 211],\r\n\t\"mediumpurple\": [147, 112, 219],\r\n\t\"mediumseagreen\": [60, 179, 113],\r\n\t\"mediumslateblue\": [123, 104, 238],\r\n\t\"mediumspringgreen\": [0, 250, 154],\r\n\t\"mediumturquoise\": [72, 209, 204],\r\n\t\"mediumvioletred\": [199, 21, 133],\r\n\t\"midnightblue\": [25, 25, 112],\r\n\t\"mintcream\": [245, 255, 250],\r\n\t\"mistyrose\": [255, 228, 225],\r\n\t\"moccasin\": [255, 228, 181],\r\n\t\"navajowhite\": [255, 222, 173],\r\n\t\"navy\": [0, 0, 128],\r\n\t\"oldlace\": [253, 245, 230],\r\n\t\"olive\": [128, 128, 0],\r\n\t\"olivedrab\": [107, 142, 35],\r\n\t\"orange\": [255, 165, 0],\r\n\t\"orangered\": [255, 69, 0],\r\n\t\"orchid\": [218, 112, 214],\r\n\t\"palegoldenrod\": [238, 232, 170],\r\n\t\"palegreen\": [152, 251, 152],\r\n\t\"paleturquoise\": [175, 238, 238],\r\n\t\"palevioletred\": [219, 112, 147],\r\n\t\"papayawhip\": [255, 239, 213],\r\n\t\"peachpuff\": [255, 218, 185],\r\n\t\"peru\": [205, 133, 63],\r\n\t\"pink\": [255, 192, 203],\r\n\t\"plum\": [221, 160, 221],\r\n\t\"powderblue\": [176, 224, 230],\r\n\t\"purple\": [128, 0, 128],\r\n\t\"rebeccapurple\": [102, 51, 153],\r\n\t\"red\": [255, 0, 0],\r\n\t\"rosybrown\": [188, 143, 143],\r\n\t\"royalblue\": [65, 105, 225],\r\n\t\"saddlebrown\": [139, 69, 19],\r\n\t\"salmon\": [250, 128, 114],\r\n\t\"sandybrown\": [244, 164, 96],\r\n\t\"seagreen\": [46, 139, 87],\r\n\t\"seashell\": [255, 245, 238],\r\n\t\"sienna\": [160, 82, 45],\r\n\t\"silver\": [192, 192, 192],\r\n\t\"skyblue\": [135, 206, 235],\r\n\t\"slateblue\": [106, 90, 205],\r\n\t\"slategray\": [112, 128, 144],\r\n\t\"slategrey\": [112, 128, 144],\r\n\t\"snow\": [255, 250, 250],\r\n\t\"springgreen\": [0, 255, 127],\r\n\t\"steelblue\": [70, 130, 180],\r\n\t\"tan\": [210, 180, 140],\r\n\t\"teal\": [0, 128, 128],\r\n\t\"thistle\": [216, 191, 216],\r\n\t\"tomato\": [255, 99, 71],\r\n\t\"turquoise\": [64, 224, 208],\r\n\t\"violet\": [238, 130, 238],\r\n\t\"wheat\": [245, 222, 179],\r\n\t\"white\": [255, 255, 255],\r\n\t\"whitesmoke\": [245, 245, 245],\r\n\t\"yellow\": [255, 255, 0],\r\n\t\"yellowgreen\": [154, 205, 50]\r\n}",
    "/*\r\n * Cookies.js - 1.2.3\r\n * https://github.com/ScottHamper/Cookies\r\n *\r\n * This is free and unencumbered software released into the public domain.\r\n */\r\n(function (global, undefined) {\r\n    'use strict';\r\n\r\n    var factory = function (window) {\r\n        if (typeof window.document !== 'object') {\r\n            throw new Error('Cookies.js requires a `window` with a `document` object');\r\n        }\r\n\r\n        var Cookies = function (key, value, options) {\r\n            return arguments.length === 1 ?\r\n                Cookies.get(key) : Cookies.set(key, value, options);\r\n        };\r\n\r\n        // Allows for setter injection in unit tests\r\n        Cookies._document = window.document;\r\n\r\n        // Used to ensure cookie keys do not collide with\r\n        // built-in `Object` properties\r\n        Cookies._cacheKeyPrefix = 'cookey.'; // Hurr hurr, :)\r\n        \r\n        Cookies._maxExpireDate = new Date('Fri, 31 Dec 9999 23:59:59 UTC');\r\n\r\n        Cookies.defaults = {\r\n            path: '/',\r\n            secure: false\r\n        };\r\n\r\n        Cookies.get = function (key) {\r\n            if (Cookies._cachedDocumentCookie !== Cookies._document.cookie) {\r\n                Cookies._renewCache();\r\n            }\r\n            \r\n            var value = Cookies._cache[Cookies._cacheKeyPrefix + key];\r\n\r\n            return value === undefined ? undefined : decodeURIComponent(value);\r\n        };\r\n\r\n        Cookies.set = function (key, value, options) {\r\n            options = Cookies._getExtendedOptions(options);\r\n            options.expires = Cookies._getExpiresDate(value === undefined ? -1 : options.expires);\r\n\r\n            Cookies._document.cookie = Cookies._generateCookieString(key, value, options);\r\n\r\n            return Cookies;\r\n        };\r\n\r\n        Cookies.expire = function (key, options) {\r\n            return Cookies.set(key, undefined, options);\r\n        };\r\n\r\n        Cookies._getExtendedOptions = function (options) {\r\n            return {\r\n                path: options && options.path || Cookies.defaults.path,\r\n                domain: options && options.domain || Cookies.defaults.domain,\r\n                expires: options && options.expires || Cookies.defaults.expires,\r\n                secure: options && options.secure !== undefined ?  options.secure : Cookies.defaults.secure\r\n            };\r\n        };\r\n\r\n        Cookies._isValidDate = function (date) {\r\n            return Object.prototype.toString.call(date) === '[object Date]' && !isNaN(date.getTime());\r\n        };\r\n\r\n        Cookies._getExpiresDate = function (expires, now) {\r\n            now = now || new Date();\r\n\r\n            if (typeof expires === 'number') {\r\n                expires = expires === Infinity ?\r\n                    Cookies._maxExpireDate : new Date(now.getTime() + expires * 1000);\r\n            } else if (typeof expires === 'string') {\r\n                expires = new Date(expires);\r\n            }\r\n\r\n            if (expires && !Cookies._isValidDate(expires)) {\r\n                throw new Error('`expires` parameter cannot be converted to a valid Date instance');\r\n            }\r\n\r\n            return expires;\r\n        };\r\n\r\n        Cookies._generateCookieString = function (key, value, options) {\r\n            key = key.replace(/[^#$&+\\^`|]/g, encodeURIComponent);\r\n            key = key.replace(/\\(/g, '%28').replace(/\\)/g, '%29');\r\n            value = (value + '').replace(/[^!#$&-+\\--:<-\\[\\]-~]/g, encodeURIComponent);\r\n            options = options || {};\r\n\r\n            var cookieString = key + '=' + value;\r\n            cookieString += options.path ? ';path=' + options.path : '';\r\n            cookieString += options.domain ? ';domain=' + options.domain : '';\r\n            cookieString += options.expires ? ';expires=' + options.expires.toUTCString() : '';\r\n            cookieString += options.secure ? ';secure' : '';\r\n\r\n            return cookieString;\r\n        };\r\n\r\n        Cookies._getCacheFromString = function (documentCookie) {\r\n            var cookieCache = {};\r\n            var cookiesArray = documentCookie ? documentCookie.split('; ') : [];\r\n\r\n            for (var i = 0; i < cookiesArray.length; i++) {\r\n                var cookieKvp = Cookies._getKeyValuePairFromCookieString(cookiesArray[i]);\r\n\r\n                if (cookieCache[Cookies._cacheKeyPrefix + cookieKvp.key] === undefined) {\r\n                    cookieCache[Cookies._cacheKeyPrefix + cookieKvp.key] = cookieKvp.value;\r\n                }\r\n            }\r\n\r\n            return cookieCache;\r\n        };\r\n\r\n        Cookies._getKeyValuePairFromCookieString = function (cookieString) {\r\n            // \"=\" is a valid character in a cookie value according to RFC6265, so cannot `split('=')`\r\n            var separatorIndex = cookieString.indexOf('=');\r\n\r\n            // IE omits the \"=\" when the cookie value is an empty string\r\n            separatorIndex = separatorIndex < 0 ? cookieString.length : separatorIndex;\r\n\r\n            var key = cookieString.substr(0, separatorIndex);\r\n            var decodedKey;\r\n            try {\r\n                decodedKey = decodeURIComponent(key);\r\n            } catch (e) {\r\n                if (console && typeof console.error === 'function') {\r\n                    console.error('Could not decode cookie with key \"' + key + '\"', e);\r\n                }\r\n            }\r\n            \r\n            return {\r\n                key: decodedKey,\r\n                value: cookieString.substr(separatorIndex + 1) // Defer decoding value until accessed\r\n            };\r\n        };\r\n\r\n        Cookies._renewCache = function () {\r\n            Cookies._cache = Cookies._getCacheFromString(Cookies._document.cookie);\r\n            Cookies._cachedDocumentCookie = Cookies._document.cookie;\r\n        };\r\n\r\n        Cookies._areEnabled = function () {\r\n            var testKey = 'cookies.js';\r\n            var areEnabled = Cookies.set(testKey, 1).get(testKey) === '1';\r\n            Cookies.expire(testKey);\r\n            return areEnabled;\r\n        };\r\n\r\n        Cookies.enabled = Cookies._areEnabled();\r\n\r\n        return Cookies;\r\n    };\r\n    var cookiesExport = (global && typeof global.document === 'object') ? factory(global) : factory;\r\n\r\n    // AMD support\r\n    if (typeof define === 'function' && define.amd) {\r\n        define(function () { return cookiesExport; });\r\n    // CommonJS/Node.js support\r\n    } else if (typeof exports === 'object') {\r\n        // Support Node.js specific `module.exports` (which can be a function)\r\n        if (typeof module === 'object' && typeof module.exports === 'object') {\r\n            exports = module.exports = cookiesExport;\r\n        }\r\n        // But always support CommonJS module 1.1.1 spec (`exports` cannot be a function)\r\n        exports.Cookies = cookiesExport;\r\n    } else {\r\n        global.Cookies = cookiesExport;\r\n    }\r\n})(typeof window === 'undefined' ? this : window);",
    "/*! Hammer.JS - v2.0.7 - 2016-04-22\n * http://hammerjs.github.io/\n *\n * Copyright (c) 2016 Jorik Tangelder;\n * Licensed under the MIT license */\n(function(window, document, exportName, undefined) {\n  'use strict';\n\nvar VENDOR_PREFIXES = ['', 'webkit', 'Moz', 'MS', 'ms', 'o'];\nvar TEST_ELEMENT = document.createElement('div');\n\nvar TYPE_FUNCTION = 'function';\n\nvar round = Math.round;\nvar abs = Math.abs;\nvar now = Date.now;\n\n/**\n * set a timeout with a given scope\n * @param {Function} fn\n * @param {Number} timeout\n * @param {Object} context\n * @returns {number}\n */\nfunction setTimeoutContext(fn, timeout, context) {\n    return setTimeout(bindFn(fn, context), timeout);\n}\n\n/**\n * if the argument is an array, we want to execute the fn on each entry\n * if it aint an array we don't want to do a thing.\n * this is used by all the methods that accept a single and array argument.\n * @param {*|Array} arg\n * @param {String} fn\n * @param {Object} [context]\n * @returns {Boolean}\n */\nfunction invokeArrayArg(arg, fn, context) {\n    if (Array.isArray(arg)) {\n        each(arg, context[fn], context);\n        return true;\n    }\n    return false;\n}\n\n/**\n * walk objects and arrays\n * @param {Object} obj\n * @param {Function} iterator\n * @param {Object} context\n */\nfunction each(obj, iterator, context) {\n    var i;\n\n    if (!obj) {\n        return;\n    }\n\n    if (obj.forEach) {\n        obj.forEach(iterator, context);\n    } else if (obj.length !== undefined) {\n        i = 0;\n        while (i < obj.length) {\n            iterator.call(context, obj[i], i, obj);\n            i++;\n        }\n    } else {\n        for (i in obj) {\n            obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\n        }\n    }\n}\n\n/**\n * wrap a method with a deprecation warning and stack trace\n * @param {Function} method\n * @param {String} name\n * @param {String} message\n * @returns {Function} A new function wrapping the supplied method.\n */\nfunction deprecate(method, name, message) {\n    var deprecationMessage = 'DEPRECATED METHOD: ' + name + '\\n' + message + ' AT \\n';\n    return function() {\n        var e = new Error('get-stack-trace');\n        var stack = e && e.stack ? e.stack.replace(/^[^\\(]+?[\\n$]/gm, '')\n            .replace(/^\\s+at\\s+/gm, '')\n            .replace(/^Object.<anonymous>\\s*\\(/gm, '{anonymous}()@') : 'Unknown Stack Trace';\n\n        var log = window.console && (window.console.warn || window.console.log);\n        if (log) {\n            log.call(window.console, deprecationMessage, stack);\n        }\n        return method.apply(this, arguments);\n    };\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} target\n * @param {...Object} objects_to_assign\n * @returns {Object} target\n */\nvar assign;\nif (typeof Object.assign !== 'function') {\n    assign = function assign(target) {\n        if (target === undefined || target === null) {\n            throw new TypeError('Cannot convert undefined or null to object');\n        }\n\n        var output = Object(target);\n        for (var index = 1; index < arguments.length; index++) {\n            var source = arguments[index];\n            if (source !== undefined && source !== null) {\n                for (var nextKey in source) {\n                    if (source.hasOwnProperty(nextKey)) {\n                        output[nextKey] = source[nextKey];\n                    }\n                }\n            }\n        }\n        return output;\n    };\n} else {\n    assign = Object.assign;\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} dest\n * @param {Object} src\n * @param {Boolean} [merge=false]\n * @returns {Object} dest\n */\nvar extend = deprecate(function extend(dest, src, merge) {\n    var keys = Object.keys(src);\n    var i = 0;\n    while (i < keys.length) {\n        if (!merge || (merge && dest[keys[i]] === undefined)) {\n            dest[keys[i]] = src[keys[i]];\n        }\n        i++;\n    }\n    return dest;\n}, 'extend', 'Use `assign`.');\n\n/**\n * merge the values from src in the dest.\n * means that properties that exist in dest will not be overwritten by src\n * @param {Object} dest\n * @param {Object} src\n * @returns {Object} dest\n */\nvar merge = deprecate(function merge(dest, src) {\n    return extend(dest, src, true);\n}, 'merge', 'Use `assign`.');\n\n/**\n * simple class inheritance\n * @param {Function} child\n * @param {Function} base\n * @param {Object} [properties]\n */\nfunction inherit(child, base, properties) {\n    var baseP = base.prototype,\n        childP;\n\n    childP = child.prototype = Object.create(baseP);\n    childP.constructor = child;\n    childP._super = baseP;\n\n    if (properties) {\n        assign(childP, properties);\n    }\n}\n\n/**\n * simple function bind\n * @param {Function} fn\n * @param {Object} context\n * @returns {Function}\n */\nfunction bindFn(fn, context) {\n    return function boundFn() {\n        return fn.apply(context, arguments);\n    };\n}\n\n/**\n * let a boolean value also be a function that must return a boolean\n * this first item in args will be used as the context\n * @param {Boolean|Function} val\n * @param {Array} [args]\n * @returns {Boolean}\n */\nfunction boolOrFn(val, args) {\n    if (typeof val == TYPE_FUNCTION) {\n        return val.apply(args ? args[0] || undefined : undefined, args);\n    }\n    return val;\n}\n\n/**\n * use the val2 when val1 is undefined\n * @param {*} val1\n * @param {*} val2\n * @returns {*}\n */\nfunction ifUndefined(val1, val2) {\n    return (val1 === undefined) ? val2 : val1;\n}\n\n/**\n * addEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction addEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.addEventListener(type, handler, false);\n    });\n}\n\n/**\n * removeEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction removeEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.removeEventListener(type, handler, false);\n    });\n}\n\n/**\n * find if a node is in the given parent\n * @method hasParent\n * @param {HTMLElement} node\n * @param {HTMLElement} parent\n * @return {Boolean} found\n */\nfunction hasParent(node, parent) {\n    while (node) {\n        if (node == parent) {\n            return true;\n        }\n        node = node.parentNode;\n    }\n    return false;\n}\n\n/**\n * small indexOf wrapper\n * @param {String} str\n * @param {String} find\n * @returns {Boolean} found\n */\nfunction inStr(str, find) {\n    return str.indexOf(find) > -1;\n}\n\n/**\n * split string on whitespace\n * @param {String} str\n * @returns {Array} words\n */\nfunction splitStr(str) {\n    return str.trim().split(/\\s+/g);\n}\n\n/**\n * find if a array contains the object using indexOf or a simple polyFill\n * @param {Array} src\n * @param {String} find\n * @param {String} [findByKey]\n * @return {Boolean|Number} false when not found, or the index\n */\nfunction inArray(src, find, findByKey) {\n    if (src.indexOf && !findByKey) {\n        return src.indexOf(find);\n    } else {\n        var i = 0;\n        while (i < src.length) {\n            if ((findByKey && src[i][findByKey] == find) || (!findByKey && src[i] === find)) {\n                return i;\n            }\n            i++;\n        }\n        return -1;\n    }\n}\n\n/**\n * convert array-like objects to real arrays\n * @param {Object} obj\n * @returns {Array}\n */\nfunction toArray(obj) {\n    return Array.prototype.slice.call(obj, 0);\n}\n\n/**\n * unique array with objects based on a key (like 'id') or just by the array's value\n * @param {Array} src [{id:1},{id:2},{id:1}]\n * @param {String} [key]\n * @param {Boolean} [sort=False]\n * @returns {Array} [{id:1},{id:2}]\n */\nfunction uniqueArray(src, key, sort) {\n    var results = [];\n    var values = [];\n    var i = 0;\n\n    while (i < src.length) {\n        var val = key ? src[i][key] : src[i];\n        if (inArray(values, val) < 0) {\n            results.push(src[i]);\n        }\n        values[i] = val;\n        i++;\n    }\n\n    if (sort) {\n        if (!key) {\n            results = results.sort();\n        } else {\n            results = results.sort(function sortUniqueArray(a, b) {\n                return a[key] > b[key];\n            });\n        }\n    }\n\n    return results;\n}\n\n/**\n * get the prefixed property\n * @param {Object} obj\n * @param {String} property\n * @returns {String|Undefined} prefixed\n */\nfunction prefixed(obj, property) {\n    var prefix, prop;\n    var camelProp = property[0].toUpperCase() + property.slice(1);\n\n    var i = 0;\n    while (i < VENDOR_PREFIXES.length) {\n        prefix = VENDOR_PREFIXES[i];\n        prop = (prefix) ? prefix + camelProp : property;\n\n        if (prop in obj) {\n            return prop;\n        }\n        i++;\n    }\n    return undefined;\n}\n\n/**\n * get a unique id\n * @returns {number} uniqueId\n */\nvar _uniqueId = 1;\nfunction uniqueId() {\n    return _uniqueId++;\n}\n\n/**\n * get the window object of an element\n * @param {HTMLElement} element\n * @returns {DocumentView|Window}\n */\nfunction getWindowForElement(element) {\n    var doc = element.ownerDocument || element;\n    return (doc.defaultView || doc.parentWindow || window);\n}\n\nvar MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n\nvar SUPPORT_TOUCH = ('ontouchstart' in window);\nvar SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\nvar SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\n\nvar INPUT_TYPE_TOUCH = 'touch';\nvar INPUT_TYPE_PEN = 'pen';\nvar INPUT_TYPE_MOUSE = 'mouse';\nvar INPUT_TYPE_KINECT = 'kinect';\n\nvar COMPUTE_INTERVAL = 25;\n\nvar INPUT_START = 1;\nvar INPUT_MOVE = 2;\nvar INPUT_END = 4;\nvar INPUT_CANCEL = 8;\n\nvar DIRECTION_NONE = 1;\nvar DIRECTION_LEFT = 2;\nvar DIRECTION_RIGHT = 4;\nvar DIRECTION_UP = 8;\nvar DIRECTION_DOWN = 16;\n\nvar DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\nvar DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\nvar DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\n\nvar PROPS_XY = ['x', 'y'];\nvar PROPS_CLIENT_XY = ['clientX', 'clientY'];\n\n/**\n * create new input type manager\n * @param {Manager} manager\n * @param {Function} callback\n * @returns {Input}\n * @constructor\n */\nfunction Input(manager, callback) {\n    var self = this;\n    this.manager = manager;\n    this.callback = callback;\n    this.element = manager.element;\n    this.target = manager.options.inputTarget;\n\n    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\n    // so when disabled the input events are completely bypassed.\n    this.domHandler = function(ev) {\n        if (boolOrFn(manager.options.enable, [manager])) {\n            self.handler(ev);\n        }\n    };\n\n    this.init();\n\n}\n\nInput.prototype = {\n    /**\n     * should handle the inputEvent data and trigger the callback\n     * @virtual\n     */\n    handler: function() { },\n\n    /**\n     * bind the events\n     */\n    init: function() {\n        this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    },\n\n    /**\n     * unbind the events\n     */\n    destroy: function() {\n        this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    }\n};\n\n/**\n * create new input type manager\n * called by the Manager constructor\n * @param {Hammer} manager\n * @returns {Input}\n */\nfunction createInputInstance(manager) {\n    var Type;\n    var inputClass = manager.options.inputClass;\n\n    if (inputClass) {\n        Type = inputClass;\n    } else if (SUPPORT_POINTER_EVENTS) {\n        Type = PointerEventInput;\n    } else if (SUPPORT_ONLY_TOUCH) {\n        Type = TouchInput;\n    } else if (!SUPPORT_TOUCH) {\n        Type = MouseInput;\n    } else {\n        Type = TouchMouseInput;\n    }\n    return new (Type)(manager, inputHandler);\n}\n\n/**\n * handle input events\n * @param {Manager} manager\n * @param {String} eventType\n * @param {Object} input\n */\nfunction inputHandler(manager, eventType, input) {\n    var pointersLen = input.pointers.length;\n    var changedPointersLen = input.changedPointers.length;\n    var isFirst = (eventType & INPUT_START && (pointersLen - changedPointersLen === 0));\n    var isFinal = (eventType & (INPUT_END | INPUT_CANCEL) && (pointersLen - changedPointersLen === 0));\n\n    input.isFirst = !!isFirst;\n    input.isFinal = !!isFinal;\n\n    if (isFirst) {\n        manager.session = {};\n    }\n\n    // source event is the normalized value of the domEvents\n    // like 'touchstart, mouseup, pointerdown'\n    input.eventType = eventType;\n\n    // compute scale, rotation etc\n    computeInputData(manager, input);\n\n    // emit secret event\n    manager.emit('hammer.input', input);\n\n    manager.recognize(input);\n    manager.session.prevInput = input;\n}\n\n/**\n * extend the data with some usable properties like scale, rotate, velocity etc\n * @param {Object} manager\n * @param {Object} input\n */\nfunction computeInputData(manager, input) {\n    var session = manager.session;\n    var pointers = input.pointers;\n    var pointersLength = pointers.length;\n\n    // store the first input to calculate the distance and direction\n    if (!session.firstInput) {\n        session.firstInput = simpleCloneInputData(input);\n    }\n\n    // to compute scale and rotation we need to store the multiple touches\n    if (pointersLength > 1 && !session.firstMultiple) {\n        session.firstMultiple = simpleCloneInputData(input);\n    } else if (pointersLength === 1) {\n        session.firstMultiple = false;\n    }\n\n    var firstInput = session.firstInput;\n    var firstMultiple = session.firstMultiple;\n    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\n\n    var center = input.center = getCenter(pointers);\n    input.timeStamp = now();\n    input.deltaTime = input.timeStamp - firstInput.timeStamp;\n\n    input.angle = getAngle(offsetCenter, center);\n    input.distance = getDistance(offsetCenter, center);\n\n    computeDeltaXY(session, input);\n    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\n\n    var overallVelocity = getVelocity(input.deltaTime, input.deltaX, input.deltaY);\n    input.overallVelocityX = overallVelocity.x;\n    input.overallVelocityY = overallVelocity.y;\n    input.overallVelocity = (abs(overallVelocity.x) > abs(overallVelocity.y)) ? overallVelocity.x : overallVelocity.y;\n\n    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\n    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\n\n    input.maxPointers = !session.prevInput ? input.pointers.length : ((input.pointers.length >\n        session.prevInput.maxPointers) ? input.pointers.length : session.prevInput.maxPointers);\n\n    computeIntervalInputData(session, input);\n\n    // find the correct target\n    var target = manager.element;\n    if (hasParent(input.srcEvent.target, target)) {\n        target = input.srcEvent.target;\n    }\n    input.target = target;\n}\n\nfunction computeDeltaXY(session, input) {\n    var center = input.center;\n    var offset = session.offsetDelta || {};\n    var prevDelta = session.prevDelta || {};\n    var prevInput = session.prevInput || {};\n\n    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\n        prevDelta = session.prevDelta = {\n            x: prevInput.deltaX || 0,\n            y: prevInput.deltaY || 0\n        };\n\n        offset = session.offsetDelta = {\n            x: center.x,\n            y: center.y\n        };\n    }\n\n    input.deltaX = prevDelta.x + (center.x - offset.x);\n    input.deltaY = prevDelta.y + (center.y - offset.y);\n}\n\n/**\n * velocity is calculated every x ms\n * @param {Object} session\n * @param {Object} input\n */\nfunction computeIntervalInputData(session, input) {\n    var last = session.lastInterval || input,\n        deltaTime = input.timeStamp - last.timeStamp,\n        velocity, velocityX, velocityY, direction;\n\n    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\n        var deltaX = input.deltaX - last.deltaX;\n        var deltaY = input.deltaY - last.deltaY;\n\n        var v = getVelocity(deltaTime, deltaX, deltaY);\n        velocityX = v.x;\n        velocityY = v.y;\n        velocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\n        direction = getDirection(deltaX, deltaY);\n\n        session.lastInterval = input;\n    } else {\n        // use latest velocity info if it doesn't overtake a minimum period\n        velocity = last.velocity;\n        velocityX = last.velocityX;\n        velocityY = last.velocityY;\n        direction = last.direction;\n    }\n\n    input.velocity = velocity;\n    input.velocityX = velocityX;\n    input.velocityY = velocityY;\n    input.direction = direction;\n}\n\n/**\n * create a simple clone from the input used for storage of firstInput and firstMultiple\n * @param {Object} input\n * @returns {Object} clonedInputData\n */\nfunction simpleCloneInputData(input) {\n    // make a simple copy of the pointers because we will get a reference if we don't\n    // we only need clientXY for the calculations\n    var pointers = [];\n    var i = 0;\n    while (i < input.pointers.length) {\n        pointers[i] = {\n            clientX: round(input.pointers[i].clientX),\n            clientY: round(input.pointers[i].clientY)\n        };\n        i++;\n    }\n\n    return {\n        timeStamp: now(),\n        pointers: pointers,\n        center: getCenter(pointers),\n        deltaX: input.deltaX,\n        deltaY: input.deltaY\n    };\n}\n\n/**\n * get the center of all the pointers\n * @param {Array} pointers\n * @return {Object} center contains `x` and `y` properties\n */\nfunction getCenter(pointers) {\n    var pointersLength = pointers.length;\n\n    // no need to loop when only one touch\n    if (pointersLength === 1) {\n        return {\n            x: round(pointers[0].clientX),\n            y: round(pointers[0].clientY)\n        };\n    }\n\n    var x = 0, y = 0, i = 0;\n    while (i < pointersLength) {\n        x += pointers[i].clientX;\n        y += pointers[i].clientY;\n        i++;\n    }\n\n    return {\n        x: round(x / pointersLength),\n        y: round(y / pointersLength)\n    };\n}\n\n/**\n * calculate the velocity between two points. unit is in px per ms.\n * @param {Number} deltaTime\n * @param {Number} x\n * @param {Number} y\n * @return {Object} velocity `x` and `y`\n */\nfunction getVelocity(deltaTime, x, y) {\n    return {\n        x: x / deltaTime || 0,\n        y: y / deltaTime || 0\n    };\n}\n\n/**\n * get the direction between two points\n * @param {Number} x\n * @param {Number} y\n * @return {Number} direction\n */\nfunction getDirection(x, y) {\n    if (x === y) {\n        return DIRECTION_NONE;\n    }\n\n    if (abs(x) >= abs(y)) {\n        return x < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\n    }\n    return y < 0 ? DIRECTION_UP : DIRECTION_DOWN;\n}\n\n/**\n * calculate the absolute distance between two points\n * @param {Object} p1 {x, y}\n * @param {Object} p2 {x, y}\n * @param {Array} [props] containing x and y keys\n * @return {Number} distance\n */\nfunction getDistance(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n\n    return Math.sqrt((x * x) + (y * y));\n}\n\n/**\n * calculate the angle between two coordinates\n * @param {Object} p1\n * @param {Object} p2\n * @param {Array} [props] containing x and y keys\n * @return {Number} angle\n */\nfunction getAngle(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n    return Math.atan2(y, x) * 180 / Math.PI;\n}\n\n/**\n * calculate the rotation degrees between two pointersets\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} rotation\n */\nfunction getRotation(start, end) {\n    return getAngle(end[1], end[0], PROPS_CLIENT_XY) + getAngle(start[1], start[0], PROPS_CLIENT_XY);\n}\n\n/**\n * calculate the scale factor between two pointersets\n * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} scale\n */\nfunction getScale(start, end) {\n    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\n}\n\nvar MOUSE_INPUT_MAP = {\n    mousedown: INPUT_START,\n    mousemove: INPUT_MOVE,\n    mouseup: INPUT_END\n};\n\nvar MOUSE_ELEMENT_EVENTS = 'mousedown';\nvar MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\n\n/**\n * Mouse events input\n * @constructor\n * @extends Input\n */\nfunction MouseInput() {\n    this.evEl = MOUSE_ELEMENT_EVENTS;\n    this.evWin = MOUSE_WINDOW_EVENTS;\n\n    this.pressed = false; // mousedown state\n\n    Input.apply(this, arguments);\n}\n\ninherit(MouseInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function MEhandler(ev) {\n        var eventType = MOUSE_INPUT_MAP[ev.type];\n\n        // on start we want to have the left mouse button down\n        if (eventType & INPUT_START && ev.button === 0) {\n            this.pressed = true;\n        }\n\n        if (eventType & INPUT_MOVE && ev.which !== 1) {\n            eventType = INPUT_END;\n        }\n\n        // mouse must be down\n        if (!this.pressed) {\n            return;\n        }\n\n        if (eventType & INPUT_END) {\n            this.pressed = false;\n        }\n\n        this.callback(this.manager, eventType, {\n            pointers: [ev],\n            changedPointers: [ev],\n            pointerType: INPUT_TYPE_MOUSE,\n            srcEvent: ev\n        });\n    }\n});\n\nvar POINTER_INPUT_MAP = {\n    pointerdown: INPUT_START,\n    pointermove: INPUT_MOVE,\n    pointerup: INPUT_END,\n    pointercancel: INPUT_CANCEL,\n    pointerout: INPUT_CANCEL\n};\n\n// in IE10 the pointer types is defined as an enum\nvar IE10_POINTER_TYPE_ENUM = {\n    2: INPUT_TYPE_TOUCH,\n    3: INPUT_TYPE_PEN,\n    4: INPUT_TYPE_MOUSE,\n    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\n};\n\nvar POINTER_ELEMENT_EVENTS = 'pointerdown';\nvar POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\n\n// IE10 has prefixed support, and case-sensitive\nif (window.MSPointerEvent && !window.PointerEvent) {\n    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\n    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\n}\n\n/**\n * Pointer events input\n * @constructor\n * @extends Input\n */\nfunction PointerEventInput() {\n    this.evEl = POINTER_ELEMENT_EVENTS;\n    this.evWin = POINTER_WINDOW_EVENTS;\n\n    Input.apply(this, arguments);\n\n    this.store = (this.manager.session.pointerEvents = []);\n}\n\ninherit(PointerEventInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function PEhandler(ev) {\n        var store = this.store;\n        var removePointer = false;\n\n        var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\n        var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\n        var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\n\n        var isTouch = (pointerType == INPUT_TYPE_TOUCH);\n\n        // get index of the event in the store\n        var storeIndex = inArray(store, ev.pointerId, 'pointerId');\n\n        // start and mouse must be down\n        if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\n            if (storeIndex < 0) {\n                store.push(ev);\n                storeIndex = store.length - 1;\n            }\n        } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n            removePointer = true;\n        }\n\n        // it not found, so the pointer hasn't been down (so it's probably a hover)\n        if (storeIndex < 0) {\n            return;\n        }\n\n        // update the event in the store\n        store[storeIndex] = ev;\n\n        this.callback(this.manager, eventType, {\n            pointers: store,\n            changedPointers: [ev],\n            pointerType: pointerType,\n            srcEvent: ev\n        });\n\n        if (removePointer) {\n            // remove from the store\n            store.splice(storeIndex, 1);\n        }\n    }\n});\n\nvar SINGLE_TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\nvar SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Touch events input\n * @constructor\n * @extends Input\n */\nfunction SingleTouchInput() {\n    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\n    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\n    this.started = false;\n\n    Input.apply(this, arguments);\n}\n\ninherit(SingleTouchInput, Input, {\n    handler: function TEhandler(ev) {\n        var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\n\n        // should we handle the touch events?\n        if (type === INPUT_START) {\n            this.started = true;\n        }\n\n        if (!this.started) {\n            return;\n        }\n\n        var touches = normalizeSingleTouches.call(this, ev, type);\n\n        // when done, reset the started state\n        if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\n            this.started = false;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction normalizeSingleTouches(ev, type) {\n    var all = toArray(ev.touches);\n    var changed = toArray(ev.changedTouches);\n\n    if (type & (INPUT_END | INPUT_CANCEL)) {\n        all = uniqueArray(all.concat(changed), 'identifier', true);\n    }\n\n    return [all, changed];\n}\n\nvar TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Multi-user touch events input\n * @constructor\n * @extends Input\n */\nfunction TouchInput() {\n    this.evTarget = TOUCH_TARGET_EVENTS;\n    this.targetIds = {};\n\n    Input.apply(this, arguments);\n}\n\ninherit(TouchInput, Input, {\n    handler: function MTEhandler(ev) {\n        var type = TOUCH_INPUT_MAP[ev.type];\n        var touches = getTouches.call(this, ev, type);\n        if (!touches) {\n            return;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction getTouches(ev, type) {\n    var allTouches = toArray(ev.touches);\n    var targetIds = this.targetIds;\n\n    // when there is only one touch, the process can be simplified\n    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\n        targetIds[allTouches[0].identifier] = true;\n        return [allTouches, allTouches];\n    }\n\n    var i,\n        targetTouches,\n        changedTouches = toArray(ev.changedTouches),\n        changedTargetTouches = [],\n        target = this.target;\n\n    // get target touches from touches\n    targetTouches = allTouches.filter(function(touch) {\n        return hasParent(touch.target, target);\n    });\n\n    // collect touches\n    if (type === INPUT_START) {\n        i = 0;\n        while (i < targetTouches.length) {\n            targetIds[targetTouches[i].identifier] = true;\n            i++;\n        }\n    }\n\n    // filter changed touches to only contain touches that exist in the collected target ids\n    i = 0;\n    while (i < changedTouches.length) {\n        if (targetIds[changedTouches[i].identifier]) {\n            changedTargetTouches.push(changedTouches[i]);\n        }\n\n        // cleanup removed touches\n        if (type & (INPUT_END | INPUT_CANCEL)) {\n            delete targetIds[changedTouches[i].identifier];\n        }\n        i++;\n    }\n\n    if (!changedTargetTouches.length) {\n        return;\n    }\n\n    return [\n        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\n        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true),\n        changedTargetTouches\n    ];\n}\n\n/**\n * Combined touch and mouse input\n *\n * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\n * This because touch devices also emit mouse events while doing a touch.\n *\n * @constructor\n * @extends Input\n */\n\nvar DEDUP_TIMEOUT = 2500;\nvar DEDUP_DISTANCE = 25;\n\nfunction TouchMouseInput() {\n    Input.apply(this, arguments);\n\n    var handler = bindFn(this.handler, this);\n    this.touch = new TouchInput(this.manager, handler);\n    this.mouse = new MouseInput(this.manager, handler);\n\n    this.primaryTouch = null;\n    this.lastTouches = [];\n}\n\ninherit(TouchMouseInput, Input, {\n    /**\n     * handle mouse and touch events\n     * @param {Hammer} manager\n     * @param {String} inputEvent\n     * @param {Object} inputData\n     */\n    handler: function TMEhandler(manager, inputEvent, inputData) {\n        var isTouch = (inputData.pointerType == INPUT_TYPE_TOUCH),\n            isMouse = (inputData.pointerType == INPUT_TYPE_MOUSE);\n\n        if (isMouse && inputData.sourceCapabilities && inputData.sourceCapabilities.firesTouchEvents) {\n            return;\n        }\n\n        // when we're in a touch event, record touches to  de-dupe synthetic mouse event\n        if (isTouch) {\n            recordTouches.call(this, inputEvent, inputData);\n        } else if (isMouse && isSyntheticEvent.call(this, inputData)) {\n            return;\n        }\n\n        this.callback(manager, inputEvent, inputData);\n    },\n\n    /**\n     * remove the event listeners\n     */\n    destroy: function destroy() {\n        this.touch.destroy();\n        this.mouse.destroy();\n    }\n});\n\nfunction recordTouches(eventType, eventData) {\n    if (eventType & INPUT_START) {\n        this.primaryTouch = eventData.changedPointers[0].identifier;\n        setLastTouch.call(this, eventData);\n    } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n        setLastTouch.call(this, eventData);\n    }\n}\n\nfunction setLastTouch(eventData) {\n    var touch = eventData.changedPointers[0];\n\n    if (touch.identifier === this.primaryTouch) {\n        var lastTouch = {x: touch.clientX, y: touch.clientY};\n        this.lastTouches.push(lastTouch);\n        var lts = this.lastTouches;\n        var removeLastTouch = function() {\n            var i = lts.indexOf(lastTouch);\n            if (i > -1) {\n                lts.splice(i, 1);\n            }\n        };\n        setTimeout(removeLastTouch, DEDUP_TIMEOUT);\n    }\n}\n\nfunction isSyntheticEvent(eventData) {\n    var x = eventData.srcEvent.clientX, y = eventData.srcEvent.clientY;\n    for (var i = 0; i < this.lastTouches.length; i++) {\n        var t = this.lastTouches[i];\n        var dx = Math.abs(x - t.x), dy = Math.abs(y - t.y);\n        if (dx <= DEDUP_DISTANCE && dy <= DEDUP_DISTANCE) {\n            return true;\n        }\n    }\n    return false;\n}\n\nvar PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\nvar NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\n\n// magical touchAction value\nvar TOUCH_ACTION_COMPUTE = 'compute';\nvar TOUCH_ACTION_AUTO = 'auto';\nvar TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\nvar TOUCH_ACTION_NONE = 'none';\nvar TOUCH_ACTION_PAN_X = 'pan-x';\nvar TOUCH_ACTION_PAN_Y = 'pan-y';\nvar TOUCH_ACTION_MAP = getTouchActionProps();\n\n/**\n * Touch Action\n * sets the touchAction property or uses the js alternative\n * @param {Manager} manager\n * @param {String} value\n * @constructor\n */\nfunction TouchAction(manager, value) {\n    this.manager = manager;\n    this.set(value);\n}\n\nTouchAction.prototype = {\n    /**\n     * set the touchAction value on the element or enable the polyfill\n     * @param {String} value\n     */\n    set: function(value) {\n        // find out the touch-action by the event handlers\n        if (value == TOUCH_ACTION_COMPUTE) {\n            value = this.compute();\n        }\n\n        if (NATIVE_TOUCH_ACTION && this.manager.element.style && TOUCH_ACTION_MAP[value]) {\n            this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\n        }\n        this.actions = value.toLowerCase().trim();\n    },\n\n    /**\n     * just re-set the touchAction value\n     */\n    update: function() {\n        this.set(this.manager.options.touchAction);\n    },\n\n    /**\n     * compute the value for the touchAction property based on the recognizer's settings\n     * @returns {String} value\n     */\n    compute: function() {\n        var actions = [];\n        each(this.manager.recognizers, function(recognizer) {\n            if (boolOrFn(recognizer.options.enable, [recognizer])) {\n                actions = actions.concat(recognizer.getTouchAction());\n            }\n        });\n        return cleanTouchActions(actions.join(' '));\n    },\n\n    /**\n     * this method is called on each input cycle and provides the preventing of the browser behavior\n     * @param {Object} input\n     */\n    preventDefaults: function(input) {\n        var srcEvent = input.srcEvent;\n        var direction = input.offsetDirection;\n\n        // if the touch action did prevented once this session\n        if (this.manager.session.prevented) {\n            srcEvent.preventDefault();\n            return;\n        }\n\n        var actions = this.actions;\n        var hasNone = inStr(actions, TOUCH_ACTION_NONE) && !TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];\n        var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];\n        var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];\n\n        if (hasNone) {\n            //do not prevent defaults if this is a tap gesture\n\n            var isTapPointer = input.pointers.length === 1;\n            var isTapMovement = input.distance < 2;\n            var isTapTouchTime = input.deltaTime < 250;\n\n            if (isTapPointer && isTapMovement && isTapTouchTime) {\n                return;\n            }\n        }\n\n        if (hasPanX && hasPanY) {\n            // `pan-x pan-y` means browser handles all scrolling/panning, do not prevent\n            return;\n        }\n\n        if (hasNone ||\n            (hasPanY && direction & DIRECTION_HORIZONTAL) ||\n            (hasPanX && direction & DIRECTION_VERTICAL)) {\n            return this.preventSrc(srcEvent);\n        }\n    },\n\n    /**\n     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\n     * @param {Object} srcEvent\n     */\n    preventSrc: function(srcEvent) {\n        this.manager.session.prevented = true;\n        srcEvent.preventDefault();\n    }\n};\n\n/**\n * when the touchActions are collected they are not a valid value, so we need to clean things up. *\n * @param {String} actions\n * @returns {*}\n */\nfunction cleanTouchActions(actions) {\n    // none\n    if (inStr(actions, TOUCH_ACTION_NONE)) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\n    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\n\n    // if both pan-x and pan-y are set (different recognizers\n    // for different directions, e.g. horizontal pan but vertical swipe?)\n    // we need none (as otherwise with pan-x pan-y combined none of these\n    // recognizers will work, since the browser would handle all panning\n    if (hasPanX && hasPanY) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    // pan-x OR pan-y\n    if (hasPanX || hasPanY) {\n        return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\n    }\n\n    // manipulation\n    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\n        return TOUCH_ACTION_MANIPULATION;\n    }\n\n    return TOUCH_ACTION_AUTO;\n}\n\nfunction getTouchActionProps() {\n    if (!NATIVE_TOUCH_ACTION) {\n        return false;\n    }\n    var touchMap = {};\n    var cssSupports = window.CSS && window.CSS.supports;\n    ['auto', 'manipulation', 'pan-y', 'pan-x', 'pan-x pan-y', 'none'].forEach(function(val) {\n\n        // If css.supports is not supported but there is native touch-action assume it supports\n        // all values. This is the case for IE 10 and 11.\n        touchMap[val] = cssSupports ? window.CSS.supports('touch-action', val) : true;\n    });\n    return touchMap;\n}\n\n/**\n * Recognizer flow explained; *\n * All recognizers have the initial state of POSSIBLE when a input session starts.\n * The definition of a input session is from the first input until the last input, with all it's movement in it. *\n * Example session for mouse-input: mousedown -> mousemove -> mouseup\n *\n * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\n * which determines with state it should be.\n *\n * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\n * POSSIBLE to give it another change on the next cycle.\n *\n *               Possible\n *                  |\n *            +-----+---------------+\n *            |                     |\n *      +-----+-----+               |\n *      |           |               |\n *   Failed      Cancelled          |\n *                          +-------+------+\n *                          |              |\n *                      Recognized       Began\n *                                         |\n *                                      Changed\n *                                         |\n *                                  Ended/Recognized\n */\nvar STATE_POSSIBLE = 1;\nvar STATE_BEGAN = 2;\nvar STATE_CHANGED = 4;\nvar STATE_ENDED = 8;\nvar STATE_RECOGNIZED = STATE_ENDED;\nvar STATE_CANCELLED = 16;\nvar STATE_FAILED = 32;\n\n/**\n * Recognizer\n * Every recognizer needs to extend from this class.\n * @constructor\n * @param {Object} options\n */\nfunction Recognizer(options) {\n    this.options = assign({}, this.defaults, options || {});\n\n    this.id = uniqueId();\n\n    this.manager = null;\n\n    // default is enable true\n    this.options.enable = ifUndefined(this.options.enable, true);\n\n    this.state = STATE_POSSIBLE;\n\n    this.simultaneous = {};\n    this.requireFail = [];\n}\n\nRecognizer.prototype = {\n    /**\n     * @virtual\n     * @type {Object}\n     */\n    defaults: {},\n\n    /**\n     * set options\n     * @param {Object} options\n     * @return {Recognizer}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // also update the touchAction, in case something changed about the directions/enabled state\n        this.manager && this.manager.touchAction.update();\n        return this;\n    },\n\n    /**\n     * recognize simultaneous with an other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    recognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\n            return this;\n        }\n\n        var simultaneous = this.simultaneous;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (!simultaneous[otherRecognizer.id]) {\n            simultaneous[otherRecognizer.id] = otherRecognizer;\n            otherRecognizer.recognizeWith(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRecognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        delete this.simultaneous[otherRecognizer.id];\n        return this;\n    },\n\n    /**\n     * recognizer can only run when an other is failing\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    requireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\n            return this;\n        }\n\n        var requireFail = this.requireFail;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (inArray(requireFail, otherRecognizer) === -1) {\n            requireFail.push(otherRecognizer);\n            otherRecognizer.requireFailure(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the requireFailure link. it does not remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRequireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        var index = inArray(this.requireFail, otherRecognizer);\n        if (index > -1) {\n            this.requireFail.splice(index, 1);\n        }\n        return this;\n    },\n\n    /**\n     * has require failures boolean\n     * @returns {boolean}\n     */\n    hasRequireFailures: function() {\n        return this.requireFail.length > 0;\n    },\n\n    /**\n     * if the recognizer can recognize simultaneous with an other recognizer\n     * @param {Recognizer} otherRecognizer\n     * @returns {Boolean}\n     */\n    canRecognizeWith: function(otherRecognizer) {\n        return !!this.simultaneous[otherRecognizer.id];\n    },\n\n    /**\n     * You should use `tryEmit` instead of `emit` directly to check\n     * that all the needed recognizers has failed before emitting.\n     * @param {Object} input\n     */\n    emit: function(input) {\n        var self = this;\n        var state = this.state;\n\n        function emit(event) {\n            self.manager.emit(event, input);\n        }\n\n        // 'panstart' and 'panmove'\n        if (state < STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n\n        emit(self.options.event); // simple 'eventName' events\n\n        if (input.additionalEvent) { // additional event(panleft, panright, pinchin, pinchout...)\n            emit(input.additionalEvent);\n        }\n\n        // panend and pancancel\n        if (state >= STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n    },\n\n    /**\n     * Check that all the require failure recognizers has failed,\n     * if true, it emits a gesture event,\n     * otherwise, setup the state to FAILED.\n     * @param {Object} input\n     */\n    tryEmit: function(input) {\n        if (this.canEmit()) {\n            return this.emit(input);\n        }\n        // it's failing anyway\n        this.state = STATE_FAILED;\n    },\n\n    /**\n     * can we emit?\n     * @returns {boolean}\n     */\n    canEmit: function() {\n        var i = 0;\n        while (i < this.requireFail.length) {\n            if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\n                return false;\n            }\n            i++;\n        }\n        return true;\n    },\n\n    /**\n     * update the recognizer\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        // make a new copy of the inputData\n        // so we can change the inputData without messing up the other recognizers\n        var inputDataClone = assign({}, inputData);\n\n        // is is enabled and allow recognizing?\n        if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\n            this.reset();\n            this.state = STATE_FAILED;\n            return;\n        }\n\n        // reset when we've reached the end\n        if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\n            this.state = STATE_POSSIBLE;\n        }\n\n        this.state = this.process(inputDataClone);\n\n        // the recognizer has recognized a gesture\n        // so trigger an event\n        if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\n            this.tryEmit(inputDataClone);\n        }\n    },\n\n    /**\n     * return the state of the recognizer\n     * the actual recognizing happens in this method\n     * @virtual\n     * @param {Object} inputData\n     * @returns {Const} STATE\n     */\n    process: function(inputData) { }, // jshint ignore:line\n\n    /**\n     * return the preferred touch-action\n     * @virtual\n     * @returns {Array}\n     */\n    getTouchAction: function() { },\n\n    /**\n     * called when the gesture isn't allowed to recognize\n     * like when another is being recognized or it is disabled\n     * @virtual\n     */\n    reset: function() { }\n};\n\n/**\n * get a usable string, used as event postfix\n * @param {Const} state\n * @returns {String} state\n */\nfunction stateStr(state) {\n    if (state & STATE_CANCELLED) {\n        return 'cancel';\n    } else if (state & STATE_ENDED) {\n        return 'end';\n    } else if (state & STATE_CHANGED) {\n        return 'move';\n    } else if (state & STATE_BEGAN) {\n        return 'start';\n    }\n    return '';\n}\n\n/**\n * direction cons to string\n * @param {Const} direction\n * @returns {String}\n */\nfunction directionStr(direction) {\n    if (direction == DIRECTION_DOWN) {\n        return 'down';\n    } else if (direction == DIRECTION_UP) {\n        return 'up';\n    } else if (direction == DIRECTION_LEFT) {\n        return 'left';\n    } else if (direction == DIRECTION_RIGHT) {\n        return 'right';\n    }\n    return '';\n}\n\n/**\n * get a recognizer by name if it is bound to a manager\n * @param {Recognizer|String} otherRecognizer\n * @param {Recognizer} recognizer\n * @returns {Recognizer}\n */\nfunction getRecognizerByNameIfManager(otherRecognizer, recognizer) {\n    var manager = recognizer.manager;\n    if (manager) {\n        return manager.get(otherRecognizer);\n    }\n    return otherRecognizer;\n}\n\n/**\n * This recognizer is just used as a base for the simple attribute recognizers.\n * @constructor\n * @extends Recognizer\n */\nfunction AttrRecognizer() {\n    Recognizer.apply(this, arguments);\n}\n\ninherit(AttrRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof AttrRecognizer\n     */\n    defaults: {\n        /**\n         * @type {Number}\n         * @default 1\n         */\n        pointers: 1\n    },\n\n    /**\n     * Used to check if it the recognizer receives valid input, like input.distance > 10.\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {Boolean} recognized\n     */\n    attrTest: function(input) {\n        var optionPointers = this.options.pointers;\n        return optionPointers === 0 || input.pointers.length === optionPointers;\n    },\n\n    /**\n     * Process the input and return the state for the recognizer\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {*} State\n     */\n    process: function(input) {\n        var state = this.state;\n        var eventType = input.eventType;\n\n        var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\n        var isValid = this.attrTest(input);\n\n        // on cancel input and we've recognized before, return STATE_CANCELLED\n        if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\n            return state | STATE_CANCELLED;\n        } else if (isRecognized || isValid) {\n            if (eventType & INPUT_END) {\n                return state | STATE_ENDED;\n            } else if (!(state & STATE_BEGAN)) {\n                return STATE_BEGAN;\n            }\n            return state | STATE_CHANGED;\n        }\n        return STATE_FAILED;\n    }\n});\n\n/**\n * Pan\n * Recognized when the pointer is down and moved in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PanRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n\n    this.pX = null;\n    this.pY = null;\n}\n\ninherit(PanRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PanRecognizer\n     */\n    defaults: {\n        event: 'pan',\n        threshold: 10,\n        pointers: 1,\n        direction: DIRECTION_ALL\n    },\n\n    getTouchAction: function() {\n        var direction = this.options.direction;\n        var actions = [];\n        if (direction & DIRECTION_HORIZONTAL) {\n            actions.push(TOUCH_ACTION_PAN_Y);\n        }\n        if (direction & DIRECTION_VERTICAL) {\n            actions.push(TOUCH_ACTION_PAN_X);\n        }\n        return actions;\n    },\n\n    directionTest: function(input) {\n        var options = this.options;\n        var hasMoved = true;\n        var distance = input.distance;\n        var direction = input.direction;\n        var x = input.deltaX;\n        var y = input.deltaY;\n\n        // lock to axis?\n        if (!(direction & options.direction)) {\n            if (options.direction & DIRECTION_HORIZONTAL) {\n                direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\n                hasMoved = x != this.pX;\n                distance = Math.abs(input.deltaX);\n            } else {\n                direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\n                hasMoved = y != this.pY;\n                distance = Math.abs(input.deltaY);\n            }\n        }\n        input.direction = direction;\n        return hasMoved && distance > options.threshold && direction & options.direction;\n    },\n\n    attrTest: function(input) {\n        return AttrRecognizer.prototype.attrTest.call(this, input) &&\n            (this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\n    },\n\n    emit: function(input) {\n\n        this.pX = input.deltaX;\n        this.pY = input.deltaY;\n\n        var direction = directionStr(input.direction);\n\n        if (direction) {\n            input.additionalEvent = this.options.event + direction;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Pinch\n * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PinchRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(PinchRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'pinch',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\n    },\n\n    emit: function(input) {\n        if (input.scale !== 1) {\n            var inOut = input.scale < 1 ? 'in' : 'out';\n            input.additionalEvent = this.options.event + inOut;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Press\n * Recognized when the pointer is down for x ms without any movement.\n * @constructor\n * @extends Recognizer\n */\nfunction PressRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    this._timer = null;\n    this._input = null;\n}\n\ninherit(PressRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PressRecognizer\n     */\n    defaults: {\n        event: 'press',\n        pointers: 1,\n        time: 251, // minimal time of the pointer to be pressed\n        threshold: 9 // a minimal movement is ok, but keep it low\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_AUTO];\n    },\n\n    process: function(input) {\n        var options = this.options;\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTime = input.deltaTime > options.time;\n\n        this._input = input;\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (!validMovement || !validPointers || (input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime)) {\n            this.reset();\n        } else if (input.eventType & INPUT_START) {\n            this.reset();\n            this._timer = setTimeoutContext(function() {\n                this.state = STATE_RECOGNIZED;\n                this.tryEmit();\n            }, options.time, this);\n        } else if (input.eventType & INPUT_END) {\n            return STATE_RECOGNIZED;\n        }\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function(input) {\n        if (this.state !== STATE_RECOGNIZED) {\n            return;\n        }\n\n        if (input && (input.eventType & INPUT_END)) {\n            this.manager.emit(this.options.event + 'up', input);\n        } else {\n            this._input.timeStamp = now();\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Rotate\n * Recognized when two or more pointer are moving in a circular motion.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction RotateRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(RotateRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof RotateRecognizer\n     */\n    defaults: {\n        event: 'rotate',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\n    }\n});\n\n/**\n * Swipe\n * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction SwipeRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(SwipeRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof SwipeRecognizer\n     */\n    defaults: {\n        event: 'swipe',\n        threshold: 10,\n        velocity: 0.3,\n        direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\n        pointers: 1\n    },\n\n    getTouchAction: function() {\n        return PanRecognizer.prototype.getTouchAction.call(this);\n    },\n\n    attrTest: function(input) {\n        var direction = this.options.direction;\n        var velocity;\n\n        if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\n            velocity = input.overallVelocity;\n        } else if (direction & DIRECTION_HORIZONTAL) {\n            velocity = input.overallVelocityX;\n        } else if (direction & DIRECTION_VERTICAL) {\n            velocity = input.overallVelocityY;\n        }\n\n        return this._super.attrTest.call(this, input) &&\n            direction & input.offsetDirection &&\n            input.distance > this.options.threshold &&\n            input.maxPointers == this.options.pointers &&\n            abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\n    },\n\n    emit: function(input) {\n        var direction = directionStr(input.offsetDirection);\n        if (direction) {\n            this.manager.emit(this.options.event + direction, input);\n        }\n\n        this.manager.emit(this.options.event, input);\n    }\n});\n\n/**\n * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\n * between the given interval and position. The delay option can be used to recognize multi-taps without firing\n * a single tap.\n *\n * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\n * multi-taps being recognized.\n * @constructor\n * @extends Recognizer\n */\nfunction TapRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    // previous time and center,\n    // used for tap counting\n    this.pTime = false;\n    this.pCenter = false;\n\n    this._timer = null;\n    this._input = null;\n    this.count = 0;\n}\n\ninherit(TapRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'tap',\n        pointers: 1,\n        taps: 1,\n        interval: 300, // max time between the multi-tap taps\n        time: 250, // max time of the pointer to be down (like finger on the screen)\n        threshold: 9, // a minimal movement is ok, but keep it low\n        posThreshold: 10 // a multi-tap can be a bit off the initial position\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_MANIPULATION];\n    },\n\n    process: function(input) {\n        var options = this.options;\n\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTouchTime = input.deltaTime < options.time;\n\n        this.reset();\n\n        if ((input.eventType & INPUT_START) && (this.count === 0)) {\n            return this.failTimeout();\n        }\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (validMovement && validTouchTime && validPointers) {\n            if (input.eventType != INPUT_END) {\n                return this.failTimeout();\n            }\n\n            var validInterval = this.pTime ? (input.timeStamp - this.pTime < options.interval) : true;\n            var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\n\n            this.pTime = input.timeStamp;\n            this.pCenter = input.center;\n\n            if (!validMultiTap || !validInterval) {\n                this.count = 1;\n            } else {\n                this.count += 1;\n            }\n\n            this._input = input;\n\n            // if tap count matches we have recognized it,\n            // else it has began recognizing...\n            var tapCount = this.count % options.taps;\n            if (tapCount === 0) {\n                // no failing requirements, immediately trigger the tap event\n                // or wait as long as the multitap interval to trigger\n                if (!this.hasRequireFailures()) {\n                    return STATE_RECOGNIZED;\n                } else {\n                    this._timer = setTimeoutContext(function() {\n                        this.state = STATE_RECOGNIZED;\n                        this.tryEmit();\n                    }, options.interval, this);\n                    return STATE_BEGAN;\n                }\n            }\n        }\n        return STATE_FAILED;\n    },\n\n    failTimeout: function() {\n        this._timer = setTimeoutContext(function() {\n            this.state = STATE_FAILED;\n        }, this.options.interval, this);\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function() {\n        if (this.state == STATE_RECOGNIZED) {\n            this._input.tapCount = this.count;\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Simple way to create a manager with a default set of recognizers.\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Hammer(element, options) {\n    options = options || {};\n    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\n    return new Manager(element, options);\n}\n\n/**\n * @const {string}\n */\nHammer.VERSION = '2.0.7';\n\n/**\n * default settings\n * @namespace\n */\nHammer.defaults = {\n    /**\n     * set if DOM events are being triggered.\n     * But this is slower and unused by simple implementations, so disabled by default.\n     * @type {Boolean}\n     * @default false\n     */\n    domEvents: false,\n\n    /**\n     * The value for the touchAction property/fallback.\n     * When set to `compute` it will magically set the correct value based on the added recognizers.\n     * @type {String}\n     * @default compute\n     */\n    touchAction: TOUCH_ACTION_COMPUTE,\n\n    /**\n     * @type {Boolean}\n     * @default true\n     */\n    enable: true,\n\n    /**\n     * EXPERIMENTAL FEATURE -- can be removed/changed\n     * Change the parent input target element.\n     * If Null, then it is being set the to main element.\n     * @type {Null|EventTarget}\n     * @default null\n     */\n    inputTarget: null,\n\n    /**\n     * force an input class\n     * @type {Null|Function}\n     * @default null\n     */\n    inputClass: null,\n\n    /**\n     * Default recognizer setup when calling `Hammer()`\n     * When creating a new Manager these will be skipped.\n     * @type {Array}\n     */\n    preset: [\n        // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\n        [RotateRecognizer, {enable: false}],\n        [PinchRecognizer, {enable: false}, ['rotate']],\n        [SwipeRecognizer, {direction: DIRECTION_HORIZONTAL}],\n        [PanRecognizer, {direction: DIRECTION_HORIZONTAL}, ['swipe']],\n        [TapRecognizer],\n        [TapRecognizer, {event: 'doubletap', taps: 2}, ['tap']],\n        [PressRecognizer]\n    ],\n\n    /**\n     * Some CSS properties can be used to improve the working of Hammer.\n     * Add them to this method and they will be set when creating a new Manager.\n     * @namespace\n     */\n    cssProps: {\n        /**\n         * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userSelect: 'none',\n\n        /**\n         * Disable the Windows Phone grippers when pressing an element.\n         * @type {String}\n         * @default 'none'\n         */\n        touchSelect: 'none',\n\n        /**\n         * Disables the default callout shown when you touch and hold a touch target.\n         * On iOS, when you touch and hold a touch target such as a link, Safari displays\n         * a callout containing information about the link. This property allows you to disable that callout.\n         * @type {String}\n         * @default 'none'\n         */\n        touchCallout: 'none',\n\n        /**\n         * Specifies whether zooming is enabled. Used by IE10>\n         * @type {String}\n         * @default 'none'\n         */\n        contentZooming: 'none',\n\n        /**\n         * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userDrag: 'none',\n\n        /**\n         * Overrides the highlight color shown when the user taps a link or a JavaScript\n         * clickable element in iOS. This property obeys the alpha value, if specified.\n         * @type {String}\n         * @default 'rgba(0,0,0,0)'\n         */\n        tapHighlightColor: 'rgba(0,0,0,0)'\n    }\n};\n\nvar STOP = 1;\nvar FORCED_STOP = 2;\n\n/**\n * Manager\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Manager(element, options) {\n    this.options = assign({}, Hammer.defaults, options || {});\n\n    this.options.inputTarget = this.options.inputTarget || element;\n\n    this.handlers = {};\n    this.session = {};\n    this.recognizers = [];\n    this.oldCssProps = {};\n\n    this.element = element;\n    this.input = createInputInstance(this);\n    this.touchAction = new TouchAction(this, this.options.touchAction);\n\n    toggleCssProps(this, true);\n\n    each(this.options.recognizers, function(item) {\n        var recognizer = this.add(new (item[0])(item[1]));\n        item[2] && recognizer.recognizeWith(item[2]);\n        item[3] && recognizer.requireFailure(item[3]);\n    }, this);\n}\n\nManager.prototype = {\n    /**\n     * set options\n     * @param {Object} options\n     * @returns {Manager}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // Options that need a little more setup\n        if (options.touchAction) {\n            this.touchAction.update();\n        }\n        if (options.inputTarget) {\n            // Clean up existing event listeners and reinitialize\n            this.input.destroy();\n            this.input.target = options.inputTarget;\n            this.input.init();\n        }\n        return this;\n    },\n\n    /**\n     * stop recognizing for this session.\n     * This session will be discarded, when a new [input]start event is fired.\n     * When forced, the recognizer cycle is stopped immediately.\n     * @param {Boolean} [force]\n     */\n    stop: function(force) {\n        this.session.stopped = force ? FORCED_STOP : STOP;\n    },\n\n    /**\n     * run the recognizers!\n     * called by the inputHandler function on every movement of the pointers (touches)\n     * it walks through all the recognizers and tries to detect the gesture that is being made\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        var session = this.session;\n        if (session.stopped) {\n            return;\n        }\n\n        // run the touch-action polyfill\n        this.touchAction.preventDefaults(inputData);\n\n        var recognizer;\n        var recognizers = this.recognizers;\n\n        // this holds the recognizer that is being recognized.\n        // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\n        // if no recognizer is detecting a thing, it is set to `null`\n        var curRecognizer = session.curRecognizer;\n\n        // reset when the last recognizer is recognized\n        // or when we're in a new session\n        if (!curRecognizer || (curRecognizer && curRecognizer.state & STATE_RECOGNIZED)) {\n            curRecognizer = session.curRecognizer = null;\n        }\n\n        var i = 0;\n        while (i < recognizers.length) {\n            recognizer = recognizers[i];\n\n            // find out if we are allowed try to recognize the input for this one.\n            // 1.   allow if the session is NOT forced stopped (see the .stop() method)\n            // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\n            //      that is being recognized.\n            // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\n            //      this can be setup with the `recognizeWith()` method on the recognizer.\n            if (session.stopped !== FORCED_STOP && ( // 1\n                    !curRecognizer || recognizer == curRecognizer || // 2\n                    recognizer.canRecognizeWith(curRecognizer))) { // 3\n                recognizer.recognize(inputData);\n            } else {\n                recognizer.reset();\n            }\n\n            // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\n            // current active recognizer. but only if we don't already have an active recognizer\n            if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\n                curRecognizer = session.curRecognizer = recognizer;\n            }\n            i++;\n        }\n    },\n\n    /**\n     * get a recognizer by its event name.\n     * @param {Recognizer|String} recognizer\n     * @returns {Recognizer|Null}\n     */\n    get: function(recognizer) {\n        if (recognizer instanceof Recognizer) {\n            return recognizer;\n        }\n\n        var recognizers = this.recognizers;\n        for (var i = 0; i < recognizers.length; i++) {\n            if (recognizers[i].options.event == recognizer) {\n                return recognizers[i];\n            }\n        }\n        return null;\n    },\n\n    /**\n     * add a recognizer to the manager\n     * existing recognizers with the same event name will be removed\n     * @param {Recognizer} recognizer\n     * @returns {Recognizer|Manager}\n     */\n    add: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'add', this)) {\n            return this;\n        }\n\n        // remove existing\n        var existing = this.get(recognizer.options.event);\n        if (existing) {\n            this.remove(existing);\n        }\n\n        this.recognizers.push(recognizer);\n        recognizer.manager = this;\n\n        this.touchAction.update();\n        return recognizer;\n    },\n\n    /**\n     * remove a recognizer by name or instance\n     * @param {Recognizer|String} recognizer\n     * @returns {Manager}\n     */\n    remove: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'remove', this)) {\n            return this;\n        }\n\n        recognizer = this.get(recognizer);\n\n        // let's make sure this recognizer exists\n        if (recognizer) {\n            var recognizers = this.recognizers;\n            var index = inArray(recognizers, recognizer);\n\n            if (index !== -1) {\n                recognizers.splice(index, 1);\n                this.touchAction.update();\n            }\n        }\n\n        return this;\n    },\n\n    /**\n     * bind event\n     * @param {String} events\n     * @param {Function} handler\n     * @returns {EventEmitter} this\n     */\n    on: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n        if (handler === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            handlers[event] = handlers[event] || [];\n            handlers[event].push(handler);\n        });\n        return this;\n    },\n\n    /**\n     * unbind event, leave emit blank to remove all handlers\n     * @param {String} events\n     * @param {Function} [handler]\n     * @returns {EventEmitter} this\n     */\n    off: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            if (!handler) {\n                delete handlers[event];\n            } else {\n                handlers[event] && handlers[event].splice(inArray(handlers[event], handler), 1);\n            }\n        });\n        return this;\n    },\n\n    /**\n     * emit event to the listeners\n     * @param {String} event\n     * @param {Object} data\n     */\n    emit: function(event, data) {\n        // we also want to trigger dom events\n        if (this.options.domEvents) {\n            triggerDomEvent(event, data);\n        }\n\n        // no handlers, so skip it all\n        var handlers = this.handlers[event] && this.handlers[event].slice();\n        if (!handlers || !handlers.length) {\n            return;\n        }\n\n        data.type = event;\n        data.preventDefault = function() {\n            data.srcEvent.preventDefault();\n        };\n\n        var i = 0;\n        while (i < handlers.length) {\n            handlers[i](data);\n            i++;\n        }\n    },\n\n    /**\n     * destroy the manager and unbinds all events\n     * it doesn't unbind dom events, that is the user own responsibility\n     */\n    destroy: function() {\n        this.element && toggleCssProps(this, false);\n\n        this.handlers = {};\n        this.session = {};\n        this.input.destroy();\n        this.element = null;\n    }\n};\n\n/**\n * add/remove the css properties as defined in manager.options.cssProps\n * @param {Manager} manager\n * @param {Boolean} add\n */\nfunction toggleCssProps(manager, add) {\n    var element = manager.element;\n    if (!element.style) {\n        return;\n    }\n    var prop;\n    each(manager.options.cssProps, function(value, name) {\n        prop = prefixed(element.style, name);\n        if (add) {\n            manager.oldCssProps[prop] = element.style[prop];\n            element.style[prop] = value;\n        } else {\n            element.style[prop] = manager.oldCssProps[prop] || '';\n        }\n    });\n    if (!add) {\n        manager.oldCssProps = {};\n    }\n}\n\n/**\n * trigger dom event\n * @param {String} event\n * @param {Object} data\n */\nfunction triggerDomEvent(event, data) {\n    var gestureEvent = document.createEvent('Event');\n    gestureEvent.initEvent(event, true, true);\n    gestureEvent.gesture = data;\n    data.target.dispatchEvent(gestureEvent);\n}\n\nassign(Hammer, {\n    INPUT_START: INPUT_START,\n    INPUT_MOVE: INPUT_MOVE,\n    INPUT_END: INPUT_END,\n    INPUT_CANCEL: INPUT_CANCEL,\n\n    STATE_POSSIBLE: STATE_POSSIBLE,\n    STATE_BEGAN: STATE_BEGAN,\n    STATE_CHANGED: STATE_CHANGED,\n    STATE_ENDED: STATE_ENDED,\n    STATE_RECOGNIZED: STATE_RECOGNIZED,\n    STATE_CANCELLED: STATE_CANCELLED,\n    STATE_FAILED: STATE_FAILED,\n\n    DIRECTION_NONE: DIRECTION_NONE,\n    DIRECTION_LEFT: DIRECTION_LEFT,\n    DIRECTION_RIGHT: DIRECTION_RIGHT,\n    DIRECTION_UP: DIRECTION_UP,\n    DIRECTION_DOWN: DIRECTION_DOWN,\n    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\n    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\n    DIRECTION_ALL: DIRECTION_ALL,\n\n    Manager: Manager,\n    Input: Input,\n    TouchAction: TouchAction,\n\n    TouchInput: TouchInput,\n    MouseInput: MouseInput,\n    PointerEventInput: PointerEventInput,\n    TouchMouseInput: TouchMouseInput,\n    SingleTouchInput: SingleTouchInput,\n\n    Recognizer: Recognizer,\n    AttrRecognizer: AttrRecognizer,\n    Tap: TapRecognizer,\n    Pan: PanRecognizer,\n    Swipe: SwipeRecognizer,\n    Pinch: PinchRecognizer,\n    Rotate: RotateRecognizer,\n    Press: PressRecognizer,\n\n    on: addEventListeners,\n    off: removeEventListeners,\n    each: each,\n    merge: merge,\n    extend: extend,\n    assign: assign,\n    inherit: inherit,\n    bindFn: bindFn,\n    prefixed: prefixed\n});\n\n// this prevents errors when Hammer is loaded in the presence of an AMD\n//  style loader but by script tag, not by the loader.\nvar freeGlobal = (typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : {})); // jshint ignore:line\nfreeGlobal.Hammer = Hammer;\n\nif (typeof define === 'function' && define.amd) {\n    define(function() {\n        return Hammer;\n    });\n} else if (typeof module != 'undefined' && module.exports) {\n    module.exports = Hammer;\n} else {\n    window[exportName] = Hammer;\n}\n\n})(window, document, 'Hammer');\n",
    "import * as base from './handlebars/base';\n\n// Each of these augment the Handlebars object. No need to setup here.\n// (This is done to easily share code between commonjs and browse envs)\nimport SafeString from './handlebars/safe-string';\nimport Exception from './handlebars/exception';\nimport * as Utils from './handlebars/utils';\nimport * as runtime from './handlebars/runtime';\n\nimport noConflict from './handlebars/no-conflict';\n\n// For compatibility and usage outside of module systems, make the Handlebars object a namespace\nfunction create() {\n  let hb = new base.HandlebarsEnvironment();\n\n  Utils.extend(hb, base);\n  hb.SafeString = SafeString;\n  hb.Exception = Exception;\n  hb.Utils = Utils;\n  hb.escapeExpression = Utils.escapeExpression;\n\n  hb.VM = runtime;\n  hb.template = function(spec) {\n    return runtime.template(spec, hb);\n  };\n\n  return hb;\n}\n\nlet inst = create();\ninst.create = create;\n\nnoConflict(inst);\n\ninst['default'] = inst;\n\nexport default inst;\n",
    "import {createFrame, extend, toString} from './utils';\nimport Exception from './exception';\nimport {registerDefaultHelpers} from './helpers';\nimport {registerDefaultDecorators} from './decorators';\nimport logger from './logger';\n\nexport const VERSION = '4.0.12';\nexport const COMPILER_REVISION = 7;\n\nexport const REVISION_CHANGES = {\n  1: '<= 1.0.rc.2', // 1.0.rc.2 is actually rev2 but doesn't report it\n  2: '== 1.0.0-rc.3',\n  3: '== 1.0.0-rc.4',\n  4: '== 1.x.x',\n  5: '== 2.0.0-alpha.x',\n  6: '>= 2.0.0-beta.1',\n  7: '>= 4.0.0'\n};\n\nconst objectType = '[object Object]';\n\nexport function HandlebarsEnvironment(helpers, partials, decorators) {\n  this.helpers = helpers || {};\n  this.partials = partials || {};\n  this.decorators = decorators || {};\n\n  registerDefaultHelpers(this);\n  registerDefaultDecorators(this);\n}\n\nHandlebarsEnvironment.prototype = {\n  constructor: HandlebarsEnvironment,\n\n  logger: logger,\n  log: logger.log,\n\n  registerHelper: function(name, fn) {\n    if (toString.call(name) === objectType) {\n      if (fn) { throw new Exception('Arg not supported with multiple helpers'); }\n      extend(this.helpers, name);\n    } else {\n      this.helpers[name] = fn;\n    }\n  },\n  unregisterHelper: function(name) {\n    delete this.helpers[name];\n  },\n\n  registerPartial: function(name, partial) {\n    if (toString.call(name) === objectType) {\n      extend(this.partials, name);\n    } else {\n      if (typeof partial === 'undefined') {\n        throw new Exception(`Attempting to register a partial called \"${name}\" as undefined`);\n      }\n      this.partials[name] = partial;\n    }\n  },\n  unregisterPartial: function(name) {\n    delete this.partials[name];\n  },\n\n  registerDecorator: function(name, fn) {\n    if (toString.call(name) === objectType) {\n      if (fn) { throw new Exception('Arg not supported with multiple decorators'); }\n      extend(this.decorators, name);\n    } else {\n      this.decorators[name] = fn;\n    }\n  },\n  unregisterDecorator: function(name) {\n    delete this.decorators[name];\n  }\n};\n\nexport let log = logger.log;\n\nexport {createFrame, logger};\n",
    "import registerInline from './decorators/inline';\n\nexport function registerDefaultDecorators(instance) {\n  registerInline(instance);\n}\n\n",
    "import {extend} from '../utils';\n\nexport default function(instance) {\n  instance.registerDecorator('inline', function(fn, props, container, options) {\n    let ret = fn;\n    if (!props.partials) {\n      props.partials = {};\n      ret = function(context, options) {\n        // Create a new partials stack frame prior to exec.\n        let original = container.partials;\n        container.partials = extend({}, original, props.partials);\n        let ret = fn(context, options);\n        container.partials = original;\n        return ret;\n      };\n    }\n\n    props.partials[options.args[0]] = options.fn;\n\n    return ret;\n  });\n}\n",
    "\nconst errorProps = ['description', 'fileName', 'lineNumber', 'message', 'name', 'number', 'stack'];\n\nfunction Exception(message, node) {\n  let loc = node && node.loc,\n      line,\n      column;\n  if (loc) {\n    line = loc.start.line;\n    column = loc.start.column;\n\n    message += ' - ' + line + ':' + column;\n  }\n\n  let tmp = Error.prototype.constructor.call(this, message);\n\n  // Unfortunately errors are not enumerable in Chrome (at least), so `for prop in tmp` doesn't work.\n  for (let idx = 0; idx < errorProps.length; idx++) {\n    this[errorProps[idx]] = tmp[errorProps[idx]];\n  }\n\n  /* istanbul ignore else */\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, Exception);\n  }\n\n  try {\n    if (loc) {\n      this.lineNumber = line;\n\n      // Work around issue under safari where we can't directly set the column value\n      /* istanbul ignore next */\n      if (Object.defineProperty) {\n        Object.defineProperty(this, 'column', {\n          value: column,\n          enumerable: true\n        });\n      } else {\n        this.column = column;\n      }\n    }\n  } catch (nop) {\n    /* Ignore if the browser is very particular */\n  }\n}\n\nException.prototype = new Error();\n\nexport default Exception;\n",
    "import registerBlockHelperMissing from './helpers/block-helper-missing';\nimport registerEach from './helpers/each';\nimport registerHelperMissing from './helpers/helper-missing';\nimport registerIf from './helpers/if';\nimport registerLog from './helpers/log';\nimport registerLookup from './helpers/lookup';\nimport registerWith from './helpers/with';\n\nexport function registerDefaultHelpers(instance) {\n  registerBlockHelperMissing(instance);\n  registerEach(instance);\n  registerHelperMissing(instance);\n  registerIf(instance);\n  registerLog(instance);\n  registerLookup(instance);\n  registerWith(instance);\n}\n",
    "import {appendContextPath, createFrame, isArray} from '../utils';\n\nexport default function(instance) {\n  instance.registerHelper('blockHelperMissing', function(context, options) {\n    let inverse = options.inverse,\n        fn = options.fn;\n\n    if (context === true) {\n      return fn(this);\n    } else if (context === false || context == null) {\n      return inverse(this);\n    } else if (isArray(context)) {\n      if (context.length > 0) {\n        if (options.ids) {\n          options.ids = [options.name];\n        }\n\n        return instance.helpers.each(context, options);\n      } else {\n        return inverse(this);\n      }\n    } else {\n      if (options.data && options.ids) {\n        let data = createFrame(options.data);\n        data.contextPath = appendContextPath(options.data.contextPath, options.name);\n        options = {data: data};\n      }\n\n      return fn(context, options);\n    }\n  });\n}\n",
    "import {appendContextPath, blockParams, createFrame, isArray, isFunction} from '../utils';\nimport Exception from '../exception';\n\nexport default function(instance) {\n  instance.registerHelper('each', function(context, options) {\n    if (!options) {\n      throw new Exception('Must pass iterator to #each');\n    }\n\n    let fn = options.fn,\n        inverse = options.inverse,\n        i = 0,\n        ret = '',\n        data,\n        contextPath;\n\n    if (options.data && options.ids) {\n      contextPath = appendContextPath(options.data.contextPath, options.ids[0]) + '.';\n    }\n\n    if (isFunction(context)) { context = context.call(this); }\n\n    if (options.data) {\n      data = createFrame(options.data);\n    }\n\n    function execIteration(field, index, last) {\n      if (data) {\n        data.key = field;\n        data.index = index;\n        data.first = index === 0;\n        data.last = !!last;\n\n        if (contextPath) {\n          data.contextPath = contextPath + field;\n        }\n      }\n\n      ret = ret + fn(context[field], {\n        data: data,\n        blockParams: blockParams([context[field], field], [contextPath + field, null])\n      });\n    }\n\n    if (context && typeof context === 'object') {\n      if (isArray(context)) {\n        for (let j = context.length; i < j; i++) {\n          if (i in context) {\n            execIteration(i, i, i === context.length - 1);\n          }\n        }\n      } else {\n        let priorKey;\n\n        for (let key in context) {\n          if (context.hasOwnProperty(key)) {\n            // We're running the iterations one step out of sync so we can detect\n            // the last iteration without have to scan the object twice and create\n            // an itermediate keys array.\n            if (priorKey !== undefined) {\n              execIteration(priorKey, i - 1);\n            }\n            priorKey = key;\n            i++;\n          }\n        }\n        if (priorKey !== undefined) {\n          execIteration(priorKey, i - 1, true);\n        }\n      }\n    }\n\n    if (i === 0) {\n      ret = inverse(this);\n    }\n\n    return ret;\n  });\n}\n",
    "import Exception from '../exception';\n\nexport default function(instance) {\n  instance.registerHelper('helperMissing', function(/* [args, ]options */) {\n    if (arguments.length === 1) {\n      // A missing field in a {{foo}} construct.\n      return undefined;\n    } else {\n      // Someone is actually trying to call something, blow up.\n      throw new Exception('Missing helper: \"' + arguments[arguments.length - 1].name + '\"');\n    }\n  });\n}\n",
    "import {isEmpty, isFunction} from '../utils';\n\nexport default function(instance) {\n  instance.registerHelper('if', function(conditional, options) {\n    if (isFunction(conditional)) { conditional = conditional.call(this); }\n\n    // Default behavior is to render the positive path if the value is truthy and not empty.\n    // The `includeZero` option may be set to treat the condtional as purely not empty based on the\n    // behavior of isEmpty. Effectively this determines if 0 is handled by the positive path or negative.\n    if ((!options.hash.includeZero && !conditional) || isEmpty(conditional)) {\n      return options.inverse(this);\n    } else {\n      return options.fn(this);\n    }\n  });\n\n  instance.registerHelper('unless', function(conditional, options) {\n    return instance.helpers['if'].call(this, conditional, {fn: options.inverse, inverse: options.fn, hash: options.hash});\n  });\n}\n",
    "export default function(instance) {\n  instance.registerHelper('log', function(/* message, options */) {\n    let args = [undefined],\n        options = arguments[arguments.length - 1];\n    for (let i = 0; i < arguments.length - 1; i++) {\n      args.push(arguments[i]);\n    }\n\n    let level = 1;\n    if (options.hash.level != null) {\n      level = options.hash.level;\n    } else if (options.data && options.data.level != null) {\n      level = options.data.level;\n    }\n    args[0] = level;\n\n    instance.log(... args);\n  });\n}\n",
    "export default function(instance) {\n  instance.registerHelper('lookup', function(obj, field) {\n    return obj && obj[field];\n  });\n}\n",
    "import {appendContextPath, blockParams, createFrame, isEmpty, isFunction} from '../utils';\n\nexport default function(instance) {\n  instance.registerHelper('with', function(context, options) {\n    if (isFunction(context)) { context = context.call(this); }\n\n    let fn = options.fn;\n\n    if (!isEmpty(context)) {\n      let data = options.data;\n      if (options.data && options.ids) {\n        data = createFrame(options.data);\n        data.contextPath = appendContextPath(options.data.contextPath, options.ids[0]);\n      }\n\n      return fn(context, {\n        data: data,\n        blockParams: blockParams([context], [data && data.contextPath])\n      });\n    } else {\n      return options.inverse(this);\n    }\n  });\n}\n",
    "import {indexOf} from './utils';\n\nlet logger = {\n  methodMap: ['debug', 'info', 'warn', 'error'],\n  level: 'info',\n\n  // Maps a given level value to the `methodMap` indexes above.\n  lookupLevel: function(level) {\n    if (typeof level === 'string') {\n      let levelMap = indexOf(logger.methodMap, level.toLowerCase());\n      if (levelMap >= 0) {\n        level = levelMap;\n      } else {\n        level = parseInt(level, 10);\n      }\n    }\n\n    return level;\n  },\n\n  // Can be overridden in the host environment\n  log: function(level, ...message) {\n    level = logger.lookupLevel(level);\n\n    if (typeof console !== 'undefined' && logger.lookupLevel(logger.level) <= level) {\n      let method = logger.methodMap[level];\n      if (!console[method]) { // eslint-disable-line no-console\n        method = 'log';\n      }\n      console[method](...message); // eslint-disable-line no-console\n    }\n  }\n};\n\nexport default logger;\n",
    "/* global window */\nexport default function(Handlebars) {\n  /* istanbul ignore next */\n  let root = typeof global !== 'undefined' ? global : window,\n      $Handlebars = root.Handlebars;\n  /* istanbul ignore next */\n  Handlebars.noConflict = function() {\n    if (root.Handlebars === Handlebars) {\n      root.Handlebars = $Handlebars;\n    }\n    return Handlebars;\n  };\n}\n",
    "import * as Utils from './utils';\nimport Exception from './exception';\nimport { COMPILER_REVISION, REVISION_CHANGES, createFrame } from './base';\n\nexport function checkRevision(compilerInfo) {\n  const compilerRevision = compilerInfo && compilerInfo[0] || 1,\n        currentRevision = COMPILER_REVISION;\n\n  if (compilerRevision !== currentRevision) {\n    if (compilerRevision < currentRevision) {\n      const runtimeVersions = REVISION_CHANGES[currentRevision],\n            compilerVersions = REVISION_CHANGES[compilerRevision];\n      throw new Exception('Template was precompiled with an older version of Handlebars than the current runtime. ' +\n            'Please update your precompiler to a newer version (' + runtimeVersions + ') or downgrade your runtime to an older version (' + compilerVersions + ').');\n    } else {\n      // Use the embedded version info since the runtime doesn't know about this revision yet\n      throw new Exception('Template was precompiled with a newer version of Handlebars than the current runtime. ' +\n            'Please update your runtime to a newer version (' + compilerInfo[1] + ').');\n    }\n  }\n}\n\nexport function template(templateSpec, env) {\n  /* istanbul ignore next */\n  if (!env) {\n    throw new Exception('No environment passed to template');\n  }\n  if (!templateSpec || !templateSpec.main) {\n    throw new Exception('Unknown template object: ' + typeof templateSpec);\n  }\n\n  templateSpec.main.decorator = templateSpec.main_d;\n\n  // Note: Using env.VM references rather than local var references throughout this section to allow\n  // for external users to override these as psuedo-supported APIs.\n  env.VM.checkRevision(templateSpec.compiler);\n\n  function invokePartialWrapper(partial, context, options) {\n    if (options.hash) {\n      context = Utils.extend({}, context, options.hash);\n      if (options.ids) {\n        options.ids[0] = true;\n      }\n    }\n\n    partial = env.VM.resolvePartial.call(this, partial, context, options);\n    let result = env.VM.invokePartial.call(this, partial, context, options);\n\n    if (result == null && env.compile) {\n      options.partials[options.name] = env.compile(partial, templateSpec.compilerOptions, env);\n      result = options.partials[options.name](context, options);\n    }\n    if (result != null) {\n      if (options.indent) {\n        let lines = result.split('\\n');\n        for (let i = 0, l = lines.length; i < l; i++) {\n          if (!lines[i] && i + 1 === l) {\n            break;\n          }\n\n          lines[i] = options.indent + lines[i];\n        }\n        result = lines.join('\\n');\n      }\n      return result;\n    } else {\n      throw new Exception('The partial ' + options.name + ' could not be compiled when running in runtime-only mode');\n    }\n  }\n\n  // Just add water\n  let container = {\n    strict: function(obj, name) {\n      if (!(name in obj)) {\n        throw new Exception('\"' + name + '\" not defined in ' + obj);\n      }\n      return obj[name];\n    },\n    lookup: function(depths, name) {\n      const len = depths.length;\n      for (let i = 0; i < len; i++) {\n        if (depths[i] && depths[i][name] != null) {\n          return depths[i][name];\n        }\n      }\n    },\n    lambda: function(current, context) {\n      return typeof current === 'function' ? current.call(context) : current;\n    },\n\n    escapeExpression: Utils.escapeExpression,\n    invokePartial: invokePartialWrapper,\n\n    fn: function(i) {\n      let ret = templateSpec[i];\n      ret.decorator = templateSpec[i + '_d'];\n      return ret;\n    },\n\n    programs: [],\n    program: function(i, data, declaredBlockParams, blockParams, depths) {\n      let programWrapper = this.programs[i],\n          fn = this.fn(i);\n      if (data || depths || blockParams || declaredBlockParams) {\n        programWrapper = wrapProgram(this, i, fn, data, declaredBlockParams, blockParams, depths);\n      } else if (!programWrapper) {\n        programWrapper = this.programs[i] = wrapProgram(this, i, fn);\n      }\n      return programWrapper;\n    },\n\n    data: function(value, depth) {\n      while (value && depth--) {\n        value = value._parent;\n      }\n      return value;\n    },\n    merge: function(param, common) {\n      let obj = param || common;\n\n      if (param && common && (param !== common)) {\n        obj = Utils.extend({}, common, param);\n      }\n\n      return obj;\n    },\n    // An empty object to use as replacement for null-contexts\n    nullContext: Object.seal({}),\n\n    noop: env.VM.noop,\n    compilerInfo: templateSpec.compiler\n  };\n\n  function ret(context, options = {}) {\n    let data = options.data;\n\n    ret._setup(options);\n    if (!options.partial && templateSpec.useData) {\n      data = initData(context, data);\n    }\n    let depths,\n        blockParams = templateSpec.useBlockParams ? [] : undefined;\n    if (templateSpec.useDepths) {\n      if (options.depths) {\n        depths = context != options.depths[0] ? [context].concat(options.depths) : options.depths;\n      } else {\n        depths = [context];\n      }\n    }\n\n    function main(context/*, options*/) {\n      return '' + templateSpec.main(container, context, container.helpers, container.partials, data, blockParams, depths);\n    }\n    main = executeDecorators(templateSpec.main, main, container, options.depths || [], data, blockParams);\n    return main(context, options);\n  }\n  ret.isTop = true;\n\n  ret._setup = function(options) {\n    if (!options.partial) {\n      container.helpers = container.merge(options.helpers, env.helpers);\n\n      if (templateSpec.usePartial) {\n        container.partials = container.merge(options.partials, env.partials);\n      }\n      if (templateSpec.usePartial || templateSpec.useDecorators) {\n        container.decorators = container.merge(options.decorators, env.decorators);\n      }\n    } else {\n      container.helpers = options.helpers;\n      container.partials = options.partials;\n      container.decorators = options.decorators;\n    }\n  };\n\n  ret._child = function(i, data, blockParams, depths) {\n    if (templateSpec.useBlockParams && !blockParams) {\n      throw new Exception('must pass block params');\n    }\n    if (templateSpec.useDepths && !depths) {\n      throw new Exception('must pass parent depths');\n    }\n\n    return wrapProgram(container, i, templateSpec[i], data, 0, blockParams, depths);\n  };\n  return ret;\n}\n\nexport function wrapProgram(container, i, fn, data, declaredBlockParams, blockParams, depths) {\n  function prog(context, options = {}) {\n    let currentDepths = depths;\n    if (depths && context != depths[0] && !(context === container.nullContext && depths[0] === null)) {\n      currentDepths = [context].concat(depths);\n    }\n\n    return fn(container,\n        context,\n        container.helpers, container.partials,\n        options.data || data,\n        blockParams && [options.blockParams].concat(blockParams),\n        currentDepths);\n  }\n\n  prog = executeDecorators(fn, prog, container, depths, data, blockParams);\n\n  prog.program = i;\n  prog.depth = depths ? depths.length : 0;\n  prog.blockParams = declaredBlockParams || 0;\n  return prog;\n}\n\nexport function resolvePartial(partial, context, options) {\n  if (!partial) {\n    if (options.name === '@partial-block') {\n      partial = options.data['partial-block'];\n    } else {\n      partial = options.partials[options.name];\n    }\n  } else if (!partial.call && !options.name) {\n    // This is a dynamic partial that returned a string\n    options.name = partial;\n    partial = options.partials[partial];\n  }\n  return partial;\n}\n\nexport function invokePartial(partial, context, options) {\n  // Use the current closure context to save the partial-block if this partial\n  const currentPartialBlock = options.data && options.data['partial-block'];\n  options.partial = true;\n  if (options.ids) {\n    options.data.contextPath = options.ids[0] || options.data.contextPath;\n  }\n\n  let partialBlock;\n  if (options.fn && options.fn !== noop) {\n    options.data = createFrame(options.data);\n    // Wrapper function to get access to currentPartialBlock from the closure\n    let fn = options.fn;\n    partialBlock = options.data['partial-block'] = function partialBlockWrapper(context, options = {}) {\n\n      // Restore the partial-block from the closure for the execution of the block\n      // i.e. the part inside the block of the partial call.\n      options.data = createFrame(options.data);\n      options.data['partial-block'] = currentPartialBlock;\n      return fn(context, options);\n    };\n    if (fn.partials) {\n      options.partials = Utils.extend({}, options.partials, fn.partials);\n    }\n  }\n\n  if (partial === undefined && partialBlock) {\n    partial = partialBlock;\n  }\n\n  if (partial === undefined) {\n    throw new Exception('The partial ' + options.name + ' could not be found');\n  } else if (partial instanceof Function) {\n    return partial(context, options);\n  }\n}\n\nexport function noop() { return ''; }\n\nfunction initData(context, data) {\n  if (!data || !('root' in data)) {\n    data = data ? createFrame(data) : {};\n    data.root = context;\n  }\n  return data;\n}\n\nfunction executeDecorators(fn, prog, container, depths, data, blockParams) {\n  if (fn.decorator) {\n    let props = {};\n    prog = fn.decorator(prog, props, container, depths && depths[0], data, blockParams, depths);\n    Utils.extend(prog, props);\n  }\n  return prog;\n}\n",
    "// Build out our basic SafeString type\nfunction SafeString(string) {\n  this.string = string;\n}\n\nSafeString.prototype.toString = SafeString.prototype.toHTML = function() {\n  return '' + this.string;\n};\n\nexport default SafeString;\n",
    "const escape = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;',\n  '=': '&#x3D;'\n};\n\nconst badChars = /[&<>\"'`=]/g,\n      possible = /[&<>\"'`=]/;\n\nfunction escapeChar(chr) {\n  return escape[chr];\n}\n\nexport function extend(obj/* , ...source */) {\n  for (let i = 1; i < arguments.length; i++) {\n    for (let key in arguments[i]) {\n      if (Object.prototype.hasOwnProperty.call(arguments[i], key)) {\n        obj[key] = arguments[i][key];\n      }\n    }\n  }\n\n  return obj;\n}\n\nexport let toString = Object.prototype.toString;\n\n// Sourced from lodash\n// https://github.com/bestiejs/lodash/blob/master/LICENSE.txt\n/* eslint-disable func-style */\nlet isFunction = function(value) {\n  return typeof value === 'function';\n};\n// fallback for older versions of Chrome and Safari\n/* istanbul ignore next */\nif (isFunction(/x/)) {\n  isFunction = function(value) {\n    return typeof value === 'function' && toString.call(value) === '[object Function]';\n  };\n}\nexport {isFunction};\n/* eslint-enable func-style */\n\n/* istanbul ignore next */\nexport const isArray = Array.isArray || function(value) {\n  return (value && typeof value === 'object') ? toString.call(value) === '[object Array]' : false;\n};\n\n// Older IE versions do not directly support indexOf so we must implement our own, sadly.\nexport function indexOf(array, value) {\n  for (let i = 0, len = array.length; i < len; i++) {\n    if (array[i] === value) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n\nexport function escapeExpression(string) {\n  if (typeof string !== 'string') {\n    // don't escape SafeStrings, since they're already safe\n    if (string && string.toHTML) {\n      return string.toHTML();\n    } else if (string == null) {\n      return '';\n    } else if (!string) {\n      return string + '';\n    }\n\n    // Force a string conversion as this will be done by the append regardless and\n    // the regex test will do this transparently behind the scenes, causing issues if\n    // an object's to string has escaped characters in it.\n    string = '' + string;\n  }\n\n  if (!possible.test(string)) { return string; }\n  return string.replace(badChars, escapeChar);\n}\n\nexport function isEmpty(value) {\n  if (!value && value !== 0) {\n    return true;\n  } else if (isArray(value) && value.length === 0) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function createFrame(object) {\n  let frame = extend({}, object);\n  frame._parent = object;\n  return frame;\n}\n\nexport function blockParams(params, ids) {\n  params.path = ids;\n  return params;\n}\n\nexport function appendContextPath(contextPath, id) {\n  return (contextPath ? contextPath + '.' : '') + id;\n}\n",
    "// Create a simple path alias to allow browserify to resolve\n// the runtime on a supported path.\nmodule.exports = require('./dist/cjs/handlebars.runtime')['default'];\n",
    "module.exports = require(\"handlebars/runtime\")[\"default\"];\n",
    "// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n",
    "(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 6–8\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n",
    "var makeString = require('./helper/makeString');\n\nmodule.exports = function capitalize(str, lowercaseRest) {\n  str = makeString(str);\n  var remainingChars = !lowercaseRest ? str.slice(1) : str.slice(1).toLowerCase();\n\n  return str.charAt(0).toUpperCase() + remainingChars;\n};\n",
    "var trim = require('./trim');\n\nmodule.exports = function dasherize(str) {\n  return trim(str).replace(/([A-Z])/g, '-$1').replace(/[-_\\s]+/g, '-').toLowerCase();\n};\n",
    "var escapeRegExp = require('./escapeRegExp');\n\nmodule.exports = function defaultToWhiteSpace(characters) {\n  if (characters == null)\n    return '\\\\s';\n  else if (characters.source)\n    return characters.source;\n  else\n    return '[' + escapeRegExp(characters) + ']';\n};\n",
    "var makeString = require('./makeString');\n\nmodule.exports = function escapeRegExp(str) {\n  return makeString(str).replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g, '\\\\$1');\n};\n",
    "/**\n * Ensure some object is a coerced to a string\n **/\nmodule.exports = function makeString(object) {\n  if (object == null) return '';\n  return '' + object;\n};\n",
    "module.exports = function strRepeat(str, qty){\n  if (qty < 1) return '';\n  var result = '';\n  while (qty > 0) {\n    if (qty & 1) result += str;\n    qty >>= 1, str += str;\n  }\n  return result;\n};\n",
    "var pad = require('./pad');\n\nmodule.exports = function lpad(str, length, padStr) {\n  return pad(str, length, padStr);\n};\n",
    "var makeString = require('./helper/makeString');\nvar strRepeat = require('./helper/strRepeat');\n\nmodule.exports = function pad(str, length, padStr, type) {\n  str = makeString(str);\n  length = ~~length;\n\n  var padlen = 0;\n\n  if (!padStr)\n    padStr = ' ';\n  else if (padStr.length > 1)\n    padStr = padStr.charAt(0);\n\n  switch (type) {\n  case 'right':\n    padlen = length - str.length;\n    return str + strRepeat(padStr, padlen);\n  case 'both':\n    padlen = length - str.length;\n    return strRepeat(padStr, Math.ceil(padlen / 2)) + str + strRepeat(padStr, Math.floor(padlen / 2));\n  default: // 'left'\n    padlen = length - str.length;\n    return strRepeat(padStr, padlen) + str;\n  }\n};\n",
    "var pad = require('./pad');\n\nmodule.exports = function rpad(str, length, padStr) {\n  return pad(str, length, padStr, 'right');\n};\n",
    "var makeString = require('./helper/makeString');\nvar defaultToWhiteSpace = require('./helper/defaultToWhiteSpace');\nvar nativeTrim = String.prototype.trim;\n\nmodule.exports = function trim(str, characters) {\n  str = makeString(str);\n  if (!characters && nativeTrim) return nativeTrim.call(str);\n  characters = defaultToWhiteSpace(characters);\n  return str.replace(new RegExp('^' + characters + '+|' + characters + '+$', 'g'), '');\n};\n",
    "//     Underscore.js 1.8.3\n//     http://underscorejs.org\n//     (c) 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n//     Underscore may be freely distributed under the MIT license.\n\n(function() {\n\n  // Baseline setup\n  // --------------\n\n  // Establish the root object, `window` in the browser, or `exports` on the server.\n  var root = this;\n\n  // Save the previous value of the `_` variable.\n  var previousUnderscore = root._;\n\n  // Save bytes in the minified (but not gzipped) version:\n  var ArrayProto = Array.prototype, ObjProto = Object.prototype, FuncProto = Function.prototype;\n\n  // Create quick reference variables for speed access to core prototypes.\n  var\n    push             = ArrayProto.push,\n    slice            = ArrayProto.slice,\n    toString         = ObjProto.toString,\n    hasOwnProperty   = ObjProto.hasOwnProperty;\n\n  // All **ECMAScript 5** native function implementations that we hope to use\n  // are declared here.\n  var\n    nativeIsArray      = Array.isArray,\n    nativeKeys         = Object.keys,\n    nativeBind         = FuncProto.bind,\n    nativeCreate       = Object.create;\n\n  // Naked function reference for surrogate-prototype-swapping.\n  var Ctor = function(){};\n\n  // Create a safe reference to the Underscore object for use below.\n  var _ = function(obj) {\n    if (obj instanceof _) return obj;\n    if (!(this instanceof _)) return new _(obj);\n    this._wrapped = obj;\n  };\n\n  // Export the Underscore object for **Node.js**, with\n  // backwards-compatibility for the old `require()` API. If we're in\n  // the browser, add `_` as a global object.\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      exports = module.exports = _;\n    }\n    exports._ = _;\n  } else {\n    root._ = _;\n  }\n\n  // Current version.\n  _.VERSION = '1.8.3';\n\n  // Internal function that returns an efficient (for current engines) version\n  // of the passed-in callback, to be repeatedly applied in other Underscore\n  // functions.\n  var optimizeCb = function(func, context, argCount) {\n    if (context === void 0) return func;\n    switch (argCount == null ? 3 : argCount) {\n      case 1: return function(value) {\n        return func.call(context, value);\n      };\n      case 2: return function(value, other) {\n        return func.call(context, value, other);\n      };\n      case 3: return function(value, index, collection) {\n        return func.call(context, value, index, collection);\n      };\n      case 4: return function(accumulator, value, index, collection) {\n        return func.call(context, accumulator, value, index, collection);\n      };\n    }\n    return function() {\n      return func.apply(context, arguments);\n    };\n  };\n\n  // A mostly-internal function to generate callbacks that can be applied\n  // to each element in a collection, returning the desired result — either\n  // identity, an arbitrary callback, a property matcher, or a property accessor.\n  var cb = function(value, context, argCount) {\n    if (value == null) return _.identity;\n    if (_.isFunction(value)) return optimizeCb(value, context, argCount);\n    if (_.isObject(value)) return _.matcher(value);\n    return _.property(value);\n  };\n  _.iteratee = function(value, context) {\n    return cb(value, context, Infinity);\n  };\n\n  // An internal function for creating assigner functions.\n  var createAssigner = function(keysFunc, undefinedOnly) {\n    return function(obj) {\n      var length = arguments.length;\n      if (length < 2 || obj == null) return obj;\n      for (var index = 1; index < length; index++) {\n        var source = arguments[index],\n            keys = keysFunc(source),\n            l = keys.length;\n        for (var i = 0; i < l; i++) {\n          var key = keys[i];\n          if (!undefinedOnly || obj[key] === void 0) obj[key] = source[key];\n        }\n      }\n      return obj;\n    };\n  };\n\n  // An internal function for creating a new object that inherits from another.\n  var baseCreate = function(prototype) {\n    if (!_.isObject(prototype)) return {};\n    if (nativeCreate) return nativeCreate(prototype);\n    Ctor.prototype = prototype;\n    var result = new Ctor;\n    Ctor.prototype = null;\n    return result;\n  };\n\n  var property = function(key) {\n    return function(obj) {\n      return obj == null ? void 0 : obj[key];\n    };\n  };\n\n  // Helper for collection methods to determine whether a collection\n  // should be iterated as an array or as an object\n  // Related: http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength\n  // Avoids a very nasty iOS 8 JIT bug on ARM-64. #2094\n  var MAX_ARRAY_INDEX = Math.pow(2, 53) - 1;\n  var getLength = property('length');\n  var isArrayLike = function(collection) {\n    var length = getLength(collection);\n    return typeof length == 'number' && length >= 0 && length <= MAX_ARRAY_INDEX;\n  };\n\n  // Collection Functions\n  // --------------------\n\n  // The cornerstone, an `each` implementation, aka `forEach`.\n  // Handles raw objects in addition to array-likes. Treats all\n  // sparse array-likes as if they were dense.\n  _.each = _.forEach = function(obj, iteratee, context) {\n    iteratee = optimizeCb(iteratee, context);\n    var i, length;\n    if (isArrayLike(obj)) {\n      for (i = 0, length = obj.length; i < length; i++) {\n        iteratee(obj[i], i, obj);\n      }\n    } else {\n      var keys = _.keys(obj);\n      for (i = 0, length = keys.length; i < length; i++) {\n        iteratee(obj[keys[i]], keys[i], obj);\n      }\n    }\n    return obj;\n  };\n\n  // Return the results of applying the iteratee to each element.\n  _.map = _.collect = function(obj, iteratee, context) {\n    iteratee = cb(iteratee, context);\n    var keys = !isArrayLike(obj) && _.keys(obj),\n        length = (keys || obj).length,\n        results = Array(length);\n    for (var index = 0; index < length; index++) {\n      var currentKey = keys ? keys[index] : index;\n      results[index] = iteratee(obj[currentKey], currentKey, obj);\n    }\n    return results;\n  };\n\n  // Create a reducing function iterating left or right.\n  function createReduce(dir) {\n    // Optimized iterator function as using arguments.length\n    // in the main function will deoptimize the, see #1991.\n    function iterator(obj, iteratee, memo, keys, index, length) {\n      for (; index >= 0 && index < length; index += dir) {\n        var currentKey = keys ? keys[index] : index;\n        memo = iteratee(memo, obj[currentKey], currentKey, obj);\n      }\n      return memo;\n    }\n\n    return function(obj, iteratee, memo, context) {\n      iteratee = optimizeCb(iteratee, context, 4);\n      var keys = !isArrayLike(obj) && _.keys(obj),\n          length = (keys || obj).length,\n          index = dir > 0 ? 0 : length - 1;\n      // Determine the initial value if none is provided.\n      if (arguments.length < 3) {\n        memo = obj[keys ? keys[index] : index];\n        index += dir;\n      }\n      return iterator(obj, iteratee, memo, keys, index, length);\n    };\n  }\n\n  // **Reduce** builds up a single result from a list of values, aka `inject`,\n  // or `foldl`.\n  _.reduce = _.foldl = _.inject = createReduce(1);\n\n  // The right-associative version of reduce, also known as `foldr`.\n  _.reduceRight = _.foldr = createReduce(-1);\n\n  // Return the first value which passes a truth test. Aliased as `detect`.\n  _.find = _.detect = function(obj, predicate, context) {\n    var key;\n    if (isArrayLike(obj)) {\n      key = _.findIndex(obj, predicate, context);\n    } else {\n      key = _.findKey(obj, predicate, context);\n    }\n    if (key !== void 0 && key !== -1) return obj[key];\n  };\n\n  // Return all the elements that pass a truth test.\n  // Aliased as `select`.\n  _.filter = _.select = function(obj, predicate, context) {\n    var results = [];\n    predicate = cb(predicate, context);\n    _.each(obj, function(value, index, list) {\n      if (predicate(value, index, list)) results.push(value);\n    });\n    return results;\n  };\n\n  // Return all the elements for which a truth test fails.\n  _.reject = function(obj, predicate, context) {\n    return _.filter(obj, _.negate(cb(predicate)), context);\n  };\n\n  // Determine whether all of the elements match a truth test.\n  // Aliased as `all`.\n  _.every = _.all = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var keys = !isArrayLike(obj) && _.keys(obj),\n        length = (keys || obj).length;\n    for (var index = 0; index < length; index++) {\n      var currentKey = keys ? keys[index] : index;\n      if (!predicate(obj[currentKey], currentKey, obj)) return false;\n    }\n    return true;\n  };\n\n  // Determine if at least one element in the object matches a truth test.\n  // Aliased as `any`.\n  _.some = _.any = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var keys = !isArrayLike(obj) && _.keys(obj),\n        length = (keys || obj).length;\n    for (var index = 0; index < length; index++) {\n      var currentKey = keys ? keys[index] : index;\n      if (predicate(obj[currentKey], currentKey, obj)) return true;\n    }\n    return false;\n  };\n\n  // Determine if the array or object contains a given item (using `===`).\n  // Aliased as `includes` and `include`.\n  _.contains = _.includes = _.include = function(obj, item, fromIndex, guard) {\n    if (!isArrayLike(obj)) obj = _.values(obj);\n    if (typeof fromIndex != 'number' || guard) fromIndex = 0;\n    return _.indexOf(obj, item, fromIndex) >= 0;\n  };\n\n  // Invoke a method (with arguments) on every item in a collection.\n  _.invoke = function(obj, method) {\n    var args = slice.call(arguments, 2);\n    var isFunc = _.isFunction(method);\n    return _.map(obj, function(value) {\n      var func = isFunc ? method : value[method];\n      return func == null ? func : func.apply(value, args);\n    });\n  };\n\n  // Convenience version of a common use case of `map`: fetching a property.\n  _.pluck = function(obj, key) {\n    return _.map(obj, _.property(key));\n  };\n\n  // Convenience version of a common use case of `filter`: selecting only objects\n  // containing specific `key:value` pairs.\n  _.where = function(obj, attrs) {\n    return _.filter(obj, _.matcher(attrs));\n  };\n\n  // Convenience version of a common use case of `find`: getting the first object\n  // containing specific `key:value` pairs.\n  _.findWhere = function(obj, attrs) {\n    return _.find(obj, _.matcher(attrs));\n  };\n\n  // Return the maximum element (or element-based computation).\n  _.max = function(obj, iteratee, context) {\n    var result = -Infinity, lastComputed = -Infinity,\n        value, computed;\n    if (iteratee == null && obj != null) {\n      obj = isArrayLike(obj) ? obj : _.values(obj);\n      for (var i = 0, length = obj.length; i < length; i++) {\n        value = obj[i];\n        if (value > result) {\n          result = value;\n        }\n      }\n    } else {\n      iteratee = cb(iteratee, context);\n      _.each(obj, function(value, index, list) {\n        computed = iteratee(value, index, list);\n        if (computed > lastComputed || computed === -Infinity && result === -Infinity) {\n          result = value;\n          lastComputed = computed;\n        }\n      });\n    }\n    return result;\n  };\n\n  // Return the minimum element (or element-based computation).\n  _.min = function(obj, iteratee, context) {\n    var result = Infinity, lastComputed = Infinity,\n        value, computed;\n    if (iteratee == null && obj != null) {\n      obj = isArrayLike(obj) ? obj : _.values(obj);\n      for (var i = 0, length = obj.length; i < length; i++) {\n        value = obj[i];\n        if (value < result) {\n          result = value;\n        }\n      }\n    } else {\n      iteratee = cb(iteratee, context);\n      _.each(obj, function(value, index, list) {\n        computed = iteratee(value, index, list);\n        if (computed < lastComputed || computed === Infinity && result === Infinity) {\n          result = value;\n          lastComputed = computed;\n        }\n      });\n    }\n    return result;\n  };\n\n  // Shuffle a collection, using the modern version of the\n  // [Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher–Yates_shuffle).\n  _.shuffle = function(obj) {\n    var set = isArrayLike(obj) ? obj : _.values(obj);\n    var length = set.length;\n    var shuffled = Array(length);\n    for (var index = 0, rand; index < length; index++) {\n      rand = _.random(0, index);\n      if (rand !== index) shuffled[index] = shuffled[rand];\n      shuffled[rand] = set[index];\n    }\n    return shuffled;\n  };\n\n  // Sample **n** random values from a collection.\n  // If **n** is not specified, returns a single random element.\n  // The internal `guard` argument allows it to work with `map`.\n  _.sample = function(obj, n, guard) {\n    if (n == null || guard) {\n      if (!isArrayLike(obj)) obj = _.values(obj);\n      return obj[_.random(obj.length - 1)];\n    }\n    return _.shuffle(obj).slice(0, Math.max(0, n));\n  };\n\n  // Sort the object's values by a criterion produced by an iteratee.\n  _.sortBy = function(obj, iteratee, context) {\n    iteratee = cb(iteratee, context);\n    return _.pluck(_.map(obj, function(value, index, list) {\n      return {\n        value: value,\n        index: index,\n        criteria: iteratee(value, index, list)\n      };\n    }).sort(function(left, right) {\n      var a = left.criteria;\n      var b = right.criteria;\n      if (a !== b) {\n        if (a > b || a === void 0) return 1;\n        if (a < b || b === void 0) return -1;\n      }\n      return left.index - right.index;\n    }), 'value');\n  };\n\n  // An internal function used for aggregate \"group by\" operations.\n  var group = function(behavior) {\n    return function(obj, iteratee, context) {\n      var result = {};\n      iteratee = cb(iteratee, context);\n      _.each(obj, function(value, index) {\n        var key = iteratee(value, index, obj);\n        behavior(result, value, key);\n      });\n      return result;\n    };\n  };\n\n  // Groups the object's values by a criterion. Pass either a string attribute\n  // to group by, or a function that returns the criterion.\n  _.groupBy = group(function(result, value, key) {\n    if (_.has(result, key)) result[key].push(value); else result[key] = [value];\n  });\n\n  // Indexes the object's values by a criterion, similar to `groupBy`, but for\n  // when you know that your index values will be unique.\n  _.indexBy = group(function(result, value, key) {\n    result[key] = value;\n  });\n\n  // Counts instances of an object that group by a certain criterion. Pass\n  // either a string attribute to count by, or a function that returns the\n  // criterion.\n  _.countBy = group(function(result, value, key) {\n    if (_.has(result, key)) result[key]++; else result[key] = 1;\n  });\n\n  // Safely create a real, live array from anything iterable.\n  _.toArray = function(obj) {\n    if (!obj) return [];\n    if (_.isArray(obj)) return slice.call(obj);\n    if (isArrayLike(obj)) return _.map(obj, _.identity);\n    return _.values(obj);\n  };\n\n  // Return the number of elements in an object.\n  _.size = function(obj) {\n    if (obj == null) return 0;\n    return isArrayLike(obj) ? obj.length : _.keys(obj).length;\n  };\n\n  // Split a collection into two arrays: one whose elements all satisfy the given\n  // predicate, and one whose elements all do not satisfy the predicate.\n  _.partition = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var pass = [], fail = [];\n    _.each(obj, function(value, key, obj) {\n      (predicate(value, key, obj) ? pass : fail).push(value);\n    });\n    return [pass, fail];\n  };\n\n  // Array Functions\n  // ---------------\n\n  // Get the first element of an array. Passing **n** will return the first N\n  // values in the array. Aliased as `head` and `take`. The **guard** check\n  // allows it to work with `_.map`.\n  _.first = _.head = _.take = function(array, n, guard) {\n    if (array == null) return void 0;\n    if (n == null || guard) return array[0];\n    return _.initial(array, array.length - n);\n  };\n\n  // Returns everything but the last entry of the array. Especially useful on\n  // the arguments object. Passing **n** will return all the values in\n  // the array, excluding the last N.\n  _.initial = function(array, n, guard) {\n    return slice.call(array, 0, Math.max(0, array.length - (n == null || guard ? 1 : n)));\n  };\n\n  // Get the last element of an array. Passing **n** will return the last N\n  // values in the array.\n  _.last = function(array, n, guard) {\n    if (array == null) return void 0;\n    if (n == null || guard) return array[array.length - 1];\n    return _.rest(array, Math.max(0, array.length - n));\n  };\n\n  // Returns everything but the first entry of the array. Aliased as `tail` and `drop`.\n  // Especially useful on the arguments object. Passing an **n** will return\n  // the rest N values in the array.\n  _.rest = _.tail = _.drop = function(array, n, guard) {\n    return slice.call(array, n == null || guard ? 1 : n);\n  };\n\n  // Trim out all falsy values from an array.\n  _.compact = function(array) {\n    return _.filter(array, _.identity);\n  };\n\n  // Internal implementation of a recursive `flatten` function.\n  var flatten = function(input, shallow, strict, startIndex) {\n    var output = [], idx = 0;\n    for (var i = startIndex || 0, length = getLength(input); i < length; i++) {\n      var value = input[i];\n      if (isArrayLike(value) && (_.isArray(value) || _.isArguments(value))) {\n        //flatten current level of array or arguments object\n        if (!shallow) value = flatten(value, shallow, strict);\n        var j = 0, len = value.length;\n        output.length += len;\n        while (j < len) {\n          output[idx++] = value[j++];\n        }\n      } else if (!strict) {\n        output[idx++] = value;\n      }\n    }\n    return output;\n  };\n\n  // Flatten out an array, either recursively (by default), or just one level.\n  _.flatten = function(array, shallow) {\n    return flatten(array, shallow, false);\n  };\n\n  // Return a version of the array that does not contain the specified value(s).\n  _.without = function(array) {\n    return _.difference(array, slice.call(arguments, 1));\n  };\n\n  // Produce a duplicate-free version of the array. If the array has already\n  // been sorted, you have the option of using a faster algorithm.\n  // Aliased as `unique`.\n  _.uniq = _.unique = function(array, isSorted, iteratee, context) {\n    if (!_.isBoolean(isSorted)) {\n      context = iteratee;\n      iteratee = isSorted;\n      isSorted = false;\n    }\n    if (iteratee != null) iteratee = cb(iteratee, context);\n    var result = [];\n    var seen = [];\n    for (var i = 0, length = getLength(array); i < length; i++) {\n      var value = array[i],\n          computed = iteratee ? iteratee(value, i, array) : value;\n      if (isSorted) {\n        if (!i || seen !== computed) result.push(value);\n        seen = computed;\n      } else if (iteratee) {\n        if (!_.contains(seen, computed)) {\n          seen.push(computed);\n          result.push(value);\n        }\n      } else if (!_.contains(result, value)) {\n        result.push(value);\n      }\n    }\n    return result;\n  };\n\n  // Produce an array that contains the union: each distinct element from all of\n  // the passed-in arrays.\n  _.union = function() {\n    return _.uniq(flatten(arguments, true, true));\n  };\n\n  // Produce an array that contains every item shared between all the\n  // passed-in arrays.\n  _.intersection = function(array) {\n    var result = [];\n    var argsLength = arguments.length;\n    for (var i = 0, length = getLength(array); i < length; i++) {\n      var item = array[i];\n      if (_.contains(result, item)) continue;\n      for (var j = 1; j < argsLength; j++) {\n        if (!_.contains(arguments[j], item)) break;\n      }\n      if (j === argsLength) result.push(item);\n    }\n    return result;\n  };\n\n  // Take the difference between one array and a number of other arrays.\n  // Only the elements present in just the first array will remain.\n  _.difference = function(array) {\n    var rest = flatten(arguments, true, true, 1);\n    return _.filter(array, function(value){\n      return !_.contains(rest, value);\n    });\n  };\n\n  // Zip together multiple lists into a single array -- elements that share\n  // an index go together.\n  _.zip = function() {\n    return _.unzip(arguments);\n  };\n\n  // Complement of _.zip. Unzip accepts an array of arrays and groups\n  // each array's elements on shared indices\n  _.unzip = function(array) {\n    var length = array && _.max(array, getLength).length || 0;\n    var result = Array(length);\n\n    for (var index = 0; index < length; index++) {\n      result[index] = _.pluck(array, index);\n    }\n    return result;\n  };\n\n  // Converts lists into objects. Pass either a single array of `[key, value]`\n  // pairs, or two parallel arrays of the same length -- one of keys, and one of\n  // the corresponding values.\n  _.object = function(list, values) {\n    var result = {};\n    for (var i = 0, length = getLength(list); i < length; i++) {\n      if (values) {\n        result[list[i]] = values[i];\n      } else {\n        result[list[i][0]] = list[i][1];\n      }\n    }\n    return result;\n  };\n\n  // Generator function to create the findIndex and findLastIndex functions\n  function createPredicateIndexFinder(dir) {\n    return function(array, predicate, context) {\n      predicate = cb(predicate, context);\n      var length = getLength(array);\n      var index = dir > 0 ? 0 : length - 1;\n      for (; index >= 0 && index < length; index += dir) {\n        if (predicate(array[index], index, array)) return index;\n      }\n      return -1;\n    };\n  }\n\n  // Returns the first index on an array-like that passes a predicate test\n  _.findIndex = createPredicateIndexFinder(1);\n  _.findLastIndex = createPredicateIndexFinder(-1);\n\n  // Use a comparator function to figure out the smallest index at which\n  // an object should be inserted so as to maintain order. Uses binary search.\n  _.sortedIndex = function(array, obj, iteratee, context) {\n    iteratee = cb(iteratee, context, 1);\n    var value = iteratee(obj);\n    var low = 0, high = getLength(array);\n    while (low < high) {\n      var mid = Math.floor((low + high) / 2);\n      if (iteratee(array[mid]) < value) low = mid + 1; else high = mid;\n    }\n    return low;\n  };\n\n  // Generator function to create the indexOf and lastIndexOf functions\n  function createIndexFinder(dir, predicateFind, sortedIndex) {\n    return function(array, item, idx) {\n      var i = 0, length = getLength(array);\n      if (typeof idx == 'number') {\n        if (dir > 0) {\n            i = idx >= 0 ? idx : Math.max(idx + length, i);\n        } else {\n            length = idx >= 0 ? Math.min(idx + 1, length) : idx + length + 1;\n        }\n      } else if (sortedIndex && idx && length) {\n        idx = sortedIndex(array, item);\n        return array[idx] === item ? idx : -1;\n      }\n      if (item !== item) {\n        idx = predicateFind(slice.call(array, i, length), _.isNaN);\n        return idx >= 0 ? idx + i : -1;\n      }\n      for (idx = dir > 0 ? i : length - 1; idx >= 0 && idx < length; idx += dir) {\n        if (array[idx] === item) return idx;\n      }\n      return -1;\n    };\n  }\n\n  // Return the position of the first occurrence of an item in an array,\n  // or -1 if the item is not included in the array.\n  // If the array is large and already in sort order, pass `true`\n  // for **isSorted** to use binary search.\n  _.indexOf = createIndexFinder(1, _.findIndex, _.sortedIndex);\n  _.lastIndexOf = createIndexFinder(-1, _.findLastIndex);\n\n  // Generate an integer Array containing an arithmetic progression. A port of\n  // the native Python `range()` function. See\n  // [the Python documentation](http://docs.python.org/library/functions.html#range).\n  _.range = function(start, stop, step) {\n    if (stop == null) {\n      stop = start || 0;\n      start = 0;\n    }\n    step = step || 1;\n\n    var length = Math.max(Math.ceil((stop - start) / step), 0);\n    var range = Array(length);\n\n    for (var idx = 0; idx < length; idx++, start += step) {\n      range[idx] = start;\n    }\n\n    return range;\n  };\n\n  // Function (ahem) Functions\n  // ------------------\n\n  // Determines whether to execute a function as a constructor\n  // or a normal function with the provided arguments\n  var executeBound = function(sourceFunc, boundFunc, context, callingContext, args) {\n    if (!(callingContext instanceof boundFunc)) return sourceFunc.apply(context, args);\n    var self = baseCreate(sourceFunc.prototype);\n    var result = sourceFunc.apply(self, args);\n    if (_.isObject(result)) return result;\n    return self;\n  };\n\n  // Create a function bound to a given object (assigning `this`, and arguments,\n  // optionally). Delegates to **ECMAScript 5**'s native `Function.bind` if\n  // available.\n  _.bind = function(func, context) {\n    if (nativeBind && func.bind === nativeBind) return nativeBind.apply(func, slice.call(arguments, 1));\n    if (!_.isFunction(func)) throw new TypeError('Bind must be called on a function');\n    var args = slice.call(arguments, 2);\n    var bound = function() {\n      return executeBound(func, bound, context, this, args.concat(slice.call(arguments)));\n    };\n    return bound;\n  };\n\n  // Partially apply a function by creating a version that has had some of its\n  // arguments pre-filled, without changing its dynamic `this` context. _ acts\n  // as a placeholder, allowing any combination of arguments to be pre-filled.\n  _.partial = function(func) {\n    var boundArgs = slice.call(arguments, 1);\n    var bound = function() {\n      var position = 0, length = boundArgs.length;\n      var args = Array(length);\n      for (var i = 0; i < length; i++) {\n        args[i] = boundArgs[i] === _ ? arguments[position++] : boundArgs[i];\n      }\n      while (position < arguments.length) args.push(arguments[position++]);\n      return executeBound(func, bound, this, this, args);\n    };\n    return bound;\n  };\n\n  // Bind a number of an object's methods to that object. Remaining arguments\n  // are the method names to be bound. Useful for ensuring that all callbacks\n  // defined on an object belong to it.\n  _.bindAll = function(obj) {\n    var i, length = arguments.length, key;\n    if (length <= 1) throw new Error('bindAll must be passed function names');\n    for (i = 1; i < length; i++) {\n      key = arguments[i];\n      obj[key] = _.bind(obj[key], obj);\n    }\n    return obj;\n  };\n\n  // Memoize an expensive function by storing its results.\n  _.memoize = function(func, hasher) {\n    var memoize = function(key) {\n      var cache = memoize.cache;\n      var address = '' + (hasher ? hasher.apply(this, arguments) : key);\n      if (!_.has(cache, address)) cache[address] = func.apply(this, arguments);\n      return cache[address];\n    };\n    memoize.cache = {};\n    return memoize;\n  };\n\n  // Delays a function for the given number of milliseconds, and then calls\n  // it with the arguments supplied.\n  _.delay = function(func, wait) {\n    var args = slice.call(arguments, 2);\n    return setTimeout(function(){\n      return func.apply(null, args);\n    }, wait);\n  };\n\n  // Defers a function, scheduling it to run after the current call stack has\n  // cleared.\n  _.defer = _.partial(_.delay, _, 1);\n\n  // Returns a function, that, when invoked, will only be triggered at most once\n  // during a given window of time. Normally, the throttled function will run\n  // as much as it can, without ever going more than once per `wait` duration;\n  // but if you'd like to disable the execution on the leading edge, pass\n  // `{leading: false}`. To disable execution on the trailing edge, ditto.\n  _.throttle = function(func, wait, options) {\n    var context, args, result;\n    var timeout = null;\n    var previous = 0;\n    if (!options) options = {};\n    var later = function() {\n      previous = options.leading === false ? 0 : _.now();\n      timeout = null;\n      result = func.apply(context, args);\n      if (!timeout) context = args = null;\n    };\n    return function() {\n      var now = _.now();\n      if (!previous && options.leading === false) previous = now;\n      var remaining = wait - (now - previous);\n      context = this;\n      args = arguments;\n      if (remaining <= 0 || remaining > wait) {\n        if (timeout) {\n          clearTimeout(timeout);\n          timeout = null;\n        }\n        previous = now;\n        result = func.apply(context, args);\n        if (!timeout) context = args = null;\n      } else if (!timeout && options.trailing !== false) {\n        timeout = setTimeout(later, remaining);\n      }\n      return result;\n    };\n  };\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // N milliseconds. If `immediate` is passed, trigger the function on the\n  // leading edge, instead of the trailing.\n  _.debounce = function(func, wait, immediate) {\n    var timeout, args, context, timestamp, result;\n\n    var later = function() {\n      var last = _.now() - timestamp;\n\n      if (last < wait && last >= 0) {\n        timeout = setTimeout(later, wait - last);\n      } else {\n        timeout = null;\n        if (!immediate) {\n          result = func.apply(context, args);\n          if (!timeout) context = args = null;\n        }\n      }\n    };\n\n    return function() {\n      context = this;\n      args = arguments;\n      timestamp = _.now();\n      var callNow = immediate && !timeout;\n      if (!timeout) timeout = setTimeout(later, wait);\n      if (callNow) {\n        result = func.apply(context, args);\n        context = args = null;\n      }\n\n      return result;\n    };\n  };\n\n  // Returns the first function passed as an argument to the second,\n  // allowing you to adjust arguments, run code before and after, and\n  // conditionally execute the original function.\n  _.wrap = function(func, wrapper) {\n    return _.partial(wrapper, func);\n  };\n\n  // Returns a negated version of the passed-in predicate.\n  _.negate = function(predicate) {\n    return function() {\n      return !predicate.apply(this, arguments);\n    };\n  };\n\n  // Returns a function that is the composition of a list of functions, each\n  // consuming the return value of the function that follows.\n  _.compose = function() {\n    var args = arguments;\n    var start = args.length - 1;\n    return function() {\n      var i = start;\n      var result = args[start].apply(this, arguments);\n      while (i--) result = args[i].call(this, result);\n      return result;\n    };\n  };\n\n  // Returns a function that will only be executed on and after the Nth call.\n  _.after = function(times, func) {\n    return function() {\n      if (--times < 1) {\n        return func.apply(this, arguments);\n      }\n    };\n  };\n\n  // Returns a function that will only be executed up to (but not including) the Nth call.\n  _.before = function(times, func) {\n    var memo;\n    return function() {\n      if (--times > 0) {\n        memo = func.apply(this, arguments);\n      }\n      if (times <= 1) func = null;\n      return memo;\n    };\n  };\n\n  // Returns a function that will be executed at most one time, no matter how\n  // often you call it. Useful for lazy initialization.\n  _.once = _.partial(_.before, 2);\n\n  // Object Functions\n  // ----------------\n\n  // Keys in IE < 9 that won't be iterated by `for key in ...` and thus missed.\n  var hasEnumBug = !{toString: null}.propertyIsEnumerable('toString');\n  var nonEnumerableProps = ['valueOf', 'isPrototypeOf', 'toString',\n                      'propertyIsEnumerable', 'hasOwnProperty', 'toLocaleString'];\n\n  function collectNonEnumProps(obj, keys) {\n    var nonEnumIdx = nonEnumerableProps.length;\n    var constructor = obj.constructor;\n    var proto = (_.isFunction(constructor) && constructor.prototype) || ObjProto;\n\n    // Constructor is a special case.\n    var prop = 'constructor';\n    if (_.has(obj, prop) && !_.contains(keys, prop)) keys.push(prop);\n\n    while (nonEnumIdx--) {\n      prop = nonEnumerableProps[nonEnumIdx];\n      if (prop in obj && obj[prop] !== proto[prop] && !_.contains(keys, prop)) {\n        keys.push(prop);\n      }\n    }\n  }\n\n  // Retrieve the names of an object's own properties.\n  // Delegates to **ECMAScript 5**'s native `Object.keys`\n  _.keys = function(obj) {\n    if (!_.isObject(obj)) return [];\n    if (nativeKeys) return nativeKeys(obj);\n    var keys = [];\n    for (var key in obj) if (_.has(obj, key)) keys.push(key);\n    // Ahem, IE < 9.\n    if (hasEnumBug) collectNonEnumProps(obj, keys);\n    return keys;\n  };\n\n  // Retrieve all the property names of an object.\n  _.allKeys = function(obj) {\n    if (!_.isObject(obj)) return [];\n    var keys = [];\n    for (var key in obj) keys.push(key);\n    // Ahem, IE < 9.\n    if (hasEnumBug) collectNonEnumProps(obj, keys);\n    return keys;\n  };\n\n  // Retrieve the values of an object's properties.\n  _.values = function(obj) {\n    var keys = _.keys(obj);\n    var length = keys.length;\n    var values = Array(length);\n    for (var i = 0; i < length; i++) {\n      values[i] = obj[keys[i]];\n    }\n    return values;\n  };\n\n  // Returns the results of applying the iteratee to each element of the object\n  // In contrast to _.map it returns an object\n  _.mapObject = function(obj, iteratee, context) {\n    iteratee = cb(iteratee, context);\n    var keys =  _.keys(obj),\n          length = keys.length,\n          results = {},\n          currentKey;\n      for (var index = 0; index < length; index++) {\n        currentKey = keys[index];\n        results[currentKey] = iteratee(obj[currentKey], currentKey, obj);\n      }\n      return results;\n  };\n\n  // Convert an object into a list of `[key, value]` pairs.\n  _.pairs = function(obj) {\n    var keys = _.keys(obj);\n    var length = keys.length;\n    var pairs = Array(length);\n    for (var i = 0; i < length; i++) {\n      pairs[i] = [keys[i], obj[keys[i]]];\n    }\n    return pairs;\n  };\n\n  // Invert the keys and values of an object. The values must be serializable.\n  _.invert = function(obj) {\n    var result = {};\n    var keys = _.keys(obj);\n    for (var i = 0, length = keys.length; i < length; i++) {\n      result[obj[keys[i]]] = keys[i];\n    }\n    return result;\n  };\n\n  // Return a sorted list of the function names available on the object.\n  // Aliased as `methods`\n  _.functions = _.methods = function(obj) {\n    var names = [];\n    for (var key in obj) {\n      if (_.isFunction(obj[key])) names.push(key);\n    }\n    return names.sort();\n  };\n\n  // Extend a given object with all the properties in passed-in object(s).\n  _.extend = createAssigner(_.allKeys);\n\n  // Assigns a given object with all the own properties in the passed-in object(s)\n  // (https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/assign)\n  _.extendOwn = _.assign = createAssigner(_.keys);\n\n  // Returns the first key on an object that passes a predicate test\n  _.findKey = function(obj, predicate, context) {\n    predicate = cb(predicate, context);\n    var keys = _.keys(obj), key;\n    for (var i = 0, length = keys.length; i < length; i++) {\n      key = keys[i];\n      if (predicate(obj[key], key, obj)) return key;\n    }\n  };\n\n  // Return a copy of the object only containing the whitelisted properties.\n  _.pick = function(object, oiteratee, context) {\n    var result = {}, obj = object, iteratee, keys;\n    if (obj == null) return result;\n    if (_.isFunction(oiteratee)) {\n      keys = _.allKeys(obj);\n      iteratee = optimizeCb(oiteratee, context);\n    } else {\n      keys = flatten(arguments, false, false, 1);\n      iteratee = function(value, key, obj) { return key in obj; };\n      obj = Object(obj);\n    }\n    for (var i = 0, length = keys.length; i < length; i++) {\n      var key = keys[i];\n      var value = obj[key];\n      if (iteratee(value, key, obj)) result[key] = value;\n    }\n    return result;\n  };\n\n   // Return a copy of the object without the blacklisted properties.\n  _.omit = function(obj, iteratee, context) {\n    if (_.isFunction(iteratee)) {\n      iteratee = _.negate(iteratee);\n    } else {\n      var keys = _.map(flatten(arguments, false, false, 1), String);\n      iteratee = function(value, key) {\n        return !_.contains(keys, key);\n      };\n    }\n    return _.pick(obj, iteratee, context);\n  };\n\n  // Fill in a given object with default properties.\n  _.defaults = createAssigner(_.allKeys, true);\n\n  // Creates an object that inherits from the given prototype object.\n  // If additional properties are provided then they will be added to the\n  // created object.\n  _.create = function(prototype, props) {\n    var result = baseCreate(prototype);\n    if (props) _.extendOwn(result, props);\n    return result;\n  };\n\n  // Create a (shallow-cloned) duplicate of an object.\n  _.clone = function(obj) {\n    if (!_.isObject(obj)) return obj;\n    return _.isArray(obj) ? obj.slice() : _.extend({}, obj);\n  };\n\n  // Invokes interceptor with the obj, and then returns obj.\n  // The primary purpose of this method is to \"tap into\" a method chain, in\n  // order to perform operations on intermediate results within the chain.\n  _.tap = function(obj, interceptor) {\n    interceptor(obj);\n    return obj;\n  };\n\n  // Returns whether an object has a given set of `key:value` pairs.\n  _.isMatch = function(object, attrs) {\n    var keys = _.keys(attrs), length = keys.length;\n    if (object == null) return !length;\n    var obj = Object(object);\n    for (var i = 0; i < length; i++) {\n      var key = keys[i];\n      if (attrs[key] !== obj[key] || !(key in obj)) return false;\n    }\n    return true;\n  };\n\n\n  // Internal recursive comparison function for `isEqual`.\n  var eq = function(a, b, aStack, bStack) {\n    // Identical objects are equal. `0 === -0`, but they aren't identical.\n    // See the [Harmony `egal` proposal](http://wiki.ecmascript.org/doku.php?id=harmony:egal).\n    if (a === b) return a !== 0 || 1 / a === 1 / b;\n    // A strict comparison is necessary because `null == undefined`.\n    if (a == null || b == null) return a === b;\n    // Unwrap any wrapped objects.\n    if (a instanceof _) a = a._wrapped;\n    if (b instanceof _) b = b._wrapped;\n    // Compare `[[Class]]` names.\n    var className = toString.call(a);\n    if (className !== toString.call(b)) return false;\n    switch (className) {\n      // Strings, numbers, regular expressions, dates, and booleans are compared by value.\n      case '[object RegExp]':\n      // RegExps are coerced to strings for comparison (Note: '' + /a/i === '/a/i')\n      case '[object String]':\n        // Primitives and their corresponding object wrappers are equivalent; thus, `\"5\"` is\n        // equivalent to `new String(\"5\")`.\n        return '' + a === '' + b;\n      case '[object Number]':\n        // `NaN`s are equivalent, but non-reflexive.\n        // Object(NaN) is equivalent to NaN\n        if (+a !== +a) return +b !== +b;\n        // An `egal` comparison is performed for other numeric values.\n        return +a === 0 ? 1 / +a === 1 / b : +a === +b;\n      case '[object Date]':\n      case '[object Boolean]':\n        // Coerce dates and booleans to numeric primitive values. Dates are compared by their\n        // millisecond representations. Note that invalid dates with millisecond representations\n        // of `NaN` are not equivalent.\n        return +a === +b;\n    }\n\n    var areArrays = className === '[object Array]';\n    if (!areArrays) {\n      if (typeof a != 'object' || typeof b != 'object') return false;\n\n      // Objects with different constructors are not equivalent, but `Object`s or `Array`s\n      // from different frames are.\n      var aCtor = a.constructor, bCtor = b.constructor;\n      if (aCtor !== bCtor && !(_.isFunction(aCtor) && aCtor instanceof aCtor &&\n                               _.isFunction(bCtor) && bCtor instanceof bCtor)\n                          && ('constructor' in a && 'constructor' in b)) {\n        return false;\n      }\n    }\n    // Assume equality for cyclic structures. The algorithm for detecting cyclic\n    // structures is adapted from ES 5.1 section 15.12.3, abstract operation `JO`.\n\n    // Initializing stack of traversed objects.\n    // It's done here since we only need them for objects and arrays comparison.\n    aStack = aStack || [];\n    bStack = bStack || [];\n    var length = aStack.length;\n    while (length--) {\n      // Linear search. Performance is inversely proportional to the number of\n      // unique nested structures.\n      if (aStack[length] === a) return bStack[length] === b;\n    }\n\n    // Add the first object to the stack of traversed objects.\n    aStack.push(a);\n    bStack.push(b);\n\n    // Recursively compare objects and arrays.\n    if (areArrays) {\n      // Compare array lengths to determine if a deep comparison is necessary.\n      length = a.length;\n      if (length !== b.length) return false;\n      // Deep compare the contents, ignoring non-numeric properties.\n      while (length--) {\n        if (!eq(a[length], b[length], aStack, bStack)) return false;\n      }\n    } else {\n      // Deep compare objects.\n      var keys = _.keys(a), key;\n      length = keys.length;\n      // Ensure that both objects contain the same number of properties before comparing deep equality.\n      if (_.keys(b).length !== length) return false;\n      while (length--) {\n        // Deep compare each member\n        key = keys[length];\n        if (!(_.has(b, key) && eq(a[key], b[key], aStack, bStack))) return false;\n      }\n    }\n    // Remove the first object from the stack of traversed objects.\n    aStack.pop();\n    bStack.pop();\n    return true;\n  };\n\n  // Perform a deep comparison to check if two objects are equal.\n  _.isEqual = function(a, b) {\n    return eq(a, b);\n  };\n\n  // Is a given array, string, or object empty?\n  // An \"empty\" object has no enumerable own-properties.\n  _.isEmpty = function(obj) {\n    if (obj == null) return true;\n    if (isArrayLike(obj) && (_.isArray(obj) || _.isString(obj) || _.isArguments(obj))) return obj.length === 0;\n    return _.keys(obj).length === 0;\n  };\n\n  // Is a given value a DOM element?\n  _.isElement = function(obj) {\n    return !!(obj && obj.nodeType === 1);\n  };\n\n  // Is a given value an array?\n  // Delegates to ECMA5's native Array.isArray\n  _.isArray = nativeIsArray || function(obj) {\n    return toString.call(obj) === '[object Array]';\n  };\n\n  // Is a given variable an object?\n  _.isObject = function(obj) {\n    var type = typeof obj;\n    return type === 'function' || type === 'object' && !!obj;\n  };\n\n  // Add some isType methods: isArguments, isFunction, isString, isNumber, isDate, isRegExp, isError.\n  _.each(['Arguments', 'Function', 'String', 'Number', 'Date', 'RegExp', 'Error'], function(name) {\n    _['is' + name] = function(obj) {\n      return toString.call(obj) === '[object ' + name + ']';\n    };\n  });\n\n  // Define a fallback version of the method in browsers (ahem, IE < 9), where\n  // there isn't any inspectable \"Arguments\" type.\n  if (!_.isArguments(arguments)) {\n    _.isArguments = function(obj) {\n      return _.has(obj, 'callee');\n    };\n  }\n\n  // Optimize `isFunction` if appropriate. Work around some typeof bugs in old v8,\n  // IE 11 (#1621), and in Safari 8 (#1929).\n  if (typeof /./ != 'function' && typeof Int8Array != 'object') {\n    _.isFunction = function(obj) {\n      return typeof obj == 'function' || false;\n    };\n  }\n\n  // Is a given object a finite number?\n  _.isFinite = function(obj) {\n    return isFinite(obj) && !isNaN(parseFloat(obj));\n  };\n\n  // Is the given value `NaN`? (NaN is the only number which does not equal itself).\n  _.isNaN = function(obj) {\n    return _.isNumber(obj) && obj !== +obj;\n  };\n\n  // Is a given value a boolean?\n  _.isBoolean = function(obj) {\n    return obj === true || obj === false || toString.call(obj) === '[object Boolean]';\n  };\n\n  // Is a given value equal to null?\n  _.isNull = function(obj) {\n    return obj === null;\n  };\n\n  // Is a given variable undefined?\n  _.isUndefined = function(obj) {\n    return obj === void 0;\n  };\n\n  // Shortcut function for checking if an object has a given property directly\n  // on itself (in other words, not on a prototype).\n  _.has = function(obj, key) {\n    return obj != null && hasOwnProperty.call(obj, key);\n  };\n\n  // Utility Functions\n  // -----------------\n\n  // Run Underscore.js in *noConflict* mode, returning the `_` variable to its\n  // previous owner. Returns a reference to the Underscore object.\n  _.noConflict = function() {\n    root._ = previousUnderscore;\n    return this;\n  };\n\n  // Keep the identity function around for default iteratees.\n  _.identity = function(value) {\n    return value;\n  };\n\n  // Predicate-generating functions. Often useful outside of Underscore.\n  _.constant = function(value) {\n    return function() {\n      return value;\n    };\n  };\n\n  _.noop = function(){};\n\n  _.property = property;\n\n  // Generates a function for a given object that returns a given property.\n  _.propertyOf = function(obj) {\n    return obj == null ? function(){} : function(key) {\n      return obj[key];\n    };\n  };\n\n  // Returns a predicate for checking whether an object has a given set of\n  // `key:value` pairs.\n  _.matcher = _.matches = function(attrs) {\n    attrs = _.extendOwn({}, attrs);\n    return function(obj) {\n      return _.isMatch(obj, attrs);\n    };\n  };\n\n  // Run a function **n** times.\n  _.times = function(n, iteratee, context) {\n    var accum = Array(Math.max(0, n));\n    iteratee = optimizeCb(iteratee, context, 1);\n    for (var i = 0; i < n; i++) accum[i] = iteratee(i);\n    return accum;\n  };\n\n  // Return a random integer between min and max (inclusive).\n  _.random = function(min, max) {\n    if (max == null) {\n      max = min;\n      min = 0;\n    }\n    return min + Math.floor(Math.random() * (max - min + 1));\n  };\n\n  // A (possibly faster) way to get the current timestamp as an integer.\n  _.now = Date.now || function() {\n    return new Date().getTime();\n  };\n\n   // List of HTML entities for escaping.\n  var escapeMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#x27;',\n    '`': '&#x60;'\n  };\n  var unescapeMap = _.invert(escapeMap);\n\n  // Functions for escaping and unescaping strings to/from HTML interpolation.\n  var createEscaper = function(map) {\n    var escaper = function(match) {\n      return map[match];\n    };\n    // Regexes for identifying a key that needs to be escaped\n    var source = '(?:' + _.keys(map).join('|') + ')';\n    var testRegexp = RegExp(source);\n    var replaceRegexp = RegExp(source, 'g');\n    return function(string) {\n      string = string == null ? '' : '' + string;\n      return testRegexp.test(string) ? string.replace(replaceRegexp, escaper) : string;\n    };\n  };\n  _.escape = createEscaper(escapeMap);\n  _.unescape = createEscaper(unescapeMap);\n\n  // If the value of the named `property` is a function then invoke it with the\n  // `object` as context; otherwise, return it.\n  _.result = function(object, property, fallback) {\n    var value = object == null ? void 0 : object[property];\n    if (value === void 0) {\n      value = fallback;\n    }\n    return _.isFunction(value) ? value.call(object) : value;\n  };\n\n  // Generate a unique integer id (unique within the entire client session).\n  // Useful for temporary DOM ids.\n  var idCounter = 0;\n  _.uniqueId = function(prefix) {\n    var id = ++idCounter + '';\n    return prefix ? prefix + id : id;\n  };\n\n  // By default, Underscore uses ERB-style template delimiters, change the\n  // following template settings to use alternative delimiters.\n  _.templateSettings = {\n    evaluate    : /<%([\\s\\S]+?)%>/g,\n    interpolate : /<%=([\\s\\S]+?)%>/g,\n    escape      : /<%-([\\s\\S]+?)%>/g\n  };\n\n  // When customizing `templateSettings`, if you don't want to define an\n  // interpolation, evaluation or escaping regex, we need one that is\n  // guaranteed not to match.\n  var noMatch = /(.)^/;\n\n  // Certain characters need to be escaped so that they can be put into a\n  // string literal.\n  var escapes = {\n    \"'\":      \"'\",\n    '\\\\':     '\\\\',\n    '\\r':     'r',\n    '\\n':     'n',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  var escaper = /\\\\|'|\\r|\\n|\\u2028|\\u2029/g;\n\n  var escapeChar = function(match) {\n    return '\\\\' + escapes[match];\n  };\n\n  // JavaScript micro-templating, similar to John Resig's implementation.\n  // Underscore templating handles arbitrary delimiters, preserves whitespace,\n  // and correctly escapes quotes within interpolated code.\n  // NB: `oldSettings` only exists for backwards compatibility.\n  _.template = function(text, settings, oldSettings) {\n    if (!settings && oldSettings) settings = oldSettings;\n    settings = _.defaults({}, settings, _.templateSettings);\n\n    // Combine delimiters into one regular expression via alternation.\n    var matcher = RegExp([\n      (settings.escape || noMatch).source,\n      (settings.interpolate || noMatch).source,\n      (settings.evaluate || noMatch).source\n    ].join('|') + '|$', 'g');\n\n    // Compile the template source, escaping string literals appropriately.\n    var index = 0;\n    var source = \"__p+='\";\n    text.replace(matcher, function(match, escape, interpolate, evaluate, offset) {\n      source += text.slice(index, offset).replace(escaper, escapeChar);\n      index = offset + match.length;\n\n      if (escape) {\n        source += \"'+\\n((__t=(\" + escape + \"))==null?'':_.escape(__t))+\\n'\";\n      } else if (interpolate) {\n        source += \"'+\\n((__t=(\" + interpolate + \"))==null?'':__t)+\\n'\";\n      } else if (evaluate) {\n        source += \"';\\n\" + evaluate + \"\\n__p+='\";\n      }\n\n      // Adobe VMs need the match returned to produce the correct offest.\n      return match;\n    });\n    source += \"';\\n\";\n\n    // If a variable is not specified, place data values in local scope.\n    if (!settings.variable) source = 'with(obj||{}){\\n' + source + '}\\n';\n\n    source = \"var __t,__p='',__j=Array.prototype.join,\" +\n      \"print=function(){__p+=__j.call(arguments,'');};\\n\" +\n      source + 'return __p;\\n';\n\n    try {\n      var render = new Function(settings.variable || 'obj', '_', source);\n    } catch (e) {\n      e.source = source;\n      throw e;\n    }\n\n    var template = function(data) {\n      return render.call(this, data, _);\n    };\n\n    // Provide the compiled source as a convenience for precompilation.\n    var argument = settings.variable || 'obj';\n    template.source = 'function(' + argument + '){\\n' + source + '}';\n\n    return template;\n  };\n\n  // Add a \"chain\" function. Start chaining a wrapped Underscore object.\n  _.chain = function(obj) {\n    var instance = _(obj);\n    instance._chain = true;\n    return instance;\n  };\n\n  // OOP\n  // ---------------\n  // If Underscore is called as a function, it returns a wrapped object that\n  // can be used OO-style. This wrapper holds altered versions of all the\n  // underscore functions. Wrapped objects may be chained.\n\n  // Helper function to continue chaining intermediate results.\n  var result = function(instance, obj) {\n    return instance._chain ? _(obj).chain() : obj;\n  };\n\n  // Add your own custom functions to the Underscore object.\n  _.mixin = function(obj) {\n    _.each(_.functions(obj), function(name) {\n      var func = _[name] = obj[name];\n      _.prototype[name] = function() {\n        var args = [this._wrapped];\n        push.apply(args, arguments);\n        return result(this, func.apply(_, args));\n      };\n    });\n  };\n\n  // Add all of the Underscore functions to the wrapper object.\n  _.mixin(_);\n\n  // Add all mutator Array functions to the wrapper.\n  _.each(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      var obj = this._wrapped;\n      method.apply(obj, arguments);\n      if ((name === 'shift' || name === 'splice') && obj.length === 0) delete obj[0];\n      return result(this, obj);\n    };\n  });\n\n  // Add all accessor Array functions to the wrapper.\n  _.each(['concat', 'join', 'slice'], function(name) {\n    var method = ArrayProto[name];\n    _.prototype[name] = function() {\n      return result(this, method.apply(this._wrapped, arguments));\n    };\n  });\n\n  // Extracts the result from a wrapped and chained object.\n  _.prototype.value = function() {\n    return this._wrapped;\n  };\n\n  // Provide unwrapping proxy for some methods used in engine operations\n  // such as arithmetic and JSON stringification.\n  _.prototype.valueOf = _.prototype.toJSON = _.prototype.value;\n\n  _.prototype.toString = function() {\n    return '' + this._wrapped;\n  };\n\n  // AMD registration happens at the end for compatibility with AMD loaders\n  // that may not enforce next-turn semantics on modules. Even though general\n  // practice for AMD registration is to be anonymous, underscore registers\n  // as a named module because, like jQuery, it is a base library that is\n  // popular enough to be bundled in a third party lib, but not be part of\n  // an AMD load request. Those cases could generate an error when an\n  // anonymous define() is called outside of a loader request.\n  if (typeof define === 'function' && define.amd) {\n    define('underscore', [], function() {\n      return _;\n    });\n  }\n}.call(this));\n",
    "/* Web Font Loader v1.6.28 - (c) Adobe Systems, Google. License: Apache 2.0 */(function(){function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?aa:ba;return p.apply(null,arguments)}var q=Date.now||function(){return+new Date};function ca(a,b){this.a=a;this.o=b||a;this.c=this.o.document}var da=!!window.FontFace;function t(a,b,c,d){b=a.c.createElement(b);if(c)for(var e in c)c.hasOwnProperty(e)&&(\"style\"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));d&&b.appendChild(a.c.createTextNode(d));return b}function u(a,b,c){a=a.c.getElementsByTagName(b)[0];a||(a=document.documentElement);a.insertBefore(c,a.lastChild)}function v(a){a.parentNode&&a.parentNode.removeChild(a)}\nfunction w(a,b,c){b=b||[];c=c||[];for(var d=a.className.split(/\\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}b=[];for(e=0;e<d.length;e+=1){f=!1;for(g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(\" \").replace(/\\s+/g,\" \").replace(/^\\s+|\\s+$/,\"\")}function y(a,b){for(var c=a.className.split(/\\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}\nfunction ea(a){return a.o.location.hostname||a.a.location.hostname}function z(a,b,c){function d(){m&&e&&f&&(m(g),m=null)}b=t(a,\"link\",{rel:\"stylesheet\",href:b,media:\"all\"});var e=!1,f=!0,g=null,m=c||null;da?(b.onload=function(){e=!0;d()},b.onerror=function(){e=!0;g=Error(\"Stylesheet failed to load\");d()}):setTimeout(function(){e=!0;d()},0);u(a,\"head\",b)}\nfunction A(a,b,c,d){var e=a.c.getElementsByTagName(\"head\")[0];if(e){var f=t(a,\"script\",{src:b}),g=!1;f.onload=f.onreadystatechange=function(){g||this.readyState&&\"loaded\"!=this.readyState&&\"complete\"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,\"HEAD\"==f.parentNode.tagName&&e.removeChild(f))};e.appendChild(f);setTimeout(function(){g||(g=!0,c&&c(Error(\"Script load timeout\")))},d||5E3);return f}return null};function B(){this.a=0;this.c=null}function C(a){a.a++;return function(){a.a--;D(a)}}function E(a,b){a.c=b;D(a)}function D(a){0==a.a&&a.c&&(a.c(),a.c=null)};function F(a){this.a=a||\"-\"}F.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\\W_]+/g,\"\").toLowerCase());return b.join(this.a)};function G(a,b){this.c=a;this.f=4;this.a=\"n\";var c=(b||\"n4\").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function fa(a){return H(a)+\" \"+(a.f+\"00\")+\" 300px \"+I(a.c)}function I(a){var b=[];a=a.split(/,\\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['\"]/g,\"\");-1!=d.indexOf(\" \")||/^\\d/.test(d)?b.push(\"'\"+d+\"'\"):b.push(d)}return b.join(\",\")}function J(a){return a.a+a.f}function H(a){var b=\"normal\";\"o\"===a.a?b=\"oblique\":\"i\"===a.a&&(b=\"italic\");return b}\nfunction ga(a){var b=4,c=\"n\",d=null;a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10))));return c+b};function ha(a,b){this.c=a;this.f=a.o.document.documentElement;this.h=b;this.a=new F(\"-\");this.j=!1!==b.events;this.g=!1!==b.classes}function ia(a){a.g&&w(a.f,[a.a.c(\"wf\",\"loading\")]);K(a,\"loading\")}function L(a){if(a.g){var b=y(a.f,a.a.c(\"wf\",\"active\")),c=[],d=[a.a.c(\"wf\",\"loading\")];b||c.push(a.a.c(\"wf\",\"inactive\"));w(a.f,c,d)}K(a,\"inactive\")}function K(a,b,c){if(a.j&&a.h[b])if(c)a.h[b](c.c,J(c));else a.h[b]()};function ja(){this.c={}}function ka(a,b,c){var d=[],e;for(e in b)if(b.hasOwnProperty(e)){var f=a.c[e];f&&d.push(f(b[e],c))}return d};function M(a,b){this.c=a;this.f=b;this.a=t(this.c,\"span\",{\"aria-hidden\":\"true\"},this.f)}function N(a){u(a.c,\"body\",a.a)}function O(a){return\"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:\"+I(a.c)+\";\"+(\"font-style:\"+H(a)+\";font-weight:\"+(a.f+\"00\")+\";\")};function P(a,b,c,d,e,f){this.g=a;this.j=b;this.a=d;this.c=c;this.f=e||3E3;this.h=f||void 0}P.prototype.start=function(){var a=this.c.o.document,b=this,c=q(),d=new Promise(function(d,e){function f(){q()-c>=b.f?e():a.fonts.load(fa(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(f,25)},function(){e()})}f()}),e=null,f=new Promise(function(a,d){e=setTimeout(d,b.f)});Promise.race([f,d]).then(function(){e&&(clearTimeout(e),e=null);b.g(b.a)},function(){b.j(b.a)})};function Q(a,b,c,d,e,f,g){this.v=a;this.B=b;this.c=c;this.a=d;this.s=g||\"BESbswy\";this.f={};this.w=e||3E3;this.u=f||null;this.m=this.j=this.h=this.g=null;this.g=new M(this.c,this.s);this.h=new M(this.c,this.s);this.j=new M(this.c,this.s);this.m=new M(this.c,this.s);a=new G(this.a.c+\",serif\",J(this.a));a=O(a);this.g.a.style.cssText=a;a=new G(this.a.c+\",sans-serif\",J(this.a));a=O(a);this.h.a.style.cssText=a;a=new G(\"serif\",J(this.a));a=O(a);this.j.a.style.cssText=a;a=new G(\"sans-serif\",J(this.a));a=\nO(a);this.m.a.style.cssText=a;N(this.g);N(this.h);N(this.j);N(this.m)}var R={D:\"serif\",C:\"sans-serif\"},S=null;function T(){if(null===S){var a=/AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))/.exec(window.navigator.userAgent);S=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return S}Q.prototype.start=function(){this.f.serif=this.j.a.offsetWidth;this.f[\"sans-serif\"]=this.m.a.offsetWidth;this.A=q();U(this)};\nfunction la(a,b,c){for(var d in R)if(R.hasOwnProperty(d)&&b===a.f[R[d]]&&c===a.f[R[d]])return!0;return!1}function U(a){var b=a.g.a.offsetWidth,c=a.h.a.offsetWidth,d;(d=b===a.f.serif&&c===a.f[\"sans-serif\"])||(d=T()&&la(a,b,c));d?q()-a.A>=a.w?T()&&la(a,b,c)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?V(a,a.v):V(a,a.B):ma(a):V(a,a.v)}function ma(a){setTimeout(p(function(){U(this)},a),50)}function V(a,b){setTimeout(p(function(){v(this.g.a);v(this.h.a);v(this.j.a);v(this.m.a);b(this.a)},a),0)};function W(a,b,c){this.c=a;this.a=b;this.f=0;this.m=this.j=!1;this.s=c}var X=null;W.prototype.g=function(a){var b=this.a;b.g&&w(b.f,[b.a.c(\"wf\",a.c,J(a).toString(),\"active\")],[b.a.c(\"wf\",a.c,J(a).toString(),\"loading\"),b.a.c(\"wf\",a.c,J(a).toString(),\"inactive\")]);K(b,\"fontactive\",a);this.m=!0;na(this)};\nW.prototype.h=function(a){var b=this.a;if(b.g){var c=y(b.f,b.a.c(\"wf\",a.c,J(a).toString(),\"active\")),d=[],e=[b.a.c(\"wf\",a.c,J(a).toString(),\"loading\")];c||d.push(b.a.c(\"wf\",a.c,J(a).toString(),\"inactive\"));w(b.f,d,e)}K(b,\"fontinactive\",a);na(this)};function na(a){0==--a.f&&a.j&&(a.m?(a=a.a,a.g&&w(a.f,[a.a.c(\"wf\",\"active\")],[a.a.c(\"wf\",\"loading\"),a.a.c(\"wf\",\"inactive\")]),K(a,\"active\")):L(a.a))};function oa(a){this.j=a;this.a=new ja;this.h=0;this.f=this.g=!0}oa.prototype.load=function(a){this.c=new ca(this.j,a.context||this.j);this.g=!1!==a.events;this.f=!1!==a.classes;pa(this,new ha(this.c,a),a)};\nfunction qa(a,b,c,d,e){var f=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=e||null,m=d||null||{};if(0===c.length&&f)L(b.a);else{b.f+=c.length;f&&(b.j=f);var h,l=[];for(h=0;h<c.length;h++){var k=c[h],n=m[k.c],r=b.a,x=k;r.g&&w(r.f,[r.a.c(\"wf\",x.c,J(x).toString(),\"loading\")]);K(r,\"fontloading\",x);r=null;if(null===X)if(window.FontFace){var x=/Gecko.*Firefox\\/(\\d+)/.exec(window.navigator.userAgent),xa=/OS X.*Version\\/10\\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);\nX=x?42<parseInt(x[1],10):xa?!1:!0}else X=!1;X?r=new P(p(b.g,b),p(b.h,b),b.c,k,b.s,n):r=new Q(p(b.g,b),p(b.h,b),b.c,k,b.s,a,n);l.push(r)}for(h=0;h<l.length;h++)l[h].start()}},0)}function pa(a,b,c){var d=[],e=c.timeout;ia(b);var d=ka(a.a,c,a.c),f=new W(a.c,b,e);a.h=d.length;b=0;for(c=d.length;b<c;b++)d[b].load(function(b,d,c){qa(a,f,b,d,c)})};function ra(a,b){this.c=a;this.a=b}\nra.prototype.load=function(a){function b(){if(f[\"__mti_fntLst\"+d]){var c=f[\"__mti_fntLst\"+d](),e=[],h;if(c)for(var l=0;l<c.length;l++){var k=c[l].fontfamily;void 0!=c[l].fontStyle&&void 0!=c[l].fontWeight?(h=c[l].fontStyle+c[l].fontWeight,e.push(new G(k,h))):e.push(new G(k))}a(e)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.o;A(this.c,(c.a.api||\"https://fast.fonts.net/jsapi\")+\"/\"+d+\".js\"+(e?\"?v=\"+e:\"\"),function(e){e?a([]):(f[\"__MonotypeConfiguration__\"+\nd]=function(){return c.a},b())}).id=\"__MonotypeAPIScript__\"+d}else a([])};function sa(a,b){this.c=a;this.a=b}sa.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new B;b=0;for(c=d.length;b<c;b++)z(this.c,d[b],C(g));var m=[];b=0;for(c=e.length;b<c;b++)if(d=e[b].split(\":\"),d[1])for(var h=d[1].split(\",\"),l=0;l<h.length;l+=1)m.push(new G(d[0],h[l]));else m.push(new G(d[0]));E(g,function(){a(m,f)})};function ta(a,b){a?this.c=a:this.c=ua;this.a=[];this.f=[];this.g=b||\"\"}var ua=\"https://fonts.googleapis.com/css\";function va(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(\":\");3==e.length&&a.f.push(e.pop());var f=\"\";2==e.length&&\"\"!=e[1]&&(f=\":\");a.a.push(e.join(f))}}\nfunction wa(a){if(0==a.a.length)throw Error(\"No fonts to load!\");if(-1!=a.c.indexOf(\"kit=\"))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,\"+\"));b=a.c+\"?family=\"+c.join(\"%7C\");0<a.f.length&&(b+=\"&subset=\"+a.f.join(\",\"));0<a.g.length&&(b+=\"&text=\"+encodeURIComponent(a.g));return b};function ya(a){this.f=a;this.a=[];this.c={}}\nvar za={latin:\"BESbswy\",\"latin-ext\":\"\\u00e7\\u00f6\\u00fc\\u011f\\u015f\",cyrillic:\"\\u0439\\u044f\\u0416\",greek:\"\\u03b1\\u03b2\\u03a3\",khmer:\"\\u1780\\u1781\\u1782\",Hanuman:\"\\u1780\\u1781\\u1782\"},Aa={thin:\"1\",extralight:\"2\",\"extra-light\":\"2\",ultralight:\"2\",\"ultra-light\":\"2\",light:\"3\",regular:\"4\",book:\"4\",medium:\"5\",\"semi-bold\":\"6\",semibold:\"6\",\"demi-bold\":\"6\",demibold:\"6\",bold:\"7\",\"extra-bold\":\"8\",extrabold:\"8\",\"ultra-bold\":\"8\",ultrabold:\"8\",black:\"9\",heavy:\"9\",l:\"3\",r:\"4\",b:\"7\"},Ba={i:\"i\",italic:\"i\",n:\"n\",normal:\"n\"},\nCa=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;\nfunction Da(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(\":\"),e=d[0].replace(/\\+/g,\" \"),f=[\"n4\"];if(2<=d.length){var g;var m=d[1];g=[];if(m)for(var m=m.split(\",\"),h=m.length,l=0;l<h;l++){var k;k=m[l];if(k.match(/^[\\w-]+$/)){var n=Ca.exec(k.toLowerCase());if(null==n)k=\"\";else{k=n[2];k=null==k||\"\"==k?\"n\":Ba[k];n=n[1];if(null==n||\"\"==n)n=\"4\";else var r=Aa[n],n=r?r:isNaN(n)?\"4\":n.substr(0,1);k=[k,n].join(\"\")}}else k=\"\";k&&g.push(k)}0<g.length&&(f=g);3==d.length&&(d=d[2],g=[],d=d?d.split(\",\"):\ng,0<d.length&&(d=za[d[0]])&&(a.c[e]=d))}a.c[e]||(d=za[e])&&(a.c[e]=d);for(d=0;d<f.length;d+=1)a.a.push(new G(e,f[d]))}};function Ea(a,b){this.c=a;this.a=b}var Fa={Arimo:!0,Cousine:!0,Tinos:!0};Ea.prototype.load=function(a){var b=new B,c=this.c,d=new ta(this.a.api,this.a.text),e=this.a.families;va(d,e);var f=new ya(e);Da(f);z(c,wa(d),C(b));E(b,function(){a(f.a,f.c,Fa)})};function Ga(a,b){this.c=a;this.a=b}Ga.prototype.load=function(a){var b=this.a.id,c=this.c.o;b?A(this.c,(this.a.api||\"https://use.typekit.net\")+\"/\"+b+\".js\",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var e=[],f=0;f<b.length;f+=2)for(var g=b[f],m=b[f+1],h=0;h<m.length;h++)e.push(new G(g,m[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(l){}a(e)}},2E3):a([])};function Ha(a,b){this.c=a;this.f=b;this.a=[]}Ha.prototype.load=function(a){var b=this.f.id,c=this.c.o,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var g=0,m=c.fonts.length;g<m;++g){var h=c.fonts[g];d.a.push(new G(h.name,ga(\"font-weight:\"+h.weight+\";font-style:\"+h.style)))}a(d.a)},A(this.c,(this.f.api||\"https://f.fontdeck.com/s/css/js/\")+ea(this.c)+\"/\"+b+\".js\",function(b){b&&a([])})):a([])};var Y=new oa(window);Y.a.c.custom=function(a,b){return new sa(b,a)};Y.a.c.fontdeck=function(a,b){return new Ha(b,a)};Y.a.c.monotype=function(a,b){return new ra(b,a)};Y.a.c.typekit=function(a,b){return new Ga(b,a)};Y.a.c.google=function(a,b){return new Ea(b,a)};var Z={load:p(Y.load,Y)};\"function\"===typeof define&&define.amd?define(function(){return Z}):\"undefined\"!==typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig));}());\n",
    "/**\n/* @module app/App\n/*/\n\"use strict\";\n\nconsole.info(\"Portfolio App started\");\n\n// if (!DEBUG) {\n// \twindow.addEventListener(\"error\", function(ev) {\n// \t\tconsole.error(\"Uncaught Error\", ev);\n// \t});\n// }\n\n// function applyPolyfills() {\n// require(\"Modernizr\");\n// require(\"setimmediate\");\n// require(\"es6-promise/auto\");\n// require(\"classlist-polyfill\");\n// require(\"raf-polyfill\");\n// require(\"matches-polyfill\");\n// require(\"fullscreen-polyfill\");\n// require(\"math-sign-polyfill\");\n// require(\"path2d-polyfill\");\n// if (!window.Modernizr.mutationobserver) {\n// \trequire(\"mutation-observer\");\n// }\n\n// function applyRequires() {\nrequire(\"backbone\").$ = require(\"backbone.native\");\nrequire(\"backbone.babysitter\");\nrequire(\"Backbone.Mutators\");\nrequire(\"hammerjs\");\n// }\n\n// document.addEventListener('DOMContentLoaded', function(ev) {\n// \tconsole.log(\"%s:[event %s]\", ev.target, ev.type);\n// });\n\nwindow.addEventListener(\"load\", function(ev) {\n\tconsole.log(\"%s:[event %s]\", ev.target, ev.type);\n\n\t// process bootstrap data, let errors go up the stack\n\ttry {\n\t\trequire(\"app/model/helper/bootstrap\")(window.bootstrap);\n\t} catch (err) {\n\t\tvar el = document.querySelector(\".app\");\n\t\tel.classList.remove(\"app-initial\");\n\t\tel.classList.add(\"app-error\");\n\t\tthrow new Error(\"bootstrap data error (\" + err.message + \")\", err.fileName, err.lineNumber);\n\t} finally { // detele global var\n\t\tdelete window.bootstrap;\n\t}\n\n\trequire(\"app/view/template/_helpers\");\n\n\t/** @type {module:app/view/helper/createColorStyleSheet} */\n\trequire(\"app/view/helper/createColorStyleSheet\").call(); /** @type {module:app/view/AppView} */\n\tvar AppView = require(\"app/view/AppView\");\n\tvar startApp = AppView.getInstance.bind(AppView);\n\n\t/** @type {module:webfontloader} */\n\tvar WebFont = require(\"webfontloader\");\n\tvar loadOpts = {\n\t\tasync: true,\n\t\tgroupName: \"\",\n\t\tclasses: false,\n\t\tactive: function() {\n\t\t\tconsole.info(\"WebFont:%s:active\", this.groupName);\n\t\t\t// AppView.getInstance();\n\t\t},\n\t\tfontactive: function(familyName, variantFvd) {\n\t\t\tconsole.info(\"WebFont:%s:fontactive '%s' (%s)\", this.groupName, familyName, variantFvd);\n\t\t},\n\t\tinactive: function() {\n\t\t\tconsole.warn(\"WebFont:%s:inactive\", this.groupName);\n\t\t\t// AppView.getInstance();\n\t\t},\n\t\tfontinactive: function(familyName, variantFvd) {\n\t\t\tconsole.warn(\"WebFont:%s:fontinactive '%s' (%s)\", this.groupName, familyName, variantFvd);\n\t\t},\n\t\tloading: function() {\n\t\t\tconsole.log(\"WebFont:%s:loading\", this.groupName);\n\t\t},\n\t\t// fontloading: function(familyName, variantDesc) {\n\t\t// \tconsole.log(\"WebFont::fontloading\", familyName, JSON.stringify(variantDesc, null, \" \"));\n\t\t// },\n\t};\n\n\tWebFont.load(_.defaults({\n\t\tasync: false,\n\t\tgroupName: \"required\",\n\t\tcustom: {\n\t\t\tfamilies: [\n\t\t\t\t\"Franklin Gothic FS:n4,n7\",\n\t\t\t\t// \t\t\"Franklin Gothic FS:i4,i7\"\n\t\t\t\t\"FolioFigures:n4\",\n\t\t\t],\n\t\t\ttestStrings: {\n\t\t\t\t\"FolioFigures\": \"hms\"\n\t\t\t},\n\t\t},\n\t\tactive: startApp,\n\t\tinactive: startApp\n\t}, loadOpts));\n\n\tWebFont.load(_.defaults({}, loadOpts));\n\n\t// requestAnimationFrame(function(tstamp) {\n\t// \tAppView.getInstance();\n\t// });\n});\n\n\nif (DEBUG) {\n\t// /** @type {module:underscore} */\n\t// var _ = require(\"underscore\");\n\n\t// var isFF = /Firefox/.test(window.navigator.userAgent);\n\t// var isIOS = /iPad|iPhone/.test(window.navigator.userAgent);\n\t/*\n\tif (/Firefox/.test(window.navigator.userAgent)) {\n\t\tconsole.prefix = \"# \";\n\t\tvar shift = [].shift;\n\t\tvar logWrapFn = function() {\n\t\t\tif (typeof arguments[1] == \"string\") arguments[1] = console.prefix + arguments[1];\n\t\t\treturn shift.apply(arguments).apply(console, arguments);\n\t\t};\n\t\tconsole.group = _.wrap(console.group, logWrapFn);\n\t\tconsole.log = _.wrap(console.log, logWrapFn);\n\t\tconsole.info = _.wrap(console.info, logWrapFn);\n\t\tconsole.warn = _.wrap(console.warn, logWrapFn);\n\t\tconsole.error = _.wrap(console.error, logWrapFn);\n\t}\n\t*/\n\t/*\n\tvar saveLogs = function() {\n\t\tvar logWrapFn = function(name, fn, msg) {\n\t\t\tdocument.documentElement.appendChild(\n\t\t\t\tdocument.createComment(\"[\" + name + \"] \" + msg));\n\t\t};\n\t\tconsole.group = _.wrap(console.group, _.partial(logWrapFn, \"group\"));\n\t\tconsole.log = _.wrap(console.log, _.partial(logWrapFn, \"log\"));\n\t\tconsole.info = _.wrap(console.info, _.partial(logWrapFn, \"info\"));\n\t\tconsole.warn = _.wrap(console.warn, _.partial(logWrapFn, \"warn\"));\n\t\tconsole.error = _.wrap(console.error, _.partial(logWrapFn, \"error\"));\n\t};\n\t*/\n\n\t// handle error events on some platforms and production\n\t/*\n\tif (isIOS) {\n\t\t// saveLogs();\n\t\twindow.addEventListener(\"error\", function() {\n\t\t\tvar args = Array.prototype.slice.apply(arguments),\n\t\t\t\tel = document.createElement(\"div\"),\n\t\t\t\thtml = \"\";\n\t\t\t_.extend(el.style, {\n\t\t\t\tfontfamily: \"monospace\",\n\t\t\t\tdisplay: \"block\",\n\t\t\t\tposition: \"absolute\",\n\t\t\t\tzIndex: \"999\",\n\t\t\t\tbackgroundColor: \"white\",\n\t\t\t\tcolor: \"black\",\n\t\t\t\twidth: \"calc(100% - 3em)\",\n\t\t\t\tbottom: \"0\",\n\t\t\t\tmargin: \"1em 1.5em\",\n\t\t\t\tpadding: \"1em 1.5em\",\n\t\t\t\toutline: \"0.5em solid red\",\n\t\t\t\toutlineOffset: \"0.5em\",\n\t\t\t\tboxSizing: \"border-box\",\n\t\t\t\toverflow: \"hidden\",\n\t\t\t});\n\t\t\thtml += \"<pre><b>location:<b> \" + window.location + \"</pre>\";\n\t\t\thtml += \"<pre><b>event:<b> \" + JSON.stringify(args.shift(), null, \" \") + \"</pre>\";\n\t\t\tif (args.length) html += \"<pre><b>rest:<b> \" + JSON.stringify(args, null, \" \") + \"</pre>\";\n\t\t\tel.innerHTML = html;\n\t\t\tdocument.body.appendChild(el);\n\t\t});\n\t}*/\n}\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    return \"<svg class=\\\"cog-symbol icon\\\" viewBox=\\\"-100 -100 200 200\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" preserveAspectRatio=\\\"xMidYMid meet\\\">\\n\t<path d=\\\"M11.754,-99.307c-7.809,-0.924 -15.699,-0.924 -23.508,0l-3.73,20.82c-6.254,1.234 -12.338,3.21 -18.123,5.888l-15.255,-14.651c-6.861,3.842 -13.244,8.48 -19.018,13.818l9.22,19.036c-4.335,4.674 -8.095,9.849 -11.201,15.416l-20.953,-2.886c-3.292,7.141 -5.731,14.645 -7.265,22.357l18.648,9.981c-0.759,6.329 -0.759,12.727 0,19.056l-18.648,9.981c1.534,7.712 3.973,15.216 7.265,22.357l20.953,-2.886c3.106,5.567 6.866,10.742 11.201,15.416l-9.22,19.036c5.774,5.338 12.157,9.976 19.018,13.818l15.255,-14.651c5.785,2.678 11.869,4.654 18.123,5.888l3.73,20.82c7.809,0.924 15.699,0.924 23.508,0l3.73,-20.82c6.254,-1.234 12.338,-3.21 18.123,-5.888l15.255,14.651c6.861,-3.842 13.244,-8.48 19.018,-13.818l-9.22,-19.036c4.335,-4.674 8.095,-9.849 11.201,-15.416l20.953,2.886c3.292,-7.141 5.731,-14.645 7.265,-22.357l-18.648,-9.981c0.759,-6.329 0.759,-12.727 0,-19.056l18.648,-9.981c-1.534,-7.712 -3.973,-15.216 -7.265,-22.357l-20.953,2.886c-3.106,-5.567 -6.866,-10.742 -11.201,-15.416l9.22,-19.036c-5.774,-5.338 -12.157,-9.976 -19.018,-13.818l-15.255,14.651c-5.785,-2.678 -11.869,-4.654 -18.123,-5.888l-3.73,-20.82ZM0,-33c18.213,0 33,14.787 33,33c0,18.213 -14.787,33 -33,33c-18.213,0 -33,-14.787 -33,-33c0,-18.213 14.787,-33 33,-33Z\\\" style=\\\"fill:currentColor;fill-rule:evenodd;\\\"/>\\n</svg>\\n\";\n},\"useData\":true});\n",
    "/**\n * @module app/control/Controller\n */\n\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n\n// /** @type {module:app/model/collection/TypeCollection} */\n// var types = require(\"app/model/collection/TypeCollection\");\n// /** @type {module:app/model/collection/KeywordCollection} */\n// var keywords = require(\"app/model/collection/KeywordCollection\");\n/** @type {module:app/model/collection/ArticleCollection} */\nvar articles = require(\"app/model/collection/ArticleCollection\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundles = require(\"app/model/collection/BundleCollection\");\n\n/* --------------------------- *\n/* Static private\n/* --------------------------- */\n\n/**\n/* @constructor\n/* @type {module:app/control/Controller}\n/*/\nvar Controller = Backbone.Router.extend({\n\n\t// /** @override */\n\t// routes: {},\n\n\t/** @override */\n\tinitialize: function(options) {\n\n\t\tif (DEBUG) {\n\t\t\tthis._routeNames = [];\n\t\t\tthis.route = function(route, name, callback) {\n\t\t\t\tthis._routeNames.push(_.isString(name) ? name : '');\n\t\t\t\treturn Backbone.Router.prototype.route.apply(this, arguments);\n\t\t\t};\n\t\t\tthis.on(\"route\", function(routeName, args) {\n\t\t\t\tconsole.log(\"controller:[route] %s [%s]\", routeName, args.join());\n\t\t\t});\n\t\t}\n\n\t\t/*\n\t\t * Prefixed article regexp: /^article(?:\\/([^\\/]+))\\/?$/\n\t\t * Single bundle regexp: /^bundles(?:\\/([^\\/]+)(?:\\/(\\d+))?)?\\/?$/\n\t\t */\n\t\tthis.route(/(.*)/,\n\t\t\t\"notfound\", this.toNotFound);\n\t\tthis.route(/^([a-z][a-z0-9\\-]*)\\/?$/,\n\t\t\t\"article-item\", this.toArticleItem);\n\t\tthis.route(/^(?:bundles)?\\/?$/,\n\t\t\t\"root\", this.toRoot);\n\t\t// this.route(/^bundles\\/?$/,\n\t\t// \t\"bundle-list\", this.toBundleList);\n\t\tthis.route(/^bundles\\/([^\\/]+)\\/?$/,\n\t\t\t\"bundle-item\", this.toBundleItem);\n\t\tthis.route(/^bundles\\/([^\\/]+)\\/(\\d+)\\/?$/,\n\t\t\t\"media-item\", this.toMediaItem);\n\n\t\tif (DEBUG) {\n\t\t\tconsole.log(\"%s::initialize routes: %o\", \"controller\", this._routeNames);\n\t\t}\n\t},\n\n\n\n\t/* ---------------------------\n\t/* JS to URL: public command methods\n\t/* --------------------------- */\n\n\tselectMedia: function(media) {\n\t\tthis._goToLocation(media.get(\"bundle\"), media);\n\t},\n\n\tselectBundle: function(bundle) {\n\t\tthis._goToLocation(bundle);\n\t},\n\n\tdeselectMedia: function() {\n\t\tthis._goToLocation(bundles.selected);\n\t},\n\n\tdeselectBundle: function() {\n\t\tthis._goToLocation();\n\t},\n\n\tselectArticle: function(article) {\n\t\tthis.navigate(article.get(\"handle\"), { trigger: true });\n\t},\n\n\tdeselectArticle: function() {\n\t\tthis.navigate(\"\", { trigger: true });\n\t},\n\n\t/* ---------------------------\n\t/* JS to URL: private helpers\n\t/* --------------------------- */\n\n\t/** Update location when navigation happens internally */\n\t/*_updateLocation: function() {\n\t\tvar bundle, media;\n\t\tbundle = bundles.selected;\n\t\tif (bundle) {\n\t\t\tmedia = bundle.get(\"media\").selected;\n\t\t}\n\t\tthis.navigate(this._getLocation(bundle, media), {\n\t\t\ttrigger: false\n\t\t});\n\t},*/\n\n\t_getLocation: function(bundle, media) {\n\t\tvar mediaIndex, location = [];\n\t\tif (bundle) {\n\t\t\tlocation.push(\"bundles\");\n\t\t\tlocation.push(bundle.get(\"handle\"));\n\t\t\tif (media) {\n\t\t\t\tmediaIndex = bundle.get(\"media\").indexOf(media);\n\t\t\t\tif (mediaIndex >= 0) {\n\t\t\t\t\tlocation.push(mediaIndex);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// location.push(\"\");\n\t\treturn location.join(\"/\");\n\t},\n\n\t_goToLocation: function(bundle, media) {\n\t\tthis.navigate(this._getLocation(bundle, media), {\n\t\t\ttrigger: true\n\t\t});\n\t},\n\n\t/* --------------------------- *\n\t/* URL to JS: router handlers\n\t/* --------------------------- */\n\n\ttoRoot: function() {\n\t\tthis.trigger(\"change:before\");\n\t\tif (bundles.selected) {\n\t\t\t// bundles.selected.get(\"media\").deselect();\n\t\t\tbundles.deselect();\n\t\t}\n\t\t// keywords.deselect();\n\t\tarticles.deselect();\n\t\tthis.trigger(\"change:after\");\n\t},\n\n\ttoNotFound: function(slug) {\n\t\tconsole.info(\"route:[*:%s]\", slug);\n\t},\n\n\t// toBundleList: function() {\n\t// \tthis.navigate(\"\", {\n\t// \t\ttrigger: true,\n\t// \t\treplace: true\n\t// \t});\n\t// },\n\n\ttoBundleItem: function(bundleHandle) {\n\t\tvar bundle = bundles.findWhere({\n\t\t\thandle: bundleHandle\n\t\t});\n\t\tif (!bundle) {\n\t\t\tthrow new Error(\"Cannot find bundle with handle \\\"\" + bundleHandle + \"\\\"\");\n\t\t}\n\t\tthis._changeSelection(bundle);\n\t},\n\n\ttoMediaItem: function(bundleHandle, mediaIndex) {\n\t\tvar bundle, media;\n\t\t// if (bundleHandle) {\n\t\tbundle = bundles.findWhere({ handle: bundleHandle });\n\t\tif (!bundle) {\n\t\t\tthrow new Error(\"No bundle with handle \\\"\" + bundleHandle + \"\\\" found\");\n\t\t}\n\t\t// if (mediaIndex) {\n\t\tmedia = bundle.get(\"media\").at(mediaIndex);\n\t\tif (!media) {\n\t\t\tthrow new Error(\"No media at index \" + mediaIndex + \" in bundle with handle \\\"\" + bundleHandle + \"\\\" found\");\n\t\t}\n\t\t// }\n\t\t// }\n\t\tthis._changeSelection(bundle, media);\n\t},\n\n\ttoArticleItem: function(articleHandle) {\n\t\tvar article = articles.findWhere({ handle: articleHandle });\n\t\tif (!article) {\n\t\t\tthrow new Error(\"Cannot find article with handle \\\"\" + articleHandle + \"\\\"\");\n\t\t}\n\t\tthis.trigger(\"change:before\", article);\n\t\tbundles.deselect();\n\t\tarticles.select(article);\n\t\tthis.trigger(\"change:after\", article);\n\t},\n\n\t/* -------------------------------\n\t/* URL to JS: private helpers\n\t/* ------------------------------- */\n\n\t/*\n\t/* NOTE: Selection order\n\t/* - Apply media selection to *incoming bundle*, as not to trigger\n\t/*\tunneccesary events on an outgoing bundle. Outgoing bundle media selection\n\t/*\tremains untouched.\n\t/* - Apply media selection *before* selecting the incoming bundle. Views\n\t/*\tnormally listen to the selected bundle only, so if the bundle is changing,\n\t/*\tthey will not be listening to media selection changes yet.\n\t/*/\n\t_changeSelection: function(bundle, media) {\n\t\tvar lastBundle, lastMedia;\n\t\tif (bundle === void 0) bundle = null;\n\t\tif (media === void 0) media = null;\n\n\t\tlastBundle = bundles.selected;\n\t\tlastMedia = lastBundle ? lastBundle.get(\"media\").selected : null;\n\t\tconsole.log(\"controller::_changeSelection bundle:[%s -> %s] media:[%s -> %s]\",\n\t\t\t(lastBundle ? lastBundle.cid : lastBundle), (bundle ? bundle.cid : bundle),\n\t\t\t(lastMedia ? lastMedia.cid : lastMedia), (media ? media.cid : media)\n\t\t);\n\n\t\tif (!articles.selected && (lastBundle === bundle) && (lastMedia === media)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.trigger(\"change:before\", bundle, media);\n\t\tbundle && bundle.get(\"media\").select(media);\n\t\tbundles.select(bundle);\n\t\tarticles.deselect();\n\t\tthis.trigger(\"change:after\", bundle, media);\n\t},\n});\n\n\nmodule.exports = new Controller();\n",
    "/**\n * @module app/control/Globals\n */\n\nmodule.exports = (function() {\n\t// reusable vars\n\tvar o, s, so;\n\t// global hash\n\tvar g = {};\n\t// SASS <--> JS shared hash\n\tvar sass = require(\"../../../sass/variables.json\");\n\n\t// JUNK FIRST: Some app-wide defaults\n\t// - - - - - - - - - - - - - - - - -\n\tg.VPAN_DRAG = 0.95; // as factor of pointer delta\n\tg.HPAN_OUT_DRAG = 0.4; // factor\n\tg.VPAN_OUT_DRAG = 0.1; // factor\n\tg.PAN_THRESHOLD = 15; // px\n\tg.COLLAPSE_THRESHOLD = 75; // px\n\tg.COLLAPSE_OFFSET = parseInt(sass.temp[\"collapse_offset\"]);\n\t// g.CLICK_EVENT = \"click\"; //window.hasOwnProperty(\"onpointerup\") ? \"pointerup\" : \"mouseup\";\n\tg.VIDEO_CROP_PX = parseInt(sass[\"video_crop_px\"]);\n\n\t// breakpoints\n\t// - - - - - - - - - - - - - - - - -\n\tg.BREAKPOINTS = {};\n\tfor (s in sass.breakpoints) {\n\t\to = sass.breakpoints[s];\n\t\t/*if (Array.isArray(o)) {\n\t\t\tg.BREAKPOINTS[s] = Object.defineProperties({}, {\n\t\t\t\t\"matches\": {\n\t\t\t\t\tget: _.partial(_.some, o.map(window.matchMedia), _.property(\"matches\"))\n\t\t\t\t},\n\t\t\t\t\"media\": {\n\t\t\t\t\tvalue: o.join(\", \")\n\t\t\t\t},\n\t\t\t\t\"queries\": {\n\t\t\t\t\tvalue: o.map(window.matchMedia)\n\t\t\t\t},\n\t\t\t});\n\t\t} else {\n\t\t\tg.BREAKPOINTS[s] = window.matchMedia(o);\n\t\t}*/\n\t\to = Array.isArray(o) ? o.join(\", \") : o;\n\t\to = o.replace(/[\\'\\\"]/g, \"\");\n\t\to = window.matchMedia(o);\n\t\to.className = s;\n\t\tg.BREAKPOINTS[s] = o;\n\t}\n\tif (DEBUG) {\n\t\tconsole.groupCollapsed(\"Breakpoints\");\n\t\tfor (s in g.BREAKPOINTS) {\n\t\t\tconsole.log(\"%s: %o\", s, g.BREAKPOINTS[s].media);\n\t\t}\n\t\tconsole.groupEnd();\n\t}\n\n\t// base colors, dimensions\n\t// - - - - - - - - - - - - - - - - -\n\tg.DEFAULT_COLORS = _.clone(sass.default_colors);\n\t// g.HORIZONTAL_STEP = parseFloat(sass.units[\"hu_px\"]);\n\t// g.VERTICAL_STEP = parseFloat(sass.units[\"vu_px\"]);\n\n\n\t// paths, networking\n\t// - - - - - - - - - - - - - - - - -\n\t// var toAbsoluteURL = (function() {\n\t// \tvar a = null;\n\t// \treturn function(url) {\n\t// \t\ta = a || document.createElement('a');\n\t// \t\ta.href = url;\n\t// \t\treturn a.href;\n\t// \t};\n\t// })();\n\t// g.APP_ROOT = toAbsoluteURL(window.approot);\n\t// g.MEDIA_DIR = toAbsoluteURL(window.mediadir);\n\n\tg.APP_ROOT = window.approot;\n\tg.MEDIA_DIR = window.mediadir;\n\n\tdelete window.approot;\n\tdelete window.mediadir;\n\n\t// hardcoded font data\n\t// - - - - - - - - - - - - - - - - -\n\tg.FONT_METRICS = {\n\t\t\"Franklin Gothic FS\": {\n\t\t\t\"unitsPerEm\": 1000,\n\t\t\t\"ascent\": 827,\n\t\t\t\"descent\": -173\n\t\t},\n\t\t\"ITCFranklinGothicStd\": {\n\t\t\t\"unitsPerEm\": 1000,\n\t\t\t\"ascent\": 686,\n\t\t\t\"descent\": -314\n\t\t},\n\t\t\"FolioFigures\": {\n\t\t\t\"unitsPerEm\": 1024,\n\t\t\t\"ascent\": 939,\n\t\t\t\"descent\": -256\n\t\t},\n\t};\n\n\tg.PAUSE_CHAR = String.fromCharCode(0x23F8);\n\tg.PLAY_CHAR = String.fromCharCode(0x23F5);\n\tg.STOP_CHAR = String.fromCharCode(0x23F9);\n\n\t// translate common template\n\tif (sass.transform_type == \"3d\") {\n\t\tg.TRANSLATE_TEMPLATE = function(x, y) {\n\t\t\treturn \"translate3d(\" + x + \"px, \" + y + \"px, 0px)\";\n\t\t};\n\t} else {\n\t\tg.TRANSLATE_TEMPLATE = function(x, y) {\n\t\t\treturn \"translate(\" + x + \"px, \" + y + \"px)\";\n\t\t};\n\t}\n\n\tg.TRANSLATE_TEMPLATE = function(x, y) {\n\t\treturn \"translate(\" + x + \"px, \" + y + \"px)\";\n\t\t// return \"translate3d(\" + x + \"px, \" + y + \"px ,0px)\";\n\t};\n\t// timing, easing\n\t// - - - - - - - - - - - - - - - - -\n\tvar ease = g.TRANSITION_EASE = sass.transitions[\"ease\"];\n\tvar duration = g.TRANSITION_DURATION = parseFloat(sass.transitions[\"duration_ms\"]);\n\tvar delayInterval = g.TRANSITION_DELAY_INTERVAL = parseFloat(sass.transitions[\"delay_interval_ms\"]);\n\tvar minDelay = g.TRANSITION_MIN_DELAY = parseFloat(sass.transitions[\"min_delay_ms\"]);\n\tvar delay = g.TRANSITION_DELAY = g.TRANSITION_DURATION + g.TRANSITION_DELAY_INTERVAL;\n\n\t// css transitions\n\t// - - - - - - - - - - - - - - - - -\n\to = {};\n\n\t// match tx() in _transitions.scss\n\t// - - - - - - - - - - - - - - - - -\n\to.tx = function tx(durationCount, delayCount, easeVal) {\n\t\t_.isNumber(durationCount) || (durationCount = 1);\n\t\t_.isNumber(delayCount) || (delayCount = -1);\n\t\t_.isString(easeVal) || (easeVal = ease);\n\n\t\tvar o = {};\n\t\tif (delayCount < 0) {\n\t\t\to.duration = (duration * durationCount) +\n\t\t\t\t(delayInterval * (durationCount - 1));\n\t\t\to.delay = 0;\n\t\t} else {\n\t\t\to.duration = (duration * durationCount) +\n\t\t\t\t(delayInterval * (durationCount - 1)) - minDelay;\n\t\t\to.delay = (delay * delayCount) - minDelay;\n\t\t}\n\t\to.easeing = easeVal;\n\t\treturn 0;\n\t}\n\n\t// transition presets\n\t// TODO: get rid of this\n\t// - - - - - - - - - - - - - - - - -\n\n\to.NONE = {\n\t\tdelay: 0,\n\t\tduration: 0,\n\t\teasing: \"step-start\"\n\t};\n\to.NOW = {\n\t\tdelay: 0,\n\t\tduration: duration,\n\t\teasing: ease\n\t};\n\to.UNSET = _.defaults({\n\t\tcssText: \"\"\n\t}, o.NONE);\n\n\tvar txAligned = _.defaults({\n\t\tduration: duration - minDelay\n\t}, o.NOW);\n\to.FIRST = _.defaults({\n\t\tdelay: delay * 0.0 + minDelay\n\t}, txAligned);\n\to.BETWEEN = _.defaults({\n\t\tdelay: delay * 1.0 + minDelay\n\t}, txAligned);\n\to.LAST = _.defaults({\n\t\tdelay: delay * 2.0 + minDelay\n\t}, txAligned);\n\to.AFTER = _.defaults({\n\t\tdelay: delay * 2.0 + minDelay\n\t}, txAligned);\n\n\to.BETWEEN_EARLY = _.defaults({\n\t\tdelay: delay * 1.0 + minDelay - 60\n\t}, txAligned);\n\to.BETWEEN_LATE = _.defaults({\n\t\tdelay: delay * 1.0 + minDelay + 60\n\t}, txAligned);\n\n\to.FIRST_LATE = _.defaults({\n\t\tdelay: delay * 0.5 + minDelay\n\t}, txAligned);\n\to.LAST_EARLY = _.defaults({\n\t\tdelay: delay * 1.5 + minDelay\n\t}, txAligned);\n\t// o.FIRST_LATE = \t\t_.defaults({delay: txDelay*0.0 + txMinDelay*2}, txAligned);\n\t// o.LAST_EARLY = \t\t_.defaults({delay: txDelay*2.0 + txMinDelay*0}, txAligned);\n\t// o.AFTER = \t\t\t_.defaults({delay: txDelay*2.0 + txMinDelay}, txAligned);\n\n\tconsole.groupCollapsed(\"Transitions\");\n\tfor (s in o) {\n\t\tif (!_.isFunction(o[s])) {\n\t\t\tso = o[s];\n\t\t\tso.name = s;\n\t\t\tso.className = \"tx-\" + s.replace(\"_\", \"-\").toLowerCase();\n\t\t\tif (!so.hasOwnProperty(\"cssText\")) {\n\t\t\t\tso.cssText = so.duration / 1000 + \"s \" + so.easing + \" \" + so.delay / 1000 + \"s\";\n\t\t\t}\n\t\t\tconsole.log(\"%s: %s\", so.name, so.cssText);\n\t\t}\n\t}\n\tconsole.groupEnd();\n\tg.transitions = o;\n\n\treturn g;\n}());\n",
    "/**\n * @module app/view/DebugToolbar\n */\n\n/** @type {module:cookies-js} */\nvar Cookies = require(\"cookies-js\");\n// /** @type {module:modernizr} */\n// var Modernizr = require(\"Modernizr\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n// /** @type {module:app/control/Controller} */\n// var controller = require(\"app/control/Controller\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n\n/** @type {Function} */\nvar viewTemplate = require(\"./template/DebugToolbar.hbs\");\n\n/** @type {Function} */\nvar gridTemplate = require(\"./template/DebugToolbar.SVGGrid.hbs\");\n\n/** @type {Function} */\nvar sizeTemplate = _.template(\"<%= w %> \\u00D7 <%= h %>\");\n\n// var appStateSymbols = { withBundle: \"b\", withMedia: \"m\", collapsed: \"c\"};\n// var appStateKeys = Object.keys(appStateSymbols);\n\nmodule.exports = View.extend({\n\n\t/** @override */\n\tcidPrefix: \"debugToolbar\",\n\t/** @override */\n\ttagName: \"div\",\n\t/** @override */\n\tclassName: \"toolbar\",\n\t/** @override */\n\ttemplate: viewTemplate,\n\n\t/** @override */\n\tproperties: {\n\t\tgrid: {\n\t\t\tget: function() {\n\t\t\t\treturn this._grid || (this._grid = this.createGridElement());\n\t\t\t}\n\t\t}\n\t},\n\n\tinitialize: function(options) {\n\t\tCookies.defaults = {\n\t\t\texpires: new Date(0x7fffffff * 1e3),\n\t\t\tdomain: String(window.location)\n\t\t\t\t.match(/^https?\\:\\/\\/([^\\/:?#]+)(?:[\\/:?#]|$)/i)[1]\n\t\t};\n\n\t\tthis.el.innerHTML = this.template({\n\t\t\ttests: Modernizr,\n\t\t\tnavigator: window.navigator\n\t\t});\n\n\t\t/* toggle's target: container\n\t\t/* - - - - - - - - - - - - - - - - */\n\t\tvar container = document.getElementById(\"container\"); //.querySelector(\"#container\");\n\n\t\t/* create/attach svg grid element\n\t\t/* - - - - - - - - - - - - - - - - */\n\t\tcontainer.insertBefore(this.createGridElement(), container.firstElementChild);\n\n\t\t/* info elements\n\t\t/* - - - - - - - - - - - - - - - - */\n\t\tthis.backendEl = this.el.querySelector(\"#edit-backend a\");\n\t\tthis.mediaInfoEl = this.el.querySelector(\"#media-info span\");\n\t\tthis.appStateEl = this.el.querySelector(\"#app-state\");\n\n\t\t/* toggle visibility\n\t\t/* - - - - - - - - - - - - - - - - */\n\t\tthis.initializeClassToggle(\"show-links\", this.el.querySelector(\"#links-toggle\"), this.el,\n\t\t\tfunction(key, value) {\n\t\t\t\tthis.el.classList.toggle(\"not-\" + key, !value);\n\t\t\t}\n\t\t);\n\t\tthis.initializeClassToggle(\"show-tests\", this.el.querySelector(\"#toggle-tests a\"), this.el);\n\t\tthis.initializeClassToggle(\"hide-passed\", this.el.querySelector(\"#toggle-passed\"), this.el);\n\n\t\t/* toggle container classes\n\t\t/* - - - - - - - - - - - - - - - - */\n\t\tthis.initializeClassToggle(\"debug-state\",\n\t\t\tthis.el.querySelector(\"#toggle-state a\"), container);\n\t\tthis.initializeClassToggle(\"debug-blocks-nav\",\n\t\t\tthis.el.querySelector(\"#toggle-blocks-nav a\"), container);\n\t\tthis.initializeClassToggle(\"debug-blocks-content\",\n\t\t\tthis.el.querySelector(\"#toggle-blocks-content a\"), container);\n\t\tthis.initializeClassToggle(\"debug-mdown\",\n\t\t\tthis.el.querySelector(\"#toggle-mdown a\"), container);\n\t\tthis.initializeClassToggle(\"debug-tx\",\n\t\t\tthis.el.querySelector(\"#toggle-tx a\"), container,\n\t\t\tfunction(key, value) {\n\t\t\t\tthis.el.classList.toggle(\"show-tx\", value);\n\t\t\t\tthis.el.classList.toggle(\"not-show-tx\", !value);\n\t\t\t}\n\t\t);\n\t\tthis.initializeClassToggle(\"debug-graph\",\n\t\t\tthis.el.querySelector(\"#toggle-graph a\"), container);\n\t\tthis.initializeClassToggle(\"debug-logs\",\n\t\t\tthis.el.querySelector(\"#toggle-logs a\"), container);\n\t\tthis.initializeClassToggle(\"debug-grid-bg\",\n\t\t\tthis.el.querySelector(\"#toggle-grid-bg a\"), document.body);\n\n\t\tthis.initializeViewportInfo();\n\n\t\t// this.initializeLayoutSelect();\n\n\t\tthis.listenTo(this.model, \"change\", this._onModelChange);\n\t\tthis._onModelChange();\n\t},\n\n\tinitializeViewportInfo: function() {\n\t\tvar viewportInfoEl = this.el.querySelector(\"#viewport-info span\");\n\t\tvar callback = function() {\n\t\t\tviewportInfoEl.textContent = sizeTemplate({ w: window.innerWidth, h: window.innerHeight });\n\t\t};\n\t\tcallback.call();\n\t\twindow.addEventListener(\"resize\", _.debounce(callback, 100, false, false));\n\t},\n\n\tinitializeToggle: function(key, toggleEl, callback) {\n\t\tif (!toggleEl) return;\n\n\t\tvar ctx = this;\n\t\tvar toggleValue = Cookies.get(key) === \"true\";\n\t\tcallback.call(ctx, key, toggleValue);\n\n\t\ttoggleEl.addEventListener(\"click\", function(ev) {\n\t\t\tif (ev.defaultPrevented) return;\n\t\t\telse ev.preventDefault();\n\t\t\ttoggleValue = !toggleValue;\n\t\t\tCookies.set(key, toggleValue ? \"true\" : \"\");\n\t\t\tcallback.call(ctx, key, toggleValue);\n\t\t}, false);\n\t},\n\n\tinitializeClassToggle: function(key, toggleEl, targetEl, callback) {\n\t\tvar hasCallback = _.isFunction(callback);\n\n\t\tthis.initializeToggle(key, toggleEl, function(key, toggleValue) {\n\t\t\ttargetEl.classList.toggle(key, toggleValue);\n\t\t\ttoggleEl.classList.toggle(\"toggle-enabled\", toggleValue);\n\t\t\ttoggleEl.classList.toggle(\"color-reverse\", toggleValue);\n\t\t\thasCallback && callback.apply(this, arguments);\n\t\t});\n\t},\n\n\t_onModelChange: function() {\n\t\t// console.log(\"%s::_onModelChange changedAttributes: %o\", this.cid, this.model.changedAttributes());\n\t\tvar i, ii, prop, el, els = this.appStateEl.children;\n\t\tfor (i = 0, ii = els.length; i < ii; i++) {\n\t\t\tel = els[i];\n\t\t\tprop = el.getAttribute(\"data-prop\");\n\t\t\tel.classList.toggle(\"has-value\", this.model.get(prop));\n\t\t\tel.classList.toggle(\"has-changed\", this.model.hasChanged(prop));\n\t\t\tel.classList.toggle(\"color-reverse\", this.model.hasChanged(prop));\n\t\t}\n\n\t\t// NOTE: Always but rewrite CMS href.\n\t\t// Only collapsed may have changed, but not worth all the logic\n\t\tvar attrVal = Globals.APP_ROOT + \"symphony/\";\n\t\tswitch (this.model.get(\"routeName\")) {\n\t\t\tcase \"article-item\":\n\t\t\t\tattrVal += \"publish/articles/edit/\" + this.model.get(\"article\").id;\n\t\t\t\tbreak;\n\t\t\tcase \"bundle-item\":\n\t\t\t\tattrVal += \"publish/bundles/edit/\" + this.model.get(\"bundle\").id;\n\t\t\t\tbreak;\n\t\t\tcase \"media-item\":\n\t\t\t\tattrVal += \"publish/media/edit/\" + this.model.get(\"media\").id;\n\t\t\t\tbreak;\n\t\t\tcase \"root\":\n\t\t\t\tattrVal += \"publish/bundles\";\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.backendEl.setAttribute(\"href\", attrVal);\n\n\t\tif (this.model.hasChanged(\"routeName\")) {\n\t\t\tdocument.body.setAttribute(\"last-route\", this.model.previous(\"routeName\"));\n\t\t\tdocument.body.setAttribute(\"current-route\", this.model.get(\"routeName\"));\n\t\t}\n\n\t\tif (this.model.hasChanged(\"media\")) {\n\t\t\tif (this.model.has(\"media\")) {\n\t\t\t\tthis.mediaInfoEl.textContent = sizeTemplate(this.model.get(\"media\").get(\"source\").toJSON());\n\t\t\t\tthis.mediaInfoEl.style.display = \"\";\n\t\t\t} else {\n\t\t\t\tthis.mediaInfoEl.textContent = \"\";\n\t\t\t\tthis.mediaInfoEl.style.display = \"none\";\n\t\t\t}\n\t\t}\n\t},\n\n\tcreateGridElement: function() {\n\t\tvar el = document.createElement(\"div\");\n\t\tel.id = \"grid-wrapper\";\n\t\tel.innerHTML = gridTemplate();\n\t\treturn el;\n\t},\n});\n\nmodule.exports.prototype._logFlags = \"\";\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    return \"<svg id=\\\"debug-grid\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" preserveAspectRatio=\\\"xMaxYMid slice\\\" viewport-fill=\\\"hsl(0,0%,100%)\\\" viewport-fill-opacity=\\\"1\\\" style=\\\"fill:none;stroke:none;stroke-width:1px;fill:none;fill-rule:evenodd;\\\">\\n<defs>\\n\t<pattern id=\\\"pat-baseline-12px\\\" class=\\\"baseline base12\\\" x=\\\"0\\\" y=\\\"0\\\" width=\\\"20\\\" height=\\\"12\\\" patternUnits=\\\"userSpaceOnUse\\\">\\n\t\t<line x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"0\\\" y2=\\\"0\\\" stroke-opacity=\\\"1.0\\\"/>\\n\t\t<line x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"3\\\" y2=\\\"3\\\" stroke-opacity=\\\"0.125\\\"/>\\n\t\t<line x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"6\\\" y2=\\\"6\\\" stroke-opacity=\\\"0.375\\\"/>\\n\t\t<line x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"9\\\" y2=\\\"9\\\" stroke-opacity=\\\"0.125\\\"/>\\n\t</pattern>\\n\\n\t<pattern id=\\\"pat-baseline-24px\\\" class=\\\"baseline base12\\\" x=\\\"0\\\" y=\\\"0\\\" width=\\\"20\\\" height=\\\"24\\\" patternUnits=\\\"userSpaceOnUse\\\">\\n\t\t<line x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"0\\\" y2=\\\"0\\\" stroke-opacity=\\\"1.0\\\"/>\\n\t</pattern>\\n\\n\t<pattern id=\\\"pat-baseline-10px\\\" class=\\\"baseline base10\\\" x=\\\"0\\\" y=\\\"0\\\" width=\\\"20\\\" height=\\\"10\\\" patternUnits=\\\"userSpaceOnUse\\\">\\n\t\t<line x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"0\\\" y2=\\\"0\\\" stroke-opacity=\\\"1.00\\\"/>\\n\t\t<line x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"5\\\" y2=\\\"5\\\" stroke-opacity=\\\"0.75\\\"/>\\n\t</pattern>\\n\t<pattern id=\\\"pat-baseline-20px\\\" class=\\\"baseline base10\\\" x=\\\"0\\\" y=\\\"0\\\" width=\\\"20\\\" height=\\\"20\\\" patternUnits=\\\"userSpaceOnUse\\\">\\n\t\t<line x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"0\\\" y2=\\\"0\\\" stroke-opacity=\\\"1.0\\\"/>\\n\t</pattern>\\n\t<pattern id=\\\"pat-cols-220px\\\" x=\\\"0\\\" y=\\\"0\\\" width=\\\"220\\\" height=\\\"36\\\" patternUnits=\\\"userSpaceOnUse\\\">\\n\t\t<rect transform=\\\"translate(0,0)\\\" x=\\\"0\\\" y=\\\"0\\\" width=\\\"20\\\" height=\\\"100%\\\" fill=\\\"hsl(336,50%,40%)\\\" fill-opacity=\\\"0.1\\\"/>\\n\t\t<rect transform=\\\"translate(200,0)\\\" x=\\\"0\\\" y=\\\"0\\\" width=\\\"20\\\" height=\\\"100%\\\" fill=\\\"hsl(336,50%,40%)\\\" fill-opacity=\\\"0.1\\\"/>\\n\t\t<line transform=\\\"translate(20 0)\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\" stroke=\\\"hsl(336,50%,60%)\\\" stroke-opacity=\\\"0.2\\\"/>\\n\t\t<line transform=\\\"translate(200 0)\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\" stroke=\\\"hsl(336,50%,40%)\\\" stroke-opacity=\\\"0.2\\\"/>\\n\\n\t\t<line transform=\\\"translate(140 0)\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\" stroke=\\\"hsl(336,50%,40%)\\\" stroke-opacity=\\\"0.3\\\"/>\\n\t\t<line transform=\\\"translate(80 0)\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\" stroke=\\\"hsl(336,50%,40%)\\\" stroke-opacity=\\\"0.3\\\"/>\\n\\n\t\t<line transform=\\\"translate(0 0)\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\" stroke=\\\"hsl(236,50%,40%)\\\" stroke-opacity=\\\"0.4\\\" stroke-width=\\\"1\\\"/>\\n\t\t<line transform=\\\"translate(220 0)\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\" stroke=\\\"hsl(236,50%,40%)\\\" stroke-opacity=\\\"0.4\\\" stroke-width=\\\"1\\\"/>\\n\t</pattern>\\n</defs>\\n<g id=\\\"debug-grid-body\\\" transform=\\\"translate(0 0.5)\\\">\\n\t<rect id=\\\"baseline\\\" x=\\\"0\\\" y=\\\"0\\\" width=\\\"100%\\\" height=\\\"100%\\\"/>\\n\t<g id=\\\"debug-grid-container\\\">\\n\t\t<g id=\\\"debug-grid-content\\\">\\n\t\t\t<rect id=\\\"baseline-content\\\" x=\\\"0\\\" y=\\\"0\\\" width=\\\"100%\\\" height=\\\"100%\\\"/>\\n\t\t\t<line id=\\\"gct0\\\" class=\\\"hguide\\\" x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"0\\\" y2=\\\"0\\\"/>\\n\t\t\t<line id=\\\"gct1\\\" class=\\\"hguide\\\" x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"0\\\" y2=\\\"0\\\"/>\\n\t\t</g>\\n\t\t<line id=\\\"gnv0\\\" class=\\\"hguide\\\" x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"0\\\" y2=\\\"0\\\"/>\\n\t\t<line id=\\\"gnv1\\\" class=\\\"hguide\\\" x1=\\\"0\\\" x2=\\\"100%\\\" y1=\\\"0\\\" y2=\\\"0\\\"/>\\n\t</g>\\n\\n\t<g id=\\\"abs-cols\\\">\\n\t\t<rect id=\\\"columns\\\" x=\\\"0\\\" y=\\\"0\\\" width=\\\"100%\\\" height=\\\"100%\\\"/>\\n\t</g>\\n\\n\t<g id=\\\"rel-cols\\\">\\n\t\t<line id=\\\"le\\\" class=\\\"vguide edge\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\"/>\\n\t\t<line id=\\\"re\\\" class=\\\"vguide edge\\\" x1=\\\"100%\\\" x2=\\\"100%\\\" y1=\\\"0\\\" y2=\\\"100%\\\"/>\\n\\n\t\t<line id=\\\"gl0\\\" class=\\\"vguide margin\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\"/>\\n\t\t<line id=\\\"gl1\\\" class=\\\"vguide gutter\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\"/>\\n\\n\t\t<line id=\\\"gr0\\\" class=\\\"vguide margin\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\"/>\\n\t\t<line id=\\\"gr1\\\" class=\\\"vguide gutter\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\"/>\\n\\n\t\t<line id=\\\"gm\\\" class=\\\"vguide\\\" x1=\\\"0\\\" x2=\\\"0\\\" y1=\\\"0\\\" y2=\\\"100%\\\"/>\\n\t</g>\\n</g>\\n</svg>\\n\";\n},\"useData\":true});\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nvar partial$0 = require('../../View/template/svg/CogSymbol.hbs');\nHandlebarsCompiler.registerPartial('../../View/template/svg/CogSymbol.hbs', partial$0);\nmodule.exports = HandlebarsCompiler.template({\"1\":function(container,depth0,helpers,partials,data) {\n    var stack1;\n\n  return \"\t<dd id=\\\"select-layout\\\">\\n\t\t<select size=1>\\n\"\n    + ((stack1 = helpers.each.call(depth0 != null ? depth0 : (container.nullContext || {}),(depth0 != null ? depth0.layouts : depth0),{\"name\":\"each\",\"hash\":{},\"fn\":container.program(2, data, 0),\"inverse\":container.noop,\"data\":data})) != null ? stack1 : \"\")\n    + \"\t\t</select>\\n\t</dd>\\n\";\n},\"2\":function(container,depth0,helpers,partials,data) {\n    var alias1=container.lambda, alias2=container.escapeExpression;\n\n  return \"\t\t\t<option value=\\\"\"\n    + alias2(alias1(depth0, depth0))\n    + \"\\\">\"\n    + alias2(alias1(depth0, depth0))\n    + \"</option>\\n\";\n},\"4\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : (container.nullContext || {});\n\n  return \"\t\t<li class=\\\"\"\n    + ((stack1 = helpers[\"if\"].call(alias1,depth0,{\"name\":\"if\",\"hash\":{},\"fn\":container.program(5, data, 0),\"inverse\":container.program(7, data, 0),\"data\":data})) != null ? stack1 : \"\")\n    + \"\\\">\"\n    + container.escapeExpression(((helper = (helper = helpers.key || (data && data.key)) != null ? helper : helpers.helperMissing),(typeof helper === \"function\" ? helper.call(alias1,{\"name\":\"key\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</li>\\n\";\n},\"5\":function(container,depth0,helpers,partials,data) {\n    return \"passed\";\n},\"7\":function(container,depth0,helpers,partials,data) {\n    return \"failed\";\n},\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=container.escapeExpression;\n\n  return \"<dl class=\\\"debug-links color-bg\\\">\\n\t<dt id=\\\"links-toggle\\\">\\n\"\n    + ((stack1 = container.invokePartial(partials[\"../../View/template/svg/CogSymbol.hbs\"],depth0,{\"name\":\"../../View/template/svg/CogSymbol.hbs\",\"data\":data,\"indent\":\"\\t\\t\",\"helpers\":helpers,\"partials\":partials,\"decorators\":container.decorators})) != null ? stack1 : \"\")\n    + \"\t</dt>\\n\"\n    + ((stack1 = helpers[\"if\"].call(alias1,(depth0 != null ? depth0.layouts : depth0),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data})) != null ? stack1 : \"\")\n    + \"\t<dd id=\\\"edit-backend\\\">\\n\t\t<a href=\\\"\"\n    + alias2((helpers.global || (depth0 && depth0.global) || helpers.helperMissing).call(alias1,\"APP_ROOT\",{\"name\":\"global\",\"hash\":{},\"data\":data}))\n    + \"symphony/\\\" class=\\\"color-fg color-bg\\\" target=\\\"_blank\\\">CMS</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-tests\\\">\\n\t\t<a href=\\\"#toggle-tests\\\" class=\\\"color-fg color-bg\\\">Tests</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-state\\\">\\n\t\t<a href=\\\"#toggle-state\\\" class=\\\"color-fg color-bg\\\">Route</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-blocks-nav\\\">\\n\t\t<a href=\\\"#toggle-blocks-nav\\\" class=\\\"color-fg color-bg\\\">Nav</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-blocks-content\\\">\\n\t\t<a href=\\\"#toggle-blocks-content\\\" class=\\\"color-fg color-bg\\\">Content</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-mdown\\\">\\n\t\t<a href=\\\"#toggle-mdown\\\" class=\\\"color-fg color-bg\\\">Markdown</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-tx\\\">\\n\t\t<a href=\\\"#toggle-tx\\\" class=\\\"color-fg color-bg\\\">TX/FX</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-grid-bg\\\">\\n\t\t<a href=\\\"#toggle-grid-bg\\\" class=\\\"color-fg color-bg\\\">Grid</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-graph\\\">\\n\t\t<a href=\\\"#toggle-graph\\\" class=\\\"color-fg color-bg\\\">Graph</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-logs\\\">\\n\t\t<a href=\\\"#toggle-logs\\\" class=\\\"color-fg color-bg\\\">Logs</a>\\n\t</dd>\\n\t<dd id=\\\"media-info\\\">\\n\t\t<span></span>\\n\t</dd>\\n\t<dd id=\\\"viewport-info\\\">\\n\t\t<span></span>\\n\t</dd>\\n\t<dd id=\\\"app-state\\\">\\n\t\t<span class=\\\"color-fg color-bg\\\" data-prop=\\\"collapsed\\\">c</span><span class=\\\"color-fg color-bg\\\" data-prop=\\\"withBundle\\\">b</span><span class=\\\"color-fg color-bg\\\" data-prop=\\\"withMedia\\\">m</span><span class=\\\"color-fg color-bg\\\" data-prop=\\\"withArticle\\\">a</span>\\n\t</dd>\\n</dl>\\n<div id=\\\"test-results\\\">\\n\t<h6>Tests <a id=\\\"toggle-passed\\\" href=\\\"#toggle-passed\\\">Passed</a></h6>\\n\t<p>\"\n    + alias2(container.lambda(((stack1 = (depth0 != null ? depth0.navigator : depth0)) != null ? stack1.userAgent : stack1), depth0))\n    + \"</p>\\n\t<ul>\\n\"\n    + ((stack1 = helpers.each.call(alias1,(depth0 != null ? depth0.tests : depth0),{\"name\":\"each\",\"hash\":{},\"fn\":container.program(4, data, 0),\"inverse\":container.noop,\"data\":data})) != null ? stack1 : \"\")\n    + \"\t</ul>\\n</div>\\n\";\n},\"usePartial\":true,\"useData\":true});\n",
    "/**\n * @module app/model/BaseItem\n * @requires module:backbone\n *//** @type {module:backbone} */\nvar BaseModel = require(\"backbone\").Model;\n// /** @type {module:app/model/BaseModel} */\n// var BaseModel = require(\"app/model/BaseModel\");\n\nmodule.exports = BaseModel.extend({\n\n\tdefaults: {\n\t\tcollapsed: false,\n\t\trouteName: \"initial\",\n\t\tarticle: null,\n\t\tbundle: null,\n\t\tmedia: null,\n\t\tfromRouteName: \"\",\n\t\twithArticle: false,\n\t\twithBundle: false,\n\t\twithMedia: false,\n\t},\n\n\tgetters: [\n\t\t\"collapsed\",\n\t\t\"routeName\",\n\t\t\"article\",\n\t\t\"bundle\",\n\t\t\"media\",\n\t\t\"fromRouteName\",\n\t\t\"withArticle\",\n\t\t\"withBundle\",\n\t\t\"withMedia\"\n\t],\n\n\t// mutators: {\n\t// \trouteName: {\n\t// \t\tset: function(key, value, opts, set) {\n\t// \t\t\t// Set fromRoute to avoid losing current \"changing\" state\n\t// \t\t\tthis._previousAttributes[\"fromRouteName\"] = this.attributes[\"fromRouteName\"];\n\t// \t\t\tthis.changed[\"fromRouteName\"] = this.attributes[\"fromRouteName\"] = this.previous(\"routeName\");\n\t// \t\t\t// set(\"fromRouteName\", this.previous(\"routeName\"), {\n\t// \t\t\t// \tsilent: true\n\t// \t\t\t// });\n\t// \t\t}\n\t// \t}\n\t// },\n\n\tinitialize: function() {\n\t\t// this.listenTo(this, {\n\t\t// \t\"change:routeName\": function() {\n\t\t// \t\tthis.set(\"fromRouteName\", this.previous(\"routeName\"));\n\t\t// \t},\n\t\t// \t\"change:article\": function(val) {\n\t\t// \t\tconsole.log(\"%s:[change] %o\", this.cid, arguments);\n\t\t// \t\tthis.set(\"withArticle\", (typeof val === 'object'));\n\t\t// \t},\n\t\t// \t\"change:bundle\": function(val) {\n\t\t// \t\tconsole.log(\"%s:[change] %o\", this.cid, arguments);\n\t\t// \t\tthis.set(\"withBundle\", (typeof val === 'object'));\n\t\t// \t},\n\t\t// \t\"change:media\": function(val) {\n\t\t// \t\tconsole.log(\"%s:[change] %o\", this.cid, arguments);\n\t\t// \t\tthis.set(\"withMedia\", (typeof val === 'object'));\n\t\t// \t},\n\t\t// });\n\n\t\t// this.set({\n\t\t// \tfromRouteName: \"\",\n\t\t// \t\twithArticle: false,\n\t\t// \t\twithBundle: false,\n\t\t// \t\twithMedia: false\n\t\t// });\n\t\tvar opts = { silent: false };\n\n\t\tthis.listenTo(this, \"change\", function(attrs) {\n\t\t\t// var opts = { silent: false };\n\t\t\tif (this.hasChanged(\"routeName\")) {\n\t\t\t\tthis.set(\"fromRouteName\", this.previous(\"routeName\"), opts);\n\t\t\t}\n\t\t\tif (this.hasChanged(\"article\")) {\n\t\t\t\tthis.set(\"withArticle\", this.has(\"article\"), opts);\n\t\t\t}\n\t\t\tif (this.hasChanged(\"bundle\")) {\n\t\t\t\tthis.set(\"withBundle\", this.has(\"bundle\"), opts);\n\t\t\t}\n\t\t\tif (this.hasChanged(\"media\")) {\n\t\t\t\tthis.set(\"withMedia\", this.has(\"media\"), opts);\n\t\t\t}\n\t\t});\n\n\t\tthis.listenTo(this, \"change:routeName\",\n\t\t\tfunction(val) {\n\t\t\t\tconsole.log(\"%s:[change:routeName] %o\", this.cid, val);\n\t\t\t\t// this.set(\"fromRouteName\", this.previous(\"routeName\"));\n\t\t\t});\n\t\tthis.listenTo(this, \"change:article\",\n\t\t\tfunction(val) {\n\t\t\t\tconsole.log(\"%s:[change:article] %o\", this.cid, val);\n\t\t\t\t// this.set(\"withArticle\", _.isObject(val));\n\t\t\t});\n\t\tthis.listenTo(this, \"change:bundle\",\n\t\t\tfunction(val) {\n\t\t\t\tconsole.log(\"%s:[change:bundle] %o\", this.cid, val);\n\t\t\t\t// this.set(\"withBundle\", _.isObject(val));\n\t\t\t});\n\t\tthis.listenTo(this, \"change:media\",\n\t\t\tfunction(val) {\n\t\t\t\tconsole.log(\"%s:[change:media] %o\", this.cid, val);\n\t\t\t\t// this.set(\"withMedia\", _.isObject(val));\n\t\t\t});\n\t},\n\n\thasAnyPrevious: function(attr) {\n\t\treturn this.previous(attr) != null;\n\t},\n\n\thasAnyChanged: function(attr) {\n\t\treturn this.hasChanged(attr) && (this.has(attr) != this.hasAnyPrevious(attr));\n\t}\n\n\t// constructor: function() {\n\t// \tObject.keys(this.defaults).forEach(function(getterName) {\n\t// \t\tObject.defineProperty(this, getterName, {\n\t// \t\t\tenumerable: true,\n\t// \t\t\tget: function() {\n\t// \t\t\t\treturn this.get(getterName);\n\t// \t\t\t}\n\t// \t\t});\n\t// \t});\n\t// \tBaseModel.apply(this, arguments);\n\t// }\n});\n",
    "/**\n * @module app/model/BaseItem\n * @requires module:backbone\n */\n\n/** @type {module:app/model/BaseModel} */\nvar BaseModel = require(\"app/model/BaseModel\");\n\n// /** @type {module:app/control/Globals} */\n// var Globals = require(\"app/control/Globals\");\n// /** @type {module:app/utils/strings/stripTags} */\n// var stripTags = require(\"utils/strings/stripTags\");\n// /** @type {module:app/model/parseSymAttrs} */\n//var parseSymAttrs = require(\"app/model/parseSymAttrs\");\n\nvar parseSymAttrs = function(s) {\n\treturn s.replace(/(\\,|\\;)/g, function(m) {\n\t\treturn (m == \",\") ? \";\" : \",\";\n\t});\n};\nvar toAttrsHash = function(obj, attr) {\n\tif (_.isString(attr)) {\n\t\tvar idx = attr.indexOf(\":\");\n\t\tif (idx > 0) {\n\t\t\tobj[attr.substring(0, idx)] = parseSymAttrs(attr.substring(idx + 1));\n\t\t} else {\n\t\t\tobj[attr] = attr; // to match HTML5<>XHTML valueless attributes\n\t\t}\n\t} // else ignore non-string values\n\treturn obj;\n};\n/**\n * @constructor\n * @type {module:app/model/BaseItem}\n */\nmodule.exports = BaseModel.extend({\n\n\t_domPrefix: \"_\",\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\t// attrs: function() { return {}; },\n\t\tget attrs() {\n\t\t\treturn {};\n\t\t},\n\t},\n\n\tgetters: [\"domid\"],\n\n\tmutators: {\n\t\tdomid: function() {\n\t\t\tif (!this.hasOwnProperty(\"_domId\"))\n\t\t\t\tthis._domId = this._domPrefix + this.id;\n\t\t\treturn this._domId;\n\t\t},\n\t\tattrs: {\n\t\t\tset: function(key, value, options, set) {\n\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\tvalue = value.reduce(toAttrsHash, {});\n\t\t\t\t}\n\t\t\t\tif (!_.isObject(value)) {\n\t\t\t\t\tconsole.error(\"%s::attrs value not an object or string array\", this.cid, value);\n\t\t\t\t\tvalue = {};\n\t\t\t\t}\n\t\t\t\tset(key, value, options);\n\t\t\t}\n\t\t},\n\t},\n\n\tattr: function(attr) {\n\t\treturn this.attrs()[attr];\n\t},\n\n\tattrs: function() {\n\t\treturn this.get(\"attrs\");\n\t},\n\n\ttoString: function() {\n\t\treturn this.get(\"domid\");\n\t},\n\n\tgetDistanceToSelected: function() {\n\t\tif (this.collection && this.collection.selectedIndex > 0) {\n\t\t\treturn this.collection.indexOf(this) - this.collection.selectedIndex;\n\t\t}\n\t\treturn -1;\n\t},\n\n\tgetIndex: function() {\n\t\tif (this.collection) {\n\t\t\treturn this.collection.indexOf(this);\n\t\t}\n\t\treturn -1;\n\t}\n});\n",
    "/**\n * @module app/model/BaseModel\n * @requires module:backbone\n */\n\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n\nvar BaseModelProto = {\n\t// constructor: function() {\n\t// \tif (this.properties) {\n\t// \t\tObject.defineProperties(this, this.properties);\n\t// \t}\n\t// \tBackbone.Model.apply(this, arguments);\n\t// }\n};\n\nvar BaseModel = {\n\textend: function(proto, obj) {\n\t\tvar constr, propName; //, propDef;\n\t\tfor (propName in proto) {\n\t\t\tif (proto.hasOwnProperty(propName) && _.isObject(proto[propName])) { //(Object.getPrototypeOf(proto[propName]) === Object.prototype)) {\n\t\t\t\tproto[propName] = _.defaults(proto[propName], this.prototype[propName]);\n\t\t\t\t// console.log(\"BaseModel::extend '%s:%s' is Object\\n%s\", proto._domPrefix, propName, JSON.stringify(proto[propName]));\n\t\t\t}\n\t\t}\n\n\t\t// if (_.isObject(proto.properties)) {\n\t\t// \tif (Array.isArray(proto.getters)) {\n\t\t// \t\tproto.properties = _.omit(proto.properties, proto.getters);\n\t\t// \t}\n\t\t// }\n\t\t// if (proto.properties && this.prototype.properties) {\n\t\t// \t_.defaults(proto.properties, this.prototype.properties);\n\t\t// }\n\n\t\tconstr = Backbone.Model.extend.apply(this, arguments);\n\n\t\tif (Array.isArray(constr.prototype.getters)) {\n\t\t\tconstr.prototype.getters.forEach(function(getterName) {\n\t\t\t\tObject.defineProperty(constr.prototype, getterName, {\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() {\n\t\t\t\t\t\treturn this.get(getterName);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\t// if (Array.isArray(constr.prototype.properties)) {\n\t\t// }\n\n\t\t// if (_.isObject(proto.properties)) {\n\t\t// \tfor (propName in proto.properties) {\n\t\t// \t\tif (proto.properties.hasOwnProperty(propName)) {\n\t\t// \t\t\tpropDef = proto.properties[propName];\n\t\t// \t\t\tif (_.isFunction(propDef)) {\n\t\t// \t\t\t\tproto.properties[propName] = {\n\t\t// \t\t\t\t\tenumerable: true, get: propDef\n\t\t// \t\t\t\t};\n\t\t// \t\t\t} else if (_.isObject(propDef)){\n\t\t// \t\t\t\tpropDef.enumerable = true;\n\t\t// \t\t\t} else {\n\t\t// \t\t\t\tdelete proto.properties[propName];\n\t\t// \t\t\t}\n\t\t// \t\t}\n\t\t// \t}\n\t\t// \tObject.defineProperties(proto, proto.properties);\n\t\t// \tdelete proto.properties;\n\t\t// }\n\t\treturn constr;\n\t}\n};\n\n/**\n * @constructor\n * @type {module:app/model/BaseModel}\n */\nmodule.exports = Backbone.Model.extend.call(Backbone.Model, BaseModelProto, BaseModel);\n// module.exports = Model.extend(BaseModelProto, BaseModel);\n",
    "/**\n * @module app/model/SelectableCollection\n */\n\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n\n/**\n * @constructor\n * @type {module:app/model/SelectableCollection}\n */\nvar SelectableCollection = Backbone.Collection.extend({\n\n\tinitialize: function(models, options) {\n\t\toptions = _.defaults({}, options, {\n\t\t\tinitialSelection: \"none\",\n\t\t\tsilentInitial: true\n\t\t});\n\t\tthis.initialSelection = options.initialSelection;\n\t\tthis.initialOptions = {\n\t\t\tsilent: options.silentInitial\n\t\t};\n\t},\n\n\treset: function(models, options) {\n\t\tthis.deselect(this.initialOptions);\n\t\tBackbone.Collection.prototype.reset.apply(this, arguments);\n\t\tif (this.initialSelection === \"first\" && this.length) {\n\t\t\tthis.select(this.at(0), this.initialOptions);\n\t\t}\n\t},\n\n\tselect: function(newModel, options) {\n\t\tif (newModel === void 0) {\n\t\t\tnewModel = null;\n\t\t}\n\t\tif (this.selected === newModel) {\n\t\t\treturn;\n\t\t}\n\t\tvar triggerEvents = !(options && options.silent);\n\t\tvar oldModel = this.selected;\n\n\t\tthis.lastSelected = this.selected;\n\t\tthis.lastSelectedIndex = this.selectedIndex;\n\t\tthis.selected = newModel;\n\t\tthis.selectedIndex = this.indexOf(newModel);\n\n\t\tif (oldModel) {\n\t\t\tif (_.isFunction(oldModel.deselect)) {\n\t\t\t\toldModel.deselect(options);\n\t\t\t} else if (triggerEvents) {\n\t\t\t\toldModel.selected = void 0;\n\t\t\t\toldModel.trigger(\"deselected\", newModel, oldModel);\n\t\t\t}\n\t\t\tif (triggerEvents) this.trigger(\"deselect:one\", oldModel);\n\t\t} else {\n\t\t\tif (triggerEvents) this.trigger(\"deselect:none\", null);\n\t\t}\n\n\t\tif (newModel) {\n\t\t\tif (_.isFunction(newModel.select)) {\n\t\t\t\tnewModel.select(options);\n\t\t\t} else if (triggerEvents) {\n\t\t\t\tnewModel.selected = true;\n\t\t\t\tnewModel.trigger(\"selected\", newModel, oldModel);\n\t\t\t}\n\t\t\tif (triggerEvents) this.trigger(\"select:one\", newModel);\n\t\t} else {\n\t\t\tif (triggerEvents) this.trigger(\"select:none\", null);\n\t\t}\n\t},\n\n\tdeselect: function(options) {\n\t\tthis.select(null, options);\n\t},\n\n\tselectAt: function(index, options) {\n\t\tif (0 > index || index >= this.length) {\n\t\t\tnew RangeError(\"index is out of bounds\");\n\t\t}\n\t\tthis.select(this.at(index), options);\n\t},\n\n\tdistance: function(a, b) {\n\t\tvar aIdx, bIdx;\n\n\t\tif (!a) return NaN;\n\t\taIdx = this.indexOf(a);\n\t\tif (aIdx == -1) return NaN;\n\n\t\tif (arguments.length == 1) {\n\t\t\tbIdx = this.selectedIndex;\n\t\t} else {\n\t\t\tif (!b) return NaN;\n\t\t\tbIdx = this.indexOf(b);\n\t\t\tif (bIdx == -1) return NaN;\n\t\t}\n\t\treturn Math.abs(bIdx - aIdx);\n\t},\n\n\t/* TODO: MOVE INTO MIXIN */\n\n\t/** @return boolean\t/*/\n\thasFollowing: function(model) {\n\t\tmodel || (model = this.selected);\n\t\treturn this.indexOf(model) < (this.length - 1);\n\t},\n\n\t/** @return next model\t*/\n\tfollowing: function(model) {\n\t\tmodel || (model = this.selected);\n\t\treturn this.hasFollowing(model) ? this.at(this.indexOf(model) + 1) : null;\n\t},\n\n\t/** @return next model or the beginning if at the end */\n\tfollowingOrFirst: function(model) {\n\t\tmodel || (model = this.selected);\n\t\treturn this.at((this.indexOf(model) + 1) % this.length);\n\t},\n\n\t/** @return boolean\t/*/\n\thasPreceding: function(model) {\n\t\tmodel || (model = this.selected);\n\t\treturn this.indexOf(model) > 0;\n\t},\n\n\t/** @return the previous model */\n\tpreceding: function(model) {\n\t\tmodel || (model = this.selected);\n\t\treturn this.hasPreceding(model) ? this.at(this.indexOf(model) - 1) : null;\n\t},\n\n\t/** @return the previous model or the end if at the beginning */\n\tprecedingOrLast: function(model) {\n\t\tmodel || (model = this.selected);\n\t\tvar index = this.indexOf(model) - 1;\n\t\treturn this.at(index > -1 ? index : this.length - 1);\n\t},\n\n});\n\nmodule.exports = SelectableCollection;\n",
    "/**\n * @module app/model/collection/ArticleCollection\n */\n\n/** @type {module:app/model/SelectableCollection} */\nvar SelectableCollection = require(\"app/model/SelectableCollection\");\n\n/** @type {module:app/model/item/ArticleItem} */\nvar ArticleItem = require(\"app/model/item/ArticleItem\");\n\n/**\n * @constructor\n * @type {module:app/model/collection/ArticleCollection}\n */\nvar ArticleCollection = SelectableCollection.extend({\n\n\t/** @type {Backbone.Model} */\n\tmodel: ArticleItem\n\n});\n\nmodule.exports = new ArticleCollection();\n",
    "/**\n * @module app/model/collection/BundleCollection\n */\n\n/** @type {module:app/model/SelectableCollection} */\nvar SelectableCollection = require(\"app/model/SelectableCollection\");\n\n/** @type {module:app/model/item/BundleItem} */\nvar BundleItem = require(\"app/model/item/BundleItem\");\n\n/**\n * @constructor\n * @type {module:app/model/collection/BundleCollection}\n */\nvar BundleCollection = SelectableCollection.extend({\n\n\t/** @type {Backbone.Model} */\n\tmodel: BundleItem,\n\n\t/** @type {Function} */\n\tcomparator: function(oa, ob) {\n\t\tvar a = oa.get(\"completed\");\n\t\tvar b = ob.get(\"completed\");\n\t\tif (a > b) {\n\t\t\treturn -1;\n\t\t} else if (a < b) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\t/** @type {String} */\n\turl: \"/json/bundles/\",\n\n});\n\nmodule.exports = new BundleCollection();\n",
    "/**\n * @module app/model/collection/KeywordCollection\n * @requires module:backbone\n */\n\n/** @type {module:app/model/SelectableCollection} */\nvar SelectableCollection = require(\"app/model/SelectableCollection\");\n\n/** @type {module:app/model/item/KeywordItem} */\nvar KeywordItem = require(\"app/model/item/KeywordItem\");\n\n/**\n * @constructor\n * @type {module:app/model/collection/KeywordCollection}\n */\nvar KeywordCollection = SelectableCollection.extend({\n\n\t/** @type {Backbone.Model} */\n\tmodel: KeywordItem\n\n});\n\nmodule.exports = new KeywordCollection();\n",
    "/**\n * @module app/model/collection/TypeCollection\n * @requires module:backbone\n */\n\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n\n/** @type {module:app/model/item/TypeItem} */\nvar TypeItem = require(\"app/model/item/TypeItem\");\n\n/**\n * @constructor\n * @type {module:app/model/collection/TypeCollection}\n */\nvar TypeCollection = Backbone.Collection.extend({\n\n\t/** @type {Backbone.Model} */\n\tmodel: TypeItem\n\n});\n\nmodule.exports = new TypeCollection();\n",
    "module.exports = function(bootstrap) {\n\n\t/** @type {module:app/control/Globals} */\n\tvar Globals = require(\"app/control/Globals\");\n\n\t// Globals.GA_TAGS = bootstrap[\"ga-tags\"];\n\t// Globals.PARAMS = bootstrap[\"params\"];\n\t// Globals.APP_ROOT = bootstrap[\"params\"][\"root\"];\n\t// Globals.MEDIA_DIR = bootstrap[\"params\"][\"uploads\"];\n\tGlobals.APP_NAME = bootstrap[\"params\"][\"website-name\"];\n\n\t/** @type {module:app/model/collection/TypeCollection} */\n\tvar typeList = require(\"app/model/collection/TypeCollection\");\n\t/** @type {module:app/model/collection/KeywordCollection} */\n\tvar keywordList = require(\"app/model/collection/KeywordCollection\");\n\t/** @type {module:app/model/collection/BundleCollection} */\n\tvar bundleList = require(\"app/model/collection/BundleCollection\");\n\t/** @type {module:app/model/collection/ArticleCollection} */\n\tvar articleList = require(\"app/model/collection/ArticleCollection\");\n\n\t// Fix-ups to bootstrap data.\n\tvar articles = bootstrap[\"articles-all\"];\n\tvar types = bootstrap[\"types-all\"];\n\tvar keywords = bootstrap[\"keywords-all\"];\n\tvar bundles = bootstrap[\"bundles-all\"];\n\tvar media = bootstrap[\"media-all\"];\n\n\t// Attach media to their bundles\n\tvar mediaByBundle = _.groupBy(media, \"bId\");\n\n\t// Fill-in back-references:\n\t// Create Keyword.bundleIds from existing Bundle.keywordIds,\n\t// then Bundle.typeIds from unique Keyword.typeId\n\n\t// _.each(bundles, function (bo, bi, ba) {\n\tbundles.forEach(function(bo, bi, ba) {\n\t\tbo.tIds = [];\n\t\tbo.media = mediaByBundle[bo.id];\n\t\t// _.each(keywords, function (ko, ki, ka) {\n\t\tkeywords.forEach(function(ko, ki, ka) {\n\t\t\tif (bi === 0) {\n\t\t\t\tko.bIds = [];\n\t\t\t}\n\t\t\t// if (_.contains(bo.kIds, ko.id)) {\n\t\t\tif (bo.kIds.indexOf(ko.id) != -1) {\n\t\t\t\tko.bIds.push(bo.id);\n\t\t\t\t// if (!_.contains(bo.tIds, ko.tId)) {\n\t\t\t\tif (bo.tIds.indexOf(ko.tId) == -1) {\n\t\t\t\t\tbo.tIds.push(ko.tId);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\t// Fill collection singletons\n\tarticleList.reset(articles);\n\ttypeList.reset(types);\n\tkeywordList.reset(keywords);\n\tbundleList.reset(bundles);\n\n\t// bootstrap[\"params\"] = bootstrap[\"articles-all\"] = bootstrap[\"types-all\"] = bootstrap[\"keywords-all\"] = bootstrap[\"bundles-all\"] = bootstrap[\"media-all\"] = null;\n};\n",
    "/**\n * @module app/model/item/ArticleItem\n */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:app/model/item/SourceItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n\n/**\n * @constructor\n * @type {module:app/model/item/ArticleItem}\n */\nmodule.exports = BaseItem.extend({\n\n\t_domPrefix: \"a\",\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tname: \"\",\n\t\thandle: \"\",\n\t\ttext: \"\"\n\t},\n\n});\n",
    "/**\n * @module app/model/item/BundleItem\n * @requires module:backbone\n */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");/** @type {Function} */\nvar Color = require(\"color\");\n\n/** @type {module:app/model/item/SourceItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n/** @type {module:app/model/item/MediaItem} */\nvar MediaItem = require(\"app/model/item/MediaItem\");\n/** @type {module:app/model/SelectableCollection} */\nvar SelectableCollection = require(\"app/model/SelectableCollection\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/utils/strings/stripTags} */\nvar stripTags = require(\"utils/strings/stripTags\");\n// /** @type {module:app/utils/strings/parseTaglist} */\n// var parseSymAttrs = require(\"app/model/parseSymAttrs\");\n\n// /** @type {module:app/model/collection/KeywordCollection} */\n// var keywords = require(\"app/model/collection/KeywordCollection\");\n\n// Globals.DEFAULT_COLORS[\"color\"];\n// Globals.DEFAULT_COLORS[\"background-color\"];\nvar attrsDefault = _.defaults({\n\t\"has-colors\": \"defaults\"\n}, Globals.DEFAULT_COLORS);\n\n/** @private */\nvar MediaCollection = SelectableCollection.extend({\n\tmodel: MediaItem,\n\tcomparator: \"o\"\n});\n\n/**\n * @constructor\n * @type {module:app/model/item/BundleItem}\n */\nmodule.exports = BaseItem.extend({\n\n\t_domPrefix: \"b\",\n\n\t/** @type {Object|Function} */\n\t// defaults: function() {\n\t// \treturn {\n\t// \t\tname: \"\",\n\t// \t\thandle: \"\",\n\t// \t\tdesc: \"\",\n\t// \t\tcompleted: 0,\n\t// \t\tkIds: [],\n\t// \t};\n\t// },\n\tdefaults: {\n\t\tname: \"\",\n\t\thandle: \"\",\n\t\tdesc: \"\",\n\t\tcompleted: 0,\n\t\tget kIds() {\n\t\t\treturn [];\n\t\t},\n\t\t// get keywords() { return []; },\n\t},\n\n\tgetters: [\"name\", \"media\"],\n\n\tmutators: {\n\t\ttext: function() {\n\t\t\treturn stripTags(this.get(\"desc\"));\n\t\t},\n\t\t// kIds: {\n\t\t// \tset: function (key, value, options, set) {\n\t\t// \t\tif (Array.isArray(value)) {\n\t\t// \t\t\tset(\"keywords\", value.map(function(id) {\n\t\t// \t\t\t\tvar obj = keywords.get(id);\n\t\t// \t\t\t\treturn obj;\n\t\t// \t\t\t}, this), options;\n\t\t// \t\t}\n\t\t// \t\tset(key, value, options);\n\t\t// \t},\n\t\t// },\n\t\tmedia: {\n\t\t\ttransient: true,\n\t\t\tset: function(key, value, options, set) {\n\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\tvalue.forEach(function(o) {\n\t\t\t\t\t\to.bundle = this;\n\t\t\t\t\t}, this);\n\t\t\t\t\tvalue = new MediaCollection(value);\n\t\t\t\t}\n\t\t\t\tset(key, value, options);\n\t\t\t},\n\t\t},\n\t},\n\n\tinitialize: function(attrs, options) {\n\t\tthis.colors = {\n\t\t\tfgColor: new Color(this.attr(\"color\")),\n\t\t\tbgColor: new Color(this.attr(\"background-color\")),\n\t\t\tlnColor: new Color(this.attr(\"link-color\")),\n\t\t};\n\t\tthis.colors.hasDarkBg = this.colors.fgColor.luminosity() > this.colors.bgColor.luminosity();\n\t},\n\n\tattrs: function() {\n\t\treturn this._attrs || (this._attrs = _.defaults({}, this.get(\"attrs\"), attrsDefault));\n\t},\n});\n",
    "/**\n * @module app/model/item/KeywordItem\n * @requires module:app/model/BaseItem\n */\n\n/** @type {module:app/model/BaseItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n\n// /** @type {module:app/model/collection/TypeCollection} */\n// var types = require(\"app/model/collection/TypeCollection\");\n\n/**\n * @constructor\n * @type {module:app/model/item/KeywordItem}\n */\nmodule.exports = BaseItem.extend({\n\n\t_domPrefix: \"k\",\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tname: \"\",\n\t\thandle: \"\",\n\t\ttId: -1,\n\t},\n\n\t// mutators: {\n\t// \ttId: {\n\t// \t\tset: function (key, value, options, set) {\n\t// \t\t\tvar type = types.get(value);\n\t// \t\t\tif (type) {\n\t// \t\t\t\ttype.get(\"keywords\").push(this);\n\t// \t\t\t\tset(\"type\", type, options);\n\t// \t\t\t}\n\t// \t\t\tset(key, value, options);\n\t// \t\t}\n\t// \t},\n\t// }\n});\n",
    "/**\n * @module app/model/item/MediaItem\n * @requires module:backbone\n */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");/** @type {Function} */\nvar Color = require(\"color\");\n\n/** @type {module:app/model/item/SourceItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n/** @type {module:app/model/item/SourceItem} */\nvar SourceItem = require(\"app/model/item/SourceItem\");\n/** @type {module:app/model/SelectableCollection} */\nvar SelectableCollection = require(\"app/model/SelectableCollection\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/utils/strings/stripTags} */\nvar stripTags = require(\"utils/strings/stripTags\");\n// /** @type {module:app/model/parseSymAttrs} */\n// var parseSymAttrs = require(\"app/model/parseSymAttrs\");\n\n// console.log(Globals.PARAMS);\n\nvar urlTemplates = {\n\t\"original\": _.template(Globals.MEDIA_DIR + \"/<%= src %>\"),\n\t\"constrain-width\": _.template(Globals.APP_ROOT + \"image/1/<%= width %>/0/uploads/<%= src %>\"),\n\t\"constrain-height\": _.template(Globals.APP_ROOT + \"image/1/0/<%= height %>/uploads/<%= src %>\"),\n\t\"debug-bandwidth\": _.template(Globals.MEDIA_DIR.replace(/(https?\\:\\/\\/[^\\/]+)/, \"$1/slow/<%= kbps %>\") + \"/<%= src %>\"),\n};\n\n/**\n * @constructor\n * @type {module:app/model/item/MediaItem.SourceCollection}\n */\nvar SourceCollection = SelectableCollection.extend({\n\tmodel: SourceItem\n});\n\n/**\n * @constructor\n * @type {module:app/model/item/MediaItem}\n */\nmodule.exports = BaseItem.extend({\n\n\t_domPrefix: \"m\",\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tname: \"<p><em>Untitled</em></p>\",\n\t\tsub: \"\",\n\t\to: 0,\n\t\tbId: -1,\n\t\tsrcIdx: 0,\n\t\tget srcset() {\n\t\t\treturn [];\n\t\t},\n\t\tget sources() {\n\t\t\treturn new SourceCollection();\n\t\t},\n\t},\n\n\tgetters: [\"name\", \"bundle\", \"source\", \"sources\"],\n\n\tmutators: {\n\t\t// desc: function() {\n\t\t// \treturn this.get(\"name\");\n\t\t// },\n\t\thandle: function() {\n\t\t\treturn this.get(\"src\");\n\t\t},\n\t\ttext: function() {\n\t\t\tif (!this.hasOwnProperty(\"_text\"))\n\t\t\t\tthis._text = _.unescape(stripTags(this.get(\"name\")));\n\t\t\treturn this._text;\n\t\t},\n\t\tattrs: {\n\t\t\tset: function(key, value, opts, set) {\n\t\t\t\tthis._attrs = null;\n\t\t\t\tBaseItem.prototype.mutators.attrs.set.apply(this, arguments);\n\t\t\t\tthis._updateSources();\n\t\t\t}\n\t\t},\n\t\tsrcset: {\n\t\t\tset: function(key, value, opts, set) {\n\t\t\t\tset(key, value, opts);\n\t\t\t\tthis.get(\"sources\").reset(value, opts);\n\t\t\t\tthis._updateSources();\n\t\t\t}\n\t\t},\n\t\tsource: {\n\t\t\ttransient: true,\n\t\t\tget: function() {\n\t\t\t\treturn this.get(\"sources\").at(this.get(\"srcIdx\"));\n\t\t\t},\n\t\t},\n\t},\n\n\tinitialize: function() {\n\t\tthis._updateColors();\n\t\tthis.listenTo(this, \"change:attrs change:bundle\", function() {\n\t\t\tthis._attrs = null;\n\t\t});\n\t},\n\n\tattrs: function() {\n\t\treturn this._attrs || (this._attrs = _.defaults({}, this.get(\"bundle\").attrs(), this.get(\"attrs\")));\n\t},\n\n\t_updateColors: function() {\n\t\tthis.colors = {\n\t\t\tfgColor: new Color(this.attr(\"color\")),\n\t\t\tbgColor: new Color(this.attr(\"background-color\"))\n\t\t};\n\t\tthis.colors.hasDarkBg = this.colors.fgColor.luminosity() > this.colors.bgColor.luminosity();\n\t},\n\n\t_updateSources: function() {\n\t\tvar srcObj = {\n\t\t\tkbps: this.attr(\"@debug-bandwidth\")\n\t\t};\n\t\tvar srcTpl = urlTemplates[srcObj.kbps ? \"debug-bandwidth\" : \"original\"];\n\t\tthis.get(\"sources\").forEach(function(item) {\n\t\t\tsrcObj.src = item.get(\"src\");\n\t\t\titem.set(\"original\", srcTpl(srcObj));\n\t\t});\n\t},\n\n\t// _updateSourcesArr: function() {\n\t// \tvar srcset = this.get(\"srcset\");\n\t// \tif (Array.isArray(srcset)) {\n\t// \t\tvar srcObj = { kbps: this.attr(\"@debug-bandwidth\") };\n\t// \t\tvar srcTpl = Globals.MEDIA_SRC_TPL[srcObj.kbps? \"debug-bandwidth\" : \"original\"];\n\t// \t\tsrcset.forEach(function(o) {\n\t// \t\t\tsrcObj.src = o.src;\n\t// \t\t\to.original = srcTpl(srcObj);\n\t// \t\t}, this);\n\t// \t}\n\t// \tthis.get(\"sources\").reset(srcset);\n\t// },\n\n});\n",
    "/**\n * @module app/model/item/SourceItem\n * @requires module:backbone\n */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n// /** @type {module:app/control/Globals} */\n// var Globals = require(\"app/control/Globals\");\n/** @type {module:app/model/item/SourceItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n\n/** @type {String} */\nvar noCacheSuffix = \"?\" + Date.now();\n\n/**\n * @constructor\n * @type {module:app/model/item/SourceItem}\n */\n// module.exports = Backbone.Model.extend({\nmodule.exports = BaseItem.extend({\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tsrc: null,\n\t\tmime: null,\n\t\tw: null,\n\t\th: null,\n\t},\n\n\tgetters: [\"src\", \"original\"],\n\n\tmutators: {\n\t\tsrc: {\n\t\t\tset: function(key, value, options, set) {\n\t\t\t\tif (DEBUG) {\n\t\t\t\t\tvalue += noCacheSuffix;\n\t\t\t\t}\n\t\t\t\tset(key, value, options);\n\t\t\t}\n\t\t},\n\t\t// original: { \n\t\t// \ttransient: true,\n\t\t// \tget: function (key, value, options, set) {\n\t\t// \t\treturn this.attributes.original || (this.attributes.original = this._composeOriginalSrc());\n\t\t// \t},\n\t\t// },\n\t\t// media: {\n\t\t// \ttransient: true,\n\t\t// \tget: function () {\n\t\t// \t\tvar retval;\n\t\t// \t\tif (this._noRecusion) {\n\t\t// \t\t\tconsole.log(\"%s::media returning null\", this.cid);\n\t\t// \t\t\tretval = null;//this.id;\n\t\t// \t\t} else {\n\t\t// \t\t\tconsole.log(\"%s::media returning Object\", this.cid);\n\t\t// \t\t\tthis._noRecusion = true;\n\t\t// \t\t\tretval = this.attributes.media;\n\t\t// \t\t\tthis._noRecusion = false;\n\t\t// \t\t}\n\t\t// \t\treturn retval;\n\t\t// \t},\n\t\t// \tset: function (key, value, options, set) {\n\t\t// \t\tif (value instanceof BaseItem) {\n\t\t// \t\t\tset(key, value, options);\n\t\t// \t\t}\n\t\t// \t},\n\t\t// },\n\t},\n\n\t// initialize: function() {\n\t// \tif (DEBUG) {\n\t// \t\tvar cb = function() {\n\t// \t\t\t// console.log(\"@debug-bandwidth:\", JSON.stringify(this.get(\"media\").attr(\"@debug-bandwidth\")));\n\t// \t\t\tconsole.log(\"media:\", JSON.stringify(this.toJSON()));\n\t// \t\t\t// if ((this.get(\"media\") instanceof BaseItem) && this.get(\"media\").attr(\"@debug-bandwidth\")) {\n\t// \t\t\t// \tconsole.log(\"original\", this.get(\"original\"));\n\t// \t\t\t// \tconsole.log(\"media:\", JSON.stringify(this.get(\"media\").toJSON()));\n\t// \t\t\t// }\n\t// \t\t}.bind(this);\n\t// \t\twindow.requestAnimationFrame(cb);\n\t// \t}\n\t// },\n\t// \n\t// _composeOriginalSrc: function() {\n\t// \tvar values = { src: this.get(\"src\") };\n\t// \tif (this.has(\"media\") && (values.kbps = this.get(\"media\").attr(\"@debug-bandwidth\"))) {\n\t// \t// if (this.has(\"media\") && this.get(\"media\").attrs().hasOwnProperty(\"@debug-bandwidth\")) {\n\t// \t// \tvalues.kbps = this.get(\"media\").attrs()[\"@debug-bandwidth\"];\n\t// \t\treturn Globals.MEDIA_SRC_TPL[\"debug-bandwidth\"](values);\n\t// \t}\n\t// \treturn Globals.MEDIA_SRC_TPL[\"original\"](values);\n\t// },\n});\n",
    "/**\n * @module app/model/item/TypeItem\n */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:app/model/item/SourceItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n\n/**\n * @constructor\n * @type {module:app/model/item/TypeItem}\n */\nmodule.exports = BaseItem.extend({\n\n\t_domPrefix: \"t\",\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tname: \"\",\n\t\thandle: \"\",\n\t\t// get kIds() { return []; },\n\t\t// get keywords() { return []; },\n\t},\n\n});\n",
    "/**\n * @module app/view/AppView\n */\n\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n\n/** @type {module:app/utils/debug/traceArgs} */\nvar stripTags = require(\"utils/strings/stripTags\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/control/Controller} */\nvar controller = require(\"app/control/Controller\");\n/** @type {module:app/model/AppState} */\nvar AppState = require(\"app/model/AppState\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundles = require(\"app/model/collection/BundleCollection\");\n/** @type {module:app/model/collection/ArticleCollection} */\nvar articles = require(\"app/model/collection/ArticleCollection\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/NavigationView} */\nvar NavigationView = require(\"app/view/NavigationView\");\n/** @type {module:app/view/ContentView} */\nvar ContentView = require(\"app/view/ContentView\");\n\n\n/** @type {module:app/view/base/TouchManager} */\nvar TouchManager = require(\"app/view/base/TouchManager\");\n/** @type {module:hammerjs} */\nvar Hammer = require(\"hammerjs\");\n// /** @type {module:utils/touch/SmoothPanRecognizer} */\n// var Pan = require(\"utils/touch/SmoothPanRecognizer\");\n// /** @type {module:hammerjs.Tap} */\n// var Tap = Hammer.Tap;\n\n// /** @type {module:utils/debug/traceElement} */\n// var traceElement = require(\"utils/debug/traceElement\");\n//\n// var vpanLogFn = _.debounce(console.log.bind(console), 100, false);\n// var hpanLogFn = _.debounce(console.log.bind(console), 100, false);\n\n/**\n * @constructor\n * @type {module:app/view/AppView}\n */\nmodule.exports = View.extend({\n\n\t/** @override */\n\tcidPrefix: \"app\",\n\t/** @override */\n\tel: \"html\",\n\t// /** @override */\n\tclassName: \"app\", // without-bundle without-media without-article\",\n\t/** @override */\n\tmodel: AppState,\n\n\t/** @override */\n\tevents: {\n\t\t\"visibilitychange\": function(ev) {\n\t\t\tconsole.log(\"%s:[%s]\", this.cid, ev.type);\n\t\t},\n\t\t\"fullscreenchange\": function(ev) {\n\t\t\tconsole.log(\"%s:[%s] fullscreen: %o\", this.cid, ev.type, (document.fullscreenElement !== null), document.fullscreen);\n\t\t},\n\t\t\"dragstart\": function(ev) {\n\t\t\tif (ev.target.nodeName == \"IMG\" || ev.target.nodeName == \"A\") {\n\t\t\t\tev.defaultPrevented || ev.preventDefault();\n\t\t\t}\n\t\t},\n\t\t// \"touchmove body\": function(ev) {\n\t\t// \tev.defaultPrevented || ev.preventDefault();\n\t\t// },\n\t},\n\n\tproperties: {\n\t\tcontainer: {\n\t\t\tget: function() {\n\t\t\t\treturn this._container ||\n\t\t\t\t\t(this._container = document.getElementById(\"container\"));\n\t\t\t\t// (this._container = document.body);\n\t\t\t}\n\t\t},\n\t\tnavigation: {\n\t\t\tget: function() {\n\t\t\t\treturn this._navigation ||\n\t\t\t\t\t(this._navigation = document.getElementById(\"navigation\"));\n\t\t\t}\n\t\t},\n\t\tcontent: {\n\t\t\tget: function() {\n\t\t\t\treturn this._content ||\n\t\t\t\t\t(this._content = document.getElementById(\"content\"));\n\t\t\t}\n\t\t},\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t/* elements */\n\t\t// this.routeEl = this.el;\n\t\t// this.stateEl = this.el\n\t\tthis.breakpointEl = this.el;\n\n\t\t/* init HammerJS handlers */\n\t\tvar vtouch, htouch, touchEl;\n\t\t// var vpan, hpan, tap;\n\n\t\t// this._vpanEnableFn = function(mc, ev) {\n\t\t// \tvar retval = !this._hasOverflowY(this.container);\n\t\t// \tvpanLogFn(\"%s::_vpanEnableFn -> %o\\n%o\", this.cid, retval, arguments);\n\t\t// \treturn retval;\n\t\t// }.bind(this);\n\t\t//\n\t\t// this._hpanEnableFn = function(mc, ev) {\n\t\t// \tvar retval = this.model.get(\"withBundle\") && this.model.get(\"collapsed\");\n\t\t// \thpanLogFn(\"%s::_hpanEnableFn -> %o\\n%o\", this.cid, retval, arguments);\n\t\t// \treturn !!retval;\n\t\t// }.bind(this);\n\n\t\ttouchEl = this.content;\n\t\t// touchEl = document.body;\n\t\tvtouch = htouch = TouchManager.init(touchEl);\n\n\t\t// vtouch.get(\"vpan\").set({ enable: this._vpanEnableFn });\n\t\t// htouch.get(\"hpan\").set({ enable: this._hpanEnableFn });\n\t\t// \t\tvtouch.set({\n\t\t// \t\t\tenable: function() {\n\t\t// \t\t\t\tconsole.log(\"app1::hammerjs enable\", arguments);\n\t\t// \t\t\t\treturn true;\n\t\t// \t\t\t}\n\t\t// \t\t});\n\t\t// hpan = vpan;\n\n\t\t// this.el.style.touchAction = \"none\"; //\"pan-x pan-y\";\n\n\t\t// tap = new Hammer.Tap();\n\t\t// hpan = new Pan({\n\t\t// \tevent: \"hpan\",\n\t\t// \tdirection: Hammer.DIRECTION_HORIZONTAL\n\t\t// });\n\t\t// hpan.set({\n\t\t// \tenable: this._hpanEnableFn\n\t\t// });\n\t\t// vpan = new Pan({\n\t\t// \tevent: \"vpan\",\n\t\t// \tdirection: Hammer.DIRECTION_VERTICAL\n\t\t// });\n\t\t// vpan.set({\n\t\t// \tenable: this._vpanEnableFn\n\t\t// });\n\t\t// hpan.requireFailure(vpan);\n\t\t// vpan.requireFailure(hpan);\n\t\t// vtouch.add([]);\n\n\t\t// htouch = vtouch = new Hammer.Manager(this.content);\n\t\t// htouch.add([tap, hpan, vpan]);\n\t\t// htouch.add([hpan, vpan]);\n\t\t// htouch.set({ touchAction: \"pan-x pan-y\" });\n\n\t\t// vpan = new Hammer(this.navigation, {\n\t\t// \trecognizers: [\n\t\t// \t\t[Pan, {\n\t\t// \t\t\tevent: 'vpan',\n\t\t// \t\t\ttouchAction: \"pan-y\",\n\t\t// \t\t\tdirection: Hammer.DIRECTION_VERTICAL,\n\t\t// \t\t\tenable: vpanEnableFn\n\t\t// \t\t}],\n\t\t// \t]\n\t\t// });\n\t\t// hpan = new Hammer(this.content, {\n\t\t// \trecognizers: [\n\t\t// \t\t[Pan, {\n\t\t// \t\t\tevent: 'hpan',\n\t\t// \t\t\ttouchAction: \"pan-x\",\n\t\t// \t\t\tdirection: Hammer.DIRECTION_HORIZONTAL,\n\t\t// \t\t\tenable: hpanEnableFn\n\t\t// \t\t}],\n\t\t// \t\t[Tap]\n\t\t// \t]\n\t\t// });\n\t\t// hpan.get(\"hpan\").requireFailure(vpan.get(\"vpan\"));\n\n\t\t// this._afterRender = this._afterRender.bind(this);\n\t\tthis._onResize = this._onResize.bind(this);\n\n\t\t/* render on resize, onorientationchange, visibilitychange */\n\t\t// window.addEventListener(\"orientationchange\", this._onResize, false);\n\t\t// window.addEventListener(\"resize\", _.debounce(this._onResize.bind(this), 30, false), false);\n\t\twindow.addEventListener(\"resize\", this._onResize, false);\n\n\t\t// var h = function(ev) { console.log(ev.type, ev) };\n\t\t// window.addEventListener(\"scroll\", h, false);\n\t\t// window.addEventListener(\"wheel\", h, false);\n\n\t\t/* TODO: replace resize w/ mediaquery listeners. Caveat: some components\n\t\t(vg. Carousel) require update on resize */\n\t\t// this._onBreakpointChange = this._onBreakpointChange.bind(this);\n\t\t// Object.keys(Globals.BREAKPOINTS).forEach(function(s) {\n\t\t// \tGlobals.BREAKPOINTS[s].addListeners(this._onBreakpointChange);\n\t\t// }, this);\n\n\n\t\t/* initialize controller/model listeners BEFORE views register their own */\n\t\tthis.listenTo(controller, \"route\", this._onRoute);\n\t\t// this.listenTo(controller, \"change:after\", this._afterControllerChanged);\n\t\tthis.listenTo(this.model, \"change\", this._onModelChange); /* FIXME */\n\n\t\t/* initialize views */\n\t\tthis.navigationView = new NavigationView({\n\t\t\tel: this.navigation,\n\t\t\tmodel: this.model,\n\t\t\tvpan: vtouch,\n\t\t\thpan: htouch\n\t\t});\n\n\t\tthis.contentView = new ContentView({\n\t\t\tel: this.content,\n\t\t\tmodel: this.model,\n\t\t\tvpan: vtouch,\n\t\t\thpan: htouch,\n\t\t});\n\n\t\t/* TouchEvents fixups\n\t\t * ------------------------------- */\n\t\tvar traceTouchEvent = function(msg, traceObj) {\n\t\t\tif (msg.hasOwnProperty(\"type\")) {\n\t\t\t\tmsg = msg.type + \" : \" +\n\t\t\t\t\t(msg.defaultPrevented ? \"prevented\" : \"not prevented\");\n\t\t\t}\n\t\t\tvar sy, sh, ch;\n\t\t\tsy = this.el.scrollTop;\n\t\t\tsh = this.el.scrollHeight - 1;\n\t\t\tch = this.el.clientHeight;\n\t\t\tconsole.log(\"%s:[%s] \" +\n\t\t\t\t\"sy:[1>%o>=%s = %o] \" +\n\t\t\t\t\"sh:[%o<=%o = %o] \" +\n\t\t\t\t\"nav:[css:%o val:%o]\",\n\t\t\t\tthis.cid, msg,\n\t\t\t\tsy, sh - ch, (1 <= sy <= (sh - ch)),\n\t\t\t\tsh, ch, (sh <= ch),\n\t\t\t\tthis.navigationView.el.style.height,\n\t\t\t\tthis.navigationView.el.scrollHeight,\n\t\t\t\ttraceObj || \"\"\n\t\t\t);\n\t\t}.bind(this);\n\n\n\t\t// var scrolltouch = new Hammer.Manager(this.el);\n\t\t// scrolltouch.add(new Hammer.Pan({ direction: Hammer.DIRECTION_VERTICAL, threshold: 0 }));\n\t\t// scrolltouch.on(\"panmove\", function(ev) {\n\t\t//\n\t\t// \t// var sy, sh, ch;\n\t\t// \t// sy = this.el.scrollTop;\n\t\t// \t// sh = this.el.scrollHeight - 1;\n\t\t// \t// ch = this.el.clientHeight;\n\t\t// \t//\n\t\t// \t// if ((1 > sy) && (ev.direction | Hammer.DIRECTION_DOWN)) {\n\t\t// \t// \tev.preventDefault();\n\t\t// \t// \tconsole.log(\"%s:[panmove] %s\", this.cid, \"prevent at top\");\n\t\t// \t// } else\n\t\t// \t// if ((sy > (sh - ch)) && (ev.direction | Hammer.DIRECTION_UP)) {\n\t\t// \t// \tev.preventDefault();\n\t\t// \t// \tconsole.log(\"%s:[panmove] %s\", this.cid, \"prevent at bottom\");\n\t\t// \t// }\n\t\t// \tif ((this.el.scrollHeight - 1) <= this.el.clientHeight) {\n\t\t// \t\tev.srcEvent.preventDefault();\n\t\t// \t}\n\t\t// \t// traceTouchEvent(ev);\n\t\t// }.bind(this));\n\n\t\tvar touchOpts = { capture: false, passive: false };\n\t\tvar onTouchStart = function(ev) {\n\t\t\tthis.el.addEventListener(\"touchmove\", onTouchMove, touchOpts);\n\t\t\tthis.el.addEventListener(\"touchend\", onTouchEnd, touchOpts);\n\t\t\tthis.el.addEventListener(\"touchcancel\", onTouchEnd, touchOpts);\n\t\t}.bind(this);\n\n\t\tvar onTouchMove = function(ev) {\n\t\t\tif (!ev.defaultPrevented && (this.el.scrollHeight - 1) <= this.el.clientHeight) {\n\t\t\t\tev.preventDefault();\n\t\t\t}\n\t\t\t//traceTouchEvent(ev);\n\t\t}.bind(this);\n\n\t\tvar onTouchEnd = function(ev) {\n\t\t\tthis.el.removeEventListener(\"touchmove\", onTouchMove, touchOpts);\n\t\t\tthis.el.removeEventListener(\"touchend\", onTouchEnd, touchOpts);\n\t\t\tthis.el.removeEventListener(\"touchcancel\", onTouchEnd, touchOpts);\n\t\t}.bind(this);\n\n\t\tthis.el.addEventListener(\"touchstart\", onTouchStart);\n\n\t\tvar onMeasured = function(view) {\n\t\t\tthis.requestAnimationFrame(function() {\n\t\t\t\tif ((this.el.scrollHeight - 1) <= this.el.clientHeight) {\n\t\t\t\t\tthis.el.style.overflowY = \"hidden\";\n\t\t\t\t} else {\n\t\t\t\t\tthis.el.style.overflowY = \"\";\n\t\t\t\t}\n\t\t\t\tthis.el.scrollTop = 1;\n\t\t\t\t//traceTouchEvent(\"view:collapsed:measured\");\n\t\t\t});\n\t\t};\n\t\tthis.listenTo(this.navigationView, \"view:collapsed:measured\", onMeasured);\n\n\n\t\t/* Google Analytics\n\t\t * ------------------------------- */\n\t\tif (window.ga && window.GA_ID) {\n\t\t\tcontroller\n\t\t\t\t.once(\"route\", function() {\n\t\t\t\t\twindow.ga(\"create\", window.GA_ID, \"auto\");\n\t\t\t\t\t// if localhost or dummy ID, disable analytics\n\t\t\t\t\tif (/(?:(localhost|\\.local))$/.test(location.hostname)\n\t\t\t\t\t\t|| window.GA_ID == \"UA-9123564-8\") {\n\t\t\t\t\t\twindow.ga(\"set\", \"sendHitTask\", null);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.on(\"route\", function(name) {\n\t\t\t\t\tvar page = Backbone.history.getFragment();\n\t\t\t\t\t// Add a slash if neccesary\n\t\t\t\t\tpage.replace(/^(?!\\/)/, \"/\");\n\t\t\t\t\twindow.ga(\"set\", \"page\", page);\n\t\t\t\t\twindow.ga(\"send\", \"pageview\");\n\t\t\t\t});\n\t\t}\n\n\t\t/* Startup listener, added last */\n\t\tthis.listenToOnce(controller, \"route\", this._appStart);\n\n\t\t/* start router, which will request appropiate state */\n\t\tBackbone.history.start({\n\t\t\tpushState: false,\n\t\t\thashChange: true,\n\t\t});\n\t},\n\n\t/* -------------------------------\n\t/* _appStart\n\t/* ------------------------------- */\n\n\t_appStart: function(name, args) {\n\t\tconsole.info(\"%s::_appStart(%s, %s)\", this.cid, name, args.join());\n\t\tthis.skipTransitions = true;\n\t\tthis.el.classList.add(\"skip-transitions\");\n\n\t\tthis.requestRender(View.MODEL_INVALID | View.SIZE_INVALID)\n\t\t\t.requestChildrenRender(View.MODEL_INVALID | View.SIZE_INVALID)\n\t\t\t.listenToOnce(this, \"view:render:after\", function(view, flags) {\n\t\t\t\t// this.setImmediate(function() {\n\t\t\t\tthis.requestAnimationFrame(function() {\n\t\t\t\t\tconsole.log(\"%s::_appStart[view:render:after][raf]\", this.cid);\n\t\t\t\t\tthis.skipTransitions = false;\n\t\t\t\t\tthis.el.classList.remove(\"skip-transitions\");\n\t\t\t\t\tthis.el.classList.remove(\"app-initial\");\n\t\t\t\t});\n\t\t\t});\n\t},\n\n\t/* --------------------------- *\n\t/* route changed\n\t/* --------------------------- */\n\n\t_onRoute: function(name, args) {\n\t\tconsole.info(\"%s::_onRoute %o -> %o\", this.cid, this.model.get(\"routeName\"), name);\n\t\t// var o = _.defaults({ routeName: name }, AppState.prototype.defaults);\n\t\tvar o = {\n\t\t\trouteName: name,\n\t\t\tbundle: null,\n\t\t\tmedia: null,\n\t\t\tarticle: null\n\t\t};\n\t\tswitch (name) {\n\t\t\tcase \"media-item\":\n\t\t\t\to.bundle = bundles.selected;\n\t\t\t\t// o.withBundle = true;\n\t\t\t\to.media = o.bundle.media.selected;\n\t\t\t\t// o.withMedia = true;\n\t\t\t\to.collapsed = true;\n\t\t\t\tbreak;\n\t\t\tcase \"bundle-item\":\n\t\t\t\to.bundle = bundles.selected;\n\t\t\t\t// o.withBundle = true;\n\t\t\t\to.collapsed = true;\n\t\t\t\tbreak;\n\t\t\tcase \"article-item\":\n\t\t\t\to.article = articles.selected;\n\t\t\t\t// o.withArticle = true;\n\t\t\t\to.collapsed = true;\n\t\t\t\tbreak;\n\t\t\tcase \"bundle-list\":\n\t\t\tcase \"notfound\":\n\t\t\tcase \"root\":\n\t\t\tdefault:\n\t\t\t\to.collapsed = false;\n\t\t\t\tbreak;\n\t\t}\n\t\t// console.log(\"%s::_onRoute args: %o\", this.cid, name, args);\n\t\tthis.model.set(o);\n\t},\n\n\t/* --------------------------- *\n\t/* model changed\n\t/* --------------------------- */\n\n\t_onModelChange: function() {\n\t\tif (DEBUG) {\n\t\t\tconsole.groupCollapsed(this.cid + \"::_onModelChange\");\n\t\t\tconsole.groupCollapsed(\"changes\");\n\t\t\tObject.keys(this.model.changedAttributes()).forEach(function(key) {\n\t\t\t\tconsole.info(\"%s::_onModelChange %s: %s -> %s\", this.cid, key,\n\t\t\t\t\tthis.model.previous(key),\n\t\t\t\t\tthis.model.get(key));\n\t\t\t}, this);\n\n\t\t\t[\"Article\", \"Bundle\", \"Media\"].forEach(function(name) {\n\t\t\t\tvar key = name.toLowerCase();\n\t\t\t\tconsole[this.hasChanged(\"with\" + name) == this.hasAnyChanged(key) ? \"log\" : \"warn\"].call(console, \"%s::_onModelChange with%s: %o with%sChanged: %o\", this.cid,\n\t\t\t\t\tname, this.has(key),\n\t\t\t\t\tname, this.hasAnyChanged(key)\n\t\t\t\t);\n\t\t\t}, this.model);\n\t\t\tconsole.groupEnd();\n\n\t\t\tthis.once(\"view:render:after\", function(view, flags) {\n\t\t\t\tconsole.info(\"%s::_onModelChange [view:render:after]\", view.cid);\n\t\t\t\tconsole.groupEnd();\n\t\t\t});\n\t\t}\n\n\t\tthis.requestRender(View.MODEL_INVALID);\n\t\t// this.requestChildrenRender(View.MODEL_INVALID);\n\t},\n\n\t/* -------------------------------\n\t/* resize\n\t/* ------------------------------- */\n\n\t_onResize: function(ev) {\n\t\tconsole.group(this.cid + \"::_onResize [event]\");\n\t\tthis.skipTransitions = true;\n\t\tthis.el.classList.add(\"skip-transitions\");\n\n\t\tthis.requestRender(View.SIZE_INVALID)\n\t\t\t// .whenRendered().then(function(view) {\n\t\t\t.once(\"view:render:after\", function(view, flags) {\n\t\t\t\t// this.requestChildrenRender(View.SIZE_INVALID, true);\n\t\t\t\t// this.setImmediate(function() {\n\t\t\t\tthis.requestAnimationFrame(function() {\n\t\t\t\t\tconsole.info(\"%s::_onResize [view:render:after][raf]\", view.cid);\n\t\t\t\t\tview.skipTransitions = false;\n\t\t\t\t\tview.el.classList.remove(\"skip-transitions\");\n\t\t\t\t\tthis.el.scrollTop = 1;\n\t\t\t\t\tconsole.groupEnd();\n\t\t\t\t})\n\t\t\t});\n\t\tif (document.fullscreenElement === null) this.renderNow();\n\t},\n\n\t/* -------------------------------\n\t/* render\n\t/* ------------------------------- */\n\n\trenderFrame: function(tstamp, flags) {\n\t\tconsole.log(\"%s::renderFrame [%s]\", this.cid, View.flagsToString(flags));\n\n\t\t/* model: set route & model id classes */\n\t\tif (flags & View.MODEL_INVALID) {\n\t\t\tthis.renderModelChange(flags);\n\t\t}\n\n\t\t/* size: check breakpoints and set classes*/\n\t\tif (flags & View.SIZE_INVALID) {\n\t\t\t_.each(Globals.BREAKPOINTS, function(o, s) {\n\t\t\t\tthis.toggle(s, o.matches);\n\t\t\t}, this.breakpointEl.classList);\n\t\t}\n\t\t/* request children render:  always render now */\n\t\tthis.requestChildrenRender(flags, true);\n\t\t/* request children render:  set 'now' flag if size is invalid */\n\t\t// this.requestChildrenRender(flags, flags & View.SIZE_INVALID);\n\n\t\t// if ((this.el.scrollHeight - 1) <= this.el.clientHeight) {\n\t\t// \tthis.el.scrollTop = 1;\n\t\t// \tthis.el.style.overflowY = \"hidden\";\n\t\t// } else {\n\t\t// \tthis.el.style.overflowY = \"\";\n\t\t// }\n\t\t// this.navigationView.whenRendered().then(function(view) {\n\t\t// \tthis.requestAnimationFrame(function() {\n\t\t// \t\tconsole.log(\"%s::renderFrame [raf] css:%o val:%o\",\n\t\t// \t\t\tthis.cid,\n\t\t// \t\t\tthis.navigationView.el.style.height,\n\t\t// \t\t\tthis.navigationView.el.scrollHeight,\n\t\t// \t\t\tthis.el.scrollTop,\n\t\t// \t\t\tthis.el.scrollHeight - 1,\n\t\t// \t\t\tthis.el.clientHeight,\n\t\t// \t\t\t(this.el.scrollHeight - 1) <= this.el.clientHeight,\n\t\t// \t\t\tthis.el.style.overflowY\n\t\t// \t\t);\n\t\t// \t});\n\t\t// }.bind(this));\n\t},\n\n\t/* -------------------------------\n\t/* body classes etc\n\t/* ------------------------------- */\n\n\trenderModelChange: function() {\n\n\t\tvar cls = this.el.classList;\n\t\tvar prevAttr = null;\n\t\tvar docTitle = [];\n\t\tvar hasDarkBg = false;\n\n\t\tdocTitle.push(Globals.APP_NAME);\n\t\tif (this.model.get(\"bundle\")) {\n\t\t\tdocTitle.push(stripTags(this.model.get(\"bundle\").get(\"name\")));\n\t\t\tif (this.model.get(\"media\")) {\n\t\t\t\tdocTitle.push(stripTags(this.model.get(\"media\").get(\"name\")));\n\t\t\t}\n\t\t} else if (this.model.get(\"article\")) {\n\t\t\tdocTitle.push(stripTags(this.model.get(\"article\").get(\"name\")));\n\t\t}\n\t\tdocument.title = _.unescape(docTitle.join(\" / \"));\n\n\t\t/* Set route class */\n\t\tif (this.model.hasChanged(\"routeName\")) {\n\n\t\t\tprevAttr = this.model.previous(\"fromRouteName\");\n\t\t\tif (prevAttr) {\n\t\t\t\tcls.remove(\"from-route-\" + prevAttr);\n\t\t\t}\n\t\t\tcls.add(\"from-route-\" + this.model.get(\"fromRouteName\"));\n\n\t\t\tprevAttr = this.model.previous(\"routeName\");\n\t\t\tif (prevAttr) {\n\t\t\t\tcls.remove(\"route-\" + prevAttr);\n\t\t\t\t// this.el.setAttribute(\"from-route\", prevAttr);\n\t\t\t}\n\t\t\t// this.el.setAttribute(\"to-route\", this.model.get(\"routeName\"));\n\t\t\tcls.add(\"route-\" + this.model.get(\"routeName\"));\n\t\t}\n\n\t\t/* Set model id classes for color styles */\n\t\t[\"article\", \"bundle\", \"media\"].forEach(function(prop) {\n\t\t\tvar item = this.model.get(prop);\n\t\t\tif (this.model.hasChanged(prop)) {\n\t\t\t\tprevAttr = this.model.previous(prop);\n\t\t\t\tif (prevAttr) {\n\t\t\t\t\tcls.remove(prevAttr.get(\"domid\"));\n\t\t\t\t}\n\t\t\t\tif (item) {\n\t\t\t\t\tcls.add(item.get(\"domid\"));\n\t\t\t\t}\n\t\t\t}\n\t\t\tcls.toggle(\"with-\" + prop, !!item);\n\t\t\tcls.toggle(\"without-\" + prop, !item);\n\t\t\thasDarkBg |= (item && item.colors && item.colors.hasDarkBg);\n\t\t}.bind(this));\n\n\t\t/* flag dark background */\n\t\tcls.toggle(\"color-dark\", hasDarkBg);\n\t},\n}, {\n\tgetInstance: function() {\n\t\tif (!(window.app instanceof this)) {\n\t\t\twindow.app = new(this)({\n\t\t\t\tmodel: new AppState()\n\t\t\t});\n\t\t}\n\t\treturn window.app;\n\t}\n});\n\nif (DEBUG) {\n\tmodule.exports = (function(AppView) {\n\t\t/** @type {module:app/debug/DebugToolbar} */\n\t\tvar DebugToolbar = require(\"app/debug/DebugToolbar\");\n\n\t\treturn AppView.extend({\n\t\t\tinitialize: function() {\n\t\t\t\tvar retval;\n\t\t\t\tvar view = new DebugToolbar({\n\t\t\t\t\tid: \"debug-toolbar\",\n\t\t\t\t\tmodel: this.model\n\t\t\t\t});\n\t\t\t\tdocument.body.appendChild(view.render().el);\n\t\t\t\tretval = AppView.prototype.initialize.apply(this, arguments);\n\t\t\t\tthis._logFlags[\"view.trace\"] = true;\n\t\t\t\tthis.navigationView._logFlags[\"view.trace\"] = true;\n\t\t\t\treturn retval;\n\t\t\t},\n\t\t})\n\t})(module.exports);\n}\n",
    "/**\n * @module app/view/ContentView\n */\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:utils/TransformHelper} */\nvar TransformHelper = require(\"utils/TransformHelper\");\n// /** @type {module:app/view/base/TouchManager} */\n// var TouchManager = require(\"app/view/base/TouchManager\");\n\n/** @type {module:app/control/Controller} */\nvar controller = require(\"app/control/Controller\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundles = require(\"app/model/collection/BundleCollection\");\n/** @type {module:app/model/collection/ArticleCollection} */\nvar articles = require(\"app/model/collection/ArticleCollection\");\n\n// /** @type {module:app/model/collection/BundleItem} */\n// var BundleItem = require(\"app/model/item/BundleItem\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/component/ArticleView} */\nvar ArticleView = require(\"app/view/component/ArticleView\");\n/** @type {module:app/view/component/CollectionStack} */\nvar CollectionStack = require(\"app/view/component/CollectionStack\");\n/** @type {module:app/view/component/CollectionStack} */\nvar SelectableListView = require(\"app/view/component/SelectableListView\");\n/** @type {module:app/view/render/DotNavigationRenderer} */\nvar DotNavigationRenderer = require(\"app/view/render/DotNavigationRenderer\");\n/** @type {module:app/view/component/Carousel} */\nvar Carousel = require(\"app/view/component/Carousel\");\n\n/** @type {module:app/view/render/CarouselRenderer} */\nvar CarouselRenderer = require(\"app/view/render/CarouselRenderer\");\n/** @type {module:app/view/render/ImageRenderer} */\nvar ImageRenderer = require(\"app/view/render/ImageRenderer\");\n/** @type {module:app/view/render/VideoRenderer} */\nvar VideoRenderer = require(\"app/view/render/VideoRenderer\");\n/** @type {module:app/view/render/SequenceRenderer} */\nvar SequenceRenderer = require(\"app/view/render/SequenceRenderer\");\n// /** @type {module:app/view/component/CanvasProgressMeter} */\n// var ProgressMeter = require(\"app/view/component/CanvasProgressMeter\");\n\n/** @type {Function} */\nvar carouselEmptyTemplate = require(\"./template/Carousel.EmptyRenderer.Bundle.hbs\");\n/** @type {Function} */\nvar mediaStackTemplate = require(\"./template/CollectionStack.Media.hbs\");\n\n// var transitionEnd = View.prefixedEvent(\"transitionend\");\nvar transformProp = View.prefixedProperty(\"transform\");\nvar transitionProp = View.prefixedProperty(\"transition\");\n\nvar tx = Globals.transitions;\n\n\n// var clickEvent = window.hasOwnProperty(\"onpointerup\") ? \"pointerup\" : \"mouseup\",\n\n/**\n * @constructor\n * @type {module:app/view/ContentView}\n */\nmodule.exports = View.extend({\n\n\t/** @override */\n\tcidPrefix: \"contentView\",\n\n\t/** @override */\n\tclassName: \"container-expanded\",\n\n\t/** @override */\n\tevents: {\n\t\t\"transitionend .adding-child\": \"_onAddedTransitionEnd\",\n\t\t\"transitionend .removing-child\": \"_onRemovedTransitionEnd\",\n\t\t// \"transitionend\": \"_onTransitionEnd\",\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t_.bindAll(this, \"_onVPanStart\", \"_onVPanMove\", \"_onVPanFinal\", \"_onCollapsedEvent\");\n\n\t\tthis.transforms = new TransformHelper();\n\t\t// this.touch = options.touch || new Error(\"no touch\"); //TouchManager.getInstance();\n\t\tthis.vpan = options.vpan || new Error(\"no vpan\");\n\t\tthis.hpan = options.hpan || new Error(\"no hpan\");\n\n\t\tthis.listenTo(this.model, \"change\", this._onModelChange);\n\n\t\t// disconnect children before last change\n\t\t// this.listenTo(bundles, \"deselect:one\", this._onDeselectOneBundle);\n\n\t\tthis.skipTransitions = true;\n\t\tthis.itemViews = [];\n\n\t\t// this.progressWrapper = this.createProgressWrapper(),\n\t\t// this.el.appendChild(this.progressWrapper.el);\n\t},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\trenderFrame: function(tstamp, flags) {\n\t\t// values\n\t\tvar collapsed = this.model.get(\"collapsed\");\n\t\tvar collapsedChanged = (flags & View.MODEL_INVALID)\n\t\t\t&& this.model.hasChanged(\"collapsed\");\n\t\tvar childrenChanged = (flags & View.MODEL_INVALID)\n\t\t\t&& (this.model.hasChanged(\"bundle\") || this.model.hasChanged(\"article\"));\n\n\t\t// flags\n\t\tvar sizeChanged = !!(flags & View.SIZE_INVALID);\n\t\tvar transformsChanged = !!(flags & (View.MODEL_INVALID | View.SIZE_INVALID | View.LAYOUT_INVALID));\n\t\ttransformsChanged = transformsChanged || this._transformsChanged || this.skipTransitions;\n\n\t\t// debug\n\t\t// - - - - - - - - - - - - - - - - -\n\t\t// if (flags & View.MODEL_INVALID) {\n\t\t// \tconsole.group(this.cid + \"::renderFrame model changed:\");\n\t\t// \tObject.keys(this.model.changed).forEach(function(key) {\n\t\t// \t\tconsole.log(\"\\t%s: %s -> %s\", key, this.model._previousAttributes[key], this.model.changed[key]);\n\t\t// \t}, this);\n\t\t// \tconsole.groupEnd();\n\t\t// }\n\n\t\t// model:children\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tif (childrenChanged) {\n\t\t\tthis.removeChildren();\n\t\t\tif (bundles.selected) {\n\t\t\t\tthis.createChildren(bundles.selected);\n\t\t\t} else\n\t\t\tif (articles.selected) {\n\t\t\t\tthis.createChildren(articles.selected);\n\t\t\t}\n\t\t}\n\n\t\t// model:collapsed\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tif (collapsedChanged) {\n\t\t\tthis.el.classList.toggle(\"container-collapsed\", collapsed);\n\t\t\tthis.el.classList.toggle(\"container-expanded\", !collapsed);\n\t\t}\n\n\t\t// size\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tif (sizeChanged) {\n\t\t\tthis.transforms.clearAllCaptures();\n\t\t}\n\n\t\t// transforms\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tif (transformsChanged) {\n\t\t\tthis.el.classList.remove(\"container-changing\");\n\t\t\tif (this.skipTransitions) {\n\t\t\t\tthis.transforms.stopAllTransitions();\n\t\t\t\tthis.el.classList.remove(\"container-changed\");\n\t\t\t\tif (!childrenChanged) {\n\t\t\t\t\t// this.transforms.clearAllOffsets();\n\t\t\t\t\tif (collapsedChanged) {\n\t\t\t\t\t\tthis._setChildrenEnabled(collapsed);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!childrenChanged) {\n\t\t\t\t\tif (collapsedChanged) {\n\t\t\t\t\t\tvar afterTransitionsFn;\n\t\t\t\t\t\tthis.el.classList.add(\"container-changed\");\n\t\t\t\t\t\t// this.transforms.clearAllOffsets();\n\t\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\t\t// container-collapsed, enable last\n\t\t\t\t\t\t\tafterTransitionsFn = function() {\n\t\t\t\t\t\t\t\tthis._setChildrenEnabled(true);\n\t\t\t\t\t\t\t\tthis.el.classList.remove(\"container-changed\");\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tthis.transforms.runAllTransitions(tx.LAST);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// container-expanded, disable first\n\t\t\t\t\t\t\tafterTransitionsFn = function() {\n\t\t\t\t\t\t\t\tthis.el.classList.remove(\"container-changed\");\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tthis._setChildrenEnabled(false);\n\t\t\t\t\t\t\tthis.transforms.runAllTransitions(tx.FIRST);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tafterTransitionsFn = afterTransitionsFn.bind(this);\n\t\t\t\t\t\tthis.transforms.whenAllTransitionsEnd().then(afterTransitionsFn, afterTransitionsFn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.transforms.items.forEach(function(o) {\n\t\t\t\t\t\t\tif (o.hasOffset) {\n\t\t\t\t\t\t\t\to.runTransition(tx.NOW);\n\t\t\t\t\t\t\t\t// o.clearOffset();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!childrenChanged) {\n\t\t\t\tthis.transforms.clearAllOffsets();\n\t\t\t}\n\t\t\tthis.transforms.validate();\n\t\t}\n\t\tif (sizeChanged) {\n\t\t\tthis.itemViews.forEach(function(view) {\n\t\t\t\tview.skipTransitions = this.skipTransitions;\n\t\t\t\tview.requestRender(View.SIZE_INVALID).renderNow();\n\t\t\t}, this);\n\t\t\t/*Promise.all(this.itemViews.map(function(view) {\n\t\t\t\t\tview.skipTransitions = this.skipTransitions;\n\t\t\t\t\treturn view.requestRender(View.SIZE_INVALID).whenRendered();\n\t\t\t\t}, this))\n\t\t\t\t.then(\n\t\t\t\t\tfunction(views) {\n\t\t\t\t\t\tvar nh = this.el.offsetParent.offsetHeight - this.el.offsetTop;\n\t\t\t\t\t\t// var oh = views.reduce(function(h, view) {\n\t\t\t\t\t\t// \treturn Math.max(h, view.el.offsetHeight);\n\t\t\t\t\t\t// }, nh);\n\t\t\t\t\t\t// oh++;\n\t\t\t\t\t\t// console.log(\"%s:[whenRendered] [result: %s %s] %o\", this.cid,\n\t\t\t\t\t\t// \tnh, oh, this.el.parent, views);\n\t\t\t\t\t\tthis.el.style.minHeight = nh + \"px\";\n\t\t\t\t\t\treturn views;\n\t\t\t\t\t}.bind(this),\n\t\t\t\t\tfunction(reason) {\n\t\t\t\t\t\tconsole.warn(\"%s:[whenRendered] [rejected] %o\", this.cid, reason);\n\t\t\t\t\t\treturn reason;\n\t\t\t\t\t}.bind(this)\n\t\t\t\t);*/\n\t\t}\n\t\tthis.skipTransitions = this._transformsChanged = false;\n\t},\n\n\t_setChildrenEnabled: function(enabled) {\n\t\t// if (enabled) {\n\t\t// \tthis.el.removeEventListener(\"click\", this._onCollapsedClick, false);\n\t\t// } else {\n\t\t// \tthis.el.addEventListener(\"click\", this._onCollapsedClick, false);\n\t\t// }\n\t\tthis.itemViews.forEach(function(view) {\n\t\t\tview.setEnabled(enabled);\n\t\t});\n\t},\n\n\t/* -------------------------------\n\t/* Collapse UI gestures/events\n\t/* ------------------------------- */\n\n\t_onCollapsedEvent: function(ev) {\n\t\tconsole.log(\"%s:[%s -> _onCollapsedEvent] target: %s\", this.cid, ev.type, ev.target);\n\t\tif (!ev.defaultPrevented &&\n\t\t\tthis.model.has(\"bundle\") &&\n\t\t\t!this.model.get(\"collapsed\") &&\n\t\t\t!this.enabled) {\n\t\t\t// this.setImmediate(function() {\n\t\t\t// if (ev.type == \"click\") ev.stopPropagation();\n\t\t\tev.preventDefault();\n\t\t\tthis.setImmediate(function() {\n\t\t\t\t// if (ev.type == \"click\") ev.stopPropagation();\n\t\t\t\tthis.model.set(\"collapsed\", true);\n\t\t\t});\n\t\t\t// });\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* model changed\n\t/* --------------------------- */\n\n\t_onModelChange: function() {\n\t\tif (this.model.hasAnyChanged(\"bundle\")) {\n\t\t\tif (this.model.has(\"bundle\")) {\n\t\t\t\tthis.vpan.on(\"vpanstart\", this._onVPanStart);\n\t\t\t} else {\n\t\t\t\tthis.vpan.off(\"vpanstart\", this._onVPanStart);\n\t\t\t}\n\t\t}\n\t\t/*\n\t\tif (this.model.hasChanged(\"withBundle\") ||\n\t\t\tthis.model.hasChanged(\"collapsed\")) {\n\t\t\tif (this.model.get(\"withBundle\") &&\n\t\t\t\t!this.model.get(\"collapsed\")) {\n\t\t\t\tthis.hpan.on(\"hpanleft hpanright\", this._onCollapsedEvent);\n\t\t\t\tthis.el.addEventListener(View.CLICK_EVENT, this._onCollapsedEvent, false);\n\t\t\t} else {\n\t\t\t\tthis.hpan.off(\"hpanleft hpanright\", this._onCollapsedEvent);\n\t\t\t\tthis.el.removeEventListener(View.CLICK_EVENT, this._onCollapsedEvent, false);\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tthis.requestRender(View.MODEL_INVALID);\n\t},\n\n\t/* -------------------------------\n\t/* Vertical touch/move (_onVPan*)\n\t/* ------------------------------- */\n\n\t_collapsedOffsetY: Globals.COLLAPSE_OFFSET,\n\n\t_onVPanStart: function(ev) {\n\t\tthis.vpan.on(\"vpanmove\", this._onVPanMove);\n\t\tthis.vpan.on(\"vpanend vpancancel\", this._onVPanFinal);\n\n\t\tthis.transforms.stopAllTransitions();\n\t\t// this.transforms.clearAllOffsets();\n\t\t// this.transforms.validate();\n\t\tthis.transforms.clearAllCaptures();\n\n\t\tthis.el.classList.add(\"container-changing\");\n\t\tthis._onVPanMove(ev);\n\t},\n\n\t_onVPanMove: function(ev) {\n\t\tvar collapsed = this.model.get(\"collapsed\");\n\t\tvar delta = ev.deltaY; //ev.thresholdDeltaY;\n\t\tvar maxDelta = this._collapsedOffsetY; // + Math.abs(ev.thresholdOffsetY);\n\n\t\t// check if direction is aligned with collapsed/expand\n\t\tvar isValidDir = collapsed ? (delta > 0) : (delta < 0);\n\t\tvar moveFactor = collapsed ? Globals.VPAN_DRAG : 1 - Globals.VPAN_DRAG;\n\n\t\tdelta = Math.abs(delta); // remove sign\n\t\tdelta *= moveFactor;\n\t\tmaxDelta *= moveFactor;\n\n\t\tif (isValidDir) {\n\t\t\tif (delta > maxDelta) { // overshooting\n\t\t\t\tdelta = ((delta - maxDelta) * Globals.VPAN_OUT_DRAG) + maxDelta;\n\t\t\t} else { // no overshooting\n\t\t\t\t// delta = delta;\n\t\t\t}\n\t\t} else {\n\t\t\tdelta = (-delta) * Globals.VPAN_OUT_DRAG; // delta is opposite\n\t\t}\n\t\tdelta *= collapsed ? 1 : -1; // reapply sign\n\n\t\tthis.transforms.offsetAll(0, delta);\n\t\tthis.transforms.validate();\n\t},\n\n\t_onVPanFinal: function(ev) {\n\t\tthis.vpan.off(\"vpanmove\", this._onVPanMove);\n\t\tthis.vpan.off(\"vpanend vpancancel\", this._onVPanFinal);\n\n\t\t// FIXME: model.collapsed may have already changed, _onVPanMove would run with wrong values:\n\t\t// model.collapsed is changed in a setImmediate callback from NavigationView.\n\n\t\tthis._onVPanMove(ev);\n\t\tthis.setImmediate(function() {\n\t\t\tthis._transformsChanged = true;\n\t\t\tthis.requestRender();\n\t\t});\n\t},\n\n\t// willCollapsedChange: function(ev) {\n\t// \tvar collapsed = this.model.get(\"collapsed\");\n\t// \treturn ev.type == \"vpanend\"? collapsed?\n\t// \t\tev.thresholdDeltaY > Globals.COLLAPSE_THRESHOLD :\n\t// \t\tev.thresholdDeltaY < -Globals.COLLAPSE_THRESHOLD :\n\t// \t\tfalse;\n\t// },\n\n\t/* -------------------------------\n\t/* create/remove children on bundle selection\n\t/* ------------------------------- */\n\n\t/** Create children on bundle select */\n\tcreateChildren: function(model) {\n\t\tvar view;\n\t\tif (model.__proto__.constructor === bundles.model) {\n\t\t\t// will be attached to dom in this order\n\t\t\tview = this.createMediaCaptionStack(model);\n\t\t\tthis.itemViews.push(view);\n\t\t\tthis.transforms.add(view.el);\n\t\t\tview = this.createMediaCarousel(model);\n\t\t\tthis.itemViews.push(view);\n\t\t\tthis.transforms.add(view.el);\n\t\t\tview = this.createMediaDotNavigation(model);\n\t\t\tthis.itemViews.push(view);\n\t\t} else\n\t\tif (model.__proto__.constructor === articles.model) {\n\t\t\tview = this.createArticleView(model);\n\t\t\tthis.itemViews.push(view);\n\t\t}\n\n\t\tthis.itemViews.forEach(function(view) {\n\t\t\tif (!this.skipTransitions) {\n\t\t\t\tview.el.classList.add(\"adding-child\");\n\t\t\t\tview.el.style.opacity = 0;\n\t\t\t}\n\t\t\tthis.el.appendChild(view.el);\n\t\t\tview.render();\n\t\t}, this);\n\n\t\tif (!this.skipTransitions) {\n\t\t\tthis.requestAnimationFrame(function() {\n\t\t\t\tconsole.log(\"%s::createChildren::[callback:requestAnimationFrame]\", this.cid);\n\t\t\t\tthis.itemViews.forEach(function(view) {\n\t\t\t\t\tif (!this.skipTransitions) {\n\t\t\t\t\t\tview.el.style[transitionProp] = \"opacity \" + tx.LAST.cssText;\n\t\t\t\t\t}\n\t\t\t\t\tview.el.style.removeProperty(\"opacity\");\n\t\t\t\t}, this);\n\t\t\t});\n\t\t}\n\t},\n\n\tremoveChildren: function() {\n\t\tthis.itemViews.forEach(function(view, i, arr) {\n\t\t\tthis.transforms.remove(view.el);\n\t\t\tif (this.skipTransitions) {\n\t\t\t\tview.remove();\n\t\t\t} else {\n\t\t\t\tvar s = window.getComputedStyle(view.el);\n\t\t\t\tif (s.opacity == \"0\" || s.visibility == \"hidden\") {\n\t\t\t\t\tconsole.log(\"%s::removeChildren [view:%s] removed immediately (invisible)\", this.cid, view.cid);\n\t\t\t\t\tview.remove();\n\t\t\t\t} else {\n\t\t\t\t\tview.el.classList.add(\"removing-child\");\n\t\t\t\t\tif (s[transformProp]) view.el.style[transformProp] = s[transformProp];\n\t\t\t\t\tview.el.style[transitionProp] = \"opacity \" + tx.FIRST.cssText;\n\t\t\t\t\tview.el.style.opacity = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tarr[i] = null;\n\t\t}, this);\n\t\tthis.itemViews.length = 0;\n\t},\n\n\t_onAddedTransitionEnd: function(ev) {\n\t\tif (ev.target.cid && this.childViews.hasOwnProperty(ev.target.cid)) {\n\t\t\tconsole.log(\"%s::_onAddedTransitionEnd [view:%s] [prop:%s] [ev:%s]\", this.cid, ev.target.cid, ev.propertyName, ev.type);\n\t\t\tvar view = this.childViews[ev.target.cid];\n\t\t\tview.el.classList.remove(\"adding-child\");\n\t\t\tview.el.style.removeProperty(transitionProp);\n\t\t}\n\t},\n\n\t_onRemovedTransitionEnd: function(ev) {\n\t\tif (ev.target.cid && this.childViews.hasOwnProperty(ev.target.cid)) {\n\t\t\tconsole.log(\"%s::_onRemovedTransitionEnd [view:%s] [prop:%s] [ev:%s]\", this.cid, ev.target.cid, ev.propertyName, ev.type);\n\t\t\tvar view = this.childViews[ev.target.cid];\n\t\t\tview.el.classList.remove(\"removing-child\");\n\t\t\tview.remove();\n\t\t}\n\t},\n\n\t// purgeChildren: function() {\n\t// \tvar i, el, els = this.el.querySelectorAll(\".removing-child\");\n\t// \tfor (i = 0; i < els.length; i++) {\n\t// \t\tel = els.item(i);\n\t// \t\tif (el.parentElement === this.el) {\n\t// \t\t\ttry {\n\t// \t\t\t\tconsole.error(\"%s::purgeChildren\", this.cid, el.getAttribute(\"data-cid\"));\n\t// \t\t\t\tView.findByElement(el).remove();\n\t// \t\t\t} catch (err) {\n\t// \t\t\t\tconsole.error(\"s::purgeChildren\", this.cid, \"orphaned element\", err);\n\t// \t\t\t\tthis.el.removeChild(el);\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// },\n\n\t/* -------------------------------\n\t/* Components\n\t/* ------------------------------- */\n\n\n\t/**\n\t * media-carousel\n\t */\n\tcreateMediaCarousel: function(bundle) {\n\t\t// Create carousel\n\t\tvar EmptyRenderer = CarouselRenderer.extend({\n\t\t\tclassName: \"carousel-item empty-item\",\n\t\t\tmodel: bundle,\n\t\t\ttemplate: carouselEmptyTemplate,\n\t\t});\n\t\tvar rendererFunction = function(item, index, arr) {\n\t\t\tif (index === -1) {\n\t\t\t\treturn EmptyRenderer;\n\t\t\t}\n\t\t\tswitch (item.attr(\"@renderer\")) {\n\t\t\t\tcase \"video\":\n\t\t\t\t\treturn VideoRenderer;\n\t\t\t\tcase \"sequence\":\n\t\t\t\t\treturn SequenceRenderer;\n\t\t\t\tcase \"image\":\n\t\t\t\t\treturn ImageRenderer;\n\t\t\t\tdefault:\n\t\t\t\t\treturn ImageRenderer;\n\t\t\t}\n\t\t};\n\t\tvar view = new Carousel({\n\t\t\tclassName: \"media-carousel \" + bundle.get(\"domid\"),\n\t\t\tcollection: bundle.get(\"media\"),\n\t\t\trendererFunction: rendererFunction,\n\t\t\trequireSelection: false,\n\t\t\tdirection: Carousel.DIRECTION_HORIZONTAL,\n\t\t\ttouch: this.hpan,\n\t\t});\n\t\tcontroller.listenTo(view, {\n\t\t\t\"view:select:one\": controller.selectMedia,\n\t\t\t\"view:select:none\": controller.deselectMedia,\n\t\t\t// \"view:removed\": controller.stopListening\n\t\t});\n\t\tview.listenTo(bundle, \"deselected\", function() {\n\t\t\tthis.stopListening(this.collection);\n\t\t\tcontroller.stopListening(this);\n\t\t});\n\t\treturn view;\n\t},\n\n\t/**\n\t * media-caption-stack\n\t */\n\tcreateMediaCaptionStack: function(bundle) {\n\t\tvar view = new CollectionStack({\n\t\t\tclassName: \"media-caption-stack\",\n\t\t\tcollection: bundle.get(\"media\"),\n\t\t\ttemplate: mediaStackTemplate\n\t\t});\n\t\tview.listenTo(bundle, \"deselected\", function() {\n\t\t\tthis.stopListening(this.collection);\n\t\t});\n\t\treturn view;\n\t},\n\n\t/**\n\t * media-dotnav\n\t */\n\tcreateMediaDotNavigation: function(bundle) {\n\t\tvar view = new SelectableListView({\n\t\t\tclassName: \"media-dotnav dots-fontface color-fg05\",\n\t\t\tcollection: bundle.get(\"media\"),\n\t\t\trenderer: DotNavigationRenderer\n\t\t});\n\t\tcontroller.listenTo(view, {\n\t\t\t\"view:select:one\": controller.selectMedia,\n\t\t\t\"view:select:none\": controller.deselectMedia,\n\t\t\t// \"view:removed\": controller.stopListening\n\t\t});\n\t\tview.listenTo(bundle, \"deselected\", function() {\n\t\t\tthis.stopListening(this.collection);\n\t\t\tcontroller.stopListening(this);\n\t\t});\n\t\treturn view;\n\t},\n\n\t/**\n\t * @param el {module:app/model/item/ArticleView}\n\t * @return {module:app/view/base/View}\n\t */\n\tcreateArticleView: function(article) {\n\t\tvar view = new ArticleView({\n\t\t\tmodel: article,\n\t\t});\n\t\treturn view;\n\t},\n\n\t// createProgressWrapper: function() {\n\t// \t// var view = new ProgressMeter({\n\t// \t// \tid: \"media-progress-wrapper\",\n\t// \t// \t// className: \"color-bg color-fg05\",\n\t// \t// \tuseOpaque: false,\n\t// \t// \tlabelFn: function() { return \"0%\"; }\n\t// \t// });\n\t// \t// this.el.appendChild(this.progressWrapper.el);\n\t// \t// return view;\n\t// \treturn null;\n\t// },\n});\n",
    "/**\n * @module app/view/NavigationView\n */\n\n/** @type {module:hammerjs} */\nvar Hammer = require(\"hammerjs\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:utils/TransformHelper} */\nvar TransformHelper = require(\"utils/TransformHelper\");\n// /** @type {module:app/view/base/TouchManager} */\n// var TouchManager = require(\"app/view/base/TouchManager\");\n\n/** @type {module:app/control/Controller} */\nvar controller = require(\"app/control/Controller\");\n/** @type {module:app/model/collection/TypeCollection} */\nvar types = require(\"app/model/collection/TypeCollection\");\n/** @type {module:app/model/collection/KeywordCollection} */\nvar keywords = require(\"app/model/collection/KeywordCollection\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundles = require(\"app/model/collection/BundleCollection\");\n/** @type {module:app/model/collection/ArticleCollection} */\nvar articles = require(\"app/model/collection/ArticleCollection\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/component/FilterableListView} */\nvar FilterableListView = require(\"app/view/component/FilterableListView\");\n/** @type {module:app/view/component/GroupingListView} */\nvar GroupingListView = require(\"app/view/component/GroupingListView\");\n// /** @type {module:app/view/component/CollectionPager} */\n// var CollectionPager = require(\"app/view/component/CollectionPager\");\n/** @type {module:app/view/component/GraphView} */\nvar GraphView = require(\"app/view/component/GraphView\");\n/** @type {module:app/view/component/ArticleButton} */\nvar ArticleButton = require(\"app/view/component/ArticleButton\");\n\n// /** @type {module:utils/prefixedProperty} */\n// var prefixedProperty = require(\"utils/prefixedProperty\");\n\n// var traceElement = require(\"utils/debug/traceElement\");\n\nvar tx = Globals.transitions;\n\nvar txNow = _.clone(tx.NOW);\ntxNow.easing = \"ease\";\n// var hTx = _.clone(collapsed ? tx.LAST : tx.FIRST);\n// hTx.easing = \"ease\";\n\n/**\n * @constructor\n * @type {module:app/view/NavigationView}\n */\nmodule.exports = View.extend({\n\n\t// /** @override */\n\t// tagName: \"div\",\n\t/** @override */\n\tcidPrefix: \"navigationView\",\n\t/** @override */\n\tclassName: \"navigation container-expanded\",\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t_.bindAll(this, \"_onVPanStart\", \"_onVPanMove\", \"_onVPanFinal\");\n\t\t_.bindAll(this, \"_onHPanStart\", \"_onHPanMove\", \"_onHPanFinal\");\n\t\t_.bindAll(this, \"_onNavigationClick\");\n\t\t// _.bindAll(this, \"_whenTransitionsEnd\", \"_whenTransitionsAbort\");\n\t\t// _.bindAll(this, \"_whenListsRendered\");\n\n\t\t// this._metrics = {\n\t\t// \tminHeight: 0\n\t\t// };\n\t\tthis.itemViews = [];\n\t\tthis.transforms = new TransformHelper();\n\t\t// this.touch = options.touch || new Error(\"no touch\"); //TouchManager.getInstance();\n\t\tthis.vpan = options.vpan || new Error(\"no vpan\");\n\t\tthis.hpan = options.hpan || new Error(\"no hpan\");\n\n\t\tthis.listenTo(this.model, \"change\", this._onModelChange);\n\t\tthis.listenTo(keywords, \"select:one select:none\", this._onKeywordSelect);\n\t\t// this.listenTo(this.model, \"withBundle:change\", this._onwithBundleChange);\n\n\t\tthis.vpanGroup = this.el.querySelector(\"#vpan-group\");\n\t\t// this.el.style.touchAction = \"none\";\n\t\t// this.el.style.webkitUserSelect = \"none\";\n\t\t// this.el.style.webkitUserDrag = \"none\";\n\n\t\tthis.keywordList = this.createKeywordList();\n\t\tthis.bundleList = this.createBundleList();\n\t\tthis.itemViews.push(this.keywordList);\n\t\tthis.itemViews.push(this.bundleList);\n\n\t\tthis.graph = this.createGraphView(this.bundleList,\n\t\t\tthis.keywordList, this.vpanGroup);\n\n\t\tthis.sitename = this.createSitenameButton();\n\t\tthis.about = this.createAboutButton();\n\n\t\t/* NOTE: .list-group .label moves horizontally (cf. sass/layouts/*.scss) */\n\t\tthis.hGroupings = this.keywordList.el.querySelectorAll(\".list-group .label\");\n\n\t\tthis.transforms.add(\n\t\t\tthis.vpanGroup,\n\t\t\tthis.bundleList.wrapper,\n\t\t\tthis.keywordList.wrapper,\n\t\t\tthis.bundleList.el,\n\t\t\tthis.keywordList.el,\n\t\t\tthis.hGroupings,\n\t\t\tthis.sitename.wrapper,\n\t\t\tthis.about.wrapper,\n\t\t\tthis.sitename.el,\n\t\t\tthis.about.el,\n\t\t\tthis.graph.el\n\t\t);\n\t\t// this.itemViews.push(this.graph);\n\t\t// this.listenTo(this.graph, {\n\t\t// \t\"canvas:update\": this._onGraphUpdate,\n\t\t// \t\"canvas:redraw\": this._onGraphRedraw,\n\t\t// });\n\n\t\t/*this.listenTo(this.graph, \"view:render:before\", function(view, flags) {\n\t\t\tvar vmax;\n\t\t\tif (!view.el.style.height) {\n\t\t\t\t// if (flags & (View.SIZE_INVALID | View.MODEL_INVALID)) {\n\t\t\t\t// if ((this.bundleList.renderFlags | View.SIZE_INVALID) ||\n\t\t\t\t// \t(this.keywordList.renderFlags | View.SIZE_INVALID)) {\n\t\t\t\t// }\n\t\t\t\tvmax = Math.max(\n\t\t\t\t\tthis.bundleList._metrics.height,\n\t\t\t\t\tthis.keywordList._metrics.height\n\t\t\t\t);\n\t\t\t\tif (_.isNumber(vmax)) {\n\t\t\t\t\tview.el.style.height = vmax + \"px\";\n\t\t\t\t\tconsole.log(\"%s:[view:render:before][once]:%s [%s] heights:[%i, %i] (max %i)\",\n\t\t\t\t\t\tthis.cid, view.cid, View.flagsToString(flags),\n\t\t\t\t\t\tthis.bundleList._metrics.height,\n\t\t\t\t\t\tthis.keywordList._metrics.height,\n\t\t\t\t\t\tvmax);\n\t\t\t\t}\n\t\t\t}\n\t\t});*/\n\t\t// this.listenTo(this.bundleList, \"view:render:after\", function(view, flags) {\n\t\t// \tconsole.info(\"%s:[view:render:after %s]\", this.cid, view.cid, View.flagsToString(flags & View.SIZE_INVALID));\n\t\t// \t\tif (flags & View.SIZE_INVALID) {\n\t\t// \t\t\t// console.info(\"%s:[%s view:render:after] bundleList height\", this.cid, view.cid, this.bundleList.el.style.height);\n\t\t// \t\t\t// this.graph.el.style.height = this.bundleList.el.style.height;\n\t\t// \t\t\tthis.graph.el.style.opacity = this.bundleList.collapsed? 0 : 1;\n\t\t// \t\t\tthis.graph.requestRender(View.SIZE_INVALID).renderNow();\n\t\t// \t// \t}\n\t\t// });\n\t\t// this.listenTo(this.bundleList, \"view:render:after\", this._onListResize);\n\t\t// this.listenTo(this.keywordList, \"view:render:after\", this._onListResize);\n\t},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\trenderFrame: function(tstamp, flags) {\n\t\tif (flags & View.MODEL_INVALID) {\n\t\t\tif (this.model.hasChanged(\"collapsed\")) {\n\t\t\t\tthis.el.classList.toggle(\"container-collapsed\", this.model.get(\"collapsed\"));\n\t\t\t\tthis.el.classList.toggle(\"container-expanded\", !this.model.get(\"collapsed\"));\n\t\t\t}\n\t\t\tif (this.model.hasChanged(\"collapsed\")\n\t\t\t\t|| this.model.hasChanged(\"withBundle\")) {\n\t\t\t\tthis.el.classList.add(\"container-changing\");\n\t\t\t}\n\t\t\tif (this.model.hasChanged(\"routeName\")) {\n\t\t\t\tthis.bundleList.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);\n\t\t\t\tthis.keywordList.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);\n\t\t\t}\n\t\t}\n\n\t\t// transforms\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tif (this.skipTransitions ||\n\t\t\t(flags & View.ALL_INVALID)) {\n\t\t\t// (flags & (View.MODEL_INVALID | View.SIZE_INVALID | View.LAYOUT_INVALID))) {\n\t\t\t// if (transformsChanged) {\n\t\t\tif (this.skipTransitions) {\n\t\t\t\tthis.transforms.stopAllTransitions();\n\t\t\t\tthis.transforms.validate();\n\t\t\t\tthis.transforms.clearAllOffsets();\n\t\t\t} else {\n\t\t\t\tthis.renderTransitions(flags);\n\t\t\t}\n\t\t\tthis.transforms.validate();\n\t\t\t// console.log(\"%s::renderFrame %o\", this.cid,\n\t\t\t// \tthis.transforms.items.map(function(o) {\n\t\t\t// \t\treturn traceElement(o.el) + \":\" +\n\t\t\t// \t\t\t(o.hasTransition ? o.transition.name : \"-\");\n\t\t\t// \t}));\n\t\t}\n\t\t// if (this.model.hasChanged(\"collapsed\") && this.model.get(\"collapsed\")) {\n\t\t// \tthis.el.style.height = \"\";\n\t\t// \t// this.el.style.minHeight = hval + \"px\";\n\t\t// \tthis.graph.el.style.height = \"\";\n\t\t// }\n\n\t\t// promise handlers\n\t\t// - - - - - - - - - - - - - - - - -\n\n\t\tvar measureRenderedLists = function(result) {\n\t\t\t// var hval = result.reduce(function(a, o) {\n\t\t\t// \treturn Math.max(a, o.metrics.height);\n\t\t\t// }, 0);\n\t\t\tvar hval = Math.max(\n\t\t\t\tthis.bundleList.metrics.height,\n\t\t\t\tthis.keywordList.metrics.height);\n\n\t\t\tif (this.model.get(\"collapsed\")) {\n\t\t\t\tthis.el.style.height = \"\";\n\t\t\t\t// this.el.style.minHeight = hval + \"px\";\n\t\t\t\tthis.graph.el.style.height = \"\";\n\t\t\t} else {\n\t\t\t\tthis.el.style.height = hval + \"px\";\n\t\t\t\t// this.el.style.minHeight = \"\";\n\t\t\t\tthis.graph.el.style.height = hval + \"px\";\n\t\t\t}\n\t\t\t// this.el.style.height = this.model.get(\"collapsed\") ? \"\" : \"100%\";\n\t\t\t// this.vpanGroup.style.height = hval;\n\t\t\tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);\n\t\t\tconsole.log(\"%s:[whenListsRenderedDone] height set to %s\", this.cid, this.model.get(\"collapsed\") ? hval + \"px\" : \"[not set]\", result);\n\t\t\tthis.trigger(\"view:collapsed:measured\", this);\n\t\t\treturn result;\n\t\t}.bind(this);\n\n\t\tvar toggleGraph = function(result) {\n\t\t\tthis.graph.enabled = !this.model.get(\"collapsed\");\n\t\t\tthis.graph.valueTo(\"a2b\", 0, 0);\n\t\t\tif (!this.model.get(\"collapsed\")) {\n\t\t\t\tthis.graph.valueTo(\"a2b\", 1, Globals.TRANSITION_DURATION);\n\t\t\t}\n\t\t\treturn result;\n\t\t}.bind(this);\n\n\t\tvar whenCollapsedChangeDone = function(result) {\n\t\t\tconsole.log(\"%s:[whenCollapsedChangeDone][flags: %s]\", this.cid, View.flagsToString(flags), result);\n\t\t\tthis.el.classList.remove(\"container-changing\");\n\t\t\tthis.trigger(\"view:collapsed:end\", this);\n\t\t\treturn result;\n\t\t}.bind(this);\n\n\t\t// promises\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tvar p;\n\t\t// p = Promise.all([\n\t\t// \t\tthis.bundleList.whenRendered(),\n\t\t// \t\tthis.keywordList.whenRendered(),\n\t\t// \t\tthis.bundleList.whenCollapseChangeEnds(),\n\t\t// \t\tthis.keywordList.whenCollapseChangeEnds(),\n\t\t// \t\tthis.transforms.whenAllTransitionsEnd(),\n\t\t// \t]);\n\n\t\tp = Promise.all([\n\t\t\t\tthis.bundleList.whenCollapseChangeEnds(),\n\t\t\t\tthis.keywordList.whenCollapseChangeEnds(),\n\t\t\t])\n\t\t\t.then(measureRenderedLists);\n\n\t\tif ((flags & View.MODEL_INVALID) && this.model.hasChanged(\"collapsed\")) {\n\t\t\tp = p.then(toggleGraph);\n\t\t}\n\t\tp\n\t\t\t.then(this.transforms.whenAllTransitionsEnd())\n\t\t\t.then(whenCollapsedChangeDone)\n\t\t\t.catch(function(reason) {\n\t\t\t\tconsole.error(\"%s::renderFrame promise rejected\", this.cid, reason);\n\t\t\t\treturn reason;\n\t\t\t}.bind(this));\n\n\t\t/*\n\t\tvar whenListsRendered = Promise.all([\n\t\t\tthis.bundleList.whenRendered(),\n\t\t\tthis.keywordList.whenRendered()\n\t\t]);\n\n\t\tvar whenTransformsEnd = this.transforms.promise();\n\n\t\twhenListsRendered.then(\n\t\t\twhenListsRenderedDone,\n\t\t\tfunction(reason) {\n\t\t\t\tconsole.warn(\"%s:[whenListsRendered] failed: %o\", this.cid, reason);\n\t\t\t\treturn reason;\n\t\t\t}.bind(this)\n\t\t);\n\n\t\tPromise.all([\n\t\t\twhenListsRendered,\n\t\t\twhenTransformsEnd\n\t\t])\n\t\t\t.then(\n\t\t\t\tfunction(result) {\n\t\t\t\t\tconsole.log(\"%s:[whenListsRendered+whenTransformsEnd] [%s]\", this.cid, View.flagsToString(flags), result);\n\t\t\t\t\tthis.el.classList.remove(\"container-changing\");\n\t\t\t\t\tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);\n\t\t\t\t}.bind(this),\n\t\t\t\tfunction(reason) {\n\t\t\t\t\tconsole.warn(\"%s:[whenListsRendered+whenTransformsEnd] [%s]\", this.cid, View.flagsToString(flags), reason);\n\t\t\t\t\tthis.el.classList.remove(\"container-changing\");\n\t\t\t\t\tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);\n\t\t\t\t}.bind(this)\n\t\t\t);*/\n\n\n\t\t// trace result handlers\n\t\t// - - - - - - - - - - - - - - - - -\n\t\t/*if (this.model.hasChanged(\"collapsed\")) {\n\t\t\tvar msgBase = this.model.get(\"collapsed\") ? \"collaps\" : \"expand\";\n\t\t\tPromise.all([\n\t\t\t\tPromise.all([\n\t\t\t\t\t\tthis.bundleList.whenRendered(),\n\t\t\t\t\t\tthis.keywordList.whenRendered()\n\t\t\t\t\t])\n\t\t\t\t\t.then(\n\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\tconsole.log(\"nav-tx:%sing\", msgBase, arguments);\n\t\t\t\t\t\t}),\n\t\t\t\tthis.transforms.promise()\n\t\t\t])\n\t\t\t\t.catch(\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tconsole.warn(\"nav-tx:%sed [rejected]\", msgBase, arguments);\n\t\t\t\t\t})\n\t\t\t\t.finally(\n\t\t\t\t\tfunction() {\n\t\t\t\t\t\tconsole.log(\"nav-tx:%sed\", msgBase, arguments);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t}*/\n\n\t\t// graph\n\t\t// - - - - - - - - - - - - - - - - -\n\t\t// if ((flags & (View.SIZE_INVALID | ~View.MODEL_INVALID))\n\t\t// \t/* collapsed has not changed, no bundle selected */\n\t\t// \t&& !this.model.hasChanged(\"collapsed\")\n\t\t// \t&& !this.model.get(\"withBundle\")) {\n\t\t// \tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);\n\t\t// \tif (!this.skipTransitions) {\n\t\t// \t\tthis.graph.renderNow();\n\t\t// \t}\n\t\t// }\n\t\t// else\n\t\t// if ((flags & View.SIZE_INVALID) && !this.model.get(\"collapsed\")) {\n\t\t// \t/* NavigationView has resized while uncollapsed,\n\t\t// \tbut model is unchanged */\n\t\t// \tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);\n\t\t// }\n\n\n\t\t// children loop\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tthis.itemViews.forEach(function(view) {\n\t\t\t// view.skipTransitions = view.skipTransitions || this.skipTransitions;\n\t\t\tif (this.skipTransitions) {\n\t\t\t\tview.skipTransitions = true;\n\t\t\t}\n\t\t\tif (flags & View.SIZE_INVALID) {\n\t\t\t\tview.requestRender(View.SIZE_INVALID);\n\t\t\t}\n\t\t\t// if (!view.skipTransitions) {\n\t\t\tview.renderNow();\n\t\t\t// }\n\t\t}, this);\n\n\t\tthis.requestAnimationFrame(function() {\n\t\t\tthis.skipTransitions = false;\n\t\t});\n\t},\n\n\t/*_whenListsRendered: function(result) {\n\t\tvar hval;\n\t\tif (this.model.get(\"collapsed\")) {\n\t\t\tthis.el.style.height = \"\";\n\t\t\t// this.graph.el.style.height = \"100%\";\n\t\t} else {\n\t\t\t// hval = result.reduce(function(a, o) {\n\t\t\t// \treturn Math.max(a, o.metrics.height);\n\t\t\t// }, 0);\n\t\t\thval = Math.max(\n\t\t\t\tthis.bundleList.metrics.height,\n\t\t\t\tthis.keywordList.metrics.height);\n\t\t\tthis.el.style.height = hval + \"px\";\n\t\t\t// this.graph.el.style.height = hval + \"px\";\n\t\t}\n\t\tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();\n\t\tconsole.log(\"%s:[_whenListsRendered] height set to %opx\", this.cid, hval ? hval : \"[empty]\", arguments);\n\t\treturn result\n\t},\n\n\t_whenTransitionsEnd: function(result) {\n\t\tconsole.info(\"%s::_whenTransitionsEnd\", this.cid);\n\t\tthis.el.classList.remove(\"container-changing\");\n\t\t// if (!Globals.BREAKPOINTS[\"medium-wide\"].matches)\n\t\t// \treturn;\n\t\t// if (!this.model.get(\"collapsed\")) {\n\t\t// \tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID); //.renderNow();\n\t\t// }\n\t\treturn result;\n\t},\n\n\t_whenTransitionsAbort: function(reason) {\n\t\tconsole.warn(\"%s::_whenTransitionsAbort %o\", this.cid, reason);\n\t\tthis.el.classList.remove(\"container-changing\");\n\t\t// if (!Globals.BREAKPOINTS[\"medium-wide\"].matches)\n\t\t// \treturn;\n\t\t// if (!this.model.get(\"collapsed\")) {\n\t\t// \tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID); //.renderNow();\n\t\t// }\n\t\treturn result;\n\t},*/\n\n\t/* -------------------------------\n\t/* renderTransitions\n\t/* ------------------------------- */\n\n\trenderTransitions: function(flags) {\n\n\t\tvar modelChanged = (flags & View.MODEL_INVALID);\n\n\t\tvar fromRoute = this.model.get(\"fromRouteName\");\n\t\tvar toRoute = this.model.get(\"routeName\");\n\t\tvar routeChanged = modelChanged && this.model.hasChanged(\"routeName\");\n\n\t\t/* bundle */\n\t\tvar withBundle = this.model.has(\"bundle\");\n\t\tvar withBundleChanged = modelChanged && this.model.hasAnyChanged(\"bundle\");\n\t\tvar bundleChanged = modelChanged && this.model.hasChanged(\"bundle\");\n\t\t/* media */\n\t\tvar withMedia = this.model.has(\"media\");\n\t\tvar withMediaChanged = modelChanged && this.model.hasAnyChanged(\"media\");\n\t\t//var mediaChanged = modelChanged && this.model.hasChanged(\"media\");\n\t\t/* article */\n\t\t// var withArticle = this.model.has(\"article\");\n\t\tvar withArticleChanged = modelChanged && this.model.hasAnyChanged(\"article\");\n\t\t//var articleChanged = modelChanged && this.model.hasChanged(\"article\");\n\t\t/* collapsed */\n\t\tvar collapsed = this.model.get(\"collapsed\");\n\t\tvar collapsedChanged = modelChanged && this.model.hasChanged(\"collapsed\");\n\n\t\tvar tf;\n\t\t/* this.vpanGroup */\n\t\ttf = this.transforms.get(this.vpanGroup);\n\t\tif (tf && tf.hasOffset) {\n\t\t\ttf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);\n\t\t\ttf.clearOffset();\n\t\t}\n\t\t/* this.bundleList.el */\n\t\t// tf = this.transforms.get(this.bundleList.el);\n\t\t// if (tf.hasOffset) {\n\t\t// \ttf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);\n\t\t// \ttf.clearOffset();\n\t\t// }\n\t\t/* this.keywordList.el */\n\t\t// tf = this.transforms.get(this.keywordList.el);\n\t\t// if (tf.hasOffset) {\n\t\t// \ttf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);\n\t\t// \ttf.clearOffset();\n\t\t// }\n\t\t/* this.graph.el */\n\t\t// tf = this.transforms.get(this.graph.el);\n\t\t// if (tf && tf.hasOffset) {\n\t\t// \ttf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);\n\t\t// \ttf.clearOffset();\n\t\t// }\n\n\t\t/*\n\t\t * NOTE:\n\t\t * Vertical:\n\t\t *\t\tsite-name-wrapper,\n\t\t *\t\tarticle-list-wrapper\n\t\t * Horizontal:\n\t\t *\t\tsite-name,\n\t\t *\t\tarticle-buttons,\n\t\t *\t\tkeywordList.wrapper,\n\t\t *\t\tbundleList.wrapper,\n\t\t *\t\thGroupings\n\t\t */\n\t\tif (Globals.BREAKPOINTS[\"medium-wide\"].matches) {\n\t\t\t/* HORIZONTAL: keywordList.wrapper */\n\t\t\ttf = this.transforms.get(this.keywordList.wrapper);\n\t\t\tif (collapsedChanged && !withArticleChanged) {\n\t\t\t\t// if (collapsedChanged) {\n\t\t\t\tif (withBundleChanged) {\n\t\t\t\t\tif (withMediaChanged)\n\t\t\t\t\t\ttf.runTransition(withBundle ? tx.LAST : tx.FIRST);\n\t\t\t\t} else {\n\t\t\t\t\tif (withMedia)\n\t\t\t\t\t\ttf.runTransition(collapsed ? tx.LAST : tx.FIRST);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!withBundleChanged && withMediaChanged)\n\t\t\t\t\ttf.runTransition(bundleChanged ? tx.BETWEEN : txNow); //tx.NOW);\n\t\t\t}\n\t\t\tif (tf.hasOffset)\n\t\t\t\ttf.clearOffset();\n\n\t\t\t/* HORIZONTAL: the rest */\n\t\t\tif (collapsedChanged ^ withArticleChanged) {\n\t\t\t\tthis.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST,\n\t\t\t\t\tthis.sitename.el, this.about.el, this.bundleList.wrapper);\n\t\t\t\t// if (fromRoute != 'article-item' && toRoute != 'media-item') {\n\t\t\t\tthis.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.hGroupings);\n\t\t\t\t// }\n\t\t\t}\n\t\t\t/* VERTICAL */\n\t\t\tif (routeChanged && (fromRoute == 'root' || toRoute == 'root')) {\n\t\t\t\tthis.transforms.runTransition(tx.BETWEEN,\n\t\t\t\t\tthis.sitename.wrapper, this.about.wrapper);\n\t\t\t}\n\t\t\t/* this.hGroupings */\n\t\t\t// if (collapsedChanged ^ withArticleChanged) {\n\t\t\t// \t// if (collapsedChanged && !withArticleChanged) {\n\t\t\t// \tthis.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.hGroupings);\n\t\t\t// }\n\t\t\t// if (collapsedChanged) {\n\t\t\t// \tif (!withArticleChanged) {\n\t\t\t// \t\t// if (fromRoute == 'root' || toRoute == 'root') {\n\t\t\t// \t\tthis.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.bundleList.wrapper);\n\t\t\t// \t}\n\t\t\t// } else {\n\t\t\t// \tif (withArticleChanged && withBundleChanged) {\n\t\t\t// \t\tthis.transforms.runTransition(withArticle ? tx.BETWEEN : tx.LAST, this.bundleList.wrapper);\n\t\t\t// \t}\n\t\t\t// }\n\t\t} else if (Globals.BREAKPOINTS[\"small-stretch\"].matches) {\n\t\t\t// if (collapsedChanged ) {\n\t\t\tif (collapsedChanged ^ withArticleChanged) {\n\t\t\t\tthis.transforms.runTransition(collapsed ? tx.FIRST : tx.LAST,\n\t\t\t\t\tthis.sitename.el, this.about.el);\n\t\t\t}\n\t\t} else {\n\t\t\tif (withBundleChanged) {\n\t\t\t\tthis.transforms.runTransition(tx.BETWEEN,\n\t\t\t\t\tthis.sitename.el, this.about.el);\n\t\t\t}\n\t\t}\n\t\t// this.transforms.clearOffset(\n\t\t// \t// this.bundleList.el,\n\t\t// \t// this.keywordList.el,\n\t\t// \tthis.bundleList.wrapper);\n\t},\n\n\t/* --------------------------- *\n\t/* own model changed\n\t/* --------------------------- */\n\n\t_onModelChange: function() {\n\t\t// \tthis.setImmediate(this.commitModel);\n\t\t// },\n\t\t//\n\t\t// commitModel: function() {\n\t\t// this.requestRender(View.MODEL_INVALID | View.LAYOUT_INVALID);\n\t\tthis.requestRender(View.MODEL_INVALID);\n\t\t// keywords.deselect();\n\t\tif (this.model.hasChanged(\"collapsed\")) {\n\t\t\tif (this.model.get(\"collapsed\")) {\n\t\t\t\t// clear keyword selection\n\t\t\t\tkeywords.deselect();\n\t\t\t} // else {}\n\t\t\tthis.keywordList.collapsed = this.model.get(\"collapsed\");\n\t\t\tthis.bundleList.collapsed = this.model.get(\"collapsed\");\n\t\t}\n\t\tif (this.model.hasChanged(\"bundle\")) {\n\t\t\tthis.bundleList.selectedItem = this.model.get(\"bundle\");\n\t\t\tthis.keywordList.refreshFilter();\n\n\t\t\t// if (!this.model.get(\"collapsed\") && this.graph) {\n\t\t\t// \tthis.listenToOnce(this.keywordList, \"view:render:after\", function(view, flags) {\n\t\t\t// \t\tconsole.log(\"%s::_onBundleSelect -> %s:[view:render:after] flags:%s\", this.cid, view.cid, View.flagsToString(flags));\n\t\t\t// \t\tthis.graph.valueTo( \"a2b\", 0,  0);\n\t\t\t// \t\t// this.graph.renderNow();\n\t\t\t// \t\tthis.graph.valueTo( \"a2b\", 1,  Globals.TRANSITION_DURATION);\n\t\t\t// \t});\n\t\t\t// }\n\t\t\t// keywords.deselect();\n\t\t\t// this.graph && this.graph.requestRender(View.SIZE_INVALID);\n\t\t}\n\t\t// var clickEv = \"click\";//View.CLICK_EVENT\n\t\tif (this.model.hasChanged(\"withBundle\")) {\n\t\t\t// this.keywordList.refreshFilter()\n\t\t\tif (this.model.get(\"withBundle\")) {\n\n\t\t\t\tthis.el.addEventListener(View.CLICK_EVENT, this._onNavigationClick);\n\t\t\t\tthis.vpan.on(\"vpanstart\", this._onVPanStart);\n\t\t\t\tthis.hpan.on(\"hpanstart\", this._onHPanStart);\n\t\t\t\t// this.hpan.on(\"tap\", this._onTap);\n\t\t\t} else {\n\t\t\t\tthis.el.removeEventListener(View.CLICK_EVENT, this._onNavigationClick);\n\t\t\t\tthis.vpan.off(\"vpanstart\", this._onVPanStart);\n\t\t\t\tthis.hpan.off(\"hpanstart\", this._onHPanStart);\n\t\t\t\tkeywords.deselect();\n\t\t\t\t// this.hpan.off(\"tap\", this._onTap);\n\t\t\t}\n\t\t\t// this.graph.valueTo()\n\t\t}\n\t},\n\n\t// _onwithBundleChange: function(withBundle) {\n\t// \tif (withBundle) {\n\t// \t\tthis.listenTo(this.model, \"collapsed:change\", function(collapsed){\n\t//\n\t// \t\t});\n\t// \t} else {\n\t// \t\tthis.stopListening(this.model, \"collapsed:change\", function(collapsed){\n\t//\n\t// \t\t});\n\t// \t}\n\t// },\n\n\t/* --------------------------- *\n\t/* keyword collection changed\n\t/* --------------------------- */\n\n\t_onKeywordSelect: function(keyword) {\n\t\t// use collection listener to avoid redundant refreshFilter calls\n\t\tif (!this.model.get(\"collapsed\") && this.graph) {\n\t\t\tthis.listenToOnce(this.bundleList, \"view:render:after\", function(view, flags) {\n\t\t\t\t// console.log(\"%s::_onKeywordSelect -> %s:[view:render:after] flags:%s\", this.cid, view.cid, View.flagsToString(flags));\n\t\t\t\tthis.graph.valueTo(\"b2a\", 0, 0);\n\t\t\t\tthis.graph.valueTo(\"b2a\", 1, Globals.TRANSITION_DURATION);\n\t\t\t});\n\t\t}\n\t\tthis.bundleList.refreshFilter();\n\t},\n\n\t/* --------------------------- *\n\t/* UI Events: bundleList keywordList buttons\n\t/* --------------------------- */\n\n\t_onNavigationClick: function(ev) {\n\t\tconsole.log(\"%s::_onNavigationClick [%s] defaultPrevented:%s\", this.cid, ev.type, ev.defaultPrevented);\n\t\tif (ev.defaultPrevented) return;\n\t\t// if (ev.target !== this.graph.el && ev.target !== this.el) return;\n\n\t\tev.preventDefault();\n\t\tif (this.model.has(\"bundle\")) {\n\t\t\t// this.transforms.offset(0, 1, this.graph.el);\n\t\t\t// this.transforms.validate();\n\t\t\t// this._setCollapsed(!this.model.get(\"collapsed\"));\n\t\t\t// this.setImmediate(function() {\n\t\t\tthis.model.set(\"collapsed\", !this.model.get(\"collapsed\"));\n\t\t\t// });\n\t\t}\n\t},\n\n\t_setCollapsed: function(value) {\n\t\tif (value !== this.model.get(\"collapsed\")) {\n\t\t\t// this.transforms.offset(0, 1, this.graph.el);\n\t\t\t// this.transforms.validate();\n\t\t\tthis.setImmediate(function() {\n\t\t\t\t// console.log(\"%s::_setCollapsed -> %s (setImmediate)\", this.cid, value);\n\t\t\t\tthis.model.set(\"collapsed\", value);\n\t\t\t});\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* Horizontal touch/move (HammerJS)\n\t/* ------------------------------- */\n\n\t_onHPanStart: function(ev) {\n\t\tthis.transforms.get(this.keywordList.wrapper)\n\t\t\t.stopTransition()\n\t\t\t.clearOffset()\n\t\t\t.validate();\n\t\t// if (this.model.get(\"layoutName\") != \"left-layout\"\n\t\t// \t&& this.model.get(\"layoutName\") != \"default-layout\") {\n\t\t// \treturn;\n\t\t// }\n\t\tif (Globals.BREAKPOINTS[\"medium-wide\"].matches\n\t\t\t&& this.model.get(\"bundle\").get(\"media\").selectedIndex <= 0\n\t\t\t&& this.model.get(\"collapsed\")) {\n\t\t\tthis.transforms.get(this.keywordList.wrapper).clearCapture();\n\t\t\tthis._onHPanMove(ev);\n\n\t\t\tthis.hpan.on(\"hpanmove\", this._onHPanMove);\n\t\t\tthis.hpan.on(\"hpanend hpancancel\", this._onHPanFinal);\n\t\t}\n\t},\n\n\t_onHPanMove: function(ev) {\n\t\t// var HPAN_DRAG = 1;\n\t\t// var HPAN_DRAG = 0.75;\n\t\tvar HPAN_DRAG = 720 / 920;\n\t\tvar delta = ev.deltaX; //ev.thresholdDeltaX;\n\t\t// var mediaItems = this.model.get(\"bundle\").get(\"media\");\n\n\t\tif (this.model.has(\"media\")) {\n\t\t\tdelta *= (ev.offsetDirection & Hammer.DIRECTION_LEFT) ?\n\t\t\t\t0.0 : HPAN_DRAG;\n\t\t} else {\n\t\t\tdelta *= (ev.offsetDirection & Hammer.DIRECTION_LEFT) ?\n\t\t\t\tHPAN_DRAG : Globals.HPAN_OUT_DRAG;\n\t\t}\n\t\tthis.transforms.offset(delta, null, this.keywordList.wrapper);\n\t\tthis.transforms.validate();\n\t},\n\n\t_onHPanFinal: function(ev) {\n\t\tthis.hpan.off(\"hpanmove\", this._onHPanMove);\n\t\tthis.hpan.off(\"hpanend hpancancel\", this._onHPanFinal);\n\n\t\t/* NOTE: if there is no model change, set tx here. Otherwise just wait for render */\n\t\tvar kTf = this.transforms.get(this.keywordList.wrapper);\n\t\tif (!(this._renderFlags & View.MODEL_INVALID) && kTf.hasOffset) {\n\t\t\tif (kTf.offsetX != 0) {\n\t\t\t\tkTf.runTransition(tx.NOW);\n\t\t\t}\n\t\t\tkTf.clearOffset().validate();\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* Vertical touch/move (_onVPan*)\n\t/* ------------------------------- */\n\n\t_collapsedOffsetY: Globals.COLLAPSE_OFFSET,\n\n\t_onVPanStart: function(ev) {\n\t\tthis.vpan.on(\"vpanmove\", this._onVPanMove);\n\t\tthis.vpan.on(\"vpanend vpancancel\", this._onVPanFinal);\n\n\n\t\tthis.transforms.stopTransition(this.vpanGroup);\n\t\tthis.transforms.clearCapture(this.vpanGroup);\n\t\t// this.transforms.stopTransition(this.bundleList.el, this.keywordList.el); //, this.graph.el);\n\t\t// // this.transforms.clearOffset(this.bundleList.el, this.keywordList.el);\n\t\t// // this.transforms.validate();\n\t\t// this.transforms.clearCapture(this.bundleList.el, this.keywordList.el); //, this.graph.el);\n\t\t//\n\t\t// if (!this.model.get(\"collapsed\")) {\n\t\t// \tthis.transforms.stopTransition(this.graph.el);\n\t\t// \tthis.transforms.clearCapture(this.graph.el);\n\t\t// }\n\t\t// // this.el.classList.add(\"container-changing\");\n\n\t\t// this._onVPanMove(ev);\n\t},\n\n\t_onVPanMove: function(ev) {\n\t\tvar delta = this._computeVPanDelta(ev.deltaY); //ev.thresholdDeltaY);\n\n\t\tthis.transforms.offset(0, delta, this.vpanGroup);\n\t\t// this.transforms.offset(0, delta,\n\t\t// \tthis.bundleList.el, this.keywordList.el);\n\t\t// if (!this.model.get(\"collapsed\")) {\n\t\t// \tthis.transforms.offset(0, delta, this.graph.el);\n\t\t// }\n\t\tthis.transforms.validate();\n\t},\n\n\t_onVPanFinal: function(ev) {\n\t\tthis.vpan.off(\"vpanmove\", this._onVPanMove);\n\t\tthis.vpan.off(\"vpanend vpancancel\", this._onVPanFinal);\n\n\t\t// this._onVPanMove(ev);\n\t\t// this.transforms.validate();\n\n\t\tthis.setImmediate(function() {\n\t\t\t// this.transforms.clearOffset(this.bundleList.el, this.keywordList.el, this.graph.el);\n\t\t\tif (this.willCollapsedChange(ev)) {\n\t\t\t\t// this._setCollapsed(!this.model.get(\"collapsed\"));\n\t\t\t\tthis.model.set(\"collapsed\", !this.model.get(\"collapsed\"));\n\t\t\t}\n\t\t\tthis.requestRender(View.LAYOUT_INVALID); //.renderNow();\n\t\t});\n\t},\n\n\twillCollapsedChange: function(ev) {\n\t\treturn ev.type == \"vpanend\" ? this.model.get(\"collapsed\") ?\n\t\t\tev.deltaY > Globals.COLLAPSE_THRESHOLD :\n\t\t\tev.deltaY < -Globals.COLLAPSE_THRESHOLD :\n\t\t\tfalse;\n\t},\n\n\t_computeVPanDelta: function(delta) {\n\t\tvar collapsed = this.model.get(\"collapsed\");\n\t\tvar maxDelta = this._collapsedOffsetY; // + Math.abs(ev.thresholdOffsetY);\n\t\t// check if direction is aligned with collapsed/expand\n\t\tvar isValidDir = collapsed ? (delta > 0) : (delta < 0);\n\t\tvar moveFactor = collapsed ? 1 - Globals.VPAN_DRAG : Globals.VPAN_DRAG;\n\n\t\tdelta = Math.abs(delta); // remove sign\n\t\tdelta *= moveFactor;\n\t\tmaxDelta *= moveFactor;\n\n\t\tif (isValidDir) {\n\t\t\tif (delta > maxDelta) { // overshooting\n\t\t\t\tdelta = ((delta - maxDelta) * Globals.VPAN_OUT_DRAG) + maxDelta;\n\t\t\t} else { // no overshooting\n\t\t\t\t// delta = delta;\n\t\t\t}\n\t\t} else {\n\t\t\tdelta = (-delta) * Globals.VPAN_OUT_DRAG; // delta is opposite\n\t\t}\n\t\tdelta *= collapsed ? 0.5 : -1; // reapply sign\n\t\treturn delta;\n\t},\n\n\t/* -------------------------------\n\t/* Create children components\n\t/* ------------------------------- */\n\n\t// -------------------------------\n\t// #site-name\n\t// -------------------------------\n\n\tcreateSitenameButton: function() {\n\t\tvar view = new View({\n\t\t\tel: \"#site-name\",\n\t\t\tevents: {\n\t\t\t\t\"click a\": function(domev) {\n\t\t\t\t\tdomev.defaultPrevented || domev.preventDefault();\n\t\t\t\t\tthis.trigger(\"view:click\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tview.wrapper = view.el.parentElement;\n\t\tthis.listenTo(view, \"view:click\", this._onSitenameClick);\n\t\treturn view;\n\t},\n\n\t_onSitenameClick: function() {\n\t\tswitch (this.model.get(\"routeName\")) {\n\t\t\tcase \"media-item\":\n\t\t\tcase \"bundle-item\":\n\t\t\t\t// if (this.model.get(\"collapsed\")) {\n\t\t\t\t// \tthis._setCollapsed(false);\n\t\t\t\t// } else {\n\t\t\t\tcontroller.deselectBundle();\n\t\t\t\t// }\n\t\t\t\tbreak;\n\t\t\tcase \"article-item\":\n\t\t\t\tcontroller.deselectArticle();\n\t\t\t\tbreak;\n\t\t}\n\t},\n\n\t// -------------------------------\n\t// .article-button\n\t// -------------------------------\n\n\tcreateArticleButton: function(articleItem) {\n\t\tvar view = new ArticleButton({\n\t\t\tel: \".article-button[data-handle='about']\",\n\t\t\tmodel: articleItem\n\t\t}).render();\n\t\tview.wrapper = view.el.parentElement;\n\t\tthis.listenTo(view, \"view:click\", this._onArticleClick);\n\t\treturn view;\n\t},\n\n\t_onArticleClick: function(item) {\n\t\tswitch (this.model.get(\"routeName\")) {\n\t\t\tcase \"article-item\":\n\t\t\t\tcontroller.deselectArticle();\n\t\t\t\tbreak;\n\t\t\tcase \"root\":\n\t\t\tdefault:\n\t\t\t\tcontroller.selectArticle(item);\n\t\t\t\tbreak;\n\t\t}\n\t},\n\n\tcreateAboutButton: function() {\n\t\treturn this.createArticleButton(articles.findWhere({ handle: \"about\" }));\n\t},\n\n\t// -------------------------------\n\t// #bundle-list\n\t// -------------------------------\n\n\t/**\n\t * @param el {HTMLElement}\n\t * @return {module:app/base/view/component/FilterableListView}\n\t */\n\tcreateBundleList: function(el) {\n\t\tvar view = new FilterableListView({\n\t\t\tel: \"#bundle-list\",\n\t\t\tcollection: bundles,\n\t\t\tcollapsed: false,\n\t\t\tfilterFn: function(bundle, index, arr) {\n\t\t\t\treturn keywords.selected ?\n\t\t\t\t\tbundle.get(\"kIds\").indexOf(keywords.selected.id) !== -1 : false;\n\t\t\t},\n\t\t});\n\t\tview.wrapper = view.el.parentElement;\n\t\tthis.listenTo(view, \"view:select:one view:select:none\", function(bundle) {\n\t\t\tthis.setImmediate(function() {\n\t\t\t\tcontroller.selectBundle(bundle);\n\t\t\t});\n\t\t})\n\t\tthis.listenTo(view, \"view:select:same\", this._onBundleListSame);\n\t\treturn view;\n\t},\n\n\t_onBundleListSame: function(bundle) {\n\t\t// this.transforms.offset(0, 1, this.graph.el);\n\t\t// this.transforms.validate();\n\t\t// this.setImmediate(function() {\n\t\tthis.model.set(\"collapsed\", !this.model.get(\"collapsed\"));\n\t\t// });\n\t},\n\n\t// -------------------------------\n\t// #keyword-list\n\t// -------------------------------\n\n\t/**\n\t * @param el {HTMLElement}\n\t * @return {module:app/base/view/component/GroupingListView}\n\t */\n\tcreateKeywordList: function(el) {\n\t\tvar view = new GroupingListView({\n\t\t\tel: \"#keyword-list\",\n\t\t\tcollection: keywords,\n\t\t\tcollapsed: false,\n\t\t\tfilterFn: function(item, idx, arr) {\n\t\t\t\treturn bundles.selected ?\n\t\t\t\t\t(bundles.selected.get(\"kIds\").indexOf(item.id) !== -1) : false;\n\t\t\t},\n\t\t\tgroupingFn: function(item, idx, arr) {\n\t\t\t\treturn types.get(item.get(\"tId\"));\n\t\t\t},\n\t\t});\n\t\tview.wrapper = view.el.parentElement;\n\t\tview.listenTo(keywords, \"select:one select:none\", function(item) {\n\t\t\tview.selectedItem = item;\n\t\t});\n\t\tthis.listenTo(view, \"view:select:one view:select:none\", this._onKeywordListChange);\n\t\treturn view;\n\t},\n\n\t_onKeywordListChange: function(keyword) {\n\t\tif (!this.model.get(\"collapsed\")) {\n\t\t\tkeywords.select(keyword);\n\t\t}\n\t},\n\n\t// -------------------------------\n\t// #nav-graph\n\t// -------------------------------\n\n\t/**\n\t * @param listA {module:app/base/view/component/FilterableListView}\n\t * @param listB {module:app/base/view/component/FilterableListView}\n\t * @param parentEl {HTMLElement}\n\t * @return {module:app/base/view/component/GraphView}\n\t */\n\tcreateGraphView: function(listA, listB, parentEl) {\n\t\tvar view = new GraphView({\n\t\t\tid: \"nav-graph\",\n\t\t\tlistA: listA,\n\t\t\tlistB: listB,\n\t\t\tmodel: this.model,\n\t\t\tuseOpaque: false\n\t\t});\n\t\tparentEl || (parentEl = this.el);\n\t\tparentEl.insertBefore(view.el, parentEl.firstElementChild);\n\t\treturn view;\n\t},\n\n\t/* -------------------------------\n\t/* Horizontal touch/move (MutationObserver)\n\t/* ------------------------------- */\n\n\t/*\n\t_beginTransformObserve: function() {\n\t\tif (!(Globals.BREAKPOINTS[\"medium-wide\"].matches && this.model.get(\"bundle\").get(\"media\").selectedIndex <= 0 && this.model.get(\"collapsed\"))) {\n\t\t\treturn;\n\t\t}\n\t\tvar target = document.querySelector(\".carousel > .empty-item\");\n\t\tif (target === null) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this._transformObserver) {\n\t\t\tthis._transformObserver = new MutationObserver(this._onTransformMutation);\n\t\t}\n\t\tthis._transformObserver.observe(target, { attributes: true, attributeFilter: [\"style\"] });\n\t\tthis.hpan.on(\"hpanend hpancancel\", this._endTransformObserve);\n\t\tthis.transforms.get(this.keywordList.wrapper)\n\t\t\t.stopTransition()\n\t\t\t.clearOffset()\n\t\t\t.clearCapture()\n\t\t\t.validate();\n\t},\n\n\t_endTransformObserve: function() {\n\t\tthis._transformObserver.disconnect();\n\t\tthis.hpan.off(\"hpanend hpancancel\", this._endTransformObserve);\n\t\tthis.transforms.get(this.keywordList.wrapper)\n\t\t\t.clearOffset()\n\t\t\t.runTransition(tx.NOW)\n\t\t\t.validate();\n\t},\n\n\t_onTransformMutation: function(mutations) {\n\t\tvar tView, tMetrics, tCss, dTxObj, pos;\n\n\t\t// this.keywordList.wrapper.style[prefixedProperty(\"transform\")];\n\t\t// transform = mutations[0].target.style.getPropertyValue(prefixedProperty(\"transform\"));\n\n\t\ttView = View.findByElement(mutations[0].target);\n\t\tif (tView) {\n\t\t\ttMetrics = tView.metrics;\n\t\t\tdTxObj = this.transforms.get(this.keywordList.wrapper);\n\t\t\tconsole.log(\"%s::_onTransformMutation [withMedia: %s] target: (%f\\+%f) %f wrapper: (%f) %f\", this.cid,\n\t\t\t\tthis.model.has(\"media\"),\n\t\t\t\ttMetrics.translateX, tMetrics.width, tMetrics.translateX + tMetrics.width,\n\t\t\t\tdTxObj.capturedX, tMetrics.translateX - dTxObj.capturedX,\n\t\t\t\ttMetrics\n\t\t\t);\n\n\t\t\tthis.transforms.offset(tMetrics.translateX - dTxObj.capturedX, void 0, this.keywordList.wrapper);\n\t\t\tthis.transforms.validate();\n\t\t}\n\t},\n\t*/\n});\n",
    "var PriorityQueue = function(offset) {\n\tthis._offset = offset | 0;\n\tthis._items = [];\n\tthis._priorities = [];\n\tthis._numItems = 0;\n};\n\nPriorityQueue.prototype = Object.create({\n\tenqueue: function(item, priority) {\n\t\tvar i = this._items.length;\n\t\tthis._items[i] = item;\n\t\tthis._priorities[i] = {\n\t\t\tpriority: (priority | 0),\n\t\t\tindex: i\n\t\t};\n\t\tthis._numItems++;\n\t\t// console.log(\"FrameQueue::RequestQueue::enqueue() [numItems:%i] ID:%i\", this._numItems, this._offset + i);\n\t\treturn this._offset + i;\n\t},\n\n\tcontains: function(index) {\n\t\tindex -= this.offset;\n\t\treturn 0 <= index && index < this._items.length;\n\t},\n\n\tskip: function(index) {\n\t\tvar i, item;\n\t\ti = index - this._offset;\n\t\tif (0 > i || i >= this._items.length) {\n\t\t\t// \tconsole.warn(\"FrameQueue::RequestQueue::skip(id:%i) out of range (%i-%i)\", index, this._offset, this._offset + (this._numItems - 1));\n\t\t\treturn void 0;\n\t\t}\n\t\titem = this._items[i];\n\t\tif (item !== null) {\n\t\t\t// if (item = this._items[i]) {\n\t\t\tthis._items[i] = null;\n\t\t\tthis._numItems--;\n\t\t}\n\t\treturn item;\n\t},\n\n\tindexes: function() {\n\t\tvar items = this._priorities.concat();\n\t\titems.sort(function(a, b) {\n\t\t\tif (a.priority > b.priority)\n\t\t\t\treturn 1;\n\t\t\tif (a.priority < b.priority)\n\t\t\t\treturn -1;\n\t\t\treturn 0;\n\t\t});\n\t\titems.forEach(function(o, i, a) {\n\t\t\ta[i] = o.index;\n\t\t}, this);\n\t\treturn items;\n\t},\n\n\titems: function() {\n\t\tvar items = this._priorities.concat();\n\t\titems.sort(function(a, b) {\n\t\t\tif (a.priority > b.priority)\n\t\t\t\treturn 1;\n\t\t\tif (a.priority < b.priority)\n\t\t\t\treturn -1;\n\t\t\treturn 0;\n\t\t});\n\t\titems.forEach(function(o, i, a) {\n\t\t\ta[i] = this._items[o.index];\n\t\t}, this);\n\t\treturn items;\n\t},\n\n\t_empty: function(offset) {\n\t\tthis._offset = offset;\n\t\tthis._items.length = 0;\n\t\tthis._priorities.length = 0;\n\t\tthis._numItems = 0;\n\t}\n}, {\n\n\toffset: {\n\t\tget: function() {\n\t\t\treturn this._offset;\n\t\t}\n\t},\n\n\tlength: {\n\t\tget: function() {\n\t\t\treturn this._items.length;\n\t\t}\n\t},\n\n\tnumItems: {\n\t\tget: function() {\n\t\t\treturn this._numItems;\n\t\t}\n\t},\n});\n\nvar CallbackQueue = function(requestFn, cancelFn) {\n\tthis._nextQueue = new PriorityQueue(0);\n\tthis._currQueue = null;\n\n\t// this._pending = false;\n\tthis._running = false;\n\tthis._runId = -1;\n\n\tthis._requestFn = requestFn;\n\tthis._cancelFn = cancelFn;\n\tthis._runQueue = this._runQueue.bind(this)\n};\n\nCallbackQueue.prototype = Object.create({\n\t/**\n\t * @param tstamp {int}\n\t */\n\t_runQueue: function() {\n\t\tif (this._running) throw new Error(\"wtf!!!\");\n\n\t\tthis._currQueue = this._nextQueue;\n\t\tthis._nextQueue = new PriorityQueue(this._currQueue.offset + this._currQueue.length);\n\n\t\tthis._runId = -1;\n\t\tthis._running = true;\n\n\t\tvar i, item;\n\t\tvar indexes = this._currQueue.indexes();\n\t\tvar items = this._currQueue._items;\n\t\tfor (i = 0; i < indexes.length; i++) {\n\t\t\titem = items[indexes[i]];\n\t\t\tif (item !== null) {\n\t\t\t\titem.apply(null, arguments);\n\t\t\t}\n\t\t}\n\n\t\t// var self = this;\n\t\t// this._currQueue.indexes().forEach(function(index) {\n\t\t// \tvar fn = self._currQueue._items[index];\n\t\t// \tif (fn !== null) {\n\t\t// \t\tfn.apply(null, arguments);\n\t\t// \t}\n\t\t// });\n\t\tthis._running = false;\n\t\tthis._currQueue = null;\n\n\t\tif (this._nextQueue.numItems > 0) {\n\t\t\tthis._runId = this._requestFn.call(null, this._runQueue);\n\t\t\t// this._runId = this._requestFn(this._runQueue);\n\t\t}\n\t},\n\n\t/**\n\t * @param fn {Function}\n\t * @param priority {int}\n\t * @return {int}\n\t */\n\trequest: function(fn, priority) {\n\t\t// if (!this._running && !this._pending) {\n\t\t// \tthis._pending = true;\n\t\t// \tconsole.warn(\"FrameQueue::request setImmediate: pending\");\n\t\t// \tsetImmediate(function() {\n\t\t// \t\tthis._pending = false;\n\t\t// \t\tif (this._nextQueue.numItems > 0) {\n\t\t// \t\t\tthis._runId = window.requestAnimationFrame(_runQueue);\n\t\t// \t\t\tconsole.warn(\"FrameQueue::request setImmediate: raf:%i for %i items\", this._runId, this._nextQueue.numItems);\n\t\t// \t\t} else {\n\t\t// \t\t\tconsole.warn(\"FrameQueue::request setImmediate: no items\");\n\t\t// \t\t}\n\t\t// \t});\n\t\t// }\n\t\tif (!this._running && this._runId === -1) {\n\t\t\tthis._runId = this._requestFn.call(null, this._runQueue);\n\t\t\t// this._runId = this._requestFn(this._runQueue);\n\t\t}\n\t\treturn this._nextQueue.enqueue(fn, priority);\n\t},\n\n\t/**\n\t * @param id {int}\n\t * @return {Function?}\n\t */\n\tcancel: function(id) {\n\t\tvar fn;\n\t\tif (this._running) {\n\t\t\tfn = this._currQueue.skip(id) || this._nextQueue.skip(id);\n\t\t} else {\n\t\t\tfn = this._nextQueue.skip(id);\n\t\t\tif ((this._runId !== -1) && (this._nextQueue.numItems === 0)) {\n\t\t\t\tthis._cancelFn.call(null, this._runId);\n\t\t\t\t// this._cancelFn(this._runId);\n\t\t\t\tthis._runId = -1;\n\t\t\t}\n\t\t}\n\t\treturn fn;\n\t},\n}, {\n\trunning: {\n\t\tget: function() {\n\t\t\treturn this._running;\n\t\t}\n\t}\n});\n\nmodule.exports = CallbackQueue;\n",
    "/* global Path2D */\n/**\n * @module app/view/component/progress/CanvasView\n */\n\n// /** @type {module:color} */\n// var Color = require(\"color\");\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/view/base/Interpolator} */\nvar Interpolator = require(\"app/view/base/Interpolator\");\n/** @type {module:utils/css/getBoxEdgeStyles} */\nvar getBoxEdgeStyles = require(\"utils/css/getBoxEdgeStyles\");\n\nvar MIN_CANVAS_RATIO = 1; // /Firefox/.test(window.navigator.userAgent)? 2 : 1;\n\n/**\n * @constructor\n * @type {module:app/view/component/progress/CanvasView}\n */\nvar CanvasView = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"canvasView\",\n\t/** @type {string} */\n\ttagName: \"canvas\",\n\t/** @type {string} */\n\tclassName: \"canvas-view\",\n\n\tproperties: {\n\t\tpaused: {\n\t\t\tget: function() {\n\t\t\t\treturn this._paused;\n\t\t\t},\n\t\t\tset: function(paused) {\n\t\t\t\tpaused = !!(paused);\n\t\t\t\tif (this._interpolator.paused !== paused) {\n\t\t\t\t\tthis._interpolator.paused = paused;\n\t\t\t\t\tif (!paused) {\n\t\t\t\t\t\tthis.requestRender();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tcontext: {\n\t\t\tget: function() {\n\t\t\t\treturn this._ctx;\n\t\t\t}\n\t\t},\n\t\tinterpolator: {\n\t\t\tget: function() {\n\t\t\t\treturn this._interpolator;\n\t\t\t}\n\t\t},\n\t\tcanvasRatio: {\n\t\t\tget: function() {\n\t\t\t\treturn this._canvasRatio;\n\t\t\t}\n\t\t},\n\t},\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tvalues: {\n\t\t\tvalue: 0\n\t\t},\n\t\tmaxValues: {\n\t\t\tvalue: 1\n\t\t},\n\t\tpaused: false,\n\t\tuseOpaque: false,\n\t},\n\n\t/* --------------------------- *\n\t * children/layout\n\t * --------------------------- */\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t// TODO: cleanup this options mess\n\t\toptions = _.defaults(options || {}, this.defaults);\n\t\toptions.values = _.defaults(options.values || {}, this.defaults.values);\n\t\toptions.maxValues = _.defaults(options.maxValues || {}, this.defaults.maxValues);\n\n\t\tthis._interpolator = new Interpolator(options.values, options.maxValues);\n\t\tthis._interpolator.paused = options.paused;\n\n\t\tthis._useOpaque = options.useOpaque;\n\t\tthis._options = _.pick(options, \"color\", \"backgroundColor\");\n\n\t\t// opaque background\n\t\t// --------------------------------\n\t\tvar ctxOpts = {};\n\t\t// if (this._useOpaque) {\n\t\t// \tthis._opaqueProp = Modernizr.prefixed(\"opaque\", this.el, false);\n\t\t// \tif (this._opaqueProp) {\n\t\t// \t\tthis.el[this._opaqueProp] = true;\n\t\t// \t} else {\n\t\t// \t\tctxOpts.alpha = true;\n\t\t// \t}\n\t\t// \tthis.el.classList.add(\"color-bg\");\n\t\t// }\n\n\t\t// canvas' context init\n\t\t// --------------------------------\n\t\tthis._ctx = this.el.getContext(\"2d\", ctxOpts);\n\n\t\t// adjust canvas size to pixel ratio\n\t\t// upscale the canvas if the two ratios don't match\n\t\t// --------------------------------\n\t\tvar ratio = MIN_CANVAS_RATIO;\n\t\tvar ctxRatio = this._ctx.webkitBackingStorePixelRatio || 1;\n\t\tif (window.devicePixelRatio !== ctxRatio) {\n\t\t\t// ratio = Math.max(window.devicePixelRatio / ctxRatio, MIN_CANVAS_RATIO);\n\t\t\tratio = window.devicePixelRatio / ctxRatio;\n\t\t\tratio = Math.max(ratio, MIN_CANVAS_RATIO);\n\t\t}\n\t\tthis._canvasRatio = ratio;\n\t\t// console.log(\"%s::init canvasRatio: %f\", this.cid, this._canvasRatio);\n\n\t\tthis.listenTo(this, \"view:attached\", function() {\n\t\t\t// this.invalidateSize();\n\t\t\t// this.renderNow();\n\t\t\tthis.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();\n\t\t});\n\t},\n\n\t// _computeCanvasRatio: function() {\n\t// \tvar ratio = MIN_CANVAS_RATIO;\n\t// \tvar ctxRatio = this._ctx.webkitBackingStorePixelRatio || 1;\n\t// \tif (window.devicePixelRatio !== ctxRatio) {\n\t// \t\t// ratio = Math.max(window.devicePixelRatio / ctxRatio, MIN_CANVAS_RATIO);\n\t// \t\tratio = window.devicePixelRatio / ctxRatio;\n\t// \t\tratio = Math.max(ratio, MIN_CANVAS_RATIO);\n\t// \t}\n\t// \tthis._canvasRatio = ratio;\n\t// },\n\n\t_updateCanvas: function() {\n\t\t// adjust canvas size to pixel ratio\n\t\t// upscale the canvas if the two ratios don't match\n\t\t// --------------------------------\n\n\t\tvar s = getComputedStyle(this.el);\n\n\t\t// this._canvasWidth = this.el.offsetWidth;\n\t\t// this._canvasHeight = this.el.offsetHeight;\n\t\tthis._canvasWidth = this.el.scrollWidth;\n\t\tthis._canvasHeight = this.el.scrollHeight;\n\n\t\tif (s.boxSizing === \"border-box\") {\n\t\t\tvar m = getBoxEdgeStyles(s);\n\t\t\tthis._canvasWidth -= m.paddingLeft + m.paddingRight + m.borderLeftWidth + m.borderRightWidth;\n\t\t\tthis._canvasHeight -= m.paddingTop + m.paddingBottom + m.borderTopWidth + m.borderBottomWidth;\n\t\t}\n\n\t\tthis._canvasWidth *= this._canvasRatio;\n\t\tthis._canvasHeight *= this._canvasRatio;\n\n\t\tthis.measureCanvas(this._canvasWidth, this._canvasHeight, s);\n\t\tthis.el.width = this._canvasWidth;\n\t\tthis.el.height = this._canvasHeight;\n\t\t// this.el.style.height = h + \"px\";\n\t\t// this.el.style.width = w + \"px\";\n\n\t\t// colors\n\t\t// --------------------------------\n\t\tthis._color = this._options.color ||\n\t\t\ts.color || Globals.DEFAULT_COLORS[\"color\"];\n\t\tthis._backgroundColor = this._options.backgroundColor ||\n\t\t\ts.backgroundColor || Globals.DEFAULT_COLORS[\"background-color\"];\n\n\t\t// mozOpaque\n\t\t// --------------------------------\n\t\tif (this._useOpaque && this._opaqueProp) {\n\t\t\t// this.el.style.backgroundColor = this._backgroundColor;\n\t\t\tthis.el[this._opaqueProp] = true;\n\t\t}\n\n\t\t// fontSize\n\t\t// --------------------------------\n\t\tthis._fontSize = parseFloat(s.fontSize) * this._canvasRatio;\n\t\tthis._fontFamily = s.fontFamily;\n\n\t\t// prepare canvas context\n\t\t// --------------------------------\n\t\tthis._ctx.restore();\n\n\t\tthis._ctx.font = [s.fontWeight, s.fontStyle, this._fontSize + \"px/1\", s.fontFamily].join(\" \");\n\t\tthis._ctx.textAlign = \"left\";\n\t\tthis._ctx.lineCap = \"butt\";\n\t\tthis._ctx.lineJoin = \"miter\";\n\t\tthis._ctx.strokeStyle = this._color;\n\t\tthis._ctx.fillStyle = this._color;\n\n\t\tthis.updateCanvas(this._ctx, s);\n\t\tthis._ctx.save();\n\n\t\t// console.group(this.cid+\"::_updateCanvas\");\n\t\t// console.log(\"ratio:    %f (min: %f, device: %f, context: %s)\", this._canvasRatio, MIN_CANVAS_RATIO, window.devicePixelRatio, this._ctx.webkitBackingStorePixelRatio || \"(webkit-only)\");\n\t\t// console.log(\"colors:   fg: %s bg: %s\", this._color, this._backgroundColor);\n\t\t// console.log(\"style:    %s, %s, padding: %s (%s)\", s.width, s.height, s.padding, s.boxSizing);\n\t\t// console.log(\"box:      %f x %f px\", m.width, m.height);\n\t\t// console.log(\"measured: %f x %f px\", w, h);\n\t\t// console.log(\"canvas:   %f x %f px\", this._canvasWidth, this._canvasHeight);\n\t\t// console.groupEnd();\n\t},\n\n\tmeasureCanvas: function(w, h, s) {\n\t\t/* abstract */\n\t},\n\n\tupdateCanvas: function(ctx, s) {\n\t\t/* abstract */\n\t},\n\n\t_getFontMetrics: function(str) {\n\t\tvar key, idx, mObj, mIdx = str.length;\n\t\tfor (key in Globals.FONT_METRICS) {\n\t\t\tidx = str.indexOf(key);\n\t\t\tif (idx !== -1 && idx < mIdx) {\n\t\t\t\tmIdx = idx;\n\t\t\t\tmObj = Globals.FONT_METRICS[key];\n\t\t\t}\n\t\t}\n\t\treturn mObj || {\n\t\t\t\"unitsPerEm\": 1024,\n\t\t\t\"ascent\": 939,\n\t\t\t\"descent\": -256\n\t\t};\n\t},\n\n\t_clearCanvas: function() {\n\t\tif (arguments.length == 4) {\n\t\t\tthis._clearCanvasRect.apply(this, arguments);\n\t\t} else {\n\t\t\tthis._ctx.save();\n\t\t\tthis._ctx.setTransform(1, 0, 0, 1, 0, 0);\n\t\t\tthis._clearCanvasRect(0, 0, this.el.width, this.el.height);\n\t\t\tthis._ctx.restore();\n\t\t}\n\t},\n\n\t_clearCanvasRect: function(x, y, w, h) {\n\t\tthis._ctx.clearRect(x, y, w, h);\n\t\tif (this._useOpaque) {\n\t\t\tthis._ctx.save();\n\t\t\tthis._ctx.fillStyle = this._backgroundColor;\n\t\t\tthis._ctx.fillRect(x, y, w, h);\n\t\t\tthis._ctx.restore();\n\t\t}\n\t},\n\n\t_setStyle: function(s) {\n\t\tCanvasView.setStyle(this._ctx, s);\n\t},\n\n\t/* --------------------------- *\n\t * render\n\t * --------------------------- */\n\n\t/** @override */\n\trender: function() {\n\t\tif (this.attached) {\n\t\t\treturn this.renderNow();\n\t\t}\n\t\treturn this;\n\t},\n\n\t/** @override */\n\trenderFrame: function(tstamp, flags) {\n\t\tif (!this.attached) {\n\t\t\treturn flags;\n\t\t}\n\t\tif (flags & View.SIZE_INVALID) {\n\t\t\tthis._updateCanvas();\n\t\t}\n\t\tif (this._interpolator.valuesChanged) {\n\t\t\tflags |= View.LAYOUT_INVALID;\n\t\t\tthis._interpolator.interpolate(tstamp);\n\t\t}\n\t\tif (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {\n\t\t\tthis.redraw(this._ctx, this._interpolator, flags);\n\t\t\tif (this._interpolator.valuesChanged) {\n\t\t\t\tthis.requestRender();\n\t\t\t}\n\t\t}\n\t},\n\n\t// setEnabled: function(enabled) {\n\t// \tView.prototype.setEnabled.apply(this, arguments);\n\t// \tif (this.attached) {\n\t// \t\tconsole.info(\"[%s] %s::setEnabled\", this.parentView.cid, this.cid, this.enabled);\n\t// \t\t// if (this._enabled && this._interpolator.valuesChanged) {\n\t// \t\t// this.requestRender();\n\t// \t\t// this.requestRender(CanvasView.LAYOUT_INVALID);\n\t// \t\t// }\n\t// \t}\n\t// },\n\n\t/* --------------------------- *\n\t/* public\n\t/* --------------------------- */\n\n\tgetTargetValue: function(key) {\n\t\treturn this._interpolator.getTargetValue(key);\n\t},\n\n\tgetRenderedValue: function(key) {\n\t\treturn this._interpolator.getRenderedValue(key);\n\t},\n\n\tvalueTo: function(key, value, duration) {\n\t\tthis._interpolator.valueTo(key, value, duration);\n\t\tthis.requestRender(View.MODEL_INVALID | View.LAYOUT_INVALID);\n\t},\n\n\t// updateValue: function(key) {\n\t// \treturn this._interpolator.updateValue(key || this.defaultKey);\n\t// },\n\n\t/* --------------------------- *\n\t/* redraw\n\t/* --------------------------- */\n\n\tredraw: function(ctx, interp, flags) {},\n\n}, {\n\tsetStyle: function(ctx, s) {\n\t\tif (typeof s != \"object\") return;\n\t\tfor (var p in s) {\n\t\t\tswitch (typeof ctx[p]) {\n\t\t\t\tcase \"undefined\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"function\":\n\t\t\t\t\tif (Array.isArray(s[p])) ctx[p].apply(ctx, s[p]);\n\t\t\t\t\telse ctx[p].call(ctx, s[p]);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tctx[p] = s[p];\n\t\t\t}\n\t\t}\n\t}\n});\n\nif (DEBUG) {\n\tCanvasView.prototype._logFlags = \"\";\n}\n\nmodule.exports = CanvasView;\n",
    "/**\n * @module app/view/base/Interpolator\n */\n\n/** @type {module:utils/ease/fn/linear} */\nvar linear = require(\"utils/ease/fn/linear\");\n\n/**\n * @constructor\n * @type {module:app/view/base/Interpolator}\n */\nvar Interpolator = function(values, maxValues, easeValues) {\n\tthis._tstamp = 0;\n\n\t// gets thrown away by first interpolate() but avoid null access errors\n\tthis._renderableKeys = [];\n\tthis._renderedKeys = [];\n\n\tthis._paused = false;\n\tthis._pausedChanging = false;\n\t//this._pausedKeys = [];\n\n\tthis._maxValues = _.isObject(maxValues) ? _.extend({}, maxValues) : {};\n\tthis._easeFn = _.isObject(easeValues) ? _.extend({}, easeValues) : {};\n\tthis._valueData = {};\n\n\t// var key, val, maxVal, easeFn;\n\tfor (var key in values) {\n\t\t_.isNumber(this._maxValues[key]) || (this._maxValues[key] = null);\n\t\t_.isFunction(this._easeFn[key]) || (this._easeFn[key] = linear);\n\n\t\t// create value object and store it\n\t\tthis._valueData[key] = this._initValue(values[key], 0, this._maxValues[key]);\n\n\t\t// add to next render list\n\t\tthis._renderableKeys.push(key);\n\t}\n};\n\nInterpolator.prototype = Object.create({\n\n\t/* --------------------------- *\n\t/* public interface\n\t/* --------------------------- */\n\n\tisAtTarget: function(key) {\n\t\treturn this._renderableKeys.indexOf(key) === -1;\n\t},\n\n\tgetCurrentValue: function(key) {\n\t\treturn this._valueData[key]._renderedValue || this._valueData[key]._value;\n\t},\n\n\tgetTargetValue: function(key) {\n\t\treturn this._valueData[key]._value;\n\t},\n\n\tgetStartValue: function(key) {\n\t\treturn this._valueData[key]._startValue;\n\t},\n\n\tgetRenderedValue: function(key) {\n\t\treturn this._valueData[key]._renderedValue;\n\t},\n\n\tgetOption: function(key, opt) {\n\t\tif (opt === \"max\") return this._maxValues[key];\n\t\tif (opt === \"ease\") return this._easeFn[key];\n\t},\n\n\tvalueTo: function(key, value, duration, ease) {\n\t\tvar changed, dataObj = this._valueData[key];\n\t\tif (_.isFunction(ease)) {\n\t\t\tthis._easeFn[key] = ease;\n\t\t}\n\t\t// console.log(\"%s::valueTo [%s]\", \"[interpolator]\", key, value);\n\t\tif (Array.isArray(dataObj)) {\n\t\t\tchanged = value.reduce(function(prevChanged, itemValue, i) {\n\t\t\t\tif (dataObj[i]) {\n\t\t\t\t\tdataObj[i] = this._initNumber(itemValue, duration, this._maxValues[key]);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn this._setValue(dataObj[i], itemValue, duration) || prevChanged;\n\t\t\t}.bind(this), changed);\n\t\t} else {\n\t\t\tchanged = this._setValue(dataObj, value, duration);\n\t\t}\n\t\tif (changed) {\n\t\t\tthis._renderableKeys.indexOf(key) !== -1 || this._renderableKeys.push(key);\n\t\t}\n\t\treturn this;\n\t},\n\n\tupdateValue: function(key) {\n\t\t// Call _interpolateKey only if needed. _interpolateKey() returns false\n\t\t// once interpolation is done, in which case remove key from _renderableKeys.\n\t\tvar kIndex = this._renderableKeys.indexOf(key);\n\t\tif (kIndex !== -1 && !this._interpolateKey(key)) {\n\t\t\tthis._renderableKeys.splice(kIndex, 1);\n\t\t}\n\t\treturn this;\n\t},\n\n\t/* --------------------------- *\n\t/* private: valueData\n\t/* --------------------------- */\n\n\t_initValue: function(value, duration, maxVal) {\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(function(val) {\n\t\t\t\treturn this._initNumber(val, duration, maxVal);\n\t\t\t}, this);\n\t\t}\n\t\treturn this._initNumber(value, duration, maxVal);\n\t},\n\n\t_initNumber: function(value, duration, maxVal) {\n\t\tvar o = {};\n\t\to._value = value;\n\t\to._startValue = value;\n\t\to._valueDelta = 0;\n\n\t\to._duration = duration || 0;\n\t\to._startTime = NaN;\n\t\to._elapsedTime = NaN;\n\n\t\to._lastRenderedValue = null;\n\t\to._renderedValue = o._startValue;\n\n\t\to._maxVal = maxVal;\n\t\t// if (maxVal !== void 0) o._maxVal = maxVal;\n\t\t// o._maxVal = this._maxValues[key];\n\t\t// o._maxVal = this._maxVal;// FIXME\n\t\treturn o;\n\t},\n\n\t_setValue: function(o, value, duration) {\n\t\tif (o._value !== value) {\n\t\t\to._startValue = o._value;\n\t\t\to._valueDelta = value - o._value;\n\t\t\to._value = value;\n\n\t\t\to._duration = duration || 0;\n\t\t\to._startTime = NaN;\n\t\t\to._elapsedTime = NaN;\n\n\t\t\t// o._lastRenderedValue = o._renderedValue;\n\t\t\t// o._renderedValue = o._startValue;\n\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\n\t/* --------------------------- *\n\t/* private: interpolate\n\t/* --------------------------- */\n\n\t_tstamp: 0,\n\n\t/** @override */\n\tinterpolate: function(tstamp) {\n\t\tthis._tstamp = tstamp;\n\n\t\tif (this.valuesChanged) {\n\t\t\tif (this._pausedChanging) {\n\t\t\t\tthis._renderableKeys.forEach(function(key) {\n\t\t\t\t\tvar o = this._valueData[key];\n\t\t\t\t\tif (!isNaN(o._elapsedTime)) {\n\t\t\t\t\t\to._startTime = tstamp - o._elapsedTime;\n\t\t\t\t\t}\n\t\t\t\t}, this);\n\t\t\t\tthis._pausedChanging = false;\n\t\t\t}\n\t\t\tvar changedKeys = this._renderableKeys;\n\t\t\tthis._renderableKeys = changedKeys.filter(function(key) {\n\t\t\t\treturn this._interpolateValue(tstamp, this._valueData[key], this._easeFn[key]);\n\t\t\t}, this);\n\t\t\tthis._renderedKeys = changedKeys;\n\t\t}\n\t\treturn this;\n\t},\n\n\t_interpolateKey: function(key) {\n\t\treturn this._interpolateValue(this._tstamp, this._valueData[key], this._easeFn[key]);\n\t},\n\n\t_interpolateValue: function(tstamp, o, fn) {\n\t\tif (Array.isArray(o)) {\n\t\t\treturn o.reduce(function(changed, item, index, arr) {\n\t\t\t\treturn this._interpolateNumber(tstamp, item, fn) || changed;\n\t\t\t}.bind(this), false);\n\t\t}\n\t\treturn this._interpolateNumber(tstamp, o, fn);\n\t},\n\n\t_interpolateNumber: function(tstamp, o, fn) {\n\t\tif (isNaN(o._startTime)) {\n\t\t\to._startTime = tstamp;\n\t\t}\n\t\to._lastRenderedValue = o._renderedValue;\n\n\t\tvar elapsed = Math.max(0, tstamp - o._startTime);\n\t\tif (elapsed < o._duration) {\n\t\t\tif (o._maxVal && o._valueDelta < 0) {\n\t\t\t\t// upper-bound values\n\t\t\t\to._renderedValue = fn(elapsed, o._startValue,\n\t\t\t\t\to._valueDelta + o._maxVal, o._duration) - o._maxVal;\n\t\t\t} else {\n\t\t\t\t// unbound values\n\t\t\t\to._renderedValue = fn(elapsed, o._startValue,\n\t\t\t\t\to._valueDelta, o._duration);\n\t\t\t}\n\t\t\to._elapsedTime = elapsed;\n\t\t\treturn true;\n\t\t}\n\t\to._renderedValue = o._value;\n\t\to._elapsedTime = NaN;\n\t\to._startTime = NaN;\n\t\treturn false;\n\t},\n}, {\n\t/**\n\t * @type {boolean}\n\t */\n\tpaused: {\n\t\tget: function() {\n\t\t\treturn this._paused;\n\t\t},\n\t\tset: function(value) {\n\t\t\tvalue = !!(value); // Convert to boolean\n\t\t\tif (this._paused !== value) {\n\t\t\t\tthis._paused = value;\n\t\t\t\tthis._pausedChanging = true;\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * @type {boolean} Has any value been changed by valueTo() since last interpolate()\n\t */\n\tvaluesChanged: {\n\t\tget: function() {\n\t\t\treturn !this._paused && this._renderableKeys.length > 0;\n\t\t}\n\t},\n\t/**\n\t * @type {array} Keys that are not yet at target value\n\t */\n\trenderableKeys: {\n\t\tget: function() {\n\t\t\treturn this._renderableKeys;\n\t\t}\n\t},\n\t/**\n\t * @type {array} Keys that have been rendered in the last interpolate()\n\t */\n\trenderedKeys: {\n\t\tget: function() {\n\t\t\treturn this._renderedKeys;\n\t\t}\n\t},\n\t/**\n\t * @type {array} All keys\n\t */\n\tkeys: {\n\t\tget: function() {\n\t\t\treturn Object.keys(this._valueData);\n\t\t}\n\t},\n});\n\nmodule.exports = Interpolator;\n",
    "/** @type {module:utils/prefixedEvent} */\nvar prefixedEvent = require(\"utils/prefixedEvent\");\n\nvar eventMap = {\n\t\"transitionend\": prefixedEvent(\"transitionend\"),\n\t\"fullscreenchange\": prefixedEvent(\"fullscreenchange\", document),\n\t\"fullscreenerror\": prefixedEvent(\"fullscreenerror\", document),\n\t\"visibilitychange\": prefixedEvent(\"visibilitychange\", document, \"hidden\")\n};\n\nvar eventNum = 0;\nfor (var eventName in eventMap) {\n\tif (eventName === eventMap[eventName]) {\n\t\tdelete eventMap[eventName];\n\t} else {\n\t\tObject.defineProperty(eventMap, eventName, {\n\t\t\tvalue: eventMap[eventName],\n\t\t\tenumerable: true\n\t\t});\n\t\tObject.defineProperty(eventMap, eventNum, {\n\t\t\tvalue: eventName,\n\t\t\tenumerable: false\n\t\t});\n\t\teventNum++;\n\t}\n}\nObject.defineProperty(eventMap, \"length\", {\n\tvalue: eventNum\n});\n\nif (DEBUG) {\n\tconsole.log(\"prefixes enabled for %i events\", eventMap.length, Object.keys(eventMap));\n}\n\nmodule.exports = eventMap;\n\n// module.exports = eventNum > 0? eventMap : null;\n",
    "/**\n * @module app/view/base/TouchManager\n */\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:hammerjs} */\nvar Hammer = require(\"hammerjs\");\n// /** @type {module:hammerjs.Tap} */\n// var Tap = Hammer.Tap;\n// /** @type {module:utils/touch/SmoothPanRecognizer} */\n// var Pan = require(\"utils/touch/SmoothPanRecognizer\");\n/** @type {module:hammerjs.Pan} */\nvar Pan = Hammer.Pan;\n\n/* -------------------------------\n/* Static private\n/* ------------------------------- */\n\n/**\n * @param el HTMLElement\n * @return {Hammer.Manager}\n */\nfunction createInstance(el) {\n\tvar manager = new Hammer.Manager(el);\n\t// manager.set({ domevents: true });\n\n\t// var tap = new Hammer.Tap({\n\t// \tthreshold: Globals.PAN_THRESHOLD - 1\n\t// });\n\t// manager.add(tap);\n\tvar hpan = new Pan({\n\t\tevent: \"hpan\",\n\t\tdirection: Hammer.DIRECTION_HORIZONTAL,\n\t\tthreshold: Globals.PAN_THRESHOLD,\n\t\t// touchAction: \"pan-y\",\n\t});\n\tmanager.add(hpan);\n\n\t// var vpan = new Pan({\n\t// \tevent: \"vpan\",\n\t// \tdirection: Hammer.DIRECTION_VERTICAL,\n\t// \t// threshold: Globals.PAN_THRESHOLD,\n\t// \t// touchAction: \"pan-x\",\n\t// });\n\t// manager.add(vpan);\n\t// vpan.requireFailure(hpan);\n\n\treturn manager;\n}\n\n/* -------------------------------\n/* Global hammer handlers\n/* ------------------------------- */\n\nvar touchHandlers = {};\n\n/*https://gist.githubusercontent.com/jtangelder/361052976f044200ea17/raw/f54c2cef78d59da3f38286fad683471e1c976072/PreventGhostClick.js*/\nvar lastTimeStamp = -1;\nvar panSessionOpened = false;\n\nvar saveTimeStamp = function(hev) {\n\tpanSessionOpened = !hev.isFinal;\n\tif (hev.isFinal) {\n\t\tlastTimeStamp = hev.srcEvent.timeStamp;\n\t}\n};\ntouchHandlers[\"vpanstart vpanend vpancancel\"] =\n\ttouchHandlers[\"hpanstart hpanend hpancancel\"] = saveTimeStamp;\n\nvar preventSrcEvent = function(hev) {\n\t//console.log(hev.type, \"preventDefault\");\n\thev.srcEvent.preventDefault();\n};\ntouchHandlers[\"vpanmove vpanend vpancancel\"] =\n\ttouchHandlers[\"hpanmove hpanend hpancancel\"] = preventSrcEvent;\n\n// var logHammerEvent = function(hev) {\n// \tvar msgs = [];\n// \tvar domev = hev.srcEvent;\n// \tmsgs.push(panSessionOpened ? \"panning\" : \"pan: \" + lastTimeStamp.toFixed(3));\n// \tif (domev.defaultPrevented) msgs.push(\"prevented\");\n// \tconsole.log(\"TouchManager %s [%s] [%o]\",\n// \t\tdomev.timeStamp.toFixed(3),\n// \t\tdomev.type,\n// \t\thev.type,\n// \t\tmsgs.join(\", \")\n// \t);\n// };\n// touchHandlers[[\n// \t\"vpanstart\", \"vpanend\", \"vpancancel\", \"vpanmove\",\n// \t\"hpanstart\", \"hpanend\", \"hpancancel\", \"hpanmove\"\n// ].join(\" \")] = logHammerEvent;\n\n/* -------------------------------\n/* DOM event handlers\n/* ------------------------------- */\n\nvar captureHandlers = {};\nvar bubblingHandlers = {};\n// var upEventName = window.hasOwnProperty(\"onpointerup\") ? \"pointerup\" : \"mouseup\";\n\n/* eslint-disable-next-line */\nvar logDOMEvent = function(domev, msg) {\n\tvar msgs = [];\n\tif (domev.defaultPrevented) msgs.push(\"prevented\");\n\tif (msg) msgs.push(msg);\n\tconsole.log(\"TouchManager %s [%o]\",\n\t\tdomev.timeStamp.toFixed(3),\n\t\tdomev.type,\n\t\tmsgs.join(\", \")\n\t);\n};\n// var preventWhilePanning = function(domev) {\n// panSessionOpened && domev.preventDefault();\n// };\n// var preventWhileNotPanning = function(domev) {\n// \t!panSessionOpened && domev.preventDefault();\n// };\n// captureHandlers[upEventName] = preventWhilePanning;\n\ncaptureHandlers[\"click\"] = function(domev) {\n\tif (lastTimeStamp === domev.timeStamp) {\n\t\tlastTimeStamp = -1;\n\t\tdomev.defaultPrevented || domev.preventDefault();\n\t}\n};\n\n// captureHandlers[\"touchmove\"] = captureHandlers[\"mousemove\"] = logDOMEvent;\n\n// -------------------------------\n//\n// -------------------------------\n\nfunction addHandlers() {\n\tvar eventName, el = instance.element;\n\tfor (eventName in touchHandlers)\n\t\tif (touchHandlers.hasOwnProperty(eventName))\n\t\t\tinstance.on(eventName, touchHandlers[eventName]);\n\tfor (eventName in captureHandlers)\n\t\tif (captureHandlers.hasOwnProperty(eventName))\n\t\t\tel.addEventListener(eventName, captureHandlers[eventName], true);\n\tfor (eventName in bubblingHandlers)\n\t\tif (bubblingHandlers.hasOwnProperty(eventName))\n\t\t\tel.addEventListener(eventName, bubblingHandlers[eventName], false);\n\t// document.addEventListener(\"touchmove\", preventWhileNotPanning, false);\n}\n\nfunction removeHandlers() {\n\tvar eventName, el = instance.element;\n\tfor (eventName in captureHandlers)\n\t\tif (captureHandlers.hasOwnProperty(eventName))\n\t\t\tel.removeEventListener(eventName, captureHandlers[eventName], true);\n\tfor (eventName in bubblingHandlers)\n\t\tif (captureHandlers.hasOwnProperty(eventName))\n\t\t\tel.removeEventListener(eventName, bubblingHandlers[eventName], true);\n\t// document.removeEventListener(\"touchmove\", preventWhileNotPanning, false);\n}\n\n/** @type {Hammer.Manager} */\nvar instance = null;\n\n/* -------------------------------\n/* Static public\n/* ------------------------------- */\n\nvar TouchManager = {\n\tinit: function(target) {\n\t\tif (instance === null) {\n\t\t\tinstance = createInstance(target);\n\t\t\taddHandlers();\n\t\t} else if (instance.element !== target) {\n\t\t\tconsole.warn(\"TouchManager already initialized with another element\");\n\t\t}\n\t\treturn instance;\n\t},\n\n\tdestroy: function() {\n\t\tif (instance !== null) {\n\t\t\tremoveHandlers();\n\t\t\tinstance.destroy();\n\t\t\tinstance = null;\n\t\t} else {\n\t\t\tconsole.warn(\"no instance to destroy\");\n\t\t}\n\t},\n\n\tgetInstance: function() {\n\t\tif (instance === null) {\n\t\t\tconsole.error(\"TouchManager has not been initialized\");\n\t\t}\n\t\treturn instance;\n\t}\n};\n\nmodule.exports = TouchManager;\n\n/*\n// alt syntax\nfunction createInstance(el) {\n\treturn new Hammer(el, {\n\t\trecognizers: [\n\t\t\t[Tap],\n\t\t\t[Pan, {\n\t\t\t\tevent: 'hpan',\n\t\t\t\tdirection: Hammer.DIRECTION_HORIZONTAL,\n\t\t\t\tthreshold: Globals.THRESHOLD\n\t\t\t}],\n\t\t\t[Pan, {\n\t\t\t\tevent: 'vpan',\n\t\t\t\tdirection: Hammer.DIRECTION_VERTICAL,\n\t\t\t\tthreshold: Globals.THRESHOLD\n\t\t\t}, ['hpan']]\n\t\t]\n\t});\n}\n*/\n",
    "/* global HTMLElement, MutationObserver */\n/**\n * @module app/view/base/View\n */\n\n/** @type {module:setimmediate} */\nrequire(\"setimmediate\");\n\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n\n/* -------------------------------\n/* MutationObserver\n/* ------------------------------- */\n\nvar _cidSeed = 1;\nvar _viewsByCid = {};\n\nfunction addChildViews(el) {\n\tvar view, els = el.querySelectorAll(\"*[data-cid]\");\n\tfor (var i = 0, ii = els.length; i < ii; i++) {\n\t\tview = View.findByElement(els.item(i));\n\t\tif (view) {\n\t\t\tif (!view.attached) {\n\t\t\t\t// console.log(\"View::[attached (parent)] %s\", view.cid);\n\t\t\t\tview._elementAttached();\n\t\t\t\t// } else {\n\t\t\t\t// \tconsole.warn(\"View::[attached (parent)] %s (ignored)\", view.cid);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction removeChildViews(el) {\n\tvar view, els = el.querySelectorAll(\"*[data-cid]\");\n\tfor (var i = 0, ii = els.length; i < ii; i++) {\n\t\tview = View.findByElement(els.item(i));\n\t\tif (view) {\n\t\t\tif (view.attached) {\n\t\t\t\tconsole.log(\"View::[detached (parent)] %s\", view.cid);\n\t\t\t\tview._elementDetached();\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"View::[detached (parent)] %s (ignored)\", view.cid);\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar observer = new MutationObserver(function(mm) {\n\t// console.log(\"View::mutations %s\", JSON.stringify(mm, null, \" \"));\n\tvar i, ii, m;\n\tvar j, jj, e;\n\tvar view;\n\tfor (i = 0, ii = mm.length; i < ii; i++) {\n\t\tm = mm[i];\n\t\tif (m.type == \"childList\") {\n\t\t\tfor (j = 0, jj = m.addedNodes.length; j < jj; j++) {\n\t\t\t\te = m.addedNodes.item(j);\n\t\t\t\tview = View.findByElement(e);\n\t\t\t\tif (view) {\n\t\t\t\t\tif (!view.attached) {\n\t\t\t\t\t\t// console.log(\"View::[attached (childList)] %s\", view.cid);\n\t\t\t\t\t\tview._elementAttached();\n\t\t\t\t\t\t// } else {\n\t\t\t\t\t\t// \tconsole.warn(\"View::[attached (childList)] %s (ignored)\", view.cid);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (e instanceof HTMLElement) addChildViews(e);\n\t\t\t}\n\t\t\tfor (j = 0, jj = m.removedNodes.length; j < jj; j++) {\n\t\t\t\te = m.removedNodes.item(j);\n\t\t\t\t// console.log(\"View::[detached (childList)] %s\", e.cid);\n\t\t\t\tview = View.findByElement(e);\n\t\t\t\tif (view) {\n\t\t\t\t\tif (view.attached) {\n\t\t\t\t\t\tconsole.log(\"View::[detached (childList)] %s\", view.cid, view.attached);\n\t\t\t\t\t\tview._elementDetached();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"View::[detached (childList)] %s (ignored)\", view.cid, view.attached);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (e instanceof HTMLElement) removeChildViews(e);\n\t\t\t}\n\t\t} else if (m.type == \"attributes\") {\n\t\t\tview = View.findByElement(m.target);\n\t\t\tif (view) {\n\t\t\t\tif (!view.attached) {\n\t\t\t\t\t// console.log(\"View::[attached (attribute)] %s\", view.cid);\n\t\t\t\t\tview._elementAttached();\n\t\t\t\t\t// } else {\n\t\t\t\t\t// \tconsole.warn(\"View::[attached (attribute)] %s (ignored)\", view.cid);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// else {\n\t\t\t// \tconsole.warn(\"View::[attributes] target has no cid (%s='%s')\", m.attributeName, m.target.getAttribute(m.attributeName), m);\n\t\t\t// }\n\t\t}\n\t}\n});\n\nobserver.observe(document.body, {\n\tattributes: true,\n\tchildList: true,\n\tsubtree: true,\n\tattributeFilter: [\"data-cid\"]\n});\n\n/* -------------------------------\n/* static private\n/* ------------------------------- */\n\nvar _now = window.performance ?\n\twindow.performance.now.bind(window.performance) :\n\tDate.now.bind(Date);\n// var _now = window.performance?\n// \tfunction() { return window.performance.now(); }:\n// \tfunction() { return Date.now(); };\n\n// /** @type {module:app/view/base/renderQueue} */\n// var renderQueue = require(\"app/view/base/renderQueue\");\n//\n/** @type {module:app/view/base/CallbackQueue} */\nvar renderQueue = (function(CallbackQueue) {\n\treturn new CallbackQueue(\n\t\tfunction(callback) {\n\t\t\treturn window.requestAnimationFrame(callback);\n\t\t},\n\t\tfunction(id) {\n\t\t\treturn window.cancelAnimationFrame(id);\n\t\t}\n\t);\n})(require(\"app/view/base/CallbackQueue\"));\n\n/** @type {module:app/view/base/CallbackQueue} */\nvar modelQueue = (function(CallbackQueue) {\n\treturn new CallbackQueue(\n\t\tfunction(callback) {\n\t\t\treturn window.setImmediate(function() {\n\t\t\t\tcallback.call(null, _now());\n\t\t\t});\n\t\t},\n\t\tfunction(id) {\n\t\t\treturn window.clearImmediate(id);\n\t\t}\n\t);\n})(require(\"app/view/base/CallbackQueue\"));\n\n/** @type {module:app/view/base/PrefixedEvents} */\nvar PrefixedEvents = require(\"app/view/base/PrefixedEvents\");\n\nvar applyEventPrefixes = function(events) {\n\tvar selector, unprefixed;\n\tfor (selector in events) {\n\t\tunprefixed = selector.match(/^\\w+/i)[0];\n\t\tif (PrefixedEvents.hasOwnProperty(unprefixed)) {\n\t\t\tevents[selector.replace(unprefixed, PrefixedEvents[unprefixed])] = events[selector];\n\t\t\t// console.log(\"applyEventPrefixes\", unprefixed, prefixedEvents[unprefixed]);\n\t\t\tdelete events[selector];\n\t\t}\n\t}\n\treturn events;\n};\n\nvar getViewDepth = function(view) {\n\tif (!view) {\n\t\treturn null;\n\t}\n\tif (!view.attached) {\n\t\treturn NaN;\n\t}\n\tif (view.parentView === null) {\n\t\treturn 0;\n\t}\n\treturn view.parentView.viewDepth + 1;\n};\n\nfunction logAttachInfo(view, name, level) {\n\tif ([\"log\", \"info\", \"warn\", \"error\"].indexOf(level) != -1) {\n\t\tlevel = \"log\";\n\t}\n\tconsole[level].call(console, \"%s::%s [parent:%s %s %s depth:%s]\", view.cid, name, view.parentView && view.parentView.cid, view.attached ? \"attached\" : \"detached\", view._viewPhase, view.viewDepth);\n}\n\n/* -------------------------------\n/* static public\n/* ------------------------------- */\n\n\nvar View = {\n\n\t/** @const */\n\tNONE_INVALID: 0,\n\t/** @const */\n\tALL_INVALID: ~0 >>> 1,\n\n\t/** @const */\n\tCHILDREN_INVALID: 1,\n\t/** @const */\n\tMODEL_INVALID: 2,\n\t/** @const */\n\tSTYLES_INVALID: 4,\n\t/** @const */\n\tSIZE_INVALID: 8,\n\t/** @const */\n\tLAYOUT_INVALID: 16,\n\n\t/** @const */\n\tCLICK_EVENT: \"click\", //window.hasOwnProperty(\"onpointerup\") ? \"pointerup\" : \"mouseup\",\n\n\t/** @type {module:app/view/base/ViewError} */\n\tViewError: require(\"app/view/base/ViewError\"),\n\n\t/** @type {module:utils/prefixedProperty} */\n\tprefixedProperty: require(\"utils/prefixedProperty\"),\n\n\t/** @type {module:utils/prefixedStyleName} */\n\tprefixedStyleName: require(\"utils/prefixedStyleName\"),\n\n\t/** @type {module:utils/prefixedEvent} */\n\tprefixedEvent: require(\"utils/prefixedEvent\"),\n\n\t/** @type {module:app/view/promise/whenViewIsAttached} */\n\twhenViewIsAttached: require(\"app/view/promise/whenViewIsAttached\"),\n\n\t/** @type {module:app/view/promise/whenViewIsRendered} */\n\twhenViewIsRendered: require(\"app/view/promise/whenViewIsRendered\"),\n\n\t/**\n\t/* @param el {HTMLElement}\n\t/* @return {module:app/view/base/View}\n\t/*/\n\tfindByElement: function(el) {\n\t\tif (_viewsByCid[el.cid]) {\n\t\t\treturn _viewsByCid[el.cid];\n\t\t}\n\t\treturn null;\n\t},\n\n\t/**\n\t/* @param el {HTMLElement}\n\t/* @return {module:app/view/base/View}\n\t/*/\n\tfindByDescendant: function(el) {\n\t\tdo {\n\t\t\tif (_viewsByCid[el.cid]) {\n\t\t\t\treturn _viewsByCid[el.cid];\n\t\t\t}\n\t\t} while ((el = el.parentElement || el.parentNode));\n\t\treturn null;\n\t},\n\n\t/** @override */\n\textend: function(proto, obj) {\n\t\tif (PrefixedEvents.length && proto.events) {\n\t\t\tif (_.isFunction(proto.events)) {\n\t\t\t\tproto.events = _.wrap(proto.events, function(fn) {\n\t\t\t\t\treturn applyEventPrefixes(fn.apply(this));\n\t\t\t\t});\n\t\t\t} else\n\t\t\tif (_.isObject(proto.events)) {\n\t\t\t\tproto.events = applyEventPrefixes(proto.events);\n\t\t\t}\n\t\t}\n\t\tif (proto.properties && this.prototype.properties) {\n\t\t\t_.defaults(proto.properties, this.prototype.properties);\n\t\t}\n\t\treturn Backbone.View.extend.apply(this, arguments);\n\t},\n\n\t_flagsToStrings: [\"-\"],\n\n\tflagsToString: function(flags) {\n\t\tvar s = View._flagsToStrings[flags | 0];\n\t\tif (!s) {\n\t\t\ts = [];\n\t\t\tif (flags & View.CHILDREN_INVALID) s.push(\"children\");\n\t\t\tif (flags & View.MODEL_INVALID) s.push(\"model\");\n\t\t\tif (flags & View.STYLES_INVALID) s.push(\"styles\");\n\t\t\tif (flags & View.SIZE_INVALID) s.push(\"size\");\n\t\t\tif (flags & View.LAYOUT_INVALID) s.push(\"layout\");\n\t\t\tView._flagsToStrings[flags] = s = s.join(\" \");\n\t\t}\n\t\treturn s;\n\t\t// return (flags | 0).toString(2);\n\t},\n};\n\nObject.defineProperty(View, \"instances\", {\n\tvalue: _viewsByCid,\n\tenumerable: true\n});\n\n/* -------------------------------\n/* prototype\n/* ------------------------------- */\n\n// module.exports = Backbone.View.extend({\nvar ViewProto = {\n\n\t/** @type {string} */\n\tcidPrefix: \"view\",\n\t/** @type {Boolean} */\n\t_attached: false,\n\t/** @type {HTMLElement|null} */\n\t_parentView: null,\n\t/** @type {int|null} */\n\t_viewDepth: null,\n\t/** @type {string} initializing > initialized > disposing > disposed */\n\t_viewPhase: \"initializing\",\n\t/** @type {int} */\n\t_renderQueueId: -1,\n\t/** @type {int} */\n\t_renderFlags: 0,\n\t/** @type {Boolean} */\n\t_enabled: null,\n\n\t/** @type {object} */\n\tproperties: {\n\t\tcid: {\n\t\t\tget: function() {\n\t\t\t\treturn this._cid || (this._cid = this.cidPrefix + _cidSeed++);\n\t\t\t}\n\t\t},\n\t\tattached: {\n\t\t\tget: function() {\n\t\t\t\treturn this._attached;\n\t\t\t}\n\t\t},\n\t\tparentView: {\n\t\t\tget: function() {\n\t\t\t\treturn this._parentView;\n\t\t\t}\n\t\t},\n\t\tviewDepth: {\n\t\t\tget: function() {\n\t\t\t\treturn this._getViewDepth();\n\t\t\t}\n\t\t},\n\t\tinvalidated: {\n\t\t\tget: function() {\n\t\t\t\treturn this._renderQueueId !== -1;\n\t\t\t}\n\t\t},\n\t\tenabled: {\n\t\t\tget: function() {\n\t\t\t\treturn this._enabled;\n\t\t\t},\n\t\t\tset: function(enabled) {\n\t\t\t\tthis.setEnabled(enabled);\n\t\t\t}\n\t\t},\n\t\trenderFlags: {\n\t\t\tget: function() {\n\t\t\t\treturn this._renderFlags;\n\t\t\t}\n\t\t}\n\t},\n\n\t$: Backbone.$,\n\n\t/**\n\t * @constructor\n\t * @type {module:app/view/base/View}\n\t */\n\tconstructor: function(options) {\n\t\tthis.transform = {};\n\t\tthis.childViews = {};\n\t\tthis._applyRender = this._applyRender.bind(this);\n\n\t\tif (this.properties) {\n\t\t\t// Object.defineProperties(this, getPrototypeChainValue(this, \"properties\", Backbone.View));\n\t\t\tObject.defineProperties(this, this.properties);\n\t\t}\n\t\tif (options && options.className && this.className) {\n\t\t\toptions.className += \" \" + _.result(this, \"className\");\n\t\t}\n\t\tif (options && options.parentView) {\n\t\t\tthis._setParentView(options.parentView, true);\n\t\t}\n\t\tBackbone.View.apply(this, arguments);\n\n\t\t// console.log(\"%s::initialize viewPhase:[%s => initialized]\", this.cid, this._viewPhase);\n\t\tthis._viewPhase = \"initialized\";\n\n\t\tif (this.parentView !== null) {\n\t\t\tthis.trigger(\"view:parentChange\", this.parentView, null);\n\t\t}\n\t\tif (this.attached) {\n\t\t\tthis.trigger(\"view:attached\", this);\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* remove\n\t/* ------------------------------- */\n\n\t/** @override */\n\tremove: function() {\n\t\tif (this._viewPhase == \"disposing\") {\n\t\t\tlogAttachInfo(this, \"remove\", \"warn\");\n\t\t} else {\n\t\t\t// logAttachInfo(this, \"remove\", \"log\");\n\t\t}\n\n\t\t// before removal\n\t\tthis._viewPhase = \"disposing\";\n\t\tthis._cancelRender();\n\n\t\t// call Backbone impl\n\t\t// Backbone.View.prototype.remove.apply(this, arguments);\n\n\t\t// NOTE: from Backbone impl\n\t\tthis.$el.remove(); // from Backbone impl\n\n\t\tthis._attached = false;\n\t\tthis.trigger(\"view:removed\", this);\n\n\t\t// remove parent/child references\n\t\tthis._setParentView(null);\n\n\t\t// NOTE: from Backbone impl. No more events after this\n\t\tthis.stopListening();\n\n\t\t// check for invalidations that may have been triggered by \"view:removed\"\n\t\tif (this.invalidated) {\n\t\t\tconsole.warn(\"%s::remove invalidated after remove()\", this.cid);\n\t\t\tthis._cancelRender();\n\t\t}\n\t\t// // check for children still here\n\t\t// var ccids = Object.keys(this.childViews);\n\t\t// if (ccids.length) {\n\t\t// \tconsole.warn(\"%s::remove %i children not removed [%s]\", this.cid, ccids.length, ccids.join(\", \"), this.childViews);\n\t\t// }\n\t\t// // remove childViews\n\t\t// for (var cid in this.childViews) {\n\t\t// \tthis.childViews[cid].remove();\n\t\t// }\n\t\t// clear reference in view map\n\t\tdelete _viewsByCid[this.cid];\n\t\t// delete this.el.cid;\n\t\t// update phase\n\t\tthis._viewPhase = \"disposed\";\n\t\treturn this;\n\t},\n\n\t/* -------------------------------\n\t/* _elementAttached _elementDetached\n\t/* ------------------------------- */\n\n\t_elementAttached: function() {\n\t\t// this._addToParentView();\n\t\tthis._attached = true;\n\t\tthis._viewDepth = null;\n\t\tthis.setEnabled(true);\n\t\tthis._setParentView(View.findByDescendant(this.el.parentElement));\n\n\t\t// if (this.parentView) {\n\t\t// \tconsole.log(\"[attach] [%i] %s > %s::_elementAttached\", this.viewDepth, this.parentView.cid, this.cid);\n\t\t// } else {\n\t\t// \tconsole.log(\"[attach] [%i] %s::_elementAttached\", this.viewDepth, this.cid);\n\t\t// }\n\n\t\t// if (this._viewPhase == \"initializing\") {\n\t\t// \t// this.trigger(\"view:attached\", this);\n\t\t// } else\n\t\tif (this._viewPhase == \"initialized\") {\n\t\t\tthis.trigger(\"view:attached\", this);\n\t\t} else\n\t\tif (this._viewPhase == \"replacing\") {\n\t\t\tthis._viewPhase = \"initialized\";\n\t\t\tthis.trigger(\"view:replaced\", this);\n\t\t}\n\t},\n\n\t_elementDetached: function() {\n\t\tif (!this.attached || (this._viewPhase == \"disposing\") || (this._viewPhase == \"disposed\")) {\n\t\t\tlogAttachInfo(this, \"_elementDetached\", \"error\");\n\t\t\t// } else {\n\t\t\t// \tlogAttachInfo(this, \"_elementDetached\", \"log\");\n\t\t}\n\t\tthis._attached = false;\n\t\tthis._viewDepth = null;\n\t\tthis.setEnabled(false);\n\n\t\tif (this._viewPhase != \"disposing\" || this._viewPhase == \"disposed\") {\n\t\t\tthis.remove();\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* parentView\n\t/* ------------------------------- */\n\n\t_setParentView: function(newParent, silent) {\n\t\tif (newParent === void 0) {\n\t\t\tconsole.warn(\"$s::_setParentView invalid value '%s'\", this.cid, newParent);\n\t\t\tnewParent = null;\n\t\t}\n\t\tvar oldParent = this._parentView;\n\t\tthis._parentView = newParent;\n\n\t\t// force update of _viewDepth\n\t\tthis._viewDepth = null; //getViewDepth(this);\n\n\t\t// skip the rest if arg is the same\n\t\tif (newParent === oldParent) {\n\t\t\treturn;\n\t\t}\n\t\tif (oldParent !== null) {\n\t\t\tif (this.cid in oldParent.childViews) {\n\t\t\t\tdelete oldParent.childViews[this.cid];\n\t\t\t}\n\t\t}\n\t\tif (newParent !== null) {\n\t\t\tnewParent.childViews[this.cid] = this;\n\t\t}\n\t\tif (!silent)\n\t\t\tthis.trigger(\"view:parentChange\", this, newParent, oldParent);\n\t},\n\n\twhenAttached: function() {\n\t\treturn View.whenViewIsAttached(this);\n\t},\n\n\t_getViewDepth: function() {\n\t\tif (this._viewDepth === null) {\n\t\t\tthis._viewDepth = getViewDepth(this);\n\t\t}\n\t\treturn this._viewDepth;\n\t},\n\n\t/* -------------------------------\n\t/* Backbone.View overrides\n\t/* ------------------------------- */\n\n\t/** @override */\n\tsetElement: function(element, delegate) {\n\t\t// setElement always initializes this.el, so check it to be non-null before calling super\n\t\tif (this.el) {\n\t\t\tif (this.el !== element && this.el.parentElement) {\n\t\t\t\t// Element is being replaced\n\t\t\t\tif (this.attached) {\n\t\t\t\t\t// Since old element is attached to document tree, _elementAttached will be\n\t\t\t\t\t// triggered by replaceChild: set _viewPhase = \"replacing\" to flag this\n\t\t\t\t\t// change and trigger 'view:replaced' instead of 'view:added'.\n\t\t\t\t\tthis._viewPhase = \"replacing\";\n\t\t\t\t}\n\t\t\t\tthis.el.parentElement.replaceChild(element, this.el);\n\t\t\t}\n\t\t\tBackbone.View.prototype.setElement.apply(this, arguments);\n\t\t\t// Merge classes specified by this view with the ones already in the element,\n\t\t\t// as backbone will not:\n\t\t\tif (this.className) {\n\t\t\t\t_.result(this, \"className\").split(\" \").forEach(function(item) {\n\t\t\t\t\tthis.el.classList.add(item);\n\t\t\t\t}, this);\n\t\t\t}\n\t\t} else {\n\t\t\tBackbone.View.prototype.setElement.apply(this, arguments);\n\t\t}\n\n\t\tif (this.el === void 0) {\n\t\t\tthrow new Error(\"Backbone view has no element\");\n\t\t}\n\t\t_viewsByCid[this.cid] = this;\n\t\tthis.el.cid = this.cid;\n\t\tthis.el.setAttribute(\"data-cid\", this.cid);\n\n\t\treturn this;\n\t},\n\n\t/* ---------------------------\n\t/* event helpers\n\t/* --------------------------- */\n\n\taddListeners: function(target, events, handler, useCapture) {\n\t\tif (!_.isObject(useCapture)) useCapture = !!useCapture;\n\t\tif (typeof events === \"string\") { events = events.split(\" \"); }\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\ttarget.addEventListener(events[i], handler, useCapture);\n\t\t}\n\t\treturn this;\n\t},\n\n\tremoveListeners: function(target, events, handler, useCapture) {\n\t\tif (!_.isObject(useCapture)) useCapture = !!useCapture;\n\t\tif (typeof events === \"string\") { events = events.split(\" \"); }\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\ttarget.removeEventListener(events[i], handler, useCapture);\n\t\t}\n\t\treturn this;\n\t},\n\n\tlistenToElement: function(target, events, handler) {\n\t\ttarget = Backbone.$(target);\n\t\tif (typeof events === \"string\") { events = events.split(\" \"); }\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\tthis.listenTo(target, events[i], handler);\n\t\t}\n\t},\n\tstopListeningToElement: function(target, events, handler) {\n\t\ttarget = Backbone.$(target);\n\t\tif (typeof events === \"string\") { events = events.split(\" \"); }\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\tthis.stopListening(target, events[i], handler);\n\t\t}\n\t},\n\n\t// listenToElementOnce: function(target, event, handler, useCapture) {\n\t// \tthis.listenToOnce(this.$(target), event, handler);\n\t// },\n\t// stopListenToElement: function(target, event, handler, useCapture) {\n\t// \tthis.stopListening(Backbone.$(target), event, handler);\n\t// },\n\n\tlistenToElementOnce: function(target, event, handler, useCapture) {\n\t\tif (!_.isObject(useCapture)) useCapture = !!useCapture;\n\t\tvar cleanup, wrapper, ctx;\n\t\tctx = this;\n\t\tcleanup = function() {\n\t\t\tctx.off(\"view:remove\", cleanup);\n\t\t\ttarget.removeEventListener(event, wrapper, useCapture);\n\t\t};\n\t\twrapper = function(ev) {\n\t\t\tcleanup();\n\t\t\thandler.call(ctx, ev);\n\t\t};\n\t\tctx.on(\"view:remove\", cleanup);\n\t\ttarget.addEventListener(event, wrapper, useCapture);\n\t\treturn this;\n\t},\n\n\t/* -------------------------------\n\t/* requestAnimationFrame\n\t/* ------------------------------- */\n\n\trequestAnimationFrame: function(callback, priority, ctx) {\n\t\treturn renderQueue.request(callback.bind(ctx || this), priority);\n\t},\n\n\tcancelAnimationFrame: function(id) {\n\t\treturn renderQueue.cancel(id);\n\t},\n\n\tsetImmediate: function(callback, priority, ctx) {\n\t\treturn modelQueue.request(callback.bind(ctx || this), priority);\n\t},\n\n\tclearImmediate: function(id) {\n\t\treturn modelQueue.cancel(id);\n\t\t// return window.clearImmediate(id);\n\t},\n\n\t/* -------------------------------\n\t/* deferred render: private methods\n\t/* ------------------------------- */\n\n\t_traceRenderStatus: function() {\n\t\treturn [\n\t\t\t(this._renderQueueId != -1 ? \"async id:\" + this._renderQueueId : \"sync\"),\n\t\t\tView.flagsToString(this._renderFlags),\n\t\t\t(this.attached ? \"attached\" : \"detached\"),\n\t\t\t(this.skipTransitions ? \"skip\" : \"run\") + \"-tx\"\n\t\t].join(\", \");\n\t},\n\n\t/** @private */\n\t_applyRender: function(tstamp) {\n\t\tif (DEBUG) {\n\t\t\tif (this._logFlags[\"view.render\"]) {\n\t\t\t\tconsole.log(\"%s::_applyRender [%s]\",\n\t\t\t\t\tthis.cid, this._traceRenderStatus(),\n\t\t\t\t\tthis._logFlags[\"view.trace\"] ?\n\t\t\t\t\tthis._logRenderCallers.join(\"\\n\") : \"\");\n\t\t\t}\n\t\t\tthis._logRenderCallers.length = 0;\n\t\t}\n\n\t\tvar flags = this._renderFlags;\n\t\tthis.trigger(\"view:render:before\", this, flags);\n\t\tthis._renderFlags = 0;\n\t\tthis._renderQueueId = -1;\n\t\tthis._renderFlags |= this.renderFrame(tstamp, flags);\n\t\tthis.trigger(\"view:render:after\", this, flags);\n\n\t\tif (this._renderFlags != 0) {\n\t\t\tconsole.warn(\"%s::_applyRender [returned] phase: %s flags: %s (%s)\", this.cid, this._viewPhase, View.flagsToString(this._renderFlags), this._renderFlags);\n\t\t}\n\t},\n\n\t_cancelRender: function() {\n\t\tif (this._renderQueueId != -1) {\n\t\t\tvar cancelId, cancelFn;\n\n\t\t\tcancelId = this._renderQueueId;\n\t\t\tthis._renderQueueId = -1;\n\t\t\tcancelFn = renderQueue.cancel(cancelId);\n\n\t\t\tif (cancelFn === void 0) {\n\t\t\t\tconsole.warn(\"%s::_cancelRender [id:%i] not found\", this.cid, cancelId);\n\t\t\t} else if (cancelFn === null) {\n\t\t\t\tconsole.warn(\"%s::_cancelRender [id:%i] already cancelled\", this.cid, cancelId);\n\t\t\t\t// } else {\n\t\t\t\t// \tif (this._logFlags[\"view.render\"] && !renderQueue.running)\n\t\t\t\t// \t\tconsole.log(\"%s::_cancelRender ID:%i cancelled\", this.cid, cancelId);\n\t\t\t}\n\t\t}\n\t},\n\n\t_requestRender: function() {\n\t\tif (renderQueue.running) {\n\t\t\tthis._cancelRender();\n\t\t\t// if (DEBUG) {\n\t\t\t// \tif (this._logFlags[\"view.render\"]) {\n\t\t\t// \t\tconsole.info(\"%s::_requestRender rescheduled [%s (%s)]\", this.cid, View.flagsToString(this._renderFlags), this._renderFlags);\n\t\t\t// \t}\n\t\t\t// }\n\t\t}\n\t\tif (this._renderQueueId == -1) {\n\t\t\tthis._renderQueueId = renderQueue.request(this._applyRender, isNaN(this.viewDepth) ? Number.MAX_VALUE : this.viewDepth);\n\t\t}\n\t\tif (DEBUG) {\n\t\t\tif (this._logFlags[\"view.trace\"]) {\n\t\t\t\t// if (this._logFlags[\"view.trace\"]) {\n\t\t\t\t// \tconsole.groupCollapsed(this.cid + \"::_requestRender [\" + this._traceRenderStatus() + \"] trace\");\n\t\t\t\t// \tconsole.trace();\n\t\t\t\t// \tconsole.groupEnd();\n\t\t\t\t// } else {\n\t\t\t\tconsole.log(\"%s::_requestRender %s [%s]\", this.cid,\n\t\t\t\t\t(renderQueue.running ? \"rescheduled \" : \"\"),\n\t\t\t\t\tthis._traceRenderStatus()\n\t\t\t\t);\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* render: public / abstract methods\n\t/* ------------------------------- */\n\n\tinvalidate: function(flags) {\n\t\tif (flags !== void 0) {\n\t\t\t/*if (DEBUG) {\n\t\t\t\tif (this._logFlags[\"view.render\"]) {\n\t\t\t\t\tif (this._renderFlags > 0) {\n\t\t\t\t\t\tconsole.log(\"%s::invalidate [%s (%s)] + [%s (%s)]\", this.cid, View.flagsToString(this._renderFlags), this._renderFlags, View.flagsToString(flags), flags);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log(\"%s::invalidate [%s (%s)]\", this.cid, View.flagsToString(flags), flags);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}*/\n\t\t\tthis._renderFlags |= flags;\n\t\t}\n\t\treturn this;\n\t},\n\n\trequestRender: function(flags) {\n\t\t// if (DEBUG) {\n\t\t// \tif (this._logFlags[\"view.trace\"]) {\n\t\t// \t\tvar fnPath = [];\n\t\t// \t\tvar fn = arguments.callee.caller;\n\t\t// \t\twhile (fn) {\n\t\t// \t\t\tif (fnPath.length > 5) break;\n\t\t// \t\t\tfnPath.push(fn.name);\n\t\t// \t\t\tfn = fn.caller;\n\t\t// \t\t}\n\t\t// \t\t// this._logRenderCallers.push(fnPath.join(\"\\n\\t->\"));\n\t\t// \t\tthis._logRenderCallers.push(fnPath.join(\" -> \"));\n\t\t// \t}\n\t\t// }\n\t\t// if (flags !== void 0) {\n\t\t// \tthis._renderFlags |= flags;\n\t\t// }\n\t\tthis.invalidate(flags);\n\t\tthis._requestRender();\n\t\treturn this;\n\t},\n\n\t/** @abstract */\n\trenderFrame: function(tstamp, flags) {\n\t\t// subclasses should override this method\n\t\treturn View.NONE_INVALID;\n\t},\n\n\trenderNow: function(alwaysRun) {\n\t\tif (this._renderQueueId != -1) {\n\t\t\tthis._cancelRender();\n\t\t\talwaysRun = true;\n\t\t}\n\t\t// if (alwaysRun === true) {\n\t\tif (alwaysRun) {\n\t\t\tthis._applyRender(_now());\n\t\t}\n\t\treturn this;\n\t},\n\n\twhenRendered: function() {\n\t\treturn View.whenViewIsRendered(this);\n\t},\n\n\t/* -------------------------------\n\t/* render bitwise flags\n\t/* - check: this._renderFlags & flags\n\t/* - add: this._renderFlags |= flags\n\t/* - remove: this._renderFlags &= ~flags\n\t/* ------------------------------- */\n\n\t/* helpers ------------------ */\n\n\trequestChildrenRender: function(flags, now, force) {\n\t\tvar ccid, view;\n\t\tfor (ccid in this.childViews) {\n\t\t\tview = this.childViews[ccid];\n\t\t\tview.skipTransitions = view.skipTransitions || this.skipTransitions;\n\t\t\tview.requestRender(flags);\n\t\t\tif (now) {\n\t\t\t\tview.renderNow(force);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\n\trender: function() {\n\t\treturn this.renderNow(true);\n\t},\n\n\t/* -------------------------------\n\t/* common abstract\n\t/* ------------------------------- */\n\n\t/**\n\t/* @param {Boolean}\n\t/*/\n\tsetEnabled: function(enable) {\n\t\tif (this._enabled == enable) return;\n\t\tthis._enabled = !!(enable);\n\t\tif (this._enabled) {\n\t\t\tthis.delegateEvents();\n\t\t} else {\n\t\t\tthis.undelegateEvents();\n\t\t}\n\t},\n};\n//, View);\n\nif (DEBUG) {\n\tViewProto._logFlags = [\n\t\t\"view.render\",\n\t\t// \"view.trace\"\n\t].join(\" \");\n\n\tViewProto.constructor = (function(fn) {\n\t\treturn function() {\n\t\t\tvar retval;\n\t\t\tthis._logRenderCallers = [];\n\t\t\tthis._logFlags = this._logFlags.split(\" \").reduce(function(r, o) {\n\t\t\t\tr[o] = true;\n\t\t\t\treturn r;\n\t\t\t}, {});\n\t\t\tretval = fn.apply(this, arguments);\n\t\t\t// console.log(\"------ %s %o\", this.cid, this._logFlags);\n\t\t\treturn retval;\n\t\t};\n\t})(ViewProto.constructor);\n}\n\nmodule.exports = Backbone.View.extend(ViewProto, View);\n",
    "function ViewError(view, err) {\n\tthis.view = view;\n\tthis.err = err;\n\tthis.message = err.message;\n}\nViewError.prototype = Object.create(Error.prototype);\nViewError.prototype.constructor = ViewError;\nViewError.prototype.name = \"ViewError\";\n\nmodule.exports = ViewError;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=helpers.helperMissing, alias3=container.escapeExpression, alias4=\"function\";\n\n  return \"<a href=\\\"\"\n    + alias3((helpers.global || (depth0 && depth0.global) || alias2).call(alias1,\"APP_ROOT\",{\"name\":\"global\",\"hash\":{},\"data\":data}))\n    + \"#\"\n    + alias3(((helper = (helper = helpers.handle || (depth0 != null ? depth0.handle : depth0)) != null ? helper : alias2),(typeof helper === alias4 ? helper.call(alias1,{\"name\":\"handle\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\">\"\n    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias4 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper))) != null ? stack1 : \"\")\n    + \"</a>\\n\";\n},\"useData\":true});\n",
    "/**\n/* @module app/view/component/ArticleView\n/*/\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {Function} */\nvar viewTemplate = require(\"./ArticleButton.hbs\");\n\n/**\n/* @constructor\n/* @type {module:app/view/component/ArticleButton}\n/*/\nvar ArticleButton = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"articleButton\",\n\t/** @override */\n\ttagName: \"h2\",\n\t/** @override */\n\tclassName: \"article-button\",\n\t/** @type {Function} */\n\ttemplate: viewTemplate,\n\n\tevents: {\n\t\t\"click a\": function(domev) {\n\t\t\tdomev.defaultPrevented || domev.preventDefault();\n\t\t\tthis.trigger(\"view:click\", this.model);\n\t\t}\n\t},\n\n\t// /** @override */\n\t// initialize: function(options) {},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\trenderFrame: function(tstamp, flags) {\n\t\tthis.el.innerHTML = this.template(this.model.toJSON());\n\t},\n});\nmodule.exports = ArticleButton;\n",
    "/**\n/* @module app/view/component/ArticleView\n/*/\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n\n// /** @type {module:utils/net/toAbsoluteURL} */\n// var toAbsoluteURL = require(\"utils/net/toAbsoluteURL\");\n//\n// /** @type {string} */\n// var ABS_APP_ROOT = toAbsoluteURL(require(\"app/control/Globals\").APP_ROOT);\n\n/**\n/* @constructor\n/* @type {module:app/view/component/ArticleView}\n/*/\nvar ArticleView = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"articleView\",\n\t/** @override */\n\ttagName: \"article\",\n\t/** @override */\n\tclassName: \"article-view mdown\",\n\n\t/** @override */\n\tinitialize: function(options) {},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\trenderFrame: function(tstamp, flags) {\n\t\tthis.el.innerHTML = this.model.get(\"text\");\n\t\t// FIXME: now done in xslt\n\t\t// this.el.querySelectorAll(\"a[href]\").forEach(function(el) {\n\t\t// \tvar url = toAbsoluteURL(el.getAttribute(\"href\"));\n\t\t// \tif (url.indexOf(ABS_APP_ROOT) !== 0) {\n\t\t// \t\tel.setAttribute(\"target\", \"_blank\");\n\t\t// \t}\n\t\t// });\n\t},\n});\nmodule.exports = ArticleView;\n",
    "/**\n * @module app/view/component/progress/CanvasProgressMeter\n */\n\n/** @type {module:app/view/base/CanvasView} */\nvar CanvasView = require(\"app/view/base/CanvasView\");\n\nvar PI2 = Math.PI * 2;\n/* NOTE: avoid negative rotations */\nvar BASE_ROTATION = 1 - 0.25; // of PI2 (-90 degrees)\nvar GAP_ARC = PI2 / 48;\n\n/** @type {module:utils/ease/fn/easeInQuad} */\nvar easeIn = require(\"utils/ease/fn/easeInQuad\");\n/** @type {module:utils/ease/fn/easeOutQuad} */\nvar easeOut = require(\"utils/ease/fn/easeOutQuad\");\n\nvar LOOP_OFFSET = 1.833333;\nvar STEP_MS = 400; // tween time base\n\nvar ARC_DEFAULTS = {\n\t\"amount\": {\n\t\tlineWidth: 0.75,\n\t\tradiusOffset: 0\n\t},\n\t\"available\": {\n\t\tlineWidth: 0.75,\n\t\t// lineDash: [1.3, 0.7],\n\t\tinverse: \"not-available\"\n\t},\n\t\"not-available\": {\n\t\tlineWidth: 0.8,\n\t\tlineDash: [0.3, 0.7],\n\t\tlineDashOffset: 0\n\t},\n\t\"indeterminate\": {\n\t\tlineWidth: 2.0, //0.8,\n\t\tlineDash: [0.3, 1.7],\n\t\t// lineDash: [0.6, 1.4],\n\t\tlineDashOffset: 0\n\t},\n};\n\n/**\n * @constructor\n * @type {module:app/view/component/progress/CanvasProgressMeter}\n */\nmodule.exports = CanvasView.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"canvasProgressMeter\",\n\t/** @type {string} */\n\tclassName: \"progress-meter canvas-progress-meter\",\n\n\tdefaultKey: \"amount\",\n\n\tdefaults: {\n\t\tvalues: {\n\t\t\tamount: 0,\n\t\t\tavailable: 0,\n\t\t\t_loop: 0,\n\t\t\t_stalled_arc: 0,\n\t\t\t_stalled_loop: 0,\n\t\t},\n\t\tmaxValues: {\n\t\t\tamount: 1,\n\t\t\tavailable: 1,\n\t\t\t_stalled_loop: 1,\n\t\t},\n\t\tuseOpaque: true,\n\t\tlabelFn: function(value, max) {\n\t\t\treturn ((value / max) * 100) | 0;\n\t\t},\n\t},\n\n\tproperties: {\n\t\tstalled: {\n\t\t\tget: function() {\n\t\t\t\treturn false; //this._stalled;\n\t\t\t},\n\t\t\tset: function(value) {\n\t\t\t\t// this._setStalled(value)\n\t\t\t}\n\t\t}\n\t},\n\n\t_setStalled: function(value) {\n\t\tif (this._stalled !== value) {\n\t\t\tthis._stalled = value;\n\t\t\tthis.requestRender(CanvasView.MODEL_INVALID | CanvasView.LAYOUT_INVALID);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* children/layout\n\t/* --------------------------- */\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t// TODO: cleanup options mess in CanvasView\n\t\tCanvasView.prototype.initialize.apply(this, arguments);\n\t\t// options = _.defaults(options, this.defaults);\n\n\t\tthis._labelFn = options.labelFn;\n\t\tthis._stalled = !!(options.stalled);\n\t\tthis._valueStyles = {};\n\t\tthis._canvasSize = null;\n\t\tthis._canvasOrigin = null;\n\t},\n\n\t_needsLoop: false,\n\n\t/** @override */\n\tvalueTo: function(key, value, duration) {\n\t\tif (key === \"amount\" && value < this.interpolator.getCurrentValue(\"amount\")) {\n\t\t\tthis._needsLoop = true;\n\t\t}\n\t\tCanvasView.prototype.valueTo.apply(this, arguments);\n\t},\n\n\t/* --------------------------- *\n\t/* private\n\t/* --------------------------- */\n\n\t/** @override */\n\tmeasureCanvas: function(w, h, s) {\n\t\t// make canvas square\n\t\tthis._canvasHeight = this._canvasWidth = Math.min(w, h);\n\t},\n\n\t/** @override */\n\tupdateCanvas: function() {\n\t\t// CanvasView.prototype._updateCanvas.apply(this, arguments);\n\n\t\t// size, lines, gaps, dashes (this._valueStyles, GAP_ARC, this._arcRadius)\n\t\t// --------------------------------\n\t\t// var arcName, s, arcDefault;\n\t\t// var mapLineDash = function(n) {\n\t\t// \treturn n * this.radius * GAP_ARC;\n\t\t// };\n\t\t// var sumFn = function(s, n) {\n\t\t// \treturn s + n;\n\t\t// };\n\n\t\t// this._canvasSize = Math.min(this._canvasWidth, this._canvasHeight);\n\n\t\tvar s;\n\t\t// this._maxDashArc = 0\n\t\tfor (var styleName in ARC_DEFAULTS) {\n\t\t\ts = _.defaults({}, ARC_DEFAULTS[styleName]);\n\t\t\ts.lineWidth *= this._canvasRatio;\n\t\t\ts.radius = (this._canvasWidth - s.lineWidth) / 2;\n\t\t\tif (s.radiusOffset) {\n\t\t\t\ts.radius += s.radiusOffset * this._canvasRatio;\n\t\t\t}\n\t\t\tif (_.isArray(s.lineDash)) {\n\t\t\t\ts.lineDash = s.lineDash.map(function(val, i, arr) {\n\t\t\t\t\treturn val * this.radius * GAP_ARC;\n\t\t\t\t}, s);\n\t\t\t\ts.lineDashLength = s.lineDash.reduce(function(res, val, i, arr) {\n\t\t\t\t\treturn res + val;\n\t\t\t\t}, 0);\n\t\t\t\ts.lineDashArc = s.lineDash[0] * GAP_ARC;\n\t\t\t\t// this._maxDashArc = Math.max(this._maxDashArc, s.lineDashArc);\n\t\t\t} else {\n\t\t\t\ts.lineDashArc = 0;\n\t\t\t}\n\t\t\tthis._valueStyles[styleName] = s;\n\t\t}\n\n\t\t// baselineShift\n\t\t// --------------------------------\n\t\t// NOTE: Center baseline: use ascent data to center to x-height, or sort-of.\n\t\t// with ascent/descent values (0.7, -0.3), x-height is 0.4\n\t\tvar mObj = this._getFontMetrics(this._fontFamily);\n\t\tthis._baselineShift = mObj ? (mObj.ascent + mObj.descent) / mObj.unitsPerEm : 0.7; // default value\n\t\tthis._baselineShift *= this._fontSize * 0.5; // apply to font-size, halve it\n\t\tthis._baselineShift = Math.round(this._baselineShift);\n\n\t\t// save canvas context\n\t\t// --------------------------------\n\t\t// reset matrix and translate 0,0 to center\n\t\tthis._ctx.restore();\n\t\tthis._ctx.setTransform(1, 0, 0, 1, this._canvasWidth / 2, this._canvasHeight / 2);\n\t\tthis._ctx.save();\n\t},\n\n\t/** @override */\n\tredraw: function(ctx, intrp, flags) {\n\t\tthis._clearCanvas(-this._canvasWidth / 2, -this._canvasHeight / 2,\n\t\t\tthis._canvasWidth, this._canvasHeight\n\t\t);\n\n\t\tvar s, // reused style objects\n\t\t\tvalData, // reused for interpolated data\n\t\t\tarcVal; // reused arc values\n\n\t\t// amount label\n\t\t// --------------------------------\n\t\tvalData = intrp._valueData[\"amount\"];\n\t\tthis.drawLabel(this._labelFn(valData._renderedValue, valData._maxVal));\n\n\t\t// indeterminate\n\t\t// --------------------------------\n\n\t\t/*\n\t\tvar indVal;\n\t\tif (this.stalled) {\n\t\t\t// _ind loop indefinitely while indeterminate: restart if at end\n\t\t\tif (intrp.isAtTarget(\"_ind\")) {\n\t\t\t\t// if (intrp.renderedKeys && (intrp.renderedKeys.indexOf(\"_ind\") === -1)) {\n\t\t\t\tintrp.valueTo(\"_ind\", 0, 0);\n\t\t\t\tintrp.valueTo(\"_ind\", 1, 1000);\n\t\t\t\tintrp.updateValue(\"_ind\");\n\t\t\t}\n\t\t\tindVal = intrp.getCurrentValue(\"_ind\");\n\t\t\t//indVal = intrp._valueData[\"_ind\"]._renderedValue || 0;\n\n\t\t\t// draw spinning arc\n\t\t\t// --------------------------------\n\t\t\t// s = this._valueStyles[\"amount\"];\n\t\t\t// ctx.save();\n\t\t\t// ctx.rotate(PI2 * (BASE_ROTATION + (indVal))); // + GAP_ARC);\n\t\t\t// lastEndArc = this.drawArc(1,\n\t\t\t// \tGAP_ARC,\n\t\t\t// \tPI2 - GAP_ARC,\n\t\t\t// \t0, s);\n\t\t\t// ctx.restore();\n\t\t\t// return;\n\n\t\t\t// lineDashOffset animation\n\t\t\t// --------------------------------\n\t\t\ts = this._valueStyles[\"indeterminate\"];\n\t\t\ts.lineDashOffset = s.lineDashLength * ((1 - indVal) % 3) * 3;\n\t\t\tthis._valueStyles[\"available\"].inverse = \"indeterminate\";\n\n\t\t\t// console.log(\"%s::redraw indVal:%o s.lineDashOffset:%o s.lineDash:%o\", this.cid, indVal, s.lineDashOffset, s.lineDash[0]);\n\n\t\t\t// draw spinning wheel\n\t\t\t// --------------------------------\n\t\t\t// ctx.save();\n\t\t\t// ctx.rotate((PI2 / WHEEL_NUM) * indVal); // + GAP_ARC);\n\t\t\t// this.drawWheel(this._valueStyles[\"amount\"], 2 / 5, 3 / 5);\n\t\t\t// ctx.restore();\n\n\t\t} else {\n\t\t\tif (!intrp.isAtTarget(\"_ind\")) {\n\t\t\t\t// if (intrp.renderedKeys && (intrp.renderedKeys.indexOf(\"_ind\") !== -1)) {\n\t\t\t\tintrp.valueTo(\"_ind\", 0, 0);\n\t\t\t\tintrp.updateValue(\"_ind\");\n\t\t\t}\n\t\t\t// lineDashOffset animation\n\t\t\t// --------------------------------\n\t\t\tthis._valueStyles[\"available\"].inverse = \"not-available\";\n\t\t}*/\n\n\t\t// save ctx before drawing arcs\n\t\tctx.save();\n\n\t\t// loop (amount)\n\t\t// --------------------------------\n\t\tvar loopVal;\n\t\t/*\n\t\tNOTE: If value \"amount\" has changed (with valueTo()) but no yet\n\t\tinterpolated, and its last rendered value is less, then its been reset\n\t\t(a reload, a loop, etc): we trigger a 'loop' of the whole arc.\n\t\t*/\n\t\t// if ((intrp.renderedKeys.indexOf(\"amount\") !== -1) && (valData._lastRenderedValue > valData._renderedValue)) {\n\t\tif (this._needsLoop) {\n\t\t\tthis._needsLoop = false;\n\t\t\t// trigger loop\n\t\t\tintrp.valueTo(\"_loop\", 1, 0);\n\t\t\tintrp.valueTo(\"_loop\", 0, 750);\n\t\t\tintrp.updateValue(\"_loop\");\n\t\t}\n\t\t// loopVal = intrp._valueData[\"_loop\"]._renderedValue || 0;\n\t\tloopVal = intrp.getCurrentValue(\"_loop\");\n\t\tctx.rotate((PI2 * (BASE_ROTATION + (1 - loopVal)))); // + GAP_ARC);\n\n\t\t// amount arc\n\t\t// --------------------------------\n\t\t// var amountGapArc = GAP_ARC;\n\t\tvar lastEndArc = 0;\n\n\t\ts = this._valueStyles[\"amount\"];\n\t\tarcVal = loopVal + valData._renderedValue / valData._maxVal;\n\n\t\tif (arcVal > 0) {\n\t\t\tlastEndArc = this.drawArc(arcVal,\n\t\t\t\tGAP_ARC,\n\t\t\t\tPI2 - GAP_ARC,\n\t\t\t\tlastEndArc, s);\n\t\t\tthis.drawEndCap(lastEndArc, s);\n\t\t\tlastEndArc = lastEndArc + GAP_ARC * 2;\n\t\t}\n\n\t\t// available arc\n\t\t// --------------------------------\n\t\ts = this._valueStyles[\"available\"];\n\t\tvalData = intrp._valueData[\"available\"];\n\n\t\tvar stepsNum = valData.length || 1;\n\t\tvar stepBaseArc = PI2 / stepsNum;\n\t\tvar stepAdjustArc = stepBaseArc % GAP_ARC;\n\t\tvar stepGapArc = GAP_ARC + (stepAdjustArc - s.lineDashArc) / 2;\n\n\t\tif (Array.isArray(valData)) {\n\t\t\tfor (var i = 0; i < stepsNum; i++) {\n\t\t\t\tarcVal = valData[i]._renderedValue / (valData[i]._maxVal / stepsNum);\n\t\t\t\tthis.drawArc(arcVal,\n\t\t\t\t\t(i * stepBaseArc) + stepGapArc,\n\t\t\t\t\t((i + 1) * stepBaseArc) - stepGapArc,\n\t\t\t\t\tlastEndArc, s);\n\t\t\t}\n\t\t} else {\n\t\t\tarcVal = valData._renderedValue / valData._maxVal;\n\t\t\tthis.drawArc(arcVal,\n\t\t\t\tstepGapArc,\n\t\t\t\tPI2 - stepGapArc,\n\t\t\t\tlastEndArc, s);\n\t\t}\n\t\t// restore ctx after drawing arcs\n\t\t// keep rotation transform\n\t\t//ctx.restore();\n\n\t\tif (this._stalled) {\n\t\t\tif (intrp.getTargetValue('_stalled_arc') === 0) {\n\t\t\t\tintrp.valueTo('_stalled_arc', 1, 1 * STEP_MS, easeIn).updateValue('_stalled_arc');\n\t\t\t}\n\t\t} else {\n\t\t\tif (intrp.getTargetValue('_stalled_arc') === 1) {\n\t\t\t\tintrp.valueTo('_stalled_arc', 0, 1 * STEP_MS, easeOut).updateValue('_stalled_arc');\n\t\t\t}\n\t\t}\n\t\tvar a = intrp.getRenderedValue(\"_stalled_arc\");\n\t\t// while arc is > 0, loop indefinitely while spinning and restart\n\t\t// if at end. Otherwise let interp exhaust arc duration\n\t\tif (a > 0) {\n\t\t\tif (!intrp.paused && intrp.isAtTarget('_stalled_loop')) {\n\t\t\t\tintrp\n\t\t\t\t\t.valueTo('_stalled_loop', 0, 0)\n\t\t\t\t\t.valueTo('_stalled_loop', 1, 2 * STEP_MS)\n\t\t\t\t\t.updateValue('_stalled_loop');\n\t\t\t}\n\t\t}\n\t\tvar l = intrp.getRenderedValue(\"_stalled_loop\");\n\t\t// always render while arc is > 0\n\t\tif (a > 0) {\n\t\t\t// arc span bounce\n\t\t\tvar b = (l < 0.5 ? (l % 0.5) : 0.5 - (l % 0.5)) * 2;\n\t\t\t// bounce + main arc span\n\t\t\tvar aa = (a * b * 0.25) + (a * 0.125) + .0001;\n\t\t\t// rotation loop\n\t\t\tvar ll = l + LOOP_OFFSET;\n\n\t\t\tctx.save();\n\t\t\tctx.lineWidth = 10 * this._canvasRatio;\n\t\t\tctx.globalAlpha = 1;\n\t\t\tctx.globalCompositeOperation = \"destination-out\";\n\t\t\tctx.strokeColor = 'red';\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(0, 0, (this._canvasWidth) / 2, ((1 - aa) + ll) * PI2, (aa + ll) * PI2, false);\n\t\t\tctx.stroke();\n\t\t\tctx.restore();\n\t\t}\n\t\tctx.restore();\n\t},\n\n\tdrawArc: function(value, startArc, endArc, prevArc, style) {\n\t\tvar valArc,\n\t\t\tvalStartArc,\n\t\t\tvalEndArc,\n\t\t\tinvStyle,\n\t\t\tinvStartArc,\n\t\t\tinvEndArc;\n\n\t\tprevArc || (prevArc = 0);\n\n\t\tvalArc = endArc - startArc;\n\t\tvalEndArc = startArc + (valArc * value);\n\t\tvalStartArc = Math.max(startArc, prevArc);\n\t\tif (valEndArc > valStartArc) {\n\t\t\tthis._ctx.save();\n\t\t\tthis.applyValueStyle(style);\n\t\t\tthis._ctx.beginPath();\n\t\t\tthis._ctx.arc(0, 0, style.radius, valEndArc, valStartArc, true);\n\t\t\tthis._ctx.stroke();\n\t\t\tthis._ctx.restore();\n\t\t}\n\n\t\t// if there's valueStyle, draw rest of span, minus prevArc overlap too\n\t\tif (style.inverse !== void 0) {\n\t\t\tinvStyle = this._valueStyles[style.inverse];\n\n\t\t\tinvEndArc = valEndArc + (valArc * (1 - value));\n\t\t\tinvStartArc = Math.max(valEndArc, prevArc);\n\t\t\tif (invEndArc > invStartArc) {\n\t\t\t\tthis._ctx.save();\n\t\t\t\tthis.applyValueStyle(invStyle);\n\t\t\t\tthis._ctx.beginPath();\n\t\t\t\tthis._ctx.arc(0, 0, invStyle.radius, invEndArc, invStartArc, true);\n\t\t\t\tthis._ctx.stroke();\n\t\t\t\tthis._ctx.restore();\n\t\t\t}\n\t\t}\n\n\t\treturn valEndArc;\n\t},\n\n\tapplyValueStyle: function(s) {\n\t\tthis._ctx.lineWidth = s.lineWidth;\n\t\tif (_.isArray(s.lineDash)) {\n\t\t\tthis._ctx.setLineDash(s.lineDash);\n\t\t}\n\t\tif (_.isNumber(s.lineDashOffset)) {\n\t\t\tthis._ctx.lineDashOffset = s.lineDashOffset;\n\t\t}\n\t},\n\n\n\tdrawNotch: function(arcPos, length, s) {\n\t\tvar ex, ey, ec1, ec2;\n\n\t\tex = Math.cos(arcPos);\n\t\tey = Math.sin(arcPos);\n\t\tec1 = s.radius;\n\t\tec2 = s.radius - length;\n\n\t\tthis._ctx.save();\n\t\tthis.applyValueStyle(s);\n\t\tthis._ctx.lineCap = \"square\";\n\t\tthis._ctx.beginPath();\n\t\tthis._ctx.moveTo(ec1 * ex, ec1 * ey);\n\t\tthis._ctx.lineTo(ec2 * ex, ec2 * ey);\n\t\tthis._ctx.stroke();\n\t\tthis._ctx.restore();\n\t},\n\n\tdrawEndCap: function(arcPos, s) {\n\t\tvar radius = s.radius;\n\t\tthis._ctx.save();\n\t\tthis._ctx.lineWidth = s.lineWidth;\n\n\t\tthis._ctx.rotate(arcPos - GAP_ARC * 2); // 1.5);\n\t\tthis._ctx.beginPath();\n\t\tthis._ctx.arc(0, 0, radius, GAP_ARC * 0.5, GAP_ARC * 2, false);\n\t\tthis._ctx.lineTo(radius - (GAP_ARC * radius), 0);\n\t\tthis._ctx.closePath();\n\n\t\tthis._ctx.fill();\n\t\tthis._ctx.stroke();\n\t\tthis._ctx.restore();\n\t},\n\n\tdrawLabel: function(s) {\n\t\tif (this._labelText !== s) {\n\t\t\tthis._labelText = s;\n\t\t\tthis._labelWidth = this._ctx.measureText(s).width;\n\t\t}\n\t\tthis._ctx.fillText(s, this._labelWidth * -0.5, this._baselineShift, this._labelWidth);\n\t},\n});\n\nif (DEBUG) {\n\tmodule.exports.prototype._logFlags = \"\";\n}\n",
    "/**\n * @module app/view/component/Carousel\n */\n\n/** @type {module:backbone.babysitter} */\nvar Container = require(\"backbone.babysitter\");\n\n/** @type {module:hammerjs} */\nvar Hammer = require(\"hammerjs\");\n/** @type {module:utils/touch/SmoothPanRecognizer} */\nvar Pan = require(\"utils/touch/SmoothPanRecognizer\");\n/** @type {module:hammerjs.Tap} */\nvar Tap = Hammer.Tap;\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n// /** @type {module:app/view/base/DeferredView} */\n// var View = require(\"app/view/base/DeferredView\");\n\n/** @type {module:app/view/render/CarouselRenderer} */\nvar CarouselRenderer = require(\"app/view/render/CarouselRenderer\");\n\n/** @type {module:utils/prefixedProperty} */\nvar prefixedProperty = require(\"utils/prefixedProperty\");\n/** @type {module:utils/prefixedStyleName} */\nvar prefixedStyleName = require(\"utils/prefixedStyleName\");\n\nvar transformStyleName = prefixedStyleName(\"transform\");\nvar transformProperty = prefixedProperty(\"transform\");\nvar translateTemplate = Globals.TRANSLATE_TEMPLATE;\n\n// var cssToPx = function(cssVal, el) {\n// \treturn parseInt(cssVal);\n// };\n\n// var defaultRendererFunction = (function() {\n// \tvar defaultRenderer = CarouselRenderer.extend({ className: \"carousel-item default-renderer\"}),\n// \t\temptyRenderer = CarouselRenderer.extend({ className: \"carousel-item empty-renderer\"});\n// \treturn function(item, index, arr) {\n// \t\treturn (index === -1)? emptyRenderer: defaultRenderer;\n// \t};\n// })();\n\n/** @const */\nvar MAX_SELECT_THRESHOLD = 20;\n\n// /** @const */\n// var CHILDREN_INVALID = View.CHILDREN_INVALID,\n// \tSTYLES_INVALID = View.STYLES_INVALID,\n// \tMODEL_INVALID = View.MODEL_INVALID,\n// \tSIZE_INVALID = View.SIZE_INVALID,\n// \tLAYOUT_INVALID = View.LAYOUT_INVALID;\n\nvar VERTICAL = Hammer.DIRECTION_VERTICAL,\n\tHORIZONTAL = Hammer.DIRECTION_HORIZONTAL;\n\n// x: [\"x\", \"y\"],\n// y: [\"y\", \"x\"],\n// offsetLeft: [\"offsetLeft\", \"offsetTop\"],\n// offsetTop: [\"offsetTop\", \"offsetLeft\"],\n// offsetWidth: [\"offsetWidth\", \"offsetHeight\"],\n// offsetHeight: [\"offsetHeight\", \"offsetWidth\"],\n// width: [\"width\",\"height\"],\n// height: [\"height\",\"width\"],\n// marginLeft: [\"marginLeft\",\"marginTop\"],\n// marginRight: [\"marginRight\",\"marginBottom\"],\n\n/*\nvar HORIZONTAL_PROPS = {\n\tpos: \"x\",\n\tsize: \"width\",\n\toffsetPos: \"offsetLeft\",\n\toffsetSize: \"offsetWidth\",\n\tmarginBefore: \"marginLeft\",\n\tmarginAfter: \"marginRight\",\n};\nvar VERTICAL_PROPS = {\n\tpos: \"y\",\n\tsize: \"height\",\n\toffsetPos: \"offsetTop\",\n\toffsetSize: \"offsetHeight\",\n\tmarginBefore: \"marginTop\",\n\tmarginAfter: \"marginBottom\",\n};\n*/\n\n// var DIRECTION_NONE = 1;\n// var DIRECTION_LEFT = 2;\n// var DIRECTION_RIGHT = 4;\n// var DIRECTION_UP = 8;\n// var DIRECTION_DOWN = 16;\n\nvar dirToStr = function(dir) {\n\tif (dir === Hammer.DIRECTION_NONE) return 'NONE';\n\tif (dir === Hammer.DIRECTION_LEFT) return 'LEFT';\n\tif (dir === Hammer.DIRECTION_RIGHT) return 'RIGHT';\n\tif (dir === Hammer.DIRECTION_UP) return 'UP';\n\tif (dir === Hammer.DIRECTION_DOWN) return 'DOWN';\n\tif (dir === Hammer.DIRECTION_HORIZONTAL) return 'HORIZONTAL';\n\tif (dir === Hammer.DIRECTION_VERTICAL) return 'VERTICAL';\n\tif (dir === Hammer.DIRECTION_ALL) return 'ALL';\n\treturn 'UNRECOGNIZED';\n}\n\nvar isValidTouchManager = function(touch, direction) {\n\t// var retval;\n\ttry {\n\t\treturn touch.get(\"hpan\").options.direction == direction;\n\t} catch (err) {\n\t\treturn false;\n\t}\n\t// return retval;\n};\n\n// /** @type {int} In pixels */\n// var panThreshold: 15;\n\nvar createTouchManager = function(el, dir, thres) {\n\tvar touch = new Hammer.Manager(el);\n\tvar pan = new Pan({\n\t\tevent: \"hpan\",\n\t\tthreshold: Globals.THRESHOLD,\n\t\tdirection: Hammer.DIRECTION_HORIZONTAL,\n\t});\n\tvar tap = new Tap({\n\t\tthreshold: Globals.THRESHOLD - 1,\n\t\tinterval: 50,\n\t\ttime: 200,\n\t});\n\ttap.recognizeWith(pan);\n\ttouch.add([pan, tap]);\n\treturn touch;\n};\n\n\nvar Carousel = {\n\t/** const */\n\tANIMATED: false,\n\t/** const */\n\tIMMEDIATE: true,\n\n\t/** copy of Hammer.DIRECTION_VERTICAL */\n\tDIRECTION_VERTICAL: VERTICAL,\n\t/** copy of Hammer.DIRECTION_HORIZONTAL */\n\tDIRECTION_HORIZONTAL: HORIZONTAL,\n\t/** @type {Object} */\n\tdefaults: {\n\t\t/** @type {boolean} */\n\t\tselectOnScrollEnd: false,\n\t\t/** @type {boolean} */\n\t\trequireSelection: false,\n\t\t/** @type {int} */\n\t\tdirection: HORIZONTAL,\n\t\t/** @type {int} In pixels */\n\t\tselectThreshold: 20,\n\t\t/** @type {Function} */\n\t\trendererFunction: (function() {\n\t\t\tvar defaultRenderer = CarouselRenderer.extend({\n\t\t\t\t\tclassName: \"carousel-item default-renderer\"\n\t\t\t\t}),\n\t\t\t\temptyRenderer = CarouselRenderer.extend({\n\t\t\t\t\tclassName: \"carousel-item empty-renderer\"\n\t\t\t\t});\n\t\t\treturn function(item, index, arr) {\n\t\t\t\treturn (index === -1) ? emptyRenderer : defaultRenderer;\n\t\t\t};\n\t\t})(),\n\t},\n};\nCarousel.validOptions = _.keys(Carousel.defaults);\n\n/**\n/* @constructor\n/* @type {module:app/view/component/Carousel}\n/*/\nvar CarouselProto = {\n\n\t/** @override */\n\tcidPrefix: \"carousel\",\n\t/** @override */\n\ttagName: \"div\",\n\t/** @override */\n\tclassName: \"carousel skip-transitions\",\n\n\t/* --------------------------- *\n\t/* properties\n\t/* --------------------------- */\n\n\tproperties: {\n\t\tscrolling: {\n\t\t\tget: function() {\n\t\t\t\treturn this._scrolling;\n\t\t\t}\n\t\t},\n\t\tselectedItem: {\n\t\t\tget: function() {\n\t\t\t\treturn this._selectedView.model;\n\t\t\t},\n\t\t\tset: function(value) {\n\t\t\t\tif (value)\n\t\t\t\t\tthis._onSelectOne(value)\n\t\t\t\telse\n\t\t\t\t\tthis._onSelectNone();\n\t\t\t}\n\t\t},\n\t},\n\n\tevents: {\n\t\t// \"mousedown\": \"_onMouseDown\", \"mouseup\": \"_onMouseUp\",\n\t\t\"transitionend .carousel-item.selected\": \"_onScrollTransitionEnd\",\n\t\t\"click .carousel-item:not(.selected)\": \"_onClick\",\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t_.bindAll(this, \"_onPointerEvent\", \"_onClick\");\n\n\t\tthis.itemViews = new Container();\n\t\tthis.metrics = {};\n\n\t\t_.extend(this, _.defaults(_.pick(options, Carousel.validOptions), Carousel.defaults));\n\n\t\t// this.childGap = 0; //this.dirProp(20, 18);\n\t\tthis._precedingDir = (Hammer.DIRECTION_LEFT | Hammer.DIRECTION_UP) & this.direction;\n\t\tthis._followingDir = (Hammer.DIRECTION_RIGHT | Hammer.DIRECTION_DOWN) & this.direction;\n\n\t\t// use supplied touch mgr or create private\n\t\tif (isValidTouchManager(options.touch, this.direction)) {\n\t\t\tthis.touch = options.touch;\n\t\t} else {\n\t\t\tconsole.warn(\"%s::initialize creating Hammer instance\", this.cid);\n\t\t\tthis.touch = createTouchManager(this.el, this.direction);\n\t\t\t// this.on(\"view:removed\", this.touch.destroy, this.touch);\n\t\t\tthis.listenTo(this, \"view:removed\", function() {\n\t\t\t\tthis.touch.destroy();\n\t\t\t});\n\t\t}\n\n\t\t/* create children and props */\n\t\tthis.setEnabled(true);\n\t\tthis.skipTransitions = true;\n\t\tthis._renderFlags = View.CHILDREN_INVALID;\n\t\t// this.invalidateChildren();\n\n\t\tthis.listenTo(this, \"view:attached\", function() {\n\t\t\tthis.skipTransitions = true;\n\t\t\t// this.invalidateSize();\n\t\t\t// this.renderNow();\n\t\t\t// this.requestRender();\n\t\t\tthis.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);\n\t\t});\n\n\t\t/* collection listeners */\n\t\tthis.listenTo(this.collection, {\n\t\t\t\"reset\": this._onReset,\n\t\t\t\"select:one\": this._onSelectOne,\n\t\t\t\"select:none\": this._onSelectNone,\n\t\t\t\"deselect:one\": this._onDeselectAny,\n\t\t\t\"deselect:none\": this._onDeselectAny,\n\t\t});\n\t},\n\t/* --------------------------- *\n\t/* Hammer init\n\t/* --------------------------- */\n\n\t// validateTouchManager: function(touch, direction) {\n\t// \ttry {\n\t// \t\treturn touch.get(\"pan\").options.direction === direction);\n\t// \t} catch (err) {\n\t// \t\treturn false;\n\t// \t}\n\t// },\n\n\t// initializeHammer: function(options) {\n\t// \t// direction from opts/defaults\n\t// \tif (options.direction === VERTICAL) {\n\t// \t\tthis.direction = VERTICAL;\n\t// \t} // do nothing: the default is horizontal\n\t//\n\t// \t// validate hammer instance or create local\n\t// \tif ((touch = options.touch) && (pan = touch.get(\"pan\"))) {\n\t// \t\t// Override direction only if specific\n\t// \t\tif (pan.options.direction !== Hammer.DIRECTION_ALL) {\n\t// \t\t\tthis.direction = pan.options.direction;\n\t// \t\t}\n\t// \t\tthis.panThreshold = pan.options.threshold;\n\t// \t} else {\n\t// \t\tconsole.warn(\"%s::initializeHammer using private Hammer instance\", this.cid);\n\t// \t\ttouch = createHammerInstance(this.el, this.panThreshold, this.direction);\n\t// \t\tthis.on(\"view:removed\", touch.destroy, touch);\n\t// \t}\n\t// \tthis.touch = touch;\n\t// },\n\n\tremove: function() {\n\t\t// this._scrollPendingAction && this._scrollPendingAction(true);\n\t\t// if (this._enabled) {\n\t\t// \tthis.touch.off(\"tap\", this._onTap);\n\t\t// \tthis.touch.off(\"hpanstart hpanmove hpanend hpancancel\", this._onPan);\n\t\t// }\n\t\tthis._togglePointerEvents(false);\n\t\tthis.removeChildren();\n\t\tView.prototype.remove.apply(this, arguments);\n\t\treturn this;\n\t},\n\n\n\t/* --------------------------- *\n\t/* helper functions\n\t/* --------------------------- */\n\n\tdirProp: function(hProp, vProp) {\n\t\treturn (this.direction & HORIZONTAL) ? hProp : vProp;\n\t},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\t// render: function() {\n\t// \tif (this.attached) {\n\t// \t\tthis.skipTransitions = true;\n\t// \t\t// this.invalidateSize();\n\t// \t\tthis.renderNow(true);\n\t// \t}\n\t// },\n\n\t// /** @override */\n\t// render: function () {\n\t// \tif (!this.attached) {\n\t// \t\tif (!this._renderPending) {\n\t// \t\t\tthis._renderPending = true;\n\t// \t\t\tthis.listenTo(this, \"view:attached\", this.render);\n\t// \t\t}\n\t// \t} else {\n\t// \t\tif (this._renderPending) {\n\t// \t\t\tthis._renderPending = false;\n\t// \t\t\tthis.stopListening(this, \"view:attached\", this.render);\n\t// \t\t}\n\t// \t\tthis._delta = 0;\n\t// \t\tthis.skipTransitions = true;\n\t// \t\tthis.invalidateSize();\n\t// \t\t// this.invalidateLayout();\n\t// \t\tthis.renderNow();\n\t// \t}\n\t// \treturn this;\n\t// },\n\n\t// render: function () {\n\t// \tthis.measureLater();\n\t// \tthis.scrollBy(0, Carousel.IMMEDIATE);\n\t//\n\t// \tif (this.el.parentElement) {\n\t// \t\tthis.renderNow();\n\t// \t}\n\t// \treturn this;\n\t// },\n\n\t/** @override */\n\trenderFrame: function(tstamp, flags) {\n\t\tif (flags & View.CHILDREN_INVALID) {\n\t\t\tthis._createChildren();\n\t\t\t// clear this flag now: render may be deferred until attached\n\t\t\tflags &= ~View.CHILDREN_INVALID;\n\t\t}\n\t\tif (this.attached) {\n\t\t\tif (flags & View.SIZE_INVALID) {\n\t\t\t\tthis._measure();\n\t\t\t}\n\t\t\tif (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {\n\t\t\t\tthis._scrollBy(this._delta, this.skipTransitions);\n\t\t\t}\n\t\t} else if (flags) {\n\t\t\tthis.listenToOnce(this, \"view:attached\", function() {\n\t\t\t\tthis.requestRender(flags);\n\t\t\t});\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* enabled\n\t/* --------------------------- */\n\n\t// /** @override */\n\t// _enabled: undefined,\n\n\t/** @override */\n\tsetEnabled: function(enabled) {\n\t\tif (this._enabled !== enabled) {\n\t\t\tthis._enabled = enabled;\n\t\t\t// toggle events immediately\n\t\t\tthis._togglePointerEvents(enabled);\n\t\t\t// dom manipulation on render (_renderEnabled)\n\t\t\t// this._renderFlags |= View.STYLES_INVALID;\n\t\t\t// this.requestRender();\n\t\t\tthis.setImmediate(this._renderEnabled);\n\t\t\t// this._renderEnabled();\n\t\t}\n\t},\n\n\t_renderEnabled: function() {\n\t\tthis.el.classList.toggle(\"disabled\", !this.enabled);\n\t\tthis.itemViews.each(function(view) {\n\t\t\tview.setEnabled(this.enabled);\n\t\t}, this);\n\t},\n\n\t/* --------------------------- *\n\t/* Create children\n\t/* --------------------------- */\n\n\t_createChildren: function() {\n\t\t// var sIndex;\n\t\tvar buffer, renderer, view, viewOpts;\n\n\t\tthis.removeChildren();\n\n\t\tif (this.collection.length) {\n\t\t\tviewOpts = {\n\t\t\t\t// viewDepth: this.viewDepth + 1,\n\t\t\t\t// parentView: this,\n\t\t\t\tenabled: this.enabled\n\t\t\t};\n\t\t\tbuffer = document.createDocumentFragment();\n\t\t\t// buffer = this.el;\n\n\t\t\tif (!this.requireSelection) {\n\t\t\t\trenderer = this.rendererFunction(null, -1, this.collection);\n\t\t\t\tview = new renderer(viewOpts);\n\t\t\t\tthis.itemViews.add(view);\n\t\t\t\tbuffer.appendChild(view.el);\n\t\t\t\tthis.emptyView = view;\n\t\t\t}\n\n\t\t\tthis.collection.each(function(item, index, arr) {\n\t\t\t\tviewOpts.model = item;\n\t\t\t\trenderer = this.rendererFunction(item, index, arr);\n\t\t\t\tview = new renderer(viewOpts);\n\t\t\t\tthis.itemViews.add(view);\n\t\t\t\tbuffer.appendChild(view.el);\n\t\t\t}, this);\n\n\t\t\t// if (!this.requireSelection) {\n\t\t\t// \tbuffer = this.appendItemView(buffer, this.model, -1, this.collection);\n\t\t\t// \tthis.emptyView = this.itemViews.first();\n\t\t\t// }\n\t\t\t// buffer = this.collection.reduce(this.appendItemView, buffer, this);\n\n\t\t\tthis.adjustToSelection();\n\t\t\tthis._selectedView.el.classList.add(\"selected\");\n\n\t\t\tthis.el.appendChild(buffer);\n\t\t}\n\t},\n\n\t// appendItemView: function (parentEl, model, index, arr) {\n\t// \tvar renderer = this.rendererFunction(model, index, arr);\n\t// \tvar view = new renderer({\n\t// \t\tmodel: model,\n\t// \t\tparentView: this,\n\t// \t\tenabled: this.enabled\n\t// \t});\n\t// \tthis.itemViews.add(view);\n\t// \tparentEl.appendChild(view.el);\n\t// \treturn parentEl;\n\t// },\n\n\t// createItemView: function (renderer, opts) {\n\t// \tvar view = new renderer(opts);\n\t// \tthis.itemViews.add(view);\n\t// \treturn view;\n\t// },\n\n\tremoveChildren: function() {\n\t\tthis.itemViews.each(this.removeItemView, this);\n\t\tthis.emptyView = (void 0);\n\t},\n\n\tremoveItemView: function(view) {\n\t\tthis.itemViews.remove(view);\n\t\tview.remove();\n\t\treturn view;\n\t},\n\n\t/* --------------------------- *\n\t/* measure\n\t/* --------------------------- */\n\n\t_measure: function() {\n\t\tvar m, mm;\n\t\tvar pos = 0,\n\t\t\tposInner = 0;\n\t\tvar maxAcross = 0,\n\t\t\tmaxOuter = 0;\n\t\tvar maxOuterView, maxAcrossView;\n\n\t\tmaxOuterView = maxAcrossView = this.emptyView || this.itemViews.first();\n\n\t\t// chidren metrics\n\t\tthis.itemViews.each(function(view) {\n\t\t\tview.render();\n\t\t});\n\n\t\tthis.itemViews.each(function(view) {\n\t\t\tm = this.measureItemView(view);\n\t\t\tm.pos = pos;\n\t\t\tpos += m.outer; // + this.childGap;\n\t\t\tm.posInner = posInner;\n\t\t\tposInner += m.inner; //+ this.childGap;\n\t\t\tif (view !== this.emptyView) {\n\t\t\t\tif (m.across > maxAcross) {\n\t\t\t\t\tmaxAcross = m.across;\n\t\t\t\t\tmaxAcrossView = view;\n\t\t\t\t}\n\t\t\t\tif (m.outer > maxOuter) {\n\t\t\t\t\tmaxOuter = m.outer;\n\t\t\t\t\tmaxOuterView = view;\n\t\t\t\t}\n\t\t\t}\n\t\t}, this);\n\n\t\t// measure self + max child metrics\n\t\tmm = this.metrics[this.cid] || (this.metrics[this.cid] = {});\n\t\tmm.outer = this.el[this.dirProp(\"offsetWidth\", \"offsetHeight\")];\n\t\tmm.before = maxOuterView.el[this.dirProp(\"offsetLeft\", \"offsetTop\")];\n\t\tmm.inner = maxOuterView.el[this.dirProp(\"offsetWidth\", \"offsetHeight\")];\n\t\tmm.after = mm.outer - (mm.inner + mm.before);\n\t\tmm.across = maxAcross;\n\n\t\t// m = this.metrics[maxOuterView.cid];\n\t\t// mm.inner = m.inner;\n\n\t\t// tap area\n\t\tthis._tapAcrossBefore = maxAcrossView.el[this.dirProp(\"offsetTop\", \"offsetLeft\")];\n\t\tthis._tapAcrossAfter = this._tapAcrossBefore + maxAcross;\n\t\tthis._tapBefore = mm.before + this._tapGrow;\n\t\tthis._tapAfter = mm.before + mm.inner - this._tapGrow;\n\n\t\tthis.selectThreshold = Math.min(MAX_SELECT_THRESHOLD, mm.outer * 0.1);\n\t},\n\n\tmeasureItemView: function(view) {\n\t\tvar m, viewEl;\n\t\t// var s, sizeEl;\n\n\t\tviewEl = view.el;\n\t\tm = this.metrics[view.cid] || (this.metrics[view.cid] = {});\n\n\t\tm.outer = viewEl[this.dirProp(\"offsetWidth\", \"offsetHeight\")];\n\t\tm.across = viewEl[this.dirProp(\"offsetHeight\", \"offsetWidth\")];\n\n\t\tif (view.metrics) {\n\t\t\tm.before = view.metrics[this.dirProp(\"marginLeft\", \"marginTop\")];\n\t\t\tm.outer += m.before;\n\t\t\tm.outer += view.metrics[this.dirProp(\"marginRight\", \"marginBottom\")];\n\t\t\tm.inner = view.metrics.content[this.dirProp(\"width\", \"height\")];\n\t\t\tm.before += view.metrics.content[this.dirProp(\"x\", \"y\")];\n\t\t\tm.after = m.outer - (m.inner + m.before);\n\n\t\t\t// var marginBefore = view.metrics[this.dirProp(\"marginLeft\",\"marginTop\")];\n\t\t\t// var marginAfter = view.metrics[this.dirProp(\"marginRight\",\"marginBottom\")];\n\t\t\t// var pos = view.metrics.content[this.dirProp(\"x\",\"y\")];\n\t\t\t//\n\t\t\t// m.inner = view.metrics.content[this.dirProp(\"width\",\"height\")];\n\t\t\t// m.before = marginBefore + pos;\n\t\t\t// m.outer += marginBefore + marginAfter;\n\t\t\t// m.after = m.outer - (m.inner + m.before);\n\t\t} else {\n\t\t\t// throw new Error(\"renderer has no metrics\");\n\t\t\tconsole.warn(\"%s::measureItemView view '%s' has no metrics\", this.cid, view.cid);\n\t\t\tm.inner = m.outer;\n\t\t\tm.after = m.before = 0;\n\t\t}\n\n\t\treturn m;\n\t},\n\n\t/* --------------------------- *\n\t/* scrolling property\n\t/* --------------------------- */\n\n\t_delta: 0,\n\n\t_scrolling: false,\n\n\t_setScrolling: function(scrolling) {\n\t\t// console.warn(\"_setScrolling current/requested\", this._scrolling, scrolling);\n\t\tif (this._scrolling != scrolling) {\n\t\t\tthis._scrolling = scrolling;\n\t\t\tthis.el.classList.toggle(\"scrolling\", scrolling);\n\t\t\tthis.trigger(scrolling ? \"view:scrollstart\" : \"view:scrollend\");\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Scroll/layout\n\t/* --------------------------- */\n\n\tscrollBy: function(delta, skipTransitions) {\n\t\tthis._delta = delta || 0;\n\t\tthis.skipTransitions = !!skipTransitions;\n\t\t// this.invalidateLayout();\n\t\tthis.requestRender(View.LAYOUT_INVALID);\n\t},\n\n\t_scrollBy: function(delta, skipTransitions) {\n\t\tvar sMetrics, metrics, pos;\n\n\t\tsMetrics = this.metrics[(this._scrollCandidateView || this._selectedView).cid];\n\t\tthis.itemViews.each(function(view) {\n\t\t\tmetrics = this.metrics[view.cid];\n\t\t\tpos = Math.floor(this._getScrollOffset(delta, metrics, sMetrics));\n\t\t\tview.metrics.translateX = (this.direction & HORIZONTAL) ? pos : 0;\n\t\t\tview.metrics.translateY = (this.direction & HORIZONTAL) ? 0 : pos;\n\t\t\tview.metrics._transform = translateTemplate(view.metrics.translateX, view.metrics.translateY);\n\t\t\tview.el.style[transformProperty] = view.metrics._transform;\n\t\t\t// view.el.style[transformProperty] = (this.direction & HORIZONTAL)?\n\t\t\t// \t\"translate3d(\" + pos + \"px,0,0)\":\n\t\t\t// \t\"translate3d(0,\" + pos + \"px,0)\";\n\t\t}, this);\n\n\t\tthis.el.classList.toggle(\"skip-transitions\", skipTransitions);\n\t\tthis.selectFromView();\n\t},\n\n\t_getScrollOffset: function(delta, mCurr, mSel) {\n\t\tvar pos, offset = 0;\n\n\t\tpos = mCurr.pos - mSel.pos + delta;\n\t\tif (pos < 0) {\n\t\t\tif (Math.abs(pos) < mSel.outer) {\n\t\t\t\toffset += (-mCurr.after) / mSel.outer * pos;\n\t\t\t} else {\n\t\t\t\toffset += mCurr.after;\n\t\t\t}\n\t\t} else\n\t\tif (0 <= pos) {\n\t\t\tif (Math.abs(pos) < mSel.outer) {\n\t\t\t\toffset -= mCurr.before / mSel.outer * pos;\n\t\t\t} else {\n\t\t\t\toffset -= mCurr.before;\n\t\t\t}\n\t\t}\n\t\treturn pos + offset;\n\t},\n\n\t_onScrollTransitionEnd: function(ev) {\n\t\tif (ev.propertyName === transformStyleName && this.scrolling) {\n\t\t\tconsole.log(\"%s::_onScrollTransitionEnd selected: %s\", this.cid, ev.target.cid);\n\t\t\tthis._setScrolling(false);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* toggle touch events\n\t/* --------------------------- */\n\n\t_togglePointerEvents: function(enable) {\n\t\t// console.log(\"%s::_togglePointerEvents\", this.cid, enable);\n\t\tif (this._pointerEventsEnabled == enable) return;\n\n\t\tthis._pointerEventsEnabled = enable;\n\t\tif (enable) {\n\t\t\tthis.touch.on(\"hpanstart hpanmove hpanend hpancancel\", this._onPointerEvent);\n\t\t\tthis.el.addEventListener(View.CLICK_EVENT, this._onClick, true);\n\t\t} else {\n\t\t\tthis.touch.off(\"hpanstart hpanmove hpanend hpancancel\", this._onPointerEvent);\n\t\t\tthis.el.removeEventListener(View.CLICK_EVENT, this._onClick, true);\n\t\t}\n\t},\n\n\t_onPointerEvent: function(ev) {\n\t\t// NOTE: https://github.com/hammerjs/hammer.js/pull/1118\n\t\tif (ev.srcEvent.type === 'pointercancel')\n\t\t\treturn;\n\t\t// console.log(\"%s::_onPointerEvent\", this.cid, ev.type,\n\t\t// \tdirToStr(ev.direction),\n\t\t// \tdirToStr(ev.offsetDirection),\n\t\t// \tdirToStr(this.direction),\n\t\t// \tdirToStr(ev.direction | this.direction));\n\t\t// if (ev.direction & this.direction) {\n\t\tswitch (ev.type) {\n\t\t\t// case View.CLICK_EVENT:\n\t\t\t// \treturn this._onClick(ev);\n\t\t\t// case \"tap\":\n\t\t\t// \treturn this._onTap(ev);\n\t\t\tcase \"hpanstart\":\n\t\t\t\treturn this._onPanStart(ev);\n\t\t\tcase \"hpanmove\":\n\t\t\t\treturn this._onPanMove(ev);\n\t\t\tcase \"hpanend\":\n\t\t\t\treturn this._onPanFinal(ev);\n\t\t\tcase \"hpancancel\":\n\t\t\t\treturn this._onPanFinal(ev);\n\t\t}\n\t\t// }\n\t},\n\n\t/* --------------------------- *\n\t/* touch event: pan\n\t/* --------------------------- */\n\n\tgetViewAtPanDir: function(dir) {\n\t\t// return (dir & this._precedingDir) ? this._precedingView : this._followingView;\n\t\treturn (dir & this._followingDir) ? this._precedingView : this._followingView;\n\t},\n\n\t// _panCapturedOffset: 0,\n\n\t/** @param {Object} ev */\n\t_onPanStart: function(ev) {\n\t\tthis.selectFromView();\n\t\tthis.el.classList.add(\"panning\");\n\t\tthis._setScrolling(true);\n\t},\n\n\t/** @param {Object} ev */\n\t_onPanMove: function(ev) {\n\t\t// var delta = (this.direction & HORIZONTAL) ? ev.thresholdDeltaX : ev.thresholdDeltaY;\n\t\tvar delta = (this.direction & HORIZONTAL) ? ev.deltaX : ev.deltaY;\n\t\tvar view = this.getViewAtPanDir(ev.offsetDirection);\n\t\tvar cView = this._panCandidateView;\n\n\t\tif (cView !== view) {\n\t\t\tcView && cView.el.classList.remove(\"candidate\");\n\t\t\tview && view.el.classList.add(\"candidate\");\n\t\t\tthis._panCandidateView = view;\n\t\t}\n\t\tif (cView === (void 0)) {\n\t\t\tdelta *= Globals.HPAN_OUT_DRAG;\n\t\t}\n\n\t\tif (this._renderRafId !== -1) {\n\t\t\tthis.scrollBy(delta, Carousel.IMMEDIATE);\n\t\t\tthis.renderNow();\n\t\t} else {\n\t\t\tthis._scrollBy(delta, Carousel.IMMEDIATE);\n\t\t}\n\t},\n\n\t/** @param {Object} ev */\n\t_onPanFinal: function(ev) {\n\t\tvar scrollCandidate;\n\t\t// NOTE: this delta is used for determining selection, NOT for layout\n\t\t// var delta = (this.direction & HORIZONTAL) ? ev.thresholdDeltaX : ev.thresholdDeltaY;\n\t\tvar delta = (this.direction & HORIZONTAL) ? ev.deltaX : ev.deltaY;\n\n\t\tif ((ev.type == \"hpanend\")\n\t\t\t/* pan direction (current event) and offsetDirection (whole gesture) must match */\n\t\t\t&& (ev.direction ^ ev.offsetDirection ^ this.direction)\n\t\t\t// && (ev.direction & ev.offsetDirection & this.direction)\n\t\t\t/* gesture must overshoot selectThreshold */\n\t\t\t&& (Math.abs(delta) > this.selectThreshold)) {\n\t\t\t/* choose next scroll target */\n\t\t\tscrollCandidate = this.getViewAtPanDir(ev.offsetDirection);\n\t\t}\n\t\tthis._scrollCandidateView = scrollCandidate || (void 0);\n\n\t\tif (this._panCandidateView && (this._panCandidateView !== scrollCandidate)) {\n\t\t\tthis._panCandidateView.el.classList.remove(\"candidate\");\n\t\t}\n\t\tthis._panCandidateView = (void 0);\n\t\tthis.el.classList.remove(\"panning\");\n\n\t\tthis.scrollBy(0, Carousel.ANIMATED);\n\t\tthis.selectFromView();\n\n\t\t// if (this._renderRafId !== -1) {\n\t\t// \tthis.scrollBy(0, Carousel.ANIMATED);\n\t\t// \tthis.renderNow();\n\t\t// } else {\n\t\t// \tthis._scrollBy(0, Carousel.ANIMATED);\n\t\t// }\n\t},\n\n\t/* --------------------------- *\n\t/* touch event: tap\n\t/* --------------------------- */\n\n\t/** @type {int} In pixels */\n\t_tapGrow: 10,\n\n\tgetViewAtTapPos: function(posAlong, posAcross) {\n\t\tif ((this._tapAcrossBefore < posAcross) && (posAcross < this._tapAcrossAfter)) {\n\t\t\tif (posAlong < this._tapBefore) {\n\t\t\t\treturn this._precedingView;\n\t\t\t} else\n\t\t\tif (posAlong > this._tapAfter) {\n\t\t\t\treturn this._followingView;\n\t\t\t}\n\t\t}\n\t\treturn (void 0);\n\t},\n\n\t_onClick: function(ev) {\n\t\tconsole.log(\"%s::_onClick\", this.cid, ev.type, ev);\n\t\tthis._onTap(ev);\n\t},\n\n\t_onTap: function(ev) {\n\t\tif (ev.defaultPrevented) return;\n\n\t\tvar tapCandidate;\n\t\tvar targetView = View.findByDescendant(ev.target);\n\t\t// console.log(\"%s::_onTap %o\", this.cid, targetView.cid, ev.target);\n\t\t// if (!this.itemViews.contains(targetView)) {\n\t\t// \treturn;\n\t\t// }\n\t\tdo {\n\t\t\tif (this._selectedView === targetView) {\n\t\t\t\ttapCandidate = null;\n\t\t\t\tbreak;\n\t\t\t} else if (this === targetView.parentView) {\n\t\t\t\ttapCandidate = targetView;\n\t\t\t\tbreak;\n\t\t\t} else if (this === targetView) {\n\t\t\t\tvar bounds, tapX, tapY;\n\t\t\t\tbounds = this.el.getBoundingClientRect();\n\t\t\t\ttapX = (ev.type == \"tap\" ? ev.center.x : ev.clientX) - bounds.left;\n\t\t\t\ttapY = (ev.type == \"tap\" ? ev.center.y : ev.clientY) - bounds.top;\n\t\t\t\ttapCandidate = this.getViewAtTapPos(\n\t\t\t\t\tthis.dirProp(tapX, tapY),\n\t\t\t\t\tthis.dirProp(tapY, tapX)\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} while ((targetView = targetView.parentView))\n\n\t\tif (tapCandidate) {\n\t\t\tev.preventDefault();\n\t\t\t// ev.stopPropagation();\n\n\t\t\t// this._scrollCandidateView = tapCandidate;\n\t\t\t// this._setScrolling(true);\n\t\t\t// this.scrollBy(0, Carousel.ANIMATED);\n\t\t\t// this._scrollCandidateView.el.classList.add(\"candidate\");\n\t\t\t// this.selectFromView();\n\n\t\t\t//// NOT using internalSelection\n\t\t\t// this.triggerSelectionEvents(tapCandidate, false);\n\n\t\t\t// using internalSelection\n\t\t\tthis._scrollCandidateView = tapCandidate;\n\t\t\tthis._setScrolling(true);\n\t\t\tthis.scrollBy(0, Carousel.ANIMATED);\n\n\t\t\tthis.triggerSelectionEvents(tapCandidate, true);\n\t\t\t// this.renderNow();\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Private\n\t/* --------------------------- */\n\n\ttriggerSelectionEvents: function(view, internal) {\n\t\tif (view === (void 0) || this._internalSelection) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._internalSelection = !!internal;\n\t\tif (view === this.emptyView) {\n\t\t\tthis.trigger(\"view:select:none\");\n\t\t} else {\n\t\t\tthis.trigger(\"view:select:one\", view.model);\n\t\t}\n\t\tthis._internalSelection = false;\n\t},\n\n\tselectFromView: function() {\n\t\tif (this._scrollCandidateView === (void 0)) {\n\t\t\treturn;\n\t\t}\n\t\tvar view = this._scrollCandidateView;\n\n\t\tthis.triggerSelectionEvents(view, true);\n\n\t\t// this._scrollCandidateView = (void 0);\n\t\t// view.el.classList.remove(\"candidate\");\n\t\t// this.requestAnimationFrame(function() {});\n\t},\n\n\tadjustToSelection: function() {\n\t\tvar m, i = this.collection.selectedIndex;\n\t\t// assume -1 < index < this.collection.length\n\t\tif (this.requireSelection) {\n\t\t\t(i == -1) && i++; // if selection is null (index -1), set _selectedView to first item (index 0)\n\t\t\tthis._selectedView = (m = this.collection.at(i)) && this.itemViews.findByModel(m);\n\t\t\tthis._precedingView = (m = this.collection.at(i - 1)) && this.itemViews.findByModel(m);\n\t\t\tthis._followingView = (m = this.collection.at(i + 1)) && this.itemViews.findByModel(m);\n\t\t} else {\n\t\t\tthis._selectedView = (m = this.collection.at(i)) ? this.itemViews.findByModel(m) : this.emptyView;\n\t\t\tthis._precedingView = m && ((m = this.collection.at(i - 1)) ? this.itemViews.findByModel(m) : this.emptyView);\n\t\t\tthis._followingView = (m = this.collection.at(i + 1)) && this.itemViews.findByModel(m);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Model listeners\n\t/* --------------------------- */\n\n\t/** @private */\n\t_onSelectOne: function(model) {\n\t\tif (model === this._selectedView.model) {\n\t\t\t// console.info(\"INTERNAL\");\n\t\t\treturn;\n\t\t}\n\t\tthis._onSelectAny(model);\n\t},\n\n\t/** @private */\n\t_onSelectNone: function() {\n\t\tif ((this.requireSelection ? this.itemViews.first() : this.emptyView) === this._selectedView) {\n\t\t\t// console.info(\"INTERNAL\");\n\t\t\treturn;\n\t\t}\n\t\tthis._onSelectAny();\n\t},\n\n\t/** @private */\n\t_onSelectAny: function(model) {\n\t\tthis._selectedView.el.classList.remove(\"selected\");\n\t\tthis.adjustToSelection();\n\t\tthis._selectedView.el.classList.add(\"selected\");\n\t\tif (this._scrollCandidateView) {\n\t\t\tthis._scrollCandidateView.el.classList.remove(\"candidate\");\n\t\t\tthis._scrollCandidateView = (void 0);\n\t\t}\n\n\t\tif (!this._internalSelection) {\n\t\t\tthis._setScrolling(true);\n\t\t\tthis.scrollBy(0, Carousel.ANIMATED);\n\t\t}\n\t},\n\n\t// _onDeselectAny: function (model) {},\n\n\t/** @private */\n\t_onReset: function() {\n\t\t// this._createChildren();\n\t\t// this.invalidateChildren();\n\t\tthis.requestRender(View.CHILDREN_INVALID | View.MODEL_INVALID);\n\t},\n\n\n\t/* --------------------------- *\n\t/* TEMP\n\t/* --------------------------- */\n\n\t// _scrollBy2: function (delta, skipTransitions) {\n\t// \tvar metrics, pos;\n\t// \tvar sMetrics = this.metrics[(this._scrollCandidateView || this._selectedView).cid];\n\t// \tvar cMetrics = this.metrics[(this._panCandidateView || this._selectedView).cid];\n\t//\n\t// \tthis.itemViews.each(function (view) {\n\t// \t\tmetrics = this.metrics[view.cid];\n\t// \t\tpos = Math.floor(this._getScrollOffset(delta, metrics, sMetrics, cMetrics));\n\t// \t\tview.el.style[transformProperty] = (this.direction & HORIZONTAL)?\n\t// \t\t\t\t\"translate3d(\" + pos + \"px,0,0)\" : \"translate3d(0,\" + pos + \"px,0)\";\n\t// \t\t\t\t// \"translate(\" + pos + \"px,0)\" : \"translate(0,\" + pos + \"px)\";\n\t// \t\t\t\t// \"translateX(\" + pos + \"px)\" : \"translateY(\" + pos + \"px)\";\n\t// \t}, this);\n\t// \tthis.el.classList.toggle(\"skip-transitions\", skipTransitions);\n\t// \tthis.selectFromView();\n\t// },\n\n\t// _getScrollOffset2: function (delta, mCurr, mSel, mCan) {\n\t// \tvar offset = 0;\n\t// \tvar posInner = mCurr.posInner - mSel.posInner + delta;\n\t//\n\t// \tif (posInner < -mSel.inner) {\n\t// \t\toffset = -(mCurr.before);\n\t// \t} else if (posInner > mSel.inner) {\n\t// \t\toffset = (mSel.after);\n\t// \t} else {\n\t// \t\tif (posInner < 0) {\n\t// \t\t\toffset = (mCurr.before) / (mCurr.inner) * posInner;\n\t// \t\t} else {\n\t// \t\t\toffset = (mSel.after) / (mCan.inner) * posInner;\n\t// \t\t}\n\t// \t}\n\t// \treturn posInner + offset;\n\t// },\n\n\t// captureSelectedOffset: function() {\n\t// \tvar val, view, cssval, m, mm;\n\t//\n\t// \tval = 0;\n\t// \tview = this._scrollCandidateView || this._selectedView;\n\t// \tcssval = getComputedStyle(view.el)[transformProperty];\n\t//\n\t// \tmm = cssval.match(/(matrix|matrix3d)\\(([^\\)]+)\\)/);\n\t// \tif (mm) {\n\t// \t\tm = mm[2].split(\",\");\n\t// \t\tif (this.direction & HORIZONTAL) {\n\t// \t\t\tval = m[mm[1]==\"matrix\"? 4 : 12];\n\t// \t\t} else {\n\t// \t\t\tval = m[mm[1]==\"matrix\"? 5 : 13];\n\t// \t\t}\n\t// \t\tval = parseFloat(val);\n\t// \t}\n\t//\n\t// \tconsole.log(\"%s::captureSelectedOffset\", this.cid, cssval, val, cssval.match(/matrix\\((?:\\d\\,){3}(\\d)\\,(\\d)|matrix3d\\((?:\\d\\,){11}(\\d)\\,(\\d)/));\n\t//\n\t// \treturn val;\n\t// },\n\n\t// _onScrollEnd: function(exec) {\n\t// \tthis._scrollEndCancellable = (void 0);\n\t// \t// this.el.classList.remove(\"disabled-changing\");\n\t// \tif (exec) {\n\t// \t\tthis._setScrolling(false);\n\t// \t\t// this.el.classList.remove(\"scrolling\");\n\t// \t\t// this.trigger(\"view:scrollend\");\n\t// \t\tconsole.log(\"%s::_onScrollEnd\", this.cid);\n\t// \t}\n\t// },\n\t// _onMouseDown: function(ev) {\n\t// \tif (this._scrolling) {\n\t// \t\tthis._panCapturedOffset = this.captureSelectedOffset();\n\t// \t\tconsole.log(\"%s::events[mousedown] scrolling interrupted (pos %f)\", this.cid, this._panCapturedOffset);\n\t// \t}\n\t// },\n\t// _onMouseUp:function(ev) {\n\t// \tthis._panCapturedOffset = 0;\n\t// },\n\n};\n\nif (DEBUG) {\n\tCarouselProto._logFlags = \"\";\n}\n\nmodule.exports = Carousel = View.extend(CarouselProto, Carousel);\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper;\n\n  return container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"id\",\"hash\":{},\"data\":data}) : helper)));\n},\"useData\":true});\n",
    "/**\n * @module app/view/component/CollectionStack\n */\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n\n/** @type {string} */\nvar viewTemplate = require(\"./CollectionStack.hbs\");\n\n/**\n * @constructor\n * @type {module:app/component/CollectionStack}\n */\nmodule.exports = View.extend({\n\n\t/** @override */\n\tcidPrefix: \"stack\",\n\t/** @override */\n\ttagName: \"div\",\n\t/** @override */\n\tclassName: \"stack\",\n\t/** @override */\n\ttemplate: viewTemplate,\n\n\tevents: {\n\t\t\"transitionend\": function(ev) {\n\t\t\t// console.log(\"%s::transitionend [invalid: %s] [transition: %s]\", this.cid, this._contentInvalid, (this._skipTransitions? \"skip\": \"run\"), ev.target.id, ev.target.className);\n\t\t\tthis._renderContent();\n\t\t}\n\t},\n\n\tinitialize: function(options) {\n\t\tthis._enabled = true;\n\t\tthis._skipTransitions = true;\n\t\tthis._contentInvalid = true;\n\n\t\toptions.template && (this.template = options.template);\n\t\tthis.content = document.createElement(\"div\");\n\t\tthis.content.className = \"stack-item\";\n\t\tthis.el.appendChild(this.content);\n\n\t\tthis.listenTo(this.collection, \"select:one select:none\", this._onSelectChange);\n\t},\n\n\tsetEnabled: function(enabled) {\n\t\tif (this._enabled !== enabled) {\n\t\t\tthis._enabled = enabled;\n\t\t\tthis.el.classList.toggle(\"disabled\", !this._enabled);\n\t\t}\n\t},\n\n\t_onSelectChange: function(item) {\n\t\tif (this._renderedItem === this.collection.selected) {\n\t\t\tthrow new Error(\"change event received but item is identical\");\n\t\t}\n\t\tthis._renderedItem = this.collection.selected;\n\n\t\tthis._contentInvalid = true;\n\t\tthis.render();\n\t},\n\n\t/* --------------------------- *\n\t/* render\n\t/* --------------------------- */\n\n\trender: function() {\n\t\tif (this._skipTransitions) {\n\t\t\t// execute even if content has not changed to apply styles immediately\n\t\t\tthis._skipTransitions = false;\n\t\t\tthis.el.classList.add(\"skip-transitions\");\n\t\t\tthis.setImmediate(function() {\n\t\t\t\tthis.el.classList.remove(\"skip-transitions\");\n\t\t\t});\n\n\t\t\t// render changed content immediately\n\t\t\tif (this._contentInvalid) {\n\t\t\t\tthis._renderContent();\n\t\t\t}\n\t\t} else {\n\t\t\t// else remove 'current' class and render on transitionend\n\t\t\tif (this._contentInvalid) {\n\t\t\t\tthis.content.classList.remove(\"current\");\n\t\t\t\t// this.content.className = \"stack-item\";\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\n\t_renderContent: function() {\n\t\tif (this._contentInvalid) {\n\t\t\tthis._contentInvalid = false;\n\t\t\tvar item = this.collection.selected;\n\t\t\tthis.content.innerHTML = item ? this.template(item.toJSON()) : \"\";\n\t\t\tthis.content.classList.add(\"current\");\n\t\t\t// this.content.className = \"stack-item current\";\n\t\t}\n\t},\n});\n",
    "/**\n/* @module app/view/component/FilterableListView\n/*/\n\n/** @type {module:backbone.babysitter} */\nvar Container = require(\"backbone.babysitter\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/component/ClickableRenderer} */\nvar ClickableRenderer = require(\"app/view/render/ClickableRenderer\");\n/** @type {module:utils/prefixedProperty} */\nvar prefixedProperty = require(\"utils/prefixedProperty\");\n/** @type {module:utils/css/getBoxEdgeStyles} */\nvar getBoxEdgeStyles = require(\"utils/css/getBoxEdgeStyles\");\n/** @type {module:utils/array/difference} */\nvar diff = require(\"utils/array/difference\");\n/** @type {module:utils/promise/resolveAll} */\nvar resolveAll = require(\"utils/promise/resolveAll\");\n/** @type {module:utils/promise/rejectAll} */\nvar rejectAll = require(\"utils/promise/rejectAll\");\n\n// var resolveAll = function(pp, result) {\n// \tif (pp.length != 0) {\n// \t\tpp.forEach(function(p, i, a) {\n// \t\t\tp.resolve(result);\n// \t\t\ta[i] = null;\n// \t\t});\n// \t\tpp.length = 0;\n// \t}\n// \treturn pp;\n// };\n\n// var rejectAll = function(pp, reason) {\n// \tif (pp.length != 0) {\n// \t\tpp.forEach(function(p, i, a) {\n// \t\t\tp.reject(reason);\n// \t\t\ta[i] = null;\n// \t\t});\n// \t\tpp.length = 0;\n// \t}\n// \treturn pp;\n// };\n\n/** @type {module:app/control/Globals.TRANSLATE_TEMPLATE} */\nvar translateCssValue = require(\"app/control/Globals\").TRANSLATE_TEMPLATE;\n\n/** @const */\nvar transformProp = prefixedProperty(\"transform\");\n\n/**\n/* @constructor\n/* @type {module:app/view/component/FilterableListView}\n/*/\nvar FilterableListView = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"filterableList\",\n\t/** @override */\n\ttagName: \"ul\",\n\t/** @override */\n\tclassName: \"list selectable filterable\",\n\n\t/** @override */\n\tdefaults: {\n\t\tcollapsed: true,\n\t\tfilterFn: function() {\n\t\t\treturn true;\n\t\t},\n\t\trenderer: ClickableRenderer.extend({\n\t\t\t/** @override */\n\t\t\tcidPrefix: \"listItem\",\n\t\t\t/** @override */\n\t\t\tclassName: \"list-item list-node\",\n\t\t}),\n\t},\n\n\t/** @override */\n\tproperties: {\n\t\tcollapsed: {\n\t\t\tget: function() {\n\t\t\t\treturn this._collapsed;\n\t\t\t},\n\t\t\tset: function(value) {\n\t\t\t\tthis._setCollapsed(value);\n\t\t\t}\n\t\t},\n\t\tselectedItem: {\n\t\t\tget: function() {\n\t\t\t\treturn this._selectedItem;\n\t\t\t},\n\t\t\tset: function(value) {\n\t\t\t\tthis._setSelection(value);\n\t\t\t}\n\t\t},\n\t\tfilteredItems: {\n\t\t\tget: function() {\n\t\t\t\treturn this._filteredItems;\n\t\t\t}\n\t\t},\n\t\tmetrics: {\n\t\t\tget: function() {\n\t\t\t\treturn this._metrics;\n\t\t\t}\n\t\t}\n\t},\n\n\t/** @override */\n\tevents: {\n\t\t\"transitionend .list-node\": function(ev) {\n\t\t\t// if (!ev.target.classList.contains(\"list-node\")) {}\n\t\t\tif (ev.propertyName == transformProp\n\t\t\t\t&& ev.target.parentElement === this.el) {\n\t\t\t\tthis._changedPosNum--;\n\t\t\t\t// console.log(\"%s:[%s (%s)] [%s]\", this.cid, ev.type, ev.target.className, ev.propertyName, this._changedPosNum, ev);\n\t\t\t}\n\t\t\tif (!this._collapsedChanging) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._changedPosNum == 0) {\n\t\t\t\t// if ((ev.propertyName == transformProp) ||\n\t\t\t\t// \t(ev.propertyName == \"visibility\")) {\n\t\t\t\tconsole.log(\"%s:[%s .list-item] [%s] collapsed-changing end (resolving %s promises)\", this.cid, ev.type, ev.propertyName, this._collapsePromises.length);\n\t\t\t\tthis._collapsedChanging = false;\n\t\t\t\tthis.el.classList.remove(\"collapsed-changing\");\n\t\t\t\tresolveAll(this._collapsePromises, this);\n\t\t\t}\n\t\t},\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tthis._filteredItems = [];\n\t\tthis._filteredIncoming = [];\n\t\tthis._filteredOutgoing = [];\n\n\t\tthis._metrics = {};\n\t\tthis._itemMetrics = [];\n\t\tthis._collapsePromises = [];\n\t\tthis.itemViews = new Container();\n\n\t\t_.defaults(options, this.defaults);\n\t\tthis.renderer = options.renderer;\n\t\tthis._filterFn = options.filterFn;\n\n\t\t// this.computeFilter();\n\t\t// this.collection.each(this.createItemView, this);\n\n\t\tthis.collection.each(this.createItemView, this);\n\t\tthis._setSelection(this.collection.selected);\n\t\tthis._setCollapsed(options.collapsed);\n\t\tthis.refreshFilter();\n\t\t// this.skipTransitions = true;\n\t\t// this.renderNow();\n\n\t\t// this.listenTo(this.collection, \"select:one select:none\", this._setSelection);\n\t\tthis.listenTo(this.collection, \"reset\", function() {\n\t\t\tthis._allItems = null;\n\t\t\tthrow new Error(\"not implemented\");\n\t\t});\n\n\t\t// will trigger on return if this.el is already attached\n\t\t// this.skipTransitions = true;\n\t\t// this.el.classList.add(\"skip-transitions\");\n\t\t// this.requestRender(View.ALL_INVALID);\n\n\t\tconsole.log(\"%s::initialize attached: %o\", this.cid, this.attached);\n\n\t\tthis.once(\"view:attached\", function(view) {\n\t\t\tconsole.log(\"%s::initialize -> [view:attached] attached: %o\", view.cid, view.attached);\n\t\t\t// view.requestRender(View.ALL_INVALID).renderNow();\n\t\t\tview.skipTransitions = true;\n\t\t\tview.el.classList.add(\"skip-transitions\");\n\t\t\tview.setImmediate(function() {\n\t\t\t\t// this.skipTransitions = true;\n\t\t\t\tview.renderNow();\n\t\t\t});\n\t\t});\n\t},\n\n\t/**\n\t * Get an array with a collection contens\n\t * @private\n\t */\n\t_getAllItems: function() {\n\t\treturn this._allItems || (this._allItems = this.collection.slice());\n\t},\n\n\t/* --------------------------- *\n\t/* Transition promises\n\t/* --------------------------- */\n\n\t_whenCollapseChangeEnds: function() {\n\t\tif (this._collapsedChanged) {\n\t\t\tvar view = this;\n\t\t\treturn new Promise(function(resolve, reject) {\n\t\t\t\tview.on(\"view:render:after\", resolve);\n\t\t\t})\n\t\t} else {\n\t\t\treturn Promise.resolve(this);\n\t\t}\n\t},\n\n\twhenCollapseChangeEnds: function() {\n\t\tvar d, p, pp;\n\t\tif (this._collapsedChanging || this._collapsedChanged) {\n\t\t\td = {};\n\t\t\tp = new Promise(function(resolve, reject) {\n\t\t\t\td.resolve = resolve;\n\t\t\t\td.reject = reject;\n\t\t\t});\n\t\t\tpp = this._collapsePromises;\n\t\t\tpp.push(d);\n\t\t} else {\n\t\t\tp = Promise.resolve(this);\n\t\t}\n\t\treturn p;\n\t},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\t/** @override */\n\trenderFrame: function(tstamp, flags) {\n\t\t// if (DEBUG) {\n\t\t// \tvar changed = [];\n\t\t// \tthis._collapsedChanged && changed.push(\"collapsed\");\n\t\t// \tthis._selectionChanged && changed.push(\"selection\");\n\t\t// \tthis._filterChanged && changed.push(\"filter\");\n\t\t// \tconsole.log(\"%s::renderFrame [%s]\", this.cid, changed.join(\" \"));\n\t\t// }\n\n\t\t// collapsed transition flag\n\t\tif (this._collapsedChanging) {\n\t\t\tconsole.warn(\"%s::renderFrame collapsed tx interrupted\", this.cid);\n\t\t\tthis._collapsedChanging = false;\n\t\t\tthis.el.classList.remove(\"collapsed-changing\");\n\t\t\trejectAll(this._collapsePromises, this);\n\t\t}\n\t\tif (this.skipTransitions) {\n\t\t\tthis.el.classList.add(\"skip-transitions\");\n\t\t\t// this.requestAnimationFrame(function() {\n\t\t\tthis.setImmediate(function() {\n\t\t\t\tthis.skipTransitions = false;\n\t\t\t\tthis.el.classList.remove(\"skip-transitions\");\n\t\t\t});\n\t\t}\n\n\t\tif (this._collapsedChanged) {\n\t\t\tthis._collapsedChanged = false;\n\t\t\tflags |= View.SIZE_INVALID;\n\t\t\tthis.el.classList.toggle(\"collapsed\", this._collapsed);\n\n\t\t\tif (this.skipTransitions) {\n\t\t\t\tthis._collapsedChanging = false;\n\t\t\t\t// resolveAll(this._collapsePromises, this.el);\n\t\t\t\tthis.once(\"view:render:after\", function(view) {\n\t\t\t\t\tthis._changedPosNum = 0;\n\t\t\t\t\tresolveAll(view._collapsePromises, view);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis._collapsedChanging = true;\n\t\t\t\tthis.el.classList.add(\"collapsed-changing\");\n\t\t\t\t// this will be resolved on transitionend\n\t\t\t}\n\t\t\tconsole.log(\"%s:[collapse changed] %s promises\", this.cid,\n\t\t\t\tthis._collapsePromises.length,\n\t\t\t\tthis._collapsedChanging ? \"resolving now\" : \"resolving on transitionend\"\n\t\t\t);\n\t\t}\n\n\t\tif (this._selectionChanged) {\n\t\t\tthis._selectionChanged = false;\n\t\t\tflags |= View.LAYOUT_INVALID;\n\t\t\tthis.renderSelection(this.collection.selected, this.collection.lastSelected);\n\t\t}\n\n\t\tif (this._filterChanged) {\n\t\t\tthis._filterChanged = false;\n\t\t\tflags |= View.LAYOUT_INVALID;\n\t\t\tvar lastFilteredItems = this.filteredItems;\n\t\t\t// this._printStats(lastFilteredItems);\n\t\t\tthis.computeFilter();\n\t\t\tthis.applyFilter();\n\t\t\tif (DEBUG) {\n\t\t\t\tthis._printStats(lastFilteredItems);\n\t\t\t}\n\t\t}\n\n\t\tif (flags & View.SIZE_INVALID) {\n\t\t\tthis.measure(); // NOTE: measures children\n\t\t}\n\n\t\tif (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {\n\t\t\tthis.renderLayout();\n\t\t}\n\t},\n\n\tmeasure: function() {\n\t\t// var i, ii, el, els, m, mm;\n\t\t// els = this.el.children;\n\t\t// ii = els.length;\n\t\t// mm = this._itemMetrics;\n\t\t// for (i = 0; i < ii; i++) {\n\t\t// \tmm[i] = _.pick(els[i], \"offsetTop\", \"offsetHeight\");\n\t\t// }\n\n\t\tthis._metrics = getBoxEdgeStyles(this.el, this._metrics);\n\n\t\t// var itemEl, itemView, baseline = 0;\n\t\t// if (itemEl = this.el.querySelector(\".list-item:not(.excluded) .label\")) {\n\t\t// \t// itemView = this.itemViews.findByCid(itemEl.cid);\n\t\t// \tvar elA = itemEl, elB = itemEl.parentElement;\n\t\t// \tvar yA = elA.offsetTop,\n\t\t// \t\thA = elA.offsetHeight,\n\t\t// \t\tyB = elB.offsetTop,\n\t\t// \t\thB = elB.offsetHeight;\n\t\t// \tbaseline = ((yA + hA) - (yB + hB));\n\t\t// \tconsole.log(\"%s::measure fontSize: %spx (%s+%s)-(%s+%s)=%s\", this.cid, this._metrics.fontSize,\n\t\t// \t\tyA, hA, yB, hB, baseline\n\t\t// \t);\n\t\t// }\n\n\t\tthis.itemViews.forEach(function(view) {\n\t\t\tif (!view._metrics) view._metrics = {};\n\t\t\t// view._metrics.baseline = this._metrics.fontSize - baseline;\n\t\t\tview._metrics.offsetTop = view.el.offsetTop;\n\t\t\tview._metrics.offsetHeight = view.el.offsetHeight;\n\t\t\tview._metrics.offsetLeft = view.el.offsetLeft;\n\t\t\tview._metrics.offsetWidth = view.el.offsetWidth;\n\t\t\tif (!this._collapsed && view.label) {\n\t\t\t\tview._metrics.textLeft = view.label.offsetLeft;\n\t\t\t\tview._metrics.textWidth = view.label.offsetWidth;\n\t\t\t} else {\n\t\t\t\tview._metrics.textLeft = view._metrics.offsetLeft;\n\t\t\t\tview._metrics.textWidth = view._metrics.offsetWidth;\n\t\t\t}\n\t\t}, this);\n\n\t\t// this._metrics.baseline = this._metrics.fontSize - baseline;\n\t},\n\n\trenderLayout: function() {\n\t\tvar posX, posY, lastX, lastY;\n\t\tposX = this._metrics.paddingLeft;\n\t\tposY = this._metrics.paddingTop;\n\n\t\tthis._changedPosNum = 0;\n\t\t// use HTMLElement.children to keep layout order\n\t\tfor (var i = 0, ii = this.el.children.length; i < ii; i++) {\n\t\t\tvar view = this.itemViews.findByCid(this.el.children[i].cid);\n\t\t\tlastX = view.transform.tx;\n\t\t\tlastY = view.transform.ty;\n\t\t\tif (((this.collection.selected && !view.model.selected) ||\n\t\t\t\t\tview.el.classList.contains(\"excluded\")) && this._collapsed) {\n\t\t\t\tview.transform.tx = posX;\n\t\t\t\tview.transform.ty = posY;\n\t\t\t} else {\n\t\t\t\tif (view._metrics.offsetHeight == 0) {\n\t\t\t\t\tposY -= view._metrics.offsetTop;\n\t\t\t\t}\n\t\t\t\tview.transform.tx = posX;\n\t\t\t\tview.transform.ty = posY;\n\t\t\t\tposY += view._metrics.offsetHeight + view._metrics.offsetTop;\n\t\t\t}\n\t\t\tview.el.style[transformProp] = translateCssValue(view.transform.tx, view.transform.ty);\n\t\t\tif (view.transform.tx != lastX || view.transform.ty != lastY) {\n\t\t\t\tthis._changedPosNum++;\n\t\t\t}\n\t\t}\n\n\t\t// posY += this._metrics.paddingBottom;\n\t\tthis._metrics.height = Math.max(0, posY + this._metrics.paddingBottom);\n\t\tthis.el.style.height = this._metrics.height + \"px\";\n\t\t// this.el.style.height = (posY > 0) ? posY + \"px\" : \"\";\n\t},\n\n\t/* --------------------------- *\n\t/* Child views\n\t/* --------------------------- */\n\n\t/** @private */\n\tcreateItemView: function(item, index) {\n\t\tvar view = new this.renderer({\n\t\t\tmodel: item,\n\t\t\tel: this.el.querySelector(\".list-item[data-id=\\\"\" + item.id + \"\\\"]\")\n\t\t});\n\t\t// item.set(\"excluded\", false, { silent: true });\n\t\t// view.listenTo(item, \"change:excluded\", function(item, newVal) {\n\t\t// \t// console.log(arguments);\n\t\t// \tif (this.el.classList.contains(\"excluded\") !== newVal) {\n\t\t// \t\tconsole.warn(\"%s:[change:excluded] m:%o css: %o\", this.cid, newVal, this.el.classList.contains(\"excluded\"));\n\t\t// \t}\n\t\t// \t// this.el.classList.toggle(\"excluded\", excluded);\n\t\t// });\n\t\tthis.listenTo(view, \"renderer:click\", this._onRendererClick);\n\t\tthis.itemViews.add(view);\n\t\treturn view;\n\t},\n\n\t/** @private */\n\t_onRendererClick: function(item, ev) {\n\t\tif (this._collapsedChanging\n\t\t\t|| (this._collapsed && item.get(\"excluded\"))) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.collection.selected !== item) {\n\t\t\tthis.trigger(\"view:select:one\", item);\n\t\t} else {\n\t\t\tif (ev.altKey) {\n\t\t\t\tthis.trigger(\"view:select:none\");\n\t\t\t} else {\n\t\t\t\tthis.trigger(\"view:select:same\", item);\n\t\t\t}\n\t\t\t// this.trigger(\"view:select:none\");\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Collapsed\n\t/* --------------------------- */\n\n\t/** @private */\n\t_collapsed: undefined,\n\n\t/**\n\t * @param {Boolean}\n\t */\n\t_setCollapsed: function(collapsed) {\n\t\tif (collapsed !== this._collapsed) {\n\t\t\tthis._collapsed = collapsed;\n\t\t\tthis._collapsedChanged = true;\n\t\t\tthis.requestRender();\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Selection\n\t/* --------------------------- */\n\n\t/** @private */\n\t_selectedItem: undefined,\n\n\t/** @param {Backbone.Model|null} */\n\t_setSelection: function(item) {\n\t\tif (item !== this._selectedItem) {\n\t\t\tthis._selectedItem = item;\n\t\t\tthis._selectionChanged = true;\n\t\t\tthis.requestRender(View.MODEL_INVALID);\n\t\t}\n\t},\n\n\t/** @private */\n\trenderSelection: function(newItem, oldItem) {\n\t\tvar view;\n\t\tif (oldItem) {\n\t\t\tview = this.itemViews.findByModel(oldItem);\n\t\t\tview.el.classList.remove(\"selected\");\n\t\t\t// view.label.classList.remove(\"color-fg\");\n\t\t\t// view.label.classList.remove(\"color-reverse\");\n\t\t}\n\t\tif (newItem) {\n\t\t\tview = this.itemViews.findByModel(newItem);\n\t\t\tview.el.classList.add(\"selected\");\n\t\t\t// view.label.classList.add(\"color-fg\");\n\t\t\t// view.label.classList.add(\"color-reverse\");\n\t\t}\n\t\tthis.el.classList.toggle(\"has-selected\", this.selectedItem !== null);\n\t},\n\n\t/* --------------------------- *\n\t/* Filter\n\t/* --------------------------- */\n\n\trefreshFilter: function() {\n\t\tif (this._filterFn) {\n\t\t\tthis._filterChanged = true;\n\t\t\tthis.requestRender(View.MODEL_INVALID);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Filter impl 2\n\t/* --------------------------- */\n\n\tcomputeFilter: function() {\n\t\tvar newItems, oldItems;\n\t\tvar hasNew, hasOld;\n\t\tthis._filteredIncoming.length = 0;\n\t\tthis._filteredOutgoing.length = 0;\n\n\t\tnewItems = this._filterFn ? this.collection.filter(this._filterFn, this) : this._getAllItems();\n\t\toldItems = this._filteredItems;\n\t\thasNew = !!(newItems && newItems.length);\n\t\thasOld = !!(oldItems && oldItems.length);\n\t\t// NOTE: diff third arg is destination array\n\t\tif (hasNew) {\n\t\t\t// incoming exclusions\n\t\t\tdiff((hasOld ? oldItems : this._getAllItems()), newItems, this._filteredIncoming);\n\t\t\t// this._filteredIncoming.forEach(function(item) {\n\t\t\t// \titem.set(\"excluded\", true);\n\t\t\t// });\n\t\t}\n\t\tif (hasOld) {\n\t\t\t// outgoing exclusions\n\t\t\tdiff((hasNew ? newItems : this._getAllItems()), oldItems, this._filteredOutgoing);\n\t\t\t// this._filteredOutgoing.forEach(function(item) {\n\t\t\t// \titem.set(\"excluded\", false);\n\t\t\t// });\n\t\t}\n\t\t// console.log(\"%s::renderFilterFn\", this.cid, newItems);\n\t\tthis._filteredItems = newItems;\n\t},\n\n\tapplyFilter: function() {\n\t\t// this.itemViews.forEach(function(view) {\n\t\t// \tview.el.classList.toggle(\"excluded\", view.model.get(\"excluded\"));\n\t\t// });\n\t\tthis._filteredIncoming.forEach(function(item) {\n\t\t\tthis.itemViews.findByModel(item).el.classList.add(\"excluded\");\n\t\t\titem.set(\"excluded\", true);\n\t\t}, this);\n\t\tthis._filteredOutgoing.forEach(function(item) {\n\t\t\tthis.itemViews.findByModel(item).el.classList.remove(\"excluded\");\n\t\t\titem.set(\"excluded\", false);\n\t\t}, this);\n\n\t\tthis.el.classList.toggle(\"has-excluded\", this.filteredItems.length > 0);\n\t},\n\n\t/* --------------------------- *\n\t/* Filter impl 1\n\t/* --------------------------- */\n\n\t/*\n\tcomputeFilter_1: function() {\n\t\tvar items = this._filterFn ? this.collection.filter(this._filterFn, this) : this._getAllItems();\n\t\tthis.renderFilters(items, this._filteredItems);\n\t\tthis._filteredItems = items;\n\t},\n\n\trenderFilters: function(newItems, oldItems) {\n\t\tvar hasNew = !!(newItems && newItems.length);\n\t\tvar hasOld = !!(oldItems && oldItems.length);\n\t\tvar inExcl = [];\n\t\tvar outExcl = [];\n\n\t\t// console.log(\"%s::renderFilterFn\", this.cid, newItems);\n\t\t// NOTE: diff third arg is destination array\n\t\tif (hasNew) {\n\t\t\tdiff((hasOld ? oldItems : this._getAllItems()), newItems, inExcl)\n\t\t\t// .forEach(function(item) {\n\t\t\t// \tthis.itemViews.findByModel(item).el.classList.add(\"excluded\");\n\t\t\t// \titem.set(\"excluded\", true);\n\t\t\t// }, this);\n\t\t}\n\t\tif (hasOld) {\n\t\t\tdiff((hasNew ? newItems : this._getAllItems()), oldItems, outExcl)\n\t\t\t// .forEach(function(item) {\n\t\t\t// \tthis.itemViews.findByModel(item).el.classList.remove(\"excluded\");\n\t\t\t// \titem.set(\"excluded\", false);\n\t\t\t// }, this);\n\t\t}\n\t\tthis._filteredIncoming = inExcl;\n\t\tthis._filteredOutgoing = outExcl;\n\t\t// this.el.classList.toggle(\"has-excluded\", hasNew);\n\t\t// this.applyFilter();\n\t},\n\t*/\n\n\t// computeFiltered: function() {\n\t// \tthis._filterResult = this.collection.map(this._filterFn, this);\n\t// },\n\t//\n\t// renderFiltered: function() {\n\t// \tthis.collection.forEach(function(item, index) {\n\t// \t\tthis.itemViews.findByModel(item).el.classList.toggle(\"excluded\", !this._filterResult[index]);\n\t// \t}, this);\n\t// },\n\n});\n\nif (DEBUG) {\n\tFilterableListView.prototype._logFlags = [\n\t\t\"view.render\",\n\t\t// \"view.trace\"\n\t].join(\" \");\n\n\tFilterableListView.prototype._printStats = function(lastFilteredItems) {\n\t\tif (this._logFlags[\"view.trace\"]) console.log(\"%s::renderFrame %s filtered:%o(=%o)/%o (changed:%o, in:%o, out:%o)\", this.cid,\n\t\t\tthis.filteredItems.length > 0 ? \"has\" : \"has not\",\n\t\t\tthis.filteredItems.length,\n\t\t\tlastFilteredItems ? (this.filteredItems.length + this._filteredIncoming.length) - this._filteredOutgoing.length : this.filteredItems.length,\n\t\t\tthis.collection.length,\n\t\t\t(this._filteredIncoming.length + this._filteredOutgoing.length),\n\t\t\tthis._filteredIncoming.length,\n\t\t\tthis._filteredOutgoing.length);\n\t};\n}\n\nmodule.exports = FilterableListView;\n",
    "/**\n * @module app/view/component/GraphView\n */\n\n/** @type {Function} */\nvar Color = require(\"color\");\n\n/** @type {module:app/view/base/CanvasView} */\nvar CanvasView = require(\"app/view/base/CanvasView\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n\n/** @type {module:utils/canvas/calcArcHConnector} */\nvar calcArcHConnector = require(\"utils/canvas/calcArcHConnector\");\n\n/** @type {module:utils/canvas/CanvasHelper} */\nvar CanvasHelper = require(\"utils/canvas/CanvasHelper\");\n\n/** @type {module:utils/geom/inflateRect} */\nvar inflateRect = require(\"utils/geom/inflateRect\");\n\n// /** @type {module:utils/dom/getAbsoluteClientRect} */\n// var getAbsoluteClientRect = require(\"utils/dom/getAbsoluteClientRect\");\n\n\n// var BEZIER_CIRCLE = 0.551915024494;\n// var MIN_CANVAS_RATIO = 2;\n// var PI2 = Math.PI * 2;\n\nvar styleBase = {\n\tlineCap: \"butt\", // round, butt, square\n\tlineWidth: 0.75,\n\tlineDashOffset: 0,\n\tsetLineDash: [[]],\n\t// radiusBase: 2,\n\t// /* factored to rem unit */ //6,\n\t// radiusIncrement: 0.21, //3, //0.25,\n\t// /* uses lineWidth multiplier */\n\t// outlineWidth: 3,\n\t// /* uses lineWidth multiplier */\n\t// arrowSize: 0.3,\n};\nvar paramsBase = {\n\tradiusBase: 1.25,\n\t/* factored to rem unit */ //6,\n\tradiusIncrement: 0.21, //3, //0.25,\n\t/* uses lineWidth multiplier */\n\toutlineWidth: 3,\n\t/* factored to rem unit */\n\tarrowSize: 0.4, //0.3,\n};\n\n// var overlayStyleBase = {\n// \tglobalAlpha: 0.75,\n// \tglobalCompositeOperation: \"destination-out\",\n// \tlineWidth: 4,\n// \tlineJoin: \"round\",\n// \ttextBaseline: \"top\",\n// \ttextAlign: \"left\",\n// };\n\nif (DEBUG) {\n\t/* eslint-disable no-unused-vars */\n\tvar _dStyles = {\n\t\tdefaults: {\n\t\t\tglobalAlpha: 0.66,\n\t\t\tlineWidth: 0,\n\t\t\tfillStyle: \"transparent\",\n\t\t\tstrokeStyle: \"transparent\",\n\t\t\tlineDashOffset: 0,\n\t\t\tsetLineDash: [[]]\n\t\t}\n\t};\n\n\t/* Stroke */\n\t[\n\t\t\"red\", \"salmon\", \"sienna\",\n\t\t\"green\", \"yellowgreen\", \"olive\",\n\t\t\"blue\", \"lightskyblue\", \"midnightblue\",\n\t\t\"grey\", \"silver\"\n\t]\n\t.forEach(function(colorName) {\n\t\tvar rgbaValue = Color(colorName).alpha(0.75).rgbaString();\n\n\t\t_dStyles[colorName] = _.defaults({\n\t\t\tlineWidth: 0.75,\n\t\t\tstrokeStyle: rgbaValue,\n\t\t}, _dStyles[\"defaults\"]);\n\n\t\t_dStyles[colorName + \"_dashed\"] = _.defaults({\n\t\t\tsetLineDash: [[4, 2]],\n\t\t\tstrokeStyle: rgbaValue,\n\t\t}, _dStyles[\"defaults\"]);\n\n\t\t_dStyles[colorName + \"_thick\"] = _.defaults({\n\t\t\tlineWidth: 5,\n\t\t\tstrokeStyle: rgbaValue,\n\t\t}, _dStyles[\"defaults\"]);\n\n\t\t_dStyles[colorName + \"_fill\"] = _.defaults({\n\t\t\tfillStyle: rgbaValue\n\t\t}, _dStyles[\"defaults\"]);\n\t})\n\t/* eslint-enable no-unused-vars */\n}\n\nvar getRectDirX = function(r1, r2) {\n\tif (r1.right < r2.left) {\n\t\treturn 1;\n\t}\n\tif (r2.right < r1.left) {\n\t\treturn -1;\n\t}\n\treturn 0;\n};\n\n/**\n * @constructor\n * @type {module:app/view/component/GraphView}\n */\nvar GraphView = CanvasView.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"graph\",\n\t/** @override */\n\ttagName: \"canvas\",\n\t/** @override */\n\tclassName: \"graph\",\n\n\tdefaultKey: \"a2b\",\n\n\tdefaults: {\n\t\tvalues: {\n\t\t\ta2b: 0,\n\t\t\tb2a: 0,\n\t\t},\n\t\tmaxValues: {\n\t\t\ta2b: 1,\n\t\t\tb2a: 1,\n\t\t},\n\t\t// useOpaque: true,\n\t\t// labelFn: function(value, max) {\n\t\t// \treturn ((value / max) * 100) | 0;\n\t\t// },\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tCanvasView.prototype.initialize.apply(this, arguments);\n\n\t\tthis._listA = options.listA;\n\t\tthis._listB = options.listB;\n\t\tthis._a2b = {\n\t\t\tsrcView: options.listA,\n\t\t\tdestView: options.listB,\n\t\t\ts: _.defaults({\n\t\t\t\tlineWidth: 1.25\n\t\t\t\t// radiusIncrement: 0.25,\n\t\t\t}, styleBase, paramsBase),\n\t\t\tp: _.defaults({}, paramsBase),\n\t\t\tstrokeStyleFn: function(fg, bg, ln) {\n\t\t\t\treturn Color(ln).mix(bg, 0.9).hexString();\n\t\t\t\t// return Color(fg).mix(bg, 0.9).hexString();\n\t\t\t}\n\t\t};\n\t\tthis._b2a = {\n\t\t\tsrcView: options.listB,\n\t\t\tdestView: options.listA,\n\t\t\ts: _.defaults({\n\t\t\t\tlineWidth: 0.7,\n\t\t\t\t// arrowSize: 0.25,\n\t\t\t\t// radiusIncrement: 0,\n\t\t\t\t// outlineWidth: 0,\n\t\t\t}, styleBase, paramsBase),\n\t\t\tp: _.defaults({}, paramsBase),\n\t\t\tstrokeStyleFn: function(fg, bg, ln) {\n\t\t\t\treturn Color(fg).mix(bg, 0.6).hexString();\n\t\t\t}\n\t\t};\n\n\t\t// this.listenTo(this._a2b.srcView.collection, \"view:select:one view:select:none\", function(item) {\n\t\t// \tthis._a2b.connectorsOut = this._a2b.connectors;\n\t\t// \tthis._a2b.connectors = null;\n\t\t// });\n\t\t//\n\t\t// this.listenTo(this._b2a.srcView.collection, \"view:select:one view:select:none\", function(item) {\n\t\t// \tthis._b2a.connectorsOut = this._b2a.connectors;\n\t\t// \tthis._b2a.connectors = null;\n\t\t// });\n\n\t\t// this.listenTo(this, \"view:render:before\", this._beforeViewRender);\n\n\t\t// this._traceScroll = _.debounce(this.__raceScroll, 100, false);\n\n\t\t// var viewportChanged = function(ev) {\n\t\t// \tconsole.log(\"%s:[%s]\", this.cid, ev.type);\n\t\t//\n\t\t// \t// this._traceScroll(ev.type);\n\t\t// \t// this._labelOverlays = null;\n\t\t// \tthis.invalidate(CanvasView.LAYOUT_INVALID | CanvasView.SIZE_INVALID);\n\t\t// \t// this.requestRender(CanvasView.LAYOUT_INVALID | CanvasView.SIZE_INVALID);\n\t\t// \t// this.requestRender().renderNow();\n\t\t// }.bind(this);\n\t\t// viewportChanged = _.debounce(viewportChanged, 60, false);\n\n\t\t// window.addEventListener(\"scroll\",\n\t\t// \t\t_.debounce(viewportChanged, 100, false), false);\n\t\t// window.addEventListener(\"wheel\",\n\t\t// \t_.debounce(viewportChanged, 100, false), false);\n\t\t// window.addEventListener(\"scroll\", viewportChanged, false);\n\t\t// window.addEventListener(\"wheel\", viewportChanged, false);\n\t\t// window.addEventListener(\"resize\", viewportChanged, false);\n\t\t// window.addEventListener(\"orientationchange\", viewportChanged, false);\n\n\t\t// this._addListListeners(this._a2b);\n\t\t// this._addListListeners(this._b2a);\n\t},\n\n\t/** @override */\n\tmeasureCanvas: function(w, h, s) {\n\t\tconsole.log(\"%s::measureCanvas style:%o scroll:%o offset:%o client:%o arg:%o\", this.cid, s.height, this.el.offsetHeight, this.el.scrollHeight, this.el.clientHeight, h);\n\t},\n\n\t/** @override */\n\tupdateCanvas: function() {\n\t\tthis._updateMetrics();\n\t\tthis._updateStyles();\n\t},\n\n\t/* --------------------------- *\n\t/* styles\n\t/* --------------------------- */\n\n\t_updateStyles: function() {\n\t\tvar b, bgColor, lnColor;\n\t\tif (this.model.has(\"bundle\")) {\n\t\t\tb = this.model.get(\"bundle\");\n\t\t\tlnColor = b.colors.lnColor.clone();\n\t\t\tbgColor = b.colors.bgColor.clone();\n\t\t} else {\n\t\t\tbgColor = Color(Globals.DEFAULT_COLORS[\"background-color\"]);\n\t\t\tlnColor = Color(Globals.DEFAULT_COLORS[\"link-color\"]);\n\t\t}\n\n\t\tthis._a2b.s.strokeStyle = this._a2b.s.fillStyle =\n\t\t\tthis._a2b.strokeStyleFn(this._color, bgColor, lnColor);\n\t\tthis._b2a.s.strokeStyle = this._b2a.s.fillStyle =\n\t\t\tthis._b2a.strokeStyleFn(this._color, bgColor, lnColor);\n\n\t\tif (DEBUG) {\n\t\t\tthis._debugBlocks = this.el.matches(\".debug-blocks .\" + this.className);\n\t\t\tthis._debugGraph = this.el.matches(\".debug-graph .\" + this.className);\n\t\t}\n\t},\n\n\t_setStyle: function(s) {\n\t\tif (typeof s == \"string\") {\n\t\t\ts = this._styleData[s];\n\t\t}\n\t\tCanvasView.setStyle(this._ctx, s);\n\t},\n\n\t/* --------------------------- *\n\t/* metrics\n\t/* --------------------------- */\n\n\t_updateMetrics: function() {\n\t\tvar bounds;\n\n\t\tthis._rootFontSize = parseFloat(\n\t\t\tgetComputedStyle(document.documentElement).fontSize);\n\n\t\tbounds = this.el.getBoundingClientRect();\n\t\t// bounds = getAbsoluteClientRect(this.el);\n\t\tthis._ctx.setTransform(this._canvasRatio, 0, 0, this._canvasRatio,\n\t\t\t(-(bounds.left + window.pageXOffset) * this._canvasRatio) - 0.5,\n\t\t\t(-(bounds.top + window.pageYOffset) * this._canvasRatio) - 0.5\n\t\t);\n\n\t\tvar i, ii, els;\n\t\tvar srcRect, destRect;\n\t\tvar srcMin, destMin;\n\n\t\tsrcRect = this._a2b.srcView.el.getBoundingClientRect();\n\t\tdestRect = this._a2b.destView.el.getBoundingClientRect();\n\t\tthis._a2b.qx = getRectDirX(srcRect, destRect);\n\n\t\tels = this._listA.el.querySelectorAll(\".label\");\n\t\tsrcMin = srcRect.left + window.pageXOffset;\n\t\tfor (i = 0, ii = els.length; i < ii; i++) {\n\t\t\tsrcMin = Math.max(srcMin,\n\t\t\t\tels[i].getBoundingClientRect().right + window.pageXOffset);\n\t\t}\n\t\tthis._a2b.xMin = srcMin;\n\n\t\tels = this._listB.el.querySelectorAll(\".label\");\n\t\tdestMin = destRect.left + window.pageXOffset;\n\t\tfor (i = 0, ii = els.length; i < ii; i++) {\n\t\t\tdestMin = Math.min(destMin,\n\t\t\t\tels[i].getBoundingClientRect().left + window.pageXOffset);\n\t\t}\n\t\tthis._a2b.destMinX = destMin;\n\n\t\tthis._b2a.qx = -this._a2b.qx;\n\t\tthis._b2a.xMin = this._a2b.destMinX;\n\t\tthis._b2a.destMinX = this._a2b.xMin;\n\n\t\t// var s = getComputedStyle(document.documentElement);\n\t\t// this._rootFontSize = parseFloat(s.fontSize); // * this._canvasRatio;\n\t\t// console.log(\"%s::_updateMetrics _rootFontSize: %s %o\", this.cid, this._rootFontSize, s);\n\n\t\t// var c = Math.abs(sData.xMin - dData.xMin) / 6;\n\t\t// sMin = sData.xMin + c * qx;\n\t\t// dMin = dData.xMin - c * qx;\n\n\t\t// this._a2b.targets = this._measureListItems(listView);\n\t\t// this._b2a.targets = this._measureListItems(listView);\n\n\t\t// // connector minimum branch x2\n\t\t// listView = this._listB;\n\t\t// for (i = 0, ii = listView.groups.length; i < ii; i++) {\n\t\t// \titemView = listView.itemViews.findByModel(listView.groups[i]);\n\t\t// \titemRect = (itemView.label || itemView.el).getBoundingClientRect();\n\t\t// \tthis._b2a.xMin = Math.min(this._b2a.xMin, itemRect.left);\n\t\t// \t// if (itemView._metrics) this._b2a.rect.left + itemView.transform.tx + itemView._metrics.textLeft;\n\t\t// }\n\t},\n\n\t/* --------------------------- *\n\t/* redraw\n\t/* --------------------------- */\n\n\tredraw: function(ctx, interp, flags) {\n\t\tthis._clearCanvas(0, 0, this._canvasWidth, this._canvasHeight);\n\t\tctx.save();\n\t\tthis._redraw_fromElements(ctx, interp, flags);\n\t\t// this._redraw_fromViews(ctx, interp);\n\t\tctx.restore();\n\t},\n\n\t_redraw_fromElements: function(ctx, interp, flags) {\n\t\t// b2a: keyword to bundles, right to left\n\t\t// a2b: bundle to keywords, left to right\n\t\tif (flags & (CanvasView.SIZE_INVALID | CanvasView.MODEL_INVALID)) {\n\t\t\tconsole.log(\"%s::redraw [valuesChanged: %s] [flags: %s]\", this.cid, interp.valuesChanged, CanvasView.flagsToString(flags));\n\t\t\tthis._a2b.connectorsOut = this._a2b.connectors;\n\t\t\tthis._b2a.connectorsOut = this._b2a.connectors;\n\t\t\tthis._b2a.connectors = this._computeConnectors(this._b2a);\n\t\t\tthis._a2b.connectors = this._computeConnectors(this._a2b);\n\t\t\tthis._labelOverlays = this._computeLabelOverlays(this._listB);\n\t\t}\n\n\t\t/* line dash value interpolation */\n\t\tvar b2aVal, a2bVal;\n\t\tb2aVal = interp.getRenderedValue(\"b2a\") / interp.getOption(\"b2a\", \"max\"); //_valueData[\"b2a\"]._maxVal;\n\t\t// b2aVal = interp._valueData[\"b2a\"]._renderedValue / interp._valueData[\"b2a\"]._maxVal;\n\t\ta2bVal = interp.getRenderedValue(\"a2b\") / interp.getOption(\"a2b\", \"max\"); //interp._valueData[\"a2b\"]._maxVal;\n\t\t// a2bVal = interp._valueData[\"a2b\"]._renderedValue / interp._valueData[\"a2b\"]._maxVal;\n\n\t\t/* draw */\n\t\tthis._drawConnectors(this._b2a.connectors, this._b2a.s, b2aVal, 1);\n\t\tthis._drawConnectors(this._b2a.connectorsOut, this._b2a.s, 1 - b2aVal, 1);\n\t\tthis._drawConnectors(this._a2b.connectors, this._a2b.s, a2bVal, 2);\n\t\t// this._drawConnectors(this._a2b.connectorsOut, this._a2b.s, 1 - a2bVal, 2);\n\t\tthis._drawLabelOverlays(this._labelOverlays);\n\t},\n\n\t/* --------------------------- *\n\t * label overlays\n\t * --------------------------- */\n\n\t_computeLabelOverlays: function(list) {\n\t\tvar data = { rects: [] };\n\t\tvar els = list.el.querySelectorAll(\".list-group .label span\");\n\n\t\tvar i, ii, r;\n\t\tfor (i = 0, ii = els.length; i < ii; i++) {\n\t\t\t// r = inflateRect(els[i].getBoundingClientRect(), 0, 0);\n\t\t\tr = _.clone(els[i].getBoundingClientRect());\n\t\t\tr.top += window.pageYOffset; // - 0.5;\n\t\t\tr.left += window.pageXOffset; // - 0.5;\n\t\t\t// r.innerText = els[i].innerText;\n\t\t\tdata.rects[i] = r;\n\t\t}\n\t\t// data.cssStyle = getComputedStyle(els[0]);\n\t\t// data.boxStyle = getBoxEdgeStyles(overlayData.cssStyle);\n\t\t// data.ctxStyle = {\n\t\t// \tfont: [s.fontWeight, s.fontStyle, s.fontSize + \"/\" + s.lineHeight, s.fontFamily].join(\" \")\n\t\t// };\n\t\treturn data;\n\t},\n\n\t_drawLabelOverlays: function(data) {\n\t\tthis._ctx.save();\n\t\t// CanvasView.setStyle(this._ctx, s);\n\t\tthis._ctx.globalAlpha = 0.85;\n\t\tthis._ctx.globalCompositeOperation = \"destination-out\";\n\t\t// this._ctx.canvas.style.letterSpacing = overlayData.cssStyle.letterSpacing;\n\n\t\tdata.rects.forEach(function(r) {\n\t\t\t// this._ctx.clearRect(r.left, r.top, r.width, r.height);\n\t\t\tthis._ctx.fillRect(r.left, r.top, r.width, r.height);\n\t\t\t// this._ctx.strokeText(r.innerText, r.left, r.top);\n\t\t}, this);\n\t\tthis._ctx.restore();\n\n\t\tif (DEBUG) {\n\t\t\tif (this._debugGraph || this._debugBlocks) {\n\t\t\t\tdata.rects.forEach(function(r) {\n\t\t\t\t\tr = inflateRect(r, 0, 0);\n\t\t\t\t\tCanvasHelper.drawRect(this._ctx, _dStyles[\"silver_dashed\"],\n\t\t\t\t\t\tr.left, r.top, r.width, r.height);\n\t\t\t\t}, this);\n\t\t\t}\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t * connectors\n\t * --------------------------- */\n\n\t_computeConnectors: function(d) {\n\t\tvar sMin = d.xMin;\n\t\tvar dMin = d.destMinX;\n\t\tvar qx = d.qx;\n\n\t\tvar rBase, rInc;\n\t\trBase = this._roundTo(d.s.radiusBase * this._rootFontSize, 0.5);\n\t\trInc = this._roundTo(d.s.radiusIncrement * this._rootFontSize, 0.5);\n\n\t\t// var root = {};\n\t\tvar i, p, ddNum, connectors = [];\n\t\tvar x1, y1, tx;\n\n\t\tvar sView, ddView, ddItems;\n\t\tif (d.srcView.collection.selected && d.destView.filteredItems) {\n\t\t\tsView = d.srcView.itemViews.findByModel(d.srcView.collection.selected);\n\n\t\t\tvar rect = sView.label.getBoundingClientRect();\n\t\t\tx1 = rect.left;\n\t\t\ty1 = rect.top + rect.height / 2;\n\t\t\tif (qx > 0) x1 += rect.width;\n\t\t\tx1 += window.pageXOffset;\n\t\t\ty1 += window.pageYOffset;\n\n\t\t\t// if (!sView._metrics) return;\n\t\t\t// x1 = d.rect.left + sView.transform.tx\n\t\t\t// \t+ sView._metrics.textLeft;\n\t\t\t// y1 = d.rect.top + sView.transform.ty\n\t\t\t// \t+ sView._metrics.offsetHeight / 2;\n\t\t\t// if (qx > 0) x1 += sView._metrics.textWidth;\n\n\t\t\tddItems = d.destView.filteredItems;\n\t\t\tddNum = d.destView.filteredItems.length;\n\n\t\t\tfor (i = 0; i < ddNum; i++) {\n\t\t\t\tp = {};\n\t\t\t\tddView = d.destView.itemViews.findByModel(ddItems[i]);\n\n\t\t\t\trect = ddView.label.getBoundingClientRect();\n\t\t\t\tp.x2 = rect.left;\n\t\t\t\tp.y2 = rect.top + rect.height / 2;\n\t\t\t\tif (qx < 0) p.x2 += rect.width;\n\t\t\t\tp.x2 += window.pageXOffset;\n\t\t\t\tp.y2 += window.pageYOffset;\n\n\t\t\t\t// p.x2 = d.destRect.left + ddView.transform.tx\n\t\t\t\t// \t+ ddView._metrics.textLeft;\n\t\t\t\t// p.y2 = d.destRect.top + ddView.transform.ty\n\t\t\t\t// \t+ ddView._metrics.offsetHeight / 2;\n\t\t\t\t// if (qx < 0) p.x2 += ddView._metrics.textWidth;\n\n\t\t\t\tp.x1 = x1;\n\t\t\t\tp.y1 = y1;\n\t\t\t\tp.qx = qx;\n\t\t\t\tconnectors[i] = p;\n\t\t\t}\n\t\t\tconnectors.sort(function(a, b) {\n\t\t\t\treturn a.y2 - b.y2;\n\t\t\t});\n\t\t\t// ssEl's number of items above in the Y axis\n\t\t\tvar si = 0;\n\t\t\t// Node first arc (r0) max radius (cx0)\n\t\t\t// They are centered to the label, so halve it\n\t\t\tvar rMax0 = ddNum * rInc * 0.5;\n\t\t\t// cy1 offset from y1\n\t\t\tvar a;\n\n\t\t\t// First pass, calc first radius (r0, at the source of the connector),\n\t\t\t// and the amount of dest connectors vertically closer to the source (di)\n\t\t\tfor (i = 0; i < ddNum; i++) {\n\t\t\t\tp = connectors[i];\n\n\t\t\t\ta = (i - (ddNum - 1) / 2) * rInc;\n\t\t\t\tp.cy1 = p.y1 + a;\n\t\t\t\tp.cy2 = p.y2;\n\t\t\t\tp.r0 = Math.abs(a);\n\t\t\t\tp.cx0 = p.x1 + (rMax0 - p.r0) * qx;\n\n\t\t\t\t// If src (cy1) is above dest (y2), decrease index diff (di)\n\t\t\t\tp.di = ((p.cy1 - p.y2) > 0) ? i : ddNum - (i + 1);\n\t\t\t\tsi = Math.max(si, p.di);\n\n\t\t\t\t// p.dx = x1 - p.x2;\n\t\t\t\t// p.dy = y1 - p.y2;\n\t\t\t}\n\n\t\t\t// Calc max radius that fits sMin to dMin:\n\t\t\t// from space btw sMin to dMin, remove first arc and max arc increase,\n\t\t\t// then halve (there's two arcs left)\n\t\t\tvar rBaseMax = (Math.abs(dMin - sMin) - (rMax0 + (si * rInc))) / 2;\n\t\t\t// Ensure 0 > rBase > rBaseMax\n\t\t\trBase = Math.max(0, Math.min(rBase, rBaseMax));\n\t\t\t// console.log(\"%s::_computeConnectors 1rem = %spx rBase:%s rBaseMax:%s\", this.cid, this._rootFontSize, rBase, rBaseMax);\n\n\t\t\tfor (i = 0; i < ddNum; i++) {\n\t\t\t\tp = connectors[i];\n\t\t\t\tp.r1 = p.di * rInc + rBase;\n\t\t\t\tp.r2 = rBase;\n\n\t\t\t\t// p.r1 = p.di * rInc + rBase;\n\t\t\t\t// p.r2 = (si - p.di) * rInc + rBase;\n\n\t\t\t\tp.cx1 = sMin + (rMax0 * qx);\n\t\t\t\tp.cx2 = dMin - ((si - p.di) * rInc) * qx;\n\t\t\t\t//\n\t\t\t\t// p.cx1 = sMin + (rMax0 * qx);\n\t\t\t\t// p.cx2 = dMin;\n\n\t\t\t\ttx = calcArcHConnector(p.cx1, p.cy1, p.r1, p.cx2, p.cy2, p.r2, 0.9);\n\t\t\t\tif (tx) {\n\t\t\t\t\tp.tx1 = tx[0];\n\t\t\t\t\tp.tx2 = tx[1];\n\t\t\t\t} else {\n\t\t\t\t\tp.tx1 = p.cx1;\n\t\t\t\t\tp.tx2 = p.cx2;\n\t\t\t\t}\n\t\t\t\tp.length = Math.abs(p.x1 - p.x2) + Math.abs(p.cy1 - p.cy2);\n\n\t\t\t\t// Find out longest node connection for setLineDash\n\t\t\t\t// root.maxLength = Math.max(root.maxLength, p.length);\n\t\t\t}\n\t\t\tconnectors.sort(function(a, b) {\n\t\t\t\treturn a.di - b.di; // Sort by index distance to from source point\n\t\t\t\t// return a.r0 - b.r0; // Sort by first arc (centered)\n\t\t\t\t// return (a.r1 + a.r2) - (b.r1 + b.r2);\n\t\t\t\t// return a.tx2 - b.tx2;\n\t\t\t});\n\n\t\t\tconnectors.si = si;\n\t\t\tconnectors.qx = qx;\n\t\t\tconnectors.sMin = sMin;\n\t\t\tconnectors.dMin = dMin;\n\t\t\t// root.x = x1;\n\t\t\t// root.y = y1;\n\t\t\t// root.qx = qx;\n\t\t\t// root.r0 = si * rInc;\n\t\t}\n\t\t// d.connectors = connectors;\n\t\t// d.root = root;\n\t\t// return d;\n\t\treturn connectors;\n\t},\n\n\t_drawConnectors: function(pp, s, lVal, dir) {\n\t\tvar i, ii, p;\n\t\tvar ow, ra1, ra2, ta;\n\n\t\tif (!(pp && pp.length && lVal)) return;\n\n\t\tii = pp.length;\n\n\t\t/* outline width */\n\t\tow = s.lineWidth + s.outlineWidth;\n\t\t// ow = Math.min(\n\t\t// \tthis._roundTo(s.radiusIncrement * this._rootFontSize, 0.5),\n\t\t// \tthis._roundTo(s.lineWidth * (1 + s.outlineWidth), 0.5)\n\t\t// );\n\n\t\t/* arrow radiuses, direction */\n\t\t// ra1 = (s.radiusIncrement * this._rootFontSize) + s.lineWidth;\n\t\tra1 = s.arrowSize * this._rootFontSize;\n\t\tra2 = ra1 + (ow - s.lineWidth);\n\t\tta = Math.PI * dir;\n\t\t// dir -= 2;\n\n\t\tthis._setStyle(s);\n\n\t\t// if (lVal < 1) {\n\t\t// \tthis._ctx.lineDashOffset = lMax * (1 + lVal);\n\t\t// \tthis._ctx.setLineDash([lMax, lMax])\n\t\t// \t// this._ctx.lineDashOffset = lMax * (1 + lVal);;\n\t\t// \t// this._ctx.setLineDash([lMax * (1 - lVal), lMax]);\n\t\t// }\n\n\t\t// for (i = 0; i < ii; i++) {\n\t\t// p = pp[i];\n\t\tif (s.outlineWidth) {\n\t\t\tthis._ctx.save();\n\t\t\tthis._ctx.globalCompositeOperation = \"destination-out\";\n\t\t\tthis._ctx.lineWidth = ow;\n\t\t\tfor (i = 0; i < ii; i++) {\n\t\t\t\tp = pp[i];\n\n\t\t\t\tif (lVal < 1) {\n\t\t\t\t\tthis._ctx.lineDashOffset = p.length * (1 + lVal);\n\t\t\t\t\tthis._ctx.setLineDash([p.length, p.length])\n\t\t\t\t}\n\t\t\t\tthis._drawConnector(p, i, pp);\n\t\t\t\tif (lVal == 1) {\n\t\t\t\t\tthis._drawArrowhead(p.x2, p.y2, ra2, dir * ta);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._ctx.restore();\n\t\t}\n\n\t\tfor (i = 0; i < ii; i++) {\n\t\t\tp = pp[i];\n\t\t\tif (lVal < 1) {\n\t\t\t\tthis._ctx.lineDashOffset = p.length * (1 + lVal);\n\t\t\t\tthis._ctx.setLineDash([p.length, p.length])\n\t\t\t}\n\t\t\tthis._drawConnector(p, i, pp);\n\t\t\tif (lVal == 1) {\n\t\t\t\tthis._drawArrowhead(p.x2, p.y2, ra1, dir * ta);\n\t\t\t}\n\t\t}\n\t},\n\n\t_drawArrowhead: function(x, y, r, t) {\n\t\t// this._ctx.save();\n\t\t// this._ctx.lineDashOffset = 0;\n\t\t// this._ctx.setLineDash([]);\n\t\tCanvasHelper.arrowhead2(this._ctx, x, y, r, t);\n\t\tthis._ctx.stroke();\n\t\t// this._ctx.restore();\n\t},\n\n\t_drawArrowhead2: function(x, y, r, t) {\n\t\tCanvasHelper.arrowhead(this._ctx, x, y, r, t);\n\t\tthis._ctx.fill();\n\t},\n\n\t// _drawArrowheadH: function(x, y, r, a) {\n\t// \tthis._ctx.save();\n\t// \tthis._ctx.lineDashOffset = 0;\n\t// \tthis._ctx.setLineDash([]);\n\t// \tthis._ctx.beginPath();\n\t// \tthis._ctx.moveTo(x + r * 1 / dir, y - r);\n\t// \tthis._ctx.lineTo(x, y);\n\t// \tthis._ctx.lineTo(x + r * 1 / dir, y + r);\n\t// \tthis._ctx.stroke();\n\t// \tthis._ctx.restore();\n\t// },\n\n\t_drawConnector: function(p, i, pp) {\n\t\tthis._ctx.beginPath();\n\t\tthis._ctx.moveTo(p.x2, p.cy2);\n\t\tthis._ctx.arcTo(p.tx2, p.cy2, p.tx1, p.cy1, p.r2);\n\t\tthis._ctx.arcTo(p.tx1, p.cy1, p.cx1, p.cy1, p.r1);\n\t\tthis._ctx.arcTo(p.cx0, p.cy1, p.cx0, p.y1, p.r0);\n\n\t\t// p.cx00 = p.x1 + ((p.r0 + p.di) * p.qx);\n\t\t// p.cy00 = (p.cy1 + p.y1) / 2;\n\t\t// this._ctx.arcTo(p.cx00, p.cy1, p.cx00, p.cy00, p.r0 / 2);\n\t\t// this._ctx.arcTo(p.cx00, p.y1, p.x1, p.y1, p.r0 / 2);\n\t\t// this._ctx.lineTo(p.x1, p.y1);\n\n\t\t// p.cx00 = p.x1 + (p.r0 * p.qx * 2);\n\t\t// this._ctx.lineTo(p.cx00, p.cy1);\n\t\t// this._ctx.quadraticCurveTo(p.cx0, p.cy1, p.cx0, p.y1);\n\n\t\t// this._ctx.lineTo(p.cx0, p.y1);\n\t\tthis._ctx.stroke();\n\t},\n\n\t_roundTo: function(n, p) {\n\t\tif (p > 1) p = 1 / p;\n\t\treturn Math.round(n / p) * p;\n\t},\n\n\t/*\n\t_computeConnectors: function(d) {\n\t\tvar rBase = d.s.radiusBase;\n\t\tvar rInc = d.s.radiusIncrement;\n\t\tvar sMin = d.xMin;\n\t\tvar dMin = d.destMinX;\n\n\t\tvar lMax = 0;\n\t\tvar p, connectors = [];\n\t\tvar qx, x1, y1, tx;\n\t\tvar si; // ssEl's number of items above in the Y axis\n\n\t\tif (d.rect.right < d.destRect.left) {\n\t\t\tqx = 1;\n\t\t} else if (d.destRect.right < d.rect.left) {\n\t\t\tqx = -1;\n\t\t} else {\n\t\t\tqx = 0;\n\t\t}\n\n\t\tvar ssEl, ddEls, ddNum, ssRect, ddRect, i;\n\t\tssEl = d.srcView.el.querySelector(\".list-item.selected .label\");\n\t\tif (ssEl) {\n\t\t\tssRect = ssEl.getBoundingClientRect();\n\t\t\tx1 = ssRect.left;\n\t\t\tif (qx > 0) x1 += ssRect.width;\n\t\t\ty1 = ssRect.top + ssRect.height / 2;\n\t\t\t// r2 = rBase;\n\t\t\t// cx1 = d.xMin;\n\n\t\t\tsi = 0;\n\t\t\tddEls = d.destView.el.querySelectorAll(\".list-item:not(.excluded) .label\");\n\t\t\tddNum = ddEls.length;\n\t\t\t// dx = Math.abs(d.xMin - dData.xMin);\n\n\t\t\tfor (i = 0; i < ddNum; i++) {\n\t\t\t\tp = {};\n\t\t\t\tddRect = ddEls[i].getBoundingClientRect();\n\t\t\t\tp.x2 = ddRect.left;\n\t\t\t\tif (qx < 0) p.x2 += ddRect.width;\n\t\t\t\tp.y2 = ddRect.top + ddRect.height / 2;\n\t\t\t\tp.x1 = x1;\n\t\t\t\tp.y1 = y1;\n\t\t\t\tp.dx = p.x1 - p.x2;\n\t\t\t\tp.dy = p.y1 - p.y2;\n\t\t\t\tp.qx = qx;\n\t\t\t\tp.qy = Math.sign(p.dy);\n\t\t\t\t// p.dLength = Math.abs(p.x) + Math.abs(p.y);\n\t\t\t\tp.di = p.dy > 0 ? i : ddNum - (i + 1);\n\t\t\t\tsi = Math.max(si, p.di);\n\t\t\t\tconnectors[i] = p;\n\t\t\t}\n\n\t\t\tvar a, rMax0 = ddNum * 0.5 * rInc;\n\t\t\tfor (i = 0; i < ddNum; i++) {\n\t\t\t\tp = connectors[i];\n\t\t\t\tp.r1 = p.di * rInc + rBase;\n\t\t\t\tp.r2 = rBase;\n\t\t\t\t// p.r2 = (si - p.di) * rInc + rBase;\n\n\t\t\t\tp.cx1 = sMin;\n\t\t\t\tp.cx2 = dMin - ((si - p.di) * rInc) * qx;\n\t\t\t\t// p.cx2 = dMin;\n\n\t\t\t\ta = (i - (ddNum - 1) / 2) * rInc;\n\t\t\t\tp.cy1 = p.y1 + a;\n\t\t\t\tp.cy2 = p.y2;\n\n\t\t\t\ta = Math.abs(a);\n\t\t\t\tp.r0 = a;\n\t\t\t\tp.cx0 = p.x1 + (rMax0 - a) * qx;\n\n\t\t\t\ttx = calcArcHConnector(p.cx1, p.cy1, p.r1, p.cx2, p.cy2, p.r2, 0.8);\n\t\t\t\tp.tx1 = tx[0];\n\t\t\t\tp.tx2 = tx[1];\n\n\t\t\t\t// Find out longest node connection for setLineDash\n\t\t\t\tlMax = Math.max(lMax, Math.abs(p.x1 - p.x2) + Math.abs(p.cy1 - p.cy2));\n\t\t\t}\n\t\t\t// Sort by distance y1 (original) > cy1 (rInc offset) distance\n\t\t\tconnectors.sort(function(a, b) {\n\t\t\t\t// return Math.abs(b.y1 - b.cy1) - Math.abs(a.y1 - a.cy1);\n\t\t\t\t// return a.r0 - b.r0;\n\t\t\t\treturn b.di - a.di;\n\t\t\t});\n\t\t}\n\t\td.connectors = connectors;\n\t\td.maxLength = lMax;\n\t\td.maxLength = qx;\n\t}, */\n\n});\n\nif (DEBUG) {\n\t// GraphView.prototype._logFlags = \"\";\n\n\tvar applyFn = function(context, args) {\n\t\treturn Array.prototype.shift.apply(args).apply(context, args);\n\t}\n\n\tGraphView.prototype._drawConnector = _.wrap(GraphView.prototype._drawConnector, function(fn, p, i, pp) {\n\t\tif (!this._debugGraph) {\n\t\t\t// visual debug aids are off\n\t\t\treturn fn.call(this, p, i, pp);\n\t\t}\n\n\t\t// var isRtl = p.qx < 0;\n\t\tvar isFirst = i == 0;\n\t\tvar isLast = i == (pp.length - 1);\n\t\t// guide color\n\t\tvar gs = _dStyles[isFirst ? \"salmon_dashed\" : \"lightskyblue_dashed\"];\n\n\t\tif (isFirst) {\n\t\t\tCanvasHelper.drawVGuide(this._ctx, _dStyles[\"grey\"], pp.sMin);\n\t\t\tCanvasHelper.drawVGuide(this._ctx, _dStyles[\"grey\"], pp.dMin);\n\t\t}\n\n\t\tif (isFirst) {\n\t\t\tCanvasHelper.drawHGuide(this._ctx, _dStyles[\"silver_dashed\"], p.y1);\n\t\t\tCanvasHelper.drawVGuide(this._ctx, _dStyles[\"silver_dashed\"], p.x1);\n\t\t\tCanvasHelper.drawCircle(this._ctx, _dStyles[\"midnightblue\"], p.x1, p.y1, 10);\n\t\t}\n\t\tif (isFirst || isLast) {\n\t\t\t// CanvasHelper.drawVGuide(this._ctx, gs, p.cx1 + (p.r1 * p.qx));\n\t\t\tCanvasHelper.drawVGuide(this._ctx, gs, p.tx2);\n\t\t\tCanvasHelper.drawVGuide(this._ctx, gs, p.cx2 - (p.r2 * p.qx));\n\t\t\t// CanvasHelper.drawVGuide(this._ctx, gs, p.cx2);\n\t\t\t// CanvasHelper.drawHGuide(this._ctx, gs, p.cy2);\n\t\t}\n\t\tif (isFirst || isLast) {\n\t\t\tthis._ctx.save();\n\t\t\tthis._ctx.strokeStyle = _dStyles[(isFirst ? \"red\" : \"blue\")].strokeStyle;\n\t\t\tthis._ctx.lineWidth *= 1.5;\n\t\t}\n\t\t// }\n\n\t\tfn.call(this, p, i, pp);\n\n\t\t// if (isRtl) {\n\t\tif (isFirst || isLast) {\n\t\t\tthis._ctx.restore();\n\t\t}\n\t\t// point color\n\t\tvar pCol = isLast ? \"midnightblue\" : isFirst ? \"sienna\" : \"grey\";\n\t\tvar ps = _dStyles[pCol];\n\t\tvar pf = _dStyles[pCol + \"_fill\"];\n\n\t\t// CanvasHelper.drawCrosshair(this._ctx, ps, p.x1 + ((p.r0 + p.di) * p.qx), p.cy1, 3);\n\n\n\t\tif (isFirst || isLast) {\n\t\t\t// moveTo(p.x2, p.cy2)\n\t\t\tCanvasHelper.drawCrosshair(this._ctx, ps, p.x2, p.cy2, 10);\n\t\t\tCanvasHelper.drawCircle(this._ctx, ps, p.x2, p.cy2, 3);\n\n\t\t\t// arcTo #1: (p.tx2, p.cy2, p.tx1, p.cy1, p.r2)\n\t\t\tCanvasHelper.drawSquare(this._ctx, ps, p.tx2, p.cy2, 4); // p1\n\t\t\tCanvasHelper.drawCircle(this._ctx, pf, p.tx1, p.cy1, 2); // p2\n\n\t\t\t// arcTo #2: (p.tx1, p.cy1, p.cx1, p.cy1, p.r1)\n\t\t\tCanvasHelper.drawSquare(this._ctx, ps, p.tx1, p.cy1, 4); // p1\n\t\t\tCanvasHelper.drawCircle(this._ctx, pf, p.cx1, p.cy1, 2); // p2\n\n\t\t\t// arcTo #2: (p.cx0, p.cy1, p.cx0, p.y1, p.r0)\n\t\t\tCanvasHelper.drawSquare(this._ctx, ps, p.cx0, p.cy1, 4); // p1\n\t\t\tCanvasHelper.drawCircle(this._ctx, pf, p.cx0, p.y1, 2); // p2\n\n\t\t\tCanvasHelper.drawCircle(this._ctx, _dStyles[\"green\"], p.tx1, p.cy1, 4);\n\t\t\tCanvasHelper.drawCircle(this._ctx, _dStyles[\"green\"], p.cx1, p.cy1, 4);\n\t\t\tCanvasHelper.drawCircle(this._ctx, _dStyles[\"green\"], p.cx2, p.cy2, 4);\n\t\t}\n\t\t// }\n\t});\n\n\n\tGraphView.prototype._traceScroll = function(type) {\n\t\tvar tpl = \"%s:[%s] DPR:%i \" +\n\t\t\t\"[window: %i %i] \" +\n\t\t\t\"[html: %i %i %i] \" +\n\t\t\t\"[body: %i %i %i] \" +\n\t\t\t\"[container: %i %i %i] \" +\n\t\t\t\"[graph: %i %i %i]\";\n\t\tconsole.log(tpl, this.cid, type, this._canvasRatio,\n\t\t\twindow.pageYOffset,\n\t\t\twindow.pageYOffset,\n\t\t\tdocument.documentElement.clientHeight,\n\t\t\tdocument.documentElement.scrollTop,\n\t\t\tdocument.documentElement.scrollHeight,\n\t\t\tdocument.body.clientHeight,\n\t\t\tdocument.body.scrollTop,\n\t\t\tdocument.body.scrollHeight,\n\t\t\tdocument.body.firstElementChild.clientHeight,\n\t\t\tdocument.body.firstElementChild.scrollTop,\n\t\t\tdocument.body.firstElementChild.scrollHeight,\n\t\t\tthis.el.clientHeight,\n\t\t\tthis.el.scrollTop,\n\t\t\tthis.el.scrollHeight\n\t\t);\n\t};\n\n\tif (GraphView.prototype._logFlags.split(\" \")[\"view.render\"]) {\n\t\t// GraphView.prototype._requestRender = _.wrap(CanvasView.prototype._requestRender, function(fn) {\n\t\t// \tdebouncedLog(\"%s::_requestRender\", this.cid);\n\t\t// \treturn applyMethod(this, arguments);\n\t\t// });\n\t\tvar debouncedLog = _.debounce(_.bind(console.log, console), 500, true);\n\n\t\tGraphView.prototype._applyRender = _.wrap(CanvasView.prototype._applyRender, function(fn) {\n\t\t\tvar retval;\n\t\t\tthis._logFlags[\"view.render\"] = false;\n\t\t\tdebouncedLog(\"%s::_applyRender [debounced]\", this.cid);\n\t\t\tretval = applyFn(this, arguments);\n\t\t\tthis._logFlags[\"view.render\"] = true;\n\t\t\treturn retval;\n\t\t});\n\t}\n}\n\nmodule.exports = GraphView;\n",
    "/**\n * @module app/view/component/GroupingListView\n */\n\n/** @type {module:app/view/component/FilterableListView} */\nvar FilterableListView = require(\"app/view/component/FilterableListView\");\n/** @type {module:app/view/component/ClickableRenderer} */\nvar ClickableRenderer = require(\"app/view/render/ClickableRenderer\");\n/** @type {module:app/view/render/LabelRenderer} */\nvar LabelRenderer = require(\"app/view/render/LabelRenderer\");\n// /** @type {module:utils/array/difference} */\n// var diff = require(\"utils/array/difference\");\n\n/**\n * @constructor\n * @type {module:app/view/component/GroupingListView}\n */\nvar GroupingListView = FilterableListView.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"groupingList\",\n\n\t/** @override */\n\ttagName: \"dl\",\n\n\t/** @override */\n\tclassName: \"grouped\",\n\n\t/** @type {Function|null} empty array */\n\t_groupingFn: null, //function() { return null; },\n\n\t/** @override */\n\tdefaults: _.defaults({\n\t\t// defaults: {\n\t\trenderer: ClickableRenderer.extend({\n\t\t\t/** @override */\n\t\t\tcidPrefix: \"groupingListItem\",\n\t\t\t/** @override */\n\t\t\ttagName: \"dl\",\n\t\t\t/** @override */\n\t\t\tclassName: \"list-item list-node\",\n\t\t}),\n\t\tgroupingRenderer: LabelRenderer.extend({\n\t\t\t/** @override */\n\t\t\tcidPrefix: \"groupingListGroup\",\n\t\t\t/** @override */\n\t\t\ttagName: \"dt\",\n\t\t\t/** @override */\n\t\t\tclassName: \"list-group list-node\",\n\t\t}),\n\t\tgroupingFn: null,\n\t\t// },\n\t}, FilterableListView.prototype.defaults),\n\n\tproperties: {\n\t\tgroups: {\n\t\t\tget: function() {\n\t\t\t\treturn this._groups;\n\t\t\t}\n\t\t},\n\t\tfilteredGroups: {\n\t\t\tget: function() {\n\t\t\t\treturn this._filteredGroups;\n\t\t\t}\n\t\t},\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tFilterableListView.prototype.initialize.apply(this, arguments);\n\n\t\tthis._groups = [];\n\t\tthis._filteredGroups = [];\n\t\tthis._changedFilteredGroups = [];\n\t\tthis._groupsByItemCid = {};\n\n\t\tthis._groupingFn = options.groupingFn;\n\t\tthis.groupingRenderer = options.groupingRenderer;\n\t\tthis._computeGroups();\n\t\tif (this._groupingFn) {\n\t\t\tthis._groups.forEach(this.createGroupingView, this);\n\t\t}\n\t},\n\n\t/**\n\t * Called once on collection change\n\t * @private\n\t */\n\t_computeGroups: function() {\n\t\t// this._groups = _.uniq(this.collection.map(this._groupingFn, this));\n\t\tthis._groups.length = 0;\n\t\t// this._groupItems.length = 0;\n\t\tif (this._groupingFn) {\n\t\t\tthis.collection.forEach(function(item) {\n\t\t\t\tvar gIdx, gObj;\n\t\t\t\tgObj = this._groupingFn.apply(null, arguments);\n\t\t\t\tif (gObj) {\n\t\t\t\t\tgIdx = this._groups.indexOf(gObj);\n\t\t\t\t\tif (gIdx == -1) {\n\t\t\t\t\t\tgIdx = this._groups.length;\n\t\t\t\t\t\tthis._groups[gIdx] = gObj;\n\t\t\t\t\t\t// this._groupItems[gIdx] = [];\n\t\t\t\t\t}\n\t\t\t\t\t// this._groupItems[gIdx].push(item);\n\t\t\t\t}\n\t\t\t\tthis._groupsByItemCid[item.cid] = gObj;\n\t\t\t}, this);\n\t\t} else {\n\t\t\tthis.collection.forEach(function(item) {\n\t\t\t\tthis._groupsByItemCid[item.cid] = null;\n\t\t\t}, this);\n\t\t}\n\t},\n\n\t/** @private Create children views */\n\tcreateGroupingView: function(item) {\n\t\tvar view = new this.groupingRenderer({\n\t\t\tmodel: item,\n\t\t\tel: this.el.querySelector(\".list-group[data-id=\\\"\" + item.id + \"\\\"]\")\n\t\t});\n\t\tthis.itemViews.add(view);\n\t\treturn view;\n\t},\n\n\t/* --------------------------- *\n\t/* Filter impl 1\n\t/* --------------------------- */\n\n\t/** @override */\n\t/*\n\tcomputeFilter_1: function() {\n\t\tFilterableListView.prototype.computeFilter_1.apply(this, arguments);\n\n\t\tif (this._groupingFn) {\n\t\t\tif (this._filteredItems.length == 0) {\n\t\t\t\tthis._filteredGroups = [];\n\t\t\t} else {\n\t\t\t\tthis._filteredGroups = _.uniq(this._filteredItems.map(function(item) {\n\t\t\t\t\treturn this._groupsByItemCid[item.cid];\n\t\t\t\t}, this));\n\t\t\t}\n\t\t}\n\t\t// if (this._groupingFn) {\n\t\t// \tif (this._filteredItems.length == 0) {\n\t\t// \t\tthis._filteredGroups = [];\n\t\t// \t\tthis._groups.forEach(function(group) {\n\t\t// \t\t\tthis.itemViews.findByModel(group).el.classList.remove(\"excluded\");\n\t\t// \t\t}, this);\n\t\t// \t} else {\n\t\t// \t\tthis._filteredGroups = _.uniq(this._filteredItems.map(function(item) {\n\t\t// \t\t\treturn this._groupsByItemCid[item.cid];\n\t\t// \t\t}, this));\n\t\t// \t\tthis._groups.forEach(function(group) {\n\t\t// \t\t\tthis.itemViews.findByModel(group).el.classList.toggle(\"excluded\", this._filteredGroups.indexOf(group) == -1);\n\t\t// \t\t}, this);\n\t\t// \t}\n\t\t// }\n\t},\n\t*/\n\n\t/* --------------------------- *\n\t/* Filter impl 2\n\t/* --------------------------- */\n\n\t// /** @override */\n\t// renderFilterFn_2: function() {\n\t// \tFilterableListView.prototype.renderFilterFn_2.apply(this, arguments);\n\t// },\n\n\t/** @override */\n\tcomputeFilter: function() {\n\t\tFilterableListView.prototype.computeFilter.apply(this, arguments);\n\n\t\tif (this._groupingFn) {\n\t\t\tif (this._filteredItems.length == 0) {\n\t\t\t\tthis._filteredGroups = this._groups.concat(); //[];\n\t\t\t} else {\n\t\t\t\tthis._filteredGroups = _.uniq(this._filteredItems.map(function(item) {\n\t\t\t\t\treturn this._groupsByItemCid[item.cid];\n\t\t\t\t}, this));\n\t\t\t}\n\t\t}\n\t},\n\n\t/** @override */\n\tapplyFilter: function() {\n\t\tFilterableListView.prototype.applyFilter.apply(this, arguments);\n\n\t\tthis._groups.forEach(function(group) {\n\t\t\tthis.itemViews.findByModel(group).el.classList.toggle(\"excluded\", (this._filteredGroups.indexOf(group) == -1));\n\t\t}, this);\n\t},\n\n\t// computeFiltered: function() {\n\t// \tFilterableListView.prototype.computeFiltered.apply(this, arguments);\n\t// },\n\t//\n\t// renderFiltered: function() {\n\t// \tFilterableListView.prototype.renderFiltered.apply(this, arguments);\n\t// },\n\n});\n\nmodule.exports = GroupingListView;\n",
    "/**\n * @module app/view/component/PlayToggleSymbol\n */\n\n// /** @type {module:app/control/Globals} */\n// var Globals = require(\"app/control/Globals\");\n/** @type {module:app/view/base/CanvasView} */\nvar CanvasView = require(\"app/view/base/CanvasView\");\n\n/** @type {Function} */\nvar Color = require(\"color\");\n/** @type {module:utils/canvas/bitmap/stackBlurRGB} */\nvar stackBlurRGB = require(\"utils/canvas/bitmap/stackBlurRGB\");\n/** @type {module:utils/canvas/bitmap/getAverageRGB} */\nvar getAverageRGB = require(\"utils/canvas/bitmap/getAverageRGB\");\n/** @type {module:utils/canvas/bitmap/multiply} */\nvar multiply = require(\"utils/canvas/bitmap/multiply\");\n/** @type {module:utils/canvas/bitmap/desaturate} */\nvar desaturate = require(\"utils/canvas/bitmap/desaturate\");\n/** @type {module:utils/canvas/CanvasHelper} */\nvar roundRect = require(\"utils/canvas/CanvasHelper\").roundRect;\n\n/** @type {module:utils/ease/fn/easeInQuad} */\nvar easeIn = require(\"utils/ease/fn/easeInQuad\");\n/** @type {module:utils/ease/fn/easeOutQuad} */\nvar easeOut = require(\"utils/ease/fn/easeOutQuad\");\n\nvar PI2 = Math.PI * 2;\nvar LOOP_OFFSET = 1.833333;\nvar INTEP_MS = require(\"app/control/Globals\").TRANSITION_DURATION;\nvar FILTER_REFRESH_THRESHOLD = 0.5; //seconds elapsed\nvar FILTER_SCALE = 1.5;\nvar FILTER_RADIUS = 30; //pixels\nvar FILTER_MULTIPLY = 0.1;\n\nvar PlayToggleSymbol = {\n\tPLAY: \"playing\",\n\tPAUSE: \"paused\",\n\tWAITING: \"waiting\",\n\tENDED: \"ended\",\n};\n\nmodule.exports = CanvasView.extend({\n\n\t\t/** @type {string} */\n\t\tcidPrefix: \"playToggleSymbol\",\n\t\t/** @type {string} */\n\t\tclassName: \"play-toggle\",\n\n\t\tdefaults: {\n\t\t\tvalues: {\n\t\t\t\t_loop: 0,\n\t\t\t\t_arc: 0,\n\t\t\t},\n\t\t\tmaxValues: {\n\t\t\t\t_loop: 1\n\t\t\t},\n\t\t\tcolor: \"rgba(255,255,255,1.0)\",\n\t\t\tbackgroundColor: \"rgba(0,0,0,0.25)\",\n\t\t\tpaused: true,\n\t\t\tsymbolName: \"\",\n\t\t\t// borderRadius: 3,\n\t\t\t// borderWidth: 3,\n\t\t},\n\n\t\tproperties: {\n\t\t\tsymbolName: {\n\t\t\t\tget: function() {\n\t\t\t\t\treturn this._symbolName;\n\t\t\t\t},\n\t\t\t\tset: function(value) {\n\t\t\t\t\tthis._setSymbolName(value);\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\n\t\t/** @override */\n\t\tinitialize: function(options) {\n\t\t\t// TODO: cleanup options mess in CanvasView\n\t\t\tCanvasView.prototype.initialize.apply(this, arguments);\n\t\t\tthis._options = _.extend(this._options, _.pick(options, \"symbolName\", \"borderRadius\", \"borderWidth\"));\n\t\t\tthis.symbolName = this._options.symbolName;\n\t\t},\n\n\t\t/** @override */\n\t\tmeasureCanvas: function(w, h, s) {\n\t\t\t// make canvas square\n\t\t\tthis._canvasHeight = this._canvasWidth = Math.min(w, h);\n\t\t},\n\n\t\t/** @override */\n\t\tupdateCanvas: function(ctx, s) {\n\t\t\tvar mObj = this._getFontMetrics(this._fontFamily);\n\t\t\tthis._baselineShift = mObj ? (mObj.ascent + mObj.descent) / mObj.unitsPerEm : 0.7; // default value\n\t\t\tthis._baselineShift *= this._fontSize * 0.5; // apply to font-size, halve it\n\t\t\tthis._baselineShift = Math.round(this._baselineShift);\n\n\t\t\tthis._canvasOffsetX = this._canvasOffsetY = this._canvasWidth / 2;\n\t\t\t// double SQRT1_2: square within circle within square\n\t\t\tthis._radius = (this._canvasWidth / 2) * Math.SQRT1_2 * Math.SQRT1_2 * Math.SQRT1_2;\n\t\t\tthis._side = this._radius; // * Math.SQRT1_2; // * Math.SQRT1_2;\n\t\t\t// this._borderWidth = this._options.borderWidth * this._canvasRatio;\n\t\t\t// this._borderRadius = this._canvasWidth * this._canvasRatio / 2; //this._options.borderRadius * this._canvasRatio;\n\n\t\t\t// reset matrix and translate 0,0 to center\n\t\t\tthis._ctx.setTransform(1, 0, 0, 1, this._canvasOffsetX, this._canvasOffsetY);\n\t\t\t// this._ctx.restore();\n\t\t\t// this._ctx.textBaseline = \"middle\";\n\t\t\tthis._ctx.lineWidth = this._radius * (1 - Math.SQRT1_2);\n\t\t\t// this._ctx.fillStyle = \"#FFF\";\n\t\t\tthis._ctx.shadowColor = \"rgba(0,0,0,0.75)\";\n\t\t\tthis._ctx.shadowBlur = 1;\n\t\t\tthis._ctx.shadowOffsetX = 2;\n\t\t\tthis._ctx.shadowOffsetY = 2;\n\t\t\t// this._ctx.save();\n\n\t\t\tthis._isImageDataInvalid = true;\n\t\t\t//console.log(\"%s::updateCanvas %s\", this.cid, this._backgroundColor);\n\t\t},\n\n\t\t/* --------------------------- *\n\t\t * symbolName\n\t\t * --------------------------- */\n\n\t\t_symbolName: \"\",\n\t\t_setSymbolName: function(value) {\n\t\t\tif (this._symbolName !== value) {\n\t\t\t\tthis._lastSymbolName = this._symbolName;\n\t\t\t\tthis._symbolName = value;\n\n\t\t\t\tthis.refreshImageSource();\n\t\t\t\tthis.requestRender(CanvasView.LAYOUT_INVALID);\n\t\t\t\tconsole.log(\"%s::[set] symbol %o (from %o)\", this.attached ? this.parentView.cid : this.cid, this._symbolName, this._lastSymbolName, this.paused ? \"paused\" : \"\");\n\t\t\t}\n\t\t},\n\n\t\t/* --------------------------- *\n\t\t * setImageSource/refreshImageSource\n\t\t * --------------------------- */\n\n\t\t_imageSource: null,\n\t\tsetImageSource: function(imageSource) {\n\t\t\tif (this._imageSource !== imageSource) {\n\t\t\t\tthis._imageSource = imageSource;\n\t\t\t\tthis._isImageDataInvalid = true;\n\t\t\t\tthis.requestRender(CanvasView.SIZE_INVALID);\n\t\t\t}\n\t\t},\n\n\t\t_imageDataTC: null,\n\t\trefreshImageSource: function(threshold) {\n\t\t\tif (this._isImageDataInvalid || !(this._imageSource instanceof HTMLVideoElement)) {\n\t\t\t\treturn; // data is marked for refresh already, or not a video\n\t\t\t}\n\t\t\tif (!_.isNumber(threshold)) {\n\t\t\t\tthreshold = FILTER_REFRESH_THRESHOLD;\n\t\t\t}\n\t\t\tif (threshold < Math.abs(this._imageDataTC - this._imageSource.currentTime)) {\n\t\t\t\tthis._isImageDataInvalid = true;\n\t\t\t\tthis.requestRender(CanvasView.SIZE_INVALID);\n\t\t\t}\n\t\t},\n\n\t\t_imageData: null,\n\t\t_updateImageData: function() {\n\t\t\tif (this._imageSource === null) {\n\t\t\t\tthis._imageData = null;\n\t\t\t\tthis._imageDataTC = null;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// source scale, source rect, dest scale, dest rect, current timecode\n\t\t\tvar s, sr, d, dr, tc;\n\n\t\t\t// Get source/dest offsets, intrinsic scale and timecode\n\t\t\t// ---------------------------------\n\t\t\tsr = this._imageSource.getBoundingClientRect();\n\t\t\tdr = this.el.getBoundingClientRect();\n\n\t\t\tif (this._imageSource instanceof HTMLVideoElement) {\n\t\t\t\ts = this._imageSource.videoWidth / sr.width;\n\t\t\t\ttc = this._imageSource.currentTime;\n\t\t\t} else {\n\t\t\t\ts = this._imageSource.naturalWidth / sr.width;\n\t\t\t\ttc = 0;\n\t\t\t}\n\t\t\td = s * FILTER_SCALE;\n\n\t\t\t// draw source canvas maintaining position\n\t\t\t// ---------------------------------\n\t\t\tthis._ctx.save();\n\t\t\tthis._ctx.setTransform(1, 0, 0, 1, 0, 0);\n\t\t\tthis._ctx.drawImage(this._imageSource,\n\t\t\t\t(dr.left - sr.left) * s + (dr.width / 2) * s - (dr.width / 2) * d,\n\t\t\t\t(dr.top - sr.top) * s + (dr.height / 2) * s - (dr.height / 2) * d,\n\t\t\t\tdr.width * d, dr.height * d,\n\t\t\t\t0, 0, this.el.width, this.el.height\n\t\t\t);\n\t\t\t// if (d == s)\n\t\t\t// this._ctx.drawImage(this._imageSource,\n\t\t\t// \t(dr.left - sr.left) * s, (dr.top - sr.top) * s,\n\t\t\t// \tdr.width * s, dr.height * s,\n\t\t\t// \t0, 0, this.el.width, this.el.height\n\t\t\t// );\n\n\t\t\t// get ImageData\n\t\t\t// find luminosity threshold form average color\n\t\t\t// ---------------------------------\n\t\t\tvar imgdata, isDark;\n\n\t\t\timgdata = this._ctx.getImageData(0, 0, this.el.width, this.el.height);\n\t\t\t// isDark = !Color().rgb(getAverageRGB(imgdata)).dark();\n\n\t\t\t// this._ctx.globalCompositeOperation = \"luminosity\";\n\t\t\t// this._ctx.globalAlpha = 0.25;\n\t\t\t// this._ctx.fillStyle = (isDark ? \"black\" : \"white\");\n\t\t\t// this._ctx.fillRect(0, 0, this.el.width, this.el.height);\n\n\t\t\tthis._ctx.clearRect(0, 0, this.el.width, this.el.height);\n\t\t\tthis._ctx.restore();\n\n\t\t\t// Store appropiate color values\n\t\t\t// ---------------------------------\n\t\t\tthis._color = isDark ? \"white\" : \"black\";\n\t\t\t// this._color = isDark ? \"rgba(255,255,255,0.75)\" : \"rgba(0,0,0,0.75)\";\n\t\t\t// this._backgroundColor = isDark ? \"rgba(0,0,0,0.75)\" : \"rgba(255,255,255,0.74)\";\n\n\t\t\t// this.el.style.color =\n\t\t\t// \tthis._ctx.fillStyle =\n\t\t\t// \tthis._ctx.strokeStyle =\n\t\t\t// \tthis._color;\n\t\t\t// this.el.style.backgroundColor =\n\t\t\t// \tthis._ctx.shadowColor =\n\t\t\t// \tthis._backgroundColor;\n\n\t\t\t// this.el.classList.toggle(\"lod\", isDark);\n\t\t\t// this.el.classList.toggle(\"dol\", !isDark);\n\n\t\t\t// Apply filters and save results\n\t\t\t// ---------------------------------\n\t\t\t// imgdata = this._ctx.getImageData(0, 0, this.el.width, this.el.height);\n\t\t\t// imgdata = multiply(imgdata, (isDark ? 1 - FILTER_MULTIPLY : 1 + FILTER_MULTIPLY));\n\t\t\t// imgdata = desaturate(imgdata, 0.5);\n\n\t\t\timgdata = multiply(imgdata, 1 + FILTER_MULTIPLY);\n\t\t\timgdata = stackBlurRGB(imgdata, FILTER_RADIUS);\n\t\t\t// imgdata = null;\n\n\t\t\tthis._imageData = imgdata;\n\t\t\tthis._imageDataTC = tc;\n\t\t},\n\n\t\t/** @override */\n\t\tredraw: function(ctx, intrp, flags) {\n\t\t\tthis._clearCanvas();\n\n\t\t\tif (this._symbolName === 'waiting') {\n\t\t\t\tif (intrp.getTargetValue('_arc') === 0) {\n\t\t\t\t\tintrp.valueTo('_arc', 1, 0 * INTEP_MS, easeIn)\n\t\t\t\t\t\t.updateValue('_arc');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (intrp.getTargetValue('_arc') === 1) {\n\t\t\t\t\tintrp.valueTo('_arc', 0, 0 * INTEP_MS, easeOut)\n\t\t\t\t\t\t.updateValue('_arc');\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar a = intrp.getRenderedValue(\"_arc\");\n\t\t\t// while arc is > 0, loop indefinitely while spinning and restart\n\t\t\t// if at end. Otherwise let interp exhaust arc duration\n\t\t\tif (a > 0) {\n\t\t\t\tif (!intrp.paused && intrp.isAtTarget('_loop')) {\n\t\t\t\t\t// console.log(\"%s::redraw [loop]\", this.cid, this.parentView.cid);\n\t\t\t\t\tintrp\n\t\t\t\t\t\t.valueTo('_loop', 0, 0)\n\t\t\t\t\t\t.valueTo('_loop', 1, 2 * INTEP_MS)\n\t\t\t\t\t\t.updateValue('_loop');\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar l = intrp.getRenderedValue(\"_loop\");\n\n\t\t\t// if (this._isImageDataInvalid) {\n\t\t\t// \tthis._isImageDataInvalid = false;\n\t\t\t// \tthis._updateImageData();\n\t\t\t// }\n\t\t\t// if (this._imageData !== null) {\n\t\t\t// \tctx.putImageData(this._imageData, 0, 0);\n\t\t\t// }\n\n\t\t\t// always render while arc is > 0\n\t\t\tif (a > 0) {\n\t\t\t\t// arc span bounce\n\t\t\t\tvar b = (l < 0.5 ? (l % 0.5) : 0.5 - (l % 0.5)) * 2;\n\t\t\t\t// bounce + main arc span\n\t\t\t\tvar aa = (a * b * 0.25) + (a * 0.125) + .0001;\n\t\t\t\t// rotation loop\n\t\t\t\tvar ll = l + LOOP_OFFSET;\n\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.arc(0, 0, this._radius, ((1 - aa) + ll) * PI2, (aa + ll) * PI2, false);\n\t\t\t\tctx.stroke();\n\t\t\t}\n\n\t\t\tswitch (this._symbolName) {\n\t\t\t\tcase \"replay\":\n\t\t\t\tcase \"ended\":\n\t\t\t\tcase \"play\":\n\t\t\t\t\t// this.drawPlay(ctx, (1 - a) * s);\n\t\t\t\t\tthis.drawPlay(ctx, this._side);\n\t\t\t\t\tctx.fill();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"pause\":\n\t\t\t\t\t// this.drawPause(ctx, (1 - a) * s);\n\t\t\t\t\tthis.drawPause(ctx, this._side);\n\t\t\t\t\tctx.fill();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"waiting\":\n\t\t\t\t\tswitch (this._lastSymbolName) {\n\t\t\t\t\t\tcase \"replay\":\n\t\t\t\t\t\tcase \"ended\":\n\t\t\t\t\t\tcase \"play\":\n\t\t\t\t\t\t\tthis.drawPlay(ctx, (1 - a) * this._side);\n\t\t\t\t\t\t\tctx.fill();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"pause\":\n\t\t\t\t\t\t\tthis.drawPause(ctx, (1 - a) * this._side);\n\t\t\t\t\t\t\tctx.fill();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\n\t\tdrawPlay: function(ctx, r) {\n\t\t\tvar tx = (1 - Math.SQRT1_2) * r;\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(tx + r, 0);\n\t\t\tctx.lineTo(tx - r, -r);\n\t\t\tctx.lineTo(tx - r, r);\n\t\t\tctx.closePath();\n\t\t},\n\n\t\tdrawPause: function(ctx, r) {\n\t\t\tvar w = r * 0.75;\n\t\t\tvar h = r * 2;\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(-r, -r, w, h);\n\t\t\tctx.rect(r - w, -r, w, h);\n\t\t\tctx.closePath();\n\t\t},\n\n\t\tdrawLabel: function(labelString) {\n\t\t\tvar labelWidth = this._ctx.measureText(labelString).width;\n\t\t\tthis._ctx.fillText(labelString,\n\t\t\t\tlabelWidth * -0.5,\n\t\t\t\t// 0, labelWidth);\n\t\t\t\tthis._baselineShift, labelWidth);\n\t\t},\n\t},\n\tPlayToggleSymbol);\n",
    "/**\n * @module app/view/component/SelectableListView\n */\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n\n/** @type {module:backbone.babysitter} */\nvar Container = require(\"backbone.babysitter\");\n/** @type {module:app/view/component/DefaultSelectableRenderer} */\nvar DefaultSelectableRenderer = require(\"app/view/render/DefaultSelectableRenderer\");\n/** @type {module:app/view/component/ClickableRenderer} */\nvar ClickableRenderer = require(\"app/view/render/ClickableRenderer\");\n\nvar SelectableListView = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"selectableList\",\n\n\t/** @override */\n\ttagName: \"ul\",\n\n\t/** @override */\n\tclassName: \"list selectable\",\n\n\t/** @type {module:app/view/component/DefaultSelectableRenderer} */\n\trenderer: DefaultSelectableRenderer,\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tthis._enabled = true;\n\t\tthis._childrenInvalid = true;\n\n\t\toptions.renderer && (this.renderer = options.renderer);\n\t\tthis.showEmpty = !!options.showEmpty;\n\t\tthis.itemViews = new Container();\n\n\t\tthis.listenTo(this.collection, \"add remove reset\", this._onCollectionChange);\n\t},\n\n\t/** @override */\n\tremove: function() {\n\t\tthis.removeChildren();\n\t\tView.prototype.remove.apply(this, arguments);\n\t\treturn this;\n\t},\n\n\t_onCollectionChange: function(ev) {\n\t\tthis._childrenInvalid = true;\n\t\tthis.render();\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tif (this._childrenInvalid) {\n\t\t\tthis._childrenInvalid = false;\n\t\t\tthis.createChildren();\n\t\t}\n\t\treturn this;\n\t},\n\n\t/** @override */\n\tsetEnabled: function(enabled) {\n\t\tif (this._enabled !== enabled) {\n\t\t\tthis._enabled = enabled;\n\t\t\tthis.el.classList.toggle(\"disabled\", !this._enabled);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Child views\n\t/* --------------------------- */\n\n\tcreateChildren: function() {\n\t\tvar eltBuffer, view;\n\n\t\tthis.removeChildren();\n\t\tthis.el.innerHTML = \"\";\n\n\t\tif (this.collection.length) {\n\t\t\teltBuffer = document.createDocumentFragment();\n\t\t\tif (this.showEmpty) {\n\t\t\t\tview = this.createEmptyView();\n\t\t\t\teltBuffer.appendChild(view.render().el);\n\t\t\t}\n\t\t\tthis.collection.each(function(model, index, arr) {\n\t\t\t\tview = this.createItemView(model, index);\n\t\t\t\teltBuffer.appendChild(view.render().el);\n\t\t\t}, this);\n\t\t\tthis.el.appendChild(eltBuffer);\n\t\t}\n\t},\n\n\tcreateItemView: function(model, index) {\n\t\tvar view = new(this.renderer)({\n\t\t\tmodel: model\n\t\t});\n\t\tthis.itemViews.add(view);\n\t\tthis.listenTo(view, \"renderer:click\", this.onItemViewClick);\n\t\treturn view;\n\t},\n\n\tremoveChildren: function() {\n\t\tthis.itemViews.each(this.removeItemView, this);\n\t},\n\n\tremoveItemView: function(view) {\n\t\tthis.stopListening(view);\n\t\tthis.itemViews.remove(view);\n\t\tview.remove();\n\t\treturn view;\n\t},\n\n\t/* --------------------------- *\n\t/* Child event handlers\n\t/* --------------------------- */\n\n\t/** @private */\n\tonItemViewClick: function(item) {\n\t\tif (this.collection.selected !== item && this._enabled) {\n\t\t\tthis.trigger(\"view:select:one\", item);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Empty view\n\t/* --------------------------- */\n\n\tcreateEmptyView: function() {\n\t\tvar view = new SelectableListView.EmptyRenderer({\n\t\t\tmodel: this.collection\n\t\t});\n\t\tthis.itemViews.add(view);\n\t\tthis.listenTo(view, \"renderer:click\", function() {\n\t\t\tthis._enabled && this.trigger(\"view:select:none\");\n\t\t});\n\t\treturn view;\n\t},\n}, {\n\tEmptyRenderer: ClickableRenderer.extend({\n\n\t\t/** @override */\n\t\ttagName: \"li\",\n\t\t/** @override */\n\t\tclassName: \"list-item empty-item\",\n\n\t\t/** @override */\n\t\tinitialize: function(options) {\n\t\t\tthis.listenTo(this.model, \"selected deselected\", this.renderClassList);\n\t\t\tthis.renderClassList();\n\t\t},\n\n\t\t/** @override */\n\t\trender: function() {\n\t\t\tthis.el.innerHTML = \"<a href=\\\"#clear\\\"><b> </b></a>\";\n\t\t\tthis.renderClassList();\n\t\t\treturn this;\n\t\t},\n\n\t\trenderClassList: function() {\n\t\t\tthis.el.classList.toggle(\"selected\", this.model.selectedIndex === -1);\n\t\t},\n\t})\n});\n\nmodule.exports = SelectableListView;\n",
    "/** @type {Function} */\nvar Color = require(\"color\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundles = require(\"app/model/collection/BundleCollection\");\n\n// - - - - - - - - - - - - - - - -\n//  utils\n// - - - - - - - - - - - - - - - -\n\nfunction insertCSSRule(sheet, selector, style) {\n\tvar cssText = \"\";\n\tfor (var prop in style) {\n\t\tcssText += prop + \":\" + style[prop] + \";\";\n\t}\n\tsheet.insertRule(selector + \"{\" + cssText + \"}\", sheet.cssRules.length);\n}\n\nfunction selfAndDescendant(selfCls, cls) {\n\treturn selfCls + \" \" + cls + \", \" + selfCls + cls;\n}\n\n// - - - - - - - - - - - - - - - -\n//  root rules\n// - - - - - - - - - - - - - - - -\n\nvar rootStyles = [\n\t\"color\",\n\t\"background\",\n\t\"background-color\",\n\t// \"--link-color\"\n];\n\nfunction initRootStyles(sheet, rootSelector, attrs, fgColor, bgColor, lnColor, hasDarkBg) {\n\tvar s, revSelector, fgColorVal, bgColorVal;\n\t// var revFgColorVal, revBgColorVal;\n\n\ts = _.pick(attrs, rootStyles);\n\ts[\"-webkit-font-smoothing\"] = (hasDarkBg ? \"antialiased\" : \"auto\");\n\t/* NOTE: In Firefox '-moz-osx-font-smoothing: grayscale;'\n\t/* works both in light over dark and dark over light, hardcoded in _base.scss */\n\t//s[\"-moz-osx-font-smoothing\"] = (hasDarkBg? \"grayscale\" : \"auto\");\n\tinsertCSSRule(sheet, rootSelector, s);\n\n\t// A element\n\t// - - - - - - - - - - - - - - - -\n\ts = {}\n\ts[\"color\"] = lnColor.rgbString();\n\tinsertCSSRule(sheet, rootSelector + \" a\", s);\n\tinsertCSSRule(sheet, rootSelector + \" .color-ln\", s);\n\n\t// .color-fg05\n\t// - - - - - - - - - - - - - - - -\n\ts = {};\n\ts[\"color\"] = fgColor.clone().mix(bgColor, 0.5).rgbString();\n\ts[\"border-color\"] = fgColor.clone().mix(bgColor, 0.7).rgbString();\n\tinsertCSSRule(sheet, rootSelector + \" .color-fg05\", s);\n\n\tfgColorVal = fgColor.rgbString();\n\tbgColorVal = bgColor.rgbString();\n\t// revFgColorVal = bgColor.clone().mix(fgColor, 0.9).rgbString();\n\t// revBgColorVal = fgColor.clone().mix(bgColor, 0.6).rgbString();\n\trevSelector = rootSelector + \" .color-reverse\";\n\n\t// .color-fg .color-bg\n\t// - - - - - - - - - - - - - - - -\n\ts = {\n\t\t\"color\": fgColorVal\n\t};\n\tinsertCSSRule(sheet, rootSelector + \" .color-fg\", s);\n\ts = {\n\t\t\"background-color\": bgColorVal\n\t};\n\tinsertCSSRule(sheet, rootSelector + \" .color-bg\", s);\n\t// html inverted text/background\n\ts = {\n\t\t\"color\": bgColorVal\n\t}; // s = { \"color\" : revFgColorVal };\n\t// s[\"-webkit-font-smoothing\"] = (hasDarkBg ? \"auto\" : \"antialiased\");\n\t// insertCSSRule(sheet, revSelector + \" .color-fg\", s);\n\t// insertCSSRule(sheet, revSelector + \".color-fg\", s);\n\tinsertCSSRule(sheet, selfAndDescendant(revSelector, \".color-fg\"), s);\n\n\ts = {\n\t\t\"background-color\": fgColorVal\n\t};\n\t// s = { \"background-color\" : revBgColorVal };\n\t// insertCSSRule(sheet, revSelector + \" .color-bg\", s);\n\t// insertCSSRule(sheet, revSelector + \".color-bg\", s);\n\tinsertCSSRule(sheet, selfAndDescendant(revSelector, \".color-bg\"), s);\n\n\t// .color-stroke .color-fill (SVG)\n\t// - - - - - - - - - - - - - - - -\n\ts = {\n\t\t\"stroke\": fgColorVal\n\t};\n\tinsertCSSRule(sheet, rootSelector + \" .color-stroke\", s);\n\ts = {\n\t\t\"fill\": bgColorVal\n\t};\n\tinsertCSSRule(sheet, rootSelector + \" .color-fill\", s);\n\t// svg inverted fill/stroke\n\ts = {\n\t\t\"stroke\": bgColorVal\n\t};\n\t// insertCSSRule(sheet, revSelector + \" .color-stroke\", s);\n\t// insertCSSRule(sheet, revSelector + \".color-stroke\", s);\n\tinsertCSSRule(sheet, selfAndDescendant(revSelector, \".color-stroke\"), s);\n\ts = {\n\t\t\"fill\": fgColorVal\n\t};\n\t// insertCSSRule(sheet, revSelector + \" .color-fill\", s);\n\t// insertCSSRule(sheet, revSelector + \".color-fill\", s);\n\tinsertCSSRule(sheet, selfAndDescendant(revSelector, \".color-fill\"), s);\n\n\t// .text-outline\n\t// - - - - - - - - - - - - - - - -\n\t// s = {\n\t// \t\"text-shadow\": \"-1px -1px 0 \" + bgColorVal +\n\t// \t\t\", 1px -1px 0 \" + bgColorVal +\n\t// \t\t\", -1px 1px 0 \" + bgColorVal +\n\t// \t\t\", 1px 1px 0 \" + bgColorVal\n\t// };\n\t// insertCSSRule(sheet, rootSelector + \" :not(..collapsed-changing) .text-outline-bg\", s);\n\n}\n\n// - - - - - - - - - - - - - - - -\n// carousel styles\n// - - - - - - - - - - - - - - - -\n\nvar carouselStyles = [\"box-shadow\", \"border\", \"border-radius\"];\n\nfunction initCarouselStyles(sheet, carouselSelector, attrs, fgColor, bgColor, lnColor, hasDarkBg) {\n\tvar s = _.pick(attrs, carouselStyles); //, \"background-color\"]);\n\tinsertCSSRule(sheet, carouselSelector + \" .media-item .content\", s);\n\n\t// .media-item .color-bg09\n\t// - - - - - - - - - - - - - - - -\n\ts = {};\n\ts[\"background-color\"] = bgColor.clone().mix(fgColor, 0.95).rgbString();\n\t// s[\"background-color\"] = bgColor.clone()[hasDarkBg ? \"darken\" : \"lighten\"](0.045).rgbString();\n\t// s[\"background-color\"] = bgColor.clone()[hasDarkBg ? \"lighten\" : \"darken\"](0.03).rgbString();\n\tinsertCSSRule(sheet, carouselSelector + \" .media-item .color-bg09\", s);\n\n\t// .media-item .placeholder\n\t// - - - - - - - - - - - - - - - -\n\ts = {};\n\ts[\"-webkit-font-smoothing\"] = (hasDarkBg ? \"auto\" : \"antialiased\");\n\t// text color luminosity is inverse from body, apply oposite rendering mode\n\ts[\"color\"] = bgColor.rgbString();\n\t// s[\"color\"] = bgColor.clone()[hasDarkBg ? \"darken\" : \"lighten\"](0.045).rgbString();\n\ts[\"background-color\"] = bgColor.clone().mix(fgColor, 0.95).rgbString();\n\t// s[\"background-color\"] = bgColor.clone().mix(fgColor, 0.8).alpha(0.3).rgbaString();\n\t// s[\"background-color\"] = bgColor.clone()[hasDarkBg ? \"lighten\" : \"darken\"](0.03).rgbString();\n\t(\"border-radius\" in attrs) && (s[\"border-radius\"] = attrs[\"border-radius\"]);\n\tinsertCSSRule(sheet, carouselSelector + \" .media-item .placeholder\", s);\n\n\t// .empty-item A\n\t// - - - - - - - - - - - - - - - -\n\ts = {};\n\ts[\"text-decoration-color\"] = fgColor.clone().mix(bgColor, 0.3).rgbString();\n\tinsertCSSRule(sheet, carouselSelector + \" .empty-item A\", s);\n\t// // .color-gradient\n\t// // - - - - - - - - - - - - - - - -\n\t// s = {};\n\t// s[\"background-color\"] = \"transparent\";\n\t// s[\"background\"] = \"linear-gradient(to bottom, \" +\n\t// \t\tbgColor.clone().alpha(0.00).rgbaString() + \" 0%, \" +\n\t// \t\tbgColor.clone().alpha(0.11).rgbaString() + \" 100%)\";\n\t// insertCSSRule(sheet, rootSelector + \" .color-gradient\", s);\n\t// s = {};\n\t// s[\"background-color\"] = \"transparent\";\n\t// s[\"background\"] = \"linear-gradient(to bottom, \" +\n\t// \t\tfgColor.clone().alpha(0.00).rgbaString() + \" 0%, \" +\n\t// \t\tfgColor.clone().alpha(0.11).rgbaString() + \" 100%)\";\n\t// insertCSSRule(sheet, revSelector + \" .color-gradient\", s);\n\t// insertCSSRule(sheet, revSelector + \".color-gradient\", s);\n}\n\nmodule.exports = function() {\n\tvar attrs, fgColor, bgColor, lnColor, hasDarkBg;\n\n\tattrs = Globals.DEFAULT_COLORS;\n\tfgColor = new Color(Globals.DEFAULT_COLORS[\"color\"]);\n\tbgColor = new Color(Globals.DEFAULT_COLORS[\"background-color\"]);\n\tlnColor = new Color(Globals.DEFAULT_COLORS[\"link-color\"])\n\thasDarkBg = fgColor.luminosity() > bgColor.luminosity();\n\n\tvar colorStyles = document.createElement(\"style\");\n\tcolorStyles.id = \"colors\";\n\tcolorStyles.type = \"text/css\";\n\tdocument.head.appendChild(colorStyles);\n\t// var colorStyles = document.querySelector(\"link#folio\");\n\n\tinitRootStyles(colorStyles.sheet, \".app\",\n\t\tattrs, fgColor, bgColor, lnColor, hasDarkBg);\n\tinitCarouselStyles(colorStyles.sheet, \".carousel\",\n\t\tattrs, fgColor, bgColor, lnColor, hasDarkBg);\n\n\t// - - - - - - - - - - - - - - - -\n\t// per-bundle rules\n\t// - - - - - - - - - - - - - - - -\n\tbundles.each(function(bundle) {\n\t\tattrs = bundle.attrs(); //get(\"attrs\");\n\t\tfgColor = bundle.colors.fgColor;\n\t\tbgColor = bundle.colors.bgColor;\n\t\tlnColor = bundle.colors.lnColor;\n\t\thasDarkBg = bundle.colors.hasDarkBg;\n\n\t\tinitRootStyles(colorStyles.sheet,\n\t\t\t\".app.\" + bundle.get(\"domid\"),\n\t\t\tattrs, fgColor, bgColor, lnColor, hasDarkBg);\n\t\tinitCarouselStyles(colorStyles.sheet,\n\t\t\t\".carousel.\" + bundle.get(\"domid\"),\n\t\t\tattrs, fgColor, bgColor, lnColor, hasDarkBg);\n\t});\n};\n",
    "/*global XMLHttpRequest */\n\n// /** @type {module:underscore.string/lpad} */\n// var classify = require(\"underscore.string/classify\");\n\n// var statusMsg = _.template(\"<%= status %> received from <%= url %> (<%= statusText %>)\");\n// var errMsg = _.template(\"'<%= errName %>' ocurred during request <%= url %>\");\n\nif (window.XMLHttpRequest && window.URL && window.Blob) {\n\tmodule.exports = function(url, progressFn) {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tvar request = new XMLHttpRequest();\n\t\t\trequest.open(\"GET\", url, true);\n\t\t\t// request.timeout = 10000; // in milliseconds\n\t\t\trequest.responseType = \"blob\";\n\n\t\t\tvar errorFromEvent = function(ev) {\n\t\t\t\tvar err = new Error((ev.target.status > 0 ?\n\t\t\t\t\t\"http_\" + request.statusText.replace(/\\s/g, \"_\") :\n\t\t\t\t\tev.type + \"_event\").toUpperCase());\n\t\t\t\terr.infoCode = ev.target.status;\n\t\t\t\terr.infoSrc = url;\n\t\t\t\terr.logEvent = ev;\n\t\t\t\terr.logMessage = \"_loadImageAsObjectURL::\" + ev.type + \" [reject]\";\n\t\t\t\treturn err;\n\t\t\t};\n\n\t\t\t// if progressFn is supplied\n\t\t\t// - - - - - - - - - - - - - - - - - -\n\t\t\tif (progressFn) {\n\t\t\t\trequest.onprogress = function(ev) {\n\t\t\t\t\tprogressFn(ev.loaded / ev.total, request);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// resolved/success\n\t\t\t// - - - - - - - - - - - - - - - - - -\n\t\t\trequest.onload = function(ev) {\n\t\t\t\t// When the request loads, check whether it was successful\n\t\t\t\tif (request.status == 200) {\n\t\t\t\t\t// If successful, resolve the promise by passing back a reference url\n\t\t\t\t\tresolve(URL.createObjectURL(request.response));\n\t\t\t\t} else {\n\t\t\t\t\treject(errorFromEvent(ev));\n\t\t\t\t}\n\t\t\t};\n\t\t\t// normal abort\n\t\t\t// - - - - - - - - - - - - - - - - - -\n\t\t\trequest.onabort = function(ev) {\n\t\t\t\tresolve(void 0);\n\t\t\t};\n\t\t\t// reject/failure\n\t\t\t// - - - - - - - - - - - - - - - - - -\n\t\t\trequest.onerror = function(ev) {\n\t\t\t\treject(errorFromEvent(ev));\n\t\t\t};\n\t\t\trequest.ontimeout = request.onerror;\n\n\t\t\t// finally\n\t\t\t// - - - - - - - - - - - - - - - - - -\n\t\t\trequest.onloadend = function(ev) {\n\t\t\t\t//console.log(\"_loadImageAsObjectURL::%s [cleanup] (%s)\", ev ? ev.type : \"no event\", url);\n\t\t\t\trequest.onabort = request.ontimeout = request.onerror = void 0;\n\t\t\t\trequest.onload = request.onloadend = void 0;\n\t\t\t\tif (progressFn) {\n\t\t\t\t\trequest.onprogress = void 0;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\trequest.send();\n\t\t});\n\t};\n} else {\n\tmodule.exports = function(url, progressFn) {\n\t\treturn Promise.resolve(url);\n\t};\n}\n",
    "module.exports = function(image, resolveEmpty) {\n\treturn new Promise(function(resolve, reject) {\n\t\tif (!(image instanceof window.HTMLImageElement)) {\n\t\t\t//reject(new Error(\"not an HTMLImageElement\"));\n\t\t\treject(\"Error: not an HTMLImageElement\");\n\t\t} else if (image.complete && (image.src.length > 0 || resolveEmpty)) {\n\t\t\t// if (image.src === \"\") console.warn(\"_whenImageLoads resolved with empty src\");\n\t\t\t// else console.log(\"_whenImageLoads resolve-sync\", image.src);\n\t\t\tresolve(image);\n\t\t} else {\n\t\t\tvar handlers = {\n\t\t\t\tload: function(ev) {\n\t\t\t\t\t// console.log(\"_whenImageLoads_dom resolve-async\", ev.type, image.src);\n\t\t\t\t\tremoveEventListeners();\n\t\t\t\t\tresolve(image);\n\t\t\t\t},\n\t\t\t\terror: function(ev) {\n\t\t\t\t\tvar err = new Error(\"Loading failed (\" + ev.type + \" event)\");\n\t\t\t\t\terr.infoCode = -1;\n\t\t\t\t\terr.infoSrc = image.src;\n\t\t\t\t\terr.logEvent = ev;\n\t\t\t\t\terr.logMessage = \"_whenImageLoads::\" + ev.type + \" [reject]\";\n\t\t\t\t\tremoveEventListeners();\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t};\n\t\t\thandlers.abort = handlers.error;\n\t\t\tvar removeEventListeners = function() {\n\t\t\t\tfor (var event in handlers) {\n\t\t\t\t\tif (handlers.hasOwnProperty(event)) {\n\t\t\t\t\t\timage.removeEventListener(event, handlers[event], false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tfor (var event in handlers) {\n\t\t\t\tif (handlers.hasOwnProperty(event)) {\n\t\t\t\t\timage.addEventListener(event, handlers[event], false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};\n",
    "/** @type {module:app/view/promise/_whenImageLoads} */\nvar _whenImageLoads = require(\"app/view/promise/_whenImageLoads\");\n/** @type {module:app/view/promise/_loadImageAsObjectURL} */\nvar _loadImageAsObjectURL = require(\"app/view/promise/_loadImageAsObjectURL\");\n\n// var isBlobRE = /^blob\\:.*/;\n\n// var logMessage = \"%s::whenDefaultImageLoads [%s]: %s\";\n\nmodule.exports = function(view) {\n\treturn new Promise(function(resolve, reject) {\n\t\tvar source = view.model.get(\"source\");\n\t\tif (source.has(\"prefetched\")) {\n\t\t\tview.defaultImage.src = source.get(\"prefetched\");\n\t\t\t_whenImageLoads(view.defaultImage)\n\t\t\t\t.then(\n\t\t\t\t\tfunction(targetEl) {\n\t\t\t\t\t\t// console.log(logMessage, view.cid, \"resolved\", \"prefetched\");\n\t\t\t\t\t\tresolve(view);\n\t\t\t\t\t});\n\t\t} else {\n\t\t\tview.mediaState = \"pending\";\n\n\t\t\tvar sUrl = source.get(\"original\");\n\t\t\tvar progressFn = function(progress, ev) {\n\t\t\t\t// console.log(logMessage, view.cid, \"progress\", progress);\n\t\t\t\tview.updateMediaProgress(progress, sUrl);\n\t\t\t};\n\t\t\tprogressFn = _.throttle(progressFn, 100, {\n\t\t\t\tleading: true,\n\t\t\t\ttrailing: false\n\t\t\t});\n\t\t\t_loadImageAsObjectURL(sUrl, progressFn)\n\t\t\t\t.then(\n\t\t\t\t\tfunction(url) {\n\t\t\t\t\t\tif (/^blob\\:.*/.test(url)) {\n\t\t\t\t\t\t\tsource.set(\"prefetched\", url);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tview.defaultImage.src = url;\n\t\t\t\t\t\t// URL.revokeObjectURL(url);\n\t\t\t\t\t\treturn view.defaultImage;\n\t\t\t\t\t})\n\t\t\t\t.then(_whenImageLoads)\n\t\t\t\t.then(\n\t\t\t\t\tfunction(targetEl) {\n\t\t\t\t\t\t// console.log(logMessage, view.cid, \"resolved\", targetEl.src);\n\t\t\t\t\t\tview.on(\"view:removed\", function() {\n\t\t\t\t\t\t\tvar prefetched = source.get(\"prefetched\");\n\t\t\t\t\t\t\tif (prefetched && /^blob\\:/.test(prefetched)) {\n\t\t\t\t\t\t\t\tsource.unset(\"prefetched\", {\n\t\t\t\t\t\t\t\t\tsilent: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tURL.revokeObjectURL(prefetched);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// view.placeholder.removeAttribute(\"data-progress\");\n\t\t\t\t\t\t// view.updateMediaProgress(imageUrl, \"complete\");\n\t\t\t\t\t\tresolve(view);\n\t\t\t\t\t},\n\t\t\t\t\t// \t})\n\t\t\t\t\t// .catch(\n\t\t\t\t\tfunction(err) {\n\t\t\t\t\t\t// console.warn(logMessage, view.cid, \"rejected\", err.message);\n\t\t\t\t\t\t// view.placeholder.removeAttribute(\"data-progress\");\n\t\t\t\t\t\t// view.updateMediaProgress(imageUrl, progress);\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t});\n\t\t}\n\t});\n};\n",
    "/* global Promise */\n/** @type {module:app/view/base/ViewError} */\nvar ViewError = require(\"app/view/base/ViewError\");\n\n/** @type {module:app/view/base/ViewError} */\nvar whenViewIsAttached = require(\"app/view/promise/whenViewIsAttached\");\n\nfunction whenScrollingEnds(view) {\n\treturn new Promise(function(resolve, reject) {\n\t\tvar parent = view.parentView;\n\t\tif (parent === null) {\n\t\t\tconsole.error(\"%s::whenScrollingEnds [%s] (sync)\", view.cid, \"rejected\", view.attached);\n\t\t\treject(new ViewError(view, new Error(\"whenScrollingEnds: view has no parent\")));\n\t\t} else if (!parent.scrolling) {\n\t\t\t// console.log(\"%s::whenScrollingEnds [%s] (sync)\", view.cid, \"resolved\", view.attached);\n\t\t\tresolve(view);\n\t\t} else {\n\t\t\tvar cleanup = function() {\n\t\t\t\tparent.off(\"view:scrollend\", onScrollend);\n\t\t\t\tparent.off(\"view:remove\", onRemove);\n\t\t\t};\n\t\t\tvar onScrollend = function() {\n\t\t\t\t// console.log(\"%s::whenScrollingEnds [%s]\", view.cid, \"resolved\", view.attached);\n\t\t\t\tcleanup();\n\t\t\t\tresolve(view);\n\t\t\t};\n\t\t\tvar onRemove = function() {\n\t\t\t\t// console.log(\"%s::whenScrollingEnds [%s]\", view.cid, \"rejected\", view.attached);\n\t\t\t\tcleanup();\n\t\t\t\treject(new ViewError(view, new Error(\"whenScrollingEnds: view was removed\")));\n\t\t\t};\n\t\t\tparent.on(\"view:scrollend\", onScrollend);\n\t\t\tparent.on(\"view:remove\", onRemove);\n\t\t}\n\t});\n}\n\nmodule.exports = function(view) {\n\treturn Promise.resolve(view)\n\t\t.then(whenViewIsAttached)\n\t\t.then(whenScrollingEnds);\n};\n\n/*\nmodule.exports = function(view) {\n\treturn Promise.resolve(view)\n\t\t.then(function(view) {\n\t\t\tif (view.attached) {\n\t\t\t\treturn view;\n\t\t\t} else {\n\t\t\t\treturn new Promise(function(resolve, reject) {\n\t\t\t\t\tview.once(\"view:attached\", function(view) {\n\t\t\t\t\t\tresolve(view);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\t\t.then(function(view) {\n\t\t\tif (!view.parentView.scrolling) {\n\t\t\t\treturn view;\n\t\t\t} else {\n\t\t\t\treturn new Promise(function(resolve, reject) {\n\t\t\t\t\tvar resolveOnScrollend = function() {\n\t\t\t\t\t\t// console.log(\"%s::whenScrollingEnds [%s]\", view.cid, \"resolved\");\n\t\t\t\t\t\tview.off(\"view:remove\", rejectOnRemove);\n\t\t\t\t\t\tresolve(view);\n\t\t\t\t\t};\n\t\t\t\t\tvar rejectOnRemove = function(view) {\n\t\t\t\t\t\t// console.log(\"%s::whenScrollingEnds [%s]\", view.cid, \"rejected\");\n\t\t\t\t\t\tview.parentView.off(\"view:scrollend\", resolveOnScrollend);\n\t\t\t\t\t\treject(new ViewError(view,\n\t\t\t\t\t\t\tnew Error(\"whenSelectScrollingEnds: view was removed (\"+ view.cid +\")\")));\n\t\t\t\t\t};\n\t\t\t\t\tview.parentView.once(\"view:scrollend\", resolveOnScrollend);\n\t\t\t\t\tview.once(\"view:remove\", rejectOnRemove);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n};\n*/\n",
    "/** @type {module:app/view/base/ViewError} */\nvar ViewError = require(\"app/view/base/ViewError\");\n\n// var logMessage = \"%s::whenSelectionDistanceIs [%s]: %s\";\n\n/**\n * @param {module:app/view/base/View}\n * @param {number} distance\n */\nmodule.exports = function(view, distance) {\n\treturn new Promise(function(resolve, reject) {\n\t\t// if (!(view.model && view.model.collection)) {\n\t\t// \treject(new ViewError(view, new Error(\"whenSelectionIsContiguous: model.collection is empty\")));\n\t\t// }\n\t\tvar model = view.model;\n\t\tvar collection = model.collection;\n\n\t\tvar check = function(n) { // Check indices for contiguity\n\t\t\treturn Math.abs(collection.indexOf(model) - collection.selectedIndex) <= distance;\n\t\t};\n\n\t\tif (check()) {\n\t\t\t// console.log(logMessage, view.cid, \"resolve\", \"sync\");\n\t\t\tresolve(view);\n\t\t} else {\n\t\t\tvar cleanupOnSettle = function() {\n\t\t\t\t// console.log(logMessage, view.cid, \"cleanup\", \"async\");\n\t\t\t\tcollection.off(\"select:one select:none\", resolveOnSelect);\n\t\t\t\tview.off(\"view:removed\", rejectOnRemove);\n\t\t\t};\n\t\t\tvar resolveOnSelect = function(model) {\n\t\t\t\tif (check()) {\n\t\t\t\t\t// console.log(logMessage, view.cid, \"resolve\", \"async\");\n\t\t\t\t\tcleanupOnSettle();\n\t\t\t\t\tresolve(view);\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar rejectOnRemove = function(view) {\n\t\t\t\tcleanupOnSettle();\n\t\t\t\treject(new ViewError(view, new Error(\"whenSelectionDistanceIs: view was removed\")));\n\t\t\t};\n\t\t\tcollection.on(\"select:one select:none\", resolveOnSelect);\n\t\t\tview.on(\"view:removed\", rejectOnRemove);\n\t\t}\n\t});\n};\n",
    "// /** @type {module:app/view/base/ViewError} */\n// var ViewError = require(\"app/view/base/ViewError\");\n\n/** @type {module:app/view/promise/whenSelectionDistanceIs} */\nvar whenSelectionDistanceIs = require(\"app/view/promise/whenSelectionDistanceIs\");\n\n/** @param {module:app/view/base/View} */\nmodule.exports = function(view) {\n\treturn whenSelectionDistanceIs(view, 1);\n};\n",
    "module.exports = function(view) {\n\treturn new Promise(function(resolve, reject) {\n\t\tif (view.attached) {\n\t\t\tresolve(view);\n\t\t} else {\n\t\t\tview.on(\"view:attached\", function(view) {\n\t\t\t\tresolve(view);\n\t\t\t});\n\t\t}\n\t});\n};\n",
    "module.exports = function(view) {\n\treturn new Promise(function(resolve, reject) {\n\t\tif (!view.invalidated) {\n\t\t\tresolve(view);\n\t\t} else {\n\t\t\tview.once(\"view:render:after\", function(view, flags) {\n\t\t\t\tresolve(view);\n\t\t\t});\n\t\t}\n\t});\n};\n",
    "/**\n * @module app/view/render/CarouselRenderer\n */\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n\n/** @type {module:underscore} */\nvar getBoxEdgeStyles = require(\"utils/css/getBoxEdgeStyles\");\n\n// FIXME: this fixup should not be done here\n// /** @type {module:utils/net/toAbsoluteURL} */\n// var toAbsoluteURL = require(\"utils/net/toAbsoluteURL\");\n// /** @type {string} */\n// var ABS_APP_ROOT = toAbsoluteURL(require(\"app/control/Globals\").APP_ROOT);\n\n/**\n * @constructor\n * @type {module:app/view/render/CarouselRenderer}\n */\nvar CarouselRenderer = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"carouselRenderer\",\n\t/** @override */\n\ttagName: \"div\",\n\t/** @override */\n\tclassName: \"carousel-item\",\n\t/** @override */\n\ttemplate: _.template(\"<div class=\\\"content sizing\\\"><%= name %></div>\"),\n\n\tproperties: {\n\t\tcontent: {\n\t\t\tget: function() {\n\t\t\t\treturn this._content || (this._content = this.el.querySelector(\".content\"));\n\t\t\t},\n\t\t},\n\t\tsizing: {\n\t\t\tget: function() {\n\t\t\t\treturn this._sizing || (this._sizing = this.el.querySelector(\".sizing\"));\n\t\t\t},\n\t\t}\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tif (this.model.attr(\"@classname\") !== void 0) {\n\t\t\tvar clsAttr = this.model.attr(\"@classname\").split(\" \");\n\t\t\tfor (var i = 0; i < clsAttr.length; i++) {\n\t\t\t\tthis.el.classList.add(clsAttr[i]);\n\t\t\t}\n\t\t}\n\t\toptions.parentView && (this.parentView = options.parentView);\n\t\tthis.metrics = {};\n\t\tthis.metrics.content = {};\n\t\tthis.createChildren();\n\t\t// this.enabled = !!options.enabled; // force bool\n\t\tthis.setEnabled(!!options.enabled);\n\t},\n\n\tcreateChildren: function() {\n\t\tthis.el.innerHTML = this.template(this.model.toJSON());\n\t\t// FIXME: this fixup should not be done here\n\t\t// FIXED: now done in xslt\n\t\t/*this.el.querySelectorAll(\"a[href]\").forEach(function(el) {\n\t\t\tvar url = toAbsoluteURL(el.getAttribute(\"href\"));\n\t\t\tif (url.indexOf(ABS_APP_ROOT) !== 0) {\n\t\t\t\tel.setAttribute(\"target\", \"_blank\");\n\t\t\t}\n\t\t});*/\n\t},\n\n\t/** @return {HTMLElement} */\n\tgetSizingEl: function() {\n\t\treturn this._sizing || (this._sizing = this.el.querySelector(\".sizing\"));\n\t},\n\n\t/** @return {HTMLElement} */\n\tgetContentEl: function() {\n\t\treturn this._content || (this._content = this.el.querySelector(\".content\"));\n\t},\n\n\t/** @return {this} */\n\tmeasure: function() {\n\t\tvar sizing = this.getSizingEl();\n\n\t\tthis.metrics = getBoxEdgeStyles(this.el, this.metrics);\n\t\tthis.metrics.content = getBoxEdgeStyles(this.getContentEl(), this.metrics.content);\n\n\t\tsizing.style.maxWidth = \"\";\n\t\tsizing.style.maxHeight = \"\";\n\n\t\tthis.metrics.content.x = sizing.offsetLeft + sizing.clientLeft;\n\t\tthis.metrics.content.y = sizing.offsetTop + sizing.clientTop;\n\t\tthis.metrics.content.width = sizing.clientWidth;\n\t\tthis.metrics.content.height = sizing.clientHeight;\n\n\t\treturn this;\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tthis.measure();\n\t\treturn this;\n\t},\n\n\tgetSelectionDistance: function() {\n\t\treturn Math.abs(this.model.collection.indexOf(this.model) - this.model.collection.selectedIndex);\n\t},\n});\n\nmodule.exports = CarouselRenderer;\n",
    "/**\n * @module app/view/render/ClickableRenderer\n */\n\n/** @type {module:app/view/render/LabelRenderer} */\nvar LabelRenderer = require(\"app/view/render/LabelRenderer\");\n\n/**\n * @constructor\n * @type {module:app/view/render/ClickableRenderer}\n */\nvar ClickableRenderer = LabelRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"clickableRenderer\",\n\n\t// defaults: {\n\t// \ttarget: \".label\"\n\t// },\n\n\t/** @override */\n\tevents: {\n\t\t\"click .label\": function(ev) {\n\t\t\tif (ev.defaultPrevented) return;\n\n\t\t\tev.preventDefault();\n\t\t\tthis.trigger(\"renderer:click\", this.model, ev);\n\t\t},\n\t\t\"click a\": function(ev) {\n\t\t\tev.defaultPrevented || ev.preventDefault();\n\t\t}\n\t},\n\n\t// initialize: function(options) {\n\t// \toptions || (options = {});\n\t// \t// if (options) {\n\t// \toptions = _.defaults({}, options, _.result(this, 'defaults'));\n\t// \t// } else {\n\t// \t// \t _.defaults({}, _.result(this, 'defaults'));\n\t// \t// }\n\t// \tthis.events[\"click \" + options.target] = this.clickHandler;\n\t// },\n\t//\n\t// clickHandler: function(ev) {\n\t// \tif (ev.defaultPrevented) return;\n\t//\n\t// \tev.preventDefault();\n\t// \tthis.trigger(\"renderer:click\", this.model, ev);\n\t// }\n});\n\nmodule.exports = ClickableRenderer;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=helpers.helperMissing, alias3=\"function\";\n\n  return \"<a href=\\\"#\"\n    + container.escapeExpression(((helper = (helper = helpers.domid || (depth0 != null ? depth0.domid : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"domid\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\"><span class=\\\"label\\\">\"\n    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper))) != null ? stack1 : \"\")\n    + \"</span></a>\";\n},\"useData\":true});\n",
    "/**\n * @module app/view/render/DefaultSelectableRenderer\n */\n\n/** @type {module:app/view/component/ClickableRenderer} */\nvar ClickableRenderer = require(\"app/view/render/ClickableRenderer\");\n\n/**\n * @constructor\n * @type {module:app/view/render/DefaultSelectableRenderer}\n */\nvar DefaultSelectableRenderer = ClickableRenderer.extend({\n\n\t/** @override */\n\ttagName: \"li\",\n\t/** @override */\n\tclassName: \"list-item\",\n\t/** @override */\n\ttemplate: require(\"./DefaultSelectableRenderer.hbs\"),\n\n\tinitialize: function(options) {\n\t\tthis.listenTo(this.model, \"selected deselected\", this._renderClassList);\n\t\tthis._renderClassList();\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tthis.el.innerHTML = this.template(this.model.toJSON());\n\t\tthis._renderClassList();\n\t\treturn this;\n\t},\n\n\t_renderClassList: function() {\n\t\tthis.el.classList.toggle(\"selected\", this.model.selected);\n\t},\n});\n\nmodule.exports = DefaultSelectableRenderer;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=helpers.helperMissing, alias3=\"function\", alias4=container.escapeExpression;\n\n  return \"<span class=\\\"label\\\">\"\n    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</span><a href=\\\"#\"\n    + alias4(((helper = (helper = helpers.domid || (depth0 != null ? depth0.domid : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"domid\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\"><b> </b></a>\";\n},\"useData\":true});\n",
    "/**\n * @module app/view/render/DotNavigationRenderer\n */\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n\n// /** @type {module:app/view/component/ClickableRenderer} */\n// var ClickableRenderer = require(\"app/view/render/LabelRenderer\");\n/** @type {string} */\nvar viewTemplate = require(\"./DotNavigationRenderer.hbs\");\n\n/**\n * @constructor\n * @type {module:app/view/render/DotNavigationRenderer}\n */\nvar DotNavigationRenderer = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"dotRenderer\",\n\t/** @override */\n\ttagName: \"li\",\n\t/** @override */\n\tclassName: \"list-item\",\n\t/** @override */\n\ttemplate: viewTemplate,\n\n\t/** @override */\n\tevents: {\n\t\t\"click\": function(ev) {\n\t\t\tif (ev.defaultPrevented) return;\n\n\t\t\tev.preventDefault();\n\t\t\tthis.trigger(\"renderer:click\", this.model, ev);\n\t\t},\n\t\t\"click a\": function(ev) {\n\t\t\tev.defaultPrevented || ev.preventDefault();\n\t\t}\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tthis.listenTo(this.model, \"selected deselected\", this.renderClassList);\n\t\tthis.renderClassList();\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tthis.el.innerHTML = this.template(this.model.toJSON());\n\t\tthis.renderClassList();\n\t\treturn this;\n\t},\n\n\trenderClassList: function() {\n\t\tthis.el.classList.toggle(\"selected\", this.model.selected);\n\t},\n});\n\nmodule.exports = DotNavigationRenderer;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=helpers.helperMissing, alias3=\"function\", alias4=container.escapeExpression;\n\n  return \"<div class=\\\"placeholder sizing\\\"></div>\\n<img class=\\\"content media-border default\\\" alt=\\\"\"\n    + alias4(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"text\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" longdesc=\\\"#desc_m\"\n    + alias4(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"id\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" />\\n\";\n},\"useData\":true});\n",
    "/**\n * @module app/view/render/ImageRenderer\n */\n\n/** @type {module:app/view/MediaRenderer} */\nvar MediaRenderer = require(\"./MediaRenderer\");\n\n/** @type {Function} */\nvar viewTemplate = require(\"./ImageRenderer.hbs\");\n\n/**\n * @constructor\n * @type {module:app/view/render/ImageRenderer}\n */\nvar ImageRenderer = MediaRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"imageRenderer\",\n\t/** @type {string} */\n\tclassName: MediaRenderer.prototype.className + \" image-item\",\n\t/** @type {Function} */\n\ttemplate: viewTemplate,\n\n\t/** @override */\n\tinitialize: function(opts) {\n\t\tMediaRenderer.prototype.initialize.apply(this, arguments);\n\t\t// this.createChildren();\n\t\t// this.initializeAsync();\n\t},\n\n\t/* --------------------------- *\n\t/* children/layout\n\t/* --------------------------- */\n\n\t/** @override */\n\tcreateChildren: function() {\n\t\tMediaRenderer.prototype.createChildren.apply(this, arguments);\n\t\t// this.el.innerHTML = this.template(this.model.toJSON());\n\t\tthis.placeholder = this.el.querySelector(\".placeholder\");\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tMediaRenderer.prototype.render.apply(this, arguments);\n\n\t\t// this.measure();\n\n\t\tvar img = this.getDefaultImage();\n\t\timg.setAttribute(\"width\", this.metrics.media.width);\n\t\timg.setAttribute(\"height\", this.metrics.media.height);\n\n\t\tvar content = this.getContentEl();\n\t\tcontent.style.left = this.metrics.content.x + \"px\";\n\t\tcontent.style.top = this.metrics.content.y + \"px\";\n\n\t\t// var sizing = this.getSizingEl();\n\t\t// sizing.style.maxWidth = this.metrics.content.width + \"px\";\n\t\t// sizing.style.maxHeight = this.metrics.content.height + \"px\";\n\n\t\treturn this;\n\t},\n\n\t/* --------------------------- *\n\t/* initializeAsync\n\t/* --------------------------- */\n\n\tinitializeAsync: function() {\n\t\treturn MediaRenderer.prototype.initializeAsync.apply(this, arguments)\n\t\t// return MediaRenderer.whenSelectionIsContiguous(this)\n\t\t// // return Promise.resolve(this)\n\t\t// // \t.then(MediaRenderer.whenSelectionIsContiguous)\n\t\t// \t.then(MediaRenderer.whenSelectTransitionEnds)\n\t\t// \t.then(MediaRenderer.whenDefaultImageLoads)\n\t\t// .then(\n\t\t// \tfunction(view) {\n\t\t// \t\tview.mediaState = \"ready\";\n\t\t// \t})\n\t\t// .catch(\n\t\t// \tfunction(err) {\n\t\t// \t\tif (err instanceof ViewError) {\n\t\t// \t\t\t// NOTE: ignore ViewError type\n\t\t// \t\t\t// console.log(err.view.cid, err.view.model.cid, \"ImageRenderer: \" + err.message);\n\t\t// \t\t} else {\n\t\t// \t\t\tconsole.error(this.cid, err.name, err);\n\t\t// \t\t\tthis.placeholder.innerHTML = \"<p class=\\\"color-fg\\\" style=\\\"position:absolute;bottom:0;padding:3rem;\\\"><strong>\" + err.name + \"</strong> \" + err.message + \"</p>\";\n\t\t// \t\t\tthis.mediaState = \"error\";\n\t\t// \t\t}\n\t\t// \t}.bind(this))\n\t\t;\n\t},\n});\n\nmodule.exports = ImageRenderer;\n",
    "/**\n * @module app/view/render/LabelRenderer\n */\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n\n/**\n * @constructor\n * @type {module:app/view/render/LabelRenderer}\n */\nvar LabelRenderer = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"labelRenderer\",\n\n\tproperties: {\n\t\tlabel: {\n\t\t\tget: function() {\n\t\t\t\treturn this._label || (this._label = this.el.querySelector(\".label\"));\n\t\t\t}\n\t\t}\n\t\t// measuredWidth: {\n\t\t// \tget: function() {\n\t\t// \t\treturn this._measuredWidth;\n\t\t// \t}\n\t\t// },\n\t\t// measuredHeight: {\n\t\t// \tget: function() {\n\t\t// \t\treturn this._measuredHeight;\n\t\t// \t}\n\t\t// },\n\t},\n\n\t/* -------------------------------\n\t/* measure\n\t/* ------------------------------- */\n\n\t// _measuredWidth: null,\n\t// _measuredHeight: null,\n\t// measure: function() {},\n});\n\nmodule.exports = LabelRenderer;\n",
    "/*global XMLHttpRequest, HTMLMediaElement, MediaError*/\n/**\n * @module app/view/render/MediaRenderer\n */\n\n/** @type {module:underscore.strings/lpad} */\nvar lpad = require(\"underscore.string/lpad\");\n\n/** @type {module:app/model/item/MediaItem} */\nvar MediaItem = require(\"app/model/item/MediaItem\");\n/** @type {module:app/view/CarouselRenderer} */\nvar CarouselRenderer = require(\"app/view/render/CarouselRenderer\");\n\n// var errorTemplate = require(\"../template/ErrorBlock.hbs\");\n// /** @type {module:utils/css/getBoxEdgeStyles} */\n// var getBoxEdgeStyles = require(\"utils/css/getBoxEdgeStyles\");\n\nvar MediaRenderer = CarouselRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"mediaRenderer\",\n\t/** @type {string} */\n\tclassName: CarouselRenderer.prototype.className + \" media-item\",\n\t/** @type {module:app/model/MediaItem} */\n\tmodel: MediaItem,\n\n\tproperties: {\n\t\tdefaultImage: {\n\t\t\tget: function() {\n\t\t\t\treturn this._defaultImage || (this._defaultImage = this.el.querySelector(\"img.default\"));\n\t\t\t}\n\t\t},\n\t\tmediaState: {\n\t\t\tget: function() {\n\t\t\t\treturn this._mediaState;\n\t\t\t},\n\t\t\tset: function(state) {\n\t\t\t\tthis._setMediaState(state);\n\t\t\t}\n\t\t}\n\t},\n\n\t/** @override */\n\tinitialize: function(opts) {\n\t\t// if (this.model.attrs().hasOwnProperty(\"@classname\")) {\n\t\t// \tthis.el.className += \" \" + this.model.attr(\"@classname\");\n\t\t// }\n\n\t\t// NOTE: @classname attr handling moved to CarouselRenderer\n\t\t// if (this.model.attr(\"@classname\") !== void 0) {\n\t\t// \tvar clsAttr = this.model.attr(\"@classname\").split(\" \");\n\t\t// \tfor (var i = 0; i < clsAttr.length; i++) {\n\t\t// \t\tthis.el.classList.add(clsAttr[i]);\n\t\t// \t}\n\t\t// }\n\t\tCarouselRenderer.prototype.initialize.apply(this, arguments);\n\n\t\tthis.metrics.media = {};\n\t\tthis.mediaState = \"idle\";\n\n\t\tthis.initializeAsync()\n\t\t\t.then(this.whenInitialized)\n\t\t\t.catch(this.whenInitializeError.bind(this));\n\t},\n\n\tinitializeAsync: function() {\n\t\t// var MediaRenderer = Object.getPrototypeOf(this).constructor;\n\t\treturn Promise.resolve(this)\n\t\t\t.then(MediaRenderer.whenSelectionIsContiguous)\n\t\t\t.then(MediaRenderer.whenScrollingEnds)\n\t\t\t.then(MediaRenderer.whenDefaultImageLoads);\n\t},\n\n\twhenInitialized: function(view) {\n\t\t// console.log(\"%s::whenInitialized [%s]\", view.cid, \"resolved\");\n\t\tview.mediaState = \"ready\";\n\t\tview.placeholder.removeAttribute(\"data-progress\");\n\t\treturn view;\n\t},\n\n\twhenInitializeError: function(err) {\n\t\tif (err instanceof CarouselRenderer.ViewError) {\n\t\t\t// NOTE: ignore ViewError type\n\t\t\treturn;\n\t\t} else if (err instanceof Error) {\n\t\t\tconsole.error(err.stack);\n\t\t}\n\t\tthis.placeholder.removeAttribute(\"data-progress\");\n\t\tthis.mediaState = \"error\";\n\t},\n\n\tupdateMediaProgress: function(progress, id) {\n\t\tif (_.isNumber(progress)) {\n\t\t\tthis.placeholder.setAttribute(\"data-progress\", lpad(Math.floor(progress * 100), 2, '0'));\n\t\t}\n\t\t// else if (progress === \"complete\") {\n\t\t// \tthis.placeholder.removeAttribute(\"data-progress\");\n\t\t// }\n\t},\n\n\t// whenMediaIsReady: function(view) {\n\t// \treturn MediaRenderer.whenDefaultImageLoads(this, this.updateMediaProgress.bind(this));\n\t// },\n\n\t/* --------------------------- *\n\t/* child getters\n\t/* --------------------------- */\n\n\t/** @return {HTMLElement} */\n\tgetDefaultImage: function() {\n\t\treturn this.defaultImage;\n\t},\n\n\t/* --------------------------- *\n\t/* children/layout\n\t/* --------------------------- */\n\n\tcreateChildren: function() {\n\t\tthis.el.innerHTML = this.template(this.model.toJSON());\n\t},\n\n\t/** @override */\n\tmeasure: function() {\n\t\tCarouselRenderer.prototype.measure.apply(this, arguments);\n\n\t\tvar sw, sh; // source dimensions\n\t\tvar pcw, pch; // measured values\n\t\tvar cx, cy, cw, ch, cs; // computed values\n\t\tvar ew, eh; // content edge totals\n\t\tvar cm; // content metrics\n\n\t\tcm = this.metrics.content;\n\t\tcx = cm.x;\n\t\tcy = cm.y;\n\t\tpcw = cm.width;\n\t\tpch = cm.height;\n\n\t\tew = (cm.paddingLeft + cm.paddingRight + cm.borderLeftWidth + cm.borderRightWidth);\n\t\teh = (cm.paddingTop + cm.paddingBottom + cm.borderTopWidth + cm.borderBottomWidth);\n\t\tpcw -= ew;\n\t\tpch -= eh;\n\n\t\tsw = this.model.get(\"source\").get(\"w\");\n\t\tsh = this.model.get(\"source\").get(\"h\");\n\n\t\t// Unless both client dimensions are larger than the source's\n\t\t// choose constraint direction by aspect ratio\n\t\tif (sw < pcw && sh < pch) {\n\t\t\tcs = 1;\n\t\t\tcw = sw;\n\t\t\tch = sh;\n\t\t\tthis.metrics.fitDirection = \"both\";\n\t\t} else if ((pcw / pch) < (sw / sh)) {\n\t\t\t// fit width\n\t\t\tcw = pcw;\n\t\t\tcs = cw / sw;\n\t\t\t// ch = cs * sh;\n\t\t\tch = Math.round(cs * sh);\n\t\t\tthis.metrics.fitDirection = \"width\";\n\t\t} else {\n\t\t\t// fit height\n\t\t\tch = pch;\n\t\t\tcs = ch / sh;\n\t\t\t// cw = cs * sw;\n\t\t\tcw = Math.round(cs * sw);\n\t\t\tthis.metrics.fitDirection = \"height\";\n\t\t}\n\n\t\tthis.metrics.content.x = cx;\n\t\tthis.metrics.content.y = cy;\n\t\tthis.metrics.content.width = cw + ew;\n\t\tthis.metrics.content.height = ch + eh;\n\n\t\tthis.metrics.media.x = cx + cm.paddingLeft + cm.borderLeftWidth;\n\t\tthis.metrics.media.y = cy + cm.paddingTop + cm.borderTopWidth;\n\t\tthis.metrics.media.width = cw;\n\t\tthis.metrics.media.height = ch;\n\t\tthis.metrics.media.scale = cs;\n\n\t\t// console.log(\"%s::measure mw:%s mh:%s fit: %s metrics: %o\", this.cid, pcw, pch, this.metrics.fitDirection, this.metrics);\n\t\t// var sizing = this.getSizingEl();\n\t\t// sizing.style.maxWidth = (cw + ew) + \"px\";\n\t\t// sizing.style.maxHeight = (ch + eh) + \"px\";\n\n\t\treturn this;\n\t},\n\n\trender: function() {\n\t\t// NOTE: not calling super.render, calling measure ourselves\n\t\tthis.measure();\n\n\t\tvar sizing = this.getSizingEl();\n\t\tsizing.style.maxWidth = this.metrics.content.width + \"px\";\n\t\tsizing.style.maxHeight = this.metrics.content.height + \"px\";\n\n\t\tthis.el.setAttribute(\"data-fit-dir\", this.metrics.fitDirection);\n\n\t\treturn this;\n\t},\n\n\t/* --------------------------- *\n\t/* mediaState\n\t/* --------------------------- */\n\n\t_mediaStateEnum: [\"idle\", \"pending\", \"ready\", \"error\"],\n\n\t_setMediaState: function(key) {\n\t\tif (this._mediaStateEnum.indexOf(key) === -1) {\n\t\t\tthrow new Error(\"Argument \" + key + \" invalid. Must be one of: \" + this._mediaStateEnum.join(\", \"));\n\t\t}\n\t\tif (this._mediaState !== key) {\n\t\t\tif (this._mediaState) {\n\t\t\t\tthis.el.classList.remove(this._mediaState);\n\t\t\t}\n\t\t\tthis.el.classList.add(key);\n\t\t\tthis._mediaState = key;\n\t\t\tthis.trigger(\"media:\" + key);\n\t\t}\n\t},\n}, {\n\tLOG_TO_SCREEN: true,\n\t/** @type {module:app/view/promise/whenSelectionDistanceIs} */\n\twhenSelectionDistanceIs: require(\"app/view/promise/whenSelectionDistanceIs\"),\n\n\t/** @type {module:app/view/promise/whenSelectionIsContiguous} */\n\twhenSelectionIsContiguous: require(\"app/view/promise/whenSelectionIsContiguous\"),\n\n\t// /** @type {module:app/view/promise/whenSelectTransitionEnds} */\n\t// whenSelectTransitionEnds: require(\"app/view/promise/whenSelectTransitionEnds\"),\n\n\t/** @type {module:app/view/promise/whenScrollingEnds} */\n\twhenScrollingEnds: require(\"app/view/promise/whenScrollingEnds\"),\n\n\t/** @type {module:app/view/promise/whenDefaultImageLoads} */\n\twhenDefaultImageLoads: require(\"app/view/promise/whenDefaultImageLoads\"),\n});\n\n/* ---------------------------\n/* log to screen\n/* --------------------------- */\nif (DEBUG) {\n\n\tMediaRenderer = (function(MediaRenderer) {\n\t\tif (!MediaRenderer.LOG_TO_SCREEN) return MediaRenderer;\n\n\t\t/** @type {Function} */\n\t\tvar Color = require(\"color\");\n\t\t// /** @type {module:underscore.string/lpad} */\n\t\t// var lpad = require(\"underscore.string/lpad\");\n\t\t// /** @type {module:underscore.string/rpad} */\n\t\t// var rpad = require(\"underscore.string/rpad\");\n\n\t\treturn MediaRenderer.extend({\n\n\t\t\t/** @override */\n\t\t\tinitialize: function() {\n\n\t\t\t\tvar fgColor = new Color(this.model.attr(\"color\"));\n\t\t\t\tvar bgColor = new Color(this.model.attr(\"background-color\"));\n\t\t\t\tthis.__logColors = {\n\t\t\t\t\tnormal: fgColor.clone().mix(bgColor, 0.75).hslString(),\n\t\t\t\t\tignored: fgColor.clone().mix(bgColor, 0.25).hslString(),\n\t\t\t\t\terror: \"brown\",\n\t\t\t\t\tabort: \"orange\"\n\t\t\t\t};\n\t\t\t\tthis.__logFrameStyle = \"1px dashed \" + fgColor.clone().mix(bgColor, 0.5).hslString();\n\t\t\t\tthis.__logStartTime = Date.now();\n\t\t\t\tthis.__rafId = -1;\n\t\t\t\tthis.__onFrame = this.__onFrame.bind(this);\n\t\t\t\tMediaRenderer.prototype.initialize.apply(this, arguments);\n\t\t\t},\n\n\t\t\tinitializeAsync: function() {\n\t\t\t\treturn MediaRenderer.prototype.initializeAsync.apply(this, arguments).catch(function(err) {\n\t\t\t\t\tif (!(err instanceof MediaRenderer.ViewError)) {\n\t\t\t\t\t\tthis.__logMessage(err.message, err.name, this.__logColors[\"error\"]);\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t}.bind(this));\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\tcreateChildren: function() {\n\t\t\t\tvar ret = MediaRenderer.prototype.createChildren.apply(this, arguments);\n\n\t\t\t\tthis.__logElement = document.createElement(\"div\");\n\t\t\t\tthis.__logElement.className = \"debug-log\";\n\t\t\t\t// this.__logElement.style.touchAction = \"pan-y\";\n\t\t\t\tthis.__logHeaderEl = document.createElement(\"pre\");\n\t\t\t\tthis.__logHeaderEl.className = \"log-header color-bg\";\n\t\t\t\t// this.model.colors.fgColor.clone().mix(fgColor, 0.9).rgbString()\n\t\t\t\t// this.model.colors.fgColor.clone().alpha\n\t\t\t\tthis.__logHeaderEl.textContent = this.__getHeaderText();\n\t\t\t\tthis.__logElement.appendChild(this.__logHeaderEl);\n\t\t\t\tthis.el.insertBefore(this.__logElement, this.el.firstElementChild);\n\t\t\t\treturn ret;\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\trender: function() {\n\t\t\t\tvar ret = MediaRenderer.prototype.render.apply(this, arguments);\n\n\t\t\t\tthis.__logElement.style.top = (this.metrics.content.height + this.metrics.content.y) + \"px\";\n\t\t\t\tthis.__logElement.style.left = this.metrics.content.x + \"px\";\n\t\t\t\tthis.__logElement.style.width = this.metrics.content.width + \"px\";\n\t\t\t\tthis.__logElement.scrollTop = this.__logElement.scrollHeight;\n\n\t\t\t\treturn ret;\n\t\t\t},\n\n\t\t\twhenInitializeError: function(err) {\n\t\t\t\t// NOTE: not calling super\n\t\t\t\t// MediaRenderer.prototype.whenInitializeError.apply(this, arguments);\n\t\t\t\tif (err instanceof CarouselRenderer.ViewError) {\n\t\t\t\t\t// NOTE: ignore ViewError type\n\t\t\t\t\t// console.warn(\"%s::whenInitializeError \", err.view.cid, err.message);\n\t\t\t\t\treturn;\n\t\t\t\t} else if (err instanceof Error) {\n\t\t\t\t\tconsole.warn(err.stack);\n\t\t\t\t}\n\t\t\t\t// this.placeholder.innerHTML = err ? errorTemplate(err) : \"\";\n\t\t\t\tthis.placeholder.removeAttribute(\"data-progress\");\n\t\t\t\tthis.mediaState = \"error\";\n\n\t\t\t\t// console.error(\"%s::initializeAsync [%s (caught)]: %s\", this.cid, err.name, (err.info && err.info.logMessage) || err.message);\n\t\t\t\t// err.logEvent && console.log(err.logEvent);\n\t\t\t},\n\n\t\t\t/* --------------------------- *\n\t\t\t/* log methods\n\t\t\t/* --------------------------- */\n\n\t\t\t__logMessage: function(msg, logtype, color) {\n\t\t\t\tvar logEntryEl = document.createElement(\"pre\");\n\n\t\t\t\tlogtype || (logtype = \"-\")\n\t\t\t\tlogEntryEl.textContent = this.__getTStamp() + \" \" + msg;\n\t\t\t\tlogEntryEl.setAttribute(\"data-logtype\", logtype);\n\t\t\t\tlogEntryEl.style.color = color || this.__logColors[logtype] || this.__logColors.normal;\n\n\t\t\t\tthis.__logElement.appendChild(logEntryEl);\n\t\t\t\tthis.__logElement.scrollTop = this.__logElement.scrollHeight;\n\n\t\t\t\tif (this.__rafId == -1) {\n\t\t\t\t\tthis.__rafId = this.requestAnimationFrame(this.__onFrame);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t__onFrame: function(tstamp) {\n\t\t\t\tthis.__rafId = -1;\n\t\t\t\tthis.__logElement.lastElementChild.style.borderBottom = this.__logFrameStyle;\n\t\t\t\tthis.__logElement.lastElementChild.style.paddingBottom = \"2px\";\n\t\t\t\tthis.__logElement.lastElementChild.style.marginBottom = \"2px\";\n\t\t\t},\n\n\t\t\t__getTStamp: function() {\n\t\t\t\t// return new Date(Date.now() - this.__logStartTime).toISOString().substr(11, 12);\n\t\t\t\treturn lpad(((Date.now() - this.__logStartTime) / 1000).toFixed(3), 8, \"0\");\n\t\t\t},\n\n\t\t\t__getHeaderText: function() {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t});\n\t})(MediaRenderer);\n\n} // end debug\n\n/**\n * @constructor\n * @type {module:app/view/render/MediaRenderer}\n */\nmodule.exports = MediaRenderer;\n",
    "/**\n * @module app/view/render/PlayableRenderer\n */\n\n/** @type {module:app/view/MediaRenderer} */\nvar MediaRenderer = require(\"app/view/render/MediaRenderer\");\n// /** @type {module:app/view/component/CanvasProgressMeter} */\n// var ProgressMeter = require(\"app/view/component/CanvasProgressMeter\");\n\n/** @type {Function} */\nvar prefixedProperty = require(\"utils/prefixedProperty\");\n/** @type {Function} */\nvar prefixedEvent = require(\"utils/prefixedEvent\");\n\n// var visibilityHiddenProp = prefixedProperty(\"hidden\", document);\n/** @type {String} */\nvar visibilityStateProp = prefixedProperty(\"visibilityState\", document);\n/** @type {String} */\nvar visibilityChangeEvent = prefixedEvent(\"visibilitychange\", document, \"hidden\");\n\n// /** @type {Function} */\n// var Color = require(\"color\");\n//\n// /** @type {Function} */\n// // var duotone = require(\"utils/canvas/bitmap/duotone\");\n// // var stackBlurMono = require(\"utils/canvas/bitmap/stackBlurMono\");\n// var stackBlurRGB = require(\"utils/canvas/bitmap/stackBlurRGB\");\n// // var getAverageRGBA = require(\"utils/canvas/bitmap/getAverageRGBA\");\n// var getAverageRGB = require(\"utils/canvas/bitmap/getAverageRGB\");\n// // var inflateRect = require(\"utils/geom/inflateRect\");\n//\n\n// var WAIT_DEBOUNCE_MS = require(\"app/control/Globals\").TRANSITION_DURATION;\n\n// /** @type {HTMLCanvasElement} */\n// var _sharedCanvas = null;\n// /** @return {HTMLCanvasElement} */\n// var getSharedCanvas = function() {\n// \tif (_sharedCanvas === null) {\n// \t\t_sharedCanvas = document.createElement(\"canvas\");\n// \t}\n// \treturn _sharedCanvas;\n// };\n\n// var SVG_NS = \"http://www.w3.org/2000/svg\";\n// var XLINK_NS = \"http://www.w3.org/1999/xlink\";\n//\n// var useIdSeed = 0\n// var createSVGUseElement = function() {\n// \tvar svgEl = document.createElementNS(SVG_NS, \"use\");\n// \tsvgEl.setAttributeNS(null, \"id\", name + (useIdSeed++));\n// \tsvgEl.setAttributeNS(null, \"class\", [name, \"symbol\"].join(\" \"));\n// \tsvgEl.setAttributeNS(XLINK_NS, \"xlink:href\", \"#\" + name);\n// \treturn svgEl;\n// };\n\n// function logAttachInfo(view, name, level) {\n// \tif ([\"log\", \"info\", \"warn\", \"error\"].indexOf(level) != -1) {\n// \t\tlevel = \"log\";\n// \t}\n// \tconsole[level].call(console, \"%s::%s [parent:%s %s %s depth:%s]\", view.cid, name, view.parentView && view.parentView.cid, view.attached ? \"attached\" : \"detached\", view._viewPhase, view.viewDepth);\n// }\n\n/**\n * @constructor\n * @type {module:app/view/render/PlayableRenderer}\n */\nvar PlayableRenderer = MediaRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"playableRenderer\",\n\n\t/** @type {string|Function} */\n\tclassName: MediaRenderer.prototype.className + \" playable-item\",\n\n\tproperties: {\n\t\tmediaPaused: {\n\t\t\t/** @return {Boolean} */\n\t\t\tget: function() {\n\t\t\t\treturn this._isMediaPaused();\n\t\t\t}\n\t\t},\n\t\tmediaWaiting: {\n\t\t\t/** @return {Boolean} */\n\t\t\tget: function() {\n\t\t\t\treturn this._isMediaWaiting();\n\t\t\t}\n\t\t},\n\t\tplaybackRequested: {\n\t\t\t/** @return {Boolean} */\n\t\t\tget: function() {\n\t\t\t\treturn this._playbackRequested;\n\t\t\t},\n\t\t\tset: function(value) {\n\t\t\t\tthis._setPlaybackRequested(value);\n\t\t\t}\n\t\t},\n\t\toverlay: {\n\t\t\t/** @return {HTMLElement} */\n\t\t\tget: function() {\n\t\t\t\treturn this._overlay || (this._overlay = this.el.querySelector(\".overlay\"));\n\t\t\t}\n\t\t},\n\t\t// playToggle: {\n\t\t// \t/** @return {HTMLElement} */\n\t\t// \tget: function() {\n\t\t// \t\treturn this._playToggle || (this._playToggle = this.el.querySelector(\".play-toggle\"));\n\t\t// \t}\n\t\t// },\n\t\t// playToggleSymbol: {\n\t\t// \t/** @return {HTMLElement} */\n\t\t// \tget: function() {\n\t\t// \t\treturn this._playToggleSymbol || (this._playToggleSymbol = this.el.querySelector(\".play-toggle-symbol\"));\n\t\t// \t}\n\t\t// },\n\t\tplayToggleHitarea: {\n\t\t\t/** @return {HTMLElement} */\n\t\t\tget: function() {\n\t\t\t\treturn this._playToggleHitarea || (this._playToggleHitarea = this.el.querySelector(\".play-toggle-hitarea\"));\n\t\t\t}\n\t\t},\n\t},\n\n\t/** @override */\n\tinitialize: function(opts) {\n\t\tthis._playToggleSymbol = {};\n\t\t// this._toggleWaiting = _.debounce(this._toggleWaiting, 500);\n\t\t// this._toggleWaiting = _.throttle(this._toggleWaiting, WAIT_DEBOUNCE_MS, { leading: true, trailing: true });\n\n\t\t_.bindAll(this,\n\t\t\t\"_onPlaybackToggle\",\n\t\t\t\"_onVisibilityChange\"\n\t\t);\n\t\tMediaRenderer.prototype.initialize.apply(this, arguments);\n\t\tthis._setPlaybackRequested(this._playbackRequested);\n\n\t\t// this.listenTo(this, \"view:parentChange\", function(childView, newParent, oldParent) {\n\t\t// \t// logAttachInfo(this, \"[view:parentChange]\", \"info\");\n\t\t// \tconsole.info(\"%s::[view:parentChange] '%s' to '%s'\", this.cid, oldParent && oldParent.cid, newParent && newParent.cid);\n\t\t// });\n\t},\n\n\t// /** @override */\n\t// initializeAsync: function() {\n\t// \treturn MediaRenderer.prototype.initialize.initializeAsync.apply(this, arguments);\n\t// },\n\n\t// /** @override */\n\t// remove: function() {\n\t// \tMediaRenderer.prototype.remove.apply(this, arguments);\n\t// \treturn this;\n\t// },\n\n\t/* --------------------------- *\n\t/* children/layout\n\t/* --------------------------- */\n\n\t// createChildren: function() {\n\t// },\n\n\t/* --------------------------- *\n\t/* setEnabled\n\t/* --------------------------- */\n\n\t/** @override */\n\tsetEnabled: function(enabled) {\n\t\tMediaRenderer.prototype.setEnabled.apply(this, arguments);\n\t\t// this._validatePlayback(enabled);\n\t\t// if (enabled) {\n\t\tthis._validatePlayback();\n\t\t// } else {\n\t\t// \t// if selected, pause media\n\t\t// \tthis.model.selected && this._togglePlayback(false);\n\t\t// \t// this._togglePlayback(false);\n\t\t// }\n\t\t// console.log(\"%s::setEnabled\", this.cid, this.enabled);\n\t\t// this._playToggleSymbol.paused = (this.enabled && this.model.selected);\n\t\t//}\n\t},\n\n\t/* ---------------------------\n\t/* selection handlers\n\t/* --------------------------- */\n\n\tlistenToSelection: function() {\n\t\tif (this._viewPhase != \"initialized\")\n\t\t\tthrow new Error(this.cid + \"::listenToSelection called while \" + this._viewPhase);\n\n\t\t// logAttachInfo(this, \"listenToSelection\", \"log\");\n\t\t// this.listenTo(this, \"view:removed\", this.removeSelectionListeners);\n\t\tthis.listenTo(this.model, \"selected\", this._onModelSelected);\n\t\tthis.listenTo(this.model, \"deselected\", this._onModelDeselected);\n\t\tif (this.model.selected) {\n\t\t\tthis._onModelSelected();\n\t\t}\n\t},\n\n\t/* model selected handlers:\n\t/* model selection toggles playback\n\t/* --------------------------- */\n\n\t_onModelSelected: function() {\n\t\tconsole.log(\"%s::_onModelSelected _playbackRequested: %s, event: %s\", this.cid, this._playbackRequested, this._toggleEvent);\n\t\tthis.listenTo(this, \"view:parentChange\", this._onParentChange);\n\t\tif (this.parentView) this._onParentChange(this, this.parentView, null);\n\n\t\t// this.enabled = true;\n\t\tthis._playToggleSymbol.paused = !this.enabled;\n\n\t\tthis._listenWhileSelected();\n\t\tthis._validatePlayback();\n\t},\n\n\t_onModelDeselected: function() {\n\t\tconsole.log(\"%s::_onModelDeselected _playbackRequested: %s, event: %s\", this.cid, this._playbackRequested, this._toggleEvent);\n\t\tthis.stopListening(this, \"view:parentChange\", this._onParentChange);\n\t\tif (this.parentView) this._onParentChange(this, null, this.parentView);\n\n\t\tthis._playToggleSymbol.paused = true;\n\n\t\tthis._stopListeningWhileSelected();\n\t\tthis._validatePlayback(false);\n\t\t// this._togglePlayback(false);\n\t},\n\n\t/* view:parentChange handlers 3\n\t/* --------------------------- */\n\t_onParentChange: function(childView, newParent, oldParent) {\n\t\t// console.log(\"[scroll] %s::_onParentChange '%s' to '%s'\", this.cid, oldParent && oldParent.cid, newParent && newParent.cid);\n\t\tif (oldParent) this.stopListening(oldParent, \"view:scrollstart view:scrollend\", this._onScrollChange);\n\t\tif (newParent) this.listenTo(newParent, \"view:scrollstart view:scrollend\", this._onScrollChange);\n\t},\n\n\t_onScrollChange: function() {\n\t\tif (this.parentView === null) {\n\t\t\tthrow new Error(this.cid + \"::_onScrollChange parentView is null\");\n\t\t}\n\t\tthis._validatePlayback();\n\t},\n\n\t/* visibility dom event\n\t/* --------------------------- */\n\t_onVisibilityChange: function(ev) {\n\t\tthis._validatePlayback();\n\t},\n\n\t/* listen to DOM events\n\t * --------------------------- */\n\n\t_listenWhileSelected: function() {\n\t\tthis.listenTo(this, \"view:removed\", this._stopListeningWhileSelected);\n\t\tdocument.addEventListener(visibilityChangeEvent, this._onVisibilityChange, false);\n\t\tthis.playToggleHitarea.addEventListener(this._toggleEvent, this._onPlaybackToggle, false);\n\t},\n\n\t_stopListeningWhileSelected: function() {\n\t\tthis.stopListening(this, \"view:removed\", this._stopListeningWhileSelected);\n\t\tdocument.removeEventListener(visibilityChangeEvent, this._onVisibilityChange, false);\n\t\tthis.playToggleHitarea.removeEventListener(this._toggleEvent, this._onPlaybackToggle, false);\n\t},\n\n\t/* --------------------------- *\n\t/* play-toggle\n\t/* --------------------------- */\n\n\t/** @type {String} */\n\t_toggleEvent: MediaRenderer.CLICK_EVENT, //window.hasOwnProperty(\"onpointerup\") ? \"pointerup\" : \"mouseup\",\n\n\t_onPlaybackToggle: function(ev) {\n\t\t//console.log(\"%s[%sabled]::_onPlaybackToggle[%s] defaultPrevented: %s\", this.cid, this.enabled ? \"en\" : \"dis\", ev.type, ev.defaultPrevented);\n\t\t// NOTE: Perform action if MouseEvent.button is 0 or undefined (0: left-button)\n\t\tif (this.enabled && !ev.defaultPrevented && !ev.button) {\n\t\t\tev.preventDefault();\n\t\t\tthis.playbackRequested = !this.playbackRequested;\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* playbackRequested\n\t/* --------------------------- */\n\n\t_playbackCount: 0,\n\n\t/** @type {Boolean?} */\n\t_playbackRequested: null,\n\n\t_setPlaybackRequested: function(value) {\n\t\tthis._playbackRequested = value;\n\n\t\tvar classList = this.content.classList;\n\t\tclassList.toggle(\"playing\", value === true);\n\t\tclassList.toggle(\"paused\", value === false);\n\t\tclassList.toggle(\"requested\", value === true || value === false);\n\n\t\tthis._renderPlaybackState();\n\n\t\t// this._validatePlayback(this.playbackRequested);\n\t\t// if (this.playbackRequested) {\n\t\tthis._validatePlayback();\n\t\t// } else {\n\t\t// \tthis._togglePlayback(false);\n\t\t// }\n\t},\n\n\t/* --------------------------- *\n\t/* _togglePlayback\n\t/* --------------------------- */\n\n\t/** @param {Boolean} */\n\t_togglePlayback: function(newPlayState) {\n\t\tif (DEBUG) this.__logMessage([\n\t\t\t\t\"args:\", Array.prototype.join.apply(arguments),\n\t\t\t\t\"paused:\", (this._isMediaPaused() ? \"pause\" : \"play\"),\n\t\t\t\t\"media-state:\", this.mediaState,\n\t\t\t\t].join(\" \"),\n\t\t\t\"toggle-playback\");\n\n\t\tif (_.isBoolean(newPlayState) && newPlayState !== this._isMediaPaused()) {\n\t\t\treturn; // requested state is current, do nothing\n\t\t} else {\n\t\t\tnewPlayState = this._isMediaPaused();\n\t\t}\n\t\tif (newPlayState) { // changing to what?\n\t\t\t// this._playbackCount++;\n\t\t\tthis._playMedia();\n\t\t} else {\n\t\t\tthis._pauseMedia();\n\t\t}\n\t\t/* NOTE: called from _setPlaybackRequested */\n\t\t// this._renderPlaybackState();\n\t},\n\n\t_canResumePlayback: function() {\n\t\treturn !!(\n\t\t\tthis.enabled &&\n\t\t\tthis.model.selected &&\n\t\t\tthis.playbackRequested &&\n\t\t\t(this.mediaState === \"ready\") &&\n\t\t\tthis.attached &&\n\t\t\t(this.parentView !== null) &&\n\t\t\t(!this.parentView.scrolling) &&\n\t\t\t(document[visibilityStateProp] != \"hidden\")\n\t\t);\n\t},\n\n\t_validatePlayback: function(shortcircuit) {\n\t\t// a 'shortcircuit' boolean argument can be passed, and if false,\n\t\t// skip _canResumePlayback and pause playback right away\n\t\tif (arguments.length !== 0 && !shortcircuit) {\n\t\t\tthis._togglePlayback(false);\n\t\t} else {\n\t\t\tthis._togglePlayback(this._canResumePlayback());\n\t\t}\n\t\tthis._playToggleSymbol.paused = !(this.attached && this.enabled && this.model.selected);\n\t},\n\n\t/* ---------------------------\n\t/* _setPlayToggleSymbol\n\t/* --------------------------- */\n\n\t_renderPlaybackState: function() {\n\t\tif (!this.attached) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.progressMeter) {\n\t\t\tthis.progressMeter.stalled = this._isMediaWaiting();\n\t\t}\n\t\t// this._setPlayToggleSymbol(\"waiting\");\n\t\t// this.content.classList.toggle(\"waiting\", true);\n\n\t\t// if (!this.content.classList.contains(\"started\")) {\n\t\t// \tthis._setPlayToggleSymbol(\"play\");\n\t\t// } else\n\t\tvar waiting = !this.parentView.scrolling && this._isMediaWaiting();\n\n\t\tif (this.playbackRequested) {\n\t\t\tif (waiting) {\n\t\t\t\tthis._setPlayToggleSymbol(\"waiting\");\n\t\t\t} else {\n\t\t\t\tthis._setPlayToggleSymbol(\"play\");\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.content.classList.contains(\"started\")) {\n\t\t\t\tthis._setPlayToggleSymbol(\"pause\");\n\t\t\t} else {\n\t\t\t\tthis._setPlayToggleSymbol(\"play\");\n\t\t\t}\n\t\t}\n\t\tvar cls = this.content.classList;\n\t\tcls.toggle(\"playing\", this.playbackRequested);\n\t\tcls.toggle(\"paused\", !this.playbackRequested);\n\t\tcls.toggle(\"waiting\", waiting);\n\n\t\t//console.log(\"%s::_renderPlaybackState [play: %s] [wait: %s] [symbol: %s]\", this.cid, this.playbackRequested, this._isMediaWaiting(), this._playToggleSymbol.symbolName);\n\t},\n\n\t_setPlayToggleSymbol: function(symbolName) {\n\t\t//console.log(\"%s::_setPlayToggleSymbol [enabled: %s] [selected: %s] [symbol: %s]\", this.cid, this.enabled, !!(this.model.selected), symbolName);\n\n\t\t// this._playToggleSymbol.paused = !(this.attached && this.enabled && !!(this.model.selected));\n\t\tthis._playToggleSymbol.symbolName = symbolName;\n\t\tif (this.mediaState === \"ready\") { //this._playToggleSymbol.renderFlags) {\n\t\t\tthis._playToggleSymbol.renderNow();\n\t\t}\n\t},\n\n\t// _playToggleSymbolSvg: null,\n\t// _playToggleSymbolName: null,\n\t// _setPlayToggleSymbol_svg: function(symbolName) {\n\t// \tif (this._playToggleSymbolName !== symbolName) {\n\t// \t\tvar svgDoc = this.el.querySelector(\"svg.play-toggle-symbol\");\n\t// \t\tif (this._playToggleSymbolSvg) {\n\t// \t\t\tsvgDoc.removeChild(this._playToggleSymbolSvg);\n\t// \t\t}\n\t// \t\tvar svgSym = document.createElementNS(\"http://www.w3.org/2000/svg\", \"use\");\n\t// \t\tsvgSym.setAttributeNS(\"http://www.w3.org/1999/xlink\", \"xlink:href\", \"#\" + symbolName);\n\t// \t\tsvgDoc.appendChild(svgSym);\n\t// \t\tsvgDoc.setAttributeNS(null, \"class\", symbolName + \"-symbol play-toggle-symbol\");\n\t//\n\t// \t\tthis._playToggleSymbolSvg = svgSym;\n\t// \t\tthis._playToggleSymbolName = symbolName;\n\t// \t}\n\t// },\n\n\t/* --------------------------- *\n\t/* waiting\n\t/* --------------------------- */\n\n\t_isWaiting: false,\n\n\t_isMediaWaiting: function() {\n\t\treturn this._isWaiting;\n\t},\n\n\t_toggleWaiting: function(waiting) {\n\t\tif (arguments.length === 0) {\n\t\t\twaiting = !this._isWaiting;\n\t\t}\n\t\t// if (this._isMediaPaused()) {\n\t\t// \twaiting = false;\n\t\t// }\n\t\tif (this._isWaiting !== waiting) {\n\t\t\tthis._isWaiting = waiting;\n\t\t\tthis._renderPlaybackState();\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* abstract\n\t/* --------------------------- */\n\n\t_isMediaPaused: function() {\n\t\tconsole.warn(\"%s::_isMediaPaused Not implemented\", this.cid);\n\t\treturn true;\n\t},\n\n\t_playMedia: function() {\n\t\tconsole.warn(\"%s::_playMedia Not implemented\", this.cid);\n\t},\n\n\t_pauseMedia: function() {\n\t\tconsole.warn(\"%s::_pauseMedia Not implemented\", this.cid);\n\t},\n\n\t/* --------------------------- *\n\t/* util\n\t/* --------------------------- */\n\n\tupdateOverlay: function(mediaEl, targetEl, rectEl) {\n\t\t// this method is not critical, just catch and log all errors\n\t\t// try {\n\t\t// \tthis._updateOverlay(mediaEl, targetEl, rectEl)\n\t\t// } catch (err) {\n\t\t// \tconsole.error(\"%s::updateOverlay\", this.cid, err);\n\t\t// }\n\t},\n\n\t/**\\/\n\t_drawMediaElement: function(ctx, mediaEl, dest) {\n\t\t// destination rect\n\t\t// NOTE: mediaEl is expected to have the same dimensions in this.metrics.media\n\t\tmediaEl || (mediaEl = this.defaultImage);\n\t\tdest || (dest = {\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\twidth: this.metrics.media.width,\n\t\t\theight: this.metrics.media.height\n\t\t});\n\n\t\t// native/display scale\n\t\tvar sW = this.model.get(\"source\").get(\"w\"),\n\t\t\tsH = this.model.get(\"source\").get(\"h\"),\n\t\t\trsX = sW / this.metrics.media.width,\n\t\t\trsY = sH / this.metrics.media.height;\n\n\t\t// dest, scaled to native\n\t\tvar src = {\n\t\t\tx: Math.max(0, dest.x * rsX),\n\t\t\ty: Math.max(0, dest.y * rsY),\n\t\t\twidth: Math.min(sW, dest.width * rsX),\n\t\t\theight: Math.min(sH, dest.height * rsY)\n\t\t};\n\n\t\t// resize canvas\n\t\t// var canvas = ctx.canvas;\n\t\t// if (canvas.width !== dest.width || canvas.height !== dest.height) {\n\t\t// \tcanvas.width = dest.width;\n\t\t// \tcanvas.height = dest.height;\n\t\t// }\n\t\tctx.canvas.width = dest.width;\n\t\tctx.canvas.height = dest.height;\n\n\t\t// copy image to canvas\n\t\tctx.clearRect(0, 0, dest.width, dest.height);\n\t\tctx.drawImage(mediaEl,\n\t\t\tsrc.x, src.y, src.width, src.height,\n\t\t\t0, 0, dest.width, dest.height // destination rect\n\t\t);\n\n\t\treturn ctx;\n\t},\n\n\t_getImageData: function(mediaEl, targetEl, rectEl) {\n\t\t// src/dest rects\n\t\t// ------------------------------\n\t\trectEl || (rectEl = targetEl);\n\n\t\t// NOTE: does not work with svg element\n\t\t// var tRect = rectEl.getBoundingClientRect();\n\t\t// var cRect = mediaEl.getBoundingClientRect();\n\t\t// var tX = tRect.x - cRect.x,\n\t\t// \ttY = tRect.y - cRect.y,\n\t\t// \ttW = tRect.width,\n\t\t// \ttH = tRect.height;\n\n\t\t// target bounds\n\t\tvar tX = rectEl.offsetLeft,\n\t\t\ttY = rectEl.offsetTop,\n\t\t\ttW = rectEl.offsetWidth,\n\t\t\ttH = rectEl.offsetHeight;\n\n\t\tif (tX === void 0 || tY === void 0 || tW === void 0 || tH === void 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// destination rect\n\t\tvar RECT_GROW = 0;\n\t\tvar dest = {\n\t\t\tx: tX - RECT_GROW,\n\t\t\ty: tY - RECT_GROW,\n\t\t\twidth: tW + RECT_GROW * 2,\n\t\t\theight: tH + RECT_GROW * 2\n\t\t};\n\n\t\t// native/display scale\n\t\tvar sW = this.model.get(\"source\").get(\"w\"),\n\t\t\tsH = this.model.get(\"source\").get(\"h\"),\n\t\t\trsX = sW / this.metrics.media.width,\n\t\t\trsY = sH / this.metrics.media.height;\n\n\t\t// dest, scaled to native\n\t\tvar src = {\n\t\t\tx: Math.max(0, dest.x * rsX),\n\t\t\ty: Math.max(0, dest.y * rsY),\n\t\t\twidth: Math.min(sW, dest.width * rsX),\n\t\t\theight: Math.min(sH, dest.height * rsY)\n\t\t};\n\n\t\t// Copy image to canvas\n\t\t// ------------------------------\n\t\t// canvas = document.createElement(\"canvas\");\n\t\t// canvas.style.width  = dest.width + \"px\";\n\t\t// canvas.style.height = dest.height + \"px\";\n\n\t\tvar canvas = getSharedCanvas();\n\t\tif (canvas.width !== dest.width || canvas.height !== dest.height) {\n\t\t\tcanvas.width = dest.width;\n\t\t\tcanvas.height = dest.height;\n\t\t}\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tctx.clearRect(0, 0, dest.width, dest.height);\n\t\tctx.drawImage(mediaEl,\n\t\t\tsrc.x, src.y, src.width, src.height,\n\t\t\t0, 0, dest.width, dest.height // destination rect\n\t\t);\n\t\treturn ctx.getImageData(0, 0, dest.width, dest.height);\n\t},\n\n\t_updateOverlay: function(mediaEl, targetEl, rectEl) {\n\t\tvar canvas, ctx;\n\t\tvar imageData = this._getImageData(mediaEl, targetEl, rectEl);\n\t\tvar avgColor = Color().rgb(getAverageRGB(imageData));\n\n\t\t// var avgHex = avgColor.hexString(), els = this.el.querySelectorAll(\"img, video\");\n\t\t// for (var i = 0; i < els.length; i++) {\n\t\t// \tels.item(i).style.backgroundColor = avgHex;\n\t\t// }\n\n\t\ttargetEl.classList.toggle(\"over-dark\", avgColor.dark());\n\n\t\t// console.log(\"%s::updateOverlay() avgColor:%s (%s)\", this.cid, avgColor.rgbString(), avgColor.dark()?\"dark\":\"light\", targetEl);\n\n\t\t// Color, filter opts\n\t\t// ------------------------------\n\n\t\tthis.fgColor || (this.fgColor = new Color(this.model.attr(\"color\")));\n\t\tthis.bgColor || (this.bgColor = new Color(this.model.attr(\"background-color\")));\n\n\t\tvar opts = { radius: 20 };\n\t\tvar isFgDark = this.fgColor.luminosity() < this.bgColor.luminosity();\n\t\topts.x00 = isFgDark ? this.fgColor.clone().lighten(0.5) : this.bgColor.clone().darken(0.5);\n\t\topts.xFF = isFgDark ? this.bgColor.clone().lighten(0.5) : this.fgColor.clone().darken(0.5);\n\n\t\tstackBlurRGB(imageData, { radius: 40 });\n\t\t// stackBlurMono(imageData, opts);\n\t\t// duotone(imageData, opts);\n\n\t\tctx = getSharedCanvas();\n\t\tif (canvas.width !== imageData.width || canvas.height !== imageData.height) {\n\t\t\tcanvas.width = imageData.width;\n\t\t\tcanvas.height = imageData.height;\n\t\t}\n\t\tctx = canvas.getContext(\"2d\");\n\t\tctx.putImageData(imageData, 0, 0);\n\t\ttargetEl.style.backgroundOrigin = \"border-box\";\n\t\ttargetEl.style.backgroundClip = \"content-box\";\n\t\ttargetEl.style.backgroundSize = \"100%\";\n\t\t// targetEl.style.padding = \"0 0 5rem 0\";\n\t\ttargetEl.style.backgroundImage = \"url(\" + canvas.toDataURL() + \")\";\n\t} /**/\n});\n\n/* ---------------------------\n/* Google Analytics\n/* --------------------------- */\nif (GA) {\n\tPlayableRenderer = (function(PlayableRenderer) {\n\n\t\t/** @type {module:underscore.strings/dasherize} */\n\t\tvar dasherize = require(\"underscore.string/dasherize\");\n\n\t\t// var readyEvents = [\"playing\", \"waiting\", \"ended\"];\n\t\t// var userEvents = [\"play\", \"pause\"];\n\n\t\treturn PlayableRenderer.extend({\n\n\t\t\t/** @override */\n\t\t\tinitialize: function() {\n\t\t\t\tvar retval = PlayableRenderer.prototype.initialize.apply(this, arguments);\n\t\t\t\tthis._gaEventSuffix = this.playbackRequested ? \"-autoplay\" : \"\";\n\t\t\t\treturn retval;\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\t_onPlaybackToggle: function(ev) {\n\t\t\t\tvar retval = PlayableRenderer.prototype._onPlaybackToggle.apply(this, arguments);\n\t\t\t\tif (window.ga) {\n\t\t\t\t\twindow.ga(\"send\", {\n\t\t\t\t\t\thitType: \"event\",\n\t\t\t\t\t\teventCategory: dasherize(this.cidPrefix),\n\t\t\t\t\t\teventAction: (this.playbackRequested ? \"play\" : \"pause\") + this._gaEventSuffix,\n\t\t\t\t\t\teventLabel: this.model.get(\"text\"),\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(\"%s::_onPlaybackToggle window.ga is %s\", this.cid, window.ga);\n\t\t\t\t}\n\t\t\t\treturn retval;\n\t\t\t},\n\n\t\t\t// /** @override */\n\t\t\t// _togglePlayback: function(newPlayState) {\n\t\t\t// \tvar retval = PlayableRenderer.prototype._togglePlayback.apply(this, arguments);\n\t\t\t// \twindow.ga(\"send\", {\n\t\t\t// \t\thitType: \"event\",\n\t\t\t// \t\teventCategory: \"Playable\",\n\t\t\t// \t\teventAction: this.playbackRequested ? \"play\" : \"pause\",\n\t\t\t// \t\teventLabel: this.model.get(\"text\"),\n\t\t\t// \t});\n\t\t\t// \treturn retval;\n\t\t\t// },\n\t\t});\n\t})(PlayableRenderer);\n}\n\n// if (DEBUG) {\n// \tPlayableRenderer.prototype._logFlags = \"\";\n//\n// \tPlayableRenderer = (function(PlayableRenderer) {\n// \t\tif (!PlayableRenderer.LOG_TO_SCREEN) return PlayableRenderer;\n//\n// \t\t/** @type {module:underscore.strings/lpad} */\n// \t\tvar lpad = require(\"underscore.string/lpad\");\n//\n// \t\treturn PlayableRenderer.extend({\n// \t\t\t_canResumePlayback: function() {\n// \t\t\t\tvar retval = PlayableRenderer.prototype._canResumePlayback.apply(this.arguments);\n// \t\t\t\tconsole.log(\"[scroll] %s::_canResumePlayback():%s\", this.cid, retval, {\n// \t\t\t\t\t\"enabled\": this.enabled,\n// \t\t\t\t\t\"selected\": (!!this.model.selected),\n// \t\t\t\t\t\"playbackRequested\": this.playbackRequested,\n// \t\t\t\t\t\"attached\": this.attached,\n// \t\t\t\t\t\"parentView\": (this.parentView && this.parentView.cid),\n// \t\t\t\t\t\"!scrolling\": (this.parentView && !this.parentView.scrolling),\n// \t\t\t\t\t\"mediaState\": this.mediaState,\n// \t\t\t\t\t// \"!document.hidden\": !document[visibilityHiddenProp],\n// \t\t\t\t\t\"visibilityState\": document[visibilityStateProp]\n// \t\t\t\t});\n// \t\t\t\treturn retval;\n// \t\t\t},\n// \t\t});\n// \t})(PlayableRenderer);\n// }\n\nmodule.exports = PlayableRenderer;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=helpers.helperMissing, alias3=\"function\", alias4=container.escapeExpression;\n\n  return \"<div class=\\\"placeholder sizing\\\"></div>\\n<div class=\\\"content\\\">\\n\t<div class=\\\"media-border content-size\\\"></div>\\n\t<div class=\\\"controls content-size\\\">\\n\t\t<canvas class=\\\"progress-meter\\\"></canvas>\\n\t</div>\\n\t<div class=\\\"sequence media-size\\\">\\n\t\t<img class=\\\"sequence-step current default\\\" alt=\\\"\"\n    + alias4(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"text\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" longdesc=\\\"#desc_m\"\n    + alias4(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"id\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" />\\n\t</div>\\n\t<div class=\\\"overlay media-size play-toggle-hitarea\\\">\\n\t\t<canvas class=\\\"play-toggle\\\"/>\\n\t</div>\\n</div>\\n\";\n},\"useData\":true});\n",
    "/**\n * @module app/view/render/SequenceRenderer\n */\n\n/* --------------------------- *\n * Imports\n * --------------------------- */\n\n/** @type {module:backbone.babysitter} */\nvar Container = require(\"backbone.babysitter\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/render/PlayableRenderer} */\nvar PlayableRenderer = require(\"app/view/render/PlayableRenderer\");\n// /** @type {module:app/model/SelectableCollection} */\n// var SelectableCollection = require(\"app/model/SelectableCollection\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n\n/** @type {module:app/view/component/CanvasProgressMeter} */\nvar ProgressMeter = require(\"app/view/component/CanvasProgressMeter\");\n/** @type {module:app/view/component/PlayToggleSymbol} */\nvar PlayToggleSymbol = require(\"app/view/component/PlayToggleSymbol\");\n\n/** @type {module:utils/Timer} */\nvar Timer = require(\"utils/Timer\");\n// /** @type {Function} */\n// var transitionEnd = require(\"utils/event/transitionEnd\");\n// /** @type {module:utils/prefixedProperty} */\n// var prefixed = require(\"utils/prefixedProperty\");\n\n/** @type {Function} */\nvar _whenImageLoads = require(\"app/view/promise/_whenImageLoads\");\n/** @type {module:app/view/promise/_loadImageAsObjectURL} */\nvar _loadImageAsObjectURL = require(\"app/view/promise/_loadImageAsObjectURL\");\n// /** @type {Function} */\n// var whenSelectionDistanceIs = require(\"app/view/promise/whenSelectionDistanceIs\");\n// var whenSelectTransitionEnds = require(\"app/view/promise/whenSelectTransitionEnds\");\n// var whenDefaultImageLoads = require(\"app/view/promise/whenDefaultImageLoads\");\n\n// /** @type {Function} */\n// var Color = require(\"color\");\n// var duotone = require(\"utils/canvas/bitmap/duotone\");\n// var stackBlurRGB = require(\"utils/canvas/bitmap/stackBlurRGB\");\n// var stackBlurMono = require(\"utils/canvas/bitmap/stackBlurMono\");\n// var getAverageRGBA = require(\"utils/canvas/bitmap/getAverageRGBA\");\n\nvar errorTemplate = require(\"../template/ErrorBlock.hbs\");\n\nvar MIN_STEP_INTERVAL = 2 * Globals.TRANSITION_DURATION + Globals.TRANSITION_DELAY_INTERVAL;\nvar DEFAULT_STEP_INTERVAL = 6 * Globals.TRANSITION_DURATION + Globals.TRANSITION_DELAY_INTERVAL;\n\n\n/* --------------------------- *\n * Private classes\n * --------------------------- */\n\n/**\n * @constructor\n * @type {module:app/view/render/SequenceRenderer.PrefetechedSourceRenderer}\n */\nvar PrefetechedSourceRenderer = View.extend({\n\n\tcidPrefix: \"sequenceStepRenderer\",\n\t/** @type {string} */\n\tclassName: \"sequence-step\",\n\t/** @type {string} */\n\ttagName: \"img\",\n\n\tproperties: {\n\t\tready: {\n\t\t\tget: function() {\n\t\t\t\treturn this._ready;\n\t\t\t}\n\t\t}\n\t},\n\n\t/** @override */\n\tinitialize: function(opts) {\n\t\t!this.el.hasAttribute(\"alt\") && this.el.setAttribute(\"alt\", this.model.get(\"src\"));\n\t\t// this.el.setAttribute(\"longdesc\", this.model.get(\"original\"));\n\n\t\tif (this.model.has(\"prefetched\")) {\n\t\t\tthis._renderPrefetched();\n\t\t} else {\n\t\t\tthis.listenTo(this.model, \"change:prefetched\", this._renderPrefetched);\n\t\t}\n\t\tthis.listenTo(this.model, \"selected deselected\", this._renderSelection);\n\t\tthis._renderSelection();\n\t},\n\n\t_renderSelection: function() {\n\t\tthis.el.classList.toggle(\"current\", !!this.model.selected);\n\t},\n\n\t_renderPrefetched: function() {\n\t\tvar prefetched = this.model.get(\"prefetched\");\n\t\tif (prefetched !== this.el.src) {\n\t\t\tthis.el.src = prefetched;\n\t\t}\n\t\t_whenImageLoads(this.el).then(\n\t\t\tfunction(el) {\n\t\t\t\tthis.requestAnimationFrame(function(tstamp) {\n\t\t\t\t\tthis._setReady(true);\n\t\t\t\t});\n\t\t\t}.bind(this),\n\t\t\tfunction(err) {\n\t\t\t\t// this._setReady(false);\n\t\t\t\t(err instanceof Error) || (err = new Error(\"cannot load prefetched url\"));\n\t\t\t\tthrow err;\n\t\t\t}.bind(this)\n\t\t);\n\t},\n\n\t/** @type {boolean} */\n\t_ready: false,\n\n\t_setReady: function(ready) {\n\t\tif (this._ready !== ready) {\n\t\t\tthis._ready = !!(ready); // make bool\n\t\t\tthis.trigger(\"renderer:ready\", this);\n\t\t}\n\t},\n\n\trender: function() {\n\t\t// if (this.model.has(\"prefetched\")) {\n\t\t// \tthis._renderPrefetched();\n\t\t// }\n\t\t// this.el.classList.toggle(\"current\", !!this.model.selected);\n\t\tconsole.log(\"%s::render\", this.cid);\n\t\treturn this;\n\t},\n});\n\n/**\n * @constructor\n * @type {module:app/view/render/SequenceRenderer.SimpleSourceRenderer}\n */\n// var SimpleSourceRenderer = View.extend({\n//\n// \tcidPrefix: \"sequenceStepRenderer\",\n// \t/** @type {string} */\n// \tclassName: \"sequence-step\",\n// \t/** @type {string} */\n// \ttagName: \"img\",\n//\n// \t/** @override */\n// \tinitialize: function (options) {\n// \t\t// this.el.classList.toggle(\"current\", this.model.hasOwnProperty(\"selected\"));\n// \t\tthis.el.classList.toggle(\"current\", !!this.model.selected);\n// \t\tthis.listenTo(this.model, {\n// \t\t\t\"selected\": function () {\n// \t\t\t\tthis.el.classList.add(\"current\");\n// \t\t\t},\n// \t\t\t\"deselected\": function () {\n// \t\t\t\tthis.el.classList.remove(\"current\");\n// \t\t\t}\n// \t\t});\n// \t\tif (this.el.src === \"\") {\n// \t\t\tthis.el.src = Globals.MEDIA_DIR + \"/\" + this.model.get(\"src\");\n// \t\t}\n//\n// \t\tif (this.model.has(\"error\")) {\n// \t\t\tthis._onModelError();\n// \t\t} else {\n// \t\t\tthis.listenToOnce(this.model, \"change:error\", this._onModelError);\n// \t\t\t// this.listenToOnce(this.model, {\n// \t\t\t// \t\"change:source\": this._onModelSource,\n// \t\t\t// \t\"change:error\": this._onModelError,\n// \t\t\t// });\n// \t\t}\n// \t},\n//\n// \t// _onModelSource: function() {\n// \t// \tthis.el.src = Globals.MEDIA_DIR + \"/\" + this.model.get(\"src\");\n// \t// \t// console.log(\"%s::change:src\", this.cid, this.model.get(\"src\"));\n// \t// },\n//\n// \t_onModelError: function() {\n// \t\tvar err = this.model.get(\"error\");\n// \t\tvar errEl = document.createElement(\"div\");\n// \t\terrEl.className = \"error color-bg\" + (this.model.selected? \" current\" : \"\");\n// \t\terrEl.innerHTML = errorTemplate(err);\n// \t\tthis.setElement(errEl, true);\n// \t\tconsole.log(\"%s::change:error\", this.cid, err.message, err.infoSrc);\n// \t},\n// });\n\nvar SourceErrorRenderer = View.extend({\n\n\t/** @type {string} */\n\tclassName: \"sequence-step error\",\n\t/** @override */\n\tcidPrefix: \"sourceErrorRenderer\",\n\t/** @override */\n\ttemplate: errorTemplate,\n\t/** @type {boolean} */\n\tready: true,\n\n\tinitialize: function(opts) {\n\t\t// var handleSelectionChange = function onSelectionChange () {\n\t\t// \tthis.el.classList.toggle(\"current\", !!this.model.selected);\n\t\t// };\n\t\t// this.listenTo(this.model, \"selected deselected\", handleSelectionChange);\n\t\t// // this.el.classList.toggle(\"current\", !!this.model.selected);\n\t\t// handleSelectionChange.call(this);\n\t\tthis.listenTo(this.model, \"selected deselected\", function() {\n\t\t\tthis.el.classList.toggle(\"current\", !!this.model.selected);\n\t\t});\n\t},\n\n\trender: function() {\n\t\tthis.el.classList.toggle(\"current\", !!this.model.selected);\n\t\tthis.el.innerHTML = this.template(this.model.get(\"error\"));\n\t\treturn this;\n\t},\n});\n\nvar SequenceStepRenderer = PrefetechedSourceRenderer;\n// var SequenceStepRenderer = SimpleSourceRenderer;\n\n/**\n * @constructor\n * @type {module:app/view/render/SequenceRenderer}\n */\nvar SequenceRenderer = PlayableRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"sequenceRenderer\",\n\t/** @type {string} */\n\tclassName: PlayableRenderer.prototype.className + \" sequence-item\",\n\t/** @type {Function} */\n\ttemplate: require(\"./SequenceRenderer.hbs\"),\n\n\t/* --------------------------- *\n\t/* initialize\n\t/* --------------------------- */\n\n\tinitialize: function(opts) {\n\t\tthis.sources = this.model.get(\"sources\");\n\t\tPlayableRenderer.prototype.initialize.apply(this, arguments);\n\t},\n\n\t/* --------------------------- *\n\t * children\n\t * --------------------------- */\n\n\t/** @override */\n\tcreateChildren: function() {\n\t\tPlayableRenderer.prototype.createChildren.apply(this, arguments);\n\n\t\tthis.placeholder = this.el.querySelector(\".placeholder\");\n\t\tthis.sequence = this.content.querySelector(\".sequence\");\n\n\t\t// styles\n\t\t// ---------------------------------\n\t\tvar s, attrs = this.model.attrs();\n\t\t// var s, attrs = this.model.get(\"attrs\");\n\t\ts = _.pick(attrs, \"box-shadow\", \"border\", \"border-radius\");\n\t\t_.extend(this.content.querySelector(\".media-border\").style, s);\n\t\ts = _.pick(attrs, \"border-radius\");\n\t\t_.extend(this.sequence.style, s);\n\t\t_.extend(this.placeholder.style, s);\n\n\t\t// model\n\t\t// ---------------------------------\n\t\tthis.sources.select(this.model.get(\"source\"));\n\n\t\t// itemViews\n\t\t// ---------------------------------\n\t\tthis.itemViews = new Container();\n\t\t// add default image as renderer (already in DOM)\n\t\tthis.itemViews.add(new SequenceStepRenderer({\n\t\t\tel: this.getDefaultImage(),\n\t\t\tmodel: this.model.get(\"source\")\n\t\t}));\n\t},\n\n\t/* --------------------------- *\n\t * layout/render\n\t * --------------------------- */\n\n\t/** @override */\n\trender: function() {\n\t\tPlayableRenderer.prototype.render.apply(this, arguments);\n\n\t\tvar els, el, i, cssW, cssH;\n\t\tvar content = this.content;\n\n\t\t// media-size\n\t\t// ---------------------------------\n\t\tcssW = this.metrics.media.width + \"px\";\n\t\tcssH = this.metrics.media.height + \"px\";\n\n\t\tels = this.el.querySelectorAll(\".media-size\");\n\t\tfor (i = 0; i < els.length; i++) {\n\t\t\tel = els.item(i);\n\t\t\tel.style.width = cssW;\n\t\t\tel.style.height = cssH;\n\t\t}\n\t\tcontent.style.width = cssW;\n\t\tcontent.style.height = cssH;\n\n\t\t// content-position\n\t\t// ---------------------------------\n\t\tvar cssX, cssY;\n\t\tcssX = this.metrics.content.x + \"px\";\n\t\tcssY = this.metrics.content.y + \"px\";\n\t\tcontent.style.left = cssX;\n\t\tcontent.style.top = cssY;\n\n\t\tel = this.el.querySelector(\".controls\");\n\t\t// el.style.left = cssX;\n\t\t// el.style.top = cssY;\n\t\tel.style.width = this.metrics.content.width + \"px\";\n\t\tel.style.height = this.metrics.content.height + \"px\";\n\n\t\t// // content-size\n\t\t// // ---------------------------------\n\t\t// cssW = this.metrics.content.width + \"px\";\n\t\t// cssH = this.metrics.content.height + \"px\";\n\t\t//\n\t\t// els = this.el.querySelectorAll(\".content-size\");\n\t\t// for (i = 0; i < els.length; i++) {\n\t\t// \tel = els.item(i);\n\t\t// \tel.style.width = cssW;\n\t\t// \tel.style.height = cssH;\n\t\t// }\n\n\t\treturn this;\n\t},\n\n\t/* --------------------------- *\n\t * initializeAsync\n\t * --------------------------- */\n\n\tinitializePlayable: function() {\n\t\t// model\n\t\t// ---------------------------------\n\t\t// this.sources.select(this.model.get(\"source\"));\n\t\tthis.content.classList.add(\"started\");\n\n\t\t// Sequence model\n\t\t// ---------------------------------\n\t\tPlayableRenderer.whenSelectionDistanceIs(this, 0)\n\t\t\t// .then(function(view) {\n\t\t\t// \t/* defaultImage is loaded, add `started` rightaway */\n\t\t\t// \tview.content.classList.add(\"started\");\n\t\t\t// \treturn view;\n\t\t\t// })\n\t\t\t.then(this._preloadAllItems, function(err) {\n\t\t\t\treturn (err instanceof View.ViewError) ? (void 0) : err; // Ignore ViewError\n\t\t\t});\n\n\t\tthis._sequenceInterval = Math.max(parseInt(this.model.attr(\"@sequence-interval\")), MIN_STEP_INTERVAL) || DEFAULT_STEP_INTERVAL;\n\n\t\t// timer\n\t\t// ---------------------------------\n\t\t/* timer will be started when _validatePlayback is called from _onModelSelected */\n\t\tthis.timer = new Timer();\n\t\tthis.listenTo(this, \"view:removed\", function() {\n\t\t\tthis.timer.stop();\n\t\t\tthis.stopListening(this.timer);\n\t\t});\n\n\t\tthis.listenTo(this.timer, {\n\t\t\t\"start\": this._onTimerStart,\n\t\t\t\"resume\": this._onTimerResume,\n\t\t\t\"pause\": this._onTimerPause,\n\t\t\t\"end\": this._onTimerEnd,\n\t\t\t// \"stop\": function () {}, // stop is only called on view remove\n\t\t});\n\n\t\t// play-toggle-symbol\n\t\t// ---------------------------------\n\t\tthis._playToggleSymbol = new PlayToggleSymbol(_.extend({\n\t\t\tel: this.el.querySelector(\".play-toggle\")\n\t\t}, this._playToggleSymbol || {}));\n\n\t\t// progress-meter model\n\t\t// ---------------------------------\n\t\tthis._sourceProgressByIdx = this.sources.map(function() {\n\t\t\treturn 0;\n\t\t});\n\t\tthis._sourceProgressByIdx[0] = 1; // first item is already loaded\n\n\t\t// progress-meter\n\t\t// ---------------------------------\n\t\tthis.progressMeter = new ProgressMeter({\n\t\t\tel: this.el.querySelector(\".progress-meter\"),\n\t\t\tcolor: this.model.attr(\"color\"),\n\t\t\t// backgroundColor: this.model.attr(\"background-color\"),\n\t\t\tvalues: {\n\t\t\t\tavailable: this._sourceProgressByIdx.concat(),\n\t\t\t},\n\t\t\tmaxValues: {\n\t\t\t\tamount: this.sources.length,\n\t\t\t\tavailable: this.sources.length,\n\t\t\t},\n\t\t\tlabelFn: (function() {\n\t\t\t\tif (this.playbackRequested === false) return Globals.PAUSE_CHAR;\n\t\t\t\treturn (this.sources.selectedIndex + 1) + \"/\" + this.sources.length;\n\t\t\t}).bind(this)\n\t\t});\n\t\t// this.el.querySelector(\".top-bar\")\n\t\t//\t\t.appendChild(this.progressMeter.render().el);\n\t},\n\n\tinitializeAsync: function() {\n\t\treturn PlayableRenderer.prototype.initializeAsync.apply(this, arguments)\n\t\t\t.then(\n\t\t\t\tfunction(view) {\n\t\t\t\t\treturn view.whenAttached();\n\t\t\t\t})\n\t\t\t.then(function(view) {\n\t\t\t\tview.initializePlayable();\n\t\t\t\t// view.updateOverlay(view.defaultImage, view.playToggle); //view.overlay);\n\t\t\t\tview.listenToSelection();\n\t\t\t\treturn view;\n\t\t\t});\n\t},\n\n\twhenInitialized: function(view) {\n\t\tvar retval = PlayableRenderer.prototype.whenInitialized.apply(this, arguments);\n\t\tview._validatePlayback();\n\t\treturn retval;\n\t},\n\n\t/* --------------------------- *\n\t * _preloadAllItems\n\t * --------------------------- */\n\n\t_preloadAllItems: function(view) {\n\t\tview.once(\"view:remove\", function() {\n\t\t\tvar silent = { silent: true };\n\t\t\tview.sources.forEach(function(item, index, sources) {\n\t\t\t\t// view.stopListening(item, \"change:progress\");\n\t\t\t\tvar prefetched = item.get(\"prefetched\");\n\t\t\t\tif (prefetched && /^blob\\:/.test(prefetched)) {\n\t\t\t\t\titem.set(\"progress\", 0, silent);\n\t\t\t\t\titem.unset(\"prefetched\", silent);\n\t\t\t\t\tURL.revokeObjectURL(prefetched);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn view.sources.reduce(function(lastPromise, item, index, sources) {\n\t\t\treturn lastPromise.then(function(view) {\n\t\t\t\tif (view._viewPhase === \"disposed\") {\n\t\t\t\t\t/** do nothing */\n\t\t\t\t\treturn view;\n\t\t\t\t} else\n\t\t\t\tif (item.has(\"prefetched\")) {\n\t\t\t\t\tview._updateItemProgress(1, index);\n\t\t\t\t\treturn view;\n\t\t\t\t} else {\n\t\t\t\t\tvar onItemProgress = function(item, progress) {\n\t\t\t\t\t\tview._updateItemProgress(progress, index);\n\t\t\t\t\t};\n\t\t\t\t\tview.listenTo(item, \"change:progress\", onItemProgress);\n\t\t\t\t\tview.once(\"view:remove\", function(view) {\n\t\t\t\t\t\tview.stopListening(item, \"change:progress\", onItemProgress);\n\t\t\t\t\t});\n\t\t\t\t\treturn _loadImageAsObjectURL(item.get(\"original\"),\n\t\t\t\t\t\t\tfunction(progress, request) {\n\t\t\t\t\t\t\t\t/* NOTE: Since we are calling URL.revokeObjectURL when view is removed, also abort incomplete requests. Otherwise, clear the callback reference from XMLHttpRequest.onprogress  */\n\t\t\t\t\t\t\t\tif (view._viewPhase === \"disposed\") {\n\t\t\t\t\t\t\t\t\t//console.warn(\"%s::_preloadAllItems aborting XHR [%s %s] (%s)\", view.cid, request.status, request.readyState, item.get(\"original\"), request);\n\t\t\t\t\t\t\t\t\trequest.abort();\n\t\t\t\t\t\t\t\t\t// request.onprogress = void 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\titem.set(\"progress\", progress);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\tfunction(pUrl) {\n\t\t\t\t\t\t\t\titem.set({\n\t\t\t\t\t\t\t\t\t\"progress\": pUrl ? 1 : 0,\n\t\t\t\t\t\t\t\t\t\"prefetched\": pUrl\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treturn view;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfunction(err) {\n\t\t\t\t\t\t\t\titem.set({\n\t\t\t\t\t\t\t\t\t\"progress\": 0,\n\t\t\t\t\t\t\t\t\t\"error\": err\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treturn view;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}, Promise.resolve(view));\n\t},\n\n\t// _preloadAllItems2: function(view) {\n\t// \treturn view.sources.reduce(function(lastPromise, item, index, sources) {\n\t// \t\treturn lastPromise.then(function(view) {\n\t// \t\t\tvar itemView = view._getItemView(item);\n\t// \t\t\treturn _whenImageLoads(itemView.el).then(function(url){\n\t// \t\t\t\tview._updateItemProgress(1, index);\n\t// \t\t\t\treturn view;\n\t// \t\t\t}, function(err) {\n\t// \t\t\t\tview._updateItemProgress(0, index);\n\t// \t\t\t\titem.set(\"error\", err);\n\t// \t\t\t\treturn view;\n\t// \t\t\t});\n\t// \t\t});\n\t// \t}, Promise.resolve(view));\n\t// },\n\n\t_updateItemProgress: function(progress, index) {\n\t\tthis._sourceProgressByIdx[index] = progress;\n\t\tif (this.progressMeter) {\n\t\t\tthis.progressMeter.valueTo(\"available\", this._sourceProgressByIdx, 300);\n\t\t}\n\t},\n\n\t/* ---------------------------\n\t * PlayableRenderer implementation\n\t * --------------------------- */\n\n\t/** @override initial value */\n\t_playbackRequested: true,\n\n\t/** @type {Boolean} internal store */\n\t_paused: true,\n\n\t/** @override */\n\t_isMediaPaused: function() {\n\t\treturn this._paused;\n\t},\n\n\t/** @override */\n\t_playMedia: function() {\n\t\tif (!this._paused) return;\n\t\tthis._paused = false;\n\n\t\tif (!this._isMediaWaiting()) {\n\t\t\tif (this.timer.status === Timer.PAUSED) {\n\t\t\t\tthis.timer.start(); // resume, actually\n\t\t\t} else {\n\t\t\t\tthis.timer.start(this._sequenceInterval);\n\t\t\t}\n\t\t}\n\t},\n\n\t/** @override */\n\t_pauseMedia: function() {\n\t\tif (this._paused) return;\n\t\tthis._paused = true;\n\t\tif (this.timer.status === Timer.STARTED) {\n\t\t\tthis.timer.pause();\n\t\t}\n\t},\n\n\t// /** @override */\n\t// _renderPlaybackState: function() {\n\t// \t// if (!this.content.classList.contains(\"started\")) {\n\t// \t// \tthis.content.classList.add(\"started\");\n\t// \t// }\n\t// \tPlayableRenderer.prototype._renderPlaybackState.apply(this, arguments);\n\t// },\n\n\t/* --------------------------- *\n\t/* sequence private\n\t/* --------------------------- */\n\n\t_onTimerStart: function(duration) {\n\t\tvar item;\n\t\tif (this.sources.selectedIndex === -1) {\n\t\t\titem = this.model.get(\"source\");\n\t\t} else {\n\t\t\titem = this.sources.followingOrFirst();\n\t\t}\n\t\tthis.sources.select(item);\n\t\tthis.progressMeter.valueTo(\"amount\", this.sources.selectedIndex + 1, duration);\n\t\tthis.content.classList.toggle(\"playback-error\", item.has(\"error\"));\n\n\t\t// var currView = this.itemViews.findByModel(item);\n\t\t// if (!item.has(\"error\") && currView !== null) {\n\t\t// \tthis._playToggleSymbol.setImageSource(currView.el);\n\t\t// \t// this.updateOverlay(currView.el, this.playToggle);\n\t\t// } else {\n\t\t// \tthis._playToggleSymbol.setImageSource(null);\n\t\t// }\n\n\t\t// // init next renderer now to have smoother transitions\n\t\t// this._getItemView(this.sources.followingOrFirst());\n\t},\n\n\t_onTimerResume: function(duration) {\n\t\tthis.progressMeter.valueTo(\"amount\", this.sources.selectedIndex + 1, duration);\n\t},\n\n\t_onTimerPause: function(duration) {\n\t\tthis.progressMeter.valueTo(\"amount\", this.progressMeter.getRenderedValue(\"amount\"), 0);\n\t},\n\n\t/* last completely played sequence index */\n\t// _lastPlayedIndex: -1,\n\n\t_onTimerEnd: function() {\n\t\tvar nextItem, nextView;\n\n\t\tvar showNextView = function(result) {\n\t\t\t// console.log(\"%s::showNextView %sms %s\", context.cid, context._sequenceInterval, nextItem.cid)\n\t\t\tthis.setImmediate(function() {\n\t\t\t\tif (!this.mediaPaused) {\n\t\t\t\t\tthis.timer.start(this._sequenceInterval);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn result;\n\t\t}.bind(this);\n\n\t\t// get next item init next renderer\n\t\tnextItem = this.sources.followingOrFirst();\n\t\tnextView = this._getItemView(nextItem);\n\n\t\tif (nextItem.has(\"error\")) {\n\t\t\tshowNextView();\n\t\t} else if (nextItem.has(\"prefetched\")) {\n\t\t\t_whenImageLoads(nextView.el).then(showNextView, showNextView);\n\t\t} else {\n\t\t\t/* TODO: add ga event 'media-waiting' */\n\t\t\t// window.ga(\"send\", \"event\", \"sequence-item\", \"waiting\", this.model.get(\"text\"));\n\t\t\t// console.log(\"%s:[waiting] %sms %s\", context.cid, nextItem.cid);\n\t\t\tthis._toggleWaiting(true);\n\t\t\tthis.listenToOnce(nextItem, \"change:prefetched change:error\", function(model) {\n\t\t\t\t// console.log(\"%s:[playing] %sms %s\", context.cid, nextItem.cid);\n\t\t\t\tthis._toggleWaiting(false);\n\t\t\t\t_whenImageLoads(nextView.el).then(showNextView, showNextView);\n\t\t\t});\n\t\t}\n\t},\n\n\t_getItemView: function(item) {\n\t\tvar view = this.itemViews.findByModel(item);\n\t\tif (!view) {\n\t\t\tview = new(item.has(\"error\") ? SourceErrorRenderer : SequenceStepRenderer)({\n\t\t\t\tmodel: item\n\t\t\t});\n\t\t\tthis.itemViews.add(view);\n\t\t\tthis.sequence.appendChild(view.render().el);\n\t\t}\n\t\treturn view;\n\t},\n\n\t/* --------------------------- *\n\t/* progress meter\n\t/* --------------------------- */\n\n\t// _createDefaultItemData: function() {\n\t// \tvar canvas = document.createElement(\"canvas\");\n\t// \tvar context = canvas.getContext(\"2d\");\n\t// \tvar imageData = this._drawMediaElement(context).getImageData(0, 0, canvas.width, canvas.height);\n\t//\n\t// \tvar opts = { radius: 20 };\n\t// \tvar fgColor = new Color(this.model.attr(\"color\"));\n\t// \tvar bgColor = new Color(this.model.attr(\"background-color\"));\n\t// \tvar isFgDark = fgColor.luminosity() < bgColor.luminosity();\n\t// \topts.x00 = isFgDark? fgColor.clone().lighten(0.33) : bgColor.clone().darken(0.33);\n\t// \topts.xFF = isFgDark? bgColor.clone().lighten(0.33) : fgColor.clone().darken(0.33);\n\t//\n\t// \tstackBlurMono(imageData, opts);\n\t// \tduotone(imageData, opts);\n\t// \t// stackBlurRGB(imageData, opts);\n\t//\n\t// \tcontext.putImageData(imageData, 0, 0);\n\t// \treturn canvas.toDataURL();\n\t// },\n});\n\nif (DEBUG) {\n\tSequenceRenderer = (function(SequenceRenderer) {\n\t\tif (!SequenceRenderer.LOG_TO_SCREEN) return SequenceRenderer;\n\n\t\t// /** @type {module:underscore.strings/lpad} */\n\t\t// var rpad = require(\"underscore.string/rpad\");\n\t\t/** @type {module:underscore.strings/lpad} */\n\t\tvar lpad = require(\"underscore.string/lpad\");\n\t\t/** @type {module:underscore.strings/capitalize} */\n\t\tvar caps = require(\"underscore.string/capitalize\");\n\n\t\treturn SequenceRenderer.extend({\n\t\t\t/** @override */\n\t\t\tinitialize: function() {\n\t\t\t\tSequenceRenderer.prototype.initialize.apply(this, arguments);\n\n\t\t\t\tthis.__logColors = _.extend({\n\t\t\t\t\t\"media:play\": \"darkred\",\n\t\t\t\t\t\"media:pause\": \"darkred\",\n\n\t\t\t\t\t\"timer:start\": \"darkgreen\",\n\t\t\t\t\t\"timer:end\": \"darkgreen\",\n\t\t\t\t\t\"timer:resume\": \"green\",\n\t\t\t\t\t\"timer:pause\": \"green\",\n\n\t\t\t\t\t\"load:progress\": \"blue\",\n\t\t\t\t\t\"load:complete\": \"darkblue\"\n\t\t\t\t}, this.__logColors);\n\t\t\t},\n\n\t\t\t// __getHeaderText: function() {\n\t\t\t// \tvar fmt1 = function(s) {\n\t\t\t// \t\treturn lpad(caps(s), 8).substr(0, 8).toUpperCase();\n\t\t\t// \t};\n\t\t\t// \tvar fmt2 = function(s) {\n\t\t\t// \t\treturn lpad(caps(s), 8).substr(0, 8).toUpperCase();\n\t\t\t// \t};\n\t\t\t// \tvar o = {\n\t\t\t// \t\t\"tstamp\": fmt1,\n\t\t\t// \t\t\"index\": fmt2,\n\t\t\t// \t\t\"duration\": fmt1,\n\t\t\t// \t\t\"playback\": fmt1,\n\t\t\t// \t\t\"media\": fmt1,\n\t\t\t// \t\t\"timer\": fmt1,\n\t\t\t// \t\t\"next\": fmt1,\n\t\t\t// \t};\n\t\t\t// \treturn Object.keys(o).map(function(s, i, a) {\n\t\t\t// \t\treturn o[s](s);\n\t\t\t// \t}).join(\" \");\n\t\t\t// \t// Object.keys(o).reduce(function(ss, s, i, a) {\n\t\t\t// \t// \treturn ss + \" \" + lpad(caps(s), 8).substr(0, 8).toUpperCase();\n\t\t\t// \t// }, \"\");\n\t\t\t// },\n\n\t\t\t__getHeaderText: function() {\n\t\t\t\treturn [\n\t\t\t\t\t\"tstamp\",\n\t\t\t\t\t\"index\",\n\t\t\t\t\t\"duration\",\n\t\t\t\t\t\"playback\",\n\t\t\t\t\t\"media\",\n\t\t\t\t\t\"timer\",\n\t\t\t\t\t\"next\",\n\t\t\t\t].map(function(s, i, a) {\n\t\t\t\t\treturn lpad(caps(s), 8).substr(0, 8).toUpperCase();\n\t\t\t\t}).join(\" \");\n\t\t\t},\n\n\t\t\t__logTimerEvent: function(evname, msg) {\n\t\t\t\tvar logMsg = [\n\t\t\t\t\tthis.sources.selectedIndex,\n\t\t\t\t\t(this.timer.getDuration() * .001).toFixed(3),\n\t\t\t\t\tthis.playbackRequested ? \">>\" : \"::\",\n\t\t\t\t\tthis.mediaPaused ? \"paused\" :\n\t\t\t\t\t(this.mediaWaiting ? \"waiting\" : \"playing\"),\n\t\t\t\t\tthis.timer.getStatus(),\n\t\t\t\t\tthis.sources.followingOrFirst().has(\"prefetched\") ? \"ready\" : \"pending\"\n\t\t\t\t].map(function(s, i, a) {\n\t\t\t\t\treturn lpad(s, 8).substr(0, 8).toUpperCase();\n\t\t\t\t});\n\t\t\t\tmsg && logMsg.push(msg);\n\t\t\t\tlogMsg = logMsg.join(\" \");\n\n\t\t\t\tthis.__logMessage(logMsg, evname);\n\t\t\t\t// console.log(\"%s::[%s] %s\", this.cid, evname, logMsg);\n\t\t\t},\n\t\t\t_playMedia: function() {\n\t\t\t\tthis.__logTimerEvent(\"media:play\");\n\t\t\t\tSequenceRenderer.prototype._playMedia.apply(this, arguments);\n\t\t\t\t// this.__logTimerEvent(\"< media:play\");\n\t\t\t\t// console.log(\"%s::_playMedia()\", this.cid);\n\t\t\t},\n\t\t\t_pauseMedia: function() {\n\t\t\t\tthis.__logTimerEvent(\"media:pause\");\n\t\t\t\tSequenceRenderer.prototype._pauseMedia.apply(this, arguments);\n\t\t\t\t// this.__logTimerEvent(\"< media:pause\");\n\t\t\t\t// console.log(\"%s::_pauseMedia()\", this.cid);\n\t\t\t},\n\n\t\t\t_onTimerStart: function() {\n\t\t\t\tthis.__logTimerEvent(\"timer:start\");\n\t\t\t\tSequenceRenderer.prototype._onTimerStart.apply(this, arguments);\n\t\t\t},\n\t\t\t_onTimerResume: function() {\n\t\t\t\tthis.__logTimerEvent(\"timer:resume\");\n\t\t\t\tSequenceRenderer.prototype._onTimerResume.apply(this, arguments);\n\t\t\t},\n\t\t\t_onTimerPause: function() {\n\t\t\t\tthis.__logTimerEvent(\"timer:pause\");\n\t\t\t\tSequenceRenderer.prototype._onTimerPause.apply(this, arguments);\n\t\t\t},\n\t\t\t_onTimerEnd: function() {\n\t\t\t\tthis.__logTimerEvent(\"timer:end\");\n\t\t\t\tSequenceRenderer.prototype._onTimerEnd.apply(this, arguments);\n\t\t\t},\n\n\t\t\t_updateItemProgress: function(progress, srcIdx) {\n\t\t\t\tif (progress == 1) {\n\t\t\t\t\tthis.__logTimerEvent(\"load:complete\", \"item \" + srcIdx + \": complete\");\n\t\t\t\t} else\n\t\t\t\tif (srcIdx === this.sources.selectedIndex) {\n\t\t\t\t\tthis.__logTimerEvent(\"load:progress\", \"item \" + srcIdx + \": \" + progress);\n\t\t\t\t}\n\t\t\t\tSequenceRenderer.prototype._updateItemProgress.apply(this, arguments);\n\t\t\t},\n\n\t\t\t_preloadAllItems: function(view) {\n\t\t\t\tview.__logMessage(view.cid + \"::_preloadAllItems\", \"load:start\");\n\t\t\t\tSequenceRenderer.prototype._preloadAllItems.apply(view, arguments);\n\t\t\t},\n\t\t});\n\t})(SequenceRenderer);\n}\n\nmodule.exports = SequenceRenderer;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nvar partial$0 = require('../template/svg/FullscreenSymbol.hbs');\nHandlebarsCompiler.registerPartial('../template/svg/FullscreenSymbol.hbs', partial$0);\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper;\n\n  return \"<div class=\\\"placeholder sizing\\\"></div>\\n<div class=\\\"content media-border\\\">\\n\t<div class=\\\"controls content-size\\\">\\n\t\t<canvas class=\\\"progress-meter\\\"></canvas>\\n\t</div>\\n\t<div class=\\\"crop-box media-size\\\">\\n\t\t<video width=\\\"240\\\" height=\\\"180\\\" muted playsinline></video>\\n\t\t<img class=\\\"poster default\\\" alt=\\\"\"\n    + container.escapeExpression(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"text\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" width=\\\"240\\\" height=\\\"180\\\" />\\n\t</div>\\n\t<div class=\\\"overlay media-size play-toggle-hitarea\\\">\\n\t\t\t<canvas class=\\\"play-toggle\\\"></canvas>\\n\t\t<a class=\\\"fullscreen-toggle\\\" href=\\\"javascript:(void 0)\\\">\\n\"\n    + ((stack1 = container.invokePartial(partials[\"../template/svg/FullscreenSymbol.hbs\"],depth0,{\"name\":\"../template/svg/FullscreenSymbol.hbs\",\"data\":data,\"indent\":\"\\t\\t\\t\",\"helpers\":helpers,\"partials\":partials,\"decorators\":container.decorators})) != null ? stack1 : \"\")\n    + \"\t\t</a>\\n\t</div>\\n</div>\\n\";\n},\"usePartial\":true,\"useData\":true});\n",
    "/*global HTMLMediaElement, MediaError*/\n/**\n * @module app/view/render/VideoRenderer\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video\n * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement\n * @see https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Media_events\n * @see https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Using_HTML5_audio_and_video\n */\n\n/* --------------------------- *\n * Imports\n * --------------------------- */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/view/render/PlayableRenderer} */\nvar PlayableRenderer = require(\"app/view/render/PlayableRenderer\");\n/** @type {module:app/view/component/CanvasProgressMeter} */\nvar ProgressMeter = require(\"app/view/component/CanvasProgressMeter\");\n// /** @type {module:app/view/component/PlayToggleSymbol} */\nvar PlayToggleSymbol = require(\"app/view/component/PlayToggleSymbol\");\n\n// var stackBlurMono = require(\"utils/canvas/bitmap/stackBlurMono\");\n// var stackBlurRGB = require(\"utils/canvas/bitmap/stackBlurRGB\");\n\n// /** @type {module:utils/prefixedStyleName} */\n// var prefixedStyleName = require(\"utils/prefixedStyleName\");\n/** @type {module:utils/prefixedEvent} */\nvar prefixedEvent = require(\"utils/prefixedEvent\");\n\n// var whenViewIsAttached = require(\"app/view/promise/whenViewIsAttached\");\n// /** @type {Function} */\n// var whenSelectionDistanceIs = require(\"app/view/promise/whenSelectionDistanceIs\");\n\n/* --------------------------- *\n * private static\n * --------------------------- */\n\nvar fullscreenChangeEvent = prefixedEvent(\"fullscreenchange\", document);\n// var fullscreenErrorEvent = prefixedEvent(\"fullscreenerror\", document);\n\nvar formatTimecode = function(value) {\n\tif (isNaN(value)) return \"\"; //value = 0;\n\tif (value >= 3600) return ((value / 3600) | 0) + \"H\";\n\tif (value >= 60) return ((value / 60) | 0) + \"M\";\n\t// if (value >= 10) return \"0\" + (value | 0) + \"S\";\n\treturn (value | 0) + \"S\";\n};\n\nvar VIDEO_CROP_PX = Globals.VIDEO_CROP_PX;\nvar SYNC_TIMEOUT_MS = 1200;\nvar SYNC_THRESHOLD_MS = 100;\n\n/**\n * @constructor\n * @type {module:app/view/render/VideoRenderer}\n */\nvar VideoRenderer = PlayableRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"videoRenderer\",\n\t/** @type {string} */\n\tclassName: PlayableRenderer.prototype.className + \" video-item\",\n\t/** @type {Function} */\n\ttemplate: require(\"./VideoRenderer.hbs\"),\n\n\t// events: (function() {\n\t// \tvar ret = {};\n\t// \tret[PlayableRenderer.CLICK_EVENT + \" .fullscreen-toggle\"] = \"_onFullscreenToggle\";\n\t// \treturn ret;\n\t// }()),\n\n\t// events: function() {\n\t// \tvar events = {};\n\t// \tevents[PlayableRenderer.CLICK_EVENT + \" .fullscreen-toggle\"] = \"_onFullscreenToggle\";\n\t// \treturn _.extend(events, _.result(this, PlayableRenderer.prototype.events));\n\t// },\n\t// events: {\n\t// \t\"click .fullscreen-toggle\": \"_onFullscreenToggle\",\n\t// },\n\n\tproperties: {\n\t\tfullscreenToggle: {\n\t\t\t/** @return {HTMLElement} */\n\t\t\tget: function() {\n\t\t\t\treturn this._fullscreenToggle || (this._fullscreenToggle = this.el.querySelector(\".fullscreen-toggle\"));\n\t\t\t}\n\t\t},\n\t},\n\n\t/** @override */\n\tinitialize: function(opts) {\n\t\tPlayableRenderer.prototype.initialize.apply(this, arguments);\n\t\t_.bindAll(this,\n\t\t\t\"_updatePlaybackState\",\n\t\t\t\"_updateCurrTimeValue\",\n\t\t\t\"_updateBufferedValue\",\n\t\t\t\"_onMediaError\",\n\t\t\t\"_onMediaEnded\",\n\t\t\t// \"_onMediaPlayingOnce\",\n\t\t\t\"_onFullscreenChange\",\n\t\t\t\"_onFullscreenToggle\"\n\t\t);\n\t\t_.bindAll(this,\n\t\t\t\"_playbackTimeoutFn_playing\",\n\t\t\t\"_playbackTimeoutFn_waiting\"\n\t\t);\n\t\t// var onPeerSelect = function() {\n\t\t// \tthis.content.style.display = (this.getSelectionDistance() > 1)? \"none\": \"\";\n\t\t// };\n\t\t// this.listenTo(this.model.collection, \"select:one select:none\", onPeerSelect);\n\t\t// onPeerSelect();\n\t},\n\n\t/* --------------------------- *\n\t * children\n\t * --------------------------- */\n\n\t/** @override */\n\tcreateChildren: function() {\n\t\tPlayableRenderer.prototype.createChildren.apply(this, arguments);\n\n\t\tthis.placeholder = this.el.querySelector(\".placeholder\");\n\t\t// this.overlay = this.content.querySelector(\".overlay\");\n\t\tthis.video = this.content.querySelector(\"video\");\n\t\t// this.video.loop = this.model.attrs().hasOwnProperty(\"@video-loop\");\n\n\t\t// this.video.setAttribute(\"muted\", \"muted\");\n\t\t// this.video.setAttribute(\"playsinline\", \"playsinline\");\n\t\t// if (this.model.attr(\"@video-loop\") !== void 0) {\n\t\t// \tthis.video.setAttribute(\"loop\", \"loop\");\n\t\t// }\n\t\tthis.video.setAttribute(\"preload\", \"none\");\n\t\tif (this.video.controlList) this.video.controlList.add(\"nodownload\");\n\n\t\t// this.video.muted = true;\n\t\t// this.video.playsinline = true;\n\t\t// this.video.preload = \"auto\";\n\t\tthis.video.loop = this.model.attr(\"@video-loop\") !== void 0;\n\t\tthis.video.src = this.findPlayableSource(this.video);\n\t},\n\n\t/* --------------------------- *\n\t * layout/render\n\t * --------------------------- */\n\n\tmeasure: function() {\n\t\tPlayableRenderer.prototype.measure.apply(this, arguments);\n\n\t\t// NOTE: Vertical 1px video crop\n\t\t// - Cropped in CSS: video, .poster { margin-top: -1px; margin-bottom: -1px;}\n\t\t// - Cropped height is adjusted in metrics obj\n\t\t// - Crop amount added back to actual video on render()\n\t\tthis.metrics.media.height += VIDEO_CROP_PX * 2;\n\t\tthis.metrics.content.height += VIDEO_CROP_PX * 2;\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tPlayableRenderer.prototype.render.apply(this, arguments);\n\n\t\tvar els, el, i, cssW, cssH;\n\t\tvar img = this.defaultImage;\n\t\tvar content = this.content;\n\n\t\t// media-size\n\t\t// ---------------------------------\n\t\tcssW = this.metrics.media.width + \"px\";\n\t\tcssH = this.metrics.media.height + \"px\";\n\n\t\tels = this.el.querySelectorAll(\".media-size\");\n\t\tfor (i = 0; i < els.length; i++) {\n\t\t\tel = els.item(i);\n\t\t\tel.style.width = cssW;\n\t\t\tel.style.height = cssH;\n\t\t}\n\n\t\tcontent.style.width = cssW;\n\t\tcontent.style.height = (this.metrics.media.height + VIDEO_CROP_PX) + \"px\";\n\n\t\t// content-position\n\t\t// ---------------------------------\n\t\tvar cssX, cssY;\n\t\tcssX = this.metrics.content.x + \"px\";\n\t\tcssY = this.metrics.content.y + \"px\";\n\t\tcontent.style.left = cssX;\n\t\tcontent.style.top = cssY;\n\n\t\tel = this.el.querySelector(\".controls\");\n\t\t// el.style.left = cssX;\n\t\t// controls.style.top = cssY;\n\t\tel.style.width = this.metrics.content.width + \"px\";\n\t\tel.style.height = this.metrics.content.height + \"px\";\n\n\t\t// // content-size\n\t\t// // ---------------------------------\n\t\t// cssW = this.metrics.content.width + \"px\";\n\t\t// cssH = this.metrics.content.height + \"px\";\n\t\t//\n\t\t// els = this.el.querySelectorAll(\".content-size\");\n\t\t// for (i = 0; i < els.length; i++) {\n\t\t// \tel = els.item(i);\n\t\t// \tel.style.width = cssW;\n\t\t// \tel.style.height = cssH;\n\t\t// }\n\n\t\t// NOTE: elements below must use video's UNCROPPED height, so +2px\n\t\tthis.video.setAttribute(\"width\", this.metrics.media.width);\n\t\tthis.video.setAttribute(\"height\", this.metrics.media.height - VIDEO_CROP_PX * 2);\n\t\timg.setAttribute(\"width\", this.metrics.media.width);\n\t\timg.setAttribute(\"height\", this.metrics.media.height - VIDEO_CROP_PX * 2);\n\n\t\treturn this;\n\t},\n\n\t/* --------------------------- *\n\t * initializeAsync\n\t * --------------------------- */\n\n\tinitializeAsync: function() {\n\t\treturn Promise.resolve(this)\n\t\t\t.then(PlayableRenderer.whenSelectionIsContiguous)\n\t\t\t.then(PlayableRenderer.whenScrollingEnds)\n\t\t\t.then(PlayableRenderer.whenViewIsAttached)\n\t\t\t.then(\n\t\t\t\tfunction(view) {\n\t\t\t\t\t// console.log(\"%s::initializeAsync [attached, scrollend, selected > %o, preload:%s] ('%o')\", view.cid, view.model.getDistanceToSelected(), view.video.preload, view.model.get(\"name\"));\n\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\tPlayableRenderer.whenDefaultImageLoads(view),\n\t\t\t\t\t\tview.whenVideoHasMetadata(view),\n\t\t\t\t\t]).then(function() {\n\t\t\t\t\t\treturn view;\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t.then(\n\t\t\t\tfunction(view) {\n\t\t\t\t\t// console.log(\"%s::initializeAsync [defaultImage, preload:%s] ('%o')\", view.cid, view.video.preload, view.model.get(\"name\"));\n\t\t\t\t\tview.initializePlayable();\n\t\t\t\t\t// view.updateOverlay(view.defaultImage, view.playToggle); //view.overlay);\n\t\t\t\t\tview.listenToSelection();\n\t\t\t\t\treturn view;\n\t\t\t\t});\n\n\t\t// videoEl.setAttribute(\"preload\", \"metadata\");\n\t},\n\n\tinitializePlayable: function() {\n\t\t// When selected for the first time\n\t\t// ---------------------------------\n\t\tPlayableRenderer.whenSelectionDistanceIs(this, 0)\n\t\t\t.then(function(view) {\n\t\t\t\tview.video.setAttribute(\"preload\", \"auto\");\n\t\t\t\tview.video.preload = \"auto\";\n\t\t\t\t// console.log(\"%s::initializeAsync [selected, preload:%s] ('%o')\", view.cid, view.video.preload, view.model.get(\"name\"));\n\t\t\t\treturn view;\n\t\t\t})\n\t\t\t.catch(function(reason) {\n\t\t\t\tif (reason instanceof PlayableRenderer.ViewError) {\n\t\t\t\t\tconsole.log(\"%s::%s\", reason.view.cid, reason.message);\n\t\t\t\t} else {\n\t\t\t\t\tconsole.warn(reason);\n\t\t\t\t\t// return Promise.reject(reason);\n\t\t\t\t}\n\t\t\t});\n\t\t// play-toggle-symbol\n\t\t// ---------------------------------\n\t\tthis._playToggleSymbol = new PlayToggleSymbol(_.extend({\n\t\t\tel: this.el.querySelector(\".play-toggle\")\n\t\t}, this._playToggleSymbol || {}));\n\n\t\t// this._playToggleSymbol.setImageSource(this.defaultImage, 0, 0);\n\t\t// this.listenToElementOnce(this.video, \"timeupdate\", function(ev) {\n\t\t// \tthis._playToggleSymbol.setImageSource(this.video);\n\t\t// });\n\n\t\t// progress-meter\n\t\t// ---------------------------------\n\t\tthis.progressMeter = new ProgressMeter({\n\t\t\tel: this.el.querySelector(\".progress-meter\"),\n\t\t\tcolor: this.model.attr(\"color\"),\n\t\t\t// backgroundColor: this.model.attr(\"background-color\"),\n\t\t\tmaxValues: {\n\t\t\t\tamount: this.video.duration,\n\t\t\t\tavailable: this.video.duration,\n\t\t\t},\n\t\t\tlabelFn: (function(value, total) {\n\t\t\t\tif (!this._started || this.video.ended || isNaN(value)) {\n\t\t\t\t\treturn formatTimecode(total);\n\t\t\t\t} else if (!this.playbackRequested) {\n\t\t\t\t\treturn Globals.PAUSE_CHAR;\n\t\t\t\t} else {\n\t\t\t\t\treturn formatTimecode(total - value);\n\t\t\t\t}\n\t\t\t}).bind(this)\n\t\t});\n\t\t// this.el.querySelector(\".controls\").appendChild(this.progressMeter.el);\n\t\t// var el = this.el.querySelector(\".progress-meter\");\n\t\t// el.parentNode.replaceChild(this.progressMeter.el, el);\n\t\t// var parentEl = this.el.querySelector(\".controls\");\n\t\t// parentEl.insertBefore(this.progressMeter.el, parentEl.firstChild);\n\n\t\t// this._setPlayToggleSymbol(\"play-symbol\");\n\t\tthis._renderPlaybackState();\n\n\t\t// listen to video events\n\t\t// ---------------------------------\n\t\t// this.video.poster = this.model.get(\"source\").get(\"original\");\n\t\tthis.addMediaListeners();\n\t},\n\n\t/* --------------------------- *\n\t * whenVideoHasMetadata promise\n\t * --------------------------- */\n\n\twhenVideoHasMetadata: function(view) {\n\t\t// NOTE: not pretty !!!\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tvar videoEl = view.video;\n\t\t\tvar eventHandlers = {\n\t\t\t\tloadedmetadata: function(ev) {\n\t\t\t\t\tif (ev) removeEventListeners();\n\t\t\t\t\t// console.log(\"%s::whenVideoHasMetadata [%s] %s\", view.cid, \"resolved\", ev ? ev.type : \"sync\");\n\t\t\t\t\tresolve(view);\n\t\t\t\t},\n\t\t\t\tabort: function(ev) {\n\t\t\t\t\tif (ev) removeEventListeners();\n\t\t\t\t\treject(new PlayableRenderer.ViewError(view, new Error(\"whenVideoHasMetadata: view was removed\")));\n\t\t\t\t},\n\t\t\t\terror: function(ev) {\n\t\t\t\t\tif (ev) removeEventListeners();\n\t\t\t\t\tvar err;\n\t\t\t\t\tif (videoEl.error) {\n\t\t\t\t\t\terr = new Error(_.invert(MediaError)[videoEl.error.code]);\n\t\t\t\t\t\terr.infoCode = videoEl.error.code;\n\t\t\t\t\t} else {\n\t\t\t\t\t\terr = new Error(\"Unspecified error\");\n\t\t\t\t\t}\n\t\t\t\t\terr.infoSrc = videoEl.src;\n\t\t\t\t\terr.logMessage = \"whenVideoHasMetadata: \" + err.name + \" \" + err.infoSrc;\n\t\t\t\t\terr.logEvent = ev;\n\t\t\t\t\treject(err);\n\t\t\t\t},\n\t\t\t};\n\n\t\t\t//  (videoEl.preload == \"auto\" && videoEl.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA)\n\t\t\t// \t(videoEl.preload == \"metadata\" && videoEl.readyState >= HTMLMediaElement.HAVE_METADATA)\n\n\t\t\tif (videoEl.error) {\n\t\t\t\teventHandlers.error();\n\t\t\t} else if (videoEl.readyState >= HTMLMediaElement.HAVE_METADATA) {\n\t\t\t\teventHandlers.loadedmetadata();\n\t\t\t} else {\n\t\t\t\tvar sources = videoEl.querySelectorAll(\"source\");\n\t\t\t\tvar errTarget = sources.length > 0 ? sources.item(sources.length - 1) : videoEl;\n\t\t\t\tvar errCapture = errTarget === videoEl; // use capture with HTMLMediaElement\n\n\t\t\t\tvar removeEventListeners = function() {\n\t\t\t\t\terrTarget.removeEventListener(\"error\", eventHandlers.error, errCapture);\n\t\t\t\t\tfor (var ev in eventHandlers) {\n\t\t\t\t\t\tif (ev !== \"error\" && eventHandlers.hasOwnProperty(ev)) {\n\t\t\t\t\t\t\tvideoEl.removeEventListener(ev, eventHandlers[ev], false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\terrTarget.addEventListener(\"error\", eventHandlers.error, errCapture);\n\t\t\t\tfor (var ev in eventHandlers) {\n\t\t\t\t\tif (ev !== \"error\" && eventHandlers.hasOwnProperty(ev)) {\n\t\t\t\t\t\tvideoEl.addEventListener(ev, eventHandlers[ev], false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t/* NOTE: MS Edge ignores js property, using setAttribute */\n\t\t\t\tvideoEl.setAttribute(\"preload\", \"metadata\");\n\t\t\t\tvideoEl.preload = \"metadata\";\n\n\t\t\t\t// videoEl.setAttribute(\"poster\", view.get(\"source\").get(\"original\"));\n\t\t\t\t// videoEl.setAttribute(\"preload\", \"metadata\");\n\t\t\t\t// videoEl.poster = view.model.get(\"source\").get(\"original\");\n\t\t\t\t// videoEl.loop = view.model.attr(\"@video-loop\") !== void 0;\n\t\t\t\t// videoEl.src = view.findPlayableSource(videoEl);\n\t\t\t\t// videoEl.load();\n\n\t\t\t\t// console.log(\"%s::whenVideoHasMetadata [preload:%s]\", view.cid, videoEl.preload);\n\t\t\t}\n\t\t});\n\t},\n\n\tfindPlayableSource: function(video) {\n\t\tvar playable = this.model.get(\"sources\").find(function(source) {\n\t\t\treturn /^video\\//.test(source.get(\"mime\")) && video.canPlayType(source.get(\"mime\")) != \"\";\n\t\t});\n\t\treturn playable ? playable.get(\"original\") : \"\";\n\t},\n\n\t/* ---------------------------\n\t * PlayableRenderer implementation\n\t * --------------------------- */\n\n\t// /** @override */\n\t// _canResumePlayback: function() {\n\t// \treturn PlayableRenderer.prototype._canResumePlayback.apply(this, arguments) && this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA;\n\t// },\n\n\t/** @override initial value */\n\t_playbackRequested: false,\n\n\t/** @override */\n\t_isMediaPaused: function() {\n\t\treturn this.video.paused;\n\t},\n\n\t/** @override */\n\t_playMedia: function() {\n\t\tif (this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA && this.video.seekable.length == 0) {\n\t\t\tconsole.warn(this.cid, \"WTF! got video data, but cannot seek, calling load()\");\n\t\t\t// this._logMessage(\"call:load\", \"got video data, but cannot seek, calling load()\", \"orange\");\n\t\t\tif (_.isFunction(this.video.load)) {\n\t\t\t\tthis.video.load();\n\t\t\t}\n\t\t}\n\t\t/* NOTE: loop is false, restart from end on request */\n\t\telse if (this.video.ended) {\n\t\t\tthis.video.currentTime = this.video.seekable.start(0);\n\t\t}\n\n\t\t/* if not enough data */\n\t\tif (this.video.readyState < HTMLMediaElement.HAVE_ENOUGH_DATA) {\n\t\t\tif (this.video.networkState == HTMLMediaElement.NETWORK_IDLE) {\n\t\t\t\tthis.video.load();\n\t\t\t} //else {\n\t\t\t// var _playStamp = this._playbackCount;\n\t\t\t// console.log(\"%s::_playMedia %s waiting [#%s]\", this.cid, this._isMediaWaiting() ? \"continue\" : \"begin\", _playStamp);\n\t\t\t//\n\t\t\t// this.listenToElementOnce(this.video, \"canplaythrough\", function(ev) {\n\t\t\t// \tconsole.log(\"%s::_playMedia end waiting [#%s]\", this.cid, _playStamp);\n\t\t\t//\n\t\t\t// \tthis._toggleWaiting(false);\n\t\t\t// \t// this.playbackRequested && this.video.play();\n\t\t\t// \tthis._validatePlayback();\n\t\t\t// });\n\t\t\t//}\n\t\t\t/* NOTE: on \"canplaythrough\" _playMedia() will be called again if still required */\n\t\t\tthis._toggleWaiting(true);\n\t\t}\n\t\t/* play */\n\t\telse {\n\t\t\t/* NOTE: current browsers return a promise */\n\t\t\tthis.video.play();\n\t\t}\n\t},\n\n\t/** @override */\n\t_pauseMedia: function() {\n\t\t// this._setPlayToggleSymbol(\"play-symbol\");\n\t\tthis.video.pause();\n\t\t// this._renderPlaybackState();\n\t},\n\n\t/* ---------------------------\n\t/* DOM events\n\t/* --------------------------- */\n\n\t_listenWhileSelected: function() {\n\t\tPlayableRenderer.prototype._listenWhileSelected.apply(this, arguments);\n\t\tthis.fullscreenToggle.addEventListener(\n\t\t\tthis._toggleEvent, this._onFullscreenToggle, false);\n\t},\n\n\t_stopListeningWhileSelected: function() {\n\t\tPlayableRenderer.prototype._stopListeningWhileSelected.apply(this, arguments);\n\t\tthis.fullscreenToggle.removeEventListener(\n\t\t\tthis._toggleEvent, this._onFullscreenToggle, false);\n\t},\n\n\t/* ---------------------------\n\t/* media events\n\t/* --------------------------- */\n\n\taddMediaListeners: function() {\n\t\t// if (!this._started) {\n\t\t// \tthis.addListeners(this.video, this.playingOnceEvents, this._onMediaPlayingOnce);\n\t\t// }\n\t\tthis.addListeners(this.video, this.updatePlaybackEvents, this._updatePlaybackState);\n\t\tthis.addListeners(this.video, this.updateBufferedEvents, this._updateBufferedValue);\n\t\tthis.addListeners(this.video, this.updateCurrTimeEvents, this._updateCurrTimeValue);\n\t\tthis.video.addEventListener(\"ended\", this._onMediaEnded, false);\n\t\tthis.video.addEventListener(\"error\", this._onMediaError, true);\n\n\t\tthis.on(\"view:removed\", this.removeMediaListeners, this);\n\t},\n\n\tremoveMediaListeners: function() {\n\t\tthis.off(\"view:removed\", this.removeMediaListeners, this);\n\n\t\t// if (!this._started) {\n\t\t// \tthis.removeListeners(this.video, this.playingOnceEvents, this._onMediaPlayingOnce);\n\t\t// }\n\t\tthis.removeListeners(this.video, this.updatePlaybackEvents, this._updatePlaybackState);\n\t\tthis.removeListeners(this.video, this.updateBufferedEvents, this._updateBufferedValue);\n\t\tthis.removeListeners(this.video, this.updateCurrTimeEvents, this._updateCurrTimeValue);\n\t\tthis.video.removeEventListener(\"ended\", this._onMediaEnded, false);\n\t\tthis.video.removeEventListener(\"error\", this._onMediaError, true);\n\t},\n\n\t/* ---------------------------\n\t/* media event handlers\n\t/* --------------------------- */\n\n\t_onMediaError: function(ev) {\n\t\tthis.removeMediaListeners();\n\t\tthis.removeSelectionListeners();\n\n\t\tthis._started = false;\n\t\tthis.content.classList.remove(\"started\");\n\n\t\tthis.mediaState = \"error\";\n\t\tthis.playbackRequested = false;\n\t\t// this.content.classList.remove(\"ended\");\n\t\t// this.content.classList.remove(\"waiting\");\n\t\tthis._exitFullscreen();\n\t},\n\n\t_onMediaEnded: function(ev) {\n\t\tthis.playbackRequested = false;\n\t\tthis._exitFullscreen();\n\t},\n\n\t_exitFullscreen: function() {\n\t\t/* NOTE: polyfill should handle this on iOS? */\n\t\tif (this.video.webkitDisplayingFullscreen) {\n\t\t\tthis.video.webkitExitFullscreen();\n\t\t}\n\t\tif (document.fullscreenElement === this.video) {\n\t\t\tthis.video.exitFullscreen();\n\t\t}\n\t},\n\n\t/* ---------------------------\n\t/* _onMediaPlayingOnce\n\t/* --------------------------- */\n\n\t// playingOnceEvents: \"playing waiting\",\n\t//\n\t// _onMediaPlayingOnce: function(ev) {\n\t// \tthis.removeListeners(this.video, this.playingOnceEvents, this._onMediaPlayingOnce);\n\t// \tif (!this._started) {\n\t// \t\tthis._started = true;\n\t// \t\tthis.content.classList.add(\"started\");\n\t// \t}\n\t// },\n\n\t/* ---------------------------\n\t/* _updateCurrTimeValue\n\t/* --------------------------- */\n\n\tupdateCurrTimeEvents: \"playing waiting pause timeupdate seeked\", //.split(\" \"),\n\n\t_updateCurrTimeValue: function(ev) {\n\t\tif (this.video.played.length) {\n\t\t\tthis.content.classList.add(\"started\");\n\t\t}\n\t\tif (this.progressMeter) {\n\t\t\tthis.progressMeter.valueTo(\"amount\", this.video.currentTime, 0);\n\t\t}\n\t},\n\n\t/* ---------------------------\n\t/* _updatePlaybackState\n\t/* --------------------------- */\n\n\t// updatePlaybackEvents: \"playing play waiting pause seeking seeked ended\",\n\tupdatePlaybackEvents: \"timeupdate playing pause waiting canplaythrough seeked\",\n\n\t_isPlaybackWaiting: false,\n\t_playbackStartTS: -1,\n\t_playbackStartTC: -1,\n\n\t_updatePlaybackState: function(ev) {\n\t\t// var isWaiting = false;\n\t\t// var symbolName = \"play-symbol\";\n\n\t\t// NOTE: clearTimeout will cancel both setTimeout and setInterval IDs\n\t\twindow.clearTimeout(this._playbackTimeoutID);\n\t\tthis._playbackTimeoutID = -1;\n\n\t\tif (this.playbackRequested) {\n\t\t\tif (ev.type !== \"timeupdate\") {\n\t\t\t\tthis._playbackStartTS = ev.timeStamp;\n\t\t\t\tthis._playbackStartTC = this.video.currentTime;\n\t\t\t}\n\t\t\tswitch (ev.type) {\n\t\t\t\tcase \"timeupdate\":\n\t\t\t\t\tif (SYNC_THRESHOLD_MS < Math.abs((ev.timeStamp - this._playbackStartTS) -\n\t\t\t\t\t\t\t((this.video.currentTime - this._playbackStartTC) * 1000))) {\n\t\t\t\t\t\tthis._playbackStartTS = ev.timeStamp;\n\t\t\t\t\t\tthis._playbackStartTC = this.video.currentTime;\n\t\t\t\t\t\tthis._playbackTimeoutID =\n\t\t\t\t\t\t\twindow.setTimeout(this._playbackTimeoutFn_waiting, SYNC_TIMEOUT_MS);\n\t\t\t\t\t\tthis._toggleWaiting(true);\n\t\t\t\t\t\t// break;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._playbackTimeoutID =\n\t\t\t\t\t\t\twindow.setTimeout(this._playbackTimeoutFn_playing, SYNC_TIMEOUT_MS);\n\t\t\t\t\t\tthis._toggleWaiting(false);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"playing\":\n\t\t\t\t\tthis._playbackStartTS = ev.timeStamp;\n\t\t\t\t\tthis._playbackStartTC = this.video.currentTime;\n\t\t\t\t\tthis._playbackTimeoutID = window.setTimeout(this._playbackTimeoutFn_playing, SYNC_TIMEOUT_MS);\n\t\t\t\t\tthis._toggleWaiting(false);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"pause\":\n\t\t\t\t\t/* NOTE: this.playbackRequested is true, the pause wasn't triggered\n\t\t\t\t\t * from UI, but by the waiting handler below, so we treat it as\n\t\t\t\t\t * waiting */\n\t\t\t\t\t// if (!this.playbackRequested) {\n\t\t\t\t\t// \tthis._toggleWaiting(false);\n\t\t\t\t\t// }\n\t\t\t\t\tthis._toggleWaiting(this.playbackRequested);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"canplaythrough\":\n\t\t\t\t\tthis._toggleWaiting(false);\n\t\t\t\t\tthis._validatePlayback();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"waiting\":\n\t\t\t\t\t/* NOTE: if the video is seeking, give it a chance to resume, so do\n\t\t\t\t\t * nothing, and handle things on seeked/playing */\n\t\t\t\t\tif (!this.video.seeking) {\n\t\t\t\t\t\t/* if not enough data */\n\t\t\t\t\t\tif (this.video.readyState < HTMLMediaElement.HAVE_ENOUGH_DATA) {\n\t\t\t\t\t\t\tthis.video.pause();\n\n\t\t\t\t\t\t\t// this.listenToElementOnce(this.video, \"canplaythrough\", function() {\n\t\t\t\t\t\t\t// \tthis._toggleWaiting(false);\n\t\t\t\t\t\t\t// \tthis._validatePlayback();\n\t\t\t\t\t\t\t// this.playbackRequested && this.video.play();\n\t\t\t\t\t\t\t// });\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._toggleWaiting(true);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthis._toggleWaiting(false);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\t\t\tthis._toggleWaiting(false);\n\t\t}\n\t},\n\n\t_playbackTimeoutID: -1,\n\t_playbackTimeoutFn_playing: function() {\n\t\tthis._playbackTimeoutID = -1;\n\n\t\tthis._toggleWaiting(true);\n\t\t// this._renderPlaybackState();\n\n\t\t// this._setPlayToggleSymbol(\"waiting-symbol\");\n\t\t// this.content.classList.add(\"waiting\");\n\t\t// this.progressMeter.stalled = true;\n\t\t// this._isPlaybackWaiting = true;\n\t},\n\n\t_playbackTimeoutFn_waiting: function() {\n\t\tif (SYNC_THRESHOLD_MS < (this.video.currentTime - this._playbackStartTC) * 1000) {\n\t\t\tthis._playbackTimeoutID =\n\t\t\t\twindow.setTimeout(this._playbackTimeoutFn_waiting, SYNC_TIMEOUT_MS);\n\t\t} else {\n\t\t\t// since there is no event.timeStamp\n\t\t\t// var delta = this.video.currentTime - this._playbackStartTC;\n\t\t\t// this._playbackStartTS += delta * 1000;\n\t\t\t// this._playbackStartTS = window.performance.now();\n\t\t\tthis._playbackStartTS += SYNC_TIMEOUT_MS;\n\t\t\tthis._playbackStartTC = this.video.currentTime;\n\t\t\tthis._playbackTimeoutID =\n\t\t\t\twindow.setTimeout(this._playbackTimeoutFn_playing, SYNC_TIMEOUT_MS);\n\n\t\t\tthis._toggleWaiting(false);\n\t\t\t// this._renderPlaybackState();\n\n\t\t\t// this._setPlayToggleSymbol(\"pause-symbol\");\n\t\t\t// this.content.classList.remove(\"waiting\");\n\t\t\t// this.progressMeter.stalled = false;\n\t\t\t// this._isPlaybackWaiting = false;\n\t\t}\n\t},\n\n\t/** @override */\n\t_renderPlaybackState: function() {\n\t\t// if (DEBUG) {\n\t\t// \tthis.__logMessage([\n\t\t// \t\"mediaState:\", this.mediaState,\n\t\t// \t\"played:\", this.video.played.length,\n\t\t// \t\"ended:\", this.video.ended,\n\t\t// \t\"toggle.paused:\", this._playToggleSymbol.paused\n\t\t// ].join(\" \"), \"_renderPlaybackState\");\n\t\t// }\n\t\t// console.log(\"%s::_renderPlaybackState mediaState:%s played:%o ended:%o\",\n\t\t// \tthis.cid, this.mediaState, this.video.played.length, this.video.ended);\n\t\t//\n\t\t// if (this.mediaState === \"ready\") {\n\t\t// \tthis.updateOverlay(this.video, this.playToggle);\n\t\t// }\n\n\t\tvar cls = this.content.classList;\n\t\t// if (!this._started && this.playbackRequested &&\n\t\t// \t\tthis.video.readyState === HTMLMediaElement.HAVE_ENOUGH_DATA) {\n\t\t// \tthis._started = true;\n\t\t// \tcls.add(\"started\");\n\t\t// }\n\t\t// cls.toggle(\"started\", (this.video.played.length > 0));\n\t\tcls.toggle(\"ended\", this.video.ended);\n\n\t\tPlayableRenderer.prototype._renderPlaybackState.apply(this, arguments);\n\t},\n\n\t_setPlayToggleSymbol: function(symbolName) {\n\t\t// if (this.video.ended) {\n\t\t// \tconsole.log(\"%s::_setPlayToggleSymbol %s -> ended\", this.cid, symbolName);\n\t\t// }\n\t\t// if (this.mediaState === \"ready\") {\n\t\t// \tif (this.playbackRequested && !this._isMediaWaiting()) {\n\t\t// \t\tthis._playToggleSymbol.setImageSource(null);\n\t\t// \t} else {\n\t\t// \t\tthis._playToggleSymbol.setImageSource(this.video);\n\t\t// \t}\n\t\t// \tthis._playToggleSymbol.refreshImageSource();\n\t\t// }\n\t\treturn PlayableRenderer.prototype._setPlayToggleSymbol.call(this, this.video.ended ? \"ended\" : symbolName);\n\t},\n\n\t/* ---------------------------\n\t/* _updateBufferedValue\n\t/* --------------------------- */\n\n\t// updateBufferedEvents: \"progress canplay canplaythrough playing timeupdate\",//loadeddata\n\tupdateBufferedEvents: \"progress canplay canplaythrough play playing\",\n\n\t_updateBufferedValue: function(ev) {\n\t\t// if (!this._started) return;\n\t\tvar bRanges = this.video.buffered;\n\t\tif (bRanges.length > 0) {\n\t\t\tthis._bufferedValue = bRanges.end(bRanges.length - 1);\n\t\t\tif (this.progressMeter && ((this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) /*|| (this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA && this.video.networkState == HTMLMediaElement.NETWORK_LOADING)*/ )) {\n\t\t\t\tthis.progressMeter.valueTo(\"available\", this._bufferedValue, 300);\n\t\t\t\t// this.progressMeter.valueTo(\"available\", this._bufferedValue, Math.max(0, 1000 * (this._bufferedValue - (this.progressMeter.getTargetValue(\"available\") | 0))));\n\t\t\t}\n\t\t}\n\t},\n\n\t/* ---------------------------\n\t/* fullscreen api\n\t/* --------------------------- */\n\n\t_onFullscreenToggle: function(ev) {\n\t\t// NOTE: Ignore if MouseEvent.button is 0 or undefined (0: left-button)\n\t\tif (!ev.defaultPrevented && !ev.button && this.model.selected) {\n\t\t\tev.preventDefault();\n\t\t\ttry {\n\t\t\t\tif (document.hasOwnProperty(\"fullscreenElement\") &&\n\t\t\t\t\tdocument.fullscreenElement !== this.video) {\n\t\t\t\t\tdocument.addEventListener(fullscreenChangeEvent, this._onFullscreenChange, false);\n\t\t\t\t\tthis.video.requestFullscreen();\n\t\t\t\t} else\n\t\t\t\tif (this.video.webkitSupportsFullscreen && !this.video.webkitDisplayingFullscreen) {\n\t\t\t\t\tthis.video.addEventListener(\"webkitbeginfullscreen\", this._onFullscreenChange, false);\n\t\t\t\t\tthis.video.webkitEnterFullScreen();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tthis.video.controls = false;\n\t\t\t\tconsole.error(err);\n\t\t\t}\n\t\t}\n\t},\n\n\t_onFullscreenChange: function(ev) {\n\t\tswitch (ev.type) {\n\t\t\tcase fullscreenChangeEvent:\n\t\t\t\t// var isOwnFullscreen = Modernizr.prefixed(\"fullscreenElement\", document) === this.video;\n\t\t\t\tvar isOwnFullscreen = document.fullscreenElement === this.video;\n\t\t\t\tthis.video.controls = isOwnFullscreen;\n\t\t\t\tif (!isOwnFullscreen) {\n\t\t\t\t\tdocument.removeEventListener(fullscreenChangeEvent, this._onFullscreenChange, false);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"webkitbeginfullscreen\":\n\t\t\t\tthis.video.controls = true;\n\t\t\t\tthis.video.removeEventListener(\"webkitbeginfullscreen\", this._onFullscreenChange, false);\n\t\t\t\tthis.video.addEventListener(\"webkitendfullscreen\", this._onFullscreenChange, false);\n\t\t\t\tbreak;\n\t\t\tcase \"webkitendfullscreen\":\n\t\t\t\tthis.video.removeEventListener(\"webkitendfullscreen\", this._onFullscreenChange, false);\n\t\t\t\tthis.video.controls = false;\n\t\t\t\tbreak;\n\t\t}\n\t},\n});\nmodule.exports = VideoRenderer;\n\n/* ---------------------------\n/* log to screen\n/* --------------------------- */\nif (DEBUG) {\n\tmodule.exports = (function(VideoRenderer) {\n\t\tif (!VideoRenderer.LOG_TO_SCREEN) return VideoRenderer;\n\n\t\t/** @type {Function} */\n\t\tvar Color = require(\"color\");\n\t\t/** @type {module:underscore.strings/lpad} */\n\t\tvar lpad = require(\"underscore.string/lpad\");\n\t\t/** @type {module:underscore.strings/rpad} */\n\t\tvar rpad = require(\"underscore.string/rpad\");\n\n\t\t// var fullscreenEvents = [\n\t\t// \tfullscreenChangeEvent, fullscreenErrorEvent,\n\t\t// \t\"webkitbeginfullscreen\", \"webkitendfullscreen\",\n\t\t// ];\n\n\t\tvar mediaEvents = require(\"utils/event/mediaEventsEnum\");\n\t\tvar logPlaybackStateEvents, logBufferedEvents, logPlayedEvents;\n\n\t\t// logPlaybackStateEvents = [\"playing\", \"waiting\", \"ended\", \"pause\", \"seeking\", \"seeked\"];\n\t\t// logBufferedEvents = [\"progress\", \"durationchange\", \"canplay\", \"play\"];\n\t\t// logPlayedEvents = [\"playing\", \"timeupdate\"];\n\n\t\tlogPlaybackStateEvents = [\n\t\t\t\"loadstart\",\n\t\t\t\"progress\",\n\t\t\t\"suspend\",\n\t\t\t\"abort\",\n\t\t\t\"error\",\n\t\t\t\"emptied\",\n\t\t\t\"stalled\",\n\t\t];\n\t\tlogBufferedEvents = [\n\t\t\t\"loadedmetadata\",\n\t\t\t\"loadeddata\",\n\t\t\t\"canplay\",\n\t\t\t\"canplaythrough\",\n\t\t\t\"playing\",\n\t\t\t\"waiting\",\n\t\t\t\"seeking\", // seeking changed to true\n\t\t\t\"seeked\", // seeking changed to false\n\t\t\t\"ended\", // ended is true\n\t\t];\n\t\tlogPlayedEvents = [\n\t\t\t\"play\",\n\t\t\t\"pause\"\n\t\t];\n\n\t\t// Exclude some events from log\n\t\tmediaEvents = _.without(mediaEvents, \"resize\", \"error\");\n\t\t// Make sure event subsets exist in the main set\n\t\tlogPlaybackStateEvents = _.intersection(mediaEvents, logPlaybackStateEvents);\n\t\tlogBufferedEvents = _.intersection(mediaEvents, logBufferedEvents);\n\t\tlogPlayedEvents = _.intersection(mediaEvents, logPlayedEvents);\n\n\t\tvar readyStateSymbols = _.invert(_.pick(HTMLMediaElement,\n\t\t\tfunction(val, key, obj) {\n\t\t\t\treturn /^HAVE_/.test(key);\n\t\t\t}));\n\t\tvar readyStateToString = function(el) {\n\t\t\treturn readyStateSymbols[el.readyState] + \"(\" + el.readyState + \")\";\n\t\t};\n\n\t\tvar networkStateSymbols = _.invert(_.pick(HTMLMediaElement,\n\t\t\tfunction(val, key, obj) {\n\t\t\t\treturn /^NETWORK_/.test(key);\n\t\t\t}));\n\t\tvar networkStateToString = function(el) {\n\t\t\treturn networkStateSymbols[el.networkState] + \"(\" + el.networkState + \")\";\n\t\t};\n\n\t\tvar mediaErrorSymbols = _.invert(MediaError);\n\t\tvar mediaErrorToString = function(el) {\n\t\t\treturn el.error ? mediaErrorSymbols[el.error.code] + \"(\" + el.error.code + \")\" : \"[MediaError null]\";\n\t\t};\n\n\t\tvar findRangeIndex = function(range, currTime) {\n\t\t\tfor (var i = 0, ii = range.length; i < ii; i++) {\n\t\t\t\tif (range.start(i) <= currTime && currTime <= range.end(i)) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1;\n\t\t};\n\n\t\tvar formatVideoError = function(video) {\n\t\t\treturn [\n\t\t\t\tmediaErrorToString(video),\n\t\t\t\tnetworkStateToString(video),\n\t\t\t\treadyStateToString(video),\n\t\t\t].join(\" \");\n\t\t};\n\n\t\tvar getVideoStatsCols = function() {\n\t\t\treturn \"0000.000 [Curr/Total] [Seekable]  [Buffered]  networkState readyState      Playback\";\n\t\t\t// return \"0000.620 [t:  0.0  27.4] [s: 27.4 0/1] [b:  0.5 0/1] LOADING(2)   FUTURE_DATA(3)  :: (::)\";\n\t\t}\n\n\t\tvar formatVideoStats = function(video) {\n\t\t\tvar currTime = video.currentTime,\n\t\t\t\tdurTime = video.duration,\n\t\t\t\tbRanges = video.buffered,\n\t\t\t\tbRangeIdx,\n\t\t\t\tsRanges = video.seekable,\n\t\t\t\tsRangeIdx;\n\n\t\t\tbRangeIdx = findRangeIndex(bRanges, currTime);\n\t\t\tsRangeIdx = findRangeIndex(sRanges, currTime);\n\t\t\treturn [\n\t\t\t\t\"[\" + lpad(currTime.toFixed(1), 5) +\n\t\t\t\t\t\" \" + lpad((!isNaN(durTime) ? durTime.toFixed(1) : \"-\"), 4) + \"]\",\n\t\t\t\t\"[\" + lpad((sRangeIdx >= 0 ? sRanges.end(sRangeIdx).toFixed(1) : \"-\"), 5) +\n\t\t\t\t\t\" \" + (sRangeIdx >= 0 ? sRangeIdx : \"-\") + \"/\" + sRanges.length + \"]\",\n\t\t\t\t\"[\" + lpad((bRangeIdx >= 0 ? bRanges.end(bRangeIdx).toFixed(1) : \"-\"), 5) +\n\t\t\t\t\t\" \" + (bRangeIdx >= 0 ? bRangeIdx : \"-\") + \"/\" + bRanges.length + \"]\",\n\t\t\t\trpad(networkStateToString(video).substr(8), 12),\n\t\t\t\trpad(readyStateToString(video).substr(5), 15),\n\t\t\t\t(video.ended ? \">:\" : (video.paused ? \"::\" : \">>\"))\n\t\t\t\t// video.playbackRate.toFixed(2) + \" (\" + video.defaultPlaybackRate.toFixed(2) + \")\"\n\t\t\t]; //.join(\" \");\n\t\t};\n\n\t\treturn VideoRenderer.extend({\n\n\t\t\t/** @override */\n\t\t\tinitialize: function() {\n\t\t\t\tVideoRenderer.prototype.initialize.apply(this, arguments);\n\n\t\t\t\t_.bindAll(this, \"__handleMediaEvent\");\n\n\t\t\t\tvar fgColor = this.model.attr(\"color\"),\n\t\t\t\t\tred = new Color(\"red\"),\n\t\t\t\t\tblue = new Color(\"blue\"),\n\t\t\t\t\tgreen = new Color(\"green\");\n\n\t\t\t\tfor (var i = 0; i < mediaEvents.length; i++) {\n\t\t\t\t\tvar ev = mediaEvents[i];\n\t\t\t\t\tthis.video.addEventListener(ev, this.__handleMediaEvent, false);\n\n\t\t\t\t\tvar c = new Color(fgColor),\n\t\t\t\t\t\tcc = 1;\n\t\t\t\t\tif (logBufferedEvents.indexOf(ev) != -1) c.mix(green, (cc /= 2));\n\t\t\t\t\tif (logPlayedEvents.indexOf(ev) != -1) c.mix(red, (cc /= 2));\n\t\t\t\t\tif (logPlaybackStateEvents.indexOf(ev) != -1) c.mix(blue, (cc /= 2));\n\t\t\t\t\tthis.__logColors[ev] = c.rgbString();\n\t\t\t\t}\n\t\t\t\tthis.video.addEventListener(\"error\", this.__handleMediaEvent, true);\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\tremove: function() {\n\t\t\t\tVideoRenderer.prototype.remove.apply(this, arguments);\n\t\t\t\tfor (var i = 0; i < mediaEvents.length; i++) {\n\t\t\t\t\tif (mediaEvents[i] == \"error\") continue;\n\t\t\t\t\tthis.video.removeEventListener(mediaEvents[i], this.__handleMediaEvent, false);\n\t\t\t\t}\n\t\t\t\tthis.video.removeEventListener(\"error\", this.__handleMediaEvent, true);\n\t\t\t},\n\n\t\t\t// /** @override */\n\t\t\t// _onVisibilityChange: function(ev) {\n\t\t\t// \tVideoRenderer.prototype._onVisibilityChange.apply(this, arguments);\n\t\t\t// \tvar stateVal = Modernizr.prefixed(\"visibilityState\", document);\n\t\t\t// \tthis.__logEvent(\"visibilityState:\" + stateVal, ev.type + \":\" + stateVal);\n\t\t\t// },\n\t\t\t//\n\t\t\t// /** @override */\n\t\t\t// _onFullscreenChange: function(ev) {\n\t\t\t// \tVideoRenderer.prototype._onFullscreenChange.apply(this, arguments);\n\t\t\t// \tvar logtype = (document.fullscreenElement === this.video ? \"enter:\" : \"exit:\") + ev.type;\n\t\t\t// \tthis.__logEvent(\"document.fullscreenElement: \" + this.cid, logtype);\n\t\t\t// },\n\n\t\t\t/** @override */\n\t\t\t_onFullscreenToggle: function(ev) {\n\t\t\t\tif (!ev.defaultPrevented && this.model.selected) {\n\t\t\t\t\tthis.__logEvent(\"fullscreen-toggle\", ev.type);\n\t\t\t\t}\n\t\t\t\tVideoRenderer.prototype._onFullscreenToggle.apply(this, arguments);\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\t_playbackTimeoutFn_playing: function() {\n\t\t\t\tVideoRenderer.prototype._playbackTimeoutFn_playing.apply(this, arguments);\n\t\t\t\t// this.__logEvent(formatVideoStats(this.video).join(\" \"), \"timeout-play\");\n\t\t\t\tthis.__handleMediaEvent({\n\t\t\t\t\ttype: \"timeout-play\",\n\t\t\t\t\ttimeStamp: null,\n\t\t\t\t\tisTimeout: true\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\t_playbackTimeoutFn_waiting: function() {\n\t\t\t\tVideoRenderer.prototype._playbackTimeoutFn_waiting.apply(this, arguments);\n\t\t\t\t// this.__logEvent(formatVideoStats(this.video).join(\" \"), \"timeout-wait\");\n\t\t\t\tthis.__handleMediaEvent({\n\t\t\t\t\ttype: \"timeout-wait\",\n\t\t\t\t\ttimeStamp: null,\n\t\t\t\t\tisTimeout: true\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t__handleMediaEvent: function(ev) {\n\t\t\t\tvar evmsg = formatVideoStats(this.video);\n\n\t\t\t\tif (this.playbackRequested === true) {\n\t\t\t\t\tevmsg.push(\"(>>)\");\n\t\t\t\t} else if (this.playbackRequested === false) {\n\t\t\t\t\tevmsg.push(\"(::)\");\n\t\t\t\t} else {\n\t\t\t\t\tevmsg.push(\"(--)\");\n\t\t\t\t}\n\n\t\t\t\tif (this.playbackRequested) {\n\t\t\t\t\tevmsg.push(this._playbackTimeoutID !== -1 ? \"W\" : \"-\");\n\t\t\t\t} else {\n\t\t\t\t\tevmsg.push(this._playbackTimeoutID !== -1 ? \"?\" : \"!\");\n\t\t\t\t}\n\t\t\t\t// evmsg.push(this._playToggleSymbol.symbolName);\n\n\t\t\t\tvar ts, tc;\n\t\t\t\tif ((this.updatePlaybackEvents.indexOf(ev.type) > -1) || ev.isTimeout) {\n\t\t\t\t\t// evmsg.push(this._playbackStartTS.toFixed(2));\n\t\t\t\t\tts = ev.timeStamp - this._playbackStartTS;\n\t\t\t\t\ttc = this.video.currentTime - this._playbackStartTC;\n\t\t\t\t\tts *= .001; // s to ms\n\t\t\t\t\tevmsg.push(Math.abs(tc - ts).toFixed(3));\n\t\t\t\t}\n\t\t\t\t// else {\n\t\t\t\t// \tts = this._playbackStartTS;\n\t\t\t\t// \ttc = this._playbackStartTC;\n\t\t\t\t// }\n\t\t\t\t// ts *= .001; // s to ms\n\t\t\t\t// evmsg.push(Math.abs(tc - ts).toFixed(3));\n\t\t\t\t// evmsg.push(\"TC:\" + tc.toFixed(3));\n\t\t\t\t// evmsg.push(\"TS:\" + ts.toFixed(3));\n\n\t\t\t\tthis.__logEvent(evmsg.join(\" \"), ev.type);\n\t\t\t\tif (ev.type === \"error\" || ev.type === \"abort\") {\n\t\t\t\t\tthis.__logMessage(formatVideoError(this.video), ev.type);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t__logEvent: function(msg, logtype, color) {\n\t\t\t\tvar logEntryEl = this.__logElement.lastElementChild;\n\t\t\t\tif ((logEntryEl && logEntryEl.getAttribute(\"data-logtype\") == logtype) &&\n\t\t\t\t\t((logtype === \"timeupdate\") || (logtype === \"progress\"))) {\n\t\t\t\t\tvar logRepeatVal = parseInt(logEntryEl.getAttribute(\"data-logrepeat\"));\n\t\t\t\t\tlogEntryEl.textContent = this.__getTStamp() + \" \" + msg;\n\t\t\t\t\tlogEntryEl.setAttribute(\"data-logrepeat\", isNaN(logRepeatVal) ? 2 : ++logRepeatVal);\n\t\t\t\t} else {\n\t\t\t\t\tthis.__logMessage(msg, logtype, color);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t__getHeaderText: function() {\n\t\t\t\treturn getVideoStatsCols();\n\t\t\t},\n\t\t});\n\t})(module.exports);\n}\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=helpers.helperMissing, alias3=\"function\";\n\n  return \"<div id=\\\"desc_b\"\n    + container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"id\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" class=\\\"content sizing mdown\\\">\"\n    + ((stack1 = ((helper = (helper = helpers.desc || (depth0 != null ? depth0.desc : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"desc\",\"hash\":{},\"data\":data}) : helper))) != null ? stack1 : \"\")\n    + \"</div>\\n\";\n},\"useData\":true});\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=helpers.helperMissing, alias3=\"function\";\n\n  return \"<div id=\\\"desc_m\"\n    + container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"id\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" class=\\\"content sizing\\\"><p>\"\n    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper))) != null ? stack1 : \"\")\n    + \"</p>\"\n    + ((stack1 = ((helper = (helper = helpers.sub || (depth0 != null ? depth0.sub : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"sub\",\"hash\":{},\"data\":data}) : helper))) != null ? stack1 : \"\")\n    + \"</div>\\n\";\n},\"useData\":true});\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper;\n\n  return \"\t\t<p><code>\"\n    + container.escapeExpression(((helper = (helper = helpers.infoSrc || (depth0 != null ? depth0.infoSrc : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : (container.nullContext || {}),{\"name\":\"infoSrc\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</code></p>\\n\";\n},\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : (container.nullContext || {}), alias2=helpers.helperMissing, alias3=\"function\", alias4=container.escapeExpression;\n\n  return \"<div class=\\\"error-title color-fg color-reverse\\\">\"\n    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</div>\\n<div class=\\\"error-message color-fg\\\">\\n\t<p><strong>\"\n    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</strong> <code>\"\n    + alias4(((helper = (helper = helpers.message || (depth0 != null ? depth0.message : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"message\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</code></p>\\n\"\n    + ((stack1 = helpers[\"if\"].call(alias1,(depth0 != null ? depth0.infoSrc : depth0),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data})) != null ? stack1 : \"\")\n    + \"</div>\\n\";\n},\"useData\":true});\n",
    "// var Handlebars = require(\"handlebars\")[\"default\"];\nvar Handlebars = require(\"hbsfy/runtime\");\n/** @type {Function} */\nvar Color = require(\"color\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n\n// (function() {\nvar helpers = {\n\t/*\n\t/* Arithmetic helpers\n\t/*/\n\tadd: function(value, addition) {\n\t\treturn value + addition;\n\t},\n\tsubtract: function(value, substraction) {\n\t\treturn value - substraction;\n\t},\n\tdivide: function(value, divisor) {\n\t\treturn value / divisor;\n\t},\n\tmultiply: function(value, multiplier) {\n\t\treturn value * multiplier;\n\t},\n\tfloor: function(value) {\n\t\treturn Math.floor(value);\n\t},\n\tceil: function(value) {\n\t\treturn Math.ceil(value);\n\t},\n\tround: function(value) {\n\t\treturn Math.round(value);\n\t},\n\tglobal: function(value) {\n\t\treturn Globals[value];\n\t},\n\n\t/*\n\t/* Flow control helpers\n\t/*/\n\tis: function(a, b, opts) {\n\t\treturn (a === b) ? opts.fn(this) : opts.inverse(this);\n\t},\n\tisnot: function(a, b, opts) {\n\t\treturn (a !== b) ? opts.fn(this) : opts.inverse(this);\n\t},\n\tisany: function(value) {\n\t\tvar i = 0,\n\t\t\tii = arguments.length - 2,\n\t\t\topts = arguments[ii + 1];\n\t\tdo\n\t\t\tif (value === arguments[++i]) {\n\t\t\t\treturn opts.fn(this);\n\t\t\t}\n\t\twhile (i < ii);\n\t\treturn opts.inverse(this);\n\t},\n\tcontains: function(a, b, opts) {\n\t\treturn (a.indexOf(b) !== -1) ? opts.fn(this) : opts.inverse(this);\n\t},\n\tignore: function() {\n\t\treturn \"\";\n\t},\n\n\t/*\n\t/* Color helpers\n\t/*/\n\tmix: function(colora, colorb, amount) {\n\t\treturn new Color(colora).mix(new Color(colorb), amount).rgbString();\n\t},\n\tlighten: function(color, amount) {\n\t\treturn new Color(color).lighten(amount).rgbString();\n\t},\n\tdarken: function(color, amount) {\n\t\treturn new Color(color).darken(amount).rgbString();\n\t},\n\t// colorFormat: function(color, fmt) {\n\t// \tswitch (fmt) {\n\t// \t\tcase \"rgb\":\n\t// \t\t\treturn new Color(color).rgbString();\n\t// \t\tcase \"hsl\":\n\t// \t\t\treturn new Color(color).hslString();\n\t// \t\tcase \"hex\": default:\n\t// \t\t\treturn new Color(color).hexString();\n\t// \t}\n\t// },\n};\nfor (var helper in helpers) {\n\tif (helpers.hasOwnProperty(helper)) {\n\t\tHandlebars.registerHelper(helper, helpers[helper]);\n\t}\n}\n// })();\n\n// module.exports = Handlebars;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    return \"<svg class=\\\"fullscreen-symbol\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" preserveAspectRatio=\\\"xMidYMid meet\\\" viewBox=\\\"-21 -21 42 42\\\">\\n\t<path id=\\\"fullscreen-shadow\\\" d=\\\"M-5,5 L-20,20 M-7,20 L-20,20 L-20,7 M5,-5 L20,-20 M7,-20 L20,-20 L20,-7\\\" class=\\\"bg-color-stroke\\\" style=\\\"fill:none\\\" vector-effect=\\\"non-scaling-stroke\\\" transform=\\\"translate(2 2)\\\"/>\\n\t<path id=\\\"fullscreen-path\\\" d=\\\"M-5,5 L-20,20 M-7,20 L-20,20 L-20,7 M5,-5 L20,-20 M7,-20 L20,-20 L20,-7\\\" class=\\\"color-stroke\\\" style=\\\"fill:none\\\" vector-effect=\\\"non-scaling-stroke\\\" />\\n</svg>\\n\";\n},\"useData\":true});\n",
    "/** @type {module:backbone} */\nvar Events = require(\"backbone\").Events;\n\n\n// var defaultOptions = {\n// \ttick: 1,\n// \tonstart: null,\n// \tontick: null,\n// \tonpause: null,\n// \tonstop: null,\n// \tonend: null\n// }\nvar idSeed = 0;\n\nvar Timer = function(options) {\n\t// if (!(this instanceof Timer)) {\n\t// \treturn new Timer(options);\n\t// }\n\tthis._id = idSeed++;\n\t// this._options = {};\n\tthis._duration = 0;\n\tthis._status = \"initialized\";\n\tthis._start = 0;\n\t// this._measures = [];\n\n\t// for (var prop in defaultOptions) {\n\t// \tthis._options[prop] = defaultOptions[prop];\n\t// }\n\t// this.options(options);\n};\n\n_.extend(Timer.prototype, Events, {\n\n\tstart: function(duration) {\n\t\tif (!_.isNumber(duration) && !this._duration) {\n\t\t\treturn this;\n\t\t}\n\t\t// duration && (duration *= 1000)\n\t\tif (this._timeout && this._status === \"started\") {\n\t\t\treturn this;\n\t\t}\n\t\tvar evName = (this._status === \"stopped\") ? \"start\" : \"resume\";\n\t\tthis._duration = duration || this._duration;\n\t\tthis._timeout = window.setTimeout(end.bind(this), this._duration);\n\t\t// if (typeof this._options.ontick === \"function\") {\n\t\t// \tthis._interval = setInterval(function() {\n\t\t// \t\tthis.trigger(\"tick\", this.getDuration())\n\t\t// \t}.bind(this), +this._options.tick * 1000)\n\t\t// }\n\t\tthis._start = _now();\n\t\tthis._status = \"started\";\n\t\tthis.trigger(evName, this.getDuration());\n\t\treturn this;\n\t},\n\n\tpause: function() {\n\t\tif (this._status !== \"started\") {\n\t\t\treturn this;\n\t\t}\n\t\tthis._duration -= (_now() - this._start);\n\t\tclear.call(this, false);\n\t\tthis._status = \"paused\";\n\t\tthis.trigger(\"pause\", this.getDuration());\n\t\treturn this;\n\t},\n\n\tstop: function() {\n\t\tif (!/started|paused/.test(this._status)) {\n\t\t\treturn this;\n\t\t}\n\t\tclear.call(this, true);\n\t\tthis._status = \"stopped\";\n\t\tthis.trigger(\"stop\");\n\t\treturn this;\n\t},\n\n\tgetDuration: function() {\n\t\tif (this._status === \"started\") {\n\t\t\treturn this._duration - (_now() - this._start);\n\t\t}\n\t\tif (this._status === \"paused\") {\n\t\t\treturn this._duration;\n\t\t}\n\t\treturn 0;\n\t},\n\n\tgetStatus: function() {\n\t\treturn this._status;\n\t},\n});\n\nvar _now = window.performance ?\n\twindow.performance.now.bind(window.performance) :\n\tDate.now.bind(Date);\n\nfunction end() {\n\tclear.call(this);\n\tthis._status = \"stopped\";\n\tthis.trigger(\"end\");\n}\n\nfunction clear(clearDuration) {\n\twindow.clearTimeout(this._timeout);\n\t// window.clearInterval(this._interval);\n\tif (clearDuration === true) {\n\t\tthis._duration = 0;\n\t}\n}\n\nObject.defineProperties(Timer.prototype, {\n\tduration: {\n\t\tenumerable: true,\n\t\tget: function() {\n\t\t\treturn this.getDuration();\n\t\t}\n\t},\n\tstatus: {\n\t\tenumerable: true,\n\t\tget: function() {\n\t\t\treturn this.getStatus();\n\t\t}\n\t}\n});\n\nObject.defineProperties(Timer, {\n\tSTOPPED: {\n\t\tenumerable: true,\n\t\tvalue: \"stopped\"\n\t},\n\tSTARTED: {\n\t\tenumerable: true,\n\t\tvalue: \"started\"\n\t},\n\tPAUSED: {\n\t\tenumerable: true,\n\t\tvalue: \"paused\"\n\t},\n});\n\nmodule.exports = Timer;\n",
    "/* -------------------------------\n/* Imports\n/* ------------------------------- *//** @type {module:utils/TransformItem} */\nvar TransformItem = require(\"./TransformItem\");\n\nvar idSeed = 0;\nvar cidSeed = 100;\nvar slice = Array.prototype.slice;\n\n/**\n * @constructor\n * @type {module:app/helper/TransformHelper}\n */\nfunction TransformHelper() {\n\tthis.id = idSeed++;\n\tthis._items = [];\n\tthis._itemsById = {};\n}\n\nTransformHelper.prototype = Object.create({\n\n\t/* -------------------------------\n\t/* Private\n\t/* ------------------------------- */\n\n\t_get: function(el) {\n\t\tif (this.has(el)) {\n\t\t\treturn this._itemsById[el.eid];\n\t\t} else {\n\t\t\treturn this._add(el);\n\t\t}\n\t},\n\n\t_add: function(el) {\n\t\tvar item, id;\n\t\t// id = el.eid || el.cid || el.id;\n\t\t// if (!id || (this._itemsById[id] && (this._itemsById[id].el !== el))) {\n\t\t// \tid = \"elt\" + cidSeed++;\n\t\t// }\n\t\t// if (!el.eid) {\n\t\t// \tid = el.eid || el.cid || (\"elt\" + cidSeed++);\n\t\t// }\n\t\tid = el.eid || el.cid || (\"elt\" + cidSeed++);\n\t\titem = new TransformItem(el, id);\n\t\tthis._itemsById[id] = item;\n\t\tthis._items.push(item);\n\t\treturn item;\n\t},\n\n\t_remove: function(el) {\n\t\tif (this.has(el)) {\n\t\t\tvar o = this._itemsById[el.eid];\n\t\t\tthis._items.splice(this._items.indexOf(o), 1);\n\t\t\to.destroy();\n\t\t\tdelete this._itemsById[el.eid];\n\t\t}\n\t},\n\n\t_invoke: function(funcName, args, startIndex) {\n\t\tvar i, ii, j, jj, el, o, rr;\n\t\tvar funcArgs = null;\n\t\tif (startIndex !== void 0) {\n\t\t\tfuncArgs = slice.call(args, 0, startIndex);\n\t\t} else {\n\t\t\tstartIndex = 0;\n\t\t}\n\t\tfor (i = startIndex, ii = args.length, rr = []; i < ii; ++i) {\n\t\t\tel = args[i];\n\t\t\t// iterate on NodeList, Arguments, Array...\n\t\t\tif (el.length) {\n\t\t\t\tfor (j = 0, jj = el.length; j < jj; ++j) {\n\t\t\t\t\to = this._get(el[j]);\n\t\t\t\t\trr.push(o[funcName].apply(o, funcArgs));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\to = this._get(el);\n\t\t\t\trr.push(o[funcName].apply(o, funcArgs));\n\t\t\t}\n\t\t}\n\t\treturn rr;\n\t},\n\n\t/* -------------------------------\n\t/* Public\n\t/* ------------------------------- */\n\n\thas: function(el) {\n\t\treturn el.eid && this._itemsById[el.eid] !== void 0;\n\t},\n\n\tgetItems: function() {\n\t\tvar i, j, el, ret = [];\n\t\tfor (i = 0; i < arguments.length; ++i) {\n\t\t\tel = arguments[i];\n\t\t\tif (el.length) {\n\t\t\t\tfor (j = 0; j < el.length; ++j) {\n\t\t\t\t\tret.push(this._get(el[j]));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tret.push(this._get(el));\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t},\n\n\tget: function(el) {\n\t\treturn this._get(el);\n\t},\n\n\tadd: function() {\n\t\tvar i, j, el;\n\t\tfor (i = 0; i < arguments.length; ++i) {\n\t\t\tel = arguments[i];\n\t\t\tif (el.length) {\n\t\t\t\tfor (j = 0; j < el.length; ++j) {\n\t\t\t\t\tthis._get(el[j]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._get(el);\n\t\t\t}\n\t\t}\n\t},\n\n\tremove: function() {\n\t\tvar i, j, el;\n\t\tfor (i = 0; i < arguments.length; ++i) {\n\t\t\tel = arguments[i];\n\t\t\tif (el.length) {\n\t\t\t\tfor (j = 0; j < el.length; ++j) {\n\t\t\t\t\tthis._remove(el[j]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._remove(el);\n\t\t\t}\n\t\t}\n\t},\n\n\t/* --------------------------------\n\t/* public\n\t/* -------------------------------- */\n\n\t/* public: single arg\n\t/* - - - - - - - - - - - - - - - - */\n\n\thasOffset: function(el) {\n\t\treturn this.has(el) ? this._itemsById[el.eid].hasOffset : (void 0);\n\t},\n\n\t/* public: capture\n\t/* - - - - - - - - - - - - - - - - */\n\n\tcapture: function() {\n\t\tthis._invoke(\"capture\", arguments);\n\t},\n\tcaptureAll: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].capture();\n\t\t}\n\t},\n\n\tclearCapture: function() {\n\t\tthis._invoke(\"clearCapture\", arguments);\n\t},\n\tclearAllCaptures: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].clearCapture();\n\t\t}\n\t},\n\n\t/* public: offset\n\t/* - - - - - - - - - - - - - - - - */\n\toffset: function(x, y) {\n\t\tthis._invoke(\"offset\", arguments, 2);\n\t},\n\toffsetAll: function(x, y) {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].offset(x, y);\n\t\t}\n\t},\n\n\tclearOffset: function() {\n\t\tthis._invoke(\"clearOffset\", arguments);\n\t},\n\tclearAllOffsets: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].clearOffset();\n\t\t}\n\t},\n\n\t/* public: transitions\n\t/* - - - - - - - - - - - - - - - - */\n\n\trunTransition: function(transition) {\n\t\tthis._invoke(\"runTransition\", arguments, 1);\n\t},\n\trunAllTransitions: function(transition) {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].runTransition(transition);\n\t\t}\n\t},\n\n\tclearTransition: function() {\n\t\tthis._invoke(\"clearTransition\", arguments);\n\t},\n\tclearAllTransitions: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].clearTransition();\n\t\t}\n\t},\n\n\tstopTransition: function() {\n\t\tthis._invoke(\"stopTransition\", arguments);\n\t},\n\tstopAllTransitions: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].stopTransition();\n\t\t}\n\t},\n\n\twhenTransitionEnds: function() {\n\t\tvar res = this._invoke(\"whenTransitionEnds\", arguments);\n\t\treturn res.length != 0 ?\n\t\t\tPromise.all(res) :\n\t\t\tPromise.resolve(null);\n\t},\n\twhenAllTransitionsEnd: function() {\n\t\treturn (this._items.length != 0) ? Promise.all(this._items.map(function(o) {\n\t\t\treturn o.whenTransitionEnds();\n\t\t})) : Promise.resolve(null);\n\t},\n\n\tpromise: function() {\n\t\treturn arguments.length == 0 ?\n\t\t\tthis.whenAllTransitionsEnd() :\n\t\t\tthis.whenTransitionEnds.call(this, arguments);\n\t},\n\n\t/* -------------------------------\n\t/* validation\n\t/* ------------------------------- */\n\n\tvalidate: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].validate();\n\t\t}\n\t},\n}, {\n\titems: {\n\t\tget: function() {\n\t\t\treturn this._items;\n\t\t}\n\t}\n});\n\nmodule.exports = TransformHelper;\n",
    "/* -------------------------------\n * Imports\n * ------------------------------- */\n/** @type {module:utils/prefixedProperty} */\nvar prefixedProperty = require(\"utils/prefixedProperty\");\n/** @type {module:utils/prefixedStyleName} */\nvar prefixedStyleName = require(\"utils/prefixedStyleName\");\n/** @type {module:utils/prefixedEvent} */\nvar prefixedEvent = require(\"utils/prefixedEvent\");\n/** @type {String} */\nvar transitionEnd = prefixedEvent(\"transitionend\");\n//var transitionEnd = require(\"utils/event/transitionEnd\");\n// /** @type {Function} */\n// var slice = Array.prototype.slice;\n\n// /** @type {module:utils/debug/traceElement} */\n// var traceElt = require(\"./debug/traceElement\");\n// var traceEltCache = {};\n// var log = function() {\n// \tvar logFn = \"log\";\n// \tvar args = slice.apply(arguments);\n// \tswitch(args[0]) {\n// \t\tcase \"error\":\n// \t\tcase \"warn\":\n// \t\tcase \"info\":\n// \t\t\tlogFn = args.shift();\n// \t\t\tbreak;\n// \t\tdefault:\n// \t\t\t// break;\n// \t\t\treturn;\n// \t}\n// \tvar el, txId;\n// \tif ((el = args[0]) && (txId = el.eid)) {\n// \t\targs[0] = traceEltCache[txId] || (traceEltCache[txId] = el);\n// \t}\n// \targs[0] = \"\\t\" + args[0];\n// \tconsole[logFn].apply(console, args);\n// };\n\n/* jshint -W079 */\n// var console = (function(target) {\n// \treturn Object.getOwnPropertyNames(target).reduce(function(proxy, prop) {\n// \t\tif ((typeof target[prop]) == \"function\") {\n// \t\t\tswitch (prop) {\n// \t\t\t\tcase \"error\":\n// \t\t\t\tcase \"warn\":\n// \t\t\t\tcase \"info\":\n// \t\t\t\t\tproxy[prop] = function () {\n// \t\t\t\t\t\tvar args = slice.apply(arguments);\n// \t\t\t\t\t\tif (typeof args[0] == \"string\") {\n// \t\t\t\t\t\t\targs[0] = prop + \"::\" + args[0];\n// \t\t\t\t\t\t}\n// \t\t\t\t\t\treturn target[prop].apply(target, args);\n// \t\t\t\t\t};\n// \t\t\t\t\tbreak;\n// \t\t\t\tcase \"log\":\n// \t\t\t\t\tproxy[prop] = function() {};\n// \t\t\t\t\tbreak;\n// \t\t\t\tdefault:\n// \t\t\t\t\tproxy[prop] = target[prop].bind(target);\n// \t\t\t\t\tbreak;\n// \t\t\t}\n// \t\t} else {\n// \t\t\tObject.defineProperty(proxy, prop, {\n// \t\t\t\tget: function() { return target[prop]; },\n// \t\t\t\tset: function(val) { target[prop] = val; }\n// \t\t\t});\n// \t\t}\n// \t\treturn proxy;\n// \t}, {});\n// })(window.console);\n/* jshint +W079 */\n\n/* -------------------------------\n/* Private static\n/* ------------------------------- */\n\nvar NO_TRANSITION_VALUE = \"none 0s step-start 0s\";\n// var NO_TRANSITION_VALUE = \"all 0.001s step-start 0.001s\";\n\nvar UNSET_TRANSITION = {\n\tname: \"unset\",\n\tclassName: \"tx-unset\",\n\tproperty: \"none\",\n\teasing: \"ease\",\n\tdelay: 0,\n\tduration: 0,\n\tcssText: \"unset\",\n};\n\n// var translateTemplate = _.template(\"translate(<%= _renderedX %>px, <%= _renderedY %>px)\";\n// var translate3dTemplate = _.template(\"translate3d(<%= _renderedX %>px, <%= _renderedY %>px, 0px)\";\n// var transitionTemplate = _.template(\"<%= property %> <% duration/1000 %>s <%= easing %> <% delay/1000 %>s\");\n\nvar translateTemplate = (function(fn) {\n\treturn function(o) {\n\t\treturn fn(o._renderedX, o._renderedY);\n\t};\n}(require(\"app/control/Globals\").TRANSLATE_TEMPLATE));\n\nvar transitionTemplate = function(o) {\n\treturn o.property + \" \" +\n\t\to.duration / 1000 + \"s \" +\n\t\to.easing + \" \" +\n\t\to.delay / 1000 + \"s\";\n};\n\nvar propDefaults = {\n\t\"opacity\": \"1\",\n\t\"visibility\": \"visible\",\n\t\"transform\": \"matrix(1, 0, 0, 1, 0, 0)\",\n\t\"transformStyle\": \"\",\n\t\"transition\": \"\",\n\t// \"willChange\": \"\",\n\t// \"transitionDuration\": \"0s\",\n\t// \"transitionDelay\": \"0s\",\n\t// \"transitionProperty\": \"none\",\n\t// \"transitionTimingFunction\": \"ease\"\n};\nvar propKeys = Object.keys(propDefaults);\nvar propNames = propKeys.reduce(function(obj, propName) {\n\tobj[propName] = prefixedProperty(propName);\n\treturn obj;\n}, {});\n\nvar styleNames = (function(camelToDashed) {\n\treturn propKeys\n\t\t.map(camelToDashed)\n\t\t.reduce(function(obj, propName) {\n\t\t\tobj[propName] = prefixedStyleName(propName);\n\t\t\treturn obj;\n\t\t}, {});\n})(require(\"utils/strings/camelToDashed\"));\n\nvar resolveAll = function(pp, result) {\n\tif (pp.length != 0) {\n\t\tpp.forEach(function(p, i, a) {\n\t\t\tp.resolve(result);\n\t\t\ta[i] = null;\n\t\t});\n\t\tpp.length = 0;\n\t}\n\treturn pp;\n};\n\nvar rejectAll = function(pp, reason) {\n\tif (pp.length != 0) {\n\t\tpp.forEach(function(p, i, a) {\n\t\t\tp.reject(reason);\n\t\t\ta[i] = null;\n\t\t});\n\t\tpp.length = 0;\n\t}\n\treturn pp;\n};\n\n/* -------------------------------\n * TransformItem\n * ------------------------------- */\n\n/**\n * @constructor\n */\nvar TransformItem = function(el, id) {\n\tthis.el = el;\n\tthis.id = id;\n\tthis.el.eid = id;\n\n\tthis._onTransitionEnd = this._onTransitionEnd.bind(this);\n\tthis.el.addEventListener(transitionEnd, this._onTransitionEnd, false);\n\n\tthis._captureInvalid = false;\n\tthis._capturedChanged = false;\n\tthis._capturedX = null;\n\tthis._capturedY = null;\n\tthis._currCapture = {};\n\tthis._lastCapture = {};\n\n\tthis._hasOffset = false;\n\tthis._offsetInvalid = false;\n\tthis._offsetX = null;\n\tthis._offsetY = null;\n\n\tthis._renderedX = null;\n\tthis._renderedY = null;\n\n\tthis._hasTransition = false;\n\tthis._transitionInvalid = false;\n\tthis._transitionRunning = false;\n\tthis._transition = _.extend({}, UNSET_TRANSITION); //{};\n\n\tthis._promises = [];\n\tthis._pendingPromises = [];\n}\n\nTransformItem.prototype = Object.create({\n\n\t/* -------------------------------\n\t/* Public\n\t/* ------------------------------- */\n\n\t/* destroy\n\t/* - - - - - - - - - - - - - - - - */\n\tdestroy: function() {\n\t\t// NOTE: style property may have been modified; clearOffset(element) should\n\t\t// be called explicitly if clean up is required.\n\t\tthis.el.removeEventListener(transitionEnd, this._onTransitionEnd, false);\n\t\trejectAll(this._pendingPromises, this);\n\t\trejectAll(this._promises, this);\n\t\t// delete this.el.eid;\n\t},\n\n\t/* capture\n\t/* - - - - - - - - - - - - - - - - */\n\tcapture: function(force) {\n\t\t// console.log(\"tx[%s]::capture\", this.id);\n\t\tif (force) {\n\t\t\tthis.clearCapture();\n\t\t}\n\t\tthis._validateCapture();\n\t\treturn this;\n\t},\n\n\tclearCapture: function() {\n\t\t// console.log(\"tx[%s]::clearCapture\", this.id);\n\t\t// this._hasOffset = false;\n\t\tthis._captureInvalid = true;\n\t\treturn this;\n\t},\n\n\t/* offset/clear\n\t/* - - - - - - - - - - - - - - - - */\n\toffset: function(x, y) {\n\t\t// console.log(\"tx[%s]::offset\", this.id);\n\t\tthis._hasOffset = true;\n\t\tthis._offsetInvalid = true;\n\t\tthis._offsetX = x || 0;\n\t\tthis._offsetY = y || 0;\n\t\t// if (this.immediate) this._validateOffset();\n\t\treturn this;\n\t},\n\n\tclearOffset: function() {\n\t\tif (this._hasOffset) {\n\t\t\t// console.log(\"tx[%s]::clearOffset\", this.id);\n\t\t\tthis._hasOffset = false;\n\t\t\tthis._offsetInvalid = true;\n\t\t\tthis._offsetX = null;\n\t\t\tthis._offsetY = null;\n\t\t\t// if (this.immediate) this._validateOffset();\n\t\t}\n\t\t// else {\n\t\t// \tconsole.log(\"tx[%s]::clearOffset no offset to clear\", this.id);\n\t\t// }\n\t\treturn this;\n\t},\n\n\t/* transitions\n\t/* - - - - - - - - - - - - - - - - */\n\trunTransition: function(transition) {\n\t\tif (!transition) { // || (transition.duration + transition.delay) == 0) {\n\t\t\treturn this.clearTransition();\n\t\t}\n\t\tvar lastValue = this._transitionValue;\n\t\tvar lastName = this._transition.name;\n\t\tthis._transition.property = styleNames[\"transform\"];\n\t\tthis._transition = _.extend(this._transition, transition);\n\t\tthis._transitionValue = transitionTemplate(this._transition);\n\n\t\tif (this._transitionInvalid) {\n\t\t\tconsole.warn(\"tx[%s]::runTransition set over (%s:'%s' => %s:'%s')\", this.id,\n\t\t\t\tlastName, lastValue, this._transition.name, this._transitionValue);\n\t\t}\n\n\t\tthis._hasTransition = true;\n\t\tthis._transitionInvalid = true;\n\t\t// if (this.immediate) this._validateTransition();\n\t\treturn this;\n\t},\n\n\tclearTransition: function() {\n\t\tthis._transition = _.extend(this._transition, UNSET_TRANSITION);\n\t\tthis._transitionValue = NO_TRANSITION_VALUE;\n\n\t\tthis._hasTransition = false;\n\t\tthis._transitionInvalid = true;\n\t\t// if (this.immediate) this._validateTransition();\n\t\treturn this;\n\t},\n\n\tstopTransition: function() {\n\t\t// this._transition.name = \"[none]\";\n\t\t// this._transition.property = \"none\";\n\t\tthis._transition = _.extend(this._transition, UNSET_TRANSITION);\n\t\tthis._transitionValue = NO_TRANSITION_VALUE;\n\n\t\tthis._hasTransition = false;\n\t\tthis._transitionInvalid = true;\n\t\t// if (this.immediate) this._validateTransition();\n\t\treturn this;\n\t},\n\n\twhenTransitionEnds: function() {\n\t\tvar d, p, pp;\n\t\tif (this._transitionInvalid || this._transitionRunning) {\n\t\t\td = {};\n\t\t\tp = new Promise(function(resolve, reject) {\n\t\t\t\td.resolve = resolve;\n\t\t\t\td.reject = reject;\n\t\t\t});\n\t\t\tpp = this._transitionInvalid ? this._pendingPromises : this._promises;\n\t\t\tpp.push(d);\n\t\t} else {\n\t\t\tp = Promise.resolve(this);\n\t\t}\n\t\treturn p;\n\t},\n\n\t/* validation\n\t/* - - - - - - - - - - - - - - - - */\n\tvalidate: function() {\n\t\t// this.el.removeEventListener(transitionEnd, this._onTransitionEnd, false);\n\t\tthis._ignoreEvent = true;\n\n\t\tif (this._captureInvalid) {\n\t\t\tvar lastX = (this._renderedX !== null ? this._renderedX : this._capturedX),\n\t\t\t\tlastY = (this._renderedY !== null ? this._renderedY : this._capturedY);\n\n\t\t\t// this._validateTransition();\n\t\t\tthis._validateCapture();\n\t\t\tthis._validateOffset();\n\n\t\t\tvar currX = (this._renderedX !== null ? this._renderedX : this._capturedX),\n\t\t\t\tcurrY = (this._renderedY !== null ? this._renderedY : this._capturedY);\n\n\t\t\tif (lastX === currX && lastY === currY) {\n\t\t\t\tthis._hasTransition && console.warn(\"tx[%s]::validate unchanged: last:[%i,%i] curr:[%i,%i]\", this.el.id || this.id, lastX, lastY, currX, currY);\n\t\t\t\t// console.info(\"tx[%s]::validate unchanged: last:[%f,%f] curr:[%f,%f] render:[%f,%f] captured[%f,%f]\", this.el.id || this.id, lastX, lastY, currX, currY, this._renderedX, this._renderedY, this._capturedX, this._capturedY);\n\t\t\t\tthis.clearTransition();\n\t\t\t\t// this._validateTransition();\n\t\t\t}\n\t\t\tthis._validateTransition();\n\t\t} else {\n\t\t\t// this._validateCapture();\n\t\t\tthis._validateTransition();\n\t\t\tthis._validateOffset();\n\t\t}\n\n\t\t// this.el.addEventListener(transitionEnd, this._onTransitionEnd, false);\n\t\tthis._ignoreEvent = false;\n\n\t\t// if (this._capturedChanged) {\n\t\t// \tconsole.error(\"tx[%s]::validate capture changed: [%f,%f]\", this.id, this._capturedX, this._capturedY);\n\t\t// }\n\t\tthis._capturedChanged = false;\n\t\treturn this;\n\t},\n\n\t/* -------------------------------\n\t/* Private\n\t/* ------------------------------- */\n\n\t_validateCapture: function() {\n\t\tif (!this._captureInvalid) {\n\t\t\treturn;\n\t\t}\n\t\t// var computed, capturedValues;\n\t\tvar transformValue = null;\n\n\t\tif (this._hasOffset && !this._offsetInvalid) {\n\t\t\t// this is an explicit call to capture() instead of a subcall from _validateOffset()\n\t\t\ttransformValue = this._getCSSProp(\"transform\");\n\t\t\tif (transformValue === \"\") {\n\t\t\t\tconsole.error(\"tx[%s]::_capture valid offset (%i,$i) but transformValue=\\\"\\\"\", this.id, this._offsetX, this._offsetY);\n\t\t\t}\n\t\t\tthis._removeCSSProp(\"transform\");\n\t\t}\n\n\t\t// NOTE: reusing object, all props will be overwritten\n\t\tthis._lastCapture = this._currCapture;\n\t\tthis._currCapture = this._getComputedCSSProps();\n\n\t\tif (this._currCapture.transform !== this._lastCapture.transform) {\n\t\t\tvar m, mm; //, ret = {};\n\t\t\tmm = this._currCapture.transform.match(/(matrix|matrix3d)\\(([^\\)]+)\\)/);\n\t\t\tif (mm) {\n\t\t\t\tm = mm[2].split(\",\");\n\t\t\t\tif (mm[1] === \"matrix\") {\n\t\t\t\t\tthis._capturedX = parseFloat(m[4]);\n\t\t\t\t\tthis._capturedY = parseFloat(m[5]);\n\t\t\t\t} else {\n\t\t\t\t\tthis._capturedX = parseFloat(m[12]);\n\t\t\t\t\tthis._capturedY = parseFloat(m[13]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._capturedX = 0;\n\t\t\t\tthis._capturedY = 0;\n\t\t\t}\n\t\t\tthis._capturedChanged = true;\n\t\t}\n\t\tif (transformValue !== null) {\n\t\t\tconsole.log(\"tx[%s]::_capture reapplying '%s'\", this.id, transformValue);\n\t\t\tthis._setCSSProp(\"transform\", transformValue);\n\t\t}\n\t\tthis._captureInvalid = false;\n\t},\n\n\t_validateOffset: function() {\n\t\tif (this._offsetInvalid) {\n\t\t\t// this._validateCapture();\n\t\t\tthis._offsetInvalid = false;\n\t\t\tif (this._hasOffset) {\n\t\t\t\tvar tx = this._offsetX + this._capturedX;\n\t\t\t\tvar ty = this._offsetY + this._capturedY;\n\t\t\t\tif (tx !== this._renderedX || ty !== this._renderedY) {\n\t\t\t\t\tthis._renderedX = tx;\n\t\t\t\t\tthis._renderedY = ty;\n\t\t\t\t\tthis._setCSSProp(\"transform\", translateTemplate(this));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._renderedX = null;\n\t\t\t\tthis._renderedY = null;\n\t\t\t\tthis._removeCSSProp(\"transform\");\n\t\t\t}\n\t\t}\n\t},\n\n\t_validateTransition: function() {\n\t\tif (this._transitionInvalid) {\n\t\t\t// this._validateCapture();\n\t\t\tthis._transitionInvalid = false;\n\n\t\t\t// save promises made while invalid\n\t\t\tvar reject = this._promises;\n\t\t\t// prepare _promises and push in new ones\n\t\t\tthis._promises = this._pendingPromises;\n\t\t\t// whatever still here is to be rejected. reuse array\n\t\t\tthis._pendingPromises = rejectAll(reject, this);\n\n\t\t\t// Set running flag, if there's a transition to run\n\t\t\tthis._transitionRunning = this._hasTransition;\n\t\t\t// Set the css value (which will be empty string if there's no transition)\n\t\t\tthis._setCSSProp(\"transition\", this._transitionValue);\n\t\t\tif (DEBUG) {\n\t\t\t\tif (this._hasTransition) {\n\t\t\t\t\tthis.el.setAttribute(\"data-tx\", this._transition.name);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!this._hasTransition) {\n\t\t\t\t// if there is no transition, resolve promises now\n\t\t\t\tresolveAll(this._promises, this);\n\t\t\t}\n\t\t}\n\t},\n\n\t_onTransitionEnd: function(ev) {\n\t\tif (this._ignoreEvent) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._transitionRunning && (this.el === ev.target) &&\n\t\t\t(this._transition.property == ev.propertyName)) {\n\t\t\tthis._hasTransition = false;\n\t\t\tthis._transitionRunning = false;\n\t\t\tthis._removeCSSProp(\"transition\");\n\t\t\tresolveAll(this._promises, this);\n\n\t\t\tif (DEBUG) {\n\t\t\t\tif (this.el.hasAttribute(\"data-tx\")) {\n\t\t\t\t\t// this.el.setAttribute(\"data-tx-last\", this.el.getAttribute(\"data-tx\"));\n\t\t\t\t\tthis.el.removeAttribute(\"data-tx\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* CSS\n\t/* ------------------------------- */\n\n\t_getCSSProp: function(prop) {\n\t\treturn this.el.style[propNames[prop]];\n\t\t// return this.el.style[prefixedProperty(prop)];\n\t\t// return this.el.style.getPropertyValue(styleNames[prop]);\n\t},\n\n\t_setCSSProp: function(prop, value) {\n\t\tif (prop === \"transition\" && value == NO_TRANSITION_VALUE) {\n\t\t\tvalue = \"\";\n\t\t}\n\t\tif (value === null || value === void 0 || value === \"\") {\n\t\t\tthis._removeCSSProp(prop);\n\t\t} else {\n\t\t\tthis.el.style[propNames[prop]] = value;\n\t\t\t// this.el.style.setProperty(styleNames[prop], value);\n\t\t}\n\t},\n\n\t_removeCSSProp: function(prop) {\n\t\tthis.el.style[propNames[prop]] = \"\";\n\t\t// this.el.style.removeProperty(styleNames[prop]);\n\t},\n\n\t_getComputedCSSProps: function() {\n\t\tvar values = {};\n\t\tvar computed = window.getComputedStyle(this.el);\n\t\tfor (var p in propNames) {\n\t\t\tvalues[p] = computed[propNames[p]];\n\t\t}\n\t\treturn values;\n\t},\n}, {\n\ttransition: {\n\t\tget: function() {\n\t\t\treturn this._transition;\n\t\t}\n\t},\n\thasTransition: {\n\t\tget: function() {\n\t\t\treturn this._hasTransition;\n\t\t}\n\t},\n\tcapturedChanged: {\n\t\tget: function() {\n\t\t\treturn this._capturedChanged;\n\t\t}\n\t},\n\tcapturedX: {\n\t\tget: function() {\n\t\t\treturn this._capturedX;\n\t\t}\n\t},\n\tcapturedY: {\n\t\tget: function() {\n\t\t\treturn this._capturedY;\n\t\t}\n\t},\n\n\thasOffset: {\n\t\tget: function() {\n\t\t\treturn this._hasOffset;\n\t\t}\n\t},\n\toffsetX: {\n\t\tget: function() {\n\t\t\treturn this._offsetX;\n\t\t}\n\t},\n\toffsetY: {\n\t\tget: function() {\n\t\t\treturn this._offsetY;\n\t\t}\n\t},\n});\n\nmodule.exports = TransformItem;\n",
    "module.exports = function(a1, a2, dest) {\n\treturn a1.reduce(function(res, o, i, a) {\n\t\tif (a2.indexOf(o) == -1) res.push(o);\n\t\treturn res;\n\t}, (dest !== void 0) ? dest : []);\n};\n",
    "var PI2 = Math.PI * 2;\n\nvar splice = Array.prototype.splice;\n// var concat = Array.prototype.concat;\n\n/*\n *\tUsing javascript to convert radians to degrees with positive and\n *\tnegative values [https://stackoverflow.com/questions/29588404/]\n *\t`(((r * (180/Math.PI)) % 360) + 360) % 360;`\n *\t`function mod(n, m) {\n *\t\treturn ((n % m) + m) % m;\n *\t}`\n */\nvar _mod = function(n, m) {\n\treturn ((n % m) + m) % m;\n};\n\nvar setStyle = function(ctx, s) {\n\tif (typeof s != \"object\") return;\n\tfor (var p in s) {\n\t\tswitch (typeof ctx[p]) {\n\t\t\tcase \"undefined\":\n\t\t\t\tbreak;\n\t\t\tcase \"function\":\n\t\t\t\tif (Array.isArray(s[p])) {\n\t\t\t\t\tctx[p].apply(ctx, s[p]);\n\t\t\t\t} else {\n\t\t\t\t\tctx[p].call(ctx, s[p]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tctx[p] = s[p];\n\t\t}\n\t}\n};\n\nvar _drawShape = function(fn, s, ctx) {\n\tctx.save();\n\tif (s) {\n\t\tsetStyle(ctx, s);\n\t}\n\tfn.apply(null, splice.call(arguments, 2));\n\tif ('strokeStyle' in s) { /* ctx.lineWidth > 0 */\n\t\tctx.stroke();\n\t}\n\tif ('fillStyle' in s) { /* ctx.fillStyle !== \"transparent\" */\n\t\tctx.fill();\n\t}\n\tctx.restore();\n};\n\nmodule.exports = {\n\tsetStyle: setStyle,\n\n\tvGuide: function(ctx, x) {\n\t\tctx.beginPath();\n\t\tctx.moveTo(x, 0);\n\t\tctx.lineTo(x, ctx.canvas.height);\n\t},\n\tdrawVGuide: function(ctx, s, x) {\n\t\t_drawShape(this.vGuide, s, ctx, x);\n\t},\n\n\thGuide: function(ctx, y) {\n\t\tctx.beginPath();\n\t\tctx.moveTo(0, y);\n\t\tctx.lineTo(ctx.canvas.width, y);\n\t},\n\tdrawHGuide: function(ctx, s, y) {\n\t\t_drawShape(this.hGuide, s, ctx, y);\n\t},\n\n\tcrosshair: function(ctx, x, y, r) {\n\t\tctx.save();\n\t\tctx.translate(x, y);\n\t\tctx.rotate(Math.PI / 4);\n\t\tctx.beginPath();\n\t\tctx.moveTo(0, -r);\n\t\tctx.lineTo(0, r);\n\t\tctx.moveTo(-r, 0);\n\t\tctx.lineTo(r, 0);\n\t\tctx.restore();\n\t},\n\tdrawCrosshair: function(ctx, s, x, y, r) {\n\t\t_drawShape(this.crosshair, s, ctx, x, y, r);\n\t},\n\n\tcircle: function(ctx, x, y, r) {\n\t\tctx.beginPath();\n\t\tctx.arc(x, y, r, 0, PI2);\n\t},\n\tdrawCircle: function(ctx, s, x, y, r) {\n\t\t_drawShape(this.circle, s, ctx, x, y, r);\n\t},\n\n\tsquare: function(ctx, x, y, r) {\n\t\tr = Math.floor(r / 2) * 2;\n\t\tctx.beginPath();\n\t\tctx.rect(x - r, y - r, r * 2, r * 2);\n\t},\n\tdrawSquare: function(ctx, s, x, y, r) {\n\t\t_drawShape(this.square, s, ctx, x, y, r);\n\t},\n\n\tarrowhead: function(ctx, x, y, r, t) {\n\t\tctx.save();\n\t\tctx.translate(x, y);\n\t\tctx.rotate(_mod(t, PI2));\n\t\tctx.translate(r * 0.5, 0);\n\t\tctx.beginPath();\n\t\tctx.moveTo(0, 0);\n\t\t// ctx.lineTo(-r, r * Math.SQRT1_2);\n\t\t// ctx.lineTo(-r, -r * Math.SQRT1_2);\n\t\tctx.lineTo(-r * Math.SQRT2, r * Math.SQRT1_2);\n\t\tctx.arcTo(0, 0, -r * Math.SQRT2, -r * Math.SQRT1_2, r);\n\t\t// ctx.quadraticCurveTo(0, 0, -r * Math.SQRT2, -r * Math.SQRT1_2);\n\t\tctx.lineTo(0, 0);\n\t\tctx.closePath();\n\t\tctx.restore();\n\t},\n\tdrawArrowhead: function(ctx, s, x, y, r, t) {\n\t\t_drawShape(this.arrowhead, s, ctx, x, y, r, t);\n\t},\n\n\tarrowhead2: function(ctx, x, y, r, t) {\n\t\tctx.save();\n\t\tctx.translate(x, y);\n\t\tctx.rotate(_mod(t, PI2));\n\t\tctx.beginPath();\n\t\tctx.moveTo(-r, r * Math.SQRT1_2);\n\t\tctx.lineTo(0, 0);\n\t\tctx.lineTo(-r, -r * Math.SQRT1_2);\n\t\tctx.restore();\n\t},\n\tdrawArrowhead2: function(ctx, s, x, y, r, t) {\n\t\t_drawShape(this.arrowhead, s, ctx, x, y, r, t);\n\t},\n\n\trect: function(ctx, a1, a2, a3, a4) {\n\t\tif (typeof a1 === \"object\") {\n\t\t\ta4 = a1.height;\n\t\t\ta3 = a1.width;\n\t\t\ta2 = a1.top;\n\t\t\ta1 = a1.left;\n\t\t}\n\t\tctx.beginPath();\n\t\tctx.rect(a1, a2, a3, a4);\n\t},\n\tdrawRect: function(ctx, s, a1, a2, a3, a4) {\n\t\t_drawShape(this.rect, s, ctx, a1, a2, a3, a4);\n\t},\n\n\troundRect: function(ctx, x, y, w, h, r) {\n\t\tif (w < 2 * r) r = w / 2;\n\t\tif (h < 2 * r) r = h / 2;\n\t\tctx.beginPath();\n\t\tctx.moveTo(x + r, y);\n\t\tctx.arcTo(x + w, y, x + w, y + h, r);\n\t\tctx.arcTo(x + w, y + h, x, y + h, r);\n\t\tctx.arcTo(x, y + h, x, y, r);\n\t\tctx.arcTo(x, y, x + w, y, r);\n\t\tctx.closePath();\n\t},\n\tdrawRoundRect: function(ctx, s, x, y, w, h, r) {\n\t\t_drawShape(this.roundRect, s, ctx, x, y, h, r);\n\t},\n\n\tquadRoundRect: function(ctx, x, y, w, h, r) {\n\t\tctx.beginPath();\n\t\tctx.moveTo(x, y + r);\n\t\tctx.quadraticCurveTo(x, y, x + r, y);\n\t\tctx.lineTo(x + w - r, y);\n\t\tctx.quadraticCurveTo(x + w, y, x + w, y + r);\n\t\tctx.lineTo(x + w, y + h - r);\n\t\tctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);\n\t\tctx.lineTo(x + r, y + h);\n\t\tctx.quadraticCurveTo(x, y + h, x, y + h - r);\n\t\tctx.closePath();\n\t},\n\tdrawQuadRoundRect: function(ctx, s, x, y, w, h, r) {\n\t\t_drawShape(this.quadRoundRect, s, ctx, x, y, h, r);\n\t},\n};\n",
    "/*\n\nStackBlur - a fast almost Gaussian Blur For Canvas\n\nVersion:  0.5\nAuthor: Mario Klingemann\nContact:  mario@quasimondo.com\nWebsite: http://www.quasimondo.com/StackBlurForCanvas\nTwitter: @quasimondo\n\nIn case you find this class useful - especially in commercial projects -\nI am not totally unhappy for a small donation to my PayPal account\nmario@quasimondo.de\n\nOr support me on flattr: \nhttps://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript\n\nCopyright (c) 2010 Mario Klingemann\n\nPermission is hereby granted, free of charge, to any person\nobtaining a copy of this software and associated documentation\nfiles (the \"Software\"), to deal in the Software without\nrestriction, including without limitation the rights to use,\ncopy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the\nSoftware is furnished to do so, subject to the following\nconditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\nOF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\nHOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\nWHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\nOTHER DEALINGS IN THE SOFTWARE.\n*/\n\nmodule.exports = function() {\n\tthis.r = 0;\n\tthis.g = 0;\n\tthis.b = 0;\n\tthis.a = 0;\n\tthis.next = null;\n};\n",
    "module.exports = function(imageData, adj) {\n\tvar pixels = imageData.data;\n\tvar r, g, b, s;\n\tvar i, ii;\n\n\tif (arguments.length === 1) {\n\t\tfor (i = 0, ii = pixels.length; i < ii; i += 4) {\n\t\t\tpixels[i] = (pixels[i] * 299 + pixels[i + 1] * 587 + pixels[i + 2] * 144) / 1000;\n\t\t}\n\t} else\n\tif (arguments.length === 2) {\n\t\tif (0 >= adj > 1) {\n\t\t\tconsole.warn(\"argument out of range (1-0)\", adj);\n\t\t\treturn imageData;\n\t\t}\n\t\tfor (i = 0, ii = pixels.length; i < ii; i += 4) {\n\t\t\tr = pixels[i];\n\t\t\tg = pixels[i + 1];\n\t\t\tb = pixels[i + 2];\n\t\t\t// s = ((r * 299 + g * 587 + b * 144) / 1000) * (1 - adj);\n\t\t\t// pixels[i] = r * adj + s;\n\t\t\t// pixels[i + 1] = g * adj + s;\n\t\t\t// pixels[i + 2] = b * adj + s;\n\t\t\ts = Math.max(r, g, b);\n\t\t\tif (s === 0) {\n\t\t\t\tpixels[i] = Math.round(255 * adj);\n\t\t\t\tpixels[i + 1] = Math.round(255 * adj);\n\t\t\t\tpixels[i + 2] = Math.round(255 * adj);\n\t\t\t} else {\n\t\t\t\ts = 255 * adj / s;\n\t\t\t\tpixels[i] = Math.round(r * s);\n\t\t\t\tpixels[i + 1] = Math.round(g * s);\n\t\t\t\tpixels[i + 2] = Math.round(b * s);\n\t\t\t}\n\t\t}\n\t}\n\treturn imageData;\n};\n\n// function saturation(r,g,b, s) {\n//     var min = rgb.indexOf(Math.min.apply(null, rgb)), // index of min\n//         max = rgb.indexOf(Math.max.apply(null, rgb)), // index of max\n//         mid = [0, 1, 2].filter(function (i) {return i !== min && i !== max;})[0],\n//         a = rgb[max] - rgb[min],\n//         b = rgb[mid] - rgb[min],\n//         x = rgb[max],\n//         arr = [x, x, x];\n//     if (min === max) {\n//         min = 2; // both max = min = 0, => mid = 1, so set min = 2\n//         a = 1;   // also means a = b = 0, don't want division by 0 in `b / a`\n//     }\n//\n//     arr[max] = x;\n//     arr[min] = Math.round(x * (1 - s));\n//     arr[mid] = Math.round(x * ((1 - s) + s * b / a));\n//\n//     return arr;\n// }\n\n\n// function nvalue(rgb, v) {\n//     var x = Math.max.apply(null, rgb);\n//     if (x === 0)\n//         return [\n//             Math.round(255 * v),\n//             Math.round(255 * v),\n//             Math.round(255 * v)\n//         ];\n//     x = 255 * v / x;\n//     return [\n//         Math.round(rgb[0] * x),\n//         Math.round(rgb[1] * x),\n//         Math.round(rgb[2] * x)\n//     ];\n// }\n",
    "module.exports = function(imageData, opts) {\n\tvar pixels = imageData.data;\n\tvar pixelsNum = pixels.length;\n\tvar rgbAvg = [0, 0, 0];\n\tvar i;\n\n\tfor (i = 0; i < pixelsNum; i += 4) {\n\t\trgbAvg[0] += pixels[i];\n\t\trgbAvg[1] += pixels[i + 1];\n\t\trgbAvg[2] += pixels[i + 2];\n\t}\n\tfor (i = 0; i < 3; i++) {\n\t\trgbAvg[i] = (rgbAvg[i] / (pixelsNum / 4)) | 0;\n\t}\n\treturn rgbAvg;\n};\n",
    "/*\n\nStackBlur - a fast almost Gaussian Blur For Canvas\n\nVersion:  0.5\nAuthor: Mario Klingemann\nContact:  mario@quasimondo.com\nWebsite: http://www.quasimondo.com/StackBlurForCanvas\nTwitter: @quasimondo\n\nIn case you find this class useful - especially in commercial projects -\nI am not totally unhappy for a small donation to my PayPal account\nmario@quasimondo.de\n\nOr support me on flattr: \nhttps://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript\n\nCopyright (c) 2010 Mario Klingemann\n\nPermission is hereby granted, free of charge, to any person\nobtaining a copy of this software and associated documentation\nfiles (the \"Software\"), to deal in the Software without\nrestriction, including without limitation the rights to use,\ncopy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the\nSoftware is furnished to do so, subject to the following\nconditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\nOF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\nHOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\nWHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\nOTHER DEALINGS IN THE SOFTWARE.\n*/\n\nmodule.exports = [\n\t\t512, 512, 456, 512, 328, 456, 335, 512, 405, 328, 271, 456, 388, 335, 292, 512,\n\t\t454, 405, 364, 328, 298, 271, 496, 456, 420, 388, 360, 335, 312, 292, 273, 512,\n\t\t482, 454, 428, 405, 383, 364, 345, 328, 312, 298, 284, 271, 259, 496, 475, 456,\n\t\t437, 420, 404, 388, 374, 360, 347, 335, 323, 312, 302, 292, 282, 273, 265, 512,\n\t\t497, 482, 468, 454, 441, 428, 417, 405, 394, 383, 373, 364, 354, 345, 337, 328,\n\t\t320, 312, 305, 298, 291, 284, 278, 271, 265, 259, 507, 496, 485, 475, 465, 456,\n\t\t446, 437, 428, 420, 412, 404, 396, 388, 381, 374, 367, 360, 354, 347, 341, 335,\n\t\t329, 323, 318, 312, 307, 302, 297, 292, 287, 282, 278, 273, 269, 265, 261, 512,\n\t\t505, 497, 489, 482, 475, 468, 461, 454, 447, 441, 435, 428, 422, 417, 411, 405,\n\t\t399, 394, 389, 383, 378, 373, 368, 364, 359, 354, 350, 345, 341, 337, 332, 328,\n\t\t324, 320, 316, 312, 309, 305, 301, 298, 294, 291, 287, 284, 281, 278, 274, 271,\n\t\t268, 265, 262, 259, 257, 507, 501, 496, 491, 485, 480, 475, 470, 465, 460, 456,\n\t\t451, 446, 442, 437, 433, 428, 424, 420, 416, 412, 408, 404, 400, 396, 392, 388,\n\t\t385, 381, 377, 374, 370, 367, 363, 360, 357, 354, 350, 347, 344, 341, 338, 335,\n\t\t332, 329, 326, 323, 320, 318, 315, 312, 310, 307, 304, 302, 299, 297, 294, 292,\n\t\t289, 287, 285, 282, 280, 278, 275, 273, 271, 269, 267, 265, 263, 261, 259];\n",
    "module.exports = function(pixels, adjustment) {\n\tvar d = pixels.data;\n\tfor (var i = 0; i < d.length; i += 4) {\n\t\td[i] *= adjustment;\n\t\td[i + 1] *= adjustment;\n\t\td[i + 2] *= adjustment;\n\t}\n\treturn pixels;\n};\n",
    "/*\n\nStackBlur - a fast almost Gaussian Blur For Canvas\n\nVersion:  0.5\nAuthor: Mario Klingemann\nContact:  mario@quasimondo.com\nWebsite: http://www.quasimondo.com/StackBlurForCanvas\nTwitter: @quasimondo\n\nIn case you find this class useful - especially in commercial projects -\nI am not totally unhappy for a small donation to my PayPal account\nmario@quasimondo.de\n\nOr support me on flattr: \nhttps://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript\n\nCopyright (c) 2010 Mario Klingemann\n\nPermission is hereby granted, free of charge, to any person\nobtaining a copy of this software and associated documentation\nfiles (the \"Software\"), to deal in the Software without\nrestriction, including without limitation the rights to use,\ncopy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the\nSoftware is furnished to do so, subject to the following\nconditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\nOF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\nHOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\nWHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\nOTHER DEALINGS IN THE SOFTWARE.\n*/\n\nmodule.exports = [\n\t\t9, 11, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 17,\n\t\t17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 18, 19,\n\t\t19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20,\n\t\t20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21,\n\t\t21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21,\n\t\t21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22,\n\t\t22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22,\n\t\t22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23,\n\t\t23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n\t\t23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n\t\t23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23,\n\t\t23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n\t\t24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n\t\t24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n\t\t24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,\n\t\t24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24];\n",
    "/* jshint ignore:start */\n/*\n\nStackBlur - a fast almost Gaussian Blur For Canvas\n\nVersion:  0.5\nAuthor: Mario Klingemann\nContact:  mario@quasimondo.com\nWebsite: http://www.quasimondo.com/StackBlurForCanvas\nTwitter: @quasimondo\n\nIn case you find this class useful - especially in commercial projects -\nI am not totally unhappy for a small donation to my PayPal account\nmario@quasimondo.de\n\nOr support me on flattr:\nhttps://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript\n\nCopyright (c) 2010 Mario Klingemann\n\nPermission is hereby granted, free of charge, to any person\nobtaining a copy of this software and associated documentation\nfiles (the \"Software\"), to deal in the Software without\nrestriction, including without limitation the rights to use,\ncopy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the\nSoftware is furnished to do so, subject to the following\nconditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\nOF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\nHOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\nWHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\nOTHER DEALINGS IN THE SOFTWARE.\n*/\n\nvar mul_table = require(\"./mul_table\");\nvar shg_table = require(\"./shg_table\");\nvar BlurStack = require(\"./BlurStack\");\n\nmodule.exports = function(imageData, opts) {\n\tif ((typeof opts === \"object\") && opts.hasOwnProperty(\"radius\")) {\n\t\topts = opts.radius;\n\t}\n\tif ((typeof opts !== \"number\") || isNaN(opts) || (1 > opts)) {\n\t\t// no valid argument value do nothing\n\t\treturn imageData;\n\t}\n\tvar radius = opts | 0;\n\tvar pixels = imageData.data,\n\t\twidth = imageData.width,\n\t\theight = imageData.height;\n\n\tvar x, y, i, p, yp, yi, yw, r_sum, g_sum, b_sum,\n\t\tr_out_sum, g_out_sum, b_out_sum,\n\t\tr_in_sum, g_in_sum, b_in_sum,\n\t\tpr, pg, pb, rbs;\n\n\tvar div = radius + radius + 1;\n\tvar w4 = width << 2;\n\tvar widthMinus1 = width - 1;\n\tvar heightMinus1 = height - 1;\n\tvar radiusPlus1 = radius + 1;\n\tvar sumFactor = radiusPlus1 * (radiusPlus1 + 1) / 2;\n\n\tvar stackStart = new BlurStack();\n\tvar stack = stackStart;\n\tfor (i = 1; i < div; i++) {\n\t\tstack = stack.next = new BlurStack();\n\t\tif (i == radiusPlus1) var stackEnd = stack;\n\t}\n\tstack.next = stackStart;\n\tvar stackIn = null;\n\tvar stackOut = null;\n\n\tyw = yi = 0;\n\n\tvar mul_sum = mul_table[radius];\n\tvar shg_sum = shg_table[radius];\n\n\tfor (y = 0; y < height; y++) {\n\t\tr_in_sum = g_in_sum = b_in_sum = r_sum = g_sum = b_sum = 0;\n\n\t\tr_out_sum = radiusPlus1 * (pr = pixels[yi]);\n\t\tg_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);\n\t\tb_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);\n\n\t\tr_sum += sumFactor * pr;\n\t\tg_sum += sumFactor * pg;\n\t\tb_sum += sumFactor * pb;\n\n\t\tstack = stackStart;\n\n\t\tfor (i = 0; i < radiusPlus1; i++) {\n\t\t\tstack.r = pr;\n\t\t\tstack.g = pg;\n\t\t\tstack.b = pb;\n\t\t\tstack = stack.next;\n\t\t}\n\n\t\tfor (i = 1; i < radiusPlus1; i++) {\n\t\t\tp = yi + ((widthMinus1 < i ? widthMinus1 : i) << 2);\n\t\t\tr_sum += (stack.r = (pr = pixels[p])) * (rbs = radiusPlus1 - i);\n\t\t\tg_sum += (stack.g = (pg = pixels[p + 1])) * rbs;\n\t\t\tb_sum += (stack.b = (pb = pixels[p + 2])) * rbs;\n\n\t\t\tr_in_sum += pr;\n\t\t\tg_in_sum += pg;\n\t\t\tb_in_sum += pb;\n\n\t\t\tstack = stack.next;\n\t\t}\n\n\t\tstackIn = stackStart;\n\t\tstackOut = stackEnd;\n\t\tfor (x = 0; x < width; x++) {\n\t\t\tpixels[yi] = (r_sum * mul_sum) >> shg_sum;\n\t\t\tpixels[yi + 1] = (g_sum * mul_sum) >> shg_sum;\n\t\t\tpixels[yi + 2] = (b_sum * mul_sum) >> shg_sum;\n\n\t\t\tr_sum -= r_out_sum;\n\t\t\tg_sum -= g_out_sum;\n\t\t\tb_sum -= b_out_sum;\n\n\t\t\tr_out_sum -= stackIn.r;\n\t\t\tg_out_sum -= stackIn.g;\n\t\t\tb_out_sum -= stackIn.b;\n\n\t\t\tp = (yw + ((p = x + radius + 1) < widthMinus1 ? p : widthMinus1)) << 2;\n\n\t\t\tr_in_sum += (stackIn.r = pixels[p]);\n\t\t\tg_in_sum += (stackIn.g = pixels[p + 1]);\n\t\t\tb_in_sum += (stackIn.b = pixels[p + 2]);\n\n\t\t\tr_sum += r_in_sum;\n\t\t\tg_sum += g_in_sum;\n\t\t\tb_sum += b_in_sum;\n\n\t\t\tstackIn = stackIn.next;\n\n\t\t\tr_out_sum += (pr = stackOut.r);\n\t\t\tg_out_sum += (pg = stackOut.g);\n\t\t\tb_out_sum += (pb = stackOut.b);\n\n\t\t\tr_in_sum -= pr;\n\t\t\tg_in_sum -= pg;\n\t\t\tb_in_sum -= pb;\n\n\t\t\tstackOut = stackOut.next;\n\n\t\t\tyi += 4;\n\t\t}\n\t\tyw += width;\n\t}\n\n\tfor (x = 0; x < width; x++) {\n\t\tg_in_sum = b_in_sum = r_in_sum = g_sum = b_sum = r_sum = 0;\n\n\t\tyi = x << 2;\n\t\tr_out_sum = radiusPlus1 * (pr = pixels[yi]);\n\t\tg_out_sum = radiusPlus1 * (pg = pixels[yi + 1]);\n\t\tb_out_sum = radiusPlus1 * (pb = pixels[yi + 2]);\n\n\t\tr_sum += sumFactor * pr;\n\t\tg_sum += sumFactor * pg;\n\t\tb_sum += sumFactor * pb;\n\n\t\tstack = stackStart;\n\n\t\tfor (i = 0; i < radiusPlus1; i++) {\n\t\t\tstack.r = pr;\n\t\t\tstack.g = pg;\n\t\t\tstack.b = pb;\n\t\t\tstack = stack.next;\n\t\t}\n\n\t\typ = width;\n\n\t\tfor (i = 1; i <= radius; i++) {\n\t\t\tyi = (yp + x) << 2;\n\n\t\t\tr_sum += (stack.r = (pr = pixels[yi])) * (rbs = radiusPlus1 - i);\n\t\t\tg_sum += (stack.g = (pg = pixels[yi + 1])) * rbs;\n\t\t\tb_sum += (stack.b = (pb = pixels[yi + 2])) * rbs;\n\n\t\t\tr_in_sum += pr;\n\t\t\tg_in_sum += pg;\n\t\t\tb_in_sum += pb;\n\n\t\t\tstack = stack.next;\n\n\t\t\tif (i < heightMinus1) {\n\t\t\t\typ += width;\n\t\t\t}\n\t\t}\n\n\t\tyi = x;\n\t\tstackIn = stackStart;\n\t\tstackOut = stackEnd;\n\t\tfor (y = 0; y < height; y++) {\n\t\t\tp = yi << 2;\n\t\t\tpixels[p] = (r_sum * mul_sum) >> shg_sum;\n\t\t\tpixels[p + 1] = (g_sum * mul_sum) >> shg_sum;\n\t\t\tpixels[p + 2] = (b_sum * mul_sum) >> shg_sum;\n\n\t\t\tr_sum -= r_out_sum;\n\t\t\tg_sum -= g_out_sum;\n\t\t\tb_sum -= b_out_sum;\n\n\t\t\tr_out_sum -= stackIn.r;\n\t\t\tg_out_sum -= stackIn.g;\n\t\t\tb_out_sum -= stackIn.b;\n\n\t\t\tp = (x + (((p = y + radiusPlus1) < heightMinus1 ? p : heightMinus1) * width)) << 2;\n\n\t\t\tr_sum += (r_in_sum += (stackIn.r = pixels[p]));\n\t\t\tg_sum += (g_in_sum += (stackIn.g = pixels[p + 1]));\n\t\t\tb_sum += (b_in_sum += (stackIn.b = pixels[p + 2]));\n\n\t\t\tstackIn = stackIn.next;\n\n\t\t\tr_out_sum += (pr = stackOut.r);\n\t\t\tg_out_sum += (pg = stackOut.g);\n\t\t\tb_out_sum += (pb = stackOut.b);\n\n\t\t\tr_in_sum -= pr;\n\t\t\tg_in_sum -= pg;\n\t\t\tb_in_sum -= pb;\n\n\t\t\tstackOut = stackOut.next;\n\n\t\t\tyi += width;\n\t\t}\n\t}\n\treturn imageData;\n};\n\n/* jshint ignore:end */\n",
    "/**\n * @module utils/canvas/calcArcHConnector\n */\n\nmodule.exports = function(x1, y1, r1, x2, y2, r2, ro) {\n\tvar qx = x2 > x1 ? 1 : -1;\n\tvar qy = y2 > y1 ? 1 : -1;\n\tvar dy = Math.abs(y2 - y1);\n\tvar dx = Math.abs(x2 - x1);\n\tvar rr = r1 + r2;\n\tvar tx1, tx2, c, tx, ty;\n\n\tif (dy < 1) {\n\t\t// points are aligned horizontally, no arcs needed\n\t\ttx1 = 0;\n\t\ttx2 = dx\n\t\t// return [x1, x2];\n\t}\n\n\tif (dy >= rr && dx >= rr) {\n\t\t// arcs fit horizontally:\n\t\t// second circle center is r1+r2, tangent intersect at x=r1\n\t\tc = rr;\n\t\ttx1 = r1;\n\t\ttx2 = r1;\n\t} else {\n\t\t// arcs overlap horizontally:\n\t\t// find second circle center\n\t\tc = Math.sqrt(dy * r2 * 2 + dy * r1 * 2 - dy * dy);\n\n\t\t// circles tangent point\n\t\ttx = (c * r1) / rr;\n\t\tty = (dy * r1) / rr;\n\n\t\tif (r1 < ty || c > dx) {\n\t\t\treturn;\n\t\t}\n\n\t\t// tangent perpendicular slope\n\t\tvar slope = (rr - dy) / c;\n\t\t// tangent intersections\n\t\ttx1 = tx - (ty * slope);\n\t\ttx2 = (dy * slope) + tx1;\n\n\t\t/*\n\t\t// circle centers\n\t\tvar ccx1, ccy1, ccx2, ccy2;\n\t\tccx1 = 0;\n\t\tccy1 = r1;\n\t\tccx2 = c;\n\t\tccy2 = dy - r2;\n\t\t// tangent perpendicular slope\n\t\tvar slope = (ccy1 - ccy2) / (ccx2 - ccx1);\n\t\tvar xSec = tx - (ty * slope);\n\t\t// tangent intersections\n\t\ttx1 = xSec;\n\t\ttx2 = (dy * slope) + xSec;\n\t\t*/\n\t}\n\n\t// offset arcTo's in x-axis\n\tif (ro > 0) {\n\t\tif (ro > 1) {\n\t\t\tro = Math.min(dx - rr, ro);\n\t\t} else {\n\t\t\tro *= dx - rr;\n\t\t}\n\t\ttx1 += ro;\n\t\ttx2 += ro;\n\t}\n\n\treturn [tx1 * qx + x1, tx2 * qx + x1, tx1, tx2];\n};\n\n/*\nvar drawArcConnector = function(ctx, x1, y1, x2, y2, r) {\n\tvar dx, dy, hx, hy, gx, gy;\n\n\thx = 0;\n\thy = 0;\n\tgx = (x1 + x2) / 2;\n\tgy = (y1 + y2) / 2;\n\tdx = Math.abs(x1 - gx);\n\tdy = Math.abs(y1 - gy);\n\n\tif (dx < r && dy < r) {\n\t\tr = Math.min(dx * Math.SQRT1_2, dy * Math.SQRT1_2);\n\t} else {\n\t\tif (dx < r) {\n\t\t\thy = Math.acos(dx / r) * r * 0.5;\n\t\t\tif (y1 > y2) hy *= -1;\n\t\t}\n\t\tif (dy < r) {\n\t\t\thx = Math.acos(dy / r) * r * 0.5;\n\t\t\tif (x1 > x2) hx *= -1;\n\t\t}\n\t}\n\tctx.arcTo(gx - hx, y1, gx + hx, y2, r);\n\tctx.arcTo(gx + hx, y2, x2, y2, r);\n};\n\nvar drawArcConnector2 = function(ctx, x1, y1, x2, y2, r) {\n\tvar dx, dy, hx, hy, cx1, cx2;\n\n\thx = 0;\n\thy = 0;\n\tdx = Math.abs(x2 - x1) / 2;\n\tdy = Math.abs(y1 - y2) / 2;\n\n\tif (dx < r && dy < r) {\n\t\tr = Math.min(dx * Math.SQRT1_2, dy * Math.SQRT1_2);\n\t} else {\n\t\tif (dx < r) {\n\t\t\thy = Math.acos(dx / r) * r;\n\t\t}\n\t\tif (dy < r) {\n\t\t\thx = Math.acos(dy / r) * r;\n\t\t}\n\t}\n\tcx1 = x1 + dx;\n\tcx2 = x2 - (dx - hx / 2);\n\tctx.arcTo(cx1, y1, cx2, y2, r);\n\tctx.arcTo(cx2, y2, x2, y2, r);\n};\n\nvar drawArcConnector1 = function(ctx, x1, y1, x2, y2, r) {\n\tvar dx, dy, cx;\n\n\tdx = Math.abs(x2 - x1) / 2;\n\tdy = Math.abs(y1 - y2) / 2;\n\tr = Math.min(r, dy * Math.SQRT1_2);\n\tif (x1 < x2) {\n\t\tcx = x1 + dx + r;\n\t} else {\n\t\tcx = x2 - dx - r;\n\t}\n\t// cx = (x2 + x1) / 2;\n\t// cx += x1 < x2 ? r : -r;\n\n\tctx.arcTo(cx, y1, cx, y2, r);\n\tctx.arcTo(cx, y2, x2, y2, r);\n};\n*/\n",
    "/* global HTMLElement, CSSStyleDeclaration */\n\n// var parseSize = require(\"./parseSize\");\n\nvar CSS_BOX_PROPS = [\n\t\"boxSizing\", \"position\", \"objectFit\"\n];\nvar CSS_EDGE_PROPS = [\n\t\"marginTop\", \"marginBottom\", \"marginLeft\", \"marginRight\",\n\t\"borderTopWidth\", \"borderBottomWidth\", \"borderLeftWidth\", \"borderRightWidth\",\n\t\"paddingTop\", \"paddingBottom\", \"paddingLeft\", \"paddingRight\",\n];\nvar CSS_POS_PROPS = [\"top\", \"bottom\", \"left\", \"right\"];\nvar CSS_SIZE_PROPS = [\"width\", \"height\", \"minWidth\", \"minHeight\", \"maxWidth\", \"maxHeight\"];\nvar CSS_ALL_PROPS = CSS_EDGE_PROPS.concat(CSS_SIZE_PROPS, CSS_POS_PROPS);\n\n// var COMPUTED_PROPS = [\n// \t\"clientLeft\", \"clientTop\", \"clientWidth\", \"clientHeight\",\n// \t\"offsetLeft\", \"offsetTop\", \"offsetWidth\", \"offsetHeight\"\n// ];\n// var o = _.pick(element, function(val) {\n// \treturn /^(offset|client)(Left|Top|Width|Height)/.test(val);\n// });\n\nvar cssDimensionRE = /^(-?[\\d\\.]+)(px|em|rem)$/;\n// var cssDimRe = /^([-\\.0-9]+)([rem]+)$/;\n\nmodule.exports = function(s, m, includeSizePos) {\n\tif (s instanceof HTMLElement) {\n\t\ts = getComputedStyle(s);\n\t}\n\tif (DEBUG) {\n\t\tif (!(s instanceof CSSStyleDeclaration)) {\n\t\t\tthrow new Error(\"Not a CSSStyleDeclaration nor HTMLElement\");\n\t\t}\n\t}\n\tvar v, p, i, ii, emPx, remPx;\n\tm || (m = {});\n\n\temPx = m.fontSize = parseFloat(s.fontSize);\n\n\tfor (i = 0, ii = CSS_BOX_PROPS.length; i < ii; i++) {\n\t\tp = CSS_BOX_PROPS[i];\n\t\tif (p in s) {\n\t\t\tm[p] = s[p];\n\t\t}\n\t}\n\tvar cssProps = includeSizePos ? CSS_EDGE_PROPS : CSS_ALL_PROPS;\n\tfor (i = 0, ii = cssProps.length; i < ii; i++) {\n\t\tp = cssProps[i];\n\t\tm[\"_\" + p] = s[p];\n\t\tif (s[p] && (v = cssDimensionRE.exec(s[p]))) {\n\t\t\tif (v[2] === \"px\") {\n\t\t\t\tm[p] = parseFloat(v[1]);\n\t\t\t} else if (v[2] === \"em\") {\n\t\t\t\tm[p] = parseFloat(v[1]) * emPx;\n\t\t\t} else if (v[2] === \"rem\") {\n\t\t\t\tremPx || (remPx = parseFloat(getComputedStyle(document.documentElement).fontSize));\n\t\t\t\tm[p] = parseFloat(v[1]) * remPx;\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Ignoring value\", p, v[1], v[2]);\n\t\t\t\tm[p] = null;\n\t\t\t}\n\t\t} // else {\n\t\t//\tconsole.warn(\"Ignoring unitless value\", p, v);\n\t\t//}\n\t}\n\treturn m;\n};\n",
    "/* easeInQuad */\nmodule.exports = function(x, t, b, c, d) {\n\treturn c * (t /= d) * t + b;\n};\n",
    "/* easeOutQuad */\nmodule.exports = function(t, b, c, d) {\n\treturn -c * (t /= d) * (t - 2) + b;\n};\n",
    "/**\n * @param {number} i current iteration\n * @param {number} s start value\n * @param {number} d change in value\n * @param {number} t total iterations\n * @return {number}\n */\nvar linear = function(i, s, d, t) {\n\treturn d * i / t + s;\n};\n\nmodule.exports = linear;\n",
    "/* https://html.spec.whatwg.org/multipage/media.html#event-media-canplay\n */\nmodule.exports = [\n\t// networkState\n\t\"loadstart\",\n\t\"progress\",\n\t\"suspend\",\n\t\"abort\",\n\t\"error\",\n\t\"emptied\",\n\t\"stalled\",\n\t// readyState\n\t\"loadedmetadata\",\n\t\"loadeddata\",\n\t\"canplay\",\n\t\"canplaythrough\",\n\t\"playing\",\n\t\"waiting\",\n\t//\n\t\"seeking\", // seeking changed to true\n\t\"seeked\", // seeking changed to false\n\t\"ended\", // ended is true\n\t//\n\t\"durationchange\", // duration updated\n\t\"timeupdate\", // currentTime updated\n\t\"play\", // paused is false\n\t\"pause\", // paused is false\n\t\"paused\", // ??\n\t\"ratechange\",\n\t//\n\t\"resize\",\n\t\"volumechange\",\n];\n",
    "/**\n * @module app/view/component/GraphView\n */module.exports = function(rect, dx, dy) {\n\tif (arguments.length == 2) {\n\t\tdy = dx;\n\t}\n\tvar r = {\n\t\twidth: rect.width + dx * 2,\n\t\theight: rect.height + dy * 2\n\t};\n\tif (r.width >= 0) {\n\t\tr.left = rect.left - dx;\n\t\tr.right = r.left + r.width;\n\t\tr.x = r.left;\n\t} else {\n\t\tr.right = rect.right + dx;\n\t\tr.left = rect.right - r.width;\n\t\tr.y = r.right;\n\t}\n\tif (r.height >= 0) {\n\t\tr.top = rect.top - dy;\n\t\tr.bottom = r.top + r.height;\n\t\tr.y = r.top;\n\t} else {\n\t\tr.bottom = rect.bottom + dy;\n\t\tr.top = rect.bottom - r.height;\n\t\tr.y = r.bottom;\n\t}\n\n\treturn r;\n};\n",
    "/** @type {Array} lowercase prefixes */\nvar lcPrefixes = [\"\"].concat(require(\"./prefixes\"));\n\n/** @type {Array} capitalized prefixes */\nvar ucPrefixes = lcPrefixes.map(function(s) {\n\treturn (s === \"\") ? s : s.charAt(0).toUpperCase() + s.substr(1);\n});\n\n/** @type {Object} specific event solvers */\nvar _solvers = {};\n\n/** @type {Object} cached values */\nvar _cache = {};\n\n/**\n * @param {String} name Unprefixed event name\n * @param {?Object} obj Prefix test target\n * @param {?String} testProp Proxy property to test prefixes\n * @return {String|null}\n */\nvar _prefixedEvent = function(name, obj, testProp) {\n\tvar prefixes = /^[A-Z]/.test(name) ? ucPrefixes : lcPrefixes;\n\tobj || (obj = document);\n\tfor (var i = 0; i < prefixes.length; i++) {\n\t\tif (testProp) {\n\t\t\tif ((prefixes[i] + testProp) in obj) {\n\t\t\t\treturn prefixes[i] + name;\n\t\t\t}\n\t\t}\n\t\tif ((\"on\" + prefixes[i] + name) in obj) {\n\t\t\treturn prefixes[i] + name;\n\t\t}\n\t}\n\treturn null;\n};\n\n// transitionend\n_solvers[\"transitionend\"] = function() {\n\tvar prop, style = document.body.style,\n\t\tmap = {\n\t\t\t\"transition\": \"transitionend\",\n\t\t\t\"WebkitTransition\": \"webkitTransitionEnd\",\n\t\t\t\"MozTransition\": \"transitionend\",\n\t\t\t// \"msTransition\" : \"MSTransitionEnd\",\n\t\t\t\"OTransition\": \"oTransitionEnd\"\n\t\t};\n\tfor (prop in map) {\n\t\tif (prop in style) {\n\t\t\treturn map[prop];\n\t\t}\n\t}\n\treturn null;\n};\n\n/**\n * get the prefixed property\n * @param {String} property name\n * @param {Object} look-up object\n * @returns {String|null} prefixed\n */\nmodule.exports = function(evName) {\n\tif (!_cache.hasOwnProperty(evName)) {\n\t\t_cache[evName] = _solvers.hasOwnProperty(evName) ? _solvers[evName]() : _prefixedEvent.apply(null, arguments);\n\t\tif (_cache[evName] === null) {\n\t\t\tconsole.warn(\"Event '%s' not found\", evName);\n\t\t} else {\n\t\t\tconsole.log(\"Event '%s' found as '%s'\", evName, _cache[evName]);\n\t\t}\n\t}\n\treturn _cache[evName];\n\t// return _cache[evName] || (_cache[evName] = _solvers[evName]? _solvers[evName].call() : _prefixedProperty.apply(null, arguments));\n};\n\n/*\nvar defaultTest = function(name, obj) {\n\tvar prefixes = /^[A-Z]/.test(name)? ucPrefixes : lcPrefixes;\n\tfor (var i = 0; i < prefixes.length; i++) {\n\t\tif ((\"on\" + prefixes[i] + name) in obj) {\n\t\t\tconsole.log(\"Event '%s' found as '%s'\", name, prefixes[i] + name);\n\t\t\treturn prefixes[i] + name;\n\t\t}\n\t}\n\treturn null;\n};\n\nvar proxyTest = function(name, obj, testProp) {\n\tvar prefixes = /^[A-Z]/.test(name)? ucPrefixes : lcPrefixes;\n\tfor (var i = 0; i < prefixes.length; i++) {\n\t\tif ((prefixes[i] + testProp) in obj) {\n\t\t\tconsole.log(\"Event %s inferred as '%s' from property '%s'\", name, prefixes[i] + name, testProp);\n\t\t\treturn prefixes[i] + name;\n\t\t}\n\t}\n\treturn null;\n};\n*/\n",
    "/**\n/* @module utils/prefixedProperty\n/*/\n\n/** @type {module:utils/prefixes} */\nvar prefixes = require(\"./prefixes\");\n/** @type {Number} prefix count */\nvar _prefixNum = prefixes.length;\n/** @type {Array} cached values */\nvar _cache = {};\n\nvar _prefixedProperty = function(prop, obj) {\n\tvar prefixedProp, camelProp;\n\n\tif (prop in obj) {\n\t\tconsole.log(\"Property '%s' found unprefixed\", prop);\n\t\treturn prop;\n\t}\n\tcamelProp = prop[0].toUpperCase() + prop.slice(1);\n\tfor (var i = 0; i < _prefixNum; i++) {\n\t\tprefixedProp = prefixes[i] + camelProp;\n\t\tif (prefixedProp in obj) {\n\t\t\tconsole.log(\"Property '%s' found as '%s'\", prop, prefixedProp);\n\t\t\treturn prefixedProp;\n\t\t}\n\t}\n\tconsole.error(\"Property '%s' not found\", prop);\n\treturn null;\n};\n\n/**\n * get the prefixed property\n * @param {String} property name\n * @param {Object} look-up object\n * @returns {String|null} prefixed\n */\nmodule.exports = function(prop, obj) {\n\treturn _cache[prop] || (_cache[prop] = _prefixedProperty(prop, obj || document.body.style));\n};\n",
    "/**\n/* @module utils/prefixedStyleName\n/*/\n\n/** @type {module:utils/prefixes} */\nvar prefixes = require(\"./prefixes\"); //.map(function(prefix) { return \"-\" + prefix + \"-\"; });\n/** @type {Number} prefix count */\nvar _prefixNum = prefixes.length;\n/** @type {Array} cached values */\nvar _cache = {};\n\nvar _prefixedStyleName = function(style, styleObj) {\n\tvar prefixedStyle;\n\n\tif (style in styleObj) {\n\t\tconsole.log(\"CSS style '%s' found unprefixed\", style);\n\t\treturn style;\n\t}\n\tfor (var i = 0; i < _prefixNum; i++) {\n\t\tprefixedStyle = \"-\" + prefixes[i] + \"-\" + style;\n\t\t// prefixedStyle = prefixes[i] + style;\n\t\tif (prefixedStyle in styleObj) {\n\t\t\tconsole.log(\"CSS style '%s' found as '%s'\", style, prefixedStyle);\n\t\t\treturn prefixedStyle;\n\t\t}\n\t}\n\tconsole.warn(\"CSS style '%s' not found\", style);\n\treturn null;\n};\n\n/**\n * get the prefixed style name\n * @param {String} style name\n * @param {Object} look-up style object\n * @returns {String|Undefined} prefixed\n */\nmodule.exports = function(style, styleObj) {\n\t// return _cache[style] || (_cache[style] = _prefixedStyleName_reverse(style, styleObj || document.body.style));\n\treturn _cache[style] || (_cache[style] = _prefixedStyleName(style, styleObj || document.body.style));\n};\n\n// /** @type {module:utils/strings/camelToDashed} */\n// var camelToDashed = require(\"./strings/camelToDashed\");\n// /** @type {module:utils/prefixedProperty} */\n// var prefixedProperty = require(\"./prefixedProperty\");\n// /** @type {module:utils/strings/dashedToCamel} */\n// var dashedToCamel = require(\"./strings/dashedToCamel\");\n//\n// var _prefixedStyleName_reverse = function (style, styleObj) {\n// \tvar camelProp, prefixedProp;\n// \tcamelProp = dashedToCamel(style);\n// \tprefixedProp = prefixedProperty(camelProp, styleObj);\n// \treturn prefixedProp? (camelProp === prefixedProp? \"\" : \"-\") + camelToDashed(prefixedProp) : null;\n// };\n",
    "module.exports = [\"webkit\", \"moz\", \"ms\", \"o\"];\n",
    "module.exports = function(pp, reason) {\n\tif (pp.length > 0) {\n\t\tpp.forEach(function(p, i, a) {\n\t\t\tp.reject(reason);\n\t\t\ta[i] = null;\n\t\t});\n\t\tpp.length = 0;\n\t}\n\treturn pp;\n};\n",
    "module.exports = function(pp, result) {\n\tif (pp.length != 0) {\n\t\tpp.forEach(function(p, i, a) {\n\t\t\tp.resolve(result);\n\t\t\ta[i] = null;\n\t\t});\n\t\tpp.length = 0;\n\t}\n\treturn pp;\n};\n",
    "module.exports = function(str) {\n\treturn str.replace(/[A-Z]/g, function($0) {\n\t\treturn \"-\" + $0.toLowerCase();\n\t});\n};\n",
    "module.exports = function(s) {\n\treturn s.replace(/<[^>]+>/g, \"\");\n};\n",
    "/** @type {module:hammerjs} */\nvar Hammer = require(\"hammerjs\");\n\n// /**\n//  * get a usable string, used as event postfix\n//  * @param {Const} state\n//  * @returns {String} state\n//  */\n// function stateStr(state) {\n// \tif (state & Hammer.STATE_CANCELLED) {\n// \t\treturn \"cancel\";\n// \t} else if (state & Hammer.STATE_ENDED) {\n// \t\treturn \"end\";\n// \t} else if (state & Hammer.STATE_CHANGED) {\n// \t\treturn \"move\";\n// \t} else if (state & Hammer.STATE_BEGAN) {\n// \t\treturn \"start\";\n// \t}\n// \treturn \"\";\n// }\n\n/**\n * direction cons to string\n * @param {Const} direction\n * @returns {String}\n */\nfunction dirStr(direction) {\n\tif (direction == Hammer.DIRECTION_DOWN) {\n\t\treturn \"down\";\n\t} else if (direction == Hammer.DIRECTION_UP) {\n\t\treturn \"up\";\n\t} else if (direction == Hammer.DIRECTION_LEFT) {\n\t\treturn \"left\";\n\t} else if (direction == Hammer.DIRECTION_RIGHT) {\n\t\treturn \"right\";\n\t}\n\treturn \"\";\n}\n\n///**\n// * Pan\n// * Recognized when the pointer is down and moved in the allowed direction.\n// * @constructor\n// * @extends AttrRecognizer\n// */\n//function PanRecognizer() {\n//\tHammer.AttrRecognizer.apply(this, arguments);\n//\n//\tthis.pX = null;\n//\tthis.pY = null;\n//}\n//\n//inherit(PanRecognizer, Hammer.AttrRecognizer, {\n//\t/**\n//\t/* @namespace\n//\t/* @memberof PanRecognizer\n//\t/*/\n//\tdefaults: {\n//\t\tevent: \"pan\",\n//\t\tthreshold: 10,\n//\t\tpointers: 1,\n//\t\tdirection: DIRECTION_ALL\n//\t},\n//\n//\tgetTouchAction: function() {\n//\t\tvar direction = this.options.direction;\n//\t\tvar actions = [];\n//\t\tif (direction & DIRECTION_HORIZONTAL) {\n//\t\t\tactions.push(TOUCH_ACTION_PAN_Y);\n//\t\t}\n//\t\tif (direction & DIRECTION_VERTICAL) {\n//\t\t\tactions.push(TOUCH_ACTION_PAN_X);\n//\t\t}\n//\t\treturn actions;\n//\t},\n//\n//\tdirectionTest: function(input) {\n//\t\tvar options = this.options;\n//\t\tvar hasMoved = true;\n//\t\tvar distance = input.distance;\n//\t\tvar direction = input.direction;\n//\t\tvar x = input.deltaX;\n//\t\tvar y = input.deltaY;\n//\n//\t\t// lock to axis?\n//\t\tif (!(direction & options.direction)) {\n//\t\t\tif (options.direction & DIRECTION_HORIZONTAL) {\n//\t\t\t\tdirection = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\n//\t\t\t\thasMoved = x != this.pX;\n//\t\t\t\tdistance = Math.abs(input.deltaX);\n//\t\t\t} else {\n//\t\t\t\tdirection = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\n//\t\t\t\thasMoved = y != this.pY;\n//\t\t\t\tdistance = Math.abs(input.deltaY);\n//\t\t\t}\n//\t\t}\n//\t\tinput.direction = direction;\n//\t\treturn hasMoved && distance > options.threshold && direction & options.direction;\n//\t},\n//\n//\tattrTest: function(input) {\n//\t\treturn AttrRecognizer.prototype.attrTest.call(this, input) &&\n//\t\t\t(this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\n//\t},\n//\n//\temit: function(input) {\n//\t\tthis.pX = input.deltaX;\n//\t\tthis.pY = input.deltaY;\n//\n//\t\tvar direction = dirStr(input.direction);\n//\t\tif (direction) {\n//\t\t\tthis.manager.emit(this.options.event + direction, input);\n//\t\t}\n//\n//\t\tthis._super.emit.call(this, input);\n//\t}\n//});\n\n/**\n * SmoothPan\n * @constructor\n * @extends Hammer.Pan\n */\nfunction SmoothPan() {\n\tvar ret = Hammer.Pan.apply(this, arguments);\n\tthis.thresholdOffsetX = null;\n\tthis.thresholdOffsetY = null;\n\tthis.thresholdOffset = null;\n\treturn ret;\n}\n\nHammer.inherit(SmoothPan, Hammer.Pan, {\n\temit: function(input) {\n\t\t// Inheritance breaks, so this code is taken from PanRecognizer.emit\n\t\t//\tthis._super.emit.call(this, input); // Triggers infinite recursion\n\t\t//\tHammer.Pan.prototype.emit.apply(this, arguments); // This breaks too\n\n\t\tvar threshold = this.options.threshold;\n\t\tvar direction = input.direction;\n\n\t\tif (this.state == Hammer.STATE_BEGAN) {\n\t\t\tthis.thresholdOffsetX = (direction & Hammer.DIRECTION_HORIZONTAL) ? ((direction & Hammer.DIRECTION_LEFT) ? threshold : -threshold) : 0;\n\t\t\tthis.thresholdOffsetY = (direction & Hammer.DIRECTION_VERTICAL) ? ((direction & Hammer.DIRECTION_UP) ? threshold : -threshold) : 0;\n\t\t\t// this.thresholdOffset = (direction & Hammer.DIRECTION_HORIZONTAL)? input.thresholdOffsetX : input.thresholdOffsetY;\n\t\t\t// console.log(\"RECOGNIZER STATE\", dirStr(direction), stateStr(this.state), this.thresholdOffsetX);\n\t\t}\n\t\tinput.thresholdOffsetX = this.thresholdOffsetX;\n\t\tinput.thresholdOffsetY = this.thresholdOffsetY;\n\t\tinput.thresholdDeltaX = input.deltaX + this.thresholdOffsetX;\n\t\tinput.thresholdDeltaY = input.deltaY + this.thresholdOffsetY;\n\n\t\tthis.pX = input.deltaX;\n\t\tthis.pY = input.deltaY;\n\n\t\tdirection = dirStr(direction);\n\t\tif (direction) {\n\t\t\tthis.manager.emit(this.options.event + direction, input);\n\t\t}\n\t\treturn Hammer.Recognizer.prototype.emit.apply(this, arguments);\n\t}\n});\n\nmodule.exports = SmoothPan;\n",
    "module.exports={\n\t\"video_crop_px\": \"0\",\n\t\"transform_type\": \"3d\",\n\t\"transitions\": {\n\t\t\"ease\": \"ease-in-out\",\n\t\t\"duration_ms\": \"350\",\n\t\t\"delay_interval_ms\": \"34\",\n\t\t\"min_delay_ms\": \"34\"\n\t},\n\t\"breakpoints\": {\n\t\t\"landscape\": \"'(orientation: landscape)'\",\n\t\t\"portrait\": \"'(orientation: portrait)'\",\n\t\t\"xsmall-stretch\": \"'not screen and (min-width: 460px), not screen and (min-height: 420px)'\",\n\t\t\"small-stretch\": \"'not screen and (min-width: 704px), not screen and (min-height: 540px)'\",\n\t\t\"default\":\"'only screen and (min-width: 704px) and (min-height: 540px)'\",\n\t\t\"medium-wide\": \"'only screen and (min-width: 1024px) and (min-height: 540px)'\",\n\t\t\"large-wide\": \"'only screen and (min-width: 1224px) and (min-height: 704px)'\",\n\t\t\"xlarge-wide\": \"'only screen and (min-width: 1824px) and (min-height: 1024px)'\"\n\t},\n\t\"default_colors\": {\n\t\t\"color\": \"hsl(47, 5%, 15%)\",\n\t\t\"background-color\": \"hsl(47, 5%, 95%)\",\n\t\t\"link-color\": \"hsl(10, 80%, 50%)\"\n\t},\n\t\"temp\": {\n\t\t\"collapse_offset\": \"360\"\n\t},\n\t\"_ignore\": {\n\t\t\"transitions\": {\n\t\t\t\"ease\": \"cubic-bezier(0.42, 0.0, 0.58, 1.0)\",\n\t\t\t\"duration_ms\": \"400\",\n\t\t\t\"delay_interval_ms\": \"134\",\n\t\t\t\"min_delay_ms\": \"34\"\n\t\t},\n\t\t\"default_colors\": {\n\t\t\t\"--link-color\": \"hsl(10, 80%, 50%)\",\n\t\t\t\"--alt-background-color\": \"unset\"\n\t\t},\n\t\t\"units\": {\n\t\t\t\"hu_px\": \"20\",\n\t\t\t\"vu_px\": \"12\"\n\t\t},\n\t\t\"breakpoints\": {\n\t\t\t\"mobile\": \"'not screen and (min-width: 704px), not screen and (min-height: 540px)'\",\n\t\t\t\"unsupported\": \"'not screen and (min-width: 704px)'\",\n\t\t\t\"unquoted\": \"only screen and (min-width: 1824px)\",\n\t\t\t\"unquoted_neg\": \"not screen and (min-width: 704px)\",\n\t\t\t\"quoted_combined\": \"'not screen and (min-width: 704px), not screen and (min-height: 540px)'\",\n\t\t\t\"array\": [\n\t\t\t\t\"only screen and (min-width: 704px)\",\n\t\t\t\t\"not screen and (min-width: 704px)\",\n\t\t\t\t\"not screen and (min-height: 540px)\"\n\t\t\t]\n\t\t}\n\t}\n}\n"
  ]
}