{
  "version": 3,
  "sources": [
    "node_modules/browserify/node_modules/browser-pack/_prelude.js",
    "node_modules/browserify/node_modules/process/browser.js",
    "node_modules/handlebars/lib/handlebars.runtime.js",
    "node_modules/handlebars/lib/handlebars/base.js",
    "node_modules/handlebars/lib/handlebars/decorators.js",
    "node_modules/handlebars/lib/handlebars/decorators/inline.js",
    "node_modules/handlebars/lib/handlebars/exception.js",
    "node_modules/handlebars/lib/handlebars/helpers.js",
    "node_modules/handlebars/lib/handlebars/helpers/block-helper-missing.js",
    "node_modules/handlebars/lib/handlebars/helpers/each.js",
    "node_modules/handlebars/lib/handlebars/helpers/helper-missing.js",
    "node_modules/handlebars/lib/handlebars/helpers/if.js",
    "node_modules/handlebars/lib/handlebars/helpers/log.js",
    "node_modules/handlebars/lib/handlebars/helpers/lookup.js",
    "node_modules/handlebars/lib/handlebars/helpers/with.js",
    "node_modules/handlebars/lib/handlebars/logger.js",
    "node_modules/handlebars/dist/cjs/handlebars/node_modules/handlebars/lib/handlebars/no-conflict.js",
    "node_modules/handlebars/lib/handlebars/runtime.js",
    "node_modules/handlebars/lib/handlebars/safe-string.js",
    "node_modules/handlebars/lib/handlebars/utils.js",
    "node_modules/handlebars/runtime.js",
    "node_modules/hbsfy/runtime.js",
    "node_modules/setimmediate/setImmediate.js",
    "node_modules/underscore.string/camelize.js",
    "node_modules/underscore.string/capitalize.js",
    "node_modules/underscore.string/classify.js",
    "node_modules/underscore.string/dasherize.js",
    "node_modules/underscore.string/decapitalize.js",
    "node_modules/underscore.string/helper/defaultToWhiteSpace.js",
    "node_modules/underscore.string/helper/escapeRegExp.js",
    "node_modules/underscore.string/helper/makeString.js",
    "node_modules/underscore.string/helper/strRepeat.js",
    "node_modules/underscore.string/lpad.js",
    "node_modules/underscore.string/pad.js",
    "node_modules/underscore.string/rpad.js",
    "node_modules/underscore.string/trim.js",
    "src/js/app/App.js",
    "src/js/app/control/Controller.js",
    "src/js/app/control/Globals.js",
    "src/js/app/model/AppState.js",
    "src/js/app/model/BaseItem.js",
    "src/js/app/model/SelectableCollection.js",
    "src/js/app/model/collection/ArticleCollection.js",
    "src/js/app/model/collection/BundleCollection.js",
    "src/js/app/model/collection/KeywordCollection.js",
    "src/js/app/model/collection/TypeCollection.js",
    "src/js/app/model/helper/bootstrap.js",
    "src/js/app/model/item/ArticleItem.js",
    "src/js/app/model/item/BundleItem.js",
    "src/js/app/model/item/KeywordItem.js",
    "src/js/app/model/item/MediaItem.js",
    "src/js/app/model/item/SourceItem.js",
    "src/js/app/model/item/TypeItem.js",
    "src/js/app/view/AppView.js",
    "src/js/app/view/ContentView.js",
    "src/js/app/view/DebugToolbar.js",
    "src/js/app/view/NavigationView.js",
    "src/js/app/view/base/CanvasView.js",
    "src/js/app/view/base/FrameQueue.js",
    "src/js/app/view/base/Interpolator.js",
    "src/js/app/view/base/PrefixedEvents.js",
    "src/js/app/view/base/TouchManager.js",
    "src/js/app/view/base/View.js",
    "src/js/app/view/base/ViewError.js",
    "src/js/app/view/component/ArticleButton.hbs",
    "src/js/app/view/component/ArticleButton.js",
    "src/js/app/view/component/ArticleView.js",
    "src/js/app/view/component/Carousel.js",
    "src/js/app/view/component/CollectionStack.hbs",
    "src/js/app/view/component/CollectionStack.js",
    "src/js/app/view/component/FilterableListView.js",
    "src/js/app/view/component/GraphView.js",
    "src/js/app/view/component/GroupingListView.js",
    "src/js/app/view/component/ProgressMeter.js",
    "src/js/app/view/component/SelectableListView.js",
    "src/js/app/view/component/progress/CanvasProgressMeter3.js",
    "src/js/app/view/helper/createColorStyleSheet.js",
    "src/js/app/view/promise/_loadImageAsObjectURL.js",
    "src/js/app/view/promise/_whenImageLoads.js",
    "src/js/app/view/promise/whenDefaultImageLoads.js",
    "src/js/app/view/promise/whenScrollingEnds.js",
    "src/js/app/view/promise/whenSelectionDistanceIs.js",
    "src/js/app/view/promise/whenSelectionIsContiguous.js",
    "src/js/app/view/promise/whenViewIsAttached.js",
    "src/js/app/view/render/CarouselRenderer.js",
    "src/js/app/view/render/ClickableRenderer.js",
    "src/js/app/view/render/DefaultSelectableRenderer.hbs",
    "src/js/app/view/render/DefaultSelectableRenderer.js",
    "src/js/app/view/render/DotNavigationRenderer.hbs",
    "src/js/app/view/render/DotNavigationRenderer.js",
    "src/js/app/view/render/ImageRenderer.hbs",
    "src/js/app/view/render/ImageRenderer.js",
    "src/js/app/view/render/LabelRenderer.js",
    "src/js/app/view/render/MediaRenderer.js",
    "src/js/app/view/render/PlayableRenderer.js",
    "src/js/app/view/render/SequenceRenderer.hbs",
    "src/js/app/view/render/SequenceRenderer.js",
    "src/js/app/view/render/VideoRenderer.hbs",
    "src/js/app/view/render/VideoRenderer.js",
    "src/js/app/view/template/Carousel.EmptyRenderer.Bundle.hbs",
    "src/js/app/view/template/CollectionStack.Media.hbs",
    "src/js/app/view/template/DebugToolbar.hbs",
    "src/js/app/view/template/ErrorBlock.hbs",
    "src/js/app/view/template/_helpers.js",
    "src/js/utils/Timer.js",
    "src/js/utils/TransformHelper.js",
    "src/js/utils/TransformItem.js",
    "src/js/utils/canvas/CanvasHelper.js",
    "src/js/utils/canvas/calcArcHConnector.js",
    "src/js/utils/css/getBoxEdgeStyles.js",
    "src/js/utils/ease/linear.js",
    "src/js/utils/event/mediaEventsEnum.js",
    "src/js/utils/geom/inflateRect.js",
    "src/js/utils/prefixedEvent.js",
    "src/js/utils/prefixedProperty.js",
    "src/js/utils/prefixedStyleName.js",
    "src/js/utils/prefixes.js",
    "src/js/utils/setImmediate.js",
    "src/js/utils/strings/camelToDashed.js",
    "src/js/utils/strings/stripTags.js",
    "src/js/utils/touch/SmoothPanRecognizer.js",
    "src/sass/variables.json"
  ],
  "names": [],
  "mappings": "AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;8BC3FsB,mBAAmB;;IAA7B,IAAI;;;;;oCAIO,0BAA0B;;;;mCAC3B,wBAAwB;;;;+BACvB,oBAAoB;;IAA/B,KAAK;;iCACQ,sBAAsB;;IAAnC,OAAO;;oCAEI,0BAA0B;;;;;AAGjD,SAAS,MAAM,GAAG;AAChB,MAAI,EAAE,GAAG,IAAI,IAAI,CAAC,qBAAqB,EAAE,CAAC;;AAE1C,OAAK,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC;AACvB,IAAE,CAAC,UAAU,oCAAa,CAAC;AAC3B,IAAE,CAAC,SAAS,mCAAY,CAAC;AACzB,IAAE,CAAC,KAAK,GAAG,KAAK,CAAC;AACjB,IAAE,CAAC,gBAAgB,GAAG,KAAK,CAAC,gBAAgB,CAAC;;AAE7C,IAAE,CAAC,EAAE,GAAG,OAAO,CAAC;AAChB,IAAE,CAAC,QAAQ,GAAG,UAAS,IAAI,EAAE;AAC3B,WAAO,OAAO,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;GACnC,CAAC;;AAEF,SAAO,EAAE,CAAC;CACX;;AAED,IAAI,IAAI,GAAG,MAAM,EAAE,CAAC;AACpB,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;;AAErB,kCAAW,IAAI,CAAC,CAAC;;AAEjB,IAAI,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC;;qBAER,IAAI;;;;;;;;;;;;;qBCpCyB,SAAS;;yBAC/B,aAAa;;;;uBACE,WAAW;;0BACR,cAAc;;sBACnC,UAAU;;;;AAEtB,IAAM,OAAO,GAAG,OAAO,CAAC;;AACxB,IAAM,iBAAiB,GAAG,CAAC,CAAC;;;AAE5B,IAAM,gBAAgB,GAAG;AAC9B,GAAC,EAAE,aAAa;AAChB,GAAC,EAAE,eAAe;AAClB,GAAC,EAAE,eAAe;AAClB,GAAC,EAAE,UAAU;AACb,GAAC,EAAE,kBAAkB;AACrB,GAAC,EAAE,iBAAiB;AACpB,GAAC,EAAE,UAAU;CACd,CAAC;;;AAEF,IAAM,UAAU,GAAG,iBAAiB,CAAC;;AAE9B,SAAS,qBAAqB,CAAC,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE;AACnE,MAAI,CAAC,OAAO,GAAG,OAAO,IAAI,EAAE,CAAC;AAC7B,MAAI,CAAC,QAAQ,GAAG,QAAQ,IAAI,EAAE,CAAC;AAC/B,MAAI,CAAC,UAAU,GAAG,UAAU,IAAI,EAAE,CAAC;;AAEnC,kCAAuB,IAAI,CAAC,CAAC;AAC7B,wCAA0B,IAAI,CAAC,CAAC;CACjC;;AAED,qBAAqB,CAAC,SAAS,GAAG;AAChC,aAAW,EAAE,qBAAqB;;AAElC,QAAM,qBAAQ;AACd,KAAG,EAAE,oBAAO,GAAG;;AAEf,gBAAc,EAAE,wBAAS,IAAI,EAAE,EAAE,EAAE;AACjC,QAAI,gBAAS,IAAI,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;AACtC,UAAI,EAAE,EAAE;AAAE,cAAM,2BAAc,yCAAyC,CAAC,CAAC;OAAE;AAC3E,oBAAO,IAAI,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;KAC5B,MAAM;AACL,UAAI,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;KACzB;GACF;AACD,kBAAgB,EAAE,0BAAS,IAAI,EAAE;AAC/B,WAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;GAC3B;;AAED,iBAAe,EAAE,yBAAS,IAAI,EAAE,OAAO,EAAE;AACvC,QAAI,gBAAS,IAAI,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;AACtC,oBAAO,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;KAC7B,MAAM;AACL,UAAI,OAAO,OAAO,KAAK,WAAW,EAAE;AAClC,cAAM,yEAA0D,IAAI,oBAAiB,CAAC;OACvF;AACD,UAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,OAAO,CAAC;KAC/B;GACF;AACD,mBAAiB,EAAE,2BAAS,IAAI,EAAE;AAChC,WAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;GAC5B;;AAED,mBAAiB,EAAE,2BAAS,IAAI,EAAE,EAAE,EAAE;AACpC,QAAI,gBAAS,IAAI,CAAC,IAAI,CAAC,KAAK,UAAU,EAAE;AACtC,UAAI,EAAE,EAAE;AAAE,cAAM,2BAAc,4CAA4C,CAAC,CAAC;OAAE;AAC9E,oBAAO,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;KAC/B,MAAM;AACL,UAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;KAC5B;GACF;AACD,qBAAmB,EAAE,6BAAS,IAAI,EAAE;AAClC,WAAO,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;GAC9B;CACF,CAAC;;AAEK,IAAI,GAAG,GAAG,oBAAO,GAAG,CAAC;;;QAEpB,WAAW;QAAE,MAAM;;;;;;;;;;;;gCC7EA,qBAAqB;;;;AAEzC,SAAS,yBAAyB,CAAC,QAAQ,EAAE;AAClD,gCAAe,QAAQ,CAAC,CAAC;CAC1B;;;;;;;;qBCJoB,UAAU;;qBAEhB,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,iBAAiB,CAAC,QAAQ,EAAE,UAAS,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,OAAO,EAAE;AAC3E,QAAI,GAAG,GAAG,EAAE,CAAC;AACb,QAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;AACnB,WAAK,CAAC,QAAQ,GAAG,EAAE,CAAC;AACpB,SAAG,GAAG,UAAS,OAAO,EAAE,OAAO,EAAE;;AAE/B,YAAI,QAAQ,GAAG,SAAS,CAAC,QAAQ,CAAC;AAClC,iBAAS,CAAC,QAAQ,GAAG,cAAO,EAAE,EAAE,QAAQ,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC;AAC1D,YAAI,GAAG,GAAG,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;AAC/B,iBAAS,CAAC,QAAQ,GAAG,QAAQ,CAAC;AAC9B,eAAO,GAAG,CAAC;OACZ,CAAC;KACH;;AAED,SAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,EAAE,CAAC;;AAE7C,WAAO,GAAG,CAAC;GACZ,CAAC,CAAC;CACJ;;;;;;;;;;ACpBD,IAAM,UAAU,GAAG,CAAC,aAAa,EAAE,UAAU,EAAE,YAAY,EAAE,SAAS,EAAE,MAAM,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;;AAEnG,SAAS,SAAS,CAAC,OAAO,EAAE,IAAI,EAAE;AAChC,MAAI,GAAG,GAAG,IAAI,IAAI,IAAI,CAAC,GAAG;MACtB,IAAI,YAAA;MACJ,MAAM,YAAA,CAAC;AACX,MAAI,GAAG,EAAE;AACP,QAAI,GAAG,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC;AACtB,UAAM,GAAG,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC;;AAE1B,WAAO,IAAI,KAAK,GAAG,IAAI,GAAG,GAAG,GAAG,MAAM,CAAC;GACxC;;AAED,MAAI,GAAG,GAAG,KAAK,CAAC,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;;;AAG1D,OAAK,IAAI,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,UAAU,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE;AAChD,QAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC;GAC9C;;;AAGD,MAAI,KAAK,CAAC,iBAAiB,EAAE;AAC3B,SAAK,CAAC,iBAAiB,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;GAC1C;;AAED,MAAI,GAAG,EAAE;AACP,QAAI,CAAC,UAAU,GAAG,IAAI,CAAC;AACvB,QAAI,CAAC,MAAM,GAAG,MAAM,CAAC;GACtB;CACF;;AAED,SAAS,CAAC,SAAS,GAAG,IAAI,KAAK,EAAE,CAAC;;qBAEnB,SAAS;;;;;;;;;;;;;yCClCe,gCAAgC;;;;2BAC9C,gBAAgB;;;;oCACP,0BAA0B;;;;yBACrC,cAAc;;;;0BACb,eAAe;;;;6BACZ,kBAAkB;;;;2BACpB,gBAAgB;;;;AAElC,SAAS,sBAAsB,CAAC,QAAQ,EAAE;AAC/C,yCAA2B,QAAQ,CAAC,CAAC;AACrC,2BAAa,QAAQ,CAAC,CAAC;AACvB,oCAAsB,QAAQ,CAAC,CAAC;AAChC,yBAAW,QAAQ,CAAC,CAAC;AACrB,0BAAY,QAAQ,CAAC,CAAC;AACtB,6BAAe,QAAQ,CAAC,CAAC;AACzB,2BAAa,QAAQ,CAAC,CAAC;CACxB;;;;;;;;qBChBqD,UAAU;;qBAEjD,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,oBAAoB,EAAE,UAAS,OAAO,EAAE,OAAO,EAAE;AACvE,QAAI,OAAO,GAAG,OAAO,CAAC,OAAO;QACzB,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;;AAEpB,QAAI,OAAO,KAAK,IAAI,EAAE;AACpB,aAAO,EAAE,CAAC,IAAI,CAAC,CAAC;KACjB,MAAM,IAAI,OAAO,KAAK,KAAK,IAAI,OAAO,IAAI,IAAI,EAAE;AAC/C,aAAO,OAAO,CAAC,IAAI,CAAC,CAAC;KACtB,MAAM,IAAI,eAAQ,OAAO,CAAC,EAAE;AAC3B,UAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;AACtB,YAAI,OAAO,CAAC,GAAG,EAAE;AACf,iBAAO,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;SAC9B;;AAED,eAAO,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;OAChD,MAAM;AACL,eAAO,OAAO,CAAC,IAAI,CAAC,CAAC;OACtB;KACF,MAAM;AACL,UAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,GAAG,EAAE;AAC/B,YAAI,IAAI,GAAG,mBAAY,OAAO,CAAC,IAAI,CAAC,CAAC;AACrC,YAAI,CAAC,WAAW,GAAG,yBAAkB,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC;AAC7E,eAAO,GAAG,EAAC,IAAI,EAAE,IAAI,EAAC,CAAC;OACxB;;AAED,aAAO,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;KAC7B;GACF,CAAC,CAAC;CACJ;;;;;;;;;;;;;qBC/B8E,UAAU;;yBACnE,cAAc;;;;qBAErB,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,MAAM,EAAE,UAAS,OAAO,EAAE,OAAO,EAAE;AACzD,QAAI,CAAC,OAAO,EAAE;AACZ,YAAM,2BAAc,6BAA6B,CAAC,CAAC;KACpD;;AAED,QAAI,EAAE,GAAG,OAAO,CAAC,EAAE;QACf,OAAO,GAAG,OAAO,CAAC,OAAO;QACzB,CAAC,GAAG,CAAC;QACL,GAAG,GAAG,EAAE;QACR,IAAI,YAAA;QACJ,WAAW,YAAA,CAAC;;AAEhB,QAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,GAAG,EAAE;AAC/B,iBAAW,GAAG,yBAAkB,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;KACjF;;AAED,QAAI,kBAAW,OAAO,CAAC,EAAE;AAAE,aAAO,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAAE;;AAE1D,QAAI,OAAO,CAAC,IAAI,EAAE;AAChB,UAAI,GAAG,mBAAY,OAAO,CAAC,IAAI,CAAC,CAAC;KAClC;;AAED,aAAS,aAAa,CAAC,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE;AACzC,UAAI,IAAI,EAAE;AACR,YAAI,CAAC,GAAG,GAAG,KAAK,CAAC;AACjB,YAAI,CAAC,KAAK,GAAG,KAAK,CAAC;AACnB,YAAI,CAAC,KAAK,GAAG,KAAK,KAAK,CAAC,CAAC;AACzB,YAAI,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC;;AAEnB,YAAI,WAAW,EAAE;AACf,cAAI,CAAC,WAAW,GAAG,WAAW,GAAG,KAAK,CAAC;SACxC;OACF;;AAED,SAAG,GAAG,GAAG,GAAG,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;AAC7B,YAAI,EAAE,IAAI;AACV,mBAAW,EAAE,mBAAY,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE,KAAK,CAAC,EAAE,CAAC,WAAW,GAAG,KAAK,EAAE,IAAI,CAAC,CAAC;OAC/E,CAAC,CAAC;KACJ;;AAED,QAAI,OAAO,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;AAC1C,UAAI,eAAQ,OAAO,CAAC,EAAE;AACpB,aAAK,IAAI,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AACvC,cAAI,CAAC,IAAI,OAAO,EAAE;AAChB,yBAAa,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,KAAK,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;WAC/C;SACF;OACF,MAAM;AACL,YAAI,QAAQ,YAAA,CAAC;;AAEb,aAAK,IAAI,GAAG,IAAI,OAAO,EAAE;AACvB,cAAI,OAAO,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;;;;AAI/B,gBAAI,QAAQ,KAAK,SAAS,EAAE;AAC1B,2BAAa,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;aAChC;AACD,oBAAQ,GAAG,GAAG,CAAC;AACf,aAAC,EAAE,CAAC;WACL;SACF;AACD,YAAI,QAAQ,KAAK,SAAS,EAAE;AAC1B,uBAAa,CAAC,QAAQ,EAAE,CAAC,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC;SACtC;OACF;KACF;;AAED,QAAI,CAAC,KAAK,CAAC,EAAE;AACX,SAAG,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;KACrB;;AAED,WAAO,GAAG,CAAC;GACZ,CAAC,CAAC;CACJ;;;;;;;;;;;;;yBC9EqB,cAAc;;;;qBAErB,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,eAAe,EAAE,iCAAgC;AACvE,QAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;;AAE1B,aAAO,SAAS,CAAC;KAClB,MAAM;;AAEL,YAAM,2BAAc,mBAAmB,GAAG,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,IAAI,GAAG,GAAG,CAAC,CAAC;KACvF;GACF,CAAC,CAAC;CACJ;;;;;;;;;;qBCZiC,UAAU;;qBAE7B,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,IAAI,EAAE,UAAS,WAAW,EAAE,OAAO,EAAE;AAC3D,QAAI,kBAAW,WAAW,CAAC,EAAE;AAAE,iBAAW,GAAG,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAAE;;;;;AAKtE,QAAI,AAAC,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,WAAW,IAAK,eAAQ,WAAW,CAAC,EAAE;AACvE,aAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KAC9B,MAAM;AACL,aAAO,OAAO,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;KACzB;GACF,CAAC,CAAC;;AAEH,UAAQ,CAAC,cAAc,CAAC,QAAQ,EAAE,UAAS,WAAW,EAAE,OAAO,EAAE;AAC/D,WAAO,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,WAAW,EAAE,EAAC,EAAE,EAAE,OAAO,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,EAAE,EAAE,IAAI,EAAE,OAAO,CAAC,IAAI,EAAC,CAAC,CAAC;GACvH,CAAC,CAAC;CACJ;;;;;;;;;;qBCnBc,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,KAAK,EAAE,kCAAiC;AAC9D,QAAI,IAAI,GAAG,CAAC,SAAS,CAAC;QAClB,OAAO,GAAG,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;AAC9C,SAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AAC7C,UAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;KACzB;;AAED,QAAI,KAAK,GAAG,CAAC,CAAC;AACd,QAAI,OAAO,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,EAAE;AAC9B,WAAK,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC;KAC5B,MAAM,IAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,EAAE;AACrD,WAAK,GAAG,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC;KAC5B;AACD,QAAI,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC;;AAEhB,YAAQ,CAAC,GAAG,MAAA,CAAZ,QAAQ,EAAS,IAAI,CAAC,CAAC;GACxB,CAAC,CAAC;CACJ;;;;;;;;;;qBClBc,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,QAAQ,EAAE,UAAS,GAAG,EAAE,KAAK,EAAE;AACrD,WAAO,GAAG,IAAI,GAAG,CAAC,KAAK,CAAC,CAAC;GAC1B,CAAC,CAAC;CACJ;;;;;;;;;;qBCJ8E,UAAU;;qBAE1E,UAAS,QAAQ,EAAE;AAChC,UAAQ,CAAC,cAAc,CAAC,MAAM,EAAE,UAAS,OAAO,EAAE,OAAO,EAAE;AACzD,QAAI,kBAAW,OAAO,CAAC,EAAE;AAAE,aAAO,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAAE;;AAE1D,QAAI,EAAE,GAAG,OAAO,CAAC,EAAE,CAAC;;AAEpB,QAAI,CAAC,eAAQ,OAAO,CAAC,EAAE;AACrB,UAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;AACxB,UAAI,OAAO,CAAC,IAAI,IAAI,OAAO,CAAC,GAAG,EAAE;AAC/B,YAAI,GAAG,mBAAY,OAAO,CAAC,IAAI,CAAC,CAAC;AACjC,YAAI,CAAC,WAAW,GAAG,yBAAkB,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;OAChF;;AAED,aAAO,EAAE,CAAC,OAAO,EAAE;AACjB,YAAI,EAAE,IAAI;AACV,mBAAW,EAAE,mBAAY,CAAC,OAAO,CAAC,EAAE,CAAC,IAAI,IAAI,IAAI,CAAC,WAAW,CAAC,CAAC;OAChE,CAAC,CAAC;KACJ,MAAM;AACL,aAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KAC9B;GACF,CAAC,CAAC;CACJ;;;;;;;;;;qBCvBqB,SAAS;;AAE/B,IAAI,MAAM,GAAG;AACX,WAAS,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,EAAE,OAAO,CAAC;AAC7C,OAAK,EAAE,MAAM;;;AAGb,aAAW,EAAE,qBAAS,KAAK,EAAE;AAC3B,QAAI,OAAO,KAAK,KAAK,QAAQ,EAAE;AAC7B,UAAI,QAAQ,GAAG,eAAQ,MAAM,CAAC,SAAS,EAAE,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC;AAC9D,UAAI,QAAQ,IAAI,CAAC,EAAE;AACjB,aAAK,GAAG,QAAQ,CAAC;OAClB,MAAM;AACL,aAAK,GAAG,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;OAC7B;KACF;;AAED,WAAO,KAAK,CAAC;GACd;;;AAGD,KAAG,EAAE,aAAS,KAAK,EAAc;AAC/B,SAAK,GAAG,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;;AAElC,QAAI,OAAO,OAAO,KAAK,WAAW,IAAI,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,KAAK,EAAE;AAC/E,UAAI,MAAM,GAAG,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;AACrC,UAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;;AACpB,cAAM,GAAG,KAAK,CAAC;OAChB;;wCAPmB,OAAO;AAAP,eAAO;;;AAQ3B,aAAO,CAAC,MAAM,OAAC,CAAf,OAAO,EAAY,OAAO,CAAC,CAAC;KAC7B;GACF;CACF,CAAC;;qBAEa,MAAM;;;;;;;;;;;qBCjCN,UAAS,UAAU,EAAE;;AAElC,MAAI,IAAI,GAAG,OAAO,MAAM,KAAK,WAAW,GAAG,MAAM,GAAG,MAAM;MACtD,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC;;AAElC,YAAU,CAAC,UAAU,GAAG,YAAW;AACjC,QAAI,IAAI,CAAC,UAAU,KAAK,UAAU,EAAE;AAClC,UAAI,CAAC,UAAU,GAAG,WAAW,CAAC;KAC/B;AACD,WAAO,UAAU,CAAC;GACnB,CAAC;CACH;;;;;;;;;;;;;;;;;;;;;;;;;qBCZsB,SAAS;;IAApB,KAAK;;yBACK,aAAa;;;;oBAC8B,QAAQ;;AAElE,SAAS,aAAa,CAAC,YAAY,EAAE;AAC1C,MAAM,gBAAgB,GAAG,YAAY,IAAI,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC;MACvD,eAAe,0BAAoB,CAAC;;AAE1C,MAAI,gBAAgB,KAAK,eAAe,EAAE;AACxC,QAAI,gBAAgB,GAAG,eAAe,EAAE;AACtC,UAAM,eAAe,GAAG,uBAAiB,eAAe,CAAC;UACnD,gBAAgB,GAAG,uBAAiB,gBAAgB,CAAC,CAAC;AAC5D,YAAM,2BAAc,yFAAyF,GACvG,qDAAqD,GAAG,eAAe,GAAG,mDAAmD,GAAG,gBAAgB,GAAG,IAAI,CAAC,CAAC;KAChK,MAAM;;AAEL,YAAM,2BAAc,wFAAwF,GACtG,iDAAiD,GAAG,YAAY,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC;KACnF;GACF;CACF;;AAEM,SAAS,QAAQ,CAAC,YAAY,EAAE,GAAG,EAAE;;AAE1C,MAAI,CAAC,GAAG,EAAE;AACR,UAAM,2BAAc,mCAAmC,CAAC,CAAC;GAC1D;AACD,MAAI,CAAC,YAAY,IAAI,CAAC,YAAY,CAAC,IAAI,EAAE;AACvC,UAAM,2BAAc,2BAA2B,GAAG,OAAO,YAAY,CAAC,CAAC;GACxE;;AAED,cAAY,CAAC,IAAI,CAAC,SAAS,GAAG,YAAY,CAAC,MAAM,CAAC;;;;AAIlD,KAAG,CAAC,EAAE,CAAC,aAAa,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;;AAE5C,WAAS,oBAAoB,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;AACvD,QAAI,OAAO,CAAC,IAAI,EAAE;AAChB,aAAO,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC;AAClD,UAAI,OAAO,CAAC,GAAG,EAAE;AACf,eAAO,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;OACvB;KACF;;AAED,WAAO,GAAG,GAAG,CAAC,EAAE,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;AACtE,QAAI,MAAM,GAAG,GAAG,CAAC,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;;AAExE,QAAI,MAAM,IAAI,IAAI,IAAI,GAAG,CAAC,OAAO,EAAE;AACjC,aAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,OAAO,EAAE,YAAY,CAAC,eAAe,EAAE,GAAG,CAAC,CAAC;AACzF,YAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;KAC3D;AACD,QAAI,MAAM,IAAI,IAAI,EAAE;AAClB,UAAI,OAAO,CAAC,MAAM,EAAE;AAClB,YAAI,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;AAC/B,aAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;AAC5C,cAAI,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;AAC5B,kBAAM;WACP;;AAED,eAAK,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;SACtC;AACD,cAAM,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;OAC3B;AACD,aAAO,MAAM,CAAC;KACf,MAAM;AACL,YAAM,2BAAc,cAAc,GAAG,OAAO,CAAC,IAAI,GAAG,0DAA0D,CAAC,CAAC;KACjH;GACF;;;AAGD,MAAI,SAAS,GAAG;AACd,UAAM,EAAE,gBAAS,GAAG,EAAE,IAAI,EAAE;AAC1B,UAAI,EAAE,IAAI,IAAI,GAAG,CAAA,AAAC,EAAE;AAClB,cAAM,2BAAc,GAAG,GAAG,IAAI,GAAG,mBAAmB,GAAG,GAAG,CAAC,CAAC;OAC7D;AACD,aAAO,GAAG,CAAC,IAAI,CAAC,CAAC;KAClB;AACD,UAAM,EAAE,gBAAS,MAAM,EAAE,IAAI,EAAE;AAC7B,UAAM,GAAG,GAAG,MAAM,CAAC,MAAM,CAAC;AAC1B,WAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;AAC5B,YAAI,MAAM,CAAC,CAAC,CAAC,IAAI,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,EAAE;AACxC,iBAAO,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;SACxB;OACF;KACF;AACD,UAAM,EAAE,gBAAS,OAAO,EAAE,OAAO,EAAE;AACjC,aAAO,OAAO,OAAO,KAAK,UAAU,GAAG,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,OAAO,CAAC;KACxE;;AAED,oBAAgB,EAAE,KAAK,CAAC,gBAAgB;AACxC,iBAAa,EAAE,oBAAoB;;AAEnC,MAAE,EAAE,YAAS,CAAC,EAAE;AACd,UAAI,GAAG,GAAG,YAAY,CAAC,CAAC,CAAC,CAAC;AAC1B,SAAG,CAAC,SAAS,GAAG,YAAY,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC;AACvC,aAAO,GAAG,CAAC;KACZ;;AAED,YAAQ,EAAE,EAAE;AACZ,WAAO,EAAE,iBAAS,CAAC,EAAE,IAAI,EAAE,mBAAmB,EAAE,WAAW,EAAE,MAAM,EAAE;AACnE,UAAI,cAAc,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;UACjC,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;AACpB,UAAI,IAAI,IAAI,MAAM,IAAI,WAAW,IAAI,mBAAmB,EAAE;AACxD,sBAAc,GAAG,WAAW,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,mBAAmB,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;OAC3F,MAAM,IAAI,CAAC,cAAc,EAAE;AAC1B,sBAAc,GAAG,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAG,WAAW,CAAC,IAAI,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC;OAC9D;AACD,aAAO,cAAc,CAAC;KACvB;;AAED,QAAI,EAAE,cAAS,KAAK,EAAE,KAAK,EAAE;AAC3B,aAAO,KAAK,IAAI,KAAK,EAAE,EAAE;AACvB,aAAK,GAAG,KAAK,CAAC,OAAO,CAAC;OACvB;AACD,aAAO,KAAK,CAAC;KACd;AACD,SAAK,EAAE,eAAS,KAAK,EAAE,MAAM,EAAE;AAC7B,UAAI,GAAG,GAAG,KAAK,IAAI,MAAM,CAAC;;AAE1B,UAAI,KAAK,IAAI,MAAM,IAAK,KAAK,KAAK,MAAM,AAAC,EAAE;AACzC,WAAG,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;OACvC;;AAED,aAAO,GAAG,CAAC;KACZ;;AAED,QAAI,EAAE,GAAG,CAAC,EAAE,CAAC,IAAI;AACjB,gBAAY,EAAE,YAAY,CAAC,QAAQ;GACpC,CAAC;;AAEF,WAAS,GAAG,CAAC,OAAO,EAAgB;QAAd,OAAO,yDAAG,EAAE;;AAChC,QAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;;AAExB,OAAG,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;AACpB,QAAI,CAAC,OAAO,CAAC,OAAO,IAAI,YAAY,CAAC,OAAO,EAAE;AAC5C,UAAI,GAAG,QAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;KAChC;AACD,QAAI,MAAM,YAAA;QACN,WAAW,GAAG,YAAY,CAAC,cAAc,GAAG,EAAE,GAAG,SAAS,CAAC;AAC/D,QAAI,YAAY,CAAC,SAAS,EAAE;AAC1B,UAAI,OAAO,CAAC,MAAM,EAAE;AAClB,cAAM,GAAG,OAAO,KAAK,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC,MAAM,CAAC;OAC5F,MAAM;AACL,cAAM,GAAG,CAAC,OAAO,CAAC,CAAC;OACpB;KACF;;AAED,aAAS,IAAI,CAAC,OAAO,gBAAe;AAClC,aAAO,EAAE,GAAG,YAAY,CAAC,IAAI,CAAC,SAAS,EAAE,OAAO,EAAE,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,QAAQ,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;KACrH;AACD,QAAI,GAAG,iBAAiB,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,CAAC,MAAM,IAAI,EAAE,EAAE,IAAI,EAAE,WAAW,CAAC,CAAC;AACtG,WAAO,IAAI,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;GAC/B;AACD,KAAG,CAAC,KAAK,GAAG,IAAI,CAAC;;AAEjB,KAAG,CAAC,MAAM,GAAG,UAAS,OAAO,EAAE;AAC7B,QAAI,CAAC,OAAO,CAAC,OAAO,EAAE;AACpB,eAAS,CAAC,OAAO,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;;AAElE,UAAI,YAAY,CAAC,UAAU,EAAE;AAC3B,iBAAS,CAAC,QAAQ,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC;OACtE;AACD,UAAI,YAAY,CAAC,UAAU,IAAI,YAAY,CAAC,aAAa,EAAE;AACzD,iBAAS,CAAC,UAAU,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,UAAU,EAAE,GAAG,CAAC,UAAU,CAAC,CAAC;OAC5E;KACF,MAAM;AACL,eAAS,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;AACpC,eAAS,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;AACtC,eAAS,CAAC,UAAU,GAAG,OAAO,CAAC,UAAU,CAAC;KAC3C;GACF,CAAC;;AAEF,KAAG,CAAC,MAAM,GAAG,UAAS,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM,EAAE;AAClD,QAAI,YAAY,CAAC,cAAc,IAAI,CAAC,WAAW,EAAE;AAC/C,YAAM,2BAAc,wBAAwB,CAAC,CAAC;KAC/C;AACD,QAAI,YAAY,CAAC,SAAS,IAAI,CAAC,MAAM,EAAE;AACrC,YAAM,2BAAc,yBAAyB,CAAC,CAAC;KAChD;;AAED,WAAO,WAAW,CAAC,SAAS,EAAE,CAAC,EAAE,YAAY,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;GACjF,CAAC;AACF,SAAO,GAAG,CAAC;CACZ;;AAEM,SAAS,WAAW,CAAC,SAAS,EAAE,CAAC,EAAE,EAAE,EAAE,IAAI,EAAE,mBAAmB,EAAE,WAAW,EAAE,MAAM,EAAE;AAC5F,WAAS,IAAI,CAAC,OAAO,EAAgB;QAAd,OAAO,yDAAG,EAAE;;AACjC,QAAI,aAAa,GAAG,MAAM,CAAC;AAC3B,QAAI,MAAM,IAAI,OAAO,KAAK,MAAM,CAAC,CAAC,CAAC,EAAE;AACnC,mBAAa,GAAG,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;KAC1C;;AAED,WAAO,EAAE,CAAC,SAAS,EACf,OAAO,EACP,SAAS,CAAC,OAAO,EAAE,SAAS,CAAC,QAAQ,EACrC,OAAO,CAAC,IAAI,IAAI,IAAI,EACpB,WAAW,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC,EACxD,aAAa,CAAC,CAAC;GACpB;;AAED,MAAI,GAAG,iBAAiB,CAAC,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,MAAM,EAAE,IAAI,EAAE,WAAW,CAAC,CAAC;;AAEzE,MAAI,CAAC,OAAO,GAAG,CAAC,CAAC;AACjB,MAAI,CAAC,KAAK,GAAG,MAAM,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;AACxC,MAAI,CAAC,WAAW,GAAG,mBAAmB,IAAI,CAAC,CAAC;AAC5C,SAAO,IAAI,CAAC;CACb;;AAEM,SAAS,cAAc,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;AACxD,MAAI,CAAC,OAAO,EAAE;AACZ,QAAI,OAAO,CAAC,IAAI,KAAK,gBAAgB,EAAE;AACrC,aAAO,GAAG,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;KACzC,MAAM;AACL,aAAO,GAAG,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KAC1C;GACF,MAAM,IAAI,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE;;AAEzC,WAAO,CAAC,IAAI,GAAG,OAAO,CAAC;AACvB,WAAO,GAAG,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;GACrC;AACD,SAAO,OAAO,CAAC;CAChB;;AAEM,SAAS,aAAa,CAAC,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE;AACvD,SAAO,CAAC,OAAO,GAAG,IAAI,CAAC;AACvB,MAAI,OAAO,CAAC,GAAG,EAAE;AACf,WAAO,CAAC,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC;GACvE;;AAED,MAAI,YAAY,YAAA,CAAC;AACjB,MAAI,OAAO,CAAC,EAAE,IAAI,OAAO,CAAC,EAAE,KAAK,IAAI,EAAE;AACrC,WAAO,CAAC,IAAI,GAAG,kBAAY,OAAO,CAAC,IAAI,CAAC,CAAC;AACzC,gBAAY,GAAG,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,OAAO,CAAC,EAAE,CAAC;;AAE1D,QAAI,YAAY,CAAC,QAAQ,EAAE;AACzB,aAAO,CAAC,QAAQ,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,EAAE,OAAO,CAAC,QAAQ,EAAE,YAAY,CAAC,QAAQ,CAAC,CAAC;KAC9E;GACF;;AAED,MAAI,OAAO,KAAK,SAAS,IAAI,YAAY,EAAE;AACzC,WAAO,GAAG,YAAY,CAAC;GACxB;;AAED,MAAI,OAAO,KAAK,SAAS,EAAE;AACzB,UAAM,2BAAc,cAAc,GAAG,OAAO,CAAC,IAAI,GAAG,qBAAqB,CAAC,CAAC;GAC5E,MAAM,IAAI,OAAO,YAAY,QAAQ,EAAE;AACtC,WAAO,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;GAClC;CACF;;AAEM,SAAS,IAAI,GAAG;AAAE,SAAO,EAAE,CAAC;CAAE;;AAErC,SAAS,QAAQ,CAAC,OAAO,EAAE,IAAI,EAAE;AAC/B,MAAI,CAAC,IAAI,IAAI,EAAE,MAAM,IAAI,IAAI,CAAA,AAAC,EAAE;AAC9B,QAAI,GAAG,IAAI,GAAG,kBAAY,IAAI,CAAC,GAAG,EAAE,CAAC;AACrC,QAAI,CAAC,IAAI,GAAG,OAAO,CAAC;GACrB;AACD,SAAO,IAAI,CAAC;CACb;;AAED,SAAS,iBAAiB,CAAC,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE;AACzE,MAAI,EAAE,CAAC,SAAS,EAAE;AAChB,QAAI,KAAK,GAAG,EAAE,CAAC;AACf,QAAI,GAAG,EAAE,CAAC,SAAS,CAAC,IAAI,EAAE,KAAK,EAAE,SAAS,EAAE,MAAM,IAAI,MAAM,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,MAAM,CAAC,CAAC;AAC5F,SAAK,CAAC,MAAM,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;GAC3B;AACD,SAAO,IAAI,CAAC;CACb;;;;;;;;AC3QD,SAAS,UAAU,CAAC,MAAM,EAAE;AAC1B,MAAI,CAAC,MAAM,GAAG,MAAM,CAAC;CACtB;;AAED,UAAU,CAAC,SAAS,CAAC,QAAQ,GAAG,UAAU,CAAC,SAAS,CAAC,MAAM,GAAG,YAAW;AACvE,SAAO,EAAE,GAAG,IAAI,CAAC,MAAM,CAAC;CACzB,CAAC;;qBAEa,UAAU;;;;;;;;;;;;;;;ACTzB,IAAM,MAAM,GAAG;AACb,KAAG,EAAE,OAAO;AACZ,KAAG,EAAE,MAAM;AACX,KAAG,EAAE,MAAM;AACX,KAAG,EAAE,QAAQ;AACb,KAAG,EAAE,QAAQ;AACb,KAAG,EAAE,QAAQ;AACb,KAAG,EAAE,QAAQ;CACd,CAAC;;AAEF,IAAM,QAAQ,GAAG,YAAY;IACvB,QAAQ,GAAG,WAAW,CAAC;;AAE7B,SAAS,UAAU,CAAC,GAAG,EAAE;AACvB,SAAO,MAAM,CAAC,GAAG,CAAC,CAAC;CACpB;;AAEM,SAAS,MAAM,CAAC,GAAG,oBAAmB;AAC3C,OAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AACzC,SAAK,IAAI,GAAG,IAAI,SAAS,CAAC,CAAC,CAAC,EAAE;AAC5B,UAAI,MAAM,CAAC,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE;AAC3D,WAAG,CAAC,GAAG,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;OAC9B;KACF;GACF;;AAED,SAAO,GAAG,CAAC;CACZ;;AAEM,IAAI,QAAQ,GAAG,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC;;;;;;AAKhD,IAAI,UAAU,GAAG,oBAAS,KAAK,EAAE;AAC/B,SAAO,OAAO,KAAK,KAAK,UAAU,CAAC;CACpC,CAAC;;;AAGF,IAAI,UAAU,CAAC,GAAG,CAAC,EAAE;AACnB,UAIM,UAAU,GAJhB,UAAU,GAAG,UAAS,KAAK,EAAE;AAC3B,WAAO,OAAO,KAAK,KAAK,UAAU,IAAI,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,mBAAmB,CAAC;GACpF,CAAC;CACH;QACO,UAAU,GAAV,UAAU;;;;;AAIX,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,IAAI,UAAS,KAAK,EAAE;AACtD,SAAO,AAAC,KAAK,IAAI,OAAO,KAAK,KAAK,QAAQ,GAAI,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,gBAAgB,GAAG,KAAK,CAAC;CACjG,CAAC;;;;;AAGK,SAAS,OAAO,CAAC,KAAK,EAAE,KAAK,EAAE;AACpC,OAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,KAAK,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;AAChD,QAAI,KAAK,CAAC,CAAC,CAAC,KAAK,KAAK,EAAE;AACtB,aAAO,CAAC,CAAC;KACV;GACF;AACD,SAAO,CAAC,CAAC,CAAC;CACX;;AAGM,SAAS,gBAAgB,CAAC,MAAM,EAAE;AACvC,MAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;;AAE9B,QAAI,MAAM,IAAI,MAAM,CAAC,MAAM,EAAE;AAC3B,aAAO,MAAM,CAAC,MAAM,EAAE,CAAC;KACxB,MAAM,IAAI,MAAM,IAAI,IAAI,EAAE;AACzB,aAAO,EAAE,CAAC;KACX,MAAM,IAAI,CAAC,MAAM,EAAE;AAClB,aAAO,MAAM,GAAG,EAAE,CAAC;KACpB;;;;;AAKD,UAAM,GAAG,EAAE,GAAG,MAAM,CAAC;GACtB;;AAED,MAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE;AAAE,WAAO,MAAM,CAAC;GAAE;AAC9C,SAAO,MAAM,CAAC,OAAO,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC;CAC7C;;AAEM,SAAS,OAAO,CAAC,KAAK,EAAE;AAC7B,MAAI,CAAC,KAAK,IAAI,KAAK,KAAK,CAAC,EAAE;AACzB,WAAO,IAAI,CAAC;GACb,MAAM,IAAI,OAAO,CAAC,KAAK,CAAC,IAAI,KAAK,CAAC,MAAM,KAAK,CAAC,EAAE;AAC/C,WAAO,IAAI,CAAC;GACb,MAAM;AACL,WAAO,KAAK,CAAC;GACd;CACF;;AAEM,SAAS,WAAW,CAAC,MAAM,EAAE;AAClC,MAAI,KAAK,GAAG,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC;AAC/B,OAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AACvB,SAAO,KAAK,CAAC;CACd;;AAEM,SAAS,WAAW,CAAC,MAAM,EAAE,GAAG,EAAE;AACvC,QAAM,CAAC,IAAI,GAAG,GAAG,CAAC;AAClB,SAAO,MAAM,CAAC;CACf;;AAEM,SAAS,iBAAiB,CAAC,WAAW,EAAE,EAAE,EAAE;AACjD,SAAO,CAAC,WAAW,GAAG,WAAW,GAAG,GAAG,GAAG,EAAE,CAAA,GAAI,EAAE,CAAC;CACpD;;;;AC3GD;AACA;AACA;AACA;;ACHA;AACA;;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC1LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACTA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC9JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AClOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACnMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC9FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC/XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3hBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACpuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AC1RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACtRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACrCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC1XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACjwBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7JA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACzKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACxRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;ACnWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACpnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AC3sBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AChuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9hBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AC/IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACrEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1DA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACnKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "file": "generated.js",
  "sourceRoot": "../",
  "sourcesContent": [
    "(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})",
    "// shim for using process in browser\n\nvar process = module.exports = {};\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = setTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    clearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        setTimeout(drainQueue, 0);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n",
    "import * as base from './handlebars/base';\n\n// Each of these augment the Handlebars object. No need to setup here.\n// (This is done to easily share code between commonjs and browse envs)\nimport SafeString from './handlebars/safe-string';\nimport Exception from './handlebars/exception';\nimport * as Utils from './handlebars/utils';\nimport * as runtime from './handlebars/runtime';\n\nimport noConflict from './handlebars/no-conflict';\n\n// For compatibility and usage outside of module systems, make the Handlebars object a namespace\nfunction create() {\n  let hb = new base.HandlebarsEnvironment();\n\n  Utils.extend(hb, base);\n  hb.SafeString = SafeString;\n  hb.Exception = Exception;\n  hb.Utils = Utils;\n  hb.escapeExpression = Utils.escapeExpression;\n\n  hb.VM = runtime;\n  hb.template = function(spec) {\n    return runtime.template(spec, hb);\n  };\n\n  return hb;\n}\n\nlet inst = create();\ninst.create = create;\n\nnoConflict(inst);\n\ninst['default'] = inst;\n\nexport default inst;\n",
    "import {createFrame, extend, toString} from './utils';\nimport Exception from './exception';\nimport {registerDefaultHelpers} from './helpers';\nimport {registerDefaultDecorators} from './decorators';\nimport logger from './logger';\n\nexport const VERSION = '4.0.5';\nexport const COMPILER_REVISION = 7;\n\nexport const REVISION_CHANGES = {\n  1: '<= 1.0.rc.2', // 1.0.rc.2 is actually rev2 but doesn't report it\n  2: '== 1.0.0-rc.3',\n  3: '== 1.0.0-rc.4',\n  4: '== 1.x.x',\n  5: '== 2.0.0-alpha.x',\n  6: '>= 2.0.0-beta.1',\n  7: '>= 4.0.0'\n};\n\nconst objectType = '[object Object]';\n\nexport function HandlebarsEnvironment(helpers, partials, decorators) {\n  this.helpers = helpers || {};\n  this.partials = partials || {};\n  this.decorators = decorators || {};\n\n  registerDefaultHelpers(this);\n  registerDefaultDecorators(this);\n}\n\nHandlebarsEnvironment.prototype = {\n  constructor: HandlebarsEnvironment,\n\n  logger: logger,\n  log: logger.log,\n\n  registerHelper: function(name, fn) {\n    if (toString.call(name) === objectType) {\n      if (fn) { throw new Exception('Arg not supported with multiple helpers'); }\n      extend(this.helpers, name);\n    } else {\n      this.helpers[name] = fn;\n    }\n  },\n  unregisterHelper: function(name) {\n    delete this.helpers[name];\n  },\n\n  registerPartial: function(name, partial) {\n    if (toString.call(name) === objectType) {\n      extend(this.partials, name);\n    } else {\n      if (typeof partial === 'undefined') {\n        throw new Exception(`Attempting to register a partial called \"${name}\" as undefined`);\n      }\n      this.partials[name] = partial;\n    }\n  },\n  unregisterPartial: function(name) {\n    delete this.partials[name];\n  },\n\n  registerDecorator: function(name, fn) {\n    if (toString.call(name) === objectType) {\n      if (fn) { throw new Exception('Arg not supported with multiple decorators'); }\n      extend(this.decorators, name);\n    } else {\n      this.decorators[name] = fn;\n    }\n  },\n  unregisterDecorator: function(name) {\n    delete this.decorators[name];\n  }\n};\n\nexport let log = logger.log;\n\nexport {createFrame, logger};\n",
    "import registerInline from './decorators/inline';\n\nexport function registerDefaultDecorators(instance) {\n  registerInline(instance);\n}\n\n",
    "import {extend} from '../utils';\n\nexport default function(instance) {\n  instance.registerDecorator('inline', function(fn, props, container, options) {\n    let ret = fn;\n    if (!props.partials) {\n      props.partials = {};\n      ret = function(context, options) {\n        // Create a new partials stack frame prior to exec.\n        let original = container.partials;\n        container.partials = extend({}, original, props.partials);\n        let ret = fn(context, options);\n        container.partials = original;\n        return ret;\n      };\n    }\n\n    props.partials[options.args[0]] = options.fn;\n\n    return ret;\n  });\n}\n",
    "\nconst errorProps = ['description', 'fileName', 'lineNumber', 'message', 'name', 'number', 'stack'];\n\nfunction Exception(message, node) {\n  let loc = node && node.loc,\n      line,\n      column;\n  if (loc) {\n    line = loc.start.line;\n    column = loc.start.column;\n\n    message += ' - ' + line + ':' + column;\n  }\n\n  let tmp = Error.prototype.constructor.call(this, message);\n\n  // Unfortunately errors are not enumerable in Chrome (at least), so `for prop in tmp` doesn't work.\n  for (let idx = 0; idx < errorProps.length; idx++) {\n    this[errorProps[idx]] = tmp[errorProps[idx]];\n  }\n\n  /* istanbul ignore else */\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, Exception);\n  }\n\n  if (loc) {\n    this.lineNumber = line;\n    this.column = column;\n  }\n}\n\nException.prototype = new Error();\n\nexport default Exception;\n",
    "import registerBlockHelperMissing from './helpers/block-helper-missing';\nimport registerEach from './helpers/each';\nimport registerHelperMissing from './helpers/helper-missing';\nimport registerIf from './helpers/if';\nimport registerLog from './helpers/log';\nimport registerLookup from './helpers/lookup';\nimport registerWith from './helpers/with';\n\nexport function registerDefaultHelpers(instance) {\n  registerBlockHelperMissing(instance);\n  registerEach(instance);\n  registerHelperMissing(instance);\n  registerIf(instance);\n  registerLog(instance);\n  registerLookup(instance);\n  registerWith(instance);\n}\n",
    "import {appendContextPath, createFrame, isArray} from '../utils';\n\nexport default function(instance) {\n  instance.registerHelper('blockHelperMissing', function(context, options) {\n    let inverse = options.inverse,\n        fn = options.fn;\n\n    if (context === true) {\n      return fn(this);\n    } else if (context === false || context == null) {\n      return inverse(this);\n    } else if (isArray(context)) {\n      if (context.length > 0) {\n        if (options.ids) {\n          options.ids = [options.name];\n        }\n\n        return instance.helpers.each(context, options);\n      } else {\n        return inverse(this);\n      }\n    } else {\n      if (options.data && options.ids) {\n        let data = createFrame(options.data);\n        data.contextPath = appendContextPath(options.data.contextPath, options.name);\n        options = {data: data};\n      }\n\n      return fn(context, options);\n    }\n  });\n}\n",
    "import {appendContextPath, blockParams, createFrame, isArray, isFunction} from '../utils';\nimport Exception from '../exception';\n\nexport default function(instance) {\n  instance.registerHelper('each', function(context, options) {\n    if (!options) {\n      throw new Exception('Must pass iterator to #each');\n    }\n\n    let fn = options.fn,\n        inverse = options.inverse,\n        i = 0,\n        ret = '',\n        data,\n        contextPath;\n\n    if (options.data && options.ids) {\n      contextPath = appendContextPath(options.data.contextPath, options.ids[0]) + '.';\n    }\n\n    if (isFunction(context)) { context = context.call(this); }\n\n    if (options.data) {\n      data = createFrame(options.data);\n    }\n\n    function execIteration(field, index, last) {\n      if (data) {\n        data.key = field;\n        data.index = index;\n        data.first = index === 0;\n        data.last = !!last;\n\n        if (contextPath) {\n          data.contextPath = contextPath + field;\n        }\n      }\n\n      ret = ret + fn(context[field], {\n        data: data,\n        blockParams: blockParams([context[field], field], [contextPath + field, null])\n      });\n    }\n\n    if (context && typeof context === 'object') {\n      if (isArray(context)) {\n        for (let j = context.length; i < j; i++) {\n          if (i in context) {\n            execIteration(i, i, i === context.length - 1);\n          }\n        }\n      } else {\n        let priorKey;\n\n        for (let key in context) {\n          if (context.hasOwnProperty(key)) {\n            // We're running the iterations one step out of sync so we can detect\n            // the last iteration without have to scan the object twice and create\n            // an itermediate keys array.\n            if (priorKey !== undefined) {\n              execIteration(priorKey, i - 1);\n            }\n            priorKey = key;\n            i++;\n          }\n        }\n        if (priorKey !== undefined) {\n          execIteration(priorKey, i - 1, true);\n        }\n      }\n    }\n\n    if (i === 0) {\n      ret = inverse(this);\n    }\n\n    return ret;\n  });\n}\n",
    "import Exception from '../exception';\n\nexport default function(instance) {\n  instance.registerHelper('helperMissing', function(/* [args, ]options */) {\n    if (arguments.length === 1) {\n      // A missing field in a {{foo}} construct.\n      return undefined;\n    } else {\n      // Someone is actually trying to call something, blow up.\n      throw new Exception('Missing helper: \"' + arguments[arguments.length - 1].name + '\"');\n    }\n  });\n}\n",
    "import {isEmpty, isFunction} from '../utils';\n\nexport default function(instance) {\n  instance.registerHelper('if', function(conditional, options) {\n    if (isFunction(conditional)) { conditional = conditional.call(this); }\n\n    // Default behavior is to render the positive path if the value is truthy and not empty.\n    // The `includeZero` option may be set to treat the condtional as purely not empty based on the\n    // behavior of isEmpty. Effectively this determines if 0 is handled by the positive path or negative.\n    if ((!options.hash.includeZero && !conditional) || isEmpty(conditional)) {\n      return options.inverse(this);\n    } else {\n      return options.fn(this);\n    }\n  });\n\n  instance.registerHelper('unless', function(conditional, options) {\n    return instance.helpers['if'].call(this, conditional, {fn: options.inverse, inverse: options.fn, hash: options.hash});\n  });\n}\n",
    "export default function(instance) {\n  instance.registerHelper('log', function(/* message, options */) {\n    let args = [undefined],\n        options = arguments[arguments.length - 1];\n    for (let i = 0; i < arguments.length - 1; i++) {\n      args.push(arguments[i]);\n    }\n\n    let level = 1;\n    if (options.hash.level != null) {\n      level = options.hash.level;\n    } else if (options.data && options.data.level != null) {\n      level = options.data.level;\n    }\n    args[0] = level;\n\n    instance.log(... args);\n  });\n}\n",
    "export default function(instance) {\n  instance.registerHelper('lookup', function(obj, field) {\n    return obj && obj[field];\n  });\n}\n",
    "import {appendContextPath, blockParams, createFrame, isEmpty, isFunction} from '../utils';\n\nexport default function(instance) {\n  instance.registerHelper('with', function(context, options) {\n    if (isFunction(context)) { context = context.call(this); }\n\n    let fn = options.fn;\n\n    if (!isEmpty(context)) {\n      let data = options.data;\n      if (options.data && options.ids) {\n        data = createFrame(options.data);\n        data.contextPath = appendContextPath(options.data.contextPath, options.ids[0]);\n      }\n\n      return fn(context, {\n        data: data,\n        blockParams: blockParams([context], [data && data.contextPath])\n      });\n    } else {\n      return options.inverse(this);\n    }\n  });\n}\n",
    "import {indexOf} from './utils';\n\nlet logger = {\n  methodMap: ['debug', 'info', 'warn', 'error'],\n  level: 'info',\n\n  // Maps a given level value to the `methodMap` indexes above.\n  lookupLevel: function(level) {\n    if (typeof level === 'string') {\n      let levelMap = indexOf(logger.methodMap, level.toLowerCase());\n      if (levelMap >= 0) {\n        level = levelMap;\n      } else {\n        level = parseInt(level, 10);\n      }\n    }\n\n    return level;\n  },\n\n  // Can be overridden in the host environment\n  log: function(level, ...message) {\n    level = logger.lookupLevel(level);\n\n    if (typeof console !== 'undefined' && logger.lookupLevel(logger.level) <= level) {\n      let method = logger.methodMap[level];\n      if (!console[method]) {   // eslint-disable-line no-console\n        method = 'log';\n      }\n      console[method](...message);    // eslint-disable-line no-console\n    }\n  }\n};\n\nexport default logger;\n",
    "/* global window */\nexport default function(Handlebars) {\n  /* istanbul ignore next */\n  let root = typeof global !== 'undefined' ? global : window,\n      $Handlebars = root.Handlebars;\n  /* istanbul ignore next */\n  Handlebars.noConflict = function() {\n    if (root.Handlebars === Handlebars) {\n      root.Handlebars = $Handlebars;\n    }\n    return Handlebars;\n  };\n}\n",
    "import * as Utils from './utils';\nimport Exception from './exception';\nimport { COMPILER_REVISION, REVISION_CHANGES, createFrame } from './base';\n\nexport function checkRevision(compilerInfo) {\n  const compilerRevision = compilerInfo && compilerInfo[0] || 1,\n        currentRevision = COMPILER_REVISION;\n\n  if (compilerRevision !== currentRevision) {\n    if (compilerRevision < currentRevision) {\n      const runtimeVersions = REVISION_CHANGES[currentRevision],\n            compilerVersions = REVISION_CHANGES[compilerRevision];\n      throw new Exception('Template was precompiled with an older version of Handlebars than the current runtime. ' +\n            'Please update your precompiler to a newer version (' + runtimeVersions + ') or downgrade your runtime to an older version (' + compilerVersions + ').');\n    } else {\n      // Use the embedded version info since the runtime doesn't know about this revision yet\n      throw new Exception('Template was precompiled with a newer version of Handlebars than the current runtime. ' +\n            'Please update your runtime to a newer version (' + compilerInfo[1] + ').');\n    }\n  }\n}\n\nexport function template(templateSpec, env) {\n  /* istanbul ignore next */\n  if (!env) {\n    throw new Exception('No environment passed to template');\n  }\n  if (!templateSpec || !templateSpec.main) {\n    throw new Exception('Unknown template object: ' + typeof templateSpec);\n  }\n\n  templateSpec.main.decorator = templateSpec.main_d;\n\n  // Note: Using env.VM references rather than local var references throughout this section to allow\n  // for external users to override these as psuedo-supported APIs.\n  env.VM.checkRevision(templateSpec.compiler);\n\n  function invokePartialWrapper(partial, context, options) {\n    if (options.hash) {\n      context = Utils.extend({}, context, options.hash);\n      if (options.ids) {\n        options.ids[0] = true;\n      }\n    }\n\n    partial = env.VM.resolvePartial.call(this, partial, context, options);\n    let result = env.VM.invokePartial.call(this, partial, context, options);\n\n    if (result == null && env.compile) {\n      options.partials[options.name] = env.compile(partial, templateSpec.compilerOptions, env);\n      result = options.partials[options.name](context, options);\n    }\n    if (result != null) {\n      if (options.indent) {\n        let lines = result.split('\\n');\n        for (let i = 0, l = lines.length; i < l; i++) {\n          if (!lines[i] && i + 1 === l) {\n            break;\n          }\n\n          lines[i] = options.indent + lines[i];\n        }\n        result = lines.join('\\n');\n      }\n      return result;\n    } else {\n      throw new Exception('The partial ' + options.name + ' could not be compiled when running in runtime-only mode');\n    }\n  }\n\n  // Just add water\n  let container = {\n    strict: function(obj, name) {\n      if (!(name in obj)) {\n        throw new Exception('\"' + name + '\" not defined in ' + obj);\n      }\n      return obj[name];\n    },\n    lookup: function(depths, name) {\n      const len = depths.length;\n      for (let i = 0; i < len; i++) {\n        if (depths[i] && depths[i][name] != null) {\n          return depths[i][name];\n        }\n      }\n    },\n    lambda: function(current, context) {\n      return typeof current === 'function' ? current.call(context) : current;\n    },\n\n    escapeExpression: Utils.escapeExpression,\n    invokePartial: invokePartialWrapper,\n\n    fn: function(i) {\n      let ret = templateSpec[i];\n      ret.decorator = templateSpec[i + '_d'];\n      return ret;\n    },\n\n    programs: [],\n    program: function(i, data, declaredBlockParams, blockParams, depths) {\n      let programWrapper = this.programs[i],\n          fn = this.fn(i);\n      if (data || depths || blockParams || declaredBlockParams) {\n        programWrapper = wrapProgram(this, i, fn, data, declaredBlockParams, blockParams, depths);\n      } else if (!programWrapper) {\n        programWrapper = this.programs[i] = wrapProgram(this, i, fn);\n      }\n      return programWrapper;\n    },\n\n    data: function(value, depth) {\n      while (value && depth--) {\n        value = value._parent;\n      }\n      return value;\n    },\n    merge: function(param, common) {\n      let obj = param || common;\n\n      if (param && common && (param !== common)) {\n        obj = Utils.extend({}, common, param);\n      }\n\n      return obj;\n    },\n\n    noop: env.VM.noop,\n    compilerInfo: templateSpec.compiler\n  };\n\n  function ret(context, options = {}) {\n    let data = options.data;\n\n    ret._setup(options);\n    if (!options.partial && templateSpec.useData) {\n      data = initData(context, data);\n    }\n    let depths,\n        blockParams = templateSpec.useBlockParams ? [] : undefined;\n    if (templateSpec.useDepths) {\n      if (options.depths) {\n        depths = context !== options.depths[0] ? [context].concat(options.depths) : options.depths;\n      } else {\n        depths = [context];\n      }\n    }\n\n    function main(context/*, options*/) {\n      return '' + templateSpec.main(container, context, container.helpers, container.partials, data, blockParams, depths);\n    }\n    main = executeDecorators(templateSpec.main, main, container, options.depths || [], data, blockParams);\n    return main(context, options);\n  }\n  ret.isTop = true;\n\n  ret._setup = function(options) {\n    if (!options.partial) {\n      container.helpers = container.merge(options.helpers, env.helpers);\n\n      if (templateSpec.usePartial) {\n        container.partials = container.merge(options.partials, env.partials);\n      }\n      if (templateSpec.usePartial || templateSpec.useDecorators) {\n        container.decorators = container.merge(options.decorators, env.decorators);\n      }\n    } else {\n      container.helpers = options.helpers;\n      container.partials = options.partials;\n      container.decorators = options.decorators;\n    }\n  };\n\n  ret._child = function(i, data, blockParams, depths) {\n    if (templateSpec.useBlockParams && !blockParams) {\n      throw new Exception('must pass block params');\n    }\n    if (templateSpec.useDepths && !depths) {\n      throw new Exception('must pass parent depths');\n    }\n\n    return wrapProgram(container, i, templateSpec[i], data, 0, blockParams, depths);\n  };\n  return ret;\n}\n\nexport function wrapProgram(container, i, fn, data, declaredBlockParams, blockParams, depths) {\n  function prog(context, options = {}) {\n    let currentDepths = depths;\n    if (depths && context !== depths[0]) {\n      currentDepths = [context].concat(depths);\n    }\n\n    return fn(container,\n        context,\n        container.helpers, container.partials,\n        options.data || data,\n        blockParams && [options.blockParams].concat(blockParams),\n        currentDepths);\n  }\n\n  prog = executeDecorators(fn, prog, container, depths, data, blockParams);\n\n  prog.program = i;\n  prog.depth = depths ? depths.length : 0;\n  prog.blockParams = declaredBlockParams || 0;\n  return prog;\n}\n\nexport function resolvePartial(partial, context, options) {\n  if (!partial) {\n    if (options.name === '@partial-block') {\n      partial = options.data['partial-block'];\n    } else {\n      partial = options.partials[options.name];\n    }\n  } else if (!partial.call && !options.name) {\n    // This is a dynamic partial that returned a string\n    options.name = partial;\n    partial = options.partials[partial];\n  }\n  return partial;\n}\n\nexport function invokePartial(partial, context, options) {\n  options.partial = true;\n  if (options.ids) {\n    options.data.contextPath = options.ids[0] || options.data.contextPath;\n  }\n\n  let partialBlock;\n  if (options.fn && options.fn !== noop) {\n    options.data = createFrame(options.data);\n    partialBlock = options.data['partial-block'] = options.fn;\n\n    if (partialBlock.partials) {\n      options.partials = Utils.extend({}, options.partials, partialBlock.partials);\n    }\n  }\n\n  if (partial === undefined && partialBlock) {\n    partial = partialBlock;\n  }\n\n  if (partial === undefined) {\n    throw new Exception('The partial ' + options.name + ' could not be found');\n  } else if (partial instanceof Function) {\n    return partial(context, options);\n  }\n}\n\nexport function noop() { return ''; }\n\nfunction initData(context, data) {\n  if (!data || !('root' in data)) {\n    data = data ? createFrame(data) : {};\n    data.root = context;\n  }\n  return data;\n}\n\nfunction executeDecorators(fn, prog, container, depths, data, blockParams) {\n  if (fn.decorator) {\n    let props = {};\n    prog = fn.decorator(prog, props, container, depths && depths[0], data, blockParams, depths);\n    Utils.extend(prog, props);\n  }\n  return prog;\n}\n",
    "// Build out our basic SafeString type\nfunction SafeString(string) {\n  this.string = string;\n}\n\nSafeString.prototype.toString = SafeString.prototype.toHTML = function() {\n  return '' + this.string;\n};\n\nexport default SafeString;\n",
    "const escape = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;',\n  '=': '&#x3D;'\n};\n\nconst badChars = /[&<>\"'`=]/g,\n      possible = /[&<>\"'`=]/;\n\nfunction escapeChar(chr) {\n  return escape[chr];\n}\n\nexport function extend(obj/* , ...source */) {\n  for (let i = 1; i < arguments.length; i++) {\n    for (let key in arguments[i]) {\n      if (Object.prototype.hasOwnProperty.call(arguments[i], key)) {\n        obj[key] = arguments[i][key];\n      }\n    }\n  }\n\n  return obj;\n}\n\nexport let toString = Object.prototype.toString;\n\n// Sourced from lodash\n// https://github.com/bestiejs/lodash/blob/master/LICENSE.txt\n/* eslint-disable func-style */\nlet isFunction = function(value) {\n  return typeof value === 'function';\n};\n// fallback for older versions of Chrome and Safari\n/* istanbul ignore next */\nif (isFunction(/x/)) {\n  isFunction = function(value) {\n    return typeof value === 'function' && toString.call(value) === '[object Function]';\n  };\n}\nexport {isFunction};\n/* eslint-enable func-style */\n\n/* istanbul ignore next */\nexport const isArray = Array.isArray || function(value) {\n  return (value && typeof value === 'object') ? toString.call(value) === '[object Array]' : false;\n};\n\n// Older IE versions do not directly support indexOf so we must implement our own, sadly.\nexport function indexOf(array, value) {\n  for (let i = 0, len = array.length; i < len; i++) {\n    if (array[i] === value) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n\nexport function escapeExpression(string) {\n  if (typeof string !== 'string') {\n    // don't escape SafeStrings, since they're already safe\n    if (string && string.toHTML) {\n      return string.toHTML();\n    } else if (string == null) {\n      return '';\n    } else if (!string) {\n      return string + '';\n    }\n\n    // Force a string conversion as this will be done by the append regardless and\n    // the regex test will do this transparently behind the scenes, causing issues if\n    // an object's to string has escaped characters in it.\n    string = '' + string;\n  }\n\n  if (!possible.test(string)) { return string; }\n  return string.replace(badChars, escapeChar);\n}\n\nexport function isEmpty(value) {\n  if (!value && value !== 0) {\n    return true;\n  } else if (isArray(value) && value.length === 0) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function createFrame(object) {\n  let frame = extend({}, object);\n  frame._parent = object;\n  return frame;\n}\n\nexport function blockParams(params, ids) {\n  params.path = ids;\n  return params;\n}\n\nexport function appendContextPath(contextPath, id) {\n  return (contextPath ? contextPath + '.' : '') + id;\n}\n",
    "// Create a simple path alias to allow browserify to resolve\n// the runtime on a supported path.\nmodule.exports = require('./dist/cjs/handlebars.runtime')['default'];\n",
    "module.exports = require(\"handlebars/runtime\")[\"default\"];\n",
    "(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 6–8\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n",
    "var trim = require('./trim');\nvar decap = require('./decapitalize');\n\nmodule.exports = function camelize(str, decapitalize) {\n  str = trim(str).replace(/[-_\\s]+(.)?/g, function(match, c) {\n    return c ? c.toUpperCase() : '';\n  });\n\n  if (decapitalize === true) {\n    return decap(str);\n  } else {\n    return str;\n  }\n};\n",
    "var makeString = require('./helper/makeString');\n\nmodule.exports = function capitalize(str, lowercaseRest) {\n  str = makeString(str);\n  var remainingChars = !lowercaseRest ? str.slice(1) : str.slice(1).toLowerCase();\n\n  return str.charAt(0).toUpperCase() + remainingChars;\n};\n",
    "var capitalize = require('./capitalize');\nvar camelize = require('./camelize');\nvar makeString = require('./helper/makeString');\n\nmodule.exports = function classify(str) {\n  str = makeString(str);\n  return capitalize(camelize(str.replace(/[\\W_]/g, ' ')).replace(/\\s/g, ''));\n};\n",
    "var trim = require('./trim');\n\nmodule.exports = function dasherize(str) {\n  return trim(str).replace(/([A-Z])/g, '-$1').replace(/[-_\\s]+/g, '-').toLowerCase();\n};\n",
    "var makeString = require('./helper/makeString');\n\nmodule.exports = function decapitalize(str) {\n  str = makeString(str);\n  return str.charAt(0).toLowerCase() + str.slice(1);\n};\n",
    "var escapeRegExp = require('./escapeRegExp');\n\nmodule.exports = function defaultToWhiteSpace(characters) {\n  if (characters == null)\n    return '\\\\s';\n  else if (characters.source)\n    return characters.source;\n  else\n    return '[' + escapeRegExp(characters) + ']';\n};\n",
    "var makeString = require('./makeString');\n\nmodule.exports = function escapeRegExp(str) {\n  return makeString(str).replace(/([.*+?^=!:${}()|[\\]\\/\\\\])/g, '\\\\$1');\n};\n",
    "/**\n * Ensure some object is a coerced to a string\n **/\nmodule.exports = function makeString(object) {\n  if (object == null) return '';\n  return '' + object;\n};\n",
    "module.exports = function strRepeat(str, qty){\n  if (qty < 1) return '';\n  var result = '';\n  while (qty > 0) {\n    if (qty & 1) result += str;\n    qty >>= 1, str += str;\n  }\n  return result;\n};\n",
    "var pad = require('./pad');\n\nmodule.exports = function lpad(str, length, padStr) {\n  return pad(str, length, padStr);\n};\n",
    "var makeString = require('./helper/makeString');\nvar strRepeat = require('./helper/strRepeat');\n\nmodule.exports = function pad(str, length, padStr, type) {\n  str = makeString(str);\n  length = ~~length;\n\n  var padlen = 0;\n\n  if (!padStr)\n    padStr = ' ';\n  else if (padStr.length > 1)\n    padStr = padStr.charAt(0);\n\n  switch (type) {\n  case 'right':\n    padlen = length - str.length;\n    return str + strRepeat(padStr, padlen);\n  case 'both':\n    padlen = length - str.length;\n    return strRepeat(padStr, Math.ceil(padlen / 2)) + str + strRepeat(padStr, Math.floor(padlen / 2));\n  default: // 'left'\n    padlen = length - str.length;\n    return strRepeat(padStr, padlen) + str;\n  }\n};\n",
    "var pad = require('./pad');\n\nmodule.exports = function rpad(str, length, padStr) {\n  return pad(str, length, padStr, 'right');\n};\n",
    "var makeString = require('./helper/makeString');\nvar defaultToWhiteSpace = require('./helper/defaultToWhiteSpace');\nvar nativeTrim = String.prototype.trim;\n\nmodule.exports = function trim(str, characters) {\n  str = makeString(str);\n  if (!characters && nativeTrim) return nativeTrim.call(str);\n  characters = defaultToWhiteSpace(characters);\n  return str.replace(new RegExp('^' + characters + '+|' + characters + '+$', 'g'), '');\n};\n",
    "/**\n/* @module app/App\n/*/\n\"use strict\";\n\nconsole.info(\"Portfolio App started\");\n\nif (!DEBUG) {\n\twindow.addEventListener(\"error\", function(ev) {\n\t\tconsole.error(\"Uncaught Error\", ev);\n\t});\n}\n\nrequire(\"Modernizr\");\nrequire(\"es6-promise\").polyfill();\nrequire(\"classlist-polyfill\");\nrequire(\"raf-polyfill\");\nrequire(\"matches-polyfill\");\nrequire(\"fullscreen-polyfill\");\nrequire(\"math-sign-polyfill\");\nrequire(\"setimmediate\");\n\nrequire(\"backbone\").$ = require(\"backbone.native\");\nrequire(\"backbone.babysitter\");\nrequire(\"Backbone.Mutators\");\nrequire(\"hammerjs\");\n\ndocument.addEventListener('DOMContentLoaded', function(ev) {\n\tconsole.log(\"%s:[event %s]\", ev.target, ev.type);\n});\nwindow.addEventListener(\"load\", function(ev) {\n\tconsole.log(\"%s:[event %s]\", ev.target, ev.type);\n\n\t// process bootstrap data, let errors go up the stack\n\ttry {\n\t\trequire(\"app/model/helper/bootstrap\")(window.bootstrap);\n\t\t// } catch (err) {\n\t\t// \t// document.body.innerHTML = \"<h1>Oops... </h1>\";\n\t\t// \t// document.documentElement.classList.remove(\"app-initial\");\n\t\t// \t// document.documentElement.classList.add(\"app-error\");\n\t\t// \tthrow new Error(\"bootstrap data is missing\");\n\t} finally {\n\t\t// detele global var\n\t\tdelete window.bootstrap;\n\t}\n\n\trequire(\"app/view/template/_helpers\");\n\t// require(\"app/view/template/_partials\");\n\t/** @type {module:app/view/helper/createColorStyleSheet} */\n\trequire(\"app/view/helper/createColorStyleSheet\").call();\n\n\t/** @type {module:app/view/AppView} */\n\tvar AppView = require(\"app/view/AppView\");\n\n\t/** @type {module:webfontloader} */\n\tvar WebFont = require(\"webfontloader\");\n\tWebFont.load({\n\t\tasync: true,\n\t\tclasses: false,\n\t\tcustom: {\n\t\t\tfamilies: [\n\t\t\t\t\"Franklin Gothic FS:n4,i4,n7,i7\",\n\t\t\t\t\"FolioFigures:n4\",\n\t\t\t],\n\t\t\ttestStrings: {\n\t\t\t\t\"FolioFigures\": \"hms\"\n\t\t\t},\n\t\t},\n\t\tactive: function() {\n\t\t\tconsole.info(\"WebFont::active\");\n\t\t\tAppView.getInstance();\n\t\t},\n\t\tfontactive: function(familyName, variantFvd) {\n\t\t\tconsole.info(\"WebFont::fontactive '%s' (%s)\", familyName, variantFvd);\n\t\t},\n\t\tinactive: function() {\n\t\t\tconsole.warn(\"WebFont::inactive\");\n\t\t\tAppView.getInstance();\n\t\t},\n\t\tfontinactive: function(familyName, variantFvd) {\n\t\t\tconsole.warn(\"WebFont::fontinactive '%s' (%s)\", familyName, variantFvd);\n\t\t},\n\t\t// loading: function() {\n\t\t// \tconsole.log(\"WebFont::loading\");\n\t\t// },\n\t\t// fontloading: function(familyName, variantDesc) {\n\t\t// \tconsole.log(\"WebFont::fontloading\", familyName, JSON.stringify(variantDesc, null, \" \"));\n\t\t// },\n\t});\n});\n\n\nif (DEBUG) {\n\t// /** @type {module:underscore} */\n\t// var _ = require(\"underscore\");\n\n\t// var isFF = /Firefox/.test(window.navigator.userAgent);\n\t// var isIOS = /iPad|iPhone/.test(window.navigator.userAgent);\n\t/*\n\tif (/Firefox/.test(window.navigator.userAgent)) {\n\t\tconsole.prefix = \"# \";\n\t\tvar shift = [].shift;\n\t\tvar logWrapFn = function() {\n\t\t\tif (typeof arguments[1] == \"string\") arguments[1] = console.prefix + arguments[1];\n\t\t\treturn shift.apply(arguments).apply(console, arguments);\n\t\t};\n\t\tconsole.group = _.wrap(console.group, logWrapFn);\n\t\tconsole.log = _.wrap(console.log, logWrapFn);\n\t\tconsole.info = _.wrap(console.info, logWrapFn);\n\t\tconsole.warn = _.wrap(console.warn, logWrapFn);\n\t\tconsole.error = _.wrap(console.error, logWrapFn);\n\t}\n\t*/\n\t/*\n\tvar saveLogs = function() {\n\t\tvar logWrapFn = function(name, fn, msg) {\n\t\t\tdocument.documentElement.appendChild(\n\t\t\t\tdocument.createComment(\"[\" + name + \"] \" + msg));\n\t\t};\n\t\tconsole.group = _.wrap(console.group, _.partial(logWrapFn, \"group\"));\n\t\tconsole.log = _.wrap(console.log, _.partial(logWrapFn, \"log\"));\n\t\tconsole.info = _.wrap(console.info, _.partial(logWrapFn, \"info\"));\n\t\tconsole.warn = _.wrap(console.warn, _.partial(logWrapFn, \"warn\"));\n\t\tconsole.error = _.wrap(console.error, _.partial(logWrapFn, \"error\"));\n\t};\n\t*/\n\n\t// handle error events on some platforms and production\n\t/*\n\tif (isIOS) {\n\t\t// saveLogs();\n\t\twindow.addEventListener(\"error\", function() {\n\t\t\tvar args = Array.prototype.slice.apply(arguments),\n\t\t\t\tel = document.createElement(\"div\"),\n\t\t\t\thtml = \"\";\n\t\t\t_.extend(el.style, {\n\t\t\t\tfontfamily: \"monospace\",\n\t\t\t\tdisplay: \"block\",\n\t\t\t\tposition: \"absolute\",\n\t\t\t\tzIndex: \"999\",\n\t\t\t\tbackgroundColor: \"white\",\n\t\t\t\tcolor: \"black\",\n\t\t\t\twidth: \"calc(100% - 3em)\",\n\t\t\t\tbottom: \"0\",\n\t\t\t\tmargin: \"1em 1.5em\",\n\t\t\t\tpadding: \"1em 1.5em\",\n\t\t\t\toutline: \"0.5em solid red\",\n\t\t\t\toutlineOffset: \"0.5em\",\n\t\t\t\tboxSizing: \"border-box\",\n\t\t\t\toverflow: \"hidden\",\n\t\t\t});\n\t\t\thtml += \"<pre><b>location:<b> \" + window.location + \"</pre>\";\n\t\t\thtml += \"<pre><b>event:<b> \" + JSON.stringify(args.shift(), null, \" \") + \"</pre>\";\n\t\t\tif (args.length) html += \"<pre><b>rest:<b> \" + JSON.stringify(args, null, \" \") + \"</pre>\";\n\t\t\tel.innerHTML = html;\n\t\t\tdocument.body.appendChild(el);\n\t\t});\n\t}*/\n}",
    "/**\n/* @module app/control/Controller\n/*/\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n\n// /** @type {module:app/model/collection/TypeCollection} */\n// var types = require(\"app/model/collection/TypeCollection\");\n// /** @type {module:app/model/collection/KeywordCollection} */\n// var keywords = require(\"app/model/collection/KeywordCollection\");\n/** @type {module:app/model/collection/ArticleCollection} */\nvar articles = require(\"app/model/collection/ArticleCollection\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundles = require(\"app/model/collection/BundleCollection\");\n\n/* --------------------------- *\n/* Static private\n/* --------------------------- */\n\n/**\n/* @constructor\n/* @type {module:app/control/Controller}\n/*/\nvar Controller = Backbone.Router.extend({\n\n\t// /** @override */\n\t// routes: {},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tthis._routeNames = [];\n\t\t/*\n\t\tPrefixed article regexp: /^article(?:\\/([^\\/]+))\\/?$/\n\t\tSingle bundle regexp: /^bundles(?:\\/([^\\/]+)(?:\\/(\\d+))?)?\\/?$/\n\t\t*/\n\t\tthis.route(/(.*)/,\n\t\t\t\"notfound\", this.toNotFound);\n\t\tthis.route(/^([a-z][a-z0-9\\-]*)\\/?$/,\n\t\t\t\"article-item\", this.toArticleItem);\n\t\tthis.route(/^(?:bundles)?\\/?$/,\n\t\t\t\"root\", this.toRoot);\n\t\t// this.route(/^bundles\\/?$/,\n\t\t// \t\"bundle-list\", this.toBundleList);\n\t\tthis.route(/^bundles\\/([^\\/]+)\\/?$/,\n\t\t\t\"bundle-item\", this.toBundleItem);\n\t\tthis.route(/^bundles\\/([^\\/]+)\\/(\\d+)\\/?$/,\n\t\t\t\"media-item\", this.toMediaItem);\n\n\t\tconsole.log(\"%s::initialize routes: %o\", \"controller\", this._routeNames);\n\t},\n\n\troute: function(route, name, callback) {\n\t\tthis._routeNames.push(_.isString(name) ? name : '');\n\t\treturn Backbone.Router.prototype.route.apply(this, arguments);\n\t},\n\n\t/* ---------------------------\n\t/* JS to URL: public command methods\n\t/* --------------------------- */\n\n\tselectMedia: function(media) {\n\t\tthis._goToLocation(media.get(\"bundle\"), media);\n\t},\n\n\tselectBundle: function(bundle) {\n\t\tthis._goToLocation(bundle);\n\t},\n\n\tdeselectMedia: function() {\n\t\tthis._goToLocation(bundles.selected);\n\t},\n\n\tdeselectBundle: function() {\n\t\tthis._goToLocation();\n\t},\n\n\tselectArticle: function(article) {\n\t\tthis.navigate(article.get(\"handle\"), { trigger: true });\n\t},\n\n\tdeselectArticle: function() {\n\t\tthis.navigate(\"\", { trigger: true });\n\t},\n\n\t/* ---------------------------\n\t/* JS to URL: private helpers\n\t/* --------------------------- */\n\n\t/** Update location when navigation happens internally */\n\t_updateLocation: function() {\n\t\tvar bundle, media;\n\t\tbundle = bundles.selected;\n\t\tif (bundle) {\n\t\t\tmedia = bundle.get(\"media\").selected;\n\t\t}\n\t\tthis.navigate(this._getLocation(bundle, media), {\n\t\t\ttrigger: false\n\t\t});\n\t},\n\n\t_getLocation: function(bundle, media) {\n\t\tvar mediaIndex, location = [];\n\t\tif (bundle) {\n\t\t\tlocation.push(\"bundles\");\n\t\t\tlocation.push(bundle.get(\"handle\"));\n\t\t\tif (media) {\n\t\t\t\tmediaIndex = bundle.get(\"media\").indexOf(media);\n\t\t\t\tif (mediaIndex >= 0) {\n\t\t\t\t\tlocation.push(mediaIndex);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// location.push(\"\");\n\t\treturn location.join(\"/\");\n\t},\n\n\t_goToLocation: function(bundle, media) {\n\t\tthis.navigate(this._getLocation(bundle, media), {\n\t\t\ttrigger: true\n\t\t});\n\t},\n\n\t/* --------------------------- *\n\t/* URL to JS: router handlers\n\t/* --------------------------- */\n\n\ttoRoot: function() {\n\t\tthis.trigger(\"change:before\");\n\t\tif (bundles.selected) {\n\t\t\tbundles.selected.get(\"media\").deselect();\n\t\t\tbundles.deselect();\n\t\t}\n\t\t// keywords.deselect();\n\t\tarticles.deselect();\n\t\tthis.trigger(\"change:after\");\n\t},\n\n\ttoNotFound: function(slug) {\n\t\tconsole.info(\"route:[*:%s]\", slug);\n\t},\n\n\t// toBundleList: function() {\n\t// \tthis.navigate(\"\", {\n\t// \t\ttrigger: true,\n\t// \t\treplace: true\n\t// \t});\n\t// },\n\n\ttoBundleItem: function(bundleHandle) {\n\t\tvar bundle = bundles.findWhere({\n\t\t\thandle: bundleHandle\n\t\t});\n\t\tif (!bundle) {\n\t\t\tthrow new Error(\"Cannot find bundle with handle \\\"\" + bundleHandle + \"\\\"\");\n\t\t}\n\t\tthis._changeSelection(bundle);\n\t},\n\n\ttoMediaItem: function(bundleHandle, mediaIndex) {\n\t\tvar bundle, media;\n\t\t// if (bundleHandle) {\n\t\tbundle = bundles.findWhere({ handle: bundleHandle });\n\t\tif (!bundle) {\n\t\t\tthrow new Error(\"No bundle with handle \\\"\" + bundleHandle + \"\\\" found\");\n\t\t}\n\t\t// if (mediaIndex) {\n\t\tmedia = bundle.get(\"media\").at(mediaIndex);\n\t\tif (!media) {\n\t\t\tthrow new Error(\"No media at index \" + mediaIndex + \" in bundle with handle \\\"\" + bundleHandle + \"\\\" found\");\n\t\t}\n\t\t// }\n\t\t// }\n\t\tthis._changeSelection(bundle, media);\n\t},\n\n\ttoArticleItem: function(articleHandle) {\n\t\tvar article = articles.findWhere({ handle: articleHandle });\n\t\tif (!article) {\n\t\t\tthrow new Error(\"Cannot find article with handle \\\"\" + articleHandle + \"\\\"\");\n\t\t}\n\t\tthis.trigger(\"change:before\", article);\n\t\tbundles.deselect();\n\t\tarticles.select(article);\n\t\tthis.trigger(\"change:after\", article);\n\t},\n\n\t/* -------------------------------\n\t/* URL to JS: private helpers\n\t/* ------------------------------- */\n\n\t/*\n\t/* NOTE: Selection order\n\t/* - Apply media selection to *incoming bundle*, as not to trigger\n\t/*\tunneccesary events on an outgoing bundle. Outgoing bundle media selection\n\t/*\tremains untouched.\n\t/* - Apply media selection *before* selecting the incoming bundle. Views\n\t/*\tnormally listen to the selected bundle only, so if the bundle is changing,\n\t/*\tthey will not be listening to media selection changes yet.\n\t/*/\n\t_changeSelection: function(bundle, media) {\n\t\tvar lastBundle, lastMedia;\n\t\tif (bundle === void 0) bundle = null;\n\t\tif (media === void 0) media = null;\n\n\t\tlastBundle = bundles.selected;\n\t\tlastMedia = lastBundle ? lastBundle.get(\"media\").selected : null;\n\t\tconsole.log(\"controller::_changeSelection bundle:[%s => %s] media:[%s => %s]\",\n\t\t\t(lastBundle ? lastBundle.cid : lastBundle), (bundle ? bundle.cid : bundle),\n\t\t\t(lastMedia ? lastMedia.cid : lastMedia), (media ? media.cid : media)\n\t\t);\n\n\t\tif (!articles.selected && lastBundle === bundle && lastMedia === media) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.trigger(\"change:before\", bundle, media);\n\t\tbundle && bundle.get(\"media\").select(media);\n\t\tbundles.select(bundle);\n\t\tarticles.deselect();\n\t\tthis.trigger(\"change:after\", bundle, media);\n\t},\n});\n\nmodule.exports = new Controller();",
    "/**\n/* @module app/control/Globals\n/*/\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n\nmodule.exports = (function() {\n\t// reusable vars\n\tvar o, s, so;\n\t// global hash\n\tvar g = {};\n\t// SASS <--> JS shared hash\n\tvar sass = require(\"../../../sass/variables.json\");\n\n\t// JUNK FIRST: Some app-wide defaults\n\t// - - - - - - - - - - - - - - - - -\n\tg.VPAN_DRAG = 0.95; // as factor of pointer delta\n\tg.HPAN_OUT_DRAG = 0.4; // factor\n\tg.VPAN_OUT_DRAG = 0.1; // factor\n\tg.PAN_THRESHOLD = 15; // px\n\tg.COLLAPSE_THRESHOLD = 75; // px\n\tg.COLLAPSE_OFFSET = parseInt(sass.temp[\"collapse_offset\"]);\n\n\t// breakpoints\n\t// - - - - - - - - - - - - - - - - -\n\tg.BREAKPOINTS = {};\n\tfor (s in sass.breakpoints) {\n\t\to = sass.breakpoints[s];\n\t\t/*if (Array.isArray(o)) {\n\t\t\tg.BREAKPOINTS[s] = Object.defineProperties({}, {\n\t\t\t\t\"matches\": {\n\t\t\t\t\tget: _.partial(_.some, o.map(window.matchMedia), _.property(\"matches\"))\n\t\t\t\t},\n\t\t\t\t\"media\": {\n\t\t\t\t\tvalue: o.join(\", \")\n\t\t\t\t},\n\t\t\t\t\"queries\": {\n\t\t\t\t\tvalue: o.map(window.matchMedia)\n\t\t\t\t},\n\t\t\t});\n\t\t} else {\n\t\t\tg.BREAKPOINTS[s] = window.matchMedia(o);\n\t\t}*/\n\t\to = Array.isArray(o) ? o.join(\", \") : o;\n\t\to = o.replace(/[\\'\\\"]/g, \"\");\n\t\to = window.matchMedia(o);\n\t\to.className = s;\n\t\tg.BREAKPOINTS[s] = o;\n\t}\n\tif (DEBUG) {\n\t\tconsole.group(\"Breakpoints\");\n\t\tfor (s in g.BREAKPOINTS) {\n\t\t\t// console.log(\"%s: %o %o\", s, g.BREAKPOINTS[s], sass.breakpoints[s] + '');\n\t\t\tconsole.log(\"%s: %o\", s, g.BREAKPOINTS[s].media);\n\t\t}\n\t\tconsole.groupEnd();\n\t}\n\n\t// base colors, dimensions\n\t// - - - - - - - - - - - - - - - - -\n\tg.DEFAULT_COLORS = _.clone(sass.default_colors);\n\tg.HORIZONTAL_STEP = parseFloat(sass.units[\"hu_px\"]);\n\tg.VERTICAL_STEP = parseFloat(sass.units[\"vu_px\"]);\n\n\n\t// paths, networking\n\t// - - - - - - - - - - - - - - - - -\n\t// var toAbsoluteURL = (function() {\n\t// \tvar a = null;\n\t// \treturn function(url) {\n\t// \t\ta = a || document.createElement('a');\n\t// \t\ta.href = url;\n\t// \t\treturn a.href;\n\t// \t};\n\t// })();\n\t// g.APP_ROOT = toAbsoluteURL(window.approot);\n\t// g.MEDIA_DIR = toAbsoluteURL(window.mediadir);\n\n\tg.APP_ROOT = window.approot;\n\tg.MEDIA_DIR = window.mediadir;\n\n\tdelete window.approot;\n\tdelete window.mediadir;\n\n\t// hardcoded font data\n\t// - - - - - - - - - - - - - - - - -\n\tg.FONT_METRICS = {\n\t\t\"Franklin Gothic FS\": {\n\t\t\t\"unitsPerEm\": 1000,\n\t\t\t\"ascent\": 827,\n\t\t\t\"descent\": -173\n\t\t},\n\t\t\"ITCFranklinGothicStd\": {\n\t\t\t\"unitsPerEm\": 1000,\n\t\t\t\"ascent\": 686,\n\t\t\t\"descent\": -314\n\t\t},\n\t\t\"FolioFigures\": {\n\t\t\t\"unitsPerEm\": 1024,\n\t\t\t\"ascent\": 939,\n\t\t\t\"descent\": -256\n\t\t},\n\t};\n\n\tg.PAUSE_CHAR = String.fromCharCode(0x23F8);\n\tg.PLAY_CHAR = String.fromCharCode(0x23F5);\n\tg.STOP_CHAR = String.fromCharCode(0x23F9);\n\n\t// translate common template\n\n\tg.TRANSLATE_TEMPLATE = function(x, y) {\n\t\treturn \"translate(\" + x + \"px, \" + y + \"px)\";\n\t\t// return \"translate3d(\" + x + \"px, \" + y + \"px ,0px)\";\n\t};\n\t// timing, easing\n\t// - - - - - - - - - - - - - - - - -\n\tvar ease = g.TRANSITION_EASE = sass.transitions[\"ease\"];\n\tvar duration = g.TRANSITION_DURATION = parseFloat(sass.transitions[\"duration_ms\"]);\n\tvar delayInterval = g.TRANSITION_DELAY_INTERVAL = parseFloat(sass.transitions[\"delay_interval_ms\"]);\n\tvar minDelay = g.TRANSITION_MIN_DELAY = parseFloat(sass.transitions[\"min_delay_ms\"]);\n\tvar delay = g.TRANSITION_DELAY = g.TRANSITION_DURATION + g.TRANSITION_DELAY_INTERVAL;\n\n\t// css transition presets\n\t// TODO: get rid of this\n\t// - - - - - - - - - - - - - - - - -\n\n\t// var tx = function(txo, durationCount, delayCount) {\n\t// \ttxo.duration = (duration * durationCount)\n\t// \t\t+ (delayInterval * (durationCount - 1));\n\t// \ttxo.delay = (delay * delayCount) + minDelay;\n\t// };\n\n\to = {};\n\n\to.NONE = {\n\t\tdelay: 0,\n\t\tduration: 0,\n\t\teasing: \"step-start\"\n\t};\n\to.NOW = {\n\t\tdelay: 0,\n\t\tduration: duration,\n\t\teasing: ease\n\t};\n\to.UNSET = _.defaults({\n\t\tcssText: \"\"\n\t}, o.NONE);\n\n\tvar txAligned = _.defaults({\n\t\tduration: duration - minDelay\n\t}, o.NOW);\n\to.FIRST = _.defaults({\n\t\tdelay: delay * 0.0 + minDelay\n\t}, txAligned);\n\to.BETWEEN = _.defaults({\n\t\tdelay: delay * 1.0 + minDelay\n\t}, txAligned);\n\to.LAST = _.defaults({\n\t\tdelay: delay * 2.0 + minDelay\n\t}, txAligned);\n\to.AFTER = _.defaults({\n\t\tdelay: delay * 2.0 + minDelay\n\t}, txAligned);\n\n\to.BETWEEN_EARLY = _.defaults({\n\t\tdelay: delay * 1.0 + minDelay - 60\n\t}, txAligned);\n\to.BETWEEN_LATE = _.defaults({\n\t\tdelay: delay * 1.0 + minDelay + 60\n\t}, txAligned);\n\n\to.FIRST_LATE = _.defaults({\n\t\tdelay: delay * 0.5 + minDelay\n\t}, txAligned);\n\to.LAST_EARLY = _.defaults({\n\t\tdelay: delay * 1.5 + minDelay\n\t}, txAligned);\n\t// o.FIRST_LATE = \t\t_.defaults({delay: txDelay*0.0 + txMinDelay*2}, txAligned);\n\t// o.LAST_EARLY = \t\t_.defaults({delay: txDelay*2.0 + txMinDelay*0}, txAligned);\n\t// o.AFTER = \t\t\t_.defaults({delay: txDelay*2.0 + txMinDelay}, txAligned);\n\n\tconsole.groupCollapsed(\"Transitions\");\n\tfor (s in o) {\n\t\tso = o[s];\n\t\tso.name = s;\n\t\tso.className = \"tx-\" + s.replace(\"_\", \"-\").toLowerCase();\n\t\tif (!so.hasOwnProperty(\"cssText\")) {\n\t\t\tso.cssText = so.duration / 1000 + \"s \" + so.easing + \" \" + so.delay / 1000 + \"s\";\n\t\t}\n\t\tconsole.log(\"%s: %s\", so.name, so.cssText);\n\t}\n\tconsole.groupEnd();\n\tg.transitions = o;\n\n\treturn g;\n}());",
    "/**\n * @module app/model/BaseItem\n * @requires module:backbone\n */\n\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n\nvar defaults = {\n\trouteName: \"initial\",\n\tcollapsed: false,\n\tarticle: null,\n\twithArticle: false,\n\tbundle: null,\n\twithBundle: false,\n\tmedia: null,\n\twithMedia: false,\n};\n\nvar AppState = Backbone.Model.extend({\n\tdefaults: defaults,\n\t// getters: Object.keys(defaults),\n});\n\nmodule.exports = AppState;",
    "/**\n * @module app/model/BaseItem\n * @requires module:backbone\n */\n\n/** @type {module:backbone} */\nvar Model = require(\"backbone\").Model;\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n\n// /** @type {module:app/control/Globals} */\n// var Globals = require(\"app/control/Globals\");\n// /** @type {module:app/utils/strings/stripTags} */\n// var stripTags = require(\"utils/strings/stripTags\");\n// /** @type {module:app/model/parseSymAttrs} */\n//var parseSymAttrs = require(\"app/model/parseSymAttrs\");\n\nvar parseSymAttrs = function(s) {\n\treturn s.replace(/(\\,|\\;)/g, function(m) {\n\t\treturn (m == \",\") ? \";\" : \",\";\n\t});\n};\nvar toAttrsHash = function(obj, attr) {\n\tif (_.isString(attr)) {\n\t\tvar idx = attr.indexOf(\":\");\n\t\tif (idx > 0) {\n\t\t\tobj[attr.substring(0, idx)] = parseSymAttrs(attr.substring(idx + 1));\n\t\t} else {\n\t\t\tobj[attr] = attr; // to match HTML5<>XHTML valueless attributes\n\t\t}\n\t} // else ignore non-string values\n\treturn obj;\n};\n\nvar BaseItemProto = {\n\n\t_domPrefix: \"_\",\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\t// attrs: function() { return {}; },\n\t\tget attrs() {\n\t\t\treturn {};\n\t\t},\n\t},\n\n\tgetters: [\"domid\"],\n\n\tmutators: {\n\t\tdomid: function() {\n\t\t\tif (!this.hasOwnProperty(\"_domId\"))\n\t\t\t\tthis._domId = this._domPrefix + this.id;\n\t\t\treturn this._domId;\n\t\t},\n\t\tattrs: {\n\t\t\tset: function(key, value, options, set) {\n\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\tvalue = value.reduce(toAttrsHash, {});\n\t\t\t\t}\n\t\t\t\tif (!_.isObject(value)) {\n\t\t\t\t\tconsole.error(\"%s::attrs value not an object or string array\", this.cid, value);\n\t\t\t\t\tvalue = {};\n\t\t\t\t}\n\t\t\t\tset(key, value, options);\n\t\t\t}\n\t\t},\n\t},\n\n\tattr: function(attr) {\n\t\treturn this.attrs()[attr];\n\t},\n\n\tattrs: function() {\n\t\treturn this.get(\"attrs\");\n\t},\n\n\ttoString: function() {\n\t\treturn this.get(\"domid\");\n\t}\n};\n\nvar BaseItem = {\n\textend: function(proto, obj) {\n\t\tvar constr, propName; //, propDef;\n\t\tfor (propName in proto) {\n\t\t\tif (proto.hasOwnProperty(propName) && _.isObject(proto[propName])) { //(Object.getPrototypeOf(proto[propName]) === Object.prototype)) {\n\t\t\t\t_.defaults(proto[propName], BaseItemProto[propName]);\n\t\t\t\t// console.log(\"BaseItem::extend '%s:%s' is Object\\n%s\", proto._domPrefix, p, JSON.stringify(proto[p]));\n\t\t\t}\n\t\t}\n\t\t// if (proto.properties && this.prototype.properties) {\n\t\t// \t_.defaults(proto.properties, this.prototype.properties);\n\t\t// }\n\t\tconstr = Model.extend.apply(this, arguments);\n\n\t\tif (Array.isArray(constr.prototype.getters)) {\n\t\t\tconstr.prototype.getters.forEach(function(getterName) {\n\t\t\t\tObject.defineProperty(constr.prototype, getterName, {\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tget: function() {\n\t\t\t\t\t\treturn this.get(getterName);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\t// if (_.isObject(proto.properties)) {\n\t\t// \tfor (propName in proto.properties) {\n\t\t// \t\tif (proto.properties.hasOwnProperty(propName)) {\n\t\t// \t\t\tpropDef = proto.properties[propName];\n\t\t// \t\t\tif (_.isFunction(propDef)) {\n\t\t// \t\t\t\tproto.properties[propName] = {\n\t\t// \t\t\t\t\tenumerable: true, get: propDef\n\t\t// \t\t\t\t};\n\t\t// \t\t\t} else if (_.isObject(propDef)){\n\t\t// \t\t\t\tpropDef.enumerable = true;\n\t\t// \t\t\t} else {\n\t\t// \t\t\t\tdelete proto.properties[propName];\n\t\t// \t\t\t}\n\t\t// \t\t}\n\t\t// \t}\n\t\t// \tObject.defineProperties(proto, proto.properties);\n\t\t// \tdelete proto.properties;\n\t\t// }\n\t\treturn constr;\n\t}\n};\n\n/**\n * @constructor\n * @type {module:app/model/BaseItem}\n */\nmodule.exports = BaseItem.extend.call(Model, BaseItemProto, BaseItem);\n// module.exports = Model.extend(BaseItemProto, BaseItem);\n",
    "/**\n * @module app/model/SelectableCollection\n */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n\n/**\n * @constructor\n * @type {module:app/model/SelectableCollection}\n */\nvar SelectableCollection = Backbone.Collection.extend({\n\n\tinitialize: function(models, options) {\n\t\toptions = _.defaults({}, options, {\n\t\t\tinitialSelection: \"none\",\n\t\t\tsilentInitial: true\n\t\t});\n\t\tthis.initialSelection = options.initialSelection;\n\t\tthis.initialOptions = {\n\t\t\tsilent: options.silentInitial\n\t\t};\n\t},\n\n\treset: function(models, options) {\n\t\tthis.deselect(this.initialOptions);\n\t\tBackbone.Collection.prototype.reset.apply(this, arguments);\n\t\tif (this.initialSelection === \"first\" && this.length) {\n\t\t\tthis.select(this.at(0), this.initialOptions);\n\t\t}\n\t},\n\n\tselect: function(newModel, options) {\n\t\tif (newModel === void 0) {\n\t\t\tnewModel = null;\n\t\t}\n\t\tif (this.selected === newModel) {\n\t\t\treturn;\n\t\t}\n\t\tvar triggerEvents = !(options && options.silent);\n\t\tvar oldModel = this.selected;\n\n\t\tthis.lastSelected = this.selected;\n\t\tthis.lastSelectedIndex = this.selectedIndex;\n\t\tthis.selected = newModel;\n\t\tthis.selectedIndex = this.indexOf(newModel);\n\n\t\tif (oldModel) {\n\t\t\tif (_.isFunction(oldModel.deselect)) {\n\t\t\t\toldModel.deselect(options);\n\t\t\t} else if (triggerEvents) {\n\t\t\t\toldModel.selected = void 0;\n\t\t\t\toldModel.trigger(\"deselected\", newModel, oldModel);\n\t\t\t}\n\t\t\tif (triggerEvents) this.trigger(\"deselect:one\", oldModel);\n\t\t} else {\n\t\t\tif (triggerEvents) this.trigger(\"deselect:none\", null);\n\t\t}\n\n\t\tif (newModel) {\n\t\t\tif (_.isFunction(newModel.select)) {\n\t\t\t\tnewModel.select(options);\n\t\t\t} else if (triggerEvents) {\n\t\t\t\tnewModel.selected = true;\n\t\t\t\tnewModel.trigger(\"selected\", newModel, oldModel);\n\t\t\t}\n\t\t\tif (triggerEvents) this.trigger(\"select:one\", newModel);\n\t\t} else {\n\t\t\tif (triggerEvents) this.trigger(\"select:none\", null);\n\t\t}\n\t},\n\n\tdeselect: function(options) {\n\t\tthis.select(null, options);\n\t},\n\n\tselectAt: function(index, options) {\n\t\tif (0 > index || index >= this.length) {\n\t\t\tnew RangeError(\"index is out of bounds\");\n\t\t}\n\t\tthis.select(this.at(index), options);\n\t},\n\n\tdistance: function(a, b) {\n\t\tvar aIdx, bIdx;\n\n\t\tif (!a) return NaN;\n\t\taIdx = this.indexOf(a);\n\t\tif (aIdx == -1) return NaN;\n\n\t\tif (arguments.length == 1) {\n\t\t\tbIdx = this.selectedIndex;\n\t\t} else {\n\t\t\tif (!b) return NaN;\n\t\t\tbIdx = this.indexOf(b);\n\t\t\tif (bIdx == -1) return NaN;\n\t\t}\n\t\treturn Math.abs(bIdx - aIdx);\n\t},\n\n\t/* TODO: MOVE INTO MIXIN */\n\n\t/** @return boolean\t/*/\n\thasFollowing: function(model) {\n\t\tmodel || (model = this.selected);\n\t\treturn this.indexOf(model) < (this.length - 1);\n\t},\n\n\t/** @return next model\t*/\n\tfollowing: function(model) {\n\t\tmodel || (model = this.selected);\n\t\treturn this.hasFollowing(model) ? this.at(this.indexOf(model) + 1) : null;\n\t},\n\n\t/** @return next model or the beginning if at the end */\n\tfollowingOrFirst: function(model) {\n\t\tmodel || (model = this.selected);\n\t\treturn this.at((this.indexOf(model) + 1) % this.length);\n\t},\n\n\t/** @return boolean\t/*/\n\thasPreceding: function(model) {\n\t\tmodel || (model = this.selected);\n\t\treturn this.indexOf(model) > 0;\n\t},\n\n\t/** @return the previous model */\n\tpreceding: function(model) {\n\t\tmodel || (model = this.selected);\n\t\treturn this.hasPreceding(model) ? this.at(this.indexOf(model) - 1) : null;\n\t},\n\n\t/** @return the previous model or the end if at the beginning */\n\tprecedingOrLast: function(model) {\n\t\tmodel || (model = this.selected);\n\t\tvar index = this.indexOf(model) - 1;\n\t\treturn this.at(index > -1 ? index : this.length - 1);\n\t},\n\n});\n\nmodule.exports = SelectableCollection;\n",
    "/**\n * @module app/model/collection/ArticleCollection\n */\n\n/** @type {module:app/model/SelectableCollection} */\nvar SelectableCollection = require(\"app/model/SelectableCollection\");\n\n/** @type {module:app/model/item/ArticleItem} */\nvar ArticleItem = require(\"app/model/item/ArticleItem\");\n\n/**\n * @constructor\n * @type {module:app/model/collection/ArticleCollection}\n */\nvar ArticleCollection = SelectableCollection.extend({\n\n\t/** @type {Backbone.Model} */\n\tmodel: ArticleItem\n\n});\n\nmodule.exports = new ArticleCollection();",
    "/**\n * @module app/model/collection/BundleCollection\n */\n\n/** @type {module:app/model/SelectableCollection} */\nvar SelectableCollection = require(\"app/model/SelectableCollection\");\n\n/** @type {module:app/model/item/BundleItem} */\nvar BundleItem = require(\"app/model/item/BundleItem\");\n\n/**\n * @constructor\n * @type {module:app/model/collection/BundleCollection}\n */\nvar BundleCollection = SelectableCollection.extend({\n\n\t/** @type {Backbone.Model} */\n\tmodel: BundleItem,\n\n\t/** @type {Function} */\n\tcomparator: function(oa, ob) {\n\t\tvar a = oa.get(\"completed\");\n\t\tvar b = ob.get(\"completed\");\n\t\tif (a > b) {\n\t\t\treturn -1;\n\t\t} else if (a < b) {\n\t\t\treturn 1;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t},\n\n\t/** @type {String} */\n\turl: \"/json/bundles/\",\n\n});\n\nmodule.exports = new BundleCollection();\n",
    "/**\n * @module app/model/collection/KeywordCollection\n * @requires module:backbone\n */\n\n/** @type {module:app/model/SelectableCollection} */\nvar SelectableCollection = require(\"app/model/SelectableCollection\");\n\n/** @type {module:app/model/item/KeywordItem} */\nvar KeywordItem = require(\"app/model/item/KeywordItem\");\n\n/**\n * @constructor\n * @type {module:app/model/collection/KeywordCollection}\n */\nvar KeywordCollection = SelectableCollection.extend({\n\n\t/** @type {Backbone.Model} */\n\tmodel: KeywordItem\n\n});\n\nmodule.exports = new KeywordCollection();\n",
    "/**\n * @module app/model/collection/TypeCollection\n * @requires module:backbone\n */\n\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n\n/** @type {module:app/model/item/TypeItem} */\nvar TypeItem = require(\"app/model/item/TypeItem\");\n\n/**\n * @constructor\n * @type {module:app/model/collection/TypeCollection}\n */\nvar TypeCollection = Backbone.Collection.extend({\n\n\t/** @type {Backbone.Model} */\n\tmodel: TypeItem\n\n});\n\nmodule.exports = new TypeCollection();\n",
    "/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n\n/** @type {module:app/model/collection/TypeCollection} */\nvar typeList = require(\"app/model/collection/TypeCollection\");\n/** @type {module:app/model/collection/KeywordCollection} */\nvar keywordList = require(\"app/model/collection/KeywordCollection\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundleList = require(\"app/model/collection/BundleCollection\");\n/** @type {module:app/model/collection/ArticleCollection} */\nvar articleList = require(\"app/model/collection/ArticleCollection\");\n\nmodule.exports = function(bootstrap) {\n\t// Fix-ups to bootstrap data.\n\n\tvar articles = bootstrap[\"articles-all\"];\n\tvar types = bootstrap[\"types-all\"];\n\tvar keywords = bootstrap[\"keywords-all\"];\n\tvar bundles = bootstrap[\"bundles-all\"];\n\tvar media = bootstrap[\"media-all\"];\n\n\t// Attach media to their bundles\n\tvar mediaByBundle = _.groupBy(media, \"bId\");\n\n\t// Fill-in back-references:\n\t// Create Keyword.bundleIds from existing Bundle.keywordIds,\n\t// then Bundle.typeIds from unique Keyword.typeId\n\n\t// _.each(bundles, function (bo, bi, ba) {\n\tbundles.forEach(function(bo, bi, ba) {\n\t\tbo.tIds = [];\n\t\tbo.media = mediaByBundle[bo.id];\n\t\t// _.each(keywords, function (ko, ki, ka) {\n\t\tkeywords.forEach(function(ko, ki, ka) {\n\t\t\tif (bi === 0) {\n\t\t\t\tko.bIds = [];\n\t\t\t}\n\t\t\t// if (_.contains(bo.kIds, ko.id)) {\n\t\t\tif (bo.kIds.indexOf(ko.id) != -1) {\n\t\t\t\tko.bIds.push(bo.id);\n\t\t\t\t// if (!_.contains(bo.tIds, ko.tId)) {\n\t\t\t\tif (bo.tIds.indexOf(ko.tId) == -1) {\n\t\t\t\t\tbo.tIds.push(ko.tId);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\t// Fill collection singletons\\\n\tarticleList.reset(articles);\n\ttypeList.reset(types);\n\tkeywordList.reset(keywords);\n\tbundleList.reset(bundles);\n};",
    "/**\n * @module app/model/item/ArticleItem\n */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:app/model/item/SourceItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n\n/**\n * @constructor\n * @type {module:app/model/item/ArticleItem}\n */\nmodule.exports = BaseItem.extend({\n\n\t_domPrefix: \"a\",\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tname: \"\",\n\t\thandle: \"\",\n\t\ttext: \"\"\n\t},\n\n});",
    "/**\n * @module app/model/item/BundleItem\n * @requires module:backbone\n */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n/** @type {Function} */\nvar Color = require(\"color\");\n\n/** @type {module:app/model/item/SourceItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n/** @type {module:app/model/item/MediaItem} */\nvar MediaItem = require(\"app/model/item/MediaItem\");\n/** @type {module:app/model/SelectableCollection} */\nvar SelectableCollection = require(\"app/model/SelectableCollection\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/utils/strings/stripTags} */\nvar stripTags = require(\"utils/strings/stripTags\");\n// /** @type {module:app/utils/strings/parseTaglist} */\n// var parseSymAttrs = require(\"app/model/parseSymAttrs\");\n\n// /** @type {module:app/model/collection/KeywordCollection} */\n// var keywords = require(\"app/model/collection/KeywordCollection\");\n\n// Globals.DEFAULT_COLORS[\"color\"];\n// Globals.DEFAULT_COLORS[\"background-color\"];\nvar attrsDefault = _.defaults({\n\t\"has-colors\": \"defaults\"\n}, Globals.DEFAULT_COLORS);\n\n/** @private */\nvar MediaCollection = SelectableCollection.extend({\n\tmodel: MediaItem,\n\tcomparator: \"o\"\n});\n\n/**\n * @constructor\n * @type {module:app/model/item/BundleItem}\n */\nmodule.exports = BaseItem.extend({\n\n\t_domPrefix: \"b\",\n\n\t/** @type {Object|Function} */\n\t// defaults: function() {\n\t// \treturn {\n\t// \t\tname: \"\",\n\t// \t\thandle: \"\",\n\t// \t\tdesc: \"\",\n\t// \t\tcompleted: 0,\n\t// \t\tkIds: [],\n\t// \t};\n\t// },\n\tdefaults: {\n\t\tname: \"\",\n\t\thandle: \"\",\n\t\tdesc: \"\",\n\t\tcompleted: 0,\n\t\tget kIds() {\n\t\t\treturn [];\n\t\t},\n\t\t// get keywords() { return []; },\n\t},\n\n\tgetters: [\"name\", \"media\"],\n\n\tmutators: {\n\t\ttext: function() {\n\t\t\treturn stripTags(this.get(\"desc\"));\n\t\t},\n\t\t// kIds: {\n\t\t// \tset: function (key, value, options, set) {\n\t\t// \t\tif (Array.isArray(value)) {\n\t\t// \t\t\tset(\"keywords\", value.map(function(id) {\n\t\t// \t\t\t\tvar obj = keywords.get(id);\n\t\t// \t\t\t\treturn obj;\n\t\t// \t\t\t}, this), options;\n\t\t// \t\t}\n\t\t// \t\tset(key, value, options);\n\t\t// \t},\n\t\t// },\n\t\tmedia: {\n\t\t\ttransient: true,\n\t\t\tset: function(key, value, options, set) {\n\t\t\t\tif (Array.isArray(value)) {\n\t\t\t\t\tvalue.forEach(function(o) {\n\t\t\t\t\t\to.bundle = this;\n\t\t\t\t\t}, this);\n\t\t\t\t\tvalue = new MediaCollection(value);\n\t\t\t\t}\n\t\t\t\tset(key, value, options);\n\t\t\t},\n\t\t},\n\t},\n\n\tinitialize: function(attrs, options) {\n\t\tthis.colors = {\n\t\t\tfgColor: new Color(this.attr(\"color\")),\n\t\t\tbgColor: new Color(this.attr(\"background-color\")),\n\t\t\tlnColor: new Color(this.attr(\"--link-color\")),\n\t\t};\n\t\tthis.colors.hasDarkBg = this.colors.fgColor.luminosity() > this.colors.bgColor.luminosity();\n\t},\n\n\tattrs: function() {\n\t\treturn this._attrs || (this._attrs = _.defaults({}, this.get(\"attrs\"), attrsDefault));\n\t},\n});\n",
    "/**\n * @module app/model/item/KeywordItem\n * @requires module:app/model/BaseItem\n */\n\n/** @type {module:app/model/BaseItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n\n// /** @type {module:app/model/collection/TypeCollection} */\n// var types = require(\"app/model/collection/TypeCollection\");\n\n/**\n * @constructor\n * @type {module:app/model/item/KeywordItem}\n */\nmodule.exports = BaseItem.extend({\n\n\t_domPrefix: \"k\",\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tname: \"\",\n\t\thandle: \"\",\n\t\ttId: -1,\n\t},\n\n\t// mutators: {\n\t// \ttId: {\n\t// \t\tset: function (key, value, options, set) {\n\t// \t\t\tvar type = types.get(value);\n\t// \t\t\tif (type) {\n\t// \t\t\t\ttype.get(\"keywords\").push(this);\n\t// \t\t\t\tset(\"type\", type, options);\n\t// \t\t\t}\n\t// \t\t\tset(key, value, options);\n\t// \t\t}\n\t// \t},\n\t// }\n});\n",
    "/**\n * @module app/model/item/MediaItem\n * @requires module:backbone\n */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n/** @type {Function} */\nvar Color = require(\"color\");\n\n/** @type {module:app/model/item/SourceItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n/** @type {module:app/model/item/SourceItem} */\nvar SourceItem = require(\"app/model/item/SourceItem\");\n/** @type {module:app/model/SelectableCollection} */\nvar SelectableCollection = require(\"app/model/SelectableCollection\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/utils/strings/stripTags} */\nvar stripTags = require(\"utils/strings/stripTags\");\n// /** @type {module:app/model/parseSymAttrs} */\n// var parseSymAttrs = require(\"app/model/parseSymAttrs\");\n\nvar urlTemplates = {\n\t\"original\": _.template(Globals.MEDIA_DIR + \"/<%= src %>\"),\n\t\"constrain-width\": _.template(Globals.APP_ROOT + \"image/1/<%= width %>/0/uploads/<%= src %>\"),\n\t\"constrain-height\": _.template(Globals.APP_ROOT + \"image/1/0/<%= height %>/uploads/<%= src %>\"),\n\t\"debug-bandwidth\": _.template(Globals.MEDIA_DIR.replace(/(https?\\:\\/\\/[^\\/]+)/, \"$1/slow/<%= kbps %>\") + \"/<%= src %>\"),\n};\n\n/**\n * @constructor\n * @type {module:app/model/item/MediaItem.SourceCollection}\n */\nvar SourceCollection = SelectableCollection.extend({\n\tmodel: SourceItem\n});\n\n/**\n * @constructor\n * @type {module:app/model/item/MediaItem}\n */\nmodule.exports = BaseItem.extend({\n\n\t_domPrefix: \"m\",\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tname: \"<p><em>Untitled</em></p>\",\n\t\tsub: \"\",\n\t\to: 0,\n\t\tbId: -1,\n\t\tsrcIdx: 0,\n\t\tget srcset() {\n\t\t\treturn [];\n\t\t},\n\t\tget sources() {\n\t\t\treturn new SourceCollection();\n\t\t},\n\t},\n\n\tgetters: [\"name\", \"bundle\", \"source\", \"sources\"],\n\n\tmutators: {\n\t\t// desc: function() {\n\t\t// \treturn this.get(\"name\");\n\t\t// },\n\t\thandle: function() {\n\t\t\treturn this.get(\"src\");\n\t\t},\n\t\ttext: function() {\n\t\t\tif (!this.hasOwnProperty(\"_text\"))\n\t\t\t\tthis._text = _.unescape(stripTags(this.get(\"name\")));\n\t\t\treturn this._text;\n\t\t},\n\t\tattrs: {\n\t\t\tset: function(key, value, opts, set) {\n\t\t\t\tthis._attrs = null;\n\t\t\t\tBaseItem.prototype.mutators.attrs.set.apply(this, arguments);\n\t\t\t\tthis._updateSources();\n\t\t\t}\n\t\t},\n\t\tsrcset: {\n\t\t\tset: function(key, value, opts, set) {\n\t\t\t\tset(key, value, opts);\n\t\t\t\tthis.get(\"sources\").reset(value, opts);\n\t\t\t\tthis._updateSources();\n\t\t\t}\n\t\t},\n\t\tsource: {\n\t\t\ttransient: true,\n\t\t\tget: function() {\n\t\t\t\treturn this.get(\"sources\").at(this.get(\"srcIdx\"));\n\t\t\t},\n\t\t},\n\t},\n\n\tinitialize: function() {\n\t\tthis._updateColors();\n\t\tthis.listenTo(this, \"change:attrs change:bundle\", function() {\n\t\t\tthis._attrs = null;\n\t\t});\n\t},\n\n\tattrs: function() {\n\t\treturn this._attrs || (this._attrs = _.defaults({}, this.get(\"bundle\").attrs(), this.get(\"attrs\")));\n\t},\n\n\t_updateColors: function() {\n\t\tthis.colors = {\n\t\t\tfgColor: new Color(this.attr(\"color\")),\n\t\t\tbgColor: new Color(this.attr(\"background-color\"))\n\t\t};\n\t\tthis.colors.hasDarkBg = this.colors.fgColor.luminosity() > this.colors.bgColor.luminosity();\n\t},\n\n\t_updateSources: function() {\n\t\tvar srcObj = {\n\t\t\tkbps: this.attr(\"@debug-bandwidth\")\n\t\t};\n\t\tvar srcTpl = urlTemplates[srcObj.kbps ? \"debug-bandwidth\" : \"original\"];\n\t\tthis.get(\"sources\").forEach(function(item) {\n\t\t\tsrcObj.src = item.get(\"src\");\n\t\t\titem.set(\"original\", srcTpl(srcObj));\n\t\t});\n\t},\n\n\t// _updateSourcesArr: function() {\n\t// \tvar srcset = this.get(\"srcset\");\n\t// \tif (Array.isArray(srcset)) {\n\t// \t\tvar srcObj = { kbps: this.attr(\"@debug-bandwidth\") };\n\t// \t\tvar srcTpl = Globals.MEDIA_SRC_TPL[srcObj.kbps? \"debug-bandwidth\" : \"original\"];\n\t// \t\tsrcset.forEach(function(o) {\n\t// \t\t\tsrcObj.src = o.src;\n\t// \t\t\to.original = srcTpl(srcObj);\n\t// \t\t}, this);\n\t// \t}\n\t// \tthis.get(\"sources\").reset(srcset);\n\t// },\n\n});",
    "/**\n * @module app/model/item/SourceItem\n * @requires module:backbone\n */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n// /** @type {module:app/control/Globals} */\n// var Globals = require(\"app/control/Globals\");\n/** @type {module:app/model/item/SourceItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n\n/** @type {String} */\nvar noCacheSuffix = \"?\" + Date.now();\n\n/**\n * @constructor\n * @type {module:app/model/item/SourceItem}\n */\n// module.exports = Backbone.Model.extend({\nmodule.exports = BaseItem.extend({\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tsrc: null,\n\t\tmime: null,\n\t\tw: null,\n\t\th: null,\n\t},\n\n\tgetters: [\"src\", \"original\"],\n\n\tmutators: {\n\t\tsrc: {\n\t\t\tset: function(key, value, options, set) {\n\t\t\t\tif (DEBUG) {\n\t\t\t\t\tvalue += noCacheSuffix;\n\t\t\t\t}\n\t\t\t\tset(key, value, options);\n\t\t\t}\n\t\t},\n\t\t// original: { \n\t\t// \ttransient: true,\n\t\t// \tget: function (key, value, options, set) {\n\t\t// \t\treturn this.attributes.original || (this.attributes.original = this._composeOriginalSrc());\n\t\t// \t},\n\t\t// },\n\t\t// media: {\n\t\t// \ttransient: true,\n\t\t// \tget: function () {\n\t\t// \t\tvar retval;\n\t\t// \t\tif (this._noRecusion) {\n\t\t// \t\t\tconsole.log(\"%s::media returning null\", this.cid);\n\t\t// \t\t\tretval = null;//this.id;\n\t\t// \t\t} else {\n\t\t// \t\t\tconsole.log(\"%s::media returning Object\", this.cid);\n\t\t// \t\t\tthis._noRecusion = true;\n\t\t// \t\t\tretval = this.attributes.media;\n\t\t// \t\t\tthis._noRecusion = false;\n\t\t// \t\t}\n\t\t// \t\treturn retval;\n\t\t// \t},\n\t\t// \tset: function (key, value, options, set) {\n\t\t// \t\tif (value instanceof BaseItem) {\n\t\t// \t\t\tset(key, value, options);\n\t\t// \t\t}\n\t\t// \t},\n\t\t// },\n\t},\n\n\t// initialize: function() {\n\t// \tif (DEBUG) {\n\t// \t\tvar cb = function() {\n\t// \t\t\t// console.log(\"@debug-bandwidth:\", JSON.stringify(this.get(\"media\").attr(\"@debug-bandwidth\")));\n\t// \t\t\tconsole.log(\"media:\", JSON.stringify(this.toJSON()));\n\t// \t\t\t// if ((this.get(\"media\") instanceof BaseItem) && this.get(\"media\").attr(\"@debug-bandwidth\")) {\n\t// \t\t\t// \tconsole.log(\"original\", this.get(\"original\"));\n\t// \t\t\t// \tconsole.log(\"media:\", JSON.stringify(this.get(\"media\").toJSON()));\n\t// \t\t\t// }\n\t// \t\t}.bind(this);\n\t// \t\twindow.requestAnimationFrame(cb);\n\t// \t}\n\t// },\n\t// \n\t// _composeOriginalSrc: function() {\n\t// \tvar values = { src: this.get(\"src\") };\n\t// \tif (this.has(\"media\") && (values.kbps = this.get(\"media\").attr(\"@debug-bandwidth\"))) {\n\t// \t// if (this.has(\"media\") && this.get(\"media\").attrs().hasOwnProperty(\"@debug-bandwidth\")) {\n\t// \t// \tvalues.kbps = this.get(\"media\").attrs()[\"@debug-bandwidth\"];\n\t// \t\treturn Globals.MEDIA_SRC_TPL[\"debug-bandwidth\"](values);\n\t// \t}\n\t// \treturn Globals.MEDIA_SRC_TPL[\"original\"](values);\n\t// },\n});\n",
    "/**\n * @module app/model/item/TypeItem\n */\n\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:app/model/item/SourceItem} */\nvar BaseItem = require(\"app/model/BaseItem\");\n\n/**\n * @constructor\n * @type {module:app/model/item/TypeItem}\n */\nmodule.exports = BaseItem.extend({\n\n\t_domPrefix: \"t\",\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tname: \"\",\n\t\thandle: \"\",\n\t\t// get kIds() { return []; },\n\t\t// get keywords() { return []; },\n\t},\n\n});\n",
    "/**\n/* @module app/view/AppView\n/*/\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n// /** @type {Function} */\n// var Color = require(\"color\");\n\n/** @type {module:app/utils/debug/traceArgs} */\nvar stripTags = require(\"utils/strings/stripTags\");\n// /** @type {Function} */\n// var prefixedProperty = require(\"utils/prefixedProperty\");\n// /** @type {Function} */\n// var prefixedEvent = require(\"utils/prefixedEvent\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/view/base/TouchManager} */\nvar TouchManager = require(\"app/view/base/TouchManager\");\n/** @type {module:app/control/Controller} */\nvar controller = require(\"app/control/Controller\");\n/** @type {module:app/model/AppState} */\nvar AppState = require(\"app/model/AppState\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundles = require(\"app/model/collection/BundleCollection\");\n/** @type {module:app/model/collection/ArticleCollection} */\nvar articles = require(\"app/model/collection/ArticleCollection\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/NavigationView} */\nvar NavigationView = require(\"app/view/NavigationView\");\n/** @type {module:app/view/ContentView} */\nvar ContentView = require(\"app/view/ContentView\");\n\nvar AppView = {\n\tgetInstance: function() {\n\t\tif (!(window.app instanceof this)) {\n\t\t\twindow.app = new(this)({\n\t\t\t\tmodel: new AppState()\n\t\t\t});\n\t\t}\n\t\treturn window.app;\n\t}\n};\n\nvar AppViewProto = {\n\n\t/** @override */\n\tcidPrefix: \"app\",\n\t/** @override */\n\tel: \"body\",\n\t/** @override */\n\tclassName: \"without-bundle without-media\",\n\t/** @override */\n\tmodel: AppState,\n\n\t/** @override */\n\tevents: {\n\t\t\"visibilitychange\": function(ev) {\n\t\t\tconsole.log(ev.type);\n\t\t},\n\t\t\"fullscreenchange\": function(ev) {\n\t\t\tconsole.log(ev.type);\n\t\t},\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t/* create single hammerjs manager */\n\t\tthis.touch = TouchManager.init(this.el);\n\n\t\t/* render on resize, onorientationchange, visibilitychange */\n\t\tthis._onResize = this._onResize.bind(this); // _.bindAll(this, \"_onResize\");\n\t\twindow.addEventListener(\"orientationchange\", this._onResize, false);\n\t\twindow.addEventListener(\"resize\", _.debounce(this._onResize, 100, false /* immediate? */ ), false);\n\n\t\t/* TODO: replace resize w/ mediaquery listeners. Caveat: some components\n\t\t(vg. Carousel) require update on resize */\n\t\t// this._onBreakpointChange = this._onBreakpointChange.bind(this);\n\t\t// Object.keys(Globals.BREAKPOINTS).forEach(function(s) {\n\t\t// \tGlobals.BREAKPOINTS[s].addListener(this._onBreakpointChange);\n\t\t// }, this);\n\n\t\t/* initialize controller/model listeners BEFORE views register their own */\n\t\tthis.listenTo(controller, \"route\", this._onRoute);\n\t\t// this.listenTo(controller, \"change:after\", this._afterControllerChanged);\n\t\tthis.listenTo(this.model, \"change\", this._onModelChange); /* FIXME */\n\n\t\t/* initialize views */\n\t\tthis.navigationView = new NavigationView({\n\t\t\tel: \"#navigation\",\n\t\t\tmodel: this.model\n\t\t});\n\t\tthis.contentView = new ContentView({\n\t\t\tel: \"#content\",\n\t\t\tmodel: this.model\n\t\t});\n\n\t\t/* Google Analytics */\n\t\tif (window.ga) {\n\t\t\tcontroller\n\t\t\t\t.once(\"route\", function() {\n\t\t\t\t\twindow.ga(\"create\", window.GA_ID, \"auto\");\n\t\t\t\t\tif (/(?:(localhost|\\.local))$/.test(location.hostname))\n\t\t\t\t\t\twindow.ga(\"set\", \"sendHitTask\", null);\n\t\t\t\t})\n\t\t\t\t.on(\"route\", function(name) {\n\t\t\t\t\tvar page = Backbone.history.getFragment();\n\t\t\t\t\t// Add a slash if neccesary\n\t\t\t\t\tpage.replace(/^(?!\\/)/, \"/\");\n\t\t\t\t\t// if (!/^\\//.test(page)) page = \"/\" + page;\n\t\t\t\t\twindow.ga(\"set\", \"page\", page);\n\t\t\t\t\twindow.ga(\"send\", \"pageview\");\n\t\t\t\t});\n\t\t}\n\n\t\t/* Startup listener, added last */\n\t\tthis.listenToOnce(controller, \"route\", this._appStart);\n\n\t\t/* start router, which will request appropiate state */\n\t\tBackbone.history.start({\n\t\t\tpushState: false,\n\t\t\thashChange: true,\n\t\t\t// root: Globals.APP_ROOT.match(/(?:https?\\:\\/\\/[^\\/]+(.*))/)[1]\n\t\t});\n\t\t// this.listenTo(this.model, \"change\", this._onModelChange);\n\t},\n\n\t/* -------------------------------\n\t/* _appStart\n\t/* ------------------------------- */\n\n\t_appStart: function() {\n\t\tconsole.info(\"%s::_appStart\", this.cid, arguments[0]);\n\t\tthis._appStartChanged = true;\n\t\tthis.requestRender(View.MODEL_INVALID | View.SIZE_INVALID);\n\t},\n\n\t/* --------------------------- *\n\t/* model changed\n\t/* --------------------------- */\n\n\t_onRoute: function(name, args) {\n\t\tvar o = _.defaults({ routeName: name }, AppState.prototype.defaults);\n\t\tswitch (name) {\n\t\t\tcase \"media-item\":\n\t\t\t\to.bundle = bundles.selected;\n\t\t\t\to.withBundle = true;\n\t\t\t\to.media = o.bundle.media.selected;\n\t\t\t\to.withMedia = true;\n\t\t\t\to.collapsed = true;\n\t\t\t\tbreak;\n\t\t\tcase \"bundle-item\":\n\t\t\t\to.bundle = bundles.selected;\n\t\t\t\to.withBundle = true;\n\t\t\t\to.collapsed = true;\n\t\t\t\tbreak;\n\t\t\tcase \"article-item\":\n\t\t\t\to.article = articles.selected;\n\t\t\t\to.withArticle = true;\n\t\t\t\to.collapsed = true;\n\t\t\t\tbreak;\n\t\t\tcase \"bundle-list\":\n\t\t\tcase \"notfound\":\n\t\t\tcase \"root\":\n\t\t\tdefault:\n\t\t\t\to.collapsed = false;\n\t\t\t\tbreak;\n\t\t}\n\t\tconsole.info(\"%s::_onRoute %o -> %o\", this.cid, this.model.get(\"routeName\"), name);\n\t\tthis.model.set(o);\n\t},\n\n\t/* --------------------------- *\n\t/* model changed\n\t/* --------------------------- */\n\n\t_onModelChange: function() {\n\t\t// if (this.model.hasChanged(\"bundle\")\n\t\t// \t|| this.model.hasChanged(\"media\")\n\t\t// \t|| this.model.hasChanged(\"article\")\n\t\t// \t|| this.model.hasChanged(\"routeName\")) {\n\t\tthis.requestRender(View.MODEL_INVALID);\n\t\t// }\n\t},\n\n\t/* -------------------------------\n\t/* resize\n\t/* ------------------------------- */\n\n\t_onResize: function() {\n\t\tconsole.log(\"%s::_onResize\", this.cid);\n\t\tthis.requestRender(View.SIZE_INVALID).renderNow();\n\t},\n\n\t// _onBreakpointChange: function(ev) {\n\t// \tconsole.log(\"%s::_onBreakpointChange\", this.cid, ev.matches, ev.media, ev.target.className);\n\t// \tthis.requestRender(View.SIZE_INVALID).renderNow();\n\t// },\n\n\t/* -------------------------------\n\t/* render\n\t/* ------------------------------- */\n\n\trenderFrame: function(tstamp, flags) {\n\t\tif (flags & View.MODEL_INVALID) {\n\t\t\tthis.renderModelChange();\n\t\t}\n\t\tif (flags & View.SIZE_INVALID) {\n\t\t\tthis.renderResize();\n\t\t}\n\t\tif (this._appStartChanged) {\n\t\t\tthis._appStartChanged = false;\n\t\t\tthis.requestAnimationFrame(this.renderAppStart);\n\t\t}\n\t},\n\n\trenderAppStart: function() {\n\t\tconsole.log(\"%s::renderAppStart\", this.cid);\n\t\t// document.documentElement.classList.remove(\"app-initial\");\n\t\tthis.el.classList.remove(\"app-initial\");\n\t\tif (this.el.classList.contains(\"route-initial\")) {\n\t\t\tthis.el.classList.remove(\"route-initial\");\n\t\t\tdocument.documentElement.appendChild(\n\t\t\t\tdocument.createComment(\"'route-initial' was still present\"));\n\t\t}\n\t\t// document.documentElement.classList.add(\"app-ready\");\n\t},\n\n\trenderResize: function() {\n\t\tdocument.body.scrollTop = 0;\n\t\t_.each(Globals.BREAKPOINTS, function(o, s) {\n\t\t\tthis.toggle(s, o.matches);\n\t\t}, document.documentElement.classList);\n\n\t\t// var bb = _.filter(_.keys(Globals.BREAKPOINTS), function(s) {\n\t\t// \treturn this.contains(s);\n\t\t// }, document.body.classList).join();\n\t\t// console.log(\"%s::renderResize matches: %s\", this.cid, bb);\n\n\t\tthis.requestChildrenRender(View.SIZE_INVALID, true);\n\t},\n\n\t/* -------------------------------\n\t/* body classes etc\n\t/* ------------------------------- */\n\n\t// _controllerChanged: true,\n\n\trenderModelChange: function() {\n\t\tconsole.log(\"%s::renderModelChange\", this.cid);\n\n\t\tvar article = this.model.get(\"article\");\n\t\tvar bundle = this.model.get(\"bundle\");\n\t\tvar media = this.model.get(\"media\");\n\n\t\t// \tthis.updateDocumentTitle(bundle, media);\n\t\t// \tthis.updateClassList(bundle, media);\n\t\t// },\n\t\t//\n\t\t// updateDocumentTitle: function(bundle, media) {\n\t\t// Set browser title\n\t\tvar docTitle = \"Portfolio\";\n\t\tif (bundle) {\n\t\t\tdocTitle += \" - \" + stripTags(bundle.get(\"name\"));\n\t\t\tif (media) {\n\t\t\t\tdocTitle += \": \" + stripTags(media.get(\"name\"));\n\t\t\t}\n\t\t} else if (article) {\n\t\t\tdocTitle += \" - \" + stripTags(article.get(\"name\"));\n\t\t}\n\t\tdocument.title = _.unescape(docTitle);\n\t\t// },\n\t\t//\n\t\t// updateClassList: function(bundle, media) {\n\t\t// classList target\n\t\tvar cls = this.el.classList;\n\t\tvar prevAttr = null;\n\t\t// var hasDarkBg = false;\n\n\t\t// Set article class\n\t\tif (this.model.hasChanged(\"article\")) {\n\t\t\tprevAttr = this.model.previous(\"article\");\n\t\t\tif (prevAttr) {\n\t\t\t\tcls.remove(prevAttr.get(\"domid\"));\n\t\t\t}\n\t\t\tif (article) {\n\t\t\t\tcls.add(article.get(\"domid\"));\n\t\t\t\t// hasDarkBg = hasDarkBg || bundle.colors.hasDarkBg;\n\t\t\t}\n\t\t}\n\t\tcls.toggle(\"with-article\", !!article);\n\t\tcls.toggle(\"without-article\", !article);\n\n\t\t// Set bundle class\n\t\tif (this.model.hasChanged(\"bundle\")) {\n\t\t\tprevAttr = this.model.previous(\"bundle\");\n\t\t\tif (prevAttr) {\n\t\t\t\tcls.remove(prevAttr.get(\"domid\"));\n\t\t\t}\n\t\t\tif (bundle) {\n\t\t\t\tcls.add(bundle.get(\"domid\"));\n\t\t\t\t// hasDarkBg = hasDarkBg || bundle.colors.hasDarkBg;\n\t\t\t}\n\t\t}\n\t\tcls.toggle(\"with-bundle\", !!bundle);\n\t\tcls.toggle(\"without-bundle\", !bundle);\n\n\t\t// Set media class\n\t\tif (this.model.hasChanged(\"media\")) {\n\t\t\tprevAttr = this.model.previous(\"media\");\n\t\t\tif (prevAttr) {\n\t\t\t\tcls.remove(prevAttr.get(\"domid\"));\n\t\t\t}\n\t\t\tif (media) {\n\t\t\t\tcls.add(media.get(\"domid\"));\n\t\t\t\t// hasDarkBg = hasDarkBg || media.colors.hasDarkBg;\n\t\t\t}\n\t\t}\n\t\tcls.toggle(\"with-media\", !!media);\n\t\tcls.toggle(\"without-media\", !media);\n\n\t\t// Set state classes\n\t\tif (this.model.hasChanged(\"routeName\")) {\n\t\t\tprevAttr = this.model.previous(\"routeName\");\n\t\t\tif (prevAttr) {\n\t\t\t\tcls.remove(\"route-\" + prevAttr);\n\t\t\t}\n\t\t\tcls.add(\"route-\" + this.model.get(\"routeName\"));\n\t\t}\n\n\t\t// Set color-dark class\n\t\t// cls.toggle(\"color-dark\", hasDarkBg);\n\t\tcls.toggle(\"color-dark\",\n\t\t\t(media && media.colors.hasDarkBg) ||\n\t\t\t(bundle && bundle.colors.hasDarkBg));\n\t},\n};\n\nif (DEBUG) {\n\t/** @type {module:app/view/DebugToolbar} */\n\tvar DebugToolbar = require(\"app/view/DebugToolbar\");\n\n\tAppViewProto._onModelChange = (function(fn) {\n\t\treturn function() {\n\t\t\tconsole.group(this.cid + \"::_onModelChange changed:\");\n\t\t\tObject.keys(this.model.changedAttributes()).forEach(function(key) {\n\t\t\t\tvar prev = this.model.previous(key),\n\t\t\t\t\tcurr = this.model.get(key);\n\t\t\t\tconsole.info(\"%s::_onModelChange %s: %s -> %s\", this.cid, key,\n\t\t\t\t\tprev && prev.toString(),\n\t\t\t\t\tcurr && curr.toString());\n\t\t\t}, this);\n\t\t\tconsole.groupEnd();\n\t\t\treturn fn.apply(this, arguments);\n\t\t};\n\t})(AppViewProto._onModelChange);\n\n\tAppViewProto.initialize = (function(fn) {\n\t\treturn function() {\n\t\t\t// var ret = fn.apply(this, arguments);\n\t\t\tvar view = new DebugToolbar({\n\t\t\t\tid: \"debug-toolbar\",\n\t\t\t\tmodel: this.model\n\t\t\t});\n\t\t\tthis.el.appendChild(view.render().el);\n\t\t\t// this.listenTo(this.model, \"change:layoutName\", function() {\n\t\t\t// \tthis.requestRender(View.SIZE_INVALID); //.renderNow();\n\t\t\t// });\n\t\t\t// return ret;\n\t\t\treturn fn.apply(this, arguments);\n\t\t};\n\t})(AppViewProto.initialize);\n}\n\n/**\n/* @constructor\n/* @type {module:app/view/AppView}\n/*/\nmodule.exports = View.extend(AppViewProto, AppView);",
    "/**\n * @module app/view/NavigationView\n */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:utils/TransformHelper} */\nvar TransformHelper = require(\"utils/TransformHelper\");\n/** @type {module:app/view/base/TouchManager} */\nvar TouchManager = require(\"app/view/base/TouchManager\");\n\n/** @type {module:app/control/Controller} */\nvar controller = require(\"app/control/Controller\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundles = require(\"app/model/collection/BundleCollection\");\n/** @type {module:app/model/collection/ArticleCollection} */\nvar articles = require(\"app/model/collection/ArticleCollection\");\n\n// /** @type {module:app/model/collection/BundleItem} */\n// var BundleItem = require(\"app/model/item/BundleItem\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/component/ArticleView} */\nvar ArticleView = require(\"app/view/component/ArticleView\");\n/** @type {module:app/view/component/CollectionStack} */\nvar CollectionStack = require(\"app/view/component/CollectionStack\");\n/** @type {module:app/view/component/CollectionStack} */\nvar SelectableListView = require(\"app/view/component/SelectableListView\");\n/** @type {module:app/view/render/DotNavigationRenderer} */\nvar DotNavigationRenderer = require(\"app/view/render/DotNavigationRenderer\");\n/** @type {module:app/view/component/Carousel} */\nvar Carousel = require(\"app/view/component/Carousel\");\n\n/** @type {module:app/view/render/CarouselRenderer} */\nvar CarouselRenderer = require(\"app/view/render/CarouselRenderer\");\n/** @type {module:app/view/render/ImageRenderer} */\nvar ImageRenderer = require(\"app/view/render/ImageRenderer\");\n/** @type {module:app/view/render/VideoRenderer} */\nvar VideoRenderer = require(\"app/view/render/VideoRenderer\");\n/** @type {module:app/view/render/SequenceRenderer} */\nvar SequenceRenderer = require(\"app/view/render/SequenceRenderer\");\n// /** @type {module:app/view/component/ProgressMeter} */\n// var ProgressMeter = require(\"app/view/component/ProgressMeter\");\n\n/** @type {Function} */\nvar carouselEmptyTemplate = require(\"./template/Carousel.EmptyRenderer.Bundle.hbs\");\n/** @type {Function} */\nvar mediaStackTemplate = require(\"./template/CollectionStack.Media.hbs\");\n\n// var transitionEnd = View.prefixedEvent(\"transitionend\");\nvar transformProp = View.prefixedProperty(\"transform\");\nvar transitionProp = View.prefixedProperty(\"transition\");\n\nvar tx = Globals.transitions;\n\n/**\n * @constructor\n * @type {module:app/view/ContentView}\n */\nvar ContentView = View.extend({\n\n\t/** @override */\n\tcidPrefix: \"contentView\",\n\n\t/** @override */\n\tclassName: \"container-x container-expanded\",\n\n\t/** @override */\n\tevents: {\n\t\t\"transitionend .adding-child\": \"_onAddedTransitionEnd\",\n\t\t\"transitionend .removing-child\": \"_onRemovedTransitionEnd\",\n\t\t// \"transitionend\": \"_onTransitionEnd\",\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t_.bindAll(this, \"_onVPanStart\", \"_onVPanMove\", \"_onVPanFinal\", \"_onCollapsedEvent\");\n\n\t\tthis.transforms = new TransformHelper();\n\t\tthis.touch = TouchManager.getInstance();\n\n\t\tthis.listenTo(this.model, \"change\", this._onModelChange);\n\n\t\t// disconnect children before last change\n\t\t// this.listenTo(bundles, \"deselect:one\", this._onDeselectOneBundle);\n\n\t\tthis.skipTransitions = true;\n\t\tthis.itemViews = [];\n\n\t\t// this.progressWrapper = this.createProgressWrapper(),\n\t\t// this.el.appendChild(this.progressWrapper.el);\n\t},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\trenderFrame: function(tstamp, flags) {\n\t\t// values\n\t\tvar collapsed = this.model.get(\"collapsed\");\n\t\tvar collapsedChanged = (flags & View.MODEL_INVALID)\n\t\t\t&& this.model.hasChanged(\"collapsed\");\n\t\tvar childrenChanged = (flags & View.MODEL_INVALID)\n\t\t\t&& (this.model.hasChanged(\"bundle\") || this.model.hasChanged(\"article\"));\n\n\t\t// flags\n\t\tvar sizeChanged = !!(flags & View.SIZE_INVALID);\n\t\tvar transformsChanged = !!(flags & (View.MODEL_INVALID | View.SIZE_INVALID | View.LAYOUT_INVALID));\n\t\ttransformsChanged = transformsChanged || this._transformsChanged || this.skipTransitions;\n\n\t\t// debug\n\t\t// - - - - - - - - - - - - - - - - -\n\t\t// if (flags & View.MODEL_INVALID) {\n\t\t// \tconsole.group(this.cid + \"::renderFrame model changed:\");\n\t\t// \tObject.keys(this.model.changed).forEach(function(key) {\n\t\t// \t\tconsole.log(\"\\t%s: %s -> %s\", key, this.model._previousAttributes[key], this.model.changed[key]);\n\t\t// \t}, this);\n\t\t// \tconsole.groupEnd();\n\t\t// }\n\n\t\t// model:children\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tif (childrenChanged) {\n\t\t\tthis.removeChildren();\n\t\t\tif (bundles.selected) {\n\t\t\t\tthis.createChildren(bundles.selected);\n\t\t\t} else\n\t\t\tif (articles.selected) {\n\t\t\t\tthis.createChildren(articles.selected);\n\t\t\t}\n\t\t}\n\n\t\t// model:collapsed\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tif (collapsedChanged) {\n\t\t\tthis.el.classList.toggle(\"container-collapsed\", collapsed);\n\t\t\tthis.el.classList.toggle(\"container-expanded\", !collapsed);\n\t\t}\n\n\t\t// size\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tif (sizeChanged) {\n\t\t\tthis.transforms.clearAllCaptures();\n\t\t}\n\n\t\t// transforms\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tif (transformsChanged) {\n\t\t\tthis.el.classList.remove(\"container-changing\");\n\t\t\tif (this.skipTransitions) {\n\t\t\t\tthis.transforms.stopAllTransitions();\n\t\t\t\tthis.el.classList.remove(\"container-changed\");\n\t\t\t\tif (!childrenChanged) {\n\t\t\t\t\t// this.transforms.clearAllOffsets();\n\t\t\t\t\tif (collapsedChanged) {\n\t\t\t\t\t\tthis._setChildrenEnabled(collapsed);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!childrenChanged) {\n\t\t\t\t\tif (collapsedChanged) {\n\t\t\t\t\t\tvar afterTransitionsFn;\n\t\t\t\t\t\tthis.el.classList.add(\"container-changed\");\n\t\t\t\t\t\t// this.transforms.clearAllOffsets();\n\t\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\t\t// container-collapsed, enable last\n\t\t\t\t\t\t\tafterTransitionsFn = function() {\n\t\t\t\t\t\t\t\tthis._setChildrenEnabled(true);\n\t\t\t\t\t\t\t\tthis.el.classList.remove(\"container-changed\");\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tthis.transforms.runAllTransitions(tx.LAST);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// container-expanded, disable first\n\t\t\t\t\t\t\tafterTransitionsFn = function() {\n\t\t\t\t\t\t\t\tthis.el.classList.remove(\"container-changed\");\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tthis._setChildrenEnabled(false);\n\t\t\t\t\t\t\tthis.transforms.runAllTransitions(tx.FIRST);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tafterTransitionsFn = afterTransitionsFn.bind(this);\n\t\t\t\t\t\tthis.transforms.whenAllTransitionsEnd().then(afterTransitionsFn, afterTransitionsFn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.transforms.items.forEach(function(o) {\n\t\t\t\t\t\t\tif (o.hasOffset) {\n\t\t\t\t\t\t\t\to.runTransition(tx.NOW);\n\t\t\t\t\t\t\t\t// o.clearOffset();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!childrenChanged) {\n\t\t\t\tthis.transforms.clearAllOffsets();\n\t\t\t}\n\t\t\tthis.transforms.validate();\n\t\t}\n\t\tif (sizeChanged) {\n\t\t\tthis.itemViews.forEach(function(view) {\n\t\t\t\tview.skipTransitions = this.skipTransitions;\n\t\t\t\t// view.invalidateSize();\n\t\t\t\t// view.renderNow();\n\t\t\t\tview.requestRender(View.SIZE_INVALID).renderNow();\n\t\t\t}, this);\n\t\t}\n\t\tthis.skipTransitions = this._transformsChanged = false;\n\t},\n\n\t_setChildrenEnabled: function(enabled) {\n\t\t// if (enabled) {\n\t\t// \tthis.el.removeEventListener(\"click\", this._onCollapsedClick, false);\n\t\t// } else {\n\t\t// \tthis.el.addEventListener(\"click\", this._onCollapsedClick, false);\n\t\t// }\n\t\tthis.itemViews.forEach(function(view) {\n\t\t\tview.setEnabled(enabled);\n\t\t});\n\t},\n\n\t_onCollapsedEvent: function(ev) {\n\t\tconsole.log(\"%s:[%s -> _onCollapsedEvent] target: %s\", this.cid, ev.type, ev.target);\n\t\tif (!ev.defaultPrevented && this.model.get(\"withBundle\") && !this.model.get(\"collapsed\") && !this.enabled) {\n\t\t\t// this.setImmediate(function() {\n\t\t\t// if (ev.type == \"click\") ev.stopPropagation();\n\t\t\tev.preventDefault();\n\t\t\tthis.setImmediate(function() {\n\t\t\t\t// if (ev.type == \"click\") ev.stopPropagation();\n\t\t\t\tthis.model.set(\"collapsed\", true);\n\t\t\t});\n\t\t\t// });\n\t\t}\n\t},\n\t/* --------------------------- *\n\t/* model changed\n\t/* --------------------------- */\n\n\t_onModelChange: function() {\n\t\tif (this.model.hasChanged(\"withBundle\")) {\n\t\t\tif (this.model.get(\"withBundle\")) {\n\t\t\t\tthis.touch.on(\"vpanstart\", this._onVPanStart);\n\t\t\t} else {\n\t\t\t\tthis.touch.off(\"vpanstart\", this._onVPanStart);\n\t\t\t}\n\t\t}\n\t\tif (this.model.hasChanged(\"collapsed\") || this.model.hasChanged(\"withBundle\")) {\n\t\t\tif (this.model.get(\"withBundle\") && !this.model.get(\"collapsed\")) {\n\t\t\t\tthis.touch.on(\"hpanleft hpanright\", this._onCollapsedEvent);\n\t\t\t\tthis.el.addEventListener(\"click\", this._onCollapsedEvent, false);\n\t\t\t} else {\n\t\t\t\tthis.touch.off(\"hpanleft hpanright\", this._onCollapsedEvent);\n\t\t\t\tthis.el.removeEventListener(\"click\", this._onCollapsedEvent, false);\n\t\t\t}\n\t\t}\n\t\tthis.requestRender(View.MODEL_INVALID);\n\t},\n\n\t/* -------------------------------\n\t/* Vertical touch/move (_onVPan*)\n\t/* ------------------------------- */\n\n\t_collapsedOffsetY: Globals.COLLAPSE_OFFSET,\n\n\t_onVPanStart: function(ev) {\n\t\tthis.touch.on(\"vpanmove\", this._onVPanMove);\n\t\tthis.touch.on(\"vpanend vpancancel\", this._onVPanFinal);\n\n\t\tthis.transforms.stopAllTransitions();\n\t\t// this.transforms.clearAllOffsets();\n\t\t// this.transforms.validate();\n\t\tthis.transforms.clearAllCaptures();\n\n\t\tthis.el.classList.add(\"container-changing\");\n\t\tthis._onVPanMove(ev);\n\t},\n\n\t_onVPanMove: function(ev) {\n\t\tvar collapsed = this.model.get(\"collapsed\");\n\t\tvar delta = ev.deltaY; //ev.thresholdDeltaY;\n\t\tvar maxDelta = this._collapsedOffsetY; // + Math.abs(ev.thresholdOffsetY);\n\n\t\t// check if direction is aligned with collapsed/expand\n\t\tvar isValidDir = collapsed ? (delta > 0) : (delta < 0);\n\t\tvar moveFactor = collapsed ? Globals.VPAN_DRAG : 1 - Globals.VPAN_DRAG;\n\n\t\tdelta = Math.abs(delta); // remove sign\n\t\tdelta *= moveFactor;\n\t\tmaxDelta *= moveFactor;\n\n\t\tif (isValidDir) {\n\t\t\tif (delta > maxDelta) { // overshooting\n\t\t\t\tdelta = ((delta - maxDelta) * Globals.VPAN_OUT_DRAG) + maxDelta;\n\t\t\t} else { // no overshooting\n\t\t\t\t// delta = delta;\n\t\t\t}\n\t\t} else {\n\t\t\tdelta = (-delta) * Globals.VPAN_OUT_DRAG; // delta is opposite\n\t\t}\n\t\tdelta *= collapsed ? 1 : -1; // reapply sign\n\n\t\tthis.transforms.offsetAll(0, delta);\n\t\tthis.transforms.validate();\n\t},\n\n\t_onVPanFinal: function(ev) {\n\t\tthis.touch.off(\"vpanmove\", this._onVPanMove);\n\t\tthis.touch.off(\"vpanend vpancancel\", this._onVPanFinal);\n\n\t\t// FIXME: model.collapsed may have already changed, _onVPanMove would run with wrong values:\n\t\t// model.collapsed is changed in a setImmediate callback from NavigationView.\n\n\t\tthis._onVPanMove(ev);\n\t\tthis.setImmediate(function() {\n\t\t\tthis._transformsChanged = true;\n\t\t\tthis.requestRender();\n\t\t});\n\t},\n\n\t// willCollapsedChange: function(ev) {\n\t// \tvar collapsed = this.model.get(\"collapsed\");\n\t// \treturn ev.type == \"vpanend\"? collapsed?\n\t// \t\tev.thresholdDeltaY > Globals.COLLAPSE_THRESHOLD :\n\t// \t\tev.thresholdDeltaY < -Globals.COLLAPSE_THRESHOLD :\n\t// \t\tfalse;\n\t// },\n\n\t/* -------------------------------\n\t/* create/remove children on bundle selection\n\t/* ------------------------------- */\n\n\t/** Create children on bundle select */\n\tcreateChildren: function(model) {\n\t\tvar view;\n\t\tif (model.__proto__.constructor === bundles.model) {\n\t\t\t// will be attached to dom in this order\n\t\t\tview = this.createMediaCaptionStack(model);\n\t\t\tthis.itemViews.push(view);\n\t\t\tthis.transforms.add(view.el);\n\t\t\tview = this.createMediaCarousel(model);\n\t\t\tthis.itemViews.push(view);\n\t\t\tthis.transforms.add(view.el);\n\t\t\tview = this.createMediaDotNavigation(model);\n\t\t\tthis.itemViews.push(view);\n\t\t} else\n\t\tif (model.__proto__.constructor === articles.model) {\n\t\t\tview = this.createArticleView(model);\n\t\t\tthis.itemViews.push(view);\n\t\t}\n\n\t\tthis.itemViews.forEach(function(view) {\n\t\t\tif (!this.skipTransitions) {\n\t\t\t\tview.el.classList.add(\"adding-child\");\n\t\t\t\tview.el.style.opacity = 0;\n\t\t\t}\n\t\t\tthis.el.appendChild(view.el);\n\t\t\tview.render();\n\t\t}, this);\n\n\t\tif (!this.skipTransitions) {\n\t\t\tthis.requestAnimationFrame(function() {\n\t\t\t\tconsole.log(\"%s::createChildren::[callback:requestAnimationFrame]\", this.cid);\n\t\t\t\tthis.itemViews.forEach(function(view) {\n\t\t\t\t\tif (!this.skipTransitions) {\n\t\t\t\t\t\tview.el.style[transitionProp] = \"opacity \" + tx.LAST.cssText;\n\t\t\t\t\t}\n\t\t\t\t\tview.el.style.removeProperty(\"opacity\");\n\t\t\t\t}, this);\n\t\t\t});\n\t\t}\n\t},\n\n\tremoveChildren: function() {\n\t\tthis.itemViews.forEach(function(view, i, arr) {\n\t\t\tthis.transforms.remove(view.el);\n\t\t\tif (this.skipTransitions) {\n\t\t\t\tview.remove();\n\t\t\t} else {\n\t\t\t\tvar s = window.getComputedStyle(view.el);\n\t\t\t\tif (s.opacity == \"0\" || s.visibility == \"hidden\") {\n\t\t\t\t\tconsole.log(\"%s::removeChildren [view:%s] removed immediately (invisible)\", this.cid, view.cid);\n\t\t\t\t\tview.remove();\n\t\t\t\t} else {\n\t\t\t\t\tview.el.classList.add(\"removing-child\");\n\t\t\t\t\tif (s[transformProp]) view.el.style[transformProp] = s[transformProp];\n\t\t\t\t\tview.el.style[transitionProp] = \"opacity \" + tx.FIRST.cssText;\n\t\t\t\t\tview.el.style.opacity = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tarr[i] = null;\n\t\t}, this);\n\t\tthis.itemViews.length = 0;\n\t},\n\n\t_onAddedTransitionEnd: function(ev) {\n\t\tif (ev.target.cid && this.childViews.hasOwnProperty(ev.target.cid)) {\n\t\t\tconsole.log(\"%s::_onAddedTransitionEnd [view:%s] [prop:%s] [ev:%s]\", this.cid, ev.target.cid, ev.propertyName, ev.type);\n\t\t\tvar view = this.childViews[ev.target.cid];\n\t\t\tview.el.classList.remove(\"adding-child\");\n\t\t\tview.el.style.removeProperty(transitionProp);\n\t\t}\n\t},\n\n\t_onRemovedTransitionEnd: function(ev) {\n\t\tif (ev.target.cid && this.childViews.hasOwnProperty(ev.target.cid)) {\n\t\t\tconsole.log(\"%s::_onRemovedTransitionEnd [view:%s] [prop:%s] [ev:%s]\", this.cid, ev.target.cid, ev.propertyName, ev.type);\n\t\t\tvar view = this.childViews[ev.target.cid];\n\t\t\tview.el.classList.remove(\"removing-child\");\n\t\t\tview.remove();\n\t\t}\n\t},\n\n\t// purgeChildren: function() {\n\t// \tvar i, el, els = this.el.querySelectorAll(\".removing-child\");\n\t// \tfor (i = 0; i < els.length; i++) {\n\t// \t\tel = els.item(i);\n\t// \t\tif (el.parentElement === this.el) {\n\t// \t\t\ttry {\n\t// \t\t\t\tconsole.error(\"%s::purgeChildren\", this.cid, el.getAttribute(\"data-cid\"));\n\t// \t\t\t\tView.findByElement(el).remove();\n\t// \t\t\t} catch (err) {\n\t// \t\t\t\tconsole.error(\"s::purgeChildren\", this.cid, \"orphaned element\", err);\n\t// \t\t\t\tthis.el.removeChild(el);\n\t// \t\t\t}\n\t// \t\t}\n\t// \t}\n\t// },\n\n\t/* -------------------------------\n\t/* Components\n\t/* ------------------------------- */\n\n\n\t/**\n\t * media-carousel\n\t */\n\tcreateMediaCarousel: function(bundle) {\n\t\t// Create carousel\n\t\tvar EmptyRenderer = CarouselRenderer.extend({\n\t\t\tclassName: \"carousel-item empty-item\",\n\t\t\tmodel: bundle,\n\t\t\ttemplate: carouselEmptyTemplate,\n\t\t});\n\t\tvar rendererFunction = function(item, index, arr) {\n\t\t\tif (index === -1) {\n\t\t\t\treturn EmptyRenderer;\n\t\t\t}\n\t\t\tswitch (item.attr(\"@renderer\")) {\n\t\t\t\tcase \"video\":\n\t\t\t\t\treturn VideoRenderer;\n\t\t\t\tcase \"sequence\":\n\t\t\t\t\treturn SequenceRenderer;\n\t\t\t\tcase \"image\":\n\t\t\t\t\treturn ImageRenderer;\n\t\t\t\tdefault:\n\t\t\t\t\treturn ImageRenderer;\n\t\t\t}\n\t\t};\n\t\tvar view = new Carousel({\n\t\t\tclassName: \"media-carousel \" + bundle.get(\"domid\"),\n\t\t\tcollection: bundle.get(\"media\"),\n\t\t\trendererFunction: rendererFunction,\n\t\t\trequireSelection: false,\n\t\t\tdirection: Carousel.DIRECTION_HORIZONTAL,\n\t\t\ttouch: this.touch,\n\t\t});\n\t\tcontroller.listenTo(view, {\n\t\t\t\"view:select:one\": controller.selectMedia,\n\t\t\t\"view:select:none\": controller.deselectMedia,\n\t\t\t// \"view:removed\": controller.stopListening\n\t\t});\n\t\tview.listenTo(bundle, \"deselected\", function() {\n\t\t\tthis.stopListening(this.collection);\n\t\t\tcontroller.stopListening(this);\n\t\t});\n\t\treturn view;\n\t},\n\n\t/**\n\t * media-caption-stack\n\t */\n\tcreateMediaCaptionStack: function(bundle) {\n\t\tvar view = new CollectionStack({\n\t\t\tclassName: \"media-caption-stack\",\n\t\t\tcollection: bundle.get(\"media\"),\n\t\t\ttemplate: mediaStackTemplate\n\t\t});\n\t\tview.listenTo(bundle, \"deselected\", function() {\n\t\t\tthis.stopListening(this.collection);\n\t\t});\n\t\treturn view;\n\t},\n\n\t/**\n\t * media-dotnav\n\t */\n\tcreateMediaDotNavigation: function(bundle) {\n\t\tvar view = new SelectableListView({\n\t\t\tclassName: \"media-dotnav dots-fontface color-fg05\",\n\t\t\tcollection: bundle.get(\"media\"),\n\t\t\trenderer: DotNavigationRenderer\n\t\t});\n\t\tcontroller.listenTo(view, {\n\t\t\t\"view:select:one\": controller.selectMedia,\n\t\t\t\"view:select:none\": controller.deselectMedia,\n\t\t\t// \"view:removed\": controller.stopListening\n\t\t});\n\t\tview.listenTo(bundle, \"deselected\", function() {\n\t\t\tthis.stopListening(this.collection);\n\t\t\tcontroller.stopListening(this);\n\t\t});\n\t\treturn view;\n\t},\n\n\t/**\n\t * @param el {module:app/model/item/ArticleView}\n\t * @return {module:app/view/base/View}\n\t */\n\tcreateArticleView: function(article) {\n\t\tvar view = new ArticleView({\n\t\t\tmodel: article,\n\t\t});\n\t\treturn view;\n\t},\n\n\t// createProgressWrapper: function() {\n\t// \t// var view = new ProgressMeter({\n\t// \t// \tid: \"media-progress-wrapper\",\n\t// \t// \t// className: \"color-bg color-fg05\",\n\t// \t// \tuseOpaque: false,\n\t// \t// \tlabelFn: function() { return \"0%\"; }\n\t// \t// });\n\t// \t// this.el.appendChild(this.progressWrapper.el);\n\t// \t// return view;\n\t// \treturn null;\n\t// },\n});\n\nmodule.exports = ContentView;",
    "/**\n * @module app/view/DebugToolbar\n */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:cookies-js} */\nvar Cookies = require(\"cookies-js\");\n// /** @type {module:modernizr} */\n// var Modernizr = require(\"Modernizr\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n// /** @type {module:app/control/Controller} */\n// var controller = require(\"app/control/Controller\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n\n/** @type {Function} */\nvar viewTemplate = require(\"./template/DebugToolbar.hbs\");\n\n/** @type {Function} */\nvar sizeTemplate = _.template(\"<%= w %> \\u00D7 <%= h %>\");\n\n// var appStateSymbols = { withBundle: \"b\", withMedia: \"m\", collapsed: \"c\"};\n// var appStateKeys = Object.keys(appStateSymbols);\n\nvar DebugToolbar = View.extend({\n\n\t/** @override */\n\tcidPrefix: \"debugToolbar\",\n\t/** @override */\n\ttagName: \"div\",\n\t/** @override */\n\tclassName: \"toolbar\",\n\t/** @override */\n\ttemplate: viewTemplate,\n\n\tinitialize: function(options) {\n\t\tCookies.defaults = {\n\t\t\texpires: new Date(0x7fffffff * 1e3),\n\t\t\tdomain: String(window.location)\n\t\t\t\t.match(/^https?\\:\\/\\/([^\\/:?#]+)(?:[\\/:?#]|$)/i)[1]\n\t\t};\n\n\t\tthis.el.innerHTML = this.template({\n\t\t\ttests: Modernizr,\n\t\t\tnavigator: window.navigator\n\t\t});\n\n\t\t/* toggle's target: container\n\t\t/* - - - - - - - - - - - - - - - - */\n\t\tvar container = document.body.querySelector(\"#container\");\n\n\t\t/* info elements\n\t\t/* - - - - - - - - - - - - - - - - */\n\t\tthis.backendEl = this.el.querySelector(\"#edit-backend a\");\n\t\tthis.mediaInfoEl = this.el.querySelector(\"#media-info span\");\n\t\tthis.appStateEl = this.el.querySelector(\"#app-state\");\n\n\t\t/* toggle visibility\n\t\t\t\t/* - - - - - - - - - - - - - - - - */\n\t\tthis.initializeClassToggle(\"show-links\", this.el.querySelector(\".debug-links #links-toggle\"), this.el);\n\t\tthis.initializeClassToggle(\"show-tests\", this.el.querySelector(\"#toggle-tests a\"), this.el);\n\t\tthis.initializeClassToggle(\"hide-passed\", this.el.querySelector(\"#toggle-passed\"), this.el);\n\n\t\t/* toggle container classes\n\t\t/* - - - - - - - - - - - - - - - - */\n\t\tthis.initializeClassToggle(\"debug-grid-bg\", this.el.querySelector(\"#toggle-grid-bg a\"), container);\n\t\tthis.initializeClassToggle(\"debug-blocks\", this.el.querySelector(\"#toggle-blocks a\"), container);\n\t\tthis.initializeClassToggle(\"debug-markdown\", this.el.querySelector(\"#toggle-markdown a\"), container);\n\t\tthis.initializeClassToggle(\"debug-logs\", this.el.querySelector(\"#toggle-logs a\"), container);\n\t\tthis.initializeClassToggle(\"debug-tx\", this.el.querySelector(\"#toggle-tx a\"), container,\n\t\t\tfunction(key, value) {\n\t\t\t\tthis.el.classList.toggle(\"show-tx\", value);\n\t\t\t}\n\t\t);\n\n\t\tthis.initializeViewportInfo();\n\n\t\t// this.initializeLayoutSelect();\n\n\t\tthis.listenTo(this.model, \"change\", this._onModelChange);\n\t\tthis._onModelChange();\n\t},\n\n\tinitializeViewportInfo: function() {\n\t\tvar viewportInfoEl = this.el.querySelector(\"#viewport-info span\");\n\t\tvar callback = function() {\n\t\t\tviewportInfoEl.textContent = sizeTemplate({ w: window.innerWidth, h: window.innerHeight });\n\t\t};\n\t\tcallback.call();\n\t\twindow.addEventListener(\"resize\", _.debounce(callback, 100, false, false));\n\t},\n\n\tinitializeToggle: function(key, toggleEl, callback) {\n\t\tvar ctx = this;\n\t\tvar toggleValue = Cookies.get(key) === \"true\";\n\t\tcallback.call(ctx, key, toggleValue);\n\n\t\ttoggleEl.addEventListener(\"click\", function(ev) {\n\t\t\tif (ev.defaultPrevented) return;\n\t\t\telse ev.preventDefault();\n\t\t\ttoggleValue = !toggleValue;\n\t\t\tCookies.set(key, toggleValue ? \"true\" : \"\");\n\t\t\tcallback.call(ctx, key, toggleValue);\n\t\t}, false);\n\t},\n\n\tinitializeClassToggle: function(key, toggleEl, targetEl, callback) {\n\t\tvar hasCallback = _.isFunction(callback);\n\n\t\tthis.initializeToggle(key, toggleEl, function(key, toggleValue) {\n\t\t\ttargetEl.classList.toggle(key, toggleValue);\n\t\t\ttoggleEl.classList.toggle(\"toggle-enabled\", toggleValue);\n\t\t\ttoggleEl.classList.toggle(\"color-reverse\", toggleValue);\n\t\t\thasCallback && callback.apply(this, arguments);\n\t\t});\n\t},\n\n\t_onModelChange: function() {\n\t\tconsole.log(\"%s::_onModelChange changedAttributes: %o\", this.cid, this.model.changedAttributes());\n\t\tvar i, ii, prop, el, els = this.appStateEl.children;\n\t\tfor (i = 0, ii = els.length; i < ii; i++) {\n\t\t\tel = els[i];\n\t\t\tprop = el.getAttribute(\"data-prop\");\n\t\t\tel.classList.toggle(\"has-value\", this.model.get(prop));\n\t\t\tel.classList.toggle(\"has-changed\", this.model.hasChanged(prop));\n\t\t\tel.classList.toggle(\"color-reverse\", this.model.hasChanged(prop));\n\t\t}\n\t\tif (this.model.hasChanged(\"routeName\")) {\n\t\t\tvar attrVal = Globals.APP_ROOT + \"symphony/\";\n\t\t\tswitch (this.model.get(\"routeName\")) {\n\t\t\t\tcase \"article-item\":\n\t\t\t\t\tattrVal += \"publish/articles/edit/\" + this.model.get(\"article\").id;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"bundle-item\":\n\t\t\t\t\tattrVal += \"publish/bundles/edit/\" + this.model.get(\"bundle\").id;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"media-item\":\n\t\t\t\t\tattrVal += \"publish/media/edit/\" + this.model.get(\"media\").id;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"root\":\n\t\t\t\t\tattrVal += \"publish/bundles\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.backendEl.setAttribute(\"href\", attrVal);\n\t\t}\n\t\tif (this.model.hasChanged(\"media\")) {\n\t\t\tif (this.model.has(\"media\")) {\n\t\t\t\tthis.mediaInfoEl.textContent = sizeTemplate(this.model.get(\"media\").get(\"source\").toJSON());\n\t\t\t\tthis.mediaInfoEl.style.display = \"\";\n\t\t\t} else {\n\t\t\t\tthis.mediaInfoEl.textContent = \"\";\n\t\t\t\tthis.mediaInfoEl.style.display = \"none\";\n\t\t\t}\n\t\t}\n\t},\n});\n\nmodule.exports = DebugToolbar;",
    "/* global MutationObserver */\n/**\n/* @module app/view/NavigationView\n/*/\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:hammerjs} */\nvar Hammer = require(\"hammerjs\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:utils/TransformHelper} */\nvar TransformHelper = require(\"utils/TransformHelper\");\n/** @type {module:app/view/base/TouchManager} */\nvar TouchManager = require(\"app/view/base/TouchManager\");\n\n/** @type {module:app/control/Controller} */\nvar controller = require(\"app/control/Controller\");\n/** @type {module:app/model/collection/TypeCollection} */\nvar types = require(\"app/model/collection/TypeCollection\");\n/** @type {module:app/model/collection/KeywordCollection} */\nvar keywords = require(\"app/model/collection/KeywordCollection\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundles = require(\"app/model/collection/BundleCollection\");\n/** @type {module:app/model/collection/ArticleCollection} */\nvar articles = require(\"app/model/collection/ArticleCollection\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/component/FilterableListView} */\nvar FilterableListView = require(\"app/view/component/FilterableListView\");\n/** @type {module:app/view/component/GroupingListView} */\nvar GroupingListView = require(\"app/view/component/GroupingListView\");\n// /** @type {module:app/view/component/CollectionPager} */\n// var CollectionPager = require(\"app/view/component/CollectionPager\");\n/** @type {module:app/view/component/GraphView} */\nvar GraphView = require(\"app/view/component/GraphView\");\n/** @type {module:app/view/component/ArticleButton} */\nvar ArticleButton = require(\"app/view/component/ArticleButton\");\n\n// /** @type {module:utils/prefixedProperty} */\n// var prefixedProperty = require(\"utils/prefixedProperty\");\n\nvar tx = Globals.transitions;\n\n/**\n/* @constructor\n/* @type {module:app/view/NavigationView}\n/*/\nvar NavigationView = View.extend({\n\n\t/** @override */\n\tcidPrefix: \"navigationView\",\n\n\t/** @override */\n\tclassName: \"container-expanded\",\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t_.bindAll(this, \"_onVPanStart\", \"_onVPanMove\", \"_onVPanFinal\");\n\t\t_.bindAll(this, \"_onHPanStart\", \"_onHPanMove\", \"_onHPanFinal\");\n\t\t_.bindAll(this, \"_whenTransitionsEnd\", \"_whenTransitionsAbort\");\n\t\t_.bindAll(this, \"_onNavigationClick\");\n\n\t\tthis.itemViews = [];\n\t\tthis.transforms = new TransformHelper();\n\t\tthis.touch = TouchManager.getInstance();\n\n\t\tthis.listenTo(this.model, \"change\", this._onModelChange);\n\n\t\tthis.keywordList = this.createKeywordList();\n\t\t/* NOTE: .list-group .label moves horizontally (cf. sass/layouts/*.scss) */\n\t\tthis.hGroupings = this.keywordList.el.querySelectorAll(\".list-group .label\");\n\t\tthis.transforms.add(this.hGroupings, this.keywordList.el, this.keywordList.wrapper);\n\t\tthis.itemViews.push(this.keywordList);\n\n\t\tthis.bundleList = this.createBundleList();\n\t\tthis.transforms.add(this.bundleList.el, this.bundleList.wrapper);\n\t\tthis.itemViews.push(this.bundleList);\n\n\t\tthis.sitename = this.createSitenameButton();\n\t\tthis.transforms.add(this.sitename.wrapper, this.sitename.el);\n\t\t// this.transforms.add(this.sitename.el.firstElementChild, this.sitename.el);\n\n\t\tthis.about = this.createArticleButton(articles.findWhere({ handle: \"about\" }));\n\t\tthis.transforms.add(this.about.wrapper, this.about.el);\n\n\t\tthis.graph = this.createGraphView(this.bundleList, this.keywordList);\n\t\t// this.transforms.add(this.graph.el);\n\t\t// this.itemViews.push(this.graph);\n\t\t// this.listenTo(this.graph, {\n\t\t// \t\"canvas:update\": this._onGraphUpdate,\n\t\t// \t\"canvas:redraw\": this._onGraphRedraw,\n\t\t// });\n\n\t\tthis.listenTo(this.graph, \"view:render:before\", function(view, flags) {\n\t\t\t// console.info(\"%s:[%s view:render:before]\", this.cid, view.cid);\n\t\t\tif (flags & View.SIZE_INVALID | View.MODEL_INVALID) {\n\t\t\t\tconsole.info(\"%s:[%s view:render:before] heights: %s %s (bundleList,keywordList)\",\n\t\t\t\t\tthis.cid, view.cid,\n\t\t\t\t\tthis.bundleList._metrics.height,\n\t\t\t\t\tthis.keywordList._metrics.height\n\t\t\t\t);\n\t\t\t\tthis.graph.el.style.height = Math.max(\n\t\t\t\t\tthis.bundleList._metrics.height,\n\t\t\t\t\tthis.keywordList._metrics.height\n\t\t\t\t) + \"px\";\n\t\t\t\t// this.graph.el.style.opacity = this.bundleList.collapsed? \"0\": \"1\";\n\t\t\t\t// view.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();\n\t\t\t}\n\t\t});\n\t\t// this.listenTo(this.bundleList, \"view:render:after\", function(view, flags) {\n\t\t// \tconsole.info(\"%s:[view:render:after %s]\", this.cid, view.cid, View.flagsToString(flags & View.SIZE_INVALID));\n\t\t// \t\tif (flags & View.SIZE_INVALID) {\n\t\t// \t\t\t// console.info(\"%s:[%s view:render:after] bundleList height\", this.cid, view.cid, this.bundleList.el.style.height);\n\t\t// \t\t\t// this.graph.el.style.height = this.bundleList.el.style.height;\n\t\t// \t\t\tthis.graph.el.style.opacity = this.bundleList.collapsed? 0 : 1;\n\t\t// \t\t\tthis.graph.requestRender(View.SIZE_INVALID).renderNow();\n\t\t// \t// \t}\n\t\t// });\n\t\t// this.listenTo(this.bundleList, \"view:render:after\", this._onListResize);\n\t\t// this.listenTo(this.keywordList, \"view:render:after\", this._onListResize);\n\t},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\trenderFrame: function(tstamp, flags) {\n\t\tif (flags & View.MODEL_INVALID) {\n\t\t\tif (this.model.hasChanged(\"collapsed\")) {\n\t\t\t\tthis.el.classList.toggle(\"container-collapsed\", this.model.get(\"collapsed\"));\n\t\t\t\tthis.el.classList.toggle(\"container-expanded\", !this.model.get(\"collapsed\"));\n\t\t\t}\n\t\t\tif (this.model.hasChanged(\"collapsed\")\n\t\t\t\t|| this.model.hasChanged(\"withBundle\")) {\n\t\t\t\tthis.el.classList.add(\"container-changing\");\n\t\t\t}\n\t\t\tif (this.model.hasChanged(\"bundle\")) {\n\t\t\t\tthis.bundleList.requestRender(View.SIZE_INVALID);\n\t\t\t\tthis.keywordList.requestRender(View.SIZE_INVALID);\n\t\t\t}\n\t\t}\n\n\t\t// transforms\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tif (this.skipTransitions ||\n\t\t\t(flags & (View.MODEL_INVALID | View.SIZE_INVALID | View.LAYOUT_INVALID))) {\n\t\t\t// if (transformsChanged) {\n\t\t\tif (this.skipTransitions) {\n\t\t\t\tthis.transforms.stopAllTransitions();\n\t\t\t\tthis.transforms.validate();\n\t\t\t\tthis.transforms.clearAllOffsets();\n\t\t\t} else {\n\t\t\t\tthis.renderTransitions(flags);\n\t\t\t}\n\t\t\tthis.transforms.validate();\n\t\t\t// console.log(\"%s::renderFrame %o\", this.cid,\n\t\t\t// \tthis.transforms.items.map(function(o) {\n\t\t\t// \t\treturn [o.hasTransition, o.el.localName, o.el.id || o.el.className].join(\" : \");\n\t\t\t// \t})\n\t\t\t// );\n\t\t}\n\n\t\tif (flags & View.MODEL_INVALID) {\n\t\t\t// if (this.model.hasChanged(\"collapsed\")) {\n\t\t\t//if ((this.model.hasChanged(\"collapsed\") && !this.model.get(\"collapsed\")) || (this.model.hasChanged(\"withBundle\") && !this.model.get(\"withBundle\"))) {\n\t\t\tif (this.model.hasChanged(\"collapsed\")\n\t\t\t\t|| this.model.hasChanged(\"withBundle\")\n\t\t\t\t|| this.model.hasChanged(\"withArticle\")) {\n\t\t\t\tthis.transforms.promise().then(this._whenTransitionsEnd, this._whenTransitionsAbort);\n\t\t\t}\n\t\t}\n\n\t\t// children loop\n\t\t// - - - - - - - - - - - - - - - - -\n\t\tthis.itemViews.forEach(function(view) {\n\t\t\tview.skipTransitions = view.skipTransitions || this.skipTransitions;\n\t\t\tif (flags & View.SIZE_INVALID) {\n\t\t\t\tview.requestRender(View.SIZE_INVALID);\n\t\t\t}\n\t\t\tif (!view.skipTransitions) {\n\t\t\t\tview.renderNow();\n\t\t\t}\n\t\t}, this);\n\n\t\t// graph\n\t\t// - - - - - - - - - - - - - - - - -\n\t\t/* collapsed has not changed, no bundle selected */\n\t\tif ((flags & (View.SIZE_INVALID | ~View.MODEL_INVALID))\n\t\t\t&& !this.model.hasChanged(\"collapsed\")\n\t\t\t&& !this.model.get(\"withBundle\")) {\n\t\t\tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);\n\t\t\tif (!this.skipTransitions) {\n\t\t\t\tthis.graph.renderNow();\n\t\t\t}\n\t\t}\n\t\t/* NavigationView has resized while uncollapsed,\n\t\t   but model is unchanged */\n\t\telse if ((flags & View.SIZE_INVALID) && !this.model.get(\"collapsed\")) {\n\t\t\t// console.info(\"%s::renderFrame\", this.cid, \"NavigationView has resized\");\n\t\t\tthis.graph.requestRender(View.SIZE_INVALID);\n\t\t}\n\t\tthis.skipTransitions = false;\n\t},\n\n\t_whenTransitionsEnd: function(result) {\n\t\tconsole.info(\"%s::_whenTransitionsEnd\", this.cid);\n\t\tthis.el.classList.remove(\"container-changing\");\n\t\tif (Globals.BREAKPOINTS[\"desktop-small\"].matches\n\t\t\t|| !this.model.get(\"collapsed\")) {\n\t\t\tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();\n\t\t}\n\t},\n\n\t_whenTransitionsAbort: function(reason) {\n\t\tconsole.warn(\"%s::_whenTransitionsAbort %o\", this.cid, reason);\n\t\tthis.el.classList.remove(\"container-changing\");\n\t\tif (Globals.BREAKPOINTS[\"desktop-small\"].matches\n\t\t\t|| !this.model.get(\"collapsed\")) {\n\t\t\tthis.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* renderTransitions\n\t/* ------------------------------- */\n\n\trenderTransitions: function(flags) {\n\t\tvar fromRoute = this.model.previous(\"routeName\");\n\t\tvar toRoute = this.model.get(\"routeName\");\n\n\t\tvar modelChanged = (flags & View.MODEL_INVALID);\n\t\t/* bundle */\n\t\tvar withBundle = this.model.get(\"withBundle\");\n\t\tvar withBundleChanged = modelChanged && this.model.hasChanged(\"withBundle\");\n\t\tvar bundleChanged = modelChanged && this.model.hasChanged(\"bundle\");\n\t\t/* media */\n\t\tvar withMedia = this.model.get(\"withMedia\");\n\t\tvar withMediaChanged = modelChanged && this.model.hasChanged(\"withMedia\");\n\t\t//var mediaChanged = modelChanged && this.model.hasChanged(\"media\");\n\t\t/* collapsed */\n\t\tvar collapsed = this.model.get(\"collapsed\");\n\t\tvar collapsedChanged = modelChanged && this.model.hasChanged(\"collapsed\");\n\t\t/* article */\n\t\t// var withArticle = this.model.get(\"withArticle\");\n\t\tvar withArticleChanged = modelChanged && this.model.hasChanged(\"withArticle\");\n\n\t\tvar tf;\n\t\t/* this.bundleList.el */\n\t\ttf = this.transforms.get(this.bundleList.el);\n\t\tif (tf.hasOffset) {\n\t\t\ttf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);\n\t\t}\n\t\t/* this.keywordList.el */\n\t\ttf = this.transforms.get(this.keywordList.el);\n\t\tif (tf.hasOffset) {\n\t\t\ttf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);\n\t\t}\n\t\t/* this.graph.el */\n\t\ttf = this.transforms.get(this.graph.el);\n\t\tif (tf && tf.hasOffset) {\n\t\t\ttf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);\n\t\t\ttf.clearOffset();\n\t\t}\n\n\t\t/*\n\t\t * NOTE:\n\t\t * Vertical:\n\t\t *\t\tsite-name-wrapper,\n\t\t *\t\tarticle-list-wrapper\n\t\t * Horizontal:\n\t\t *\t\tsite-name,\n\t\t *\t\tarticle-buttons,\n\t\t *\t\tkeywordList.wrapper,\n\t\t *\t\tbundleList.wrapper,\n\t\t *\t\thGroupings\n\t\t */\n\t\tif (Globals.BREAKPOINTS[\"desktop-small\"].matches) {\n\t\t\t/* HORIZONTAL */\n\t\t\ttf = this.transforms.get(this.keywordList.wrapper);\n\t\t\tif (collapsedChanged && !withArticleChanged) {\n\t\t\t\t// if (collapsedChanged) {\n\t\t\t\tif (withBundleChanged) {\n\t\t\t\t\tif (withMediaChanged)\n\t\t\t\t\t\ttf.runTransition(withBundle ? tx.LAST : tx.FIRST);\n\t\t\t\t} else {\n\t\t\t\t\tif (withMedia)\n\t\t\t\t\t\ttf.runTransition(collapsed ? tx.LAST : tx.FIRST);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!withBundleChanged && withMediaChanged)\n\t\t\t\t\ttf.runTransition(bundleChanged ? tx.BETWEEN : tx.NOW);\n\t\t\t}\n\t\t\tif (collapsedChanged ^ withArticleChanged) {\n\t\t\t\tthis.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST,\n\t\t\t\t\tthis.sitename.el, this.about.el, this.bundleList.wrapper, this.hGroupings);\n\t\t\t}\n\t\t\t/* VERTICAL */\n\t\t\tif (fromRoute == 'root' || toRoute == 'root') {\n\t\t\t\tthis.transforms.runTransition(tx.BETWEEN,\n\t\t\t\t\tthis.sitename.wrapper, this.about.wrapper);\n\t\t\t}\n\t\t\t/* this.hGroupings */\n\t\t\t// if (collapsedChanged ^ withArticleChanged) {\n\t\t\t// \t// if (collapsedChanged && !withArticleChanged) {\n\t\t\t// \tthis.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.hGroupings);\n\t\t\t// }\n\t\t\t// if (collapsedChanged) {\n\t\t\t// \tif (!withArticleChanged) {\n\t\t\t// \t\t// if (fromRoute == 'root' || toRoute == 'root') {\n\t\t\t// \t\tthis.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.bundleList.wrapper);\n\t\t\t// \t}\n\t\t\t// } else {\n\t\t\t// \tif (withArticleChanged && withBundleChanged) {\n\t\t\t// \t\tthis.transforms.runTransition(withArticle ? tx.BETWEEN : tx.LAST, this.bundleList.wrapper);\n\t\t\t// \t}\n\t\t\t// }\n\t\t} else {\n\t\t\tif (withBundleChanged) {\n\t\t\t\tthis.transforms.runTransition(tx.BETWEEN,\n\t\t\t\t\tthis.sitename.el, this.about.el);\n\t\t\t}\n\t\t}\n\t\tthis.transforms.clearOffset(this.bundleList.el, this.keywordList.el,\n\t\t\tthis.keywordList.wrapper);\n\t},\n\n\t/* --------------------------- *\n\t/* own model changed\n\t/* --------------------------- */\n\n\t_onModelChange: function() {\n\t\t// keywords.deselect();\n\t\tif (this.model.hasChanged(\"collapsed\")) {\n\t\t\tif (this.model.get(\"collapsed\")) {\n\t\t\t\t// clear keyword selection\n\t\t\t\tkeywords.deselect();\n\t\t\t\t// this.touch.on(\"tap\", this._onNavigationClick);\n\t\t\t} else {\n\t\t\t\t// this.touch.off(\"tap\", this._onNavigationClick);\n\t\t\t}\n\t\t\tthis.keywordList.collapsed = this.bundleList.collapsed = this.model.get(\"collapsed\");\n\t\t}\n\t\tif (this.model.hasChanged(\"bundle\")) {\n\t\t\t// keywords.deselect();\n\t\t\tthis.keywordList.refresh();\n\t\t\t// this.graph && this.graph.requestRender(View.SIZE_INVALID);\n\t\t}\n\t\tif (this.model.hasChanged(\"withBundle\")) {\n\t\t\tif (this.model.get(\"withBundle\")) {\n\t\t\t\tthis.touch.on(\"vpanstart\", this._onVPanStart);\n\t\t\t\tthis.touch.on(\"hpanstart\", this._onHPanStart);\n\t\t\t\t// this.touch.on(\"tap\", this._onTap);\n\t\t\t} else {\n\t\t\t\tthis.touch.off(\"vpanstart\", this._onVPanStart);\n\t\t\t\tthis.touch.off(\"hpanstart\", this._onHPanStart);\n\t\t\t\t// this.touch.off(\"tap\", this._onTap);\n\t\t\t}\n\t\t\t// this.graph.valueTo()\n\t\t}\n\t\tthis.requestRender(View.MODEL_INVALID);\n\t},\n\n\t/* --------------------------- *\n\t/* keyword collection changed\n\t/* --------------------------- */\n\n\t_onKeywordSelect: function(keyword) {\n\t\t// use collection listener to avoid redundant refresh calls\n\t\tthis.bundleList.refresh();\n\t\tif (!this.model.get(\"collapsed\") && this.graph) {\n\t\t\tthis.listenToOnce(this.bundleList, \"view:render:after\", function(view, flags) {\n\t\t\t\tconsole.log(\"%s::_onKeywordSelect -> %s:[view:render:after] flags:%s\", this.cid, view.cid, View.flagsToString(flags));\n\t\t\t\tthis.graph.valueTo(0, 0, \"amount\");\n\t\t\t\t// this.graph.renderNow();\n\t\t\t\tthis.graph.valueTo(1, Globals.TRANSITION_DURATION, \"amount\");\n\t\t\t});\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* UI Events: bundleList keywordList buttons\n\t/* --------------------------- */\n\n\t_onNavigationClick: function(ev) {\n\t\tthis._changeCollapsed(false);\n\t},\n\n\t_onArticleClick: function(item) {\n\t\tswitch (this.model.get(\"routeName\")) {\n\t\t\tcase \"article-item\":\n\t\t\t\tcontroller.deselectArticle();\n\t\t\t\tbreak;\n\t\t\tcase \"root\":\n\t\t\tdefault:\n\t\t\t\tcontroller.selectArticle(item);\n\t\t\t\tbreak;\n\t\t}\n\t},\n\n\t_onSitenameClick: function() {\n\t\tswitch (this.model.get(\"routeName\")) {\n\t\t\tcase \"media-item\":\n\t\t\tcase \"bundle-item\":\n\t\t\t\tif (this.model.get(\"collapsed\")) {\n\t\t\t\t\tthis._changeCollapsed(false);\n\t\t\t\t} else {\n\t\t\t\t\tcontroller.deselectBundle();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"article-item\":\n\t\t\t\tcontroller.deselectArticle();\n\t\t\t\tbreak;\n\t\t}\n\t},\n\n\t_onBundleListSame: function(bundle) {\n\t\tthis._changeCollapsed(!this.model.get(\"collapsed\"));\n\t},\n\n\t_onKeywordListChange: function(keyword) {\n\t\tif (!this.model.get(\"collapsed\")) {\n\t\t\tkeywords.select(keyword);\n\t\t}\n\t},\n\n\t_changeCollapsed: function(value) {\n\t\tif (value !== this.model.get(\"collapsed\")) {\n\t\t\tthis.transforms.offset(0, 1, this.graph.el);\n\t\t\tthis.transforms.validate();\n\t\t\tthis.setImmediate(function() {\n\t\t\t\tconsole.log(\"%s::_changeCollapsed\", this.cid);\n\t\t\t\tthis.model.set(\"collapsed\", !this.model.get(\"collapsed\"));\n\t\t\t});\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* Horizontal touch/move (HammerJS)\n\t/* ------------------------------- */\n\n\t_onHPanStart: function(ev) {\n\t\tthis.transforms.get(this.keywordList.wrapper)\n\t\t\t.stopTransition()\n\t\t\t.clearOffset()\n\t\t\t.validate();\n\t\t// if (this.model.get(\"layoutName\") != \"left-layout\"\n\t\t// \t&& this.model.get(\"layoutName\") != \"default-layout\") {\n\t\t// \treturn;\n\t\t// }\n\t\tif (Globals.BREAKPOINTS[\"desktop-small\"].matches\n\t\t\t&& this.model.get(\"bundle\").get(\"media\").selectedIndex <= 0\n\t\t\t&& this.model.get(\"collapsed\")) {\n\t\t\tthis.transforms.get(this.keywordList.wrapper).clearCapture();\n\t\t\tthis._onHPanMove(ev);\n\n\t\t\tthis.touch.on(\"hpanmove\", this._onHPanMove);\n\t\t\tthis.touch.on(\"hpanend hpancancel\", this._onHPanFinal);\n\t\t}\n\t},\n\n\t_onHPanMove: function(ev) {\n\t\t// var HPAN_DRAG = 1;\n\t\t// var HPAN_DRAG = 0.75;\n\t\tvar HPAN_DRAG = 720 / 920;\n\t\tvar delta = ev.deltaX; //ev.thresholdDeltaX;\n\t\t// var mediaItems = this.model.get(\"bundle\").get(\"media\");\n\n\t\tif (this.model.get(\"withMedia\")) {\n\t\t\t// if (this.model.get(\"withMedia\") ^ (this._renderFlags & View.MODEL_INVALID)) {\n\t\t\t// if (mediaItems.selected !== null) {\n\t\t\tdelta *= (ev.offsetDirection & Hammer.DIRECTION_LEFT) ?\n\t\t\t\t0.0 : HPAN_DRAG;\n\t\t\t// if (bundles.selected.get(\"media\").selectedIndex == -1) {\n\t\t} else { //if (media.selectedIndex == 0) {\n\t\t\tdelta *= (ev.offsetDirection & Hammer.DIRECTION_LEFT) ?\n\t\t\t\tHPAN_DRAG : Globals.HPAN_OUT_DRAG;\n\t\t}\n\t\tthis.transforms.offset(delta, void 0, this.keywordList.wrapper);\n\t\tthis.transforms.validate();\n\t},\n\n\t_onHPanFinal: function(ev) {\n\t\tthis.touch.off(\"hpanmove\", this._onHPanMove);\n\t\tthis.touch.off(\"hpanend hpancancel\", this._onHPanFinal);\n\n\t\t/* NOTE: if there is no model change, set tx here. Otherwise just wait for render */\n\t\tvar kTf = this.transforms.get(this.keywordList.wrapper);\n\t\tif (!(this._renderFlags & View.MODEL_INVALID) && kTf.hasOffset) {\n\t\t\tif (kTf.offsetX != 0) {\n\t\t\t\tkTf.runTransition(tx.NOW);\n\t\t\t}\n\t\t\tkTf.clearOffset().validate();\n\t\t\t// kTf.clearOffset().runTransition(tx.NOW).validate();\n\t\t\t// this.transforms.clearOffset(this.keywordList.wrapper);\n\t\t\t// this.transforms.runTransition(tx.NOW, this.keywordList.wrapper);\n\t\t\t// this.transforms.validate();\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* Vertical touch/move (_onVPan*)\n\t/* ------------------------------- */\n\n\t_collapsedOffsetY: Globals.COLLAPSE_OFFSET,\n\n\t_onVPanStart: function(ev) {\n\t\tthis.touch.on(\"vpanmove\", this._onVPanMove);\n\t\tthis.touch.on(\"vpanend vpancancel\", this._onVPanFinal);\n\n\t\tthis.transforms.stopTransition(this.bundleList.el, this.keywordList.el); //, this.graph.el);\n\t\t// this.transforms.clearOffset(this.bundleList.el, this.keywordList.el);\n\t\t// this.transforms.validate();\n\t\tthis.transforms.clearCapture(this.bundleList.el, this.keywordList.el); //, this.graph.el);\n\n\t\tif (!this.model.get(\"collapsed\")) {\n\t\t\tthis.transforms.stopTransition(this.graph.el);\n\t\t\tthis.transforms.clearCapture(this.graph.el);\n\t\t}\n\t\t// this.el.classList.add(\"container-changing\");\n\t\tthis._onVPanMove(ev);\n\t},\n\n\t_onVPanMove: function(ev) {\n\t\tvar collapsed = this.model.get(\"collapsed\");\n\t\tvar delta = ev.deltaY; //ev.thresholdDeltaY;\n\t\tvar maxDelta = this._collapsedOffsetY; // + Math.abs(ev.thresholdOffsetY);\n\n\t\t// check if direction is aligned with collapsed/expand\n\t\tvar isValidDir = collapsed ? (delta > 0) : (delta < 0);\n\t\tvar moveFactor = collapsed ? 1 - Globals.VPAN_DRAG : Globals.VPAN_DRAG;\n\n\t\tdelta = Math.abs(delta); // remove sign\n\t\tdelta *= moveFactor;\n\t\tmaxDelta *= moveFactor;\n\n\t\tif (isValidDir) {\n\t\t\tif (delta > maxDelta) { // overshooting\n\t\t\t\tdelta = ((delta - maxDelta) * Globals.VPAN_OUT_DRAG) + maxDelta;\n\t\t\t} else { // no overshooting\n\t\t\t\t// delta = delta;\n\t\t\t}\n\t\t} else {\n\t\t\tdelta = (-delta) * Globals.VPAN_OUT_DRAG; // delta is opposite\n\t\t}\n\t\tdelta *= collapsed ? 0.5 : -1; // reapply sign\n\n\t\tthis.transforms.offset(0, delta, this.bundleList.el, this.keywordList.el); //, this.graph.el);\n\t\tif (!collapsed)\n\t\t\tthis.transforms.offset(0, delta, this.graph.el)\n\t\tthis.transforms.validate();\n\t},\n\n\t_onVPanFinal: function(ev) {\n\t\tthis.touch.off(\"vpanmove\", this._onVPanMove);\n\t\tthis.touch.off(\"vpanend vpancancel\", this._onVPanFinal);\n\n\t\tthis._onVPanMove(ev);\n\t\tthis.setImmediate(function() {\n\t\t\tif (this.willCollapsedChange(ev)) {\n\t\t\t\tthis.model.set(\"collapsed\", !this.model.get(\"collapsed\"));\n\t\t\t} else {\n\t\t\t\tthis.requestRender(View.LAYOUT_INVALID);\n\t\t\t}\n\t\t});\n\t},\n\n\twillCollapsedChange: function(ev) {\n\t\treturn ev.type == \"vpanend\" ? this.model.get(\"collapsed\") ?\n\t\t\tev.deltaY > Globals.COLLAPSE_THRESHOLD :\n\t\t\tev.deltaY < -Globals.COLLAPSE_THRESHOLD :\n\t\t\tfalse;\n\t},\n\n\t/* -------------------------------\n\t/* Components\n\t/* ------------------------------- */\n\n\tcreateSitenameButton: function() {\n\t\tvar view = new View({\n\t\t\tel: \"#site-name\",\n\t\t\tevents: {\n\t\t\t\t\"click a\": function(domev) {\n\t\t\t\t\tdomev.defaultPrevented || domev.preventDefault();\n\t\t\t\t\tthis.trigger(\"view:click\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.listenTo(view, \"view:click\", this._onSitenameClick);\n\t\tview.wrapper = view.el.parentElement;\n\t\treturn view;\n\t},\n\n\tcreateArticleButton: function(articleItem) {\n\t\tvar view = new ArticleButton({\n\t\t\tel: \"#about\",\n\t\t\tmodel: articleItem\n\t\t}).render();\n\t\tthis.listenTo(view, \"view:click\", this._onArticleClick);\n\t\tview.wrapper = view.el.parentElement;\n\t\treturn view;\n\t},\n\n\t// createArticleButton2: function(articleItem) {\n\t// \tvar view = new View({\n\t// \t\tel: \"#about\",\n\t// \t\tclassName: \"article-button\",\n\t// \t\t// tag: \"h2\",\n\t// \t\tmodel: articleItem,\n\t// \t});\n\t// \t// this.listenTo(view, \"view:click\", this._onAboutClick);\n\t// \tview.label = view.el.querySelector(\"a\");\n\t// \tview.label.innerHTML = articleItem.get(\"name\");\n\t// \tview.wrapper = view.el.parentElement;\n\t// \treturn view;\n\t// },\n\n\t/**\n\t * bundle-list\n\t */\n\tcreateBundleList: function() {\n\t\tvar view = new FilterableListView({\n\t\t\tel: \"#bundle-list\",\n\t\t\tcollection: bundles,\n\t\t\tcollapsed: false,\n\t\t\tfilterFn: function(bundle, index, arr) {\n\t\t\t\treturn keywords.selected ?\n\t\t\t\t\tbundle.get(\"kIds\").indexOf(keywords.selected.id) !== -1 : false;\n\t\t\t},\n\t\t});\n\t\tcontroller.listenTo(view, {\n\t\t\t\"view:select:one\": controller.selectBundle,\n\t\t\t\"view:select:none\": controller.deselectBundle\n\t\t});\n\t\tthis.listenTo(view, \"view:select:same\", this._onBundleListSame);\n\t\tthis.listenTo(keywords, \"select:one select:none\", this._onKeywordSelect);\n\t\tview.wrapper = view.el.parentElement;\n\t\treturn view;\n\t},\n\n\t/**\n\t * keyword-list\n\t */\n\tcreateKeywordList: function() {\n\t\tvar view = new GroupingListView({\n\t\t\tel: \"#keyword-list\",\n\t\t\tcollection: keywords,\n\t\t\tcollapsed: false,\n\t\t\tfilterFn: function(item, idx, arr) {\n\t\t\t\t// return !!(item.get(\"bundle\").selected);\n\t\t\t\treturn bundles.selected ?\n\t\t\t\t\t(bundles.selected.get(\"kIds\").indexOf(item.id) !== -1) : false;\n\t\t\t},\n\t\t\tgroupingFn: function(item, idx, arr) {\n\t\t\t\t// return item.get(\"type\");\n\t\t\t\treturn types.get(item.get(\"tId\"));\n\t\t\t},\n\t\t});\n\t\tthis.listenTo(view, \"view:select:one view:select:none\", this._onKeywordListChange);\n\t\tview.wrapper = view.el.parentElement;\n\t\treturn view;\n\t},\n\n\t/**\n\t * nav-graph\n\t */\n\tcreateGraphView: function(listA, listB) {\n\t\tvar view = new GraphView({\n\t\t\tid: \"nav-graph\",\n\t\t\tlistA: listA,\n\t\t\tlistB: listB,\n\t\t\tmodel: this.model,\n\t\t\tuseOpaque: false\n\t\t});\n\t\tthis.el.appendChild(view.el);\n\t\treturn view;\n\t},\n\n\t/* -------------------------------\n\t/* Horizontal touch/move (MutationObserver)\n\t/* ------------------------------- */\n\n\t/*\n\t_beginTransformObserve: function() {\n\t\tif (!(Globals.BREAKPOINTS[\"desktop-small\"].matches && this.model.get(\"bundle\").get(\"media\").selectedIndex <= 0 && this.model.get(\"collapsed\"))) {\n\t\t\treturn;\n\t\t}\n\t\tvar target = document.querySelector(\".carousel > .empty-item\");\n\t\tif (target === null) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this._transformObserver) {\n\t\t\tthis._transformObserver = new MutationObserver(this._onTransformMutation);\n\t\t}\n\t\tthis._transformObserver.observe(target, { attributes: true, attributeFilter: [\"style\"] });\n\t\tthis.touch.on(\"hpanend hpancancel\", this._endTransformObserve);\n\t\tthis.transforms.get(this.keywordList.wrapper)\n\t\t\t.stopTransition()\n\t\t\t.clearOffset()\n\t\t\t.clearCapture()\n\t\t\t.validate();\n\t},\n\n\t_endTransformObserve: function() {\n\t\tthis._transformObserver.disconnect();\n\t\tthis.touch.off(\"hpanend hpancancel\", this._endTransformObserve);\n\t\tthis.transforms.get(this.keywordList.wrapper)\n\t\t\t.clearOffset()\n\t\t\t.runTransition(tx.NOW)\n\t\t\t.validate();\n\t},\n\n\t_onTransformMutation: function(mutations) {\n\t\tvar tView, tMetrics, tCss, dTxObj, pos;\n\n\t\t// this.keywordList.wrapper.style[prefixedProperty(\"transform\")];\n\t\t// transform = mutations[0].target.style.getPropertyValue(prefixedProperty(\"transform\"));\n\n\t\ttView = View.findByElement(mutations[0].target);\n\t\tif (tView) {\n\t\t\ttMetrics = tView.metrics;\n\t\t\tdTxObj = this.transforms.get(this.keywordList.wrapper);\n\t\t\tconsole.log(\"%s::_onTransformMutation [withMedia: %s] target: (%f\\+%f) %f wrapper: (%f) %f\", this.cid,\n\t\t\t\tthis.model.has(\"media\"),\n\t\t\t\ttMetrics.translateX, tMetrics.width, tMetrics.translateX + tMetrics.width,\n\t\t\t\tdTxObj.capturedX, tMetrics.translateX - dTxObj.capturedX,\n\t\t\t\ttMetrics\n\t\t\t);\n\n\t\t\tthis.transforms.offset(tMetrics.translateX - dTxObj.capturedX, void 0, this.keywordList.wrapper);\n\t\t\tthis.transforms.validate();\n\t\t}\n\t},\n\t*/\n});\n\nmodule.exports = NavigationView;",
    "/* global Path2D */\n/**\n * @module app/view/component/progress/CanvasView\n */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n// /** @type {module:color} */\n// var Color = require(\"color\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/view/base/Interpolator} */\nvar Interpolator = require(\"app/view/base/Interpolator\");\n/** @type {module:utils/css/getBoxEdgeStyles} */\nvar getBoxEdgeStyles = require(\"utils/css/getBoxEdgeStyles\");\n\nvar MIN_CANVAS_RATIO = 2; // /Firefox/.test(window.navigator.userAgent)? 2 : 1;\n\n/**\n * @constructor\n * @type {module:app/view/component/progress/CanvasView}\n */\nvar CanvasView = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"canvasView\",\n\t/** @type {string} */\n\ttagName: \"canvas\",\n\t/** @type {string} */\n\tclassName: \"canvas-view\",\n\n\tproperties: {\n\t\tcontext: {\n\t\t\tget: function() {\n\t\t\t\treturn this._ctx;\n\t\t\t}\n\t\t},\n\t\tinterpolator: {\n\t\t\tget: function() {\n\t\t\t\treturn this._interpolator;\n\t\t\t}\n\t\t},\n\t\tcanvasRatio: {\n\t\t\tget: function() {\n\t\t\t\treturn this._canvasRatio;\n\t\t\t}\n\t\t},\n\t},\n\n\t/** @type {Object} */\n\tdefaults: {\n\t\tvalues: {\n\t\t\tvalue: 0\n\t\t},\n\t\tmaxValues: {\n\t\t\tvalue: 1\n\t\t},\n\t\tuseOpaque: true,\n\t},\n\n\t/* --------------------------- *\n\t/* children/layout\n\t/* --------------------------- */\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t// TODO: cleanup this options mess\n\t\toptions = _.defaults(options, this.defaults);\n\t\toptions.values = _.defaults(options.values, this.defaults.values);\n\t\toptions.maxValues = _.defaults(options.maxValues, this.defaults.maxValues);\n\n\t\tthis._interpolator = new Interpolator(options.values, options.maxValues);\n\n\t\t// render props\n\t\t// this._color = options.color;\n\t\t// this._backgroundColor = options.backgroundColor;\n\t\tthis._useOpaque = options.useOpaque;\n\n\t\tthis._options = _.pick(options, \"color\", \"backgroundColor\");\n\n\t\t// opaque background\n\t\t// --------------------------------\n\t\tvar ctxOpts = {};\n\t\t// if (this._useOpaque) {\n\t\t// \tthis._opaqueProp = Modernizr.prefixed(\"opaque\", this.el, false);\n\t\t// \tif (this._opaqueProp) {\n\t\t// \t\tthis.el[this._opaqueProp] = true;\n\t\t// \t} else {\n\t\t// \t\tctxOpts.alpha = true;\n\t\t// \t}\n\t\t// \tthis.el.classList.add(\"color-bg\");\n\t\t// }\n\n\t\t// canvas' context init\n\t\t// --------------------------------\n\t\tthis._ctx = this.el.getContext(\"2d\", ctxOpts);\n\n\t\t// adjust canvas size to pixel ratio\n\t\t// upscale the canvas if the two ratios don't match\n\t\t// --------------------------------\n\t\tvar ratio = MIN_CANVAS_RATIO;\n\t\tvar ctxRatio = this._ctx.webkitBackingStorePixelRatio || 1;\n\t\tif (window.devicePixelRatio !== ctxRatio) {\n\t\t\t// ratio = Math.max(window.devicePixelRatio / ctxRatio, MIN_CANVAS_RATIO);\n\t\t\tratio = window.devicePixelRatio / ctxRatio;\n\t\t\tratio = Math.max(ratio, MIN_CANVAS_RATIO);\n\t\t}\n\t\tthis._canvasRatio = ratio;\n\t\t// console.log(\"%s::init canvasRatio: %f\", this.cid, this._canvasRatio);\n\n\t\tthis.listenTo(this, \"view:attached\", function() {\n\t\t\t// this.invalidateSize();\n\t\t\t// this.renderNow();\n\t\t\tthis.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();\n\t\t});\n\t},\n\n\t// _computeCanvasRatio: function() {\n\t// \tvar ratio = MIN_CANVAS_RATIO;\n\t// \tvar ctxRatio = this._ctx.webkitBackingStorePixelRatio || 1;\n\t// \tif (window.devicePixelRatio !== ctxRatio) {\n\t// \t\t// ratio = Math.max(window.devicePixelRatio / ctxRatio, MIN_CANVAS_RATIO);\n\t// \t\tratio = window.devicePixelRatio / ctxRatio;\n\t// \t\tratio = Math.max(ratio, MIN_CANVAS_RATIO);\n\t// \t}\n\t// \tthis._canvasRatio = ratio;\n\t// },\n\n\t_updateCanvas: function() {\n\t\t// adjust canvas size to pixel ratio\n\t\t// upscale the canvas if the two ratios don't match\n\t\t// --------------------------------\n\t\tvar s, m, w, h, edgeW, edgeH;\n\n\t\ts = getComputedStyle(this.el);\n\t\tm = getBoxEdgeStyles(s);\n\t\tedgeW = m.paddingLeft + m.paddingRight + m.borderLeftWidth + m.borderRightWidth;\n\t\tedgeH = m.paddingTop + m.paddingBottom + m.borderTopWidth + m.borderBottomWidth;\n\t\tw = this.el.offsetWidth;\n\t\th = this.el.offsetHeight;\n\n\t\tthis.el.width = this._canvasWidth = (w - edgeW) * this._canvasRatio;\n\t\tthis.el.height = this._canvasHeight = (h - edgeH) * this._canvasRatio;\n\t\t// this.el.style.height = h + \"px\";\n\t\t// this.el.style.width = w + \"px\";\n\n\t\t// colors\n\t\t// --------------------------------\n\t\tthis._color = s.color || this._options.color || Globals.DEFAULT_COLORS[\"color\"];\n\t\tthis._backgroundColor = s.backgroundColor || this._options.backgroundColor || Globals.DEFAULT_COLORS[\"background-color\"];\n\n\t\t// mozOpaque\n\t\t// --------------------------------\n\t\tif (this._useOpaque && this._opaqueProp) {\n\t\t\t// this.el.style.backgroundColor = this._backgroundColor;\n\t\t\tthis.el[this._opaqueProp] = true;\n\t\t}\n\n\t\t// fontSize\n\t\t// --------------------------------\n\t\tthis._fontSize = parseFloat(s.fontSize) * this._canvasRatio;\n\t\tthis._fontFamily = s.fontFamily;\n\n\t\t// prepare canvas context\n\t\t// --------------------------------\n\t\tthis._ctx.restore();\n\n\t\tthis._ctx.font = [s.fontWeight, s.fontStyle, this._fontSize + \"px/1\", s.fontFamily].join(\" \");\n\t\tthis._ctx.textAlign = \"left\";\n\t\tthis._ctx.lineCap = \"butt\";\n\t\tthis._ctx.lineJoin = \"miter\";\n\t\tthis._ctx.strokeStyle = this._color;\n\t\tthis._ctx.fillStyle = this._color;\n\n\t\tthis.updateCanvas(this._ctx);\n\t\tthis._ctx.save();\n\n\t\t// console.group(this.cid+\"::_updateCanvas\");\n\t\t// console.log(\"ratio:    %f (min: %f, device: %f, context: %s)\", this._canvasRatio, MIN_CANVAS_RATIO, window.devicePixelRatio, this._ctx.webkitBackingStorePixelRatio || \"(webkit-only)\");\n\t\t// console.log(\"colors:   fg: %s bg: %s\", this._color, this._backgroundColor);\n\t\t// console.log(\"style:    %s, %s, padding: %s (%s)\", s.width, s.height, s.padding, s.boxSizing);\n\t\t// console.log(\"box:      %f x %f px\", m.width, m.height);\n\t\t// console.log(\"measured: %f x %f px\", w, h);\n\t\t// console.log(\"canvas:   %f x %f px\", this._canvasWidth, this._canvasHeight);\n\t\t// console.groupEnd();\n\t},\n\n\tupdateCanvas: function() {\n\n\t},\n\n\t_getFontMetrics: function(str) {\n\t\tvar key, idx, mObj, mIdx = str.length;\n\t\tfor (key in Globals.FONT_METRICS) {\n\t\t\tidx = str.indexOf(key);\n\t\t\tif (idx !== -1 && idx < mIdx) {\n\t\t\t\tmIdx = idx;\n\t\t\t\tmObj = Globals.FONT_METRICS[key];\n\t\t\t}\n\t\t}\n\t\treturn mObj;\n\t},\n\n\t_clearCanvas: function(x, y, w, h) {\n\t\tthis._ctx.clearRect(x, y, w, h);\n\t\tif (this._useOpaque) {\n\t\t\tthis._ctx.save();\n\t\t\tthis._ctx.fillStyle = this._backgroundColor;\n\t\t\tthis._ctx.fillRect(x, y, w, h);\n\t\t\tthis._ctx.restore();\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* render\n\t/* --------------------------- */\n\n\t/** @override */\n\trender: function() {\n\t\tif (this.attached) {\n\t\t\treturn this.renderNow();\n\t\t}\n\t\treturn this;\n\t},\n\n\t/** @override */\n\trenderFrame: function(tstamp, flags) {\n\t\tif (!this.attached) {\n\t\t\treturn flags;\n\t\t}\n\t\tif (flags & View.SIZE_INVALID) {\n\t\t\tthis._updateCanvas();\n\t\t}\n\t\tif (this._interpolator.valuesChanged) {\n\t\t\tflags |= View.LAYOUT_INVALID;\n\t\t\tthis._interpolator.interpolate(tstamp);\n\t\t}\n\t\tif (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {\n\t\t\tthis.redraw(this._ctx, this._interpolator);\n\t\t\tif (this._interpolator.valuesChanged) {\n\t\t\t\tthis.requestRender();\n\t\t\t}\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* public\n\t/* --------------------------- */\n\n\tgetValue: function(key) {\n\t\treturn this._interpolator.getValue(key);\n\t},\n\n\tgetRenderedValue: function(key) {\n\t\treturn this._interpolator.getRenderedValue(key);\n\t},\n\n\tvalueTo: function(value, duration, key) {\n\t\tthis._interpolator.valueTo(value, duration, key);\n\t\tthis.requestRender(View.MODEL_INVALID | View.LAYOUT_INVALID);\n\t},\n\n\t// updateValue: function(key) {\n\t// \treturn this._interpolator.updateValue(key || this.defaultKey);\n\t// },\n\n\t/* --------------------------- *\n\t/* redraw\n\t/* --------------------------- */\n\n\tredraw: function(context, changed) {},\n\n});\n\nif (DEBUG) {\n\tCanvasView.prototype._skipLog = true;\n}\n\nmodule.exports = CanvasView;\n",
    "// /** @type {module:utils/setImmediate} */\n// var setImmediate = require(\"utils/setImmediate\");\n\n// function sortByPriority(a, b) {\n// \tif (a.priority > b.priority)\n// \t\treturn 1;\n// \tif (a.priority < b.priority)\n// \t\treturn -1;\n// \treturn 0;\n// }\n\nfunction RequestQueue(offset) {\n\tthis._offset = offset | 0;\n\tthis._items = [];\n\tthis._priorities = [];\n\tthis._numItems = 0;\n}\n\nRequestQueue.prototype = Object.create({\n\tenqueue: function(item, priority) {\n\t\tvar i = this._items.length;\n\t\tthis._items[i] = item;\n\t\tthis._priorities[i] = {\n\t\t\tpriority: (priority | 0),\n\t\t\tindex: i\n\t\t};\n\t\tthis._numItems++;\n\t\t// console.log(\"FrameQueue::RequestQueue::enqueue() [numItems:%i] ID:%i\", this._numItems, this._offset + i);\n\t\treturn this._offset + i;\n\t},\n\n\tcontains: function(index) {\n\t\tindex -= this.offset;\n\t\treturn 0 <= index && index < this._items.length;\n\t},\n\n\tskip: function(index) {\n\t\tvar i, item;\n\t\ti = index - this._offset;\n\t\tif (0 > i || i >= this._items.length) {\n\t\t\t// \tconsole.warn(\"FrameQueue::RequestQueue::skip(id:%i) out of range (%i-%i)\", index, this._offset, this._offset + (this._numItems - 1));\n\t\t\treturn void 0;\n\t\t}\n\t\titem = this._items[i];\n\t\tif (item !== null) {\n\t\t\t// if (item = this._items[i]) {\n\t\t\tthis._items[i] = null;\n\t\t\tthis._numItems--;\n\n\t\t\t// if (this._numItems == 0) {\n\t\t\t// \tthis._empty(this._offset + this._items.length);\n\t\t\t// }\n\t\t\t// console.log(\"FrameQueue::RequestQueue::skip(id:%i) [numItems:%i] skipping\", index, this._numItems);\n\t\t}\n\t\t// else {\n\t\t// \tconsole.warn(\"FrameQueue::RequestQueue::skip(id:%i) [numItems:%i] item is null\", index, this._numItems);\n\t\t// }\n\t\treturn item;\n\t},\n\n\t// forEach: function(fn, context) {\n\t// \treturn this.items.forEach(fn, context);\n\t// },\n\n\tindexes: function() {\n\t\t// .map(function(o, i, a) {\n\t\t// \treturn this[o.index];\n\t\t// }, this._items);\n\t\tvar items = this._priorities.concat();\n\t\titems.sort(function(a, b) {\n\t\t\tif (a.priority > b.priority)\n\t\t\t\treturn 1;\n\t\t\tif (a.priority < b.priority)\n\t\t\t\treturn -1;\n\t\t\treturn 0;\n\t\t});\n\t\titems.forEach(function(o, i, a) {\n\t\t\ta[i] = o.index;\n\t\t}, this);\n\t\treturn items;\n\t},\n\n\titems: function() {\n\t\t// .map(function(o, i, a) {\n\t\t// \treturn this[o.index];\n\t\t// }, this._items);\n\t\tvar items = this._priorities.concat();\n\t\titems.sort(function(a, b) {\n\t\t\tif (a.priority > b.priority)\n\t\t\t\treturn 1;\n\t\t\tif (a.priority < b.priority)\n\t\t\t\treturn -1;\n\t\t\treturn 0;\n\t\t});\n\t\titems.forEach(function(o, i, a) {\n\t\t\ta[i] = this._items[o.index];\n\t\t}, this);\n\t\treturn items;\n\t},\n\n\t_empty: function(offset) {\n\t\tthis._offset = offset;\n\t\tthis._items.length = 0;\n\t\tthis._priorities.length = 0;\n\t\tthis._numItems = 0;\n\t}\n}, {\n\n\toffset: {\n\t\tget: function() {\n\t\t\treturn this._offset;\n\t\t}\n\t},\n\n\tlength: {\n\t\tget: function() {\n\t\t\treturn this._items.length;\n\t\t}\n\t},\n\n\tnumItems: {\n\t\tget: function() {\n\t\t\treturn this._numItems;\n\t\t}\n\t},\n});\n\nvar _nextQueue = new RequestQueue(0);\nvar _currQueue = null;\n\nvar _pending = false;\nvar _running = false;\nvar _rafId = -1;\n\n/**\n/* @param tstamp {int}\n/*/\nvar _runQueue = function(tstamp) {\n\tif (_running) throw new Error(\"wtf!!!\");\n\n\t_rafId = -1;\n\t_running = true;\n\t_currQueue = _nextQueue;\n\t_nextQueue = new RequestQueue(_currQueue.offset + _currQueue.length);\n\n\t// _currQueue.items().forEach(function(fn, i, a) {\n\t// \tif (fn !== null) {\n\t// \t\tfn(tstamp);\n\t// \t}\n\t// });\n\t_currQueue.indexes().forEach(function(index, i, a) {\n\t\tvar fn = _currQueue._items[index];\n\t\tif (fn !== null) {\n\t\t\tfn(tstamp);\n\t\t}\n\t});\n\t_running = false;\n\t_currQueue = null;\n\n\tif (_nextQueue.numItems > 0) {\n\t\t_rafId = window.requestAnimationFrame(_runQueue);\n\t}\n};\n\nvar FrameQueue = Object.create({\n\t/**\n\t/* @param fn {Function}\n\t/* @param forceNext {int}\n\t/* @return {int}\n\t/*/\n\trequest: function(fn, priority) {\n\t\t// if (!_running && !_pending) {\n\t\t// \t_pending = true;\n\t\t// \tconsole.warn(\"FrameQueue::request setImmediate: pending\");\n\t\t// \tsetImmediate(function() {\n\t\t// \t\t_pending = false;\n\t\t// \t\tif (_nextQueue.numItems > 0) {\n\t\t// \t\t\t_rafId = window.requestAnimationFrame(_runQueue);\n\t\t// \t\t\tconsole.warn(\"FrameQueue::request setImmediate: raf:%i for %i items\", _rafId, _nextQueue.numItems);\n\t\t// \t\t} else {\n\t\t// \t\t\tconsole.warn(\"FrameQueue::request setImmediate: no items\");\n\t\t// \t\t}\n\t\t// \t});\n\t\t// }\n\t\tif (!_running && _rafId === -1) {\n\t\t\t_rafId = window.requestAnimationFrame(_runQueue);\n\t\t}\n\t\treturn _nextQueue.enqueue(fn, priority);\n\t},\n\n\t/**\n\t/* @param id {int}\n\t/* @return {Function?}\n\t/*/\n\tcancel: function(id) {\n\t\tvar fn;\n\t\tif (_running) {\n\t\t\tfn = _currQueue.skip(id) || _nextQueue.skip(id);\n\t\t} else {\n\t\t\tfn = _nextQueue.skip(id);\n\t\t\tif ((_rafId !== -1) && (_nextQueue.numItems === 0)) {\n\t\t\t\twindow.cancelAnimationFrame(_rafId);\n\t\t\t\t_rafId = -1;\n\t\t\t}\n\t\t}\n\t\treturn fn;\n\t},\n}, {\n\trunning: {\n\t\tget: function() {\n\t\t\treturn _running;\n\t\t}\n\t}\n});\n\nif (DEBUG) {\n\t/** @type {module:underscore} */\n\tvar _ = require(\"underscore\");\n\n\t// console.info(\"Using app/view/base/FrameQueue\");\n\n\t// \t// // log frame exec time\n\t// \t// var _now = window.performance?\n\t// \t// \twindow.performance.now.bind(window.performance) :\n\t// \t// \tDate.now.bind(Date);\n\t// \t// _runQueue = _.wrap(_runQueue, function(fn, tstamp) {\n\t// \t// \tvar retval, tframe;\n\t// \t// \tconsole.log(\"[FRAME BEGIN] [%ims] %i items [ids:%i-%i]\", tstamp, _nextQueue.numItems, _nextQueue.offset, _nextQueue.offset + _nextQueue.length);\n\t// \t// \ttframe = _now();\n\t// \t// \tretval = fn(tstamp);\n\t// \t// \ttframe = _now() - tframe;\n\t// \t// \tconsole.log(\"[FRAME ENDED] [%ims] took %ims\\n---\\n\", tstamp + tframe, tframe);\n\t// \t// \tif (_nextQueue.numItems != 0) console.info(\"[FRAME ENDED] %i items scheduled for [raf:%i]\", _nextQueue.numItems, _rafId);\n\t// \t// \treturn retval;\n\t// \t// });\n\t//\n\t// \t// log frame end\n\t// \t_runQueue = _.wrap(_runQueue, function(fn, tstamp) {\n\t// \t\tvar retval;\n\t// \t\tconsole.log(\"FrameQueue::_runQueue %i items (ID range:%i-%i)\", _nextQueue.numItems, _nextQueue.offset, _nextQueue.offset + _nextQueue.length - 1);\n\t// \t\tretval = fn(tstamp);\n\t// \t\tconsole.log(\"[Frame exit]\\n---\\n\");\n\t// \t\treturn retval;\n\t// \t});\n\n\t// use log prefix\n\tif (console.prefix) {\n\t\t_runQueue = _.wrap(_runQueue, function(fn, tstamp) {\n\t\t\tvar retval, logprefix;\n\t\t\tlogprefix = console.prefix;\n\t\t\tconsole.prefix += \"[raf:\" + _rafId + \"] \";\n\t\t\tretval = fn(tstamp);\n\t\t\tconsole.prefix = logprefix;\n\t\t\treturn retval;\n\t\t});\n\t}\n\n\t// FrameQueue.cancel = _.wrap(FrameQueue.cancel, function(fn, id) {\n\t// \tif ((_currQueue !== null) && (_currQueue.offset >= id) && (id < _nextQueue.offset)) {\n\t// \t\tconsole.info(\"FrameQueue::cancel ID:%i in running range (%i-%i)\", id, _currQueue.offset, _nextQueue.offset - 1);\n\t// \t}\n\t// \tvar rafId = _rafId;\n\t// \tvar retval = fn(id);\n\t// \tif (retval === void 0) {\n\t// \t\tconsole.warn(\"FrameQueue::cancel ID:%i not found\", id);\n\t// \t} else if (retval === null) {\n\t// \t\tconsole.warn(\"FrameQueue::cancel ID:%i already cancelled\", id);\n\t// \t} else {\n\t// \t\tif (!_running && _nextQueue.numItems == 0) {\n\t// \t\t\tconsole.info(\"FrameQueue::cancel raf:%i cancelled (ID:%i cancelled, empty queue)\", rafId, id);\n\t// \t\t}\n\t// \t}\n\t// \treturn retval;\n\t// });\n}\n\n\nmodule.exports = FrameQueue;\n",
    "/**\n * @module app/view/base/Interpolator\n */\n\n// /** @type {module:underscore} */\n// var _ = require(\"underscore\");\n/** @type {module:utils/ease/linear} */\nvar linear = require(\"utils/ease/linear\");\n\n/**\n * @constructor\n * @type {module:app/view/base/Interpolator}\n */\nfunction Interpolator(values, maxValues) {\n\tthis._valueData = {};\n\tthis._maxValues = {};\n\tthis._renderableKeys = [];\n\n\tvar key, val, maxVal;\n\tfor (key in values) {\n\t\tval = values[key];\n\t\tmaxVal = maxValues[key] || null;\n\t\t// create value object and store it\n\t\tthis._valueData[key] = this._initValue(val, 0, maxVal);\n\t\t// add maxValue to store\n\t\tthis._maxValues[key] = maxVal;\n\t\t// add to next render list\n\t\tthis._renderableKeys.push(key);\n\t}\n\tthis._valuesChanged = this._renderableKeys.length > 0;\n}\n\nInterpolator.prototype = Object.create({\n\n\t/* --------------------------- *\n\t/* public interface\n\t/* --------------------------- */\n\n\tisAtTarget: function(key) {\n\t\treturn this._renderableKeys.indexOf(key) === -1;\n\t},\n\n\tgetValue: function(key) {\n\t\treturn this._valueData[key]._value;\n\t},\n\n\tgetRenderedValue: function(key) {\n\t\treturn this._valueData[key]._renderedValue;\n\t},\n\n\tvalueTo: function(value, duration, key) {\n\t\tvar changed, dataObj = this._valueData[key];\n\t\t// console.log(\"%s::valueTo [%s]\", \"[interpolator]\", key, value);\n\t\tif (Array.isArray(dataObj)) {\n\t\t\tchanged = value.reduce(function(prevChanged, itemValue, i) {\n\t\t\t\tif (dataObj[i]) {\n\t\t\t\t\tdataObj[i] = this._initNumber(itemValue, duration, this._maxValues[key]);\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\treturn this._setValue(itemValue, duration, dataObj[i]) || prevChanged;\n\t\t\t\t}\n\t\t\t}.bind(this), changed);\n\t\t} else {\n\t\t\tchanged = this._setValue(value, duration, dataObj);\n\t\t}\n\t\tif (changed) {\n\t\t\tthis._renderableKeys.indexOf(key) !== -1 || this._renderableKeys.push(key);\n\t\t\tthis._valuesChanged = true;\n\t\t\t// this.render();\n\t\t\t// this.requestRender();\n\t\t}\n\t\treturn this;\n\t},\n\n\tupdateValue: function(key) {\n\t\t// Call _interpolateValue only if needed. _interpolateValue() returns false\n\t\t// once interpolation is done, in which case remove key from _renderableKeys.\n\t\tvar kIndex = this._renderableKeys.indexOf(key);\n\t\tif (kIndex !== -1 && !this._interpolateValue(key)) {\n\t\t\tthis._renderableKeys.splice(kIndex, 1);\n\t\t\tthis._valuesChanged = this._renderableKeys.length > 0;\n\t\t}\n\t\treturn this;\n\t},\n\n\t/* --------------------------- *\n\t/* private: valueData\n\t/* --------------------------- */\n\n\t_initValue: function(value, duration, maxVal) {\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value.map(function(val) {\n\t\t\t\treturn this._initNumber(val, 0, maxVal);\n\t\t\t}, this);\n\t\t} else {\n\t\t\treturn this._initNumber(value, 0, maxVal);\n\t\t}\n\t},\n\n\t// _initArray: function(value, duration, maxVal) {\n\t// \treturn val.map(function(val) {\n\t// \t\treturn this._initNumber(val, 0, maxVal);\n\t// \t}, this);\n\t// },\n\n\t_initNumber: function(value, duration, maxVal) {\n\t\tvar o = {};\n\t\to._value = value;\n\t\to._startValue = value;\n\t\to._valueDelta = 0;\n\n\t\to._duration = duration || 0;\n\t\to._startTime = -1;\n\t\to._elapsedTime = 0;\n\n\t\to._lastRenderedValue = o._renderedValue = null;\n\n\t\to._maxVal = maxVal;\n\t\t// if (maxVal !== void 0) o._maxVal = maxVal;\n\t\t// o._maxVal = this._maxValues[key];\n\t\t// o._maxVal = this._maxVal;// FIXME\n\t\treturn o;\n\t},\n\n\t_setValue: function(value, duration, o) {\n\t\tif (o._value != value) {\n\t\t\to._startValue = o._value;\n\t\t\to._valueDelta = value - o._value;\n\t\t\to._value = value;\n\n\t\t\to._duration = duration || 0;\n\t\t\to._startTime = -1;\n\t\t\to._elapsedTime = 0;\n\n\t\t\to._lastRenderedValue = o._renderedValue;\n\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\n\t/* --------------------------- *\n\t/* private: interpolate\n\t/* --------------------------- */\n\n\t/** @override */\n\tinterpolate: function(tstamp) {\n\t\tif (this._valuesChanged) {\n\t\t\tthis._valuesChanged = false;\n\n\t\t\tvar changedKeys = this._renderableKeys;\n\t\t\tthis._tstamp = tstamp;\n\t\t\tthis._renderableKeys = changedKeys.filter(this._interpolateValue, this);\n\t\t\tthis._renderedKeys = changedKeys;\n\n\t\t\tif (this._renderableKeys.length !== 0) {\n\t\t\t\tthis._valuesChanged = true;\n\t\t\t\t// \t// this.requestRender();\n\t\t\t}\n\t\t}\n\t\t// console.log(\"%s::interpolate valuesChanged:%s tstamp:%f\", \"[interpolator]\", this._valuesChanged, tstamp);\n\t\t// return this._valuesChanged;\n\t\t// return this.valuesChanged;\n\n\t\treturn this;\n\t},\n\n\t_interpolateValue: function(key) {\n\t\tvar dataObj = this._valueData[key];\n\t\tif (Array.isArray(dataObj)) {\n\t\t\treturn dataObj.reduce(function(continueNext, o, index, arr) {\n\t\t\t\treturn this._interpolateNumber(this._tstamp, o) || continueNext;\n\t\t\t}.bind(this), false);\n\t\t} else {\n\t\t\treturn this._interpolateNumber(this._tstamp, dataObj);\n\t\t}\n\t},\n\n\t_interpolateNumber: function(tstamp, o) {\n\t\tif (o._startTime < 0) {\n\t\t\to._startTime = tstamp;\n\t\t}\n\t\tvar elapsed = tstamp - o._startTime;\n\t\to._elapsedTime = elapsed;\n\t\to._lastRenderedValue = o._renderedValue;\n\t\tif (elapsed < o._duration) {\n\t\t\tif (o._maxVal && o._valueDelta < 0) {\n\t\t\t\t// upper-bound values\n\t\t\t\to._renderedValue = linear(elapsed, o._startValue,\n\t\t\t\t\to._valueDelta + o._maxVal, o._duration) - o._maxVal;\n\t\t\t} else {\n\t\t\t\t// unbound values\n\t\t\t\to._renderedValue = linear(elapsed, o._startValue,\n\t\t\t\t\to._valueDelta, o._duration);\n\t\t\t}\n\t\t\treturn true;\n\t\t} else {\n\t\t\to._renderedValue = o._value;\n\t\t\treturn false;\n\t\t}\n\t},\n}, {\n\tvaluesChanged: {\n\t\tget: function() {\n\t\t\treturn this._valuesChanged;\n\t\t}\n\t},\n\trenderableKeys: {\n\t\tget: function() {\n\t\t\treturn this._renderableKeys;\n\t\t}\n\t},\n\trenderedKeys: {\n\t\tget: function() {\n\t\t\treturn this._renderedKeys;\n\t\t}\n\t},\n});\n\nmodule.exports = Interpolator;\n",
    "/** @type {module:utils/prefixedEvent} */\nvar prefixedEvent = require(\"utils/prefixedEvent\");\n\nvar eventMap = {\n\t\"transitionend\": prefixedEvent(\"transitionend\"),\n\t\"fullscreenchange\": prefixedEvent(\"fullscreenchange\", document),\n\t\"fullscreenerror\": prefixedEvent(\"fullscreenerror\", document),\n\t\"visibilitychange\": prefixedEvent(\"visibilitychange\", document, \"hidden\")\n};\n\nvar eventNum = 0;\nfor (var eventName in eventMap) {\n\tif (eventName === eventMap[eventName]) {\n\t\tdelete eventMap[eventName];\n\t} else {\n\t\tObject.defineProperty(eventMap, eventName, {\n\t\t\tvalue: eventMap[eventName],\n\t\t\tenumerable: true\n\t\t});\n\t\tObject.defineProperty(eventMap, eventNum, {\n\t\t\tvalue: eventName,\n\t\t\tenumerable: false\n\t\t});\n\t\teventNum++;\n\t}\n}\nObject.defineProperty(eventMap, \"length\", {\n\tvalue: eventNum\n});\n\nif (DEBUG) {\n\tconsole.log(\"prefixes enabled for %i events\", eventMap.length, Object.keys(eventMap));\n}\n\nmodule.exports = eventMap;\n\n// module.exports = eventNum > 0? eventMap : null;\n",
    "/**\n * @module app/view/base/TouchManager\n */\n\n// /** @type {module:underscore} */\n// var _ = require(\"underscore\");\n/** @type {module:hammerjs} */\nvar Hammer = require(\"hammerjs\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n\n/** @type {module:hammerjs.Tap} */\nvar Tap = Hammer.Tap;\n/** @type {module:utils/touch/SmoothPanRecognizer} */\nvar Pan = require(\"utils/touch/SmoothPanRecognizer\");\n// /** @type {module:hammerjs.Pan} */\n// var Pan = Hammer.Pan;\n\n/* -------------------------------\n/* Static private\n/* ------------------------------- */\n\n/**\n * @param el HTMLElement\n * @return {Hammer.Manager}\n */\nfunction createInstance(el) {\n\tvar manager, hpan, vpan, tap;\n\thpan = new Pan({\n\t\tthreshold: Globals.PAN_THRESHOLD,\n\t\tdirection: Hammer.DIRECTION_HORIZONTAL,\n\t\tevent: \"hpan\",\n\t});\n\tvpan = new Pan({\n\t\tthreshold: Globals.PAN_THRESHOLD,\n\t\tdirection: Hammer.DIRECTION_VERTICAL,\n\t\tevent: \"vpan\",\n\t});\n\ttap = new Tap({\n\t\t// threshold: Globals.PAN_THRESHOLD - 1\n\t});\n\tmanager = new Hammer.Manager(el);\n\tmanager.add([tap, hpan, vpan]);\n\tvpan.requireFailure(hpan);\n\t// manager.set({ domevents: true });\n\treturn manager;\n}\n\n// function createInstance(el) {\n// \treturn new Hammer(el, {\n// \t\trecognizers: [\n// \t\t\t[Tap],\n// \t\t\t[Pan, {\n// \t\t\t\tevent: 'hpan',\n// \t\t\t\tdirection: Hammer.DIRECTION_HORIZONTAL,\n// \t\t\t\tthreshold: Globals.THRESHOLD\n// \t\t\t}],\n// \t\t\t[Pan, {\n// \t\t\t\tevent: 'vpan',\n// \t\t\t\tdirection: Hammer.DIRECTION_VERTICAL,\n// \t\t\t\tthreshold: Globals.THRESHOLD\n// \t\t\t}, ['hpan']]\n// \t\t]\n// \t});\n// }\n\n// function createInstance(el) {\n// \tvar recognizers = [];\n// \tvar manager = new Hammer.Manager(el);\n//\n// \tvar hpan = new Pan({\n// \t\tevent: \"hpan\",\n// \t\tthreshold: Globals.THRESHOLD,\n// \t\tdirection: Hammer.DIRECTION_HORIZONTAL\n// \t});\n//\n// \tvar vpan = new Pan({\n// \t\tevent: \"vpan\",\n// \t\tthreshold: Globals.THRESHOLD,\n// \t\tdirection: Hammer.DIRECTION_VERTICAL\n// \t});\n//\n// \tvar tap = new Hammer.Tap();\n// \t// var tap = new Hammer.Tap({\n// \t// \tthreshold: Globals.THRESHOLD - 1,\n// \t// \tinterval: 50,\n// \t// \ttime: 200\n// \t// });\n// \trecognizers.push(vpan);\n// \trecognizers.push(hpan);\n// \trecognizers.push(tap);\n// \tmanager.add(recognizers);\n//\n// \thpan.recognizeWith([vpan]);\n// \thpan.requireFailure([vpan]);\n// \ttap.recognizeWith([vpan, hpan]);\n//\n// \t// tap.requireFailure(vpan);\n//\n// \t// manager.set({ domevents: true });\n// \treturn manager;\n// }\n\n/*https://gist.githubusercontent.com/jtangelder/361052976f044200ea17/raw/f54c2cef78d59da3f38286fad683471e1c976072/PreventGhostClick.js*/\n\n// function\tlogEvent(message) {\n// \tconsole.log(message, domev.type,\n// \t\t\"panSessionOpened: \" + panSessionOpened,\n// \t\t\"defaultPrevented: \" + domev.defaultPrevented\n// \t);\n// }\n\nvar lastTimeStamp = -1;\nvar panSessionOpened = false;\nvar upEventName = window.hasOwnProperty(\"onpointerup\") ? \"pointerup\" : \"mouseup\";\n\nvar touchHandlers = {};\ntouchHandlers[\"vpanstart vpanend vpancancel hpanstart hpanend hpancancel\"] = function(hev) {\n\t// console.log(\"TouchManager:[%s]\", hev.srcEvent.type);\n\tpanSessionOpened = !hev.isFinal;\n\tif (hev.isFinal)\n\t\tlastTimeStamp = hev.srcEvent.timeStamp;\n};\n// touchHandlers[\"hammer.input tap vpanmove hpanmove\"] = function(hev) {\n// \tconsole.log(\"TouchManager:[%s -> %s]\", hev.srcEvent.type, hev.type);\n// };\n\nvar captureHandlers = {};\ncaptureHandlers[\"click\"] = function(domev) {\n\tif (lastTimeStamp == domev.timeStamp) {\n\t\tlastTimeStamp = -1;\n\t\tdomev.defaultPrevented || domev.preventDefault();\n\t\tdomev.stopPropagation();\n\t}\n};\ncaptureHandlers[\"dragstart\"] = function(domev) {\n\tif (domev.target.nodeName == \"IMG\") {\n\t\tdomev.defaultPrevented || domev.preventDefault();\n\t}\n};\ncaptureHandlers[upEventName] = function(domev) {\n\tpanSessionOpened && domev.preventDefault();\n};\n\nvar bubblingHandlers = {};\n\n// -------------------------------\n//\n// -------------------------------\n\nfunction addHandlers() {\n\tvar eventName, el = instance.element;\n\tfor (eventName in touchHandlers)\n\t\tif (touchHandlers.hasOwnProperty(eventName))\n\t\t\tinstance.on(eventName, touchHandlers[eventName]);\n\tfor (eventName in captureHandlers)\n\t\tif (captureHandlers.hasOwnProperty(eventName))\n\t\t\tel.addEventListener(eventName, captureHandlers[eventName], true);\n\tfor (eventName in bubblingHandlers)\n\t\tif (bubblingHandlers.hasOwnProperty(eventName))\n\t\t\tel.addEventListener(eventName, bubblingHandlers[eventName], false);\n}\n\nfunction removeHandlers() {\n\tvar eventName, el = instance.element;\n\tfor (eventName in captureHandlers)\n\t\tif (captureHandlers.hasOwnProperty(eventName))\n\t\t\tel.removeEventListener(eventName, captureHandlers[eventName], true);\n\tfor (eventName in bubblingHandlers)\n\t\tif (captureHandlers.hasOwnProperty(eventName))\n\t\t\tel.removeEventListener(eventName, bubblingHandlers[eventName], true);\n}\n\n/** @type {Hammer.Manager} */\nvar instance = null;\n\n/* -------------------------------\n/* Static public\n/* ------------------------------- */\n\nvar TouchManager = {\n\tinit: function(target) {\n\t\tif (instance === null) {\n\t\t\tinstance = createInstance(target);\n\t\t\taddHandlers();\n\t\t} else if (instance.element !== target) {\n\t\t\tconsole.warn(\"TouchManager already initialized with another element\");\n\t\t}\n\t\treturn instance;\n\t},\n\n\tdestroy: function() {\n\t\tif (instance !== null) {\n\t\t\tremoveHandlers();\n\t\t\tinstance.destroy();\n\t\t\tinstance = null;\n\t\t} else {\n\t\t\tconsole.warn(\"no instance to destroy\");\n\t\t}\n\t},\n\n\tgetInstance: function() {\n\t\tif (instance === null) {\n\t\t\tconsole.error(\"TouchManager has not been initialized\");\n\t\t}\n\t\treturn instance;\n\t}\n};\n\nmodule.exports = TouchManager;",
    "/* global HTMLElement, MutationObserver */\n/**\n * @module app/view/base/View\n */\n\n/** @type {module:backbone} */\nvar Backbone = require(\"backbone\");\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n\n/* -------------------------------\n/* MutationObserver\n/* ------------------------------- */\n\nvar _cidSeed = 1;\nvar _viewsByCid = {};\n\nfunction addChildViews(el) {\n\tvar view, els = el.querySelectorAll(\"*[data-cid]\");\n\tfor (var i = 0, ii = els.length; i < ii; i++) {\n\t\tview = View.findByElement(els.item(i));\n\t\tif (view) {\n\t\t\tif (!view.attached) {\n\t\t\t\t// console.log(\"View::[attached (parent)] %s\", view.cid);\n\t\t\t\tview._elementAttached();\n\t\t\t\t// } else {\n\t\t\t\t// \tconsole.warn(\"View::[attached (parent)] %s (ignored)\", view.cid);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction removeChildViews(el) {\n\tvar view, els = el.querySelectorAll(\"*[data-cid]\");\n\tfor (var i = 0, ii = els.length; i < ii; i++) {\n\t\tview = View.findByElement(els.item(i));\n\t\tif (view) {\n\t\t\tif (view.attached) {\n\t\t\t\tconsole.log(\"View::[detached (parent)] %s\", view.cid);\n\t\t\t\tview._elementDetached();\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"View::[detached (parent)] %s (ignored)\", view.cid);\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar observer = new MutationObserver(function(mm) {\n\t// console.log(\"View::mutations %s\", JSON.stringify(mm, null, \" \"));\n\tvar i, ii, m;\n\tvar j, jj, e;\n\tvar view;\n\tfor (i = 0, ii = mm.length; i < ii; i++) {\n\t\tm = mm[i];\n\t\tif (m.type == \"childList\") {\n\t\t\tfor (j = 0, jj = m.addedNodes.length; j < jj; j++) {\n\t\t\t\te = m.addedNodes.item(j);\n\t\t\t\tview = View.findByElement(e);\n\t\t\t\tif (view) {\n\t\t\t\t\tif (!view.attached) {\n\t\t\t\t\t\t// console.log(\"View::[attached (childList)] %s\", view.cid);\n\t\t\t\t\t\tview._elementAttached();\n\t\t\t\t\t\t// } else {\n\t\t\t\t\t\t// \tconsole.warn(\"View::[attached (childList)] %s (ignored)\", view.cid);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (e instanceof HTMLElement) addChildViews(e);\n\t\t\t}\n\t\t\tfor (j = 0, jj = m.removedNodes.length; j < jj; j++) {\n\t\t\t\te = m.removedNodes.item(j);\n\t\t\t\t// console.log(\"View::[detached (childList)] %s\", e.cid);\n\t\t\t\tview = View.findByElement(e);\n\t\t\t\tif (view) {\n\t\t\t\t\tif (view.attached) {\n\t\t\t\t\t\tconsole.log(\"View::[detached (childList)] %s\", view.cid, view.attached);\n\t\t\t\t\t\tview._elementDetached();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.warn(\"View::[detached (childList)] %s (ignored)\", view.cid, view.attached);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (e instanceof HTMLElement) removeChildViews(e);\n\t\t\t}\n\t\t} else if (m.type == \"attributes\") {\n\t\t\tview = View.findByElement(m.target);\n\t\t\tif (view) {\n\t\t\t\tif (!view.attached) {\n\t\t\t\t\t// console.log(\"View::[attached (attribute)] %s\", view.cid);\n\t\t\t\t\tview._elementAttached();\n\t\t\t\t\t// } else {\n\t\t\t\t\t// \tconsole.warn(\"View::[attached (attribute)] %s (ignored)\", view.cid);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// else {\n\t\t\t// \tconsole.warn(\"View::[attributes] target has no cid (%s='%s')\", m.attributeName, m.target.getAttribute(m.attributeName), m);\n\t\t\t// }\n\t\t}\n\t}\n});\n\nobserver.observe(document.body, {\n\tattributes: true,\n\tchildList: true,\n\tsubtree: true,\n\tattributeFilter: [\"data-cid\"]\n});\n\n/* -------------------------------\n/* static private\n/* ------------------------------- */\n\n/** @type {module:app/view/base/FrameQueue} */\nvar FrameQueue = require(\"app/view/base/FrameQueue\");\n\n/** @type {module:app/view/base/PrefixedEvents} */\nvar PrefixedEvents = require(\"app/view/base/PrefixedEvents\");\n\nvar _now = window.performance ?\n\twindow.performance.now.bind(window.performance) :\n\tDate.now.bind(Date);\n// var _now = window.performance?\n// \tfunction() { return window.performance.now(); }:\n// \tfunction() { return Date.now(); };\n\nvar applyEventPrefixes = function(events) {\n\tvar selector, unprefixed;\n\tfor (selector in events) {\n\t\tunprefixed = selector.match(/^\\w+/i)[0];\n\t\tif (PrefixedEvents.hasOwnProperty(unprefixed)) {\n\t\t\tevents[selector.replace(unprefixed, PrefixedEvents[unprefixed])] = events[selector];\n\t\t\t// console.log(\"applyEventPrefixes\", unprefixed, prefixedEvents[unprefixed]);\n\t\t\tdelete events[selector];\n\t\t}\n\t}\n\treturn events;\n};\n\nvar getViewDepth = function(view) {\n\tif (!view) {\n\t\treturn null;\n\t}\n\tif (!view.attached) {\n\t\treturn NaN;\n\t}\n\tif (view.parentView === null) {\n\t\treturn 0;\n\t}\n\treturn view.parentView.viewDepth + 1;\n};\n\nfunction logAttachInfo(view, name, level) {\n\tif ([\"log\", \"info\", \"warn\", \"error\"].indexOf(level) != -1) {\n\t\tlevel = \"log\";\n\t}\n\tconsole[level].call(console, \"%s::%s [parent:%s %s %s depth:%s]\", view.cid, name, view.parentView && view.parentView.cid, view.attached ? \"attached\" : \"detached\", view._viewPhase, view.viewDepth);\n}\n\n/* -------------------------------\n/* static public\n/* ------------------------------- */\n\n\nvar View = {\n\n\t/** @const */\n\tNONE_INVALID: 0,\n\t/** @const */\n\tCHILDREN_INVALID: 1,\n\n\t/** @const */\n\tMODEL_INVALID: 2,\n\t/** @const */\n\tSTYLES_INVALID: 4,\n\t/** @const */\n\tSIZE_INVALID: 8,\n\t/** @const */\n\tLAYOUT_INVALID: 16,\n\n\t/** @const */\n\t// RENDER_INVALID: 8 | 16,\n\n\t/** @type {module:app/view/base/ViewError} */\n\tViewError: require(\"app/view/base/ViewError\"),\n\n\t/** @type {module:utils/prefixedProperty} */\n\tprefixedProperty: require(\"utils/prefixedProperty\"),\n\n\t/** @type {module:utils/prefixedStyleName} */\n\tprefixedStyleName: require(\"utils/prefixedStyleName\"),\n\n\t/** @type {module:utils/prefixedEvent} */\n\tprefixedEvent: require(\"utils/prefixedEvent\"),\n\n\t// /** @type {module:utils/setImmediate} */\n\t// setImmediate: require(\"utils/setImmediate\"),\n\n\t/** @type {module:app/view/promise/whenViewIsAttached} */\n\twhenViewIsAttached: require(\"app/view/promise/whenViewIsAttached\"),\n\n\t/**\n\t/* @param el {HTMLElement}\n\t/* @return {module:app/view/base/View}\n\t/*/\n\tfindByElement: function(el) {\n\t\tif (_viewsByCid[el.cid]) {\n\t\t\treturn _viewsByCid[el.cid];\n\t\t}\n\t\treturn null;\n\t},\n\n\t/**\n\t/* @param el {HTMLElement}\n\t/* @return {module:app/view/base/View}\n\t/*/\n\tfindByDescendant: function(el) {\n\t\tdo {\n\t\t\tif (_viewsByCid[el.cid]) {\n\t\t\t\treturn _viewsByCid[el.cid];\n\t\t\t}\n\t\t} while ((el = el.parentElement || el.parentNode));\n\t\treturn null;\n\t},\n\n\t/** @override */\n\textend: function(proto, obj) {\n\t\tif (PrefixedEvents.length && proto.events) {\n\t\t\tif (_.isFunction(proto.events)) {\n\t\t\t\tproto.events = _.wrap(proto.events, function(fn) {\n\t\t\t\t\treturn applyEventPrefixes(fn.apply(this));\n\t\t\t\t});\n\t\t\t} else\n\t\t\tif (_.isObject(proto.events)) {\n\t\t\t\tproto.events = applyEventPrefixes(proto.events);\n\t\t\t}\n\t\t}\n\t\tif (proto.properties && this.prototype.properties) {\n\t\t\t_.defaults(proto.properties, this.prototype.properties);\n\t\t}\n\t\treturn Backbone.View.extend.apply(this, arguments);\n\t},\n\n\t_flagsToStrings: [\"-\"],\n\n\tflagsToString: function(flags) {\n\t\tvar s = View._flagsToStrings[flags | 0];\n\t\tif (!s) {\n\t\t\ts = [];\n\t\t\tif (flags & View.CHILDREN_INVALID) s.push(\"children\");\n\t\t\tif (flags & View.MODEL_INVALID) s.push(\"model\");\n\t\t\tif (flags & View.STYLES_INVALID) s.push(\"styles\");\n\t\t\tif (flags & View.SIZE_INVALID) s.push(\"size\");\n\t\t\tif (flags & View.LAYOUT_INVALID) s.push(\"layout\");\n\t\t\tView._flagsToStrings[flags] = s = s.join(\" \");\n\t\t}\n\t\treturn s;\n\t\t// return (flags | 0).toString(2);\n\t},\n};\n\nObject.defineProperty(View, \"instances\", {\n\tvalue: _viewsByCid,\n\tenumerable: true\n});\n\n/* -------------------------------\n/* prototype\n/* ------------------------------- */\n\nvar ViewProto = {\n\n\t/** @type {string} */\n\tcidPrefix: \"view\",\n\t/** @type {Boolean} */\n\t_attached: false,\n\t/** @type {HTMLElement|null} */\n\t_parentView: null,\n\t/** @type {int|null} */\n\t_viewDepth: null,\n\t/** @type {string} initializing > initialized > disposing > disposed */\n\t_viewPhase: \"initializing\",\n\t/** @type {int} */\n\t_frameQueueId: -1,\n\t/** @type {int} */\n\t_renderFlags: 0,\n\n\t/** @type {object} */\n\tproperties: {\n\t\tcid: {\n\t\t\tget: function() {\n\t\t\t\treturn this._cid || (this._cid = this.cidPrefix + _cidSeed++);\n\t\t\t}\n\t\t},\n\t\tattached: {\n\t\t\tget: function() {\n\t\t\t\treturn this._attached;\n\t\t\t}\n\t\t},\n\t\tparentView: {\n\t\t\tget: function() {\n\t\t\t\treturn this._parentView;\n\t\t\t}\n\t\t},\n\t\tviewDepth: {\n\t\t\tget: function() {\n\t\t\t\treturn this._getViewDepth();\n\t\t\t}\n\t\t},\n\t\tinvalidated: {\n\t\t\tget: function() {\n\t\t\t\treturn this._frameQueueId !== -1;\n\t\t\t}\n\t\t},\n\t\tenabled: {\n\t\t\tget: function() {\n\t\t\t\treturn this._enabled;\n\t\t\t},\n\t\t\tset: function(enabled) {\n\t\t\t\tthis.setEnabled(enabled);\n\t\t\t}\n\t\t},\n\t},\n\n\t/**\n\t * @constructor\n\t * @type {module:app/view/base/View}\n\t */\n\tconstructor: function(options) {\n\t\tthis.transform = {};\n\t\tthis.childViews = {};\n\t\tthis._applyRender = this._applyRender.bind(this);\n\n\t\tif (this.properties) {\n\t\t\t// Object.defineProperties(this, getPrototypeChainValue(this, \"properties\", Backbone.View));\n\t\t\tObject.defineProperties(this, this.properties);\n\t\t}\n\t\tif (options && options.className && this.className) {\n\t\t\toptions.className += \" \" + _.result(this, \"className\");\n\t\t}\n\t\tif (options && options.parentView) {\n\t\t\tthis._setParentView(options.parentView, true);\n\t\t}\n\t\tBackbone.View.apply(this, arguments);\n\n\t\t// console.log(\"%s::initialize viewPhase:[%s => initialized]\", this.cid, this._viewPhase);\n\t\tthis._viewPhase = \"initialized\";\n\n\t\tif (this.parentView !== null) {\n\t\t\tthis.trigger(\"view:parentChange\", this.parentView, null);\n\t\t}\n\t\tif (this.attached) {\n\t\t\tthis.trigger(\"view:attached\", this);\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* remove\n\t/* ------------------------------- */\n\n\t/** @override */\n\tremove: function() {\n\t\tif (this._viewPhase == \"disposing\") {\n\t\t\tlogAttachInfo(this, \"remove\", \"warn\");\n\t\t} else {\n\t\t\t// logAttachInfo(this, \"remove\", \"log\");\n\t\t}\n\n\t\t// before removal\n\t\tthis._viewPhase = \"disposing\";\n\t\tthis._cancelRender();\n\n\t\t// call Backbone impl\n\t\t// Backbone.View.prototype.remove.apply(this, arguments);\n\n\t\t// NOTE: from Backbone impl\n\t\tthis.$el.remove(); // from Backbone impl\n\n\t\tthis._attached = false;\n\t\tthis.trigger(\"view:removed\", this);\n\n\t\t// remove parent/child references\n\t\tthis._setParentView(null);\n\n\t\t// NOTE: from Backbone impl. No more events after this\n\t\tthis.stopListening();\n\n\t\t// check for invalidations that may have been triggered by \"view:removed\"\n\t\tif (this.invalidated) {\n\t\t\tconsole.warn(\"%s::remove invalidated after remove()\", this.cid);\n\t\t\tthis._cancelRender();\n\t\t}\n\t\t// // check for children still here\n\t\t// var ccids = Object.keys(this.childViews);\n\t\t// if (ccids.length) {\n\t\t// \tconsole.warn(\"%s::remove %i children not removed [%s]\", this.cid, ccids.length, ccids.join(\", \"), this.childViews);\n\t\t// }\n\t\t// // remove childViews\n\t\t// for (var cid in this.childViews) {\n\t\t// \tthis.childViews[cid].remove();\n\t\t// }\n\t\t// clear reference in view map\n\t\tdelete _viewsByCid[this.cid];\n\t\t// delete this.el.cid;\n\t\t// update phase\n\t\tthis._viewPhase = \"disposed\";\n\t\treturn this;\n\t},\n\n\t/* -------------------------------\n\t/* _elementAttached _elementDetached\n\t/* ------------------------------- */\n\n\t_elementAttached: function() {\n\t\t// this._addToParentView();\n\t\tthis._attached = true;\n\t\tthis._viewDepth = null;\n\t\tthis._setParentView(View.findByDescendant(this.el.parentElement));\n\n\t\t// if (this.parentView) {\n\t\t// \tconsole.log(\"[attach] [%i] %s > %s::_elementAttached\", this.viewDepth, this.parentView.cid, this.cid);\n\t\t// } else {\n\t\t// \tconsole.log(\"[attach] [%i] %s::_elementAttached\", this.viewDepth, this.cid);\n\t\t// }\n\n\t\t// if (this._viewPhase == \"initializing\") {\n\t\t// \t// this.trigger(\"view:attached\", this);\n\t\t// } else\n\t\tif (this._viewPhase == \"initialized\") {\n\t\t\tthis.trigger(\"view:attached\", this);\n\t\t} else\n\t\tif (this._viewPhase == \"replacing\") {\n\t\t\tthis._viewPhase = \"initialized\";\n\t\t\tthis.trigger(\"view:replaced\", this);\n\t\t}\n\t},\n\n\t_elementDetached: function() {\n\t\tif (!this.attached || (this._viewPhase == \"disposing\") || (this._viewPhase == \"disposed\")) {\n\t\t\tlogAttachInfo(this, \"_elementDetached\", \"error\");\n\t\t\t// } else {\n\t\t\t// \tlogAttachInfo(this, \"_elementDetached\", \"log\");\n\t\t}\n\t\tthis._attached = false;\n\t\tthis._viewDepth = null;\n\n\t\tif (this._viewPhase != \"disposing\" || this._viewPhase == \"disposed\") {\n\t\t\tthis.remove();\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* parentView\n\t/* ------------------------------- */\n\n\t_setParentView: function(newParent, silent) {\n\t\tif (newParent === void 0) {\n\t\t\tconsole.warn(\"$s::_setParentView invalid value '%s'\", this.cid, newParent);\n\t\t\tnewParent = null;\n\t\t}\n\t\tvar oldParent = this._parentView;\n\t\tthis._parentView = newParent;\n\n\t\t// force update of _viewDepth\n\t\tthis._viewDepth = null; //getViewDepth(this);\n\n\t\t// skip the rest if arg is the same\n\t\tif (newParent === oldParent) {\n\t\t\treturn;\n\t\t}\n\t\tif (oldParent !== null) {\n\t\t\tif (this.cid in oldParent.childViews) {\n\t\t\t\tdelete oldParent.childViews[this.cid];\n\t\t\t}\n\t\t}\n\t\tif (newParent !== null) {\n\t\t\tnewParent.childViews[this.cid] = this;\n\t\t}\n\t\tif (!silent)\n\t\t\tthis.trigger(\"view:parentChange\", this, newParent, oldParent);\n\t},\n\n\twhenAttached: function() {\n\t\treturn View.whenViewIsAttached(this);\n\t},\n\n\t_getViewDepth: function() {\n\t\tif (this._viewDepth === null) {\n\t\t\tthis._viewDepth = getViewDepth(this);\n\t\t}\n\t\treturn this._viewDepth;\n\t},\n\n\t/* -------------------------------\n\t/* Backbone.View overrides\n\t/* ------------------------------- */\n\n\t/** @override */\n\tsetElement: function(element, delegate) {\n\t\t// setElement always initializes this.el, so check it to be non-null before calling super\n\t\tif (this.el) {\n\t\t\tif (this.el !== element && this.el.parentElement) {\n\t\t\t\t// Element is being replaced\n\t\t\t\tif (this.attached) {\n\t\t\t\t\t// Since old element is attached to document tree, _elementAttached will be\n\t\t\t\t\t// triggered by replaceChild: set _viewPhase = \"replacing\" to flag this\n\t\t\t\t\t// change and trigger 'view:replaced' instead of 'view:added'.\n\t\t\t\t\tthis._viewPhase = \"replacing\";\n\t\t\t\t}\n\t\t\t\tthis.el.parentElement.replaceChild(element, this.el);\n\t\t\t}\n\t\t\tBackbone.View.prototype.setElement.apply(this, arguments);\n\t\t\t// Merge classes specified by this view with the ones already in the element,\n\t\t\t// as backbone will not:\n\t\t\tif (this.className) {\n\t\t\t\t_.result(this, \"className\").split(\" \").forEach(function(item) {\n\t\t\t\t\tthis.el.classList.add(item);\n\t\t\t\t}, this);\n\t\t\t}\n\t\t} else {\n\t\t\tBackbone.View.prototype.setElement.apply(this, arguments);\n\t\t}\n\n\t\tif (this.el === void 0) {\n\t\t\tthrow new Error(\"Backbone view has no element\");\n\t\t}\n\t\t_viewsByCid[this.cid] = this;\n\t\tthis.el.cid = this.cid;\n\t\tthis.el.setAttribute(\"data-cid\", this.cid);\n\n\t\treturn this;\n\t},\n\n\t/* -------------------------------\n\t/* requestAnimationFrame\n\t/* ------------------------------- */\n\n\trequestAnimationFrame: function(callback, priority, ctx) {\n\t\treturn FrameQueue.request(callback.bind(ctx || this), priority);\n\t},\n\n\tcancelAnimationFrame: function(id) {\n\t\treturn FrameQueue.cancel(id);\n\t},\n\n\tsetImmediate: function(callback, ctx) {\n\t\twindow.setImmediate(callback.bind(ctx || this));\n\t},\n\n\t/* -------------------------------\n\t/* deferred render: private methods\n\t/* ------------------------------- */\n\n\t/** @private */\n\t_applyRender: function(tstamp) {\n\t\tif (!this._skipLog) {\n\t\t\tconsole.log(\"%s::_applyRender [flags: %s] [%s, %s, %s]\", this.cid,\n\t\t\t\tView.flagsToString(this._renderFlags),\n\t\t\t\t(this._frameQueueId != -1 ? \"async #\" + this._frameQueueId : \"sync\"),\n\t\t\t\t(this.attached ? \"attached\" : \"detached\"),\n\t\t\t\t(this.skipTransitions ? \"skip\" : \"run\") + \" transitions\"\n\t\t\t);\n\t\t}\n\n\t\tvar flags = this._renderFlags;\n\t\tthis.trigger(\"view:render:before\", this, flags);\n\t\tthis._renderFlags = 0;\n\t\tthis._frameQueueId = -1;\n\t\tthis._renderFlags |= this.renderFrame(tstamp, flags);\n\t\tthis.trigger(\"view:render:after\", this, flags);\n\n\t\tif (this._renderFlags != 0) {\n\t\t\tconsole.warn(\"%s::_applyRender [returned] flags: %s\", this.cid, View.flagsToString(this._renderFlags), this._renderFlags);\n\t\t}\n\t},\n\n\t_cancelRender: function() {\n\t\tif (this._frameQueueId != -1) {\n\t\t\tvar cancelId, cancelFn;\n\n\t\t\tcancelId = this._frameQueueId;\n\t\t\tthis._frameQueueId = -1;\n\t\t\tcancelFn = FrameQueue.cancel(cancelId);\n\n\t\t\tif (cancelFn === void 0) {\n\t\t\t\tconsole.warn(\"%s::_cancelRender ID:%i not found\", this.cid, cancelId);\n\t\t\t} else if (cancelFn === null) {\n\t\t\t\tconsole.warn(\"%s::_cancelRender ID:%i already cancelled\", this.cid, cancelId);\n\t\t\t\t// } else {\n\t\t\t\t// \tif (!this._skipLog && !FrameQueue.running)\n\t\t\t\t// \t\tconsole.log(\"%s::_cancelRender ID:%i cancelled\", this.cid, cancelId);\n\t\t\t}\n\t\t}\n\t},\n\n\t_requestRender: function() {\n\t\tif (this._frameQueueId == -1) {\n\t\t\tthis._frameQueueId = FrameQueue.request(this._applyRender, isNaN(this.viewDepth) ? Number.MAX_VALUE : this.viewDepth);\n\t\t\t// this._frameQueueId = FrameQueue.request(this._applyRender, 10);\n\t\t\t// if (!this._skipLog && !FrameQueue.running)\n\t\t\t// \tconsole.log(\"%s::_requestRender ID:%i rescheduled\", this.cid, this._frameQueueId);\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* render: public / abstract methods\n\t/* ------------------------------- */\n\n\trequestRender: function(flags) {\n\t\tif (flags !== void 0) {\n\t\t\tthis._renderFlags |= flags;\n\t\t}\n\t\tthis._requestRender();\n\t\treturn this;\n\t},\n\n\t/** @abstract */\n\trenderFrame: function(tstamp, flags) {\n\t\t// subclasses should override this method\n\t\treturn View.NONE_INVALID;\n\t},\n\n\trenderNow: function(alwaysRun) {\n\t\tif (this._frameQueueId != -1) {\n\t\t\tvar cancelId = this._cancelRender();\n\t\t\talwaysRun = true;\n\t\t}\n\t\t// if (alwaysRun === true) {\n\t\tif (alwaysRun) {\n\t\t\tthis._applyRender(_now());\n\t\t}\n\t\treturn this;\n\t},\n\n\t/* -------------------------------\n\t/* render bitwise flags\n\t/* - check: this._renderFlags & flags\n\t/* - add: this._renderFlags |= flags\n\t/* - remove: this._renderFlags &= ~flags\n\t/* ------------------------------- */\n\n\t/* helpers ------------------ */\n\n\trequestChildrenRender: function(flags, now, force) {\n\t\tvar ccid, view;\n\t\tfor (ccid in this.childViews) {\n\t\t\tview = this.childViews[ccid];\n\t\t\tview.skipTransitions = !!(flags & View.SIZE_INVALID);\n\t\t\tview.requestRender(flags);\n\t\t\tif (now) {\n\t\t\t\tview.renderNow(force);\n\t\t\t}\n\t\t}\n\t},\n\n\trender: function() {\n\t\treturn this.renderNow(true);\n\t},\n\n\t/* -------------------------------\n\t/* common abstract\n\t/* ------------------------------- */\n\n\t/** @private */\n\t_enabled: undefined,\n\n\t/**\n\t/* @param {Boolean}\n\t/*/\n\tsetEnabled: function(enable) {\n\t\tthis._enabled = enable;\n\t},\n};\n\nmodule.exports = Backbone.View.extend(ViewProto, View);\n",
    "function ViewError(view, err) {\n\tthis.view = view;\n\tthis.err = err;\n\tthis.message = err.message;\n}\nViewError.prototype = Object.create(Error.prototype);\nViewError.prototype.constructor = ViewError;\nViewError.prototype.name = \"ViewError\";\n\nmodule.exports = ViewError;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=container.escapeExpression, alias4=\"function\";\n\n  return \"<a href=\\\"\"\n    + alias3((helpers.global || (depth0 && depth0.global) || alias2).call(alias1,\"APP_ROOT\",{\"name\":\"global\",\"hash\":{},\"data\":data}))\n    + \"#\"\n    + alias3(((helper = (helper = helpers.handle || (depth0 != null ? depth0.handle : depth0)) != null ? helper : alias2),(typeof helper === alias4 ? helper.call(alias1,{\"name\":\"handle\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\">\"\n    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias4 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper))) != null ? stack1 : \"\")\n    + \"</a>\\n\";\n},\"useData\":true});\n",
    "/**\n/* @module app/view/component/ArticleView\n/*/\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {Function} */\nvar viewTemplate = require(\"./ArticleButton.hbs\");\n\n/**\n/* @constructor\n/* @type {module:app/view/component/ArticleButton}\n/*/\nvar ArticleButton = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"articleButton\",\n\t/** @override */\n\ttagName: \"h2\",\n\t/** @override */\n\tclassName: \"article-button\",\n\t/** @type {Function} */\n\ttemplate: viewTemplate,\n\n\tevents: {\n\t\t\"click a\": function(domev) {\n\t\t\tdomev.defaultPrevented || domev.preventDefault();\n\t\t\tthis.trigger(\"view:click\", this.model);\n\t\t}\n\t},\n\n\t// /** @override */\n\t// initialize: function(options) {},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\trenderFrame: function(tstamp, flags) {\n\t\tthis.el.innerHTML = this.template(this.model.toJSON());\n\t},\n});\nmodule.exports = ArticleButton;",
    "/**\n/* @module app/view/component/ArticleView\n/*/\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n\n// /** @type {module:utils/net/toAbsoluteURL} */\n// var toAbsoluteURL = require(\"utils/net/toAbsoluteURL\");\n//\n// /** @type {string} */\n// var ABS_APP_ROOT = toAbsoluteURL(require(\"app/control/Globals\").APP_ROOT);\n\n/**\n/* @constructor\n/* @type {module:app/view/component/ArticleView}\n/*/\nvar ArticleView = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"articleView\",\n\t/** @override */\n\ttagName: \"article\",\n\t/** @override */\n\tclassName: \"article-view markdown-html\",\n\n\t/** @override */\n\tinitialize: function(options) {},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\trenderFrame: function(tstamp, flags) {\n\t\tthis.el.innerHTML = this.model.get(\"text\");\n\t\t// FIXME: now done in xslt\n\t\t// this.el.querySelectorAll(\"a[href]\").forEach(function(el) {\n\t\t// \tvar url = toAbsoluteURL(el.getAttribute(\"href\"));\n\t\t// \tif (url.indexOf(ABS_APP_ROOT) !== 0) {\n\t\t// \t\tel.setAttribute(\"target\", \"_blank\");\n\t\t// \t}\n\t\t// });\n\t},\n});\nmodule.exports = ArticleView;",
    "/**\n/* @module app/view/component/Carousel\n/*/\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:hammerjs} */\nvar Hammer = require(\"hammerjs\");\n/** @type {module:backbone.babysitter} */\nvar Container = require(\"backbone.babysitter\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n// /** @type {module:app/view/base/DeferredView} */\n// var View = require(\"app/view/base/DeferredView\");\n\n/** @type {module:app/view/render/CarouselRenderer} */\nvar CarouselRenderer = require(\"app/view/render/CarouselRenderer\");\n\n/** @type {module:utils/prefixedProperty} */\nvar prefixedProperty = require(\"utils/prefixedProperty\");\n/** @type {module:utils/prefixedStyleName} */\nvar prefixedStyleName = require(\"utils/prefixedStyleName\");\n\nvar transformStyleName = prefixedStyleName(\"transform\");\nvar transformProperty = prefixedProperty(\"transform\");\nvar translateTemplate = Globals.TRANSLATE_TEMPLATE;\n\n// var cssToPx = function(cssVal, el) {\n// \treturn parseInt(cssVal);\n// };\n\n// var defaultRendererFunction = (function() {\n// \tvar defaultRenderer = CarouselRenderer.extend({ className: \"carousel-item default-renderer\"}),\n// \t\temptyRenderer = CarouselRenderer.extend({ className: \"carousel-item empty-renderer\"});\n// \treturn function(item, index, arr) {\n// \t\treturn (index === -1)? emptyRenderer: defaultRenderer;\n// \t};\n// })();\n\n/** @const */\nvar MAX_SELECT_THRESHOLD = 20;\n\n// /** @const */\n// var CHILDREN_INVALID = View.CHILDREN_INVALID,\n// \tSTYLES_INVALID = View.STYLES_INVALID,\n// \tMODEL_INVALID = View.MODEL_INVALID,\n// \tSIZE_INVALID = View.SIZE_INVALID,\n// \tLAYOUT_INVALID = View.LAYOUT_INVALID;\n\nvar VERTICAL = Hammer.DIRECTION_VERTICAL,\n\tHORIZONTAL = Hammer.DIRECTION_HORIZONTAL;\n\n// x: [\"x\", \"y\"],\n// y: [\"y\", \"x\"],\n// offsetLeft: [\"offsetLeft\", \"offsetTop\"],\n// offsetTop: [\"offsetTop\", \"offsetLeft\"],\n// offsetWidth: [\"offsetWidth\", \"offsetHeight\"],\n// offsetHeight: [\"offsetHeight\", \"offsetWidth\"],\n// width: [\"width\",\"height\"],\n// height: [\"height\",\"width\"],\n// marginLeft: [\"marginLeft\",\"marginTop\"],\n// marginRight: [\"marginRight\",\"marginBottom\"],\n\n/*\nvar HORIZONTAL_PROPS = {\n\tpos: \"x\",\n\tsize: \"width\",\n\toffsetPos: \"offsetLeft\",\n\toffsetSize: \"offsetWidth\",\n\tmarginBefore: \"marginLeft\",\n\tmarginAfter: \"marginRight\",\n};\nvar VERTICAL_PROPS = {\n\tpos: \"y\",\n\tsize: \"height\",\n\toffsetPos: \"offsetTop\",\n\toffsetSize: \"offsetHeight\",\n\tmarginBefore: \"marginTop\",\n\tmarginAfter: \"marginBottom\",\n};\n*/\n\n// var DIRECTION_NONE = 1;\n// var DIRECTION_LEFT = 2;\n// var DIRECTION_RIGHT = 4;\n// var DIRECTION_UP = 8;\n// var DIRECTION_DOWN = 16;\n\n// function dirToStr(dir) {\n// \tif (dir === Hammer.DIRECTION_NONE) return 'NONE';\n// \tif (dir === Hammer.DIRECTION_LEFT) return 'LEFT';\n// \tif (dir === Hammer.DIRECTION_RIGHT) return 'RIGHT';\n// \tif (dir === Hammer.DIRECTION_UP) return 'UP';\n// \tif (dir === Hammer.DIRECTION_DOWN) return 'DOWN';\n// \tif (dir === Hammer.DIRECTION_HORIZONTAL) return 'HORIZONTAL';\n// \tif (dir === Hammer.DIRECTION_VERTICAL) return 'VERTICAL';\n// \tif (dir === Hammer.DIRECTION_ALL) return 'ALL';\n// \treturn 'UNRECOGNIZED';\n// }\n\nvar isValidTouchManager = function(touch, direction) {\n\t// var retval;\n\ttry {\n\t\treturn touch.get(\"hpan\").options.direction == direction;\n\t} catch (err) {\n\t\treturn false;\n\t}\n\t// return retval;\n};\n\n// /** @type {int} In pixels */\n// var panThreshold: 15;\n\nvar createTouchManager = function(el, dir, thres) {\n\tvar touch = new Hammer.Manager(el);\n\tvar pan = new Hammer.Pan({\n\t\tthreshold: 15,\n\t\tdirection: dir,\n\t});\n\tvar tap = new Hammer.Tap({\n\t\tthreshold: thres - 1,\n\t\tinterval: 50,\n\t\ttime: 200,\n\t});\n\ttap.recognizeWith(pan);\n\ttouch.add([pan, tap]);\n\treturn touch;\n};\n\n\nvar Carousel = {\n\t/** const */\n\tANIMATED: false,\n\t/** const */\n\tIMMEDIATE: true,\n\n\t/** copy of Hammer.DIRECTION_VERTICAL */\n\tDIRECTION_VERTICAL: VERTICAL,\n\t/** copy of Hammer.DIRECTION_HORIZONTAL */\n\tDIRECTION_HORIZONTAL: HORIZONTAL,\n\t/** @type {Object} */\n\tdefaults: {\n\t\t/** @type {boolean} */\n\t\tselectOnScrollEnd: false,\n\t\t/** @type {boolean} */\n\t\trequireSelection: false,\n\t\t/** @type {int} */\n\t\tdirection: HORIZONTAL,\n\t\t/** @type {int} In pixels */\n\t\tselectThreshold: 20,\n\t\t/** @type {Function} */\n\t\trendererFunction: (function() {\n\t\t\tvar defaultRenderer = CarouselRenderer.extend({\n\t\t\t\t\tclassName: \"carousel-item default-renderer\"\n\t\t\t\t}),\n\t\t\t\temptyRenderer = CarouselRenderer.extend({\n\t\t\t\t\tclassName: \"carousel-item empty-renderer\"\n\t\t\t\t});\n\t\t\treturn function(item, index, arr) {\n\t\t\t\treturn (index === -1) ? emptyRenderer : defaultRenderer;\n\t\t\t};\n\t\t})(),\n\t},\n};\nCarousel.validOptions = _.keys(Carousel.defaults);\n\n/**\n/* @constructor\n/* @type {module:app/view/component/Carousel}\n/*/\nvar CarouselProto = {\n\n\t/** @override */\n\tcidPrefix: \"carousel\",\n\t/** @override */\n\ttagName: \"div\",\n\t/** @override */\n\tclassName: \"carousel skip-transitions\",\n\n\t/* --------------------------- *\n\t/* properties\n\t/* --------------------------- */\n\n\tproperties: {\n\t\tscrolling: {\n\t\t\tget: function() {\n\t\t\t\treturn this._scrolling;\n\t\t\t}\n\t\t},\n\t},\n\n\tevents: {\n\t\t// \"mousedown\": \"_onMouseDown\", \"mouseup\": \"_onMouseUp\",\n\t\t\"transitionend .carousel-item.selected\": \"_onScrollTransitionEnd\",\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t_.bindAll(this, \"_onTouchEvent\");\n\n\t\tthis.itemViews = new Container();\n\t\tthis.metrics = {};\n\n\t\t_.extend(this, _.defaults(_.pick(options, Carousel.validOptions), Carousel.defaults));\n\n\t\t// this.childGap = 0; //this.dirProp(20, 18);\n\t\tthis._precedingDir = (Hammer.DIRECTION_LEFT | Hammer.DIRECTION_UP) & this.direction;\n\t\tthis._followingDir = (Hammer.DIRECTION_RIGHT | Hammer.DIRECTION_DOWN) & this.direction;\n\n\t\t// use supplied touch mgr or create private\n\t\tif (isValidTouchManager(options.touch, this.direction)) {\n\t\t\tthis.touch = options.touch;\n\t\t} else {\n\t\t\tconsole.warn(\"%s::initializeHammer using private Hammer instance\", this.cid);\n\t\t\tthis.touch = createTouchManager(this.el, this.direction);\n\t\t\t// this.on(\"view:removed\", this.touch.destroy, this.touch);\n\t\t\tthis.listenTo(this, \"view:removed\", function() {\n\t\t\t\tthis.touch.destroy();\n\t\t\t});\n\t\t}\n\n\t\t/* create children and props */\n\t\tthis.setEnabled(true);\n\t\tthis.skipTransitions = true;\n\t\tthis._renderFlags = View.CHILDREN_INVALID;\n\t\t// this.invalidateChildren();\n\n\t\tthis.listenTo(this, \"view:attached\", function() {\n\t\t\tthis.skipTransitions = true;\n\t\t\t// this.invalidateSize();\n\t\t\t// this.renderNow();\n\t\t\t// this.requestRender();\n\t\t\tthis.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);\n\t\t});\n\n\t\t/* collection listeners */\n\t\tthis.listenTo(this.collection, {\n\t\t\t\"reset\": this._onReset,\n\t\t\t\"select:one\": this._onSelectOne,\n\t\t\t\"select:none\": this._onSelectNone,\n\t\t\t\"deselect:one\": this._onDeselectAny,\n\t\t\t\"deselect:none\": this._onDeselectAny,\n\t\t});\n\t},\n\t/* --------------------------- *\n\t/* Hammer init\n\t/* --------------------------- */\n\n\t// validateTouchManager: function(touch, direction) {\n\t// \ttry {\n\t// \t\treturn touch.get(\"pan\").options.direction === direction);\n\t// \t} catch (err) {\n\t// \t\treturn false;\n\t// \t}\n\t// },\n\n\t// initializeHammer: function(options) {\n\t// \t// direction from opts/defaults\n\t// \tif (options.direction === VERTICAL) {\n\t// \t\tthis.direction = VERTICAL;\n\t// \t} // do nothing: the default is horizontal\n\t//\n\t// \t// validate hammer instance or create local\n\t// \tif ((touch = options.touch) && (pan = touch.get(\"pan\"))) {\n\t// \t\t// Override direction only if specific\n\t// \t\tif (pan.options.direction !== Hammer.DIRECTION_ALL) {\n\t// \t\t\tthis.direction = pan.options.direction;\n\t// \t\t}\n\t// \t\tthis.panThreshold = pan.options.threshold;\n\t// \t} else {\n\t// \t\tconsole.warn(\"%s::initializeHammer using private Hammer instance\", this.cid);\n\t// \t\ttouch = createHammerInstance(this.el, this.panThreshold, this.direction);\n\t// \t\tthis.on(\"view:removed\", touch.destroy, touch);\n\t// \t}\n\t// \tthis.touch = touch;\n\t// },\n\n\tremove: function() {\n\t\t// this._scrollPendingAction && this._scrollPendingAction(true);\n\t\t// if (this._enabled) {\n\t\t// \tthis.touch.off(\"tap\", this._onTap);\n\t\t// \tthis.touch.off(\"hpanstart hpanmove hpanend hpancancel\", this._onPan);\n\t\t// }\n\t\tthis._toggleTouchEvents(false);\n\t\tthis.removeChildren();\n\t\tView.prototype.remove.apply(this, arguments);\n\t\treturn this;\n\t},\n\n\n\t/* --------------------------- *\n\t/* helper functions\n\t/* --------------------------- */\n\n\tdirProp: function(hProp, vProp) {\n\t\treturn (this.direction & HORIZONTAL) ? hProp : vProp;\n\t},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\t// render: function() {\n\t// \tif (this.attached) {\n\t// \t\tthis.skipTransitions = true;\n\t// \t\t// this.invalidateSize();\n\t// \t\tthis.renderNow(true);\n\t// \t}\n\t// },\n\n\t// /** @override */\n\t// render: function () {\n\t// \tif (!this.attached) {\n\t// \t\tif (!this._renderPending) {\n\t// \t\t\tthis._renderPending = true;\n\t// \t\t\tthis.listenTo(this, \"view:attached\", this.render);\n\t// \t\t}\n\t// \t} else {\n\t// \t\tif (this._renderPending) {\n\t// \t\t\tthis._renderPending = false;\n\t// \t\t\tthis.stopListening(this, \"view:attached\", this.render);\n\t// \t\t}\n\t// \t\tthis._delta = 0;\n\t// \t\tthis.skipTransitions = true;\n\t// \t\tthis.invalidateSize();\n\t// \t\t// this.invalidateLayout();\n\t// \t\tthis.renderNow();\n\t// \t}\n\t// \treturn this;\n\t// },\n\n\t// render: function () {\n\t// \tthis.measureLater();\n\t// \tthis.scrollBy(0, Carousel.IMMEDIATE);\n\t//\n\t// \tif (this.el.parentElement) {\n\t// \t\tthis.renderNow();\n\t// \t}\n\t// \treturn this;\n\t// },\n\n\t/** @override */\n\trenderFrame: function(tstamp, flags) {\n\t\tif (flags & View.CHILDREN_INVALID) {\n\t\t\tthis._createChildren();\n\t\t\t// clear this flag now: render may be deferred until attached\n\t\t\tflags &= ~View.CHILDREN_INVALID;\n\t\t}\n\t\tif (this.attached) {\n\t\t\tif (flags & View.SIZE_INVALID) {\n\t\t\t\tthis._measure();\n\t\t\t}\n\t\t\tif (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {\n\t\t\t\tthis._scrollBy(this._delta, this.skipTransitions);\n\t\t\t}\n\t\t} else if (flags) {\n\t\t\tthis.listenToOnce(this, \"view:attached\", function() {\n\t\t\t\tthis.requestRender(flags);\n\t\t\t});\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* enabled\n\t/* --------------------------- */\n\n\t/** @override */\n\t_enabled: undefined,\n\n\t/** @override */\n\tsetEnabled: function(enabled) {\n\t\tif (this._enabled !== enabled) {\n\t\t\tthis._enabled = enabled;\n\t\t\t// toggle events immediately\n\t\t\tthis._toggleTouchEvents(enabled);\n\t\t\t// dom manipulation on render (_renderEnabled)\n\t\t\t// this._renderFlags |= View.STYLES_INVALID;\n\t\t\t// this.requestRender();\n\n\t\t\tthis.el.classList.toggle(\"disabled\", !this.enabled);\n\t\t\tthis.itemViews.each(function(view) {\n\t\t\t\tview.setEnabled(this.enabled);\n\t\t\t}, this);\n\t\t}\n\t},\n\n\t_renderEnabled: function() {\n\t\tthis.el.classList.toggle(\"disabled\", !this.enabled);\n\t\tthis.itemViews.each(function(view) {\n\t\t\tview.setEnabled(this.enabled);\n\t\t}, this);\n\t},\n\n\t/* --------------------------- *\n\t/* Create children\n\t/* --------------------------- */\n\n\t_createChildren: function() {\n\t\t// var sIndex;\n\t\tvar buffer, renderer, view, viewOpts;\n\n\t\tthis.removeChildren();\n\n\t\tif (this.collection.length) {\n\t\t\tviewOpts = {\n\t\t\t\t// viewDepth: this.viewDepth + 1,\n\t\t\t\t// parentView: this,\n\t\t\t\tenabled: this.enabled\n\t\t\t};\n\t\t\tbuffer = document.createDocumentFragment();\n\t\t\t// buffer = this.el;\n\n\t\t\tif (!this.requireSelection) {\n\t\t\t\trenderer = this.rendererFunction(null, -1, this.collection);\n\t\t\t\tview = new renderer(viewOpts);\n\t\t\t\tthis.itemViews.add(view);\n\t\t\t\tbuffer.appendChild(view.el);\n\t\t\t\tthis.emptyView = view;\n\t\t\t}\n\n\t\t\tthis.collection.each(function(item, index, arr) {\n\t\t\t\tviewOpts.model = item;\n\t\t\t\trenderer = this.rendererFunction(item, index, arr);\n\t\t\t\tview = new renderer(viewOpts);\n\t\t\t\tthis.itemViews.add(view);\n\t\t\t\tbuffer.appendChild(view.el);\n\t\t\t}, this);\n\n\t\t\t// if (!this.requireSelection) {\n\t\t\t// \tbuffer = this.appendItemView(buffer, this.model, -1, this.collection);\n\t\t\t// \tthis.emptyView = this.itemViews.first();\n\t\t\t// }\n\t\t\t// buffer = this.collection.reduce(this.appendItemView, buffer, this);\n\n\t\t\tthis.adjustToSelection();\n\t\t\tthis._selectedView.el.classList.add(\"selected\");\n\n\t\t\tthis.el.appendChild(buffer);\n\t\t}\n\t},\n\n\t// appendItemView: function (parentEl, model, index, arr) {\n\t// \tvar renderer = this.rendererFunction(model, index, arr);\n\t// \tvar view = new renderer({\n\t// \t\tmodel: model,\n\t// \t\tparentView: this,\n\t// \t\tenabled: this.enabled\n\t// \t});\n\t// \tthis.itemViews.add(view);\n\t// \tparentEl.appendChild(view.el);\n\t// \treturn parentEl;\n\t// },\n\n\t// createItemView: function (renderer, opts) {\n\t// \tvar view = new renderer(opts);\n\t// \tthis.itemViews.add(view);\n\t// \treturn view;\n\t// },\n\n\tremoveChildren: function() {\n\t\tthis.itemViews.each(this.removeItemView, this);\n\t\tthis.emptyView = void 0;\n\t},\n\n\tremoveItemView: function(view) {\n\t\tthis.itemViews.remove(view);\n\t\tview.remove();\n\t\treturn view;\n\t},\n\n\t/* --------------------------- *\n\t/* measure\n\t/* --------------------------- */\n\n\t_measure: function() {\n\t\tvar m, mm;\n\t\tvar pos = 0,\n\t\t\tposInner = 0;\n\t\tvar maxAcross = 0,\n\t\t\tmaxOuter = 0;\n\t\tvar maxOuterView, maxAcrossView;\n\n\t\tmaxOuterView = maxAcrossView = this.emptyView || this.itemViews.first();\n\n\t\t// chidren metrics\n\t\tthis.itemViews.each(function(view) {\n\t\t\tview.render();\n\t\t});\n\n\t\tthis.itemViews.each(function(view) {\n\t\t\tm = this.measureItemView(view);\n\t\t\tm.pos = pos;\n\t\t\tpos += m.outer; // + this.childGap;\n\t\t\tm.posInner = posInner;\n\t\t\tposInner += m.inner; //+ this.childGap;\n\t\t\tif (view !== this.emptyView) {\n\t\t\t\tif (m.across > maxAcross) {\n\t\t\t\t\tmaxAcross = m.across;\n\t\t\t\t\tmaxAcrossView = view;\n\t\t\t\t}\n\t\t\t\tif (m.outer > maxOuter) {\n\t\t\t\t\tmaxOuter = m.outer;\n\t\t\t\t\tmaxOuterView = view;\n\t\t\t\t}\n\t\t\t}\n\t\t}, this);\n\n\t\t// measure self + max child metrics\n\t\tmm = this.metrics[this.cid] || (this.metrics[this.cid] = {});\n\t\tmm.outer = this.el[this.dirProp(\"offsetWidth\", \"offsetHeight\")];\n\t\tmm.before = maxOuterView.el[this.dirProp(\"offsetLeft\", \"offsetTop\")];\n\t\tmm.inner = maxOuterView.el[this.dirProp(\"offsetWidth\", \"offsetHeight\")];\n\t\tmm.after = mm.outer - (mm.inner + mm.before);\n\t\tmm.across = maxAcross;\n\n\t\t// m = this.metrics[maxOuterView.cid];\n\t\t// mm.inner = m.inner;\n\n\t\t// tap area\n\t\tthis._tapAcrossBefore = maxAcrossView.el[this.dirProp(\"offsetTop\", \"offsetLeft\")];\n\t\tthis._tapAcrossAfter = this._tapAcrossBefore + maxAcross;\n\t\tthis._tapBefore = mm.before + this._tapGrow;\n\t\tthis._tapAfter = mm.before + mm.inner - this._tapGrow;\n\n\t\tthis.selectThreshold = Math.min(MAX_SELECT_THRESHOLD, mm.outer * 0.1);\n\t},\n\n\tmeasureItemView: function(view) {\n\t\tvar m, viewEl;\n\t\t// var s, sizeEl;\n\n\t\tviewEl = view.el;\n\t\tm = this.metrics[view.cid] || (this.metrics[view.cid] = {});\n\n\t\tm.outer = viewEl[this.dirProp(\"offsetWidth\", \"offsetHeight\")];\n\t\tm.across = viewEl[this.dirProp(\"offsetHeight\", \"offsetWidth\")];\n\n\t\tif (view.metrics) {\n\t\t\tm.before = view.metrics[this.dirProp(\"marginLeft\", \"marginTop\")];\n\t\t\tm.outer += m.before;\n\t\t\tm.outer += view.metrics[this.dirProp(\"marginRight\", \"marginBottom\")];\n\t\t\tm.inner = view.metrics.content[this.dirProp(\"width\", \"height\")];\n\t\t\tm.before += view.metrics.content[this.dirProp(\"x\", \"y\")];\n\t\t\tm.after = m.outer - (m.inner + m.before);\n\n\t\t\t// var marginBefore = view.metrics[this.dirProp(\"marginLeft\",\"marginTop\")];\n\t\t\t// var marginAfter = view.metrics[this.dirProp(\"marginRight\",\"marginBottom\")];\n\t\t\t// var pos = view.metrics.content[this.dirProp(\"x\",\"y\")];\n\t\t\t//\n\t\t\t// m.inner = view.metrics.content[this.dirProp(\"width\",\"height\")];\n\t\t\t// m.before = marginBefore + pos;\n\t\t\t// m.outer += marginBefore + marginAfter;\n\t\t\t// m.after = m.outer - (m.inner + m.before);\n\t\t} else {\n\t\t\t// throw new Error(\"renderer has no metrics\");\n\t\t\tconsole.warn(\"%s::measureItemView view '%s' has no metrics\", this.cid, view.cid);\n\t\t\tm.inner = m.outer;\n\t\t\tm.after = m.before = 0;\n\t\t}\n\n\t\treturn m;\n\t},\n\n\t/* --------------------------- *\n\t/* scrolling property\n\t/* --------------------------- */\n\n\t_delta: 0,\n\n\t_scrolling: false,\n\n\t_setScrolling: function(scrolling) {\n\t\t// console.warn(\"_setScrolling current/requested\", this._scrolling, scrolling);\n\t\tif (this._scrolling != scrolling) {\n\t\t\tthis._scrolling = scrolling;\n\t\t\tthis.el.classList.toggle(\"scrolling\", scrolling);\n\t\t\tthis.trigger(scrolling ? \"view:scrollstart\" : \"view:scrollend\");\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Scroll/layout\n\t/* --------------------------- */\n\n\tscrollBy: function(delta, skipTransitions) {\n\t\tthis._delta = delta || 0;\n\t\tthis.skipTransitions = !!skipTransitions;\n\t\t// this.invalidateLayout();\n\t\tthis.requestRender(View.LAYOUT_INVALID);\n\t},\n\n\t_scrollBy: function(delta, skipTransitions) {\n\t\tvar sMetrics, metrics, pos;\n\n\t\tsMetrics = this.metrics[(this._scrollCandidateView || this._selectedView).cid];\n\t\tthis.itemViews.each(function(view) {\n\t\t\tmetrics = this.metrics[view.cid];\n\t\t\tpos = Math.floor(this._getScrollOffset(delta, metrics, sMetrics));\n\t\t\tview.metrics.translateX = (this.direction & HORIZONTAL) ? pos : 0;\n\t\t\tview.metrics.translateY = (this.direction & HORIZONTAL) ? 0 : pos;\n\t\t\tview.metrics._transform = translateTemplate(view.metrics.translateX, view.metrics.translateY);\n\t\t\tview.el.style[transformProperty] = view.metrics._transform;\n\t\t\t// view.el.style[transformProperty] = (this.direction & HORIZONTAL)?\n\t\t\t// \t\"translate3d(\" + pos + \"px,0,0)\":\n\t\t\t// \t\"translate3d(0,\" + pos + \"px,0)\";\n\t\t}, this);\n\n\t\tthis.el.classList.toggle(\"skip-transitions\", skipTransitions);\n\t\tthis.selectFromView();\n\t},\n\n\t_getScrollOffset: function(delta, mCurr, mSel) {\n\t\tvar pos, offset = 0;\n\n\t\tpos = mCurr.pos - mSel.pos + delta;\n\t\tif (pos < 0) {\n\t\t\tif (Math.abs(pos) < mCurr.outer) {\n\t\t\t\toffset += (-mCurr.after) / mCurr.outer * pos;\n\t\t\t} else {\n\t\t\t\toffset += mCurr.after;\n\t\t\t}\n\t\t} else\n\t\tif (0 <= pos) {\n\t\t\tif (Math.abs(pos) < mCurr.outer) {\n\t\t\t\toffset -= mCurr.before / mCurr.outer * pos;\n\t\t\t} else {\n\t\t\t\toffset -= mCurr.before;\n\t\t\t}\n\t\t}\n\t\treturn pos + offset;\n\t},\n\n\t_onScrollTransitionEnd: function(ev) {\n\t\tif (ev.propertyName === transformStyleName && this.scrolling) {\n\t\t\tconsole.log(\"%s::_onScrollTransitionEnd selected: %s\", this.cid, ev.target.cid);\n\t\t\tthis._setScrolling(false);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* toggle touch events\n\t/* --------------------------- */\n\n\t_toggleTouchEvents: function(enable) {\n\t\t// console.log(\"%s::_toggleTouchEvents\", this.cid, enable);\n\t\tif (this._touchEventsEnabled !== enable) {\n\t\t\tthis._touchEventsEnabled = enable;\n\t\t\tif (enable) {\n\t\t\t\tthis.touch.on(\"hpanstart hpanmove hpanend hpancancel tap\", this._onTouchEvent);\n\t\t\t} else {\n\t\t\t\tthis.touch.off(\"hpanstart hpanmove hpanend hpancancel tap\", this._onTouchEvent);\n\t\t\t}\n\t\t}\n\t},\n\n\t_onTouchEvent: function(ev) {\n\t\t// console.log(\"%s::_onTouchEvent\", this.cid, ev.type);\n\t\tswitch (ev.type) {\n\t\t\tcase \"tap\":\n\t\t\t\treturn this._onTap(ev);\n\t\t\tcase \"hpanstart\":\n\t\t\t\treturn this._onPanStart(ev);\n\t\t\tcase \"hpanmove\":\n\t\t\t\treturn this._onPanMove(ev);\n\t\t\tcase \"hpanend\":\n\t\t\t\treturn this._onPanFinal(ev);\n\t\t\tcase \"hpancancel\":\n\t\t\t\treturn this._onPanFinal(ev);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* touch event: pan\n\t/* --------------------------- */\n\n\t// _panCapturedOffset: 0,\n\n\t/** @param {Object} ev */\n\t_onPanStart: function(ev) {\n\t\tthis.selectFromView();\n\t\tthis.el.classList.add(\"panning\");\n\t\tthis._setScrolling(true);\n\t},\n\n\t/** @param {Object} ev */\n\t_onPanMove: function(ev) {\n\t\tvar view = this.getViewAtPanDir(ev.offsetDirection);\n\t\tvar delta = (this.direction & HORIZONTAL) ? ev.thresholdDeltaX : ev.thresholdDeltaY;\n\t\t// var delta = (this.direction & HORIZONTAL) ? ev.deltaX : ev.deltaY;\n\n\t\tif (this._panCandidateView !== view) {\n\t\t\tthis._panCandidateView && this._panCandidateView.el.classList.remove(\"candidate\");\n\t\t\tthis._panCandidateView = view;\n\t\t\tthis._panCandidateView && this._panCandidateView.el.classList.add(\"candidate\");\n\t\t}\n\t\tif (this._panCandidateView === void 0) {\n\t\t\tdelta *= Globals.HPAN_OUT_DRAG;\n\t\t}\n\n\t\tif (this._renderRafId !== -1) {\n\t\t\tthis.scrollBy(delta, Carousel.IMMEDIATE);\n\t\t\tthis.renderNow();\n\t\t} else {\n\t\t\tthis._scrollBy(delta, Carousel.IMMEDIATE);\n\t\t}\n\t},\n\n\t/** @param {Object} ev */\n\t_onPanFinal: function(ev) {\n\t\tvar scrollCandidate;\n\t\t// NOTE: this delta is used for determining selection, NOT for layout\n\t\tvar delta = (this.direction & HORIZONTAL) ? ev.thresholdDeltaX : ev.thresholdDeltaY;\n\t\t// var delta = (this.direction & HORIZONTAL) ? ev.deltaX : ev.deltaY;\n\n\t\tif ((ev.type == \"hpanend\")\n\t\t\t/* pan direction (current event) and offsetDirection (whole gesture) must match */\n\t\t\t&& (ev.direction ^ ev.offsetDirection ^ this.direction)\n\t\t\t// && (ev.direction & ev.offsetDirection & this.direction)\n\t\t\t/* gesture must overshoot selectThreshold */\n\t\t\t&& (Math.abs(delta) > this.selectThreshold)) {\n\t\t\t/* choose next scroll target */\n\t\t\tscrollCandidate = this.getViewAtPanDir(ev.offsetDirection);\n\t\t}\n\t\tthis._scrollCandidateView = scrollCandidate || void 0;\n\n\t\tif (this._panCandidateView && (this._panCandidateView !== scrollCandidate)) {\n\t\t\tthis._panCandidateView.el.classList.remove(\"candidate\");\n\t\t}\n\t\tthis._panCandidateView = void 0;\n\t\tthis.el.classList.remove(\"panning\");\n\n\t\tthis.scrollBy(0, Carousel.ANIMATED);\n\t\tthis.selectFromView();\n\n\t\t// if (this._renderRafId !== -1) {\n\t\t// \tthis.scrollBy(0, Carousel.ANIMATED);\n\t\t// \tthis.renderNow();\n\t\t// } else {\n\t\t// \tthis._scrollBy(0, Carousel.ANIMATED);\n\t\t// }\n\t},\n\n\t/* --------------------------- *\n\t/* touch event: tap\n\t/* --------------------------- */\n\n\tgetViewAtPanDir: function(dir) {\n\t\t// return (dir & this._precedingDir) ? this._precedingView : this._followingView;\n\t\treturn (dir & this._followingDir) ? this._precedingView : this._followingView;\n\t},\n\n\t/** @type {int} In pixels */\n\t_tapGrow: 10,\n\n\tgetViewAtTapPos: function(pos, posAcross) {\n\t\tif (this._tapAcrossBefore < posAcross && posAcross < this._tapAcrossAfter) {\n\t\t\tif (pos < this._tapBefore) {\n\t\t\t\treturn this._precedingView;\n\t\t\t} else if (pos > this._tapAfter) {\n\t\t\t\treturn this._followingView;\n\t\t\t}\n\t\t}\n\t\treturn void 0;\n\t},\n\n\t_onTap: function(ev) {\n\t\tvar targetView = View.findByDescendant(ev.target);\n\t\t// if (!this.itemViews.contains(targetView)) {\n\t\t// \treturn;\n\t\t// }\n\t\tdo {\n\t\t\tif (this._selectedView === targetView) {\n\t\t\t\t// console.log(\"%s tap ocurred on selected: %o\", this.cid, targetView);\n\t\t\t\treturn;\n\t\t\t} else if (this === targetView) {\n\t\t\t\t// console.log(\"%s tap ocurred on carousel: %o\", this.cid, targetView);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} while ((targetView = targetView.parentView))\n\n\t\t// this.selectFromView();\n\n\t\tvar bounds = this.el.getBoundingClientRect();\n\t\tvar tapX = ev.center.x - bounds.left;\n\t\tvar tapY = ev.center.y - bounds.top;\n\t\tvar tapCandidate = this.getViewAtTapPos(\n\t\t\tthis.dirProp(tapX, tapY),\n\t\t\tthis.dirProp(tapY, tapX)\n\t\t);\n\n\t\tif (tapCandidate) {\n\t\t\tconsole.log(\"%s::_onTap %o\", this.cid, ev);\n\t\t\tev.preventDefault();\n\t\t\t// ev.stopPropagation();\n\n\t\t\t// this._scrollCandidateView = tapCandidate;\n\t\t\t// this._setScrolling(true);\n\t\t\t// this.scrollBy(0, Carousel.ANIMATED);\n\t\t\t// this._scrollCandidateView.el.classList.add(\"candidate\");\n\t\t\t// this.selectFromView();\n\n\t\t\t//// NOT using internalSelection\n\t\t\t// this.triggerSelectionEvents(tapCandidate, false);\n\n\t\t\t// using internalSelection\n\t\t\tthis._scrollCandidateView = tapCandidate;\n\t\t\tthis._setScrolling(true);\n\t\t\tthis.scrollBy(0, Carousel.ANIMATED);\n\n\t\t\tthis.triggerSelectionEvents(tapCandidate, true);\n\t\t\t// this.renderNow();\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Private\n\t/* --------------------------- */\n\n\ttriggerSelectionEvents: function(view, internal) {\n\t\tif (view === void 0 || this._internalSelection) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._internalSelection = !!internal;\n\t\tif (view === this.emptyView) {\n\t\t\tthis.trigger(\"view:select:none\");\n\t\t} else {\n\t\t\tthis.trigger(\"view:select:one\", view.model);\n\t\t}\n\t\tthis._internalSelection = false;\n\t},\n\n\tselectFromView: function() {\n\t\tif (this._scrollCandidateView === void 0) {\n\t\t\treturn;\n\t\t}\n\t\tvar view = this._scrollCandidateView;\n\t\tthis._scrollCandidateView = void 0;\n\t\tview.el.classList.remove(\"candidate\");\n\n\t\tthis.triggerSelectionEvents(view, true);\n\t},\n\n\tadjustToSelection: function() {\n\t\tvar m, i = this.collection.selectedIndex;\n\t\t// assume -1 < index < this.collection.length\n\t\tif (this.requireSelection) {\n\t\t\t(i == -1) && i++; // if selection is null (index -1), set _selectedView to first item (index 0)\n\t\t\tthis._selectedView = (m = this.collection.at(i)) && this.itemViews.findByModel(m);\n\t\t\tthis._precedingView = (m = this.collection.at(i - 1)) && this.itemViews.findByModel(m);\n\t\t\tthis._followingView = (m = this.collection.at(i + 1)) && this.itemViews.findByModel(m);\n\t\t} else {\n\t\t\tthis._selectedView = (m = this.collection.at(i)) ? this.itemViews.findByModel(m) : this.emptyView;\n\t\t\tthis._precedingView = m && ((m = this.collection.at(i - 1)) ? this.itemViews.findByModel(m) : this.emptyView);\n\t\t\tthis._followingView = (m = this.collection.at(i + 1)) && this.itemViews.findByModel(m);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Model listeners\n\t/* --------------------------- */\n\n\t/** @private */\n\t_onSelectOne: function(model) {\n\t\tif (model === this._selectedView.model) {\n\t\t\t// console.info(\"INTERNAL\");\n\t\t\treturn;\n\t\t}\n\t\tthis._onSelectAny(model);\n\t},\n\n\t/** @private */\n\t_onSelectNone: function() {\n\t\tif ((this.requireSelection ? this.itemViews.first() : this.emptyView) === this._selectedView) {\n\t\t\t// console.info(\"INTERNAL\");\n\t\t\treturn;\n\t\t}\n\t\tthis._onSelectAny();\n\t},\n\n\t/** @private */\n\t_onSelectAny: function(model) {\n\t\tthis._selectedView.el.classList.remove(\"selected\");\n\t\tthis.adjustToSelection();\n\t\tthis._selectedView.el.classList.add(\"selected\");\n\n\t\tif (!this._internalSelection) {\n\t\t\tthis._setScrolling(true);\n\t\t\tthis.scrollBy(0, Carousel.ANIMATED);\n\t\t}\n\t},\n\n\t// _onDeselectAny: function (model) {},\n\n\t/** @private */\n\t_onReset: function() {\n\t\t// this._createChildren();\n\t\t// this.invalidateChildren();\n\t\tthis.requestRender(View.CHILDREN_INVALID | View.MODEL_INVALID);\n\t},\n\n\n\t/* --------------------------- *\n\t/* TEMP\n\t/* --------------------------- */\n\n\t// _scrollBy2: function (delta, skipTransitions) {\n\t// \tvar metrics, pos;\n\t// \tvar sMetrics = this.metrics[(this._scrollCandidateView || this._selectedView).cid];\n\t// \tvar cMetrics = this.metrics[(this._panCandidateView || this._selectedView).cid];\n\t//\n\t// \tthis.itemViews.each(function (view) {\n\t// \t\tmetrics = this.metrics[view.cid];\n\t// \t\tpos = Math.floor(this._getScrollOffset(delta, metrics, sMetrics, cMetrics));\n\t// \t\tview.el.style[transformProperty] = (this.direction & HORIZONTAL)?\n\t// \t\t\t\t\"translate3d(\" + pos + \"px,0,0)\" : \"translate3d(0,\" + pos + \"px,0)\";\n\t// \t\t\t\t// \"translate(\" + pos + \"px,0)\" : \"translate(0,\" + pos + \"px)\";\n\t// \t\t\t\t// \"translateX(\" + pos + \"px)\" : \"translateY(\" + pos + \"px)\";\n\t// \t}, this);\n\t// \tthis.el.classList.toggle(\"skip-transitions\", skipTransitions);\n\t// \tthis.selectFromView();\n\t// },\n\n\t// _getScrollOffset2: function (delta, mCurr, mSel, mCan) {\n\t// \tvar offset = 0;\n\t// \tvar posInner = mCurr.posInner - mSel.posInner + delta;\n\t//\n\t// \tif (posInner < -mSel.inner) {\n\t// \t\toffset = -(mCurr.before);\n\t// \t} else if (posInner > mSel.inner) {\n\t// \t\toffset = (mSel.after);\n\t// \t} else {\n\t// \t\tif (posInner < 0) {\n\t// \t\t\toffset = (mCurr.before) / (mCurr.inner) * posInner;\n\t// \t\t} else {\n\t// \t\t\toffset = (mSel.after) / (mCan.inner) * posInner;\n\t// \t\t}\n\t// \t}\n\t// \treturn posInner + offset;\n\t// },\n\n\t// captureSelectedOffset: function() {\n\t// \tvar val, view, cssval, m, mm;\n\t//\n\t// \tval = 0;\n\t// \tview = this._scrollCandidateView || this._selectedView;\n\t// \tcssval = getComputedStyle(view.el)[transformProperty];\n\t//\n\t// \tmm = cssval.match(/(matrix|matrix3d)\\(([^\\)]+)\\)/);\n\t// \tif (mm) {\n\t// \t\tm = mm[2].split(\",\");\n\t// \t\tif (this.direction & HORIZONTAL) {\n\t// \t\t\tval = m[mm[1]==\"matrix\"? 4 : 12];\n\t// \t\t} else {\n\t// \t\t\tval = m[mm[1]==\"matrix\"? 5 : 13];\n\t// \t\t}\n\t// \t\tval = parseFloat(val);\n\t// \t}\n\t//\n\t// \tconsole.log(\"%s::captureSelectedOffset\", this.cid, cssval, val, cssval.match(/matrix\\((?:\\d\\,){3}(\\d)\\,(\\d)|matrix3d\\((?:\\d\\,){11}(\\d)\\,(\\d)/));\n\t//\n\t// \treturn val;\n\t// },\n\n\t// _onScrollEnd: function(exec) {\n\t// \tthis._scrollEndCancellable = void 0;\n\t// \t// this.el.classList.remove(\"disabled-changing\");\n\t// \tif (exec) {\n\t// \t\tthis._setScrolling(false);\n\t// \t\t// this.el.classList.remove(\"scrolling\");\n\t// \t\t// this.trigger(\"view:scrollend\");\n\t// \t\tconsole.log(\"%s::_onScrollEnd\", this.cid);\n\t// \t}\n\t// },\n\t// _onMouseDown: function(ev) {\n\t// \tif (this._scrolling) {\n\t// \t\tthis._panCapturedOffset = this.captureSelectedOffset();\n\t// \t\tconsole.log(\"%s::events[mousedown] scrolling interrupted (pos %f)\", this.cid, this._panCapturedOffset);\n\t// \t}\n\t// },\n\t// _onMouseUp:function(ev) {\n\t// \tthis._panCapturedOffset = 0;\n\t// },\n\n};\n\nmodule.exports = Carousel = View.extend(CarouselProto, Carousel);",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper;\n\n  return container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : {},{\"name\":\"id\",\"hash\":{},\"data\":data}) : helper)));\n},\"useData\":true});\n",
    "/**\n * @module app/view/component/CollectionStack\n */\n\n// /** @type {module:underscore} */\n// var _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n\n// /** @type {module:app/control/Globals} */\n// var Globals = require(\"app/control/Globals\");\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n// /** @type {Function} */\n// var transitionEnd = require(\"utils/event/transitionEnd\");\n/** @type {Function} */\nvar setImmediate = require(\"utils/setImmediate\");\n\n/** @type {string} */\nvar viewTemplate = require(\"./CollectionStack.hbs\");\n\n/**\n * @constructor\n * @type {module:app/component/CollectionStack}\n */\nmodule.exports = View.extend({\n\n\t/** @override */\n\tcidPrefix: \"stack\",\n\t/** @override */\n\ttagName: \"div\",\n\t/** @override */\n\tclassName: \"stack\",\n\t/** @override */\n\ttemplate: viewTemplate,\n\n\tevents: {\n\t\t\"transitionend\": function(ev) {\n\t\t\t// console.log(\"%s::transitionend [invalid: %s] [transition: %s]\", this.cid, this._contentInvalid, (this._skipTransitions? \"skip\": \"run\"), ev.target.id, ev.target.className);\n\t\t\tthis._renderContent();\n\t\t}\n\t},\n\n\tinitialize: function(options) {\n\t\tthis._enabled = true;\n\t\tthis._skipTransitions = true;\n\t\tthis._contentInvalid = true;\n\n\t\toptions.template && (this.template = options.template);\n\t\tthis.content = document.createElement(\"div\");\n\t\tthis.content.className = \"stack-item\";\n\t\tthis.el.appendChild(this.content);\n\n\t\tthis.listenTo(this.collection, \"select:one select:none\", this._onSelectChange);\n\t},\n\n\tsetEnabled: function(enabled) {\n\t\tif (this._enabled !== enabled) {\n\t\t\tthis._enabled = enabled;\n\t\t\tthis.el.classList.toggle(\"disabled\", !this._enabled);\n\t\t}\n\t},\n\n\t_onSelectChange: function(item) {\n\t\tif (this._renderedItem === this.collection.selected) {\n\t\t\tthrow new Error(\"change event received but item is identical\");\n\t\t}\n\t\tthis._renderedItem = this.collection.selected;\n\n\t\tthis._contentInvalid = true;\n\t\tthis.render();\n\t},\n\n\t/* --------------------------- *\n\t/* render\n\t/* --------------------------- */\n\n\trender: function() {\n\t\tif (this._skipTransitions) {\n\t\t\t// execute even if content has not changed to apply styles immediately\n\t\t\tthis._skipTransitions = false;\n\t\t\tthis.el.classList.add(\"skip-transitions\");\n\t\t\tsetImmediate(function() {\n\t\t\t\tthis.el.classList.remove(\"skip-transitions\");\n\t\t\t}.bind(this));\n\n\t\t\t// render changed content immediately\n\t\t\tif (this._contentInvalid) {\n\t\t\t\tthis._renderContent();\n\t\t\t}\n\t\t} else {\n\t\t\t// else remove 'current' class and render on transitionend\n\t\t\tif (this._contentInvalid) {\n\t\t\t\tthis.content.classList.remove(\"current\");\n\t\t\t\t// this.content.className = \"stack-item\";\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\n\t_renderContent: function() {\n\t\tif (this._contentInvalid) {\n\t\t\tthis._contentInvalid = false;\n\t\t\tvar item = this.collection.selected;\n\t\t\tthis.content.innerHTML = item ? this.template(item.toJSON()) : \"\";\n\t\t\tthis.content.classList.add(\"current\");\n\t\t\t// this.content.className = \"stack-item current\";\n\t\t}\n\t},\n});\n",
    "/**\n/* @module app/view/component/FilterableListView\n/*/\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:backbone.babysitter} */\nvar Container = require(\"backbone.babysitter\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/component/ClickableRenderer} */\nvar ClickableRenderer = require(\"app/view/render/ClickableRenderer\");\n/** @type {module:utils/prefixedProperty} */\nvar prefixedProperty = require(\"utils/prefixedProperty\");\n/** @type {module:utils/css/getBoxEdgeStyles} */\nvar getBoxEdgeStyles = require(\"utils/css/getBoxEdgeStyles\");\n\nvar diff = function(a1, a2) {\n\treturn a1.reduce(function(res, o, i, a) {\n\t\tif (a2.indexOf(o) == -1) res.push(o);\n\t\treturn res;\n\t}, []);\n};\n\n/** @type {module:app/control/Globals.TRANSLATE_TEMPLATE} */\nvar translateCssValue = require(\"app/control/Globals\").TRANSLATE_TEMPLATE;\n\n/** @const */\nvar transformProp = prefixedProperty(\"transform\");\n\n/**\n/* @constructor\n/* @type {module:app/view/component/FilterableListView}\n/*/\nvar FilterableListView = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"filterableList\",\n\t/** @override */\n\ttagName: \"ul\",\n\t/** @override */\n\tclassName: \"list selectable filterable\",\n\n\t/** @override */\n\tdefaults: {\n\t\tcollapsed: true,\n\t\tfilterFn: function() {\n\t\t\treturn true;\n\t\t},\n\t\trenderer: ClickableRenderer.extend({\n\t\t\t/** @override */\n\t\t\tcidPrefix: \"listItem\",\n\t\t}),\n\t},\n\n\t/** @override */\n\tproperties: {\n\t\tcollapsed: {\n\t\t\tget: function() {\n\t\t\t\treturn this._collapsed;\n\t\t\t},\n\t\t\tset: function(value) {\n\t\t\t\tthis._setCollapsed(value);\n\t\t\t}\n\t\t},\n\t\tfilteredItems: {\n\t\t\tget: function() {\n\t\t\t\treturn this._filteredItems;\n\t\t\t}\n\t\t}\n\t},\n\n\t/** @override */\n\tevents: {\n\t\t\"transitionend .list-item\": function(ev) {\n\t\t\tif (this._collapsedTransitioning && ev.propertyName === \"visibility\" /*&& this.el.classList.contains(\"collapsed-changed\")*/ ) {\n\t\t\t\tthis._collapsedTransitioning = false;\n\t\t\t\tthis.el.classList.remove(\"collapsed-changed\");\n\t\t\t\tconsole.log(\"%s::events[transitionend .list-item] collapsed-changed end\", this.cid);\n\t\t\t}\n\t\t},\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tthis._metrics = {};\n\t\tthis._itemMetrics = [];\n\t\tthis.itemViews = new Container();\n\n\t\t_.defaults(options, this.defaults);\n\t\tthis.renderer = options.renderer;\n\t\tthis._filterFn = options.filterFn;\n\n\t\tthis.collection.each(this.createItemView, this);\n\t\tthis.refresh();\n\t\tthis._setSelection(this.collection.selected);\n\t\tthis._setCollapsed(options.collapsed);\n\n\t\t// will trigger on return if this.el is already attached\n\t\t// this.skipTransitions = true;\n\t\tthis.listenTo(this, \"view:attached\", function() {\n\t\t\tthis.skipTransitions = true;\n\t\t\tthis.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID); //.renderNow();\n\t\t});\n\n\t\tthis.listenTo(this.collection, \"select:one select:none\", this._setSelection);\n\t\tthis.listenTo(this.collection, \"reset\", function() {\n\t\t\tthis._allItems = null;\n\t\t\tthrow new Error(\"not implemented\");\n\t\t});\n\t},\n\n\t/* --------------------------- *\n\t/* Render\n\t/* --------------------------- */\n\n\t/** @override */\n\trenderFrame: function(tstamp, flags) {\n\t\t// collapsed transition flag\n\t\tif (this._collapsedTransitioning)\n\t\t\tconsole.warn(\"%s::renderFrame collapsed transition interrupted\", this.cid);\n\n\t\tthis._collapsedTransitioning = !this.skipTransitions && this._collapsedChanged;\n\n\t\t// this.el.classList.toggle(\"animate\", !this.skipTransitions);\n\t\tthis.el.classList.toggle(\"collapsed-changed\", this._collapsedTransitioning);\n\t\tthis.el.classList.toggle(\"skip-transitions\", this.skipTransitions);\n\t\tif (this.skipTransitions) {\n\t\t\tthis.skipTransitions = false;\n\t\t\t// Invalidate again after frame render loop to reapply transforms:\n\t\t\t// that should kill any running transitions.\n\t\t\tthis.setImmediate(function() {\n\t\t\t\tthis.requestRender(View.LAYOUT_INVALID);\n\t\t\t});\n\t\t}\n\t\tif (this._collapsedChanged) {\n\t\t\tflags |= View.SIZE_INVALID;\n\t\t\tthis.el.classList.toggle(\"collapsed\", this._collapsed);\n\t\t}\n\t\tif (this._selectionChanged) {\n\t\t\tflags |= View.LAYOUT_INVALID;\n\t\t\tthis.renderSelection(this.collection.selected, this.collection.lastSelected);\n\t\t}\n\t\tif (this._filterChanged) {\n\t\t\tflags |= View.LAYOUT_INVALID;\n\t\t\tthis.renderFilterFn();\n\t\t}\n\t\tif (flags & View.SIZE_INVALID) {\n\t\t\tthis.measure();\n\t\t}\n\t\tif (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {\n\t\t\tthis.renderLayout();\n\t\t}\n\t\tthis._collapsedChanged = this._selectionChanged = this._filterChanged = false;\n\t},\n\n\tmeasure: function() {\n\t\t// var i, ii, el, els, m, mm;\n\t\t// els = this.el.children;\n\t\t// ii = els.length;\n\t\t// mm = this._itemMetrics;\n\t\t// for (i = 0; i < ii; i++) {\n\t\t// \tmm[i] = _.pick(els[i], \"offsetTop\", \"offsetHeight\");\n\t\t// }\n\n\t\tthis._metrics = getBoxEdgeStyles(this.el, this._metrics);\n\n\t\t// var itemEl, itemView, baseline = 0;\n\t\t// if (itemEl = this.el.querySelector(\".list-item:not(.excluded) .label\")) {\n\t\t// \t// itemView = this.itemViews.findByCid(itemEl.cid);\n\t\t// \tvar elA = itemEl, elB = itemEl.parentElement;\n\t\t// \tvar yA = elA.offsetTop,\n\t\t// \t\thA = elA.offsetHeight,\n\t\t// \t\tyB = elB.offsetTop,\n\t\t// \t\thB = elB.offsetHeight;\n\t\t// \tbaseline = ((yA + hA) - (yB + hB));\n\t\t// \tconsole.log(\"%s::measure fontSize: %spx (%s+%s)-(%s+%s)=%s\", this.cid, this._metrics.fontSize,\n\t\t// \t\tyA, hA, yB, hB, baseline\n\t\t// \t);\n\t\t// }\n\n\t\tthis.itemViews.forEach(function(view) {\n\t\t\tif (!view._metrics) view._metrics = {};\n\t\t\t// view._metrics.baseline = this._metrics.fontSize - baseline;\n\t\t\tview._metrics.offsetTop = view.el.offsetTop;\n\t\t\tview._metrics.offsetHeight = view.el.offsetHeight;\n\t\t\tview._metrics.offsetLeft = view.el.offsetLeft;\n\t\t\tview._metrics.offsetWidth = view.el.offsetWidth;\n\t\t\tif (!this._collapsed && view.label) {\n\t\t\t\tview._metrics.textLeft = view.label.offsetLeft;\n\t\t\t\tview._metrics.textWidth = view.label.offsetWidth;\n\t\t\t} else {\n\t\t\t\tview._metrics.textLeft = view._metrics.offsetLeft;\n\t\t\t\tview._metrics.textWidth = view._metrics.offsetWidth;\n\t\t\t}\n\t\t}, this);\n\n\t\t// this._metrics.baseline = this._metrics.fontSize - baseline;\n\t},\n\n\trenderLayout: function() {\n\t\tvar posX, posY;\n\t\tposX = this._metrics.paddingLeft;\n\t\tposY = this._metrics.paddingTop;\n\n\t\tfor (var i = 0, ii = this.el.children.length; i < ii; i++) {\n\t\t\tvar view = this.itemViews.findByCid(this.el.children[i].cid);\n\t\t\tif (((this.collection.selected && !view.model.selected) ||\n\t\t\t\t\tview.el.classList.contains(\"excluded\")) && this._collapsed) {\n\t\t\t\tview.transform.tx = posX;\n\t\t\t\tview.transform.ty = posY;\n\t\t\t} else {\n\t\t\t\tif (view._metrics.offsetHeight == 0)\n\t\t\t\t\tposY -= view._metrics.offsetTop;\n\t\t\t\tview.transform.tx = posX;\n\t\t\t\tview.transform.ty = posY;\n\t\t\t\tposY += view._metrics.offsetHeight + view._metrics.offsetTop;\n\t\t\t}\n\t\t\tview.el.style[transformProp] = translateCssValue(view.transform.tx, view.transform.ty);\n\t\t}\n\n\t\t// posY += this._metrics.paddingBottom;\n\t\tthis._metrics.height = Math.max(0, posY + this._metrics.paddingBottom);\n\t\tthis.el.style.height = this._metrics.height + \"px\";\n\t\t// this.el.style.height = (posY > 0) ? posY + \"px\" : \"\";\n\t},\n\n\t/* --------------------------- *\n\t/* Child views\n\t/* --------------------------- */\n\n\t/** @private */\n\tcreateItemView: function(item, index) {\n\t\tvar view = new this.renderer({\n\t\t\tmodel: item,\n\t\t\tel: this.el.querySelector(\".list-item[data-id=\\\"\" + item.id + \"\\\"]\")\n\t\t});\n\t\titem.set(\"excluded\", false, { silent: true });\n\t\tthis.listenTo(view, \"renderer:click\", this._onRendererClick);\n\t\tview.listenTo(item, \"change:excluded\", function(item, newVal) {\n\t\t\t// console.log(arguments);\n\t\t\tif (this.el.classList.contains(\"excluded\") !== newVal) {\n\t\t\t\tconsole.warn(\"%s:[change:excluded] m:%o css: %o\", this.cid, newVal, this.el.classList.contains(\"excluded\"));\n\t\t\t}\n\t\t\t// this.el.classList.toggle(\"excluded\", excluded);\n\t\t});\n\t\tthis.itemViews.add(view);\n\t\treturn view;\n\t},\n\n\t/** @private */\n\t_onRendererClick: function(item, ev) {\n\t\tif (this._collapsedTransitioning\n\t\t\t|| (this._collapsed && item.get(\"excluded\"))) {\n\t\t\treturn;\n\t\t}\n\t\tif (this.collection.selected !== item) {\n\t\t\tthis.trigger(\"view:select:one\", item);\n\t\t} else {\n\t\t\tif (ev.altKey) {\n\t\t\t\tthis.trigger(\"view:select:none\");\n\t\t\t} else {\n\t\t\t\tthis.trigger(\"view:select:same\", item);\n\t\t\t}\n\t\t\t// this.trigger(\"view:select:none\");\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Collapsed\n\t/* --------------------------- */\n\n\t/** @private */\n\t_collapsed: undefined,\n\n\t/**\n\t/* @param {Boolean}\n\t/*/\n\t_setCollapsed: function(collapsed) {\n\t\tif (collapsed !== this._collapsed) {\n\t\t\tthis._collapsed = collapsed;\n\t\t\tthis._collapsedChanged = true;\n\t\t\tthis.requestRender();\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Selection\n\t/* --------------------------- */\n\n\t/** @private */\n\t_selectedItem: undefined,\n\n\t/** @param {Backbone.Model|null} */\n\t_setSelection: function(item) {\n\t\tthis._selectedItem = item;\n\t\tthis._selectionChanged = true;\n\t\tthis._requestRender();\n\t},\n\n\t/** @private */\n\trenderSelection: function(newItem, oldItem) {\n\t\tvar view;\n\t\tif (oldItem) {\n\t\t\tview = this.itemViews.findByModel(oldItem);\n\t\t\tview.el.classList.remove(\"selected\");\n\t\t\t// view.label.classList.remove(\"color-fg\");\n\t\t\t// view.label.classList.remove(\"color-reverse\");\n\t\t}\n\t\tif (newItem) {\n\t\t\tview = this.itemViews.findByModel(newItem);\n\t\t\tview.el.classList.add(\"selected\");\n\t\t\t// view.label.classList.add(\"color-fg\");\n\t\t\t// view.label.classList.add(\"color-reverse\");\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Filter\n\t/* --------------------------- */\n\n\trefresh: function() {\n\t\tif (this._filterFn) {\n\t\t\tthis._filterChanged = true;\n\t\t\tthis.requestRender();\n\t\t}\n\t},\n\n\trenderFilterFn: function() {\n\t\tvar items = this._filterFn ? this.collection.filter(this._filterFn, this) : this._getAllItems();\n\t\tthis.renderFilters(items, this._filteredItems);\n\t\tthis._filteredItems = items;\n\t},\n\n\trenderFilters: function(newItems, oldItems) {\n\t\tvar hasNew = !!(newItems && newItems.length);\n\t\tvar hasOld = !!(oldItems && oldItems.length);\n\n\t\tconsole.log(\"%s::renderFilterFn\", this.cid, newItems);\n\n\t\tif (hasNew) {\n\t\t\tdiff((hasOld ? oldItems : this._getAllItems()), newItems).forEach(function(item) {\n\t\t\t\tthis.itemViews.findByModel(item).el.classList.add(\"excluded\");\n\t\t\t\titem.set(\"excluded\", true);\n\t\t\t}, this);\n\t\t}\n\t\tif (hasOld) {\n\t\t\tdiff((hasNew ? newItems : this._getAllItems()), oldItems).forEach(function(item) {\n\t\t\t\tthis.itemViews.findByModel(item).el.classList.remove(\"excluded\");\n\t\t\t\titem.set(\"excluded\", false);\n\t\t\t}, this);\n\t\t}\n\t\tthis.el.classList.toggle(\"has-excluded\", hasNew);\n\t},\n\n\t_getAllItems: function() {\n\t\treturn this._allItems || (this._allItems = this.collection.slice());\n\t},\n\n\t/* --------------------------- *\n\t/* Filter 2\n\t/* --------------------------- */\n\n\t// computeFiltered: function() {\n\t// \tthis._filterResult = this.collection.map(this._filterFn, this);\n\t// },\n\t//\n\t// renderFiltered: function() {\n\t// \tthis.collection.forEach(function(item, index) {\n\t// \t\tthis.itemViews.findByModel(item).el.classList.toggle(\"excluded\", !this._filterResult[index]);\n\t// \t}, this);\n\t// },\n\n});\n\nmodule.exports = FilterableListView;",
    "/**\n * @module app/view/component/GraphView\n */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n\n/** @type {Function} */\nvar Color = require(\"color\");\n\n/** @type {module:app/view/base/View} */\nvar CanvasView = require(\"app/view/base/CanvasView\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n\n// /** @type {module:app/model/collection/TypeCollection} */\n// var types = require(\"app/model/collection/TypeCollection\");\n// /** @type {module:app/model/collection/BundleCollection} */\n// var bundles = require(\"app/model/collection/BundleCollection\");\n// /** @type {module:app/model/collection/KeywordCollection} */\n// var keywords = require(\"app/model/collection/KeywordCollection\");\n\n/** @type {module:utils/canvas/calcArcHConnector} */\nvar calcArcHConnector = require(\"utils/canvas/calcArcHConnector\");\n\n/** @type {module:utils/geom/inflateRect} */\nvar inflateRect = require(\"utils/geom/inflateRect\");\n\n/** @type {module:utils/canvas/calcArcHConnector} */\nvar CanvasHelper = require(\"utils/canvas/CanvasHelper\");\n\n// var BEZIER_CIRCLE = 0.551915024494;\n// var MIN_CANVAS_RATIO = 2;\n// var PI2 = Math.PI * 2;\n\nvar styleBase = {\n\tlineCap: \"butt\", // round, butt, square\n\tlineWidth: 0.75,\n\tlineDashOffset: 0,\n\tsetLineDash: [[]],\n\tradiusBase: 0.75,\n\t/* factored to rem unit */ //6,\n\tradiusIncrement: 3, //0.25,\n\t/* factored to rem unit */ //4,\n\toutlineWidth: 4.5,\n\t// margin: 20,\n};\n\nif (DEBUG) {\n\t/* eslint-disable no-unused-vars */\n\tvar _dStyles = {\n\t\tred: {\n\t\t\tlineWidth: 1,\n\t\t\tfillStyle: \"rgba(255,127,127,0.75)\",\n\t\t\tstrokeStyle: \"rgba(255,127,127,0.75)\",\n\t\t\tlineDashOffset: 0,\n\t\t\tsetLineDash: [[]]\n\t\t},\n\t\tblue: {\n\t\t\tlineWidth: 1,\n\t\t\tfillStyle: \"rgba(127,127,255,0.75)\",\n\t\t\tstrokeStyle: \"rgba(127,127,255,0.75)\",\n\t\t\tlineDashOffset: 0,\n\t\t\tsetLineDash: [[]]\n\t\t}\n\t};\n\t/* eslint-enable no-unused-vars */\n}\n\nfunction setStyle(ctx, s) {\n\tif (typeof s != \"object\") return;\n\tfor (var p in s) {\n\t\tswitch (typeof ctx[p]) {\n\t\t\tcase \"undefined\":\n\t\t\t\tbreak;\n\t\t\tcase \"function\":\n\t\t\t\tif (Array.isArray(s[p])) ctx[p].apply(ctx, s[p]);\n\t\t\t\telse ctx[p].call(ctx, s[p]);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tctx[p] = s[p];\n\t\t}\n\t}\n}\n\n/**\n * @constructor\n * @type {module:app/view/component/GraphView}\n */\nvar GraphView = CanvasView.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"graph\",\n\t/** @override */\n\ttagName: \"canvas\",\n\t/** @override */\n\tclassName: \"graph\",\n\t// /** @override */\n\t// model: Backbone.Model,\n\n\tdefaultKey: \"amount\",\n\n\tdefaults: {\n\t\tvalues: {\n\t\t\tamount: 0,\n\t\t\t// available: 0,\n\t\t\t// _loop: 0,\n\t\t},\n\t\tmaxValues: {\n\t\t\tamount: 1,\n\t\t\t// available: 1,\n\t\t},\n\t\t// useOpaque: true,\n\t\t// labelFn: function(value, max) {\n\t\t// \treturn ((value / max) * 100) | 0;\n\t\t// },\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tCanvasView.prototype.initialize.apply(this, arguments);\n\n\t\tthis._listA = options.listA;\n\t\tthis._listB = options.listB;\n\t\tthis._a2b = {\n\t\t\tsrcView: options.listA,\n\t\t\tdestView: options.listB,\n\t\t\ts: _.defaults({\n\t\t\t\tlineWidth: 1.5\n\t\t\t}, styleBase),\n\t\t\tstrokeStyleFn: function(fg, bg, ln) {\n\t\t\t\treturn Color(ln).mix(bg, 0.9).hexString();\n\t\t\t\t// return Color(fg).mix(bg, 0.9).hexString();\n\t\t\t}\n\t\t};\n\t\tthis._b2a = {\n\t\t\tsrcView: options.listB,\n\t\t\tdestView: options.listA,\n\t\t\ts: _.defaults({\n\t\t\t\tlineWidth: 0.7,\n\t\t\t\t// radiusIncrement: 1,\n\t\t\t\t// outlineWidth: 6,\n\t\t\t}, styleBase),\n\t\t\tstrokeStyleFn: function(fg, bg, ln) {\n\t\t\t\treturn Color(fg).mix(bg, 0.8).hexString();\n\t\t\t}\n\t\t};\n\t\tthis.listenTo(this, \"view:render:before\", this._beforeViewRender);\n\t\t// this._addListListeners(this._a2b);\n\t\t// this._addListListeners(this._b2a);\n\t},\n\n\t// _addListListeners: function(d) {\n\t// \tthis.listenTo(d.srcView, {\n\t// \t\t\"select:one\": function(model) {\n\t// \t\t\tthis.listenToOnce(d.destView, \"view:render:after\",\n\t// \t\t\t\tfunction(view) {\n\t// \t\t\t\t\td.srcItem = d.srcView.collection.selected;\n\t// \t\t\t\t\td.destItems = d.destView.filteredItems;\n\t// \t\t\t\t});\n\t// \t\t},\n\t// \t\t\"select:none\": function() {\n\t// \t\t\td.srcItem = d.destItems = null;\n\t// \t\t}\n\t// \t});\n\t// },\n\n\t/** @override */\n\tupdateCanvas: function(ctx) {\n\t\tthis._updateMetrics();\n\t\tthis._updateStyles();\n\t},\n\n\t/* --------------------------- *\n\t/* styles\n\t/* --------------------------- */\n\n\t_updateStyles: function() {\n\t\tvar b, bgColor, lnColor; //, altBgColor;\n\t\tif (this.model.get(\"withBundle\")) {\n\t\t\tb = this.model.get(\"bundle\");\n\t\t\tlnColor = b.colors.lnColor.clone();\n\t\t\tbgColor = b.colors.bgColor.clone();\n\t\t\t// altBgColor = b.attrs[\"--alt-background-color\"];\n\t\t} else {\n\t\t\tbgColor = Color(Globals.DEFAULT_COLORS[\"background-color\"]);\n\t\t\tlnColor = Color(Globals.DEFAULT_COLORS[\"--link-color\"]);\n\t\t}\n\t\t// bgColor = Color(window.getComputedStyle(this.el).getPropertyValue(\"background-color\"));\n\t\t// console.log(\"%s::_updateStyles bg: %s\", this.cid, window.getComputedStyle(this.el).getPropertyValue(\"background-color\"));\n\t\t// var bgColor = this.model.get(\"withBundle\") ? this.model.get(\"bundle\").colors.bgColor : Color(Globals.DEFAULT_COLORS[\"background-color\"]);\n\t\t// var lnColor = this.model.get(\"withBundle\") ? this.model.get(\"bundle\").colors.lnColor : Color(Globals.DEFAULT_COLORS[\"--link-color\"]);\n\t\t// var altBgColor = this.model.get(\"bundle\").attrs[\"--alt-background-color\"];\n\n\t\tthis._a2b.s.strokeStyle = this._a2b.s.fillStyle =\n\t\t\tthis._a2b.strokeStyleFn(this._color, bgColor, lnColor);\n\t\tthis._b2a.s.strokeStyle = this._b2a.s.fillStyle =\n\t\t\tthis._b2a.strokeStyleFn(this._color, bgColor, lnColor)\n\t},\n\n\t_setStyle: function(s) {\n\t\t// var ctx = this._ctx;\n\t\tif (typeof s == \"string\") {\n\t\t\ts = this._styleData[s];\n\t\t}\n\t\tsetStyle(this._ctx, s);\n\t},\n\n\t/* --------------------------- *\n\t/* metrics\n\t/* --------------------------- */\n\n\t_updateMetrics: function() {\n\t\tvar bounds = this.el.getBoundingClientRect();\n\t\tthis._ctx.setTransform(this._canvasRatio, 0, 0, this._canvasRatio, -bounds.left * this._canvasRatio - 0.5, -bounds.top * this._canvasRatio - 0.5);\n\n\t\tvar i, ii, els;\n\t\tvar aRect, bRect;\n\t\tvar aMin, bMin;\n\n\t\taRect = this._listA.el.getBoundingClientRect();\n\t\taMin = aRect.left;\n\t\tels = this._listA.el.querySelectorAll(\".label\");\n\t\tfor (i = 0, ii = els.length; i < ii; i++) {\n\t\t\taMin = Math.max(aMin,\n\t\t\t\tels[i].getBoundingClientRect().right);\n\t\t}\n\n\t\tbRect = this._listB.el.getBoundingClientRect();\n\t\tbMin = bRect.left;\n\t\tels = this._listB.el.querySelectorAll(\".label\");\n\t\tfor (i = 0, ii = els.length; i < ii; i++) {\n\t\t\tbMin = Math.min(bMin,\n\t\t\t\tels[i].getBoundingClientRect().left);\n\t\t}\n\t\tthis._b2a.destRect = this._a2b.rect = aRect;\n\t\tthis._b2a.destMinX = this._a2b.xMin = aMin;\n\t\tthis._a2b.destRect = this._b2a.rect = bRect;\n\t\tthis._a2b.destMinX = this._b2a.xMin = bMin;\n\n\t\tvar s = getComputedStyle(document.documentElement);\n\t\tthis._rootFontSize = parseFloat(s.fontSize); // * this._canvasRatio;\n\t\t// console.log(\"%s::_updateMetrics _rootFontSize: %s %o\", this.cid, this._rootFontSize, s);\n\n\t\t// var c = Math.abs(sData.xMin - dData.xMin) / 6;\n\t\t// sMin = sData.xMin + c * qx;\n\t\t// dMin = dData.xMin - c * qx;\n\n\t\t// this._a2b.targets = this._measureListItems(listView);\n\t\t// this._b2a.targets = this._measureListItems(listView);\n\n\t\t// // connector minimum branch x2\n\t\t// listView = this._listB;\n\t\t// for (i = 0, ii = listView.groups.length; i < ii; i++) {\n\t\t// \titemView = listView.itemViews.findByModel(listView.groups[i]);\n\t\t// \titemRect = (itemView.label || itemView.el).getBoundingClientRect();\n\t\t// \tthis._b2a.xMin = Math.min(this._b2a.xMin, itemRect.left);\n\t\t// \t// if (itemView._metrics) this._b2a.rect.left + itemView.transform.tx + itemView._metrics.textLeft;\n\t\t// }\n\t},\n\n\t/* --------------------------- *\n\t/* redraw\n\t/* --------------------------- */\n\n\t_beforeViewRender: function(view, flags) {\n\t\tif (flags & (CanvasView.SIZE_INVALID | CanvasView.MODEL_INVALID)) {\n\t\t\tconsole.log(\"%s::_beforeViewRender [flags: %s]\", this.cid, CanvasView.flagsToString(flags));\n\n\t\t\tthis._a2b.pointsOut = this._a2b.points;\n\t\t\tthis._a2b.maxLengthOut = this._a2b.maxLength;\n\t\t\tthis._a2b.points = null;\n\t\t\tthis._a2b.maxLength = null;\n\n\t\t\tthis._b2a.pointsOut = this._b2a.points;\n\t\t\tthis._b2a.maxLengthOut = this._b2a.maxLength;\n\t\t\tthis._b2a.points = null;\n\t\t\tthis._b2a.maxLength = null;\n\n\t\t\tthis._groupRects = null;\n\t\t}\n\t},\n\n\tredraw: function(ctx, interpolator) {\n\t\t// console.log(\"%s::redraw [valuesChanged: %s]\", this.cid, interpolator.valuesChanged);\n\t\tthis._clearCanvas(0, 0, this._canvasWidth, this._canvasHeight);\n\t\tctx.save();\n\t\tthis._redraw_fromElements(ctx, interpolator);\n\t\t// this._redraw_fromViews(ctx, interpolator);\n\t\tctx.restore();\n\t},\n\n\t_drawConnectors: function(pp, s, lMax, lVal, dir) {\n\t\tvar i, ii;\n\t\tif (pp && (ii = pp.length) && (lVal > 0)) {\n\t\t\tvar ra1 = s.radiusIncrement + s.lineWidth;\n\t\t\tvar ra2 = ra1 + (s.outlineWidth - s.lineWidth);\n\t\t\tthis._setStyle(s);\n\t\t\tif (lVal < 1) {\n\t\t\t\tthis._ctx.lineDashOffset = lMax * (1 + lVal);\n\t\t\t\tthis._ctx.setLineDash([lMax, lMax]);\n\t\t\t}\n\t\t\tfor (i = 0; i < ii; i++) {\n\t\t\t\tthis._ctx.save();\n\t\t\t\tthis._ctx.globalCompositeOperation = \"destination-out\";\n\t\t\t\tthis._ctx.lineWidth = s.outlineWidth;\n\t\t\t\t// for (i = 0; i < ii; i++) {\n\t\t\t\tthis._drawConnector(pp[i]);\n\t\t\t\tif (lVal == 1) {\n\t\t\t\t\tCanvasHelper.arrowhead(this._ctx, pp[i].x2, pp[i].y2, ra2, Math.PI * dir, true, s);\n\t\t\t\t\t// CanvasHelper.circle(this._ctx, pp[i].x2, pp[i].y2, 2.5, true, s);\n\t\t\t\t}\n\t\t\t\t// }\n\t\t\t\tthis._ctx.restore();\n\t\t\t\t// for (i = 0; i < ii; i++) {\n\t\t\t\tthis._drawConnector(pp[i]);\n\t\t\t\tif (lVal == 1) {\n\t\t\t\t\tCanvasHelper.arrowhead(this._ctx, pp[i].x2, pp[i].y2, ra1, Math.PI * dir, true, s);\n\t\t\t\t\t// CanvasHelper.circle(this._ctx, pp[i].x2, pp[i].y2, 1.5, true, s);\n\t\t\t\t}\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\t},\n\n\t_redraw_fromElements: function(ctx, interpolator) {\n\t\t// b2a: keyword to bundles, right to left\n\t\t// a2b: bundle to keywords, left to right\n\t\tif (this._b2a.points === null) {\n\t\t\tthis._computeConnectors2(this._b2a); //, this._listB, this._listA);\n\t\t}\n\t\tif (this._a2b.points === null) {\n\t\t\tthis._computeConnectors2(this._a2b); //, this._listA, this._listB);\n\t\t}\n\n\t\t/* line dash value interpolation */\n\t\tvar lVal = interpolator._valueData[\"amount\"]._renderedValue / interpolator._valueData[\"amount\"]._maxVal;\n\n\t\t/* draw */\n\t\tthis._drawConnectors(this._b2a.points, this._b2a.s,\n\t\t\tthis._b2a.maxLength, lVal, 1);\n\t\tthis._drawConnectors(this._b2a.pointsOut, this._b2a.s,\n\t\t\tthis._b2a.maxLengthOut, 1 - lVal, 1);\n\t\tthis._drawConnectors(this._a2b.points, this._a2b.s,\n\t\t\tthis._a2b.maxLength, 1, 2);\n\n\t\t// clear some label backgrounds\n\t\tif (this._groupRects === null) {\n\t\t\tthis._groupRects = [];\n\t\t\tvar els = this._listB.el.querySelectorAll(\".list-group .label span\");\n\t\t\tfor (var i = 0, ii = els.length; i < ii; i++) {\n\t\t\t\tthis._groupRects[i] = inflateRect(els[i].getBoundingClientRect(), -8.5, -4.5);\n\t\t\t}\n\t\t}\n\t\tthis._groupRects.forEach(function(r) {\n\t\t\t// TODO: implement DOMRect.inflate()\n\t\t\tthis._ctx.clearRect(r.left, r.top, r.width - 1, r.height - 1);\n\t\t\t// this._ctx.strokeRect(r.left, r.top, r.width, r.height);\n\t\t\t// var ro = r.original;\n\t\t\t// this._ctx.strokeRect(ro.left, ro.top, ro.width, ro.height);\n\t\t}, this);\n\n\t\t// var i, ii, r;\n\t\t// if (this._a2b.points || this._b2a.points || this._a2b.pointsOut || this._b2a.pointsOut) {\n\t\t// \tii = this._groupRects.length;\n\t\t// \tfor (i = 0; i < ii; i++) {\n\t\t// \t\tr = this._groupRects[i];\n\t\t// \t\tctx.clearRect(r.left, r.top, r.width, r.height);\n\t\t// \t}\n\t\t// }\n\n\t\t// if (DEBUG) {\n\t\t// \tif (!interpolator._valuesChanged) {\n\t\t// \t\tvar p;\n\t\t// \t\tfor (i = 0; i < ii; i++) {\n\t\t// \t\t\tp = this._b2a.points[i];\n\t\t// \t\t\tCanvasHelper.crosshair(ctx, p.cx2, p.cy2, 5, _dStyles.red);\n\t\t// \t\t\tCanvasHelper.circle(ctx, p.cx1, p.cy1, 1, true, _dStyles.blue);\n\t\t// \t\t}\n\t\t// \t}\n\t\t// \tCanvasHelper.vGuide(ctx, this._a2b.xMin, _dStyles.red);\n\t\t// \tCanvasHelper.vGuide(ctx, this._b2a.xMin, _dStyles.blue);\n\t\t// }\n\t},\n\n\t_computeConnectors2: function(d) {\n\t\tvar rBase = d.s.radiusBase * this._rootFontSize;\n\t\tvar rInc = d.s.radiusIncrement; // * this._rootFontSize;\n\t\tvar sMin = d.xMin;\n\t\tvar dMin = d.destMinX;\n\n\t\tvar lMax = 0;\n\t\tvar p, points = [];\n\t\tvar qx, x1, y1, tx;\n\t\tvar si; // ssEl's number of items above in the Y axis\n\n\t\tif (d.rect.right < d.destRect.left) {\n\t\t\tqx = 1;\n\t\t} else if (d.destRect.right < d.rect.left) {\n\t\t\tqx = -1;\n\t\t} else {\n\t\t\tqx = 0;\n\t\t}\n\n\t\tvar sView, ddView, ddItems, ddNum, i;\n\t\tif (d.srcView.collection.selected && d.destView.filteredItems) {\n\t\t\tsView = d.srcView.itemViews.findByModel(d.srcView.collection.selected);\n\t\t\tx1 = d.rect.left + sView.transform.tx + sView._metrics.textLeft;\n\t\t\ty1 = d.rect.top + sView.transform.ty + sView._metrics.offsetHeight / 2;\n\t\t\tif (qx > 0) x1 += sView._metrics.textWidth;\n\n\t\t\tddItems = d.destView.filteredItems;\n\t\t\tddNum = d.destView.filteredItems.length;\n\t\t\tfor (i = 0; i < ddNum; i++) {\n\t\t\t\tddView = d.destView.itemViews.findByModel(ddItems[i]);\n\t\t\t\tp = {};\n\t\t\t\tp.x2 = d.destRect.left + ddView.transform.tx + ddView._metrics.textLeft;\n\t\t\t\tp.y2 = d.destRect.top + ddView.transform.ty + ddView._metrics.offsetHeight / 2;\n\t\t\t\tif (qx < 0) p.x2 += ddView._metrics.textWidth;\n\n\t\t\t\tp.x1 = x1;\n\t\t\t\tp.y1 = y1;\n\t\t\t\tp.dx = x1 - p.x2;\n\t\t\t\tp.dy = y1 - p.y2;\n\t\t\t\tp.qx = qx;\n\t\t\t\tpoints[i] = p;\n\t\t\t}\n\t\t\tpoints.sort(function(a, b) {\n\t\t\t\treturn a.y2 - b.y2;\n\t\t\t});\n\t\t\tsi = 0;\n\t\t\tfor (i = 0; i < ddNum; i++) {\n\t\t\t\tp = points[i];\n\t\t\t\tp.di = p.dy > 0 ? i : ddNum - (i + 1);\n\t\t\t\tsi = Math.max(si, p.di);\n\t\t\t}\n\n\t\t\tvar a, rMax0 = ddNum * 0.5 * rInc;\n\t\t\tfor (i = 0; i < ddNum; i++) {\n\t\t\t\tp = points[i];\n\t\t\t\tp.r1 = p.di * rInc + rBase;\n\t\t\t\tp.r2 = rBase;\n\t\t\t\t// p.r2 = (si - p.di) * rInc + rBase;\n\n\t\t\t\tp.cx1 = sMin;\n\t\t\t\tp.cx2 = dMin - ((si - p.di) * rInc) * qx;\n\t\t\t\t// p.cx2 = dMin;\n\n\t\t\t\ta = (i - (ddNum - 1) / 2) * rInc;\n\t\t\t\tp.cy1 = p.y1 + a;\n\t\t\t\tp.cy2 = p.y2;\n\n\t\t\t\ta = Math.abs(a);\n\t\t\t\tp.r0 = a;\n\t\t\t\tp.cx0 = p.x1 + (rMax0 - a) * qx;\n\n\t\t\t\ttx = calcArcHConnector(p.cx1, p.cy1, p.r1, p.cx2, p.cy2, p.r2, 0.9);\n\t\t\t\tif (tx) {\n\t\t\t\t\tp.tx1 = tx[0];\n\t\t\t\t\tp.tx2 = tx[1];\n\t\t\t\t} else {\n\t\t\t\t\tp.tx1 = p.cx1;\n\t\t\t\t\tp.tx2 = p.cx2;\n\t\t\t\t}\n\n\t\t\t\t// Find out longest node connection for setLineDash\n\t\t\t\tlMax = Math.max(lMax, Math.abs(p.x1 - p.x2) + Math.abs(p.cy1 - p.cy2));\n\t\t\t}\n\t\t\tpoints.sort(function(a, b) {\n\t\t\t\treturn b.di - a.di; // Sort by distance to selected view\n\t\t\t});\n\t\t}\n\t\td.points = points;\n\t\td.maxLength = lMax;\n\t\td.xDir = qx;\n\t},\n\n\t_drawConnector: function(p) {\n\t\tthis._ctx.beginPath();\n\t\tthis._ctx.moveTo(p.x2, p.cy2);\n\t\tthis._ctx.arcTo(p.tx2, p.cy2, p.tx1, p.cy1, p.r2);\n\t\tthis._ctx.arcTo(p.tx1, p.cy1, p.cx1, p.cy1, p.r1);\n\t\t// this._ctx.quadraticCurveTo(p.cx0, p.cy1, p.cx0, p.y1)\n\t\tthis._ctx.arcTo(p.cx0, p.cy1, p.cx0, p.y1, p.r0);\n\t\t// this._ctx.lineTo(p.cx0, p.y1);\n\t\tthis._ctx.stroke();\n\n\t\t// CanvasHelper.circle(this._ctx, p.cx0, p.cy1, 1, _dStyles[\"blue\"], true);\n\t\t// CanvasHelper.circle(this._ctx, p.cx1, p.cy1, 1, _dStyles[\"blue\"], true);\n\t\t// CanvasHelper.crosshair(this._ctx, p.tx1, p.cy1, 8, _dStyles[\"blue\"], true);\n\t\t// CanvasHelper.crosshair(this._ctx, p.tx2, p.cy2, 8, _dStyles[\"red\"], true);\n\t\t// CanvasHelper.circle(this._ctx, p.cx2, p.cy2, 2, _dStyles[\"red\"], true);\n\t\t// CanvasHelper.circle(this._ctx, p.x1 - (p.r3 * p.qx * 2), p.cy1, 2, _dStyles[\"blue\"], true);\n\t},\n\n\t/*_computeConnectors: function(d) {\n\t\tvar rBase = d.s.radiusBase;\n\t\tvar rInc = d.s.radiusIncrement;\n\t\tvar sMin = d.xMin;\n\t\tvar dMin = d.destMinX;\n\n\t\tvar lMax = 0;\n\t\tvar p, points = [];\n\t\tvar qx, x1, y1, tx;\n\t\tvar si; // ssEl's number of items above in the Y axis\n\n\t\tif (d.rect.right < d.destRect.left) {\n\t\t\tqx = 1;\n\t\t} else if (d.destRect.right < d.rect.left) {\n\t\t\tqx = -1;\n\t\t} else {\n\t\t\tqx = 0;\n\t\t}\n\n\t\tvar ssEl, ddEls, ddNum, ssRect, ddRect, i;\n\t\tssEl = d.srcView.el.querySelector(\".list-item.selected .label\");\n\t\tif (ssEl) {\n\t\t\tssRect = ssEl.getBoundingClientRect();\n\t\t\tx1 = ssRect.left;\n\t\t\tif (qx > 0) x1 += ssRect.width;\n\t\t\ty1 = ssRect.top + ssRect.height / 2;\n\t\t\t// r2 = rBase;\n\t\t\t// cx1 = d.xMin;\n\n\t\t\tsi = 0;\n\t\t\tddEls = d.destView.el.querySelectorAll(\".list-item:not(.excluded) .label\");\n\t\t\tddNum = ddEls.length;\n\t\t\t// dx = Math.abs(d.xMin - dData.xMin);\n\n\t\t\tfor (i = 0; i < ddNum; i++) {\n\t\t\t\tp = {};\n\t\t\t\tddRect = ddEls[i].getBoundingClientRect();\n\t\t\t\tp.x2 = ddRect.left;\n\t\t\t\tif (qx < 0) p.x2 += ddRect.width;\n\t\t\t\tp.y2 = ddRect.top + ddRect.height / 2;\n\t\t\t\tp.x1 = x1;\n\t\t\t\tp.y1 = y1;\n\t\t\t\tp.dx = p.x1 - p.x2;\n\t\t\t\tp.dy = p.y1 - p.y2;\n\t\t\t\tp.qx = qx;\n\t\t\t\tp.qy = Math.sign(p.dy);\n\t\t\t\t// p.dLength = Math.abs(p.x) + Math.abs(p.y);\n\t\t\t\tp.di = p.dy > 0 ? i : ddNum - (i + 1);\n\t\t\t\tsi = Math.max(si, p.di);\n\t\t\t\tpoints[i] = p;\n\t\t\t}\n\n\t\t\tvar a, rMax0 = ddNum * 0.5 * rInc;\n\t\t\tfor (i = 0; i < ddNum; i++) {\n\t\t\t\tp = points[i];\n\t\t\t\tp.r1 = p.di * rInc + rBase;\n\t\t\t\tp.r2 = rBase;\n\t\t\t\t// p.r2 = (si - p.di) * rInc + rBase;\n\n\t\t\t\tp.cx1 = sMin;\n\t\t\t\tp.cx2 = dMin - ((si - p.di) * rInc) * qx;\n\t\t\t\t// p.cx2 = dMin;\n\n\t\t\t\ta = (i - (ddNum - 1) / 2) * rInc;\n\t\t\t\tp.cy1 = p.y1 + a;\n\t\t\t\tp.cy2 = p.y2;\n\n\t\t\t\ta = Math.abs(a);\n\t\t\t\tp.r0 = a;\n\t\t\t\tp.cx0 = p.x1 + (rMax0 - a) * qx;\n\n\t\t\t\ttx = calcArcHConnector(p.cx1, p.cy1, p.r1, p.cx2, p.cy2, p.r2, 0.8);\n\t\t\t\tp.tx1 = tx[0];\n\t\t\t\tp.tx2 = tx[1];\n\n\t\t\t\t// Find out longest node connection for setLineDash\n\t\t\t\tlMax = Math.max(lMax, Math.abs(p.x1 - p.x2) + Math.abs(p.cy1 - p.cy2));\n\t\t\t}\n\t\t\t// Sort by distance y1 (original) > cy1 (rInc offset) distance\n\t\t\tpoints.sort(function(a, b) {\n\t\t\t\t// return Math.abs(b.y1 - b.cy1) - Math.abs(a.y1 - a.cy1);\n\t\t\t\t// return a.r0 - b.r0;\n\t\t\t\treturn b.di - a.di;\n\t\t\t});\n\t\t}\n\t\td.points = points;\n\t\td.maxLength = lMax;\n\t\td.xDir = qx;\n\t},*/\n\n\t/*_redraw_fromMetrics: function(ctx, interpolator) {\n\t\tvar i, ii, model, mCids;\n\n\t\tvar idx, metrics;\n\t\tvar x1, y1, x2, y2, xMin1, xMin2;\n\t\tvar cx1, cy1, r1;\n\t\tvar cx2, cy2, r2;\n\t\tvar s, rInc, rBase, xMargin; // connector-to-element margin in px\n\n\t\t// keyword to bundles, left to right\n\t\tif (model = this._listB.collection.selected) {\n\t\t\tmCids = model.get(\"bIds\");\n\t\t\tii = mCids.length;\n\t\t}\n\t\t// bundle to keywords, right to left\n\t\tif (model = this.model.get(\"bundle\")) {\n\t\t\tmCids = model.get(\"bIds\");\n\t\t\tii = mCids.length;\n\n\t\t\ts = this._b2a.s;\n\t\t\trInc = s.radiusIncrement;\n\t\t\trBase = s.radiusBase;\n\t\t\txMargin = s.margin;\n\n\t\t\txMin1 = this._a2b.xMin;\n\t\t\txMin2 = this._b2a.xMin;\n\t\t\tidx = _.findIndex(this._targetsA, { mId: model.id });\n\t\t\tmetrics = this._targetsA[idx];\n\t\t\tx1 = metrics.after - xMargin;\n\t\t\ty1 = metrics.y;\n\t\t\tr2 = rBase;\n\t\t\tcx1 = Math.min(x1, xMin1);\n\n\t\t\tii = this._targetsB.length;\n\t\t\tfor (i = 0; i < ii; i++); {}\n\t\t}\n\t},*/\n\n\t/*_redraw_fromViews: function(ctx, interpolator) {\n\t\tvar i, numItems, view, rect, model, mCids;\n\t\tvar yMin, yMax, dx;\n\t\tvar s, roInc, m;\n\n\t\t// var xMid = (this._a2b.xMin + this._b2a.xMin) / 2;\n\t\tyMin = Math.min(this._a2b.rect.top, this._b2a.rect.top);\n\t\tyMax = Math.max(this._a2b.rect.bottom, this._b2a.rect.bottom);\n\t\tdx = Math.abs(this._a2b.xMin - this._b2a.xMin);\n\n\t\ts = this._b2a.s;\n\t\troInc = s.radiusIncrement;\n\t\tm = s.margin; // connector-to-element margin in px\n\n\t\tvar rr = 0.6; // r1 to r2 ratio\n\t\tvar r1, r2;\n\t\tr1 = (dx / 4) * rr;\n\t\tr2 = (dx / 4) * (1 / rr);\n\t\tr1 = Math.floor(r1);\n\t\tr2 = Math.floor(r2);\n\n\t\tvar x1, y1, x2, y2; // connector start/end\n\t\tvar cx1, cy1, cx2, cy2; // connector anchors\n\t\tvar xMin1, xMin2;\n\t\tvar ro; // radius offset\n\n\t\txMin1 = this._a2b.xMin;\n\t\txMin2 = this._b2a.xMin;\n\n\t\tthis._setStyle(s);\n\n\t\t// bundle to keywords\n\t\tif (model = this.model.get(\"bundle\")) {\n\t\t\tview = this._listA.itemViews.findByModel(model);\n\t\t\tif (view._metrics) {\n\t\t\t\tmCids = model.get(\"kIds\");\n\t\t\t\tnumItems = mCids.length;\n\n\t\t\t\tx1 = this._a2b.rect.left + view.transform.tx + view._metrics.textLeft + view._metrics.textWidth;\n\t\t\t\ty1 = this._a2b.rect.top + view.transform.ty + view._metrics.offsetHeight / 2;\n\t\t\t\tcx1 = Math.max(x1, xMin1);\n\t\t\t\tro = mCids.length * roInc * 0.5;\n\n\t\t\t\tfor (i = 0; i < numItems; i++) {\n\t\t\t\t\tview = this._listB.itemViews.findByModel(keywords.get(mCids[i]));\n\t\t\t\t\tif (view._metrics) {\n\t\t\t\t\t\tx2 = this._b2a.rect.left + view.transform.tx + view._metrics.textLeft;\n\t\t\t\t\t\ty2 = this._b2a.rect.top + view.transform.ty + view._metrics.offsetHeight / 2;\n\t\t\t\t\t\tcx2 = Math.min(x2, xMin2);\n\t\t\t\t\t\tcy1 = y1 + i * roInc;\n\t\t\t\t\t\tcy2 = y2; // - i*roInc;\n\t\t\t\t\t\tro += y1 > y2 ? roInc : -roInc;\n\n\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\tctx.moveTo(x1, cy1);\n\t\t\t\t\t\tdrawArcHConnector(ctx, cx1, cy1, cx2, cy2, r1 + ro, r2 - ro);\n\t\t\t\t\t\tctx.lineTo(x2, cy2);\n\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\txMin1 = this._b2a.xMin;\n\t\txMin2 = this._a2b.xMin;\n\n\t\t// keyword to bundles\n\t\tif (model = this._listB.collection.selected) {\n\t\t\tview = this._listB.itemViews.findByModel(model);\n\t\t\tif (view._metrics) {\n\t\t\t\tmCids = model.get(\"bIds\");\n\t\t\t\tnumItems = mCids.length;\n\n\t\t\t\tx1 = this._b2a.rect.left + view.transform.tx + view._metrics.textLeft;\n\t\t\t\ty1 = this._b2a.rect.top + view.transform.ty + view._metrics.offsetHeight / 2;\n\t\t\t\tcx1 = Math.min(x1, xMin1);\n\t\t\t\tro = mCids.length * roInc * 0.5;\n\n\t\t\t\t// ctx.setLineDash([]);\n\t\t\t\tfor (i = 0; i < numItems; i++) {\n\t\t\t\t\tview = this._listA.itemViews.findByModel(this._listA.collection.get(mCids[i]));\n\t\t\t\t\tif (view._metrics) {\n\t\t\t\t\t\tx2 = this._a2b.rect.left + view.transform.tx + view._metrics.textLeft + view._metrics.textWidth;\n\t\t\t\t\t\ty2 = this._a2b.rect.top + view.transform.ty + view._metrics.offsetHeight / 2;\n\t\t\t\t\t\tcx2 = Math.max(x2, xMin2);\n\t\t\t\t\t\tcy1 = y1 + i * roInc;\n\t\t\t\t\t\tcy2 = y2; // + i*roInc;\n\t\t\t\t\t\tro += y1 > y2 ? roInc : -roInc;\n\n\t\t\t\t\t\tctx.beginPath();\n\t\t\t\t\t\tctx.moveTo(x1, cy1);\n\t\t\t\t\t\tdrawArcHConnector(ctx, cx1, cy1, cx2, cy2, r1 + ro, r2 - ro);\n\t\t\t\t\t\tctx.lineTo(x2, cy2);\n\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},*/\n\n\t/*_measureListItems: function(listView) {\n\t\tvar listRect, retval;\n\n\t\tlistRect = listView.el.getBoundingClientRect();\n\t\tretval = listView.itemViews.map(function(view, i) {\n\t\t\treturn {\n\t\t\t\tvId: view.id,\n\t\t\t\tmId: view.model.id,\n\t\t\t\tleft: listRect.left + view.transform.tx + view._metrics.textLeft,\n\t\t\t\tright: listRect.left + view.transform.tx + view._metrics.textLeft + view._metrics.textWidth,\n\t\t\t\ty: listRect.top + view.transform.ty + view._metrics.offsetHeight / 2,\n\t\t\t};\n\t\t}, this);\n\t\tretval.sort(function(a, b) {\n\t\t\treturn a.y - b.y;\n\t\t});\n\t\tretval.before = listRect.left;\n\t\tretval.after = listRect.left + listRect.width;\n\t\treturn retval;\n\t},*/\n});\n\nif (DEBUG) {\n\tvar applyMethod = function(context, args) {\n\t\treturn Array.prototype.shift.apply(args).apply(context, args);\n\t}\n\tGraphView.prototype._skipLog = false;\n\tGraphView.prototype._requestRender = _.wrap(CanvasView.prototype._requestRender, function(fn) {\n\t\tconsole.log(\"%s::_requestRender\", this.cid);\n\t\t// var retval = Array.prototype.shift.apply(arguments).apply(this, arguments);\n\t\t// return retval;\n\n\t\treturn applyMethod(this, arguments);\n\t});\n\tGraphView.prototype._applyRender = _.wrap(CanvasView.prototype._applyRender, function(fn) {\n\t\t// this._skipLog = true;\n\t\tconsole.log(\"%s::_applyRender\", this.cid);\n\t\t// var retval = Array.prototype.shift.apply(arguments).apply(this, arguments);\n\t\t// this._skipLog = false;\n\t\t// return retval;\n\t\treturn applyMethod(this, arguments);\n\t});\n}\n\nmodule.exports = GraphView;",
    "/**\n * @module app/view/component/GroupingListView\n */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n// /** @type {module:backbone.babysitter} */\n// var Container = require(\"backbone.babysitter\");\n// /** @type {module:app/view/base/View} */\n// var View = require(\"app/view/base/View\");\n/** @type {module:app/view/component/FilterableListView} */\nvar FilterableListView = require(\"app/view/component/FilterableListView\");\n/** @type {module:app/view/component/ClickableRenderer} */\nvar ClickableRenderer = require(\"app/view/render/ClickableRenderer\");\n/** @type {module:app/view/render/LabelRenderer} */\nvar LabelRenderer = require(\"app/view/render/LabelRenderer\");\n\n/**\n * @constructor\n * @type {module:app/view/component/GroupingListView}\n */\nvar GroupingListView = FilterableListView.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"groupingList\",\n\n\t/** @override */\n\ttagName: \"dl\",\n\n\t/** @override */\n\tclassName: \"grouped\",\n\n\t/** @type {Function|null} empty array */\n\t_groupingFn: null, //function() { return null; },\n\n\t/** @override */\n\tdefaults: _.defaults({\n\t\t// defaults: {\n\t\trenderer: ClickableRenderer.extend({\n\t\t\t/** @override */\n\t\t\tcidPrefix: \"groupingListItem\",\n\t\t\t/** @override */\n\t\t\ttagName: \"dl\",\n\t\t\t/** @override */\n\t\t\tclassName: \"list-item list-label\",\n\t\t}),\n\t\tgroupingRenderer: LabelRenderer.extend({\n\t\t\t/** @override */\n\t\t\tcidPrefix: \"groupingListGroup\",\n\t\t\t/** @override */\n\t\t\ttagName: \"dt\",\n\t\t\t/** @override */\n\t\t\tclassName: \"list-group list-label\",\n\t\t}),\n\t\tgroupingFn: null,\n\t\t// },\n\t}, FilterableListView.prototype.defaults),\n\n\tproperties: {\n\t\tgroups: {\n\t\t\tget: function() {\n\t\t\t\treturn this._groups;\n\t\t\t}\n\t\t}\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tFilterableListView.prototype.initialize.apply(this, arguments);\n\n\t\tthis._groups = [];\n\t\t// this._groupItems = [];\n\t\tthis._groupsByItemCid = {};\n\n\t\tthis._groupingFn = options.groupingFn;\n\t\tthis.groupingRenderer = options.groupingRenderer;\n\n\t\tthis._refreshGroups();\n\t\tif (this._groupingFn) {\n\t\t\tthis._groups.forEach(this.createGroupingView, this);\n\t\t}\n\t},\n\n\t_refreshGroups: function() {\n\t\t// this._groups = _.uniq(this.collection.map(this._groupingFn, this));\n\t\tthis._groups.length = 0;\n\t\t// this._groupItems.length = 0;\n\t\tif (this._groupingFn) {\n\t\t\tthis.collection.forEach(function(item) {\n\t\t\t\tvar gIdx, gObj = this._groupingFn.apply(null, arguments);\n\t\t\t\tif (gObj) {\n\t\t\t\t\tgIdx = this._groups.indexOf(gObj);\n\t\t\t\t\tif (gIdx == -1) {\n\t\t\t\t\t\tgIdx = this._groups.length;\n\t\t\t\t\t\tthis._groups[gIdx] = gObj;\n\t\t\t\t\t\t// this._groupItems[gIdx] = [];\n\t\t\t\t\t}\n\t\t\t\t\t// this._groupItems[gIdx].push(item);\n\t\t\t\t}\n\t\t\t\tthis._groupsByItemCid[item.cid] = gObj;\n\t\t\t}, this);\n\t\t} else {\n\t\t\tthis.collection.forEach(function(item) {\n\t\t\t\tthis._groupsByItemCid[item.cid] = null;\n\t\t\t}, this);\n\t\t}\n\t},\n\n\trenderFilterFn: function() {\n\t\tFilterableListView.prototype.renderFilterFn.apply(this, arguments);\n\n\t\tif (this._groupingFn) {\n\t\t\tif (this._filteredItems.length == 0) {\n\t\t\t\tthis._groups.forEach(function(group) {\n\t\t\t\t\tthis.itemViews.findByModel(group).el.classList.remove(\"excluded\");\n\t\t\t\t}, this);\n\t\t\t} else {\n\t\t\t\tvar filteredGroups = this._filteredItems.map(function(item) {\n\t\t\t\t\treturn this._groupsByItemCid[item.cid];\n\t\t\t\t}, this);\n\t\t\t\tthis._groups.forEach(function(group) {\n\t\t\t\t\tthis.itemViews.findByModel(group).el.classList.toggle(\"excluded\", filteredGroups.indexOf(group) == -1);\n\t\t\t\t}, this);\n\t\t\t}\n\t\t\t// this._groupsExclusionIndex = this._groups.map(function (group) {\n\t\t\t// \treturn groups.indexOf(group) == -1);\n\t\t\t// }, this);\n\t\t}\n\t},\n\n\t/** @private Create children views */\n\tcreateGroupingView: function(item) {\n\t\tvar view = new this.groupingRenderer({\n\t\t\tmodel: item,\n\t\t\tel: this.el.querySelector(\".list-group[data-id=\\\"\" + item.id + \"\\\"]\")\n\t\t});\n\t\tthis.itemViews.add(view);\n\t\treturn view;\n\t},\n\n\t/* --------------------------- *\n\t/* Filter 2\n\t/* --------------------------- */\n\n\t// computeFiltered: function() {\n\t// \tFilterableListView.prototype.computeFiltered.apply(this, arguments);\n\t// },\n\t//\n\t// renderFiltered: function() {\n\t// \tFilterableListView.prototype.renderFiltered.apply(this, arguments);\n\t// },\n\n});\n\nmodule.exports = GroupingListView;\n",
    "/** @type {module:app/view/component/progress/CanvasProgressMeter} */\nmodule.exports = require(\"app/view/component/progress/CanvasProgressMeter3\");\n/** @type {module:app/view/component/progress/SVGPathProgressMeter} */\n// module.exports = require(\"app/view/component/progress/SVGPathProgressMeter\");\n/** @type {module:app/view/component/progress/SVGCircleProgressMeter} */\n// module.exports = require(\"app/view/component/progress/SVGCircleProgressMeter\");\n",
    "/**\n * @module app/view/component/SelectableListView\n */\n\n// /** @type {module:underscore} */\n// var _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:backbone.babysitter} */\nvar Container = require(\"backbone.babysitter\");\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/component/DefaultSelectableRenderer} */\nvar DefaultSelectableRenderer = require(\"app/view/render/DefaultSelectableRenderer\");\n/** @type {module:app/view/component/ClickableRenderer} */\nvar ClickableRenderer = require(\"app/view/render/ClickableRenderer\");\n\nvar SelectableListView = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"selectableList\",\n\n\t/** @override */\n\ttagName: \"ul\",\n\n\t/** @override */\n\tclassName: \"list selectable\",\n\n\t/** @type {module:app/view/component/DefaultSelectableRenderer} */\n\trenderer: DefaultSelectableRenderer,\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tthis._enabled = true;\n\t\tthis._childrenInvalid = true;\n\n\t\toptions.renderer && (this.renderer = options.renderer);\n\t\tthis.showEmpty = !!options.showEmpty;\n\t\tthis.itemViews = new Container();\n\n\t\tthis.listenTo(this.collection, \"add remove reset\", this._onCollectionChange);\n\t},\n\n\t/** @override */\n\tremove: function() {\n\t\tthis.removeChildren();\n\t\tView.prototype.remove.apply(this, arguments);\n\t\treturn this;\n\t},\n\n\t_onCollectionChange: function(ev) {\n\t\tthis._childrenInvalid = true;\n\t\tthis.render();\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tif (this._childrenInvalid) {\n\t\t\tthis._childrenInvalid = false;\n\t\t\tthis.createChildren();\n\t\t}\n\t\treturn this;\n\t},\n\n\t/** @override */\n\tsetEnabled: function(enabled) {\n\t\tif (this._enabled !== enabled) {\n\t\t\tthis._enabled = enabled;\n\t\t\tthis.el.classList.toggle(\"disabled\", !this._enabled);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Child views\n\t/* --------------------------- */\n\n\tcreateChildren: function() {\n\t\tvar eltBuffer, view;\n\n\t\tthis.removeChildren();\n\t\tthis.el.innerHTML = \"\";\n\n\t\tif (this.collection.length) {\n\t\t\teltBuffer = document.createDocumentFragment();\n\t\t\tif (this.showEmpty) {\n\t\t\t\tview = this.createEmptyView();\n\t\t\t\teltBuffer.appendChild(view.render().el);\n\t\t\t}\n\t\t\tthis.collection.each(function(model, index, arr) {\n\t\t\t\tview = this.createItemView(model, index);\n\t\t\t\teltBuffer.appendChild(view.render().el);\n\t\t\t}, this);\n\t\t\tthis.el.appendChild(eltBuffer);\n\t\t}\n\t},\n\n\tcreateItemView: function(model, index) {\n\t\tvar view = new(this.renderer)({\n\t\t\tmodel: model\n\t\t});\n\t\tthis.itemViews.add(view);\n\t\tthis.listenTo(view, \"renderer:click\", this.onItemViewClick);\n\t\treturn view;\n\t},\n\n\tremoveChildren: function() {\n\t\tthis.itemViews.each(this.removeItemView, this);\n\t},\n\n\tremoveItemView: function(view) {\n\t\tthis.stopListening(view);\n\t\tthis.itemViews.remove(view);\n\t\tview.remove();\n\t\treturn view;\n\t},\n\n\t/* --------------------------- *\n\t/* Child event handlers\n\t/* --------------------------- */\n\n\t/** @private */\n\tonItemViewClick: function(item) {\n\t\tif (this.collection.selected !== item && this._enabled) {\n\t\t\tthis.trigger(\"view:select:one\", item);\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* Empty view\n\t/* --------------------------- */\n\n\tcreateEmptyView: function() {\n\t\tvar view = new SelectableListView.EmptyRenderer({\n\t\t\tmodel: this.collection\n\t\t});\n\t\tthis.itemViews.add(view);\n\t\tthis.listenTo(view, \"renderer:click\", function() {\n\t\t\tthis._enabled && this.trigger(\"view:select:none\");\n\t\t});\n\t\treturn view;\n\t},\n}, {\n\tEmptyRenderer: ClickableRenderer.extend({\n\n\t\t/** @override */\n\t\ttagName: \"li\",\n\t\t/** @override */\n\t\tclassName: \"list-item empty-item\",\n\n\t\t/** @override */\n\t\tinitialize: function(options) {\n\t\t\tthis.listenTo(this.model, \"selected deselected\", this.renderClassList);\n\t\t\tthis.renderClassList();\n\t\t},\n\n\t\t/** @override */\n\t\trender: function() {\n\t\t\tthis.el.innerHTML = \"<a href=\\\"#clear\\\"><b> </b></a>\";\n\t\t\tthis.renderClassList();\n\t\t\treturn this;\n\t\t},\n\n\t\trenderClassList: function() {\n\t\t\tthis.el.classList.toggle(\"selected\", this.model.selectedIndex === -1);\n\t\t},\n\t})\n});\n\nmodule.exports = SelectableListView;\n",
    "/**\n * @module app/view/component/progress/CanvasProgressMeter\n */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/view/base/CanvasView} */\nvar CanvasView = require(\"app/view/base/CanvasView\");\n// /** @type {module:app/view/base/Interpolator} */\n// var Interpolator = require(\"app/view/base/Interpolator\");\n\nvar ARC_ERR = 0.00001;\n// var ARC_ERR = 0.0;\nvar PI = Math.PI;\nvar PI2 = Math.PI * 2;\n\nvar GAP_ARC = PI2 / 48;\nvar CAP_SCALE = 2; // cap arc = GAP_ARC * CAP_SCALE\nvar WAIT_CYCLE_VALUE = 1;\nvar WAIT_CYCLE_MS = 300; // milliseconds per interpolation loop \n\nvar ARC_DEFAULTS = {\n\t\"amount\": {\n\t\tlineWidth: 0.8,\n\t\tradiusOffset: 0\n\t},\n\t\"not-available\": {\n\t\tlineWidth: 1.0,\n\t\tlineDash: [0.3, 0.7]\n\t},\n\t\"available\": {\n\t\tlineWidth: 0.8,\n\t\tinverse: \"not-available\"\n\t},\n};\n\n/**\n * @constructor\n * @type {module:app/view/component/progress/CanvasProgressMeter}\n */\nvar CanvasProgressMeter = CanvasView.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"canvasProgressMeter\",\n\t/** @type {string} */\n\tclassName: \"progress-meter canvas-progress-meter\",\n\n\tdefaultKey: \"amount\",\n\n\tdefaults: {\n\t\tvalues: {\n\t\t\tamount: 0,\n\t\t\tavailable: 0,\n\t\t\t_loop: 0,\n\t\t},\n\t\tmaxValues: {\n\t\t\tamount: 1,\n\t\t\tavailable: 1,\n\t\t},\n\t\tuseOpaque: true,\n\t\tlabelFn: function(value, max) {\n\t\t\treturn ((value / max) * 100) | 0;\n\t\t},\n\t},\n\n\t/* --------------------------- *\n\t/* children/layout\n\t/* --------------------------- */\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t// TODO: cleanup options mess in CanvasView\n\t\tCanvasView.prototype.initialize.apply(this, arguments);\n\t\t// options = _.defaults(options, this.defaults);\n\n\t\tthis._labelFn = options.labelFn;\n\t\tthis._valueStyles = {};\n\t\tthis._canvasSize = null;\n\t\tthis._canvasOrigin = null;\n\t},\n\n\t_updateCanvas: function() {\n\t\tCanvasView.prototype._updateCanvas.apply(this, arguments);\n\n\t\t// size, lines, gaps, dashes (this._valueStyles, GAP_ARC, this._arcRadius)\n\t\t// --------------------------------\n\t\tvar arcName, arcObj, arcDefault;\n\t\tvar mapLineDash = function(n) {\n\t\t\treturn n * this.radius * GAP_ARC;\n\t\t};\n\t\tvar sumFn = function(s, n) {\n\t\t\treturn s + n;\n\t\t};\n\n\t\tthis._canvasSize = Math.min(this._canvasWidth, this._canvasWidth); // / this._canvasRatio;\n\t\tthis._maxDashArc = 0;\n\n\t\tfor (arcName in ARC_DEFAULTS) {\n\t\t\tarcDefault = ARC_DEFAULTS[arcName];\n\t\t\tarcObj = this._valueStyles[arcName] = {};\n\t\t\tarcObj.inverse = arcDefault.inverse; // copy inverse key\n\t\t\t// arcObj.inverse2 = arcDefault.inverse2;\n\t\t\tarcObj.lineWidth = arcDefault.lineWidth * this._canvasRatio;\n\t\t\tarcObj.radius = (this._canvasSize - arcObj.lineWidth) / 2;\n\t\t\tif (arcDefault.radiusOffset) {\n\t\t\t\tarcObj.radius += arcDefault.radiusOffset * this._canvasRatio;\n\t\t\t}\n\t\t\tif (arcDefault.lineDash && arcDefault.lineDash.length) {\n\t\t\t\tarcObj.lineDash = arcDefault.lineDash.map(mapLineDash, arcObj);\n\t\t\t\tarcObj.lineDashArc = arcDefault.lineDash[0] * GAP_ARC;\n\t\t\t\tarcObj.lineDashLength = arcObj.lineDash.reduce(sumFn);\n\t\t\t\tthis._maxDashArc = Math.max(this._maxDashArc, arcObj.lineDashArc);\n\t\t\t} else {\n\t\t\t\tarcObj.lineDashArc = 0;\n\t\t\t}\n\t\t}\n\n\t\t// baselineShift\n\t\t// --------------------------------\n\t\t// NOTE: Center baseline: use ascent data to center to x-height, or sort-of.\n\t\t// with ascent/descent values (0.7, -0.3), x-height is 0.4\n\t\tvar mObj = this._getFontMetrics(this._fontFamily);\n\t\tthis._baselineShift = mObj ? (mObj.ascent + mObj.descent) / mObj.unitsPerEm : 0.7; // default value\n\t\tthis._baselineShift *= this._fontSize * 0.5; // apply to font-size, halve it\n\t\tthis._baselineShift = Math.round(this._baselineShift);\n\n\t\t// save canvas context\n\t\t// --------------------------------\n\t\t// reset matrix and translate 0,0 to center\n\t\tthis._ctx.restore();\n\t\tthis._ctx.setTransform(1, 0, 0, 1, this._canvasWidth / 2, this._canvasHeight / 2);\n\t\tthis._ctx.save();\n\t},\n\n\t/* --------------------------- *\n\t/* private\n\t/* --------------------------- */\n\n\t/** @override */\n\tredraw: function(context, interpolator) {\n\t\tthis._clearCanvas(-this._canvasWidth / 2, -this._canvasHeight / 2, this._canvasWidth, this._canvasHeight);\n\n\t\tvar loopValue = interpolator._valueData[\"_loop\"]._renderedValue || 0;\n\t\tvar amountData = interpolator._valueData[\"amount\"];\n\t\tvar availableData = interpolator._valueData[\"available\"];\n\n\t\tvar amountStyle = this._valueStyles[\"amount\"];\n\t\tvar availableStyle = this._valueStyles[\"available\"];\n\n\t\t// amount label\n\t\t// --------------------------------\n\t\tthis.drawLabel(this._labelFn(amountData._renderedValue, amountData._maxVal));\n\n\t\t// save ctx before drawing arcs\n\t\tthis._ctx.save();\n\n\t\t// loop rotation\n\t\t// --------------------------------\n\t\t// if (interpolator.renderedKeys && (interpolator.renderedKeys.indexOf(\"amount\") !== -1)) {\n\t\t// \tconsole.log(\"%s::redraw (_loop) max: %s last: %s curr: %s\", this.cid,\n\t\t// \t\tamountData._maxVal,\n\t\t// \t\tamountData._lastRenderedValue,\n\t\t// \t\tamountData._renderedValue\n\t\t// \t);\n\t\t// }\n\t\tif (interpolator.renderedKeys && (interpolator.renderedKeys.indexOf(\"amount\") !== -1) && (amountData._lastRenderedValue > amountData._renderedValue)) {\n\t\t\t// trigger loop\n\t\t\tinterpolator.valueTo(1, 0, \"_loop\");\n\t\t\tinterpolator.valueTo(0, 750, \"_loop\");\n\t\t\tinterpolator.updateValue(\"_loop\");\n\t\t}\n\t\tthis._ctx.rotate(PI2 * ((1 - loopValue) - 0.25));\n\n\t\t// amount arc\n\t\t// --------------------------------\n\t\tvar amountGapArc = GAP_ARC;\n\t\tvar amountEndArc = 0;\n\t\tvar amountValue = loopValue + amountData._renderedValue / amountData._maxVal;\n\n\t\tif (amountValue > 0) {\n\t\t\tamountEndArc = this.drawArc(amountStyle, amountValue, amountGapArc, PI2 - amountGapArc);\n\t\t\tthis.drawEndCap(amountStyle, amountEndArc);\n\t\t\tamountEndArc = amountEndArc + amountGapArc * 2;\n\t\t}\n\n\t\t// available arc\n\t\t// --------------------------------\n\t\tvar stepsNum = availableData.length || 1;\n\t\tvar stepBaseArc = PI2 / stepsNum;\n\t\tvar stepAdjustArc = stepBaseArc % GAP_ARC;\n\t\tvar stepGapArc = GAP_ARC + (stepAdjustArc - availableStyle.lineDashArc) / 2;\n\n\t\tif (Array.isArray(availableData)) {\n\t\t\tfor (var o, i = 0; i < stepsNum; i++) {\n\t\t\t\to = availableData[i];\n\t\t\t\tthis.drawArc(availableStyle, o._renderedValue / (o._maxVal / stepsNum), (i * stepBaseArc) + stepGapArc, ((i + 1) * stepBaseArc) - stepGapArc, amountEndArc);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.drawArc(availableStyle, availableData._renderedValue / availableData._maxVal, stepGapArc, PI2 - stepGapArc, amountEndArc);\n\t\t}\n\t\t// restore ctx after drawing arcs\n\t\tthis._ctx.restore();\n\t},\n\n\tdrawArc: function(valueStyle, value, startArc, endArc, prevArc) {\n\t\tvar valArc, invStyle,\n\t\t\tvalStartArc, valEndArc,\n\t\t\tinvStartArc, invEndArc;\n\t\tprevArc || (prevArc = 0);\n\n\t\tvalArc = endArc - startArc;\n\t\tvalEndArc = startArc + (valArc * value);\n\t\tvalStartArc = Math.max(startArc, prevArc);\n\t\tif (valEndArc > valStartArc) {\n\t\t\tthis._ctx.save();\n\t\t\tthis.applyValueStyle(valueStyle);\n\t\t\tthis._ctx.beginPath();\n\t\t\tthis._ctx.arc(0, 0, valueStyle.radius, valEndArc, valStartArc, true);\n\t\t\tthis._ctx.stroke();\n\t\t\tthis._ctx.restore();\n\t\t}\n\t\t// if there's valueStyle, draw rest of span, minus prevArc overlap too\n\t\tif (valueStyle.inverse !== void 0) {\n\t\t\tinvStyle = this._valueStyles[valueStyle.inverse];\n\t\t\tinvEndArc = valEndArc + (valArc * (1 - value));\n\t\t\tinvStartArc = Math.max(valEndArc, prevArc);\n\t\t\tif (invEndArc > invStartArc) {\n\t\t\t\tthis._ctx.save();\n\t\t\t\tthis.applyValueStyle(invStyle);\n\t\t\t\tthis._ctx.beginPath();\n\t\t\t\tthis._ctx.arc(0, 0, invStyle.radius, invEndArc, invStartArc, true);\n\t\t\t\tthis._ctx.stroke();\n\t\t\t\tthis._ctx.restore();\n\t\t\t}\n\t\t}\n\t\treturn valEndArc;\n\t},\n\n\tapplyValueStyle: function(styleObj) {\n\t\tthis._ctx.lineWidth = styleObj.lineWidth;\n\t\tif (styleObj.lineDash) {\n\t\t\tthis._ctx.setLineDash(styleObj.lineDash);\n\t\t}\n\t\tif (styleObj.lineDashOffset) {\n\t\t\tthis._ctx.lineDashOffset = styleObj.lineDashOffset;\n\t\t}\n\t},\n\n\tdrawLabel: function(labelString) {\n\t\tvar labelWidth = this._ctx.measureText(labelString).width;\n\t\tthis._ctx.fillText(labelString,\n\t\t\tlabelWidth * -0.5,\n\t\t\tthis._baselineShift, labelWidth);\n\t},\n\n\tdrawEndCap: function(valueStyle, arcPos) {\n\t\tvar radius = valueStyle.radius;\n\t\tthis._ctx.save();\n\t\tthis._ctx.lineWidth = valueStyle.lineWidth;\n\n\t\tthis._ctx.rotate(arcPos - GAP_ARC * 1.5);\n\t\tthis._ctx.beginPath();\n\t\tthis._ctx.arc(0, 0, radius, GAP_ARC * 0.5, GAP_ARC * 2, false);\n\t\tthis._ctx.lineTo(radius - (GAP_ARC * radius), 0);\n\t\tthis._ctx.closePath();\n\n\t\tthis._ctx.fill();\n\t\tthis._ctx.stroke();\n\t\tthis._ctx.restore();\n\t},\n});\n\nif (DEBUG) {\n\tCanvasProgressMeter.prototype._skipLog = true;\n}\n\nmodule.exports = CanvasProgressMeter;\n",
    "/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n/** @type {Function} */\nvar Color = require(\"color\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/model/collection/BundleCollection} */\nvar bundles = require(\"app/model/collection/BundleCollection\");\n\n// - - - - - - - - - - - - - - - -\n//  utils\n// - - - - - - - - - - - - - - - -\n\nfunction insertCSSRule(sheet, selector, style) {\n\tvar cssText = \"\";\n\tfor (var prop in style) {\n\t\tcssText += prop + \":\" + style[prop] + \";\";\n\t}\n\tsheet.insertRule(selector + \"{\" + cssText + \"}\", sheet.cssRules.length);\n}\n\nfunction selfAndDescendant(selfCls, cls) {\n\treturn selfCls + \" \" + cls + \", \" + selfCls + cls;\n}\n\n// - - - - - - - - - - - - - - - -\n//  body rules\n// - - - - - - - - - - - - - - - -\n\nvar bodyStyles = [\"background\", \"background-color\", \"color\", \"--link-color\"];\n\nfunction initBodyStyles(sheet, bodySelector, attrs, fgColor, bgColor, lnColor, hasDarkBg) {\n\tvar s, revSelector, fgColorVal, bgColorVal;\n\t// var revFgColorVal, revBgColorVal;\n\n\ts = _.pick(attrs, bodyStyles);\n\ts[\"-webkit-font-smoothing\"] = (hasDarkBg ? \"antialiased\" : \"auto\");\n\t/* NOTE: In Firefox 'body { -moz-osx-font-smoothing: grayscale; }'\n\t/* works both in light over dark and dark over light, hardcoded in _base.scss */\n\t//s[\"-moz-osx-font-smoothing\"] = (hasDarkBg? \"grayscale\" : \"auto\");\n\tinsertCSSRule(sheet, bodySelector, s);\n\n\t// A element\n\t// - - - - - - - - - - - - - - - -\n\ts = {}\n\ts[\"color\"] = lnColor.rgbString();\n\tinsertCSSRule(sheet, bodySelector + \" a\", s);\n\tinsertCSSRule(sheet, bodySelector + \" .color-ln\", s);\n\n\t// .color-fg05\n\t// - - - - - - - - - - - - - - - -\n\ts = {};\n\ts[\"color\"] = fgColor.clone().mix(bgColor, 0.5).rgbString();\n\ts[\"border-color\"] = fgColor.clone().mix(bgColor, 0.7).rgbString();\n\tinsertCSSRule(sheet, bodySelector + \" .color-fg05\", s);\n\n\tfgColorVal = fgColor.rgbString();\n\tbgColorVal = bgColor.rgbString();\n\t// revFgColorVal = bgColor.clone().mix(fgColor, 0.9).rgbString();\n\t// revBgColorVal = fgColor.clone().mix(bgColor, 0.6).rgbString();\n\trevSelector = bodySelector + \" .color-reverse\";\n\n\t// .color-fg .color-bg\n\t// - - - - - - - - - - - - - - - -\n\ts = {\n\t\t\"color\": fgColorVal\n\t};\n\tinsertCSSRule(sheet, bodySelector + \" .color-fg\", s);\n\ts = {\n\t\t\"background-color\": bgColorVal\n\t};\n\tinsertCSSRule(sheet, bodySelector + \" .color-bg\", s);\n\t// html inverted text/background\n\ts = {\n\t\t\"color\": bgColorVal\n\t}; // s = { \"color\" : revFgColorVal };\n\ts[\"-webkit-font-smoothing\"] = (hasDarkBg ? \"auto\" : \"antialiased\");\n\t// insertCSSRule(sheet, revSelector + \" .color-fg\", s);\n\t// insertCSSRule(sheet, revSelector + \".color-fg\", s);\n\tinsertCSSRule(sheet, selfAndDescendant(revSelector, \".color-fg\"), s);\n\n\ts = {\n\t\t\"background-color\": fgColorVal\n\t};\n\t// s = { \"background-color\" : revBgColorVal };\n\t// insertCSSRule(sheet, revSelector + \" .color-bg\", s);\n\t// insertCSSRule(sheet, revSelector + \".color-bg\", s);\n\tinsertCSSRule(sheet, selfAndDescendant(revSelector, \".color-bg\"), s);\n\n\t// .color-stroke .color-fill (SVG)\n\t// - - - - - - - - - - - - - - - -\n\ts = {\n\t\t\"stroke\": fgColorVal\n\t};\n\tinsertCSSRule(sheet, bodySelector + \" .color-stroke\", s);\n\ts = {\n\t\t\"fill\": bgColorVal\n\t};\n\tinsertCSSRule(sheet, bodySelector + \" .color-fill\", s);\n\t// svg inverted fill/stroke\n\ts = {\n\t\t\"stroke\": bgColorVal\n\t};\n\t// insertCSSRule(sheet, revSelector + \" .color-stroke\", s);\n\t// insertCSSRule(sheet, revSelector + \".color-stroke\", s);\n\tinsertCSSRule(sheet, selfAndDescendant(revSelector, \".color-stroke\"), s);\n\ts = {\n\t\t\"fill\": fgColorVal\n\t};\n\t// insertCSSRule(sheet, revSelector + \" .color-fill\", s);\n\t// insertCSSRule(sheet, revSelector + \".color-fill\", s);\n\tinsertCSSRule(sheet, selfAndDescendant(revSelector, \".color-fill\"), s);\n\n\t// .text-outline\n\t// - - - - - - - - - - - - - - - -\n\t// s = {\n\t// \t\"text-shadow\": \"-1px -1px 0 \" + bgColorVal +\n\t// \t\t\", 1px -1px 0 \" + bgColorVal +\n\t// \t\t\", -1px 1px 0 \" + bgColorVal +\n\t// \t\t\", 1px 1px 0 \" + bgColorVal\n\t// };\n\t// insertCSSRule(sheet, bodySelector + \" :not(.collapsed-changed) .text-outline-bg\", s);\n\n}\n\n// - - - - - - - - - - - - - - - -\n// carousel styles\n// - - - - - - - - - - - - - - - -\n\nvar carouselStyles = [\"box-shadow\", \"border\", \"border-radius\"];\n\nfunction initCarouselStyles(sheet, carouselSelector, attrs, fgColor, bgColor, lnColor, hasDarkBg) {\n\tvar s = _.pick(attrs, carouselStyles); //, \"background-color\"]);\n\tinsertCSSRule(sheet, carouselSelector + \" .media-item .content\", s);\n\n\t// .media-item .color-bg09\n\t// - - - - - - - - - - - - - - - -\n\ts = {};\n\ts[\"background-color\"] = bgColor.clone().mix(fgColor, 0.95).rgbString();\n\t// s[\"background-color\"] = bgColor.clone()[hasDarkBg ? \"darken\" : \"lighten\"](0.045).rgbString();\n\t// s[\"background-color\"] = bgColor.clone()[hasDarkBg ? \"lighten\" : \"darken\"](0.03).rgbString();\n\tinsertCSSRule(sheet, carouselSelector + \" .media-item .color-bg09\", s);\n\n\t// .media-item .placeholder\n\t// - - - - - - - - - - - - - - - -\n\ts = {};\n\ts[\"-webkit-font-smoothing\"] = (hasDarkBg ? \"auto\" : \"antialiased\");\n\t// text color luminosity is inverse from body, apply oposite rendering mode\n\ts[\"color\"] = bgColor.rgbString();\n\t// s[\"color\"] = bgColor.clone()[hasDarkBg ? \"darken\" : \"lighten\"](0.045).rgbString();\n\ts[\"background-color\"] = bgColor.clone().mix(fgColor, 0.95).rgbString();\n\t// s[\"background-color\"] = bgColor.clone().mix(fgColor, 0.8).alpha(0.3).rgbaString();\n\t// s[\"background-color\"] = bgColor.clone()[hasDarkBg ? \"lighten\" : \"darken\"](0.03).rgbString();\n\t(\"border-radius\" in attrs) && (s[\"border-radius\"] = attrs[\"border-radius\"]);\n\tinsertCSSRule(sheet, carouselSelector + \" .media-item .placeholder\", s);\n\n\t// .empty-item A\n\t// - - - - - - - - - - - - - - - -\n\ts = {};\n\ts[\"text-decoration-color\"] = fgColor.clone().mix(bgColor, 0.3).rgbString();\n\tinsertCSSRule(sheet, carouselSelector + \" .empty-item A\", s);\n\t// // .color-gradient\n\t// // - - - - - - - - - - - - - - - -\n\t// s = {};\n\t// s[\"background-color\"] = \"transparent\";\n\t// s[\"background\"] = \"linear-gradient(to bottom, \" +\n\t// \t\tbgColor.clone().alpha(0.00).rgbaString() + \" 0%, \" +\n\t// \t\tbgColor.clone().alpha(0.11).rgbaString() + \" 100%)\";\n\t// insertCSSRule(sheet, bodySelector + \" .color-gradient\", s);\n\t// s = {};\n\t// s[\"background-color\"] = \"transparent\";\n\t// s[\"background\"] = \"linear-gradient(to bottom, \" +\n\t// \t\tfgColor.clone().alpha(0.00).rgbaString() + \" 0%, \" +\n\t// \t\tfgColor.clone().alpha(0.11).rgbaString() + \" 100%)\";\n\t// insertCSSRule(sheet, revSelector + \" .color-gradient\", s);\n\t// insertCSSRule(sheet, revSelector + \".color-gradient\", s);\n}\n\nmodule.exports = function() {\n\tvar attrs, fgColor, bgColor, lnColor, hasDarkBg;\n\n\tattrs = Globals.DEFAULT_COLORS;\n\tfgColor = new Color(Globals.DEFAULT_COLORS[\"color\"]);\n\tbgColor = new Color(Globals.DEFAULT_COLORS[\"background-color\"]);\n\tlnColor = new Color(Globals.DEFAULT_COLORS[\"--link-color\"])\n\thasDarkBg = fgColor.luminosity() > bgColor.luminosity();\n\n\tvar colorStyles = document.createElement(\"style\");\n\tcolorStyles.id = \"colors\";\n\tcolorStyles.type = \"text/css\";\n\tdocument.head.appendChild(colorStyles);\n\t// var colorStyles = document.querySelector(\"link#folio\");\n\n\tinitBodyStyles(colorStyles.sheet, \"BODY\", attrs, fgColor, bgColor, lnColor, hasDarkBg);\n\tinitCarouselStyles(colorStyles.sheet, \".carousel\", attrs, fgColor, bgColor, lnColor, hasDarkBg);\n\n\t// - - - - - - - - - - - - - - - -\n\t// per-bundle rules\n\t// - - - - - - - - - - - - - - - -\n\tbundles.each(function(bundle) {\n\t\tattrs = bundle.attrs(); //get(\"attrs\");\n\t\tfgColor = bundle.colors.fgColor;\n\t\tbgColor = bundle.colors.bgColor;\n\t\tlnColor = bundle.colors.lnColor;\n\t\thasDarkBg = bundle.colors.hasDarkBg;\n\n\t\tinitBodyStyles(colorStyles.sheet, \"BODY.\" + bundle.get(\"domid\"), attrs, fgColor, bgColor, lnColor, hasDarkBg);\n\t\tinitCarouselStyles(colorStyles.sheet, \".carousel.\" + bundle.get(\"domid\"), attrs, fgColor, bgColor, lnColor, hasDarkBg);\n\t});\n};",
    "/*global XMLHttpRequest */\nvar _ = require(\"underscore\");\n/** @type {module:underscore.string/lpad} */\nvar classify = require(\"underscore.string/classify\");\n\n// var statusMsg = _.template(\"<%= status %> received from <%= url %> (<%= statusText %>)\");\n// var errMsg = _.template(\"'<%= errName %>' ocurred during request <%= url %>\");\n\nif (window.XMLHttpRequest && window.URL && window.Blob) {\n\tmodule.exports = function(url, progressFn) {\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tvar request = new XMLHttpRequest();\n\t\t\trequest.open(\"GET\", url, true);\n\t\t\t// request.timeout = 10000; // in milliseconds\n\t\t\trequest.responseType = \"blob\";\n\n\t\t\t// if progressFn is supplied\n\t\t\t// - - - - - - - - - - - - - - - - - -\n\t\t\tif (progressFn) {\n\t\t\t\trequest.onprogress = function(ev) {\n\t\t\t\t\tprogressFn(ev.loaded / ev.total);\n\t\t\t\t};\n\t\t\t}\n\t\t\t// resolved/success\n\t\t\t// - - - - - - - - - - - - - - - - - -\n\t\t\trequest.onload = function(ev) {\n\t\t\t\t// When the request loads, check whether it was successful\n\t\t\t\tif (request.status == 200) {\n\t\t\t\t\t// If successful, resolve the promise by passing back a reference url\n\t\t\t\t\tresolve(URL.createObjectURL(request.response));\n\t\t\t\t} else {\n\t\t\t\t\tvar err = new Error((\"http_\" + request.statusText.replace(/\\s/g, \"_\")).toUpperCase());\n\t\t\t\t\terr.infoCode = request.status;\n\t\t\t\t\terr.infoSrc = url;\n\t\t\t\t\terr.logEvent = ev;\n\t\t\t\t\terr.logMessage = \"_loadImageAsObjectURL::\" + ev.type + \" [reject]\";\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t};\n\t\t\t// reject/failure\n\t\t\t// - - - - - - - - - - - - - - - - - -\n\t\t\trequest.onerror = function(ev) {\n\t\t\t\tvar err = new Error((ev.type + \"_event\").toUpperCase());\n\t\t\t\terr.infoCode = -1;\n\t\t\t\terr.infoSrc = url;\n\t\t\t\terr.logEvent = ev;\n\t\t\t\terr.logMessage = \"_loadImageAsObjectURL::\" + ev.type + \" [reject]\";\n\t\t\t\treject(err);\n\t\t\t};\n\t\t\trequest.onabort = request.ontimeout = request.onerror;\n\t\t\t// finally\n\t\t\t// - - - - - - - - - - - - - - - - - -\n\t\t\trequest.onloadend = function() {\n\t\t\t\trequest.onabort = request.ontimeout = request.onerror = void 0;\n\t\t\t\trequest.onload = request.onloadend = void 0;\n\t\t\t\tif (progressFn) {\n\t\t\t\t\trequest.onprogress = void 0;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\trequest.send();\n\t\t});\n\t};\n} else {\n\tmodule.exports = function(url) {\n\t\treturn Promise.resolve(url);\n\t};\n}\n",
    "module.exports = function(image, resolveEmpty) {\n\treturn new Promise(function(resolve, reject) {\n\t\tif (!(image instanceof window.HTMLImageElement)) {\n\t\t\treject(new Error(\"not an HTMLImageElement\"));\n\t\t} else if (image.complete && (image.src.length > 0 || resolveEmpty)) {\n\t\t\t// if (image.src === \"\") console.warn(\"_whenImageLoads resolved with empty src\");\n\t\t\t// else console.log(\"_whenImageLoads resolve-sync\", image.src);\n\t\t\tresolve(image);\n\t\t} else {\n\t\t\tvar handlers = {\n\t\t\t\tload: function(ev) {\n\t\t\t\t\t// console.log(\"_whenImageLoads_dom resolve-async\", ev.type, image.src);\n\t\t\t\t\tremoveEventListeners();\n\t\t\t\t\tresolve(image);\n\t\t\t\t},\n\t\t\t\terror: function(ev) {\n\t\t\t\t\tvar err = new Error(\"Loading failed (\" + ev.type + \" event)\");\n\t\t\t\t\terr.infoCode = -1;\n\t\t\t\t\terr.infoSrc = image.src;\n\t\t\t\t\terr.logEvent = ev;\n\t\t\t\t\terr.logMessage = \"_whenImageLoads::\" + ev.type + \" [reject]\";\n\t\t\t\t\tremoveEventListeners();\n\t\t\t\t\treject(err);\n\t\t\t\t}\n\t\t\t};\n\t\t\thandlers.abort = handlers.error;\n\t\t\tvar removeEventListeners = function() {\n\t\t\t\tfor (var event in handlers) {\n\t\t\t\t\tif (handlers.hasOwnProperty(event)) {\n\t\t\t\t\t\timage.removeEventListener(event, handlers[event], false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tfor (var event in handlers) {\n\t\t\t\tif (handlers.hasOwnProperty(event)) {\n\t\t\t\t\timage.addEventListener(event, handlers[event], false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};\n",
    "/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n/** @type {module:app/view/promise/_whenImageLoads} */\nvar _whenImageLoads = require(\"app/view/promise/_whenImageLoads\");\n/** @type {module:app/view/promise/_loadImageAsObjectURL} */\nvar _loadImageAsObjectURL = require(\"app/view/promise/_loadImageAsObjectURL\");\n\n// var isBlobRE = /^blob\\:.*/;\n\nvar logMessage = \"%s::whenDefaultImageLoads [%s]: %s\";\n\nmodule.exports = function(view) {\n\treturn new Promise(function(resolve, reject) {\n\t\tvar source = view.model.get(\"source\");\n\t\tif (source.has(\"prefetched\")) {\n\t\t\tview.defaultImage.src = source.get(\"prefetched\");\n\t\t\t_whenImageLoads(view.defaultImage)\n\t\t\t\t.then(\n\t\t\t\t\tfunction(targetEl) {\n\t\t\t\t\t\t// console.log(logMessage, view.cid, \"resolved\", \"prefetched\");\n\t\t\t\t\t\tresolve(view);\n\t\t\t\t\t});\n\t\t} else {\n\t\t\tview.mediaState = \"pending\";\n\n\t\t\tvar sUrl = source.get(\"original\");\n\t\t\tvar progressFn = function(progress) {\n\t\t\t\t// console.log(logMessage, view.cid, \"progress\", progress);\n\t\t\t\tview.updateMediaProgress(progress, sUrl);\n\t\t\t};\n\t\t\tprogressFn = _.throttle(progressFn, 100, {\n\t\t\t\tleading: true,\n\t\t\t\ttrailing: false\n\t\t\t});\n\t\t\t_loadImageAsObjectURL(sUrl, progressFn)\n\t\t\t\t.then(\n\t\t\t\t\tfunction(url) {\n\t\t\t\t\t\tif (/^blob\\:.*/.test(url)) {\n\t\t\t\t\t\t\tsource.set(\"prefetched\", url);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tview.defaultImage.src = url;\n\t\t\t\t\t\t// URL.revokeObjectURL(url); \n\t\t\t\t\t\treturn view.defaultImage;\n\t\t\t\t\t})\n\t\t\t\t.then(_whenImageLoads)\n\t\t\t\t.then(\n\t\t\t\t\tfunction(targetEl) {\n\t\t\t\t\t\t// console.log(logMessage, view.cid, \"resolved\", targetEl.src);\n\t\t\t\t\t\tview.on(\"view:removed\", function() {\n\t\t\t\t\t\t\tvar prefetched = source.get(\"prefetched\");\n\t\t\t\t\t\t\tif (prefetched && /^blob\\:/.test(prefetched)) {\n\t\t\t\t\t\t\t\tsource.unset(\"prefetched\", {\n\t\t\t\t\t\t\t\t\tsilent: true\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tURL.revokeObjectURL(prefetched);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// view.placeholder.removeAttribute(\"data-progress\");\n\t\t\t\t\t\t// view.updateMediaProgress(imageUrl, \"complete\");\n\t\t\t\t\t\tresolve(view);\n\t\t\t\t\t},\n\t\t\t\t\t// \t})\n\t\t\t\t\t// .catch(\n\t\t\t\t\tfunction(err) {\n\t\t\t\t\t\t// console.warn(logMessage, view.cid, \"rejected\", err.message);\n\t\t\t\t\t\t// view.placeholder.removeAttribute(\"data-progress\");\n\t\t\t\t\t\t// view.updateMediaProgress(imageUrl, progress);\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t});\n\t\t}\n\t});\n};\n",
    "/* global Promise */\n/** @type {module:app/view/base/ViewError} */\nvar ViewError = require(\"app/view/base/ViewError\");\n\n/** @type {module:app/view/base/ViewError} */\nvar whenViewIsAttached = require(\"app/view/promise/whenViewIsAttached\");\n\nfunction whenScrollingEnds(view) {\n\treturn new Promise(function(resolve, reject) {\n\t\tvar parent = view.parentView;\n\t\tif (parent === null) {\n\t\t\tconsole.error(\"%s::whenScrollingEnds [%s] (sync)\", view.cid, \"rejected\", view.attached);\n\t\t\treject(new ViewError(view, new Error(\"whenScrollingEnds: view has no parent\")));\n\t\t} else if (!parent.scrolling) {\n\t\t\t// console.log(\"%s::whenScrollingEnds [%s] (sync)\", view.cid, \"resolved\", view.attached);\n\t\t\tresolve(view);\n\t\t} else {\n\t\t\tvar cleanup = function() {\n\t\t\t\tparent.off(\"view:scrollend\", onScrollend);\n\t\t\t\tparent.off(\"view:remove\", onRemove);\n\t\t\t};\n\t\t\tvar onScrollend = function() {\n\t\t\t\t// console.log(\"%s::whenScrollingEnds [%s]\", view.cid, \"resolved\", view.attached);\n\t\t\t\tcleanup();\n\t\t\t\tresolve(view);\n\t\t\t};\n\t\t\tvar onRemove = function() {\n\t\t\t\t// console.log(\"%s::whenScrollingEnds [%s]\", view.cid, \"rejected\", view.attached);\n\t\t\t\tcleanup();\n\t\t\t\treject(new ViewError(view, new Error(\"whenScrollingEnds: view was removed\")));\n\t\t\t};\n\t\t\tparent.on(\"view:scrollend\", onScrollend);\n\t\t\tparent.on(\"view:remove\", onRemove);\n\t\t}\n\t});\n}\n\nmodule.exports = function(view) {\n\treturn Promise.resolve(view)\n\t\t.then(whenViewIsAttached)\n\t\t.then(whenScrollingEnds);\n};\n\n/*\nmodule.exports = function(view) {\n\treturn Promise.resolve(view)\n\t\t.then(function(view) {\n\t\t\tif (view.attached) {\n\t\t\t\treturn view;\n\t\t\t} else {\n\t\t\t\treturn new Promise(function(resolve, reject) {\n\t\t\t\t\tview.once(\"view:attached\", function(view) {\n\t\t\t\t\t\tresolve(view);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\t\t.then(function(view) {\n\t\t\tif (!view.parentView.scrolling) {\n\t\t\t\treturn view;\n\t\t\t} else {\n\t\t\t\treturn new Promise(function(resolve, reject) {\n\t\t\t\t\tvar resolveOnScrollend = function() {\n\t\t\t\t\t\t// console.log(\"%s::whenScrollingEnds [%s]\", view.cid, \"resolved\");\n\t\t\t\t\t\tview.off(\"view:remove\", rejectOnRemove);\n\t\t\t\t\t\tresolve(view);\n\t\t\t\t\t};\n\t\t\t\t\tvar rejectOnRemove = function(view) {\n\t\t\t\t\t\t// console.log(\"%s::whenScrollingEnds [%s]\", view.cid, \"rejected\");\n\t\t\t\t\t\tview.parentView.off(\"view:scrollend\", resolveOnScrollend);\n\t\t\t\t\t\treject(new ViewError(view,\n\t\t\t\t\t\t\tnew Error(\"whenSelectScrollingEnds: view was removed (\"+ view.cid +\")\")));\n\t\t\t\t\t};\n\t\t\t\t\tview.parentView.once(\"view:scrollend\", resolveOnScrollend);\n\t\t\t\t\tview.once(\"view:remove\", rejectOnRemove);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n};\n*/\n",
    "/** @type {module:app/view/base/ViewError} */\nvar ViewError = require(\"app/view/base/ViewError\");\n\n// var logMessage = \"%s::whenSelectionDistanceIs [%s]: %s\";\n\n/**\n * @param {module:app/view/base/View}\n * @param {number} distance\n */\nmodule.exports = function(view, distance) {\n\treturn new Promise(function(resolve, reject) {\n\t\t// if (!(view.model && view.model.collection)) {\n\t\t// \treject(new ViewError(view, new Error(\"whenSelectionIsContiguous: model.collection is empty\")));\n\t\t// }\n\t\tvar model = view.model;\n\t\tvar collection = model.collection;\n\n\t\tvar check = function(n) { // Check indices for contiguity\n\t\t\treturn Math.abs(collection.indexOf(model) - collection.selectedIndex) <= distance;\n\t\t};\n\n\t\tif (check()) {\n\t\t\t// console.log(logMessage, view.cid, \"resolve\", \"sync\");\n\t\t\tresolve(view);\n\t\t} else {\n\t\t\tvar cleanupOnSettle = function() {\n\t\t\t\t// console.log(logMessage, view.cid, \"cleanup\", \"async\");\n\t\t\t\tcollection.off(\"select:one select:none\", resolveOnSelect);\n\t\t\t\tview.off(\"view:removed\", rejectOnRemove);\n\t\t\t};\n\t\t\tvar resolveOnSelect = function(model) {\n\t\t\t\tif (check()) {\n\t\t\t\t\t// console.log(logMessage, view.cid, \"resolve\", \"async\");\n\t\t\t\t\tcleanupOnSettle();\n\t\t\t\t\tresolve(view);\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar rejectOnRemove = function(view) {\n\t\t\t\tcleanupOnSettle();\n\t\t\t\treject(new ViewError(view, new Error(\"whenSelectionDistanceIs: view was removed\")));\n\t\t\t};\n\t\t\tcollection.on(\"select:one select:none\", resolveOnSelect);\n\t\t\tview.on(\"view:removed\", rejectOnRemove);\n\t\t}\n\t});\n};\n",
    "/** @type {module:app/view/base/ViewError} */\nvar ViewError = require(\"app/view/base/ViewError\");\n\n/** @type {module:app/view/promise/whenSelectionDistanceIs} */\nvar whenSelectionDistanceIs = require(\"app/view/promise/whenSelectionDistanceIs\");\n\n/** @param {module:app/view/base/View} */\nmodule.exports = function(view) {\n\treturn whenSelectionDistanceIs(view, 1);\n};\n",
    "module.exports = function(view) {\n\treturn new Promise(function(resolve, reject) {\n\t\tif (view.attached) {\n\t\t\tresolve(view);\n\t\t} else {\n\t\t\tview.on(\"view:attached\", function(view) {\n\t\t\t\tresolve(view);\n\t\t\t});\n\t\t}\n\t});\n};\n",
    "/**\n * @module app/view/render/CarouselRenderer\n */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:underscore} */\nvar getBoxEdgeStyles = require(\"utils/css/getBoxEdgeStyles\");\n\n// FIXME: this fixup should not be done here\n// /** @type {module:utils/net/toAbsoluteURL} */\n// var toAbsoluteURL = require(\"utils/net/toAbsoluteURL\");\n// /** @type {string} */\n// var ABS_APP_ROOT = toAbsoluteURL(require(\"app/control/Globals\").APP_ROOT);\n\n/**\n * @constructor\n * @type {module:app/view/render/CarouselRenderer}\n */\nvar CarouselRenderer = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"carouselRenderer\",\n\t/** @override */\n\ttagName: \"div\",\n\t/** @override */\n\tclassName: \"carousel-item\",\n\t/** @override */\n\ttemplate: _.template(\"<div class=\\\"content sizing\\\"><%= name %></div>\"),\n\n\tproperties: {\n\t\tcontent: {\n\t\t\tget: function() {\n\t\t\t\treturn this._content || (this._content = this.el.querySelector(\".content\"));\n\t\t\t},\n\t\t},\n\t\tsizing: {\n\t\t\tget: function() {\n\t\t\t\treturn this._sizing || (this._sizing = this.el.querySelector(\".sizing\"));\n\t\t\t},\n\t\t}\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tif (this.model.attr(\"@classname\") !== void 0) {\n\t\t\tvar clsAttr = this.model.attr(\"@classname\").split(\" \");\n\t\t\tfor (var i = 0; i < clsAttr.length; i++) {\n\t\t\t\tthis.el.classList.add(clsAttr[i]);\n\t\t\t}\n\t\t}\n\t\toptions.parentView && (this.parentView = options.parentView);\n\t\tthis.metrics = {};\n\t\tthis.metrics.content = {};\n\t\tthis.createChildren();\n\t\t// this.enabled = !!options.enabled; // force bool\n\t\tthis.setEnabled(!!options.enabled);\n\t},\n\n\tcreateChildren: function() {\n\t\tthis.el.innerHTML = this.template(this.model.toJSON());\n\t\t// FIXME: this fixup should not be done here\n\t\t// FIXED: now done in xslt\n\t\t/*this.el.querySelectorAll(\"a[href]\").forEach(function(el) {\n\t\t\tvar url = toAbsoluteURL(el.getAttribute(\"href\"));\n\t\t\tif (url.indexOf(ABS_APP_ROOT) !== 0) {\n\t\t\t\tel.setAttribute(\"target\", \"_blank\");\n\t\t\t}\n\t\t});*/\n\t},\n\n\t/** @return {HTMLElement} */\n\tgetSizingEl: function() {\n\t\treturn this._sizing || (this._sizing = this.el.querySelector(\".sizing\"));\n\t},\n\n\t/** @return {HTMLElement} */\n\tgetContentEl: function() {\n\t\treturn this._content || (this._content = this.el.querySelector(\".content\"));\n\t},\n\n\t/** @return {this} */\n\tmeasure: function() {\n\t\tvar sizing = this.getSizingEl();\n\n\t\tthis.metrics = getBoxEdgeStyles(this.el, this.metrics);\n\t\tthis.metrics.content = getBoxEdgeStyles(this.getContentEl(), this.metrics.content);\n\n\t\tsizing.style.maxWidth = \"\";\n\t\tsizing.style.maxHeight = \"\";\n\n\t\tthis.metrics.content.x = sizing.offsetLeft + sizing.clientLeft;\n\t\tthis.metrics.content.y = sizing.offsetTop + sizing.clientTop;\n\t\tthis.metrics.content.width = sizing.clientWidth;\n\t\tthis.metrics.content.height = sizing.clientHeight;\n\n\t\treturn this;\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tthis.measure();\n\t\treturn this;\n\t},\n\n\tgetSelectionDistance: function() {\n\t\treturn Math.abs(this.model.collection.indexOf(this.model) - this.model.collection.selectedIndex);\n\t},\n});\n\nmodule.exports = CarouselRenderer;",
    "/**\n * @module app/view/render/ClickableRenderer\n */\n\n/** @type {module:app/view/render/LabelRenderer} */\nvar LabelRenderer = require(\"app/view/render/LabelRenderer\");\n\n/**\n * @constructor\n * @type {module:app/view/render/ClickableRenderer}\n */\nvar ClickableRenderer = LabelRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"clickableRenderer\",\n\n\t/** @override */\n\tevents: {\n\t\t\"click\": function(ev) {\n\t\t\tthis.trigger(\"renderer:click\", this.model, ev);\n\t\t},\n\t\t\"click a\": function(ev) {\n\t\t\tev.defaultPrevented || ev.preventDefault();\n\t\t}\n\t},\n});\n\nmodule.exports = ClickableRenderer;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=\"function\";\n\n  return \"<a href=\\\"#\"\n    + container.escapeExpression(((helper = (helper = helpers.domid || (depth0 != null ? depth0.domid : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"domid\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\"><span class=\\\"label\\\">\"\n    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper))) != null ? stack1 : \"\")\n    + \"</span></a>\";\n},\"useData\":true});\n",
    "/**\n * @module app/view/render/DefaultSelectableRenderer\n */\n\n/** @type {module:app/view/component/ClickableRenderer} */\nvar ClickableRenderer = require(\"app/view/render/ClickableRenderer\");\n\n/**\n * @constructor\n * @type {module:app/view/render/DefaultSelectableRenderer}\n */\nvar DefaultSelectableRenderer = ClickableRenderer.extend({\n\n\t/** @override */\n\ttagName: \"li\",\n\t/** @override */\n\tclassName: \"list-item\",\n\t/** @override */\n\ttemplate: require(\"./DefaultSelectableRenderer.hbs\"),\n\n\tinitialize: function(options) {\n\t\tthis.listenTo(this.model, \"selected deselected\", this._renderClassList);\n\t\tthis._renderClassList();\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tthis.el.innerHTML = this.template(this.model.toJSON());\n\t\tthis._renderClassList();\n\t\treturn this;\n\t},\n\n\t_renderClassList: function() {\n\t\tthis.el.classList.toggle(\"selected\", this.model.selected);\n\t},\n});\n\nmodule.exports = DefaultSelectableRenderer;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=\"function\", alias4=container.escapeExpression;\n\n  return \"<span class=\\\"label\\\">\"\n    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</span><a href=\\\"#\"\n    + alias4(((helper = (helper = helpers.domid || (depth0 != null ? depth0.domid : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"domid\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\"><b> </b></a>\";\n},\"useData\":true});\n",
    "/**\n * @module app/view/render/DotNavigationRenderer\n */\n\n// /** @type {module:underscore} */\n// var _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {string} */\nvar viewTemplate = require(\"./DotNavigationRenderer.hbs\");\n/** @type {module:app/view/component/ClickableRenderer} */\nvar ClickableRenderer = require(\"app/view/render/ClickableRenderer\");\n\n/**\n * @constructor\n * @type {module:app/view/render/DotNavigationRenderer}\n */\nvar DotNavigationRenderer = ClickableRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"dotRenderer\",\n\t/** @override */\n\ttagName: \"li\",\n\t/** @override */\n\tclassName: \"list-item\",\n\t/** @override */\n\ttemplate: viewTemplate,\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\tthis.listenTo(this.model, \"selected deselected\", this.renderClassList);\n\t\tthis.renderClassList();\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tthis.el.innerHTML = this.template(this.model.toJSON());\n\t\tthis.renderClassList();\n\t\treturn this;\n\t},\n\n\trenderClassList: function() {\n\t\tthis.el.classList.toggle(\"selected\", this.model.selected);\n\t},\n});\n\nmodule.exports = DotNavigationRenderer;\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=\"function\", alias4=container.escapeExpression;\n\n  return \"<div class=\\\"placeholder sizing\\\"></div>\\n<img class=\\\"content media-border default\\\" alt=\\\"\"\n    + alias4(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"text\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" longdesc=\\\"#desc_m\"\n    + alias4(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"id\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" />\\n\";\n},\"useData\":true});\n",
    "/**\n * @module app/view/render/ImageRenderer\n */\n\n// /** @type {module:underscore} */\n// var _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n\n// /** @type {module:app/control/Globals} */\n// var Globals = require(\"app/control/Globals\");\n// /** @type {module:app/model/item/MediaItem} */\n// var MediaItem = require(\"app/model/item/MediaItem\");\n\n/** @type {module:app/view/MediaRenderer} */\nvar MediaRenderer = require(\"./MediaRenderer\");\n\n/** @type {Function} */\nvar viewTemplate = require(\"./ImageRenderer.hbs\");\n\n/**\n * @constructor\n * @type {module:app/view/render/ImageRenderer}\n */\nvar ImageRenderer = MediaRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"imageRenderer\",\n\t/** @type {string} */\n\tclassName: MediaRenderer.prototype.className + \" image-renderer\",\n\t/** @type {Function} */\n\ttemplate: viewTemplate,\n\n\t/** @override */\n\tinitialize: function(opts) {\n\t\tMediaRenderer.prototype.initialize.apply(this, arguments);\n\t\t// this.createChildren();\n\t\t// this.initializeAsync();\n\t},\n\n\t/* --------------------------- *\n\t/* children/layout\n\t/* --------------------------- */\n\n\t/** @override */\n\tcreateChildren: function() {\n\t\tMediaRenderer.prototype.createChildren.apply(this, arguments);\n\t\t// this.el.innerHTML = this.template(this.model.toJSON());\n\t\tthis.placeholder = this.el.querySelector(\".placeholder\");\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tMediaRenderer.prototype.render.apply(this, arguments);\n\n\t\t// this.measure();\n\n\t\tvar img = this.getDefaultImage();\n\t\timg.setAttribute(\"width\", this.metrics.media.width);\n\t\timg.setAttribute(\"height\", this.metrics.media.height);\n\n\t\tvar content = this.getContentEl();\n\t\tcontent.style.left = this.metrics.content.x + \"px\";\n\t\tcontent.style.top = this.metrics.content.y + \"px\";\n\n\t\t// var sizing = this.getSizingEl();\n\t\t// sizing.style.maxWidth = this.metrics.content.width + \"px\";\n\t\t// sizing.style.maxHeight = this.metrics.content.height + \"px\";\n\n\t\treturn this;\n\t},\n\n\t/* --------------------------- *\n\t/* initializeAsync\n\t/* --------------------------- */\n\n\tinitializeAsync: function() {\n\t\treturn MediaRenderer.prototype.initializeAsync.apply(this, arguments)\n\t\t// return MediaRenderer.whenSelectionIsContiguous(this)\n\t\t// // return Promise.resolve(this)\n\t\t// // \t.then(MediaRenderer.whenSelectionIsContiguous)\n\t\t// \t.then(MediaRenderer.whenSelectTransitionEnds)\n\t\t// \t.then(MediaRenderer.whenDefaultImageLoads)\n\t\t// .then(\n\t\t// \tfunction(view) {\n\t\t// \t\tview.mediaState = \"ready\";\n\t\t// \t})\n\t\t// .catch(\n\t\t// \tfunction(err) {\n\t\t// \t\tif (err instanceof ViewError) {\n\t\t// \t\t\t// NOTE: ignore ViewError type\n\t\t// \t\t\t// console.log(err.view.cid, err.view.model.cid, \"ImageRenderer: \" + err.message);\n\t\t// \t\t} else {\n\t\t// \t\t\tconsole.error(this.cid, err.name, err);\n\t\t// \t\t\tthis.placeholder.innerHTML = \"<p class=\\\"color-fg\\\" style=\\\"position:absolute;bottom:0;padding:3rem;\\\"><strong>\" + err.name + \"</strong> \" + err.message + \"</p>\";\n\t\t// \t\t\tthis.mediaState = \"error\";\n\t\t// \t\t}\n\t\t// \t}.bind(this))\n\t\t;\n\t},\n});\n\nmodule.exports = ImageRenderer;\n",
    "/**\n * @module app/view/render/LabelRenderer\n */\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n\n/**\n * @constructor\n * @type {module:app/view/render/LabelRenderer}\n */\nvar LabelRenderer = View.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"labelRenderer\",\n\n\tproperties: {\n\t\tlabel: {\n\t\t\tget: function() {\n\t\t\t\treturn this._label || (this._label = this.el.querySelector(\".label\"));\n\t\t\t}\n\t\t}\n\t\t// measuredWidth: {\n\t\t// \tget: function() {\n\t\t// \t\treturn this._measuredWidth;\n\t\t// \t}\n\t\t// },\n\t\t// measuredHeight: {\n\t\t// \tget: function() {\n\t\t// \t\treturn this._measuredHeight;\n\t\t// \t}\n\t\t// },\n\t},\n\n\t/* -------------------------------\n\t/* measure\n\t/* ------------------------------- */\n\n\t// _measuredWidth: null,\n\t// _measuredHeight: null,\n\t// measure: function() {},\n});\n\nmodule.exports = LabelRenderer;\n",
    "/*global XMLHttpRequest, HTMLMediaElement, MediaError*/\n/**\n * @module app/view/render/MediaRenderer\n */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n/** @type {module:underscore.strings/lpad} */\nvar lpad = require(\"underscore.string/lpad\");\n// /** @type {module:utils/css/getBoxEdgeStyles} */\n// var getBoxEdgeStyles = require(\"utils/css/getBoxEdgeStyles\");\n\n/** @type {module:app/model/item/MediaItem} */\nvar MediaItem = require(\"app/model/item/MediaItem\");\n/** @type {module:app/view/CarouselRenderer} */\nvar CarouselRenderer = require(\"app/view/render/CarouselRenderer\");\n\nvar errorTemplate = require(\"../template/ErrorBlock.hbs\");\n\nvar MediaRenderer = CarouselRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"mediaRenderer\",\n\t/** @type {string} */\n\tclassName: CarouselRenderer.prototype.className + \" media-item\",\n\t/** @type {module:app/model/MediaItem} */\n\tmodel: MediaItem,\n\n\tproperties: {\n\t\tdefaultImage: {\n\t\t\tget: function() {\n\t\t\t\treturn this._defaultImage || (this._defaultImage = this.el.querySelector(\"img.default\"));\n\t\t\t}\n\t\t},\n\t\tmediaState: {\n\t\t\tget: function() {\n\t\t\t\treturn this._mediaState;\n\t\t\t},\n\t\t\tset: function(state) {\n\t\t\t\tthis._setMediaState(state);\n\t\t\t}\n\t\t}\n\t},\n\n\t/** @override */\n\tinitialize: function(opts) {\n\t\t// if (this.model.attrs().hasOwnProperty(\"@classname\")) {\n\t\t// \tthis.el.className += \" \" + this.model.attr(\"@classname\");\n\t\t// }\n\n\t\t// NOTE: @classname attr handling moved to CarouselRenderer\n\t\t// if (this.model.attr(\"@classname\") !== void 0) {\n\t\t// \tvar clsAttr = this.model.attr(\"@classname\").split(\" \");\n\t\t// \tfor (var i = 0; i < clsAttr.length; i++) {\n\t\t// \t\tthis.el.classList.add(clsAttr[i]);\n\t\t// \t}\n\t\t// }\n\t\tCarouselRenderer.prototype.initialize.apply(this, arguments);\n\n\t\tthis.metrics.media = {};\n\t\tthis.mediaState = \"idle\";\n\n\t\tthis.initializeAsync()\n\t\t\t.then(this.whenInitialized)\n\t\t\t.catch(this.whenInitializeError.bind(this));\n\t},\n\n\tinitializeAsync: function() {\n\t\t// var MediaRenderer = Object.getPrototypeOf(this).constructor;\n\t\treturn Promise.resolve(this)\n\t\t\t.then(MediaRenderer.whenSelectionIsContiguous)\n\t\t\t.then(MediaRenderer.whenScrollingEnds)\n\t\t\t.then(MediaRenderer.whenDefaultImageLoads);\n\t},\n\n\twhenInitialized: function(view) {\n\t\t// console.log(\"%s::whenInitialized [%s]\", view.cid, \"resolved\");\n\t\tview.mediaState = \"ready\";\n\t\tview.placeholder.removeAttribute(\"data-progress\");\n\t\treturn view;\n\t},\n\n\twhenInitializeError: function(err) {\n\t\tif (err instanceof CarouselRenderer.ViewError) {\n\t\t\t// NOTE: ignore ViewError type\n\t\t\t// console.log(\"%s::whenInitializeError\", err.view.cid, err.message);\n\t\t\treturn;\n\t\t} else if (err instanceof Error) {\n\t\t\tconsole.error(err.stack);\n\t\t}\n\t\tthis.renderMediaError(err);\n\t\tthis.placeholder.removeAttribute(\"data-progress\");\n\t\tthis.mediaState = \"error\";\n\t\t// this.placeholder.innerHTML = errorTemplate(err);\n\t\t// this.placeholder.removeAttribute(\"data-progress\");\n\t\t// this.mediaState = \"error\";\n\n\t\tconsole.error(\"%s::initializeAsync [%s (caught)]: %s\", this.cid, err.name,\n\t\t\t(err.info && err.info.logMessage) || err.message);\n\t\terr.logEvent && console.log(err.logEvent);\n\t},\n\n\trenderMediaError: function(err) {\n\t\tthis.placeholder.innerHTML = err ? errorTemplate(err) : \"\";\n\t},\n\n\tupdateMediaProgress: function(progress, id) {\n\t\tif (_.isNumber(progress)) {\n\t\t\tthis.placeholder.setAttribute(\"data-progress\", lpad(Math.floor(progress * 100), 2, '0'));\n\t\t}\n\t\t// else if (progress === \"complete\") {\n\t\t// \tthis.placeholder.removeAttribute(\"data-progress\");\n\t\t// }\n\t},\n\n\t// whenMediaIsReady: function(view) {\n\t// \treturn MediaRenderer.whenDefaultImageLoads(this, this.updateMediaProgress.bind(this));\n\t// },\n\n\t/* --------------------------- *\n\t/* child getters\n\t/* --------------------------- */\n\n\t/** @return {HTMLElement} */\n\tgetDefaultImage: function() {\n\t\treturn this.defaultImage;\n\t},\n\n\t/* --------------------------- *\n\t/* children/layout\n\t/* --------------------------- */\n\n\tcreateChildren: function() {\n\t\tthis.el.innerHTML = this.template(this.model.toJSON());\n\t},\n\n\t/** @override */\n\tmeasure: function() {\n\t\tCarouselRenderer.prototype.measure.apply(this, arguments);\n\n\t\tvar sw, sh; // source dimensions\n\t\tvar pcw, pch; // measured values\n\t\tvar cx, cy, cw, ch, cs; // computed values\n\t\tvar ew, eh; // content edge totals\n\t\tvar cm; // content metrics\n\n\t\tcm = this.metrics.content;\n\t\tcx = cm.x;\n\t\tcy = cm.y;\n\t\tpcw = cm.width;\n\t\tpch = cm.height;\n\n\t\tew = (cm.paddingLeft + cm.paddingRight + cm.borderLeftWidth + cm.borderRightWidth);\n\t\teh = (cm.paddingTop + cm.paddingBottom + cm.borderTopWidth + cm.borderBottomWidth);\n\t\tpcw -= ew;\n\t\tpch -= eh;\n\n\t\tsw = this.model.get(\"source\").get(\"w\");\n\t\tsh = this.model.get(\"source\").get(\"h\");\n\n\t\t// Unless both client dimensions are larger than the source's\n\t\t// choose constraint direction by aspect ratio\n\t\tif (sw < pcw && sh < pch) {\n\t\t\tcs = 1;\n\t\t\tcw = sw;\n\t\t\tch = sh;\n\t\t} else if ((pcw / pch) < (sw / sh)) {\n\t\t\t// constrain height\n\t\t\tcw = pcw;\n\t\t\tcs = cw / sw;\n\t\t\t// ch = cs * sh;\n\t\t\tch = Math.round(cs * sh);\n\t\t} else {\n\t\t\t// constrain width\n\t\t\tch = pch;\n\t\t\tcs = ch / sh;\n\t\t\t// cw = cs * sw;\n\t\t\tcw = Math.round(cs * sw);\n\t\t}\n\n\t\tthis.metrics.content.x = cx;\n\t\tthis.metrics.content.y = cy;\n\t\tthis.metrics.content.width = cw + ew;\n\t\tthis.metrics.content.height = ch + eh;\n\n\t\tthis.metrics.media.x = cx + cm.paddingLeft + cm.borderLeftWidth;\n\t\tthis.metrics.media.y = cy + cm.paddingTop + cm.borderTopWidth;\n\t\tthis.metrics.media.width = cw;\n\t\tthis.metrics.media.height = ch;\n\t\tthis.metrics.media.scale = cs;\n\n\t\t// var sizing = this.getSizingEl();\n\t\t// sizing.style.maxWidth = (cw + ew) + \"px\";\n\t\t// sizing.style.maxHeight = (ch + eh) + \"px\";\n\n\t\treturn this;\n\t},\n\n\trender: function() {\n\t\t// NOTE: not calling super.render, calling measure ourselves\n\t\tthis.measure();\n\n\t\tvar sizing = this.getSizingEl();\n\t\tsizing.style.maxWidth = this.metrics.content.width + \"px\";\n\t\tsizing.style.maxHeight = this.metrics.content.height + \"px\";\n\n\t\treturn this;\n\t},\n\n\t/* --------------------------- *\n\t/* mediaState\n\t/* --------------------------- */\n\n\t_mediaStateEnum: [\"idle\", \"pending\", \"ready\", \"error\"],\n\n\t_setMediaState: function(key) {\n\t\tif (this._mediaStateEnum.indexOf(key) === -1) {\n\t\t\tthrow new Error(\"Argument \" + key + \" invalid. Must be one of: \" + this._mediaStateEnum.join(\", \"));\n\t\t}\n\t\tif (this._mediaState !== key) {\n\t\t\tif (this._mediaState) {\n\t\t\t\tthis.el.classList.remove(this._mediaState);\n\t\t\t}\n\t\t\tthis.el.classList.add(key);\n\t\t\tthis._mediaState = key;\n\t\t\tthis.trigger(\"media:\" + key);\n\t\t}\n\t},\n}, {\n\tLOG_TO_SCREEN: false,\n\n\t/** @type {module:app/view/promise/whenSelectionIsContiguous} */\n\twhenSelectionIsContiguous: require(\"app/view/promise/whenSelectionIsContiguous\"),\n\n\t// /** @type {module:app/view/promise/whenSelectTransitionEnds} */\n\t// whenSelectTransitionEnds: require(\"app/view/promise/whenSelectTransitionEnds\"),\n\n\t/** @type {module:app/view/promise/whenScrollingEnds} */\n\twhenScrollingEnds: require(\"app/view/promise/whenScrollingEnds\"),\n\n\t/** @type {module:app/view/promise/whenDefaultImageLoads} */\n\twhenDefaultImageLoads: require(\"app/view/promise/whenDefaultImageLoads\"),\n});\n\n/* ---------------------------\n/* log to screen\n/* --------------------------- */\nif (DEBUG) {\n\n\tMediaRenderer = (function(MediaRenderer) {\n\t\tif (!MediaRenderer.LOG_TO_SCREEN) return MediaRenderer;\n\n\t\t/** @type {Function} */\n\t\tvar Color = require(\"color\");\n\t\t// /** @type {module:underscore.string/lpad} */\n\t\t// var lpad = require(\"underscore.string/lpad\");\n\t\t// /** @type {module:underscore.string/rpad} */\n\t\t// var rpad = require(\"underscore.string/rpad\");\n\n\t\treturn MediaRenderer.extend({\n\n\t\t\t/** @override */\n\t\t\tinitialize: function() {\n\t\t\t\tMediaRenderer.prototype.initialize.apply(this, arguments);\n\n\t\t\t\tvar fgColor = new Color(this.model.attr(\"color\"));\n\t\t\t\tvar bgColor = new Color(this.model.attr(\"background-color\"));\n\t\t\t\tthis.__logColors = {\n\t\t\t\t\tnormal: fgColor.clone().mix(bgColor, 0.75).hslString(),\n\t\t\t\t\tignored: fgColor.clone().mix(bgColor, 0.25).hslString(),\n\t\t\t\t\terror: \"brown\",\n\t\t\t\t\tabort: \"orange\"\n\t\t\t\t};\n\t\t\t\tthis.__logFrameStyle = \"1px dashed \" + fgColor.clone().mix(bgColor, 0.5).hslString();\n\t\t\t\tthis.__logStartTime = Date.now();\n\t\t\t\tthis.__rafId = -1;\n\t\t\t\tthis.__onFrame = this.__onFrame.bind(this);\n\t\t\t},\n\n\t\t\tinitializeAsync: function() {\n\t\t\t\treturn MediaRenderer.prototype.initializeAsync.apply(this, arguments).catch(function(err) {\n\t\t\t\t\tif (!(err instanceof MediaRenderer.ViewError)) {\n\t\t\t\t\t\tthis.__logMessage(err.message, err.name, this.__logColors[\"error\"]);\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t}.bind(this));\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\tcreateChildren: function() {\n\t\t\t\tvar ret = MediaRenderer.prototype.createChildren.apply(this, arguments);\n\n\t\t\t\tthis.__logElement = document.createElement(\"div\");\n\t\t\t\tthis.__logElement.className = \"debug-log\";\n\t\t\t\tthis.__logHeaderEl = document.createElement(\"pre\");\n\t\t\t\tthis.__logHeaderEl.className = \"log-header color-bg\";\n\t\t\t\t// this.model.colors.fgColor.clone().mix(fgColor, 0.9).rgbString()\n\t\t\t\t// this.model.colors.fgColor.clone().alpha\n\t\t\t\tthis.__logHeaderEl.textContent = this.__getHeaderText();\n\t\t\t\tthis.__logElement.appendChild(this.__logHeaderEl);\n\t\t\t\tthis.el.insertBefore(this.__logElement, this.el.firstElementChild);\n\t\t\t\treturn ret;\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\trender: function() {\n\t\t\t\tMediaRenderer.prototype.render.apply(this, arguments);\n\n\t\t\t\tthis.__logElement.style.marginTop = \"3rem\";\n\t\t\t\tthis.__logElement.style.maxHeight = \"calc(100% - \" + (this.metrics.media.height) + \"px - 3rem)\";\n\t\t\t\tthis.__logElement.style.width = this.metrics.media.width + \"px\";\n\t\t\t\tthis.__logElement.scrollTop = this.__logElement.scrollHeight;\n\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t__logMessage: function(msg, logtype, color) {\n\t\t\t\tvar logEntryEl = document.createElement(\"pre\");\n\n\t\t\t\tlogEntryEl.textContent = this.__getTStamp() + \" \" + msg;\n\t\t\t\tlogEntryEl.setAttribute(\"data-logtype\", logtype || \"-\");\n\t\t\t\tlogEntryEl.style.color = color || this.__logColors[logtype] || this.__logColors.normal;\n\n\t\t\t\tthis.__logElement.appendChild(logEntryEl);\n\t\t\t\tthis.__logElement.scrollTop = this.__logElement.scrollHeight;\n\n\t\t\t\tif (this.__rafId == -1) {\n\t\t\t\t\tthis.__rafId = this.requestAnimationFrame(this.__onFrame);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t__onFrame: function(tstamp) {\n\t\t\t\tthis.__rafId = -1;\n\t\t\t\tthis.__logElement.lastElementChild.style.borderBottom = this.__logFrameStyle;\n\t\t\t\tthis.__logElement.lastElementChild.style.paddingBottom = \"2px\";\n\t\t\t\tthis.__logElement.lastElementChild.style.marginBottom = \"2px\";\n\t\t\t},\n\n\t\t\t__getTStamp: function() {\n\t\t\t\t// return new Date(Date.now() - this.__logStartTime).toISOString().substr(11, 12);\n\t\t\t\treturn lpad(((Date.now() - this.__logStartTime) / 1000).toFixed(3), 8, \"0\");\n\t\t\t},\n\n\t\t\t__getHeaderText: function() {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t});\n\t})(MediaRenderer);\n\n} // end debug\n\n/**\n * @constructor\n * @type {module:app/view/render/MediaRenderer}\n */\nmodule.exports = MediaRenderer;",
    "/**\n * @module app/view/render/PlayableRenderer\n */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n/** @type {Function} */\n// var Color = require(\"color\");\n\n/** @type {module:app/view/MediaRenderer} */\nvar MediaRenderer = require(\"app/view/render/MediaRenderer\");\n// /** @type {module:app/view/component/ProgressMeter} */\n// var ProgressMeter = require(\"app/view/component/ProgressMeter\");\n\n/** @type {Function} */\nvar prefixedProperty = require(\"utils/prefixedProperty\");\n/** @type {Function} */\nvar prefixedEvent = require(\"utils/prefixedEvent\");\n\n// var visibilityHiddenProp = prefixedProperty(\"hidden\", document);\n/** @type {String} */\nvar visibilityStateProp = prefixedProperty(\"visibilityState\", document);\n/** @type {String} */\nvar visibilityChangeEvent = prefixedEvent(\"visibilitychange\", document, \"hidden\");\n\n/** @type {Function} */\n// var duotone = require(\"utils/canvas/bitmap/duotone\");\n// var stackBlurRGB = require(\"utils/canvas/bitmap/stackBlurRGB\");\n// var stackBlurMono = require(\"utils/canvas/bitmap/stackBlurMono\");\n// var getAverageRGBA = require(\"utils/canvas/bitmap/getAverageRGBA\");\n// var getAverageRGB = require(\"utils/canvas/bitmap/getAverageRGB\");\n\n// /** @type {HTMLCanvasElement} */\n// var _sharedCanvas = null;\n// /** @return {HTMLCanvasElement} */\n// var getSharedCanvas = function() {\n// \tif (_sharedCanvas === null) {\n// \t\t_sharedCanvas = document.createElement(\"canvas\");\n// \t}\n// \treturn _sharedCanvas;\n// };\n\n// function logAttachInfo(view, name, level) {\n// \tif ([\"log\", \"info\", \"warn\", \"error\"].indexOf(level) != -1) {\n// \t\tlevel = \"log\";\n// \t}\n// \tconsole[level].call(console, \"%s::%s [parent:%s %s %s depth:%s]\", view.cid, name, view.parentView && view.parentView.cid, view.attached ? \"attached\" : \"detached\", view._viewPhase, view.viewDepth);\n// }\n\n/**\n * @constructor\n * @type {module:app/view/render/PlayableRenderer}\n */\nvar PlayableRenderer = MediaRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"playableRenderer\",\n\n\t/** @type {string|Function} */\n\tclassName: MediaRenderer.prototype.className + \" playable-renderer\",\n\n\tproperties: {\n\t\tpaused: {\n\t\t\t/** @return {Boolean} */\n\t\t\tget: function() {\n\t\t\t\treturn this._isMediaPaused();\n\t\t\t}\n\t\t},\n\t\tplaybackRequested: {\n\t\t\t/** @return {Boolean} */\n\t\t\tget: function() {\n\t\t\t\treturn this._playbackRequested;\n\t\t\t},\n\t\t\tset: function(value) {\n\t\t\t\tthis._setPlaybackRequested(value);\n\t\t\t}\n\t\t},\n\t\tplayToggle: {\n\t\t\t/** @return {HTMLElement} */\n\t\t\tget: function() {\n\t\t\t\treturn this._playToggle || (this._playToggle = this.el.querySelector(\".play-toggle\"));\n\t\t\t}\n\t\t},\n\t\toverlay: {\n\t\t\t/** @return {HTMLElement} */\n\t\t\tget: function() {\n\t\t\t\treturn this._overlay || (this._overlay = this.el.querySelector(\".overlay\"));\n\t\t\t}\n\t\t}\n\t},\n\n\t/** @override */\n\tinitialize: function(opts) {\n\t\tMediaRenderer.prototype.initialize.apply(this, arguments);\n\t\t_.bindAll(this,\n\t\t\t\"_onPlaybackToggle\",\n\t\t\t\"_onVisibilityChange\"\n\t\t);\n\t\tthis._setPlaybackRequested(this._playbackRequested);\n\t\t// this.listenTo(this, \"view:parentChange\", function(childView, newParent, oldParent) {\n\t\t// \t// logAttachInfo(this, \"[view:parentChange]\", \"info\");\n\t\t// \tconsole.info(\"%s::[view:parentChange] '%s' to '%s'\", this.cid, oldParent && oldParent.cid, newParent && newParent.cid);\n\t\t// });\n\t},\n\n\t// /** @override */\n\t// initializeAsync: function() {\n\t// \treturn MediaRenderer.prototype.initialize.initializeAsync.apply(this, arguments);\n\t// },\n\n\t// /** @override */\n\t// remove: function() {\n\t// \tMediaRenderer.prototype.remove.apply(this, arguments);\n\t// \treturn this;\n\t// },\n\n\t/* --------------------------- *\n\t/* children/layout\n\t/* --------------------------- */\n\n\t// createChildren: function() {\n\t// \tthis.el.innerHTML = this.template(this.model.toJSON());\n\t// \tthis.placeholder = this.el.querySelector(\".placeholder\");\n\t// \tthis.content = this.el.querySelector(\".content\");\n\t// \tthis.image = this.content.querySelector(\"img.current\");\n\t// },\n\n\t/* --------------------------- *\n\t/* setEnabled\n\t/* --------------------------- */\n\n\t/** @override */\n\tsetEnabled: function(enabled) {\n\t\tMediaRenderer.prototype.setEnabled.apply(this, arguments);\n\t\t// this._validatePlayback(enabled);\n\t\t// if (enabled) {\n\t\tthis._validatePlayback();\n\t\t// } else {\n\t\t// \t// if selected, pause media\n\t\t// \tthis.model.selected && this.togglePlayback(false);\n\t\t// \t// this.togglePlayback(false);\n\t\t// }\n\t},\n\n\t/* ---------------------------\n\t/* selection handlers\n\t/* --------------------------- */\n\n\taddSelectionListeners: function() {\n\t\tif (this._viewPhase != \"initialized\")\n\t\t\tthrow new Error(this.cid + \"::addSelectionListeners called while \" + this._viewPhase);\n\n\t\t// logAttachInfo(this, \"addSelectionListeners\", \"log\");\n\t\t// this.listenTo(this, \"view:removed\", this.removeSelectionListeners);\n\t\tthis.listenTo(this.model, \"selected\", this._onModelSelected);\n\t\tthis.listenTo(this.model, \"deselected\", this._onModelDeselected);\n\t\tif (this.model.selected) {\n\t\t\tthis._onModelSelected();\n\t\t}\n\t},\n\n\t// removeSelectionListeners: function() {\n\t// \t// logAttachInfo(this, \"removeSelectionListeners\", \"log\");\n\t// \tthis.stopListening(this, \"view:removed\", this.removeSelectionListeners);\n\t// \tthis.stopListening(this.model, \"selected\", this._onModelSelected);\n\t// \tthis.stopListening(this.model, \"deselected\", this._onModelDeselected);\n\t// \tif (this.model.selected) {\n\t// \t\tthis._onModelDeselected();\n\t// \t}\n\t// },\n\n\t/* model selected handlers:\n\t/* model selection toggles playback\n\t/* --------------------------- */\n\n\t_onModelSelected: function() {\n\t\tconsole.log(\"%s::_onModelSelected _playbackRequested: %s, event: %s\", this.cid, this._playbackRequested, this._toggleEvent);\n\t\t// logAttachInfo(this, \"_onModelSelected\", \"log\");\n\t\t// this._addParentListeners();\n\t\tthis.listenTo(this, \"view:parentChange\", this._onParentChange);\n\t\tif (this.parentView) this._onParentChange(this, this.parentView, null);\n\n\t\tthis._addDOMListeners();\n\t\tthis._validatePlayback();\n\t},\n\n\t_onModelDeselected: function() {\n\t\t// logAttachInfo(this, \"_onModelDeselected\", \"log\");\n\t\t// this._removeParentListeners();\n\t\tthis.stopListening(this, \"view:parentChange\", this._onParentChange);\n\t\tif (this.parentView) this._onParentChange(this, null, this.parentView);\n\n\t\tthis._removeDOMListeners();\n\t\tthis.togglePlayback(false);\n\t\t// this._validatePlayback(this.model.selected);\n\t\t// this._validatePlayback();\n\t},\n\n\t/* view:parentChange handlers 3\n\t/* --------------------------- */\n\n\t_onParentChange: function(childView, newParent, oldParent) {\n\t\t// console.log(\"[scroll] %s::_onParentChange '%s' to '%s'\", this.cid, oldParent && oldParent.cid, newParent && newParent.cid);\n\t\tif (oldParent) this.stopListening(oldParent, \"view:scrollstart view:scrollend\", this._onScrollChange);\n\t\tif (newParent) this.listenTo(newParent, \"view:scrollstart view:scrollend\", this._onScrollChange);\n\t},\n\n\t_onScrollChange: function() {\n\t\tif (this.parentView === null) {\n\t\t\tthis.togglePlayback(false);\n\t\t\tthrow new Error(this.cid + \"::_onScrollChange parentView is null\");\n\t\t}\n\t\t// console.log(\"[scroll] %s::_onScrollChange %s.scrolling: %s\", this.cid, this.parentView.cid, this.parentView.scrolling);\n\n\t\t// this._validatePlayback(!this.parentView.scrolling);\n\t\t// if (!this.parentView.scrolling) {\n\t\tthis._validatePlayback();\n\t\t// } else {\n\t\t// \tthis.togglePlayback(false);\n\t\t// }\n\t},\n\n\t/* view:parentChange handlers\n\t/* --------------------------- */\n\n\t/*_addParentListeners: function() {\n\t\tif (!this.parentView) {\n\t\t\tlogAttachInfo(this, \"_addParentListeners\", \"error\");\n\t\t\treturn;\n\t\t}\n\t\tthis.listenTo(this, \"view:remove\", this._removeParentListeners);\n\t\tthis.listenTo(this.parentView, \"view:remove\", this._removeParentListeners);\n\t\tthis.listenTo(this.parentView, \"view:scrollstart\", this._onScrollStart);\n\t\tthis.listenTo(this.parentView, \"view:scrollend\", this._onScrollEnd);\n\t},\n\n\t_removeParentListeners: function(view) {\n\t\tif (!this.parentView) {\n\t\t\tlogAttachInfo(this, \"_removeParentListeners\", \"error\");\n\t\t\treturn;\n\t\t}\n\t\tif (view !== void 0) {\n\t\t\tlogAttachInfo(this, \"_removeParentListeners [event source view]\", \"info\");\n\t\t\t// console.info(\"%s[playable]::_removeParentListeners event source view: %s\", this.cid, view && view.cid);\n\t\t}\n\n\t\tthis.stopListening(this, \"view:remove\", this._removeParentListeners);\n\t\tthis.stopListening(this.parentView, \"view:remove\", this._removeParentListeners);\n\t\tthis.stopListening(this.parentView, \"view:scrollstart\", this._onScrollStart);\n\t\tthis.stopListening(this.parentView, \"view:scrollend\", this._onScrollEnd);\n\t},*/\n\n\t/* view:scrollstart view:scrollend\n\t/* --------------------------- */\n\n\t/*_onScrollStart: function() {\n\t\tthis.togglePlayback(false);\n\t},\n\n\t_onScrollEnd: function() {\n\t\tthis._validatePlayback();\n\t},*/\n\n\t/* listen to DOM events\n\t/* --------------------------- */\n\n\t_addDOMListeners: function() {\n\t\tthis.listenTo(this, \"view:removed\", this._removeDOMListeners);\n\t\tdocument.addEventListener(visibilityChangeEvent, this._onVisibilityChange, false);\n\t\tthis.playToggle.addEventListener(this._toggleEvent, this._onPlaybackToggle, true);\n\t},\n\n\t_removeDOMListeners: function() {\n\t\tthis.stopListening(this, \"view:removed\", this._removeDOMListeners);\n\t\tdocument.removeEventListener(visibilityChangeEvent, this._onVisibilityChange, false);\n\t\tthis.playToggle.removeEventListener(this._toggleEvent, this._onPlaybackToggle, true);\n\t},\n\n\t/* visibility dom event\n\t/* --------------------------- */\n\t_onVisibilityChange: function(ev) {\n\t\t// this._validatePlayback(!document[visibilityHiddenProp]);\n\t\t// this._validatePlayback(document[visibilityStateProp] != \"hidden\");\n\t\t// if (document[visibilityStateProp] != \"hidden\") {\n\t\tthis._validatePlayback();\n\t\t// } else {\n\t\t// \tthis.togglePlayback(false);\n\t\t// }\n\t},\n\n\t/* --------------------------- *\n\t/* play-toggle\n\t/* --------------------------- */\n\n\t/** @type {String} */\n\t_toggleEvent: window.hasOwnProperty(\"onpointerup\") ? \"pointerup\" : \"mouseup\",\n\n\t_onPlaybackToggle: function(ev) {\n\t\tconsole.log(\"%s[%sabled]::_onPlaybackToggle[%s] defaultPrevented: %s\", this.cid, this.enabled ? \"en\" : \"dis\", ev.type, ev.defaultPrevented);\n\t\t// NOTE: Perform action if MouseEvent.button is 0 or undefined (0: left-button)\n\t\tif (!ev.defaultPrevented && !ev.button) {\n\t\t\tev.preventDefault();\n\t\t\tthis.playbackRequested = !this.playbackRequested;\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* playbackRequested\n\t/* --------------------------- */\n\n\t/** @type {Boolean?} */\n\t_playbackRequested: null,\n\n\t_setPlaybackRequested: function(value) {\n\t\tthis._playbackRequested = value;\n\n\t\tvar classList = this.content.classList;\n\t\tclassList.toggle(\"playing\", value === true);\n\t\tclassList.toggle(\"paused\", value === false);\n\t\tclassList.toggle(\"requested\", value === true || value === false);\n\n\t\t// this._validatePlayback(this.playbackRequested);\n\t\t// if (this.playbackRequested) {\n\t\tthis._validatePlayback();\n\t\t// } else {\n\t\t// \tthis.togglePlayback(false);\n\t\t// }\n\t},\n\n\t/* --------------------------- *\n\t/* togglePlayback\n\t/* --------------------------- */\n\n\t/** @override */\n\ttogglePlayback: function(newPlayState) {\n\t\t// console.log(\"[scroll] %s::togglePlayback [%s -> %s] (requested: %s)\", this.cid,\n\t\t// \t\t(this._isMediaPaused()? \"pause\" : \"play\"),\n\t\t// \t\t(newPlayState? \"play\" : \"pause\"),\n\t\t// \t\tthis.playbackRequested\n\t\t// \t);\n\t\tif (_.isBoolean(newPlayState) && newPlayState !== this._isMediaPaused()) {\n\t\t\treturn; // requested state is current, do nothing\n\t\t} else {\n\t\t\tnewPlayState = this._isMediaPaused();\n\t\t}\n\t\tif (newPlayState) { // changing to what?\n\t\t\tthis._playMedia();\n\t\t} else {\n\t\t\tthis._pauseMedia();\n\t\t}\n\t},\n\n\t_canResumePlayback: function() {\n\t\treturn !!(\n\t\t\tthis.enabled &&\n\t\t\tthis.model.selected &&\n\t\t\tthis.playbackRequested &&\n\t\t\t(this.mediaState === \"ready\") &&\n\t\t\tthis.attached &&\n\t\t\t(this.parentView !== null) &&\n\t\t\t(!this.parentView.scrolling) &&\n\t\t\t(document[visibilityStateProp] != \"hidden\")\n\t\t);\n\t},\n\n\t_validatePlayback: function(shortcircuit) {\n\t\t// a 'shortcircuit' boolean argument can be passed, and if false,\n\t\t// skip _canResumePlayback and pause playback right away\n\t\tif (arguments.length != 0 && !shortcircuit) {\n\t\t\tthis.togglePlayback(false);\n\t\t} else {\n\t\t\tthis.togglePlayback(this._canResumePlayback());\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* abstract\n\t/* --------------------------- */\n\n\t_isMediaPaused: function() {\n\t\tconsole.warn(\"%s::_isMediaPaused Not implemented\", this.cid);\n\t\treturn true;\n\t},\n\n\t_playMedia: function() {\n\t\tconsole.warn(\"%s::_playMedia Not implemented\", this.cid);\n\t},\n\n\t_pauseMedia: function() {\n\t\tconsole.warn(\"%s::_pauseMedia Not implemented\", this.cid);\n\t},\n\n\t/* --------------------------- *\n\t/* util\n\t/* --------------------------- */\n\n\tupdateOverlay: function(mediaEl, targetEl, rectEl) {\n\t\t// // this method is not critical, just catch and log all errors\n\t\t// try {\n\t\t// \tthis._updateOverlay(mediaEl, targetEl, rectEl)\n\t\t// } catch (err) {\n\t\t// \tconsole.error(\"%s::updateOverlay\", this.cid, err);\n\t\t// }\n\t},\n\n\t_drawMediaElement: function(context, mediaEl, dest) {\n\t\t// destination rect\n\t\t// NOTE: mediaEl is expected to have the same dimensions in this.metrics.media\n\t\tmediaEl || (mediaEl = this.defaultImage);\n\t\tdest || (dest = {\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t\twidth: this.metrics.media.width,\n\t\t\theight: this.metrics.media.height\n\t\t});\n\n\t\t// native/display scale\n\t\tvar sW = this.model.get(\"source\").get(\"w\"),\n\t\t\tsH = this.model.get(\"source\").get(\"h\"),\n\t\t\trsX = sW / this.metrics.media.width,\n\t\t\trsY = sH / this.metrics.media.height;\n\n\t\t// dest, scaled to native\n\t\tvar src = {\n\t\t\tx: Math.max(0, dest.x * rsX),\n\t\t\ty: Math.max(0, dest.y * rsY),\n\t\t\twidth: Math.min(sW, dest.width * rsX),\n\t\t\theight: Math.min(sH, dest.height * rsY)\n\t\t};\n\n\t\t// resize canvas\n\t\t// var canvas = context.canvas;\n\t\t// if (canvas.width !== dest.width || canvas.height !== dest.height) {\n\t\t// \tcanvas.width = dest.width;\n\t\t// \tcanvas.height = dest.height;\n\t\t// }\n\t\tcontext.canvas.width = dest.width;\n\t\tcontext.canvas.height = dest.height;\n\n\t\t// copy image to canvas\n\t\tcontext.clearRect(0, 0, dest.width, dest.height);\n\t\tcontext.drawImage(mediaEl,\n\t\t\tsrc.x, src.y, src.width, src.height,\n\t\t\t0, 0, dest.width, dest.height // destination rect\n\t\t);\n\n\t\treturn context;\n\t},\n\n\t/*\n\t_updateOverlay: function(mediaEl, targetEl, rectEl) {\n\t\t// src/dest rects\n\t\t// ------------------------------\n\t\trectEl || (rectEl = targetEl);\n\n\t\t// NOTE: does not work with svg element\n\t\t// var tRect = rectEl.getBoundingClientRect();\n\t\t// var cRect = mediaEl.getBoundingClientRect();\n\t\t// var tX = tRect.x - cRect.x,\n\t\t// \ttY = tRect.y - cRect.y,\n\t\t// \ttW = tRect.width,\n\t\t// \ttH = tRect.height;\n\n\t\t// target bounds\n\t\tvar tX = rectEl.offsetLeft,\n\t\t\ttY = rectEl.offsetTop,\n\t\t\ttW = rectEl.offsetWidth,\n\t\t\ttH = rectEl.offsetHeight;\n\n\t\tif (tX === void 0 || tY === void 0 || tW === void 0 || tH === void 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// destination rect\n\t\tvar RECT_GROW = 20;\n\t\tvar dest = {\n\t\t\tx: tX - RECT_GROW,\n\t\t\ty: tY - RECT_GROW,\n\t\t\twidth: tW + RECT_GROW * 2,\n\t\t\theight: tH + RECT_GROW * 2\n\t\t};\n\n\t\t// native/display scale\n\t\tvar sW = this.model.get(\"w\"),\n\t\t\tsH = this.model.get(\"h\"),\n\t\t\trsX = sW/this.metrics.media.width,\n\t\t\trsY = sH/this.metrics.media.height;\n\n\t\t// dest, scaled to native\n\t\tvar src = {\n\t\t\tx: Math.max(0, dest.x * rsX),\n\t\t\ty: Math.max(0, dest.y * rsY),\n\t\t\twidth: Math.min(sW, dest.width * rsX),\n\t\t\theight: Math.min(sH, dest.height * rsY)\n\t\t};\n\n\t\t// Copy image to canvas\n\t\t// ------------------------------\n\t\tvar canvas, context, imageData;\n\n\t\t// canvas = document.createElement(\"canvas\");\n\t\t// canvas.style.width  = dest.width + \"px\";\n\t\t// canvas.style.height = dest.height + \"px\";\n\n\t\tcanvas = getSharedCanvas();\n\t\tif (canvas.width !== dest.width || canvas.height !== dest.height) {\n\t\t\tcanvas.width = dest.width;\n\t\t\tcanvas.height = dest.height;\n\t\t}\n\t\tcontext = canvas.getContext(\"2d\");\n\t\tcontext.clearRect(0, 0, dest.width, dest.height);\n\t\tcontext.drawImage(mediaEl,\n\t\t\tsrc.x, src.y, src.width, src.height,\n\t\t\t0, 0, dest.width, dest.height // destination rect\n\t\t);\n\t\timageData = context.getImageData(0, 0, dest.width, dest.height);\n\n\t\tvar avgColor = Color().rgb(getAverageRGB(imageData));\n\t\t// var avgHex = avgColor.hexString(), els = this.el.querySelectorAll(\"img, video\");\n\t\t// for (var i = 0; i < els.length; i++) {\n\t\t// \tels.item(i).style.backgroundColor = avgHex;\n\t\t// }\n\n\t\ttargetEl.classList.toggle(\"over-dark\", avgColor.dark());\n\n\t\t// console.log(\"%s::updateOverlay() avgColor:%s (%s)\", this.cid, avgColor.rgbString(), avgColor.dark()?\"dark\":\"light\", targetEl);\n\n\t\t// Color, filter opts\n\t\t// ------------------------------\n\n\t\t// this.fgColor || (this.fgColor = new Color(this.model.attr(\"color\")));\n\t\t// this.bgColor || (this.bgColor = new Color(this.model.attr(\"background-color\")));\n\t\t//\n\t\t// var opts = { radius: 20 };\n\t\t// var isFgDark = this.fgColor.luminosity() < this.bgColor.luminosity();\n\t\t// opts.x00 = isFgDark? this.fgColor.clone().lighten(0.5) : this.bgColor.clone().darken(0.5);\n\t\t// opts.xFF = isFgDark? this.bgColor.clone().lighten(0.5) : this.fgColor.clone().darken(0.5);\n\t\t//\n\t\t// stackBlurMono(imageData, opts);\n\t\t// duotone(imageData, opts);\n\t\t// stackBlurRGB(imageData, { radius: 20 });\n\t\t//\n\t\t// context.putImageData(imageData, 0, 0);\n\t\t// targetEl.style.backgroundImage = \"url(\" + canvas.toDataURL() + \")\";\n\t}*/\n});\n\n/* ---------------------------\n/* Google Analytics\n/* --------------------------- */\nif (GA) {\n\tPlayableRenderer = (function(PlayableRenderer) {\n\n\t\t/** @type {module:underscore.strings/dasherize} */\n\t\tvar dasherize = require(\"underscore.string/dasherize\");\n\n\t\t// var readyEvents = [\"playing\", \"waiting\", \"ended\"];\n\t\t// var userEvents = [\"play\", \"pause\"];\n\n\n\t\treturn PlayableRenderer.extend({\n\n\t\t\t/** @override */\n\t\t\tinitialize: function() {\n\t\t\t\tvar retval = PlayableRenderer.prototype.initialize.apply(this, arguments);\n\t\t\t\tthis._playbackRequestedDefault = this.playbackRequested;\n\t\t\t\treturn retval;\n\t\t\t},\n\n\t\t\t_onPlaybackToggle: function(ev) {\n\t\t\t\tvar retval = PlayableRenderer.prototype._onPlaybackToggle.apply(this, arguments);\n\t\t\t\tvar o = {\n\t\t\t\t\thitType: \"event\",\n\t\t\t\t\teventCategory: dasherize(this.cidPrefix),\n\t\t\t\t\teventAction: this.playbackRequested ? \"play\" : \"pause\",\n\t\t\t\t\teventLabel: this.model.get(\"text\"),\n\t\t\t\t};\n\t\t\t\tif (this._playbackRequestedDefault)\n\t\t\t\t\to.eventAction += \"-autoplay\";\n\t\t\t\twindow.ga(\"send\", o);\n\t\t\t\treturn retval;\n\t\t\t},\n\n\t\t\t// /** @override */\n\t\t\t// togglePlayback: function(newPlayState) {\n\t\t\t// \tvar retval = PlayableRenderer.prototype.togglePlayback.apply(this, arguments);\n\t\t\t// \twindow.ga(\"send\", {\n\t\t\t// \t\thitType: \"event\",\n\t\t\t// \t\teventCategory: \"Playable\",\n\t\t\t// \t\teventAction: this.playbackRequested ? \"play\" : \"pause\",\n\t\t\t// \t\teventLabel: this.model.get(\"text\"),\n\t\t\t// \t});\n\t\t\t// \treturn retval;\n\t\t\t// },\n\t\t});\n\t})(PlayableRenderer);\n}\n\n// if (DEBUG) {\n//\n// PlayableRenderer = (function(PlayableRenderer) {\n// \tif (!PlayableRenderer.LOG_TO_SCREEN) return PlayableRenderer;\n//\n// \t/** @type {module:underscore.strings/lpad} */\n// \tvar lpad = require(\"underscore.string/lpad\");\n//\n// \treturn PlayableRenderer.extend({\n// \t\t_canResumePlayback: function() {\n// \t\t\tvar retval = PlayableRenderer.prototype._canResumePlayback.apply(this.arguments);\n// \t\t\tconsole.log(\"[scroll] %s::_canResumePlayback():%s\", this.cid, retval,\n// \t\t\t{\n// \t\t\t\t\"enabled\": this.enabled,\n// \t\t\t\t\"selected\": (!!this.model.selected),\n// \t\t\t\t\"playbackRequested\": this.playbackRequested,\n// \t\t\t\t\"attached\": this.attached,\n// \t\t\t\t\"parentView\": (this.parentView && this.parentView.cid),\n// \t\t\t\t\"!scrolling\": (this.parentView && !this.parentView.scrolling),\n// \t\t\t\t\"mediaState\": this.mediaState,\n// \t\t\t\t// \"!document.hidden\": !document[visibilityHiddenProp],\n// \t\t\t\t\"visibilityState\": document[visibilityStateProp]\n// \t\t\t});\n// \t\t\treturn retval;\n// \t\t},\n// \t});\n// })(PlayableRenderer);\n//\n// }\n\nmodule.exports = PlayableRenderer;",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=\"function\", alias4=container.escapeExpression;\n\n  return \"<div class=\\\"placeholder sizing\\\"></div>\\n<div class=\\\"content\\\">\\n\t<div class=\\\"media-border content-size\\\"></div>\\n\t<div class=\\\"controls content-size\\\">\\n\t\t<div class=\\\"top-bar control-box\\\">\\n\t\t</div>\\n\t</div>\\n\t<div class=\\\"sequence media-size\\\">\\n\t\t<img class=\\\"sequence-step current default\\\" alt=\\\"\"\n    + alias4(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"text\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" longdesc=\\\"#desc_m\"\n    + alias4(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"id\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" />\\n\t</div>\\n\t<div class=\\\"overlay media-size\\\">\\n\t\t<div class=\\\"play-toggle-hitarea play-toggle\\\">\\n\t\t</div>\\n\t</div>\\n</div>\\n\";\n},\"useData\":true});\n",
    "/**\n * @module app/view/render/SequenceRenderer\n */\n\n/* --------------------------- *\n/* Imports\n/* --------------------------- */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:backbone.babysitter} */\nvar Container = require(\"backbone.babysitter\");\n\n/** @type {module:app/view/base/View} */\nvar View = require(\"app/view/base/View\");\n/** @type {module:app/view/render/PlayableRenderer} */\nvar PlayableRenderer = require(\"app/view/render/PlayableRenderer\");\n// /** @type {module:app/model/SelectableCollection} */\n// var SelectableCollection = require(\"app/model/SelectableCollection\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n\n/** @type {module:app/view/component/ProgressMeter} */\nvar ProgressMeter = require(\"app/view/component/ProgressMeter\");\n\n/** @type {module:utils/Timer} */\nvar Timer = require(\"utils/Timer\");\n// /** @type {Function} */\n// var transitionEnd = require(\"utils/event/transitionEnd\");\n// /** @type {module:utils/prefixedProperty} */\n// var prefixed = require(\"utils/prefixedProperty\");\n\n/** @type {Function} */\nvar _whenImageLoads = require(\"app/view/promise/_whenImageLoads\");\n/** @type {module:app/view/promise/_loadImageAsObjectURL} */\nvar _loadImageAsObjectURL = require(\"app/view/promise/_loadImageAsObjectURL\");\n/** @type {Function} */\nvar whenSelectionDistanceIs = require(\"app/view/promise/whenSelectionDistanceIs\");\n// var whenSelectTransitionEnds = require(\"app/view/promise/whenSelectTransitionEnds\");\n// var whenDefaultImageLoads = require(\"app/view/promise/whenDefaultImageLoads\");\n\n// /** @type {Function} */\n// var Color = require(\"color\");\n// var duotone = require(\"utils/canvas/bitmap/duotone\");\n// var stackBlurRGB = require(\"utils/canvas/bitmap/stackBlurRGB\");\n// var stackBlurMono = require(\"utils/canvas/bitmap/stackBlurMono\");\n// var getAverageRGBA = require(\"utils/canvas/bitmap/getAverageRGBA\");\n\nvar errorTemplate = require(\"../template/ErrorBlock.hbs\");\n\nvar MIN_STEP_INTERVAL = 2 * Globals.TRANSITION_DURATION + Globals.TRANSITION_DELAY_INTERVAL;\nvar DEFAULT_STEP_INTERVAL = 6 * Globals.TRANSITION_DURATION + Globals.TRANSITION_DELAY_INTERVAL;\n\n\n/* --------------------------- *\n/* Private classes\n/* --------------------------- */\n\n// /**\n// * @constructor\n// * @type {module:app/view/render/SequenceRenderer.SourceCollection}\n// */\n// var SourceCollection = SelectableCollection.extend({\n// \tmodel: Backbone.Model\n// });\n\n/**\n * @constructor\n * @type {module:app/view/render/SequenceRenderer.PrefetechedSourceRenderer}\n */\nvar PrefetechedSourceRenderer = View.extend({\n\n\tcidPrefix: \"sequenceStepRenderer\",\n\t/** @type {string} */\n\tclassName: \"sequence-step\",\n\t/** @type {string} */\n\ttagName: \"img\",\n\n\tproperties: {\n\t\tready: {\n\t\t\tget: function() {\n\t\t\t\treturn this._ready;\n\t\t\t}\n\t\t}\n\t},\n\n\t/** @override */\n\tinitialize: function(options) {\n\t\t!this.el.hasAttribute(\"alt\") && this.el.setAttribute(\"alt\", this.model.get(\"src\"));\n\t\t// this.el.setAttribute(\"longdesc\", this.model.get(\"original\"));\n\n\t\tif (this.model.has(\"prefetched\")) {\n\t\t\tthis._renderPrefetched();\n\t\t} else {\n\t\t\tthis.listenTo(this.model, \"change:prefetched\", this._renderPrefetched);\n\t\t}\n\t\tthis.listenTo(this.model, \"selected deselected\", this._renderSelection);\n\t\tthis._renderSelection();\n\t},\n\n\t_renderSelection: function() {\n\t\tthis.el.classList.toggle(\"current\", !!this.model.selected);\n\t},\n\n\t_renderPrefetched: function() {\n\t\tvar prefetched = this.model.get(\"prefetched\");\n\t\tif (prefetched !== this.el.src) {\n\t\t\tthis.el.src = prefetched;\n\t\t}\n\t\t_whenImageLoads(this.el).then(\n\t\t\tfunction(el) {\n\t\t\t\tthis.requestAnimationFrame(function(tstamp) {\n\t\t\t\t\tthis._setReady(true);\n\t\t\t\t});\n\t\t\t}.bind(this),\n\t\t\tfunction(err) {\n\t\t\t\t// this._setReady(false);\n\t\t\t\t(err instanceof Error) || (err = new Error(\"cannot load prefetched url\"));\n\t\t\t\tthrow err;\n\t\t\t}.bind(this)\n\t\t);\n\t},\n\n\t/** @type {boolean} */\n\t_ready: false,\n\n\t_setReady: function(ready) {\n\t\tif (this._ready === ready) return;\n\t\tthis._ready = !!(ready); // make bool\n\t\tthis.trigger(\"renderer:ready\", this);\n\t},\n\n\trender: function() {\n\t\t// if (this.model.has(\"prefetched\")) {\n\t\t// \tthis._renderPrefetched();\n\t\t// }\n\t\t// this.el.classList.toggle(\"current\", !!this.model.selected);\n\t\tconsole.log(\"%s::render\", this.cid);\n\t\treturn this;\n\t},\n});\n\n/**\n * @constructor\n * @type {module:app/view/render/SequenceRenderer.SimpleSourceRenderer}\n */\n// var SimpleSourceRenderer = View.extend({\n//\n// \tcidPrefix: \"sequenceStepRenderer\",\n// \t/** @type {string} */\n// \tclassName: \"sequence-step\",\n// \t/** @type {string} */\n// \ttagName: \"img\",\n//\n// \t/** @override */\n// \tinitialize: function (options) {\n// \t\t// this.el.classList.toggle(\"current\", this.model.hasOwnProperty(\"selected\"));\n// \t\tthis.el.classList.toggle(\"current\", !!this.model.selected);\n// \t\tthis.listenTo(this.model, {\n// \t\t\t\"selected\": function () {\n// \t\t\t\tthis.el.classList.add(\"current\");\n// \t\t\t},\n// \t\t\t\"deselected\": function () {\n// \t\t\t\tthis.el.classList.remove(\"current\");\n// \t\t\t}\n// \t\t});\n// \t\tif (this.el.src === \"\") {\n// \t\t\tthis.el.src = Globals.MEDIA_DIR + \"/\" + this.model.get(\"src\");\n// \t\t}\n//\n// \t\tif (this.model.has(\"error\")) {\n// \t\t\tthis._onModelError();\n// \t\t} else {\n// \t\t\tthis.listenToOnce(this.model, \"change:error\", this._onModelError);\n// \t\t\t// this.listenToOnce(this.model, {\n// \t\t\t// \t\"change:source\": this._onModelSource,\n// \t\t\t// \t\"change:error\": this._onModelError,\n// \t\t\t// });\n// \t\t}\n// \t},\n//\n// \t// _onModelSource: function() {\n// \t// \tthis.el.src = Globals.MEDIA_DIR + \"/\" + this.model.get(\"src\");\n// \t// \t// console.log(\"%s::change:src\", this.cid, this.model.get(\"src\"));\n// \t// },\n//\n// \t_onModelError: function() {\n// \t\tvar err = this.model.get(\"error\");\n// \t\tvar errEl = document.createElement(\"div\");\n// \t\terrEl.className = \"error color-bg\" + (this.model.selected? \" current\" : \"\");\n// \t\terrEl.innerHTML = errorTemplate(err);\n// \t\tthis.setElement(errEl, true);\n// \t\tconsole.log(\"%s::change:error\", this.cid, err.message, err.infoSrc);\n// \t},\n// });\n\nvar SourceErrorRenderer = View.extend({\n\n\t/** @type {string} */\n\tclassName: \"sequence-step error\",\n\t/** @override */\n\tcidPrefix: \"sourceErrorRenderer\",\n\t/** @override */\n\ttemplate: errorTemplate,\n\t/** @type {boolean} */\n\tready: true,\n\n\tinitialize: function(options) {\n\t\t// var handleSelectionChange = function onSelectionChange () {\n\t\t// \tthis.el.classList.toggle(\"current\", !!this.model.selected);\n\t\t// };\n\t\t// this.listenTo(this.model, \"selected deselected\", handleSelectionChange);\n\t\t// // this.el.classList.toggle(\"current\", !!this.model.selected);\n\t\t// handleSelectionChange.call(this);\n\t\tthis.listenTo(this.model, \"selected deselected\", function() {\n\t\t\tthis.el.classList.toggle(\"current\", !!this.model.selected);\n\t\t});\n\t},\n\n\trender: function() {\n\t\tthis.el.classList.toggle(\"current\", !!this.model.selected);\n\t\tthis.el.innerHTML = this.template(this.model.get(\"error\"));\n\t\treturn this;\n\t},\n});\n\nvar SequenceStepRenderer = PrefetechedSourceRenderer;\n// var SequenceStepRenderer = SimpleSourceRenderer;\n\n/**\n * @constructor\n * @type {module:app/view/render/SequenceRenderer}\n */\nvar SequenceRenderer = PlayableRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"sequenceRenderer\",\n\t/** @type {string} */\n\tclassName: PlayableRenderer.prototype.className + \" sequence-renderer\",\n\t/** @type {Function} */\n\ttemplate: require(\"./SequenceRenderer.hbs\"),\n\n\t/* --------------------------- *\n\t/* initialize\n\t/* --------------------------- */\n\n\tinitialize: function() {\n\t\tthis.sources = this.model.get(\"sources\");\n\t\tPlayableRenderer.prototype.initialize.apply(this, arguments);\n\t},\n\n\tinitializeAsync: function() {\n\t\treturn PlayableRenderer.prototype.initializeAsync.apply(this, arguments)\n\t\t\t.then(\n\t\t\t\tfunction(view) {\n\t\t\t\t\treturn view.whenAttached();\n\t\t\t\t})\n\t\t\t.then(function(view) {\n\t\t\t\tview.initializePlayable();\n\t\t\t\tview.updateOverlay(view.defaultImage, view.overlay);\n\t\t\t\tview.addSelectionListeners();\n\t\t\t\treturn view;\n\t\t\t});\n\t},\n\n\twhenInitialized: function(view) {\n\t\tvar retval = PlayableRenderer.prototype.whenInitialized.apply(this, arguments);\n\t\tview._validatePlayback();\n\t\treturn retval;\n\t},\n\n\t/* --------------------------- *\n\t/* children\n\t/* --------------------------- */\n\n\t/** @override */\n\tcreateChildren: function() {\n\t\tPlayableRenderer.prototype.createChildren.apply(this, arguments);\n\n\t\tthis.placeholder = this.el.querySelector(\".placeholder\");\n\t\tthis.sequence = this.content.querySelector(\".sequence\");\n\n\t\tthis.content.classList.add(\"started\");\n\n\t\t// styles\n\t\t// ---------------------------------\n\t\tvar s, attrs = this.model.attrs();\n\t\t// var s, attrs = this.model.get(\"attrs\");\n\t\ts = _.pick(attrs, \"box-shadow\", \"border\", \"border-radius\");\n\t\t_.extend(this.content.querySelector(\".media-border\").style, s);\n\t\ts = _.pick(attrs, \"border-radius\");\n\t\t_.extend(this.sequence.style, s);\n\t\t_.extend(this.placeholder.style, s);\n\n\t\t// model\n\t\t// ---------------------------------\n\t\tthis.sources.select(this.model.get(\"source\"));\n\n\t\t// itemViews\n\t\t// ---------------------------------\n\t\tthis.itemViews = new Container();\n\t\t// add default image as renderer (already in DOM)\n\t\tthis.itemViews.add(new SequenceStepRenderer({\n\t\t\tel: this.getDefaultImage(),\n\t\t\tmodel: this.sources.selected\n\t\t}));\n\t},\n\n\t/* --------------------------- *\n\t/* layout\n\t/* --------------------------- */\n\n\t/** @override */\n\trender: function() {\n\t\tPlayableRenderer.prototype.render.apply(this, arguments);\n\n\t\tvar els, el, i, cssW, cssH;\n\t\tvar content = this.content;\n\n\t\t// media-size\n\t\t// ---------------------------------\n\t\tcssW = this.metrics.media.width + \"px\";\n\t\tcssH = this.metrics.media.height + \"px\";\n\n\t\tels = this.el.querySelectorAll(\".media-size\");\n\t\tfor (i = 0; i < els.length; i++) {\n\t\t\tel = els.item(i);\n\t\t\tel.style.width = cssW;\n\t\t\tel.style.height = cssH;\n\t\t}\n\t\tcontent.style.width = cssW;\n\t\tcontent.style.height = cssH;\n\n\t\t// content-position\n\t\t// ---------------------------------\n\t\tvar cssX, cssY;\n\t\tcssX = this.metrics.content.x + \"px\";\n\t\tcssY = this.metrics.content.y + \"px\";\n\t\tcontent.style.left = cssX;\n\t\tcontent.style.top = cssY;\n\n\t\tel = this.el.querySelector(\".controls\");\n\t\t// el.style.left = cssX;\n\t\t// el.style.top = cssY;\n\t\tel.style.width = this.metrics.content.width + \"px\";\n\t\tel.style.height = this.metrics.content.height + \"px\";\n\n\t\t// // content-size\n\t\t// // ---------------------------------\n\t\t// cssW = this.metrics.content.width + \"px\";\n\t\t// cssH = this.metrics.content.height + \"px\";\n\t\t//\n\t\t// els = this.el.querySelectorAll(\".content-size\");\n\t\t// for (i = 0; i < els.length; i++) {\n\t\t// \tel = els.item(i);\n\t\t// \tel.style.width = cssW;\n\t\t// \tel.style.height = cssH;\n\t\t// }\n\n\t\treturn this;\n\t},\n\n\tinitializePlayable: function() {\n\t\t// Sequence model\n\t\t// ---------------------------------\n\t\t// this.sources = this._createSourceCollection(this.model);\n\t\twhenSelectionDistanceIs(this, 0).then(this._preloadAllItems, function(err) {\n\t\t\tif (err instanceof View.ViewError) { // Ignore ViewError\n\t\t\t\t// console.warn(err.name, err.message);//, err.view.cid);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn err;\n\t\t});\n\n\t\t// timer\n\t\t// ---------------------------------\n\t\tthis._sequenceInterval = Math.max(parseInt(this.model.attr(\"@sequence-interval\")), MIN_STEP_INTERVAL) || DEFAULT_STEP_INTERVAL;\n\n\t\tthis.timer = new Timer();\n\t\tthis.listenTo(this, \"view:removed\", function() {\n\t\t\tthis.timer.stop();\n\t\t\tthis.stopListening(this.timer);\n\t\t});\n\t\tthis.listenTo(this.timer, {\n\t\t\t\"start\": this._onTimerStart,\n\t\t\t\"resume\": this._onTimerResume,\n\t\t\t\"pause\": this._onTimerPause,\n\t\t\t\"end\": this._onTimerEnd,\n\t\t\t// \"stop\": function () { // stop is only called on view remove},\n\t\t});\n\n\t\t// progress-meter model\n\t\t// ---------------------------------\n\t\tthis._sourceProgressByIdx = this.sources.map(function() {\n\t\t\treturn 0;\n\t\t});\n\t\tthis._sourceProgressByIdx[0] = 1; // first item is already loaded\n\n\t\t// progress-meter\n\t\t// ---------------------------------\n\n\t\tthis.progressMeter = new ProgressMeter({\n\t\t\tvalues: {\n\t\t\t\tavailable: this._sourceProgressByIdx.concat(),\n\t\t\t},\n\t\t\tmaxValues: {\n\t\t\t\tamount: this.sources.length,\n\t\t\t\tavailable: this.sources.length,\n\t\t\t},\n\t\t\tcolor: this.model.attr(\"color\"),\n\t\t\tbackgroundColor: this.model.attr(\"background-color\"),\n\t\t\tlabelFn: this._progressLabelFn.bind(this)\n\t\t});\n\n\t\tthis.el.querySelector(\".top-bar\").appendChild(this.progressMeter.render().el);\n\t},\n\n\t_progressLabelFn: function() {\n\t\tif (this.playbackRequested === false) return Globals.PAUSE_CHAR;\n\t\treturn (this.sources.selectedIndex + 1) + \"/\" + this.sources.length;\n\t},\n\n\t_preloadAllItems: function(view) {\n\t\tview.once(\"view:remove\", function() {\n\t\t\tvar silent = {\n\t\t\t\tsilent: true\n\t\t\t};\n\t\t\tview.sources.forEach(function(item, index, sources) {\n\t\t\t\tvar prefetched = item.get(\"prefetched\");\n\t\t\t\tif (prefetched && /^blob\\:/.test(prefetched)) {\n\t\t\t\t\titem.unset(\"prefetched\", silent);\n\t\t\t\t\titem.set(\"progress\", 0, silent);\n\t\t\t\t\tURL.revokeObjectURL(prefetched);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\treturn view.sources.reduce(function(lastPromise, item, index, sources) {\n\t\t\treturn lastPromise.then(function(view) {\n\t\t\t\tif (item.has(\"prefetched\")) {\n\t\t\t\t\tview._updateItemProgress(1, index);\n\t\t\t\t\treturn view;\n\t\t\t\t} else {\n\t\t\t\t\treturn _loadImageAsObjectURL(item.get(\"original\"),\n\t\t\t\t\t\t\tfunction(progress) {\n\t\t\t\t\t\t\t\tview._updateItemProgress(progress, index);\n\t\t\t\t\t\t\t\titem.set(\"progress\", progress);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\tfunction(pUrl) {\n\t\t\t\t\t\t\t\tview._updateItemProgress(1, index);\n\t\t\t\t\t\t\t\titem.set({\n\t\t\t\t\t\t\t\t\tprefetched: pUrl,\n\t\t\t\t\t\t\t\t\tprogress: 1\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t// item.set(\"prefetched\", pUrl);\n\t\t\t\t\t\t\t\treturn view;\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tfunction(err) {\n\t\t\t\t\t\t\t\tview._updateItemProgress(0, index);\n\t\t\t\t\t\t\t\titem.set({\n\t\t\t\t\t\t\t\t\terror: err,\n\t\t\t\t\t\t\t\t\tprogress: 0\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t// item.set(\"error\", err);\n\t\t\t\t\t\t\t\treturn view;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\t\t}, Promise.resolve(view));\n\t},\n\n\t// _preloadAllItems2: function(view) {\n\t// \treturn view.sources.reduce(function(lastPromise, item, index, sources) {\n\t// \t\treturn lastPromise.then(function(view) {\n\t// \t\t\tvar itemView = view._getItemRenderer(item);\n\t// \t\t\treturn _whenImageLoads(itemView.el).then(function(url){\n\t// \t\t\t\tview._updateItemProgress(1, index);\n\t// \t\t\t\treturn view;\n\t// \t\t\t}, function(err) {\n\t// \t\t\t\tview._updateItemProgress(0, index);\n\t// \t\t\t\titem.set(\"error\", err);\n\t// \t\t\t\treturn view;\n\t// \t\t\t});\n\t// \t\t});\n\t// \t}, Promise.resolve(view));\n\t// },\n\n\t// _getItemRenderer: function(item) {}\n\n\t_updateItemProgress: function(progress, index) {\n\t\tthis._sourceProgressByIdx[index] = progress;\n\t\tif (this.progressMeter) {\n\t\t\tthis.progressMeter.valueTo(this._sourceProgressByIdx, 300, \"available\");\n\t\t}\n\t},\n\n\t/* ---------------------------\n\t/* PlayableRenderer implementation\n\t/* --------------------------- */\n\n\t/** @override initial value */\n\t_playbackRequested: true,\n\n\t/** @type {Boolean} internal store */\n\t_paused: true,\n\n\t/** @override */\n\t_isMediaPaused: function() {\n\t\treturn this._paused;\n\t},\n\n\t/** @override */\n\t_playMedia: function() {\n\t\tif (!this._paused) return;\n\t\tthis._paused = false;\n\t\tif (this.timer.status == Timer.PAUSED) {\n\t\t\tthis.timer.start(); // resume, actually\n\t\t} else {\n\t\t\tthis.timer.start(this._sequenceInterval);\n\t\t}\n\t},\n\n\t/** @override */\n\t_pauseMedia: function() {\n\t\tif (this._paused) return;\n\t\tthis._paused = true;\n\t\tif (this.timer.status == Timer.STARTED) {\n\t\t\tthis.timer.pause();\n\t\t}\n\t},\n\n\t/* --------------------------- *\n\t/* sequence private\n\t/* --------------------------- */\n\n\t_onTimerStart: function(duration) {\n\t\tthis.progressMeter.valueTo(this.sources.selectedIndex + 1, duration, \"amount\");\n\t\t// init next renderer now to have smooth transitions\n\t\tthis._getItemRenderer(this.sources.followingOrFirst());\n\t},\n\n\t_onTimerResume: function(duration) {\n\t\tthis.progressMeter.valueTo(this.sources.selectedIndex + 1, duration, \"amount\");\n\t},\n\n\t_onTimerPause: function(duration) {\n\t\t// var meterDur = this.progressMeter._valueData[\"amount\"]._duration - this.progressMeter._valueData[\"amount\"]._elapsedTime;\n\t\t// var meterVal = this.progressMeter.getRenderedValue(\"amount\");\n\t\t// var timerVal = (this._sequenceInterval - duration) / this._sequenceInterval + this.sources.selectedIndex;\n\t\t//\n\t\t// console.log(\"%s::_onTimerPause [interval:%sms]\\n\\tmeter:%s (%sms)\\n\\ttimer:%s (%sms)\\n\\tdiffs:%s (%sms)\",\n\t\t// \t\tthis.cid, this._sequenceInterval,\n\t\t// \t\tmeterVal, meterDur,\n\t\t// \t\ttimerVal, duration,\n\t\t// \t\tMath.abs(meterVal-timerVal), Math.abs(meterDur-duration));\n\n\t\t// this.progressMeter.valueTo(timerVal);\n\t\t// this.progressMeter.valueTo(meterVal);\n\n\t\tthis.progressMeter.valueTo(this.progressMeter.getRenderedValue(\"amount\"), 0, \"amount\");\n\t},\n\n\t_onTimerEnd: function() {\n\t\tvar context = this;\n\t\tvar nextSource, nextView;\n\n\t\tnextSource = this.sources.followingOrFirst();\n\t\t// init next renderer\n\t\tnextView = this._getItemRenderer(nextSource);\n\t\t// init second next renderer\n\t\t// this._getItemRenderer(this.sources.followingOrFirst(nextSource));\n\n\t\tvar showNextView = function() {\n\t\t\tcontext.requestAnimationFrame(function() {\n\t\t\t\tcontext.content.classList.remove(\"waiting\");\n\t\t\t\tif (!context._paused) {\n\t\t\t\t\t// if (context.playbackRequested) {\n\t\t\t\t\tcontext.content.classList.toggle(\"playback-error\", nextSource.has(\"error\"));\n\t\t\t\t\tcontext.sources.select(nextSource); // NOTE: step increase done here\n\t\t\t\t\t// view.updateOverlay(nextView.el, view.overlay);\n\t\t\t\t\tcontext.timer.start(context._sequenceInterval);\n\t\t\t\t\t// console.log(\"%s::showNextView %sms %s\", context.cid, context._sequenceInterval, nextSource.cid)\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tif (nextSource.has(\"prefetched\") || nextSource.has(\"error\")) {\n\t\t\t// nextView = context._getItemRenderer(nextSource).el;\n\t\t\t_whenImageLoads(nextView.el).then(showNextView, showNextView);\n\t\t} else {\n\t\t\tthis.content.classList.add(\"waiting\");\n\t\t\t/* TODO: add ga event 'media-waiting' */\n\t\t\t// console.log(\"%s:[waiting] %sms %s\", context.cid, nextSource.cid);\n\t\t\twindow.ga(\"send\", \"event\", \"sequence-renderer\", \"waiting\", this.model.get(\"text\"));\n\t\t\tthis.listenTo(nextSource, \"change:prefetched change:error\",\n\t\t\t\tfunction() {\n\t\t\t\t\tthis.stopListening(nextSource, \"change:prefetched change:error\");\n\t\t\t\t\t/* TODO: add ga event 'media-playing' */\n\t\t\t\t\t// console.log(\"%s:[playing] %sms %s\", context.cid, nextSource.cid);\n\t\t\t\t\twindow.ga(\"send\", \"event\", \"sequence-renderer\", \"playing\", this.model.get(\"text\"));\n\t\t\t\t\t_whenImageLoads(nextView.el).then(showNextView, showNextView);\n\t\t\t\t\t// context.content.classList.remove(\"waiting\");\n\t\t\t\t\t// nextView = context._getItemRenderer(nextSource).el;\n\t\t\t\t});\n\t\t}\n\t},\n\n\t_getItemRenderer: function(item) {\n\t\tvar view = this.itemViews.findByModel(item);\n\t\tif (!view) {\n\t\t\tvar renderer = item.has(\"error\") ? SourceErrorRenderer : SequenceStepRenderer;\n\t\t\tview = new renderer({\n\t\t\t\tmodel: item\n\t\t\t});\n\t\t\t// view = new SequenceStepRenderer({ model: item });\n\t\t\tthis.itemViews.add(view);\n\t\t\tthis.sequence.appendChild(view.render().el);\n\t\t}\n\t\treturn view;\n\t},\n\n\t/* --------------------------- *\n\t/* progress meter\n\t/* --------------------------- */\n\n\t// _createDefaultItemData: function() {\n\t// \tvar canvas = document.createElement(\"canvas\");\n\t// \tvar context = canvas.getContext(\"2d\");\n\t// \tvar imageData = this._drawMediaElement(context).getImageData(0, 0, canvas.width, canvas.height);\n\t//\n\t// \tvar opts = { radius: 20 };\n\t// \tvar fgColor = new Color(this.model.attr(\"color\"));\n\t// \tvar bgColor = new Color(this.model.attr(\"background-color\"));\n\t// \tvar isFgDark = fgColor.luminosity() < bgColor.luminosity();\n\t// \topts.x00 = isFgDark? fgColor.clone().lighten(0.33) : bgColor.clone().darken(0.33);\n\t// \topts.xFF = isFgDark? bgColor.clone().lighten(0.33) : fgColor.clone().darken(0.33);\n\t//\n\t// \tstackBlurMono(imageData, opts);\n\t// \tduotone(imageData, opts);\n\t// \t// stackBlurRGB(imageData, opts);\n\t//\n\t// \tcontext.putImageData(imageData, 0, 0);\n\t// \treturn canvas.toDataURL();\n\t// },\n});\n\nif (DEBUG) {\n\n\tSequenceRenderer = (function(SequenceRenderer) {\n\t\tif (!SequenceRenderer.LOG_TO_SCREEN) return SequenceRenderer;\n\n\t\t/** @type {module:underscore.strings/lpad} */\n\t\tvar lpad = require(\"underscore.string/lpad\");\n\n\t\treturn SequenceRenderer.extend({\n\t\t\t__logTimerEvent: function(evname, msg) {\n\t\t\t\tvar logMsg = [\n\t\t\t\t\"source: \", lpad(this.sources.selectedIndex, 2),\n\t\t\t\t\"duration:\", lpad(this.timer.getDuration(), 4),\n\t\t\t\t\"paused:\", this.paused,\n\t\t\t\t\"requested:\", this.playbackRequested,\n\t\t\t\t\"status:\", this.timer.getStatus(),\n\t\t\t];\n\t\t\t\tmsg && logMsg.push(msg);\n\t\t\t\tlogMsg = logMsg.join(\" \");\n\n\t\t\t\tthis.__logMessage(logMsg, evname);\n\t\t\t\t// console.log(\"%s::[%s] %s\", this.cid, evname, logMsg);\n\t\t\t},\n\t\t\t_playMedia: function() {\n\t\t\t\tthis.__logTimerEvent(\"playback\");\n\t\t\t\tSequenceRenderer.prototype._playMedia.apply(this, arguments);\n\t\t\t\t// console.log(\"%s::_playMedia()\", this.cid);\n\t\t\t},\n\t\t\t_pauseMedia: function() {\n\t\t\t\tthis.__logTimerEvent(\"playback\");\n\t\t\t\tSequenceRenderer.prototype._pauseMedia.apply(this, arguments);\n\t\t\t\t// console.log(\"%s::_pauseMedia()\", this.cid);\n\t\t\t},\n\n\t\t\t_onTimerStart: function() {\n\t\t\t\tthis.__logTimerEvent(\"timer:start\");\n\t\t\t\tSequenceRenderer.prototype._onTimerStart.apply(this, arguments);\n\t\t\t},\n\t\t\t_onTimerResume: function() {\n\t\t\t\tthis.__logTimerEvent(\"timer:resume\");\n\t\t\t\tSequenceRenderer.prototype._onTimerStart.apply(this, arguments);\n\t\t\t},\n\t\t\t_onTimerPause: function() {\n\t\t\t\tthis.__logTimerEvent(\"timer:pause\");\n\t\t\t\tSequenceRenderer.prototype._onTimerPause.apply(this, arguments);\n\t\t\t},\n\t\t\t_onTimerEnd: function() {\n\t\t\t\tthis.__logTimerEvent(\"timer:end\");\n\t\t\t\tSequenceRenderer.prototype._onTimerEnd.apply(this, arguments);\n\t\t\t},\n\n\t\t\t_updateItemProgress: function(progress, srcIdx) {\n\t\t\t\tif (progress == 1) {\n\t\t\t\t\tthis.__logMessage(\"idx:\" + srcIdx + \" progress:\" + progress, \"load:progress\");\n\t\t\t\t}\n\t\t\t\tSequenceRenderer.prototype._updateItemProgress.apply(this, arguments);\n\t\t\t},\n\n\t\t\t_preloadAllItems: function(view) {\n\t\t\t\tview.__logMessage(view.cid + \"::_preloadAllItems\", \"load:start\");\n\t\t\t\tSequenceRenderer.prototype._preloadAllItems.apply(view, arguments);\n\t\t\t},\n\t\t});\n\t})(SequenceRenderer);\n}\n\nmodule.exports = SequenceRenderer;",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var helper;\n\n  return \"<div class=\\\"placeholder sizing\\\"></div>\\n<div class=\\\"content media-border\\\">\\n\t<div class=\\\"controls content-size\\\">\\n\t\t<div class=\\\"top-bar control-box\\\">\\n\t\t\t<a class=\\\"fullscreen-toggle\\\" href=\\\"javascript:(void 0)\\\">\\n\t\t\t\t<svg version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" preserveAspectRatio=\\\"xMidYMid meet\\\" viewBox=\\\"-21 -21 42 42\\\" style=\\\"max-width:14px;max-height:14px\\\">\\n\t\t\t\t\t<path d=\\\"M-5,5 L-20,20 M-7,20 L-20,20 L-20,7 M5,-5 L20,-20 M7,-20 L20,-20 L20,-7\\\" class=\\\"color-stroke\\\" style=\\\"stroke-width:1;fill:none;\\\" vector-effect=\\\"non-scaling-stroke\\\" />\\n\t\t\t\t</svg>\\n\t\t\t</a>\\n\t\t</div>\\n\t</div>\\n\t<div class=\\\"crop-box media-size\\\">\\n\t\t<video preload=\\\"none\\\" width=\\\"240\\\" height=\\\"180\\\"></video>\\n\t\t<img class=\\\"poster default\\\" alt=\\\"\"\n    + container.escapeExpression(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : {},{\"name\":\"text\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" width=\\\"240\\\" height=\\\"180\\\" />\\n\t</div>\\n\t<div class=\\\"overlay media-size\\\">\\n\t\t<div class=\\\"play-toggle-hitarea play-toggle\\\">\\n\t\t</div>\\n\t</div>\\n</div>\\n\";\n},\"useData\":true});\n",
    "/*global HTMLMediaElement, MediaError*/\n/**\n * @module app/view/render/VideoRenderer\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video\n * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement\n * @see https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Media_events\n * @see https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Using_HTML5_audio_and_video\n */\n\n/* --------------------------- *\n/* Imports\n/* --------------------------- */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n// /** @type {module:backbone} */\n// var Backbone = require(\"backbone\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n/** @type {module:app/view/render/PlayableRenderer} */\nvar PlayableRenderer = require(\"app/view/render/PlayableRenderer\");\n/** @type {module:app/view/component/ProgressMeter} */\nvar ProgressMeter = require(\"app/view/component/ProgressMeter\");\n// /** @type {module:utils/prefixedStyleName} */\n// var prefixedStyleName = require(\"utils/prefixedStyleName\");\n/** @type {module:utils/prefixedEvent} */\nvar prefixedEvent = require(\"utils/prefixedEvent\");\n\n/* --------------------------- *\n/* private static\n/* --------------------------- */\n\n// var whenViewIsAttached = require(\"app/view/promise/whenViewIsAttached\");\n\nvar fullscreenChangeEvent = prefixedEvent(\"fullscreenchange\", document);\n// var fullscreenErrorEvent = prefixedEvent(\"fullscreenerror\", document);\n\nvar formatTimecode = function(value) {\n\tif (isNaN(value)) return \"\"; //value = 0;\n\tif (value >= 3600) return ((value / 3600) | 0) + \"H\";\n\tif (value >= 60) return ((value / 60) | 0) + \"M\";\n\t// if (value >= 10) return \"0\" + (value | 0) + \"S\";\n\treturn (value | 0) + \"S\";\n};\n\n/**\n * @constructor\n * @type {module:app/view/render/VideoRenderer}\n */\nvar VideoRenderer = PlayableRenderer.extend({\n\n\t/** @type {string} */\n\tcidPrefix: \"videoRenderer\",\n\t/** @type {string} */\n\tclassName: PlayableRenderer.prototype.className + \" video-renderer\",\n\t/** @type {Function} */\n\ttemplate: require(\"./VideoRenderer.hbs\"),\n\n\tevents: (function() {\n\t\treturn window.hasOwnProperty(\"onpointerup\")\n\t\t\t? { \"pointerup .fullscreen-toggle\": \"_onFullscreenToggle\" }\n\t\t\t: { \"mouseup .fullscreen-toggle\": \"_onFullscreenToggle\" }\n\t}()),\n\n\t// events: {\n\t// \t\"click .fullscreen-toggle\": \"_onFullscreenToggle\",\n\t// },\n\n\t// properties: {\n\t// \tpaused: {\n\t// \t\tget: function() {\n\t// \t\t\treturn this.video.paused;\n\t// \t\t}\n\t// \t},\n\t// },\n\n\t/** @override */\n\tinitialize: function(opts) {\n\t\tPlayableRenderer.prototype.initialize.apply(this, arguments);\n\n\t\t_.bindAll(this,\n\t\t\t\"_updatePlaybackState\",\n\t\t\t\"_updatePlayedValue\",\n\t\t\t\"_updateBufferedValue\",\n\t\t\t\"_onMediaError\",\n\t\t\t\"_onMediaEnded\",\n\t\t\t\"_onMediaPlayingOnce\",\n\t\t\t\"_onFullscreenChange\"\n\t\t);\n\t\t// var onPeerSelect = function() {\n\t\t// \tthis.content.style.display = (this.getSelectionDistance() > 1)? \"none\": \"\";\n\t\t// };\n\t\t// this.listenTo(this.model.collection, \"select:one select:none\", onPeerSelect);\n\t\t// onPeerSelect();\n\t},\n\n\t/* --------------------------- *\n\t/* children/layout\n\t/* --------------------------- */\n\n\t/** @override */\n\tcreateChildren: function() {\n\t\tPlayableRenderer.prototype.createChildren.apply(this, arguments);\n\n\t\tthis.placeholder = this.el.querySelector(\".placeholder\");\n\t\t// this.overlay = this.content.querySelector(\".overlay\");\n\t\tthis.video = this.content.querySelector(\"video\");\n\t\t// this.video.loop = this.model.attrs().hasOwnProperty(\"@video-loop\");\n\t\tthis.video.loop = this.model.attr(\"@video-loop\") !== void 0;\n\t\tthis.video.src = this.findPlayableSource(this.video);\n\t},\n\n\tmeasure: function() {\n\t\tPlayableRenderer.prototype.measure.apply(this, arguments);\n\n\t\t// NOTE: Top/bottom 1px video crop\n\t\t// - Cropped in CSS: video, .poster { margin-top: -1px; margin-bottom: -1px;}\n\t\t// - Cropped height is adjusted in metrics obj\n\t\t// - Crop amount added back to actual video on render()\n\t\tthis.metrics.media.height -= 2;\n\t\tthis.metrics.content.height -= 2;\n\t},\n\n\t/** @override */\n\trender: function() {\n\t\tPlayableRenderer.prototype.render.apply(this, arguments);\n\n\t\tvar els, el, i, cssW, cssH;\n\t\tvar img = this.defaultImage;\n\t\tvar content = this.content;\n\n\t\t// media-size\n\t\t// ---------------------------------\n\t\tcssW = this.metrics.media.width + \"px\";\n\t\tcssH = this.metrics.media.height + \"px\";\n\n\t\tels = this.el.querySelectorAll(\".media-size\");\n\t\tfor (i = 0; i < els.length; i++) {\n\t\t\tel = els.item(i);\n\t\t\tel.style.width = cssW;\n\t\t\tel.style.height = cssH;\n\t\t}\n\n\t\tcontent.style.width = cssW;\n\t\tcontent.style.height = (this.metrics.media.height - 1) + \"px\";\n\n\t\t// content-position\n\t\t// ---------------------------------\n\t\tvar cssX, cssY;\n\t\tcssX = this.metrics.content.x + \"px\";\n\t\tcssY = this.metrics.content.y + \"px\";\n\t\tcontent.style.left = cssX;\n\t\tcontent.style.top = cssY;\n\n\t\tel = this.el.querySelector(\".controls\");\n\t\t// el.style.left = cssX;\n\t\t// controls.style.top = cssY;\n\t\tel.style.width = this.metrics.content.width + \"px\";\n\t\tel.style.height = this.metrics.content.height + \"px\";\n\n\t\t// // content-size\n\t\t// // ---------------------------------\n\t\t// cssW = this.metrics.content.width + \"px\";\n\t\t// cssH = this.metrics.content.height + \"px\";\n\t\t//\n\t\t// els = this.el.querySelectorAll(\".content-size\");\n\t\t// for (i = 0; i < els.length; i++) {\n\t\t// \tel = els.item(i);\n\t\t// \tel.style.width = cssW;\n\t\t// \tel.style.height = cssH;\n\t\t// }\n\n\t\t// NOTE: elements below must use video's UNCROPPED height, so +2px\n\t\tthis.video.setAttribute(\"width\", this.metrics.media.width);\n\t\tthis.video.setAttribute(\"height\", this.metrics.media.height + 2);\n\t\timg.setAttribute(\"width\", this.metrics.media.width);\n\t\timg.setAttribute(\"height\", this.metrics.media.height + 2);\n\n\t\treturn this;\n\t},\n\n\t/* --------------------------- *\n\t/* initializeAsync\n\t/* --------------------------- */\n\n\tinitializeAsync: function() {\n\t\treturn Promise.resolve(this)\n\t\t\t.then(PlayableRenderer.whenSelectionIsContiguous)\n\t\t\t.then(PlayableRenderer.whenScrollingEnds)\n\t\t\t.then(\n\t\t\t\tfunction(view) {\n\t\t\t\t\treturn Promise.all([\n\t\t\t\t\t\tview.whenVideoHasMetadata(view),\n\t\t\t\t\t\tPlayableRenderer.whenDefaultImageLoads(view),\n\t\t\t\t\t]).then(\n\t\t\t\t\t\tfunction(arr) {\n\t\t\t\t\t\t\treturn Promise.resolve(view);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfunction(err) {\n\t\t\t\t\t\t\treturn Promise.reject(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t})\n\t\t\t.then(\n\t\t\t\tfunction(view) {\n\t\t\t\t\treturn view.whenAttached();\n\t\t\t\t})\n\t\t\t.then(\n\t\t\t\tfunction(view) {\n\t\t\t\t\tview.initializePlayable();\n\t\t\t\t\tview.updateOverlay(view.defaultImage, view.overlay);\n\t\t\t\t\tview.addSelectionListeners();\n\t\t\t\t\treturn view;\n\t\t\t\t});\n\t},\n\n\tinitializePlayable: function() {\n\t\t// video\n\t\t// ---------------------------------\n\t\tthis.addMediaListeners();\n\n\t\t// progress-meter\n\t\t// ---------------------------------\n\t\tthis.progressMeter = new ProgressMeter({\n\t\t\tmaxValues: {\n\t\t\t\tamount: this.video.duration,\n\t\t\t\tavailable: this.video.duration,\n\t\t\t},\n\t\t\tcolor: this.model.attr(\"color\"),\n\t\t\tbackgroundColor: this.model.attr(\"background-color\"),\n\t\t\tlabelFn: this._progressLabelFn.bind(this)\n\t\t});\n\t\tvar parentEl = this.el.querySelector(\".top-bar\");\n\t\tparentEl.insertBefore(this.progressMeter.render().el, parentEl.firstChild);\n\t},\n\n\t_progressLabelFn: function(value, total) {\n\t\tif (!this._started || this.video.ended || isNaN(value)) {\n\t\t\treturn formatTimecode(total);\n\t\t} else if (!this.playbackRequested) {\n\t\t\treturn Globals.PAUSE_CHAR;\n\t\t} else {\n\t\t\treturn formatTimecode(total - value);\n\t\t}\n\t},\n\n\t/* ---------------------------\n\t/* whenVideoHasMetadata promise\n\t/* --------------------------- */\n\n\twhenVideoHasMetadata: function(view) {\n\t\t// NOTE: not pretty !!!\n\t\treturn new Promise(function(resolve, reject) {\n\t\t\tvar mediaEl = view.video;\n\t\t\tvar eventHandlers = {\n\t\t\t\tloadedmetadata: function(ev) {\n\t\t\t\t\tif (ev) removeEventListeners();\n\t\t\t\t\t// console.log(\"%s::whenVideoHasMetadata [%s] %s\", view.cid, \"resolved\", ev? ev.type : \"sync\");\n\t\t\t\t\tresolve(view);\n\t\t\t\t},\n\t\t\t\tabort: function(ev) {\n\t\t\t\t\tif (ev) removeEventListeners();\n\t\t\t\t\treject(new PlayableRenderer.ViewError(view, new Error(\"whenVideoHasMetadata: view was removed\")));\n\t\t\t\t},\n\t\t\t\terror: function(ev) {\n\t\t\t\t\tif (ev) removeEventListeners();\n\t\t\t\t\tvar err;\n\t\t\t\t\tif (mediaEl.error) {\n\t\t\t\t\t\terr = new Error(_.invert(MediaError)[mediaEl.error.code]);\n\t\t\t\t\t\terr.infoCode = mediaEl.error.code;\n\t\t\t\t\t} else {\n\t\t\t\t\t\terr = new Error(\"Unspecified error\");\n\t\t\t\t\t}\n\t\t\t\t\terr.infoSrc = mediaEl.src;\n\t\t\t\t\terr.logMessage = \"whenVideoHasMetadata: \" + err.name + \" \" + err.infoSrc;\n\t\t\t\t\terr.logEvent = ev;\n\t\t\t\t\treject(err);\n\t\t\t\t},\n\t\t\t};\n\t\t\t//  (mediaEl.preload == \"auto\" && mediaEl.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA)\n\t\t\t// \t(mediaEl.preload == \"metadata\" && mediaEl.readyState >= HTMLMediaElement.HAVE_METADATA)\n\t\t\tif (mediaEl.error) {\n\t\t\t\teventHandlers.error();\n\t\t\t} else if (mediaEl.readyState >= HTMLMediaElement.HAVE_METADATA) {\n\t\t\t\teventHandlers.loadedmetadata();\n\t\t\t} else {\n\t\t\t\tvar sources = mediaEl.querySelectorAll(\"source\");\n\t\t\t\tvar errTarget = sources.length > 0 ? sources.item(sources.length - 1) : mediaEl;\n\t\t\t\tvar errCapture = errTarget === mediaEl; // use capture with HTMLMediaElement\n\n\t\t\t\tvar removeEventListeners = function() {\n\t\t\t\t\terrTarget.removeEventListener(\"error\", eventHandlers.error, errCapture);\n\t\t\t\t\tfor (var ev in eventHandlers) {\n\t\t\t\t\t\tif (ev !== \"error\" && eventHandlers.hasOwnProperty(ev)) {\n\t\t\t\t\t\t\tmediaEl.removeEventListener(ev, eventHandlers[ev], false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\terrTarget.addEventListener(\"error\", eventHandlers.error, errCapture);\n\t\t\t\tfor (var ev in eventHandlers) {\n\t\t\t\t\tif (ev !== \"error\" && eventHandlers.hasOwnProperty(ev)) {\n\t\t\t\t\t\tmediaEl.addEventListener(ev, eventHandlers[ev], false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmediaEl.preload = \"metadata\";\n\t\t\t}\n\t\t});\n\t},\n\n\tfindPlayableSource: function(video) {\n\t\tvar playable = this.model.get(\"sources\").find(function(source) {\n\t\t\treturn /^video\\//.test(source.get(\"mime\")) && video.canPlayType(source.get(\"mime\")) != \"\";\n\t\t});\n\t\treturn playable ? playable.get(\"original\") : \"\";\n\t},\n\n\t/* ---------------------------\n\t/* PlayableRenderer implementation\n\t/* --------------------------- */\n\n\t/** @override initial value */\n\t_playbackRequested: false,\n\n\t/** @override */\n\t_isMediaPaused: function() {\n\t\treturn this.video.paused;\n\t},\n\n\t/** @override */\n\t_playMedia: function() {\n\t\tif (this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA && this.video.seekable.length == 0) {\n\t\t\tconsole.warn(this.cid, \"WTF! got video data, but cannot seek, calling load()\");\n\t\t\t// this._logMessage(\"call:load\", \"got video data, but cannot seek, calling load()\", \"orange\");\n\t\t\tthis.video.load();\n\t\t\t// this.video.currentTime = 0;\n\t\t} else if (this.video.ended) {\n\t\t\tthis.video.currentTime = this.video.seekable.start(0);\n\t\t}\n\t\tthis.video.play();\n\t},\n\n\t/** @override */\n\t_pauseMedia: function() {\n\t\tthis.video.pause();\n\t},\n\n\t/* ---------------------------\n\t/* media events\n\t/* --------------------------- */\n\n\t// updatePlaybackEvents: \"play playing waiting pause seeking seeked ended\",\n\t// updateBufferedEvents: \"progress canplay canplaythrough playing timeupdate\",//loadeddata\n\tupdatePlaybackEvents: \"playing waiting pause\",\n\tupdateBufferedEvents: \"progress canplay canplaythrough play playing\",\n\tupdatePlayedEvents: \"timeupdate seeked\",\n\n\taddMediaListeners: function() {\n\t\tif (!this._started) this.video.addEventListener(\"playing\", this._onMediaPlayingOnce, false);\n\t\tthis.addListener(this.video, this.updatePlaybackEvents, this._updatePlaybackState);\n\t\tthis.addListener(this.video, this.updateBufferedEvents, this._updateBufferedValue);\n\t\tthis.addListener(this.video, this.updatePlayedEvents, this._updatePlayedValue);\n\t\tthis.video.addEventListener(\"ended\", this._onMediaEnded, false);\n\t\tthis.video.addEventListener(\"error\", this._onMediaError, true);\n\n\t\tthis.on(\"view:removed\", this.removeMediaListeners, this);\n\t},\n\n\tremoveMediaListeners: function() {\n\t\tthis.off(\"view:removed\", this.removeMediaListeners, this);\n\n\t\tif (!this._started) this.video.removeEventListener(\"playing\", this._onMediaPlayingOnce, false);\n\t\tthis.removeListener(this.video, this.updatePlaybackEvents, this._updatePlaybackState);\n\t\tthis.removeListener(this.video, this.updateBufferedEvents, this._updateBufferedValue);\n\t\tthis.removeListener(this.video, this.updatePlayedEvents, this._updatePlayedValue);\n\t\tthis.video.removeEventListener(\"ended\", this._onMediaEnded, false);\n\t\tthis.video.removeEventListener(\"error\", this._onMediaError, true);\n\t},\n\n\t/* ---------------------------\n\t/* media event handlers\n\t/* --------------------------- */\n\n\t_onMediaError: function(ev) {\n\t\tthis.removeMediaListeners();\n\t\tthis.removeSelectionListeners();\n\n\t\tthis._onMediaEnded(ev);\n\t\tthis.content.classList.remove(\"ended\");\n\t\tthis.content.classList.remove(\"waiting\");\n\t\tthis.content.classList.remove(\"started\");\n\t\tthis._started = false;\n\n\t\tthis.mediaState = \"error\";\n\t},\n\n\t_onMediaPlayingOnce: function(ev) {\n\t\tthis.video.removeEventListener(\"playing\", this._onMediaPlayingOnce, false);\n\t\tif (!this._started) {\n\t\t\tthis._started = true;\n\t\t\tthis.content.classList.add(\"started\");\n\t\t}\n\t},\n\n\t_onMediaEnded: function(ev) {\n\t\tthis.playbackRequested = false;\n\t\tif (this.video.webkitDisplayingFullscreen) {\n\t\t\tthis.video.webkitExitFullscreen();\n\t\t}\n\t\tif (document.fullscreenElement === this.video) {\n\t\t\tthis.video.exitFullscreen();\n\t\t}\n\t},\n\n\t_updatePlaybackState: function(ev) {\n\t\tvar classList = this.content.classList;\n\t\tif (this.playbackRequested) {\n\t\t\tswitch (ev.type) {\n\t\t\t\tcase \"pause\":\n\t\t\t\tcase \"playing\":\n\t\t\t\t\tclassList.remove(\"waiting\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"waiting\":\n\t\t\t\t\tclassList.add(\"waiting\");\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\t\t\tclassList.remove(\"waiting\");\n\t\t}\n\t\tclassList.toggle(\"ended\", this.video.ended);\n\n\t\tthis._updatePlayedValue(ev);\n\t},\n\n\t_updatePlayedValue: function(ev) {\n\t\tthis._currentTimeValue = this.video.currentTime;\n\t\tif (this.progressMeter) {\n\t\t\tthis.progressMeter.valueTo(this._currentTimeValue, 0, \"amount\");\n\t\t}\n\t},\n\n\t_updateBufferedValue: function(ev) {\n\t\tvar bRanges = this.video.buffered;\n\t\tif (bRanges.length > 0) {\n\t\t\tthis._bufferedValue = bRanges.end(bRanges.length - 1);\n\t\t\tif (this.progressMeter && ((this.video.readyState == HTMLMediaElement.HAVE_ENOUGH_DATA) /*|| (this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA && this.video.networkState == HTMLMediaElement.NETWORK_LOADING)*/ )) {\n\t\t\t\tthis.progressMeter.valueTo(this._bufferedValue, 300, \"available\");\n\t\t\t\t// this.progressMeter.valueTo(this._bufferedValue, Math.max(0, 1000 * (this._bufferedValue - (this.progressMeter.getValue(\"available\") | 0))), \"available\");\n\t\t\t}\n\t\t}\n\t},\n\n\t/* ---------------------------\n\t/* fullscreen api\n\t/* --------------------------- */\n\n\t_onFullscreenToggle: function(ev) {\n\t\t// NOTE: Ignore if MouseEvent.button is 0 or undefined (0: left-button)\n\t\tif (!ev.defaultPrevented && !ev.button && this.model.selected) {\n\t\t\t// ev.preventDefault();\n\t\t\ttry {\n\t\t\t\tif (document.hasOwnProperty(\"fullscreenElement\") &&\n\t\t\t\t\tdocument.fullscreenElement !== this.video) {\n\t\t\t\t\tdocument.addEventListener(fullscreenChangeEvent, this._onFullscreenChange, false);\n\t\t\t\t\tthis.video.requestFullscreen();\n\t\t\t\t} else\n\t\t\t\tif (this.video.webkitSupportsFullscreen && !this.video.webkitDisplayingFullscreen) {\n\t\t\t\t\tthis.video.addEventListener(\"webkitbeginfullscreen\", this._onFullscreenChange, false);\n\t\t\t\t\tthis.video.webkitEnterFullScreen();\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tthis.video.controls = false;\n\t\t\t\tconsole.error(err);\n\t\t\t}\n\t\t}\n\t},\n\n\t_onFullscreenChange: function(ev) {\n\t\tswitch (ev.type) {\n\t\t\tcase fullscreenChangeEvent:\n\t\t\t\t// var isOwnFullscreen = Modernizr.prefixed(\"fullscreenElement\", document) === this.video;\n\t\t\t\tvar isOwnFullscreen = document.fullscreenElement === this.video;\n\t\t\t\tthis.video.controls = isOwnFullscreen;\n\t\t\t\tif (!isOwnFullscreen) {\n\t\t\t\t\tdocument.removeEventListener(fullscreenChangeEvent, this._onFullscreenChange, false);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"webkitbeginfullscreen\":\n\t\t\t\tthis.video.controls = true;\n\t\t\t\tthis.video.removeEventListener(\"webkitbeginfullscreen\", this._onFullscreenChange, false);\n\t\t\t\tthis.video.addEventListener(\"webkitendfullscreen\", this._onFullscreenChange, false);\n\t\t\t\tbreak;\n\t\t\tcase \"webkitendfullscreen\":\n\t\t\t\tthis.video.controls = false;\n\t\t\t\tthis.video.removeEventListener(\"webkitendfullscreen\", this._onFullscreenChange, false);\n\t\t\t\tbreak;\n\t\t}\n\t},\n\n\t/* ---------------------------\n\t/* event helpers\n\t/* --------------------------- */\n\n\taddListener: function(target, events, handler, useCapture) {\n\t\t(typeof events === \"string\") && (events = events.split(\" \"));\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\ttarget.addEventListener(events[i], handler, !!useCapture);\n\t\t}\n\t},\n\n\tremoveListener: function(target, events, handler, useCapture) {\n\t\t(typeof events === \"string\") && (events = events.split(\" \"));\n\t\tfor (var i = 0; i < events.length; i++) {\n\t\t\ttarget.removeEventListener(events[i], handler, !!useCapture);\n\t\t}\n\t},\n});\n\n/* ---------------------------\n/* log to screen\n/* --------------------------- */\nif (DEBUG) {\n\n\tVideoRenderer = (function(VideoRenderer) {\n\t\tif (!VideoRenderer.LOG_TO_SCREEN) return VideoRenderer;\n\n\t\t/** @type {Function} */\n\t\tvar Color = require(\"color\");\n\t\t/** @type {module:underscore.strings/lpad} */\n\t\tvar lpad = require(\"underscore.string/lpad\");\n\t\t/** @type {module:underscore.strings/rpad} */\n\t\tvar rpad = require(\"underscore.string/rpad\");\n\n\t\t// var fullscreenEvents = [\n\t\t// \tfullscreenChangeEvent, fullscreenErrorEvent,\n\t\t// \t\"webkitbeginfullscreen\", \"webkitendfullscreen\",\n\t\t// ];\n\n\t\tvar mediaEvents = require(\"utils/event/mediaEventsEnum\");\n\t\tvar updatePlaybackStateEvents, updateBufferedEvents, updatePlayedEvents;\n\n\t\t// updatePlaybackStateEvents = [\"playing\", \"waiting\", \"ended\", \"pause\", \"seeking\", \"seeked\"];\n\t\t// updateBufferedEvents = [\"progress\", \"durationchange\", \"canplay\", \"play\"];\n\t\t// updatePlayedEvents = [\"playing\", \"timeupdate\"];\n\n\t\tupdatePlaybackStateEvents = [\n\t\t\t\"loadstart\",\n\t\t\t\"progress\",\n\t\t\t\"suspend\",\n\t\t\t\"abort\",\n\t\t\t\"error\",\n\t\t\t\"emptied\",\n\t\t\t\"stalled\",\n\t\t];\n\t\tupdateBufferedEvents = [\n\t\t\t\"loadedmetadata\",\n\t\t\t\"loadeddata\",\n\t\t\t\"canplay\",\n\t\t\t\"canplaythrough\",\n\t\t\t\"playing\",\n\t\t\t\"waiting\",\n\t\t\t\"seeking\", // seeking changed to true\n\t\t\t\"seeked\", // seeking changed to false\n\t\t\t\"ended\", // ended is true\n\t\t];\n\t\tupdatePlayedEvents = [\"play\", \"pause\"];\n\n\t\t// Exclude some events from log\n\t\tmediaEvents = _.without(mediaEvents, \"resize\", \"error\");\n\t\t// Make sure event subsets exist in the main set\n\t\tupdatePlaybackStateEvents = _.intersection(mediaEvents, updatePlaybackStateEvents);\n\t\tupdateBufferedEvents = _.intersection(mediaEvents, updateBufferedEvents);\n\t\tupdatePlayedEvents = _.intersection(mediaEvents, updatePlayedEvents);\n\n\t\tvar readyStateSymbols = _.invert(_.pick(HTMLMediaElement,\n\t\t\tfunction(val, key, obj) {\n\t\t\t\treturn /^HAVE_/.test(key);\n\t\t\t}));\n\t\tvar readyStateToString = function(el) {\n\t\t\treturn readyStateSymbols[el.readyState] + \"(\" + el.readyState + \")\";\n\t\t};\n\n\t\tvar networkStateSymbols = _.invert(_.pick(HTMLMediaElement,\n\t\t\tfunction(val, key, obj) {\n\t\t\t\treturn /^NETWORK_/.test(key);\n\t\t\t}));\n\t\tvar networkStateToString = function(el) {\n\t\t\treturn networkStateSymbols[el.networkState] + \"(\" + el.networkState + \")\";\n\t\t};\n\n\t\tvar mediaErrorSymbols = _.invert(MediaError);\n\t\tvar mediaErrorToString = function(el) {\n\t\t\treturn el.error ? mediaErrorSymbols[el.error.code] + \"(\" + el.error.code + \")\" : \"[MediaError null]\";\n\t\t};\n\n\t\tvar findRangeIndex = function(range, currTime) {\n\t\t\tfor (var i = 0, ii = range.length; i < ii; i++) {\n\t\t\t\tif (range.start(i) <= currTime && currTime <= range.end(i)) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1;\n\t\t};\n\n\t\tvar formatVideoError = function(video) {\n\t\t\treturn [\n\t\t\t\tmediaErrorToString(video),\n\t\t\t\tnetworkStateToString(video),\n\t\t\t\treadyStateToString(video),\n\t\t\t].join(\" \");\n\t\t};\n\n\t\tvar getVideoStatsCols = function() {\n\t\t\treturn \"0000.000 [Current/Total] [Seekable   ] [Buffered   ] networkState readyState      Playing\";\n\t\t\t// return \"0000.620 [t:  0.0  27.4] [s: 27.4 0/1] [b:  0.5 0/1] LOADING(2)   FUTURE_DATA(3)  :: (::)\";\n\t\t}\n\n\t\tvar formatVideoStats = function(video) {\n\t\t\tvar currTime = video.currentTime,\n\t\t\t\tdurTime = video.duration,\n\t\t\t\tbRanges = video.buffered,\n\t\t\t\tbRangeIdx,\n\t\t\t\tsRanges = video.seekable,\n\t\t\t\tsRangeIdx;\n\n\t\t\tbRangeIdx = findRangeIndex(bRanges, currTime);\n\t\t\tsRangeIdx = findRangeIndex(sRanges, currTime);\n\t\t\treturn [\n\t\t\t\t\"[t:\" + lpad(currTime.toFixed(1), 5) +\n\t\t\t\t\t\" \" + lpad((!isNaN(durTime) ? durTime.toFixed(1) : \"-\"), 5) + \"]\",\n\t\t\t\t\"[s:\" + lpad((sRangeIdx >= 0 ? sRanges.end(sRangeIdx).toFixed(1) : \"-\"), 5) +\n\t\t\t\t\t\" \" + (sRangeIdx >= 0 ? sRangeIdx : \"-\") + \"/\" + sRanges.length + \"]\",\n\t\t\t\t\"[b:\" + lpad((bRangeIdx >= 0 ? bRanges.end(bRangeIdx).toFixed(1) : \"-\"), 5) +\n\t\t\t\t\t\" \" + (bRangeIdx >= 0 ? bRangeIdx : \"-\") + \"/\" + bRanges.length + \"]\",\n\t\t\t\trpad(networkStateToString(video).substr(8), 12),\n\t\t\t\trpad(readyStateToString(video).substr(5), 15),\n\t\t\t\t(video.ended ? \">:\" : (video.paused ? \"::\" : \">>\")),\n\t\t\t].join(\" \");\n\t\t};\n\n\t\treturn VideoRenderer.extend({\n\n\t\t\t/** @override */\n\t\t\tinitialize: function() {\n\t\t\t\tVideoRenderer.prototype.initialize.apply(this, arguments);\n\n\t\t\t\t_.bindAll(this, \"__handleMediaEvent\");\n\n\t\t\t\tvar fgColor = this.model.attr(\"color\"),\n\t\t\t\t\tred = new Color(\"red\"),\n\t\t\t\t\tblue = new Color(\"blue\"),\n\t\t\t\t\tgreen = new Color(\"green\");\n\n\t\t\t\tfor (var i = 0; i < mediaEvents.length; i++) {\n\t\t\t\t\tvar ev = mediaEvents[i];\n\t\t\t\t\tthis.video.addEventListener(ev, this.__handleMediaEvent, false);\n\n\t\t\t\t\tvar c = new Color(fgColor),\n\t\t\t\t\t\tcc = 1;\n\t\t\t\t\tif (updateBufferedEvents.indexOf(ev) != -1) c.mix(green, (cc /= 2));\n\t\t\t\t\tif (updatePlayedEvents.indexOf(ev) != -1) c.mix(red, (cc /= 2));\n\t\t\t\t\tif (updatePlaybackStateEvents.indexOf(ev) != -1) c.mix(blue, (cc /= 2));\n\t\t\t\t\tthis.__logColors[ev] = c.rgbString();\n\t\t\t\t}\n\t\t\t\tthis.video.addEventListener(\"error\", this.__handleMediaEvent, true);\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\tremove: function() {\n\t\t\t\tVideoRenderer.prototype.remove.apply(this, arguments);\n\t\t\t\tfor (var i = 0; i < mediaEvents.length; i++) {\n\t\t\t\t\tif (mediaEvents[i] == \"error\") continue;\n\t\t\t\t\tthis.video.removeEventListener(mediaEvents[i], this.__handleMediaEvent, false);\n\t\t\t\t}\n\t\t\t\tthis.video.removeEventListener(\"error\", this.__handleMediaEvent, true);\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\t_onVisibilityChange: function(ev) {\n\t\t\t\tVideoRenderer.prototype._onVisibilityChange.apply(this, arguments);\n\t\t\t\tvar stateVal = Modernizr.prefixed(\"visibilityState\", document);\n\t\t\t\tthis.__logEvent(\"visibilityState:\" + stateVal, ev.type + \":\" + stateVal);\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\t_onFullscreenChange: function(ev) {\n\t\t\t\tVideoRenderer.prototype._onFullscreenChange.apply(this, arguments);\n\t\t\t\tvar logtype = (document.fullscreenElement === this.video ? \"enter:\" : \"exit:\") + ev.type;\n\t\t\t\tthis.__logEvent(\"document.fullscreenElement: \" + this.cid, logtype);\n\t\t\t},\n\n\t\t\t/** @override */\n\t\t\t_onFullscreenToggle: function(ev) {\n\t\t\t\tVideoRenderer.prototype._onFullscreenToggle.apply(this, arguments);\n\t\t\t\tif (!ev.defaultPrevented && this.model.selected) {\n\t\t\t\t\tthis.__logEvent(\"fullscreen-toggle\", ev.type);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t__handleMediaEvent: function(ev) {\n\t\t\t\tvar evmsg; //, errmsg;\n\t\t\t\t// evmsg = formatVideoStats(this.video) + \" \" + rpad(this._lastPlaybackStates || \"-\", 9);\n\t\t\t\tevmsg = formatVideoStats(this.video);\n\t\t\t\tif (this.playbackRequested === true) {\n\t\t\t\t\tevmsg += \" (>>)\";\n\t\t\t\t} else if (this.playbackRequested === false) {\n\t\t\t\t\tevmsg += \" (::)\";\n\t\t\t\t} else {\n\t\t\t\t\tevmsg += \" (--)\";\n\t\t\t\t}\n\t\t\t\tthis.__logEvent(evmsg, ev.type);\n\t\t\t\tif (ev.type === \"error\" || ev.type === \"abort\") {\n\t\t\t\t\tthis.__logMessage(formatVideoError(this.video), ev.type);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t__logEvent: function(msg, logtype, color) {\n\t\t\t\tvar logEntryEl = this.__logElement.lastElementChild;\n\t\t\t\tif ((logEntryEl && logEntryEl.getAttribute(\"data-logtype\") == logtype) &&\n\t\t\t\t\t((logtype === \"timeupdate\") || (logtype === \"progress\"))) {\n\t\t\t\t\tvar logRepeatVal = parseInt(logEntryEl.getAttribute(\"data-logrepeat\"));\n\t\t\t\t\tlogEntryEl.textContent = this.__getTStamp() + \" \" + msg;\n\t\t\t\t\tlogEntryEl.setAttribute(\"data-logrepeat\", isNaN(logRepeatVal) ? 2 : ++logRepeatVal);\n\t\t\t\t} else {\n\t\t\t\t\tthis.__logMessage(msg, logtype, color);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t__getHeaderText: function() {\n\t\t\t\treturn getVideoStatsCols();\n\t\t\t},\n\t\t});\n\t})(VideoRenderer);\n\n}\n\nmodule.exports = VideoRenderer;",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=\"function\";\n\n  return \"<div id=\\\"desc_b\"\n    + container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"id\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" class=\\\"content sizing markdown-html\\\">\"\n    + ((stack1 = ((helper = (helper = helpers.desc || (depth0 != null ? depth0.desc : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"desc\",\"hash\":{},\"data\":data}) : helper))) != null ? stack1 : \"\")\n    + \"</div>\\n\";\n},\"useData\":true});\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=\"function\";\n\n  return \"<div id=\\\"desc_m\"\n    + container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"id\",\"hash\":{},\"data\":data}) : helper)))\n    + \"\\\" class=\\\"content sizing\\\"><p>\"\n    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper))) != null ? stack1 : \"\")\n    + \"</p>\"\n    + ((stack1 = ((helper = (helper = helpers.sub || (depth0 != null ? depth0.sub : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"sub\",\"hash\":{},\"data\":data}) : helper))) != null ? stack1 : \"\")\n    + \"</div>\\n\";\n},\"useData\":true});\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"1\":function(container,depth0,helpers,partials,data) {\n    var stack1;\n\n  return \"\t<dd id=\\\"select-layout\\\">\\n\t\t<select size=1>\\n\"\n    + ((stack1 = helpers.each.call(depth0 != null ? depth0 : {},(depth0 != null ? depth0.layouts : depth0),{\"name\":\"each\",\"hash\":{},\"fn\":container.program(2, data, 0),\"inverse\":container.noop,\"data\":data})) != null ? stack1 : \"\")\n    + \"\t\t</select>\\n\t</dd>\\n\";\n},\"2\":function(container,depth0,helpers,partials,data) {\n    var alias1=container.lambda, alias2=container.escapeExpression;\n\n  return \"\t\t\t<option value=\\\"\"\n    + alias2(alias1(depth0, depth0))\n    + \"\\\">\"\n    + alias2(alias1(depth0, depth0))\n    + \"</option>\\n\";\n},\"4\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : {};\n\n  return \"\t\t<li class=\\\"\"\n    + ((stack1 = helpers[\"if\"].call(alias1,depth0,{\"name\":\"if\",\"hash\":{},\"fn\":container.program(5, data, 0),\"inverse\":container.program(7, data, 0),\"data\":data})) != null ? stack1 : \"\")\n    + \"\\\">\"\n    + container.escapeExpression(((helper = (helper = helpers.key || (data && data.key)) != null ? helper : helpers.helperMissing),(typeof helper === \"function\" ? helper.call(alias1,{\"name\":\"key\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</li>\\n\";\n},\"5\":function(container,depth0,helpers,partials,data) {\n    return \"passed\";\n},\"7\":function(container,depth0,helpers,partials,data) {\n    return \"failed\";\n},\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, alias1=depth0 != null ? depth0 : {}, alias2=container.escapeExpression;\n\n  return \"<dl class=\\\"debug-links\\\">\\n\t<dt id=\\\"links-toggle\\\">\\n\t\t<svg class=\\\"icon\\\" viewBox=\\\"-100 -100 200 200\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" preserveAspectRatio=\\\"xMidYMid meet\\\">\\n\t\t\t<path id=\\\"cog\\\" d=\\\"M11.754,-99.307c-7.809,-0.924 -15.699,-0.924 -23.508,0l-3.73,20.82c-6.254,1.234 -12.338,3.21 -18.123,5.888l-15.255,-14.651c-6.861,3.842 -13.244,8.48 -19.018,13.818l9.22,19.036c-4.335,4.674 -8.095,9.849 -11.201,15.416l-20.953,-2.886c-3.292,7.141 -5.731,14.645 -7.265,22.357l18.648,9.981c-0.759,6.329 -0.759,12.727 0,19.056l-18.648,9.981c1.534,7.712 3.973,15.216 7.265,22.357l20.953,-2.886c3.106,5.567 6.866,10.742 11.201,15.416l-9.22,19.036c5.774,5.338 12.157,9.976 19.018,13.818l15.255,-14.651c5.785,2.678 11.869,4.654 18.123,5.888l3.73,20.82c7.809,0.924 15.699,0.924 23.508,0l3.73,-20.82c6.254,-1.234 12.338,-3.21 18.123,-5.888l15.255,14.651c6.861,-3.842 13.244,-8.48 19.018,-13.818l-9.22,-19.036c4.335,-4.674 8.095,-9.849 11.201,-15.416l20.953,2.886c3.292,-7.141 5.731,-14.645 7.265,-22.357l-18.648,-9.981c0.759,-6.329 0.759,-12.727 0,-19.056l18.648,-9.981c-1.534,-7.712 -3.973,-15.216 -7.265,-22.357l-20.953,2.886c-3.106,-5.567 -6.866,-10.742 -11.201,-15.416l9.22,-19.036c-5.774,-5.338 -12.157,-9.976 -19.018,-13.818l-15.255,14.651c-5.785,-2.678 -11.869,-4.654 -18.123,-5.888l-3.73,-20.82ZM0,-33c18.213,0 33,14.787 33,33c0,18.213 -14.787,33 -33,33c-18.213,0 -33,-14.787 -33,-33c0,-18.213 14.787,-33 33,-33Z\\\" style=\\\"fill:currentColor;fill-rule:evenodd;\\\"/>\\n\t\t</svg>\\n\t</dt>\\n\t<dt id=\\\"app-state\\\">\\n\t\t<span class=\\\"color-fg color-bg\\\" data-prop=\\\"withBundle\\\">b</span>\\n\t\t<span class=\\\"color-fg color-bg\\\" data-prop=\\\"withMedia\\\">m</span>\\n\t\t<span class=\\\"color-fg color-bg\\\" data-prop=\\\"collapsed\\\">c</span>\\n\t</dt>\\n\"\n    + ((stack1 = helpers[\"if\"].call(alias1,(depth0 != null ? depth0.layouts : depth0),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data})) != null ? stack1 : \"\")\n    + \"\t<dd id=\\\"edit-backend\\\">\\n\t\t<a href=\\\"\"\n    + alias2((helpers.global || (depth0 && depth0.global) || helpers.helperMissing).call(alias1,\"APP_ROOT\",{\"name\":\"global\",\"hash\":{},\"data\":data}))\n    + \"symphony/\\\" class=\\\"color-fg color-bg\\\" target=\\\"_blank\\\">CMS</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-tests\\\">\\n\t\t<a href=\\\"#toggle-tests\\\" class=\\\"color-fg color-bg\\\">Tests</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-blocks\\\">\\n\t\t<a href=\\\"#toggle-blocks\\\" class=\\\"color-fg color-bg\\\">Blocks</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-tx\\\">\\n\t\t<a href=\\\"#toggle-blocks\\\" class=\\\"color-fg color-bg\\\">TX/FX</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-grid-bg\\\">\\n\t\t<a href=\\\"#toggle-grid-bg\\\" class=\\\"color-fg color-bg\\\">Grid</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-markdown\\\">\\n\t\t<a href=\\\"#toggle-markdown\\\" class=\\\"color-fg color-bg\\\">Markdown</a>\\n\t</dd>\\n\t<dd id=\\\"toggle-logs\\\">\\n\t\t<a href=\\\"#toggle-logs\\\" class=\\\"color-fg color-bg\\\">Logs</a>\\n\t</dd>\\n\t<dd id=\\\"media-info\\\">\\n\t\t<span></span>\\n\t</dd>\\n\t<dd id=\\\"viewport-info\\\">\\n\t\t<span></span>\\n\t</dd>\\n</dl>\\n<div id=\\\"test-results\\\">\\n\t<h6>Tests <a id=\\\"toggle-passed\\\" href=\\\"#toggle-passed\\\">Passed</a></h6>\\n\t<p>\"\n    + alias2(container.lambda(((stack1 = (depth0 != null ? depth0.navigator : depth0)) != null ? stack1.userAgent : stack1), depth0))\n    + \"</p>\\n\t<ul>\\n\"\n    + ((stack1 = helpers.each.call(alias1,(depth0 != null ? depth0.tests : depth0),{\"name\":\"each\",\"hash\":{},\"fn\":container.program(4, data, 0),\"inverse\":container.noop,\"data\":data})) != null ? stack1 : \"\")\n    + \"\t</ul>\\n</div>\\n\";\n},\"useData\":true});\n",
    "// hbsfy compiled Handlebars template\nvar HandlebarsCompiler = require('hbsfy/runtime');\nmodule.exports = HandlebarsCompiler.template({\"1\":function(container,depth0,helpers,partials,data) {\n    var helper;\n\n  return \"\t\t<p><code>\"\n    + container.escapeExpression(((helper = (helper = helpers.infoSrc || (depth0 != null ? depth0.infoSrc : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === \"function\" ? helper.call(depth0 != null ? depth0 : {},{\"name\":\"infoSrc\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</code></p>\\n\";\n},\"compiler\":[7,\">= 4.0.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=\"function\", alias4=container.escapeExpression;\n\n  return \"<div class=\\\"error-message color-fg\\\">\\n\t<p><strong>\"\n    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"name\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</strong> <code>\"\n    + alias4(((helper = (helper = helpers.message || (depth0 != null ? depth0.message : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{\"name\":\"message\",\"hash\":{},\"data\":data}) : helper)))\n    + \"</code></p>\\n\"\n    + ((stack1 = helpers[\"if\"].call(alias1,(depth0 != null ? depth0.infoSrc : depth0),{\"name\":\"if\",\"hash\":{},\"fn\":container.program(1, data, 0),\"inverse\":container.noop,\"data\":data})) != null ? stack1 : \"\")\n    + \"</div>\";\n},\"useData\":true});\n",
    "// var Handlebars = require(\"handlebars\")[\"default\"];\nvar Handlebars = require(\"hbsfy/runtime\");\n/** @type {Function} */\nvar Color = require(\"color\");\n/** @type {module:app/control/Globals} */\nvar Globals = require(\"app/control/Globals\");\n\n// (function() {\nvar helpers = {\n\t/*\n\t/* Arithmetic helpers\n\t/*/\n\tadd: function(value, addition) {\n\t\treturn value + addition;\n\t},\n\tsubtract: function(value, substraction) {\n\t\treturn value - substraction;\n\t},\n\tdivide: function(value, divisor) {\n\t\treturn value / divisor;\n\t},\n\tmultiply: function(value, multiplier) {\n\t\treturn value * multiplier;\n\t},\n\tfloor: function(value) {\n\t\treturn Math.floor(value);\n\t},\n\tceil: function(value) {\n\t\treturn Math.ceil(value);\n\t},\n\tround: function(value) {\n\t\treturn Math.round(value);\n\t},\n\tglobal: function(value) {\n\t\treturn Globals[value];\n\t},\n\n\t/*\n\t/* Flow control helpers\n\t/*/\n\tis: function(a, b, opts) {\n\t\treturn (a === b) ? opts.fn(this) : opts.inverse(this);\n\t},\n\tisnot: function(a, b, opts) {\n\t\treturn (a !== b) ? opts.fn(this) : opts.inverse(this);\n\t},\n\tisany: function(value) {\n\t\tvar i = 0,\n\t\t\tii = arguments.length - 2,\n\t\t\topts = arguments[ii + 1];\n\t\tdo\n\t\t\tif (value === arguments[++i]) {\n\t\t\t\treturn opts.fn(this);\n\t\t\t}\n\t\twhile (i < ii);\n\t\treturn opts.inverse(this);\n\t},\n\tcontains: function(a, b, opts) {\n\t\treturn (a.indexOf(b) !== -1) ? opts.fn(this) : opts.inverse(this);\n\t},\n\tignore: function() {\n\t\treturn \"\";\n\t},\n\n\t/*\n\t/* Color helpers\n\t/*/\n\tmix: function(colora, colorb, amount) {\n\t\treturn new Color(colora).mix(new Color(colorb), amount).rgbString();\n\t},\n\tlighten: function(color, amount) {\n\t\treturn new Color(color).lighten(amount).rgbString();\n\t},\n\tdarken: function(color, amount) {\n\t\treturn new Color(color).darken(amount).rgbString();\n\t},\n\t// colorFormat: function(color, fmt) {\n\t// \tswitch (fmt) {\n\t// \t\tcase \"rgb\":\n\t// \t\t\treturn new Color(color).rgbString();\n\t// \t\tcase \"hsl\":\n\t// \t\t\treturn new Color(color).hslString();\n\t// \t\tcase \"hex\": default:\n\t// \t\t\treturn new Color(color).hexString();\n\t// \t}\n\t// },\n};\nfor (var helper in helpers) {\n\tif (helpers.hasOwnProperty(helper)) {\n\t\tHandlebars.registerHelper(helper, helpers[helper]);\n\t}\n}\n// })();\n\n// module.exports = Handlebars;\n",
    "/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n/** @type {module:backbone} */\nvar Events = require(\"backbone\").Events;\n\n\n// var defaultOptions = {\n// \ttick: 1,\n// \tonstart: null,\n// \tontick: null,\n// \tonpause: null,\n// \tonstop: null,\n// \tonend: null\n// }\nvar idSeed = 0;\n\nvar Timer = function(options) {\n\t// if (!(this instanceof Timer)) {\n\t// \treturn new Timer(options);\n\t// }\n\tthis._id = idSeed++;\n\t// this._options = {};\n\tthis._duration = 0;\n\tthis._status = \"initialized\";\n\tthis._start = 0;\n\t// this._measures = [];\n\n\t// for (var prop in defaultOptions) {\n\t// \tthis._options[prop] = defaultOptions[prop];\n\t// }\n\t// this.options(options);\n};\n\n_.extend(Timer.prototype, Events, {\n\n\tstart: function(duration) {\n\t\tif (!_.isNumber(duration) && !this._duration) {\n\t\t\treturn this;\n\t\t}\n\t\t// duration && (duration *= 1000)\n\t\tif (this._timeout && this._status === \"started\") {\n\t\t\treturn this;\n\t\t}\n\t\tvar evName = (this._status === \"stopped\") ? \"start\" : \"resume\";\n\t\tthis._duration = duration || this._duration;\n\t\tthis._timeout = window.setTimeout(end.bind(this), this._duration);\n\t\t// if (typeof this._options.ontick === \"function\") {\n\t\t// \tthis._interval = setInterval(function() {\n\t\t// \t\tthis.trigger(\"tick\", this.getDuration())\n\t\t// \t}.bind(this), +this._options.tick * 1000)\n\t\t// }\n\t\tthis._start = _now();\n\t\tthis._status = \"started\";\n\t\tthis.trigger(evName, this.getDuration());\n\t\treturn this;\n\t},\n\n\tpause: function() {\n\t\tif (this._status !== \"started\") {\n\t\t\treturn this;\n\t\t}\n\t\tthis._duration -= (_now() - this._start);\n\t\tclear.call(this, false);\n\t\tthis._status = \"paused\";\n\t\tthis.trigger(\"pause\", this.getDuration());\n\t\treturn this;\n\t},\n\n\tstop: function() {\n\t\tif (!/started|paused/.test(this._status)) {\n\t\t\treturn this;\n\t\t}\n\t\tclear.call(this, true);\n\t\tthis._status = \"stopped\";\n\t\tthis.trigger(\"stop\");\n\t\treturn this;\n\t},\n\n\tgetDuration: function() {\n\t\tif (this._status === \"started\") {\n\t\t\treturn this._duration - (_now() - this._start);\n\t\t}\n\t\tif (this._status === \"paused\") {\n\t\t\treturn this._duration;\n\t\t}\n\t\treturn 0;\n\t},\n\n\tgetStatus: function() {\n\t\treturn this._status;\n\t},\n});\n\nvar _now = window.performance ?\n\twindow.performance.now.bind(window.performance) :\n\tDate.now.bind(Date);\n\nfunction end() {\n\tclear.call(this);\n\tthis._status = \"stopped\";\n\tthis.trigger(\"end\");\n}\n\nfunction clear(clearDuration) {\n\twindow.clearTimeout(this._timeout);\n\t// window.clearInterval(this._interval);\n\tif (clearDuration === true) {\n\t\tthis._duration = 0;\n\t}\n}\n\nObject.defineProperties(Timer.prototype, {\n\tduration: {\n\t\tenumerable: true,\n\t\tget: function() {\n\t\t\treturn this.getDuration();\n\t\t}\n\t},\n\tstatus: {\n\t\tenumerable: true,\n\t\tget: function() {\n\t\t\treturn this.getStatus();\n\t\t}\n\t}\n});\n\nObject.defineProperties(Timer, {\n\tSTOPPED: {\n\t\tenumerable: true,\n\t\tvalue: \"stopped\"\n\t},\n\tSTARTED: {\n\t\tenumerable: true,\n\t\tvalue: \"started\"\n\t},\n\tPAUSED: {\n\t\tenumerable: true,\n\t\tvalue: \"paused\"\n\t},\n});\n\nmodule.exports = Timer;\n",
    "/* -------------------------------\n/* Imports\n/* ------------------------------- */\n\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n\n/** @type {module:utils/TransformItem} */\nvar TransformItem = require(\"./TransformItem\");\n\nvar idSeed = 0;\nvar cidSeed = 100;\nvar slice = Array.prototype.slice;\n\n/**\n * @constructor\n * @type {module:app/helper/TransformHelper}\n */\nfunction TransformHelper() {\n\tthis.id = idSeed++;\n\tthis._items = [];\n\tthis._itemsById = {};\n}\n\nTransformHelper.prototype = Object.create({\n\n\t/* -------------------------------\n\t/* Private\n\t/* ------------------------------- */\n\n\t_get: function(el) {\n\t\tif (this.has(el)) {\n\t\t\treturn this._itemsById[el.eid];\n\t\t} else {\n\t\t\treturn this._add(el);\n\t\t}\n\t},\n\n\t_add: function(el) {\n\t\tvar item, id;\n\t\t// id = el.eid || el.cid || el.id;\n\t\t// if (!id || (this._itemsById[id] && (this._itemsById[id].el !== el))) {\n\t\t// \tid = \"elt\" + cidSeed++;\n\t\t// }\n\t\t// if (!el.eid) {\n\t\t// \tid = el.eid || el.cid || (\"elt\" + cidSeed++);\n\t\t// }\n\t\tid = el.eid || el.cid || (\"elt\" + cidSeed++);\n\t\titem = new TransformItem(el, id);\n\t\tthis._itemsById[id] = item;\n\t\tthis._items.push(item);\n\t\treturn item;\n\t},\n\n\t_remove: function(el) {\n\t\tif (this.has(el)) {\n\t\t\tvar o = this._itemsById[el.eid];\n\t\t\tthis._items.splice(this._items.indexOf(o), 1);\n\t\t\to.destroy();\n\t\t\tdelete this._itemsById[el.eid];\n\t\t}\n\t},\n\n\t_invoke: function(funcName, args, startIndex) {\n\t\tvar i, ii, j, jj, el, o, rr;\n\t\tvar funcArgs = null;\n\t\tif (startIndex !== void 0) {\n\t\t\tfuncArgs = slice.call(args, 0, startIndex);\n\t\t} else {\n\t\t\tstartIndex = 0;\n\t\t}\n\t\tfor (i = startIndex, ii = args.length, rr = []; i < ii; ++i) {\n\t\t\tel = args[i];\n\t\t\t// iterate on NodeList, Arguments, Array...\n\t\t\tif (el.length) {\n\t\t\t\tfor (j = 0, jj = el.length; j < jj; ++j) {\n\t\t\t\t\to = this._get(el[j]);\n\t\t\t\t\trr.push(o[funcName].apply(o, funcArgs));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\to = this._get(el);\n\t\t\t\trr.push(o[funcName].apply(o, funcArgs));\n\t\t\t}\n\t\t}\n\t\treturn rr;\n\t},\n\n\t/* -------------------------------\n\t/* Public\n\t/* ------------------------------- */\n\n\thas: function(el) {\n\t\treturn el.eid && this._itemsById[el.eid] !== void 0;\n\t},\n\n\tgetItems: function() {\n\t\tvar i, j, el, ret = [];\n\t\tfor (i = 0; i < arguments.length; ++i) {\n\t\t\tel = arguments[i];\n\t\t\tif (el.length) {\n\t\t\t\tfor (j = 0; j < el.length; ++j) {\n\t\t\t\t\tret.push(this._get(el[j]));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tret.push(this._get(el));\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t},\n\n\tget: function(el) {\n\t\treturn this._get(el);\n\t},\n\n\tadd: function() {\n\t\tvar i, j, el;\n\t\tfor (i = 0; i < arguments.length; ++i) {\n\t\t\tel = arguments[i];\n\t\t\tif (el.length) {\n\t\t\t\tfor (j = 0; j < el.length; ++j) {\n\t\t\t\t\tthis._get(el[j]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._get(el);\n\t\t\t}\n\t\t}\n\t},\n\n\tremove: function() {\n\t\tvar i, j, el;\n\t\tfor (i = 0; i < arguments.length; ++i) {\n\t\t\tel = arguments[i];\n\t\t\tif (el.length) {\n\t\t\t\tfor (j = 0; j < el.length; ++j) {\n\t\t\t\t\tthis._remove(el[j]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._remove(el);\n\t\t\t}\n\t\t}\n\t},\n\n\t/* --------------------------------\n\t/* public\n\t/* -------------------------------- */\n\n\t/* public: single arg\n\t/* - - - - - - - - - - - - - - - - */\n\n\thasOffset: function(el) {\n\t\treturn this.has(el) ? this._itemsById[el.eid].hasOffset : (void 0);\n\t},\n\n\t/* public: capture\n\t/* - - - - - - - - - - - - - - - - */\n\n\tcapture: function() {\n\t\tthis._invoke(\"capture\", arguments);\n\t},\n\tcaptureAll: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].capture();\n\t\t}\n\t},\n\n\tclearCapture: function() {\n\t\tthis._invoke(\"clearCapture\", arguments);\n\t},\n\tclearAllCaptures: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].clearCapture();\n\t\t}\n\t},\n\n\t/* public: offset\n\t/* - - - - - - - - - - - - - - - - */\n\toffset: function(x, y) {\n\t\tthis._invoke(\"offset\", arguments, 2);\n\t},\n\toffsetAll: function(x, y) {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].offset(x, y);\n\t\t}\n\t},\n\n\tclearOffset: function() {\n\t\tthis._invoke(\"clearOffset\", arguments);\n\t},\n\tclearAllOffsets: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].clearOffset();\n\t\t}\n\t},\n\n\t/* public: transitions\n\t/* - - - - - - - - - - - - - - - - */\n\n\trunTransition: function(transition) {\n\t\tthis._invoke(\"runTransition\", arguments, 1);\n\t},\n\trunAllTransitions: function(transition) {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].runTransition(transition);\n\t\t}\n\t},\n\n\tclearTransition: function() {\n\t\tthis._invoke(\"clearTransition\", arguments);\n\t},\n\tclearAllTransitions: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].clearTransition();\n\t\t}\n\t},\n\n\tstopTransition: function() {\n\t\tthis._invoke(\"stopTransition\", arguments);\n\t},\n\tstopAllTransitions: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].stopTransition();\n\t\t}\n\t},\n\n\twhenTransitionEnds: function() {\n\t\tvar res = this._invoke(\"whenTransitionEnds\", arguments);\n\t\treturn res.length != 0 ?\n\t\t\tPromise.all(res) :\n\t\t\tPromise.resolve(null);\n\t},\n\twhenAllTransitionsEnd: function() {\n\t\treturn (this._items.length != 0) ? Promise.all(this._items.map(function(o) {\n\t\t\treturn o.whenTransitionEnds();\n\t\t})) : Promise.resolve(null);\n\t},\n\n\tpromise: function() {\n\t\treturn arguments.length == 0 ?\n\t\t\tthis.whenAllTransitionsEnd() :\n\t\t\tthis.whenTransitionEnds.call(this, arguments);\n\t},\n\n\t/* -------------------------------\n\t/* validation\n\t/* ------------------------------- */\n\n\tvalidate: function() {\n\t\tfor (var i = 0, ii = this._items.length; i < ii; i++) {\n\t\t\tthis._items[i].validate();\n\t\t}\n\t},\n}, {\n\titems: {\n\t\tget: function() {\n\t\t\treturn this._items;\n\t\t}\n\t}\n});\n\nmodule.exports = TransformHelper;\n",
    "/* -------------------------------\n * Imports\n * ------------------------------- */\n\n/** @type {module:underscore} */\nvar _ = require(\"underscore\");\n\n/** @type {module:utils/prefixedProperty} */\nvar prefixedProperty = require(\"utils/prefixedProperty\");\n/** @type {module:utils/prefixedStyleName} */\nvar prefixedStyleName = require(\"utils/prefixedStyleName\");\n/** @type {module:utils/prefixedEvent} */\nvar prefixedEvent = require(\"utils/prefixedEvent\");\n\n/** @type {String} */\nvar transitionEnd = prefixedEvent(\"transitionend\"); //require(\"utils/event/transitionEnd\");\n// /** @type {Function} */// var slice = Array.prototype.slice;\n\n// /** @type {module:utils/debug/traceElement} */\n// var traceElt = require(\"./debug/traceElement\");\n// var traceEltCache = {};\n// var log = function() {\n// \tvar logFn = \"log\";\n// \tvar args = slice.apply(arguments);\n// \tswitch(args[0]) {\n// \t\tcase \"error\":\n// \t\tcase \"warn\":\n// \t\tcase \"info\":\n// \t\t\tlogFn = args.shift();\n// \t\t\tbreak;\n// \t\tdefault:\n// \t\t\t// break;\n// \t\t\treturn;\n// \t}\n// \tvar el, txId;\n// \tif ((el = args[0]) && (txId = el.eid)) {\n// \t\targs[0] = traceEltCache[txId] || (traceEltCache[txId] = el);\n// \t}\n// \targs[0] = \"\\t\" + args[0];\n// \tconsole[logFn].apply(console, args);\n// };\n\n/* jshint -W079 */\n// var console = (function(target) {\n// \treturn Object.getOwnPropertyNames(target).reduce(function(proxy, prop) {\n// \t\tif ((typeof target[prop]) == \"function\") {\n// \t\t\tswitch (prop) {\n// \t\t\t\tcase \"error\":\n// \t\t\t\tcase \"warn\":\n// \t\t\t\tcase \"info\":\n// \t\t\t\t\tproxy[prop] = function () {\n// \t\t\t\t\t\tvar args = slice.apply(arguments);\n// \t\t\t\t\t\tif (typeof args[0] == \"string\") {\n// \t\t\t\t\t\t\targs[0] = prop + \"::\" + args[0];\n// \t\t\t\t\t\t}\n// \t\t\t\t\t\treturn target[prop].apply(target, args);\n// \t\t\t\t\t};\n// \t\t\t\t\tbreak;\n// \t\t\t\tcase \"log\":\n// \t\t\t\t\tproxy[prop] = function() {};\n// \t\t\t\t\tbreak;\n// \t\t\t\tdefault:\n// \t\t\t\t\tproxy[prop] = target[prop].bind(target);\n// \t\t\t\t\tbreak;\n// \t\t\t}\n// \t\t} else {\n// \t\t\tObject.defineProperty(proxy, prop, {\n// \t\t\t\tget: function() { return target[prop]; },\n// \t\t\t\tset: function(val) { target[prop] = val; }\n// \t\t\t});\n// \t\t}\n// \t\treturn proxy;\n// \t}, {});\n// })(window.console);\n/* jshint +W079 */\n\n/* -------------------------------\n/* Private static\n/* ------------------------------- */\n\nvar NO_TRANSITION = \"none 0s step-start 0s\";\n\n\n// var translateTemplate = function(o) {\n// \t// return \"translate(\" + o._renderedX + \"px, \" + o._renderedY + \"px)\";\n// \t// return \"translate3d(\" + o._renderedX + \"px, \" + o._renderedY + \"px, 0px)\";\n// };\n\nvar translateTemplate = (function() {\n\tvar fn = require(\"app/control/Globals\").TRANSLATE_TEMPLATE;\n\treturn function(o) {\n\t\treturn fn(o._renderedX, o._renderedY);\n\t};\n}());\n\nvar transitionTemplate = function(o) {\n\treturn o.property + \" \" + o.duration / 1000 + \"s \" + o.easing + \" \" + o.delay / 1000 + \"s\";\n};\n\nvar UNSET_TRANSITION = {\n\tname: \"unset\",\n\tclassName: \"tx-unset\",\n\tproperty: \"none\",\n\teasing: \"ease\",\n\tdelay: 0,\n\tduration: 0,\n\tcssText: \"unset\",\n};\n\n// var transitionTemplate = _.template(\"<%= property %> <% duration/1000 %>s <%= easing %> <% delay/1000 %>s\");\n// var NO_TRANSITION = \"all 0.001s step-start 0.001s\";\n\nvar propDefaults = {\n\t\"opacity\": \"1\",\n\t\"visibility\": \"visible\",\n\t\"transform\": \"matrix(1, 0, 0, 1, 0, 0)\",\n\t\"transformStyle\": \"\",\n\t\"transition\": \"\",\n\t// \"willChange\": \"\",\n\t// \"transitionDuration\": \"0s\",\n\t// \"transitionDelay\": \"0s\",\n\t// \"transitionProperty\": \"none\",\n\t// \"transitionTimingFunction\": \"ease\"\n};\nvar propKeys = Object.keys(propDefaults);\nvar propNames = propKeys.reduce(function(obj, propName) {\n\tobj[propName] = prefixedProperty(propName);\n\treturn obj;\n}, {});\n\n/** @type {module:utils/strings/camelToDashed} */\nvar camelToDashed = require(\"utils/strings/camelToDashed\");\nvar styleNames = propKeys.map(camelToDashed).reduce(function(obj, propName) {\n\tobj[propName] = prefixedStyleName(propName);\n\treturn obj;\n}, {});\n\nvar resolveAll = function(pp, result) {\n\tif (pp.length != 0) {\n\t\tpp.forEach(function(p, i, a) {\n\t\t\tp.resolve(result);\n\t\t\ta[i] = null;\n\t\t});\n\t\tpp.length = 0;\n\t}\n\treturn pp;\n};\n\nvar rejectAll = function(pp, reason) {\n\tif (pp.length != 0) {\n\t\tpp.forEach(function(p, i, a) {\n\t\t\tp.reject(reason);\n\t\t\ta[i] = null;\n\t\t});\n\t\tpp.length = 0;\n\t}\n\treturn pp;\n};\n\n/* -------------------------------\n * TransformItem\n * ------------------------------- */\n\n/**\n * @constructor\n */\nfunction TransformItem(el, id) {\n\t_.bindAll(this, \"_onTransitionEnd\");\n\n\tthis.el = el;\n\tthis.id = id;\n\tthis.el.eid = id;\n\tthis.el.addEventListener(transitionEnd, this._onTransitionEnd, false);\n\n\tthis._captureInvalid = false;\n\tthis._capturedChanged = false;\n\tthis._capturedX = null;\n\tthis._capturedY = null;\n\tthis._currCapture = {};\n\tthis._lastCapture = {};\n\n\tthis._hasOffset = false;\n\tthis._offsetInvalid = false;\n\tthis._offsetX = null;\n\tthis._offsetY = null;\n\n\tthis._renderedX = null;\n\tthis._renderedY = null;\n\n\tthis._hasTransition = false;\n\tthis._transitionInvalid = false;\n\tthis._transitionRunning = false;\n\tthis._transition = _.extend({}, UNSET_TRANSITION); //{};\n\n\tthis._promises = [];\n\tthis._pendingPromises = [];\n}\n\nTransformItem.prototype = Object.create({\n\n\t/* -------------------------------\n\t/* Public\n\t/* ------------------------------- */\n\n\t/* destroy\n\t/* - - - - - - - - - - - - - - - - */\n\tdestroy: function() {\n\t\t// NOTE: style property may have been modified; clearOffset(element) should\n\t\t// be called explicitly if clean up is required.\n\t\tthis.el.removeEventListener(transitionEnd, this._onTransitionEnd, false);\n\t\trejectAll(this._pendingPromises, this.el);\n\t\trejectAll(this._promises, this.el);\n\t\t// delete this.el.eid;\n\t},\n\n\t/* capture\n\t/* - - - - - - - - - - - - - - - - */\n\tcapture: function() {\n\t\t// console.log(\"tx[%s]::capture\", this.id);\n\t\tthis._validateCapture();\n\t\treturn this;\n\t},\n\n\tclearCapture: function() {\n\t\t// console.log(\"tx[%s]::clearCapture\", this.id);\n\t\t// this._hasOffset = false;\n\t\tthis._captureInvalid = true;\n\t\treturn this;\n\t},\n\n\t/* offset/clear\n\t/* - - - - - - - - - - - - - - - - */\n\toffset: function(x, y) {\n\t\t// console.log(\"tx[%s]::offset\", this.id);\n\n\t\tthis._hasOffset = true;\n\t\tthis._offsetInvalid = true;\n\t\tthis._offsetX = x || 0;\n\t\tthis._offsetY = y || 0;\n\t\t// if (this.immediate) this._validateOffset();\n\t\treturn this;\n\t},\n\n\tclearOffset: function() {\n\t\tif (this._hasOffset) {\n\t\t\t// console.log(\"tx[%s]::clearOffset\", this.id);\n\n\t\t\tthis._hasOffset = false;\n\t\t\tthis._offsetInvalid = true;\n\t\t\tthis._offsetX = null;\n\t\t\tthis._offsetY = null;\n\t\t\t// if (this.immediate) this._validateOffset();\n\t\t} else {\n\t\t\t// console.log(\"tx[%s]::clearOffset no offset to clear\", this.id);\n\t\t}\n\t\treturn this;\n\t},\n\n\t/* transitions\n\t/* - - - - - - - - - - - - - - - - */\n\trunTransition: function(transition) {\n\t\tif (!transition) { // || (transition.duration + transition.delay) == 0) {\n\t\t\treturn this.clearTransition();\n\t\t}\n\t\tvar lastValue = this._transitionValue;\n\t\tvar lastName = this._transition.name;\n\t\tthis._transition.property = styleNames[\"transform\"];\n\t\tthis._transition = _.extend(this._transition, transition);\n\t\tthis._transitionValue = transitionTemplate(this._transition);\n\n\t\tif (this._transitionInvalid) {\n\t\t\tconsole.warn(\"tx[%s]::runTransition set over (%s:'%s' => %s:'%s')\", this.id,\n\t\t\t\tlastName, lastValue, this._transition.name, this._transitionValue);\n\t\t}\n\n\t\tthis._hasTransition = true;\n\t\tthis._transitionInvalid = true;\n\t\t// if (this.immediate) this._validateTransition();\n\t\treturn this;\n\t},\n\n\tclearTransition: function() {\n\t\tthis._transition = _.extend(this._transition, UNSET_TRANSITION);\n\t\tthis._transitionValue = NO_TRANSITION;\n\n\t\tthis._hasTransition = false;\n\t\tthis._transitionInvalid = true;\n\t\t// if (this.immediate) this._validateTransition();\n\t\treturn this;\n\t},\n\n\tstopTransition: function() {\n\t\t// this._transition.name = \"[none]\";\n\t\t// this._transition.property = \"none\";\n\t\tthis._transition = _.extend(this._transition, UNSET_TRANSITION);\n\t\tthis._transitionValue = NO_TRANSITION;\n\n\t\tthis._hasTransition = false;\n\t\tthis._transitionInvalid = true;\n\t\t// if (this.immediate) this._validateTransition();\n\t\treturn this;\n\t},\n\n\twhenTransitionEnds: function() {\n\t\tvar d, p, pp;\n\t\tif (this._transitionInvalid || this._transitionRunning) {\n\t\t\td = {};\n\t\t\tp = new Promise(function(resolve, reject) {\n\t\t\t\td.resolve = resolve;\n\t\t\t\td.reject = reject;\n\t\t\t});\n\t\t\tpp = this._transitionInvalid ? this._pendingPromises : this._promises;\n\t\t\tpp.push(d);\n\t\t} else {\n\t\t\tp = Promise.resolve(this.el);\n\t\t}\n\t\treturn p;\n\t},\n\n\t/* validation\n\t/* - - - - - - - - - - - - - - - - */\n\tvalidate: function() {\n\t\t// this.el.removeEventListener(transitionEnd, this._onTransitionEnd, false);\n\t\tthis._ignoreEvent = true;\n\n\t\tif (this._captureInvalid) {\n\t\t\tvar lastX = (this._renderedX !== null ? this._renderedX : this._capturedX),\n\t\t\t\tlastY = (this._renderedY !== null ? this._renderedY : this._capturedY);\n\n\t\t\t// this._validateTransition();\n\t\t\tthis._validateCapture();\n\t\t\tthis._validateOffset();\n\n\t\t\tvar currX = (this._renderedX !== null ? this._renderedX : this._capturedX),\n\t\t\t\tcurrY = (this._renderedY !== null ? this._renderedY : this._capturedY);\n\n\t\t\tif (lastX === currX && lastY === currY) {\n\t\t\t\tthis._hasTransition && console.warn(\"tx[%s]::validate unchanged: last:[%i,%i] curr:[%i,%i]\", this.el.id || this.id, lastX, lastY, currX, currY);\n\t\t\t\t// console.info(\"tx[%s]::validate unchanged: last:[%f,%f] curr:[%f,%f] render:[%f,%f] captured[%f,%f]\", this.el.id || this.id, lastX, lastY, currX, currY, this._renderedX, this._renderedY, this._capturedX, this._capturedY);\n\t\t\t\tthis.clearTransition();\n\t\t\t\t// this._validateTransition();\n\t\t\t}\n\t\t\tthis._validateTransition();\n\t\t} else {\n\t\t\t// this._validateCapture();\n\t\t\tthis._validateTransition();\n\t\t\tthis._validateOffset();\n\t\t}\n\n\t\t// this.el.addEventListener(transitionEnd, this._onTransitionEnd, false);\n\t\tthis._ignoreEvent = false;\n\n\t\t// if (this._capturedChanged) {\n\t\t// \tconsole.error(\"tx[%s]::validate capture changed: [%f,%f]\", this.id, this._capturedX, this._capturedY);\n\t\t// }\n\t\tthis._capturedChanged = false;\n\t\treturn this;\n\t},\n\n\t/* -------------------------------\n\t/* Private\n\t/* ------------------------------- */\n\n\t_validateCapture: function() {\n\t\tif (!this._captureInvalid) {\n\t\t\treturn;\n\t\t}\n\t\t// var computed, capturedValues;\n\t\tvar transformValue = null;\n\n\t\tif (this._hasOffset && !this._offsetInvalid) {\n\t\t\t// this is an explicit call to capture() instead of a subcall from _validateOffset()\n\t\t\ttransformValue = this._getCSSProp(\"transform\");\n\t\t\tif (transformValue === \"\") {\n\t\t\t\tconsole.error(\"tx[%s]::_capture valid offset (%i,$i) but transformValue=\\\"\\\"\", this.id, this._offsetX, this._offsetY);\n\t\t\t}\n\t\t\tthis._removeCSSProp(\"transform\");\n\t\t}\n\n\t\t// NOTE: reusing object, all props will be overwritten\n\t\tthis._lastCapture = this._currCapture;\n\t\tthis._currCapture = this._getComputedCSSProps();\n\n\t\tif (this._currCapture.transform !== this._lastCapture.transform) {\n\t\t\tvar m, mm; //, ret = {};\n\t\t\tmm = this._currCapture.transform.match(/(matrix|matrix3d)\\(([^\\)]+)\\)/);\n\t\t\tif (mm) {\n\t\t\t\tm = mm[2].split(\",\");\n\t\t\t\tif (mm[1] === \"matrix\") {\n\t\t\t\t\tthis._capturedX = parseFloat(m[4]);\n\t\t\t\t\tthis._capturedY = parseFloat(m[5]);\n\t\t\t\t} else {\n\t\t\t\t\tthis._capturedX = parseFloat(m[12]);\n\t\t\t\t\tthis._capturedY = parseFloat(m[13]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._capturedX = 0;\n\t\t\t\tthis._capturedY = 0;\n\t\t\t}\n\t\t\tthis._capturedChanged = true;\n\t\t}\n\t\tif (transformValue !== null) {\n\t\t\tconsole.log(\"tx[%s]::_capture reapplying '%s'\", this.id, transformValue);\n\t\t\tthis._setCSSProp(\"transform\", transformValue);\n\t\t}\n\t\tthis._captureInvalid = false;\n\t},\n\n\t_validateOffset: function() {\n\t\tif (this._offsetInvalid) {\n\t\t\t// this._validateCapture();\n\t\t\tthis._offsetInvalid = false;\n\t\t\tif (this._hasOffset) {\n\t\t\t\tvar tx = this._offsetX + this._capturedX;\n\t\t\t\tvar ty = this._offsetY + this._capturedY;\n\t\t\t\tif (tx !== this._renderedX || ty !== this._renderedY) {\n\t\t\t\t\tthis._renderedX = tx;\n\t\t\t\t\tthis._renderedY = ty;\n\t\t\t\t\tthis._setCSSProp(\"transform\", translateTemplate(this));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._renderedX = null;\n\t\t\t\tthis._renderedY = null;\n\t\t\t\tthis._removeCSSProp(\"transform\");\n\t\t\t}\n\t\t}\n\t},\n\n\t_validateTransition: function() {\n\t\tif (this._transitionInvalid) {\n\t\t\t// this._validateCapture();\n\t\t\tthis._transitionInvalid = false;\n\n\t\t\t// save promises made while invalid\n\t\t\tvar reject = this._promises;\n\t\t\t// prepare _promises and push in new ones\n\t\t\tthis._promises = this._pendingPromises;\n\t\t\t// whatever still here is to be rejected. reuse array\n\t\t\tthis._pendingPromises = rejectAll(reject, this.el);\n\n\t\t\tthis._transitionRunning = this._hasTransition;\n\t\t\tthis._setCSSProp(\"transition\", this._transitionValue);\n\n\t\t\tif (!this._hasTransition) {\n\t\t\t\t// no transition, resolve now\n\t\t\t\tresolveAll(this._promises, this.el);\n\t\t\t}\n\t\t}\n\t},\n\n\t_onTransitionEnd: function(ev) {\n\t\tif (this._ignoreEvent) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._transitionRunning && (this.el === ev.target) &&\n\t\t\t(this._transition.property == ev.propertyName)) {\n\t\t\tthis._hasTransition = false;\n\t\t\tthis._transitionRunning = false;\n\t\t\tthis._removeCSSProp(\"transition\");\n\t\t\tresolveAll(this._promises, this.el);\n\t\t}\n\t},\n\n\t/* -------------------------------\n\t/* CSS\n\t/* ------------------------------- */\n\n\t_getCSSProp: function(prop) {\n\t\treturn this.el.style[propNames[prop]];\n\t\t// return this.el.style[prefixedProperty(prop)];\n\t\t// return this.el.style.getPropertyValue(styleNames[prop]);\n\t},\n\n\t_setCSSProp: function(prop, value) {\n\t\tif (prop === \"transition\" && value == NO_TRANSITION) {\n\t\t\tvalue = \"\";\n\t\t}\n\t\tif (value === null || value === void 0 || value === \"\") {\n\t\t\tthis._removeCSSProp(prop);\n\t\t} else {\n\t\t\tthis.el.style[propNames[prop]] = value;\n\t\t\t// this.el.style.setProperty(styleNames[prop], value);\n\t\t}\n\t},\n\n\t_removeCSSProp: function(prop) {\n\t\tthis.el.style[propNames[prop]] = \"\";\n\t\t// this.el.style.removeProperty(styleNames[prop]);\n\t},\n\n\t_getComputedCSSProps: function() {\n\t\tvar values = {};\n\t\tvar computed = window.getComputedStyle(this.el);\n\t\tfor (var p in propNames) {\n\t\t\tvalues[p] = computed[propNames[p]];\n\t\t}\n\t\treturn values;\n\t},\n}, {\n\ttransition: {\n\t\tget: function() {\n\t\t\treturn this._transition;\n\t\t}\n\t},\n\thasTransition: {\n\t\tget: function() {\n\t\t\treturn this._hasTransition;\n\t\t}\n\t},\n\tcapturedChanged: {\n\t\tget: function() {\n\t\t\treturn this._capturedChanged;\n\t\t}\n\t},\n\tcapturedX: {\n\t\tget: function() {\n\t\t\treturn this._capturedX;\n\t\t}\n\t},\n\tcapturedY: {\n\t\tget: function() {\n\t\t\treturn this._capturedY;\n\t\t}\n\t},\n\n\thasOffset: {\n\t\tget: function() {\n\t\t\treturn this._hasOffset;\n\t\t}\n\t},\n\toffsetX: {\n\t\tget: function() {\n\t\t\treturn this._offsetX;\n\t\t}\n\t},\n\toffsetY: {\n\t\tget: function() {\n\t\t\treturn this._offsetY;\n\t\t}\n\t},\n});\n\nmodule.exports = TransformItem;",
    "var PI2 = Math.PI * 2;\n\nvar setStyle = function(ctx, s) {\n\tif (typeof s != \"object\") return;\n\tfor (var p in s) {\n\t\tswitch (typeof ctx[p]) {\n\t\t\tcase \"undefined\":\n\t\t\t\tbreak;\n\t\t\tcase \"function\":\n\t\t\t\tif (Array.isArray(s[p])) ctx[p].apply(ctx, s[p]);\n\t\t\t\telse ctx[p].call(ctx, s[p]);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tctx[p] = s[p];\n\t\t}\n\t}\n};\n\nmodule.exports = {\n\tsetStyle: setStyle,\n\n\tvGuide: function(ctx, x, s) {\n\t\tctx.save();\n\t\tif (s) setStyle(ctx, s);\n\t\tctx.beginPath();\n\t\tctx.moveTo(x, ctx.canvas.offsetTop);\n\t\tctx.lineTo(x, ctx.canvas.offsetHeight);\n\t\tctx.stroke();\n\t\tctx.restore();\n\t},\n\n\tcrosshair: function(ctx, x, y, r, s) {\n\t\tctx.save();\n\t\tif (s) {\n\t\t\tsetStyle(ctx, s);\n\t\t}\n\t\t// if (s && s.style != \"vertical\") {\n\t\tctx.translate(x, y);\n\t\tctx.rotate(Math.PI / 4);\n\t\t// }\n\t\tctx.beginPath();\n\t\tctx.moveTo(0, -r);\n\t\tctx.lineTo(0, r);\n\t\tctx.moveTo(-r, 0);\n\t\tctx.lineTo(r, 0);\n\t\tctx.stroke();\n\t\tctx.restore();\n\t},\n\n\tcircle: function(ctx, x, y, r, s, solid) {\n\t\tctx.save();\n\t\tif (s) setStyle(ctx, s);\n\t\tctx.beginPath();\n\t\tctx.arc(x, y, r, 0, PI2);\n\t\tctx.closePath();\n\t\tif (solid) ctx.fill();\n\t\telse ctx.stroke();\n\t\tctx.restore();\n\t},\n\n\tsquare: function(ctx, x, y, r, s, solid) {\n\t\tr = Math.floor(r / 2) * 2;\n\t\tif (solid) r += 0.5;\n\t\tctx.save();\n\t\tif (s) setStyle(ctx, s);\n\t\tctx.beginPath();\n\t\tctx.rect(x - r, y - r, r * 2, r * 2);\n\t\tif (solid) ctx.fill();\n\t\telse ctx.stroke();\n\t\tctx.restore();\n\t},\n\n\tarrowhead: function(ctx, x, y, r, a, solid, s) {\n\t\tctx.save();\n\t\tif (s) {\n\t\t\tsetStyle(ctx, s);\n\t\t}\n\t\tif (r < 10) {\n\t\t\tctx.setLineDash([]);\n\t\t}\n\t\tctx.translate(x, y);\n\t\tctx.rotate(a); // - Math.PI * 0.5);\n\t\tctx.translate(r * 0.5, 0);\n\t\tctx.beginPath();\n\t\tctx.moveTo(0, 0);\n\t\t// ctx.lineTo(-r, r * Math.SQRT1_2);\n\t\t// ctx.lineTo(-r, -r * Math.SQRT1_2);\n\t\tctx.lineTo(-r * Math.SQRT2, r * Math.SQRT1_2);\n\t\tctx.arcTo(0, 0, -r * Math.SQRT2, -r * Math.SQRT1_2, r);\n\t\t// ctx.quadraticCurveTo(0, 0, -r * Math.SQRT2, -r * Math.SQRT1_2);\n\t\tctx.lineTo(0, 0);\n\t\tif (solid) ctx.fill();\n\t\telse ctx.stroke();\n\t\tctx.restore();\n\t}\n};",
    "/**\n * @module utils/canvas/calcArcHConnector\n */\n\nmodule.exports = function(x1, y1, r1, x2, y2, r2, ro) {\n\tvar qx = x2 > x1 ? 1 : -1;\n\tvar qy = y2 > y1 ? 1 : -1;\n\tvar dy = Math.abs(y2 - y1);\n\tvar dx = Math.abs(x2 - x1);\n\tvar rr = r1 + r2;\n\tvar tx1, tx2, c, tx, ty;\n\n\tif (dy < 1) {\n\t\t// points are aligned horizontally, no arcs needed\n\t\ttx1 = 0;\n\t\ttx2 = dx\n\t\t// return [x1, x2];\n\t}\n\n\tif (dy >= rr && dx >= rr) {\n\t\t// arcs fit horizontally:\n\t\t// second circle center is r1+r2, tangent intersect at x=r1\n\t\tc = rr;\n\t\ttx1 = r1;\n\t\ttx2 = r1;\n\t} else {\n\t\t// arcs overlap horizontally:\n\t\t// find second circle center\n\t\tc = Math.sqrt(dy * r2 * 2 + dy * r1 * 2 - dy * dy);\n\n\t\t// circles tangent point\n\t\ttx = (c * r1) / rr;\n\t\tty = (dy * r1) / rr;\n\n\t\tif (r1 < ty || c > dx) {\n\t\t\treturn;\n\t\t}\n\n\t\t// tangent perpendicular slope\n\t\tvar slope = (rr - dy) / c;\n\t\t// tangent intersections\n\t\ttx1 = tx - (ty * slope);\n\t\ttx2 = (dy * slope) + tx1;\n\n\t\t/*\n\t\t// circle centers\n\t\tvar ccx1, ccy1, ccx2, ccy2;\n\t\tccx1 = 0;\n\t\tccy1 = r1;\n\t\tccx2 = c;\n\t\tccy2 = dy - r2;\n\t\t// tangent perpendicular slope\n\t\tvar slope = (ccy1 - ccy2) / (ccx2 - ccx1);\n\t\tvar xSec = tx - (ty * slope);\n\t\t// tangent intersections\n\t\ttx1 = xSec;\n\t\ttx2 = (dy * slope) + xSec;\n\t\t*/\n\t}\n\n\t// offset arcTo's in x-axis\n\tif (ro > 0) {\n\t\tif (ro > 1) {\n\t\t\tro = Math.min(dx - rr, ro);\n\t\t} else {\n\t\t\tro *= dx - rr;\n\t\t}\n\t\ttx1 += ro;\n\t\ttx2 += ro;\n\t}\n\n\treturn [tx1 * qx + x1, tx2 * qx + x1, tx1, tx2];\n};\n\n/*\nvar drawArcConnector = function(ctx, x1, y1, x2, y2, r) {\n\tvar dx, dy, hx, hy, gx, gy;\n\n\thx = 0;\n\thy = 0;\n\tgx = (x1 + x2) / 2;\n\tgy = (y1 + y2) / 2;\n\tdx = Math.abs(x1 - gx);\n\tdy = Math.abs(y1 - gy);\n\n\tif (dx < r && dy < r) {\n\t\tr = Math.min(dx * Math.SQRT1_2, dy * Math.SQRT1_2);\n\t} else {\n\t\tif (dx < r) {\n\t\t\thy = Math.acos(dx / r) * r * 0.5;\n\t\t\tif (y1 > y2) hy *= -1;\n\t\t}\n\t\tif (dy < r) {\n\t\t\thx = Math.acos(dy / r) * r * 0.5;\n\t\t\tif (x1 > x2) hx *= -1;\n\t\t}\n\t}\n\tctx.arcTo(gx - hx, y1, gx + hx, y2, r);\n\tctx.arcTo(gx + hx, y2, x2, y2, r);\n};\n\nvar drawArcConnector2 = function(ctx, x1, y1, x2, y2, r) {\n\tvar dx, dy, hx, hy, cx1, cx2;\n\n\thx = 0;\n\thy = 0;\n\tdx = Math.abs(x2 - x1) / 2;\n\tdy = Math.abs(y1 - y2) / 2;\n\n\tif (dx < r && dy < r) {\n\t\tr = Math.min(dx * Math.SQRT1_2, dy * Math.SQRT1_2);\n\t} else {\n\t\tif (dx < r) {\n\t\t\thy = Math.acos(dx / r) * r;\n\t\t}\n\t\tif (dy < r) {\n\t\t\thx = Math.acos(dy / r) * r;\n\t\t}\n\t}\n\tcx1 = x1 + dx;\n\tcx2 = x2 - (dx - hx / 2);\n\tctx.arcTo(cx1, y1, cx2, y2, r);\n\tctx.arcTo(cx2, y2, x2, y2, r);\n};\n\nvar drawArcConnector1 = function(ctx, x1, y1, x2, y2, r) {\n\tvar dx, dy, cx;\n\n\tdx = Math.abs(x2 - x1) / 2;\n\tdy = Math.abs(y1 - y2) / 2;\n\tr = Math.min(r, dy * Math.SQRT1_2);\n\tif (x1 < x2) {\n\t\tcx = x1 + dx + r;\n\t} else {\n\t\tcx = x2 - dx - r;\n\t}\n\t// cx = (x2 + x1) / 2;\n\t// cx += x1 < x2 ? r : -r;\n\n\tctx.arcTo(cx, y1, cx, y2, r);\n\tctx.arcTo(cx, y2, x2, y2, r);\n};\n*/\n",
    "/* global HTMLElement, CSSStyleDeclaration */\n\n// var parseSize = require(\"./parseSize\");\n\nvar CSS_BOX_PROPS = [\n\t\"boxSizing\", \"position\", \"objectFit\"\n];\nvar CSS_EDGE_PROPS = [\n\t\"marginTop\", \"marginBottom\", \"marginLeft\", \"marginRight\",\n\t\"borderTopWidth\", \"borderBottomWidth\", \"borderLeftWidth\", \"borderRightWidth\",\n\t\"paddingTop\", \"paddingBottom\", \"paddingLeft\", \"paddingRight\",\n];\nvar CSS_POS_PROPS = [\"top\", \"bottom\", \"left\", \"right\"];\nvar CSS_SIZE_PROPS = [\"width\", \"height\", \"minWidth\", \"minHeight\", \"maxWidth\", \"maxHeight\"];\nvar CSS_ALL_PROPS = CSS_EDGE_PROPS.concat(CSS_SIZE_PROPS, CSS_POS_PROPS);\n\n// var COMPUTED_PROPS = [\n// \t\"clientLeft\", \"clientTop\", \"clientWidth\", \"clientHeight\",\n// \t\"offsetLeft\", \"offsetTop\", \"offsetWidth\", \"offsetHeight\"\n// ];\n// var o = _.pick(element, function(val) {\n// \treturn /^(offset|client)(Left|Top|Width|Height)/.test(val);\n// });\n\nvar cssDimensionRE = /^(-?[\\d\\.]+)(px|em|rem)$/;\n// var cssDimRe = /^([-\\.0-9]+)([rem]+)$/;\n\nmodule.exports = function(s, m, includeSizePos) {\n\tif (s instanceof HTMLElement) {\n\t\ts = getComputedStyle(s);\n\t}\n\tif (DEBUG) {\n\t\tif (!(s instanceof CSSStyleDeclaration)) {\n\t\t\tthrow new Error(\"Not a CSSStyleDeclaration nor HTMLElement\");\n\t\t}\n\t}\n\tvar v, p, i, ii, emPx, remPx;\n\tm || (m = {});\n\n\temPx = m.fontSize = parseFloat(s.fontSize);\n\n\tfor (i = 0, ii = CSS_BOX_PROPS.length; i < ii; i++) {\n\t\tp = CSS_BOX_PROPS[i];\n\t\tif (p in s) {\n\t\t\tm[p] = s[p];\n\t\t}\n\t}\n\tvar cssProps = includeSizePos ? CSS_EDGE_PROPS : CSS_ALL_PROPS;\n\tfor (i = 0, ii = cssProps.length; i < ii; i++) {\n\t\tp = cssProps[i];\n\t\tm[\"_\" + p] = s[p];\n\t\tif (s[p] && (v = cssDimensionRE.exec(s[p]))) {\n\t\t\tif (v[2] === \"px\") {\n\t\t\t\tm[p] = parseFloat(v[1]);\n\t\t\t} else if (v[2] === \"em\") {\n\t\t\t\tm[p] = parseFloat(v[1]) * emPx;\n\t\t\t} else if (v[2] === \"rem\") {\n\t\t\t\tremPx || (remPx = parseFloat(getComputedStyle(document.documentElement).fontSize));\n\t\t\t\tm[p] = parseFloat(v[1]) * remPx;\n\t\t\t} else {\n\t\t\t\tconsole.warn(\"Ignoring value\", p, v[1], v[2]);\n\t\t\t\tm[p] = null;\n\t\t\t}\n\t\t} // else {\n\t\t//\tconsole.warn(\"Ignoring unitless value\", p, v);\n\t\t//}\n\t}\n\treturn m;\n};\n",
    "/**\n * @param {number} i current iteration\n * @param {number} s start value\n * @param {number} d change in value\n * @param {number} t total iterations\n * @return {number}\n */\nvar linear = function(i, s, d, t) {\n\treturn d * i / t + s;\n};\n\nmodule.exports = linear;\n",
    "/* https://html.spec.whatwg.org/multipage/media.html#event-media-canplay\n */\nmodule.exports = [\n\t// networkState\n\t\"loadstart\",\n\t\"progress\",\n\t\"suspend\",\n\t\"abort\",\n\t\"error\",\n\t\"emptied\",\n\t\"stalled\",\n\t// readyState\n\t\"loadedmetadata\",\n\t\"loadeddata\",\n\t\"canplay\",\n\t\"canplaythrough\",\n\t\"playing\",\n\t\"waiting\",\n\t//\n\t\"seeking\", // seeking changed to true\n\t\"seeked\", // seeking changed to false\n\t\"ended\", // ended is true\n\t//\n\t\"durationchange\", // duration updated\n\t\"timeupdate\", // currentTime updated\n\t\"play\", // paused is false\n\t\"pause\", // paused is false\n\t\"paused\", // ??\n\t\"ratechange\",\n\t//\n\t\"resize\",\n\t\"volumechange\",\n];",
    "/**\n * @module app/view/component/GraphView\n */\n\n// /** @type {module:underscore} */\n// var _ = require(\"underscore\");\n\nmodule.exports = function(rect, dx, dy) {\n\tdy || (dy = dx);\n\tvar r = {\n\t\twidth: rect.width + dx * 2,\n\t\theight: rect.height + dy * 2\n\t};\n\tif (r.width >= 0) {\n\t\tr.left = rect.left - dx;\n\t\tr.right = r.left + r.width;\n\t\tr.x = r.left;\n\t} else {\n\t\tr.right = rect.right + dx;\n\t\tr.left = rect.right - r.width;\n\t\tr.y = r.right;\n\t}\n\tif (r.height >= 0) {\n\t\tr.top = rect.top - dy;\n\t\tr.bottom = r.top + r.height;\n\t\tr.y = r.top;\n\t} else {\n\t\tr.bottom = rect.bottom + dy;\n\t\tr.top = rect.bottom - r.height;\n\t\tr.y = r.bottom;\n\t}\n\n\treturn r;\n};\n",
    "/** @type {Array} lowercase prefixes */\nvar lcPrefixes = [\"\"].concat(require(\"./prefixes\"));\n\n/** @type {Array} capitalized prefixes */\nvar ucPrefixes = lcPrefixes.map(function(s) {\n\treturn (s === \"\") ? s : s.charAt(0).toUpperCase() + s.substr(1);\n});\n\n/** @type {Object} specific event solvers */\nvar _solvers = {};\n\n/** @type {Object} cached values */\nvar _cache = {};\n\n/**\n * @param {String} name Unprefixed event name\n * @param {?Object} obj Prefix test target\n * @param {?String} testProp Proxy property to test prefixes\n * @return {String|null}\n */\nvar _prefixedEvent = function(name, obj, testProp) {\n\tvar prefixes = /^[A-Z]/.test(name) ? ucPrefixes : lcPrefixes;\n\tobj || (obj = document);\n\tfor (var i = 0; i < prefixes.length; i++) {\n\t\tif (testProp) {\n\t\t\tif ((prefixes[i] + testProp) in obj) {\n\t\t\t\treturn prefixes[i] + name;\n\t\t\t}\n\t\t}\n\t\tif ((\"on\" + prefixes[i] + name) in obj) {\n\t\t\treturn prefixes[i] + name;\n\t\t}\n\t}\n\treturn null;\n};\n\n// transitionend\n_solvers[\"transitionend\"] = function() {\n\tvar prop, style = document.body.style,\n\t\tmap = {\n\t\t\t\"transition\": \"transitionend\",\n\t\t\t\"WebkitTransition\": \"webkitTransitionEnd\",\n\t\t\t\"MozTransition\": \"transitionend\",\n\t\t\t// \"msTransition\" : \"MSTransitionEnd\",\n\t\t\t\"OTransition\": \"oTransitionEnd\"\n\t\t};\n\tfor (prop in map) {\n\t\tif (prop in style) {\n\t\t\treturn map[prop];\n\t\t}\n\t}\n\treturn null;\n};\n\n/**\n * get the prefixed property\n * @param {String} property name\n * @param {Object} look-up object\n * @returns {String|null} prefixed\n */\nmodule.exports = function(evName) {\n\tif (!_cache.hasOwnProperty(evName)) {\n\t\t_cache[evName] = _solvers.hasOwnProperty(evName) ? _solvers[evName]() : _prefixedEvent.apply(null, arguments);\n\t\tif (_cache[evName] === null) {\n\t\t\tconsole.warn(\"Event '%s' not found\", evName);\n\t\t} else {\n\t\t\tconsole.log(\"Event '%s' found as '%s'\", evName, _cache[evName]);\n\t\t}\n\t}\n\treturn _cache[evName];\n\t// return _cache[evName] || (_cache[evName] = _solvers[evName]? _solvers[evName].call() : _prefixedProperty.apply(null, arguments));\n};\n\n/*\nvar defaultTest = function(name, obj) {\n\tvar prefixes = /^[A-Z]/.test(name)? ucPrefixes : lcPrefixes;\n\tfor (var i = 0; i < prefixes.length; i++) {\n\t\tif ((\"on\" + prefixes[i] + name) in obj) {\n\t\t\tconsole.log(\"Event '%s' found as '%s'\", name, prefixes[i] + name);\n\t\t\treturn prefixes[i] + name;\n\t\t}\n\t}\n\treturn null;\n};\n\nvar proxyTest = function(name, obj, testProp) {\n\tvar prefixes = /^[A-Z]/.test(name)? ucPrefixes : lcPrefixes;\n\tfor (var i = 0; i < prefixes.length; i++) {\n\t\tif ((prefixes[i] + testProp) in obj) {\n\t\t\tconsole.log(\"Event %s inferred as '%s' from property '%s'\", name, prefixes[i] + name, testProp);\n\t\t\treturn prefixes[i] + name;\n\t\t}\n\t}\n\treturn null;\n};\n*/\n",
    "/**\n/* @module utils/prefixedProperty\n/*/\n\n/** @type {module:utils/prefixes} */\nvar prefixes = require(\"./prefixes\");\n/** @type {Number} prefix count */\nvar _prefixNum = prefixes.length;\n/** @type {Array} cached values */\nvar _cache = {};\n\nvar _prefixedProperty = function(prop, obj) {\n\tvar prefixedProp, camelProp;\n\n\tif (prop in obj) {\n\t\tconsole.log(\"Property '%s' found unprefixed\", prop);\n\t\treturn prop;\n\t}\n\tcamelProp = prop[0].toUpperCase() + prop.slice(1);\n\tfor (var i = 0; i < _prefixNum; i++) {\n\t\tprefixedProp = prefixes[i] + camelProp;\n\t\tif (prefixedProp in obj) {\n\t\t\tconsole.log(\"Property '%s' found as '%s'\", prop, prefixedProp);\n\t\t\treturn prefixedProp;\n\t\t}\n\t}\n\tconsole.error(\"Property '%s' not found\", prop);\n\treturn null;\n};\n\n/**\n * get the prefixed property\n * @param {String} property name\n * @param {Object} look-up object\n * @returns {String|null} prefixed\n */\nmodule.exports = function(prop, obj) {\n\treturn _cache[prop] || (_cache[prop] = _prefixedProperty(prop, obj || document.body.style));\n};\n",
    "/**\n/* @module utils/prefixedStyleName\n/*/\n\n/** @type {module:utils/prefixes} */\nvar prefixes = require(\"./prefixes\"); //.map(function(prefix) { return \"-\" + prefix + \"-\"; });\n/** @type {Number} prefix count */\nvar _prefixNum = prefixes.length;\n/** @type {Array} cached values */\nvar _cache = {};\n\nvar _prefixedStyleName = function(style, styleObj) {\n\tvar prefixedStyle;\n\n\tif (style in styleObj) {\n\t\tconsole.log(\"CSS style '%s' found unprefixed\", style);\n\t\treturn style;\n\t}\n\tfor (var i = 0; i < _prefixNum; i++) {\n\t\tprefixedStyle = \"-\" + prefixes[i] + \"-\" + style;\n\t\t// prefixedStyle = prefixes[i] + style;\n\t\tif (prefixedStyle in styleObj) {\n\t\t\tconsole.log(\"CSS style '%s' found as '%s'\", style, prefixedStyle);\n\t\t\treturn prefixedStyle;\n\t\t}\n\t}\n\tconsole.warn(\"CSS style '%s' not found\", style);\n\treturn null;\n};\n\n/**\n * get the prefixed style name\n * @param {String} style name\n * @param {Object} look-up style object\n * @returns {String|Undefined} prefixed\n */\nmodule.exports = function(style, styleObj) {\n\t// return _cache[style] || (_cache[style] = _prefixedStyleName_reverse(style, styleObj || document.body.style));\n\treturn _cache[style] || (_cache[style] = _prefixedStyleName(style, styleObj || document.body.style));\n};\n\n// /** @type {module:utils/strings/camelToDashed} */\n// var camelToDashed = require(\"./strings/camelToDashed\");\n// /** @type {module:utils/prefixedProperty} */\n// var prefixedProperty = require(\"./prefixedProperty\");\n// /** @type {module:utils/strings/dashedToCamel} */\n// var dashedToCamel = require(\"./strings/dashedToCamel\");\n//\n// var _prefixedStyleName_reverse = function (style, styleObj) {\n// \tvar camelProp, prefixedProp;\n// \tcamelProp = dashedToCamel(style);\n// \tprefixedProp = prefixedProperty(camelProp, styleObj);\n// \treturn prefixedProp? (camelProp === prefixedProp? \"\" : \"-\") + camelToDashed(prefixedProp) : null;\n// };\n",
    "module.exports = [\"webkit\", \"moz\", \"ms\", \"o\"];\n",
    "/* jshint ignore:start */\n/*\nTaken from:\nhttps://github.com/webcomponents/webcomponentsjs/blob/master/src/MutationObserver/MutationObserver.js\n*/\n/*\n * @license\n * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\nvar setImmediate;\n\n// As much as we would like to use the native implementation, IE\n// (all versions) suffers a rather annoying bug where it will drop or defer\n// callbacks when heavy DOM operations are being performed concurrently.\n//\n// For a thorough discussion on this, see:\n// http://codeforhire.com/2013/09/21/setimmediate-and-messagechannel-broken-on-internet-explorer-10/\nif (/Trident|Edge/.test(navigator.userAgent)) {\n\t// Sadly, this bug also affects postMessage and MessageQueues.\n\t//\n\t// We would like to use the onreadystatechange hack for IE <= 10, but it is\n\t// dangerous in the polyfilled environment due to requiring that the\n\t// observed script element be in the document.\n\tsetImmediate = setTimeout;\n\n\t// If some other browser ever implements it, let's prefer their native\n\t// implementation:\n} else if (window.setImmediate) {\n\tsetImmediate = window.setImmediate;\n\n\t// Otherwise, we fall back to postMessage as a means of emulating the next\n\t// task semantics of setImmediate.\n} else {\n\tvar setImmediateQueue = [];\n\tvar sentinel = String(Math.random());\n\twindow.addEventListener(\"message\", function(e) {\n\t\tif (e.data === sentinel) {\n\t\t\tvar queue = setImmediateQueue;\n\t\t\tsetImmediateQueue = [];\n\t\t\tqueue.forEach(function(func) {\n\t\t\t\tfunc();\n\t\t\t});\n\t\t}\n\t});\n\tsetImmediate = function(func) {\n\t\tsetImmediateQueue.push(func);\n\t\twindow.postMessage(sentinel, \"*\");\n\t};\n}\n\nmodule.exports = setImmediate;\n/* jshint ignore:end */\n",
    "module.exports = function(str) {\n\treturn str.replace(/[A-Z]/g, function($0) {\n\t\treturn \"-\" + $0.toLowerCase();\n\t});\n};\n",
    "module.exports = function(s) {\n\treturn s.replace(/<[^>]+>/g, \"\");\n};\n",
    "/** @type {module:hammerjs} */\nvar Hammer = require(\"hammerjs\");\n\n// /**\n//  * get a usable string, used as event postfix\n//  * @param {Const} state\n//  * @returns {String} state\n//  */\n// function stateStr(state) {\n// \tif (state & Hammer.STATE_CANCELLED) {\n// \t\treturn \"cancel\";\n// \t} else if (state & Hammer.STATE_ENDED) {\n// \t\treturn \"end\";\n// \t} else if (state & Hammer.STATE_CHANGED) {\n// \t\treturn \"move\";\n// \t} else if (state & Hammer.STATE_BEGAN) {\n// \t\treturn \"start\";\n// \t}\n// \treturn \"\";\n// }\n\n/**\n * direction cons to string\n * @param {Const} direction\n * @returns {String}\n */\nfunction dirStr(direction) {\n\tif (direction == Hammer.DIRECTION_DOWN) {\n\t\treturn \"down\";\n\t} else if (direction == Hammer.DIRECTION_UP) {\n\t\treturn \"up\";\n\t} else if (direction == Hammer.DIRECTION_LEFT) {\n\t\treturn \"left\";\n\t} else if (direction == Hammer.DIRECTION_RIGHT) {\n\t\treturn \"right\";\n\t}\n\treturn \"\";\n}\n\n///**\n// * Pan\n// * Recognized when the pointer is down and moved in the allowed direction.\n// * @constructor\n// * @extends AttrRecognizer\n// */\n//function PanRecognizer() {\n//\tHammer.AttrRecognizer.apply(this, arguments);\n//\n//\tthis.pX = null;\n//\tthis.pY = null;\n//}\n//\n//inherit(PanRecognizer, Hammer.AttrRecognizer, {\n//\t/**\n//\t/* @namespace\n//\t/* @memberof PanRecognizer\n//\t/*/\n//\tdefaults: {\n//\t\tevent: \"pan\",\n//\t\tthreshold: 10,\n//\t\tpointers: 1,\n//\t\tdirection: DIRECTION_ALL\n//\t},\n//\n//\tgetTouchAction: function() {\n//\t\tvar direction = this.options.direction;\n//\t\tvar actions = [];\n//\t\tif (direction & DIRECTION_HORIZONTAL) {\n//\t\t\tactions.push(TOUCH_ACTION_PAN_Y);\n//\t\t}\n//\t\tif (direction & DIRECTION_VERTICAL) {\n//\t\t\tactions.push(TOUCH_ACTION_PAN_X);\n//\t\t}\n//\t\treturn actions;\n//\t},\n//\n//\tdirectionTest: function(input) {\n//\t\tvar options = this.options;\n//\t\tvar hasMoved = true;\n//\t\tvar distance = input.distance;\n//\t\tvar direction = input.direction;\n//\t\tvar x = input.deltaX;\n//\t\tvar y = input.deltaY;\n//\n//\t\t// lock to axis?\n//\t\tif (!(direction & options.direction)) {\n//\t\t\tif (options.direction & DIRECTION_HORIZONTAL) {\n//\t\t\t\tdirection = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\n//\t\t\t\thasMoved = x != this.pX;\n//\t\t\t\tdistance = Math.abs(input.deltaX);\n//\t\t\t} else {\n//\t\t\t\tdirection = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\n//\t\t\t\thasMoved = y != this.pY;\n//\t\t\t\tdistance = Math.abs(input.deltaY);\n//\t\t\t}\n//\t\t}\n//\t\tinput.direction = direction;\n//\t\treturn hasMoved && distance > options.threshold && direction & options.direction;\n//\t},\n//\n//\tattrTest: function(input) {\n//\t\treturn AttrRecognizer.prototype.attrTest.call(this, input) &&\n//\t\t\t(this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\n//\t},\n//\n//\temit: function(input) {\n//\t\tthis.pX = input.deltaX;\n//\t\tthis.pY = input.deltaY;\n//\n//\t\tvar direction = dirStr(input.direction);\n//\t\tif (direction) {\n//\t\t\tthis.manager.emit(this.options.event + direction, input);\n//\t\t}\n//\n//\t\tthis._super.emit.call(this, input);\n//\t}\n//});\n\n/**\n * SmoothPan\n * @constructor\n * @extends Hammer.Pan\n */\nfunction SmoothPan() {\n\tvar ret = Hammer.Pan.apply(this, arguments);\n\tthis.thresholdOffsetX = null;\n\tthis.thresholdOffsetY = null;\n\tthis.thresholdOffset = null;\n\treturn ret;\n}\n\nHammer.inherit(SmoothPan, Hammer.Pan, {\n\temit: function(input) {\n\t\t// Inheritance breaks, so this code is taken from PanRecognizer.emit\n\t\t//\tthis._super.emit.call(this, input); // Triggers infinite recursion\n\t\t//\tHammer.Pan.prototype.emit.apply(this, arguments); // This breaks too\n\n\t\tvar threshold = this.options.threshold;\n\t\tvar direction = input.direction;\n\n\t\tif (this.state == Hammer.STATE_BEGAN) {\n\t\t\tthis.thresholdOffsetX = (direction & Hammer.DIRECTION_HORIZONTAL) ? ((direction & Hammer.DIRECTION_LEFT) ? threshold : -threshold) : 0;\n\t\t\tthis.thresholdOffsetY = (direction & Hammer.DIRECTION_VERTICAL) ? ((direction & Hammer.DIRECTION_UP) ? threshold : -threshold) : 0;\n\t\t\t// this.thresholdOffset = (direction & Hammer.DIRECTION_HORIZONTAL)? input.thresholdOffsetX : input.thresholdOffsetY;\n\t\t\t// console.log(\"RECOGNIZER STATE\", dirStr(direction), stateStr(this.state), this.thresholdOffsetX);\n\t\t}\n\t\tinput.thresholdOffsetX = this.thresholdOffsetX;\n\t\tinput.thresholdOffsetY = this.thresholdOffsetY;\n\t\tinput.thresholdDeltaX = input.deltaX + this.thresholdOffsetX;\n\t\tinput.thresholdDeltaY = input.deltaY + this.thresholdOffsetY;\n\n\t\tthis.pX = input.deltaX;\n\t\tthis.pY = input.deltaY;\n\n\t\tdirection = dirStr(direction);\n\t\tif (direction) {\n\t\t\tthis.manager.emit(this.options.event + direction, input);\n\t\t}\n\t\treturn Hammer.Recognizer.prototype.emit.apply(this, arguments);\n\t}\n});\n\nmodule.exports = SmoothPan;\n",
    "module.exports={\n\t\"units\": {\n\t\t\"hu_px\": \"20\",\n\t\t\"vu_px\": \"12\"\n\t},\n\t\"transitions\": {\n\t\t\"min_delay_ms\": \"34\",\n\t\t\"delay_interval_ms\": \"134\",\n\t\t\"duration_ms\": \"400\",\n\t\t\"ease\": \"ease\"\n\t},\n\t\"breakpoints\": {\n\t\t\"mobile\": \"'not screen and (min-width: 704px), not screen and (min-height: 540px)'\",\n\t\t\"desktop-small\": \"'only screen and (min-width: 1024px) and (min-height: 540px)'\",\n\t\t\"desktop-medium\": \"'only screen and (min-width: 1224px) and (min-height: 704px)'\",\n\t\t\"desktop-large\": \"'only screen and (min-width: 1824px) and (min-height: 1024px)'\",\n\t\t\"unsupported\": \"'not screen and (min-width: 704px)'\"\n\t},\n\t\"default_colors\": {\n\t\t\"color\": \"hsl(47, 5%, 15%)\",\n\t\t\"background-color\": \"hsl(47, 5%, 95%)\",\n\t\t\"--link-color\": \"hsl(10, 80%, 50%)\"\n\t},\n\t\"temp\": {\n\t\t\"collapse_offset\": \"360\"\n\t},\n\t\"_debug_mq\": {\n\t\t\"unquoted\": \"only screen and (min-width: 1824px)\",\n\t\t\"unquoted_neg\": \"not screen and (min-width: 704px)\",\n\t\t\"quoted_combined\": \"'not screen and (min-width: 704px), not screen and (min-height: 540px)'\",\n\t\t\"array\": [\n\t\t\t\"only screen and (min-width: 704px)\",\n\t\t\t\"not screen and (min-width: 704px)\",\n\t\t\t\"not screen and (min-height: 540px)\"\n\t\t]\n\t},\n\t\"_debug\": {\n\t\t\"--alt-background-color\": \"unset\"\n\t}\n}\n"
  ]
}