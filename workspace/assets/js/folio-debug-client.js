(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// shim for using process in browser

var process = module.exports = {};
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = setTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    clearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        setTimeout(drainQueue, 0);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],2:[function(require,module,exports){
'use strict';

exports.__esModule = true;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

// istanbul ignore next

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }

var _handlebarsBase = require('./handlebars/base');

var base = _interopRequireWildcard(_handlebarsBase);

// Each of these augment the Handlebars object. No need to setup here.
// (This is done to easily share code between commonjs and browse envs)

var _handlebarsSafeString = require('./handlebars/safe-string');

var _handlebarsSafeString2 = _interopRequireDefault(_handlebarsSafeString);

var _handlebarsException = require('./handlebars/exception');

var _handlebarsException2 = _interopRequireDefault(_handlebarsException);

var _handlebarsUtils = require('./handlebars/utils');

var Utils = _interopRequireWildcard(_handlebarsUtils);

var _handlebarsRuntime = require('./handlebars/runtime');

var runtime = _interopRequireWildcard(_handlebarsRuntime);

var _handlebarsNoConflict = require('./handlebars/no-conflict');

var _handlebarsNoConflict2 = _interopRequireDefault(_handlebarsNoConflict);

// For compatibility and usage outside of module systems, make the Handlebars object a namespace
function create() {
  var hb = new base.HandlebarsEnvironment();

  Utils.extend(hb, base);
  hb.SafeString = _handlebarsSafeString2['default'];
  hb.Exception = _handlebarsException2['default'];
  hb.Utils = Utils;
  hb.escapeExpression = Utils.escapeExpression;

  hb.VM = runtime;
  hb.template = function (spec) {
    return runtime.template(spec, hb);
  };

  return hb;
}

var inst = create();
inst.create = create;

_handlebarsNoConflict2['default'](inst);

inst['default'] = inst;

exports['default'] = inst;
module.exports = exports['default'];


},{"./handlebars/base":3,"./handlebars/exception":6,"./handlebars/no-conflict":16,"./handlebars/runtime":17,"./handlebars/safe-string":18,"./handlebars/utils":19}],3:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.HandlebarsEnvironment = HandlebarsEnvironment;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _utils = require('./utils');

var _exception = require('./exception');

var _exception2 = _interopRequireDefault(_exception);

var _helpers = require('./helpers');

var _decorators = require('./decorators');

var _logger = require('./logger');

var _logger2 = _interopRequireDefault(_logger);

var VERSION = '4.0.5';
exports.VERSION = VERSION;
var COMPILER_REVISION = 7;

exports.COMPILER_REVISION = COMPILER_REVISION;
var REVISION_CHANGES = {
  1: '<= 1.0.rc.2', // 1.0.rc.2 is actually rev2 but doesn't report it
  2: '== 1.0.0-rc.3',
  3: '== 1.0.0-rc.4',
  4: '== 1.x.x',
  5: '== 2.0.0-alpha.x',
  6: '>= 2.0.0-beta.1',
  7: '>= 4.0.0'
};

exports.REVISION_CHANGES = REVISION_CHANGES;
var objectType = '[object Object]';

function HandlebarsEnvironment(helpers, partials, decorators) {
  this.helpers = helpers || {};
  this.partials = partials || {};
  this.decorators = decorators || {};

  _helpers.registerDefaultHelpers(this);
  _decorators.registerDefaultDecorators(this);
}

HandlebarsEnvironment.prototype = {
  constructor: HandlebarsEnvironment,

  logger: _logger2['default'],
  log: _logger2['default'].log,

  registerHelper: function registerHelper(name, fn) {
    if (_utils.toString.call(name) === objectType) {
      if (fn) {
        throw new _exception2['default']('Arg not supported with multiple helpers');
      }
      _utils.extend(this.helpers, name);
    } else {
      this.helpers[name] = fn;
    }
  },
  unregisterHelper: function unregisterHelper(name) {
    delete this.helpers[name];
  },

  registerPartial: function registerPartial(name, partial) {
    if (_utils.toString.call(name) === objectType) {
      _utils.extend(this.partials, name);
    } else {
      if (typeof partial === 'undefined') {
        throw new _exception2['default']('Attempting to register a partial called "' + name + '" as undefined');
      }
      this.partials[name] = partial;
    }
  },
  unregisterPartial: function unregisterPartial(name) {
    delete this.partials[name];
  },

  registerDecorator: function registerDecorator(name, fn) {
    if (_utils.toString.call(name) === objectType) {
      if (fn) {
        throw new _exception2['default']('Arg not supported with multiple decorators');
      }
      _utils.extend(this.decorators, name);
    } else {
      this.decorators[name] = fn;
    }
  },
  unregisterDecorator: function unregisterDecorator(name) {
    delete this.decorators[name];
  }
};

var log = _logger2['default'].log;

exports.log = log;
exports.createFrame = _utils.createFrame;
exports.logger = _logger2['default'];


},{"./decorators":4,"./exception":6,"./helpers":7,"./logger":15,"./utils":19}],4:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.registerDefaultDecorators = registerDefaultDecorators;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _decoratorsInline = require('./decorators/inline');

var _decoratorsInline2 = _interopRequireDefault(_decoratorsInline);

function registerDefaultDecorators(instance) {
  _decoratorsInline2['default'](instance);
}


},{"./decorators/inline":5}],5:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerDecorator('inline', function (fn, props, container, options) {
    var ret = fn;
    if (!props.partials) {
      props.partials = {};
      ret = function (context, options) {
        // Create a new partials stack frame prior to exec.
        var original = container.partials;
        container.partials = _utils.extend({}, original, props.partials);
        var ret = fn(context, options);
        container.partials = original;
        return ret;
      };
    }

    props.partials[options.args[0]] = options.fn;

    return ret;
  });
};

module.exports = exports['default'];


},{"../utils":19}],6:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var errorProps = ['description', 'fileName', 'lineNumber', 'message', 'name', 'number', 'stack'];

function Exception(message, node) {
  var loc = node && node.loc,
      line = undefined,
      column = undefined;
  if (loc) {
    line = loc.start.line;
    column = loc.start.column;

    message += ' - ' + line + ':' + column;
  }

  var tmp = Error.prototype.constructor.call(this, message);

  // Unfortunately errors are not enumerable in Chrome (at least), so `for prop in tmp` doesn't work.
  for (var idx = 0; idx < errorProps.length; idx++) {
    this[errorProps[idx]] = tmp[errorProps[idx]];
  }

  /* istanbul ignore else */
  if (Error.captureStackTrace) {
    Error.captureStackTrace(this, Exception);
  }

  if (loc) {
    this.lineNumber = line;
    this.column = column;
  }
}

Exception.prototype = new Error();

exports['default'] = Exception;
module.exports = exports['default'];


},{}],7:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.registerDefaultHelpers = registerDefaultHelpers;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _helpersBlockHelperMissing = require('./helpers/block-helper-missing');

var _helpersBlockHelperMissing2 = _interopRequireDefault(_helpersBlockHelperMissing);

var _helpersEach = require('./helpers/each');

var _helpersEach2 = _interopRequireDefault(_helpersEach);

var _helpersHelperMissing = require('./helpers/helper-missing');

var _helpersHelperMissing2 = _interopRequireDefault(_helpersHelperMissing);

var _helpersIf = require('./helpers/if');

var _helpersIf2 = _interopRequireDefault(_helpersIf);

var _helpersLog = require('./helpers/log');

var _helpersLog2 = _interopRequireDefault(_helpersLog);

var _helpersLookup = require('./helpers/lookup');

var _helpersLookup2 = _interopRequireDefault(_helpersLookup);

var _helpersWith = require('./helpers/with');

var _helpersWith2 = _interopRequireDefault(_helpersWith);

function registerDefaultHelpers(instance) {
  _helpersBlockHelperMissing2['default'](instance);
  _helpersEach2['default'](instance);
  _helpersHelperMissing2['default'](instance);
  _helpersIf2['default'](instance);
  _helpersLog2['default'](instance);
  _helpersLookup2['default'](instance);
  _helpersWith2['default'](instance);
}


},{"./helpers/block-helper-missing":8,"./helpers/each":9,"./helpers/helper-missing":10,"./helpers/if":11,"./helpers/log":12,"./helpers/lookup":13,"./helpers/with":14}],8:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerHelper('blockHelperMissing', function (context, options) {
    var inverse = options.inverse,
        fn = options.fn;

    if (context === true) {
      return fn(this);
    } else if (context === false || context == null) {
      return inverse(this);
    } else if (_utils.isArray(context)) {
      if (context.length > 0) {
        if (options.ids) {
          options.ids = [options.name];
        }

        return instance.helpers.each(context, options);
      } else {
        return inverse(this);
      }
    } else {
      if (options.data && options.ids) {
        var data = _utils.createFrame(options.data);
        data.contextPath = _utils.appendContextPath(options.data.contextPath, options.name);
        options = { data: data };
      }

      return fn(context, options);
    }
  });
};

module.exports = exports['default'];


},{"../utils":19}],9:[function(require,module,exports){
'use strict';

exports.__esModule = true;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _utils = require('../utils');

var _exception = require('../exception');

var _exception2 = _interopRequireDefault(_exception);

exports['default'] = function (instance) {
  instance.registerHelper('each', function (context, options) {
    if (!options) {
      throw new _exception2['default']('Must pass iterator to #each');
    }

    var fn = options.fn,
        inverse = options.inverse,
        i = 0,
        ret = '',
        data = undefined,
        contextPath = undefined;

    if (options.data && options.ids) {
      contextPath = _utils.appendContextPath(options.data.contextPath, options.ids[0]) + '.';
    }

    if (_utils.isFunction(context)) {
      context = context.call(this);
    }

    if (options.data) {
      data = _utils.createFrame(options.data);
    }

    function execIteration(field, index, last) {
      if (data) {
        data.key = field;
        data.index = index;
        data.first = index === 0;
        data.last = !!last;

        if (contextPath) {
          data.contextPath = contextPath + field;
        }
      }

      ret = ret + fn(context[field], {
        data: data,
        blockParams: _utils.blockParams([context[field], field], [contextPath + field, null])
      });
    }

    if (context && typeof context === 'object') {
      if (_utils.isArray(context)) {
        for (var j = context.length; i < j; i++) {
          if (i in context) {
            execIteration(i, i, i === context.length - 1);
          }
        }
      } else {
        var priorKey = undefined;

        for (var key in context) {
          if (context.hasOwnProperty(key)) {
            // We're running the iterations one step out of sync so we can detect
            // the last iteration without have to scan the object twice and create
            // an itermediate keys array.
            if (priorKey !== undefined) {
              execIteration(priorKey, i - 1);
            }
            priorKey = key;
            i++;
          }
        }
        if (priorKey !== undefined) {
          execIteration(priorKey, i - 1, true);
        }
      }
    }

    if (i === 0) {
      ret = inverse(this);
    }

    return ret;
  });
};

module.exports = exports['default'];


},{"../exception":6,"../utils":19}],10:[function(require,module,exports){
'use strict';

exports.__esModule = true;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _exception = require('../exception');

var _exception2 = _interopRequireDefault(_exception);

exports['default'] = function (instance) {
  instance.registerHelper('helperMissing', function () /* [args, ]options */{
    if (arguments.length === 1) {
      // A missing field in a {{foo}} construct.
      return undefined;
    } else {
      // Someone is actually trying to call something, blow up.
      throw new _exception2['default']('Missing helper: "' + arguments[arguments.length - 1].name + '"');
    }
  });
};

module.exports = exports['default'];


},{"../exception":6}],11:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerHelper('if', function (conditional, options) {
    if (_utils.isFunction(conditional)) {
      conditional = conditional.call(this);
    }

    // Default behavior is to render the positive path if the value is truthy and not empty.
    // The `includeZero` option may be set to treat the condtional as purely not empty based on the
    // behavior of isEmpty. Effectively this determines if 0 is handled by the positive path or negative.
    if (!options.hash.includeZero && !conditional || _utils.isEmpty(conditional)) {
      return options.inverse(this);
    } else {
      return options.fn(this);
    }
  });

  instance.registerHelper('unless', function (conditional, options) {
    return instance.helpers['if'].call(this, conditional, { fn: options.inverse, inverse: options.fn, hash: options.hash });
  });
};

module.exports = exports['default'];


},{"../utils":19}],12:[function(require,module,exports){
'use strict';

exports.__esModule = true;

exports['default'] = function (instance) {
  instance.registerHelper('log', function () /* message, options */{
    var args = [undefined],
        options = arguments[arguments.length - 1];
    for (var i = 0; i < arguments.length - 1; i++) {
      args.push(arguments[i]);
    }

    var level = 1;
    if (options.hash.level != null) {
      level = options.hash.level;
    } else if (options.data && options.data.level != null) {
      level = options.data.level;
    }
    args[0] = level;

    instance.log.apply(instance, args);
  });
};

module.exports = exports['default'];


},{}],13:[function(require,module,exports){
'use strict';

exports.__esModule = true;

exports['default'] = function (instance) {
  instance.registerHelper('lookup', function (obj, field) {
    return obj && obj[field];
  });
};

module.exports = exports['default'];


},{}],14:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerHelper('with', function (context, options) {
    if (_utils.isFunction(context)) {
      context = context.call(this);
    }

    var fn = options.fn;

    if (!_utils.isEmpty(context)) {
      var data = options.data;
      if (options.data && options.ids) {
        data = _utils.createFrame(options.data);
        data.contextPath = _utils.appendContextPath(options.data.contextPath, options.ids[0]);
      }

      return fn(context, {
        data: data,
        blockParams: _utils.blockParams([context], [data && data.contextPath])
      });
    } else {
      return options.inverse(this);
    }
  });
};

module.exports = exports['default'];


},{"../utils":19}],15:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('./utils');

var logger = {
  methodMap: ['debug', 'info', 'warn', 'error'],
  level: 'info',

  // Maps a given level value to the `methodMap` indexes above.
  lookupLevel: function lookupLevel(level) {
    if (typeof level === 'string') {
      var levelMap = _utils.indexOf(logger.methodMap, level.toLowerCase());
      if (levelMap >= 0) {
        level = levelMap;
      } else {
        level = parseInt(level, 10);
      }
    }

    return level;
  },

  // Can be overridden in the host environment
  log: function log(level) {
    level = logger.lookupLevel(level);

    if (typeof console !== 'undefined' && logger.lookupLevel(logger.level) <= level) {
      var method = logger.methodMap[level];
      if (!console[method]) {
        // eslint-disable-line no-console
        method = 'log';
      }

      for (var _len = arguments.length, message = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        message[_key - 1] = arguments[_key];
      }

      console[method].apply(console, message); // eslint-disable-line no-console
    }
  }
};

exports['default'] = logger;
module.exports = exports['default'];


},{"./utils":19}],16:[function(require,module,exports){
(function (global){
/* global window */
'use strict';

exports.__esModule = true;

exports['default'] = function (Handlebars) {
  /* istanbul ignore next */
  var root = typeof global !== 'undefined' ? global : window,
      $Handlebars = root.Handlebars;
  /* istanbul ignore next */
  Handlebars.noConflict = function () {
    if (root.Handlebars === Handlebars) {
      root.Handlebars = $Handlebars;
    }
    return Handlebars;
  };
};

module.exports = exports['default'];


}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],17:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.checkRevision = checkRevision;
exports.template = template;
exports.wrapProgram = wrapProgram;
exports.resolvePartial = resolvePartial;
exports.invokePartial = invokePartial;
exports.noop = noop;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

// istanbul ignore next

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }

var _utils = require('./utils');

var Utils = _interopRequireWildcard(_utils);

var _exception = require('./exception');

var _exception2 = _interopRequireDefault(_exception);

var _base = require('./base');

function checkRevision(compilerInfo) {
  var compilerRevision = compilerInfo && compilerInfo[0] || 1,
      currentRevision = _base.COMPILER_REVISION;

  if (compilerRevision !== currentRevision) {
    if (compilerRevision < currentRevision) {
      var runtimeVersions = _base.REVISION_CHANGES[currentRevision],
          compilerVersions = _base.REVISION_CHANGES[compilerRevision];
      throw new _exception2['default']('Template was precompiled with an older version of Handlebars than the current runtime. ' + 'Please update your precompiler to a newer version (' + runtimeVersions + ') or downgrade your runtime to an older version (' + compilerVersions + ').');
    } else {
      // Use the embedded version info since the runtime doesn't know about this revision yet
      throw new _exception2['default']('Template was precompiled with a newer version of Handlebars than the current runtime. ' + 'Please update your runtime to a newer version (' + compilerInfo[1] + ').');
    }
  }
}

function template(templateSpec, env) {
  /* istanbul ignore next */
  if (!env) {
    throw new _exception2['default']('No environment passed to template');
  }
  if (!templateSpec || !templateSpec.main) {
    throw new _exception2['default']('Unknown template object: ' + typeof templateSpec);
  }

  templateSpec.main.decorator = templateSpec.main_d;

  // Note: Using env.VM references rather than local var references throughout this section to allow
  // for external users to override these as psuedo-supported APIs.
  env.VM.checkRevision(templateSpec.compiler);

  function invokePartialWrapper(partial, context, options) {
    if (options.hash) {
      context = Utils.extend({}, context, options.hash);
      if (options.ids) {
        options.ids[0] = true;
      }
    }

    partial = env.VM.resolvePartial.call(this, partial, context, options);
    var result = env.VM.invokePartial.call(this, partial, context, options);

    if (result == null && env.compile) {
      options.partials[options.name] = env.compile(partial, templateSpec.compilerOptions, env);
      result = options.partials[options.name](context, options);
    }
    if (result != null) {
      if (options.indent) {
        var lines = result.split('\n');
        for (var i = 0, l = lines.length; i < l; i++) {
          if (!lines[i] && i + 1 === l) {
            break;
          }

          lines[i] = options.indent + lines[i];
        }
        result = lines.join('\n');
      }
      return result;
    } else {
      throw new _exception2['default']('The partial ' + options.name + ' could not be compiled when running in runtime-only mode');
    }
  }

  // Just add water
  var container = {
    strict: function strict(obj, name) {
      if (!(name in obj)) {
        throw new _exception2['default']('"' + name + '" not defined in ' + obj);
      }
      return obj[name];
    },
    lookup: function lookup(depths, name) {
      var len = depths.length;
      for (var i = 0; i < len; i++) {
        if (depths[i] && depths[i][name] != null) {
          return depths[i][name];
        }
      }
    },
    lambda: function lambda(current, context) {
      return typeof current === 'function' ? current.call(context) : current;
    },

    escapeExpression: Utils.escapeExpression,
    invokePartial: invokePartialWrapper,

    fn: function fn(i) {
      var ret = templateSpec[i];
      ret.decorator = templateSpec[i + '_d'];
      return ret;
    },

    programs: [],
    program: function program(i, data, declaredBlockParams, blockParams, depths) {
      var programWrapper = this.programs[i],
          fn = this.fn(i);
      if (data || depths || blockParams || declaredBlockParams) {
        programWrapper = wrapProgram(this, i, fn, data, declaredBlockParams, blockParams, depths);
      } else if (!programWrapper) {
        programWrapper = this.programs[i] = wrapProgram(this, i, fn);
      }
      return programWrapper;
    },

    data: function data(value, depth) {
      while (value && depth--) {
        value = value._parent;
      }
      return value;
    },
    merge: function merge(param, common) {
      var obj = param || common;

      if (param && common && param !== common) {
        obj = Utils.extend({}, common, param);
      }

      return obj;
    },

    noop: env.VM.noop,
    compilerInfo: templateSpec.compiler
  };

  function ret(context) {
    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var data = options.data;

    ret._setup(options);
    if (!options.partial && templateSpec.useData) {
      data = initData(context, data);
    }
    var depths = undefined,
        blockParams = templateSpec.useBlockParams ? [] : undefined;
    if (templateSpec.useDepths) {
      if (options.depths) {
        depths = context !== options.depths[0] ? [context].concat(options.depths) : options.depths;
      } else {
        depths = [context];
      }
    }

    function main(context /*, options*/) {
      return '' + templateSpec.main(container, context, container.helpers, container.partials, data, blockParams, depths);
    }
    main = executeDecorators(templateSpec.main, main, container, options.depths || [], data, blockParams);
    return main(context, options);
  }
  ret.isTop = true;

  ret._setup = function (options) {
    if (!options.partial) {
      container.helpers = container.merge(options.helpers, env.helpers);

      if (templateSpec.usePartial) {
        container.partials = container.merge(options.partials, env.partials);
      }
      if (templateSpec.usePartial || templateSpec.useDecorators) {
        container.decorators = container.merge(options.decorators, env.decorators);
      }
    } else {
      container.helpers = options.helpers;
      container.partials = options.partials;
      container.decorators = options.decorators;
    }
  };

  ret._child = function (i, data, blockParams, depths) {
    if (templateSpec.useBlockParams && !blockParams) {
      throw new _exception2['default']('must pass block params');
    }
    if (templateSpec.useDepths && !depths) {
      throw new _exception2['default']('must pass parent depths');
    }

    return wrapProgram(container, i, templateSpec[i], data, 0, blockParams, depths);
  };
  return ret;
}

function wrapProgram(container, i, fn, data, declaredBlockParams, blockParams, depths) {
  function prog(context) {
    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var currentDepths = depths;
    if (depths && context !== depths[0]) {
      currentDepths = [context].concat(depths);
    }

    return fn(container, context, container.helpers, container.partials, options.data || data, blockParams && [options.blockParams].concat(blockParams), currentDepths);
  }

  prog = executeDecorators(fn, prog, container, depths, data, blockParams);

  prog.program = i;
  prog.depth = depths ? depths.length : 0;
  prog.blockParams = declaredBlockParams || 0;
  return prog;
}

function resolvePartial(partial, context, options) {
  if (!partial) {
    if (options.name === '@partial-block') {
      partial = options.data['partial-block'];
    } else {
      partial = options.partials[options.name];
    }
  } else if (!partial.call && !options.name) {
    // This is a dynamic partial that returned a string
    options.name = partial;
    partial = options.partials[partial];
  }
  return partial;
}

function invokePartial(partial, context, options) {
  options.partial = true;
  if (options.ids) {
    options.data.contextPath = options.ids[0] || options.data.contextPath;
  }

  var partialBlock = undefined;
  if (options.fn && options.fn !== noop) {
    options.data = _base.createFrame(options.data);
    partialBlock = options.data['partial-block'] = options.fn;

    if (partialBlock.partials) {
      options.partials = Utils.extend({}, options.partials, partialBlock.partials);
    }
  }

  if (partial === undefined && partialBlock) {
    partial = partialBlock;
  }

  if (partial === undefined) {
    throw new _exception2['default']('The partial ' + options.name + ' could not be found');
  } else if (partial instanceof Function) {
    return partial(context, options);
  }
}

function noop() {
  return '';
}

function initData(context, data) {
  if (!data || !('root' in data)) {
    data = data ? _base.createFrame(data) : {};
    data.root = context;
  }
  return data;
}

function executeDecorators(fn, prog, container, depths, data, blockParams) {
  if (fn.decorator) {
    var props = {};
    prog = fn.decorator(prog, props, container, depths && depths[0], data, blockParams, depths);
    Utils.extend(prog, props);
  }
  return prog;
}


},{"./base":3,"./exception":6,"./utils":19}],18:[function(require,module,exports){
// Build out our basic SafeString type
'use strict';

exports.__esModule = true;
function SafeString(string) {
  this.string = string;
}

SafeString.prototype.toString = SafeString.prototype.toHTML = function () {
  return '' + this.string;
};

exports['default'] = SafeString;
module.exports = exports['default'];


},{}],19:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.extend = extend;
exports.indexOf = indexOf;
exports.escapeExpression = escapeExpression;
exports.isEmpty = isEmpty;
exports.createFrame = createFrame;
exports.blockParams = blockParams;
exports.appendContextPath = appendContextPath;
var escape = {
  '&': '&amp;',
  '<': '&lt;',
  '>': '&gt;',
  '"': '&quot;',
  "'": '&#x27;',
  '`': '&#x60;',
  '=': '&#x3D;'
};

var badChars = /[&<>"'`=]/g,
    possible = /[&<>"'`=]/;

function escapeChar(chr) {
  return escape[chr];
}

function extend(obj /* , ...source */) {
  for (var i = 1; i < arguments.length; i++) {
    for (var key in arguments[i]) {
      if (Object.prototype.hasOwnProperty.call(arguments[i], key)) {
        obj[key] = arguments[i][key];
      }
    }
  }

  return obj;
}

var toString = Object.prototype.toString;

exports.toString = toString;
// Sourced from lodash
// https://github.com/bestiejs/lodash/blob/master/LICENSE.txt
/* eslint-disable func-style */
var isFunction = function isFunction(value) {
  return typeof value === 'function';
};
// fallback for older versions of Chrome and Safari
/* istanbul ignore next */
if (isFunction(/x/)) {
  exports.isFunction = isFunction = function (value) {
    return typeof value === 'function' && toString.call(value) === '[object Function]';
  };
}
exports.isFunction = isFunction;

/* eslint-enable func-style */

/* istanbul ignore next */
var isArray = Array.isArray || function (value) {
  return value && typeof value === 'object' ? toString.call(value) === '[object Array]' : false;
};

exports.isArray = isArray;
// Older IE versions do not directly support indexOf so we must implement our own, sadly.

function indexOf(array, value) {
  for (var i = 0, len = array.length; i < len; i++) {
    if (array[i] === value) {
      return i;
    }
  }
  return -1;
}

function escapeExpression(string) {
  if (typeof string !== 'string') {
    // don't escape SafeStrings, since they're already safe
    if (string && string.toHTML) {
      return string.toHTML();
    } else if (string == null) {
      return '';
    } else if (!string) {
      return string + '';
    }

    // Force a string conversion as this will be done by the append regardless and
    // the regex test will do this transparently behind the scenes, causing issues if
    // an object's to string has escaped characters in it.
    string = '' + string;
  }

  if (!possible.test(string)) {
    return string;
  }
  return string.replace(badChars, escapeChar);
}

function isEmpty(value) {
  if (!value && value !== 0) {
    return true;
  } else if (isArray(value) && value.length === 0) {
    return true;
  } else {
    return false;
  }
}

function createFrame(object) {
  var frame = extend({}, object);
  frame._parent = object;
  return frame;
}

function blockParams(params, ids) {
  params.path = ids;
  return params;
}

function appendContextPath(contextPath, id) {
  return (contextPath ? contextPath + '.' : '') + id;
}


},{}],20:[function(require,module,exports){
// Create a simple path alias to allow browserify to resolve
// the runtime on a supported path.
module.exports = require('./dist/cjs/handlebars.runtime')['default'];

},{"./dist/cjs/handlebars.runtime":2}],21:[function(require,module,exports){
module.exports = require("handlebars/runtime")["default"];

},{"handlebars/runtime":20}],22:[function(require,module,exports){
(function (process,global){
(function (global, undefined) {
    "use strict";

    if (global.setImmediate) {
        return;
    }

    var nextHandle = 1; // Spec says greater than zero
    var tasksByHandle = {};
    var currentlyRunningATask = false;
    var doc = global.document;
    var registerImmediate;

    function setImmediate(callback) {
      // Callback can either be a function or a string
      if (typeof callback !== "function") {
        callback = new Function("" + callback);
      }
      // Copy function arguments
      var args = new Array(arguments.length - 1);
      for (var i = 0; i < args.length; i++) {
          args[i] = arguments[i + 1];
      }
      // Store and register the task
      var task = { callback: callback, args: args };
      tasksByHandle[nextHandle] = task;
      registerImmediate(nextHandle);
      return nextHandle++;
    }

    function clearImmediate(handle) {
        delete tasksByHandle[handle];
    }

    function run(task) {
        var callback = task.callback;
        var args = task.args;
        switch (args.length) {
        case 0:
            callback();
            break;
        case 1:
            callback(args[0]);
            break;
        case 2:
            callback(args[0], args[1]);
            break;
        case 3:
            callback(args[0], args[1], args[2]);
            break;
        default:
            callback.apply(undefined, args);
            break;
        }
    }

    function runIfPresent(handle) {
        // From the spec: "Wait until any invocations of this algorithm started before this one have completed."
        // So if we're currently running a task, we'll need to delay this invocation.
        if (currentlyRunningATask) {
            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a
            // "too much recursion" error.
            setTimeout(runIfPresent, 0, handle);
        } else {
            var task = tasksByHandle[handle];
            if (task) {
                currentlyRunningATask = true;
                try {
                    run(task);
                } finally {
                    clearImmediate(handle);
                    currentlyRunningATask = false;
                }
            }
        }
    }

    function installNextTickImplementation() {
        registerImmediate = function(handle) {
            process.nextTick(function () { runIfPresent(handle); });
        };
    }

    function canUsePostMessage() {
        // The test against `importScripts` prevents this implementation from being installed inside a web worker,
        // where `global.postMessage` means something completely different and can't be used for this purpose.
        if (global.postMessage && !global.importScripts) {
            var postMessageIsAsynchronous = true;
            var oldOnMessage = global.onmessage;
            global.onmessage = function() {
                postMessageIsAsynchronous = false;
            };
            global.postMessage("", "*");
            global.onmessage = oldOnMessage;
            return postMessageIsAsynchronous;
        }
    }

    function installPostMessageImplementation() {
        // Installs an event handler on `global` for the `message` event: see
        // * https://developer.mozilla.org/en/DOM/window.postMessage
        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages

        var messagePrefix = "setImmediate$" + Math.random() + "$";
        var onGlobalMessage = function(event) {
            if (event.source === global &&
                typeof event.data === "string" &&
                event.data.indexOf(messagePrefix) === 0) {
                runIfPresent(+event.data.slice(messagePrefix.length));
            }
        };

        if (global.addEventListener) {
            global.addEventListener("message", onGlobalMessage, false);
        } else {
            global.attachEvent("onmessage", onGlobalMessage);
        }

        registerImmediate = function(handle) {
            global.postMessage(messagePrefix + handle, "*");
        };
    }

    function installMessageChannelImplementation() {
        var channel = new MessageChannel();
        channel.port1.onmessage = function(event) {
            var handle = event.data;
            runIfPresent(handle);
        };

        registerImmediate = function(handle) {
            channel.port2.postMessage(handle);
        };
    }

    function installReadyStateChangeImplementation() {
        var html = doc.documentElement;
        registerImmediate = function(handle) {
            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted
            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.
            var script = doc.createElement("script");
            script.onreadystatechange = function () {
                runIfPresent(handle);
                script.onreadystatechange = null;
                html.removeChild(script);
                script = null;
            };
            html.appendChild(script);
        };
    }

    function installSetTimeoutImplementation() {
        registerImmediate = function(handle) {
            setTimeout(runIfPresent, 0, handle);
        };
    }

    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.
    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);
    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;

    // Don't get fooled by e.g. browserify environments.
    if ({}.toString.call(global.process) === "[object process]") {
        // For Node.js before 0.9
        installNextTickImplementation();

    } else if (canUsePostMessage()) {
        // For non-IE10 modern browsers
        installPostMessageImplementation();

    } else if (global.MessageChannel) {
        // For web workers, where supported
        installMessageChannelImplementation();

    } else if (doc && "onreadystatechange" in doc.createElement("script")) {
        // For IE 6–8
        installReadyStateChangeImplementation();

    } else {
        // For older browsers
        installSetTimeoutImplementation();
    }

    attachTo.setImmediate = setImmediate;
    attachTo.clearImmediate = clearImmediate;
}(typeof self === "undefined" ? typeof global === "undefined" ? this : global : self));

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"_process":1}],23:[function(require,module,exports){
var trim = require('./trim');

module.exports = function dasherize(str) {
  return trim(str).replace(/([A-Z])/g, '-$1').replace(/[-_\s]+/g, '-').toLowerCase();
};

},{"./trim":31}],24:[function(require,module,exports){
var escapeRegExp = require('./escapeRegExp');

module.exports = function defaultToWhiteSpace(characters) {
  if (characters == null)
    return '\\s';
  else if (characters.source)
    return characters.source;
  else
    return '[' + escapeRegExp(characters) + ']';
};

},{"./escapeRegExp":25}],25:[function(require,module,exports){
var makeString = require('./makeString');

module.exports = function escapeRegExp(str) {
  return makeString(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g, '\\$1');
};

},{"./makeString":26}],26:[function(require,module,exports){
/**
 * Ensure some object is a coerced to a string
 **/
module.exports = function makeString(object) {
  if (object == null) return '';
  return '' + object;
};

},{}],27:[function(require,module,exports){
module.exports = function strRepeat(str, qty){
  if (qty < 1) return '';
  var result = '';
  while (qty > 0) {
    if (qty & 1) result += str;
    qty >>= 1, str += str;
  }
  return result;
};

},{}],28:[function(require,module,exports){
var pad = require('./pad');

module.exports = function lpad(str, length, padStr) {
  return pad(str, length, padStr);
};

},{"./pad":29}],29:[function(require,module,exports){
var makeString = require('./helper/makeString');
var strRepeat = require('./helper/strRepeat');

module.exports = function pad(str, length, padStr, type) {
  str = makeString(str);
  length = ~~length;

  var padlen = 0;

  if (!padStr)
    padStr = ' ';
  else if (padStr.length > 1)
    padStr = padStr.charAt(0);

  switch (type) {
  case 'right':
    padlen = length - str.length;
    return str + strRepeat(padStr, padlen);
  case 'both':
    padlen = length - str.length;
    return strRepeat(padStr, Math.ceil(padlen / 2)) + str + strRepeat(padStr, Math.floor(padlen / 2));
  default: // 'left'
    padlen = length - str.length;
    return strRepeat(padStr, padlen) + str;
  }
};

},{"./helper/makeString":26,"./helper/strRepeat":27}],30:[function(require,module,exports){
var pad = require('./pad');

module.exports = function rpad(str, length, padStr) {
  return pad(str, length, padStr, 'right');
};

},{"./pad":29}],31:[function(require,module,exports){
var makeString = require('./helper/makeString');
var defaultToWhiteSpace = require('./helper/defaultToWhiteSpace');
var nativeTrim = String.prototype.trim;

module.exports = function trim(str, characters) {
  str = makeString(str);
  if (!characters && nativeTrim) return nativeTrim.call(str);
  characters = defaultToWhiteSpace(characters);
  return str.replace(new RegExp('^' + characters + '+|' + characters + '+$', 'g'), '');
};

},{"./helper/defaultToWhiteSpace":24,"./helper/makeString":26}],32:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/App
/*/
"use strict";

console.info("Portfolio App started");

if (!DEBUG) {
	window.addEventListener("error", function(ev) {
		console.error("Uncaught Error", ev);
	});
}

require("Modernizr");
require("es6-promise").polyfill();
require("classlist-polyfill");
require("raf-polyfill");
require("matches-polyfill");
require("fullscreen-polyfill");
require("math-sign-polyfill");
require("setimmediate");

require("backbone").$ = require("backbone.native");
require("backbone.babysitter");
require("Backbone.Mutators");
require("hammerjs");

// document.addEventListener('DOMContentLoaded', function(ev) {
// 	console.log("%s:[event %s]", ev.target, ev.type);
// });

window.addEventListener("load", function(ev) {
	console.log("%s:[event %s]", ev.target, ev.type);

	// process bootstrap data, let errors go up the stack
	try {
		require("app/model/helper/bootstrap")(window.bootstrap);
	} catch (err) {
		var el = document.selectQuery(".app");
		el.classList.remove("app-initial");
		el.classList.add("app-error");
		throw new Error("bootstrap data error (" + err.message + ")", err.fileName, err.lineNumber);
	} finally { // detele global var
		delete window.bootstrap;
	}

	require("app/view/template/_helpers");
	// require("app/view/template/_partials");
	/** @type {module:app/view/helper/createColorStyleSheet} */
	require("app/view/helper/createColorStyleSheet").call();

	/** @type {module:app/view/AppView} */
	var AppView = require("app/view/AppView");

	/** @type {module:webfontloader} */
	var WebFont = require("webfontloader");
	WebFont.load({
		async: true,
		classes: false,
		custom: {
			families: [
				// "Franklin Gothic FS:n4,n7",
				"Franklin Gothic FS:n4,i4,n7,i7",
				"FolioFigures:n4",
			],
			testStrings: {
				"FolioFigures": "hms"
			},
		},
		active: function() {
			console.info("WebFont::active");
			// AppView.getInstance();
		},
		fontactive: function(familyName, variantFvd) {
			console.info("WebFont::fontactive '%s' (%s)", familyName, variantFvd);
		},
		inactive: function() {
			console.warn("WebFont::inactive");
			// AppView.getInstance();
		},
		fontinactive: function(familyName, variantFvd) {
			console.warn("WebFont::fontinactive '%s' (%s)", familyName, variantFvd);
		},
		// loading: function() {
		// 	console.log("WebFont::loading");
		// },
		// fontloading: function(familyName, variantDesc) {
		// 	console.log("WebFont::fontloading", familyName, JSON.stringify(variantDesc, null, " "));
		// },
	});
	AppView.getInstance();
});


if (DEBUG) {
	// /** @type {module:underscore} */
	// var _ = require("underscore");

	// var isFF = /Firefox/.test(window.navigator.userAgent);
	// var isIOS = /iPad|iPhone/.test(window.navigator.userAgent);
	/*
	if (/Firefox/.test(window.navigator.userAgent)) {
		console.prefix = "# ";
		var shift = [].shift;
		var logWrapFn = function() {
			if (typeof arguments[1] == "string") arguments[1] = console.prefix + arguments[1];
			return shift.apply(arguments).apply(console, arguments);
		};
		console.group = _.wrap(console.group, logWrapFn);
		console.log = _.wrap(console.log, logWrapFn);
		console.info = _.wrap(console.info, logWrapFn);
		console.warn = _.wrap(console.warn, logWrapFn);
		console.error = _.wrap(console.error, logWrapFn);
	}
	*/
	/*
	var saveLogs = function() {
		var logWrapFn = function(name, fn, msg) {
			document.documentElement.appendChild(
				document.createComment("[" + name + "] " + msg));
		};
		console.group = _.wrap(console.group, _.partial(logWrapFn, "group"));
		console.log = _.wrap(console.log, _.partial(logWrapFn, "log"));
		console.info = _.wrap(console.info, _.partial(logWrapFn, "info"));
		console.warn = _.wrap(console.warn, _.partial(logWrapFn, "warn"));
		console.error = _.wrap(console.error, _.partial(logWrapFn, "error"));
	};
	*/

	// handle error events on some platforms and production
	/*
	if (isIOS) {
		// saveLogs();
		window.addEventListener("error", function() {
			var args = Array.prototype.slice.apply(arguments),
				el = document.createElement("div"),
				html = "";
			_.extend(el.style, {
				fontfamily: "monospace",
				display: "block",
				position: "absolute",
				zIndex: "999",
				backgroundColor: "white",
				color: "black",
				width: "calc(100% - 3em)",
				bottom: "0",
				margin: "1em 1.5em",
				padding: "1em 1.5em",
				outline: "0.5em solid red",
				outlineOffset: "0.5em",
				boxSizing: "border-box",
				overflow: "hidden",
			});
			html += "<pre><b>location:<b> " + window.location + "</pre>";
			html += "<pre><b>event:<b> " + JSON.stringify(args.shift(), null, " ") + "</pre>";
			if (args.length) html += "<pre><b>rest:<b> " + JSON.stringify(args, null, " ") + "</pre>";
			el.innerHTML = html;
			document.body.appendChild(el);
		});
	}*/
}
}).call(this,true)

},{"Backbone.Mutators":"Backbone.Mutators","Modernizr":"Modernizr","app/model/helper/bootstrap":45,"app/view/AppView":52,"app/view/helper/createColorStyleSheet":74,"app/view/template/_helpers":101,"backbone":"backbone","backbone.babysitter":"backbone.babysitter","backbone.native":"backbone.native","classlist-polyfill":"classlist-polyfill","es6-promise":"es6-promise","fullscreen-polyfill":"fullscreen-polyfill","hammerjs":"hammerjs","matches-polyfill":"matches-polyfill","math-sign-polyfill":"math-sign-polyfill","raf-polyfill":"raf-polyfill","setimmediate":22,"webfontloader":"webfontloader"}],33:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/control/Controller
/*/

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Backbone = require("backbone");

// /** @type {module:app/model/collection/TypeCollection} */
// var types = require("app/model/collection/TypeCollection");
// /** @type {module:app/model/collection/KeywordCollection} */
// var keywords = require("app/model/collection/KeywordCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");

/* --------------------------- *
/* Static private
/* --------------------------- */

/**
/* @constructor
/* @type {module:app/control/Controller}
/*/
var Controller = Backbone.Router.extend({

	// /** @override */
	// routes: {},

	/** @override */
	initialize: function(options) {
		this._routeNames = [];

		if (DEBUG) {
			this.on("route", function(routeName, args) {
				console.log("controller:[route] %s [%s]", routeName, args.join());
			});
		}

		/*
		 * Prefixed article regexp: /^article(?:\/([^\/]+))\/?$/
		 * Single bundle regexp: /^bundles(?:\/([^\/]+)(?:\/(\d+))?)?\/?$/
		 */
		this.route(/(.*)/,
			"notfound", this.toNotFound);
		this.route(/^([a-z][a-z0-9\-]*)\/?$/,
			"article-item", this.toArticleItem);
		this.route(/^(?:bundles)?\/?$/,
			"root", this.toRoot);
		// this.route(/^bundles\/?$/,
		// 	"bundle-list", this.toBundleList);
		this.route(/^bundles\/([^\/]+)\/?$/,
			"bundle-item", this.toBundleItem);
		this.route(/^bundles\/([^\/]+)\/(\d+)\/?$/,
			"media-item", this.toMediaItem);

		console.log("%s::initialize routes: %o", "controller", this._routeNames);
	},

	route: function(route, name, callback) {
		this._routeNames.push(_.isString(name) ? name : '');
		return Backbone.Router.prototype.route.apply(this, arguments);
	},

	/* ---------------------------
	/* JS to URL: public command methods
	/* --------------------------- */

	selectMedia: function(media) {
		this._goToLocation(media.get("bundle"), media);
	},

	selectBundle: function(bundle) {
		this._goToLocation(bundle);
	},

	deselectMedia: function() {
		this._goToLocation(bundles.selected);
	},

	deselectBundle: function() {
		this._goToLocation();
	},

	selectArticle: function(article) {
		this.navigate(article.get("handle"), { trigger: true });
	},

	deselectArticle: function() {
		this.navigate("", { trigger: true });
	},

	/* ---------------------------
	/* JS to URL: private helpers
	/* --------------------------- */

	/** Update location when navigation happens internally */
	_updateLocation: function() {
		var bundle, media;
		bundle = bundles.selected;
		if (bundle) {
			media = bundle.get("media").selected;
		}
		this.navigate(this._getLocation(bundle, media), {
			trigger: false
		});
	},

	_getLocation: function(bundle, media) {
		var mediaIndex, location = [];
		if (bundle) {
			location.push("bundles");
			location.push(bundle.get("handle"));
			if (media) {
				mediaIndex = bundle.get("media").indexOf(media);
				if (mediaIndex >= 0) {
					location.push(mediaIndex);
				}
			}
		}
		// location.push("");
		return location.join("/");
	},

	_goToLocation: function(bundle, media) {
		this.navigate(this._getLocation(bundle, media), {
			trigger: true
		});
	},

	/* --------------------------- *
	/* URL to JS: router handlers
	/* --------------------------- */

	toRoot: function() {
		this.trigger("change:before");
		if (bundles.selected) {
			bundles.selected.get("media").deselect();
			bundles.deselect();
		}
		// keywords.deselect();
		articles.deselect();
		this.trigger("change:after");
	},

	toNotFound: function(slug) {
		console.info("route:[*:%s]", slug);
	},

	// toBundleList: function() {
	// 	this.navigate("", {
	// 		trigger: true,
	// 		replace: true
	// 	});
	// },

	toBundleItem: function(bundleHandle) {
		var bundle = bundles.findWhere({
			handle: bundleHandle
		});
		if (!bundle) {
			throw new Error("Cannot find bundle with handle \"" + bundleHandle + "\"");
		}
		this._changeSelection(bundle);
	},

	toMediaItem: function(bundleHandle, mediaIndex) {
		var bundle, media;
		// if (bundleHandle) {
		bundle = bundles.findWhere({ handle: bundleHandle });
		if (!bundle) {
			throw new Error("No bundle with handle \"" + bundleHandle + "\" found");
		}
		// if (mediaIndex) {
		media = bundle.get("media").at(mediaIndex);
		if (!media) {
			throw new Error("No media at index " + mediaIndex + " in bundle with handle \"" + bundleHandle + "\" found");
		}
		// }
		// }
		this._changeSelection(bundle, media);
	},

	toArticleItem: function(articleHandle) {
		var article = articles.findWhere({ handle: articleHandle });
		if (!article) {
			throw new Error("Cannot find article with handle \"" + articleHandle + "\"");
		}
		this.trigger("change:before", article);
		bundles.deselect();
		articles.select(article);
		this.trigger("change:after", article);
	},

	/* -------------------------------
	/* URL to JS: private helpers
	/* ------------------------------- */

	/*
	/* NOTE: Selection order
	/* - Apply media selection to *incoming bundle*, as not to trigger
	/*	unneccesary events on an outgoing bundle. Outgoing bundle media selection
	/*	remains untouched.
	/* - Apply media selection *before* selecting the incoming bundle. Views
	/*	normally listen to the selected bundle only, so if the bundle is changing,
	/*	they will not be listening to media selection changes yet.
	/*/
	_changeSelection: function(bundle, media) {
		var lastBundle, lastMedia;
		if (bundle === void 0) bundle = null;
		if (media === void 0) media = null;

		lastBundle = bundles.selected;
		lastMedia = lastBundle ? lastBundle.get("media").selected : null;
		console.log("controller::_changeSelection bundle:[%s -> %s] media:[%s -> %s]",
			(lastBundle ? lastBundle.cid : lastBundle), (bundle ? bundle.cid : bundle),
			(lastMedia ? lastMedia.cid : lastMedia), (media ? media.cid : media)
		);

		if (!articles.selected && (lastBundle === bundle) && (lastMedia === media)) {
			return;
		}

		this.trigger("change:before", bundle, media);
		bundle && bundle.get("media").select(media);
		bundles.select(bundle);
		articles.deselect();
		this.trigger("change:after", bundle, media);
	},
});


module.exports = new Controller();
}).call(this,true)

},{"app/model/collection/ArticleCollection":41,"app/model/collection/BundleCollection":42,"backbone":"backbone","underscore":"underscore"}],34:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/control/Globals
/*/
/** @type {module:underscore} */
var _ = require("underscore");

module.exports = (function() {
	// reusable vars
	var o, s, so;
	// global hash
	var g = {};
	// SASS <--> JS shared hash
	var sass = require("../../../sass/variables.json");

	// JUNK FIRST: Some app-wide defaults
	// - - - - - - - - - - - - - - - - -
	g.VPAN_DRAG = 0.95; // as factor of pointer delta
	g.HPAN_OUT_DRAG = 0.4; // factor
	g.VPAN_OUT_DRAG = 0.1; // factor
	g.PAN_THRESHOLD = 15; // px
	g.COLLAPSE_THRESHOLD = 75; // px
	g.COLLAPSE_OFFSET = parseInt(sass.temp["collapse_offset"]);
	g.CLICK_EVENT = window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup";

	// breakpoints
	// - - - - - - - - - - - - - - - - -
	g.BREAKPOINTS = {};
	for (s in sass.breakpoints) {
		o = sass.breakpoints[s];
		/*if (Array.isArray(o)) {
			g.BREAKPOINTS[s] = Object.defineProperties({}, {
				"matches": {
					get: _.partial(_.some, o.map(window.matchMedia), _.property("matches"))
				},
				"media": {
					value: o.join(", ")
				},
				"queries": {
					value: o.map(window.matchMedia)
				},
			});
		} else {
			g.BREAKPOINTS[s] = window.matchMedia(o);
		}*/
		o = Array.isArray(o) ? o.join(", ") : o;
		o = o.replace(/[\'\"]/g, "");
		o = window.matchMedia(o);
		o.className = s;
		g.BREAKPOINTS[s] = o;
	}
	if (DEBUG) {
		console.group("Breakpoints");
		for (s in g.BREAKPOINTS) {
			console.log("%s: %o", s, g.BREAKPOINTS[s].media);
		}
		console.groupEnd();
	}

	// base colors, dimensions
	// - - - - - - - - - - - - - - - - -
	g.DEFAULT_COLORS = _.clone(sass.default_colors);
	// g.HORIZONTAL_STEP = parseFloat(sass.units["hu_px"]);
	// g.VERTICAL_STEP = parseFloat(sass.units["vu_px"]);


	// paths, networking
	// - - - - - - - - - - - - - - - - -
	// var toAbsoluteURL = (function() {
	// 	var a = null;
	// 	return function(url) {
	// 		a = a || document.createElement('a');
	// 		a.href = url;
	// 		return a.href;
	// 	};
	// })();
	// g.APP_ROOT = toAbsoluteURL(window.approot);
	// g.MEDIA_DIR = toAbsoluteURL(window.mediadir);

	g.APP_ROOT = window.approot;
	g.MEDIA_DIR = window.mediadir;

	delete window.approot;
	delete window.mediadir;

	// hardcoded font data
	// - - - - - - - - - - - - - - - - -
	g.FONT_METRICS = {
		"Franklin Gothic FS": {
			"unitsPerEm": 1000,
			"ascent": 827,
			"descent": -173
		},
		"ITCFranklinGothicStd": {
			"unitsPerEm": 1000,
			"ascent": 686,
			"descent": -314
		},
		"FolioFigures": {
			"unitsPerEm": 1024,
			"ascent": 939,
			"descent": -256
		},
	};

	g.PAUSE_CHAR = String.fromCharCode(0x23F8);
	g.PLAY_CHAR = String.fromCharCode(0x23F5);
	g.STOP_CHAR = String.fromCharCode(0x23F9);

	// translate common template

	g.TRANSLATE_TEMPLATE = function(x, y) {
		return "translate(" + x + "px, " + y + "px)";
		// return "translate3d(" + x + "px, " + y + "px ,0px)";
	};
	// timing, easing
	// - - - - - - - - - - - - - - - - -
	var ease = g.TRANSITION_EASE = sass.transitions["ease"];
	var duration = g.TRANSITION_DURATION = parseFloat(sass.transitions["duration_ms"]);
	var delayInterval = g.TRANSITION_DELAY_INTERVAL = parseFloat(sass.transitions["delay_interval_ms"]);
	var minDelay = g.TRANSITION_MIN_DELAY = parseFloat(sass.transitions["min_delay_ms"]);
	var delay = g.TRANSITION_DELAY = g.TRANSITION_DURATION + g.TRANSITION_DELAY_INTERVAL;

	// css transitions
	// - - - - - - - - - - - - - - - - -
	o = {};

	// match tx() in _transitions.scss
	// - - - - - - - - - - - - - - - - -
	o.tx = function tx(durationCount, delayCount, easeVal) {
		_.isNumber(durationCount) || (durationCount = 1);
		_.isNumber(delayCount) || (delayCount = -1);
		_.isString(easeVal) || (easeVal = ease);

		var o = {};
		if (delayCount < 0) {
			o.duration = (duration * durationCount) +
				(delayInterval * (durationCount - 1));
			o.delay = 0;
		} else {
			o.duration = (duration * durationCount) +
				(delayInterval * (durationCount - 1)) - minDelay;
			o.delay = (delay * delayCount) - minDelay;
		}
		o.easeing = easeVal;
		return 0;
	}

	// transition presets
	// TODO: get rid of this
	// - - - - - - - - - - - - - - - - -

	o.NONE = {
		delay: 0,
		duration: 0,
		easing: "step-start"
	};
	o.NOW = {
		delay: 0,
		duration: duration,
		easing: ease
	};
	o.UNSET = _.defaults({
		cssText: ""
	}, o.NONE);

	var txAligned = _.defaults({
		duration: duration - minDelay
	}, o.NOW);
	o.FIRST = _.defaults({
		delay: delay * 0.0 + minDelay
	}, txAligned);
	o.BETWEEN = _.defaults({
		delay: delay * 1.0 + minDelay
	}, txAligned);
	o.LAST = _.defaults({
		delay: delay * 2.0 + minDelay
	}, txAligned);
	o.AFTER = _.defaults({
		delay: delay * 2.0 + minDelay
	}, txAligned);

	o.BETWEEN_EARLY = _.defaults({
		delay: delay * 1.0 + minDelay - 60
	}, txAligned);
	o.BETWEEN_LATE = _.defaults({
		delay: delay * 1.0 + minDelay + 60
	}, txAligned);

	o.FIRST_LATE = _.defaults({
		delay: delay * 0.5 + minDelay
	}, txAligned);
	o.LAST_EARLY = _.defaults({
		delay: delay * 1.5 + minDelay
	}, txAligned);
	// o.FIRST_LATE = 		_.defaults({delay: txDelay*0.0 + txMinDelay*2}, txAligned);
	// o.LAST_EARLY = 		_.defaults({delay: txDelay*2.0 + txMinDelay*0}, txAligned);
	// o.AFTER = 			_.defaults({delay: txDelay*2.0 + txMinDelay}, txAligned);

	console.group("Transitions");
	for (s in o) {
		if (!_.isFunction(o[s])) {
			so = o[s];
			so.name = s;
			so.className = "tx-" + s.replace("_", "-").toLowerCase();
			if (!so.hasOwnProperty("cssText")) {
				so.cssText = so.duration / 1000 + "s " + so.easing + " " + so.delay / 1000 + "s";
			}
			console.log("%s: %s", so.name, so.cssText);
		}
	}
	console.groupEnd();
	g.transitions = o;

	return g;
}());
}).call(this,true)

},{"../../../sass/variables.json":119,"underscore":"underscore"}],35:[function(require,module,exports){
/**
 * @module app/view/DebugToolbar
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:cookies-js} */
var Cookies = require("cookies-js");
// /** @type {module:modernizr} */
// var Modernizr = require("Modernizr");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
// /** @type {module:app/control/Controller} */
// var controller = require("app/control/Controller");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");

/** @type {Function} */
var viewTemplate = require("./template/DebugToolbar.hbs");

/** @type {Function} */
var gridTemplate = require("./template/DebugToolbar.SVGGrid.hbs");

/** @type {Function} */
var sizeTemplate = _.template("<%= w %> \u00D7 <%= h %>");

// var appStateSymbols = { withBundle: "b", withMedia: "m", collapsed: "c"};
// var appStateKeys = Object.keys(appStateSymbols);

var DebugToolbar = View.extend({

	/** @override */
	cidPrefix: "debugToolbar",
	/** @override */
	tagName: "div",
	/** @override */
	className: "toolbar",
	/** @override */
	template: viewTemplate,

	/** @override */
	properties: {
		grid: {
			get: function() {
				return this._grid || (this._grid = this.createGridElement());
			}
		}
	},

	initialize: function(options) {
		Cookies.defaults = {
			expires: new Date(0x7fffffff * 1e3),
			domain: String(window.location)
				.match(/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i)[1]
		};

		this.el.innerHTML = this.template({
			tests: Modernizr,
			navigator: window.navigator
		});

		/* toggle's target: container
		/* - - - - - - - - - - - - - - - - */
		var container = document.getElementById("container"); //.querySelector("#container");

		/* create/attach svg grid element
		/* - - - - - - - - - - - - - - - - */
		container.insertBefore(this.createGridElement(), container.firstElementChild);

		/* info elements
		/* - - - - - - - - - - - - - - - - */
		this.backendEl = this.el.querySelector("#edit-backend a");
		this.mediaInfoEl = this.el.querySelector("#media-info span");
		this.appStateEl = this.el.querySelector("#app-state");

		/* toggle visibility
		/* - - - - - - - - - - - - - - - - */
		this.initializeClassToggle("show-links", this.el.querySelector(".debug-links #links-toggle"), this.el,
			function(key, value) {
				this.el.classList.toggle("not-" + key, !value);
				// console.log("%s:initializeClassToggle:[callback] %o", this.cid, arguments);
			}
		);
		this.initializeClassToggle("show-tests", this.el.querySelector("#toggle-tests a"), this.el);
		this.initializeClassToggle("hide-passed", this.el.querySelector("#toggle-passed"), this.el);

		/* toggle container classes
		/* - - - - - - - - - - - - - - - - */
		this.initializeClassToggle("debug-grid-bg", this.el.querySelector("#toggle-grid-bg a"), document.body);
		this.initializeClassToggle("debug-blocks", this.el.querySelector("#toggle-blocks a"), container);
		this.initializeClassToggle("debug-graph", this.el.querySelector("#toggle-graph a"), container);
		this.initializeClassToggle("debug-mdown", this.el.querySelector("#toggle-mdown a"), container);
		this.initializeClassToggle("debug-logs", this.el.querySelector("#toggle-logs a"), container);
		this.initializeClassToggle("debug-tx", this.el.querySelector("#toggle-tx a"), container,
			function(key, value) {
				this.el.classList.toggle("show-tx", value);
				this.el.classList.toggle("not-show-tx", !value);
			}
		);

		this.initializeViewportInfo();

		// this.initializeLayoutSelect();

		this.listenTo(this.model, "change", this._onModelChange);
		this._onModelChange();
	},

	initializeViewportInfo: function() {
		var viewportInfoEl = this.el.querySelector("#viewport-info span");
		var callback = function() {
			viewportInfoEl.textContent = sizeTemplate({ w: window.innerWidth, h: window.innerHeight });
		};
		callback.call();
		window.addEventListener("resize", _.debounce(callback, 100, false, false));
	},

	initializeToggle: function(key, toggleEl, callback) {
		var ctx = this;
		var toggleValue = Cookies.get(key) === "true";
		callback.call(ctx, key, toggleValue);

		toggleEl.addEventListener("click", function(ev) {
			if (ev.defaultPrevented) return;
			else ev.preventDefault();
			toggleValue = !toggleValue;
			Cookies.set(key, toggleValue ? "true" : "");
			callback.call(ctx, key, toggleValue);
		}, false);
	},

	initializeClassToggle: function(key, toggleEl, targetEl, callback) {
		var hasCallback = _.isFunction(callback);

		this.initializeToggle(key, toggleEl, function(key, toggleValue) {
			targetEl.classList.toggle(key, toggleValue);
			toggleEl.classList.toggle("toggle-enabled", toggleValue);
			toggleEl.classList.toggle("color-reverse", toggleValue);
			hasCallback && callback.apply(this, arguments);
		});
	},

	_onModelChange: function() {
		console.log("%s::_onModelChange changedAttributes: %o", this.cid, this.model.changedAttributes());
		var i, ii, prop, el, els = this.appStateEl.children;
		for (i = 0, ii = els.length; i < ii; i++) {
			el = els[i];
			prop = el.getAttribute("data-prop");
			el.classList.toggle("has-value", this.model.get(prop));
			el.classList.toggle("has-changed", this.model.hasChanged(prop));
			el.classList.toggle("color-reverse", this.model.hasChanged(prop));
		}

		// NOTE: Always but rewrite CMS href.
		// Only collapsed may have changed, but not worth all the logic
		var attrVal = Globals.APP_ROOT + "symphony/";
		switch (this.model.get("routeName")) {
			case "article-item":
				attrVal += "publish/articles/edit/" + this.model.get("article").id;
				break;
			case "bundle-item":
				attrVal += "publish/bundles/edit/" + this.model.get("bundle").id;
				break;
			case "media-item":
				attrVal += "publish/media/edit/" + this.model.get("media").id;
				break;
			case "root":
				attrVal += "publish/bundles";
				break;
		}
		this.backendEl.setAttribute("href", attrVal);

		if (this.model.hasChanged("media")) {
			if (this.model.has("media")) {
				this.mediaInfoEl.textContent = sizeTemplate(this.model.get("media").get("source").toJSON());
				this.mediaInfoEl.style.display = "";
			} else {
				this.mediaInfoEl.textContent = "";
				this.mediaInfoEl.style.display = "none";
			}
		}
	},

	createGridElement: function() {
		var el = document.createElement("div");
		el.id = "grid-wrapper";
		el.innerHTML = gridTemplate();
		return el;
	},
});

module.exports = DebugToolbar;
},{"./template/DebugToolbar.SVGGrid.hbs":36,"./template/DebugToolbar.hbs":37,"app/control/Globals":34,"app/view/base/View":60,"cookies-js":"cookies-js","underscore":"underscore"}],36:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    return "<svg id=\"debug-grid\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" preserveAspectRatio=\"xMaxYMid slice\" viewport-fill=\"hsl(0,0%,100%)\" viewport-fill-opacity=\"1\" style=\"fill:none;stroke:none;stroke-width:1px;fill:none;fill-rule:evenodd;\">\n<defs>\n	<pattern id=\"pat-baseline-12px\" class=\"baseline base12\" x=\"0\" y=\"0\" width=\"20\" height=\"12\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.0\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"3\" y2=\"3\" stroke-opacity=\"0.125\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"6\" y2=\"6\" stroke-opacity=\"0.375\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"9\" y2=\"9\" stroke-opacity=\"0.125\"/>\n	</pattern>\n\n	<pattern id=\"pat-baseline-24px\" class=\"baseline base12\" x=\"0\" y=\"0\" width=\"20\" height=\"24\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.0\"/>\n	</pattern>\n\n	<pattern id=\"pat-baseline-10px\" class=\"baseline base10\" x=\"0\" y=\"0\" width=\"20\" height=\"10\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.00\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"5\" y2=\"5\" stroke-opacity=\"0.75\"/>\n	</pattern>\n	<pattern id=\"pat-baseline-20px\" class=\"baseline base10\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.0\"/>\n	</pattern>\n	<pattern id=\"pat-cols-220px\" x=\"0\" y=\"0\" width=\"220\" height=\"36\" patternUnits=\"userSpaceOnUse\">\n		<rect transform=\"translate(0,0)\" x=\"0\" y=\"0\" width=\"20\" height=\"100%\" fill=\"hsl(336,50%,40%)\" fill-opacity=\"0.1\"/>\n		<rect transform=\"translate(200,0)\" x=\"0\" y=\"0\" width=\"20\" height=\"100%\" fill=\"hsl(336,50%,40%)\" fill-opacity=\"0.1\"/>\n		<line transform=\"translate(20 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,60%)\" stroke-opacity=\"0.2\"/>\n		<line transform=\"translate(200 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,40%)\" stroke-opacity=\"0.2\"/>\n\n		<line transform=\"translate(140 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,40%)\" stroke-opacity=\"0.3\"/>\n		<line transform=\"translate(80 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,40%)\" stroke-opacity=\"0.3\"/>\n\n		<line transform=\"translate(0 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(236,50%,40%)\" stroke-opacity=\"0.4\" stroke-width=\"1\"/>\n		<line transform=\"translate(220 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(236,50%,40%)\" stroke-opacity=\"0.4\" stroke-width=\"1\"/>\n	</pattern>\n</defs>\n<g id=\"debug-grid-body\" transform=\"translate(0 0.5)\">\n	<rect id=\"baseline\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\"/>\n	<g id=\"debug-grid-container\">\n		<g id=\"debug-grid-content\">\n			<rect id=\"baseline-content\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\"/>\n			<line id=\"gct0\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n			<line id=\"gct1\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n		</g>\n		<line id=\"gnv0\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n		<line id=\"gnv1\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n	</g>\n\n	<g id=\"abs-cols\">\n		<rect id=\"columns\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\"/>\n	</g>\n\n	<g id=\"rel-cols\">\n		<line id=\"le\" class=\"vguide edge\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n		<line id=\"re\" class=\"vguide edge\" x1=\"100%\" x2=\"100%\" y1=\"0\" y2=\"100%\"/>\n\n		<line id=\"gl0\" class=\"vguide margin\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n		<line id=\"gl1\" class=\"vguide gutter\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n\n		<line id=\"gr0\" class=\"vguide margin\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n		<line id=\"gr1\" class=\"vguide gutter\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n\n		<line id=\"gm\" class=\"vguide\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n	</g>\n</g>\n</svg>\n";
},"useData":true});

},{"hbsfy/runtime":21}],37:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"1":function(container,depth0,helpers,partials,data) {
    var stack1;

  return "	<dd id=\"select-layout\">\n		<select size=1>\n"
    + ((stack1 = helpers.each.call(depth0 != null ? depth0 : {},(depth0 != null ? depth0.layouts : depth0),{"name":"each","hash":{},"fn":container.program(2, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "		</select>\n	</dd>\n";
},"2":function(container,depth0,helpers,partials,data) {
    var alias1=container.lambda, alias2=container.escapeExpression;

  return "			<option value=\""
    + alias2(alias1(depth0, depth0))
    + "\">"
    + alias2(alias1(depth0, depth0))
    + "</option>\n";
},"4":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {};

  return "		<li class=\""
    + ((stack1 = helpers["if"].call(alias1,depth0,{"name":"if","hash":{},"fn":container.program(5, data, 0),"inverse":container.program(7, data, 0),"data":data})) != null ? stack1 : "")
    + "\">"
    + container.escapeExpression(((helper = (helper = helpers.key || (data && data.key)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(alias1,{"name":"key","hash":{},"data":data}) : helper)))
    + "</li>\n";
},"5":function(container,depth0,helpers,partials,data) {
    return "passed";
},"7":function(container,depth0,helpers,partials,data) {
    return "failed";
},"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, alias1=depth0 != null ? depth0 : {}, alias2=container.escapeExpression;

  return "<dl class=\"debug-links color-bg\">\n	<dt id=\"links-toggle\">\n		<svg class=\"icon\" viewBox=\"-100 -100 200 200\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" preserveAspectRatio=\"xMidYMid meet\">\n			<path id=\"cog\" d=\"M11.754,-99.307c-7.809,-0.924 -15.699,-0.924 -23.508,0l-3.73,20.82c-6.254,1.234 -12.338,3.21 -18.123,5.888l-15.255,-14.651c-6.861,3.842 -13.244,8.48 -19.018,13.818l9.22,19.036c-4.335,4.674 -8.095,9.849 -11.201,15.416l-20.953,-2.886c-3.292,7.141 -5.731,14.645 -7.265,22.357l18.648,9.981c-0.759,6.329 -0.759,12.727 0,19.056l-18.648,9.981c1.534,7.712 3.973,15.216 7.265,22.357l20.953,-2.886c3.106,5.567 6.866,10.742 11.201,15.416l-9.22,19.036c5.774,5.338 12.157,9.976 19.018,13.818l15.255,-14.651c5.785,2.678 11.869,4.654 18.123,5.888l3.73,20.82c7.809,0.924 15.699,0.924 23.508,0l3.73,-20.82c6.254,-1.234 12.338,-3.21 18.123,-5.888l15.255,14.651c6.861,-3.842 13.244,-8.48 19.018,-13.818l-9.22,-19.036c4.335,-4.674 8.095,-9.849 11.201,-15.416l20.953,2.886c3.292,-7.141 5.731,-14.645 7.265,-22.357l-18.648,-9.981c0.759,-6.329 0.759,-12.727 0,-19.056l18.648,-9.981c-1.534,-7.712 -3.973,-15.216 -7.265,-22.357l-20.953,2.886c-3.106,-5.567 -6.866,-10.742 -11.201,-15.416l9.22,-19.036c-5.774,-5.338 -12.157,-9.976 -19.018,-13.818l-15.255,14.651c-5.785,-2.678 -11.869,-4.654 -18.123,-5.888l-3.73,-20.82ZM0,-33c18.213,0 33,14.787 33,33c0,18.213 -14.787,33 -33,33c-18.213,0 -33,-14.787 -33,-33c0,-18.213 14.787,-33 33,-33Z\" style=\"fill:currentColor;fill-rule:evenodd;\"/>\n		</svg>\n	</dt>\n	<dt id=\"app-state\">\n		<span class=\"color-fg color-bg\" data-prop=\"collapsed\">c</span><span class=\"color-fg color-bg\" data-prop=\"withBundle\">b</span><span class=\"color-fg color-bg\" data-prop=\"withMedia\">m</span><span class=\"color-fg color-bg\" data-prop=\"withArticle\">a</span>\n	</dt>\n"
    + ((stack1 = helpers["if"].call(alias1,(depth0 != null ? depth0.layouts : depth0),{"name":"if","hash":{},"fn":container.program(1, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "	<dd id=\"edit-backend\">\n		<a href=\""
    + alias2((helpers.global || (depth0 && depth0.global) || helpers.helperMissing).call(alias1,"APP_ROOT",{"name":"global","hash":{},"data":data}))
    + "symphony/\" class=\"color-fg color-bg\" target=\"_blank\">CMS</a>\n	</dd>\n	<dd id=\"toggle-tests\">\n		<a href=\"#toggle-tests\" class=\"color-fg color-bg\">Tests</a>\n	</dd>\n	<dd id=\"toggle-blocks\">\n		<a href=\"#toggle-blocks\" class=\"color-fg color-bg\">Blocks</a>\n	</dd>\n	<dd id=\"toggle-tx\">\n		<a href=\"#toggle-blocks\" class=\"color-fg color-bg\">TX/FX</a>\n	</dd>\n	<dd id=\"toggle-grid-bg\">\n		<a href=\"#toggle-grid-bg\" class=\"color-fg color-bg\">Grid</a>\n	</dd>\n	<dd id=\"toggle-graph\">\n		<a href=\"#toggle-graph\" class=\"color-fg color-bg\">Graph</a>\n	</dd>\n	<dd id=\"toggle-mdown\">\n		<a href=\"#toggle-mdown\" class=\"color-fg color-bg\">Markdown</a>\n	</dd>\n	<dd id=\"toggle-logs\">\n		<a href=\"#toggle-logs\" class=\"color-fg color-bg\">Logs</a>\n	</dd>\n	<dd id=\"media-info\">\n		<span></span>\n	</dd>\n	<dd id=\"viewport-info\">\n		<span></span>\n	</dd>\n</dl>\n<div id=\"test-results\">\n	<h6>Tests <a id=\"toggle-passed\" href=\"#toggle-passed\">Passed</a></h6>\n	<p>"
    + alias2(container.lambda(((stack1 = (depth0 != null ? depth0.navigator : depth0)) != null ? stack1.userAgent : stack1), depth0))
    + "</p>\n	<ul>\n"
    + ((stack1 = helpers.each.call(alias1,(depth0 != null ? depth0.tests : depth0),{"name":"each","hash":{},"fn":container.program(4, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "	</ul>\n</div>\n";
},"useData":true});

},{"hbsfy/runtime":21}],38:[function(require,module,exports){
/**
 * @module app/model/BaseItem
 * @requires module:backbone
 */

/** @type {module:backbone} */
var Backbone = require("backbone");

module.exports = Backbone.Model.extend({

	defaults: {
		routeName: "initial",
		collapsed: false,
		article: null,
		withArticle: false,
		bundle: null,
		withBundle: false,
		media: null,
		withMedia: false,
	},

	initialize: function() {
		Object.keys(this.defaults).forEach(function(getterName) {
			Object.defineProperty(this, getterName, {
				enumerable: true,
				get: function() {
					return this.get(getterName);
				}
			});
		});
	}
});
},{"backbone":"backbone"}],39:[function(require,module,exports){
/**
 * @module app/model/BaseItem
 * @requires module:backbone
 */

/** @type {module:backbone} */
var Model = require("backbone").Model;
/** @type {module:underscore} */
var _ = require("underscore");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
// /** @type {module:app/utils/strings/stripTags} */
// var stripTags = require("utils/strings/stripTags");
// /** @type {module:app/model/parseSymAttrs} */
//var parseSymAttrs = require("app/model/parseSymAttrs");

var parseSymAttrs = function(s) {
	return s.replace(/(\,|\;)/g, function(m) {
		return (m == ",") ? ";" : ",";
	});
};
var toAttrsHash = function(obj, attr) {
	if (_.isString(attr)) {
		var idx = attr.indexOf(":");
		if (idx > 0) {
			obj[attr.substring(0, idx)] = parseSymAttrs(attr.substring(idx + 1));
		} else {
			obj[attr] = attr; // to match HTML5<>XHTML valueless attributes
		}
	} // else ignore non-string values
	return obj;
};

var BaseItemProto = {

	_domPrefix: "_",

	/** @type {Object} */
	defaults: {
		// attrs: function() { return {}; },
		get attrs() {
			return {};
		},
	},

	getters: ["domid"],

	mutators: {
		domid: function() {
			if (!this.hasOwnProperty("_domId"))
				this._domId = this._domPrefix + this.id;
			return this._domId;
		},
		attrs: {
			set: function(key, value, options, set) {
				if (Array.isArray(value)) {
					value = value.reduce(toAttrsHash, {});
				}
				if (!_.isObject(value)) {
					console.error("%s::attrs value not an object or string array", this.cid, value);
					value = {};
				}
				set(key, value, options);
			}
		},
	},

	attr: function(attr) {
		return this.attrs()[attr];
	},

	attrs: function() {
		return this.get("attrs");
	},

	toString: function() {
		return this.get("domid");
	}
};

var BaseItem = {
	extend: function(proto, obj) {
		var constr, propName; //, propDef;
		for (propName in proto) {
			if (proto.hasOwnProperty(propName) && _.isObject(proto[propName])) { //(Object.getPrototypeOf(proto[propName]) === Object.prototype)) {
				_.defaults(proto[propName], BaseItemProto[propName]);
				// console.log("BaseItem::extend '%s:%s' is Object\n%s", proto._domPrefix, p, JSON.stringify(proto[p]));
			}
		}
		// if (proto.properties && this.prototype.properties) {
		// 	_.defaults(proto.properties, this.prototype.properties);
		// }
		constr = Model.extend.apply(this, arguments);

		if (Array.isArray(constr.prototype.getters)) {
			constr.prototype.getters.forEach(function(getterName) {
				Object.defineProperty(constr.prototype, getterName, {
					enumerable: true,
					get: function() {
						return this.get(getterName);
					}
				});
			});
		}
		// if (_.isObject(proto.properties)) {
		// 	for (propName in proto.properties) {
		// 		if (proto.properties.hasOwnProperty(propName)) {
		// 			propDef = proto.properties[propName];
		// 			if (_.isFunction(propDef)) {
		// 				proto.properties[propName] = {
		// 					enumerable: true, get: propDef
		// 				};
		// 			} else if (_.isObject(propDef)){
		// 				propDef.enumerable = true;
		// 			} else {
		// 				delete proto.properties[propName];
		// 			}
		// 		}
		// 	}
		// 	Object.defineProperties(proto, proto.properties);
		// 	delete proto.properties;
		// }
		return constr;
	}
};

/**
 * @constructor
 * @type {module:app/model/BaseItem}
 */
module.exports = BaseItem.extend.call(Model, BaseItemProto, BaseItem);
// module.exports = Model.extend(BaseItemProto, BaseItem);

},{"backbone":"backbone","underscore":"underscore"}],40:[function(require,module,exports){
/**
 * @module app/model/SelectableCollection
 */

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Backbone = require("backbone");

/**
 * @constructor
 * @type {module:app/model/SelectableCollection}
 */
var SelectableCollection = Backbone.Collection.extend({

	initialize: function(models, options) {
		options = _.defaults({}, options, {
			initialSelection: "none",
			silentInitial: true
		});
		this.initialSelection = options.initialSelection;
		this.initialOptions = {
			silent: options.silentInitial
		};
	},

	reset: function(models, options) {
		this.deselect(this.initialOptions);
		Backbone.Collection.prototype.reset.apply(this, arguments);
		if (this.initialSelection === "first" && this.length) {
			this.select(this.at(0), this.initialOptions);
		}
	},

	select: function(newModel, options) {
		if (newModel === void 0) {
			newModel = null;
		}
		if (this.selected === newModel) {
			return;
		}
		var triggerEvents = !(options && options.silent);
		var oldModel = this.selected;

		this.lastSelected = this.selected;
		this.lastSelectedIndex = this.selectedIndex;
		this.selected = newModel;
		this.selectedIndex = this.indexOf(newModel);

		if (oldModel) {
			if (_.isFunction(oldModel.deselect)) {
				oldModel.deselect(options);
			} else if (triggerEvents) {
				oldModel.selected = void 0;
				oldModel.trigger("deselected", newModel, oldModel);
			}
			if (triggerEvents) this.trigger("deselect:one", oldModel);
		} else {
			if (triggerEvents) this.trigger("deselect:none", null);
		}

		if (newModel) {
			if (_.isFunction(newModel.select)) {
				newModel.select(options);
			} else if (triggerEvents) {
				newModel.selected = true;
				newModel.trigger("selected", newModel, oldModel);
			}
			if (triggerEvents) this.trigger("select:one", newModel);
		} else {
			if (triggerEvents) this.trigger("select:none", null);
		}
	},

	deselect: function(options) {
		this.select(null, options);
	},

	selectAt: function(index, options) {
		if (0 > index || index >= this.length) {
			new RangeError("index is out of bounds");
		}
		this.select(this.at(index), options);
	},

	distance: function(a, b) {
		var aIdx, bIdx;

		if (!a) return NaN;
		aIdx = this.indexOf(a);
		if (aIdx == -1) return NaN;

		if (arguments.length == 1) {
			bIdx = this.selectedIndex;
		} else {
			if (!b) return NaN;
			bIdx = this.indexOf(b);
			if (bIdx == -1) return NaN;
		}
		return Math.abs(bIdx - aIdx);
	},

	/* TODO: MOVE INTO MIXIN */

	/** @return boolean	/*/
	hasFollowing: function(model) {
		model || (model = this.selected);
		return this.indexOf(model) < (this.length - 1);
	},

	/** @return next model	*/
	following: function(model) {
		model || (model = this.selected);
		return this.hasFollowing(model) ? this.at(this.indexOf(model) + 1) : null;
	},

	/** @return next model or the beginning if at the end */
	followingOrFirst: function(model) {
		model || (model = this.selected);
		return this.at((this.indexOf(model) + 1) % this.length);
	},

	/** @return boolean	/*/
	hasPreceding: function(model) {
		model || (model = this.selected);
		return this.indexOf(model) > 0;
	},

	/** @return the previous model */
	preceding: function(model) {
		model || (model = this.selected);
		return this.hasPreceding(model) ? this.at(this.indexOf(model) - 1) : null;
	},

	/** @return the previous model or the end if at the beginning */
	precedingOrLast: function(model) {
		model || (model = this.selected);
		var index = this.indexOf(model) - 1;
		return this.at(index > -1 ? index : this.length - 1);
	},

});

module.exports = SelectableCollection;

},{"backbone":"backbone","underscore":"underscore"}],41:[function(require,module,exports){
/**
 * @module app/model/collection/ArticleCollection
 */

/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/model/item/ArticleItem} */
var ArticleItem = require("app/model/item/ArticleItem");

/**
 * @constructor
 * @type {module:app/model/collection/ArticleCollection}
 */
var ArticleCollection = SelectableCollection.extend({

	/** @type {Backbone.Model} */
	model: ArticleItem

});

module.exports = new ArticleCollection();
},{"app/model/SelectableCollection":40,"app/model/item/ArticleItem":46}],42:[function(require,module,exports){
/**
 * @module app/model/collection/BundleCollection
 */

/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/model/item/BundleItem} */
var BundleItem = require("app/model/item/BundleItem");

/**
 * @constructor
 * @type {module:app/model/collection/BundleCollection}
 */
var BundleCollection = SelectableCollection.extend({

	/** @type {Backbone.Model} */
	model: BundleItem,

	/** @type {Function} */
	comparator: function(oa, ob) {
		var a = oa.get("completed");
		var b = ob.get("completed");
		if (a > b) {
			return -1;
		} else if (a < b) {
			return 1;
		} else {
			return 0;
		}
	},

	/** @type {String} */
	url: "/json/bundles/",

});

module.exports = new BundleCollection();

},{"app/model/SelectableCollection":40,"app/model/item/BundleItem":47}],43:[function(require,module,exports){
/**
 * @module app/model/collection/KeywordCollection
 * @requires module:backbone
 */

/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/model/item/KeywordItem} */
var KeywordItem = require("app/model/item/KeywordItem");

/**
 * @constructor
 * @type {module:app/model/collection/KeywordCollection}
 */
var KeywordCollection = SelectableCollection.extend({

	/** @type {Backbone.Model} */
	model: KeywordItem

});

module.exports = new KeywordCollection();

},{"app/model/SelectableCollection":40,"app/model/item/KeywordItem":48}],44:[function(require,module,exports){
/**
 * @module app/model/collection/TypeCollection
 * @requires module:backbone
 */

/** @type {module:backbone} */
var Backbone = require("backbone");

/** @type {module:app/model/item/TypeItem} */
var TypeItem = require("app/model/item/TypeItem");

/**
 * @constructor
 * @type {module:app/model/collection/TypeCollection}
 */
var TypeCollection = Backbone.Collection.extend({

	/** @type {Backbone.Model} */
	model: TypeItem

});

module.exports = new TypeCollection();

},{"app/model/item/TypeItem":51,"backbone":"backbone"}],45:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");

module.exports = function(bootstrap) {

	/** @type {module:app/control/Globals} */
	var Globals = require("app/control/Globals");

	// Globals.GA_TAGS = bootstrap["ga-tags"];
	// Globals.PARAMS = bootstrap["params"];
	// Globals.APP_ROOT = bootstrap["params"]["root"];
	// Globals.MEDIA_DIR = bootstrap["params"]["uploads"];
	Globals.APP_NAME = bootstrap["params"]["website-name"];

	/** @type {module:app/model/collection/TypeCollection} */
	var typeList = require("app/model/collection/TypeCollection");
	/** @type {module:app/model/collection/KeywordCollection} */
	var keywordList = require("app/model/collection/KeywordCollection");
	/** @type {module:app/model/collection/BundleCollection} */
	var bundleList = require("app/model/collection/BundleCollection");
	/** @type {module:app/model/collection/ArticleCollection} */
	var articleList = require("app/model/collection/ArticleCollection");

	// Fix-ups to bootstrap data.
	var articles = bootstrap["articles-all"];
	var types = bootstrap["types-all"];
	var keywords = bootstrap["keywords-all"];
	var bundles = bootstrap["bundles-all"];
	var media = bootstrap["media-all"];

	// Attach media to their bundles
	var mediaByBundle = _.groupBy(media, "bId");

	// Fill-in back-references:
	// Create Keyword.bundleIds from existing Bundle.keywordIds,
	// then Bundle.typeIds from unique Keyword.typeId

	// _.each(bundles, function (bo, bi, ba) {
	bundles.forEach(function(bo, bi, ba) {
		bo.tIds = [];
		bo.media = mediaByBundle[bo.id];
		// _.each(keywords, function (ko, ki, ka) {
		keywords.forEach(function(ko, ki, ka) {
			if (bi === 0) {
				ko.bIds = [];
			}
			// if (_.contains(bo.kIds, ko.id)) {
			if (bo.kIds.indexOf(ko.id) != -1) {
				ko.bIds.push(bo.id);
				// if (!_.contains(bo.tIds, ko.tId)) {
				if (bo.tIds.indexOf(ko.tId) == -1) {
					bo.tIds.push(ko.tId);
				}
			}
		});
	});

	// Fill collection singletons
	articleList.reset(articles);
	typeList.reset(types);
	keywordList.reset(keywords);
	bundleList.reset(bundles);

	// bootstrap["params"] = bootstrap["articles-all"] = bootstrap["types-all"] = bootstrap["keywords-all"] = bootstrap["bundles-all"] = bootstrap["media-all"] = null;
};
},{"app/control/Globals":34,"app/model/collection/ArticleCollection":41,"app/model/collection/BundleCollection":42,"app/model/collection/KeywordCollection":43,"app/model/collection/TypeCollection":44,"underscore":"underscore"}],46:[function(require,module,exports){
/**
 * @module app/model/item/ArticleItem
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");

/**
 * @constructor
 * @type {module:app/model/item/ArticleItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "a",

	/** @type {Object} */
	defaults: {
		name: "",
		handle: "",
		text: ""
	},

});
},{"app/model/BaseItem":39}],47:[function(require,module,exports){
/**
 * @module app/model/item/BundleItem
 * @requires module:backbone
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
var Color = require("color");

/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");
/** @type {module:app/model/item/MediaItem} */
var MediaItem = require("app/model/item/MediaItem");
/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/utils/strings/stripTags} */
var stripTags = require("utils/strings/stripTags");
// /** @type {module:app/utils/strings/parseTaglist} */
// var parseSymAttrs = require("app/model/parseSymAttrs");

// /** @type {module:app/model/collection/KeywordCollection} */
// var keywords = require("app/model/collection/KeywordCollection");

// Globals.DEFAULT_COLORS["color"];
// Globals.DEFAULT_COLORS["background-color"];
var attrsDefault = _.defaults({
	"has-colors": "defaults"
}, Globals.DEFAULT_COLORS);

/** @private */
var MediaCollection = SelectableCollection.extend({
	model: MediaItem,
	comparator: "o"
});

/**
 * @constructor
 * @type {module:app/model/item/BundleItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "b",

	/** @type {Object|Function} */
	// defaults: function() {
	// 	return {
	// 		name: "",
	// 		handle: "",
	// 		desc: "",
	// 		completed: 0,
	// 		kIds: [],
	// 	};
	// },
	defaults: {
		name: "",
		handle: "",
		desc: "",
		completed: 0,
		get kIds() {
			return [];
		},
		// get keywords() { return []; },
	},

	getters: ["name", "media"],

	mutators: {
		text: function() {
			return stripTags(this.get("desc"));
		},
		// kIds: {
		// 	set: function (key, value, options, set) {
		// 		if (Array.isArray(value)) {
		// 			set("keywords", value.map(function(id) {
		// 				var obj = keywords.get(id);
		// 				return obj;
		// 			}, this), options;
		// 		}
		// 		set(key, value, options);
		// 	},
		// },
		media: {
			transient: true,
			set: function(key, value, options, set) {
				if (Array.isArray(value)) {
					value.forEach(function(o) {
						o.bundle = this;
					}, this);
					value = new MediaCollection(value);
				}
				set(key, value, options);
			},
		},
	},

	initialize: function(attrs, options) {
		this.colors = {
			fgColor: new Color(this.attr("color")),
			bgColor: new Color(this.attr("background-color")),
			lnColor: new Color(this.attr("link-color")),
		};
		this.colors.hasDarkBg = this.colors.fgColor.luminosity() > this.colors.bgColor.luminosity();
	},

	attrs: function() {
		return this._attrs || (this._attrs = _.defaults({}, this.get("attrs"), attrsDefault));
	},
});
},{"app/control/Globals":34,"app/model/BaseItem":39,"app/model/SelectableCollection":40,"app/model/item/MediaItem":49,"color":"color","underscore":"underscore","utils/strings/stripTags":117}],48:[function(require,module,exports){
/**
 * @module app/model/item/KeywordItem
 * @requires module:app/model/BaseItem
 */

/** @type {module:app/model/BaseItem} */
var BaseItem = require("app/model/BaseItem");

// /** @type {module:app/model/collection/TypeCollection} */
// var types = require("app/model/collection/TypeCollection");

/**
 * @constructor
 * @type {module:app/model/item/KeywordItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "k",

	/** @type {Object} */
	defaults: {
		name: "",
		handle: "",
		tId: -1,
	},

	// mutators: {
	// 	tId: {
	// 		set: function (key, value, options, set) {
	// 			var type = types.get(value);
	// 			if (type) {
	// 				type.get("keywords").push(this);
	// 				set("type", type, options);
	// 			}
	// 			set(key, value, options);
	// 		}
	// 	},
	// }
});

},{"app/model/BaseItem":39}],49:[function(require,module,exports){
/**
 * @module app/model/item/MediaItem
 * @requires module:backbone
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
var Color = require("color");

/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");
/** @type {module:app/model/item/SourceItem} */
var SourceItem = require("app/model/item/SourceItem");
/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/utils/strings/stripTags} */
var stripTags = require("utils/strings/stripTags");
// /** @type {module:app/model/parseSymAttrs} */
// var parseSymAttrs = require("app/model/parseSymAttrs");

// console.log(Globals.PARAMS);

var urlTemplates = {
	"original": _.template(Globals.MEDIA_DIR + "/<%= src %>"),
	"constrain-width": _.template(Globals.APP_ROOT + "image/1/<%= width %>/0/uploads/<%= src %>"),
	"constrain-height": _.template(Globals.APP_ROOT + "image/1/0/<%= height %>/uploads/<%= src %>"),
	"debug-bandwidth": _.template(Globals.MEDIA_DIR.replace(/(https?\:\/\/[^\/]+)/, "$1/slow/<%= kbps %>") + "/<%= src %>"),
};

/**
 * @constructor
 * @type {module:app/model/item/MediaItem.SourceCollection}
 */
var SourceCollection = SelectableCollection.extend({
	model: SourceItem
});

/**
 * @constructor
 * @type {module:app/model/item/MediaItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "m",

	/** @type {Object} */
	defaults: {
		name: "<p><em>Untitled</em></p>",
		sub: "",
		o: 0,
		bId: -1,
		srcIdx: 0,
		get srcset() {
			return [];
		},
		get sources() {
			return new SourceCollection();
		},
	},

	getters: ["name", "bundle", "source", "sources"],

	mutators: {
		// desc: function() {
		// 	return this.get("name");
		// },
		handle: function() {
			return this.get("src");
		},
		text: function() {
			if (!this.hasOwnProperty("_text"))
				this._text = _.unescape(stripTags(this.get("name")));
			return this._text;
		},
		attrs: {
			set: function(key, value, opts, set) {
				this._attrs = null;
				BaseItem.prototype.mutators.attrs.set.apply(this, arguments);
				this._updateSources();
			}
		},
		srcset: {
			set: function(key, value, opts, set) {
				set(key, value, opts);
				this.get("sources").reset(value, opts);
				this._updateSources();
			}
		},
		source: {
			transient: true,
			get: function() {
				return this.get("sources").at(this.get("srcIdx"));
			},
		},
	},

	initialize: function() {
		this._updateColors();
		this.listenTo(this, "change:attrs change:bundle", function() {
			this._attrs = null;
		});
	},

	attrs: function() {
		return this._attrs || (this._attrs = _.defaults({}, this.get("bundle").attrs(), this.get("attrs")));
	},

	_updateColors: function() {
		this.colors = {
			fgColor: new Color(this.attr("color")),
			bgColor: new Color(this.attr("background-color"))
		};
		this.colors.hasDarkBg = this.colors.fgColor.luminosity() > this.colors.bgColor.luminosity();
	},

	_updateSources: function() {
		var srcObj = {
			kbps: this.attr("@debug-bandwidth")
		};
		var srcTpl = urlTemplates[srcObj.kbps ? "debug-bandwidth" : "original"];
		this.get("sources").forEach(function(item) {
			srcObj.src = item.get("src");
			item.set("original", srcTpl(srcObj));
		});
	},

	// _updateSourcesArr: function() {
	// 	var srcset = this.get("srcset");
	// 	if (Array.isArray(srcset)) {
	// 		var srcObj = { kbps: this.attr("@debug-bandwidth") };
	// 		var srcTpl = Globals.MEDIA_SRC_TPL[srcObj.kbps? "debug-bandwidth" : "original"];
	// 		srcset.forEach(function(o) {
	// 			srcObj.src = o.src;
	// 			o.original = srcTpl(srcObj);
	// 		}, this);
	// 	}
	// 	this.get("sources").reset(srcset);
	// },

});
},{"app/control/Globals":34,"app/model/BaseItem":39,"app/model/SelectableCollection":40,"app/model/item/SourceItem":50,"color":"color","underscore":"underscore","utils/strings/stripTags":117}],50:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/model/item/SourceItem
 * @requires module:backbone
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");

/** @type {String} */
var noCacheSuffix = "?" + Date.now();

/**
 * @constructor
 * @type {module:app/model/item/SourceItem}
 */
// module.exports = Backbone.Model.extend({
module.exports = BaseItem.extend({

	/** @type {Object} */
	defaults: {
		src: null,
		mime: null,
		w: null,
		h: null,
	},

	getters: ["src", "original"],

	mutators: {
		src: {
			set: function(key, value, options, set) {
				if (DEBUG) {
					value += noCacheSuffix;
				}
				set(key, value, options);
			}
		},
		// original: { 
		// 	transient: true,
		// 	get: function (key, value, options, set) {
		// 		return this.attributes.original || (this.attributes.original = this._composeOriginalSrc());
		// 	},
		// },
		// media: {
		// 	transient: true,
		// 	get: function () {
		// 		var retval;
		// 		if (this._noRecusion) {
		// 			console.log("%s::media returning null", this.cid);
		// 			retval = null;//this.id;
		// 		} else {
		// 			console.log("%s::media returning Object", this.cid);
		// 			this._noRecusion = true;
		// 			retval = this.attributes.media;
		// 			this._noRecusion = false;
		// 		}
		// 		return retval;
		// 	},
		// 	set: function (key, value, options, set) {
		// 		if (value instanceof BaseItem) {
		// 			set(key, value, options);
		// 		}
		// 	},
		// },
	},

	// initialize: function() {
	// 	if (DEBUG) {
	// 		var cb = function() {
	// 			// console.log("@debug-bandwidth:", JSON.stringify(this.get("media").attr("@debug-bandwidth")));
	// 			console.log("media:", JSON.stringify(this.toJSON()));
	// 			// if ((this.get("media") instanceof BaseItem) && this.get("media").attr("@debug-bandwidth")) {
	// 			// 	console.log("original", this.get("original"));
	// 			// 	console.log("media:", JSON.stringify(this.get("media").toJSON()));
	// 			// }
	// 		}.bind(this);
	// 		window.requestAnimationFrame(cb);
	// 	}
	// },
	// 
	// _composeOriginalSrc: function() {
	// 	var values = { src: this.get("src") };
	// 	if (this.has("media") && (values.kbps = this.get("media").attr("@debug-bandwidth"))) {
	// 	// if (this.has("media") && this.get("media").attrs().hasOwnProperty("@debug-bandwidth")) {
	// 	// 	values.kbps = this.get("media").attrs()["@debug-bandwidth"];
	// 		return Globals.MEDIA_SRC_TPL["debug-bandwidth"](values);
	// 	}
	// 	return Globals.MEDIA_SRC_TPL["original"](values);
	// },
});

}).call(this,true)

},{"app/model/BaseItem":39}],51:[function(require,module,exports){
/**
 * @module app/model/item/TypeItem
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");

/**
 * @constructor
 * @type {module:app/model/item/TypeItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "t",

	/** @type {Object} */
	defaults: {
		name: "",
		handle: "",
		// get kIds() { return []; },
		// get keywords() { return []; },
	},

});

},{"app/model/BaseItem":39}],52:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/view/AppView
/*/

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Backbone = require("backbone");

/** @type {module:app/utils/debug/traceArgs} */
var stripTags = require("utils/strings/stripTags");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/control/Controller} */
var controller = require("app/control/Controller");
/** @type {module:app/model/AppState} */
var AppState = require("app/model/AppState");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/NavigationView} */
var NavigationView = require("app/view/NavigationView");
/** @type {module:app/view/ContentView} */
var ContentView = require("app/view/ContentView");


/** @type {module:app/view/base/TouchManager} */
var TouchManager = require("app/view/base/TouchManager");
// /** @type {module:hammerjs} */
// var Hammer = require("hammerjs");
// /** @type {module:utils/touch/SmoothPanRecognizer} */
// var Pan = require("utils/touch/SmoothPanRecognizer");
// /** @type {module:hammerjs.Tap} */
// var Tap = Hammer.Tap;

// /** @type {module:utils/debug/traceElement} */
// var traceElement = require("utils/debug/traceElement");
//
// var vpanLogFn = _.debounce(console.log.bind(console), 100, false);
// var hpanLogFn = _.debounce(console.log.bind(console), 100, false);

var AppView = {
	getInstance: function() {
		if (!(window.app instanceof this)) {
			window.app = new(this)({
				model: new AppState()
			});
		}
		return window.app;
	}
};

var AppViewProto = {

	/** @override */
	cidPrefix: "app",
	/** @override */
	el: "html",
	// /** @override */
	className: "app without-bundle without-media without-article",
	/** @override */
	model: AppState,

	/** @override */
	events: {
		"visibilitychange": function(ev) {
			console.log(ev.type);
		},
		"fullscreenchange": function(ev) {
			console.log(ev.type);
		},
		"dragstart": function(ev) {
			if (ev.target.nodeName == "IMG" || ev.target.nodeName == "A") {
				ev.defaultPrevented || ev.preventDefault();
			}
		}
	},

	properties: {
		container: {
			get: function() {
				return this._container ||
					(this._container = document.getElementById("container"));
				// (this._container = document.body);
			}
		},
		navigation: {
			get: function() {
				return this._navigation ||
					(this._navigation = document.getElementById("navigation"));
			}
		},
		content: {
			get: function() {
				return this._content ||
					(this._content = document.getElementById("content"));
			}
		},
	},

	/** @override */
	initialize: function(options) {
		/* elements */
		// this.routeEl = this.el;
		// this.stateEl = this.el
		this.breakpointEl = this.el;
		// this.touchEl = document.body;
		// this.touchEl = document.getElementById("containter");

		/* init HammerJS handlers */
		var vtouch, htouch;
		// var vpan, hpan, tap;

		// this._vpanEnableFn = function(mc, ev) {
		// 	var retval = !this._hasOverflowY(this.container);
		// 	vpanLogFn("%s::_vpanEnableFn -> %o\n%o", this.cid, retval, arguments);
		// 	return retval;
		// }.bind(this);
		//
		// this._hpanEnableFn = function(mc, ev) {
		// 	var retval = this.model.get("withBundle") && this.model.get("collapsed");
		// 	hpanLogFn("%s::_hpanEnableFn -> %o\n%o", this.cid, retval, arguments);
		// 	return !!retval;
		// }.bind(this);

		vtouch = htouch = TouchManager.init(this.content);
		// vtouch.get("vpan").set({ enable: this._vpanEnableFn });
		// htouch.get("hpan").set({ enable: this._hpanEnableFn });
// 		vtouch.set({
// 			enable: function() {
// 				console.log("app1::hammerjs enable", arguments);
// 				return true;
// 			}
// 		});
		// hpan = vpan;

		// this.el.style.touchAction = "none"; //"pan-x pan-y";

		// tap = new Hammer.Tap();
		// hpan = new Pan({
		// 	event: "hpan",
		// 	direction: Hammer.DIRECTION_HORIZONTAL
		// });
		// hpan.set({
		// 	enable: this._hpanEnableFn
		// });
		// vpan = new Pan({
		// 	event: "vpan",
		// 	direction: Hammer.DIRECTION_VERTICAL
		// });
		// vpan.set({
		// 	enable: this._vpanEnableFn
		// });
		// hpan.requireFailure(vpan);
		// vpan.requireFailure(hpan);

		// vtouch = new Hammer.Manager(this.navigation);
		// vtouch.add([]);

		// htouch = vtouch = new Hammer.Manager(this.content);
		// htouch.add([tap, hpan, vpan]);
		// htouch.add([hpan, vpan]);
		// htouch.set({ touchAction: "pan-x pan-y" });

		// vpan = new Hammer(this.navigation, {
		// 	recognizers: [
		// 		[Pan, {
		// 			event: 'vpan',
		// 			touchAction: "pan-y",
		// 			direction: Hammer.DIRECTION_VERTICAL,
		// 			enable: vpanEnableFn
		// 		}],
		// 	]
		// });
		// hpan = new Hammer(this.content, {
		// 	recognizers: [
		// 		[Pan, {
		// 			event: 'hpan',
		// 			touchAction: "pan-x",
		// 			direction: Hammer.DIRECTION_HORIZONTAL,
		// 			enable: hpanEnableFn
		// 		}],
		// 		[Tap]
		// 	]
		// });
		// hpan.get("hpan").requireFailure(vpan.get("vpan"));

		// this._afterRender = this._afterRender.bind(this);
		this._onResize = this._onResize.bind(this);

		/* render on resize, onorientationchange, visibilitychange */
		window.addEventListener("orientationchange", this._onResize, false);
		window.addEventListener("resize", _.debounce(this._onResize, 30, false), false);

		// var h = function(ev) { console.log(ev.type, ev) };
		// window.addEventListener("scroll", h, false);
		// window.addEventListener("wheel", h, false);

		/* TODO: replace resize w/ mediaquery listeners. Caveat: some components
		(vg. Carousel) require update on resize */
		// this._onBreakpointChange = this._onBreakpointChange.bind(this);
		// Object.keys(Globals.BREAKPOINTS).forEach(function(s) {
		// 	Globals.BREAKPOINTS[s].addListener(this._onBreakpointChange);
		// }, this);

		/* initialize controller/model listeners BEFORE views register their own */
		this.listenTo(controller, "route", this._onRoute);
		// this.listenTo(controller, "change:after", this._afterControllerChanged);
		this.listenTo(this.model, "change", this._onModelChange); /* FIXME */

		/* initialize views */
		this.navigationView = new NavigationView({
			el: this.navigation,
			model: this.model,
			vpan: vtouch,
			hpan: htouch
		});

		this.contentView = new ContentView({
			el: this.content,
			model: this.model,
			vpan: vtouch,
			hpan: htouch,
		});

		/* Google Analytics */
		if (window.ga && window.GA_ID) {
			controller
				.once("route", function() {
					window.ga("create", window.GA_ID, "auto");
					// if localhost or dummy ID, disable analytics
					if (/(?:(localhost|\.local))$/.test(location.hostname)
						|| window.GA_ID == "UA-9123564-8") {
						window.ga("set", "sendHitTask", null);
					}
				})
				.on("route", function(name) {
					var page = Backbone.history.getFragment();
					// Add a slash if neccesary
					page.replace(/^(?!\/)/, "/");
					window.ga("set", "page", page);
					window.ga("send", "pageview");
				});
		}

		/* Startup listener, added last */
		this.listenToOnce(controller, "route", this._appStart);

		/* start router, which will request appropiate state */
		Backbone.history.start({
			pushState: false,
			hashChange: true,
		});
	},

	/* -------------------------------
	/* _appStart
	/* ------------------------------- */

	_appStart: function(name, args) {
		console.info("%s::_appStart(%s, %s)", this.cid, name, args.join());
		// this._appStartChanged = true;

		this.skipTransitions = true;
		this.el.classList.add("skip-transitions");

		this.requestRender(View.MODEL_INVALID | View.SIZE_INVALID)
			.listenToOnce(this, "view:render:after", function(view, flags) {
				this.setImmediate(function() {
					// this.requestAnimationFrame(function() {
					console.log("%s::_appStart[view:render:after][setImmediate]", this.cid);
					// console.log("%s::_appStart[view:render:after][raf]", this.cid);
					this.skipTransitions = false;
					this.el.classList.remove("skip-transitions");
					this.el.classList.remove("app-initial");
				});
			});
	},

	/* --------------------------- *
	/* route changed
	/* --------------------------- */

	_onRoute: function(name, args) {
		var o = _.defaults({ routeName: name }, AppState.prototype.defaults);
		switch (name) {
			case "media-item":
				o.bundle = bundles.selected;
				o.withBundle = true;
				o.media = o.bundle.media.selected;
				o.withMedia = true;
				o.collapsed = true;
				break;
			case "bundle-item":
				o.bundle = bundles.selected;
				o.withBundle = true;
				o.collapsed = true;
				break;
			case "article-item":
				o.article = articles.selected;
				o.withArticle = true;
				o.collapsed = true;
				break;
			case "bundle-list":
			case "notfound":
			case "root":
			default:
				o.collapsed = false;
				break;
		}
		console.info("%s::_onRoute %o -> %o", this.cid, this.model.get("routeName"), name);
		// console.log("%s::_onRoute args: %o", this.cid, name, args);
		this.model.set(o);
	},

	/* --------------------------- *
	/* model changed
	/* --------------------------- */

	_onModelChange: function() {
		// console.log("%s::_onModelChange [START]", this.cid);
		console.group(this.cid + "::_onModelChange [render request]");
		this.requestRender(View.MODEL_INVALID)
			.once("view:render:after", function(view, flags) {
				console.info("%s::_onModelChange [render complete]", view.cid);
				console.groupEnd();
				// .whenRendered().then(function(view) {
				// this.requestAnimationFrame(function() {
				// 	console.log("%s::_onModelChange [next frame]", view.cid);
				// });
			});
	},

	/* -------------------------------
	/* resize
	/* ------------------------------- */

	_onResize: function() {
		// console.log("%s::_onResize [START]", this.cid);
		console.group(this.cid + "::_onResize [render request]");
		this.skipTransitions = true;
		this.el.classList.add("skip-transitions");

		// this.requestRender(View.SIZE_INVALID).renderNow();
		// this.requestAnimationFrame(function() {
		// 	this.el.classList.remove("skip-transitions");
		// }.bind(this));

		this.requestRender(View.SIZE_INVALID)
			// .whenRendered().then(function(view) {
			.once("view:render:after", function(view, flags) {
				console.info("%s::_onResize [render complete] %o + %o = %o + %o",
					view.cid, view.el.clientTop, view.el.clientHeight, view.el.scrollTop, view.el.scrollHeight);

				// if ((view.el.scrollTop < 1) && (view.el.clientHeight != view.el.scrollHeight)) {
				// 	view.el.scrollTop = 1;
				// }
				// if (/iphone/i.test(navigator.userAgent)) {
				// document.body.scrollTop = 1;
				// }

				this.requestAnimationFrame(function() {
					view.skipTransitions = false;
					view.el.classList.remove("skip-transitions");
					// window.scrollTo(0, 1);
					// document.body.scrollTop = 1;
					console.info("%s::_onResize [render removed skipTx]", view.cid);
					console.groupEnd();
				})
			});
	},

	// _hasOverflowY: function(el) {
	// 	var retval = false;
	// 	var trace = [];
	// 	var scrollEl = el;
	// 	do {
	// 		retval = retval || (scrollEl.scrollHeight != scrollEl.clientHeight);
	// 		trace.push(traceElement(scrollEl) + " " + scrollEl.scrollHeight + " == " + scrollEl.clientHeight);
	// 	} while (scrollEl = scrollEl.parentElement);
	// 	// this.navigation.style.touchAction = retval ? "pan-x" : "auto";
	// 	vpanLogFn("%s::_hasOverflowY(%s) -> %s %o", this.cid, traceElement(el), retval, trace);
	// 	return retval;
	// },

	// _onBreakpointChange: function(ev) {
	// 	console.log("%s::_onBreakpointChange", this.cid, ev.matches, ev.media, ev.target.className);
	// 	this.requestRender(View.SIZE_INVALID).renderNow();
	// },

	/* -------------------------------
	/* render
	/* ------------------------------- */

	renderFrame: function(tstamp, flags) {
		console.log("%s::renderFrame [%s]", this.cid, View.flagsToString(flags));

		/* model: set route & model id classes */
		if (flags & View.MODEL_INVALID) {
			this.renderModelChange(flags);
		}

		/* size: check breakpoints and set classes*/
		if (flags & View.SIZE_INVALID) {
			_.each(Globals.BREAKPOINTS, function(o, s) {
				this.toggle(s, o.matches);
			}, this.breakpointEl.classList);
		}
		/* request children render:  always render now */
		this.requestChildrenRender(flags, true);
		/* request children render:  set 'now' flag if size is invalid */
		// this.requestChildrenRender(flags, flags & View.SIZE_INVALID);

		if (flags & (View.MODEL_INVALID | View.SIZE_INVALID)) {
			// this.navigation.style.touchAction = !this._hasOverflowY(this.container) ? "pan-x" : "";
			// this.content.style.touchAction = this._hpanEnableFn() ? "pan-y" : "";
			// this.requestAnimationFrame(function() {
			// 	if (this._hpanEnableFn() && this._vpanEnableFn()) {
			// 		this.content.style.touchAction = "none";
			// 	} else if (this._hpanEnableFn()) {
			// 		this.content.style.touchAction = "pan-y";
			// 	} else if (this._vpanEnableFn()) {
			// 		this.content.style.touchAction = "pan-x";
			// 	} else {
			// 		this.content.style.touchAction = "auto";
			// 	}
			// 	// 	document.body.scrollTop = 0;
			// 	// 	window.scroll({ top: 0, behavior: "smooth" });
			// });

		}
	},

	/* -------------------------------
	/* body classes etc
	/* ------------------------------- */

	renderModelChange: function() {

		var cls = this.el.classList;
		var prevAttr = null;
		var docTitle = [];
		var hasDarkBg = false;

		docTitle.push(Globals.APP_NAME);
		if (this.model.get("bundle")) {
			docTitle.push(stripTags(this.model.get("bundle").get("name")));
			if (this.model.get("media")) {
				docTitle.push(stripTags(this.model.get("media").get("name")));
			}
		} else if (this.model.get("article")) {
			docTitle.push(stripTags(this.model.get("article").get("name")));
		}
		document.title = _.unescape(docTitle.join(" / "));

		/* Set route class */
		if (this.model.hasChanged("routeName")) {
			prevAttr = this.model.previous("routeName");
			if (prevAttr) {
				cls.remove("route-" + prevAttr);
			}
			cls.add("route-" + this.model.get("routeName"));
		}

		/* Set model id classes for color styles */
		["article", "bundle", "media"].forEach(function(prop) {
			var item = this.model.get(prop);
			if (this.model.hasChanged(prop)) {
				prevAttr = this.model.previous(prop);
				if (prevAttr) {
					cls.remove(prevAttr.get("domid"));
				}
				if (item) {
					cls.add(item.get("domid"));
				}
			}
			cls.toggle("with-" + prop, !!item);
			cls.toggle("without-" + prop, !item);
			hasDarkBg |= (item && item.colors && item.colors.hasDarkBg);
		}.bind(this));

		/* flag dark background */
		cls.toggle("color-dark", hasDarkBg);
	},
};

if (DEBUG) {
	/** @type {module:app/debug/DebugToolbar} */
	var DebugToolbar = require("app/debug/DebugToolbar");

	AppViewProto._onModelChange = (function(fn) {
		return function() {
			var retval;
			console.group(this.cid + "::_onModelChange");
			Object.keys(this.model.changedAttributes()).forEach(function(key) {
				var prev = this.model.previous(key),
					curr = this.model.get(key);
				console.info("%s::_onModelChange %s: %s -> %s", this.cid, key,
					prev && prev.toString(),
					curr && curr.toString());
			}, this);
			console.groupEnd();

			retval = fn.apply(this, arguments);
			return retval;
		};
	})(AppViewProto._onModelChange);

	AppViewProto.initialize = (function(fn) {
		return function() {
			// var ret = fn.apply(this, arguments);
			var view = new DebugToolbar({
				id: "debug-toolbar",
				model: this.model
			});
			document.body.appendChild(view.render().el);
			// this.listenTo(this.model, "change:layoutName", function() {
			// 	this.requestRender(View.SIZE_INVALID); //.renderNow();
			// });
			// return ret;
			return fn.apply(this, arguments);
		};
	})(AppViewProto.initialize);
}

/**
/* @constructor
/* @type {module:app/view/AppView}
/*/
module.exports = View.extend(AppViewProto, AppView);
}).call(this,true)

},{"app/control/Controller":33,"app/control/Globals":34,"app/debug/DebugToolbar":35,"app/model/AppState":38,"app/model/collection/ArticleCollection":41,"app/model/collection/BundleCollection":42,"app/view/ContentView":53,"app/view/NavigationView":54,"app/view/base/TouchManager":59,"app/view/base/View":60,"backbone":"backbone","underscore":"underscore","utils/strings/stripTags":117}],53:[function(require,module,exports){
/**
 * @module app/view/NavigationView
 */

/** @type {module:underscore} */
var _ = require("underscore");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:utils/TransformHelper} */
var TransformHelper = require("utils/TransformHelper");
// /** @type {module:app/view/base/TouchManager} */
// var TouchManager = require("app/view/base/TouchManager");

/** @type {module:app/control/Controller} */
var controller = require("app/control/Controller");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");

// /** @type {module:app/model/collection/BundleItem} */
// var BundleItem = require("app/model/item/BundleItem");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/ArticleView} */
var ArticleView = require("app/view/component/ArticleView");
/** @type {module:app/view/component/CollectionStack} */
var CollectionStack = require("app/view/component/CollectionStack");
/** @type {module:app/view/component/CollectionStack} */
var SelectableListView = require("app/view/component/SelectableListView");
/** @type {module:app/view/render/DotNavigationRenderer} */
var DotNavigationRenderer = require("app/view/render/DotNavigationRenderer");
/** @type {module:app/view/component/Carousel} */
var Carousel = require("app/view/component/Carousel");

/** @type {module:app/view/render/CarouselRenderer} */
var CarouselRenderer = require("app/view/render/CarouselRenderer");
/** @type {module:app/view/render/ImageRenderer} */
var ImageRenderer = require("app/view/render/ImageRenderer");
/** @type {module:app/view/render/VideoRenderer} */
var VideoRenderer = require("app/view/render/VideoRenderer");
/** @type {module:app/view/render/SequenceRenderer} */
var SequenceRenderer = require("app/view/render/SequenceRenderer");
// /** @type {module:app/view/component/ProgressMeter} */
// var ProgressMeter = require("app/view/component/ProgressMeter");

/** @type {Function} */
var carouselEmptyTemplate = require("./template/Carousel.EmptyRenderer.Bundle.hbs");
/** @type {Function} */
var mediaStackTemplate = require("./template/CollectionStack.Media.hbs");

// var transitionEnd = View.prefixedEvent("transitionend");
var transformProp = View.prefixedProperty("transform");
var transitionProp = View.prefixedProperty("transition");

var tx = Globals.transitions;


// var clickEvent = window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup",

/**
 * @constructor
 * @type {module:app/view/ContentView}
 */
var ContentView = View.extend({

	/** @override */
	cidPrefix: "contentView",

	/** @override */
	className: "container-expanded",

	/** @override */
	events: {
		"transitionend .adding-child": "_onAddedTransitionEnd",
		"transitionend .removing-child": "_onRemovedTransitionEnd",
		// "transitionend": "_onTransitionEnd",
	},

	/** @override */
	initialize: function(options) {
		_.bindAll(this, "_onVPanStart", "_onVPanMove", "_onVPanFinal", "_onCollapsedEvent");

		this.transforms = new TransformHelper();
		// this.touch = options.touch || new Error("no touch"); //TouchManager.getInstance();
		this.vpan = options.vpan || new Error("no vpan");
		this.hpan = options.hpan || new Error("no hpan");

		this.listenTo(this.model, "change", this._onModelChange);

		// disconnect children before last change
		// this.listenTo(bundles, "deselect:one", this._onDeselectOneBundle);

		this.skipTransitions = true;
		this.itemViews = [];

		// this.progressWrapper = this.createProgressWrapper(),
		// this.el.appendChild(this.progressWrapper.el);
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		// values
		var collapsed = this.model.get("collapsed");
		var collapsedChanged = (flags & View.MODEL_INVALID)
			&& this.model.hasChanged("collapsed");
		var childrenChanged = (flags & View.MODEL_INVALID)
			&& (this.model.hasChanged("bundle") || this.model.hasChanged("article"));

		// flags
		var sizeChanged = !!(flags & View.SIZE_INVALID);
		var transformsChanged = !!(flags & (View.MODEL_INVALID | View.SIZE_INVALID | View.LAYOUT_INVALID));
		transformsChanged = transformsChanged || this._transformsChanged || this.skipTransitions;

		// debug
		// - - - - - - - - - - - - - - - - -
		// if (flags & View.MODEL_INVALID) {
		// 	console.group(this.cid + "::renderFrame model changed:");
		// 	Object.keys(this.model.changed).forEach(function(key) {
		// 		console.log("\t%s: %s -> %s", key, this.model._previousAttributes[key], this.model.changed[key]);
		// 	}, this);
		// 	console.groupEnd();
		// }

		// model:children
		// - - - - - - - - - - - - - - - - -
		if (childrenChanged) {
			this.removeChildren();
			if (bundles.selected) {
				this.createChildren(bundles.selected);
			} else
			if (articles.selected) {
				this.createChildren(articles.selected);
			}
		}

		// model:collapsed
		// - - - - - - - - - - - - - - - - -
		if (collapsedChanged) {
			this.el.classList.toggle("container-collapsed", collapsed);
			this.el.classList.toggle("container-expanded", !collapsed);
		}

		// size
		// - - - - - - - - - - - - - - - - -
		if (sizeChanged) {
			this.transforms.clearAllCaptures();
		}

		// transforms
		// - - - - - - - - - - - - - - - - -
		if (transformsChanged) {
			this.el.classList.remove("container-changing");
			if (this.skipTransitions) {
				this.transforms.stopAllTransitions();
				this.el.classList.remove("container-changed");
				if (!childrenChanged) {
					// this.transforms.clearAllOffsets();
					if (collapsedChanged) {
						this._setChildrenEnabled(collapsed);
					}
				}
			} else {
				if (!childrenChanged) {
					if (collapsedChanged) {
						var afterTransitionsFn;
						this.el.classList.add("container-changed");
						// this.transforms.clearAllOffsets();
						if (collapsed) {
							// container-collapsed, enable last
							afterTransitionsFn = function() {
								this._setChildrenEnabled(true);
								this.el.classList.remove("container-changed");
							};
							this.transforms.runAllTransitions(tx.LAST);
						} else {
							// container-expanded, disable first
							afterTransitionsFn = function() {
								this.el.classList.remove("container-changed");
							};
							this._setChildrenEnabled(false);
							this.transforms.runAllTransitions(tx.FIRST);
						}
						afterTransitionsFn = afterTransitionsFn.bind(this);
						this.transforms.whenAllTransitionsEnd().then(afterTransitionsFn, afterTransitionsFn);
					} else {
						this.transforms.items.forEach(function(o) {
							if (o.hasOffset) {
								o.runTransition(tx.NOW);
								// o.clearOffset();
							}
						});
					}
				}
			}
			if (!childrenChanged) {
				this.transforms.clearAllOffsets();
			}
			this.transforms.validate();
		}
		if (sizeChanged) {
			this.itemViews.forEach(function(view) {
				view.skipTransitions = this.skipTransitions;
				view.requestRender(View.SIZE_INVALID).renderNow();
			}, this);
			/*Promise.all(this.itemViews.map(function(view) {
					view.skipTransitions = this.skipTransitions;
					return view.requestRender(View.SIZE_INVALID).whenRendered();
				}, this))
				.then(
					function(views) {
						var nh = this.el.offsetParent.offsetHeight - this.el.offsetTop;
						// var oh = views.reduce(function(h, view) {
						// 	return Math.max(h, view.el.offsetHeight);
						// }, nh);
						// oh++;
						// console.log("%s:[whenRendered] [result: %s %s] %o", this.cid,
						// 	nh, oh, this.el.parent, views);
						this.el.style.minHeight = nh + "px";
						return views;
					}.bind(this),
					function(reason) {
						console.warn("%s:[whenRendered] [rejected] %o", this.cid, reason);
						return reason;
					}.bind(this)
				);*/
		}
		this.skipTransitions = this._transformsChanged = false;
	},

	_setChildrenEnabled: function(enabled) {
		// if (enabled) {
		// 	this.el.removeEventListener("click", this._onCollapsedClick, false);
		// } else {
		// 	this.el.addEventListener("click", this._onCollapsedClick, false);
		// }
		this.itemViews.forEach(function(view) {
			view.setEnabled(enabled);
		});
	},

	/* -------------------------------
	/* Collapse UI gestures/events
	/* ------------------------------- */

	_onCollapsedEvent: function(ev) {
		console.log("%s:[%s -> _onCollapsedEvent] target: %s", this.cid, ev.type, ev.target);
		if (!ev.defaultPrevented &&
			this.model.get("withBundle") &&
			!this.model.get("collapsed") &&
			!this.enabled) {
			// this.setImmediate(function() {
			// if (ev.type == "click") ev.stopPropagation();
			ev.preventDefault();
			this.setImmediate(function() {
				// if (ev.type == "click") ev.stopPropagation();
				this.model.set("collapsed", true);
			});
			// });
		}
	},

	/* --------------------------- *
	/* model changed
	/* --------------------------- */

	_onModelChange: function() {
		if (this.model.hasChanged("withBundle")) {
			if (this.model.get("withBundle")) {
				this.vpan.on("vpanstart", this._onVPanStart);
			} else {
				this.vpan.off("vpanstart", this._onVPanStart);
			}
		}
		/*
		if (this.model.hasChanged("withBundle") ||
			this.model.hasChanged("collapsed")) {
			if (this.model.get("withBundle") &&
				!this.model.get("collapsed")) {
				this.hpan.on("hpanleft hpanright", this._onCollapsedEvent);
				this.el.addEventListener(Globals.CLICK_EVENT, this._onCollapsedEvent, false);
			} else {
				this.hpan.off("hpanleft hpanright", this._onCollapsedEvent);
				this.el.removeEventListener(Globals.CLICK_EVENT, this._onCollapsedEvent, false);
			}
		}
		*/
		this.requestRender(View.MODEL_INVALID);
	},

	/* -------------------------------
	/* Vertical touch/move (_onVPan*)
	/* ------------------------------- */

	_collapsedOffsetY: Globals.COLLAPSE_OFFSET,

	_onVPanStart: function(ev) {
		this.vpan.on("vpanmove", this._onVPanMove);
		this.vpan.on("vpanend vpancancel", this._onVPanFinal);

		this.transforms.stopAllTransitions();
		// this.transforms.clearAllOffsets();
		// this.transforms.validate();
		this.transforms.clearAllCaptures();

		this.el.classList.add("container-changing");
		this._onVPanMove(ev);
	},

	_onVPanMove: function(ev) {
		var collapsed = this.model.get("collapsed");
		var delta = ev.deltaY; //ev.thresholdDeltaY;
		var maxDelta = this._collapsedOffsetY; // + Math.abs(ev.thresholdOffsetY);

		// check if direction is aligned with collapsed/expand
		var isValidDir = collapsed ? (delta > 0) : (delta < 0);
		var moveFactor = collapsed ? Globals.VPAN_DRAG : 1 - Globals.VPAN_DRAG;

		delta = Math.abs(delta); // remove sign
		delta *= moveFactor;
		maxDelta *= moveFactor;

		if (isValidDir) {
			if (delta > maxDelta) { // overshooting
				delta = ((delta - maxDelta) * Globals.VPAN_OUT_DRAG) + maxDelta;
			} else { // no overshooting
				// delta = delta;
			}
		} else {
			delta = (-delta) * Globals.VPAN_OUT_DRAG; // delta is opposite
		}
		delta *= collapsed ? 1 : -1; // reapply sign

		this.transforms.offsetAll(0, delta);
		this.transforms.validate();
	},

	_onVPanFinal: function(ev) {
		this.vpan.off("vpanmove", this._onVPanMove);
		this.vpan.off("vpanend vpancancel", this._onVPanFinal);

		// FIXME: model.collapsed may have already changed, _onVPanMove would run with wrong values:
		// model.collapsed is changed in a setImmediate callback from NavigationView.

		this._onVPanMove(ev);
		this.setImmediate(function() {
			this._transformsChanged = true;
			this.requestRender();
		});
	},

	// willCollapsedChange: function(ev) {
	// 	var collapsed = this.model.get("collapsed");
	// 	return ev.type == "vpanend"? collapsed?
	// 		ev.thresholdDeltaY > Globals.COLLAPSE_THRESHOLD :
	// 		ev.thresholdDeltaY < -Globals.COLLAPSE_THRESHOLD :
	// 		false;
	// },

	/* -------------------------------
	/* create/remove children on bundle selection
	/* ------------------------------- */

	/** Create children on bundle select */
	createChildren: function(model) {
		var view;
		if (model.__proto__.constructor === bundles.model) {
			// will be attached to dom in this order
			view = this.createMediaCaptionStack(model);
			this.itemViews.push(view);
			this.transforms.add(view.el);
			view = this.createMediaCarousel(model);
			this.itemViews.push(view);
			this.transforms.add(view.el);
			view = this.createMediaDotNavigation(model);
			this.itemViews.push(view);
		} else
		if (model.__proto__.constructor === articles.model) {
			view = this.createArticleView(model);
			this.itemViews.push(view);
		}

		this.itemViews.forEach(function(view) {
			if (!this.skipTransitions) {
				view.el.classList.add("adding-child");
				view.el.style.opacity = 0;
			}
			this.el.appendChild(view.el);
			view.render();
		}, this);

		if (!this.skipTransitions) {
			this.requestAnimationFrame(function() {
				console.log("%s::createChildren::[callback:requestAnimationFrame]", this.cid);
				this.itemViews.forEach(function(view) {
					if (!this.skipTransitions) {
						view.el.style[transitionProp] = "opacity " + tx.LAST.cssText;
					}
					view.el.style.removeProperty("opacity");
				}, this);
			});
		}
	},

	removeChildren: function() {
		this.itemViews.forEach(function(view, i, arr) {
			this.transforms.remove(view.el);
			if (this.skipTransitions) {
				view.remove();
			} else {
				var s = window.getComputedStyle(view.el);
				if (s.opacity == "0" || s.visibility == "hidden") {
					console.log("%s::removeChildren [view:%s] removed immediately (invisible)", this.cid, view.cid);
					view.remove();
				} else {
					view.el.classList.add("removing-child");
					if (s[transformProp]) view.el.style[transformProp] = s[transformProp];
					view.el.style[transitionProp] = "opacity " + tx.FIRST.cssText;
					view.el.style.opacity = 0;
				}
			}
			arr[i] = null;
		}, this);
		this.itemViews.length = 0;
	},

	_onAddedTransitionEnd: function(ev) {
		if (ev.target.cid && this.childViews.hasOwnProperty(ev.target.cid)) {
			console.log("%s::_onAddedTransitionEnd [view:%s] [prop:%s] [ev:%s]", this.cid, ev.target.cid, ev.propertyName, ev.type);
			var view = this.childViews[ev.target.cid];
			view.el.classList.remove("adding-child");
			view.el.style.removeProperty(transitionProp);
		}
	},

	_onRemovedTransitionEnd: function(ev) {
		if (ev.target.cid && this.childViews.hasOwnProperty(ev.target.cid)) {
			console.log("%s::_onRemovedTransitionEnd [view:%s] [prop:%s] [ev:%s]", this.cid, ev.target.cid, ev.propertyName, ev.type);
			var view = this.childViews[ev.target.cid];
			view.el.classList.remove("removing-child");
			view.remove();
		}
	},

	// purgeChildren: function() {
	// 	var i, el, els = this.el.querySelectorAll(".removing-child");
	// 	for (i = 0; i < els.length; i++) {
	// 		el = els.item(i);
	// 		if (el.parentElement === this.el) {
	// 			try {
	// 				console.error("%s::purgeChildren", this.cid, el.getAttribute("data-cid"));
	// 				View.findByElement(el).remove();
	// 			} catch (err) {
	// 				console.error("s::purgeChildren", this.cid, "orphaned element", err);
	// 				this.el.removeChild(el);
	// 			}
	// 		}
	// 	}
	// },

	/* -------------------------------
	/* Components
	/* ------------------------------- */


	/**
	 * media-carousel
	 */
	createMediaCarousel: function(bundle) {
		// Create carousel
		var EmptyRenderer = CarouselRenderer.extend({
			className: "carousel-item empty-item",
			model: bundle,
			template: carouselEmptyTemplate,
		});
		var rendererFunction = function(item, index, arr) {
			if (index === -1) {
				return EmptyRenderer;
			}
			switch (item.attr("@renderer")) {
				case "video":
					return VideoRenderer;
				case "sequence":
					return SequenceRenderer;
				case "image":
					return ImageRenderer;
				default:
					return ImageRenderer;
			}
		};
		var view = new Carousel({
			className: "media-carousel " + bundle.get("domid"),
			collection: bundle.get("media"),
			rendererFunction: rendererFunction,
			requireSelection: false,
			direction: Carousel.DIRECTION_HORIZONTAL,
			touch: this.hpan,
		});
		controller.listenTo(view, {
			"view:select:one": controller.selectMedia,
			"view:select:none": controller.deselectMedia,
			// "view:removed": controller.stopListening
		});
		view.listenTo(bundle, "deselected", function() {
			this.stopListening(this.collection);
			controller.stopListening(this);
		});
		return view;
	},

	/**
	 * media-caption-stack
	 */
	createMediaCaptionStack: function(bundle) {
		var view = new CollectionStack({
			className: "media-caption-stack",
			collection: bundle.get("media"),
			template: mediaStackTemplate
		});
		view.listenTo(bundle, "deselected", function() {
			this.stopListening(this.collection);
		});
		return view;
	},

	/**
	 * media-dotnav
	 */
	createMediaDotNavigation: function(bundle) {
		var view = new SelectableListView({
			className: "media-dotnav dots-fontface color-fg05",
			collection: bundle.get("media"),
			renderer: DotNavigationRenderer
		});
		controller.listenTo(view, {
			"view:select:one": controller.selectMedia,
			"view:select:none": controller.deselectMedia,
			// "view:removed": controller.stopListening
		});
		view.listenTo(bundle, "deselected", function() {
			this.stopListening(this.collection);
			controller.stopListening(this);
		});
		return view;
	},

	/**
	 * @param el {module:app/model/item/ArticleView}
	 * @return {module:app/view/base/View}
	 */
	createArticleView: function(article) {
		var view = new ArticleView({
			model: article,
		});
		return view;
	},

	// createProgressWrapper: function() {
	// 	// var view = new ProgressMeter({
	// 	// 	id: "media-progress-wrapper",
	// 	// 	// className: "color-bg color-fg05",
	// 	// 	useOpaque: false,
	// 	// 	labelFn: function() { return "0%"; }
	// 	// });
	// 	// this.el.appendChild(this.progressWrapper.el);
	// 	// return view;
	// 	return null;
	// },
});

module.exports = ContentView;
},{"./template/Carousel.EmptyRenderer.Bundle.hbs":98,"./template/CollectionStack.Media.hbs":99,"app/control/Controller":33,"app/control/Globals":34,"app/model/collection/ArticleCollection":41,"app/model/collection/BundleCollection":42,"app/view/base/View":60,"app/view/component/ArticleView":64,"app/view/component/Carousel":65,"app/view/component/CollectionStack":67,"app/view/component/SelectableListView":72,"app/view/render/CarouselRenderer":83,"app/view/render/DotNavigationRenderer":88,"app/view/render/ImageRenderer":90,"app/view/render/SequenceRenderer":95,"app/view/render/VideoRenderer":97,"underscore":"underscore","utils/TransformHelper":103}],54:[function(require,module,exports){
/* global MutationObserver */
/**
/* @module app/view/NavigationView
/*/

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:hammerjs} */
var Hammer = require("hammerjs");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:utils/TransformHelper} */
var TransformHelper = require("utils/TransformHelper");
// /** @type {module:app/view/base/TouchManager} */
// var TouchManager = require("app/view/base/TouchManager");

/** @type {module:app/control/Controller} */
var controller = require("app/control/Controller");
/** @type {module:app/model/collection/TypeCollection} */
var types = require("app/model/collection/TypeCollection");
/** @type {module:app/model/collection/KeywordCollection} */
var keywords = require("app/model/collection/KeywordCollection");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/FilterableListView} */
var FilterableListView = require("app/view/component/FilterableListView");
/** @type {module:app/view/component/GroupingListView} */
var GroupingListView = require("app/view/component/GroupingListView");
// /** @type {module:app/view/component/CollectionPager} */
// var CollectionPager = require("app/view/component/CollectionPager");
/** @type {module:app/view/component/GraphView} */
var GraphView = require("app/view/component/GraphView");
/** @type {module:app/view/component/ArticleButton} */
var ArticleButton = require("app/view/component/ArticleButton");

// /** @type {module:utils/prefixedProperty} */
// var prefixedProperty = require("utils/prefixedProperty");

var tx = Globals.transitions;

/**
/* @constructor
/* @type {module:app/view/NavigationView}
/*/
var NavigationView = View.extend({

	// /** @override */
	// tagName: "div",
	/** @override */
	cidPrefix: "navigationView",
	/** @override */
	className: "navigation container-expanded",

	/** @override */
	initialize: function(options) {
		_.bindAll(this, "_onVPanStart", "_onVPanMove", "_onVPanFinal");
		_.bindAll(this, "_onHPanStart", "_onHPanMove", "_onHPanFinal");
		_.bindAll(this, "_whenTransitionsEnd", "_whenTransitionsAbort");
		_.bindAll(this, "_whenListsRendered");
		_.bindAll(this, "_onNavigationClick");

		// this._metrics = {
		// 	minHeight: 0
		// };
		this.itemViews = [];
		this.transforms = new TransformHelper();
		// this.touch = options.touch || new Error("no touch"); //TouchManager.getInstance();
		this.vpan = options.vpan || new Error("no vpan");
		this.hpan = options.hpan || new Error("no hpan");

		this.listenTo(this.model, "change", this._onModelChange);

		this.listenTo(this.model, "withBundle:change", this._onWithBundleChange);

		this.keywordList = this.createKeywordList();
		/* NOTE: .list-group .label moves horizontally (cf. sass/layouts/*.scss) */
		this.hGroupings = this.keywordList.el.querySelectorAll(".list-group .label");
		this.transforms.add(this.hGroupings, this.keywordList.el, this.keywordList.wrapper);
		this.itemViews.push(this.keywordList);

		this.bundleList = this.createBundleList();
		this.transforms.add(this.bundleList.el, this.bundleList.wrapper);
		this.itemViews.push(this.bundleList);

		this.sitename = this.createSitenameButton();
		this.transforms.add(this.sitename.wrapper, this.sitename.el);
		// this.transforms.add(this.sitename.el.firstElementChild, this.sitename.el);

		this.about = this.createArticleButton(articles.findWhere({ handle: "about" }));
		this.transforms.add(this.about.wrapper, this.about.el);

		this.graph = this.createGraphView(this.bundleList, this.keywordList);
		// this.transforms.add(this.graph.el);
		// this.itemViews.push(this.graph);
		// this.listenTo(this.graph, {
		// 	"canvas:update": this._onGraphUpdate,
		// 	"canvas:redraw": this._onGraphRedraw,
		// });

		/*this.listenTo(this.graph, "view:render:before", function(view, flags) {
			var vmax;
			if (!view.el.style.height) {
				// if (flags & (View.SIZE_INVALID | View.MODEL_INVALID)) {
				// if ((this.bundleList.renderFlags | View.SIZE_INVALID) ||
				// 	(this.keywordList.renderFlags | View.SIZE_INVALID)) {
				// }
				vmax = Math.max(
					this.bundleList._metrics.height,
					this.keywordList._metrics.height
				);
				if (_.isNumber(vmax)) {
					view.el.style.height = vmax + "px";
					console.log("%s:[view:render:before][once]:%s [%s] heights:[%i, %i] (max %i)",
						this.cid, view.cid, View.flagsToString(flags),
						this.bundleList._metrics.height,
						this.keywordList._metrics.height,
						vmax);
				}
			}
		});*/
		// this.listenTo(this.bundleList, "view:render:after", function(view, flags) {
		// 	console.info("%s:[view:render:after %s]", this.cid, view.cid, View.flagsToString(flags & View.SIZE_INVALID));
		// 		if (flags & View.SIZE_INVALID) {
		// 			// console.info("%s:[%s view:render:after] bundleList height", this.cid, view.cid, this.bundleList.el.style.height);
		// 			// this.graph.el.style.height = this.bundleList.el.style.height;
		// 			this.graph.el.style.opacity = this.bundleList.collapsed? 0 : 1;
		// 			this.graph.requestRender(View.SIZE_INVALID).renderNow();
		// 	// 	}
		// });
		// this.listenTo(this.bundleList, "view:render:after", this._onListResize);
		// this.listenTo(this.keywordList, "view:render:after", this._onListResize);
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		if (flags & View.MODEL_INVALID) {
			if (this.model.hasChanged("collapsed")) {
				this.el.classList.toggle("container-collapsed", this.model.get("collapsed"));
				this.el.classList.toggle("container-expanded", !this.model.get("collapsed"));
			}
			if (this.model.hasChanged("collapsed")
				|| this.model.hasChanged("withBundle")) {
				this.el.classList.add("container-changing");
			}
			// if (this.bundleList.invalidated) {
			// 	this.bundleList.invalidate(View.SIZE_INVALID);
			// }
			// if (this.model.hasChanged("bundle")) {
			if (this.model.hasChanged("routeName")) {
				this.bundleList.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
				this.keywordList.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
			}
		}

		// transforms
		// - - - - - - - - - - - - - - - - -
		if (this.skipTransitions ||
			(flags & (View.MODEL_INVALID | View.SIZE_INVALID | View.LAYOUT_INVALID))) {
			// if (transformsChanged) {
			if (this.skipTransitions) {
				this.transforms.stopAllTransitions();
				this.transforms.validate();
				this.transforms.clearAllOffsets();
			} else {
				this.renderTransitions(flags);
			}
			this.transforms.validate();
			// console.log("%s::renderFrame %o", this.cid,
			// 	this.transforms.items.map(function(o) {
			// 		return [o.hasTransition, o.el.localName, o.el.id || o.el.className].join(" : ");
			// 	})
			// );
		}

		// if (flags & View.MODEL_INVALID) {
		// 	// if (this.model.hasChanged("collapsed")) {
		// 	//if ((this.model.hasChanged("collapsed") && !this.model.get("collapsed")) || (this.model.hasChanged("withBundle") && !this.model.get("withBundle"))) {
		// 	if (this.model.hasChanged("collapsed")
		// 		|| this.model.hasChanged("withBundle")
		// 		|| this.model.hasChanged("withArticle")) {
		// 		this.transforms.promise().then(this._whenTransitionsEnd, this._whenTransitionsAbort);
		// 	}
		// }

		// children loop
		// - - - - - - - - - - - - - - - - -
		this.itemViews.forEach(function(view) {
			view.skipTransitions = view.skipTransitions || this.skipTransitions;
			if (flags & View.SIZE_INVALID) {
				view.requestRender(View.SIZE_INVALID);
			}
			if (!view.skipTransitions) {
				view.renderNow();
			}
		}, this);

		var whenListsRendered = Promise.all([
			this.bundleList.whenRendered(),
			this.keywordList.whenRendered()
		])
			.then(
				function(result) {
					var hval = result.reduce(function(a, o) {
						return Math.max(a, o._metrics.height);
					}, 0);
					if (this.model.get("collapsed")) {
						this.el.style.height = "";
						// this.el.style.minHeight = "";
						// this.graph.el.style.height = "100%";
					} else {
						this.el.style.height = hval + "px";
						// this.el.style.minHeight = hval + "px";
						// this.graph.el.style.height = hval + "px";
					}
					console.log("%s:[whenRendered][flags: %s] height: %o", this.cid, View.flagsToString(flags), hval);
					return result;
				}.bind(this),
				function(reason) {
					console.warn("%s:[whenRendered] failed: %o", this.cid, reason);
					return reason;
				}.bind(this)
			);

		Promise.all([
			whenListsRendered,
			this.transforms.promise()
		])
			.then(
				function(result) {
					console.log("%s:[listsRendered+transitionsEnd] [%s]", this.cid, View.flagsToString(flags), result);

					this.el.classList.remove("container-changing");
					this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
				}.bind(this),
				function(reason) {
					console.warn("%s:[listsRendered+transitionsEnd] [%s]", this.cid, View.flagsToString(flags), reason);

					this.el.classList.remove("container-changing");
					this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
				}.bind(this)
			);

		// graph
		// - - - - - - - - - - - - - - - - -
		// if ((flags & (View.SIZE_INVALID | ~View.MODEL_INVALID))
		// 	/* collapsed has not changed, no bundle selected */
		// 	&& !this.model.hasChanged("collapsed")
		// 	&& !this.model.get("withBundle")) {
		// 	this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
		// 	if (!this.skipTransitions) {
		// 		this.graph.renderNow();
		// 	}
		// }
		// else if ((flags & View.SIZE_INVALID) && !this.model.get("collapsed")) {
		// 	/* NavigationView has resized while uncollapsed,
		// 	but model is unchanged */
		// 	this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
		// }
		this.skipTransitions = false;
	},

	_whenListsRendered: function(result) {

	},

	_whenTransitionsEnd: function(result) {
		console.info("%s::_whenTransitionsEnd", this.cid);
		this.el.classList.remove("container-changing");
		// if (!Globals.BREAKPOINTS["desktop-small"].matches)
		// 	return;
		// if (!this.model.get("collapsed")) {
		// 	this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID); //.renderNow();
		// }
	},

	_whenTransitionsAbort: function(reason) {
		console.warn("%s::_whenTransitionsAbort %o", this.cid, reason);
		this.el.classList.remove("container-changing");
		// if (!Globals.BREAKPOINTS["desktop-small"].matches)
		// 	return;
		// if (!this.model.get("collapsed")) {
		// 	this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID); //.renderNow();
		// }
	},

	/* -------------------------------
	/* renderTransitions
	/* ------------------------------- */

	renderTransitions: function(flags) {
		var fromRoute = this.model.previous("routeName");
		var toRoute = this.model.get("routeName");

		var modelChanged = (flags & View.MODEL_INVALID);
		/* bundle */
		var withBundle = this.model.get("withBundle");
		var withBundleChanged = modelChanged && this.model.hasChanged("withBundle");
		var bundleChanged = modelChanged && this.model.hasChanged("bundle");
		/* media */
		var withMedia = this.model.get("withMedia");
		var withMediaChanged = modelChanged && this.model.hasChanged("withMedia");
		//var mediaChanged = modelChanged && this.model.hasChanged("media");
		/* article */
		// var withArticle = this.model.get("withArticle");
		var withArticleChanged = modelChanged && this.model.hasChanged("withArticle");
		//var articleChanged = modelChanged && this.model.hasChanged("article");
		/* collapsed */
		var collapsed = this.model.get("collapsed");
		var collapsedChanged = modelChanged && this.model.hasChanged("collapsed");

		var tf;
		/* this.bundleList.el */
		tf = this.transforms.get(this.bundleList.el);
		if (tf.hasOffset) {
			tf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);
		}
		/* this.keywordList.el */
		tf = this.transforms.get(this.keywordList.el);
		if (tf.hasOffset) {
			tf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);
		}
		/* this.graph.el */
		tf = this.transforms.get(this.graph.el);
		if (tf && tf.hasOffset) {
			tf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);
			tf.clearOffset();
		}

		/*
		 * NOTE:
		 * Vertical:
		 *		site-name-wrapper,
		 *		article-list-wrapper
		 * Horizontal:
		 *		site-name,
		 *		article-buttons,
		 *		keywordList.wrapper,
		 *		bundleList.wrapper,
		 *		hGroupings
		 */
		if (Globals.BREAKPOINTS["desktop-small"].matches) {
			/* HORIZONTAL */
			tf = this.transforms.get(this.keywordList.wrapper);
			if (collapsedChanged && !withArticleChanged) {
				// if (collapsedChanged) {
				if (withBundleChanged) {
					if (withMediaChanged)
						tf.runTransition(withBundle ? tx.LAST : tx.FIRST);
				} else {
					if (withMedia)
						tf.runTransition(collapsed ? tx.LAST : tx.FIRST);
				}
			} else {
				if (!withBundleChanged && withMediaChanged)
					tf.runTransition(bundleChanged ? tx.BETWEEN : tx.NOW);
			}
			if (collapsedChanged ^ withArticleChanged) {
				this.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST,
					this.sitename.el, this.about.el, this.bundleList.wrapper, this.hGroupings);
			}
			/* VERTICAL */
			if (fromRoute == 'root' || toRoute == 'root') {
				this.transforms.runTransition(tx.BETWEEN,
					this.sitename.wrapper, this.about.wrapper);
			}
			/* this.hGroupings */
			// if (collapsedChanged ^ withArticleChanged) {
			// 	// if (collapsedChanged && !withArticleChanged) {
			// 	this.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.hGroupings);
			// }
			// if (collapsedChanged) {
			// 	if (!withArticleChanged) {
			// 		// if (fromRoute == 'root' || toRoute == 'root') {
			// 		this.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.bundleList.wrapper);
			// 	}
			// } else {
			// 	if (withArticleChanged && withBundleChanged) {
			// 		this.transforms.runTransition(withArticle ? tx.BETWEEN : tx.LAST, this.bundleList.wrapper);
			// 	}
			// }
		} else if (Globals.BREAKPOINTS["fullwidth"].matches) {
			// if (collapsedChanged ) {
			if (collapsedChanged ^ withArticleChanged) {
				this.transforms.runTransition(collapsed ? tx.FIRST : tx.LAST,
					this.sitename.el, this.about.el);
			}
		} else {
			if (withBundleChanged) {
				this.transforms.runTransition(tx.BETWEEN,
					this.sitename.el, this.about.el);
			}
		}
		this.transforms.clearOffset(this.bundleList.el, this.keywordList.el,
			this.keywordList.wrapper);
	},

	/* --------------------------- *
	/* own model changed
	/* --------------------------- */

	_onModelChange: function() {
		this.requestRender(View.MODEL_INVALID);
		// keywords.deselect();
		if (this.model.hasChanged("collapsed")) {
			if (this.model.get("collapsed")) {
				// clear keyword selection
				keywords.deselect();
			} // else {}
			this.keywordList.collapsed = this.model.get("collapsed");
			this.bundleList.collapsed = this.model.get("collapsed");
		}
		if (this.model.hasChanged("bundle")) {
			this.bundleList.selectedItem = this.model.get("bundle");
			this.keywordList.refresh();
			// keywords.deselect();
			// this.graph && this.graph.requestRender(View.SIZE_INVALID);
		}
		if (this.model.hasChanged("withBundle")) {
			// this.keywordList.refresh()
			if (this.model.get("withBundle")) {
				this.graph.el.addEventListener(Globals.CLICK_EVENT, this._onNavigationClick);
				this.vpan.on("vpanstart", this._onVPanStart);
				this.hpan.on("hpanstart", this._onHPanStart);
				// this.hpan.on("tap", this._onTap);
			} else {
				this.graph.el.removeEventListener(Globals.CLICK_EVENT, this._onNavigationClick);
				this.vpan.off("vpanstart", this._onVPanStart);
				this.hpan.off("hpanstart", this._onHPanStart);
				keywords.deselect();
				// this.hpan.off("tap", this._onTap);
			}
			// this.graph.valueTo()
		}
		this.requestRender(View.MODEL_INVALID);
	},

	// _onWithBundleChange: function(withBundle) {
	// 	if (withBundle) {
	// 		this.listenTo(this.model, "collapsed:change", function(collapsed){
	//
	// 		});
	// 	} else {
	// 		this.stopListening(this.model, "collapsed:change", function(collapsed){
	//
	// 		});
	// 	}
	// },

	/* --------------------------- *
	/* keyword collection changed
	/* --------------------------- */

	_onKeywordSelect: function(keyword) {
		// use collection listener to avoid redundant refresh calls
		this.bundleList.refresh();
		if (!this.model.get("collapsed") && this.graph) {
			this.listenToOnce(this.bundleList, "view:render:after", function(view, flags) {
				console.log("%s::_onKeywordSelect -> %s:[view:render:after] flags:%s", this.cid, view.cid, View.flagsToString(flags));
				this.graph.valueTo(0, 0, "amount");
				// this.graph.renderNow();
				this.graph.valueTo(1, Globals.TRANSITION_DURATION, "amount");
			});
		}
	},

	/* --------------------------- *
	/* UI Events: bundleList keywordList buttons
	/* --------------------------- */

	_onNavigationClick: function(ev) {
		if (!ev.defaultPrevented && this.model.has("bundle")) {
			console.log("%s::_onNavigationClick [%s]", this.cid, ev.type); //, ev.target);
			ev.preventDefault();
			// this.model.set("collapsed", !this.model.get("collapsed"));
			this._setCollapsed(!this.model.get("collapsed"));
		}
	},

	_onArticleClick: function(item) {
		switch (this.model.get("routeName")) {
			case "article-item":
				controller.deselectArticle();
				break;
			case "root":
			default:
				controller.selectArticle(item);
				break;
		}
	},

	_onSitenameClick: function() {
		switch (this.model.get("routeName")) {
			case "media-item":
			case "bundle-item":
				if (this.model.get("collapsed")) {
					this._setCollapsed(false);
				} else {
					controller.deselectBundle();
				}
				break;
			case "article-item":
				controller.deselectArticle();
				break;
		}
	},

	_onBundleListSame: function(bundle) {
		this._setCollapsed(!this.model.get("collapsed"));
	},

	_onKeywordListChange: function(keyword) {
		if (!this.model.get("collapsed")) {
			keywords.select(keyword);
		}
	},

	_setCollapsed: function(value) {
		if (value !== this.model.get("collapsed")) {
			this.transforms.offset(0, 1, this.graph.el);
			this.transforms.validate();
			this.setImmediate(function() {
				console.log("%s::_setCollapsed -> %s (setImmediate)", this.cid, value);
				this.model.set("collapsed", value);
			});
		}
	},

	/* -------------------------------
	/* Horizontal touch/move (HammerJS)
	/* ------------------------------- */

	_onHPanStart: function(ev) {
		this.transforms.get(this.keywordList.wrapper)
			.stopTransition()
			.clearOffset()
			.validate();
		// if (this.model.get("layoutName") != "left-layout"
		// 	&& this.model.get("layoutName") != "default-layout") {
		// 	return;
		// }
		if (Globals.BREAKPOINTS["desktop-small"].matches
			&& this.model.get("bundle").get("media").selectedIndex <= 0
			&& this.model.get("collapsed")) {
			this.transforms.get(this.keywordList.wrapper).clearCapture();
			this._onHPanMove(ev);

			this.hpan.on("hpanmove", this._onHPanMove);
			this.hpan.on("hpanend hpancancel", this._onHPanFinal);
		}
	},

	_onHPanMove: function(ev) {
		// var HPAN_DRAG = 1;
		// var HPAN_DRAG = 0.75;
		var HPAN_DRAG = 720 / 920;
		var delta = ev.deltaX; //ev.thresholdDeltaX;
		// var mediaItems = this.model.get("bundle").get("media");

		if (this.model.get("withMedia")) {
			// if (this.model.get("withMedia") ^ (this._renderFlags & View.MODEL_INVALID)) {
			// if (mediaItems.selected !== null) {
			delta *= (ev.offsetDirection & Hammer.DIRECTION_LEFT) ?
				0.0 : HPAN_DRAG;
			// if (bundles.selected.get("media").selectedIndex == -1) {
		} else { //if (media.selectedIndex == 0) {
			delta *= (ev.offsetDirection & Hammer.DIRECTION_LEFT) ?
				HPAN_DRAG : Globals.HPAN_OUT_DRAG;
		}
		this.transforms.offset(delta, void 0, this.keywordList.wrapper);
		this.transforms.validate();
	},

	_onHPanFinal: function(ev) {
		this.hpan.off("hpanmove", this._onHPanMove);
		this.hpan.off("hpanend hpancancel", this._onHPanFinal);

		/* NOTE: if there is no model change, set tx here. Otherwise just wait for render */
		var kTf = this.transforms.get(this.keywordList.wrapper);
		if (!(this._renderFlags & View.MODEL_INVALID) && kTf.hasOffset) {
			if (kTf.offsetX != 0) {
				kTf.runTransition(tx.NOW);
			}
			kTf.clearOffset().validate();
			// kTf.clearOffset().runTransition(tx.NOW).validate();
			// this.transforms.clearOffset(this.keywordList.wrapper);
			// this.transforms.runTransition(tx.NOW, this.keywordList.wrapper);
			// this.transforms.validate();
		}
	},

	/* -------------------------------
	/* Vertical touch/move (_onVPan*)
	/* ------------------------------- */

	_collapsedOffsetY: Globals.COLLAPSE_OFFSET,

	_onVPanStart: function(ev) {
		this.vpan.on("vpanmove", this._onVPanMove);
		this.vpan.on("vpanend vpancancel", this._onVPanFinal);

		this.transforms.stopTransition(this.bundleList.el, this.keywordList.el); //, this.graph.el);
		// this.transforms.clearOffset(this.bundleList.el, this.keywordList.el);
		// this.transforms.validate();
		this.transforms.clearCapture(this.bundleList.el, this.keywordList.el); //, this.graph.el);

		if (!this.model.get("collapsed")) {
			this.transforms.stopTransition(this.graph.el);
			this.transforms.clearCapture(this.graph.el);
		}
		// this.el.classList.add("container-changing");
		this._onVPanMove(ev);
	},

	_onVPanMove: function(ev) {
		var collapsed = this.model.get("collapsed");
		var delta = ev.deltaY; //ev.thresholdDeltaY;
		var maxDelta = this._collapsedOffsetY; // + Math.abs(ev.thresholdOffsetY);

		// check if direction is aligned with collapsed/expand
		var isValidDir = collapsed ? (delta > 0) : (delta < 0);
		var moveFactor = collapsed ? 1 - Globals.VPAN_DRAG : Globals.VPAN_DRAG;

		delta = Math.abs(delta); // remove sign
		delta *= moveFactor;
		maxDelta *= moveFactor;

		if (isValidDir) {
			if (delta > maxDelta) { // overshooting
				delta = ((delta - maxDelta) * Globals.VPAN_OUT_DRAG) + maxDelta;
			} else { // no overshooting
				// delta = delta;
			}
		} else {
			delta = (-delta) * Globals.VPAN_OUT_DRAG; // delta is opposite
		}
		delta *= collapsed ? 0.5 : -1; // reapply sign

		this.transforms.offset(0, delta, this.bundleList.el, this.keywordList.el); //, this.graph.el);
		if (!collapsed)
			this.transforms.offset(0, delta, this.graph.el)
		this.transforms.validate();
	},

	_onVPanFinal: function(ev) {
		this.vpan.off("vpanmove", this._onVPanMove);
		this.vpan.off("vpanend vpancancel", this._onVPanFinal);

		this._onVPanMove(ev);
		this.setImmediate(function() {
			if (this.willCollapsedChange(ev)) {
				this.model.set("collapsed", !this.model.get("collapsed"));
			} else {
				this.requestRender(View.LAYOUT_INVALID);
			}
		});
	},

	willCollapsedChange: function(ev) {
		return ev.type == "vpanend" ? this.model.get("collapsed") ?
			ev.deltaY > Globals.COLLAPSE_THRESHOLD :
			ev.deltaY < -Globals.COLLAPSE_THRESHOLD :
			false;
	},

	/* -------------------------------
	/* Components
	/* ------------------------------- */

	createSitenameButton: function() {
		var view = new View({
			el: "#site-name",
			events: {
				"click a": function(domev) {
					domev.defaultPrevented || domev.preventDefault();
					this.trigger("view:click");
				}
			}
		});
		this.listenTo(view, "view:click", this._onSitenameClick);
		view.wrapper = view.el.parentElement;
		return view;
	},

	createArticleButton: function(articleItem) {
		var view = new ArticleButton({
			el: ".article-button[data-handle='about']",
			model: articleItem
		}).render();
		this.listenTo(view, "view:click", this._onArticleClick);
		view.wrapper = view.el.parentElement;
		return view;
	},

	// createArticleButton2: function(articleItem) {
	// 	var view = new View({
	// 		el: "#about",
	// 		className: "article-button",
	// 		// tag: "h2",
	// 		model: articleItem,
	// 	});
	// 	// this.listenTo(view, "view:click", this._onAboutClick);
	// 	view.label = view.el.querySelector("a");
	// 	view.label.innerHTML = articleItem.get("name");
	// 	view.wrapper = view.el.parentElement;
	// 	return view;
	// },

	/**
	 * bundle-list
	 */
	createBundleList: function() {
		var view = new FilterableListView({
			el: "#bundle-list",
			collection: bundles,
			collapsed: false,
			filterFn: function(bundle, index, arr) {
				return keywords.selected ?
					bundle.get("kIds").indexOf(keywords.selected.id) !== -1 : false;
			},
		});
		controller.listenTo(view, {
			"view:select:one": controller.selectBundle,
			"view:select:none": controller.deselectBundle
		});
		// view.listenTo(bundles, "select:one select:none", function(item) {
		// 	view.selectedItem = item;
		// });
		this.listenTo(view, "view:select:same", this._onBundleListSame);
		this.listenTo(keywords, "select:one select:none", this._onKeywordSelect);
		view.wrapper = view.el.parentElement;
		return view;
	},

	/**
	 * keyword-list
	 */
	createKeywordList: function() {
		var view = new GroupingListView({
			el: "#keyword-list",
			collection: keywords,
			collapsed: false,
			filterFn: function(item, idx, arr) {
				// return !!(item.get("bundle").selected);
				return bundles.selected ?
					(bundles.selected.get("kIds").indexOf(item.id) !== -1) : false;
			},
			groupingFn: function(item, idx, arr) {
				// return item.get("type");
				return types.get(item.get("tId"));
			},
		});
		view.listenTo(keywords, "select:one select:none", function(item) {
			view.selectedItem = item;
		});
		this.listenTo(view, "view:select:one view:select:none", this._onKeywordListChange);
		view.wrapper = view.el.parentElement;
		return view;
	},

	/**
	 * nav-graph
	 */
	createGraphView: function(listA, listB) {
		var view = new GraphView({
			id: "nav-graph",
			listA: listA,
			listB: listB,
			model: this.model,
			useOpaque: false
		});
		// this.el.appendChild(view.el);
		this.el.insertBefore(view.el, this.el.firstElementChild);
		return view;
	},

	/* -------------------------------
	/* Horizontal touch/move (MutationObserver)
	/* ------------------------------- */

	/*
	_beginTransformObserve: function() {
		if (!(Globals.BREAKPOINTS["desktop-small"].matches && this.model.get("bundle").get("media").selectedIndex <= 0 && this.model.get("collapsed"))) {
			return;
		}
		var target = document.querySelector(".carousel > .empty-item");
		if (target === null) {
			return;
		}
		if (!this._transformObserver) {
			this._transformObserver = new MutationObserver(this._onTransformMutation);
		}
		this._transformObserver.observe(target, { attributes: true, attributeFilter: ["style"] });
		this.hpan.on("hpanend hpancancel", this._endTransformObserve);
		this.transforms.get(this.keywordList.wrapper)
			.stopTransition()
			.clearOffset()
			.clearCapture()
			.validate();
	},

	_endTransformObserve: function() {
		this._transformObserver.disconnect();
		this.hpan.off("hpanend hpancancel", this._endTransformObserve);
		this.transforms.get(this.keywordList.wrapper)
			.clearOffset()
			.runTransition(tx.NOW)
			.validate();
	},

	_onTransformMutation: function(mutations) {
		var tView, tMetrics, tCss, dTxObj, pos;

		// this.keywordList.wrapper.style[prefixedProperty("transform")];
		// transform = mutations[0].target.style.getPropertyValue(prefixedProperty("transform"));

		tView = View.findByElement(mutations[0].target);
		if (tView) {
			tMetrics = tView.metrics;
			dTxObj = this.transforms.get(this.keywordList.wrapper);
			console.log("%s::_onTransformMutation [withMedia: %s] target: (%f\+%f) %f wrapper: (%f) %f", this.cid,
				this.model.has("media"),
				tMetrics.translateX, tMetrics.width, tMetrics.translateX + tMetrics.width,
				dTxObj.capturedX, tMetrics.translateX - dTxObj.capturedX,
				tMetrics
			);

			this.transforms.offset(tMetrics.translateX - dTxObj.capturedX, void 0, this.keywordList.wrapper);
			this.transforms.validate();
		}
	},
	*/
});

module.exports = NavigationView;
},{"app/control/Controller":33,"app/control/Globals":34,"app/model/collection/ArticleCollection":41,"app/model/collection/BundleCollection":42,"app/model/collection/KeywordCollection":43,"app/model/collection/TypeCollection":44,"app/view/base/View":60,"app/view/component/ArticleButton":63,"app/view/component/FilterableListView":68,"app/view/component/GraphView":69,"app/view/component/GroupingListView":70,"hammerjs":"hammerjs","underscore":"underscore","utils/TransformHelper":103}],55:[function(require,module,exports){
(function (DEBUG){
/* global Path2D */
/**
 * @module app/view/component/progress/CanvasView
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:color} */
// var Color = require("color");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/view/base/Interpolator} */
var Interpolator = require("app/view/base/Interpolator");
/** @type {module:utils/css/getBoxEdgeStyles} */
var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

var MIN_CANVAS_RATIO = 1; // /Firefox/.test(window.navigator.userAgent)? 2 : 1;

/**
 * @constructor
 * @type {module:app/view/component/progress/CanvasView}
 */
var CanvasView = View.extend({

	/** @type {string} */
	cidPrefix: "canvasView",
	/** @type {string} */
	tagName: "canvas",
	/** @type {string} */
	className: "canvas-view",

	properties: {
		context: {
			get: function() {
				return this._ctx;
			}
		},
		interpolator: {
			get: function() {
				return this._interpolator;
			}
		},
		canvasRatio: {
			get: function() {
				return this._canvasRatio;
			}
		},
	},

	/** @type {Object} */
	defaults: {
		values: {
			value: 0
		},
		maxValues: {
			value: 1
		},
		useOpaque: true,
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	initialize: function(options) {
		// TODO: cleanup this options mess
		options = _.defaults(options, this.defaults);
		options.values = _.defaults(options.values, this.defaults.values);
		options.maxValues = _.defaults(options.maxValues, this.defaults.maxValues);

		this._interpolator = new Interpolator(options.values, options.maxValues);
		this._useOpaque = options.useOpaque;
		this._options = _.pick(options, "color", "backgroundColor");

		// opaque background
		// --------------------------------
		var ctxOpts = {};
		// if (this._useOpaque) {
		// 	this._opaqueProp = Modernizr.prefixed("opaque", this.el, false);
		// 	if (this._opaqueProp) {
		// 		this.el[this._opaqueProp] = true;
		// 	} else {
		// 		ctxOpts.alpha = true;
		// 	}
		// 	this.el.classList.add("color-bg");
		// }

		// canvas' context init
		// --------------------------------
		this._ctx = this.el.getContext("2d", ctxOpts);

		// adjust canvas size to pixel ratio
		// upscale the canvas if the two ratios don't match
		// --------------------------------
		var ratio = MIN_CANVAS_RATIO;
		var ctxRatio = this._ctx.webkitBackingStorePixelRatio || 1;
		if (window.devicePixelRatio !== ctxRatio) {
			// ratio = Math.max(window.devicePixelRatio / ctxRatio, MIN_CANVAS_RATIO);
			ratio = window.devicePixelRatio / ctxRatio;
			ratio = Math.max(ratio, MIN_CANVAS_RATIO);
		}
		this._canvasRatio = ratio;
		// console.log("%s::init canvasRatio: %f", this.cid, this._canvasRatio);

		this.listenTo(this, "view:attached", function() {
			// this.invalidateSize();
			// this.renderNow();
			this.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();
		});
	},

	// _computeCanvasRatio: function() {
	// 	var ratio = MIN_CANVAS_RATIO;
	// 	var ctxRatio = this._ctx.webkitBackingStorePixelRatio || 1;
	// 	if (window.devicePixelRatio !== ctxRatio) {
	// 		// ratio = Math.max(window.devicePixelRatio / ctxRatio, MIN_CANVAS_RATIO);
	// 		ratio = window.devicePixelRatio / ctxRatio;
	// 		ratio = Math.max(ratio, MIN_CANVAS_RATIO);
	// 	}
	// 	this._canvasRatio = ratio;
	// },

	_updateCanvas: function() {
		// adjust canvas size to pixel ratio
		// upscale the canvas if the two ratios don't match
		// --------------------------------

		var s = getComputedStyle(this.el);

		this._canvasWidth = this.el.offsetWidth;
		this._canvasHeight = this.el.offsetHeight;

		if (s.boxSizing === "border-box") {
			var m = getBoxEdgeStyles(s);
			this._canvasWidth -= m.paddingLeft + m.paddingRight + m.borderLeftWidth + m.borderRightWidth;
			this._canvasHeight -= m.paddingTop + m.paddingBottom + m.borderTopWidth + m.borderBottomWidth;
		}

		this._canvasWidth *= this._canvasRatio;
		this._canvasHeight *= this._canvasRatio;

		this.measureCanvas(this._canvasWidth, this._canvasHeight);
		this.el.width = this._canvasWidth;
		this.el.height = this._canvasHeight;
		// this.el.style.height = h + "px";
		// this.el.style.width = w + "px";

		// colors
		// --------------------------------
		this._color = this._options.color ||
			s.color || Globals.DEFAULT_COLORS["color"];
		this._backgroundColor = this._options.backgroundColor ||
			s.backgroundColor || Globals.DEFAULT_COLORS["background-color"];

		// mozOpaque
		// --------------------------------
		if (this._useOpaque && this._opaqueProp) {
			// this.el.style.backgroundColor = this._backgroundColor;
			this.el[this._opaqueProp] = true;
		}

		// fontSize
		// --------------------------------
		this._fontSize = parseFloat(s.fontSize) * this._canvasRatio;
		this._fontFamily = s.fontFamily;

		// prepare canvas context
		// --------------------------------
		this._ctx.restore();

		this._ctx.font = [s.fontWeight, s.fontStyle, this._fontSize + "px/1", s.fontFamily].join(" ");
		this._ctx.textAlign = "left";
		this._ctx.lineCap = "butt";
		this._ctx.lineJoin = "miter";
		this._ctx.strokeStyle = this._color;
		this._ctx.fillStyle = this._color;

		this.updateCanvas(this._ctx);
		this._ctx.save();

		// console.group(this.cid+"::_updateCanvas");
		// console.log("ratio:    %f (min: %f, device: %f, context: %s)", this._canvasRatio, MIN_CANVAS_RATIO, window.devicePixelRatio, this._ctx.webkitBackingStorePixelRatio || "(webkit-only)");
		// console.log("colors:   fg: %s bg: %s", this._color, this._backgroundColor);
		// console.log("style:    %s, %s, padding: %s (%s)", s.width, s.height, s.padding, s.boxSizing);
		// console.log("box:      %f x %f px", m.width, m.height);
		// console.log("measured: %f x %f px", w, h);
		// console.log("canvas:   %f x %f px", this._canvasWidth, this._canvasHeight);
		// console.groupEnd();
	},

	updateCanvas: function() {
		/* abstract */
	},

	measureCanvas: function() {
		/* abstract */
	},

	_getFontMetrics: function(str) {
		var key, idx, mObj, mIdx = str.length;
		for (key in Globals.FONT_METRICS) {
			idx = str.indexOf(key);
			if (idx !== -1 && idx < mIdx) {
				mIdx = idx;
				mObj = Globals.FONT_METRICS[key];
			}
		}
		return mObj;
	},

	_clearCanvas: function(x, y, w, h) {
		this._ctx.clearRect(x, y, w, h);
		if (this._useOpaque) {
			this._ctx.save();
			this._ctx.fillStyle = this._backgroundColor;
			this._ctx.fillRect(x, y, w, h);
			this._ctx.restore();
		}
	},

	_setStyle: function(s) {
		CanvasView.setStyle(this._ctx, s);
	},

	/* --------------------------- *
	/* render
	/* --------------------------- */

	/** @override */
	render: function() {
		if (this.attached) {
			return this.renderNow();
		}
		return this;
	},

	/** @override */
	renderFrame: function(tstamp, flags) {
		if (!this.attached) {
			return flags;
		}
		if (flags & View.SIZE_INVALID) {
			this._updateCanvas();
		}
		if (this._interpolator.valuesChanged) {
			flags |= View.LAYOUT_INVALID;
			this._interpolator.interpolate(tstamp);
		}
		if (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {
			this.redraw(this._ctx, this._interpolator);
			if (this._interpolator.valuesChanged) {
				this.requestRender();
			}
		}
	},

	/* --------------------------- *
	/* public
	/* --------------------------- */

	getValue: function(key) {
		return this._interpolator.getValue(key);
	},

	getRenderedValue: function(key) {
		return this._interpolator.getRenderedValue(key);
	},

	valueTo: function(value, duration, key) {
		this._interpolator.valueTo(value, duration, key);
		this.requestRender(View.MODEL_INVALID | View.LAYOUT_INVALID);
	},

	// updateValue: function(key) {
	// 	return this._interpolator.updateValue(key || this.defaultKey);
	// },

	/* --------------------------- *
	/* redraw
	/* --------------------------- */

	redraw: function(context, changed) {},

}, {
	setStyle: function(ctx, s) {
		if (typeof s != "object") return;
		for (var p in s) {
			switch (typeof ctx[p]) {
				case "undefined":
					break;
				case "function":
					if (Array.isArray(s[p])) ctx[p].apply(ctx, s[p]);
					else ctx[p].call(ctx, s[p]);
					break;
				default:
					ctx[p] = s[p];
			}
		}
	}
});

if (DEBUG) {
	CanvasView.prototype._skipLog = true;
}

module.exports = CanvasView;
}).call(this,true)

},{"app/control/Globals":34,"app/view/base/Interpolator":57,"app/view/base/View":60,"underscore":"underscore","utils/css/getBoxEdgeStyles":107}],56:[function(require,module,exports){
(function (DEBUG){
// /** @type {module:utils/setImmediate} */
// var setImmediate = require("utils/setImmediate");

// function sortByPriority(a, b) {
// 	if (a.priority > b.priority)
// 		return 1;
// 	if (a.priority < b.priority)
// 		return -1;
// 	return 0;
// }

function RequestQueue(offset) {
	this._offset = offset | 0;
	this._items = [];
	this._priorities = [];
	this._numItems = 0;
}

RequestQueue.prototype = Object.create({
	enqueue: function(item, priority) {
		var i = this._items.length;
		this._items[i] = item;
		this._priorities[i] = {
			priority: (priority | 0),
			index: i
		};
		this._numItems++;
		// console.log("FrameQueue::RequestQueue::enqueue() [numItems:%i] ID:%i", this._numItems, this._offset + i);
		return this._offset + i;
	},

	contains: function(index) {
		index -= this.offset;
		return 0 <= index && index < this._items.length;
	},

	skip: function(index) {
		var i, item;
		i = index - this._offset;
		if (0 > i || i >= this._items.length) {
			// 	console.warn("FrameQueue::RequestQueue::skip(id:%i) out of range (%i-%i)", index, this._offset, this._offset + (this._numItems - 1));
			return void 0;
		}
		item = this._items[i];
		if (item !== null) {
			// if (item = this._items[i]) {
			this._items[i] = null;
			this._numItems--;

			// if (this._numItems == 0) {
			// 	this._empty(this._offset + this._items.length);
			// }
			// console.log("FrameQueue::RequestQueue::skip(id:%i) [numItems:%i] skipping", index, this._numItems);
		}
		// else {
		// 	console.warn("FrameQueue::RequestQueue::skip(id:%i) [numItems:%i] item is null", index, this._numItems);
		// }
		return item;
	},

	// forEach: function(fn, context) {
	// 	return this.items.forEach(fn, context);
	// },

	indexes: function() {
		// .map(function(o, i, a) {
		// 	return this[o.index];
		// }, this._items);
		var items = this._priorities.concat();
		items.sort(function(a, b) {
			if (a.priority > b.priority)
				return 1;
			if (a.priority < b.priority)
				return -1;
			return 0;
		});
		items.forEach(function(o, i, a) {
			a[i] = o.index;
		}, this);
		return items;
	},

	items: function() {
		// .map(function(o, i, a) {
		// 	return this[o.index];
		// }, this._items);
		var items = this._priorities.concat();
		items.sort(function(a, b) {
			if (a.priority > b.priority)
				return 1;
			if (a.priority < b.priority)
				return -1;
			return 0;
		});
		items.forEach(function(o, i, a) {
			a[i] = this._items[o.index];
		}, this);
		return items;
	},

	_empty: function(offset) {
		this._offset = offset;
		this._items.length = 0;
		this._priorities.length = 0;
		this._numItems = 0;
	}
}, {

	offset: {
		get: function() {
			return this._offset;
		}
	},

	length: {
		get: function() {
			return this._items.length;
		}
	},

	numItems: {
		get: function() {
			return this._numItems;
		}
	},
});

var _nextQueue = new RequestQueue(0);
var _currQueue = null;

// var _pending = false;
var _running = false;
var _rafId = -1;

/**
/* @param tstamp {int}
/*/
var _runQueue = function(tstamp) {
	if (_running) throw new Error("wtf!!!");

	_rafId = -1;
	_running = true;
	_currQueue = _nextQueue;
	_nextQueue = new RequestQueue(_currQueue.offset + _currQueue.length);

	// _currQueue.items().forEach(function(fn, i, a) {
	// 	if (fn !== null) {
	// 		fn(tstamp);
	// 	}
	// });
	_currQueue.indexes().forEach(function(index, i, a) {
		var fn = _currQueue._items[index];
		if (fn !== null) {
			fn(tstamp);
		}
	});
	_running = false;
	_currQueue = null;

	if (_nextQueue.numItems > 0) {
		_rafId = window.requestAnimationFrame(_runQueue);
	}
};

var FrameQueue = Object.create({
	/**
	/* @param fn {Function}
	/* @param priority {int}
	/* @return {int}
	/*/
	request: function(fn, priority) {
		// if (!_running && !_pending) {
		// 	_pending = true;
		// 	console.warn("FrameQueue::request setImmediate: pending");
		// 	setImmediate(function() {
		// 		_pending = false;
		// 		if (_nextQueue.numItems > 0) {
		// 			_rafId = window.requestAnimationFrame(_runQueue);
		// 			console.warn("FrameQueue::request setImmediate: raf:%i for %i items", _rafId, _nextQueue.numItems);
		// 		} else {
		// 			console.warn("FrameQueue::request setImmediate: no items");
		// 		}
		// 	});
		// }
		if (!_running && _rafId === -1) {
			_rafId = window.requestAnimationFrame(_runQueue);
		}
		return _nextQueue.enqueue(fn, priority);
	},

	/**
	/* @param id {int}
	/* @return {Function?}
	/*/
	cancel: function(id) {
		var fn;
		if (_running) {
			fn = _currQueue.skip(id) || _nextQueue.skip(id);
		} else {
			fn = _nextQueue.skip(id);
			if ((_rafId !== -1) && (_nextQueue.numItems === 0)) {
				window.cancelAnimationFrame(_rafId);
				_rafId = -1;
			}
		}
		return fn;
	},
}, {
	running: {
		get: function() {
			return _running;
		}
	}
});

if (DEBUG) {
	/** @type {module:underscore} */
	var _ = require("underscore");

	// console.info("Using app/view/base/FrameQueue");

	// 	// // log frame exec time
	// 	// var _now = window.performance?
	// 	// 	window.performance.now.bind(window.performance) :
	// 	// 	Date.now.bind(Date);
	// 	// _runQueue = _.wrap(_runQueue, function(fn, tstamp) {
	// 	// 	var retval, tframe;
	// 	// 	console.log("[FRAME BEGIN] [%ims] %i items [ids:%i-%i]", tstamp, _nextQueue.numItems, _nextQueue.offset, _nextQueue.offset + _nextQueue.length);
	// 	// 	tframe = _now();
	// 	// 	retval = fn(tstamp);
	// 	// 	tframe = _now() - tframe;
	// 	// 	console.log("[FRAME ENDED] [%ims] took %ims\n---\n", tstamp + tframe, tframe);
	// 	// 	if (_nextQueue.numItems != 0) console.info("[FRAME ENDED] %i items scheduled for [raf:%i]", _nextQueue.numItems, _rafId);
	// 	// 	return retval;
	// 	// });

	/*
	var wrapConsole = function(prefix) {
		var shift = [].shift;
		var fnNames = ["group", "log", "info", "warn", "error"];
		var fnSrc = {};
		fnNames.forEach(function(fnName) {
			fnSrc[fnName] = console[fnName];
			console[fnName] = _.wrap(console[fnName], function() {
				if (typeof arguments[1] == "string") arguments[1] = prefix + " " + arguments[1];
				return shift.apply(arguments).apply(console, arguments);
			});
		});
		return function() {
			fnNames.forEach(function(fnName) {
				console[fnName] = fnSrc[fnName];
			});
		}
	}
	*/

	// log frame end
	_runQueue = _.wrap(_runQueue, function(fn, tstamp) {
		var retval;
		// var unwrap = wrapConsole("[raf " + _rafId + "]");
		// console.group("FrameQueue #" + _rafId);
		retval = fn(tstamp);
		// console.groupEnd();
		// unwrap();
		return retval;
	});

	// // use log prefix
	// if (console.prefix) {
	// 	_runQueue = _.wrap(_runQueue, function(fn, tstamp) {
	// 		var retval, logprefix;
	// 		logprefix = console.prefix;
	// 		console.prefix += "[raf:" + _rafId + "] ";
	// 		retval = fn(tstamp);
	// 		console.prefix = logprefix;
	// 		return retval;
	// 	});
	// }

	// FrameQueue.cancel = _.wrap(FrameQueue.cancel, function(fn, id) {
	// 	if ((_currQueue !== null) && (_currQueue.offset >= id) && (id < _nextQueue.offset)) {
	// 		console.info("FrameQueue::cancel ID:%i in running range (%i-%i)", id, _currQueue.offset, _nextQueue.offset - 1);
	// 	}
	// 	var rafId = _rafId;
	// 	var retval = fn(id);
	// 	if (retval === void 0) {
	// 		console.warn("FrameQueue::cancel ID:%i not found", id);
	// 	} else if (retval === null) {
	// 		console.warn("FrameQueue::cancel ID:%i already cancelled", id);
	// 	} else {
	// 		if (!_running && _nextQueue.numItems == 0) {
	// 			console.info("FrameQueue::cancel raf:%i cancelled (ID:%i cancelled, empty queue)", rafId, id);
	// 		}
	// 	}
	// 	return retval;
	// });
}


module.exports = FrameQueue;
}).call(this,true)

},{"underscore":"underscore"}],57:[function(require,module,exports){
/**
 * @module app/view/base/Interpolator
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
/** @type {module:utils/ease/linear} */
var linear = require("utils/ease/linear");

/**
 * @constructor
 * @type {module:app/view/base/Interpolator}
 */
function Interpolator(values, maxValues) {
	this._valueData = {};
	this._maxValues = {};
	this._renderableKeys = [];

	var key, val, maxVal;
	for (key in values) {
		val = values[key];
		maxVal = maxValues[key] || null;
		// create value object and store it
		this._valueData[key] = this._initValue(val, 0, maxVal);
		// add maxValue to store
		this._maxValues[key] = maxVal;
		// add to next render list
		this._renderableKeys.push(key);
	}
	this._valuesChanged = this._renderableKeys.length > 0;
}

Interpolator.prototype = Object.create({

	/* --------------------------- *
	/* public interface
	/* --------------------------- */

	isAtTarget: function(key) {
		return this._renderableKeys.indexOf(key) === -1;
	},

	getValue: function(key) {
		return this._valueData[key]._value;
	},

	getRenderedValue: function(key) {
		return this._valueData[key]._renderedValue;
	},

	valueTo: function(value, duration, key) {
		var changed, dataObj = this._valueData[key];
		// console.log("%s::valueTo [%s]", "[interpolator]", key, value);
		if (Array.isArray(dataObj)) {
			changed = value.reduce(function(prevChanged, itemValue, i) {
				if (dataObj[i]) {
					dataObj[i] = this._initNumber(itemValue, duration, this._maxValues[key]);
					return true;
				} else {
					return this._setValue(itemValue, duration, dataObj[i]) || prevChanged;
				}
			}.bind(this), changed);
		} else {
			changed = this._setValue(value, duration, dataObj);
		}
		if (changed) {
			this._renderableKeys.indexOf(key) !== -1 || this._renderableKeys.push(key);
			this._valuesChanged = true;
			// this.render();
			// this.requestRender();
		}
		return this;
	},

	updateValue: function(key) {
		// Call _interpolateValue only if needed. _interpolateValue() returns false
		// once interpolation is done, in which case remove key from _renderableKeys.
		var kIndex = this._renderableKeys.indexOf(key);
		if (kIndex !== -1 && !this._interpolateValue(key)) {
			this._renderableKeys.splice(kIndex, 1);
			this._valuesChanged = this._renderableKeys.length > 0;
		}
		return this;
	},

	/* --------------------------- *
	/* private: valueData
	/* --------------------------- */

	_initValue: function(value, duration, maxVal) {
		if (Array.isArray(value)) {
			return value.map(function(val) {
				return this._initNumber(val, 0, maxVal);
			}, this);
		} else {
			return this._initNumber(value, 0, maxVal);
		}
	},

	// _initArray: function(value, duration, maxVal) {
	// 	return val.map(function(val) {
	// 		return this._initNumber(val, 0, maxVal);
	// 	}, this);
	// },

	_initNumber: function(value, duration, maxVal) {
		var o = {};
		o._value = value;
		o._startValue = value;
		o._valueDelta = 0;

		o._duration = duration || 0;
		o._startTime = -1;
		o._elapsedTime = 0;

		o._lastRenderedValue = o._renderedValue = null;

		o._maxVal = maxVal;
		// if (maxVal !== void 0) o._maxVal = maxVal;
		// o._maxVal = this._maxValues[key];
		// o._maxVal = this._maxVal;// FIXME
		return o;
	},

	_setValue: function(value, duration, o) {
		if (o._value != value) {
			o._startValue = o._value;
			o._valueDelta = value - o._value;
			o._value = value;

			o._duration = duration || 0;
			o._startTime = -1;
			o._elapsedTime = 0;

			o._lastRenderedValue = o._renderedValue;

			return true;
		}
		return false;
	},

	/* --------------------------- *
	/* private: interpolate
	/* --------------------------- */

	/** @override */
	interpolate: function(tstamp) {
		if (this._valuesChanged) {
			this._valuesChanged = false;

			var changedKeys = this._renderableKeys;
			this._tstamp = tstamp;
			this._renderableKeys = changedKeys.filter(this._interpolateValue, this);
			this._renderedKeys = changedKeys;

			if (this._renderableKeys.length !== 0) {
				this._valuesChanged = true;
				// 	// this.requestRender();
			}
		}
		// console.log("%s::interpolate valuesChanged:%s tstamp:%f", "[interpolator]", this._valuesChanged, tstamp);
		// return this._valuesChanged;
		// return this.valuesChanged;

		return this;
	},

	_interpolateValue: function(key) {
		var dataObj = this._valueData[key];
		if (Array.isArray(dataObj)) {
			return dataObj.reduce(function(continueNext, o, index, arr) {
				return this._interpolateNumber(this._tstamp, o) || continueNext;
			}.bind(this), false);
		} else {
			return this._interpolateNumber(this._tstamp, dataObj);
		}
	},

	_interpolateNumber: function(tstamp, o) {
		if (o._startTime < 0) {
			o._startTime = tstamp;
		}
		var elapsed = tstamp - o._startTime;
		o._elapsedTime = elapsed;
		o._lastRenderedValue = o._renderedValue;
		if (elapsed < o._duration) {
			if (o._maxVal && o._valueDelta < 0) {
				// upper-bound values
				o._renderedValue = linear(elapsed, o._startValue,
					o._valueDelta + o._maxVal, o._duration) - o._maxVal;
			} else {
				// unbound values
				o._renderedValue = linear(elapsed, o._startValue,
					o._valueDelta, o._duration);
			}
			return true;
		} else {
			o._renderedValue = o._value;
			return false;
		}
	},
}, {
	valuesChanged: {
		get: function() {
			return this._valuesChanged;
		}
	},
	renderableKeys: {
		get: function() {
			return this._renderableKeys;
		}
	},
	renderedKeys: {
		get: function() {
			return this._renderedKeys;
		}
	},
});

module.exports = Interpolator;

},{"utils/ease/linear":108}],58:[function(require,module,exports){
(function (DEBUG){
/** @type {module:utils/prefixedEvent} */
var prefixedEvent = require("utils/prefixedEvent");

var eventMap = {
	"transitionend": prefixedEvent("transitionend"),
	"fullscreenchange": prefixedEvent("fullscreenchange", document),
	"fullscreenerror": prefixedEvent("fullscreenerror", document),
	"visibilitychange": prefixedEvent("visibilitychange", document, "hidden")
};

var eventNum = 0;
for (var eventName in eventMap) {
	if (eventName === eventMap[eventName]) {
		delete eventMap[eventName];
	} else {
		Object.defineProperty(eventMap, eventName, {
			value: eventMap[eventName],
			enumerable: true
		});
		Object.defineProperty(eventMap, eventNum, {
			value: eventName,
			enumerable: false
		});
		eventNum++;
	}
}
Object.defineProperty(eventMap, "length", {
	value: eventNum
});

if (DEBUG) {
	console.log("prefixes enabled for %i events", eventMap.length, Object.keys(eventMap));
}

module.exports = eventMap;

// module.exports = eventNum > 0? eventMap : null;

}).call(this,true)

},{"utils/prefixedEvent":111}],59:[function(require,module,exports){
/**
 * @module app/view/base/TouchManager
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
/** @type {module:hammerjs} */
var Hammer = require("hammerjs");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

/** @type {module:hammerjs.Tap} */
var Tap = Hammer.Tap;
/** @type {module:utils/touch/SmoothPanRecognizer} */
var Pan = require("utils/touch/SmoothPanRecognizer");
// /** @type {module:hammerjs.Pan} */
// var Pan = Hammer.Pan;

/* -------------------------------
/* Static private
/* ------------------------------- */

/**
 * @param el HTMLElement
 * @return {Hammer.Manager}
 */
function createInstance(el) {
	var manager, hpan, vpan, tap;
	hpan = new Pan({
		// threshold: Globals.PAN_THRESHOLD,
		// touchAction: "pan-y",
		direction: Hammer.DIRECTION_HORIZONTAL,
		event: "hpan",
	});
	vpan = new Pan({
		// threshold: Globals.PAN_THRESHOLD,
		// touchAction: "pan-x",
		direction: Hammer.DIRECTION_VERTICAL,
		event: "vpan",
	});
	tap = new Tap({
		// threshold: Globals.PAN_THRESHOLD - 1
	});
	manager = new Hammer.Manager(el);
	// manager.set({ domevents: true });
	manager.add([tap, hpan, vpan]);
	// manager.add([hpan, vpan]);
	vpan.requireFailure(hpan);
	// manager.add(hpan);
	return manager;
}

// function createInstance(el) {
// 	return new Hammer(el, {
// 		recognizers: [
// 			[Tap],
// 			[Pan, {
// 				event: 'hpan',
// 				direction: Hammer.DIRECTION_HORIZONTAL,
// 				threshold: Globals.THRESHOLD
// 			}],
// 			[Pan, {
// 				event: 'vpan',
// 				direction: Hammer.DIRECTION_VERTICAL,
// 				threshold: Globals.THRESHOLD
// 			}, ['hpan']]
// 		]
// 	});
// }

// function createInstance(el) {
// 	var recognizers = [];
// 	var manager = new Hammer.Manager(el);
//
// 	var hpan = new Pan({
// 		event: "hpan",
// 		threshold: Globals.THRESHOLD,
// 		direction: Hammer.DIRECTION_HORIZONTAL
// 	});
//
// 	var vpan = new Pan({
// 		event: "vpan",
// 		threshold: Globals.THRESHOLD,
// 		direction: Hammer.DIRECTION_VERTICAL
// 	});
//
// 	var tap = new Hammer.Tap();
// 	// var tap = new Hammer.Tap({
// 	// 	threshold: Globals.THRESHOLD - 1,
// 	// 	interval: 50,
// 	// 	time: 200
// 	// });
// 	recognizers.push(vpan);
// 	recognizers.push(hpan);
// 	recognizers.push(tap);
// 	manager.add(recognizers);
//
// 	hpan.recognizeWith([vpan]);
// 	hpan.requireFailure([vpan]);
// 	tap.recognizeWith([vpan, hpan]);
//
// 	// tap.requireFailure(vpan);
//
// 	// manager.set({ domevents: true });
// 	return manager;
// }

/*https://gist.githubusercontent.com/jtangelder/361052976f044200ea17/raw/f54c2cef78d59da3f38286fad683471e1c976072/PreventGhostClick.js*/

// function	logEvent(message) {
// 	console.log(message, domev.type,
// 		"panSessionOpened: " + panSessionOpened,
// 		"defaultPrevented: " + domev.defaultPrevented
// 	);
// }

var lastTimeStamp = -1;
var panSessionOpened = false;
var upEventName = window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup";

var touchHandlers = {};
touchHandlers["vpanstart vpanend vpancancel hpanstart hpanend hpancancel"] = function(hev) {
	// console.log("TouchManager:[%s]", hev.srcEvent.type);
	panSessionOpened = !hev.isFinal;
	if (hev.isFinal)
		lastTimeStamp = hev.srcEvent.timeStamp;
};
// touchHandlers["hammer.input tap vpanmove hpanmove"] = function(hev) {
// 	console.log("TouchManager:[%s -> %s]", hev.srcEvent.type, hev.type);
// };

var captureHandlers = {};
captureHandlers["click"] = function(domev) {
	if (lastTimeStamp == domev.timeStamp) {
		lastTimeStamp = -1;
		domev.defaultPrevented || domev.preventDefault();
		domev.stopPropagation();
	}
};
captureHandlers["dragstart"] = function(domev) {
	if (domev.target.nodeName == "IMG") {
		domev.defaultPrevented || domev.preventDefault();
	}
};
captureHandlers[upEventName] = function(domev) {
	panSessionOpened && domev.preventDefault();
};

var bubblingHandlers = {};

// -------------------------------
//
// -------------------------------

function addHandlers() {
	var eventName, el = instance.element;
	for (eventName in touchHandlers)
		if (touchHandlers.hasOwnProperty(eventName))
			instance.on(eventName, touchHandlers[eventName]);
	for (eventName in captureHandlers)
		if (captureHandlers.hasOwnProperty(eventName))
			el.addEventListener(eventName, captureHandlers[eventName], true);
	for (eventName in bubblingHandlers)
		if (bubblingHandlers.hasOwnProperty(eventName))
			el.addEventListener(eventName, bubblingHandlers[eventName], false);
}

function removeHandlers() {
	var eventName, el = instance.element;
	for (eventName in captureHandlers)
		if (captureHandlers.hasOwnProperty(eventName))
			el.removeEventListener(eventName, captureHandlers[eventName], true);
	for (eventName in bubblingHandlers)
		if (captureHandlers.hasOwnProperty(eventName))
			el.removeEventListener(eventName, bubblingHandlers[eventName], true);
}

/** @type {Hammer.Manager} */
var instance = null;

/* -------------------------------
/* Static public
/* ------------------------------- */

var TouchManager = {
	init: function(target) {
		if (instance === null) {
			instance = createInstance(target);
			addHandlers();
		} else if (instance.element !== target) {
			console.warn("TouchManager already initialized with another element");
		}
		return instance;
	},

	destroy: function() {
		if (instance !== null) {
			removeHandlers();
			instance.destroy();
			instance = null;
		} else {
			console.warn("no instance to destroy");
		}
	},

	getInstance: function() {
		if (instance === null) {
			console.error("TouchManager has not been initialized");
		}
		return instance;
	}
};

module.exports = TouchManager;
},{"app/control/Globals":34,"hammerjs":"hammerjs","utils/touch/SmoothPanRecognizer":118}],60:[function(require,module,exports){
(function (DEBUG){
/* global HTMLElement, MutationObserver */
/**
 * @module app/view/base/View
 */

/** @type {module:backbone} */
var Backbone = require("backbone");
/** @type {module:underscore} */
var _ = require("underscore");

/* -------------------------------
/* MutationObserver
/* ------------------------------- */

var _cidSeed = 1;
var _viewsByCid = {};

function addChildViews(el) {
	var view, els = el.querySelectorAll("*[data-cid]");
	for (var i = 0, ii = els.length; i < ii; i++) {
		view = View.findByElement(els.item(i));
		if (view) {
			if (!view.attached) {
				// console.log("View::[attached (parent)] %s", view.cid);
				view._elementAttached();
				// } else {
				// 	console.warn("View::[attached (parent)] %s (ignored)", view.cid);
			}
		}
	}
}

function removeChildViews(el) {
	var view, els = el.querySelectorAll("*[data-cid]");
	for (var i = 0, ii = els.length; i < ii; i++) {
		view = View.findByElement(els.item(i));
		if (view) {
			if (view.attached) {
				console.log("View::[detached (parent)] %s", view.cid);
				view._elementDetached();
			} else {
				console.warn("View::[detached (parent)] %s (ignored)", view.cid);
			}
		}
	}
}

var observer = new MutationObserver(function(mm) {
	// console.log("View::mutations %s", JSON.stringify(mm, null, " "));
	var i, ii, m;
	var j, jj, e;
	var view;
	for (i = 0, ii = mm.length; i < ii; i++) {
		m = mm[i];
		if (m.type == "childList") {
			for (j = 0, jj = m.addedNodes.length; j < jj; j++) {
				e = m.addedNodes.item(j);
				view = View.findByElement(e);
				if (view) {
					if (!view.attached) {
						// console.log("View::[attached (childList)] %s", view.cid);
						view._elementAttached();
						// } else {
						// 	console.warn("View::[attached (childList)] %s (ignored)", view.cid);
					}
				}
				if (e instanceof HTMLElement) addChildViews(e);
			}
			for (j = 0, jj = m.removedNodes.length; j < jj; j++) {
				e = m.removedNodes.item(j);
				// console.log("View::[detached (childList)] %s", e.cid);
				view = View.findByElement(e);
				if (view) {
					if (view.attached) {
						console.log("View::[detached (childList)] %s", view.cid, view.attached);
						view._elementDetached();
					} else {
						console.warn("View::[detached (childList)] %s (ignored)", view.cid, view.attached);
					}
				}
				if (e instanceof HTMLElement) removeChildViews(e);
			}
		} else if (m.type == "attributes") {
			view = View.findByElement(m.target);
			if (view) {
				if (!view.attached) {
					// console.log("View::[attached (attribute)] %s", view.cid);
					view._elementAttached();
					// } else {
					// 	console.warn("View::[attached (attribute)] %s (ignored)", view.cid);
				}
			}
			// else {
			// 	console.warn("View::[attributes] target has no cid (%s='%s')", m.attributeName, m.target.getAttribute(m.attributeName), m);
			// }
		}
	}
});

observer.observe(document.body, {
	attributes: true,
	childList: true,
	subtree: true,
	attributeFilter: ["data-cid"]
});

/* -------------------------------
/* static private
/* ------------------------------- */

/** @type {module:app/view/base/FrameQueue} */
var FrameQueue = require("app/view/base/FrameQueue");

/** @type {module:app/view/base/PrefixedEvents} */
var PrefixedEvents = require("app/view/base/PrefixedEvents");

var _now = window.performance ?
	window.performance.now.bind(window.performance) :
	Date.now.bind(Date);
// var _now = window.performance?
// 	function() { return window.performance.now(); }:
// 	function() { return Date.now(); };

var applyEventPrefixes = function(events) {
	var selector, unprefixed;
	for (selector in events) {
		unprefixed = selector.match(/^\w+/i)[0];
		if (PrefixedEvents.hasOwnProperty(unprefixed)) {
			events[selector.replace(unprefixed, PrefixedEvents[unprefixed])] = events[selector];
			// console.log("applyEventPrefixes", unprefixed, prefixedEvents[unprefixed]);
			delete events[selector];
		}
	}
	return events;
};

var getViewDepth = function(view) {
	if (!view) {
		return null;
	}
	if (!view.attached) {
		return NaN;
	}
	if (view.parentView === null) {
		return 0;
	}
	return view.parentView.viewDepth + 1;
};

function logAttachInfo(view, name, level) {
	if (["log", "info", "warn", "error"].indexOf(level) != -1) {
		level = "log";
	}
	console[level].call(console, "%s::%s [parent:%s %s %s depth:%s]", view.cid, name, view.parentView && view.parentView.cid, view.attached ? "attached" : "detached", view._viewPhase, view.viewDepth);
}

/* -------------------------------
/* static public
/* ------------------------------- */


var View = {

	/** @const */
	NONE_INVALID: 0,
	/** @const */
	CHILDREN_INVALID: 1,

	/** @const */
	MODEL_INVALID: 2,
	/** @const */
	STYLES_INVALID: 4,
	/** @const */
	SIZE_INVALID: 8,
	/** @const */
	LAYOUT_INVALID: 16,

	/** @const */
	// RENDER_INVALID: 8 | 16,

	/** @type {module:app/view/base/ViewError} */
	ViewError: require("app/view/base/ViewError"),

	/** @type {module:utils/prefixedProperty} */
	prefixedProperty: require("utils/prefixedProperty"),

	/** @type {module:utils/prefixedStyleName} */
	prefixedStyleName: require("utils/prefixedStyleName"),

	/** @type {module:utils/prefixedEvent} */
	prefixedEvent: require("utils/prefixedEvent"),

	// /** @type {module:utils/setImmediate} */
	// setImmediate: require("utils/setImmediate"),

	/** @type {module:app/view/promise/whenViewIsAttached} */
	whenViewIsAttached: require("app/view/promise/whenViewIsAttached"),


	/** @type {module:app/view/promise/whenViewIsRendered} */
	whenViewIsRendered: require("app/view/promise/whenViewIsRendered"),

	/**
	/* @param el {HTMLElement}
	/* @return {module:app/view/base/View}
	/*/
	findByElement: function(el) {
		if (_viewsByCid[el.cid]) {
			return _viewsByCid[el.cid];
		}
		return null;
	},

	/**
	/* @param el {HTMLElement}
	/* @return {module:app/view/base/View}
	/*/
	findByDescendant: function(el) {
		do {
			if (_viewsByCid[el.cid]) {
				return _viewsByCid[el.cid];
			}
		} while ((el = el.parentElement || el.parentNode));
		return null;
	},

	/** @override */
	extend: function(proto, obj) {
		if (PrefixedEvents.length && proto.events) {
			if (_.isFunction(proto.events)) {
				proto.events = _.wrap(proto.events, function(fn) {
					return applyEventPrefixes(fn.apply(this));
				});
			} else
			if (_.isObject(proto.events)) {
				proto.events = applyEventPrefixes(proto.events);
			}
		}
		if (proto.properties && this.prototype.properties) {
			_.defaults(proto.properties, this.prototype.properties);
		}
		return Backbone.View.extend.apply(this, arguments);
	},

	_flagsToStrings: ["-"],

	flagsToString: function(flags) {
		var s = View._flagsToStrings[flags | 0];
		if (!s) {
			s = [];
			if (flags & View.CHILDREN_INVALID) s.push("children");
			if (flags & View.MODEL_INVALID) s.push("model");
			if (flags & View.STYLES_INVALID) s.push("styles");
			if (flags & View.SIZE_INVALID) s.push("size");
			if (flags & View.LAYOUT_INVALID) s.push("layout");
			View._flagsToStrings[flags] = s = s.join(" ");
		}
		return s;
		// return (flags | 0).toString(2);
	},
};

Object.defineProperty(View, "instances", {
	value: _viewsByCid,
	enumerable: true
});

/* -------------------------------
/* prototype
/* ------------------------------- */

var ViewProto = {

	/** @type {string} */
	cidPrefix: "view",
	/** @type {Boolean} */
	_attached: false,
	/** @type {HTMLElement|null} */
	_parentView: null,
	/** @type {int|null} */
	_viewDepth: null,
	/** @type {string} initializing > initialized > disposing > disposed */
	_viewPhase: "initializing",
	/** @type {int} */
	_frameQueueId: -1,
	/** @type {int} */
	_renderFlags: 0,

	/** @type {object} */
	properties: {
		cid: {
			get: function() {
				return this._cid || (this._cid = this.cidPrefix + _cidSeed++);
			}
		},
		attached: {
			get: function() {
				return this._attached;
			}
		},
		parentView: {
			get: function() {
				return this._parentView;
			}
		},
		viewDepth: {
			get: function() {
				return this._getViewDepth();
			}
		},
		invalidated: {
			get: function() {
				return this._frameQueueId !== -1;
			}
		},
		enabled: {
			get: function() {
				return this._enabled;
			},
			set: function(enabled) {
				this.setEnabled(enabled);
			}
		},
		renderFlags: {
			get: function() {
				return this._renderFlags;
			}
		}
	},

	/**
	 * @constructor
	 * @type {module:app/view/base/View}
	 */
	constructor: function(options) {
		this.transform = {};
		this.childViews = {};
		this._applyRender = this._applyRender.bind(this);

		if (this.properties) {
			// Object.defineProperties(this, getPrototypeChainValue(this, "properties", Backbone.View));
			Object.defineProperties(this, this.properties);
		}
		if (options && options.className && this.className) {
			options.className += " " + _.result(this, "className");
		}
		if (options && options.parentView) {
			this._setParentView(options.parentView, true);
		}
		Backbone.View.apply(this, arguments);

		// console.log("%s::initialize viewPhase:[%s => initialized]", this.cid, this._viewPhase);
		this._viewPhase = "initialized";

		if (this.parentView !== null) {
			this.trigger("view:parentChange", this.parentView, null);
		}
		if (this.attached) {
			this.trigger("view:attached", this);
		}
	},

	/* -------------------------------
	/* remove
	/* ------------------------------- */

	/** @override */
	remove: function() {
		if (this._viewPhase == "disposing") {
			logAttachInfo(this, "remove", "warn");
		} else {
			// logAttachInfo(this, "remove", "log");
		}

		// before removal
		this._viewPhase = "disposing";
		this._cancelRender();

		// call Backbone impl
		// Backbone.View.prototype.remove.apply(this, arguments);

		// NOTE: from Backbone impl
		this.$el.remove(); // from Backbone impl

		this._attached = false;
		this.trigger("view:removed", this);

		// remove parent/child references
		this._setParentView(null);

		// NOTE: from Backbone impl. No more events after this
		this.stopListening();

		// check for invalidations that may have been triggered by "view:removed"
		if (this.invalidated) {
			console.warn("%s::remove invalidated after remove()", this.cid);
			this._cancelRender();
		}
		// // check for children still here
		// var ccids = Object.keys(this.childViews);
		// if (ccids.length) {
		// 	console.warn("%s::remove %i children not removed [%s]", this.cid, ccids.length, ccids.join(", "), this.childViews);
		// }
		// // remove childViews
		// for (var cid in this.childViews) {
		// 	this.childViews[cid].remove();
		// }
		// clear reference in view map
		delete _viewsByCid[this.cid];
		// delete this.el.cid;
		// update phase
		this._viewPhase = "disposed";
		return this;
	},

	/* -------------------------------
	/* _elementAttached _elementDetached
	/* ------------------------------- */

	_elementAttached: function() {
		// this._addToParentView();
		this._attached = true;
		this._viewDepth = null;
		this._setParentView(View.findByDescendant(this.el.parentElement));

		// if (this.parentView) {
		// 	console.log("[attach] [%i] %s > %s::_elementAttached", this.viewDepth, this.parentView.cid, this.cid);
		// } else {
		// 	console.log("[attach] [%i] %s::_elementAttached", this.viewDepth, this.cid);
		// }

		// if (this._viewPhase == "initializing") {
		// 	// this.trigger("view:attached", this);
		// } else
		if (this._viewPhase == "initialized") {
			this.trigger("view:attached", this);
		} else
		if (this._viewPhase == "replacing") {
			this._viewPhase = "initialized";
			this.trigger("view:replaced", this);
		}
	},

	_elementDetached: function() {
		if (!this.attached || (this._viewPhase == "disposing") || (this._viewPhase == "disposed")) {
			logAttachInfo(this, "_elementDetached", "error");
			// } else {
			// 	logAttachInfo(this, "_elementDetached", "log");
		}
		this._attached = false;
		this._viewDepth = null;

		if (this._viewPhase != "disposing" || this._viewPhase == "disposed") {
			this.remove();
		}
	},

	/* -------------------------------
	/* parentView
	/* ------------------------------- */

	_setParentView: function(newParent, silent) {
		if (newParent === void 0) {
			console.warn("$s::_setParentView invalid value '%s'", this.cid, newParent);
			newParent = null;
		}
		var oldParent = this._parentView;
		this._parentView = newParent;

		// force update of _viewDepth
		this._viewDepth = null; //getViewDepth(this);

		// skip the rest if arg is the same
		if (newParent === oldParent) {
			return;
		}
		if (oldParent !== null) {
			if (this.cid in oldParent.childViews) {
				delete oldParent.childViews[this.cid];
			}
		}
		if (newParent !== null) {
			newParent.childViews[this.cid] = this;
		}
		if (!silent)
			this.trigger("view:parentChange", this, newParent, oldParent);
	},

	whenAttached: function() {
		return View.whenViewIsAttached(this);
	},

	_getViewDepth: function() {
		if (this._viewDepth === null) {
			this._viewDepth = getViewDepth(this);
		}
		return this._viewDepth;
	},

	/* -------------------------------
	/* Backbone.View overrides
	/* ------------------------------- */

	/** @override */
	setElement: function(element, delegate) {
		// setElement always initializes this.el, so check it to be non-null before calling super
		if (this.el) {
			if (this.el !== element && this.el.parentElement) {
				// Element is being replaced
				if (this.attached) {
					// Since old element is attached to document tree, _elementAttached will be
					// triggered by replaceChild: set _viewPhase = "replacing" to flag this
					// change and trigger 'view:replaced' instead of 'view:added'.
					this._viewPhase = "replacing";
				}
				this.el.parentElement.replaceChild(element, this.el);
			}
			Backbone.View.prototype.setElement.apply(this, arguments);
			// Merge classes specified by this view with the ones already in the element,
			// as backbone will not:
			if (this.className) {
				_.result(this, "className").split(" ").forEach(function(item) {
					this.el.classList.add(item);
				}, this);
			}
		} else {
			Backbone.View.prototype.setElement.apply(this, arguments);
		}

		if (this.el === void 0) {
			throw new Error("Backbone view has no element");
		}
		_viewsByCid[this.cid] = this;
		this.el.cid = this.cid;
		this.el.setAttribute("data-cid", this.cid);

		return this;
	},

	/* -------------------------------
	/* requestAnimationFrame
	/* ------------------------------- */

	requestAnimationFrame: function(callback, priority, ctx) {
		return FrameQueue.request(callback.bind(ctx || this), priority);
	},

	cancelAnimationFrame: function(id) {
		return FrameQueue.cancel(id);
	},

	setImmediate: function(callback, ctx) {
		window.setImmediate(callback.bind(ctx || this));
	},

	/* -------------------------------
	/* deferred render: private methods
	/* ------------------------------- */

	/** @private */
	_applyRender: function(tstamp) {
		if (DEBUG) {
			if (!this._skipLog) {
				console.log("%s::_applyRender [%s] [%s, %s, %s]", this.cid,
					View.flagsToString(this._renderFlags),
					(this._frameQueueId != -1 ? "async #" + this._frameQueueId : "sync"),
					(this.attached ? "attached" : "detached"),
					(this.skipTransitions ? "skip" : "run") + " tx"
				);
			}
		}

		var flags = this._renderFlags;
		this.trigger("view:render:before", this, flags);
		this._renderFlags = 0;
		this._frameQueueId = -1;
		this._renderFlags |= this.renderFrame(tstamp, flags);
		this.trigger("view:render:after", this, flags);

		if (this._renderFlags != 0) {
			console.warn("%s::_applyRender [returned] flags: %s", this.cid, View.flagsToString(this._renderFlags), this._renderFlags);
		}
	},

	_cancelRender: function() {
		if (this._frameQueueId != -1) {
			var cancelId, cancelFn;

			cancelId = this._frameQueueId;
			this._frameQueueId = -1;
			cancelFn = FrameQueue.cancel(cancelId);

			if (cancelFn === void 0) {
				console.warn("%s::_cancelRender ID:%i not found", this.cid, cancelId);
			} else if (cancelFn === null) {
				console.warn("%s::_cancelRender ID:%i already cancelled", this.cid, cancelId);
				// } else {
				// 	if (!this._skipLog && !FrameQueue.running)
				// 		console.log("%s::_cancelRender ID:%i cancelled", this.cid, cancelId);
			}
		}
	},

	_requestRender: function() {
		if (FrameQueue.running) {
			this._cancelRender();
			if (DEBUG) {
				if (!this._skipLog) {
					console.info("%s::_requestRender rescheduled [%s (%s)]", this.cid, View.flagsToString(this._renderFlags), this._renderFlags);
				}
			}
		}
		if (this._frameQueueId == -1) {
			this._frameQueueId = FrameQueue.request(this._applyRender, isNaN(this.viewDepth) ? Number.MAX_VALUE : this.viewDepth);
		}
	},

	/* -------------------------------
	/* render: public / abstract methods
	/* ------------------------------- */

	invalidate: function(flags) {
		if (flags !== void 0) {
			/*if (DEBUG) {
				if (!this._skipLog) {
					if (this._renderFlags > 0) {
						console.log("%s::invalidate [%s (%s)] + [%s (%s)]", this.cid, View.flagsToString(this._renderFlags), this._renderFlags, View.flagsToString(flags), flags);
					} else {
						console.log("%s::invalidate [%s (%s)]", this.cid, View.flagsToString(flags), flags);
					}
				}
			}*/
			this._renderFlags |= flags;
		}
		return this;
	},

	requestRender: function(flags) {
		// if (flags !== void 0) {
		// 	this._renderFlags |= flags;
		// }
		this.invalidate(flags);
		this._requestRender();
		return this;
	},

	/** @abstract */
	renderFrame: function(tstamp, flags) {
		// subclasses should override this method
		return View.NONE_INVALID;
	},

	renderNow: function(alwaysRun) {
		if (this._frameQueueId != -1) {
			this._cancelRender();
			alwaysRun = true;
		}
		// if (alwaysRun === true) {
		if (alwaysRun) {
			this._applyRender(_now());
		}
		return this;
	},

	whenRendered: function() {
		return View.whenViewIsRendered(this);
	},

	/* -------------------------------
	/* render bitwise flags
	/* - check: this._renderFlags & flags
	/* - add: this._renderFlags |= flags
	/* - remove: this._renderFlags &= ~flags
	/* ------------------------------- */

	/* helpers ------------------ */

	requestChildrenRender: function(flags, now, force) {
		var ccid, view;
		for (ccid in this.childViews) {
			view = this.childViews[ccid];
			view.skipTransitions = !!(flags & View.SIZE_INVALID);
			view.requestRender(flags);
			if (now) {
				view.renderNow(force);
			}
		}
	},

	render: function() {
		return this.renderNow(true);
	},

	/* -------------------------------
	/* common abstract
	/* ------------------------------- */

	/** @private */
	_enabled: undefined,

	/**
	/* @param {Boolean}
	/*/
	setEnabled: function(enable) {
		this._enabled = enable;
	},
};

module.exports = Backbone.View.extend(ViewProto, View);
}).call(this,true)

},{"app/view/base/FrameQueue":56,"app/view/base/PrefixedEvents":58,"app/view/base/ViewError":61,"app/view/promise/whenViewIsAttached":81,"app/view/promise/whenViewIsRendered":82,"backbone":"backbone","underscore":"underscore","utils/prefixedEvent":111,"utils/prefixedProperty":112,"utils/prefixedStyleName":113}],61:[function(require,module,exports){
function ViewError(view, err) {
	this.view = view;
	this.err = err;
	this.message = err.message;
}
ViewError.prototype = Object.create(Error.prototype);
ViewError.prototype.constructor = ViewError;
ViewError.prototype.name = "ViewError";

module.exports = ViewError;

},{}],62:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=container.escapeExpression, alias4="function";

  return "<a href=\""
    + alias3((helpers.global || (depth0 && depth0.global) || alias2).call(alias1,"APP_ROOT",{"name":"global","hash":{},"data":data}))
    + "#"
    + alias3(((helper = (helper = helpers.handle || (depth0 != null ? depth0.handle : depth0)) != null ? helper : alias2),(typeof helper === alias4 ? helper.call(alias1,{"name":"handle","hash":{},"data":data}) : helper)))
    + "\">"
    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias4 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</a>\n";
},"useData":true});

},{"hbsfy/runtime":21}],63:[function(require,module,exports){
/**
/* @module app/view/component/ArticleView
/*/

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {Function} */
var viewTemplate = require("./ArticleButton.hbs");

/**
/* @constructor
/* @type {module:app/view/component/ArticleButton}
/*/
var ArticleButton = View.extend({

	/** @type {string} */
	cidPrefix: "articleButton",
	/** @override */
	tagName: "h2",
	/** @override */
	className: "article-button",
	/** @type {Function} */
	template: viewTemplate,

	events: {
		"click a": function(domev) {
			domev.defaultPrevented || domev.preventDefault();
			this.trigger("view:click", this.model);
		}
	},

	// /** @override */
	// initialize: function(options) {},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		this.el.innerHTML = this.template(this.model.toJSON());
	},
});
module.exports = ArticleButton;
},{"./ArticleButton.hbs":62,"app/view/base/View":60}],64:[function(require,module,exports){
/**
/* @module app/view/component/ArticleView
/*/

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");

// /** @type {module:utils/net/toAbsoluteURL} */
// var toAbsoluteURL = require("utils/net/toAbsoluteURL");
//
// /** @type {string} */
// var ABS_APP_ROOT = toAbsoluteURL(require("app/control/Globals").APP_ROOT);

/**
/* @constructor
/* @type {module:app/view/component/ArticleView}
/*/
var ArticleView = View.extend({

	/** @type {string} */
	cidPrefix: "articleView",
	/** @override */
	tagName: "article",
	/** @override */
	className: "article-view mdown",

	/** @override */
	initialize: function(options) {},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		this.el.innerHTML = this.model.get("text");
		// FIXME: now done in xslt
		// this.el.querySelectorAll("a[href]").forEach(function(el) {
		// 	var url = toAbsoluteURL(el.getAttribute("href"));
		// 	if (url.indexOf(ABS_APP_ROOT) !== 0) {
		// 		el.setAttribute("target", "_blank");
		// 	}
		// });
	},
});
module.exports = ArticleView;
},{"app/view/base/View":60}],65:[function(require,module,exports){
/**
/* @module app/view/component/Carousel
/*/

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");

/** @type {module:hammerjs} */
var Hammer = require("hammerjs");
/** @type {module:utils/touch/SmoothPanRecognizer} */
var Pan = require("utils/touch/SmoothPanRecognizer");
/** @type {module:hammerjs.Tap} */
var Tap = Hammer.Tap;

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
// /** @type {module:app/view/base/DeferredView} */
// var View = require("app/view/base/DeferredView");

/** @type {module:app/view/render/CarouselRenderer} */
var CarouselRenderer = require("app/view/render/CarouselRenderer");

/** @type {module:utils/prefixedProperty} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {module:utils/prefixedStyleName} */
var prefixedStyleName = require("utils/prefixedStyleName");

var transformStyleName = prefixedStyleName("transform");
var transformProperty = prefixedProperty("transform");
var translateTemplate = Globals.TRANSLATE_TEMPLATE;

// var cssToPx = function(cssVal, el) {
// 	return parseInt(cssVal);
// };

// var defaultRendererFunction = (function() {
// 	var defaultRenderer = CarouselRenderer.extend({ className: "carousel-item default-renderer"}),
// 		emptyRenderer = CarouselRenderer.extend({ className: "carousel-item empty-renderer"});
// 	return function(item, index, arr) {
// 		return (index === -1)? emptyRenderer: defaultRenderer;
// 	};
// })();

/** @const */
var MAX_SELECT_THRESHOLD = 20;

// /** @const */
// var CHILDREN_INVALID = View.CHILDREN_INVALID,
// 	STYLES_INVALID = View.STYLES_INVALID,
// 	MODEL_INVALID = View.MODEL_INVALID,
// 	SIZE_INVALID = View.SIZE_INVALID,
// 	LAYOUT_INVALID = View.LAYOUT_INVALID;

var VERTICAL = Hammer.DIRECTION_VERTICAL,
	HORIZONTAL = Hammer.DIRECTION_HORIZONTAL;

// x: ["x", "y"],
// y: ["y", "x"],
// offsetLeft: ["offsetLeft", "offsetTop"],
// offsetTop: ["offsetTop", "offsetLeft"],
// offsetWidth: ["offsetWidth", "offsetHeight"],
// offsetHeight: ["offsetHeight", "offsetWidth"],
// width: ["width","height"],
// height: ["height","width"],
// marginLeft: ["marginLeft","marginTop"],
// marginRight: ["marginRight","marginBottom"],

/*
var HORIZONTAL_PROPS = {
	pos: "x",
	size: "width",
	offsetPos: "offsetLeft",
	offsetSize: "offsetWidth",
	marginBefore: "marginLeft",
	marginAfter: "marginRight",
};
var VERTICAL_PROPS = {
	pos: "y",
	size: "height",
	offsetPos: "offsetTop",
	offsetSize: "offsetHeight",
	marginBefore: "marginTop",
	marginAfter: "marginBottom",
};
*/

// var DIRECTION_NONE = 1;
// var DIRECTION_LEFT = 2;
// var DIRECTION_RIGHT = 4;
// var DIRECTION_UP = 8;
// var DIRECTION_DOWN = 16;

// function dirToStr(dir) {
// 	if (dir === Hammer.DIRECTION_NONE) return 'NONE';
// 	if (dir === Hammer.DIRECTION_LEFT) return 'LEFT';
// 	if (dir === Hammer.DIRECTION_RIGHT) return 'RIGHT';
// 	if (dir === Hammer.DIRECTION_UP) return 'UP';
// 	if (dir === Hammer.DIRECTION_DOWN) return 'DOWN';
// 	if (dir === Hammer.DIRECTION_HORIZONTAL) return 'HORIZONTAL';
// 	if (dir === Hammer.DIRECTION_VERTICAL) return 'VERTICAL';
// 	if (dir === Hammer.DIRECTION_ALL) return 'ALL';
// 	return 'UNRECOGNIZED';
// }

var isValidTouchManager = function(touch, direction) {
	// var retval;
	try {
		return touch.get("hpan").options.direction == direction;
	} catch (err) {
		return false;
	}
	// return retval;
};

// /** @type {int} In pixels */
// var panThreshold: 15;

var createTouchManager = function(el, dir, thres) {
	var touch = new Hammer.Manager(el);
	var pan = new Pan({
		event: "hpan",
		threshold: Globals.THRESHOLD,
		direction: Hammer.DIRECTION_HORIZONTAL,
	});
	var tap = new Tap({
		threshold: Globals.THRESHOLD - 1,
		interval: 50,
		time: 200,
	});
	tap.recognizeWith(pan);
	touch.add([pan, tap]);
	return touch;
};


var Carousel = {
	/** const */
	ANIMATED: false,
	/** const */
	IMMEDIATE: true,

	/** copy of Hammer.DIRECTION_VERTICAL */
	DIRECTION_VERTICAL: VERTICAL,
	/** copy of Hammer.DIRECTION_HORIZONTAL */
	DIRECTION_HORIZONTAL: HORIZONTAL,
	/** @type {Object} */
	defaults: {
		/** @type {boolean} */
		selectOnScrollEnd: false,
		/** @type {boolean} */
		requireSelection: false,
		/** @type {int} */
		direction: HORIZONTAL,
		/** @type {int} In pixels */
		selectThreshold: 20,
		/** @type {Function} */
		rendererFunction: (function() {
			var defaultRenderer = CarouselRenderer.extend({
					className: "carousel-item default-renderer"
				}),
				emptyRenderer = CarouselRenderer.extend({
					className: "carousel-item empty-renderer"
				});
			return function(item, index, arr) {
				return (index === -1) ? emptyRenderer : defaultRenderer;
			};
		})(),
	},
};
Carousel.validOptions = _.keys(Carousel.defaults);

/**
/* @constructor
/* @type {module:app/view/component/Carousel}
/*/
var CarouselProto = {

	/** @override */
	cidPrefix: "carousel",
	/** @override */
	tagName: "div",
	/** @override */
	className: "carousel skip-transitions",

	/* --------------------------- *
	/* properties
	/* --------------------------- */

	properties: {
		scrolling: {
			get: function() {
				return this._scrolling;
			}
		},
		selectedItem: {
			get: function() {
				return this._selectedView.model;
			},
			set: function(value) {
				if (value)
					this._onSelectOne(value)
				else
					this._onSelectNone();
			}
		},
	},

	events: {
		// "mousedown": "_onMouseDown", "mouseup": "_onMouseUp",
		"transitionend .carousel-item.selected": "_onScrollTransitionEnd",
	},

	/** @override */
	initialize: function(options) {
		_.bindAll(this, "_onTouchEvent");

		this.itemViews = new Container();
		this.metrics = {};

		_.extend(this, _.defaults(_.pick(options, Carousel.validOptions), Carousel.defaults));

		// this.childGap = 0; //this.dirProp(20, 18);
		this._precedingDir = (Hammer.DIRECTION_LEFT | Hammer.DIRECTION_UP) & this.direction;
		this._followingDir = (Hammer.DIRECTION_RIGHT | Hammer.DIRECTION_DOWN) & this.direction;

		// use supplied touch mgr or create private
		if (isValidTouchManager(options.touch, this.direction)) {
			this.touch = options.touch;
		} else {
			console.warn("%s::initialize creating Hammer instance", this.cid);
			this.touch = createTouchManager(this.el, this.direction);
			// this.on("view:removed", this.touch.destroy, this.touch);
			this.listenTo(this, "view:removed", function() {
				this.touch.destroy();
			});
		}

		/* create children and props */
		this.setEnabled(true);
		this.skipTransitions = true;
		this._renderFlags = View.CHILDREN_INVALID;
		// this.invalidateChildren();

		this.listenTo(this, "view:attached", function() {
			this.skipTransitions = true;
			// this.invalidateSize();
			// this.renderNow();
			// this.requestRender();
			this.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
		});

		/* collection listeners */
		this.listenTo(this.collection, {
			"reset": this._onReset,
			"select:one": this._onSelectOne,
			"select:none": this._onSelectNone,
			"deselect:one": this._onDeselectAny,
			"deselect:none": this._onDeselectAny,
		});
	},
	/* --------------------------- *
	/* Hammer init
	/* --------------------------- */

	// validateTouchManager: function(touch, direction) {
	// 	try {
	// 		return touch.get("pan").options.direction === direction);
	// 	} catch (err) {
	// 		return false;
	// 	}
	// },

	// initializeHammer: function(options) {
	// 	// direction from opts/defaults
	// 	if (options.direction === VERTICAL) {
	// 		this.direction = VERTICAL;
	// 	} // do nothing: the default is horizontal
	//
	// 	// validate hammer instance or create local
	// 	if ((touch = options.touch) && (pan = touch.get("pan"))) {
	// 		// Override direction only if specific
	// 		if (pan.options.direction !== Hammer.DIRECTION_ALL) {
	// 			this.direction = pan.options.direction;
	// 		}
	// 		this.panThreshold = pan.options.threshold;
	// 	} else {
	// 		console.warn("%s::initializeHammer using private Hammer instance", this.cid);
	// 		touch = createHammerInstance(this.el, this.panThreshold, this.direction);
	// 		this.on("view:removed", touch.destroy, touch);
	// 	}
	// 	this.touch = touch;
	// },

	remove: function() {
		// this._scrollPendingAction && this._scrollPendingAction(true);
		// if (this._enabled) {
		// 	this.touch.off("tap", this._onTap);
		// 	this.touch.off("hpanstart hpanmove hpanend hpancancel", this._onPan);
		// }
		this._toggleTouchEvents(false);
		this.removeChildren();
		View.prototype.remove.apply(this, arguments);
		return this;
	},


	/* --------------------------- *
	/* helper functions
	/* --------------------------- */

	dirProp: function(hProp, vProp) {
		return (this.direction & HORIZONTAL) ? hProp : vProp;
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	// render: function() {
	// 	if (this.attached) {
	// 		this.skipTransitions = true;
	// 		// this.invalidateSize();
	// 		this.renderNow(true);
	// 	}
	// },

	// /** @override */
	// render: function () {
	// 	if (!this.attached) {
	// 		if (!this._renderPending) {
	// 			this._renderPending = true;
	// 			this.listenTo(this, "view:attached", this.render);
	// 		}
	// 	} else {
	// 		if (this._renderPending) {
	// 			this._renderPending = false;
	// 			this.stopListening(this, "view:attached", this.render);
	// 		}
	// 		this._delta = 0;
	// 		this.skipTransitions = true;
	// 		this.invalidateSize();
	// 		// this.invalidateLayout();
	// 		this.renderNow();
	// 	}
	// 	return this;
	// },

	// render: function () {
	// 	this.measureLater();
	// 	this.scrollBy(0, Carousel.IMMEDIATE);
	//
	// 	if (this.el.parentElement) {
	// 		this.renderNow();
	// 	}
	// 	return this;
	// },

	/** @override */
	renderFrame: function(tstamp, flags) {
		if (flags & View.CHILDREN_INVALID) {
			this._createChildren();
			// clear this flag now: render may be deferred until attached
			flags &= ~View.CHILDREN_INVALID;
		}
		if (this.attached) {
			if (flags & View.SIZE_INVALID) {
				this._measure();
			}
			if (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {
				this._scrollBy(this._delta, this.skipTransitions);
			}
		} else if (flags) {
			this.listenToOnce(this, "view:attached", function() {
				this.requestRender(flags);
			});
		}
	},

	/* --------------------------- *
	/* enabled
	/* --------------------------- */

	/** @override */
	_enabled: undefined,

	/** @override */
	setEnabled: function(enabled) {
		if (this._enabled !== enabled) {
			this._enabled = enabled;
			// toggle events immediately
			this._toggleTouchEvents(enabled);
			// dom manipulation on render (_renderEnabled)
			// this._renderFlags |= View.STYLES_INVALID;
			// this.requestRender();

			this.el.classList.toggle("disabled", !this.enabled);
			this.itemViews.each(function(view) {
				view.setEnabled(this.enabled);
			}, this);
		}
	},

	_renderEnabled: function() {
		this.el.classList.toggle("disabled", !this.enabled);
		this.itemViews.each(function(view) {
			view.setEnabled(this.enabled);
		}, this);
	},

	/* --------------------------- *
	/* Create children
	/* --------------------------- */

	_createChildren: function() {
		// var sIndex;
		var buffer, renderer, view, viewOpts;

		this.removeChildren();

		if (this.collection.length) {
			viewOpts = {
				// viewDepth: this.viewDepth + 1,
				// parentView: this,
				enabled: this.enabled
			};
			buffer = document.createDocumentFragment();
			// buffer = this.el;

			if (!this.requireSelection) {
				renderer = this.rendererFunction(null, -1, this.collection);
				view = new renderer(viewOpts);
				this.itemViews.add(view);
				buffer.appendChild(view.el);
				this.emptyView = view;
			}

			this.collection.each(function(item, index, arr) {
				viewOpts.model = item;
				renderer = this.rendererFunction(item, index, arr);
				view = new renderer(viewOpts);
				this.itemViews.add(view);
				buffer.appendChild(view.el);
			}, this);

			// if (!this.requireSelection) {
			// 	buffer = this.appendItemView(buffer, this.model, -1, this.collection);
			// 	this.emptyView = this.itemViews.first();
			// }
			// buffer = this.collection.reduce(this.appendItemView, buffer, this);

			this.adjustToSelection();
			this._selectedView.el.classList.add("selected");

			this.el.appendChild(buffer);
		}
	},

	// appendItemView: function (parentEl, model, index, arr) {
	// 	var renderer = this.rendererFunction(model, index, arr);
	// 	var view = new renderer({
	// 		model: model,
	// 		parentView: this,
	// 		enabled: this.enabled
	// 	});
	// 	this.itemViews.add(view);
	// 	parentEl.appendChild(view.el);
	// 	return parentEl;
	// },

	// createItemView: function (renderer, opts) {
	// 	var view = new renderer(opts);
	// 	this.itemViews.add(view);
	// 	return view;
	// },

	removeChildren: function() {
		this.itemViews.each(this.removeItemView, this);
		this.emptyView = void 0;
	},

	removeItemView: function(view) {
		this.itemViews.remove(view);
		view.remove();
		return view;
	},

	/* --------------------------- *
	/* measure
	/* --------------------------- */

	_measure: function() {
		var m, mm;
		var pos = 0,
			posInner = 0;
		var maxAcross = 0,
			maxOuter = 0;
		var maxOuterView, maxAcrossView;

		maxOuterView = maxAcrossView = this.emptyView || this.itemViews.first();

		// chidren metrics
		this.itemViews.each(function(view) {
			view.render();
		});

		this.itemViews.each(function(view) {
			m = this.measureItemView(view);
			m.pos = pos;
			pos += m.outer; // + this.childGap;
			m.posInner = posInner;
			posInner += m.inner; //+ this.childGap;
			if (view !== this.emptyView) {
				if (m.across > maxAcross) {
					maxAcross = m.across;
					maxAcrossView = view;
				}
				if (m.outer > maxOuter) {
					maxOuter = m.outer;
					maxOuterView = view;
				}
			}
		}, this);

		// measure self + max child metrics
		mm = this.metrics[this.cid] || (this.metrics[this.cid] = {});
		mm.outer = this.el[this.dirProp("offsetWidth", "offsetHeight")];
		mm.before = maxOuterView.el[this.dirProp("offsetLeft", "offsetTop")];
		mm.inner = maxOuterView.el[this.dirProp("offsetWidth", "offsetHeight")];
		mm.after = mm.outer - (mm.inner + mm.before);
		mm.across = maxAcross;

		// m = this.metrics[maxOuterView.cid];
		// mm.inner = m.inner;

		// tap area
		this._tapAcrossBefore = maxAcrossView.el[this.dirProp("offsetTop", "offsetLeft")];
		this._tapAcrossAfter = this._tapAcrossBefore + maxAcross;
		this._tapBefore = mm.before + this._tapGrow;
		this._tapAfter = mm.before + mm.inner - this._tapGrow;

		this.selectThreshold = Math.min(MAX_SELECT_THRESHOLD, mm.outer * 0.1);
	},

	measureItemView: function(view) {
		var m, viewEl;
		// var s, sizeEl;

		viewEl = view.el;
		m = this.metrics[view.cid] || (this.metrics[view.cid] = {});

		m.outer = viewEl[this.dirProp("offsetWidth", "offsetHeight")];
		m.across = viewEl[this.dirProp("offsetHeight", "offsetWidth")];

		if (view.metrics) {
			m.before = view.metrics[this.dirProp("marginLeft", "marginTop")];
			m.outer += m.before;
			m.outer += view.metrics[this.dirProp("marginRight", "marginBottom")];
			m.inner = view.metrics.content[this.dirProp("width", "height")];
			m.before += view.metrics.content[this.dirProp("x", "y")];
			m.after = m.outer - (m.inner + m.before);

			// var marginBefore = view.metrics[this.dirProp("marginLeft","marginTop")];
			// var marginAfter = view.metrics[this.dirProp("marginRight","marginBottom")];
			// var pos = view.metrics.content[this.dirProp("x","y")];
			//
			// m.inner = view.metrics.content[this.dirProp("width","height")];
			// m.before = marginBefore + pos;
			// m.outer += marginBefore + marginAfter;
			// m.after = m.outer - (m.inner + m.before);
		} else {
			// throw new Error("renderer has no metrics");
			console.warn("%s::measureItemView view '%s' has no metrics", this.cid, view.cid);
			m.inner = m.outer;
			m.after = m.before = 0;
		}

		return m;
	},

	/* --------------------------- *
	/* scrolling property
	/* --------------------------- */

	_delta: 0,

	_scrolling: false,

	_setScrolling: function(scrolling) {
		// console.warn("_setScrolling current/requested", this._scrolling, scrolling);
		if (this._scrolling != scrolling) {
			this._scrolling = scrolling;
			this.el.classList.toggle("scrolling", scrolling);
			this.trigger(scrolling ? "view:scrollstart" : "view:scrollend");
		}
	},

	/* --------------------------- *
	/* Scroll/layout
	/* --------------------------- */

	scrollBy: function(delta, skipTransitions) {
		this._delta = delta || 0;
		this.skipTransitions = !!skipTransitions;
		// this.invalidateLayout();
		this.requestRender(View.LAYOUT_INVALID);
	},

	_scrollBy: function(delta, skipTransitions) {
		var sMetrics, metrics, pos;

		sMetrics = this.metrics[(this._scrollCandidateView || this._selectedView).cid];
		this.itemViews.each(function(view) {
			metrics = this.metrics[view.cid];
			pos = Math.floor(this._getScrollOffset(delta, metrics, sMetrics));
			view.metrics.translateX = (this.direction & HORIZONTAL) ? pos : 0;
			view.metrics.translateY = (this.direction & HORIZONTAL) ? 0 : pos;
			view.metrics._transform = translateTemplate(view.metrics.translateX, view.metrics.translateY);
			view.el.style[transformProperty] = view.metrics._transform;
			// view.el.style[transformProperty] = (this.direction & HORIZONTAL)?
			// 	"translate3d(" + pos + "px,0,0)":
			// 	"translate3d(0," + pos + "px,0)";
		}, this);

		this.el.classList.toggle("skip-transitions", skipTransitions);
		this.selectFromView();
	},

	_getScrollOffset: function(delta, mCurr, mSel) {
		var pos, offset = 0;

		pos = mCurr.pos - mSel.pos + delta;
		if (pos < 0) {
			if (Math.abs(pos) < mSel.outer) {
				offset += (-mCurr.after) / mSel.outer * pos;
			} else {
				offset += mCurr.after;
			}
		} else
		if (0 <= pos) {
			if (Math.abs(pos) < mSel.outer) {
				offset -= mCurr.before / mSel.outer * pos;
			} else {
				offset -= mCurr.before;
			}
		}
		return pos + offset;
	},

	_onScrollTransitionEnd: function(ev) {
		if (ev.propertyName === transformStyleName && this.scrolling) {
			console.log("%s::_onScrollTransitionEnd selected: %s", this.cid, ev.target.cid);
			this._setScrolling(false);
		}
	},

	/* --------------------------- *
	/* toggle touch events
	/* --------------------------- */

	_toggleTouchEvents: function(enable) {
		// console.log("%s::_toggleTouchEvents", this.cid, enable);
		if (this._touchEventsEnabled !== enable) {
			this._touchEventsEnabled = enable;
			if (enable) {
				this.touch.on("hpanstart hpanmove hpanend hpancancel tap", this._onTouchEvent);
			} else {
				this.touch.off("hpanstart hpanmove hpanend hpancancel tap", this._onTouchEvent);
			}
		}
	},

	_onTouchEvent: function(ev) {
		// console.log("%s::_onTouchEvent", this.cid, ev.type);
		switch (ev.type) {
			case "tap":
				return this._onTap(ev);
			case "hpanstart":
				return this._onPanStart(ev);
			case "hpanmove":
				return this._onPanMove(ev);
			case "hpanend":
				return this._onPanFinal(ev);
			case "hpancancel":
				return this._onPanFinal(ev);
		}
	},

	/* --------------------------- *
	/* touch event: pan
	/* --------------------------- */

	// _panCapturedOffset: 0,

	/** @param {Object} ev */
	_onPanStart: function(ev) {
		this.selectFromView();
		this.el.classList.add("panning");
		this._setScrolling(true);
	},

	/** @param {Object} ev */
	_onPanMove: function(ev) {
		var view = this.getViewAtPanDir(ev.offsetDirection);
		var delta = (this.direction & HORIZONTAL) ? ev.thresholdDeltaX : ev.thresholdDeltaY;
		// var delta = (this.direction & HORIZONTAL) ? ev.deltaX : ev.deltaY;

		if (this._panCandidateView !== view) {
			this._panCandidateView && this._panCandidateView.el.classList.remove("candidate");
			this._panCandidateView = view;
			this._panCandidateView && this._panCandidateView.el.classList.add("candidate");
		}
		if (this._panCandidateView === void 0) {
			delta *= Globals.HPAN_OUT_DRAG;
		}

		if (this._renderRafId !== -1) {
			this.scrollBy(delta, Carousel.IMMEDIATE);
			this.renderNow();
		} else {
			this._scrollBy(delta, Carousel.IMMEDIATE);
		}
	},

	/** @param {Object} ev */
	_onPanFinal: function(ev) {
		var scrollCandidate;
		// NOTE: this delta is used for determining selection, NOT for layout
		var delta = (this.direction & HORIZONTAL) ? ev.thresholdDeltaX : ev.thresholdDeltaY;
		// var delta = (this.direction & HORIZONTAL) ? ev.deltaX : ev.deltaY;

		if ((ev.type == "hpanend")
			/* pan direction (current event) and offsetDirection (whole gesture) must match */
			&& (ev.direction ^ ev.offsetDirection ^ this.direction)
			// && (ev.direction & ev.offsetDirection & this.direction)
			/* gesture must overshoot selectThreshold */
			&& (Math.abs(delta) > this.selectThreshold)) {
			/* choose next scroll target */
			scrollCandidate = this.getViewAtPanDir(ev.offsetDirection);
		}
		this._scrollCandidateView = scrollCandidate || void 0;

		if (this._panCandidateView && (this._panCandidateView !== scrollCandidate)) {
			this._panCandidateView.el.classList.remove("candidate");
		}
		this._panCandidateView = void 0;
		this.el.classList.remove("panning");

		this.scrollBy(0, Carousel.ANIMATED);
		this.selectFromView();

		// if (this._renderRafId !== -1) {
		// 	this.scrollBy(0, Carousel.ANIMATED);
		// 	this.renderNow();
		// } else {
		// 	this._scrollBy(0, Carousel.ANIMATED);
		// }
	},

	/* --------------------------- *
	/* touch event: tap
	/* --------------------------- */

	getViewAtPanDir: function(dir) {
		// return (dir & this._precedingDir) ? this._precedingView : this._followingView;
		return (dir & this._followingDir) ? this._precedingView : this._followingView;
	},

	/** @type {int} In pixels */
	_tapGrow: 10,

	getViewAtTapPos: function(pos, posAcross) {
		if (this._tapAcrossBefore < posAcross && posAcross < this._tapAcrossAfter) {
			if (pos < this._tapBefore) {
				return this._precedingView;
			} else if (pos > this._tapAfter) {
				return this._followingView;
			}
		}
		return void 0;
	},

	_onTap: function(ev) {
		var targetView = View.findByDescendant(ev.target);
		// if (!this.itemViews.contains(targetView)) {
		// 	return;
		// }
		do {
			if (this._selectedView === targetView) {
				// console.log("%s tap ocurred on selected: %o", this.cid, targetView);
				return;
			} else if (this === targetView) {
				// console.log("%s tap ocurred on carousel: %o", this.cid, targetView);
				break;
			}
		} while ((targetView = targetView.parentView))

		// this.selectFromView();

		var bounds = this.el.getBoundingClientRect();
		var tapX = ev.center.x - bounds.left;
		var tapY = ev.center.y - bounds.top;
		var tapCandidate = this.getViewAtTapPos(
			this.dirProp(tapX, tapY),
			this.dirProp(tapY, tapX)
		);

		if (tapCandidate) {
			console.log("%s::_onTap %o", this.cid, ev);
			ev.preventDefault();
			// ev.stopPropagation();

			// this._scrollCandidateView = tapCandidate;
			// this._setScrolling(true);
			// this.scrollBy(0, Carousel.ANIMATED);
			// this._scrollCandidateView.el.classList.add("candidate");
			// this.selectFromView();

			//// NOT using internalSelection
			// this.triggerSelectionEvents(tapCandidate, false);

			// using internalSelection
			this._scrollCandidateView = tapCandidate;
			this._setScrolling(true);
			this.scrollBy(0, Carousel.ANIMATED);

			this.triggerSelectionEvents(tapCandidate, true);
			// this.renderNow();
		}
	},

	/* --------------------------- *
	/* Private
	/* --------------------------- */

	triggerSelectionEvents: function(view, internal) {
		if (view === void 0 || this._internalSelection) {
			return;
		}

		this._internalSelection = !!internal;
		if (view === this.emptyView) {
			this.trigger("view:select:none");
		} else {
			this.trigger("view:select:one", view.model);
		}
		this._internalSelection = false;
	},

	selectFromView: function() {
		if (this._scrollCandidateView === void 0) {
			return;
		}
		var view = this._scrollCandidateView;
		this._scrollCandidateView = void 0;
		view.el.classList.remove("candidate");

		this.triggerSelectionEvents(view, true);
	},

	adjustToSelection: function() {
		var m, i = this.collection.selectedIndex;
		// assume -1 < index < this.collection.length
		if (this.requireSelection) {
			(i == -1) && i++; // if selection is null (index -1), set _selectedView to first item (index 0)
			this._selectedView = (m = this.collection.at(i)) && this.itemViews.findByModel(m);
			this._precedingView = (m = this.collection.at(i - 1)) && this.itemViews.findByModel(m);
			this._followingView = (m = this.collection.at(i + 1)) && this.itemViews.findByModel(m);
		} else {
			this._selectedView = (m = this.collection.at(i)) ? this.itemViews.findByModel(m) : this.emptyView;
			this._precedingView = m && ((m = this.collection.at(i - 1)) ? this.itemViews.findByModel(m) : this.emptyView);
			this._followingView = (m = this.collection.at(i + 1)) && this.itemViews.findByModel(m);
		}
	},

	/* --------------------------- *
	/* Model listeners
	/* --------------------------- */

	/** @private */
	_onSelectOne: function(model) {
		if (model === this._selectedView.model) {
			// console.info("INTERNAL");
			return;
		}
		this._onSelectAny(model);
	},

	/** @private */
	_onSelectNone: function() {
		if ((this.requireSelection ? this.itemViews.first() : this.emptyView) === this._selectedView) {
			// console.info("INTERNAL");
			return;
		}
		this._onSelectAny();
	},

	/** @private */
	_onSelectAny: function(model) {
		this._selectedView.el.classList.remove("selected");
		this.adjustToSelection();
		this._selectedView.el.classList.add("selected");

		if (!this._internalSelection) {
			this._setScrolling(true);
			this.scrollBy(0, Carousel.ANIMATED);
		}
	},

	// _onDeselectAny: function (model) {},

	/** @private */
	_onReset: function() {
		// this._createChildren();
		// this.invalidateChildren();
		this.requestRender(View.CHILDREN_INVALID | View.MODEL_INVALID);
	},


	/* --------------------------- *
	/* TEMP
	/* --------------------------- */

	// _scrollBy2: function (delta, skipTransitions) {
	// 	var metrics, pos;
	// 	var sMetrics = this.metrics[(this._scrollCandidateView || this._selectedView).cid];
	// 	var cMetrics = this.metrics[(this._panCandidateView || this._selectedView).cid];
	//
	// 	this.itemViews.each(function (view) {
	// 		metrics = this.metrics[view.cid];
	// 		pos = Math.floor(this._getScrollOffset(delta, metrics, sMetrics, cMetrics));
	// 		view.el.style[transformProperty] = (this.direction & HORIZONTAL)?
	// 				"translate3d(" + pos + "px,0,0)" : "translate3d(0," + pos + "px,0)";
	// 				// "translate(" + pos + "px,0)" : "translate(0," + pos + "px)";
	// 				// "translateX(" + pos + "px)" : "translateY(" + pos + "px)";
	// 	}, this);
	// 	this.el.classList.toggle("skip-transitions", skipTransitions);
	// 	this.selectFromView();
	// },

	// _getScrollOffset2: function (delta, mCurr, mSel, mCan) {
	// 	var offset = 0;
	// 	var posInner = mCurr.posInner - mSel.posInner + delta;
	//
	// 	if (posInner < -mSel.inner) {
	// 		offset = -(mCurr.before);
	// 	} else if (posInner > mSel.inner) {
	// 		offset = (mSel.after);
	// 	} else {
	// 		if (posInner < 0) {
	// 			offset = (mCurr.before) / (mCurr.inner) * posInner;
	// 		} else {
	// 			offset = (mSel.after) / (mCan.inner) * posInner;
	// 		}
	// 	}
	// 	return posInner + offset;
	// },

	// captureSelectedOffset: function() {
	// 	var val, view, cssval, m, mm;
	//
	// 	val = 0;
	// 	view = this._scrollCandidateView || this._selectedView;
	// 	cssval = getComputedStyle(view.el)[transformProperty];
	//
	// 	mm = cssval.match(/(matrix|matrix3d)\(([^\)]+)\)/);
	// 	if (mm) {
	// 		m = mm[2].split(",");
	// 		if (this.direction & HORIZONTAL) {
	// 			val = m[mm[1]=="matrix"? 4 : 12];
	// 		} else {
	// 			val = m[mm[1]=="matrix"? 5 : 13];
	// 		}
	// 		val = parseFloat(val);
	// 	}
	//
	// 	console.log("%s::captureSelectedOffset", this.cid, cssval, val, cssval.match(/matrix\((?:\d\,){3}(\d)\,(\d)|matrix3d\((?:\d\,){11}(\d)\,(\d)/));
	//
	// 	return val;
	// },

	// _onScrollEnd: function(exec) {
	// 	this._scrollEndCancellable = void 0;
	// 	// this.el.classList.remove("disabled-changing");
	// 	if (exec) {
	// 		this._setScrolling(false);
	// 		// this.el.classList.remove("scrolling");
	// 		// this.trigger("view:scrollend");
	// 		console.log("%s::_onScrollEnd", this.cid);
	// 	}
	// },
	// _onMouseDown: function(ev) {
	// 	if (this._scrolling) {
	// 		this._panCapturedOffset = this.captureSelectedOffset();
	// 		console.log("%s::events[mousedown] scrolling interrupted (pos %f)", this.cid, this._panCapturedOffset);
	// 	}
	// },
	// _onMouseUp:function(ev) {
	// 	this._panCapturedOffset = 0;
	// },

};

module.exports = Carousel = View.extend(CarouselProto, Carousel);
},{"app/control/Globals":34,"app/view/base/View":60,"app/view/render/CarouselRenderer":83,"backbone.babysitter":"backbone.babysitter","hammerjs":"hammerjs","underscore":"underscore","utils/prefixedProperty":112,"utils/prefixedStyleName":113,"utils/touch/SmoothPanRecognizer":118}],66:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper;

  return container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(depth0 != null ? depth0 : {},{"name":"id","hash":{},"data":data}) : helper)));
},"useData":true});

},{"hbsfy/runtime":21}],67:[function(require,module,exports){
/**
 * @module app/view/component/CollectionStack
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
// /** @type {Function} */
// var transitionEnd = require("utils/event/transitionEnd");
/** @type {Function} */
var setImmediate = require("utils/setImmediate");

/** @type {string} */
var viewTemplate = require("./CollectionStack.hbs");

/**
 * @constructor
 * @type {module:app/component/CollectionStack}
 */
module.exports = View.extend({

	/** @override */
	cidPrefix: "stack",
	/** @override */
	tagName: "div",
	/** @override */
	className: "stack",
	/** @override */
	template: viewTemplate,

	events: {
		"transitionend": function(ev) {
			// console.log("%s::transitionend [invalid: %s] [transition: %s]", this.cid, this._contentInvalid, (this._skipTransitions? "skip": "run"), ev.target.id, ev.target.className);
			this._renderContent();
		}
	},

	initialize: function(options) {
		this._enabled = true;
		this._skipTransitions = true;
		this._contentInvalid = true;

		options.template && (this.template = options.template);
		this.content = document.createElement("div");
		this.content.className = "stack-item";
		this.el.appendChild(this.content);

		this.listenTo(this.collection, "select:one select:none", this._onSelectChange);
	},

	setEnabled: function(enabled) {
		if (this._enabled !== enabled) {
			this._enabled = enabled;
			this.el.classList.toggle("disabled", !this._enabled);
		}
	},

	_onSelectChange: function(item) {
		if (this._renderedItem === this.collection.selected) {
			throw new Error("change event received but item is identical");
		}
		this._renderedItem = this.collection.selected;

		this._contentInvalid = true;
		this.render();
	},

	/* --------------------------- *
	/* render
	/* --------------------------- */

	render: function() {
		if (this._skipTransitions) {
			// execute even if content has not changed to apply styles immediately
			this._skipTransitions = false;
			this.el.classList.add("skip-transitions");
			setImmediate(function() {
				this.el.classList.remove("skip-transitions");
			}.bind(this));

			// render changed content immediately
			if (this._contentInvalid) {
				this._renderContent();
			}
		} else {
			// else remove 'current' class and render on transitionend
			if (this._contentInvalid) {
				this.content.classList.remove("current");
				// this.content.className = "stack-item";
			}
		}
		return this;
	},

	_renderContent: function() {
		if (this._contentInvalid) {
			this._contentInvalid = false;
			var item = this.collection.selected;
			this.content.innerHTML = item ? this.template(item.toJSON()) : "";
			this.content.classList.add("current");
			// this.content.className = "stack-item current";
		}
	},
});

},{"./CollectionStack.hbs":66,"app/view/base/View":60,"utils/setImmediate":115}],68:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/view/component/FilterableListView
/*/

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");
/** @type {module:utils/prefixedProperty} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {module:utils/css/getBoxEdgeStyles} */
var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

var diff = function(a1, a2, dest) {
	return a1.reduce(function(res, o, i, a) {
		if (a2.indexOf(o) == -1) res.push(o);
		return res;
	}, dest || []);
};

/** @type {module:app/control/Globals.TRANSLATE_TEMPLATE} */
var translateCssValue = require("app/control/Globals").TRANSLATE_TEMPLATE;

/** @const */
var transformProp = prefixedProperty("transform");

/**
/* @constructor
/* @type {module:app/view/component/FilterableListView}
/*/
var FilterableListView = View.extend({

	/** @type {string} */
	cidPrefix: "filterableList",
	/** @override */
	tagName: "ul",
	/** @override */
	className: "list selectable filterable",

	/** @override */
	defaults: {
		collapsed: true,
		filterFn: function() {
			return true;
		},
		renderer: ClickableRenderer.extend({
			/** @override */
			cidPrefix: "listItem",
		}),
	},

	/** @override */
	properties: {
		collapsed: {
			get: function() {
				return this._collapsed;
			},
			set: function(value) {
				this._setCollapsed(value);
			}
		},
		selectedItem: {
			get: function() {
				return this._selectedItem;
			},
			set: function(value) {
				this._setSelection(value);
			}
		},
		filteredItems: {
			get: function() {
				return this._filteredItems;
			}
		}
	},

	/** @override */
	events: {
		"transitionend .list-item": function(ev) {
			if (this._collapsedTransitioning && ev.propertyName === "visibility" /*&& this.el.classList.contains("collapsed-changed")*/ ) {
				this._collapsedTransitioning = false;
				this.el.classList.remove("collapsed-changed");
				console.log("%s::events[transitionend .list-item] collapsed-changed end", this.cid);
			}
		},
	},

	/** @override */
	initialize: function(options) {
		this._metrics = {};
		this._itemMetrics = [];
		this.itemViews = new Container();

		_.defaults(options, this.defaults);
		this.renderer = options.renderer;
		this._filterFn = options.filterFn;
		this._filteredItems = [];

		this.collection.each(this.createItemView, this);
		this.refresh();
		this._setSelection(this.collection.selected);
		this._setCollapsed(options.collapsed);

		// will trigger on return if this.el is already attached
		// this.skipTransitions = true;
		this.listenTo(this, "view:attached", function() {
			this.skipTransitions = true;
			this.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID); //.renderNow();
		});

		// this.listenTo(this.collection, "select:one select:none", this._setSelection);
		this.listenTo(this.collection, "reset", function() {
			this._allItems = null;
			throw new Error("not implemented");
		});
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	/** @override */
	renderFrame: function(tstamp, flags) {
		if (DEBUG) {
			var changed = [];
			this._collapsedChanged && changed.push("collapsed");
			this._selectionChanged && changed.push("selection");
			this._filterChanged && changed.push("filter");
			//console.log("%s::renderFrame [%s]", this.cid, changed.join(" "));
		}

		// collapsed transition flag
		if (this._collapsedTransitioning) {
			console.warn("%s::renderFrame collapsed tx interrupted", this.cid);
		}

		this._collapsedTransitioning = !this.skipTransitions && this._collapsedChanged;

		// this.el.classList.toggle("animate", !this.skipTransitions);
		this.el.classList.toggle("collapsed-changed", this._collapsedTransitioning);
		this.el.classList.toggle("skip-transitions", this.skipTransitions);
		if (this.skipTransitions) {
			this.skipTransitions = false;
			// Invalidate again after frame render loop to reapply transforms:
			// that should kill any running transitions.
			this.setImmediate(function() {
				this.requestRender(View.LAYOUT_INVALID);
			});
		}
		if (this._collapsedChanged) {
			flags |= (View.SIZE_INVALID);
			this.el.classList.toggle("collapsed", this._collapsed);
		}
		if (this._selectionChanged) {
			flags |= View.LAYOUT_INVALID;
			this.renderSelection(this.collection.selected, this.collection.lastSelected);
		}
		if (this._filterChanged) {
			flags |= View.LAYOUT_INVALID;
			this.renderFilterFn();
		}
		if (flags & View.SIZE_INVALID) {
			this.measure();
		}
		if (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {
			this.renderLayout();
		}
		this._collapsedChanged = this._selectionChanged = this._filterChanged = false;
	},

	measure: function() {
		// var i, ii, el, els, m, mm;
		// els = this.el.children;
		// ii = els.length;
		// mm = this._itemMetrics;
		// for (i = 0; i < ii; i++) {
		// 	mm[i] = _.pick(els[i], "offsetTop", "offsetHeight");
		// }

		this._metrics = getBoxEdgeStyles(this.el, this._metrics);

		// var itemEl, itemView, baseline = 0;
		// if (itemEl = this.el.querySelector(".list-item:not(.excluded) .label")) {
		// 	// itemView = this.itemViews.findByCid(itemEl.cid);
		// 	var elA = itemEl, elB = itemEl.parentElement;
		// 	var yA = elA.offsetTop,
		// 		hA = elA.offsetHeight,
		// 		yB = elB.offsetTop,
		// 		hB = elB.offsetHeight;
		// 	baseline = ((yA + hA) - (yB + hB));
		// 	console.log("%s::measure fontSize: %spx (%s+%s)-(%s+%s)=%s", this.cid, this._metrics.fontSize,
		// 		yA, hA, yB, hB, baseline
		// 	);
		// }

		this.itemViews.forEach(function(view) {
			if (!view._metrics) view._metrics = {};
			// view._metrics.baseline = this._metrics.fontSize - baseline;
			view._metrics.offsetTop = view.el.offsetTop;
			view._metrics.offsetHeight = view.el.offsetHeight;
			view._metrics.offsetLeft = view.el.offsetLeft;
			view._metrics.offsetWidth = view.el.offsetWidth;
			if (!this._collapsed && view.label) {
				view._metrics.textLeft = view.label.offsetLeft;
				view._metrics.textWidth = view.label.offsetWidth;
			} else {
				view._metrics.textLeft = view._metrics.offsetLeft;
				view._metrics.textWidth = view._metrics.offsetWidth;
			}
		}, this);

		// this._metrics.baseline = this._metrics.fontSize - baseline;
	},

	renderLayout: function() {
		var posX, posY;
		posX = this._metrics.paddingLeft;
		posY = this._metrics.paddingTop;

		for (var i = 0, ii = this.el.children.length; i < ii; i++) {
			var view = this.itemViews.findByCid(this.el.children[i].cid);
			if (((this.collection.selected && !view.model.selected) ||
					view.el.classList.contains("excluded")) && this._collapsed) {
				view.transform.tx = posX;
				view.transform.ty = posY;
			} else {
				if (view._metrics.offsetHeight == 0)
					posY -= view._metrics.offsetTop;
				view.transform.tx = posX;
				view.transform.ty = posY;
				posY += view._metrics.offsetHeight + view._metrics.offsetTop;
			}
			view.el.style[transformProp] = translateCssValue(view.transform.tx, view.transform.ty);
		}

		// posY += this._metrics.paddingBottom;
		this._metrics.height = Math.max(0, posY + this._metrics.paddingBottom);
		this.el.style.height = this._metrics.height + "px";
		// this.el.style.height = (posY > 0) ? posY + "px" : "";
	},

	/* --------------------------- *
	/* Child views
	/* --------------------------- */

	/** @private */
	createItemView: function(item, index) {
		var view = new this.renderer({
			model: item,
			el: this.el.querySelector(".list-item[data-id=\"" + item.id + "\"]")
		});
		item.set("excluded", false, { silent: true });
		this.listenTo(view, "renderer:click", this._onRendererClick);
		view.listenTo(item, "change:excluded", function(item, newVal) {
			// console.log(arguments);
			if (this.el.classList.contains("excluded") !== newVal) {
				console.warn("%s:[change:excluded] m:%o css: %o", this.cid, newVal, this.el.classList.contains("excluded"));
			}
			// this.el.classList.toggle("excluded", excluded);
		});
		this.itemViews.add(view);
		return view;
	},

	/** @private */
	_onRendererClick: function(item, ev) {
		if (this._collapsedTransitioning
			|| (this._collapsed && item.get("excluded"))) {
			return;
		}
		if (this.collection.selected !== item) {
			this.trigger("view:select:one", item);
		} else {
			if (ev.altKey) {
				this.trigger("view:select:none");
			} else {
				this.trigger("view:select:same", item);
			}
			// this.trigger("view:select:none");
		}
	},

	/* --------------------------- *
	/* Collapsed
	/* --------------------------- */

	/** @private */
	_collapsed: undefined,

	/**
	/* @param {Boolean}
	/*/
	_setCollapsed: function(collapsed) {
		if (collapsed !== this._collapsed) {
			this._collapsed = collapsed;
			this._collapsedChanged = true;
			this.requestRender();
		}
	},

	/* --------------------------- *
	/* Selection
	/* --------------------------- */

	/** @private */
	_selectedItem: undefined,

	/** @param {Backbone.Model|null} */
	_setSelection: function(item) {
		if (item !== this._selectedItem) {
			this._selectedItem = item;
			this._selectionChanged = true;
			this.requestRender(View.MODEL_INVALID);
		}
	},

	/** @private */
	renderSelection: function(newItem, oldItem) {
		var view;
		if (oldItem) {
			view = this.itemViews.findByModel(oldItem);
			view.el.classList.remove("selected");
			// view.label.classList.remove("color-fg");
			// view.label.classList.remove("color-reverse");
		}
		if (newItem) {
			view = this.itemViews.findByModel(newItem);
			view.el.classList.add("selected");
			// view.label.classList.add("color-fg");
			// view.label.classList.add("color-reverse");
		}
	},

	/* --------------------------- *
	/* Filter
	/* --------------------------- */

	refresh: function() {
		if (this._filterFn) {
			this._filterChanged = true;
			this.requestRender(View.MODEL_INVALID);
		}
	},

	renderFilterFn: function() {
		var items = this._filterFn ? this.collection.filter(this._filterFn, this) : this._getAllItems();
		this.renderFilters(items, this._filteredItems);
		this._filteredItems = items;
	},

	renderFilters: function(newItems, oldItems) {
		var hasNew = !!(newItems && newItems.length);
		var hasOld = !!(oldItems && oldItems.length);

		// console.log("%s::renderFilterFn", this.cid, newItems);

		if (hasNew) {
			diff((hasOld ? oldItems : this._getAllItems()), newItems).forEach(function(item) {
				this.itemViews.findByModel(item).el.classList.add("excluded");
				item.set("excluded", true);
			}, this);
		}
		if (hasOld) {
			diff((hasNew ? newItems : this._getAllItems()), oldItems).forEach(function(item) {
				this.itemViews.findByModel(item).el.classList.remove("excluded");
				item.set("excluded", false);
			}, this);
		}
		this.el.classList.toggle("has-excluded", hasNew);
	},

	_getAllItems: function() {
		return this._allItems || (this._allItems = this.collection.slice());
	},

	/* --------------------------- *
	/* Filter 2
	/* --------------------------- */

	// computeFiltered: function() {
	// 	this._filterResult = this.collection.map(this._filterFn, this);
	// },
	//
	// renderFiltered: function() {
	// 	this.collection.forEach(function(item, index) {
	// 		this.itemViews.findByModel(item).el.classList.toggle("excluded", !this._filterResult[index]);
	// 	}, this);
	// },

});

module.exports = FilterableListView;
}).call(this,true)

},{"app/control/Globals":34,"app/view/base/View":60,"app/view/render/ClickableRenderer":84,"backbone.babysitter":"backbone.babysitter","underscore":"underscore","utils/css/getBoxEdgeStyles":107,"utils/prefixedProperty":112}],69:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/view/component/GraphView
 */

/** @type {module:underscore} */
var _ = require("underscore");

/** @type {Function} */
var Color = require("color");

/** @type {module:app/view/base/CanvasView} */
var CanvasView = require("app/view/base/CanvasView");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

/** @type {module:utils/canvas/calcArcHConnector} */
var calcArcHConnector = require("utils/canvas/calcArcHConnector");

/** @type {module:utils/canvas/CanvasHelper} */
var CanvasHelper = require("utils/canvas/CanvasHelper");

/** @type {module:utils/geom/inflateRect} */
var inflateRect = require("utils/geom/inflateRect");

// /** @type {module:utils/dom/getAbsoluteClientRect} */
// var getAbsoluteClientRect = require("utils/dom/getAbsoluteClientRect");


// var BEZIER_CIRCLE = 0.551915024494;
// var MIN_CANVAS_RATIO = 2;
// var PI2 = Math.PI * 2;

var styleBase = {
	lineCap: "butt", // round, butt, square
	lineWidth: 0.75,
	lineDashOffset: 0,
	setLineDash: [[]],
	radiusBase: 0.75,
	/* factored to rem unit */ //6,
	radiusIncrement: 0.21, //3, //0.25,
	/* uses lineWidth multiplier */
	outlineWidth: 1.5,
	arrowSize: 0.3
};

if (DEBUG) {
	/* eslint-disable no-unused-vars */
	var _dStyles = {};
	_dStyles["defaults"] = {
		lineWidth: 0,
		fillStyle: "transparent",
		strokeStyle: "transparent",
		lineDashOffset: 0,
		setLineDash: [[]]
	};

	/* Stroke */
	[
		"red", "salmon", "sienna",
		"green", "yellowgreen", "olive",
		"blue", "lightskyblue", "midnightblue",
		"grey", "silver"
	]
	.forEach(function(colorName) {
		var rgbaValue = Color(colorName).alpha(0.5).rgbaString();

		_dStyles[colorName] = _.defaults({
			lineWidth: 0.75,
			strokeStyle: rgbaValue,
		}, _dStyles["defaults"]);

		_dStyles[colorName + "_fill"] = _.defaults({
			fillStyle: rgbaValue
		}, _dStyles["defaults"]);
	})
	/* eslint-enable no-unused-vars */
}

/**
 * @constructor
 * @type {module:app/view/component/GraphView}
 */
var GraphView = CanvasView.extend({

	/** @type {string} */
	cidPrefix: "graph",
	/** @override */
	tagName: "canvas",
	/** @override */
	className: "graph",
	// /** @override */
	// model: Backbone.Model,

	defaultKey: "amount",

	defaults: {
		values: {
			amount: 0,
			// available: 0,
			// _loop: 0,
		},
		maxValues: {
			amount: 1,
			// available: 1,
		},
		// useOpaque: true,
		// labelFn: function(value, max) {
		// 	return ((value / max) * 100) | 0;
		// },
	},

	/** @override */
	initialize: function(options) {
		CanvasView.prototype.initialize.apply(this, arguments);

		this._listA = options.listA;
		this._listB = options.listB;
		this._a2b = {
			srcView: options.listA,
			destView: options.listB,
			s: _.defaults({
				lineWidth: 1.25
				// radiusIncrement: 0.25,
			}, styleBase),
			strokeStyleFn: function(fg, bg, ln) {
				return Color(ln).mix(bg, 0.9).hexString();
				// return Color(fg).mix(bg, 0.9).hexString();
			}
		};
		this._b2a = {
			srcView: options.listB,
			destView: options.listA,
			s: _.defaults({
				lineWidth: 0.7,
				// arrowSize: 0.25,
				// radiusIncrement: 0,
				// outlineWidth: 0,
			}, styleBase),
			strokeStyleFn: function(fg, bg, ln) {
				return Color(fg).mix(bg, 0.6).hexString();
			}
		};
		this.listenTo(this, "view:render:before", this._beforeViewRender);

		// this.__traceScroll = _.debounce(this.__traceScroll, 100, false);

		var viewportChanged = function(ev) {
			console.log("%s:[%s]", this.cid, ev.type);

			// this.__traceScroll(ev.type);
			// this._groupRects = null;
			// this.invalidate(CanvasView.LAYOUT_INVALID | CanvasView.SIZE_INVALID);
			this.requestRender(CanvasView.LAYOUT_INVALID | CanvasView.SIZE_INVALID);
		}.bind(this);
		// viewportChanged = _.debounce(viewportChanged, 100, false);

		// window.addEventListener("scroll",
		// 		_.debounce(viewportChanged, 100, false), false);
		// window.addEventListener("wheel",
		// 	_.debounce(viewportChanged, 100, false), false);
		window.addEventListener("scroll", viewportChanged, false);
		window.addEventListener("wheel", viewportChanged, false);
		window.addEventListener("resize", viewportChanged, false);
		window.addEventListener("orientationchange", viewportChanged, false);

		// this._addListListeners(this._a2b);
		// this._addListListeners(this._b2a);
	},

	__traceScroll: function(type) {
		var tpl = "%s:[%s] DPR:%i " +
			"[window: %i %i] " +
			"[html: %i %i %i] " +
			"[body: %i %i %i] " +
			"[container: %i %i %i] " +
			"[graph: %i %i %i]";
		console.log(tpl, this.cid, type, this._canvasRatio,
			window.scrollY,
			window.pageYOffset,
			document.documentElement.clientHeight,
			document.documentElement.scrollTop,
			document.documentElement.scrollHeight,
			document.body.clientHeight,
			document.body.scrollTop,
			document.body.scrollHeight,
			document.body.firstElementChild.clientHeight,
			document.body.firstElementChild.scrollTop,
			document.body.firstElementChild.scrollHeight,
			this.el.clientHeight,
			this.el.scrollTop,
			this.el.scrollHeight
		);
	},

	/** @override */
	measureCanvas: function(w, h) {
		console.log("%s::measureCanvas style:%o offset:%o client:%o arg:%o", this.cid, parseInt(this.el.style.height), this.el.offsetHeight, this.el.clientHeight, h);
	},

	/** @override */
	updateCanvas: function() {
		this._updateMetrics();
		this._updateStyles();
	},

	/* --------------------------- *
	/* styles
	/* --------------------------- */

	_updateStyles: function() {
		var b, bgColor, lnColor;
		if (this.model.get("withBundle")) {
			b = this.model.get("bundle");
			lnColor = b.colors.lnColor.clone();
			bgColor = b.colors.bgColor.clone();
		} else {
			bgColor = Color(Globals.DEFAULT_COLORS["background-color"]);
			lnColor = Color(Globals.DEFAULT_COLORS["link-color"]);
		}

		this._a2b.s.strokeStyle = this._a2b.s.fillStyle =
			this._a2b.strokeStyleFn(this._color, bgColor, lnColor);
		this._b2a.s.strokeStyle = this._b2a.s.fillStyle =
			this._b2a.strokeStyleFn(this._color, bgColor, lnColor);

		if (DEBUG) {
			this._debugBlocks = this.el.matches(".debug-blocks ." + this.className);
			this._debugGraph = this.el.matches(".debug-graph ." + this.className);
		}
	},

	_setStyle: function(s) {
		if (typeof s == "string") {
			s = this._styleData[s];
		}
		CanvasView.setStyle(this._ctx, s);
	},

	/* --------------------------- *
	/* metrics
	/* --------------------------- */

	_updateMetrics: function() {
		var bounds;
		var i, ii, els;
		var aRect, bRect;
		var aMin, bMin;

		this._rootFontSize = parseFloat(
			getComputedStyle(document.documentElement).fontSize);

		bounds = this.el.getBoundingClientRect();
		// bounds = getAbsoluteClientRect(this.el);
		this._ctx.setTransform(this._canvasRatio, 0, 0, this._canvasRatio,
			(-bounds.left * this._canvasRatio) - 0.5,
			(-bounds.top * this._canvasRatio) - 0.5
		);

		aRect = this._listA.el.getBoundingClientRect();
		aMin = aRect.left;
		els = this._listA.el.querySelectorAll(".label");
		for (i = 0, ii = els.length; i < ii; i++) {
			aMin = Math.max(aMin,
				els[i].getBoundingClientRect().right);
		}

		bRect = this._listB.el.getBoundingClientRect();
		bMin = bRect.left;
		els = this._listB.el.querySelectorAll(".label");
		for (i = 0, ii = els.length; i < ii; i++) {
			bMin = Math.min(bMin,
				els[i].getBoundingClientRect().left);
		}
		this._b2a.destRect = this._a2b.rect = aRect;
		this._b2a.destMinX = this._a2b.xMin = aMin;
		this._a2b.destRect = this._b2a.rect = bRect;
		this._a2b.destMinX = this._b2a.xMin = bMin;

		// var s = getComputedStyle(document.documentElement);
		// this._rootFontSize = parseFloat(s.fontSize); // * this._canvasRatio;
		// console.log("%s::_updateMetrics _rootFontSize: %s %o", this.cid, this._rootFontSize, s);

		// var c = Math.abs(sData.xMin - dData.xMin) / 6;
		// sMin = sData.xMin + c * qx;
		// dMin = dData.xMin - c * qx;

		// this._a2b.targets = this._measureListItems(listView);
		// this._b2a.targets = this._measureListItems(listView);

		// // connector minimum branch x2
		// listView = this._listB;
		// for (i = 0, ii = listView.groups.length; i < ii; i++) {
		// 	itemView = listView.itemViews.findByModel(listView.groups[i]);
		// 	itemRect = (itemView.label || itemView.el).getBoundingClientRect();
		// 	this._b2a.xMin = Math.min(this._b2a.xMin, itemRect.left);
		// 	// if (itemView._metrics) this._b2a.rect.left + itemView.transform.tx + itemView._metrics.textLeft;
		// }
	},

	/* --------------------------- *
	/* redraw
	/* --------------------------- */

	_beforeViewRender: function(view, flags) {
		if (flags & (CanvasView.SIZE_INVALID | CanvasView.MODEL_INVALID)) {
			console.log("%s::_beforeViewRender [flags: %s]", this.cid, CanvasView.flagsToString(flags));

			this._a2b.pointsOut = this._a2b.points;
			this._a2b.rootOut = this._a2b.root;
			this._a2b.points = null;
			this._a2b.root = null;

			this._b2a.pointsOut = this._b2a.points;
			this._b2a.rootOut = this._b2a.root;
			this._b2a.points = null;
			this._b2a.root = null;

			this._groupRects = null;
		}
	},

	redraw: function(ctx, interpolator) {
		// console.log("%s::redraw [valuesChanged: %s]", this.cid, interpolator.valuesChanged);
		this._clearCanvas(0, 0, this._canvasWidth, this._canvasHeight);
		ctx.save();
		this._redraw_fromElements(ctx, interpolator);
		// this._redraw_fromViews(ctx, interpolator);
		ctx.restore();
	},

	_redraw_fromElements: function(ctx, interpolator) {
		// b2a: keyword to bundles, right to left
		// a2b: bundle to keywords, left to right
		if (this._b2a.points === null) {
			this._computeConnectors(this._b2a); //, this._listB, this._listA);
		}
		if (this._a2b.points === null) {
			this._computeConnectors(this._a2b); //, this._listA, this._listB);
		}

		/* line dash value interpolation */
		var lVal = interpolator._valueData["amount"]._renderedValue / interpolator._valueData["amount"]._maxVal;

		/* draw */
		this._drawConnectors(this._b2a.root, this._b2a.points, this._b2a.s, lVal, 1);
		this._drawConnectors(this._b2a.rootOut, this._b2a.pointsOut, this._b2a.s, 1 - lVal, 1);
		this._drawConnectors(this._a2b.root, this._a2b.points, this._a2b.s, 1, 2);

		// this._drawOverlays(this._a2b.destView, this._a2b.destRect);

		// clear some label backgrounds
		if (this._groupRects === null) {
			this._groupRects = [];
			var els = this._listB.el.querySelectorAll(".list-group .label span");
			for (var i = 0, ii = els.length; i < ii; i++) {
				this._groupRects[i] = els[i].getBoundingClientRect(els[i]);
			}
		}
		// if (lVal === 1) {
		// 	this.__traceScroll("redraw");
		// }

		this._groupRects.forEach(function(r) {
			this._ctx.clearRect(r.left, r.top, r.width, r.height);
			if (this._debugGraph || this._debugBlocks) {
				r = inflateRect(r, 2, 2);
				CanvasHelper.drawRect(this._ctx, _dStyles["salmon"],
					r.left, r.top, r.width, r.height);
			}
		}, this);
	},

	_drawOverlays: function(list, rect) {
		var r = {},
			items = list.groups;
		for (var i = 0, num = items.length, item; i < num; i++) {
			item = list.itemViews.findByModel(items[i]);
			if (item._metrics && item.transform) {
				r.left = rect.left + item.transform.tx + item._metrics.offsetLeft;
				r.top = rect.top + item.transform.ty + item._metrics.offsetTop - 5;
				r.width = item._metrics.offsetWidth;
				r.height = item._metrics.offsetHeight;
				r = inflateRect(r, 4, 4);
				CanvasHelper.drawRect(this._ctx, _dStyles["green"],
					r.left, r.top, r.width, r.height);
			}
		}
	},

	_computeConnectors: function(d) {
		var sMin = d.xMin;
		var dMin = d.destMinX;

		var root = {};
		var p, points = [];
		var qx, x1, y1, tx;
		var rBase, rInc;

		rBase = this._roundTo(d.s.radiusBase * this._rootFontSize, 0.5);
		rInc = this._roundTo(d.s.radiusIncrement * this._rootFontSize, 0.5);

		if (d.rect.right < d.destRect.left) {
			qx = 1;
		} else if (d.destRect.right < d.rect.left) {
			qx = -1;
		} else {
			qx = 0;
		}

		var sView, ddView, ddItems, ddNum, i;
		if (d.srcView.collection.selected && d.destView.filteredItems) {
			sView = d.srcView.itemViews.findByModel(d.srcView.collection.selected);

			// var rect = sView.label.getBoundingClientRect();
			// x1 = rect.left;
			// y1 = rect.top + rect.height / 2;
			// if (qx > 0) x1 += rect.width;
			// x1 += document.body.scrollLeft;
			// y1 += document.body.scrollTop;
			if (!sView._metrics) return;

			x1 = d.rect.left + sView.transform.tx
				+ sView._metrics.textLeft;
			y1 = d.rect.top + sView.transform.ty
				+ sView._metrics.offsetHeight / 2;
			if (qx > 0) x1 += sView._metrics.textWidth;

			ddItems = d.destView.filteredItems;
			ddNum = d.destView.filteredItems.length;

			for (i = 0; i < ddNum; i++) {
				p = {};
				ddView = d.destView.itemViews.findByModel(ddItems[i]);

				// rect = ddView.label.getBoundingClientRect();
				// p.x2 = rect.left;
				// p.y2 = rect.top + rect.height / 2;
				// if (qx < 0) p.x2 += rect.width;
				// p.x2 += document.body.scrollLeft;
				// p.y2 += document.body.scrollTop;

				p.x2 = d.destRect.left + ddView.transform.tx
					+ ddView._metrics.textLeft;
				p.y2 = d.destRect.top + ddView.transform.ty
					+ ddView._metrics.offsetHeight / 2;
				if (qx < 0) p.x2 += ddView._metrics.textWidth;

				p.x1 = x1;
				p.y1 = y1;
				p.qx = qx;
				points[i] = p;
			}
			points.sort(function(a, b) {
				return a.y2 - b.y2;
			});
			var si = 0; // ssEl's number of items above in the Y axis
			var rMax0 = ddNum * 0.5 * rInc; // first arc (r0) max radius (cx0)
			var a; // cy1 offset from y1

			for (i = 0; i < ddNum; i++) {
				p = points[i];

				a = (i - (ddNum - 1) / 2) * rInc;
				p.cy1 = p.y1 + a;
				p.cy2 = p.y2;

				a = Math.abs(a);
				p.r0 = a;
				p.cx0 = p.x1 + (rMax0 - a) * qx;

				// p.dx = x1 - p.x2;
				// p.dy = y1 - p.y2;

				p.di = ((p.cy1 - p.y2) > 0) ? i : ddNum - (i + 1);
				si = Math.max(si, p.di);
			}

			// NOTE
			//sMin = p.x1 + (rMax0 * qx);

			for (i = 0; i < ddNum; i++) {
				p = points[i];
				p.r1 = p.di * rInc + rBase;
				p.r2 = rBase;
				// p.r2 = rBase + (si - p.di) * rInc;

				p.cx1 = sMin + (rMax0 * qx);
				p.cx2 = dMin - ((si - p.di) * rInc) * qx;
				// p.cx2 = dMin;

				tx = calcArcHConnector(p.cx1, p.cy1, p.r1, p.cx2, p.cy2, p.r2, 0.9);
				if (tx) {
					p.tx1 = tx[0];
					p.tx2 = tx[1];
				} else {
					p.tx1 = p.cx1;
					p.tx2 = p.cx2;
				}
				p.length = Math.abs(p.x1 - p.x2) + Math.abs(p.cy1 - p.cy2);

				// Find out longest node connection for setLineDash
				root.maxLength = Math.max(root.maxLength, p.length);
			}
			points.sort(function(a, b) {
				return a.di - b.di; // Sort by distance to selected view
			});

			root.x = x1;
			root.y = y1;
			root.qx = qx;
			root.r0 = si * rInc;
		}
		d.points = points;
		d.root = root;
	},

	_drawConnectors: function(root, pp, s, lVal, dir) {
		var i, ii, p;
		var ow, ra1, ra2, ta;

		if (!(pp && pp.length && lVal)) return;

		ii = pp.length;

		/* outline width */
		// ow = s.lineWidth + s.outlineWidth;
		ow = Math.min(
			this._roundTo(s.radiusIncrement * this._rootFontSize, 0.5),
			this._roundTo(s.lineWidth * (1 + s.outlineWidth), 0.5)
		);

		/* arrow radiuses, direction */
		// ra1 = (s.radiusIncrement * this._rootFontSize) + s.lineWidth;
		ra1 = s.arrowSize * this._rootFontSize;
		ra2 = ra1 + (ow - s.lineWidth);
		ta = Math.PI * dir;

		this._setStyle(s);

		// if (lVal < 1) {
		// 	this._ctx.lineDashOffset = lMax * (1 + lVal);
		// 	this._ctx.setLineDash([lMax, lMax])
		// 	// this._ctx.lineDashOffset = lMax * (1 + lVal);;
		// 	// this._ctx.setLineDash([lMax * (1 - lVal), lMax]);
		// }

		// for (i = 0; i < ii; i++) {
		// p = pp[i];
		if (s.outlineWidth) {
			this._ctx.save();
			this._ctx.globalCompositeOperation = "destination-out";
			this._ctx.lineWidth = ow;
			for (i = 0; i < ii; i++) {
				p = pp[i];

				if (lVal < 1) {
					this._ctx.lineDashOffset = p.length * (1 + lVal);
					this._ctx.setLineDash([p.length, p.length])
				}
				this._drawConnector(p, i, pp);
				if (lVal == 1) {
					CanvasHelper.arrowhead(this._ctx, p.x2, p.y2, ra2, ta);
					this._ctx.fill();
				}
			}
			this._ctx.restore();
		}

		for (i = 0; i < ii; i++) {
			p = pp[i];
			if (lVal < 1) {
				this._ctx.lineDashOffset = p.length * (1 + lVal);
				this._ctx.setLineDash([p.length, p.length])
			}
			this._drawConnector(p, i, pp);
			if (lVal == 1) {
				CanvasHelper.arrowhead(this._ctx, p.x2, p.y2, ra1, ta);
				this._ctx.fill();
			}
		}
	},

	_drawConnector: function(p, i, pp) {
		if (DEBUG) {
			if (this._debugGraph) {
				if (i === 0) {
					CanvasHelper.drawVGuide(this._ctx, _dStyles["grey"], p.x1);
					CanvasHelper.drawVGuide(this._ctx, _dStyles["grey"], p.cx1);
					CanvasHelper.drawHGuide(this._ctx, _dStyles["grey"], p.y1);
					CanvasHelper.drawCircle(this._ctx, _dStyles["midnightblue"], p.x1, p.y1, 10);
				}
				CanvasHelper.drawVGuide(this._ctx, _dStyles["grey"], p.cx2);
				CanvasHelper.drawHGuide(this._ctx, _dStyles["grey"], p.cy2);
				// _dStyles[p.dy > 0 ? "lightgreen" : "salmon"], p.cy2);
			}
		}

		this._ctx.beginPath();
		this._ctx.moveTo(p.x2, p.cy2);
		this._ctx.arcTo(p.tx2, p.cy2, p.tx1, p.cy1, p.r2);
		this._ctx.arcTo(p.tx1, p.cy1, p.cx1, p.cy1, p.r1);
		this._ctx.arcTo(p.cx0, p.cy1, p.cx0, p.y1, p.r0);

		// p.cx00 = p.x1 + ((p.r0 + p.di) * p.qx);
		// p.cy00 = (p.cy1 + p.y1) / 2;
		// this._ctx.arcTo(p.cx00, p.cy1, p.cx00, p.cy00, p.r0 / 2);
		// this._ctx.arcTo(p.cx00, p.y1, p.x1, p.y1, p.r0 / 2);
		// this._ctx.lineTo(p.x1, p.y1);

		// p.cx00 = p.x1 + (p.r0 * p.qx * 2);
		// this._ctx.lineTo(p.cx00, p.cy1);
		// this._ctx.quadraticCurveTo(p.cx0, p.cy1, p.cx0, p.y1);

		// this._ctx.lineTo(p.cx0, p.y1);

		this._ctx.stroke();
		if (DEBUG) {
			if (this._debugGraph) {
				CanvasHelper.drawCrosshair(this._ctx, _dStyles["blue"],
					p.x1 + ((p.r0 + p.di) * p.qx), p.cy1, 3);
				CanvasHelper.drawSquare(this._ctx, _dStyles["midnightblue"], p.cx0, p.cy1, 2);
				CanvasHelper.drawCircle(this._ctx, _dStyles["blue"], p.cx1, p.cy1, 1);
				CanvasHelper.drawSquare(this._ctx, _dStyles["blue"], p.tx1, p.cy1, 2);
				CanvasHelper.drawSquare(this._ctx, _dStyles["green"], p.tx2, p.cy2, 2);
				CanvasHelper.drawCircle(this._ctx, _dStyles["green"], p.cx2, p.cy2, 1);

				CanvasHelper.drawCircle(this._ctx, _dStyles["olive"], p.x2, p.cy2, 3);
				CanvasHelper.drawCrosshair(this._ctx, _dStyles["olive"], p.x2, p.y2, 6);
			}
		}
	},

	_roundTo: function(n, p) {
		if (p > 1) p = 1 / p;
		return Math.round(n / p) * p;
	},

	/*
	_computeConnectors: function(d) {
		var rBase = d.s.radiusBase;
		var rInc = d.s.radiusIncrement;
		var sMin = d.xMin;
		var dMin = d.destMinX;

		var lMax = 0;
		var p, points = [];
		var qx, x1, y1, tx;
		var si; // ssEl's number of items above in the Y axis

		if (d.rect.right < d.destRect.left) {
			qx = 1;
		} else if (d.destRect.right < d.rect.left) {
			qx = -1;
		} else {
			qx = 0;
		}

		var ssEl, ddEls, ddNum, ssRect, ddRect, i;
		ssEl = d.srcView.el.querySelector(".list-item.selected .label");
		if (ssEl) {
			ssRect = ssEl.getBoundingClientRect();
			x1 = ssRect.left;
			if (qx > 0) x1 += ssRect.width;
			y1 = ssRect.top + ssRect.height / 2;
			// r2 = rBase;
			// cx1 = d.xMin;

			si = 0;
			ddEls = d.destView.el.querySelectorAll(".list-item:not(.excluded) .label");
			ddNum = ddEls.length;
			// dx = Math.abs(d.xMin - dData.xMin);

			for (i = 0; i < ddNum; i++) {
				p = {};
				ddRect = ddEls[i].getBoundingClientRect();
				p.x2 = ddRect.left;
				if (qx < 0) p.x2 += ddRect.width;
				p.y2 = ddRect.top + ddRect.height / 2;
				p.x1 = x1;
				p.y1 = y1;
				p.dx = p.x1 - p.x2;
				p.dy = p.y1 - p.y2;
				p.qx = qx;
				p.qy = Math.sign(p.dy);
				// p.dLength = Math.abs(p.x) + Math.abs(p.y);
				p.di = p.dy > 0 ? i : ddNum - (i + 1);
				si = Math.max(si, p.di);
				points[i] = p;
			}

			var a, rMax0 = ddNum * 0.5 * rInc;
			for (i = 0; i < ddNum; i++) {
				p = points[i];
				p.r1 = p.di * rInc + rBase;
				p.r2 = rBase;
				// p.r2 = (si - p.di) * rInc + rBase;

				p.cx1 = sMin;
				p.cx2 = dMin - ((si - p.di) * rInc) * qx;
				// p.cx2 = dMin;

				a = (i - (ddNum - 1) / 2) * rInc;
				p.cy1 = p.y1 + a;
				p.cy2 = p.y2;

				a = Math.abs(a);
				p.r0 = a;
				p.cx0 = p.x1 + (rMax0 - a) * qx;

				tx = calcArcHConnector(p.cx1, p.cy1, p.r1, p.cx2, p.cy2, p.r2, 0.8);
				p.tx1 = tx[0];
				p.tx2 = tx[1];

				// Find out longest node connection for setLineDash
				lMax = Math.max(lMax, Math.abs(p.x1 - p.x2) + Math.abs(p.cy1 - p.cy2));
			}
			// Sort by distance y1 (original) > cy1 (rInc offset) distance
			points.sort(function(a, b) {
				// return Math.abs(b.y1 - b.cy1) - Math.abs(a.y1 - a.cy1);
				// return a.r0 - b.r0;
				return b.di - a.di;
			});
		}
		d.points = points;
		d.maxLength = lMax;
		d.maxLength = qx;
	}, */

});

if (DEBUG) {
	GraphView.prototype._skipLog = false;

	var debouncedLog = _.debounce(_.bind(console.log, console), 500, true);
	var applyMethod = function(context, args) {
		return Array.prototype.shift.apply(args).apply(context, args);
	}
	if (!GraphView.prototype._skipLog) {
		// GraphView.prototype._requestRender = _.wrap(CanvasView.prototype._requestRender, function(fn) {
		// 	debouncedLog("%s::_requestRender", this.cid);
		// 	return applyMethod(this, arguments);
		// });
		GraphView.prototype._applyRender = _.wrap(CanvasView.prototype._applyRender, function(fn) {
			this._skipLog = true;
			debouncedLog("%s::_applyRender [debounced]", this.cid);
			var retval = applyMethod(this, arguments);
			this._skipLog = false;
			return retval;

		});
	}
}

module.exports = GraphView;
}).call(this,true)

},{"app/control/Globals":34,"app/view/base/CanvasView":55,"color":"color","underscore":"underscore","utils/canvas/CanvasHelper":105,"utils/canvas/calcArcHConnector":106,"utils/geom/inflateRect":110}],70:[function(require,module,exports){
/**
 * @module app/view/component/GroupingListView
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
// /** @type {module:backbone.babysitter} */
// var Container = require("backbone.babysitter");
// /** @type {module:app/view/base/View} */
// var View = require("app/view/base/View");
/** @type {module:app/view/component/FilterableListView} */
var FilterableListView = require("app/view/component/FilterableListView");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");
/** @type {module:app/view/render/LabelRenderer} */
var LabelRenderer = require("app/view/render/LabelRenderer");

/**
 * @constructor
 * @type {module:app/view/component/GroupingListView}
 */
var GroupingListView = FilterableListView.extend({

	/** @type {string} */
	cidPrefix: "groupingList",

	/** @override */
	tagName: "dl",

	/** @override */
	className: "grouped",

	/** @type {Function|null} empty array */
	_groupingFn: null, //function() { return null; },

	/** @override */
	defaults: _.defaults({
		// defaults: {
		renderer: ClickableRenderer.extend({
			/** @override */
			cidPrefix: "groupingListItem",
			/** @override */
			tagName: "dl",
			/** @override */
			className: "list-item list-label",
		}),
		groupingRenderer: LabelRenderer.extend({
			/** @override */
			cidPrefix: "groupingListGroup",
			/** @override */
			tagName: "dt",
			/** @override */
			className: "list-group list-label",
		}),
		groupingFn: null,
		// },
	}, FilterableListView.prototype.defaults),

	properties: {
		groups: {
			get: function() {
				return this._groups;
			}
		},
		filteredGroups: {
			get: function() {
				return this._filteredGroups;
			}
		},
	},

	/** @override */
	initialize: function(options) {
		FilterableListView.prototype.initialize.apply(this, arguments);

		this._groups = [];
		this._filteredGroups = [];

		this._groupsByItemCid = {};
		this._groupingFn = options.groupingFn;
		this.groupingRenderer = options.groupingRenderer;

		this._refreshGroups();
		if (this._groupingFn) {
			this._groups.forEach(this.createGroupingView, this);
		}
	},

	_refreshGroups: function() {
		// this._groups = _.uniq(this.collection.map(this._groupingFn, this));
		this._groups.length = 0;
		// this._groupItems.length = 0;
		if (this._groupingFn) {
			this.collection.forEach(function(item) {
				var gIdx, gObj = this._groupingFn.apply(null, arguments);
				if (gObj) {
					gIdx = this._groups.indexOf(gObj);
					if (gIdx == -1) {
						gIdx = this._groups.length;
						this._groups[gIdx] = gObj;
						// this._groupItems[gIdx] = [];
					}
					// this._groupItems[gIdx].push(item);
				}
				this._groupsByItemCid[item.cid] = gObj;
			}, this);
		} else {
			this.collection.forEach(function(item) {
				this._groupsByItemCid[item.cid] = null;
			}, this);
		}
	},

	renderFilterFn: function() {
		FilterableListView.prototype.renderFilterFn.apply(this, arguments);

		if (this._groupingFn) {
			if (this._filteredItems.length == 0) {
				this._filteredGroups = [];
				this._groups.forEach(function(group) {
					this.itemViews.findByModel(group).el.classList.remove("excluded");
				}, this);
			} else {
				this._filteredGroups = _.uniq(this._filteredItems.map(function(item) {
					return this._groupsByItemCid[item.cid];
				}, this));
				this._groups.forEach(function(group) {
					this.itemViews.findByModel(group).el.classList.toggle("excluded", this._filteredGroups.indexOf(group) == -1);
				}, this);
			}
			// this._groupsExclusionIndex = this._groups.map(function (group) {
			// 	return groups.indexOf(group) == -1);
			// }, this);
		}
	},

	/** @private Create children views */
	createGroupingView: function(item) {
		var view = new this.groupingRenderer({
			model: item,
			el: this.el.querySelector(".list-group[data-id=\"" + item.id + "\"]")
		});
		this.itemViews.add(view);
		return view;
	},

	/* --------------------------- *
	/* Filter 2
	/* --------------------------- */

	// computeFiltered: function() {
	// 	FilterableListView.prototype.computeFiltered.apply(this, arguments);
	// },
	//
	// renderFiltered: function() {
	// 	FilterableListView.prototype.renderFiltered.apply(this, arguments);
	// },

});

module.exports = GroupingListView;
},{"app/view/component/FilterableListView":68,"app/view/render/ClickableRenderer":84,"app/view/render/LabelRenderer":91,"underscore":"underscore"}],71:[function(require,module,exports){
/** @type {module:app/view/component/progress/CanvasProgressMeter} */
module.exports = require("app/view/component/progress/CanvasProgressMeter3");
/** @type {module:app/view/component/progress/SVGPathProgressMeter} */
// module.exports = require("app/view/component/progress/SVGPathProgressMeter");
/** @type {module:app/view/component/progress/SVGCircleProgressMeter} */
// module.exports = require("app/view/component/progress/SVGCircleProgressMeter");

},{"app/view/component/progress/CanvasProgressMeter3":73}],72:[function(require,module,exports){
/**
 * @module app/view/component/SelectableListView
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/DefaultSelectableRenderer} */
var DefaultSelectableRenderer = require("app/view/render/DefaultSelectableRenderer");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");

var SelectableListView = View.extend({

	/** @type {string} */
	cidPrefix: "selectableList",

	/** @override */
	tagName: "ul",

	/** @override */
	className: "list selectable",

	/** @type {module:app/view/component/DefaultSelectableRenderer} */
	renderer: DefaultSelectableRenderer,

	/** @override */
	initialize: function(options) {
		this._enabled = true;
		this._childrenInvalid = true;

		options.renderer && (this.renderer = options.renderer);
		this.showEmpty = !!options.showEmpty;
		this.itemViews = new Container();

		this.listenTo(this.collection, "add remove reset", this._onCollectionChange);
	},

	/** @override */
	remove: function() {
		this.removeChildren();
		View.prototype.remove.apply(this, arguments);
		return this;
	},

	_onCollectionChange: function(ev) {
		this._childrenInvalid = true;
		this.render();
	},

	/** @override */
	render: function() {
		if (this._childrenInvalid) {
			this._childrenInvalid = false;
			this.createChildren();
		}
		return this;
	},

	/** @override */
	setEnabled: function(enabled) {
		if (this._enabled !== enabled) {
			this._enabled = enabled;
			this.el.classList.toggle("disabled", !this._enabled);
		}
	},

	/* --------------------------- *
	/* Child views
	/* --------------------------- */

	createChildren: function() {
		var eltBuffer, view;

		this.removeChildren();
		this.el.innerHTML = "";

		if (this.collection.length) {
			eltBuffer = document.createDocumentFragment();
			if (this.showEmpty) {
				view = this.createEmptyView();
				eltBuffer.appendChild(view.render().el);
			}
			this.collection.each(function(model, index, arr) {
				view = this.createItemView(model, index);
				eltBuffer.appendChild(view.render().el);
			}, this);
			this.el.appendChild(eltBuffer);
		}
	},

	createItemView: function(model, index) {
		var view = new(this.renderer)({
			model: model
		});
		this.itemViews.add(view);
		this.listenTo(view, "renderer:click", this.onItemViewClick);
		return view;
	},

	removeChildren: function() {
		this.itemViews.each(this.removeItemView, this);
	},

	removeItemView: function(view) {
		this.stopListening(view);
		this.itemViews.remove(view);
		view.remove();
		return view;
	},

	/* --------------------------- *
	/* Child event handlers
	/* --------------------------- */

	/** @private */
	onItemViewClick: function(item) {
		if (this.collection.selected !== item && this._enabled) {
			this.trigger("view:select:one", item);
		}
	},

	/* --------------------------- *
	/* Empty view
	/* --------------------------- */

	createEmptyView: function() {
		var view = new SelectableListView.EmptyRenderer({
			model: this.collection
		});
		this.itemViews.add(view);
		this.listenTo(view, "renderer:click", function() {
			this._enabled && this.trigger("view:select:none");
		});
		return view;
	},
}, {
	EmptyRenderer: ClickableRenderer.extend({

		/** @override */
		tagName: "li",
		/** @override */
		className: "list-item empty-item",

		/** @override */
		initialize: function(options) {
			this.listenTo(this.model, "selected deselected", this.renderClassList);
			this.renderClassList();
		},

		/** @override */
		render: function() {
			this.el.innerHTML = "<a href=\"#clear\"><b> </b></a>";
			this.renderClassList();
			return this;
		},

		renderClassList: function() {
			this.el.classList.toggle("selected", this.model.selectedIndex === -1);
		},
	})
});

module.exports = SelectableListView;

},{"app/view/base/View":60,"app/view/render/ClickableRenderer":84,"app/view/render/DefaultSelectableRenderer":86,"backbone.babysitter":"backbone.babysitter"}],73:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/view/component/progress/CanvasProgressMeter
 */

// /** @type {module:underscore} */
// var _ = require("underscore");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
/** @type {module:app/view/base/CanvasView} */
var CanvasView = require("app/view/base/CanvasView");
// /** @type {module:app/view/base/Interpolator} */
// var Interpolator = require("app/view/base/Interpolator");

// var ARC_ERR = 0.00001;
// var ARC_ERR = 0.0;
// var PI = Math.PI;
var PI2 = Math.PI * 2;

var GAP_ARC = PI2 / 48;
// var CAP_SCALE = 2; // cap arc = GAP_ARC * CAP_SCALE
// var WAIT_CYCLE_VALUE = 1;
// var WAIT_CYCLE_MS = 300; // milliseconds per interpolation loop

var ARC_DEFAULTS = {
	"amount": {
		lineWidth: 0.8,
		radiusOffset: 0
	},
	"not-available": {
		lineWidth: 1.0,
		lineDash: [0.3, 0.7]
	},
	"available": {
		lineWidth: 0.8,
		inverse: "not-available"
	},
};

/**
 * @constructor
 * @type {module:app/view/component/progress/CanvasProgressMeter}
 */
var CanvasProgressMeter = CanvasView.extend({

	/** @type {string} */
	cidPrefix: "canvasProgressMeter",
	/** @type {string} */
	className: "progress-meter canvas-progress-meter",

	defaultKey: "amount",

	defaults: {
		values: {
			amount: 0,
			available: 0,
			_loop: 0,
		},
		maxValues: {
			amount: 1,
			available: 1,
		},
		useOpaque: true,
		labelFn: function(value, max) {
			return ((value / max) * 100) | 0;
		},
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	initialize: function(options) {
		// TODO: cleanup options mess in CanvasView
		CanvasView.prototype.initialize.apply(this, arguments);
		// options = _.defaults(options, this.defaults);

		this._labelFn = options.labelFn;
		this._valueStyles = {};
		this._canvasSize = null;
		this._canvasOrigin = null;
	},

	measureCanvas: function(w, h) {
		this._canvasHeight = this._canvasWidth = Math.min(this._canvasWidth, this._canvasHeight);
	},

	_updateCanvas: function() {
		CanvasView.prototype._updateCanvas.apply(this, arguments);

		// size, lines, gaps, dashes (this._valueStyles, GAP_ARC, this._arcRadius)
		// --------------------------------
		var arcName, arcObj, arcDefault;
		var mapLineDash = function(n) {
			return n * this.radius * GAP_ARC;
		};
		var sumFn = function(s, n) {
			return s + n;
		};

		this._canvasSize = Math.min(this._canvasWidth, this._canvasHeight); // / this._canvasRatio;
		this._maxDashArc = 0;

		for (arcName in ARC_DEFAULTS) {
			arcDefault = ARC_DEFAULTS[arcName];
			arcObj = this._valueStyles[arcName] = {};
			arcObj.inverse = arcDefault.inverse; // copy inverse key
			// arcObj.inverse2 = arcDefault.inverse2;
			arcObj.lineWidth = arcDefault.lineWidth * this._canvasRatio;
			arcObj.radius = (this._canvasSize - arcObj.lineWidth) / 2;
			if (arcDefault.radiusOffset) {
				arcObj.radius += arcDefault.radiusOffset * this._canvasRatio;
			}
			if (arcDefault.lineDash && arcDefault.lineDash.length) {
				arcObj.lineDash = arcDefault.lineDash.map(mapLineDash, arcObj);
				arcObj.lineDashArc = arcDefault.lineDash[0] * GAP_ARC;
				arcObj.lineDashLength = arcObj.lineDash.reduce(sumFn);
				this._maxDashArc = Math.max(this._maxDashArc, arcObj.lineDashArc);
			} else {
				arcObj.lineDashArc = 0;
			}
		}

		// baselineShift
		// --------------------------------
		// NOTE: Center baseline: use ascent data to center to x-height, or sort-of.
		// with ascent/descent values (0.7, -0.3), x-height is 0.4
		var mObj = this._getFontMetrics(this._fontFamily);
		this._baselineShift = mObj ? (mObj.ascent + mObj.descent) / mObj.unitsPerEm : 0.7; // default value
		this._baselineShift *= this._fontSize * 0.5; // apply to font-size, halve it
		this._baselineShift = Math.round(this._baselineShift);

		// save canvas context
		// --------------------------------
		// reset matrix and translate 0,0 to center
		this._ctx.restore();
		this._ctx.setTransform(1, 0, 0, 1, this._canvasWidth / 2, this._canvasHeight / 2);
		this._ctx.save();
	},

	/* --------------------------- *
	/* private
	/* --------------------------- */

	/** @override */
	redraw: function(context, interpolator) {
		this._clearCanvas(-this._canvasWidth / 2, -this._canvasHeight / 2, this._canvasWidth, this._canvasHeight);

		var loopValue = interpolator._valueData["_loop"]._renderedValue || 0;
		var amountData = interpolator._valueData["amount"];
		var availableData = interpolator._valueData["available"];

		var amountStyle = this._valueStyles["amount"];
		var availableStyle = this._valueStyles["available"];

		// amount label
		// --------------------------------
		this.drawLabel(this._labelFn(amountData._renderedValue, amountData._maxVal));

		// save ctx before drawing arcs
		this._ctx.save();

		// loop rotation
		// --------------------------------
		// if (interpolator.renderedKeys && (interpolator.renderedKeys.indexOf("amount") !== -1)) {
		// 	console.log("%s::redraw (_loop) max: %s last: %s curr: %s", this.cid,
		// 		amountData._maxVal,
		// 		amountData._lastRenderedValue,
		// 		amountData._renderedValue
		// 	);
		// }
		if (interpolator.renderedKeys && (interpolator.renderedKeys.indexOf("amount") !== -1) && (amountData._lastRenderedValue > amountData._renderedValue)) {
			// trigger loop
			interpolator.valueTo(1, 0, "_loop");
			interpolator.valueTo(0, 750, "_loop");
			interpolator.updateValue("_loop");
		}
		this._ctx.rotate(PI2 * ((1 - loopValue) - 0.25));

		// amount arc
		// --------------------------------
		var amountGapArc = GAP_ARC;
		var amountEndArc = 0;
		var amountValue = loopValue + amountData._renderedValue / amountData._maxVal;

		if (amountValue > 0) {
			amountEndArc = this.drawArc(amountStyle, amountValue, amountGapArc, PI2 - amountGapArc);
			this.drawEndCap(amountStyle, amountEndArc);
			amountEndArc = amountEndArc + amountGapArc * 2;
		}

		// available arc
		// --------------------------------
		var stepsNum = availableData.length || 1;
		var stepBaseArc = PI2 / stepsNum;
		var stepAdjustArc = stepBaseArc % GAP_ARC;
		var stepGapArc = GAP_ARC + (stepAdjustArc - availableStyle.lineDashArc) / 2;

		if (Array.isArray(availableData)) {
			for (var o, i = 0; i < stepsNum; i++) {
				o = availableData[i];
				this.drawArc(availableStyle, o._renderedValue / (o._maxVal / stepsNum), (i * stepBaseArc) + stepGapArc, ((i + 1) * stepBaseArc) - stepGapArc, amountEndArc);
			}
		} else {
			this.drawArc(availableStyle, availableData._renderedValue / availableData._maxVal, stepGapArc, PI2 - stepGapArc, amountEndArc);
		}
		// restore ctx after drawing arcs
		this._ctx.restore();
	},

	drawArc: function(valueStyle, value, startArc, endArc, prevArc) {
		var valArc, invStyle,
			valStartArc, valEndArc,
			invStartArc, invEndArc;
		prevArc || (prevArc = 0);

		valArc = endArc - startArc;
		valEndArc = startArc + (valArc * value);
		valStartArc = Math.max(startArc, prevArc);
		if (valEndArc > valStartArc) {
			this._ctx.save();
			this.applyValueStyle(valueStyle);
			this._ctx.beginPath();
			this._ctx.arc(0, 0, valueStyle.radius, valEndArc, valStartArc, true);
			this._ctx.stroke();
			this._ctx.restore();
		}
		// if there's valueStyle, draw rest of span, minus prevArc overlap too
		if (valueStyle.inverse !== void 0) {
			invStyle = this._valueStyles[valueStyle.inverse];
			invEndArc = valEndArc + (valArc * (1 - value));
			invStartArc = Math.max(valEndArc, prevArc);
			if (invEndArc > invStartArc) {
				this._ctx.save();
				this.applyValueStyle(invStyle);
				this._ctx.beginPath();
				this._ctx.arc(0, 0, invStyle.radius, invEndArc, invStartArc, true);
				this._ctx.stroke();
				this._ctx.restore();
			}
		}
		return valEndArc;
	},

	applyValueStyle: function(styleObj) {
		this._ctx.lineWidth = styleObj.lineWidth;
		if (styleObj.lineDash) {
			this._ctx.setLineDash(styleObj.lineDash);
		}
		if (styleObj.lineDashOffset) {
			this._ctx.lineDashOffset = styleObj.lineDashOffset;
		}
	},

	drawLabel: function(labelString) {
		var labelWidth = this._ctx.measureText(labelString).width;
		this._ctx.fillText(labelString,
			labelWidth * -0.5,
			this._baselineShift, labelWidth);
	},

	drawEndCap: function(valueStyle, arcPos) {
		var radius = valueStyle.radius;
		this._ctx.save();
		this._ctx.lineWidth = valueStyle.lineWidth;

		this._ctx.rotate(arcPos - GAP_ARC * 1.5);
		this._ctx.beginPath();
		this._ctx.arc(0, 0, radius, GAP_ARC * 0.5, GAP_ARC * 2, false);
		this._ctx.lineTo(radius - (GAP_ARC * radius), 0);
		this._ctx.closePath();

		this._ctx.fill();
		this._ctx.stroke();
		this._ctx.restore();
	},
});

if (DEBUG) {
	CanvasProgressMeter.prototype._skipLog = true;
}

module.exports = CanvasProgressMeter;

}).call(this,true)

},{"app/view/base/CanvasView":55}],74:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
var Color = require("color");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");

// - - - - - - - - - - - - - - - -
//  utils
// - - - - - - - - - - - - - - - -

function insertCSSRule(sheet, selector, style) {
	var cssText = "";
	for (var prop in style) {
		cssText += prop + ":" + style[prop] + ";";
	}
	sheet.insertRule(selector + "{" + cssText + "}", sheet.cssRules.length);
}

function selfAndDescendant(selfCls, cls) {
	return selfCls + " " + cls + ", " + selfCls + cls;
}

// - - - - - - - - - - - - - - - -
//  root rules
// - - - - - - - - - - - - - - - -

var rootStyles = [
	"color",
	"background",
	"background-color",
	// "--link-color"
];

function initRootStyles(sheet, rootSelector, attrs, fgColor, bgColor, lnColor, hasDarkBg) {
	var s, revSelector, fgColorVal, bgColorVal;
	// var revFgColorVal, revBgColorVal;

	s = _.pick(attrs, rootStyles);
	s["-webkit-font-smoothing"] = (hasDarkBg ? "antialiased" : "auto");
	/* NOTE: In Firefox '-moz-osx-font-smoothing: grayscale;'
	/* works both in light over dark and dark over light, hardcoded in _base.scss */
	//s["-moz-osx-font-smoothing"] = (hasDarkBg? "grayscale" : "auto");
	insertCSSRule(sheet, rootSelector, s);

	// A element
	// - - - - - - - - - - - - - - - -
	s = {}
	s["color"] = lnColor.rgbString();
	insertCSSRule(sheet, rootSelector + " a", s);
	insertCSSRule(sheet, rootSelector + " .color-ln", s);

	// .color-fg05
	// - - - - - - - - - - - - - - - -
	s = {};
	s["color"] = fgColor.clone().mix(bgColor, 0.5).rgbString();
	s["border-color"] = fgColor.clone().mix(bgColor, 0.7).rgbString();
	insertCSSRule(sheet, rootSelector + " .color-fg05", s);

	fgColorVal = fgColor.rgbString();
	bgColorVal = bgColor.rgbString();
	// revFgColorVal = bgColor.clone().mix(fgColor, 0.9).rgbString();
	// revBgColorVal = fgColor.clone().mix(bgColor, 0.6).rgbString();
	revSelector = rootSelector + " .color-reverse";

	// .color-fg .color-bg
	// - - - - - - - - - - - - - - - -
	s = {
		"color": fgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-fg", s);
	s = {
		"background-color": bgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-bg", s);
	// html inverted text/background
	s = {
		"color": bgColorVal
	}; // s = { "color" : revFgColorVal };
	s["-webkit-font-smoothing"] = (hasDarkBg ? "auto" : "antialiased");
	// insertCSSRule(sheet, revSelector + " .color-fg", s);
	// insertCSSRule(sheet, revSelector + ".color-fg", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-fg"), s);

	s = {
		"background-color": fgColorVal
	};
	// s = { "background-color" : revBgColorVal };
	// insertCSSRule(sheet, revSelector + " .color-bg", s);
	// insertCSSRule(sheet, revSelector + ".color-bg", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-bg"), s);

	// .color-stroke .color-fill (SVG)
	// - - - - - - - - - - - - - - - -
	s = {
		"stroke": fgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-stroke", s);
	s = {
		"fill": bgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-fill", s);
	// svg inverted fill/stroke
	s = {
		"stroke": bgColorVal
	};
	// insertCSSRule(sheet, revSelector + " .color-stroke", s);
	// insertCSSRule(sheet, revSelector + ".color-stroke", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-stroke"), s);
	s = {
		"fill": fgColorVal
	};
	// insertCSSRule(sheet, revSelector + " .color-fill", s);
	// insertCSSRule(sheet, revSelector + ".color-fill", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-fill"), s);

	// .text-outline
	// - - - - - - - - - - - - - - - -
	// s = {
	// 	"text-shadow": "-1px -1px 0 " + bgColorVal +
	// 		", 1px -1px 0 " + bgColorVal +
	// 		", -1px 1px 0 " + bgColorVal +
	// 		", 1px 1px 0 " + bgColorVal
	// };
	// insertCSSRule(sheet, rootSelector + " :not(.collapsed-changed) .text-outline-bg", s);

}

// - - - - - - - - - - - - - - - -
// carousel styles
// - - - - - - - - - - - - - - - -

var carouselStyles = ["box-shadow", "border", "border-radius"];

function initCarouselStyles(sheet, carouselSelector, attrs, fgColor, bgColor, lnColor, hasDarkBg) {
	var s = _.pick(attrs, carouselStyles); //, "background-color"]);
	insertCSSRule(sheet, carouselSelector + " .media-item .content", s);

	// .media-item .color-bg09
	// - - - - - - - - - - - - - - - -
	s = {};
	s["background-color"] = bgColor.clone().mix(fgColor, 0.95).rgbString();
	// s["background-color"] = bgColor.clone()[hasDarkBg ? "darken" : "lighten"](0.045).rgbString();
	// s["background-color"] = bgColor.clone()[hasDarkBg ? "lighten" : "darken"](0.03).rgbString();
	insertCSSRule(sheet, carouselSelector + " .media-item .color-bg09", s);

	// .media-item .placeholder
	// - - - - - - - - - - - - - - - -
	s = {};
	s["-webkit-font-smoothing"] = (hasDarkBg ? "auto" : "antialiased");
	// text color luminosity is inverse from body, apply oposite rendering mode
	s["color"] = bgColor.rgbString();
	// s["color"] = bgColor.clone()[hasDarkBg ? "darken" : "lighten"](0.045).rgbString();
	s["background-color"] = bgColor.clone().mix(fgColor, 0.95).rgbString();
	// s["background-color"] = bgColor.clone().mix(fgColor, 0.8).alpha(0.3).rgbaString();
	// s["background-color"] = bgColor.clone()[hasDarkBg ? "lighten" : "darken"](0.03).rgbString();
	("border-radius" in attrs) && (s["border-radius"] = attrs["border-radius"]);
	insertCSSRule(sheet, carouselSelector + " .media-item .placeholder", s);

	// .empty-item A
	// - - - - - - - - - - - - - - - -
	s = {};
	s["text-decoration-color"] = fgColor.clone().mix(bgColor, 0.3).rgbString();
	insertCSSRule(sheet, carouselSelector + " .empty-item A", s);
	// // .color-gradient
	// // - - - - - - - - - - - - - - - -
	// s = {};
	// s["background-color"] = "transparent";
	// s["background"] = "linear-gradient(to bottom, " +
	// 		bgColor.clone().alpha(0.00).rgbaString() + " 0%, " +
	// 		bgColor.clone().alpha(0.11).rgbaString() + " 100%)";
	// insertCSSRule(sheet, rootSelector + " .color-gradient", s);
	// s = {};
	// s["background-color"] = "transparent";
	// s["background"] = "linear-gradient(to bottom, " +
	// 		fgColor.clone().alpha(0.00).rgbaString() + " 0%, " +
	// 		fgColor.clone().alpha(0.11).rgbaString() + " 100%)";
	// insertCSSRule(sheet, revSelector + " .color-gradient", s);
	// insertCSSRule(sheet, revSelector + ".color-gradient", s);
}

module.exports = function() {
	var attrs, fgColor, bgColor, lnColor, hasDarkBg;

	attrs = Globals.DEFAULT_COLORS;
	fgColor = new Color(Globals.DEFAULT_COLORS["color"]);
	bgColor = new Color(Globals.DEFAULT_COLORS["background-color"]);
	lnColor = new Color(Globals.DEFAULT_COLORS["link-color"])
	hasDarkBg = fgColor.luminosity() > bgColor.luminosity();

	var colorStyles = document.createElement("style");
	colorStyles.id = "colors";
	colorStyles.type = "text/css";
	document.head.appendChild(colorStyles);
	// var colorStyles = document.querySelector("link#folio");

	initRootStyles(colorStyles.sheet, ".app",
		attrs, fgColor, bgColor, lnColor, hasDarkBg);
	initCarouselStyles(colorStyles.sheet, ".carousel",
		attrs, fgColor, bgColor, lnColor, hasDarkBg);

	// - - - - - - - - - - - - - - - -
	// per-bundle rules
	// - - - - - - - - - - - - - - - -
	bundles.each(function(bundle) {
		attrs = bundle.attrs(); //get("attrs");
		fgColor = bundle.colors.fgColor;
		bgColor = bundle.colors.bgColor;
		lnColor = bundle.colors.lnColor;
		hasDarkBg = bundle.colors.hasDarkBg;

		initRootStyles(colorStyles.sheet,
			".app." + bundle.get("domid"),
			attrs, fgColor, bgColor, lnColor, hasDarkBg);
		initCarouselStyles(colorStyles.sheet,
			".carousel." + bundle.get("domid"),
			attrs, fgColor, bgColor, lnColor, hasDarkBg);
	});
};
},{"app/control/Globals":34,"app/model/collection/BundleCollection":42,"color":"color","underscore":"underscore"}],75:[function(require,module,exports){
/*global XMLHttpRequest */

// var _ = require("underscore");
// /** @type {module:underscore.string/lpad} */
// var classify = require("underscore.string/classify");

// var statusMsg = _.template("<%= status %> received from <%= url %> (<%= statusText %>)");
// var errMsg = _.template("'<%= errName %>' ocurred during request <%= url %>");

if (window.XMLHttpRequest && window.URL && window.Blob) {
	module.exports = function(url, progressFn) {
		return new Promise(function(resolve, reject) {
			var request = new XMLHttpRequest();
			request.open("GET", url, true);
			// request.timeout = 10000; // in milliseconds
			request.responseType = "blob";

			// if progressFn is supplied
			// - - - - - - - - - - - - - - - - - -
			if (progressFn) {
				request.onprogress = function(ev) {
					progressFn(ev.loaded / ev.total);
				};
			}
			// resolved/success
			// - - - - - - - - - - - - - - - - - -
			request.onload = function(ev) {
				// When the request loads, check whether it was successful
				if (request.status == 200) {
					// If successful, resolve the promise by passing back a reference url
					resolve(URL.createObjectURL(request.response));
				} else {
					var err = new Error(("http_" + request.statusText.replace(/\s/g, "_")).toUpperCase());
					err.infoCode = request.status;
					err.infoSrc = url;
					err.logEvent = ev;
					err.logMessage = "_loadImageAsObjectURL::" + ev.type + " [reject]";
					reject(err);
				}
			};
			// reject/failure
			// - - - - - - - - - - - - - - - - - -
			request.onerror = function(ev) {
				var err = new Error((ev.type + "_event").toUpperCase());
				err.infoCode = -1;
				err.infoSrc = url;
				err.logEvent = ev;
				err.logMessage = "_loadImageAsObjectURL::" + ev.type + " [reject]";
				reject(err);
			};
			request.onabort = request.ontimeout = request.onerror;
			// finally
			// - - - - - - - - - - - - - - - - - -
			request.onloadend = function() {
				request.onabort = request.ontimeout = request.onerror = void 0;
				request.onload = request.onloadend = void 0;
				if (progressFn) {
					request.onprogress = void 0;
				}
			};

			request.send();
		});
	};
} else {
	module.exports = function(url) {
		return Promise.resolve(url);
	};
}
},{}],76:[function(require,module,exports){
module.exports = function(image, resolveEmpty) {
	return new Promise(function(resolve, reject) {
		if (!(image instanceof window.HTMLImageElement)) {
			//reject(new Error("not an HTMLImageElement"));
			reject("Error: not an HTMLImageElement");
		} else if (image.complete && (image.src.length > 0 || resolveEmpty)) {
			// if (image.src === "") console.warn("_whenImageLoads resolved with empty src");
			// else console.log("_whenImageLoads resolve-sync", image.src);
			resolve(image);
		} else {
			var handlers = {
				load: function(ev) {
					// console.log("_whenImageLoads_dom resolve-async", ev.type, image.src);
					removeEventListeners();
					resolve(image);
				},
				error: function(ev) {
					var err = new Error("Loading failed (" + ev.type + " event)");
					err.infoCode = -1;
					err.infoSrc = image.src;
					err.logEvent = ev;
					err.logMessage = "_whenImageLoads::" + ev.type + " [reject]";
					removeEventListeners();
					reject(err);
				}
			};
			handlers.abort = handlers.error;
			var removeEventListeners = function() {
				for (var event in handlers) {
					if (handlers.hasOwnProperty(event)) {
						image.removeEventListener(event, handlers[event], false);
					}
				}
			};
			for (var event in handlers) {
				if (handlers.hasOwnProperty(event)) {
					image.addEventListener(event, handlers[event], false);
				}
			}
		}
	});
};

},{}],77:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:app/view/promise/_whenImageLoads} */
var _whenImageLoads = require("app/view/promise/_whenImageLoads");
/** @type {module:app/view/promise/_loadImageAsObjectURL} */
var _loadImageAsObjectURL = require("app/view/promise/_loadImageAsObjectURL");

// var isBlobRE = /^blob\:.*/;

// var logMessage = "%s::whenDefaultImageLoads [%s]: %s";

module.exports = function(view) {
	return new Promise(function(resolve, reject) {
		var source = view.model.get("source");
		if (source.has("prefetched")) {
			view.defaultImage.src = source.get("prefetched");
			_whenImageLoads(view.defaultImage)
				.then(
					function(targetEl) {
						// console.log(logMessage, view.cid, "resolved", "prefetched");
						resolve(view);
					});
		} else {
			view.mediaState = "pending";

			var sUrl = source.get("original");
			var progressFn = function(progress) {
				// console.log(logMessage, view.cid, "progress", progress);
				view.updateMediaProgress(progress, sUrl);
			};
			progressFn = _.throttle(progressFn, 100, {
				leading: true,
				trailing: false
			});
			_loadImageAsObjectURL(sUrl, progressFn)
				.then(
					function(url) {
						if (/^blob\:.*/.test(url)) {
							source.set("prefetched", url);
						}
						view.defaultImage.src = url;
						// URL.revokeObjectURL(url);
						return view.defaultImage;
					})
				.then(_whenImageLoads)
				.then(
					function(targetEl) {
						// console.log(logMessage, view.cid, "resolved", targetEl.src);
						view.on("view:removed", function() {
							var prefetched = source.get("prefetched");
							if (prefetched && /^blob\:/.test(prefetched)) {
								source.unset("prefetched", {
									silent: true
								});
								URL.revokeObjectURL(prefetched);
							}
						});
						// view.placeholder.removeAttribute("data-progress");
						// view.updateMediaProgress(imageUrl, "complete");
						resolve(view);
					},
					// 	})
					// .catch(
					function(err) {
						// console.warn(logMessage, view.cid, "rejected", err.message);
						// view.placeholder.removeAttribute("data-progress");
						// view.updateMediaProgress(imageUrl, progress);
						reject(err);
					});
		}
	});
};
},{"app/view/promise/_loadImageAsObjectURL":75,"app/view/promise/_whenImageLoads":76,"underscore":"underscore"}],78:[function(require,module,exports){
/* global Promise */
/** @type {module:app/view/base/ViewError} */
var ViewError = require("app/view/base/ViewError");

/** @type {module:app/view/base/ViewError} */
var whenViewIsAttached = require("app/view/promise/whenViewIsAttached");

function whenScrollingEnds(view) {
	return new Promise(function(resolve, reject) {
		var parent = view.parentView;
		if (parent === null) {
			console.error("%s::whenScrollingEnds [%s] (sync)", view.cid, "rejected", view.attached);
			reject(new ViewError(view, new Error("whenScrollingEnds: view has no parent")));
		} else if (!parent.scrolling) {
			// console.log("%s::whenScrollingEnds [%s] (sync)", view.cid, "resolved", view.attached);
			resolve(view);
		} else {
			var cleanup = function() {
				parent.off("view:scrollend", onScrollend);
				parent.off("view:remove", onRemove);
			};
			var onScrollend = function() {
				// console.log("%s::whenScrollingEnds [%s]", view.cid, "resolved", view.attached);
				cleanup();
				resolve(view);
			};
			var onRemove = function() {
				// console.log("%s::whenScrollingEnds [%s]", view.cid, "rejected", view.attached);
				cleanup();
				reject(new ViewError(view, new Error("whenScrollingEnds: view was removed")));
			};
			parent.on("view:scrollend", onScrollend);
			parent.on("view:remove", onRemove);
		}
	});
}

module.exports = function(view) {
	return Promise.resolve(view)
		.then(whenViewIsAttached)
		.then(whenScrollingEnds);
};

/*
module.exports = function(view) {
	return Promise.resolve(view)
		.then(function(view) {
			if (view.attached) {
				return view;
			} else {
				return new Promise(function(resolve, reject) {
					view.once("view:attached", function(view) {
						resolve(view);
					});
				});
			}
		})
		.then(function(view) {
			if (!view.parentView.scrolling) {
				return view;
			} else {
				return new Promise(function(resolve, reject) {
					var resolveOnScrollend = function() {
						// console.log("%s::whenScrollingEnds [%s]", view.cid, "resolved");
						view.off("view:remove", rejectOnRemove);
						resolve(view);
					};
					var rejectOnRemove = function(view) {
						// console.log("%s::whenScrollingEnds [%s]", view.cid, "rejected");
						view.parentView.off("view:scrollend", resolveOnScrollend);
						reject(new ViewError(view,
							new Error("whenSelectScrollingEnds: view was removed ("+ view.cid +")")));
					};
					view.parentView.once("view:scrollend", resolveOnScrollend);
					view.once("view:remove", rejectOnRemove);
				});
			}
		});
};
*/

},{"app/view/base/ViewError":61,"app/view/promise/whenViewIsAttached":81}],79:[function(require,module,exports){
/** @type {module:app/view/base/ViewError} */
var ViewError = require("app/view/base/ViewError");

// var logMessage = "%s::whenSelectionDistanceIs [%s]: %s";

/**
 * @param {module:app/view/base/View}
 * @param {number} distance
 */
module.exports = function(view, distance) {
	return new Promise(function(resolve, reject) {
		// if (!(view.model && view.model.collection)) {
		// 	reject(new ViewError(view, new Error("whenSelectionIsContiguous: model.collection is empty")));
		// }
		var model = view.model;
		var collection = model.collection;

		var check = function(n) { // Check indices for contiguity
			return Math.abs(collection.indexOf(model) - collection.selectedIndex) <= distance;
		};

		if (check()) {
			// console.log(logMessage, view.cid, "resolve", "sync");
			resolve(view);
		} else {
			var cleanupOnSettle = function() {
				// console.log(logMessage, view.cid, "cleanup", "async");
				collection.off("select:one select:none", resolveOnSelect);
				view.off("view:removed", rejectOnRemove);
			};
			var resolveOnSelect = function(model) {
				if (check()) {
					// console.log(logMessage, view.cid, "resolve", "async");
					cleanupOnSettle();
					resolve(view);
				}
			};
			var rejectOnRemove = function(view) {
				cleanupOnSettle();
				reject(new ViewError(view, new Error("whenSelectionDistanceIs: view was removed")));
			};
			collection.on("select:one select:none", resolveOnSelect);
			view.on("view:removed", rejectOnRemove);
		}
	});
};

},{"app/view/base/ViewError":61}],80:[function(require,module,exports){
// /** @type {module:app/view/base/ViewError} */
// var ViewError = require("app/view/base/ViewError");

/** @type {module:app/view/promise/whenSelectionDistanceIs} */
var whenSelectionDistanceIs = require("app/view/promise/whenSelectionDistanceIs");

/** @param {module:app/view/base/View} */
module.exports = function(view) {
	return whenSelectionDistanceIs(view, 1);
};
},{"app/view/promise/whenSelectionDistanceIs":79}],81:[function(require,module,exports){
module.exports = function(view) {
	return new Promise(function(resolve, reject) {
		if (view.attached) {
			resolve(view);
		} else {
			view.on("view:attached", function(view) {
				resolve(view);
			});
		}
	});
};

},{}],82:[function(require,module,exports){
module.exports = function(view) {
	return new Promise(function(resolve, reject) {
		if (!view.invalidated) {
			resolve(view);
		} else {
			view.once("view:render:after", function(view, flags) {
				resolve(view);
			});
		}
	});
};
},{}],83:[function(require,module,exports){
/**
 * @module app/view/render/CarouselRenderer
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:underscore} */
var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

// FIXME: this fixup should not be done here
// /** @type {module:utils/net/toAbsoluteURL} */
// var toAbsoluteURL = require("utils/net/toAbsoluteURL");
// /** @type {string} */
// var ABS_APP_ROOT = toAbsoluteURL(require("app/control/Globals").APP_ROOT);

/**
 * @constructor
 * @type {module:app/view/render/CarouselRenderer}
 */
var CarouselRenderer = View.extend({

	/** @type {string} */
	cidPrefix: "carouselRenderer",
	/** @override */
	tagName: "div",
	/** @override */
	className: "carousel-item",
	/** @override */
	template: _.template("<div class=\"content sizing\"><%= name %></div>"),

	properties: {
		content: {
			get: function() {
				return this._content || (this._content = this.el.querySelector(".content"));
			},
		},
		sizing: {
			get: function() {
				return this._sizing || (this._sizing = this.el.querySelector(".sizing"));
			},
		}
	},

	/** @override */
	initialize: function(options) {
		if (this.model.attr("@classname") !== void 0) {
			var clsAttr = this.model.attr("@classname").split(" ");
			for (var i = 0; i < clsAttr.length; i++) {
				this.el.classList.add(clsAttr[i]);
			}
		}
		options.parentView && (this.parentView = options.parentView);
		this.metrics = {};
		this.metrics.content = {};
		this.createChildren();
		// this.enabled = !!options.enabled; // force bool
		this.setEnabled(!!options.enabled);
	},

	createChildren: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
		// FIXME: this fixup should not be done here
		// FIXED: now done in xslt
		/*this.el.querySelectorAll("a[href]").forEach(function(el) {
			var url = toAbsoluteURL(el.getAttribute("href"));
			if (url.indexOf(ABS_APP_ROOT) !== 0) {
				el.setAttribute("target", "_blank");
			}
		});*/
	},

	/** @return {HTMLElement} */
	getSizingEl: function() {
		return this._sizing || (this._sizing = this.el.querySelector(".sizing"));
	},

	/** @return {HTMLElement} */
	getContentEl: function() {
		return this._content || (this._content = this.el.querySelector(".content"));
	},

	/** @return {this} */
	measure: function() {
		var sizing = this.getSizingEl();

		this.metrics = getBoxEdgeStyles(this.el, this.metrics);
		this.metrics.content = getBoxEdgeStyles(this.getContentEl(), this.metrics.content);

		sizing.style.maxWidth = "";
		sizing.style.maxHeight = "";

		this.metrics.content.x = sizing.offsetLeft + sizing.clientLeft;
		this.metrics.content.y = sizing.offsetTop + sizing.clientTop;
		this.metrics.content.width = sizing.clientWidth;
		this.metrics.content.height = sizing.clientHeight;

		return this;
	},

	/** @override */
	render: function() {
		this.measure();
		return this;
	},

	getSelectionDistance: function() {
		return Math.abs(this.model.collection.indexOf(this.model) - this.model.collection.selectedIndex);
	},
});

module.exports = CarouselRenderer;
},{"app/view/base/View":60,"underscore":"underscore","utils/css/getBoxEdgeStyles":107}],84:[function(require,module,exports){
/**
 * @module app/view/render/ClickableRenderer
 */

/** @type {module:app/view/render/LabelRenderer} */
var LabelRenderer = require("app/view/render/LabelRenderer");

/**
 * @constructor
 * @type {module:app/view/render/ClickableRenderer}
 */
var ClickableRenderer = LabelRenderer.extend({

	/** @type {string} */
	cidPrefix: "clickableRenderer",

	/** @override */
	events: {
		"click": function(ev) {
			this.trigger("renderer:click", this.model, ev);
		},
		"click a": function(ev) {
			ev.defaultPrevented || ev.preventDefault();
		}
	},
});

module.exports = ClickableRenderer;

},{"app/view/render/LabelRenderer":91}],85:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function";

  return "<a href=\"#"
    + container.escapeExpression(((helper = (helper = helpers.domid || (depth0 != null ? depth0.domid : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"domid","hash":{},"data":data}) : helper)))
    + "\"><span class=\"label\">"
    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</span></a>";
},"useData":true});

},{"hbsfy/runtime":21}],86:[function(require,module,exports){
/**
 * @module app/view/render/DefaultSelectableRenderer
 */

/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");

/**
 * @constructor
 * @type {module:app/view/render/DefaultSelectableRenderer}
 */
var DefaultSelectableRenderer = ClickableRenderer.extend({

	/** @override */
	tagName: "li",
	/** @override */
	className: "list-item",
	/** @override */
	template: require("./DefaultSelectableRenderer.hbs"),

	initialize: function(options) {
		this.listenTo(this.model, "selected deselected", this._renderClassList);
		this._renderClassList();
	},

	/** @override */
	render: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
		this._renderClassList();
		return this;
	},

	_renderClassList: function() {
		this.el.classList.toggle("selected", this.model.selected);
	},
});

module.exports = DefaultSelectableRenderer;

},{"./DefaultSelectableRenderer.hbs":85,"app/view/render/ClickableRenderer":84}],87:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<span class=\"label\">"
    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper)))
    + "</span><a href=\"#"
    + alias4(((helper = (helper = helpers.domid || (depth0 != null ? depth0.domid : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"domid","hash":{},"data":data}) : helper)))
    + "\"><b> </b></a>";
},"useData":true});

},{"hbsfy/runtime":21}],88:[function(require,module,exports){
/**
 * @module app/view/render/DotNavigationRenderer
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {string} */
var viewTemplate = require("./DotNavigationRenderer.hbs");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");

/**
 * @constructor
 * @type {module:app/view/render/DotNavigationRenderer}
 */
var DotNavigationRenderer = ClickableRenderer.extend({

	/** @type {string} */
	cidPrefix: "dotRenderer",
	/** @override */
	tagName: "li",
	/** @override */
	className: "list-item",
	/** @override */
	template: viewTemplate,

	/** @override */
	initialize: function(options) {
		this.listenTo(this.model, "selected deselected", this.renderClassList);
		this.renderClassList();
	},

	/** @override */
	render: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
		this.renderClassList();
		return this;
	},

	renderClassList: function() {
		this.el.classList.toggle("selected", this.model.selected);
	},
});

module.exports = DotNavigationRenderer;

},{"./DotNavigationRenderer.hbs":87,"app/view/render/ClickableRenderer":84}],89:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<div class=\"placeholder sizing\"></div>\n<img class=\"content media-border default\" alt=\""
    + alias4(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"text","hash":{},"data":data}) : helper)))
    + "\" longdesc=\"#desc_m"
    + alias4(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" />\n";
},"useData":true});

},{"hbsfy/runtime":21}],90:[function(require,module,exports){
/**
 * @module app/view/render/ImageRenderer
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
// /** @type {module:app/model/item/MediaItem} */
// var MediaItem = require("app/model/item/MediaItem");

/** @type {module:app/view/MediaRenderer} */
var MediaRenderer = require("./MediaRenderer");

/** @type {Function} */
var viewTemplate = require("./ImageRenderer.hbs");

/**
 * @constructor
 * @type {module:app/view/render/ImageRenderer}
 */
var ImageRenderer = MediaRenderer.extend({

	/** @type {string} */
	cidPrefix: "imageRenderer",
	/** @type {string} */
	className: MediaRenderer.prototype.className + " image-renderer",
	/** @type {Function} */
	template: viewTemplate,

	/** @override */
	initialize: function(opts) {
		MediaRenderer.prototype.initialize.apply(this, arguments);
		// this.createChildren();
		// this.initializeAsync();
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	createChildren: function() {
		MediaRenderer.prototype.createChildren.apply(this, arguments);
		// this.el.innerHTML = this.template(this.model.toJSON());
		this.placeholder = this.el.querySelector(".placeholder");
	},

	/** @override */
	render: function() {
		MediaRenderer.prototype.render.apply(this, arguments);

		// this.measure();

		var img = this.getDefaultImage();
		img.setAttribute("width", this.metrics.media.width);
		img.setAttribute("height", this.metrics.media.height);

		var content = this.getContentEl();
		content.style.left = this.metrics.content.x + "px";
		content.style.top = this.metrics.content.y + "px";

		// var sizing = this.getSizingEl();
		// sizing.style.maxWidth = this.metrics.content.width + "px";
		// sizing.style.maxHeight = this.metrics.content.height + "px";

		return this;
	},

	/* --------------------------- *
	/* initializeAsync
	/* --------------------------- */

	initializeAsync: function() {
		return MediaRenderer.prototype.initializeAsync.apply(this, arguments)
		// return MediaRenderer.whenSelectionIsContiguous(this)
		// // return Promise.resolve(this)
		// // 	.then(MediaRenderer.whenSelectionIsContiguous)
		// 	.then(MediaRenderer.whenSelectTransitionEnds)
		// 	.then(MediaRenderer.whenDefaultImageLoads)
		// .then(
		// 	function(view) {
		// 		view.mediaState = "ready";
		// 	})
		// .catch(
		// 	function(err) {
		// 		if (err instanceof ViewError) {
		// 			// NOTE: ignore ViewError type
		// 			// console.log(err.view.cid, err.view.model.cid, "ImageRenderer: " + err.message);
		// 		} else {
		// 			console.error(this.cid, err.name, err);
		// 			this.placeholder.innerHTML = "<p class=\"color-fg\" style=\"position:absolute;bottom:0;padding:3rem;\"><strong>" + err.name + "</strong> " + err.message + "</p>";
		// 			this.mediaState = "error";
		// 		}
		// 	}.bind(this))
		;
	},
});

module.exports = ImageRenderer;

},{"./ImageRenderer.hbs":89,"./MediaRenderer":92}],91:[function(require,module,exports){
/**
 * @module app/view/render/LabelRenderer
 */

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");

/**
 * @constructor
 * @type {module:app/view/render/LabelRenderer}
 */
var LabelRenderer = View.extend({

	/** @type {string} */
	cidPrefix: "labelRenderer",

	properties: {
		label: {
			get: function() {
				return this._label || (this._label = this.el.querySelector(".label"));
			}
		}
		// measuredWidth: {
		// 	get: function() {
		// 		return this._measuredWidth;
		// 	}
		// },
		// measuredHeight: {
		// 	get: function() {
		// 		return this._measuredHeight;
		// 	}
		// },
	},

	/* -------------------------------
	/* measure
	/* ------------------------------- */

	// _measuredWidth: null,
	// _measuredHeight: null,
	// measure: function() {},
});

module.exports = LabelRenderer;

},{"app/view/base/View":60}],92:[function(require,module,exports){
(function (DEBUG){
/*global XMLHttpRequest, HTMLMediaElement, MediaError*/
/**
 * @module app/view/render/MediaRenderer
 */

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:underscore.strings/lpad} */
var lpad = require("underscore.string/lpad");
// /** @type {module:utils/css/getBoxEdgeStyles} */
// var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

/** @type {module:app/model/item/MediaItem} */
var MediaItem = require("app/model/item/MediaItem");
/** @type {module:app/view/CarouselRenderer} */
var CarouselRenderer = require("app/view/render/CarouselRenderer");

var errorTemplate = require("../template/ErrorBlock.hbs");

var MediaRenderer = CarouselRenderer.extend({

	/** @type {string} */
	cidPrefix: "mediaRenderer",
	/** @type {string} */
	className: CarouselRenderer.prototype.className + " media-item",
	/** @type {module:app/model/MediaItem} */
	model: MediaItem,

	properties: {
		defaultImage: {
			get: function() {
				return this._defaultImage || (this._defaultImage = this.el.querySelector("img.default"));
			}
		},
		mediaState: {
			get: function() {
				return this._mediaState;
			},
			set: function(state) {
				this._setMediaState(state);
			}
		}
	},

	/** @override */
	initialize: function(opts) {
		// if (this.model.attrs().hasOwnProperty("@classname")) {
		// 	this.el.className += " " + this.model.attr("@classname");
		// }

		// NOTE: @classname attr handling moved to CarouselRenderer
		// if (this.model.attr("@classname") !== void 0) {
		// 	var clsAttr = this.model.attr("@classname").split(" ");
		// 	for (var i = 0; i < clsAttr.length; i++) {
		// 		this.el.classList.add(clsAttr[i]);
		// 	}
		// }
		CarouselRenderer.prototype.initialize.apply(this, arguments);

		this.metrics.media = {};
		this.mediaState = "idle";

		this.initializeAsync()
			.then(this.whenInitialized)
			.catch(this.whenInitializeError.bind(this));
	},

	initializeAsync: function() {
		// var MediaRenderer = Object.getPrototypeOf(this).constructor;
		return Promise.resolve(this)
			.then(MediaRenderer.whenSelectionIsContiguous)
			.then(MediaRenderer.whenScrollingEnds)
			.then(MediaRenderer.whenDefaultImageLoads);
	},

	whenInitialized: function(view) {
		// console.log("%s::whenInitialized [%s]", view.cid, "resolved");
		view.mediaState = "ready";
		view.placeholder.removeAttribute("data-progress");
		return view;
	},

	whenInitializeError: function(err) {
		if (err instanceof CarouselRenderer.ViewError) {
			// NOTE: ignore ViewError type
			// console.log("%s::whenInitializeError", err.view.cid, err.message);
			return;
		} else if (err instanceof Error) {
			console.error(err.stack);
		}
		this.renderMediaError(err);
		this.placeholder.removeAttribute("data-progress");
		this.mediaState = "error";
		// this.placeholder.innerHTML = errorTemplate(err);
		// this.placeholder.removeAttribute("data-progress");
		// this.mediaState = "error";

		console.error("%s::initializeAsync [%s (caught)]: %s", this.cid, err.name,
			(err.info && err.info.logMessage) || err.message);
		err.logEvent && console.log(err.logEvent);
	},

	renderMediaError: function(err) {
		this.placeholder.innerHTML = err ? errorTemplate(err) : "";
	},

	updateMediaProgress: function(progress, id) {
		if (_.isNumber(progress)) {
			this.placeholder.setAttribute("data-progress", lpad(Math.floor(progress * 100), 2, '0'));
		}
		// else if (progress === "complete") {
		// 	this.placeholder.removeAttribute("data-progress");
		// }
	},

	// whenMediaIsReady: function(view) {
	// 	return MediaRenderer.whenDefaultImageLoads(this, this.updateMediaProgress.bind(this));
	// },

	/* --------------------------- *
	/* child getters
	/* --------------------------- */

	/** @return {HTMLElement} */
	getDefaultImage: function() {
		return this.defaultImage;
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	createChildren: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
	},

	/** @override */
	measure: function() {
		CarouselRenderer.prototype.measure.apply(this, arguments);

		var sw, sh; // source dimensions
		var pcw, pch; // measured values
		var cx, cy, cw, ch, cs; // computed values
		var ew, eh; // content edge totals
		var cm; // content metrics

		cm = this.metrics.content;
		cx = cm.x;
		cy = cm.y;
		pcw = cm.width;
		pch = cm.height;

		ew = (cm.paddingLeft + cm.paddingRight + cm.borderLeftWidth + cm.borderRightWidth);
		eh = (cm.paddingTop + cm.paddingBottom + cm.borderTopWidth + cm.borderBottomWidth);
		pcw -= ew;
		pch -= eh;

		sw = this.model.get("source").get("w");
		sh = this.model.get("source").get("h");

		// Unless both client dimensions are larger than the source's
		// choose constraint direction by aspect ratio
		if (sw < pcw && sh < pch) {
			cs = 1;
			cw = sw;
			ch = sh;
			this.metrics.fitDirection = "both";
		} else if ((pcw / pch) < (sw / sh)) {
			// fit width
			cw = pcw;
			cs = cw / sw;
			// ch = cs * sh;
			ch = Math.round(cs * sh);
			this.metrics.fitDirection = "width";
		} else {
			// fit height
			ch = pch;
			cs = ch / sh;
			// cw = cs * sw;
			cw = Math.round(cs * sw);
			this.metrics.fitDirection = "height";
		}

		this.metrics.content.x = cx;
		this.metrics.content.y = cy;
		this.metrics.content.width = cw + ew;
		this.metrics.content.height = ch + eh;

		this.metrics.media.x = cx + cm.paddingLeft + cm.borderLeftWidth;
		this.metrics.media.y = cy + cm.paddingTop + cm.borderTopWidth;
		this.metrics.media.width = cw;
		this.metrics.media.height = ch;
		this.metrics.media.scale = cs;

		// console.log("%s::measure constraint: %s metrics: %o", this.cid, this.metrics.constraint, this.metrics);
		// var sizing = this.getSizingEl();
		// sizing.style.maxWidth = (cw + ew) + "px";
		// sizing.style.maxHeight = (ch + eh) + "px";

		return this;
	},

	render: function() {
		// NOTE: not calling super.render, calling measure ourselves
		this.measure();

		var sizing = this.getSizingEl();
		sizing.style.maxWidth = this.metrics.content.width + "px";
		sizing.style.maxHeight = this.metrics.content.height + "px";

		this.el.setAttribute("data-fit-dir", this.metrics.fitDirection);

		return this;
	},

	/* --------------------------- *
	/* mediaState
	/* --------------------------- */

	_mediaStateEnum: ["idle", "pending", "ready", "error"],

	_setMediaState: function(key) {
		if (this._mediaStateEnum.indexOf(key) === -1) {
			throw new Error("Argument " + key + " invalid. Must be one of: " + this._mediaStateEnum.join(", "));
		}
		if (this._mediaState !== key) {
			if (this._mediaState) {
				this.el.classList.remove(this._mediaState);
			}
			this.el.classList.add(key);
			this._mediaState = key;
			this.trigger("media:" + key);
		}
	},
}, {
	LOG_TO_SCREEN: true,

	/** @type {module:app/view/promise/whenSelectionIsContiguous} */
	whenSelectionIsContiguous: require("app/view/promise/whenSelectionIsContiguous"),

	// /** @type {module:app/view/promise/whenSelectTransitionEnds} */
	// whenSelectTransitionEnds: require("app/view/promise/whenSelectTransitionEnds"),

	/** @type {module:app/view/promise/whenScrollingEnds} */
	whenScrollingEnds: require("app/view/promise/whenScrollingEnds"),

	/** @type {module:app/view/promise/whenDefaultImageLoads} */
	whenDefaultImageLoads: require("app/view/promise/whenDefaultImageLoads"),
});

/* ---------------------------
/* log to screen
/* --------------------------- */
if (DEBUG) {

	MediaRenderer = (function(MediaRenderer) {
		if (!MediaRenderer.LOG_TO_SCREEN) return MediaRenderer;

		/** @type {Function} */
		var Color = require("color");
		// /** @type {module:underscore.string/lpad} */
		// var lpad = require("underscore.string/lpad");
		// /** @type {module:underscore.string/rpad} */
		// var rpad = require("underscore.string/rpad");

		return MediaRenderer.extend({

			/** @override */
			initialize: function() {
				MediaRenderer.prototype.initialize.apply(this, arguments);

				var fgColor = new Color(this.model.attr("color"));
				var bgColor = new Color(this.model.attr("background-color"));
				this.__logColors = {
					normal: fgColor.clone().mix(bgColor, 0.75).hslString(),
					ignored: fgColor.clone().mix(bgColor, 0.25).hslString(),
					error: "brown",
					abort: "orange"
				};
				this.__logFrameStyle = "1px dashed " + fgColor.clone().mix(bgColor, 0.5).hslString();
				this.__logStartTime = Date.now();
				this.__rafId = -1;
				this.__onFrame = this.__onFrame.bind(this);
			},

			initializeAsync: function() {
				return MediaRenderer.prototype.initializeAsync.apply(this, arguments).catch(function(err) {
					if (!(err instanceof MediaRenderer.ViewError)) {
						this.__logMessage(err.message, err.name, this.__logColors["error"]);
					}
					return Promise.reject(err);
				}.bind(this));
			},

			/** @override */
			createChildren: function() {
				var ret = MediaRenderer.prototype.createChildren.apply(this, arguments);

				this.__logElement = document.createElement("div");
				this.__logElement.className = "debug-log";
				this.__logHeaderEl = document.createElement("pre");
				this.__logHeaderEl.className = "log-header color-bg";
				// this.model.colors.fgColor.clone().mix(fgColor, 0.9).rgbString()
				// this.model.colors.fgColor.clone().alpha
				this.__logHeaderEl.textContent = this.__getHeaderText();
				this.__logElement.appendChild(this.__logHeaderEl);
				this.el.insertBefore(this.__logElement, this.el.firstElementChild);
				return ret;
			},

			/** @override */
			render: function() {
				MediaRenderer.prototype.render.apply(this, arguments);

				this.__logElement.style.marginTop = "3rem";
				this.__logElement.style.maxHeight = "calc(100% - " + (this.metrics.media.height) + "px - 3rem)";
				//this.__logElement.style.width = this.metrics.media.width + "px";
				this.__logElement.scrollTop = this.__logElement.scrollHeight;

				return this;
			},

			__logMessage: function(msg, logtype, color) {
				var logEntryEl = document.createElement("pre");

				logEntryEl.textContent = this.__getTStamp() + " " + msg;
				logEntryEl.setAttribute("data-logtype", logtype || "-");
				logEntryEl.style.color = color || this.__logColors[logtype] || this.__logColors.normal;

				this.__logElement.appendChild(logEntryEl);
				this.__logElement.scrollTop = this.__logElement.scrollHeight;

				if (this.__rafId == -1) {
					this.__rafId = this.requestAnimationFrame(this.__onFrame);
				}
			},

			__onFrame: function(tstamp) {
				this.__rafId = -1;
				this.__logElement.lastElementChild.style.borderBottom = this.__logFrameStyle;
				this.__logElement.lastElementChild.style.paddingBottom = "2px";
				this.__logElement.lastElementChild.style.marginBottom = "2px";
			},

			__getTStamp: function() {
				// return new Date(Date.now() - this.__logStartTime).toISOString().substr(11, 12);
				return lpad(((Date.now() - this.__logStartTime) / 1000).toFixed(3), 8, "0");
			},

			__getHeaderText: function() {
				return '';
			},
		});
	})(MediaRenderer);

} // end debug

/**
 * @constructor
 * @type {module:app/view/render/MediaRenderer}
 */
module.exports = MediaRenderer;
}).call(this,true)

},{"../template/ErrorBlock.hbs":100,"app/model/item/MediaItem":49,"app/view/promise/whenDefaultImageLoads":77,"app/view/promise/whenScrollingEnds":78,"app/view/promise/whenSelectionIsContiguous":80,"app/view/render/CarouselRenderer":83,"color":"color","underscore":"underscore","underscore.string/lpad":28}],93:[function(require,module,exports){
(function (GA){
/**
 * @module app/view/render/PlayableRenderer
 */

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
// var Color = require("color");

/** @type {module:app/view/MediaRenderer} */
var MediaRenderer = require("app/view/render/MediaRenderer");
// /** @type {module:app/view/component/ProgressMeter} */
// var ProgressMeter = require("app/view/component/ProgressMeter");

/** @type {Function} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {Function} */
var prefixedEvent = require("utils/prefixedEvent");

// var visibilityHiddenProp = prefixedProperty("hidden", document);
/** @type {String} */
var visibilityStateProp = prefixedProperty("visibilityState", document);
/** @type {String} */
var visibilityChangeEvent = prefixedEvent("visibilitychange", document, "hidden");

/** @type {Function} */
// var duotone = require("utils/canvas/bitmap/duotone");
// var stackBlurRGB = require("utils/canvas/bitmap/stackBlurRGB");
// var stackBlurMono = require("utils/canvas/bitmap/stackBlurMono");
// var getAverageRGBA = require("utils/canvas/bitmap/getAverageRGBA");
// var getAverageRGB = require("utils/canvas/bitmap/getAverageRGB");

// /** @type {HTMLCanvasElement} */
// var _sharedCanvas = null;
// /** @return {HTMLCanvasElement} */
// var getSharedCanvas = function() {
// 	if (_sharedCanvas === null) {
// 		_sharedCanvas = document.createElement("canvas");
// 	}
// 	return _sharedCanvas;
// };

// function logAttachInfo(view, name, level) {
// 	if (["log", "info", "warn", "error"].indexOf(level) != -1) {
// 		level = "log";
// 	}
// 	console[level].call(console, "%s::%s [parent:%s %s %s depth:%s]", view.cid, name, view.parentView && view.parentView.cid, view.attached ? "attached" : "detached", view._viewPhase, view.viewDepth);
// }

/**
 * @constructor
 * @type {module:app/view/render/PlayableRenderer}
 */
var PlayableRenderer = MediaRenderer.extend({

	/** @type {string} */
	cidPrefix: "playableRenderer",

	/** @type {string|Function} */
	className: MediaRenderer.prototype.className + " playable-renderer",

	properties: {
		paused: {
			/** @return {Boolean} */
			get: function() {
				return this._isMediaPaused();
			}
		},
		playbackRequested: {
			/** @return {Boolean} */
			get: function() {
				return this._playbackRequested;
			},
			set: function(value) {
				this._setPlaybackRequested(value);
			}
		},
		playToggle: {
			/** @return {HTMLElement} */
			get: function() {
				return this._playToggle || (this._playToggle = this.el.querySelector(".play-toggle"));
			}
		},
		overlay: {
			/** @return {HTMLElement} */
			get: function() {
				return this._overlay || (this._overlay = this.el.querySelector(".overlay"));
			}
		}
	},

	/** @override */
	initialize: function(opts) {
		MediaRenderer.prototype.initialize.apply(this, arguments);
		_.bindAll(this,
			"_onPlaybackToggle",
			"_onVisibilityChange"
		);
		this._setPlaybackRequested(this._playbackRequested);
		// this.listenTo(this, "view:parentChange", function(childView, newParent, oldParent) {
		// 	// logAttachInfo(this, "[view:parentChange]", "info");
		// 	console.info("%s::[view:parentChange] '%s' to '%s'", this.cid, oldParent && oldParent.cid, newParent && newParent.cid);
		// });
	},

	// /** @override */
	// initializeAsync: function() {
	// 	return MediaRenderer.prototype.initialize.initializeAsync.apply(this, arguments);
	// },

	// /** @override */
	// remove: function() {
	// 	MediaRenderer.prototype.remove.apply(this, arguments);
	// 	return this;
	// },

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	// createChildren: function() {
	// 	this.el.innerHTML = this.template(this.model.toJSON());
	// 	this.placeholder = this.el.querySelector(".placeholder");
	// 	this.content = this.el.querySelector(".content");
	// 	this.image = this.content.querySelector("img.current");
	// },

	/* --------------------------- *
	/* setEnabled
	/* --------------------------- */

	/** @override */
	setEnabled: function(enabled) {
		MediaRenderer.prototype.setEnabled.apply(this, arguments);
		// this._validatePlayback(enabled);
		// if (enabled) {
		this._validatePlayback();
		// } else {
		// 	// if selected, pause media
		// 	this.model.selected && this.togglePlayback(false);
		// 	// this.togglePlayback(false);
		// }
	},

	/* ---------------------------
	/* selection handlers
	/* --------------------------- */

	addSelectionListeners: function() {
		if (this._viewPhase != "initialized")
			throw new Error(this.cid + "::addSelectionListeners called while " + this._viewPhase);

		// logAttachInfo(this, "addSelectionListeners", "log");
		// this.listenTo(this, "view:removed", this.removeSelectionListeners);
		this.listenTo(this.model, "selected", this._onModelSelected);
		this.listenTo(this.model, "deselected", this._onModelDeselected);
		if (this.model.selected) {
			this._onModelSelected();
		}
	},

	// removeSelectionListeners: function() {
	// 	// logAttachInfo(this, "removeSelectionListeners", "log");
	// 	this.stopListening(this, "view:removed", this.removeSelectionListeners);
	// 	this.stopListening(this.model, "selected", this._onModelSelected);
	// 	this.stopListening(this.model, "deselected", this._onModelDeselected);
	// 	if (this.model.selected) {
	// 		this._onModelDeselected();
	// 	}
	// },

	/* model selected handlers:
	/* model selection toggles playback
	/* --------------------------- */

	_onModelSelected: function() {
		console.log("%s::_onModelSelected _playbackRequested: %s, event: %s", this.cid, this._playbackRequested, this._toggleEvent);
		// logAttachInfo(this, "_onModelSelected", "log");
		// this._addParentListeners();
		this.listenTo(this, "view:parentChange", this._onParentChange);
		if (this.parentView) this._onParentChange(this, this.parentView, null);

		this._addDOMListeners();
		this._validatePlayback();
	},

	_onModelDeselected: function() {
		// logAttachInfo(this, "_onModelDeselected", "log");
		// this._removeParentListeners();
		this.stopListening(this, "view:parentChange", this._onParentChange);
		if (this.parentView) this._onParentChange(this, null, this.parentView);

		this._removeDOMListeners();
		this.togglePlayback(false);
		// this._validatePlayback(this.model.selected);
		// this._validatePlayback();
	},

	/* view:parentChange handlers 3
	/* --------------------------- */

	_onParentChange: function(childView, newParent, oldParent) {
		// console.log("[scroll] %s::_onParentChange '%s' to '%s'", this.cid, oldParent && oldParent.cid, newParent && newParent.cid);
		if (oldParent) this.stopListening(oldParent, "view:scrollstart view:scrollend", this._onScrollChange);
		if (newParent) this.listenTo(newParent, "view:scrollstart view:scrollend", this._onScrollChange);
	},

	_onScrollChange: function() {
		if (this.parentView === null) {
			this.togglePlayback(false);
			throw new Error(this.cid + "::_onScrollChange parentView is null");
		}
		// console.log("[scroll] %s::_onScrollChange %s.scrolling: %s", this.cid, this.parentView.cid, this.parentView.scrolling);

		// this._validatePlayback(!this.parentView.scrolling);
		// if (!this.parentView.scrolling) {
		this._validatePlayback();
		// } else {
		// 	this.togglePlayback(false);
		// }
	},

	/* view:parentChange handlers
	/* --------------------------- */

	/*_addParentListeners: function() {
		if (!this.parentView) {
			logAttachInfo(this, "_addParentListeners", "error");
			return;
		}
		this.listenTo(this, "view:remove", this._removeParentListeners);
		this.listenTo(this.parentView, "view:remove", this._removeParentListeners);
		this.listenTo(this.parentView, "view:scrollstart", this._onScrollStart);
		this.listenTo(this.parentView, "view:scrollend", this._onScrollEnd);
	},

	_removeParentListeners: function(view) {
		if (!this.parentView) {
			logAttachInfo(this, "_removeParentListeners", "error");
			return;
		}
		if (view !== void 0) {
			logAttachInfo(this, "_removeParentListeners [event source view]", "info");
			// console.info("%s[playable]::_removeParentListeners event source view: %s", this.cid, view && view.cid);
		}

		this.stopListening(this, "view:remove", this._removeParentListeners);
		this.stopListening(this.parentView, "view:remove", this._removeParentListeners);
		this.stopListening(this.parentView, "view:scrollstart", this._onScrollStart);
		this.stopListening(this.parentView, "view:scrollend", this._onScrollEnd);
	},*/

	/* view:scrollstart view:scrollend
	/* --------------------------- */

	/*_onScrollStart: function() {
		this.togglePlayback(false);
	},

	_onScrollEnd: function() {
		this._validatePlayback();
	},*/

	/* listen to DOM events
	/* --------------------------- */

	_addDOMListeners: function() {
		this.listenTo(this, "view:removed", this._removeDOMListeners);
		document.addEventListener(visibilityChangeEvent, this._onVisibilityChange, false);
		this.playToggle.addEventListener(this._toggleEvent, this._onPlaybackToggle, true);
	},

	_removeDOMListeners: function() {
		this.stopListening(this, "view:removed", this._removeDOMListeners);
		document.removeEventListener(visibilityChangeEvent, this._onVisibilityChange, false);
		this.playToggle.removeEventListener(this._toggleEvent, this._onPlaybackToggle, true);
	},

	/* visibility dom event
	/* --------------------------- */
	_onVisibilityChange: function(ev) {
		// this._validatePlayback(!document[visibilityHiddenProp]);
		// this._validatePlayback(document[visibilityStateProp] != "hidden");
		// if (document[visibilityStateProp] != "hidden") {
		this._validatePlayback();
		// } else {
		// 	this.togglePlayback(false);
		// }
	},

	/* --------------------------- *
	/* play-toggle
	/* --------------------------- */

	/** @type {String} */
	_toggleEvent: window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup",

	_onPlaybackToggle: function(ev) {
		console.log("%s[%sabled]::_onPlaybackToggle[%s] defaultPrevented: %s", this.cid, this.enabled ? "en" : "dis", ev.type, ev.defaultPrevented);
		// NOTE: Perform action if MouseEvent.button is 0 or undefined (0: left-button)
		if (this.enabled && !ev.defaultPrevented && !ev.button) {
			ev.preventDefault();
			this.playbackRequested = !this.playbackRequested;
		}
	},

	/* --------------------------- *
	/* playbackRequested
	/* --------------------------- */

	/** @type {Boolean?} */
	_playbackRequested: null,

	_setPlaybackRequested: function(value) {
		this._playbackRequested = value;

		var classList = this.content.classList;
		classList.toggle("playing", value === true);
		classList.toggle("paused", value === false);
		classList.toggle("requested", value === true || value === false);

		// this._validatePlayback(this.playbackRequested);
		// if (this.playbackRequested) {
		this._validatePlayback();
		// } else {
		// 	this.togglePlayback(false);
		// }
	},

	/* --------------------------- *
	/* togglePlayback
	/* --------------------------- */

	/** @override */
	togglePlayback: function(newPlayState) {
		// console.log("[scroll] %s::togglePlayback [%s -> %s] (requested: %s)", this.cid,
		// 		(this._isMediaPaused()? "pause" : "play"),
		// 		(newPlayState? "play" : "pause"),
		// 		this.playbackRequested
		// 	);
		if (_.isBoolean(newPlayState) && newPlayState !== this._isMediaPaused()) {
			return; // requested state is current, do nothing
		} else {
			newPlayState = this._isMediaPaused();
		}
		if (newPlayState) { // changing to what?
			this._playMedia();
		} else {
			this._pauseMedia();
		}
	},

	_canResumePlayback: function() {
		return !!(
			this.enabled &&
			this.model.selected &&
			this.playbackRequested &&
			(this.mediaState === "ready") &&
			this.attached &&
			(this.parentView !== null) &&
			(!this.parentView.scrolling) &&
			(document[visibilityStateProp] != "hidden")
		);
	},

	_validatePlayback: function(shortcircuit) {
		// a 'shortcircuit' boolean argument can be passed, and if false,
		// skip _canResumePlayback and pause playback right away
		if (arguments.length != 0 && !shortcircuit) {
			this.togglePlayback(false);
		} else {
			this.togglePlayback(this._canResumePlayback());
		}
	},

	/* --------------------------- *
	/* abstract
	/* --------------------------- */

	_isMediaPaused: function() {
		console.warn("%s::_isMediaPaused Not implemented", this.cid);
		return true;
	},

	_playMedia: function() {
		console.warn("%s::_playMedia Not implemented", this.cid);
	},

	_pauseMedia: function() {
		console.warn("%s::_pauseMedia Not implemented", this.cid);
	},

	/* --------------------------- *
	/* util
	/* --------------------------- */

	updateOverlay: function(mediaEl, targetEl, rectEl) {
		// // this method is not critical, just catch and log all errors
		// try {
		// 	this._updateOverlay(mediaEl, targetEl, rectEl)
		// } catch (err) {
		// 	console.error("%s::updateOverlay", this.cid, err);
		// }
	},

	_drawMediaElement: function(context, mediaEl, dest) {
		// destination rect
		// NOTE: mediaEl is expected to have the same dimensions in this.metrics.media
		mediaEl || (mediaEl = this.defaultImage);
		dest || (dest = {
			x: 0,
			y: 0,
			width: this.metrics.media.width,
			height: this.metrics.media.height
		});

		// native/display scale
		var sW = this.model.get("source").get("w"),
			sH = this.model.get("source").get("h"),
			rsX = sW / this.metrics.media.width,
			rsY = sH / this.metrics.media.height;

		// dest, scaled to native
		var src = {
			x: Math.max(0, dest.x * rsX),
			y: Math.max(0, dest.y * rsY),
			width: Math.min(sW, dest.width * rsX),
			height: Math.min(sH, dest.height * rsY)
		};

		// resize canvas
		// var canvas = context.canvas;
		// if (canvas.width !== dest.width || canvas.height !== dest.height) {
		// 	canvas.width = dest.width;
		// 	canvas.height = dest.height;
		// }
		context.canvas.width = dest.width;
		context.canvas.height = dest.height;

		// copy image to canvas
		context.clearRect(0, 0, dest.width, dest.height);
		context.drawImage(mediaEl,
			src.x, src.y, src.width, src.height,
			0, 0, dest.width, dest.height // destination rect
		);

		return context;
	},

	/*
	_updateOverlay: function(mediaEl, targetEl, rectEl) {
		// src/dest rects
		// ------------------------------
		rectEl || (rectEl = targetEl);

		// NOTE: does not work with svg element
		// var tRect = rectEl.getBoundingClientRect();
		// var cRect = mediaEl.getBoundingClientRect();
		// var tX = tRect.x - cRect.x,
		// 	tY = tRect.y - cRect.y,
		// 	tW = tRect.width,
		// 	tH = tRect.height;

		// target bounds
		var tX = rectEl.offsetLeft,
			tY = rectEl.offsetTop,
			tW = rectEl.offsetWidth,
			tH = rectEl.offsetHeight;

		if (tX === void 0 || tY === void 0 || tW === void 0 || tH === void 0) {
			return;
		}

		// destination rect
		var RECT_GROW = 20;
		var dest = {
			x: tX - RECT_GROW,
			y: tY - RECT_GROW,
			width: tW + RECT_GROW * 2,
			height: tH + RECT_GROW * 2
		};

		// native/display scale
		var sW = this.model.get("w"),
			sH = this.model.get("h"),
			rsX = sW/this.metrics.media.width,
			rsY = sH/this.metrics.media.height;

		// dest, scaled to native
		var src = {
			x: Math.max(0, dest.x * rsX),
			y: Math.max(0, dest.y * rsY),
			width: Math.min(sW, dest.width * rsX),
			height: Math.min(sH, dest.height * rsY)
		};

		// Copy image to canvas
		// ------------------------------
		var canvas, context, imageData;

		// canvas = document.createElement("canvas");
		// canvas.style.width  = dest.width + "px";
		// canvas.style.height = dest.height + "px";

		canvas = getSharedCanvas();
		if (canvas.width !== dest.width || canvas.height !== dest.height) {
			canvas.width = dest.width;
			canvas.height = dest.height;
		}
		context = canvas.getContext("2d");
		context.clearRect(0, 0, dest.width, dest.height);
		context.drawImage(mediaEl,
			src.x, src.y, src.width, src.height,
			0, 0, dest.width, dest.height // destination rect
		);
		imageData = context.getImageData(0, 0, dest.width, dest.height);

		var avgColor = Color().rgb(getAverageRGB(imageData));
		// var avgHex = avgColor.hexString(), els = this.el.querySelectorAll("img, video");
		// for (var i = 0; i < els.length; i++) {
		// 	els.item(i).style.backgroundColor = avgHex;
		// }

		targetEl.classList.toggle("over-dark", avgColor.dark());

		// console.log("%s::updateOverlay() avgColor:%s (%s)", this.cid, avgColor.rgbString(), avgColor.dark()?"dark":"light", targetEl);

		// Color, filter opts
		// ------------------------------

		// this.fgColor || (this.fgColor = new Color(this.model.attr("color")));
		// this.bgColor || (this.bgColor = new Color(this.model.attr("background-color")));
		//
		// var opts = { radius: 20 };
		// var isFgDark = this.fgColor.luminosity() < this.bgColor.luminosity();
		// opts.x00 = isFgDark? this.fgColor.clone().lighten(0.5) : this.bgColor.clone().darken(0.5);
		// opts.xFF = isFgDark? this.bgColor.clone().lighten(0.5) : this.fgColor.clone().darken(0.5);
		//
		// stackBlurMono(imageData, opts);
		// duotone(imageData, opts);
		// stackBlurRGB(imageData, { radius: 20 });
		//
		// context.putImageData(imageData, 0, 0);
		// targetEl.style.backgroundImage = "url(" + canvas.toDataURL() + ")";
	}*/
});

/* ---------------------------
/* Google Analytics
/* --------------------------- */
if (GA) {
	PlayableRenderer = (function(PlayableRenderer) {

		/** @type {module:underscore.strings/dasherize} */
		var dasherize = require("underscore.string/dasherize");

		// var readyEvents = ["playing", "waiting", "ended"];
		// var userEvents = ["play", "pause"];


		return PlayableRenderer.extend({

			/** @override */
			initialize: function() {
				var retval = PlayableRenderer.prototype.initialize.apply(this, arguments);
				this._playbackRequestedDefault = this.playbackRequested;
				return retval;
			},

			_onPlaybackToggle: function(ev) {
				var retval = PlayableRenderer.prototype._onPlaybackToggle.apply(this, arguments);
				var o = {
					hitType: "event",
					eventCategory: dasherize(this.cidPrefix),
					eventAction: this.playbackRequested ? "play" : "pause",
					eventLabel: this.model.get("text"),
				};
				if (this._playbackRequestedDefault)
					o.eventAction += "-autoplay";
				window.ga("send", o);
				return retval;
			},

			// /** @override */
			// togglePlayback: function(newPlayState) {
			// 	var retval = PlayableRenderer.prototype.togglePlayback.apply(this, arguments);
			// 	window.ga("send", {
			// 		hitType: "event",
			// 		eventCategory: "Playable",
			// 		eventAction: this.playbackRequested ? "play" : "pause",
			// 		eventLabel: this.model.get("text"),
			// 	});
			// 	return retval;
			// },
		});
	})(PlayableRenderer);
}

// if (DEBUG) {
//
// PlayableRenderer = (function(PlayableRenderer) {
// 	if (!PlayableRenderer.LOG_TO_SCREEN) return PlayableRenderer;
//
// 	/** @type {module:underscore.strings/lpad} */
// 	var lpad = require("underscore.string/lpad");
//
// 	return PlayableRenderer.extend({
// 		_canResumePlayback: function() {
// 			var retval = PlayableRenderer.prototype._canResumePlayback.apply(this.arguments);
// 			console.log("[scroll] %s::_canResumePlayback():%s", this.cid, retval,
// 			{
// 				"enabled": this.enabled,
// 				"selected": (!!this.model.selected),
// 				"playbackRequested": this.playbackRequested,
// 				"attached": this.attached,
// 				"parentView": (this.parentView && this.parentView.cid),
// 				"!scrolling": (this.parentView && !this.parentView.scrolling),
// 				"mediaState": this.mediaState,
// 				// "!document.hidden": !document[visibilityHiddenProp],
// 				"visibilityState": document[visibilityStateProp]
// 			});
// 			return retval;
// 		},
// 	});
// })(PlayableRenderer);
//
// }

module.exports = PlayableRenderer;
}).call(this,true)

},{"app/view/render/MediaRenderer":92,"underscore":"underscore","underscore.string/dasherize":23,"utils/prefixedEvent":111,"utils/prefixedProperty":112}],94:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<div class=\"placeholder sizing\"></div>\n<div class=\"content\">\n	<div class=\"media-border content-size\"></div>\n	<div class=\"controls content-size\">\n		<canvas class=\"progress-meter\"></canvas>\n	</div>\n	<div class=\"sequence media-size\">\n		<img class=\"sequence-step current default\" alt=\""
    + alias4(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"text","hash":{},"data":data}) : helper)))
    + "\" longdesc=\"#desc_m"
    + alias4(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" />\n	</div>\n	<div class=\"overlay media-size\">\n		<div class=\"play-toggle-hitarea play-toggle\">\n		</div>\n	</div>\n</div>\n";
},"useData":true});

},{"hbsfy/runtime":21}],95:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/view/render/SequenceRenderer
 */

/* --------------------------- *
/* Imports
/* --------------------------- */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/render/PlayableRenderer} */
var PlayableRenderer = require("app/view/render/PlayableRenderer");
// /** @type {module:app/model/SelectableCollection} */
// var SelectableCollection = require("app/model/SelectableCollection");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

/** @type {module:app/view/component/ProgressMeter} */
var ProgressMeter = require("app/view/component/ProgressMeter");

/** @type {module:utils/Timer} */
var Timer = require("utils/Timer");
// /** @type {Function} */
// var transitionEnd = require("utils/event/transitionEnd");
// /** @type {module:utils/prefixedProperty} */
// var prefixed = require("utils/prefixedProperty");

/** @type {Function} */
var _whenImageLoads = require("app/view/promise/_whenImageLoads");
/** @type {module:app/view/promise/_loadImageAsObjectURL} */
var _loadImageAsObjectURL = require("app/view/promise/_loadImageAsObjectURL");
/** @type {Function} */
var whenSelectionDistanceIs = require("app/view/promise/whenSelectionDistanceIs");
// var whenSelectTransitionEnds = require("app/view/promise/whenSelectTransitionEnds");
// var whenDefaultImageLoads = require("app/view/promise/whenDefaultImageLoads");

// /** @type {Function} */
// var Color = require("color");
// var duotone = require("utils/canvas/bitmap/duotone");
// var stackBlurRGB = require("utils/canvas/bitmap/stackBlurRGB");
// var stackBlurMono = require("utils/canvas/bitmap/stackBlurMono");
// var getAverageRGBA = require("utils/canvas/bitmap/getAverageRGBA");

var errorTemplate = require("../template/ErrorBlock.hbs");

var MIN_STEP_INTERVAL = 2 * Globals.TRANSITION_DURATION + Globals.TRANSITION_DELAY_INTERVAL;
var DEFAULT_STEP_INTERVAL = 6 * Globals.TRANSITION_DURATION + Globals.TRANSITION_DELAY_INTERVAL;


/* --------------------------- *
/* Private classes
/* --------------------------- */

// /**
// * @constructor
// * @type {module:app/view/render/SequenceRenderer.SourceCollection}
// */
// var SourceCollection = SelectableCollection.extend({
// 	model: Backbone.Model
// });

/**
 * @constructor
 * @type {module:app/view/render/SequenceRenderer.PrefetechedSourceRenderer}
 */
var PrefetechedSourceRenderer = View.extend({

	cidPrefix: "sequenceStepRenderer",
	/** @type {string} */
	className: "sequence-step",
	/** @type {string} */
	tagName: "img",

	properties: {
		ready: {
			get: function() {
				return this._ready;
			}
		}
	},

	/** @override */
	initialize: function(options) {
		!this.el.hasAttribute("alt") && this.el.setAttribute("alt", this.model.get("src"));
		// this.el.setAttribute("longdesc", this.model.get("original"));

		if (this.model.has("prefetched")) {
			this._renderPrefetched();
		} else {
			this.listenTo(this.model, "change:prefetched", this._renderPrefetched);
		}
		this.listenTo(this.model, "selected deselected", this._renderSelection);
		this._renderSelection();
	},

	_renderSelection: function() {
		this.el.classList.toggle("current", !!this.model.selected);
	},

	_renderPrefetched: function() {
		var prefetched = this.model.get("prefetched");
		if (prefetched !== this.el.src) {
			this.el.src = prefetched;
		}
		_whenImageLoads(this.el).then(
			function(el) {
				this.requestAnimationFrame(function(tstamp) {
					this._setReady(true);
				});
			}.bind(this),
			function(err) {
				// this._setReady(false);
				(err instanceof Error) || (err = new Error("cannot load prefetched url"));
				throw err;
			}.bind(this)
		);
	},

	/** @type {boolean} */
	_ready: false,

	_setReady: function(ready) {
		if (this._ready === ready) return;
		this._ready = !!(ready); // make bool
		this.trigger("renderer:ready", this);
	},

	render: function() {
		// if (this.model.has("prefetched")) {
		// 	this._renderPrefetched();
		// }
		// this.el.classList.toggle("current", !!this.model.selected);
		console.log("%s::render", this.cid);
		return this;
	},
});

/**
 * @constructor
 * @type {module:app/view/render/SequenceRenderer.SimpleSourceRenderer}
 */
// var SimpleSourceRenderer = View.extend({
//
// 	cidPrefix: "sequenceStepRenderer",
// 	/** @type {string} */
// 	className: "sequence-step",
// 	/** @type {string} */
// 	tagName: "img",
//
// 	/** @override */
// 	initialize: function (options) {
// 		// this.el.classList.toggle("current", this.model.hasOwnProperty("selected"));
// 		this.el.classList.toggle("current", !!this.model.selected);
// 		this.listenTo(this.model, {
// 			"selected": function () {
// 				this.el.classList.add("current");
// 			},
// 			"deselected": function () {
// 				this.el.classList.remove("current");
// 			}
// 		});
// 		if (this.el.src === "") {
// 			this.el.src = Globals.MEDIA_DIR + "/" + this.model.get("src");
// 		}
//
// 		if (this.model.has("error")) {
// 			this._onModelError();
// 		} else {
// 			this.listenToOnce(this.model, "change:error", this._onModelError);
// 			// this.listenToOnce(this.model, {
// 			// 	"change:source": this._onModelSource,
// 			// 	"change:error": this._onModelError,
// 			// });
// 		}
// 	},
//
// 	// _onModelSource: function() {
// 	// 	this.el.src = Globals.MEDIA_DIR + "/" + this.model.get("src");
// 	// 	// console.log("%s::change:src", this.cid, this.model.get("src"));
// 	// },
//
// 	_onModelError: function() {
// 		var err = this.model.get("error");
// 		var errEl = document.createElement("div");
// 		errEl.className = "error color-bg" + (this.model.selected? " current" : "");
// 		errEl.innerHTML = errorTemplate(err);
// 		this.setElement(errEl, true);
// 		console.log("%s::change:error", this.cid, err.message, err.infoSrc);
// 	},
// });

var SourceErrorRenderer = View.extend({

	/** @type {string} */
	className: "sequence-step error",
	/** @override */
	cidPrefix: "sourceErrorRenderer",
	/** @override */
	template: errorTemplate,
	/** @type {boolean} */
	ready: true,

	initialize: function(options) {
		// var handleSelectionChange = function onSelectionChange () {
		// 	this.el.classList.toggle("current", !!this.model.selected);
		// };
		// this.listenTo(this.model, "selected deselected", handleSelectionChange);
		// // this.el.classList.toggle("current", !!this.model.selected);
		// handleSelectionChange.call(this);
		this.listenTo(this.model, "selected deselected", function() {
			this.el.classList.toggle("current", !!this.model.selected);
		});
	},

	render: function() {
		this.el.classList.toggle("current", !!this.model.selected);
		this.el.innerHTML = this.template(this.model.get("error"));
		return this;
	},
});

var SequenceStepRenderer = PrefetechedSourceRenderer;
// var SequenceStepRenderer = SimpleSourceRenderer;

/**
 * @constructor
 * @type {module:app/view/render/SequenceRenderer}
 */
var SequenceRenderer = PlayableRenderer.extend({

	/** @type {string} */
	cidPrefix: "sequenceRenderer",
	/** @type {string} */
	className: PlayableRenderer.prototype.className + " sequence-renderer",
	/** @type {Function} */
	template: require("./SequenceRenderer.hbs"),

	/* --------------------------- *
	/* initialize
	/* --------------------------- */

	initialize: function() {
		this.sources = this.model.get("sources");
		PlayableRenderer.prototype.initialize.apply(this, arguments);
	},

	initializeAsync: function() {
		return PlayableRenderer.prototype.initializeAsync.apply(this, arguments)
			.then(
				function(view) {
					return view.whenAttached();
				})
			.then(function(view) {
				view.initializePlayable();
				view.updateOverlay(view.defaultImage, view.overlay);
				view.addSelectionListeners();
				return view;
			});
	},

	whenInitialized: function(view) {
		var retval = PlayableRenderer.prototype.whenInitialized.apply(this, arguments);
		view._validatePlayback();
		return retval;
	},

	/* --------------------------- *
	/* children
	/* --------------------------- */

	/** @override */
	createChildren: function() {
		PlayableRenderer.prototype.createChildren.apply(this, arguments);

		this.placeholder = this.el.querySelector(".placeholder");
		this.sequence = this.content.querySelector(".sequence");

		this.content.classList.add("started");

		// styles
		// ---------------------------------
		var s, attrs = this.model.attrs();
		// var s, attrs = this.model.get("attrs");
		s = _.pick(attrs, "box-shadow", "border", "border-radius");
		_.extend(this.content.querySelector(".media-border").style, s);
		s = _.pick(attrs, "border-radius");
		_.extend(this.sequence.style, s);
		_.extend(this.placeholder.style, s);

		// model
		// ---------------------------------
		this.sources.select(this.model.get("source"));

		// itemViews
		// ---------------------------------
		this.itemViews = new Container();
		// add default image as renderer (already in DOM)
		this.itemViews.add(new SequenceStepRenderer({
			el: this.getDefaultImage(),
			model: this.sources.selected
		}));
	},

	/* --------------------------- *
	/* layout
	/* --------------------------- */

	/** @override */
	render: function() {
		PlayableRenderer.prototype.render.apply(this, arguments);

		var els, el, i, cssW, cssH;
		var content = this.content;

		// media-size
		// ---------------------------------
		cssW = this.metrics.media.width + "px";
		cssH = this.metrics.media.height + "px";

		els = this.el.querySelectorAll(".media-size");
		for (i = 0; i < els.length; i++) {
			el = els.item(i);
			el.style.width = cssW;
			el.style.height = cssH;
		}
		content.style.width = cssW;
		content.style.height = cssH;

		// content-position
		// ---------------------------------
		var cssX, cssY;
		cssX = this.metrics.content.x + "px";
		cssY = this.metrics.content.y + "px";
		content.style.left = cssX;
		content.style.top = cssY;

		el = this.el.querySelector(".controls");
		// el.style.left = cssX;
		// el.style.top = cssY;
		el.style.width = this.metrics.content.width + "px";
		el.style.height = this.metrics.content.height + "px";

		// // content-size
		// // ---------------------------------
		// cssW = this.metrics.content.width + "px";
		// cssH = this.metrics.content.height + "px";
		//
		// els = this.el.querySelectorAll(".content-size");
		// for (i = 0; i < els.length; i++) {
		// 	el = els.item(i);
		// 	el.style.width = cssW;
		// 	el.style.height = cssH;
		// }

		return this;
	},

	initializePlayable: function() {
		// Sequence model
		// ---------------------------------
		// this.sources = this._createSourceCollection(this.model);
		whenSelectionDistanceIs(this, 0).then(this._preloadAllItems, function(err) {
			if (err instanceof View.ViewError) { // Ignore ViewError
				// console.warn(err.name, err.message);//, err.view.cid);
				return;
			}
			return err;
		});

		// timer
		// ---------------------------------
		this._sequenceInterval = Math.max(parseInt(this.model.attr("@sequence-interval")), MIN_STEP_INTERVAL) || DEFAULT_STEP_INTERVAL;

		this.timer = new Timer();
		this.listenTo(this, "view:removed", function() {
			this.timer.stop();
			this.stopListening(this.timer);
		});
		this.listenTo(this.timer, {
			"start": this._onTimerStart,
			"resume": this._onTimerResume,
			"pause": this._onTimerPause,
			"end": this._onTimerEnd,
			// "stop": function () { // stop is only called on view remove},
		});

		// progress-meter model
		// ---------------------------------
		this._sourceProgressByIdx = this.sources.map(function() {
			return 0;
		});
		this._sourceProgressByIdx[0] = 1; // first item is already loaded

		// progress-meter
		// ---------------------------------
		this.progressMeter = new ProgressMeter({
			el: this.el.querySelector(".progress-meter"),
			values: {
				available: this._sourceProgressByIdx.concat(),
			},
			maxValues: {
				amount: this.sources.length,
				available: this.sources.length,
			},
			color: this.model.attr("color"),
			// backgroundColor: this.model.attr("background-color"),
			labelFn: this._progressLabelFn.bind(this)
		});

		// this.el.querySelector(".top-bar")
		//		.appendChild(this.progressMeter.render().el);
	},

	_progressLabelFn: function() {
		if (this.playbackRequested === false) return Globals.PAUSE_CHAR;
		return (this.sources.selectedIndex + 1) + "/" + this.sources.length;
	},

	_preloadAllItems: function(view) {
		view.once("view:remove", function() {
			var silent = {
				silent: true
			};
			view.sources.forEach(function(item, index, sources) {
				var prefetched = item.get("prefetched");
				if (prefetched && /^blob\:/.test(prefetched)) {
					item.unset("prefetched", silent);
					item.set("progress", 0, silent);
					URL.revokeObjectURL(prefetched);
				}
			});
		});
		return view.sources.reduce(function(lastPromise, item, index, sources) {
			return lastPromise.then(function(view) {
				if (item.has("prefetched")) {
					view._updateItemProgress(1, index);
					return view;
				} else {
					return _loadImageAsObjectURL(item.get("original"),
							function(progress) {
								view._updateItemProgress(progress, index);
								item.set("progress", progress);
							})
						.then(
							function(pUrl) {
								view._updateItemProgress(1, index);
								item.set({
									prefetched: pUrl,
									progress: 1
								});
								// item.set("prefetched", pUrl);
								return view;
							},
							function(err) {
								view._updateItemProgress(0, index);
								item.set({
									error: err,
									progress: 0
								});
								// item.set("error", err);
								return view;
							}
						);
				}
			});
		}, Promise.resolve(view));
	},

	// _preloadAllItems2: function(view) {
	// 	return view.sources.reduce(function(lastPromise, item, index, sources) {
	// 		return lastPromise.then(function(view) {
	// 			var itemView = view._getItemRenderer(item);
	// 			return _whenImageLoads(itemView.el).then(function(url){
	// 				view._updateItemProgress(1, index);
	// 				return view;
	// 			}, function(err) {
	// 				view._updateItemProgress(0, index);
	// 				item.set("error", err);
	// 				return view;
	// 			});
	// 		});
	// 	}, Promise.resolve(view));
	// },

	// _getItemRenderer: function(item) {}

	_updateItemProgress: function(progress, index) {
		this._sourceProgressByIdx[index] = progress;
		if (this.progressMeter) {
			this.progressMeter.valueTo(this._sourceProgressByIdx, 300, "available");
		}
	},

	/* ---------------------------
	/* PlayableRenderer implementation
	/* --------------------------- */

	/** @override initial value */
	_playbackRequested: true,

	/** @type {Boolean} internal store */
	_paused: true,

	/** @override */
	_isMediaPaused: function() {
		return this._paused;
	},

	/** @override */
	_playMedia: function() {
		if (!this._paused) return;
		this._paused = false;
		if (this.timer.status == Timer.PAUSED) {
			this.timer.start(); // resume, actually
		} else {
			this.timer.start(this._sequenceInterval);
		}
	},

	/** @override */
	_pauseMedia: function() {
		if (this._paused) return;
		this._paused = true;
		if (this.timer.status == Timer.STARTED) {
			this.timer.pause();
		}
	},

	/* --------------------------- *
	/* sequence private
	/* --------------------------- */

	_onTimerStart: function(duration) {
		this.progressMeter.valueTo(this.sources.selectedIndex + 1, duration, "amount");
		// init next renderer now to have smooth transitions
		this._getItemRenderer(this.sources.followingOrFirst());
	},

	_onTimerResume: function(duration) {
		this.progressMeter.valueTo(this.sources.selectedIndex + 1, duration, "amount");
	},

	_onTimerPause: function(duration) {
		// var meterDur = this.progressMeter._valueData["amount"]._duration - this.progressMeter._valueData["amount"]._elapsedTime;
		// var meterVal = this.progressMeter.getRenderedValue("amount");
		// var timerVal = (this._sequenceInterval - duration) / this._sequenceInterval + this.sources.selectedIndex;
		//
		// console.log("%s::_onTimerPause [interval:%sms]\n\tmeter:%s (%sms)\n\ttimer:%s (%sms)\n\tdiffs:%s (%sms)",
		// 		this.cid, this._sequenceInterval,
		// 		meterVal, meterDur,
		// 		timerVal, duration,
		// 		Math.abs(meterVal-timerVal), Math.abs(meterDur-duration));

		// this.progressMeter.valueTo(timerVal);
		// this.progressMeter.valueTo(meterVal);

		this.progressMeter.valueTo(this.progressMeter.getRenderedValue("amount"), 0, "amount");
	},

	_onTimerEnd: function() {
		var context = this;
		var nextSource, nextView;

		nextSource = this.sources.followingOrFirst();
		// init next renderer
		nextView = this._getItemRenderer(nextSource);
		// init second next renderer
		// this._getItemRenderer(this.sources.followingOrFirst(nextSource));

		var showNextView = function() {
			context.requestAnimationFrame(function() {
				context.content.classList.remove("waiting");
				if (!context._paused) {
					// if (context.playbackRequested) {
					context.content.classList.toggle("playback-error", nextSource.has("error"));
					context.sources.select(nextSource); // NOTE: step increase done here
					// view.updateOverlay(nextView.el, view.overlay);
					context.timer.start(context._sequenceInterval);
					// console.log("%s::showNextView %sms %s", context.cid, context._sequenceInterval, nextSource.cid)
				}
			});
		};

		if (nextSource.has("prefetched")) {
			// nextView = context._getItemRenderer(nextSource).el;
			_whenImageLoads(nextView.el).then(showNextView, showNextView);
		} else if (nextSource.has("error")) {
			showNextView();
		} else {
			this.content.classList.add("waiting");
			/* TODO: add ga event 'media-waiting' */
			// console.log("%s:[waiting] %sms %s", context.cid, nextSource.cid);
			window.ga("send", "event", "sequence-renderer", "waiting", this.model.get("text"));
			this.listenTo(nextSource, "change:prefetched change:error",
				function() {
					this.stopListening(nextSource, "change:prefetched change:error");
					/* TODO: add ga event 'media-playing' */
					// console.log("%s:[playing] %sms %s", context.cid, nextSource.cid);
					window.ga("send", "event", "sequence-renderer", "playing", this.model.get("text"));
					_whenImageLoads(nextView.el).then(showNextView, showNextView);
					// context.content.classList.remove("waiting");
					// nextView = context._getItemRenderer(nextSource).el;
				});
		}
	},

	_getItemRenderer: function(item) {
		var view = this.itemViews.findByModel(item);
		if (!view) {
			var renderer = item.has("error") ? SourceErrorRenderer : SequenceStepRenderer;
			view = new renderer({
				model: item
			});
			// view = new SequenceStepRenderer({ model: item });
			this.itemViews.add(view);
			this.sequence.appendChild(view.render().el);
		}
		return view;
	},

	/* --------------------------- *
	/* progress meter
	/* --------------------------- */

	// _createDefaultItemData: function() {
	// 	var canvas = document.createElement("canvas");
	// 	var context = canvas.getContext("2d");
	// 	var imageData = this._drawMediaElement(context).getImageData(0, 0, canvas.width, canvas.height);
	//
	// 	var opts = { radius: 20 };
	// 	var fgColor = new Color(this.model.attr("color"));
	// 	var bgColor = new Color(this.model.attr("background-color"));
	// 	var isFgDark = fgColor.luminosity() < bgColor.luminosity();
	// 	opts.x00 = isFgDark? fgColor.clone().lighten(0.33) : bgColor.clone().darken(0.33);
	// 	opts.xFF = isFgDark? bgColor.clone().lighten(0.33) : fgColor.clone().darken(0.33);
	//
	// 	stackBlurMono(imageData, opts);
	// 	duotone(imageData, opts);
	// 	// stackBlurRGB(imageData, opts);
	//
	// 	context.putImageData(imageData, 0, 0);
	// 	return canvas.toDataURL();
	// },
});

if (DEBUG) {

	SequenceRenderer = (function(SequenceRenderer) {
		if (!SequenceRenderer.LOG_TO_SCREEN) return SequenceRenderer;

		/** @type {module:underscore.strings/lpad} */
		var lpad = require("underscore.string/lpad");

		return SequenceRenderer.extend({
			__logTimerEvent: function(evname, msg) {
				var logMsg = [
				"source: ", lpad(this.sources.selectedIndex, 2),
				"duration:", lpad(this.timer.getDuration(), 4),
				"paused:", this.paused,
				"requested:", this.playbackRequested,
				"status:", this.timer.getStatus(),
			];
				msg && logMsg.push(msg);
				logMsg = logMsg.join(" ");

				this.__logMessage(logMsg, evname);
				// console.log("%s::[%s] %s", this.cid, evname, logMsg);
			},
			_playMedia: function() {
				this.__logTimerEvent("playback");
				SequenceRenderer.prototype._playMedia.apply(this, arguments);
				// console.log("%s::_playMedia()", this.cid);
			},
			_pauseMedia: function() {
				this.__logTimerEvent("playback");
				SequenceRenderer.prototype._pauseMedia.apply(this, arguments);
				// console.log("%s::_pauseMedia()", this.cid);
			},

			_onTimerStart: function() {
				this.__logTimerEvent("timer:start");
				SequenceRenderer.prototype._onTimerStart.apply(this, arguments);
			},
			_onTimerResume: function() {
				this.__logTimerEvent("timer:resume");
				SequenceRenderer.prototype._onTimerStart.apply(this, arguments);
			},
			_onTimerPause: function() {
				this.__logTimerEvent("timer:pause");
				SequenceRenderer.prototype._onTimerPause.apply(this, arguments);
			},
			_onTimerEnd: function() {
				this.__logTimerEvent("timer:end");
				SequenceRenderer.prototype._onTimerEnd.apply(this, arguments);
			},

			_updateItemProgress: function(progress, srcIdx) {
				if (progress == 1) {
					this.__logMessage("idx:" + srcIdx + " progress:" + progress, "load:progress");
				}
				SequenceRenderer.prototype._updateItemProgress.apply(this, arguments);
			},

			_preloadAllItems: function(view) {
				view.__logMessage(view.cid + "::_preloadAllItems", "load:start");
				SequenceRenderer.prototype._preloadAllItems.apply(view, arguments);
			},
		});
	})(SequenceRenderer);
}

module.exports = SequenceRenderer;
}).call(this,true)

},{"../template/ErrorBlock.hbs":100,"./SequenceRenderer.hbs":94,"app/control/Globals":34,"app/view/base/View":60,"app/view/component/ProgressMeter":71,"app/view/promise/_loadImageAsObjectURL":75,"app/view/promise/_whenImageLoads":76,"app/view/promise/whenSelectionDistanceIs":79,"app/view/render/PlayableRenderer":93,"backbone.babysitter":"backbone.babysitter","underscore":"underscore","underscore.string/lpad":28,"utils/Timer":102}],96:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper;

  return "<div class=\"placeholder sizing\"></div>\n<div class=\"content media-border\">\n	<div class=\"controls content-size\">\n			<canvas class=\"progress-meter\"></canvas>\n			<a class=\"fullscreen-toggle\" href=\"javascript:(void 0)\">\n				<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" preserveAspectRatio=\"xMidYMid meet\" viewBox=\"-21 -21 42 42\" style=\"max-width:14px;max-height:14px\">\n					<path d=\"M-5,5 L-20,20 M-7,20 L-20,20 L-20,7 M5,-5 L20,-20 M7,-20 L20,-20 L20,-7\" class=\"color-stroke\" style=\"stroke-width:1;fill:none;\" vector-effect=\"non-scaling-stroke\" />\n				</svg>\n			</a>\n	</div>\n	<div class=\"crop-box media-size\">\n		<video preload=\"none\" width=\"240\" height=\"180\"></video>\n		<img class=\"poster default\" alt=\""
    + container.escapeExpression(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(depth0 != null ? depth0 : {},{"name":"text","hash":{},"data":data}) : helper)))
    + "\" width=\"240\" height=\"180\" />\n	</div>\n	<div class=\"overlay media-size\">\n		<div class=\"play-toggle-hitarea play-toggle\">\n		</div>\n	</div>\n</div>\n";
},"useData":true});

},{"hbsfy/runtime":21}],97:[function(require,module,exports){
(function (DEBUG){
/*global HTMLMediaElement, MediaError*/
/**
 * @module app/view/render/VideoRenderer
 *
 * @see https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video
 * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement
 * @see https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Media_events
 * @see https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Using_HTML5_audio_and_video
 */

/* --------------------------- *
/* Imports
/* --------------------------- */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/view/render/PlayableRenderer} */
var PlayableRenderer = require("app/view/render/PlayableRenderer");
/** @type {module:app/view/component/ProgressMeter} */
var ProgressMeter = require("app/view/component/ProgressMeter");
// /** @type {module:utils/prefixedStyleName} */
// var prefixedStyleName = require("utils/prefixedStyleName");
/** @type {module:utils/prefixedEvent} */
var prefixedEvent = require("utils/prefixedEvent");

/* --------------------------- *
/* private static
/* --------------------------- */

// var whenViewIsAttached = require("app/view/promise/whenViewIsAttached");

var fullscreenChangeEvent = prefixedEvent("fullscreenchange", document);
// var fullscreenErrorEvent = prefixedEvent("fullscreenerror", document);

var formatTimecode = function(value) {
	if (isNaN(value)) return ""; //value = 0;
	if (value >= 3600) return ((value / 3600) | 0) + "H";
	if (value >= 60) return ((value / 60) | 0) + "M";
	// if (value >= 10) return "0" + (value | 0) + "S";
	return (value | 0) + "S";
};

/**
 * @constructor
 * @type {module:app/view/render/VideoRenderer}
 */
var VideoRenderer = PlayableRenderer.extend({

	/** @type {string} */
	cidPrefix: "videoRenderer",
	/** @type {string} */
	className: PlayableRenderer.prototype.className + " video-renderer",
	/** @type {Function} */
	template: require("./VideoRenderer.hbs"),

	events: (function() {
		var ret = {};
		ret[Globals.CLICK_EVENT + " fullscreen-toggle"] = "_onFullscreenToggle";
		return ret;
	}()),

	// events: {
	// 	"click .fullscreen-toggle": "_onFullscreenToggle",
	// },

	// properties: {
	// 	paused: {
	// 		get: function() {
	// 			return this.video.paused;
	// 		}
	// 	},
	// },

	/** @override */
	initialize: function(opts) {
		PlayableRenderer.prototype.initialize.apply(this, arguments);

		_.bindAll(this,
			"_updatePlaybackState",
			"_updatePlayedValue",
			"_updateBufferedValue",
			"_onMediaError",
			"_onMediaEnded",
			"_onMediaPlayingOnce",
			"_onFullscreenChange"
		);
		// var onPeerSelect = function() {
		// 	this.content.style.display = (this.getSelectionDistance() > 1)? "none": "";
		// };
		// this.listenTo(this.model.collection, "select:one select:none", onPeerSelect);
		// onPeerSelect();
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	createChildren: function() {
		PlayableRenderer.prototype.createChildren.apply(this, arguments);

		this.placeholder = this.el.querySelector(".placeholder");
		// this.overlay = this.content.querySelector(".overlay");
		this.video = this.content.querySelector("video");
		// this.video.loop = this.model.attrs().hasOwnProperty("@video-loop");
		this.video.loop = this.model.attr("@video-loop") !== void 0;
		this.video.src = this.findPlayableSource(this.video);
	},

	measure: function() {
		PlayableRenderer.prototype.measure.apply(this, arguments);

		// NOTE: Top/bottom 1px video crop
		// - Cropped in CSS: video, .poster { margin-top: -1px; margin-bottom: -1px;}
		// - Cropped height is adjusted in metrics obj
		// - Crop amount added back to actual video on render()
		this.metrics.media.height -= 2;
		this.metrics.content.height -= 2;
	},

	/** @override */
	render: function() {
		PlayableRenderer.prototype.render.apply(this, arguments);

		var els, el, i, cssW, cssH;
		var img = this.defaultImage;
		var content = this.content;

		// media-size
		// ---------------------------------
		cssW = this.metrics.media.width + "px";
		cssH = this.metrics.media.height + "px";

		els = this.el.querySelectorAll(".media-size");
		for (i = 0; i < els.length; i++) {
			el = els.item(i);
			el.style.width = cssW;
			el.style.height = cssH;
		}

		content.style.width = cssW;
		content.style.height = (this.metrics.media.height - 1) + "px";

		// content-position
		// ---------------------------------
		var cssX, cssY;
		cssX = this.metrics.content.x + "px";
		cssY = this.metrics.content.y + "px";
		content.style.left = cssX;
		content.style.top = cssY;

		el = this.el.querySelector(".controls");
		// el.style.left = cssX;
		// controls.style.top = cssY;
		el.style.width = this.metrics.content.width + "px";
		el.style.height = this.metrics.content.height + "px";

		// // content-size
		// // ---------------------------------
		// cssW = this.metrics.content.width + "px";
		// cssH = this.metrics.content.height + "px";
		//
		// els = this.el.querySelectorAll(".content-size");
		// for (i = 0; i < els.length; i++) {
		// 	el = els.item(i);
		// 	el.style.width = cssW;
		// 	el.style.height = cssH;
		// }

		// NOTE: elements below must use video's UNCROPPED height, so +2px
		this.video.setAttribute("width", this.metrics.media.width);
		this.video.setAttribute("height", this.metrics.media.height + 2);
		img.setAttribute("width", this.metrics.media.width);
		img.setAttribute("height", this.metrics.media.height + 2);

		return this;
	},

	/* --------------------------- *
	/* initializeAsync
	/* --------------------------- */

	initializeAsync: function() {
		return Promise.resolve(this)
			.then(PlayableRenderer.whenSelectionIsContiguous)
			.then(PlayableRenderer.whenScrollingEnds)
			.then(
				function(view) {
					return Promise.all([
						view.whenVideoHasMetadata(view),
						PlayableRenderer.whenDefaultImageLoads(view),
					]).then(
						function(arr) {
							return Promise.resolve(view);
						},
						function(err) {
							return Promise.reject(err);
						}
					);
				})
			.then(
				function(view) {
					return view.whenAttached();
				})
			.then(
				function(view) {
					view.initializePlayable();
					view.updateOverlay(view.defaultImage, view.overlay);
					view.addSelectionListeners();
					return view;
				});
	},

	initializePlayable: function() {
		// video
		// ---------------------------------
		this.addMediaListeners();

		// progress-meter
		// ---------------------------------
		this.progressMeter = new ProgressMeter({
			el: this.el.querySelector(".progress-meter"),
			maxValues: {
				amount: this.video.duration,
				available: this.video.duration,
			},
			color: this.model.attr("color"),
			// backgroundColor: this.model.attr("background-color"),
			labelFn: this._progressLabelFn.bind(this)
		});
		// var parentEl = this.el.querySelector(".top-bar");
		// parentEl.insertBefore(this.progressMeter.render().el, parentEl.firstChild);
	},

	_progressLabelFn: function(value, total) {
		if (!this._started || this.video.ended || isNaN(value)) {
			return formatTimecode(total);
		} else if (!this.playbackRequested) {
			return Globals.PAUSE_CHAR;
		} else {
			return formatTimecode(total - value);
		}
	},

	/* ---------------------------
	/* whenVideoHasMetadata promise
	/* --------------------------- */

	whenVideoHasMetadata: function(view) {
		// NOTE: not pretty !!!
		return new Promise(function(resolve, reject) {
			var mediaEl = view.video;
			var eventHandlers = {
				loadedmetadata: function(ev) {
					if (ev) removeEventListeners();
					// console.log("%s::whenVideoHasMetadata [%s] %s", view.cid, "resolved", ev? ev.type : "sync");
					resolve(view);
				},
				abort: function(ev) {
					if (ev) removeEventListeners();
					reject(new PlayableRenderer.ViewError(view, new Error("whenVideoHasMetadata: view was removed")));
				},
				error: function(ev) {
					if (ev) removeEventListeners();
					var err;
					if (mediaEl.error) {
						err = new Error(_.invert(MediaError)[mediaEl.error.code]);
						err.infoCode = mediaEl.error.code;
					} else {
						err = new Error("Unspecified error");
					}
					err.infoSrc = mediaEl.src;
					err.logMessage = "whenVideoHasMetadata: " + err.name + " " + err.infoSrc;
					err.logEvent = ev;
					reject(err);
				},
			};
			//  (mediaEl.preload == "auto" && mediaEl.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA)
			// 	(mediaEl.preload == "metadata" && mediaEl.readyState >= HTMLMediaElement.HAVE_METADATA)
			if (mediaEl.error) {
				eventHandlers.error();
			} else if (mediaEl.readyState >= HTMLMediaElement.HAVE_METADATA) {
				eventHandlers.loadedmetadata();
			} else {
				var sources = mediaEl.querySelectorAll("source");
				var errTarget = sources.length > 0 ? sources.item(sources.length - 1) : mediaEl;
				var errCapture = errTarget === mediaEl; // use capture with HTMLMediaElement

				var removeEventListeners = function() {
					errTarget.removeEventListener("error", eventHandlers.error, errCapture);
					for (var ev in eventHandlers) {
						if (ev !== "error" && eventHandlers.hasOwnProperty(ev)) {
							mediaEl.removeEventListener(ev, eventHandlers[ev], false);
						}
					}
				};
				errTarget.addEventListener("error", eventHandlers.error, errCapture);
				for (var ev in eventHandlers) {
					if (ev !== "error" && eventHandlers.hasOwnProperty(ev)) {
						mediaEl.addEventListener(ev, eventHandlers[ev], false);
					}
				}
				mediaEl.preload = "metadata";
			}
		});
	},

	findPlayableSource: function(video) {
		var playable = this.model.get("sources").find(function(source) {
			return /^video\//.test(source.get("mime")) && video.canPlayType(source.get("mime")) != "";
		});
		return playable ? playable.get("original") : "";
	},

	/* ---------------------------
	/* PlayableRenderer implementation
	/* --------------------------- */

	/** @override initial value */
	_playbackRequested: false,

	/** @override */
	_isMediaPaused: function() {
		return this.video.paused;
	},

	/** @override */
	_playMedia: function() {
		if (this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA && this.video.seekable.length == 0) {
			console.warn(this.cid, "WTF! got video data, but cannot seek, calling load()");
			// this._logMessage("call:load", "got video data, but cannot seek, calling load()", "orange");
			this.video.load();
			// this.video.currentTime = 0;
		} else if (this.video.ended) {
			this.video.currentTime = this.video.seekable.start(0);
		}
		this.video.play();
	},

	/** @override */
	_pauseMedia: function() {
		this.video.pause();
	},

	/* ---------------------------
	/* media events
	/* --------------------------- */

	// updatePlaybackEvents: "play playing waiting pause seeking seeked ended",
	// updateBufferedEvents: "progress canplay canplaythrough playing timeupdate",//loadeddata
	updatePlaybackEvents: "playing waiting pause",
	updateBufferedEvents: "progress canplay canplaythrough play playing",
	updatePlayedEvents: "timeupdate seeked",

	addMediaListeners: function() {
		if (!this._started) this.video.addEventListener("playing", this._onMediaPlayingOnce, false);
		this.addListener(this.video, this.updatePlaybackEvents, this._updatePlaybackState);
		this.addListener(this.video, this.updateBufferedEvents, this._updateBufferedValue);
		this.addListener(this.video, this.updatePlayedEvents, this._updatePlayedValue);
		this.video.addEventListener("ended", this._onMediaEnded, false);
		this.video.addEventListener("error", this._onMediaError, true);

		this.on("view:removed", this.removeMediaListeners, this);
	},

	removeMediaListeners: function() {
		this.off("view:removed", this.removeMediaListeners, this);

		if (!this._started) this.video.removeEventListener("playing", this._onMediaPlayingOnce, false);
		this.removeListener(this.video, this.updatePlaybackEvents, this._updatePlaybackState);
		this.removeListener(this.video, this.updateBufferedEvents, this._updateBufferedValue);
		this.removeListener(this.video, this.updatePlayedEvents, this._updatePlayedValue);
		this.video.removeEventListener("ended", this._onMediaEnded, false);
		this.video.removeEventListener("error", this._onMediaError, true);
	},

	/* ---------------------------
	/* media event handlers
	/* --------------------------- */

	_onMediaError: function(ev) {
		this.removeMediaListeners();
		this.removeSelectionListeners();

		this._onMediaEnded(ev);
		this.content.classList.remove("ended");
		this.content.classList.remove("waiting");
		this.content.classList.remove("started");
		this._started = false;

		this.mediaState = "error";
	},

	_onMediaPlayingOnce: function(ev) {
		this.video.removeEventListener("playing", this._onMediaPlayingOnce, false);
		if (!this._started) {
			this._started = true;
			this.content.classList.add("started");
		}
	},

	_onMediaEnded: function(ev) {
		this.playbackRequested = false;
		if (this.video.webkitDisplayingFullscreen) {
			this.video.webkitExitFullscreen();
		}
		if (document.fullscreenElement === this.video) {
			this.video.exitFullscreen();
		}
	},

	_updatePlaybackState: function(ev) {
		var classList = this.content.classList;
		if (this.playbackRequested) {
			switch (ev.type) {
				case "pause":
				case "playing":
					classList.remove("waiting");
					break;
				case "waiting":
					classList.add("waiting");
					break;
			}
		} else {
			classList.remove("waiting");
		}
		classList.toggle("ended", this.video.ended);

		this._updatePlayedValue(ev);
	},

	_updatePlayedValue: function(ev) {
		this._currentTimeValue = this.video.currentTime;
		if (this.progressMeter) {
			this.progressMeter.valueTo(this._currentTimeValue, 0, "amount");
		}
	},

	_updateBufferedValue: function(ev) {
		var bRanges = this.video.buffered;
		if (bRanges.length > 0) {
			this._bufferedValue = bRanges.end(bRanges.length - 1);
			if (this.progressMeter && ((this.video.readyState == HTMLMediaElement.HAVE_ENOUGH_DATA) /*|| (this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA && this.video.networkState == HTMLMediaElement.NETWORK_LOADING)*/ )) {
				this.progressMeter.valueTo(this._bufferedValue, 300, "available");
				// this.progressMeter.valueTo(this._bufferedValue, Math.max(0, 1000 * (this._bufferedValue - (this.progressMeter.getValue("available") | 0))), "available");
			}
		}
	},

	/* ---------------------------
	/* fullscreen api
	/* --------------------------- */

	_onFullscreenToggle: function(ev) {
		// NOTE: Ignore if MouseEvent.button is 0 or undefined (0: left-button)
		if (!ev.defaultPrevented && !ev.button && this.model.selected) {
			// ev.preventDefault();
			try {
				if (document.hasOwnProperty("fullscreenElement") &&
					document.fullscreenElement !== this.video) {
					document.addEventListener(fullscreenChangeEvent, this._onFullscreenChange, false);
					this.video.requestFullscreen();
				} else
				if (this.video.webkitSupportsFullscreen && !this.video.webkitDisplayingFullscreen) {
					this.video.addEventListener("webkitbeginfullscreen", this._onFullscreenChange, false);
					this.video.webkitEnterFullScreen();
				}
			} catch (err) {
				this.video.controls = false;
				console.error(err);
			}
		}
	},

	_onFullscreenChange: function(ev) {
		switch (ev.type) {
			case fullscreenChangeEvent:
				// var isOwnFullscreen = Modernizr.prefixed("fullscreenElement", document) === this.video;
				var isOwnFullscreen = document.fullscreenElement === this.video;
				this.video.controls = isOwnFullscreen;
				if (!isOwnFullscreen) {
					document.removeEventListener(fullscreenChangeEvent, this._onFullscreenChange, false);
				}
				break;
			case "webkitbeginfullscreen":
				this.video.controls = true;
				this.video.removeEventListener("webkitbeginfullscreen", this._onFullscreenChange, false);
				this.video.addEventListener("webkitendfullscreen", this._onFullscreenChange, false);
				break;
			case "webkitendfullscreen":
				this.video.controls = false;
				this.video.removeEventListener("webkitendfullscreen", this._onFullscreenChange, false);
				break;
		}
	},

	/* ---------------------------
	/* event helpers
	/* --------------------------- */

	addListener: function(target, events, handler, useCapture) {
		(typeof events === "string") && (events = events.split(" "));
		for (var i = 0; i < events.length; i++) {
			target.addEventListener(events[i], handler, !!useCapture);
		}
	},

	removeListener: function(target, events, handler, useCapture) {
		(typeof events === "string") && (events = events.split(" "));
		for (var i = 0; i < events.length; i++) {
			target.removeEventListener(events[i], handler, !!useCapture);
		}
	},
});

/* ---------------------------
/* log to screen
/* --------------------------- */
if (DEBUG) {

	VideoRenderer = (function(VideoRenderer) {
		if (!VideoRenderer.LOG_TO_SCREEN) return VideoRenderer;

		/** @type {Function} */
		var Color = require("color");
		/** @type {module:underscore.strings/lpad} */
		var lpad = require("underscore.string/lpad");
		/** @type {module:underscore.strings/rpad} */
		var rpad = require("underscore.string/rpad");

		// var fullscreenEvents = [
		// 	fullscreenChangeEvent, fullscreenErrorEvent,
		// 	"webkitbeginfullscreen", "webkitendfullscreen",
		// ];

		var mediaEvents = require("utils/event/mediaEventsEnum");
		var updatePlaybackStateEvents, updateBufferedEvents, updatePlayedEvents;

		// updatePlaybackStateEvents = ["playing", "waiting", "ended", "pause", "seeking", "seeked"];
		// updateBufferedEvents = ["progress", "durationchange", "canplay", "play"];
		// updatePlayedEvents = ["playing", "timeupdate"];

		updatePlaybackStateEvents = [
			"loadstart",
			"progress",
			"suspend",
			"abort",
			"error",
			"emptied",
			"stalled",
		];
		updateBufferedEvents = [
			"loadedmetadata",
			"loadeddata",
			"canplay",
			"canplaythrough",
			"playing",
			"waiting",
			"seeking", // seeking changed to true
			"seeked", // seeking changed to false
			"ended", // ended is true
		];
		updatePlayedEvents = ["play", "pause"];

		// Exclude some events from log
		mediaEvents = _.without(mediaEvents, "resize", "error");
		// Make sure event subsets exist in the main set
		updatePlaybackStateEvents = _.intersection(mediaEvents, updatePlaybackStateEvents);
		updateBufferedEvents = _.intersection(mediaEvents, updateBufferedEvents);
		updatePlayedEvents = _.intersection(mediaEvents, updatePlayedEvents);

		var readyStateSymbols = _.invert(_.pick(HTMLMediaElement,
			function(val, key, obj) {
				return /^HAVE_/.test(key);
			}));
		var readyStateToString = function(el) {
			return readyStateSymbols[el.readyState] + "(" + el.readyState + ")";
		};

		var networkStateSymbols = _.invert(_.pick(HTMLMediaElement,
			function(val, key, obj) {
				return /^NETWORK_/.test(key);
			}));
		var networkStateToString = function(el) {
			return networkStateSymbols[el.networkState] + "(" + el.networkState + ")";
		};

		var mediaErrorSymbols = _.invert(MediaError);
		var mediaErrorToString = function(el) {
			return el.error ? mediaErrorSymbols[el.error.code] + "(" + el.error.code + ")" : "[MediaError null]";
		};

		var findRangeIndex = function(range, currTime) {
			for (var i = 0, ii = range.length; i < ii; i++) {
				if (range.start(i) <= currTime && currTime <= range.end(i)) {
					return i;
				}
			}
			return -1;
		};

		var formatVideoError = function(video) {
			return [
				mediaErrorToString(video),
				networkStateToString(video),
				readyStateToString(video),
			].join(" ");
		};

		var getVideoStatsCols = function() {
			return "0000.000 [Current/Total] [Seekable   ] [Buffered   ] networkState readyState      Playing";
			// return "0000.620 [t:  0.0  27.4] [s: 27.4 0/1] [b:  0.5 0/1] LOADING(2)   FUTURE_DATA(3)  :: (::)";
		}

		var formatVideoStats = function(video) {
			var currTime = video.currentTime,
				durTime = video.duration,
				bRanges = video.buffered,
				bRangeIdx,
				sRanges = video.seekable,
				sRangeIdx;

			bRangeIdx = findRangeIndex(bRanges, currTime);
			sRangeIdx = findRangeIndex(sRanges, currTime);
			return [
				"[t:" + lpad(currTime.toFixed(1), 5) +
					" " + lpad((!isNaN(durTime) ? durTime.toFixed(1) : "-"), 5) + "]",
				"[s:" + lpad((sRangeIdx >= 0 ? sRanges.end(sRangeIdx).toFixed(1) : "-"), 5) +
					" " + (sRangeIdx >= 0 ? sRangeIdx : "-") + "/" + sRanges.length + "]",
				"[b:" + lpad((bRangeIdx >= 0 ? bRanges.end(bRangeIdx).toFixed(1) : "-"), 5) +
					" " + (bRangeIdx >= 0 ? bRangeIdx : "-") + "/" + bRanges.length + "]",
				rpad(networkStateToString(video).substr(8), 12),
				rpad(readyStateToString(video).substr(5), 15),
				(video.ended ? ">:" : (video.paused ? "::" : ">>")),
			].join(" ");
		};

		return VideoRenderer.extend({

			/** @override */
			initialize: function() {
				VideoRenderer.prototype.initialize.apply(this, arguments);

				_.bindAll(this, "__handleMediaEvent");

				var fgColor = this.model.attr("color"),
					red = new Color("red"),
					blue = new Color("blue"),
					green = new Color("green");

				for (var i = 0; i < mediaEvents.length; i++) {
					var ev = mediaEvents[i];
					this.video.addEventListener(ev, this.__handleMediaEvent, false);

					var c = new Color(fgColor),
						cc = 1;
					if (updateBufferedEvents.indexOf(ev) != -1) c.mix(green, (cc /= 2));
					if (updatePlayedEvents.indexOf(ev) != -1) c.mix(red, (cc /= 2));
					if (updatePlaybackStateEvents.indexOf(ev) != -1) c.mix(blue, (cc /= 2));
					this.__logColors[ev] = c.rgbString();
				}
				this.video.addEventListener("error", this.__handleMediaEvent, true);
			},

			/** @override */
			remove: function() {
				VideoRenderer.prototype.remove.apply(this, arguments);
				for (var i = 0; i < mediaEvents.length; i++) {
					if (mediaEvents[i] == "error") continue;
					this.video.removeEventListener(mediaEvents[i], this.__handleMediaEvent, false);
				}
				this.video.removeEventListener("error", this.__handleMediaEvent, true);
			},

			/** @override */
			_onVisibilityChange: function(ev) {
				VideoRenderer.prototype._onVisibilityChange.apply(this, arguments);
				var stateVal = Modernizr.prefixed("visibilityState", document);
				this.__logEvent("visibilityState:" + stateVal, ev.type + ":" + stateVal);
			},

			/** @override */
			_onFullscreenChange: function(ev) {
				VideoRenderer.prototype._onFullscreenChange.apply(this, arguments);
				var logtype = (document.fullscreenElement === this.video ? "enter:" : "exit:") + ev.type;
				this.__logEvent("document.fullscreenElement: " + this.cid, logtype);
			},

			/** @override */
			_onFullscreenToggle: function(ev) {
				VideoRenderer.prototype._onFullscreenToggle.apply(this, arguments);
				if (!ev.defaultPrevented && this.model.selected) {
					this.__logEvent("fullscreen-toggle", ev.type);
				}
			},

			__handleMediaEvent: function(ev) {
				var evmsg; //, errmsg;
				// evmsg = formatVideoStats(this.video) + " " + rpad(this._lastPlaybackStates || "-", 9);
				evmsg = formatVideoStats(this.video);
				if (this.playbackRequested === true) {
					evmsg += " (>>)";
				} else if (this.playbackRequested === false) {
					evmsg += " (::)";
				} else {
					evmsg += " (--)";
				}
				this.__logEvent(evmsg, ev.type);
				if (ev.type === "error" || ev.type === "abort") {
					this.__logMessage(formatVideoError(this.video), ev.type);
				}
			},

			__logEvent: function(msg, logtype, color) {
				var logEntryEl = this.__logElement.lastElementChild;
				if ((logEntryEl && logEntryEl.getAttribute("data-logtype") == logtype) &&
					((logtype === "timeupdate") || (logtype === "progress"))) {
					var logRepeatVal = parseInt(logEntryEl.getAttribute("data-logrepeat"));
					logEntryEl.textContent = this.__getTStamp() + " " + msg;
					logEntryEl.setAttribute("data-logrepeat", isNaN(logRepeatVal) ? 2 : ++logRepeatVal);
				} else {
					this.__logMessage(msg, logtype, color);
				}
			},

			__getHeaderText: function() {
				return getVideoStatsCols();
			},
		});
	})(VideoRenderer);

}

module.exports = VideoRenderer;
}).call(this,true)

},{"./VideoRenderer.hbs":96,"app/control/Globals":34,"app/view/component/ProgressMeter":71,"app/view/render/PlayableRenderer":93,"color":"color","underscore":"underscore","underscore.string/lpad":28,"underscore.string/rpad":30,"utils/event/mediaEventsEnum":109,"utils/prefixedEvent":111}],98:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function";

  return "<div id=\"desc_b"
    + container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" class=\"content sizing mdown\">"
    + ((stack1 = ((helper = (helper = helpers.desc || (depth0 != null ? depth0.desc : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"desc","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</div>\n";
},"useData":true});

},{"hbsfy/runtime":21}],99:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function";

  return "<div id=\"desc_m"
    + container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" class=\"content sizing\"><p>"
    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</p>"
    + ((stack1 = ((helper = (helper = helpers.sub || (depth0 != null ? depth0.sub : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"sub","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</div>\n";
},"useData":true});

},{"hbsfy/runtime":21}],100:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"1":function(container,depth0,helpers,partials,data) {
    var helper;

  return "		<p><code>"
    + container.escapeExpression(((helper = (helper = helpers.infoSrc || (depth0 != null ? depth0.infoSrc : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(depth0 != null ? depth0 : {},{"name":"infoSrc","hash":{},"data":data}) : helper)))
    + "</code></p>\n";
},"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<div class=\"error-message color-fg\">\n	<p><strong>"
    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper)))
    + "</strong> <code>"
    + alias4(((helper = (helper = helpers.message || (depth0 != null ? depth0.message : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"message","hash":{},"data":data}) : helper)))
    + "</code></p>\n"
    + ((stack1 = helpers["if"].call(alias1,(depth0 != null ? depth0.infoSrc : depth0),{"name":"if","hash":{},"fn":container.program(1, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "</div>";
},"useData":true});

},{"hbsfy/runtime":21}],101:[function(require,module,exports){
// var Handlebars = require("handlebars")["default"];
var Handlebars = require("hbsfy/runtime");
/** @type {Function} */
var Color = require("color");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

// (function() {
var helpers = {
	/*
	/* Arithmetic helpers
	/*/
	add: function(value, addition) {
		return value + addition;
	},
	subtract: function(value, substraction) {
		return value - substraction;
	},
	divide: function(value, divisor) {
		return value / divisor;
	},
	multiply: function(value, multiplier) {
		return value * multiplier;
	},
	floor: function(value) {
		return Math.floor(value);
	},
	ceil: function(value) {
		return Math.ceil(value);
	},
	round: function(value) {
		return Math.round(value);
	},
	global: function(value) {
		return Globals[value];
	},

	/*
	/* Flow control helpers
	/*/
	is: function(a, b, opts) {
		return (a === b) ? opts.fn(this) : opts.inverse(this);
	},
	isnot: function(a, b, opts) {
		return (a !== b) ? opts.fn(this) : opts.inverse(this);
	},
	isany: function(value) {
		var i = 0,
			ii = arguments.length - 2,
			opts = arguments[ii + 1];
		do
			if (value === arguments[++i]) {
				return opts.fn(this);
			}
		while (i < ii);
		return opts.inverse(this);
	},
	contains: function(a, b, opts) {
		return (a.indexOf(b) !== -1) ? opts.fn(this) : opts.inverse(this);
	},
	ignore: function() {
		return "";
	},

	/*
	/* Color helpers
	/*/
	mix: function(colora, colorb, amount) {
		return new Color(colora).mix(new Color(colorb), amount).rgbString();
	},
	lighten: function(color, amount) {
		return new Color(color).lighten(amount).rgbString();
	},
	darken: function(color, amount) {
		return new Color(color).darken(amount).rgbString();
	},
	// colorFormat: function(color, fmt) {
	// 	switch (fmt) {
	// 		case "rgb":
	// 			return new Color(color).rgbString();
	// 		case "hsl":
	// 			return new Color(color).hslString();
	// 		case "hex": default:
	// 			return new Color(color).hexString();
	// 	}
	// },
};
for (var helper in helpers) {
	if (helpers.hasOwnProperty(helper)) {
		Handlebars.registerHelper(helper, helpers[helper]);
	}
}
// })();

// module.exports = Handlebars;

},{"app/control/Globals":34,"color":"color","hbsfy/runtime":21}],102:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Events = require("backbone").Events;


// var defaultOptions = {
// 	tick: 1,
// 	onstart: null,
// 	ontick: null,
// 	onpause: null,
// 	onstop: null,
// 	onend: null
// }
var idSeed = 0;

var Timer = function(options) {
	// if (!(this instanceof Timer)) {
	// 	return new Timer(options);
	// }
	this._id = idSeed++;
	// this._options = {};
	this._duration = 0;
	this._status = "initialized";
	this._start = 0;
	// this._measures = [];

	// for (var prop in defaultOptions) {
	// 	this._options[prop] = defaultOptions[prop];
	// }
	// this.options(options);
};

_.extend(Timer.prototype, Events, {

	start: function(duration) {
		if (!_.isNumber(duration) && !this._duration) {
			return this;
		}
		// duration && (duration *= 1000)
		if (this._timeout && this._status === "started") {
			return this;
		}
		var evName = (this._status === "stopped") ? "start" : "resume";
		this._duration = duration || this._duration;
		this._timeout = window.setTimeout(end.bind(this), this._duration);
		// if (typeof this._options.ontick === "function") {
		// 	this._interval = setInterval(function() {
		// 		this.trigger("tick", this.getDuration())
		// 	}.bind(this), +this._options.tick * 1000)
		// }
		this._start = _now();
		this._status = "started";
		this.trigger(evName, this.getDuration());
		return this;
	},

	pause: function() {
		if (this._status !== "started") {
			return this;
		}
		this._duration -= (_now() - this._start);
		clear.call(this, false);
		this._status = "paused";
		this.trigger("pause", this.getDuration());
		return this;
	},

	stop: function() {
		if (!/started|paused/.test(this._status)) {
			return this;
		}
		clear.call(this, true);
		this._status = "stopped";
		this.trigger("stop");
		return this;
	},

	getDuration: function() {
		if (this._status === "started") {
			return this._duration - (_now() - this._start);
		}
		if (this._status === "paused") {
			return this._duration;
		}
		return 0;
	},

	getStatus: function() {
		return this._status;
	},
});

var _now = window.performance ?
	window.performance.now.bind(window.performance) :
	Date.now.bind(Date);

function end() {
	clear.call(this);
	this._status = "stopped";
	this.trigger("end");
}

function clear(clearDuration) {
	window.clearTimeout(this._timeout);
	// window.clearInterval(this._interval);
	if (clearDuration === true) {
		this._duration = 0;
	}
}

Object.defineProperties(Timer.prototype, {
	duration: {
		enumerable: true,
		get: function() {
			return this.getDuration();
		}
	},
	status: {
		enumerable: true,
		get: function() {
			return this.getStatus();
		}
	}
});

Object.defineProperties(Timer, {
	STOPPED: {
		enumerable: true,
		value: "stopped"
	},
	STARTED: {
		enumerable: true,
		value: "started"
	},
	PAUSED: {
		enumerable: true,
		value: "paused"
	},
});

module.exports = Timer;

},{"backbone":"backbone","underscore":"underscore"}],103:[function(require,module,exports){
/* -------------------------------
/* Imports
/* ------------------------------- */


/** @type {module:underscore} */
var _ = require("underscore");

/** @type {module:utils/TransformItem} */
var TransformItem = require("./TransformItem");

var idSeed = 0;
var cidSeed = 100;
var slice = Array.prototype.slice;

/**
 * @constructor
 * @type {module:app/helper/TransformHelper}
 */
function TransformHelper() {
	this.id = idSeed++;
	this._items = [];
	this._itemsById = {};
}

TransformHelper.prototype = Object.create({

	/* -------------------------------
	/* Private
	/* ------------------------------- */

	_get: function(el) {
		if (this.has(el)) {
			return this._itemsById[el.eid];
		} else {
			return this._add(el);
		}
	},

	_add: function(el) {
		var item, id;
		// id = el.eid || el.cid || el.id;
		// if (!id || (this._itemsById[id] && (this._itemsById[id].el !== el))) {
		// 	id = "elt" + cidSeed++;
		// }
		// if (!el.eid) {
		// 	id = el.eid || el.cid || ("elt" + cidSeed++);
		// }
		id = el.eid || el.cid || ("elt" + cidSeed++);
		item = new TransformItem(el, id);
		this._itemsById[id] = item;
		this._items.push(item);
		return item;
	},

	_remove: function(el) {
		if (this.has(el)) {
			var o = this._itemsById[el.eid];
			this._items.splice(this._items.indexOf(o), 1);
			o.destroy();
			delete this._itemsById[el.eid];
		}
	},

	_invoke: function(funcName, args, startIndex) {
		var i, ii, j, jj, el, o, rr;
		var funcArgs = null;
		if (startIndex !== void 0) {
			funcArgs = slice.call(args, 0, startIndex);
		} else {
			startIndex = 0;
		}
		for (i = startIndex, ii = args.length, rr = []; i < ii; ++i) {
			el = args[i];
			// iterate on NodeList, Arguments, Array...
			if (el.length) {
				for (j = 0, jj = el.length; j < jj; ++j) {
					o = this._get(el[j]);
					rr.push(o[funcName].apply(o, funcArgs));
				}
			} else {
				o = this._get(el);
				rr.push(o[funcName].apply(o, funcArgs));
			}
		}
		return rr;
	},

	/* -------------------------------
	/* Public
	/* ------------------------------- */

	has: function(el) {
		return el.eid && this._itemsById[el.eid] !== void 0;
	},

	getItems: function() {
		var i, j, el, ret = [];
		for (i = 0; i < arguments.length; ++i) {
			el = arguments[i];
			if (el.length) {
				for (j = 0; j < el.length; ++j) {
					ret.push(this._get(el[j]));
				}
			} else {
				ret.push(this._get(el));
			}
		}
		return ret;
	},

	get: function(el) {
		return this._get(el);
	},

	add: function() {
		var i, j, el;
		for (i = 0; i < arguments.length; ++i) {
			el = arguments[i];
			if (el.length) {
				for (j = 0; j < el.length; ++j) {
					this._get(el[j]);
				}
			} else {
				this._get(el);
			}
		}
	},

	remove: function() {
		var i, j, el;
		for (i = 0; i < arguments.length; ++i) {
			el = arguments[i];
			if (el.length) {
				for (j = 0; j < el.length; ++j) {
					this._remove(el[j]);
				}
			} else {
				this._remove(el);
			}
		}
	},

	/* --------------------------------
	/* public
	/* -------------------------------- */

	/* public: single arg
	/* - - - - - - - - - - - - - - - - */

	hasOffset: function(el) {
		return this.has(el) ? this._itemsById[el.eid].hasOffset : (void 0);
	},

	/* public: capture
	/* - - - - - - - - - - - - - - - - */

	capture: function() {
		this._invoke("capture", arguments);
	},
	captureAll: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].capture();
		}
	},

	clearCapture: function() {
		this._invoke("clearCapture", arguments);
	},
	clearAllCaptures: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].clearCapture();
		}
	},

	/* public: offset
	/* - - - - - - - - - - - - - - - - */
	offset: function(x, y) {
		this._invoke("offset", arguments, 2);
	},
	offsetAll: function(x, y) {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].offset(x, y);
		}
	},

	clearOffset: function() {
		this._invoke("clearOffset", arguments);
	},
	clearAllOffsets: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].clearOffset();
		}
	},

	/* public: transitions
	/* - - - - - - - - - - - - - - - - */

	runTransition: function(transition) {
		this._invoke("runTransition", arguments, 1);
	},
	runAllTransitions: function(transition) {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].runTransition(transition);
		}
	},

	clearTransition: function() {
		this._invoke("clearTransition", arguments);
	},
	clearAllTransitions: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].clearTransition();
		}
	},

	stopTransition: function() {
		this._invoke("stopTransition", arguments);
	},
	stopAllTransitions: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].stopTransition();
		}
	},

	whenTransitionEnds: function() {
		var res = this._invoke("whenTransitionEnds", arguments);
		return res.length != 0 ?
			Promise.all(res) :
			Promise.resolve(null);
	},
	whenAllTransitionsEnd: function() {
		return (this._items.length != 0) ? Promise.all(this._items.map(function(o) {
			return o.whenTransitionEnds();
		})) : Promise.resolve(null);
	},

	promise: function() {
		return arguments.length == 0 ?
			this.whenAllTransitionsEnd() :
			this.whenTransitionEnds.call(this, arguments);
	},

	/* -------------------------------
	/* validation
	/* ------------------------------- */

	validate: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].validate();
		}
	},
}, {
	items: {
		get: function() {
			return this._items;
		}
	}
});

module.exports = TransformHelper;

},{"./TransformItem":104,"underscore":"underscore"}],104:[function(require,module,exports){
/* -------------------------------
 * Imports
 * ------------------------------- */

/** @type {module:underscore} */
var _ = require("underscore");

/** @type {module:utils/prefixedProperty} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {module:utils/prefixedStyleName} */
var prefixedStyleName = require("utils/prefixedStyleName");
/** @type {module:utils/prefixedEvent} */
var prefixedEvent = require("utils/prefixedEvent");

/** @type {String} */
var transitionEnd = prefixedEvent("transitionend"); //require("utils/event/transitionEnd");
// /** @type {Function} */// var slice = Array.prototype.slice;

// /** @type {module:utils/debug/traceElement} */
// var traceElt = require("./debug/traceElement");
// var traceEltCache = {};
// var log = function() {
// 	var logFn = "log";
// 	var args = slice.apply(arguments);
// 	switch(args[0]) {
// 		case "error":
// 		case "warn":
// 		case "info":
// 			logFn = args.shift();
// 			break;
// 		default:
// 			// break;
// 			return;
// 	}
// 	var el, txId;
// 	if ((el = args[0]) && (txId = el.eid)) {
// 		args[0] = traceEltCache[txId] || (traceEltCache[txId] = el);
// 	}
// 	args[0] = "\t" + args[0];
// 	console[logFn].apply(console, args);
// };

/* jshint -W079 */
// var console = (function(target) {
// 	return Object.getOwnPropertyNames(target).reduce(function(proxy, prop) {
// 		if ((typeof target[prop]) == "function") {
// 			switch (prop) {
// 				case "error":
// 				case "warn":
// 				case "info":
// 					proxy[prop] = function () {
// 						var args = slice.apply(arguments);
// 						if (typeof args[0] == "string") {
// 							args[0] = prop + "::" + args[0];
// 						}
// 						return target[prop].apply(target, args);
// 					};
// 					break;
// 				case "log":
// 					proxy[prop] = function() {};
// 					break;
// 				default:
// 					proxy[prop] = target[prop].bind(target);
// 					break;
// 			}
// 		} else {
// 			Object.defineProperty(proxy, prop, {
// 				get: function() { return target[prop]; },
// 				set: function(val) { target[prop] = val; }
// 			});
// 		}
// 		return proxy;
// 	}, {});
// })(window.console);
/* jshint +W079 */

/* -------------------------------
/* Private static
/* ------------------------------- */

var NO_TRANSITION = "none 0s step-start 0s";


// var translateTemplate = function(o) {
// 	// return "translate(" + o._renderedX + "px, " + o._renderedY + "px)";
// 	// return "translate3d(" + o._renderedX + "px, " + o._renderedY + "px, 0px)";
// };

var translateTemplate = (function() {
	var fn = require("app/control/Globals").TRANSLATE_TEMPLATE;
	return function(o) {
		return fn(o._renderedX, o._renderedY);
	};
}());

var transitionTemplate = function(o) {
	return o.property + " " + o.duration / 1000 + "s " + o.easing + " " + o.delay / 1000 + "s";
};

var UNSET_TRANSITION = {
	name: "unset",
	className: "tx-unset",
	property: "none",
	easing: "ease",
	delay: 0,
	duration: 0,
	cssText: "unset",
};

// var transitionTemplate = _.template("<%= property %> <% duration/1000 %>s <%= easing %> <% delay/1000 %>s");
// var NO_TRANSITION = "all 0.001s step-start 0.001s";

var propDefaults = {
	"opacity": "1",
	"visibility": "visible",
	"transform": "matrix(1, 0, 0, 1, 0, 0)",
	"transformStyle": "",
	"transition": "",
	// "willChange": "",
	// "transitionDuration": "0s",
	// "transitionDelay": "0s",
	// "transitionProperty": "none",
	// "transitionTimingFunction": "ease"
};
var propKeys = Object.keys(propDefaults);
var propNames = propKeys.reduce(function(obj, propName) {
	obj[propName] = prefixedProperty(propName);
	return obj;
}, {});

/** @type {module:utils/strings/camelToDashed} */
var camelToDashed = require("utils/strings/camelToDashed");
var styleNames = propKeys.map(camelToDashed).reduce(function(obj, propName) {
	obj[propName] = prefixedStyleName(propName);
	return obj;
}, {});

var resolveAll = function(pp, result) {
	if (pp.length != 0) {
		pp.forEach(function(p, i, a) {
			p.resolve(result);
			a[i] = null;
		});
		pp.length = 0;
	}
	return pp;
};

var rejectAll = function(pp, reason) {
	if (pp.length != 0) {
		pp.forEach(function(p, i, a) {
			p.reject(reason);
			a[i] = null;
		});
		pp.length = 0;
	}
	return pp;
};

/* -------------------------------
 * TransformItem
 * ------------------------------- */

/**
 * @constructor
 */
function TransformItem(el, id) {
	_.bindAll(this, "_onTransitionEnd");

	this.el = el;
	this.id = id;
	this.el.eid = id;
	this.el.addEventListener(transitionEnd, this._onTransitionEnd, false);

	this._captureInvalid = false;
	this._capturedChanged = false;
	this._capturedX = null;
	this._capturedY = null;
	this._currCapture = {};
	this._lastCapture = {};

	this._hasOffset = false;
	this._offsetInvalid = false;
	this._offsetX = null;
	this._offsetY = null;

	this._renderedX = null;
	this._renderedY = null;

	this._hasTransition = false;
	this._transitionInvalid = false;
	this._transitionRunning = false;
	this._transition = _.extend({}, UNSET_TRANSITION); //{};

	this._promises = [];
	this._pendingPromises = [];
}

TransformItem.prototype = Object.create({

	/* -------------------------------
	/* Public
	/* ------------------------------- */

	/* destroy
	/* - - - - - - - - - - - - - - - - */
	destroy: function() {
		// NOTE: style property may have been modified; clearOffset(element) should
		// be called explicitly if clean up is required.
		this.el.removeEventListener(transitionEnd, this._onTransitionEnd, false);
		rejectAll(this._pendingPromises, this.el);
		rejectAll(this._promises, this.el);
		// delete this.el.eid;
	},

	/* capture
	/* - - - - - - - - - - - - - - - - */
	capture: function() {
		// console.log("tx[%s]::capture", this.id);
		this._validateCapture();
		return this;
	},

	clearCapture: function() {
		// console.log("tx[%s]::clearCapture", this.id);
		// this._hasOffset = false;
		this._captureInvalid = true;
		return this;
	},

	/* offset/clear
	/* - - - - - - - - - - - - - - - - */
	offset: function(x, y) {
		// console.log("tx[%s]::offset", this.id);

		this._hasOffset = true;
		this._offsetInvalid = true;
		this._offsetX = x || 0;
		this._offsetY = y || 0;
		// if (this.immediate) this._validateOffset();
		return this;
	},

	clearOffset: function() {
		if (this._hasOffset) {
			// console.log("tx[%s]::clearOffset", this.id);

			this._hasOffset = false;
			this._offsetInvalid = true;
			this._offsetX = null;
			this._offsetY = null;
			// if (this.immediate) this._validateOffset();
		} else {
			// console.log("tx[%s]::clearOffset no offset to clear", this.id);
		}
		return this;
	},

	/* transitions
	/* - - - - - - - - - - - - - - - - */
	runTransition: function(transition) {
		if (!transition) { // || (transition.duration + transition.delay) == 0) {
			return this.clearTransition();
		}
		var lastValue = this._transitionValue;
		var lastName = this._transition.name;
		this._transition.property = styleNames["transform"];
		this._transition = _.extend(this._transition, transition);
		this._transitionValue = transitionTemplate(this._transition);

		if (this._transitionInvalid) {
			console.warn("tx[%s]::runTransition set over (%s:'%s' => %s:'%s')", this.id,
				lastName, lastValue, this._transition.name, this._transitionValue);
		}

		this._hasTransition = true;
		this._transitionInvalid = true;
		// if (this.immediate) this._validateTransition();
		return this;
	},

	clearTransition: function() {
		this._transition = _.extend(this._transition, UNSET_TRANSITION);
		this._transitionValue = NO_TRANSITION;

		this._hasTransition = false;
		this._transitionInvalid = true;
		// if (this.immediate) this._validateTransition();
		return this;
	},

	stopTransition: function() {
		// this._transition.name = "[none]";
		// this._transition.property = "none";
		this._transition = _.extend(this._transition, UNSET_TRANSITION);
		this._transitionValue = NO_TRANSITION;

		this._hasTransition = false;
		this._transitionInvalid = true;
		// if (this.immediate) this._validateTransition();
		return this;
	},

	whenTransitionEnds: function() {
		var d, p, pp;
		if (this._transitionInvalid || this._transitionRunning) {
			d = {};
			p = new Promise(function(resolve, reject) {
				d.resolve = resolve;
				d.reject = reject;
			});
			pp = this._transitionInvalid ? this._pendingPromises : this._promises;
			pp.push(d);
		} else {
			p = Promise.resolve(this.el);
		}
		return p;
	},

	/* validation
	/* - - - - - - - - - - - - - - - - */
	validate: function() {
		// this.el.removeEventListener(transitionEnd, this._onTransitionEnd, false);
		this._ignoreEvent = true;

		if (this._captureInvalid) {
			var lastX = (this._renderedX !== null ? this._renderedX : this._capturedX),
				lastY = (this._renderedY !== null ? this._renderedY : this._capturedY);

			// this._validateTransition();
			this._validateCapture();
			this._validateOffset();

			var currX = (this._renderedX !== null ? this._renderedX : this._capturedX),
				currY = (this._renderedY !== null ? this._renderedY : this._capturedY);

			if (lastX === currX && lastY === currY) {
				this._hasTransition && console.warn("tx[%s]::validate unchanged: last:[%i,%i] curr:[%i,%i]", this.el.id || this.id, lastX, lastY, currX, currY);
				// console.info("tx[%s]::validate unchanged: last:[%f,%f] curr:[%f,%f] render:[%f,%f] captured[%f,%f]", this.el.id || this.id, lastX, lastY, currX, currY, this._renderedX, this._renderedY, this._capturedX, this._capturedY);
				this.clearTransition();
				// this._validateTransition();
			}
			this._validateTransition();
		} else {
			// this._validateCapture();
			this._validateTransition();
			this._validateOffset();
		}

		// this.el.addEventListener(transitionEnd, this._onTransitionEnd, false);
		this._ignoreEvent = false;

		// if (this._capturedChanged) {
		// 	console.error("tx[%s]::validate capture changed: [%f,%f]", this.id, this._capturedX, this._capturedY);
		// }
		this._capturedChanged = false;
		return this;
	},

	/* -------------------------------
	/* Private
	/* ------------------------------- */

	_validateCapture: function() {
		if (!this._captureInvalid) {
			return;
		}
		// var computed, capturedValues;
		var transformValue = null;

		if (this._hasOffset && !this._offsetInvalid) {
			// this is an explicit call to capture() instead of a subcall from _validateOffset()
			transformValue = this._getCSSProp("transform");
			if (transformValue === "") {
				console.error("tx[%s]::_capture valid offset (%i,$i) but transformValue=\"\"", this.id, this._offsetX, this._offsetY);
			}
			this._removeCSSProp("transform");
		}

		// NOTE: reusing object, all props will be overwritten
		this._lastCapture = this._currCapture;
		this._currCapture = this._getComputedCSSProps();

		if (this._currCapture.transform !== this._lastCapture.transform) {
			var m, mm; //, ret = {};
			mm = this._currCapture.transform.match(/(matrix|matrix3d)\(([^\)]+)\)/);
			if (mm) {
				m = mm[2].split(",");
				if (mm[1] === "matrix") {
					this._capturedX = parseFloat(m[4]);
					this._capturedY = parseFloat(m[5]);
				} else {
					this._capturedX = parseFloat(m[12]);
					this._capturedY = parseFloat(m[13]);
				}
			} else {
				this._capturedX = 0;
				this._capturedY = 0;
			}
			this._capturedChanged = true;
		}
		if (transformValue !== null) {
			console.log("tx[%s]::_capture reapplying '%s'", this.id, transformValue);
			this._setCSSProp("transform", transformValue);
		}
		this._captureInvalid = false;
	},

	_validateOffset: function() {
		if (this._offsetInvalid) {
			// this._validateCapture();
			this._offsetInvalid = false;
			if (this._hasOffset) {
				var tx = this._offsetX + this._capturedX;
				var ty = this._offsetY + this._capturedY;
				if (tx !== this._renderedX || ty !== this._renderedY) {
					this._renderedX = tx;
					this._renderedY = ty;
					this._setCSSProp("transform", translateTemplate(this));
				}
			} else {
				this._renderedX = null;
				this._renderedY = null;
				this._removeCSSProp("transform");
			}
		}
	},

	_validateTransition: function() {
		if (this._transitionInvalid) {
			// this._validateCapture();
			this._transitionInvalid = false;

			// save promises made while invalid
			var reject = this._promises;
			// prepare _promises and push in new ones
			this._promises = this._pendingPromises;
			// whatever still here is to be rejected. reuse array
			this._pendingPromises = rejectAll(reject, this.el);

			this._transitionRunning = this._hasTransition;
			this._setCSSProp("transition", this._transitionValue);

			if (!this._hasTransition) {
				// no transition, resolve now
				resolveAll(this._promises, this.el);
			}
		}
	},

	_onTransitionEnd: function(ev) {
		if (this._ignoreEvent) {
			return;
		}
		if (this._transitionRunning && (this.el === ev.target) &&
			(this._transition.property == ev.propertyName)) {
			this._hasTransition = false;
			this._transitionRunning = false;
			this._removeCSSProp("transition");
			resolveAll(this._promises, this.el);
		}
	},

	/* -------------------------------
	/* CSS
	/* ------------------------------- */

	_getCSSProp: function(prop) {
		return this.el.style[propNames[prop]];
		// return this.el.style[prefixedProperty(prop)];
		// return this.el.style.getPropertyValue(styleNames[prop]);
	},

	_setCSSProp: function(prop, value) {
		if (prop === "transition" && value == NO_TRANSITION) {
			value = "";
		}
		if (value === null || value === void 0 || value === "") {
			this._removeCSSProp(prop);
		} else {
			this.el.style[propNames[prop]] = value;
			// this.el.style.setProperty(styleNames[prop], value);
		}
	},

	_removeCSSProp: function(prop) {
		this.el.style[propNames[prop]] = "";
		// this.el.style.removeProperty(styleNames[prop]);
	},

	_getComputedCSSProps: function() {
		var values = {};
		var computed = window.getComputedStyle(this.el);
		for (var p in propNames) {
			values[p] = computed[propNames[p]];
		}
		return values;
	},
}, {
	transition: {
		get: function() {
			return this._transition;
		}
	},
	hasTransition: {
		get: function() {
			return this._hasTransition;
		}
	},
	capturedChanged: {
		get: function() {
			return this._capturedChanged;
		}
	},
	capturedX: {
		get: function() {
			return this._capturedX;
		}
	},
	capturedY: {
		get: function() {
			return this._capturedY;
		}
	},

	hasOffset: {
		get: function() {
			return this._hasOffset;
		}
	},
	offsetX: {
		get: function() {
			return this._offsetX;
		}
	},
	offsetY: {
		get: function() {
			return this._offsetY;
		}
	},
});

module.exports = TransformItem;
},{"app/control/Globals":34,"underscore":"underscore","utils/prefixedEvent":111,"utils/prefixedProperty":112,"utils/prefixedStyleName":113,"utils/strings/camelToDashed":116}],105:[function(require,module,exports){
var PI2 = Math.PI * 2;

var splice = Array.prototype.splice;
// var concat = Array.prototype.concat;

var setStyle = function(ctx, s) {
	if (typeof s != "object") return;
	for (var p in s) {
		switch (typeof ctx[p]) {
			case "undefined":
				break;
			case "function":
				if (Array.isArray(s[p])) ctx[p].apply(ctx, s[p]);
				else ctx[p].call(ctx, s[p]);
				break;
			default:
				ctx[p] = s[p];
		}
	}
};

var _drawShape = function(fn, s, ctx) {
	ctx.save();
	if (s) setStyle(ctx, s);
	fn.apply(null, splice.call(arguments, 2));
	if (ctx.lineWidth !== "transparent") ctx.stroke();
	if (ctx.fillStyle !== "transparent") ctx.fill();
	ctx.restore();
};

module.exports = {
	setStyle: setStyle,

	vGuide: function(ctx, x) {
		ctx.beginPath();
		ctx.moveTo(x, 0);
		ctx.lineTo(x, ctx.canvas.height);
	},
	drawVGuide: function(ctx, s, x) {
		_drawShape(this.vGuide, s, ctx, x);
	},

	hGuide: function(ctx, y) {
		ctx.beginPath();
		ctx.moveTo(0, y);
		ctx.lineTo(ctx.canvas.width, y);
	},
	drawHGuide: function(ctx, s, y) {
		_drawShape(this.hGuide, s, ctx, y);
	},

	crosshair: function(ctx, x, y, r) {
		ctx.save();
		ctx.translate(x, y);
		ctx.rotate(Math.PI / 4);
		ctx.beginPath();
		ctx.moveTo(0, -r);
		ctx.lineTo(0, r);
		ctx.moveTo(-r, 0);
		ctx.lineTo(r, 0);
		ctx.restore();
	},
	drawCrosshair: function(ctx, s, x, y, r) {
		_drawShape(this.crosshair, s, ctx, x, y, r);
	},

	circle: function(ctx, x, y, r) {
		ctx.beginPath();
		ctx.arc(x, y, r, 0, PI2);
	},
	drawCircle: function(ctx, s, x, y, r) {
		_drawShape(this.circle, s, ctx, x, y, r);
	},

	square: function(ctx, x, y, r) {
		r = Math.floor(r / 2) * 2;
		ctx.beginPath();
		ctx.rect(x - r, y - r, r * 2, r * 2);
	},
	drawSquare: function(ctx, s, x, y, r) {
		_drawShape(this.square, s, ctx, x, y, r);
	},

	arrowhead: function(ctx, x, y, r, t) {
		ctx.save();
		ctx.translate(x, y);
		ctx.rotate(t); // - Math.PI * 0.5);
		ctx.translate(r * 0.5, 0);
		ctx.beginPath();
		ctx.moveTo(0, 0);
		// ctx.lineTo(-r, r * Math.SQRT1_2);
		// ctx.lineTo(-r, -r * Math.SQRT1_2);
		ctx.lineTo(-r * Math.SQRT2, r * Math.SQRT1_2);
		ctx.arcTo(0, 0, -r * Math.SQRT2, -r * Math.SQRT1_2, r);
		// ctx.quadraticCurveTo(0, 0, -r * Math.SQRT2, -r * Math.SQRT1_2);
		ctx.lineTo(0, 0);
		ctx.closePath();
		ctx.restore();
	},
	drawArrowhead: function(ctx, s, x, y, r, t) {
		_drawShape(this.arrowhead, s, ctx, x, y, r, t);
	},

	rect: function(ctx, a1, a2, a3, a4) {

		ctx.beginPath();
		if (isNaN(a1)) {
			ctx.rect(a1.left, a1.top, a1.width, a1.height);
		} else {
			ctx.rect(a1, a2, a3, a4);
		}
	},
	drawRect: function(ctx, s, a1, a2, a3, a4) {
		_drawShape(this.rect, s, ctx, a1, a2, a3, a4);
	},
};
},{}],106:[function(require,module,exports){
/**
 * @module utils/canvas/calcArcHConnector
 */

module.exports = function(x1, y1, r1, x2, y2, r2, ro) {
	var qx = x2 > x1 ? 1 : -1;
	var qy = y2 > y1 ? 1 : -1;
	var dy = Math.abs(y2 - y1);
	var dx = Math.abs(x2 - x1);
	var rr = r1 + r2;
	var tx1, tx2, c, tx, ty;

	if (dy < 1) {
		// points are aligned horizontally, no arcs needed
		tx1 = 0;
		tx2 = dx
		// return [x1, x2];
	}

	if (dy >= rr && dx >= rr) {
		// arcs fit horizontally:
		// second circle center is r1+r2, tangent intersect at x=r1
		c = rr;
		tx1 = r1;
		tx2 = r1;
	} else {
		// arcs overlap horizontally:
		// find second circle center
		c = Math.sqrt(dy * r2 * 2 + dy * r1 * 2 - dy * dy);

		// circles tangent point
		tx = (c * r1) / rr;
		ty = (dy * r1) / rr;

		if (r1 < ty || c > dx) {
			return;
		}

		// tangent perpendicular slope
		var slope = (rr - dy) / c;
		// tangent intersections
		tx1 = tx - (ty * slope);
		tx2 = (dy * slope) + tx1;

		/*
		// circle centers
		var ccx1, ccy1, ccx2, ccy2;
		ccx1 = 0;
		ccy1 = r1;
		ccx2 = c;
		ccy2 = dy - r2;
		// tangent perpendicular slope
		var slope = (ccy1 - ccy2) / (ccx2 - ccx1);
		var xSec = tx - (ty * slope);
		// tangent intersections
		tx1 = xSec;
		tx2 = (dy * slope) + xSec;
		*/
	}

	// offset arcTo's in x-axis
	if (ro > 0) {
		if (ro > 1) {
			ro = Math.min(dx - rr, ro);
		} else {
			ro *= dx - rr;
		}
		tx1 += ro;
		tx2 += ro;
	}

	return [tx1 * qx + x1, tx2 * qx + x1, tx1, tx2];
};

/*
var drawArcConnector = function(ctx, x1, y1, x2, y2, r) {
	var dx, dy, hx, hy, gx, gy;

	hx = 0;
	hy = 0;
	gx = (x1 + x2) / 2;
	gy = (y1 + y2) / 2;
	dx = Math.abs(x1 - gx);
	dy = Math.abs(y1 - gy);

	if (dx < r && dy < r) {
		r = Math.min(dx * Math.SQRT1_2, dy * Math.SQRT1_2);
	} else {
		if (dx < r) {
			hy = Math.acos(dx / r) * r * 0.5;
			if (y1 > y2) hy *= -1;
		}
		if (dy < r) {
			hx = Math.acos(dy / r) * r * 0.5;
			if (x1 > x2) hx *= -1;
		}
	}
	ctx.arcTo(gx - hx, y1, gx + hx, y2, r);
	ctx.arcTo(gx + hx, y2, x2, y2, r);
};

var drawArcConnector2 = function(ctx, x1, y1, x2, y2, r) {
	var dx, dy, hx, hy, cx1, cx2;

	hx = 0;
	hy = 0;
	dx = Math.abs(x2 - x1) / 2;
	dy = Math.abs(y1 - y2) / 2;

	if (dx < r && dy < r) {
		r = Math.min(dx * Math.SQRT1_2, dy * Math.SQRT1_2);
	} else {
		if (dx < r) {
			hy = Math.acos(dx / r) * r;
		}
		if (dy < r) {
			hx = Math.acos(dy / r) * r;
		}
	}
	cx1 = x1 + dx;
	cx2 = x2 - (dx - hx / 2);
	ctx.arcTo(cx1, y1, cx2, y2, r);
	ctx.arcTo(cx2, y2, x2, y2, r);
};

var drawArcConnector1 = function(ctx, x1, y1, x2, y2, r) {
	var dx, dy, cx;

	dx = Math.abs(x2 - x1) / 2;
	dy = Math.abs(y1 - y2) / 2;
	r = Math.min(r, dy * Math.SQRT1_2);
	if (x1 < x2) {
		cx = x1 + dx + r;
	} else {
		cx = x2 - dx - r;
	}
	// cx = (x2 + x1) / 2;
	// cx += x1 < x2 ? r : -r;

	ctx.arcTo(cx, y1, cx, y2, r);
	ctx.arcTo(cx, y2, x2, y2, r);
};
*/

},{}],107:[function(require,module,exports){
(function (DEBUG){
/* global HTMLElement, CSSStyleDeclaration */

// var parseSize = require("./parseSize");

var CSS_BOX_PROPS = [
	"boxSizing", "position", "objectFit"
];
var CSS_EDGE_PROPS = [
	"marginTop", "marginBottom", "marginLeft", "marginRight",
	"borderTopWidth", "borderBottomWidth", "borderLeftWidth", "borderRightWidth",
	"paddingTop", "paddingBottom", "paddingLeft", "paddingRight",
];
var CSS_POS_PROPS = ["top", "bottom", "left", "right"];
var CSS_SIZE_PROPS = ["width", "height", "minWidth", "minHeight", "maxWidth", "maxHeight"];
var CSS_ALL_PROPS = CSS_EDGE_PROPS.concat(CSS_SIZE_PROPS, CSS_POS_PROPS);

// var COMPUTED_PROPS = [
// 	"clientLeft", "clientTop", "clientWidth", "clientHeight",
// 	"offsetLeft", "offsetTop", "offsetWidth", "offsetHeight"
// ];
// var o = _.pick(element, function(val) {
// 	return /^(offset|client)(Left|Top|Width|Height)/.test(val);
// });

var cssDimensionRE = /^(-?[\d\.]+)(px|em|rem)$/;
// var cssDimRe = /^([-\.0-9]+)([rem]+)$/;

module.exports = function(s, m, includeSizePos) {
	if (s instanceof HTMLElement) {
		s = getComputedStyle(s);
	}
	if (DEBUG) {
		if (!(s instanceof CSSStyleDeclaration)) {
			throw new Error("Not a CSSStyleDeclaration nor HTMLElement");
		}
	}
	var v, p, i, ii, emPx, remPx;
	m || (m = {});

	emPx = m.fontSize = parseFloat(s.fontSize);

	for (i = 0, ii = CSS_BOX_PROPS.length; i < ii; i++) {
		p = CSS_BOX_PROPS[i];
		if (p in s) {
			m[p] = s[p];
		}
	}
	var cssProps = includeSizePos ? CSS_EDGE_PROPS : CSS_ALL_PROPS;
	for (i = 0, ii = cssProps.length; i < ii; i++) {
		p = cssProps[i];
		m["_" + p] = s[p];
		if (s[p] && (v = cssDimensionRE.exec(s[p]))) {
			if (v[2] === "px") {
				m[p] = parseFloat(v[1]);
			} else if (v[2] === "em") {
				m[p] = parseFloat(v[1]) * emPx;
			} else if (v[2] === "rem") {
				remPx || (remPx = parseFloat(getComputedStyle(document.documentElement).fontSize));
				m[p] = parseFloat(v[1]) * remPx;
			} else {
				console.warn("Ignoring value", p, v[1], v[2]);
				m[p] = null;
			}
		} // else {
		//	console.warn("Ignoring unitless value", p, v);
		//}
	}
	return m;
};

}).call(this,true)

},{}],108:[function(require,module,exports){
/**
 * @param {number} i current iteration
 * @param {number} s start value
 * @param {number} d change in value
 * @param {number} t total iterations
 * @return {number}
 */
var linear = function(i, s, d, t) {
	return d * i / t + s;
};

module.exports = linear;

},{}],109:[function(require,module,exports){
/* https://html.spec.whatwg.org/multipage/media.html#event-media-canplay
 */
module.exports = [
	// networkState
	"loadstart",
	"progress",
	"suspend",
	"abort",
	"error",
	"emptied",
	"stalled",
	// readyState
	"loadedmetadata",
	"loadeddata",
	"canplay",
	"canplaythrough",
	"playing",
	"waiting",
	//
	"seeking", // seeking changed to true
	"seeked", // seeking changed to false
	"ended", // ended is true
	//
	"durationchange", // duration updated
	"timeupdate", // currentTime updated
	"play", // paused is false
	"pause", // paused is false
	"paused", // ??
	"ratechange",
	//
	"resize",
	"volumechange",
];
},{}],110:[function(require,module,exports){
/**
 * @module app/view/component/GraphView
 */

// /** @type {module:underscore} */
// var _ = require("underscore");

module.exports = function(rect, dx, dy) {
	dy || (dy = dx);
	var r = {
		width: rect.width + dx * 2,
		height: rect.height + dy * 2
	};
	if (r.width >= 0) {
		r.left = rect.left - dx;
		r.right = r.left + r.width;
		r.x = r.left;
	} else {
		r.right = rect.right + dx;
		r.left = rect.right - r.width;
		r.y = r.right;
	}
	if (r.height >= 0) {
		r.top = rect.top - dy;
		r.bottom = r.top + r.height;
		r.y = r.top;
	} else {
		r.bottom = rect.bottom + dy;
		r.top = rect.bottom - r.height;
		r.y = r.bottom;
	}

	return r;
};

},{}],111:[function(require,module,exports){
/** @type {Array} lowercase prefixes */
var lcPrefixes = [""].concat(require("./prefixes"));

/** @type {Array} capitalized prefixes */
var ucPrefixes = lcPrefixes.map(function(s) {
	return (s === "") ? s : s.charAt(0).toUpperCase() + s.substr(1);
});

/** @type {Object} specific event solvers */
var _solvers = {};

/** @type {Object} cached values */
var _cache = {};

/**
 * @param {String} name Unprefixed event name
 * @param {?Object} obj Prefix test target
 * @param {?String} testProp Proxy property to test prefixes
 * @return {String|null}
 */
var _prefixedEvent = function(name, obj, testProp) {
	var prefixes = /^[A-Z]/.test(name) ? ucPrefixes : lcPrefixes;
	obj || (obj = document);
	for (var i = 0; i < prefixes.length; i++) {
		if (testProp) {
			if ((prefixes[i] + testProp) in obj) {
				return prefixes[i] + name;
			}
		}
		if (("on" + prefixes[i] + name) in obj) {
			return prefixes[i] + name;
		}
	}
	return null;
};

// transitionend
_solvers["transitionend"] = function() {
	var prop, style = document.body.style,
		map = {
			"transition": "transitionend",
			"WebkitTransition": "webkitTransitionEnd",
			"MozTransition": "transitionend",
			// "msTransition" : "MSTransitionEnd",
			"OTransition": "oTransitionEnd"
		};
	for (prop in map) {
		if (prop in style) {
			return map[prop];
		}
	}
	return null;
};

/**
 * get the prefixed property
 * @param {String} property name
 * @param {Object} look-up object
 * @returns {String|null} prefixed
 */
module.exports = function(evName) {
	if (!_cache.hasOwnProperty(evName)) {
		_cache[evName] = _solvers.hasOwnProperty(evName) ? _solvers[evName]() : _prefixedEvent.apply(null, arguments);
		if (_cache[evName] === null) {
			console.warn("Event '%s' not found", evName);
		} else {
			console.log("Event '%s' found as '%s'", evName, _cache[evName]);
		}
	}
	return _cache[evName];
	// return _cache[evName] || (_cache[evName] = _solvers[evName]? _solvers[evName].call() : _prefixedProperty.apply(null, arguments));
};

/*
var defaultTest = function(name, obj) {
	var prefixes = /^[A-Z]/.test(name)? ucPrefixes : lcPrefixes;
	for (var i = 0; i < prefixes.length; i++) {
		if (("on" + prefixes[i] + name) in obj) {
			console.log("Event '%s' found as '%s'", name, prefixes[i] + name);
			return prefixes[i] + name;
		}
	}
	return null;
};

var proxyTest = function(name, obj, testProp) {
	var prefixes = /^[A-Z]/.test(name)? ucPrefixes : lcPrefixes;
	for (var i = 0; i < prefixes.length; i++) {
		if ((prefixes[i] + testProp) in obj) {
			console.log("Event %s inferred as '%s' from property '%s'", name, prefixes[i] + name, testProp);
			return prefixes[i] + name;
		}
	}
	return null;
};
*/

},{"./prefixes":114}],112:[function(require,module,exports){
/**
/* @module utils/prefixedProperty
/*/

/** @type {module:utils/prefixes} */
var prefixes = require("./prefixes");
/** @type {Number} prefix count */
var _prefixNum = prefixes.length;
/** @type {Array} cached values */
var _cache = {};

var _prefixedProperty = function(prop, obj) {
	var prefixedProp, camelProp;

	if (prop in obj) {
		console.log("Property '%s' found unprefixed", prop);
		return prop;
	}
	camelProp = prop[0].toUpperCase() + prop.slice(1);
	for (var i = 0; i < _prefixNum; i++) {
		prefixedProp = prefixes[i] + camelProp;
		if (prefixedProp in obj) {
			console.log("Property '%s' found as '%s'", prop, prefixedProp);
			return prefixedProp;
		}
	}
	console.error("Property '%s' not found", prop);
	return null;
};

/**
 * get the prefixed property
 * @param {String} property name
 * @param {Object} look-up object
 * @returns {String|null} prefixed
 */
module.exports = function(prop, obj) {
	return _cache[prop] || (_cache[prop] = _prefixedProperty(prop, obj || document.body.style));
};

},{"./prefixes":114}],113:[function(require,module,exports){
/**
/* @module utils/prefixedStyleName
/*/

/** @type {module:utils/prefixes} */
var prefixes = require("./prefixes"); //.map(function(prefix) { return "-" + prefix + "-"; });
/** @type {Number} prefix count */
var _prefixNum = prefixes.length;
/** @type {Array} cached values */
var _cache = {};

var _prefixedStyleName = function(style, styleObj) {
	var prefixedStyle;

	if (style in styleObj) {
		console.log("CSS style '%s' found unprefixed", style);
		return style;
	}
	for (var i = 0; i < _prefixNum; i++) {
		prefixedStyle = "-" + prefixes[i] + "-" + style;
		// prefixedStyle = prefixes[i] + style;
		if (prefixedStyle in styleObj) {
			console.log("CSS style '%s' found as '%s'", style, prefixedStyle);
			return prefixedStyle;
		}
	}
	console.warn("CSS style '%s' not found", style);
	return null;
};

/**
 * get the prefixed style name
 * @param {String} style name
 * @param {Object} look-up style object
 * @returns {String|Undefined} prefixed
 */
module.exports = function(style, styleObj) {
	// return _cache[style] || (_cache[style] = _prefixedStyleName_reverse(style, styleObj || document.body.style));
	return _cache[style] || (_cache[style] = _prefixedStyleName(style, styleObj || document.body.style));
};

// /** @type {module:utils/strings/camelToDashed} */
// var camelToDashed = require("./strings/camelToDashed");
// /** @type {module:utils/prefixedProperty} */
// var prefixedProperty = require("./prefixedProperty");
// /** @type {module:utils/strings/dashedToCamel} */
// var dashedToCamel = require("./strings/dashedToCamel");
//
// var _prefixedStyleName_reverse = function (style, styleObj) {
// 	var camelProp, prefixedProp;
// 	camelProp = dashedToCamel(style);
// 	prefixedProp = prefixedProperty(camelProp, styleObj);
// 	return prefixedProp? (camelProp === prefixedProp? "" : "-") + camelToDashed(prefixedProp) : null;
// };

},{"./prefixes":114}],114:[function(require,module,exports){
module.exports = ["webkit", "moz", "ms", "o"];

},{}],115:[function(require,module,exports){
/* jshint ignore:start */
/*
Taken from:
https://github.com/webcomponents/webcomponentsjs/blob/master/src/MutationObserver/MutationObserver.js
*/
/*
 * @license
 * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */

var setImmediate;

// As much as we would like to use the native implementation, IE
// (all versions) suffers a rather annoying bug where it will drop or defer
// callbacks when heavy DOM operations are being performed concurrently.
//
// For a thorough discussion on this, see:
// http://codeforhire.com/2013/09/21/setimmediate-and-messagechannel-broken-on-internet-explorer-10/
if (/Trident|Edge/.test(navigator.userAgent)) {
	// Sadly, this bug also affects postMessage and MessageQueues.
	//
	// We would like to use the onreadystatechange hack for IE <= 10, but it is
	// dangerous in the polyfilled environment due to requiring that the
	// observed script element be in the document.
	setImmediate = setTimeout;

	// If some other browser ever implements it, let's prefer their native
	// implementation:
} else if (window.setImmediate) {
	setImmediate = window.setImmediate;

	// Otherwise, we fall back to postMessage as a means of emulating the next
	// task semantics of setImmediate.
} else {
	var setImmediateQueue = [];
	var sentinel = String(Math.random());
	window.addEventListener("message", function(e) {
		if (e.data === sentinel) {
			var queue = setImmediateQueue;
			setImmediateQueue = [];
			queue.forEach(function(func) {
				func();
			});
		}
	});
	setImmediate = function(func) {
		setImmediateQueue.push(func);
		window.postMessage(sentinel, "*");
	};
}

module.exports = setImmediate;
/* jshint ignore:end */

},{}],116:[function(require,module,exports){
module.exports = function(str) {
	return str.replace(/[A-Z]/g, function($0) {
		return "-" + $0.toLowerCase();
	});
};

},{}],117:[function(require,module,exports){
module.exports = function(s) {
	return s.replace(/<[^>]+>/g, "");
};

},{}],118:[function(require,module,exports){
/** @type {module:hammerjs} */
var Hammer = require("hammerjs");

// /**
//  * get a usable string, used as event postfix
//  * @param {Const} state
//  * @returns {String} state
//  */
// function stateStr(state) {
// 	if (state & Hammer.STATE_CANCELLED) {
// 		return "cancel";
// 	} else if (state & Hammer.STATE_ENDED) {
// 		return "end";
// 	} else if (state & Hammer.STATE_CHANGED) {
// 		return "move";
// 	} else if (state & Hammer.STATE_BEGAN) {
// 		return "start";
// 	}
// 	return "";
// }

/**
 * direction cons to string
 * @param {Const} direction
 * @returns {String}
 */
function dirStr(direction) {
	if (direction == Hammer.DIRECTION_DOWN) {
		return "down";
	} else if (direction == Hammer.DIRECTION_UP) {
		return "up";
	} else if (direction == Hammer.DIRECTION_LEFT) {
		return "left";
	} else if (direction == Hammer.DIRECTION_RIGHT) {
		return "right";
	}
	return "";
}

///**
// * Pan
// * Recognized when the pointer is down and moved in the allowed direction.
// * @constructor
// * @extends AttrRecognizer
// */
//function PanRecognizer() {
//	Hammer.AttrRecognizer.apply(this, arguments);
//
//	this.pX = null;
//	this.pY = null;
//}
//
//inherit(PanRecognizer, Hammer.AttrRecognizer, {
//	/**
//	/* @namespace
//	/* @memberof PanRecognizer
//	/*/
//	defaults: {
//		event: "pan",
//		threshold: 10,
//		pointers: 1,
//		direction: DIRECTION_ALL
//	},
//
//	getTouchAction: function() {
//		var direction = this.options.direction;
//		var actions = [];
//		if (direction & DIRECTION_HORIZONTAL) {
//			actions.push(TOUCH_ACTION_PAN_Y);
//		}
//		if (direction & DIRECTION_VERTICAL) {
//			actions.push(TOUCH_ACTION_PAN_X);
//		}
//		return actions;
//	},
//
//	directionTest: function(input) {
//		var options = this.options;
//		var hasMoved = true;
//		var distance = input.distance;
//		var direction = input.direction;
//		var x = input.deltaX;
//		var y = input.deltaY;
//
//		// lock to axis?
//		if (!(direction & options.direction)) {
//			if (options.direction & DIRECTION_HORIZONTAL) {
//				direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;
//				hasMoved = x != this.pX;
//				distance = Math.abs(input.deltaX);
//			} else {
//				direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;
//				hasMoved = y != this.pY;
//				distance = Math.abs(input.deltaY);
//			}
//		}
//		input.direction = direction;
//		return hasMoved && distance > options.threshold && direction & options.direction;
//	},
//
//	attrTest: function(input) {
//		return AttrRecognizer.prototype.attrTest.call(this, input) &&
//			(this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));
//	},
//
//	emit: function(input) {
//		this.pX = input.deltaX;
//		this.pY = input.deltaY;
//
//		var direction = dirStr(input.direction);
//		if (direction) {
//			this.manager.emit(this.options.event + direction, input);
//		}
//
//		this._super.emit.call(this, input);
//	}
//});

/**
 * SmoothPan
 * @constructor
 * @extends Hammer.Pan
 */
function SmoothPan() {
	var ret = Hammer.Pan.apply(this, arguments);
	this.thresholdOffsetX = null;
	this.thresholdOffsetY = null;
	this.thresholdOffset = null;
	return ret;
}

Hammer.inherit(SmoothPan, Hammer.Pan, {
	emit: function(input) {
		// Inheritance breaks, so this code is taken from PanRecognizer.emit
		//	this._super.emit.call(this, input); // Triggers infinite recursion
		//	Hammer.Pan.prototype.emit.apply(this, arguments); // This breaks too

		var threshold = this.options.threshold;
		var direction = input.direction;

		if (this.state == Hammer.STATE_BEGAN) {
			this.thresholdOffsetX = (direction & Hammer.DIRECTION_HORIZONTAL) ? ((direction & Hammer.DIRECTION_LEFT) ? threshold : -threshold) : 0;
			this.thresholdOffsetY = (direction & Hammer.DIRECTION_VERTICAL) ? ((direction & Hammer.DIRECTION_UP) ? threshold : -threshold) : 0;
			// this.thresholdOffset = (direction & Hammer.DIRECTION_HORIZONTAL)? input.thresholdOffsetX : input.thresholdOffsetY;
			// console.log("RECOGNIZER STATE", dirStr(direction), stateStr(this.state), this.thresholdOffsetX);
		}
		input.thresholdOffsetX = this.thresholdOffsetX;
		input.thresholdOffsetY = this.thresholdOffsetY;
		input.thresholdDeltaX = input.deltaX + this.thresholdOffsetX;
		input.thresholdDeltaY = input.deltaY + this.thresholdOffsetY;

		this.pX = input.deltaX;
		this.pY = input.deltaY;

		direction = dirStr(direction);
		if (direction) {
			this.manager.emit(this.options.event + direction, input);
		}
		return Hammer.Recognizer.prototype.emit.apply(this, arguments);
	}
});

module.exports = SmoothPan;

},{"hammerjs":"hammerjs"}],119:[function(require,module,exports){
module.exports={
	"transitions": {
		"ease": "ease",
		"duration_ms": "400",
		"delay_interval_ms": "100",
		"min_delay_ms": "50"
	},
	"breakpoints": {
		"landscape": "'(orientation: landscape)'",
		"portrait": "'(orientation: portrait)'",
		"fullwidth-small": "'not screen and (min-width: 460px)'",
		"fullwidth": "'not screen and (min-width: 704px), not screen and (min-height: 540px)'",
		"desktop-small": "'only screen and (min-width: 1024px) and (min-height: 540px)'",
		"desktop-medium": "'only screen and (min-width: 1224px) and (min-height: 704px)'",
		"desktop-large": "'only screen and (min-width: 1824px) and (min-height: 1024px)'"
	},
	"default_colors": {
		"color": "hsl(47, 5%, 15%)",
		"background-color": "hsl(47, 5%, 95%)",
		"link-color": "hsl(10, 80%, 50%)"
	},
	"temp": {
		"collapse_offset": "360"
	},
	"_ignore": {
		"transitions": {
			"ease": "ease",
			"duration_ms": "400",
			"delay_interval_ms": "134",
			"min_delay_ms": "34"
		},
		"default_colors": {
			"--link-color": "hsl(10, 80%, 50%)",
			"--alt-background-color": "unset"
		},
		"units": {
			"hu_px": "20",
			"vu_px": "12"
		},
		"breakpoints": {
			"mobile": "'not screen and (min-width: 704px), not screen and (min-height: 540px)'",
			"unsupported": "'not screen and (min-width: 704px)'",
			"unquoted": "only screen and (min-width: 1824px)",
			"unquoted_neg": "not screen and (min-width: 704px)",
			"quoted_combined": "'not screen and (min-width: 704px), not screen and (min-height: 540px)'",
			"array": [
				"only screen and (min-width: 704px)",
				"not screen and (min-width: 704px)",
				"not screen and (min-height: 540px)"
			]
		}
	}
}

},{}]},{},[32])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMucnVudGltZS5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2Jhc2UuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9kZWNvcmF0b3JzLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvZGVjb3JhdG9ycy9pbmxpbmUuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9leGNlcHRpb24uanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9oZWxwZXJzLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvaGVscGVycy9ibG9jay1oZWxwZXItbWlzc2luZy5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2hlbHBlcnMvZWFjaC5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2hlbHBlcnMvaGVscGVyLW1pc3NpbmcuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9oZWxwZXJzL2lmLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvaGVscGVycy9sb2cuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9oZWxwZXJzL2xvb2t1cC5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2hlbHBlcnMvd2l0aC5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2xvZ2dlci5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2Rpc3QvY2pzL2hhbmRsZWJhcnMvbm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvbm8tY29uZmxpY3QuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9ydW50aW1lLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvc2FmZS1zdHJpbmcuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy91dGlscy5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL3J1bnRpbWUuanMiLCJub2RlX21vZHVsZXMvaGJzZnkvcnVudGltZS5qcyIsIm5vZGVfbW9kdWxlcy9zZXRpbW1lZGlhdGUvc2V0SW1tZWRpYXRlLmpzIiwibm9kZV9tb2R1bGVzL3VuZGVyc2NvcmUuc3RyaW5nL2Rhc2hlcml6ZS5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy9oZWxwZXIvZGVmYXVsdFRvV2hpdGVTcGFjZS5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy9oZWxwZXIvZXNjYXBlUmVnRXhwLmpzIiwibm9kZV9tb2R1bGVzL3VuZGVyc2NvcmUuc3RyaW5nL2hlbHBlci9tYWtlU3RyaW5nLmpzIiwibm9kZV9tb2R1bGVzL3VuZGVyc2NvcmUuc3RyaW5nL2hlbHBlci9zdHJSZXBlYXQuanMiLCJub2RlX21vZHVsZXMvdW5kZXJzY29yZS5zdHJpbmcvbHBhZC5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy9wYWQuanMiLCJub2RlX21vZHVsZXMvdW5kZXJzY29yZS5zdHJpbmcvcnBhZC5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy90cmltLmpzIiwic3JjL2pzL2FwcC9BcHAuanMiLCJzcmMvanMvYXBwL2NvbnRyb2wvQ29udHJvbGxlci5qcyIsInNyYy9qcy9hcHAvY29udHJvbC9HbG9iYWxzLmpzIiwic3JjL2pzL2FwcC9kZWJ1Zy9EZWJ1Z1Rvb2xiYXIuanMiLCJzcmMvanMvYXBwL2RlYnVnL3RlbXBsYXRlL0RlYnVnVG9vbGJhci5TVkdHcmlkLmhicyIsInNyYy9qcy9hcHAvZGVidWcvdGVtcGxhdGUvRGVidWdUb29sYmFyLmhicyIsInNyYy9qcy9hcHAvbW9kZWwvQXBwU3RhdGUuanMiLCJzcmMvanMvYXBwL21vZGVsL0Jhc2VJdGVtLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvbi5qcyIsInNyYy9qcy9hcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvbi5qcyIsInNyYy9qcy9hcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9uLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9uLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9oZWxwZXIvYm9vdHN0cmFwLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9pdGVtL0FydGljbGVJdGVtLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9pdGVtL0J1bmRsZUl0ZW0uanMiLCJzcmMvanMvYXBwL21vZGVsL2l0ZW0vS2V5d29yZEl0ZW0uanMiLCJzcmMvanMvYXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9pdGVtL1NvdXJjZUl0ZW0uanMiLCJzcmMvanMvYXBwL21vZGVsL2l0ZW0vVHlwZUl0ZW0uanMiLCJzcmMvanMvYXBwL3ZpZXcvQXBwVmlldy5qcyIsInNyYy9qcy9hcHAvdmlldy9Db250ZW50Vmlldy5qcyIsInNyYy9qcy9hcHAvdmlldy9OYXZpZ2F0aW9uVmlldy5qcyIsInNyYy9qcy9hcHAvdmlldy9iYXNlL0NhbnZhc1ZpZXcuanMiLCJzcmMvanMvYXBwL3ZpZXcvYmFzZS9GcmFtZVF1ZXVlLmpzIiwic3JjL2pzL2FwcC92aWV3L2Jhc2UvSW50ZXJwb2xhdG9yLmpzIiwic3JjL2pzL2FwcC92aWV3L2Jhc2UvUHJlZml4ZWRFdmVudHMuanMiLCJzcmMvanMvYXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvYmFzZS9WaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L2Jhc2UvVmlld0Vycm9yLmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9BcnRpY2xlQnV0dG9uLmhicyIsInNyYy9qcy9hcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZUJ1dHRvbi5qcyIsInNyYy9qcy9hcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZVZpZXcuanMiLCJzcmMvanMvYXBwL3ZpZXcvY29tcG9uZW50L0Nhcm91c2VsLmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uU3RhY2suaGJzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uU3RhY2suanMiLCJzcmMvanMvYXBwL3ZpZXcvY29tcG9uZW50L0ZpbHRlcmFibGVMaXN0Vmlldy5qcyIsInNyYy9qcy9hcHAvdmlldy9jb21wb25lbnQvR3JhcGhWaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Hcm91cGluZ0xpc3RWaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyLmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9TZWxlY3RhYmxlTGlzdFZpZXcuanMiLCJzcmMvanMvYXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL0NhbnZhc1Byb2dyZXNzTWV0ZXIzLmpzIiwic3JjL2pzL2FwcC92aWV3L2hlbHBlci9jcmVhdGVDb2xvclN0eWxlU2hlZXQuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS9fbG9hZEltYWdlQXNPYmplY3RVUkwuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS9fd2hlbkltYWdlTG9hZHMuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS93aGVuRGVmYXVsdEltYWdlTG9hZHMuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS93aGVuU2Nyb2xsaW5nRW5kcy5qcyIsInNyYy9qcy9hcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3Rpb25EaXN0YW5jZUlzLmpzIiwic3JjL2pzL2FwcC92aWV3L3Byb21pc2Uvd2hlblNlbGVjdGlvbklzQ29udGlndW91cy5qcyIsInNyYy9qcy9hcHAvdmlldy9wcm9taXNlL3doZW5WaWV3SXNBdHRhY2hlZC5qcyIsInNyYy9qcy9hcHAvdmlldy9wcm9taXNlL3doZW5WaWV3SXNSZW5kZXJlZC5qcyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvQ2Fyb3VzZWxSZW5kZXJlci5qcyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvcmVuZGVyL0RlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXIuaGJzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9EZWZhdWx0U2VsZWN0YWJsZVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9Eb3ROYXZpZ2F0aW9uUmVuZGVyZXIuaGJzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9Eb3ROYXZpZ2F0aW9uUmVuZGVyZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvcmVuZGVyL0ltYWdlUmVuZGVyZXIuaGJzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9JbWFnZVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9MYWJlbFJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9NZWRpYVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9QbGF5YWJsZVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9TZXF1ZW5jZVJlbmRlcmVyLmhicyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlci5qcyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvVmlkZW9SZW5kZXJlci5oYnMiLCJzcmMvanMvYXBwL3ZpZXcvcmVuZGVyL1ZpZGVvUmVuZGVyZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvdGVtcGxhdGUvQ2Fyb3VzZWwuRW1wdHlSZW5kZXJlci5CdW5kbGUuaGJzIiwic3JjL2pzL2FwcC92aWV3L3RlbXBsYXRlL0NvbGxlY3Rpb25TdGFjay5NZWRpYS5oYnMiLCJzcmMvanMvYXBwL3ZpZXcvdGVtcGxhdGUvRXJyb3JCbG9jay5oYnMiLCJzcmMvanMvYXBwL3ZpZXcvdGVtcGxhdGUvX2hlbHBlcnMuanMiLCJzcmMvanMvdXRpbHMvVGltZXIuanMiLCJzcmMvanMvdXRpbHMvVHJhbnNmb3JtSGVscGVyLmpzIiwic3JjL2pzL3V0aWxzL1RyYW5zZm9ybUl0ZW0uanMiLCJzcmMvanMvdXRpbHMvY2FudmFzL0NhbnZhc0hlbHBlci5qcyIsInNyYy9qcy91dGlscy9jYW52YXMvY2FsY0FyY0hDb25uZWN0b3IuanMiLCJzcmMvanMvdXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXMuanMiLCJzcmMvanMvdXRpbHMvZWFzZS9saW5lYXIuanMiLCJzcmMvanMvdXRpbHMvZXZlbnQvbWVkaWFFdmVudHNFbnVtLmpzIiwic3JjL2pzL3V0aWxzL2dlb20vaW5mbGF0ZVJlY3QuanMiLCJzcmMvanMvdXRpbHMvcHJlZml4ZWRFdmVudC5qcyIsInNyYy9qcy91dGlscy9wcmVmaXhlZFByb3BlcnR5LmpzIiwic3JjL2pzL3V0aWxzL3ByZWZpeGVkU3R5bGVOYW1lLmpzIiwic3JjL2pzL3V0aWxzL3ByZWZpeGVzLmpzIiwic3JjL2pzL3V0aWxzL3NldEltbWVkaWF0ZS5qcyIsInNyYy9qcy91dGlscy9zdHJpbmdzL2NhbWVsVG9EYXNoZWQuanMiLCJzcmMvanMvdXRpbHMvc3RyaW5ncy9zdHJpcFRhZ3MuanMiLCJzcmMvanMvdXRpbHMvdG91Y2gvU21vb3RoUGFuUmVjb2duaXplci5qcyIsInNyYy9zYXNzL3ZhcmlhYmxlcy5qc29uIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7Ozs4QkMzRnNCLG1CQUFtQjs7SUFBN0IsSUFBSTs7Ozs7b0NBSU8sMEJBQTBCOzs7O21DQUMzQix3QkFBd0I7Ozs7K0JBQ3ZCLG9CQUFvQjs7SUFBL0IsS0FBSzs7aUNBQ1Esc0JBQXNCOztJQUFuQyxPQUFPOztvQ0FFSSwwQkFBMEI7Ozs7O0FBR2pELFNBQVMsTUFBTSxHQUFHO0FBQ2hCLE1BQUksRUFBRSxHQUFHLElBQUksSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUM7O0FBRTFDLE9BQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQ3ZCLElBQUUsQ0FBQyxVQUFVLG9DQUFhLENBQUM7QUFDM0IsSUFBRSxDQUFDLFNBQVMsbUNBQVksQ0FBQztBQUN6QixJQUFFLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztBQUNqQixJQUFFLENBQUMsZ0JBQWdCLEdBQUcsS0FBSyxDQUFDLGdCQUFnQixDQUFDOztBQUU3QyxJQUFFLENBQUMsRUFBRSxHQUFHLE9BQU8sQ0FBQztBQUNoQixJQUFFLENBQUMsUUFBUSxHQUFHLFVBQVMsSUFBSSxFQUFFO0FBQzNCLFdBQU8sT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLENBQUM7R0FDbkMsQ0FBQzs7QUFFRixTQUFPLEVBQUUsQ0FBQztDQUNYOztBQUVELElBQUksSUFBSSxHQUFHLE1BQU0sRUFBRSxDQUFDO0FBQ3BCLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDOztBQUVyQixrQ0FBVyxJQUFJLENBQUMsQ0FBQzs7QUFFakIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLElBQUksQ0FBQzs7cUJBRVIsSUFBSTs7Ozs7Ozs7Ozs7OztxQkNwQ3lCLFNBQVM7O3lCQUMvQixhQUFhOzs7O3VCQUNFLFdBQVc7OzBCQUNSLGNBQWM7O3NCQUNuQyxVQUFVOzs7O0FBRXRCLElBQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQzs7QUFDeEIsSUFBTSxpQkFBaUIsR0FBRyxDQUFDLENBQUM7OztBQUU1QixJQUFNLGdCQUFnQixHQUFHO0FBQzlCLEdBQUMsRUFBRSxhQUFhO0FBQ2hCLEdBQUMsRUFBRSxlQUFlO0FBQ2xCLEdBQUMsRUFBRSxlQUFlO0FBQ2xCLEdBQUMsRUFBRSxVQUFVO0FBQ2IsR0FBQyxFQUFFLGtCQUFrQjtBQUNyQixHQUFDLEVBQUUsaUJBQWlCO0FBQ3BCLEdBQUMsRUFBRSxVQUFVO0NBQ2QsQ0FBQzs7O0FBRUYsSUFBTSxVQUFVLEdBQUcsaUJBQWlCLENBQUM7O0FBRTlCLFNBQVMscUJBQXFCLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUU7QUFDbkUsTUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLElBQUksRUFBRSxDQUFDO0FBQzdCLE1BQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxJQUFJLEVBQUUsQ0FBQztBQUMvQixNQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsSUFBSSxFQUFFLENBQUM7O0FBRW5DLGtDQUF1QixJQUFJLENBQUMsQ0FBQztBQUM3Qix3Q0FBMEIsSUFBSSxDQUFDLENBQUM7Q0FDakM7O0FBRUQscUJBQXFCLENBQUMsU0FBUyxHQUFHO0FBQ2hDLGFBQVcsRUFBRSxxQkFBcUI7O0FBRWxDLFFBQU0scUJBQVE7QUFDZCxLQUFHLEVBQUUsb0JBQU8sR0FBRzs7QUFFZixnQkFBYyxFQUFFLHdCQUFTLElBQUksRUFBRSxFQUFFLEVBQUU7QUFDakMsUUFBSSxnQkFBUyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssVUFBVSxFQUFFO0FBQ3RDLFVBQUksRUFBRSxFQUFFO0FBQUUsY0FBTSwyQkFBYyx5Q0FBeUMsQ0FBQyxDQUFDO09BQUU7QUFDM0Usb0JBQU8sSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztLQUM1QixNQUFNO0FBQ0wsVUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7S0FDekI7R0FDRjtBQUNELGtCQUFnQixFQUFFLDBCQUFTLElBQUksRUFBRTtBQUMvQixXQUFPLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7R0FDM0I7O0FBRUQsaUJBQWUsRUFBRSx5QkFBUyxJQUFJLEVBQUUsT0FBTyxFQUFFO0FBQ3ZDLFFBQUksZ0JBQVMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLFVBQVUsRUFBRTtBQUN0QyxvQkFBTyxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQzdCLE1BQU07QUFDTCxVQUFJLE9BQU8sT0FBTyxLQUFLLFdBQVcsRUFBRTtBQUNsQyxjQUFNLHlFQUEwRCxJQUFJLG9CQUFpQixDQUFDO09BQ3ZGO0FBQ0QsVUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxPQUFPLENBQUM7S0FDL0I7R0FDRjtBQUNELG1CQUFpQixFQUFFLDJCQUFTLElBQUksRUFBRTtBQUNoQyxXQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7R0FDNUI7O0FBRUQsbUJBQWlCLEVBQUUsMkJBQVMsSUFBSSxFQUFFLEVBQUUsRUFBRTtBQUNwQyxRQUFJLGdCQUFTLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxVQUFVLEVBQUU7QUFDdEMsVUFBSSxFQUFFLEVBQUU7QUFBRSxjQUFNLDJCQUFjLDRDQUE0QyxDQUFDLENBQUM7T0FBRTtBQUM5RSxvQkFBTyxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQy9CLE1BQU07QUFDTCxVQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztLQUM1QjtHQUNGO0FBQ0QscUJBQW1CLEVBQUUsNkJBQVMsSUFBSSxFQUFFO0FBQ2xDLFdBQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQztHQUM5QjtDQUNGLENBQUM7O0FBRUssSUFBSSxHQUFHLEdBQUcsb0JBQU8sR0FBRyxDQUFDOzs7UUFFcEIsV0FBVztRQUFFLE1BQU07Ozs7Ozs7Ozs7OztnQ0M3RUEscUJBQXFCOzs7O0FBRXpDLFNBQVMseUJBQXlCLENBQUMsUUFBUSxFQUFFO0FBQ2xELGdDQUFlLFFBQVEsQ0FBQyxDQUFDO0NBQzFCOzs7Ozs7OztxQkNKb0IsVUFBVTs7cUJBRWhCLFVBQVMsUUFBUSxFQUFFO0FBQ2hDLFVBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxRQUFRLEVBQUUsVUFBUyxFQUFFLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBRSxPQUFPLEVBQUU7QUFDM0UsUUFBSSxHQUFHLEdBQUcsRUFBRSxDQUFDO0FBQ2IsUUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUU7QUFDbkIsV0FBSyxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7QUFDcEIsU0FBRyxHQUFHLFVBQVMsT0FBTyxFQUFFLE9BQU8sRUFBRTs7QUFFL0IsWUFBSSxRQUFRLEdBQUcsU0FBUyxDQUFDLFFBQVEsQ0FBQztBQUNsQyxpQkFBUyxDQUFDLFFBQVEsR0FBRyxjQUFPLEVBQUUsRUFBRSxRQUFRLEVBQUUsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzFELFlBQUksR0FBRyxHQUFHLEVBQUUsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDL0IsaUJBQVMsQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO0FBQzlCLGVBQU8sR0FBRyxDQUFDO09BQ1osQ0FBQztLQUNIOztBQUVELFNBQUssQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUM7O0FBRTdDLFdBQU8sR0FBRyxDQUFDO0dBQ1osQ0FBQyxDQUFDO0NBQ0o7Ozs7Ozs7Ozs7QUNwQkQsSUFBTSxVQUFVLEdBQUcsQ0FBQyxhQUFhLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxPQUFPLENBQUMsQ0FBQzs7QUFFbkcsU0FBUyxTQUFTLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRTtBQUNoQyxNQUFJLEdBQUcsR0FBRyxJQUFJLElBQUksSUFBSSxDQUFDLEdBQUc7TUFDdEIsSUFBSSxZQUFBO01BQ0osTUFBTSxZQUFBLENBQUM7QUFDWCxNQUFJLEdBQUcsRUFBRTtBQUNQLFFBQUksR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQztBQUN0QixVQUFNLEdBQUcsR0FBRyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUM7O0FBRTFCLFdBQU8sSUFBSSxLQUFLLEdBQUcsSUFBSSxHQUFHLEdBQUcsR0FBRyxNQUFNLENBQUM7R0FDeEM7O0FBRUQsTUFBSSxHQUFHLEdBQUcsS0FBSyxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQzs7O0FBRzFELE9BQUssSUFBSSxHQUFHLEdBQUcsQ0FBQyxFQUFFLEdBQUcsR0FBRyxVQUFVLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxFQUFFO0FBQ2hELFFBQUksQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7R0FDOUM7OztBQUdELE1BQUksS0FBSyxDQUFDLGlCQUFpQixFQUFFO0FBQzNCLFNBQUssQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLENBQUM7R0FDMUM7O0FBRUQsTUFBSSxHQUFHLEVBQUU7QUFDUCxRQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztBQUN2QixRQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztHQUN0QjtDQUNGOztBQUVELFNBQVMsQ0FBQyxTQUFTLEdBQUcsSUFBSSxLQUFLLEVBQUUsQ0FBQzs7cUJBRW5CLFNBQVM7Ozs7Ozs7Ozs7Ozs7eUNDbENlLGdDQUFnQzs7OzsyQkFDOUMsZ0JBQWdCOzs7O29DQUNQLDBCQUEwQjs7Ozt5QkFDckMsY0FBYzs7OzswQkFDYixlQUFlOzs7OzZCQUNaLGtCQUFrQjs7OzsyQkFDcEIsZ0JBQWdCOzs7O0FBRWxDLFNBQVMsc0JBQXNCLENBQUMsUUFBUSxFQUFFO0FBQy9DLHlDQUEyQixRQUFRLENBQUMsQ0FBQztBQUNyQywyQkFBYSxRQUFRLENBQUMsQ0FBQztBQUN2QixvQ0FBc0IsUUFBUSxDQUFDLENBQUM7QUFDaEMseUJBQVcsUUFBUSxDQUFDLENBQUM7QUFDckIsMEJBQVksUUFBUSxDQUFDLENBQUM7QUFDdEIsNkJBQWUsUUFBUSxDQUFDLENBQUM7QUFDekIsMkJBQWEsUUFBUSxDQUFDLENBQUM7Q0FDeEI7Ozs7Ozs7O3FCQ2hCcUQsVUFBVTs7cUJBRWpELFVBQVMsUUFBUSxFQUFFO0FBQ2hDLFVBQVEsQ0FBQyxjQUFjLENBQUMsb0JBQW9CLEVBQUUsVUFBUyxPQUFPLEVBQUUsT0FBTyxFQUFFO0FBQ3ZFLFFBQUksT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPO1FBQ3pCLEVBQUUsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDOztBQUVwQixRQUFJLE9BQU8sS0FBSyxJQUFJLEVBQUU7QUFDcEIsYUFBTyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDakIsTUFBTSxJQUFJLE9BQU8sS0FBSyxLQUFLLElBQUksT0FBTyxJQUFJLElBQUksRUFBRTtBQUMvQyxhQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUN0QixNQUFNLElBQUksZUFBUSxPQUFPLENBQUMsRUFBRTtBQUMzQixVQUFJLE9BQU8sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFO0FBQ3RCLFlBQUksT0FBTyxDQUFDLEdBQUcsRUFBRTtBQUNmLGlCQUFPLENBQUMsR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQzlCOztBQUVELGVBQU8sUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO09BQ2hELE1BQU07QUFDTCxlQUFPLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztPQUN0QjtLQUNGLE1BQU07QUFDTCxVQUFJLE9BQU8sQ0FBQyxJQUFJLElBQUksT0FBTyxDQUFDLEdBQUcsRUFBRTtBQUMvQixZQUFJLElBQUksR0FBRyxtQkFBWSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDckMsWUFBSSxDQUFDLFdBQVcsR0FBRyx5QkFBa0IsT0FBTyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQzdFLGVBQU8sR0FBRyxFQUFDLElBQUksRUFBRSxJQUFJLEVBQUMsQ0FBQztPQUN4Qjs7QUFFRCxhQUFPLEVBQUUsQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7S0FDN0I7R0FDRixDQUFDLENBQUM7Q0FDSjs7Ozs7Ozs7Ozs7OztxQkMvQjhFLFVBQVU7O3lCQUNuRSxjQUFjOzs7O3FCQUVyQixVQUFTLFFBQVEsRUFBRTtBQUNoQyxVQUFRLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRSxVQUFTLE9BQU8sRUFBRSxPQUFPLEVBQUU7QUFDekQsUUFBSSxDQUFDLE9BQU8sRUFBRTtBQUNaLFlBQU0sMkJBQWMsNkJBQTZCLENBQUMsQ0FBQztLQUNwRDs7QUFFRCxRQUFJLEVBQUUsR0FBRyxPQUFPLENBQUMsRUFBRTtRQUNmLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTztRQUN6QixDQUFDLEdBQUcsQ0FBQztRQUNMLEdBQUcsR0FBRyxFQUFFO1FBQ1IsSUFBSSxZQUFBO1FBQ0osV0FBVyxZQUFBLENBQUM7O0FBRWhCLFFBQUksT0FBTyxDQUFDLElBQUksSUFBSSxPQUFPLENBQUMsR0FBRyxFQUFFO0FBQy9CLGlCQUFXLEdBQUcseUJBQWtCLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7S0FDakY7O0FBRUQsUUFBSSxrQkFBVyxPQUFPLENBQUMsRUFBRTtBQUFFLGFBQU8sR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQUU7O0FBRTFELFFBQUksT0FBTyxDQUFDLElBQUksRUFBRTtBQUNoQixVQUFJLEdBQUcsbUJBQVksT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ2xDOztBQUVELGFBQVMsYUFBYSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFO0FBQ3pDLFVBQUksSUFBSSxFQUFFO0FBQ1IsWUFBSSxDQUFDLEdBQUcsR0FBRyxLQUFLLENBQUM7QUFDakIsWUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7QUFDbkIsWUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLEtBQUssQ0FBQyxDQUFDO0FBQ3pCLFlBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQzs7QUFFbkIsWUFBSSxXQUFXLEVBQUU7QUFDZixjQUFJLENBQUMsV0FBVyxHQUFHLFdBQVcsR0FBRyxLQUFLLENBQUM7U0FDeEM7T0FDRjs7QUFFRCxTQUFHLEdBQUcsR0FBRyxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUU7QUFDN0IsWUFBSSxFQUFFLElBQUk7QUFDVixtQkFBVyxFQUFFLG1CQUFZLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLEtBQUssQ0FBQyxFQUFFLENBQUMsV0FBVyxHQUFHLEtBQUssRUFBRSxJQUFJLENBQUMsQ0FBQztPQUMvRSxDQUFDLENBQUM7S0FDSjs7QUFFRCxRQUFJLE9BQU8sSUFBSSxPQUFPLE9BQU8sS0FBSyxRQUFRLEVBQUU7QUFDMUMsVUFBSSxlQUFRLE9BQU8sQ0FBQyxFQUFFO0FBQ3BCLGFBQUssSUFBSSxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQ3ZDLGNBQUksQ0FBQyxJQUFJLE9BQU8sRUFBRTtBQUNoQix5QkFBYSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxLQUFLLE9BQU8sQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7V0FDL0M7U0FDRjtPQUNGLE1BQU07QUFDTCxZQUFJLFFBQVEsWUFBQSxDQUFDOztBQUViLGFBQUssSUFBSSxHQUFHLElBQUksT0FBTyxFQUFFO0FBQ3ZCLGNBQUksT0FBTyxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsRUFBRTs7OztBQUkvQixnQkFBSSxRQUFRLEtBQUssU0FBUyxFQUFFO0FBQzFCLDJCQUFhLENBQUMsUUFBUSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQzthQUNoQztBQUNELG9CQUFRLEdBQUcsR0FBRyxDQUFDO0FBQ2YsYUFBQyxFQUFFLENBQUM7V0FDTDtTQUNGO0FBQ0QsWUFBSSxRQUFRLEtBQUssU0FBUyxFQUFFO0FBQzFCLHVCQUFhLENBQUMsUUFBUSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUM7U0FDdEM7T0FDRjtLQUNGOztBQUVELFFBQUksQ0FBQyxLQUFLLENBQUMsRUFBRTtBQUNYLFNBQUcsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDckI7O0FBRUQsV0FBTyxHQUFHLENBQUM7R0FDWixDQUFDLENBQUM7Q0FDSjs7Ozs7Ozs7Ozs7Ozt5QkM5RXFCLGNBQWM7Ozs7cUJBRXJCLFVBQVMsUUFBUSxFQUFFO0FBQ2hDLFVBQVEsQ0FBQyxjQUFjLENBQUMsZUFBZSxFQUFFLGlDQUFnQztBQUN2RSxRQUFJLFNBQVMsQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFOztBQUUxQixhQUFPLFNBQVMsQ0FBQztLQUNsQixNQUFNOztBQUVMLFlBQU0sMkJBQWMsbUJBQW1CLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDO0tBQ3ZGO0dBQ0YsQ0FBQyxDQUFDO0NBQ0o7Ozs7Ozs7Ozs7cUJDWmlDLFVBQVU7O3FCQUU3QixVQUFTLFFBQVEsRUFBRTtBQUNoQyxVQUFRLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxVQUFTLFdBQVcsRUFBRSxPQUFPLEVBQUU7QUFDM0QsUUFBSSxrQkFBVyxXQUFXLENBQUMsRUFBRTtBQUFFLGlCQUFXLEdBQUcsV0FBVyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUFFOzs7OztBQUt0RSxRQUFJLEFBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFdBQVcsSUFBSSxDQUFDLFdBQVcsSUFBSyxlQUFRLFdBQVcsQ0FBQyxFQUFFO0FBQ3ZFLGFBQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUM5QixNQUFNO0FBQ0wsYUFBTyxPQUFPLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ3pCO0dBQ0YsQ0FBQyxDQUFDOztBQUVILFVBQVEsQ0FBQyxjQUFjLENBQUMsUUFBUSxFQUFFLFVBQVMsV0FBVyxFQUFFLE9BQU8sRUFBRTtBQUMvRCxXQUFPLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxXQUFXLEVBQUUsRUFBQyxFQUFFLEVBQUUsT0FBTyxDQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLElBQUksRUFBQyxDQUFDLENBQUM7R0FDdkgsQ0FBQyxDQUFDO0NBQ0o7Ozs7Ozs7Ozs7cUJDbkJjLFVBQVMsUUFBUSxFQUFFO0FBQ2hDLFVBQVEsQ0FBQyxjQUFjLENBQUMsS0FBSyxFQUFFLGtDQUFpQztBQUM5RCxRQUFJLElBQUksR0FBRyxDQUFDLFNBQVMsQ0FBQztRQUNsQixPQUFPLEdBQUcsU0FBUyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUM7QUFDOUMsU0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQzdDLFVBQUksQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7S0FDekI7O0FBRUQsUUFBSSxLQUFLLEdBQUcsQ0FBQyxDQUFDO0FBQ2QsUUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssSUFBSSxJQUFJLEVBQUU7QUFDOUIsV0FBSyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDO0tBQzVCLE1BQU0sSUFBSSxPQUFPLENBQUMsSUFBSSxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLElBQUksRUFBRTtBQUNyRCxXQUFLLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7S0FDNUI7QUFDRCxRQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsS0FBSyxDQUFDOztBQUVoQixZQUFRLENBQUMsR0FBRyxNQUFBLENBQVosUUFBUSxFQUFTLElBQUksQ0FBQyxDQUFDO0dBQ3hCLENBQUMsQ0FBQztDQUNKOzs7Ozs7Ozs7O3FCQ2xCYyxVQUFTLFFBQVEsRUFBRTtBQUNoQyxVQUFRLENBQUMsY0FBYyxDQUFDLFFBQVEsRUFBRSxVQUFTLEdBQUcsRUFBRSxLQUFLLEVBQUU7QUFDckQsV0FBTyxHQUFHLElBQUksR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO0dBQzFCLENBQUMsQ0FBQztDQUNKOzs7Ozs7Ozs7O3FCQ0o4RSxVQUFVOztxQkFFMUUsVUFBUyxRQUFRLEVBQUU7QUFDaEMsVUFBUSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsVUFBUyxPQUFPLEVBQUUsT0FBTyxFQUFFO0FBQ3pELFFBQUksa0JBQVcsT0FBTyxDQUFDLEVBQUU7QUFBRSxhQUFPLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUFFOztBQUUxRCxRQUFJLEVBQUUsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDOztBQUVwQixRQUFJLENBQUMsZUFBUSxPQUFPLENBQUMsRUFBRTtBQUNyQixVQUFJLElBQUksR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDO0FBQ3hCLFVBQUksT0FBTyxDQUFDLElBQUksSUFBSSxPQUFPLENBQUMsR0FBRyxFQUFFO0FBQy9CLFlBQUksR0FBRyxtQkFBWSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDakMsWUFBSSxDQUFDLFdBQVcsR0FBRyx5QkFBa0IsT0FBTyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO09BQ2hGOztBQUVELGFBQU8sRUFBRSxDQUFDLE9BQU8sRUFBRTtBQUNqQixZQUFJLEVBQUUsSUFBSTtBQUNWLG1CQUFXLEVBQUUsbUJBQVksQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLElBQUksSUFBSSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7T0FDaEUsQ0FBQyxDQUFDO0tBQ0osTUFBTTtBQUNMLGFBQU8sT0FBTyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUM5QjtHQUNGLENBQUMsQ0FBQztDQUNKOzs7Ozs7Ozs7O3FCQ3ZCcUIsU0FBUzs7QUFFL0IsSUFBSSxNQUFNLEdBQUc7QUFDWCxXQUFTLEVBQUUsQ0FBQyxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxPQUFPLENBQUM7QUFDN0MsT0FBSyxFQUFFLE1BQU07OztBQUdiLGFBQVcsRUFBRSxxQkFBUyxLQUFLLEVBQUU7QUFDM0IsUUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLEVBQUU7QUFDN0IsVUFBSSxRQUFRLEdBQUcsZUFBUSxNQUFNLENBQUMsU0FBUyxFQUFFLEtBQUssQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDO0FBQzlELFVBQUksUUFBUSxJQUFJLENBQUMsRUFBRTtBQUNqQixhQUFLLEdBQUcsUUFBUSxDQUFDO09BQ2xCLE1BQU07QUFDTCxhQUFLLEdBQUcsUUFBUSxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztPQUM3QjtLQUNGOztBQUVELFdBQU8sS0FBSyxDQUFDO0dBQ2Q7OztBQUdELEtBQUcsRUFBRSxhQUFTLEtBQUssRUFBYztBQUMvQixTQUFLLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQzs7QUFFbEMsUUFBSSxPQUFPLE9BQU8sS0FBSyxXQUFXLElBQUksTUFBTSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxFQUFFO0FBQy9FLFVBQUksTUFBTSxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7QUFDckMsVUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRTs7QUFDcEIsY0FBTSxHQUFHLEtBQUssQ0FBQztPQUNoQjs7d0NBUG1CLE9BQU87QUFBUCxlQUFPOzs7QUFRM0IsYUFBTyxDQUFDLE1BQU0sT0FBQyxDQUFmLE9BQU8sRUFBWSxPQUFPLENBQUMsQ0FBQztLQUM3QjtHQUNGO0NBQ0YsQ0FBQzs7cUJBRWEsTUFBTTs7Ozs7Ozs7Ozs7cUJDakNOLFVBQVMsVUFBVSxFQUFFOztBQUVsQyxNQUFJLElBQUksR0FBRyxPQUFPLE1BQU0sS0FBSyxXQUFXLEdBQUcsTUFBTSxHQUFHLE1BQU07TUFDdEQsV0FBVyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUM7O0FBRWxDLFlBQVUsQ0FBQyxVQUFVLEdBQUcsWUFBVztBQUNqQyxRQUFJLElBQUksQ0FBQyxVQUFVLEtBQUssVUFBVSxFQUFFO0FBQ2xDLFVBQUksQ0FBQyxVQUFVLEdBQUcsV0FBVyxDQUFDO0tBQy9CO0FBQ0QsV0FBTyxVQUFVLENBQUM7R0FDbkIsQ0FBQztDQUNIOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O3FCQ1pzQixTQUFTOztJQUFwQixLQUFLOzt5QkFDSyxhQUFhOzs7O29CQUM4QixRQUFROztBQUVsRSxTQUFTLGFBQWEsQ0FBQyxZQUFZLEVBQUU7QUFDMUMsTUFBTSxnQkFBZ0IsR0FBRyxZQUFZLElBQUksWUFBWSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7TUFDdkQsZUFBZSwwQkFBb0IsQ0FBQzs7QUFFMUMsTUFBSSxnQkFBZ0IsS0FBSyxlQUFlLEVBQUU7QUFDeEMsUUFBSSxnQkFBZ0IsR0FBRyxlQUFlLEVBQUU7QUFDdEMsVUFBTSxlQUFlLEdBQUcsdUJBQWlCLGVBQWUsQ0FBQztVQUNuRCxnQkFBZ0IsR0FBRyx1QkFBaUIsZ0JBQWdCLENBQUMsQ0FBQztBQUM1RCxZQUFNLDJCQUFjLHlGQUF5RixHQUN2RyxxREFBcUQsR0FBRyxlQUFlLEdBQUcsbURBQW1ELEdBQUcsZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLENBQUM7S0FDaEssTUFBTTs7QUFFTCxZQUFNLDJCQUFjLHdGQUF3RixHQUN0RyxpREFBaUQsR0FBRyxZQUFZLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7S0FDbkY7R0FDRjtDQUNGOztBQUVNLFNBQVMsUUFBUSxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUU7O0FBRTFDLE1BQUksQ0FBQyxHQUFHLEVBQUU7QUFDUixVQUFNLDJCQUFjLG1DQUFtQyxDQUFDLENBQUM7R0FDMUQ7QUFDRCxNQUFJLENBQUMsWUFBWSxJQUFJLENBQUMsWUFBWSxDQUFDLElBQUksRUFBRTtBQUN2QyxVQUFNLDJCQUFjLDJCQUEyQixHQUFHLE9BQU8sWUFBWSxDQUFDLENBQUM7R0FDeEU7O0FBRUQsY0FBWSxDQUFDLElBQUksQ0FBQyxTQUFTLEdBQUcsWUFBWSxDQUFDLE1BQU0sQ0FBQzs7OztBQUlsRCxLQUFHLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLENBQUM7O0FBRTVDLFdBQVMsb0JBQW9CLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUU7QUFDdkQsUUFBSSxPQUFPLENBQUMsSUFBSSxFQUFFO0FBQ2hCLGFBQU8sR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ2xELFVBQUksT0FBTyxDQUFDLEdBQUcsRUFBRTtBQUNmLGVBQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDO09BQ3ZCO0tBQ0Y7O0FBRUQsV0FBTyxHQUFHLEdBQUcsQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztBQUN0RSxRQUFJLE1BQU0sR0FBRyxHQUFHLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7O0FBRXhFLFFBQUksTUFBTSxJQUFJLElBQUksSUFBSSxHQUFHLENBQUMsT0FBTyxFQUFFO0FBQ2pDLGFBQU8sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLFlBQVksQ0FBQyxlQUFlLEVBQUUsR0FBRyxDQUFDLENBQUM7QUFDekYsWUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztLQUMzRDtBQUNELFFBQUksTUFBTSxJQUFJLElBQUksRUFBRTtBQUNsQixVQUFJLE9BQU8sQ0FBQyxNQUFNLEVBQUU7QUFDbEIsWUFBSSxLQUFLLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUMvQixhQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQzVDLGNBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEVBQUU7QUFDNUIsa0JBQU07V0FDUDs7QUFFRCxlQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDdEM7QUFDRCxjQUFNLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztPQUMzQjtBQUNELGFBQU8sTUFBTSxDQUFDO0tBQ2YsTUFBTTtBQUNMLFlBQU0sMkJBQWMsY0FBYyxHQUFHLE9BQU8sQ0FBQyxJQUFJLEdBQUcsMERBQTBELENBQUMsQ0FBQztLQUNqSDtHQUNGOzs7QUFHRCxNQUFJLFNBQVMsR0FBRztBQUNkLFVBQU0sRUFBRSxnQkFBUyxHQUFHLEVBQUUsSUFBSSxFQUFFO0FBQzFCLFVBQUksRUFBRSxJQUFJLElBQUksR0FBRyxDQUFBLEFBQUMsRUFBRTtBQUNsQixjQUFNLDJCQUFjLEdBQUcsR0FBRyxJQUFJLEdBQUcsbUJBQW1CLEdBQUcsR0FBRyxDQUFDLENBQUM7T0FDN0Q7QUFDRCxhQUFPLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUNsQjtBQUNELFVBQU0sRUFBRSxnQkFBUyxNQUFNLEVBQUUsSUFBSSxFQUFFO0FBQzdCLFVBQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQyxNQUFNLENBQUM7QUFDMUIsV0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLEdBQUcsRUFBRSxDQUFDLEVBQUUsRUFBRTtBQUM1QixZQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksSUFBSSxFQUFFO0FBQ3hDLGlCQUFPLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUN4QjtPQUNGO0tBQ0Y7QUFDRCxVQUFNLEVBQUUsZ0JBQVMsT0FBTyxFQUFFLE9BQU8sRUFBRTtBQUNqQyxhQUFPLE9BQU8sT0FBTyxLQUFLLFVBQVUsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxHQUFHLE9BQU8sQ0FBQztLQUN4RTs7QUFFRCxvQkFBZ0IsRUFBRSxLQUFLLENBQUMsZ0JBQWdCO0FBQ3hDLGlCQUFhLEVBQUUsb0JBQW9COztBQUVuQyxNQUFFLEVBQUUsWUFBUyxDQUFDLEVBQUU7QUFDZCxVQUFJLEdBQUcsR0FBRyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDMUIsU0FBRyxDQUFDLFNBQVMsR0FBRyxZQUFZLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDO0FBQ3ZDLGFBQU8sR0FBRyxDQUFDO0tBQ1o7O0FBRUQsWUFBUSxFQUFFLEVBQUU7QUFDWixXQUFPLEVBQUUsaUJBQVMsQ0FBQyxFQUFFLElBQUksRUFBRSxtQkFBbUIsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFO0FBQ25FLFVBQUksY0FBYyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1VBQ2pDLEVBQUUsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3BCLFVBQUksSUFBSSxJQUFJLE1BQU0sSUFBSSxXQUFXLElBQUksbUJBQW1CLEVBQUU7QUFDeEQsc0JBQWMsR0FBRyxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLG1CQUFtQixFQUFFLFdBQVcsRUFBRSxNQUFNLENBQUMsQ0FBQztPQUMzRixNQUFNLElBQUksQ0FBQyxjQUFjLEVBQUU7QUFDMUIsc0JBQWMsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDO09BQzlEO0FBQ0QsYUFBTyxjQUFjLENBQUM7S0FDdkI7O0FBRUQsUUFBSSxFQUFFLGNBQVMsS0FBSyxFQUFFLEtBQUssRUFBRTtBQUMzQixhQUFPLEtBQUssSUFBSSxLQUFLLEVBQUUsRUFBRTtBQUN2QixhQUFLLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQztPQUN2QjtBQUNELGFBQU8sS0FBSyxDQUFDO0tBQ2Q7QUFDRCxTQUFLLEVBQUUsZUFBUyxLQUFLLEVBQUUsTUFBTSxFQUFFO0FBQzdCLFVBQUksR0FBRyxHQUFHLEtBQUssSUFBSSxNQUFNLENBQUM7O0FBRTFCLFVBQUksS0FBSyxJQUFJLE1BQU0sSUFBSyxLQUFLLEtBQUssTUFBTSxBQUFDLEVBQUU7QUFDekMsV0FBRyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLE1BQU0sRUFBRSxLQUFLLENBQUMsQ0FBQztPQUN2Qzs7QUFFRCxhQUFPLEdBQUcsQ0FBQztLQUNaOztBQUVELFFBQUksRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDLElBQUk7QUFDakIsZ0JBQVksRUFBRSxZQUFZLENBQUMsUUFBUTtHQUNwQyxDQUFDOztBQUVGLFdBQVMsR0FBRyxDQUFDLE9BQU8sRUFBZ0I7UUFBZCxPQUFPLHlEQUFHLEVBQUU7O0FBQ2hDLFFBQUksSUFBSSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7O0FBRXhCLE9BQUcsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDcEIsUUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLElBQUksWUFBWSxDQUFDLE9BQU8sRUFBRTtBQUM1QyxVQUFJLEdBQUcsUUFBUSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztLQUNoQztBQUNELFFBQUksTUFBTSxZQUFBO1FBQ04sV0FBVyxHQUFHLFlBQVksQ0FBQyxjQUFjLEdBQUcsRUFBRSxHQUFHLFNBQVMsQ0FBQztBQUMvRCxRQUFJLFlBQVksQ0FBQyxTQUFTLEVBQUU7QUFDMUIsVUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFO0FBQ2xCLGNBQU0sR0FBRyxPQUFPLEtBQUssT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztPQUM1RixNQUFNO0FBQ0wsY0FBTSxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUM7T0FDcEI7S0FDRjs7QUFFRCxhQUFTLElBQUksQ0FBQyxPQUFPLGdCQUFlO0FBQ2xDLGFBQU8sRUFBRSxHQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsU0FBUyxFQUFFLE9BQU8sRUFBRSxTQUFTLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxRQUFRLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxNQUFNLENBQUMsQ0FBQztLQUNySDtBQUNELFFBQUksR0FBRyxpQkFBaUIsQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsT0FBTyxDQUFDLE1BQU0sSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsQ0FBQyxDQUFDO0FBQ3RHLFdBQU8sSUFBSSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztHQUMvQjtBQUNELEtBQUcsQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDOztBQUVqQixLQUFHLENBQUMsTUFBTSxHQUFHLFVBQVMsT0FBTyxFQUFFO0FBQzdCLFFBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFO0FBQ3BCLGVBQVMsQ0FBQyxPQUFPLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQzs7QUFFbEUsVUFBSSxZQUFZLENBQUMsVUFBVSxFQUFFO0FBQzNCLGlCQUFTLENBQUMsUUFBUSxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUM7T0FDdEU7QUFDRCxVQUFJLFlBQVksQ0FBQyxVQUFVLElBQUksWUFBWSxDQUFDLGFBQWEsRUFBRTtBQUN6RCxpQkFBUyxDQUFDLFVBQVUsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDO09BQzVFO0tBQ0YsTUFBTTtBQUNMLGVBQVMsQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQztBQUNwQyxlQUFTLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDdEMsZUFBUyxDQUFDLFVBQVUsR0FBRyxPQUFPLENBQUMsVUFBVSxDQUFDO0tBQzNDO0dBQ0YsQ0FBQzs7QUFFRixLQUFHLENBQUMsTUFBTSxHQUFHLFVBQVMsQ0FBQyxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFO0FBQ2xELFFBQUksWUFBWSxDQUFDLGNBQWMsSUFBSSxDQUFDLFdBQVcsRUFBRTtBQUMvQyxZQUFNLDJCQUFjLHdCQUF3QixDQUFDLENBQUM7S0FDL0M7QUFDRCxRQUFJLFlBQVksQ0FBQyxTQUFTLElBQUksQ0FBQyxNQUFNLEVBQUU7QUFDckMsWUFBTSwyQkFBYyx5QkFBeUIsQ0FBQyxDQUFDO0tBQ2hEOztBQUVELFdBQU8sV0FBVyxDQUFDLFNBQVMsRUFBRSxDQUFDLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0dBQ2pGLENBQUM7QUFDRixTQUFPLEdBQUcsQ0FBQztDQUNaOztBQUVNLFNBQVMsV0FBVyxDQUFDLFNBQVMsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxtQkFBbUIsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFO0FBQzVGLFdBQVMsSUFBSSxDQUFDLE9BQU8sRUFBZ0I7UUFBZCxPQUFPLHlEQUFHLEVBQUU7O0FBQ2pDLFFBQUksYUFBYSxHQUFHLE1BQU0sQ0FBQztBQUMzQixRQUFJLE1BQU0sSUFBSSxPQUFPLEtBQUssTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFO0FBQ25DLG1CQUFhLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDMUM7O0FBRUQsV0FBTyxFQUFFLENBQUMsU0FBUyxFQUNmLE9BQU8sRUFDUCxTQUFTLENBQUMsT0FBTyxFQUFFLFNBQVMsQ0FBQyxRQUFRLEVBQ3JDLE9BQU8sQ0FBQyxJQUFJLElBQUksSUFBSSxFQUNwQixXQUFXLElBQUksQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxFQUN4RCxhQUFhLENBQUMsQ0FBQztHQUNwQjs7QUFFRCxNQUFJLEdBQUcsaUJBQWlCLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxXQUFXLENBQUMsQ0FBQzs7QUFFekUsTUFBSSxDQUFDLE9BQU8sR0FBRyxDQUFDLENBQUM7QUFDakIsTUFBSSxDQUFDLEtBQUssR0FBRyxNQUFNLEdBQUcsTUFBTSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7QUFDeEMsTUFBSSxDQUFDLFdBQVcsR0FBRyxtQkFBbUIsSUFBSSxDQUFDLENBQUM7QUFDNUMsU0FBTyxJQUFJLENBQUM7Q0FDYjs7QUFFTSxTQUFTLGNBQWMsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRTtBQUN4RCxNQUFJLENBQUMsT0FBTyxFQUFFO0FBQ1osUUFBSSxPQUFPLENBQUMsSUFBSSxLQUFLLGdCQUFnQixFQUFFO0FBQ3JDLGFBQU8sR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0tBQ3pDLE1BQU07QUFDTCxhQUFPLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDMUM7R0FDRixNQUFNLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRTs7QUFFekMsV0FBTyxDQUFDLElBQUksR0FBRyxPQUFPLENBQUM7QUFDdkIsV0FBTyxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUM7R0FDckM7QUFDRCxTQUFPLE9BQU8sQ0FBQztDQUNoQjs7QUFFTSxTQUFTLGFBQWEsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRTtBQUN2RCxTQUFPLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztBQUN2QixNQUFJLE9BQU8sQ0FBQyxHQUFHLEVBQUU7QUFDZixXQUFPLENBQUMsSUFBSSxDQUFDLFdBQVcsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDO0dBQ3ZFOztBQUVELE1BQUksWUFBWSxZQUFBLENBQUM7QUFDakIsTUFBSSxPQUFPLENBQUMsRUFBRSxJQUFJLE9BQU8sQ0FBQyxFQUFFLEtBQUssSUFBSSxFQUFFO0FBQ3JDLFdBQU8sQ0FBQyxJQUFJLEdBQUcsa0JBQVksT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQ3pDLGdCQUFZLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxPQUFPLENBQUMsRUFBRSxDQUFDOztBQUUxRCxRQUFJLFlBQVksQ0FBQyxRQUFRLEVBQUU7QUFDekIsYUFBTyxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsUUFBUSxFQUFFLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUM5RTtHQUNGOztBQUVELE1BQUksT0FBTyxLQUFLLFNBQVMsSUFBSSxZQUFZLEVBQUU7QUFDekMsV0FBTyxHQUFHLFlBQVksQ0FBQztHQUN4Qjs7QUFFRCxNQUFJLE9BQU8sS0FBSyxTQUFTLEVBQUU7QUFDekIsVUFBTSwyQkFBYyxjQUFjLEdBQUcsT0FBTyxDQUFDLElBQUksR0FBRyxxQkFBcUIsQ0FBQyxDQUFDO0dBQzVFLE1BQU0sSUFBSSxPQUFPLFlBQVksUUFBUSxFQUFFO0FBQ3RDLFdBQU8sT0FBTyxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztHQUNsQztDQUNGOztBQUVNLFNBQVMsSUFBSSxHQUFHO0FBQUUsU0FBTyxFQUFFLENBQUM7Q0FBRTs7QUFFckMsU0FBUyxRQUFRLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRTtBQUMvQixNQUFJLENBQUMsSUFBSSxJQUFJLEVBQUUsTUFBTSxJQUFJLElBQUksQ0FBQSxBQUFDLEVBQUU7QUFDOUIsUUFBSSxHQUFHLElBQUksR0FBRyxrQkFBWSxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7QUFDckMsUUFBSSxDQUFDLElBQUksR0FBRyxPQUFPLENBQUM7R0FDckI7QUFDRCxTQUFPLElBQUksQ0FBQztDQUNiOztBQUVELFNBQVMsaUJBQWlCLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxXQUFXLEVBQUU7QUFDekUsTUFBSSxFQUFFLENBQUMsU0FBUyxFQUFFO0FBQ2hCLFFBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQztBQUNmLFFBQUksR0FBRyxFQUFFLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLE1BQU0sSUFBSSxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxNQUFNLENBQUMsQ0FBQztBQUM1RixTQUFLLENBQUMsTUFBTSxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQztHQUMzQjtBQUNELFNBQU8sSUFBSSxDQUFDO0NBQ2I7Ozs7Ozs7O0FDM1FELFNBQVMsVUFBVSxDQUFDLE1BQU0sRUFBRTtBQUMxQixNQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztDQUN0Qjs7QUFFRCxVQUFVLENBQUMsU0FBUyxDQUFDLFFBQVEsR0FBRyxVQUFVLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxZQUFXO0FBQ3ZFLFNBQU8sRUFBRSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7Q0FDekIsQ0FBQzs7cUJBRWEsVUFBVTs7Ozs7Ozs7Ozs7Ozs7O0FDVHpCLElBQU0sTUFBTSxHQUFHO0FBQ2IsS0FBRyxFQUFFLE9BQU87QUFDWixLQUFHLEVBQUUsTUFBTTtBQUNYLEtBQUcsRUFBRSxNQUFNO0FBQ1gsS0FBRyxFQUFFLFFBQVE7QUFDYixLQUFHLEVBQUUsUUFBUTtBQUNiLEtBQUcsRUFBRSxRQUFRO0FBQ2IsS0FBRyxFQUFFLFFBQVE7Q0FDZCxDQUFDOztBQUVGLElBQU0sUUFBUSxHQUFHLFlBQVk7SUFDdkIsUUFBUSxHQUFHLFdBQVcsQ0FBQzs7QUFFN0IsU0FBUyxVQUFVLENBQUMsR0FBRyxFQUFFO0FBQ3ZCLFNBQU8sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0NBQ3BCOztBQUVNLFNBQVMsTUFBTSxDQUFDLEdBQUcsb0JBQW1CO0FBQzNDLE9BQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxTQUFTLENBQUMsTUFBTSxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQ3pDLFNBQUssSUFBSSxHQUFHLElBQUksU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFO0FBQzVCLFVBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRTtBQUMzRCxXQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO09BQzlCO0tBQ0Y7R0FDRjs7QUFFRCxTQUFPLEdBQUcsQ0FBQztDQUNaOztBQUVNLElBQUksUUFBUSxHQUFHLE1BQU0sQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDOzs7Ozs7QUFLaEQsSUFBSSxVQUFVLEdBQUcsb0JBQVMsS0FBSyxFQUFFO0FBQy9CLFNBQU8sT0FBTyxLQUFLLEtBQUssVUFBVSxDQUFDO0NBQ3BDLENBQUM7OztBQUdGLElBQUksVUFBVSxDQUFDLEdBQUcsQ0FBQyxFQUFFO0FBQ25CLFVBSU0sVUFBVSxHQUpoQixVQUFVLEdBQUcsVUFBUyxLQUFLLEVBQUU7QUFDM0IsV0FBTyxPQUFPLEtBQUssS0FBSyxVQUFVLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxtQkFBbUIsQ0FBQztHQUNwRixDQUFDO0NBQ0g7UUFDTyxVQUFVLEdBQVYsVUFBVTs7Ozs7QUFJWCxJQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsT0FBTyxJQUFJLFVBQVMsS0FBSyxFQUFFO0FBQ3RELFNBQU8sQUFBQyxLQUFLLElBQUksT0FBTyxLQUFLLEtBQUssUUFBUSxHQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssZ0JBQWdCLEdBQUcsS0FBSyxDQUFDO0NBQ2pHLENBQUM7Ozs7O0FBR0ssU0FBUyxPQUFPLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRTtBQUNwQyxPQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxHQUFHLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQ2hELFFBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxLQUFLLEtBQUssRUFBRTtBQUN0QixhQUFPLENBQUMsQ0FBQztLQUNWO0dBQ0Y7QUFDRCxTQUFPLENBQUMsQ0FBQyxDQUFDO0NBQ1g7O0FBR00sU0FBUyxnQkFBZ0IsQ0FBQyxNQUFNLEVBQUU7QUFDdkMsTUFBSSxPQUFPLE1BQU0sS0FBSyxRQUFRLEVBQUU7O0FBRTlCLFFBQUksTUFBTSxJQUFJLE1BQU0sQ0FBQyxNQUFNLEVBQUU7QUFDM0IsYUFBTyxNQUFNLENBQUMsTUFBTSxFQUFFLENBQUM7S0FDeEIsTUFBTSxJQUFJLE1BQU0sSUFBSSxJQUFJLEVBQUU7QUFDekIsYUFBTyxFQUFFLENBQUM7S0FDWCxNQUFNLElBQUksQ0FBQyxNQUFNLEVBQUU7QUFDbEIsYUFBTyxNQUFNLEdBQUcsRUFBRSxDQUFDO0tBQ3BCOzs7OztBQUtELFVBQU0sR0FBRyxFQUFFLEdBQUcsTUFBTSxDQUFDO0dBQ3RCOztBQUVELE1BQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFO0FBQUUsV0FBTyxNQUFNLENBQUM7R0FBRTtBQUM5QyxTQUFPLE1BQU0sQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLFVBQVUsQ0FBQyxDQUFDO0NBQzdDOztBQUVNLFNBQVMsT0FBTyxDQUFDLEtBQUssRUFBRTtBQUM3QixNQUFJLENBQUMsS0FBSyxJQUFJLEtBQUssS0FBSyxDQUFDLEVBQUU7QUFDekIsV0FBTyxJQUFJLENBQUM7R0FDYixNQUFNLElBQUksT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO0FBQy9DLFdBQU8sSUFBSSxDQUFDO0dBQ2IsTUFBTTtBQUNMLFdBQU8sS0FBSyxDQUFDO0dBQ2Q7Q0FDRjs7QUFFTSxTQUFTLFdBQVcsQ0FBQyxNQUFNLEVBQUU7QUFDbEMsTUFBSSxLQUFLLEdBQUcsTUFBTSxDQUFDLEVBQUUsRUFBRSxNQUFNLENBQUMsQ0FBQztBQUMvQixPQUFLLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztBQUN2QixTQUFPLEtBQUssQ0FBQztDQUNkOztBQUVNLFNBQVMsV0FBVyxDQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUU7QUFDdkMsUUFBTSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUM7QUFDbEIsU0FBTyxNQUFNLENBQUM7Q0FDZjs7QUFFTSxTQUFTLGlCQUFpQixDQUFDLFdBQVcsRUFBRSxFQUFFLEVBQUU7QUFDakQsU0FBTyxDQUFDLFdBQVcsR0FBRyxXQUFXLEdBQUcsR0FBRyxHQUFHLEVBQUUsQ0FBQSxHQUFJLEVBQUUsQ0FBQztDQUNwRDs7OztBQzNHRDtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBOzs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzFMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUNoS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDMU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUN0TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbk1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ2pKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDOUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDdGhCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL2pCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM1MEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ3JUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUMzU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDNU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3JOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ3BzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2gvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQzlHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDOVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNsdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUN6S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDNVJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDeldBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNwbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzlzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ2p1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzloQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUMvSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3REQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTs7QUNIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25LQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG5cbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZHJhaW5RdWV1ZSwgMCk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iLCJpbXBvcnQgKiBhcyBiYXNlIGZyb20gJy4vaGFuZGxlYmFycy9iYXNlJztcblxuLy8gRWFjaCBvZiB0aGVzZSBhdWdtZW50IHRoZSBIYW5kbGViYXJzIG9iamVjdC4gTm8gbmVlZCB0byBzZXR1cCBoZXJlLlxuLy8gKFRoaXMgaXMgZG9uZSB0byBlYXNpbHkgc2hhcmUgY29kZSBiZXR3ZWVuIGNvbW1vbmpzIGFuZCBicm93c2UgZW52cylcbmltcG9ydCBTYWZlU3RyaW5nIGZyb20gJy4vaGFuZGxlYmFycy9zYWZlLXN0cmluZyc7XG5pbXBvcnQgRXhjZXB0aW9uIGZyb20gJy4vaGFuZGxlYmFycy9leGNlcHRpb24nO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSAnLi9oYW5kbGViYXJzL3V0aWxzJztcbmltcG9ydCAqIGFzIHJ1bnRpbWUgZnJvbSAnLi9oYW5kbGViYXJzL3J1bnRpbWUnO1xuXG5pbXBvcnQgbm9Db25mbGljdCBmcm9tICcuL2hhbmRsZWJhcnMvbm8tY29uZmxpY3QnO1xuXG4vLyBGb3IgY29tcGF0aWJpbGl0eSBhbmQgdXNhZ2Ugb3V0c2lkZSBvZiBtb2R1bGUgc3lzdGVtcywgbWFrZSB0aGUgSGFuZGxlYmFycyBvYmplY3QgYSBuYW1lc3BhY2VcbmZ1bmN0aW9uIGNyZWF0ZSgpIHtcbiAgbGV0IGhiID0gbmV3IGJhc2UuSGFuZGxlYmFyc0Vudmlyb25tZW50KCk7XG5cbiAgVXRpbHMuZXh0ZW5kKGhiLCBiYXNlKTtcbiAgaGIuU2FmZVN0cmluZyA9IFNhZmVTdHJpbmc7XG4gIGhiLkV4Y2VwdGlvbiA9IEV4Y2VwdGlvbjtcbiAgaGIuVXRpbHMgPSBVdGlscztcbiAgaGIuZXNjYXBlRXhwcmVzc2lvbiA9IFV0aWxzLmVzY2FwZUV4cHJlc3Npb247XG5cbiAgaGIuVk0gPSBydW50aW1lO1xuICBoYi50ZW1wbGF0ZSA9IGZ1bmN0aW9uKHNwZWMpIHtcbiAgICByZXR1cm4gcnVudGltZS50ZW1wbGF0ZShzcGVjLCBoYik7XG4gIH07XG5cbiAgcmV0dXJuIGhiO1xufVxuXG5sZXQgaW5zdCA9IGNyZWF0ZSgpO1xuaW5zdC5jcmVhdGUgPSBjcmVhdGU7XG5cbm5vQ29uZmxpY3QoaW5zdCk7XG5cbmluc3RbJ2RlZmF1bHQnXSA9IGluc3Q7XG5cbmV4cG9ydCBkZWZhdWx0IGluc3Q7XG4iLCJpbXBvcnQge2NyZWF0ZUZyYW1lLCBleHRlbmQsIHRvU3RyaW5nfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCBFeGNlcHRpb24gZnJvbSAnLi9leGNlcHRpb24nO1xuaW1wb3J0IHtyZWdpc3RlckRlZmF1bHRIZWxwZXJzfSBmcm9tICcuL2hlbHBlcnMnO1xuaW1wb3J0IHtyZWdpc3RlckRlZmF1bHREZWNvcmF0b3JzfSBmcm9tICcuL2RlY29yYXRvcnMnO1xuaW1wb3J0IGxvZ2dlciBmcm9tICcuL2xvZ2dlcic7XG5cbmV4cG9ydCBjb25zdCBWRVJTSU9OID0gJzQuMC41JztcbmV4cG9ydCBjb25zdCBDT01QSUxFUl9SRVZJU0lPTiA9IDc7XG5cbmV4cG9ydCBjb25zdCBSRVZJU0lPTl9DSEFOR0VTID0ge1xuICAxOiAnPD0gMS4wLnJjLjInLCAvLyAxLjAucmMuMiBpcyBhY3R1YWxseSByZXYyIGJ1dCBkb2Vzbid0IHJlcG9ydCBpdFxuICAyOiAnPT0gMS4wLjAtcmMuMycsXG4gIDM6ICc9PSAxLjAuMC1yYy40JyxcbiAgNDogJz09IDEueC54JyxcbiAgNTogJz09IDIuMC4wLWFscGhhLngnLFxuICA2OiAnPj0gMi4wLjAtYmV0YS4xJyxcbiAgNzogJz49IDQuMC4wJ1xufTtcblxuY29uc3Qgb2JqZWN0VHlwZSA9ICdbb2JqZWN0IE9iamVjdF0nO1xuXG5leHBvcnQgZnVuY3Rpb24gSGFuZGxlYmFyc0Vudmlyb25tZW50KGhlbHBlcnMsIHBhcnRpYWxzLCBkZWNvcmF0b3JzKSB7XG4gIHRoaXMuaGVscGVycyA9IGhlbHBlcnMgfHwge307XG4gIHRoaXMucGFydGlhbHMgPSBwYXJ0aWFscyB8fCB7fTtcbiAgdGhpcy5kZWNvcmF0b3JzID0gZGVjb3JhdG9ycyB8fCB7fTtcblxuICByZWdpc3RlckRlZmF1bHRIZWxwZXJzKHRoaXMpO1xuICByZWdpc3RlckRlZmF1bHREZWNvcmF0b3JzKHRoaXMpO1xufVxuXG5IYW5kbGViYXJzRW52aXJvbm1lbnQucHJvdG90eXBlID0ge1xuICBjb25zdHJ1Y3RvcjogSGFuZGxlYmFyc0Vudmlyb25tZW50LFxuXG4gIGxvZ2dlcjogbG9nZ2VyLFxuICBsb2c6IGxvZ2dlci5sb2csXG5cbiAgcmVnaXN0ZXJIZWxwZXI6IGZ1bmN0aW9uKG5hbWUsIGZuKSB7XG4gICAgaWYgKHRvU3RyaW5nLmNhbGwobmFtZSkgPT09IG9iamVjdFR5cGUpIHtcbiAgICAgIGlmIChmbikgeyB0aHJvdyBuZXcgRXhjZXB0aW9uKCdBcmcgbm90IHN1cHBvcnRlZCB3aXRoIG11bHRpcGxlIGhlbHBlcnMnKTsgfVxuICAgICAgZXh0ZW5kKHRoaXMuaGVscGVycywgbmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaGVscGVyc1tuYW1lXSA9IGZuO1xuICAgIH1cbiAgfSxcbiAgdW5yZWdpc3RlckhlbHBlcjogZnVuY3Rpb24obmFtZSkge1xuICAgIGRlbGV0ZSB0aGlzLmhlbHBlcnNbbmFtZV07XG4gIH0sXG5cbiAgcmVnaXN0ZXJQYXJ0aWFsOiBmdW5jdGlvbihuYW1lLCBwYXJ0aWFsKSB7XG4gICAgaWYgKHRvU3RyaW5nLmNhbGwobmFtZSkgPT09IG9iamVjdFR5cGUpIHtcbiAgICAgIGV4dGVuZCh0aGlzLnBhcnRpYWxzLCBuYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHR5cGVvZiBwYXJ0aWFsID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKGBBdHRlbXB0aW5nIHRvIHJlZ2lzdGVyIGEgcGFydGlhbCBjYWxsZWQgXCIke25hbWV9XCIgYXMgdW5kZWZpbmVkYCk7XG4gICAgICB9XG4gICAgICB0aGlzLnBhcnRpYWxzW25hbWVdID0gcGFydGlhbDtcbiAgICB9XG4gIH0sXG4gIHVucmVnaXN0ZXJQYXJ0aWFsOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgZGVsZXRlIHRoaXMucGFydGlhbHNbbmFtZV07XG4gIH0sXG5cbiAgcmVnaXN0ZXJEZWNvcmF0b3I6IGZ1bmN0aW9uKG5hbWUsIGZuKSB7XG4gICAgaWYgKHRvU3RyaW5nLmNhbGwobmFtZSkgPT09IG9iamVjdFR5cGUpIHtcbiAgICAgIGlmIChmbikgeyB0aHJvdyBuZXcgRXhjZXB0aW9uKCdBcmcgbm90IHN1cHBvcnRlZCB3aXRoIG11bHRpcGxlIGRlY29yYXRvcnMnKTsgfVxuICAgICAgZXh0ZW5kKHRoaXMuZGVjb3JhdG9ycywgbmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGVjb3JhdG9yc1tuYW1lXSA9IGZuO1xuICAgIH1cbiAgfSxcbiAgdW5yZWdpc3RlckRlY29yYXRvcjogZnVuY3Rpb24obmFtZSkge1xuICAgIGRlbGV0ZSB0aGlzLmRlY29yYXRvcnNbbmFtZV07XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgbG9nID0gbG9nZ2VyLmxvZztcblxuZXhwb3J0IHtjcmVhdGVGcmFtZSwgbG9nZ2VyfTtcbiIsImltcG9ydCByZWdpc3RlcklubGluZSBmcm9tICcuL2RlY29yYXRvcnMvaW5saW5lJztcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyRGVmYXVsdERlY29yYXRvcnMoaW5zdGFuY2UpIHtcbiAgcmVnaXN0ZXJJbmxpbmUoaW5zdGFuY2UpO1xufVxuXG4iLCJpbXBvcnQge2V4dGVuZH0gZnJvbSAnLi4vdXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihpbnN0YW5jZSkge1xuICBpbnN0YW5jZS5yZWdpc3RlckRlY29yYXRvcignaW5saW5lJywgZnVuY3Rpb24oZm4sIHByb3BzLCBjb250YWluZXIsIG9wdGlvbnMpIHtcbiAgICBsZXQgcmV0ID0gZm47XG4gICAgaWYgKCFwcm9wcy5wYXJ0aWFscykge1xuICAgICAgcHJvcHMucGFydGlhbHMgPSB7fTtcbiAgICAgIHJldCA9IGZ1bmN0aW9uKGNvbnRleHQsIG9wdGlvbnMpIHtcbiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IHBhcnRpYWxzIHN0YWNrIGZyYW1lIHByaW9yIHRvIGV4ZWMuXG4gICAgICAgIGxldCBvcmlnaW5hbCA9IGNvbnRhaW5lci5wYXJ0aWFscztcbiAgICAgICAgY29udGFpbmVyLnBhcnRpYWxzID0gZXh0ZW5kKHt9LCBvcmlnaW5hbCwgcHJvcHMucGFydGlhbHMpO1xuICAgICAgICBsZXQgcmV0ID0gZm4oY29udGV4dCwgb3B0aW9ucyk7XG4gICAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IG9yaWdpbmFsO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBwcm9wcy5wYXJ0aWFsc1tvcHRpb25zLmFyZ3NbMF1dID0gb3B0aW9ucy5mbjtcblxuICAgIHJldHVybiByZXQ7XG4gIH0pO1xufVxuIiwiXG5jb25zdCBlcnJvclByb3BzID0gWydkZXNjcmlwdGlvbicsICdmaWxlTmFtZScsICdsaW5lTnVtYmVyJywgJ21lc3NhZ2UnLCAnbmFtZScsICdudW1iZXInLCAnc3RhY2snXTtcblxuZnVuY3Rpb24gRXhjZXB0aW9uKG1lc3NhZ2UsIG5vZGUpIHtcbiAgbGV0IGxvYyA9IG5vZGUgJiYgbm9kZS5sb2MsXG4gICAgICBsaW5lLFxuICAgICAgY29sdW1uO1xuICBpZiAobG9jKSB7XG4gICAgbGluZSA9IGxvYy5zdGFydC5saW5lO1xuICAgIGNvbHVtbiA9IGxvYy5zdGFydC5jb2x1bW47XG5cbiAgICBtZXNzYWdlICs9ICcgLSAnICsgbGluZSArICc6JyArIGNvbHVtbjtcbiAgfVxuXG4gIGxldCB0bXAgPSBFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IuY2FsbCh0aGlzLCBtZXNzYWdlKTtcblxuICAvLyBVbmZvcnR1bmF0ZWx5IGVycm9ycyBhcmUgbm90IGVudW1lcmFibGUgaW4gQ2hyb21lIChhdCBsZWFzdCksIHNvIGBmb3IgcHJvcCBpbiB0bXBgIGRvZXNuJ3Qgd29yay5cbiAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgZXJyb3JQcm9wcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgdGhpc1tlcnJvclByb3BzW2lkeF1dID0gdG1wW2Vycm9yUHJvcHNbaWR4XV07XG4gIH1cblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBFeGNlcHRpb24pO1xuICB9XG5cbiAgaWYgKGxvYykge1xuICAgIHRoaXMubGluZU51bWJlciA9IGxpbmU7XG4gICAgdGhpcy5jb2x1bW4gPSBjb2x1bW47XG4gIH1cbn1cblxuRXhjZXB0aW9uLnByb3RvdHlwZSA9IG5ldyBFcnJvcigpO1xuXG5leHBvcnQgZGVmYXVsdCBFeGNlcHRpb247XG4iLCJpbXBvcnQgcmVnaXN0ZXJCbG9ja0hlbHBlck1pc3NpbmcgZnJvbSAnLi9oZWxwZXJzL2Jsb2NrLWhlbHBlci1taXNzaW5nJztcbmltcG9ydCByZWdpc3RlckVhY2ggZnJvbSAnLi9oZWxwZXJzL2VhY2gnO1xuaW1wb3J0IHJlZ2lzdGVySGVscGVyTWlzc2luZyBmcm9tICcuL2hlbHBlcnMvaGVscGVyLW1pc3NpbmcnO1xuaW1wb3J0IHJlZ2lzdGVySWYgZnJvbSAnLi9oZWxwZXJzL2lmJztcbmltcG9ydCByZWdpc3RlckxvZyBmcm9tICcuL2hlbHBlcnMvbG9nJztcbmltcG9ydCByZWdpc3Rlckxvb2t1cCBmcm9tICcuL2hlbHBlcnMvbG9va3VwJztcbmltcG9ydCByZWdpc3RlcldpdGggZnJvbSAnLi9oZWxwZXJzL3dpdGgnO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJEZWZhdWx0SGVscGVycyhpbnN0YW5jZSkge1xuICByZWdpc3RlckJsb2NrSGVscGVyTWlzc2luZyhpbnN0YW5jZSk7XG4gIHJlZ2lzdGVyRWFjaChpbnN0YW5jZSk7XG4gIHJlZ2lzdGVySGVscGVyTWlzc2luZyhpbnN0YW5jZSk7XG4gIHJlZ2lzdGVySWYoaW5zdGFuY2UpO1xuICByZWdpc3RlckxvZyhpbnN0YW5jZSk7XG4gIHJlZ2lzdGVyTG9va3VwKGluc3RhbmNlKTtcbiAgcmVnaXN0ZXJXaXRoKGluc3RhbmNlKTtcbn1cbiIsImltcG9ydCB7YXBwZW5kQ29udGV4dFBhdGgsIGNyZWF0ZUZyYW1lLCBpc0FycmF5fSBmcm9tICcuLi91dGlscyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdibG9ja0hlbHBlck1pc3NpbmcnLCBmdW5jdGlvbihjb250ZXh0LCBvcHRpb25zKSB7XG4gICAgbGV0IGludmVyc2UgPSBvcHRpb25zLmludmVyc2UsXG4gICAgICAgIGZuID0gb3B0aW9ucy5mbjtcblxuICAgIGlmIChjb250ZXh0ID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gZm4odGhpcyk7XG4gICAgfSBlbHNlIGlmIChjb250ZXh0ID09PSBmYWxzZSB8fCBjb250ZXh0ID09IG51bGwpIHtcbiAgICAgIHJldHVybiBpbnZlcnNlKHRoaXMpO1xuICAgIH0gZWxzZSBpZiAoaXNBcnJheShjb250ZXh0KSkge1xuICAgICAgaWYgKGNvbnRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICBpZiAob3B0aW9ucy5pZHMpIHtcbiAgICAgICAgICBvcHRpb25zLmlkcyA9IFtvcHRpb25zLm5hbWVdO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGluc3RhbmNlLmhlbHBlcnMuZWFjaChjb250ZXh0LCBvcHRpb25zKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBpbnZlcnNlKHRoaXMpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAob3B0aW9ucy5kYXRhICYmIG9wdGlvbnMuaWRzKSB7XG4gICAgICAgIGxldCBkYXRhID0gY3JlYXRlRnJhbWUob3B0aW9ucy5kYXRhKTtcbiAgICAgICAgZGF0YS5jb250ZXh0UGF0aCA9IGFwcGVuZENvbnRleHRQYXRoKG9wdGlvbnMuZGF0YS5jb250ZXh0UGF0aCwgb3B0aW9ucy5uYW1lKTtcbiAgICAgICAgb3B0aW9ucyA9IHtkYXRhOiBkYXRhfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZuKGNvbnRleHQsIG9wdGlvbnMpO1xuICAgIH1cbiAgfSk7XG59XG4iLCJpbXBvcnQge2FwcGVuZENvbnRleHRQYXRoLCBibG9ja1BhcmFtcywgY3JlYXRlRnJhbWUsIGlzQXJyYXksIGlzRnVuY3Rpb259IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCBFeGNlcHRpb24gZnJvbSAnLi4vZXhjZXB0aW9uJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ2VhY2gnLCBmdW5jdGlvbihjb250ZXh0LCBvcHRpb25zKSB7XG4gICAgaWYgKCFvcHRpb25zKSB7XG4gICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdNdXN0IHBhc3MgaXRlcmF0b3IgdG8gI2VhY2gnKTtcbiAgICB9XG5cbiAgICBsZXQgZm4gPSBvcHRpb25zLmZuLFxuICAgICAgICBpbnZlcnNlID0gb3B0aW9ucy5pbnZlcnNlLFxuICAgICAgICBpID0gMCxcbiAgICAgICAgcmV0ID0gJycsXG4gICAgICAgIGRhdGEsXG4gICAgICAgIGNvbnRleHRQYXRoO1xuXG4gICAgaWYgKG9wdGlvbnMuZGF0YSAmJiBvcHRpb25zLmlkcykge1xuICAgICAgY29udGV4dFBhdGggPSBhcHBlbmRDb250ZXh0UGF0aChvcHRpb25zLmRhdGEuY29udGV4dFBhdGgsIG9wdGlvbnMuaWRzWzBdKSArICcuJztcbiAgICB9XG5cbiAgICBpZiAoaXNGdW5jdGlvbihjb250ZXh0KSkgeyBjb250ZXh0ID0gY29udGV4dC5jYWxsKHRoaXMpOyB9XG5cbiAgICBpZiAob3B0aW9ucy5kYXRhKSB7XG4gICAgICBkYXRhID0gY3JlYXRlRnJhbWUob3B0aW9ucy5kYXRhKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBleGVjSXRlcmF0aW9uKGZpZWxkLCBpbmRleCwgbGFzdCkge1xuICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgZGF0YS5rZXkgPSBmaWVsZDtcbiAgICAgICAgZGF0YS5pbmRleCA9IGluZGV4O1xuICAgICAgICBkYXRhLmZpcnN0ID0gaW5kZXggPT09IDA7XG4gICAgICAgIGRhdGEubGFzdCA9ICEhbGFzdDtcblxuICAgICAgICBpZiAoY29udGV4dFBhdGgpIHtcbiAgICAgICAgICBkYXRhLmNvbnRleHRQYXRoID0gY29udGV4dFBhdGggKyBmaWVsZDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXQgPSByZXQgKyBmbihjb250ZXh0W2ZpZWxkXSwge1xuICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICBibG9ja1BhcmFtczogYmxvY2tQYXJhbXMoW2NvbnRleHRbZmllbGRdLCBmaWVsZF0sIFtjb250ZXh0UGF0aCArIGZpZWxkLCBudWxsXSlcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0ICYmIHR5cGVvZiBjb250ZXh0ID09PSAnb2JqZWN0Jykge1xuICAgICAgaWYgKGlzQXJyYXkoY29udGV4dCkpIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IGNvbnRleHQubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgaWYgKGkgaW4gY29udGV4dCkge1xuICAgICAgICAgICAgZXhlY0l0ZXJhdGlvbihpLCBpLCBpID09PSBjb250ZXh0Lmxlbmd0aCAtIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IHByaW9yS2V5O1xuXG4gICAgICAgIGZvciAobGV0IGtleSBpbiBjb250ZXh0KSB7XG4gICAgICAgICAgaWYgKGNvbnRleHQuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgLy8gV2UncmUgcnVubmluZyB0aGUgaXRlcmF0aW9ucyBvbmUgc3RlcCBvdXQgb2Ygc3luYyBzbyB3ZSBjYW4gZGV0ZWN0XG4gICAgICAgICAgICAvLyB0aGUgbGFzdCBpdGVyYXRpb24gd2l0aG91dCBoYXZlIHRvIHNjYW4gdGhlIG9iamVjdCB0d2ljZSBhbmQgY3JlYXRlXG4gICAgICAgICAgICAvLyBhbiBpdGVybWVkaWF0ZSBrZXlzIGFycmF5LlxuICAgICAgICAgICAgaWYgKHByaW9yS2V5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgZXhlY0l0ZXJhdGlvbihwcmlvcktleSwgaSAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJpb3JLZXkgPSBrZXk7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwcmlvcktleSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgZXhlY0l0ZXJhdGlvbihwcmlvcktleSwgaSAtIDEsIHRydWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGkgPT09IDApIHtcbiAgICAgIHJldCA9IGludmVyc2UodGhpcyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJldDtcbiAgfSk7XG59XG4iLCJpbXBvcnQgRXhjZXB0aW9uIGZyb20gJy4uL2V4Y2VwdGlvbic7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdoZWxwZXJNaXNzaW5nJywgZnVuY3Rpb24oLyogW2FyZ3MsIF1vcHRpb25zICovKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgIC8vIEEgbWlzc2luZyBmaWVsZCBpbiBhIHt7Zm9vfX0gY29uc3RydWN0LlxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU29tZW9uZSBpcyBhY3R1YWxseSB0cnlpbmcgdG8gY2FsbCBzb21ldGhpbmcsIGJsb3cgdXAuXG4gICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdNaXNzaW5nIGhlbHBlcjogXCInICsgYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAxXS5uYW1lICsgJ1wiJyk7XG4gICAgfVxuICB9KTtcbn1cbiIsImltcG9ydCB7aXNFbXB0eSwgaXNGdW5jdGlvbn0gZnJvbSAnLi4vdXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihpbnN0YW5jZSkge1xuICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignaWYnLCBmdW5jdGlvbihjb25kaXRpb25hbCwgb3B0aW9ucykge1xuICAgIGlmIChpc0Z1bmN0aW9uKGNvbmRpdGlvbmFsKSkgeyBjb25kaXRpb25hbCA9IGNvbmRpdGlvbmFsLmNhbGwodGhpcyk7IH1cblxuICAgIC8vIERlZmF1bHQgYmVoYXZpb3IgaXMgdG8gcmVuZGVyIHRoZSBwb3NpdGl2ZSBwYXRoIGlmIHRoZSB2YWx1ZSBpcyB0cnV0aHkgYW5kIG5vdCBlbXB0eS5cbiAgICAvLyBUaGUgYGluY2x1ZGVaZXJvYCBvcHRpb24gbWF5IGJlIHNldCB0byB0cmVhdCB0aGUgY29uZHRpb25hbCBhcyBwdXJlbHkgbm90IGVtcHR5IGJhc2VkIG9uIHRoZVxuICAgIC8vIGJlaGF2aW9yIG9mIGlzRW1wdHkuIEVmZmVjdGl2ZWx5IHRoaXMgZGV0ZXJtaW5lcyBpZiAwIGlzIGhhbmRsZWQgYnkgdGhlIHBvc2l0aXZlIHBhdGggb3IgbmVnYXRpdmUuXG4gICAgaWYgKCghb3B0aW9ucy5oYXNoLmluY2x1ZGVaZXJvICYmICFjb25kaXRpb25hbCkgfHwgaXNFbXB0eShjb25kaXRpb25hbCkpIHtcbiAgICAgIHJldHVybiBvcHRpb25zLmludmVyc2UodGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBvcHRpb25zLmZuKHRoaXMpO1xuICAgIH1cbiAgfSk7XG5cbiAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ3VubGVzcycsIGZ1bmN0aW9uKGNvbmRpdGlvbmFsLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIGluc3RhbmNlLmhlbHBlcnNbJ2lmJ10uY2FsbCh0aGlzLCBjb25kaXRpb25hbCwge2ZuOiBvcHRpb25zLmludmVyc2UsIGludmVyc2U6IG9wdGlvbnMuZm4sIGhhc2g6IG9wdGlvbnMuaGFzaH0pO1xuICB9KTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdsb2cnLCBmdW5jdGlvbigvKiBtZXNzYWdlLCBvcHRpb25zICovKSB7XG4gICAgbGV0IGFyZ3MgPSBbdW5kZWZpbmVkXSxcbiAgICAgICAgb3B0aW9ucyA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTtcbiAgICB9XG5cbiAgICBsZXQgbGV2ZWwgPSAxO1xuICAgIGlmIChvcHRpb25zLmhhc2gubGV2ZWwgIT0gbnVsbCkge1xuICAgICAgbGV2ZWwgPSBvcHRpb25zLmhhc2gubGV2ZWw7XG4gICAgfSBlbHNlIGlmIChvcHRpb25zLmRhdGEgJiYgb3B0aW9ucy5kYXRhLmxldmVsICE9IG51bGwpIHtcbiAgICAgIGxldmVsID0gb3B0aW9ucy5kYXRhLmxldmVsO1xuICAgIH1cbiAgICBhcmdzWzBdID0gbGV2ZWw7XG5cbiAgICBpbnN0YW5jZS5sb2coLi4uIGFyZ3MpO1xuICB9KTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdsb29rdXAnLCBmdW5jdGlvbihvYmosIGZpZWxkKSB7XG4gICAgcmV0dXJuIG9iaiAmJiBvYmpbZmllbGRdO1xuICB9KTtcbn1cbiIsImltcG9ydCB7YXBwZW5kQ29udGV4dFBhdGgsIGJsb2NrUGFyYW1zLCBjcmVhdGVGcmFtZSwgaXNFbXB0eSwgaXNGdW5jdGlvbn0gZnJvbSAnLi4vdXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihpbnN0YW5jZSkge1xuICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignd2l0aCcsIGZ1bmN0aW9uKGNvbnRleHQsIG9wdGlvbnMpIHtcbiAgICBpZiAoaXNGdW5jdGlvbihjb250ZXh0KSkgeyBjb250ZXh0ID0gY29udGV4dC5jYWxsKHRoaXMpOyB9XG5cbiAgICBsZXQgZm4gPSBvcHRpb25zLmZuO1xuXG4gICAgaWYgKCFpc0VtcHR5KGNvbnRleHQpKSB7XG4gICAgICBsZXQgZGF0YSA9IG9wdGlvbnMuZGF0YTtcbiAgICAgIGlmIChvcHRpb25zLmRhdGEgJiYgb3B0aW9ucy5pZHMpIHtcbiAgICAgICAgZGF0YSA9IGNyZWF0ZUZyYW1lKG9wdGlvbnMuZGF0YSk7XG4gICAgICAgIGRhdGEuY29udGV4dFBhdGggPSBhcHBlbmRDb250ZXh0UGF0aChvcHRpb25zLmRhdGEuY29udGV4dFBhdGgsIG9wdGlvbnMuaWRzWzBdKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZuKGNvbnRleHQsIHtcbiAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgYmxvY2tQYXJhbXM6IGJsb2NrUGFyYW1zKFtjb250ZXh0XSwgW2RhdGEgJiYgZGF0YS5jb250ZXh0UGF0aF0pXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG9wdGlvbnMuaW52ZXJzZSh0aGlzKTtcbiAgICB9XG4gIH0pO1xufVxuIiwiaW1wb3J0IHtpbmRleE9mfSBmcm9tICcuL3V0aWxzJztcblxubGV0IGxvZ2dlciA9IHtcbiAgbWV0aG9kTWFwOiBbJ2RlYnVnJywgJ2luZm8nLCAnd2FybicsICdlcnJvciddLFxuICBsZXZlbDogJ2luZm8nLFxuXG4gIC8vIE1hcHMgYSBnaXZlbiBsZXZlbCB2YWx1ZSB0byB0aGUgYG1ldGhvZE1hcGAgaW5kZXhlcyBhYm92ZS5cbiAgbG9va3VwTGV2ZWw6IGZ1bmN0aW9uKGxldmVsKSB7XG4gICAgaWYgKHR5cGVvZiBsZXZlbCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGxldCBsZXZlbE1hcCA9IGluZGV4T2YobG9nZ2VyLm1ldGhvZE1hcCwgbGV2ZWwudG9Mb3dlckNhc2UoKSk7XG4gICAgICBpZiAobGV2ZWxNYXAgPj0gMCkge1xuICAgICAgICBsZXZlbCA9IGxldmVsTWFwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV2ZWwgPSBwYXJzZUludChsZXZlbCwgMTApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBsZXZlbDtcbiAgfSxcblxuICAvLyBDYW4gYmUgb3ZlcnJpZGRlbiBpbiB0aGUgaG9zdCBlbnZpcm9ubWVudFxuICBsb2c6IGZ1bmN0aW9uKGxldmVsLCAuLi5tZXNzYWdlKSB7XG4gICAgbGV2ZWwgPSBsb2dnZXIubG9va3VwTGV2ZWwobGV2ZWwpO1xuXG4gICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBsb2dnZXIubG9va3VwTGV2ZWwobG9nZ2VyLmxldmVsKSA8PSBsZXZlbCkge1xuICAgICAgbGV0IG1ldGhvZCA9IGxvZ2dlci5tZXRob2RNYXBbbGV2ZWxdO1xuICAgICAgaWYgKCFjb25zb2xlW21ldGhvZF0pIHsgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgbWV0aG9kID0gJ2xvZyc7XG4gICAgICB9XG4gICAgICBjb25zb2xlW21ldGhvZF0oLi4ubWVzc2FnZSk7ICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgbG9nZ2VyO1xuIiwiLyogZ2xvYmFsIHdpbmRvdyAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oSGFuZGxlYmFycykge1xuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICBsZXQgcm9vdCA9IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogd2luZG93LFxuICAgICAgJEhhbmRsZWJhcnMgPSByb290LkhhbmRsZWJhcnM7XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gIEhhbmRsZWJhcnMubm9Db25mbGljdCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChyb290LkhhbmRsZWJhcnMgPT09IEhhbmRsZWJhcnMpIHtcbiAgICAgIHJvb3QuSGFuZGxlYmFycyA9ICRIYW5kbGViYXJzO1xuICAgIH1cbiAgICByZXR1cm4gSGFuZGxlYmFycztcbiAgfTtcbn1cbiIsImltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IEV4Y2VwdGlvbiBmcm9tICcuL2V4Y2VwdGlvbic7XG5pbXBvcnQgeyBDT01QSUxFUl9SRVZJU0lPTiwgUkVWSVNJT05fQ0hBTkdFUywgY3JlYXRlRnJhbWUgfSBmcm9tICcuL2Jhc2UnO1xuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tSZXZpc2lvbihjb21waWxlckluZm8pIHtcbiAgY29uc3QgY29tcGlsZXJSZXZpc2lvbiA9IGNvbXBpbGVySW5mbyAmJiBjb21waWxlckluZm9bMF0gfHwgMSxcbiAgICAgICAgY3VycmVudFJldmlzaW9uID0gQ09NUElMRVJfUkVWSVNJT047XG5cbiAgaWYgKGNvbXBpbGVyUmV2aXNpb24gIT09IGN1cnJlbnRSZXZpc2lvbikge1xuICAgIGlmIChjb21waWxlclJldmlzaW9uIDwgY3VycmVudFJldmlzaW9uKSB7XG4gICAgICBjb25zdCBydW50aW1lVmVyc2lvbnMgPSBSRVZJU0lPTl9DSEFOR0VTW2N1cnJlbnRSZXZpc2lvbl0sXG4gICAgICAgICAgICBjb21waWxlclZlcnNpb25zID0gUkVWSVNJT05fQ0hBTkdFU1tjb21waWxlclJldmlzaW9uXTtcbiAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ1RlbXBsYXRlIHdhcyBwcmVjb21waWxlZCB3aXRoIGFuIG9sZGVyIHZlcnNpb24gb2YgSGFuZGxlYmFycyB0aGFuIHRoZSBjdXJyZW50IHJ1bnRpbWUuICcgK1xuICAgICAgICAgICAgJ1BsZWFzZSB1cGRhdGUgeW91ciBwcmVjb21waWxlciB0byBhIG5ld2VyIHZlcnNpb24gKCcgKyBydW50aW1lVmVyc2lvbnMgKyAnKSBvciBkb3duZ3JhZGUgeW91ciBydW50aW1lIHRvIGFuIG9sZGVyIHZlcnNpb24gKCcgKyBjb21waWxlclZlcnNpb25zICsgJykuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFVzZSB0aGUgZW1iZWRkZWQgdmVyc2lvbiBpbmZvIHNpbmNlIHRoZSBydW50aW1lIGRvZXNuJ3Qga25vdyBhYm91dCB0aGlzIHJldmlzaW9uIHlldFxuICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignVGVtcGxhdGUgd2FzIHByZWNvbXBpbGVkIHdpdGggYSBuZXdlciB2ZXJzaW9uIG9mIEhhbmRsZWJhcnMgdGhhbiB0aGUgY3VycmVudCBydW50aW1lLiAnICtcbiAgICAgICAgICAgICdQbGVhc2UgdXBkYXRlIHlvdXIgcnVudGltZSB0byBhIG5ld2VyIHZlcnNpb24gKCcgKyBjb21waWxlckluZm9bMV0gKyAnKS4nKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRlbXBsYXRlKHRlbXBsYXRlU3BlYywgZW52KSB7XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gIGlmICghZW52KSB7XG4gICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignTm8gZW52aXJvbm1lbnQgcGFzc2VkIHRvIHRlbXBsYXRlJyk7XG4gIH1cbiAgaWYgKCF0ZW1wbGF0ZVNwZWMgfHwgIXRlbXBsYXRlU3BlYy5tYWluKSB7XG4gICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignVW5rbm93biB0ZW1wbGF0ZSBvYmplY3Q6ICcgKyB0eXBlb2YgdGVtcGxhdGVTcGVjKTtcbiAgfVxuXG4gIHRlbXBsYXRlU3BlYy5tYWluLmRlY29yYXRvciA9IHRlbXBsYXRlU3BlYy5tYWluX2Q7XG5cbiAgLy8gTm90ZTogVXNpbmcgZW52LlZNIHJlZmVyZW5jZXMgcmF0aGVyIHRoYW4gbG9jYWwgdmFyIHJlZmVyZW5jZXMgdGhyb3VnaG91dCB0aGlzIHNlY3Rpb24gdG8gYWxsb3dcbiAgLy8gZm9yIGV4dGVybmFsIHVzZXJzIHRvIG92ZXJyaWRlIHRoZXNlIGFzIHBzdWVkby1zdXBwb3J0ZWQgQVBJcy5cbiAgZW52LlZNLmNoZWNrUmV2aXNpb24odGVtcGxhdGVTcGVjLmNvbXBpbGVyKTtcblxuICBmdW5jdGlvbiBpbnZva2VQYXJ0aWFsV3JhcHBlcihwYXJ0aWFsLCBjb250ZXh0LCBvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMuaGFzaCkge1xuICAgICAgY29udGV4dCA9IFV0aWxzLmV4dGVuZCh7fSwgY29udGV4dCwgb3B0aW9ucy5oYXNoKTtcbiAgICAgIGlmIChvcHRpb25zLmlkcykge1xuICAgICAgICBvcHRpb25zLmlkc1swXSA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcGFydGlhbCA9IGVudi5WTS5yZXNvbHZlUGFydGlhbC5jYWxsKHRoaXMsIHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpO1xuICAgIGxldCByZXN1bHQgPSBlbnYuVk0uaW52b2tlUGFydGlhbC5jYWxsKHRoaXMsIHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpO1xuXG4gICAgaWYgKHJlc3VsdCA9PSBudWxsICYmIGVudi5jb21waWxlKSB7XG4gICAgICBvcHRpb25zLnBhcnRpYWxzW29wdGlvbnMubmFtZV0gPSBlbnYuY29tcGlsZShwYXJ0aWFsLCB0ZW1wbGF0ZVNwZWMuY29tcGlsZXJPcHRpb25zLCBlbnYpO1xuICAgICAgcmVzdWx0ID0gb3B0aW9ucy5wYXJ0aWFsc1tvcHRpb25zLm5hbWVdKGNvbnRleHQsIG9wdGlvbnMpO1xuICAgIH1cbiAgICBpZiAocmVzdWx0ICE9IG51bGwpIHtcbiAgICAgIGlmIChvcHRpb25zLmluZGVudCkge1xuICAgICAgICBsZXQgbGluZXMgPSByZXN1bHQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGxpbmVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgIGlmICghbGluZXNbaV0gJiYgaSArIDEgPT09IGwpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGxpbmVzW2ldID0gb3B0aW9ucy5pbmRlbnQgKyBsaW5lc1tpXTtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBsaW5lcy5qb2luKCdcXG4nKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ1RoZSBwYXJ0aWFsICcgKyBvcHRpb25zLm5hbWUgKyAnIGNvdWxkIG5vdCBiZSBjb21waWxlZCB3aGVuIHJ1bm5pbmcgaW4gcnVudGltZS1vbmx5IG1vZGUnKTtcbiAgICB9XG4gIH1cblxuICAvLyBKdXN0IGFkZCB3YXRlclxuICBsZXQgY29udGFpbmVyID0ge1xuICAgIHN0cmljdDogZnVuY3Rpb24ob2JqLCBuYW1lKSB7XG4gICAgICBpZiAoIShuYW1lIGluIG9iaikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignXCInICsgbmFtZSArICdcIiBub3QgZGVmaW5lZCBpbiAnICsgb2JqKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvYmpbbmFtZV07XG4gICAgfSxcbiAgICBsb29rdXA6IGZ1bmN0aW9uKGRlcHRocywgbmFtZSkge1xuICAgICAgY29uc3QgbGVuID0gZGVwdGhzLmxlbmd0aDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKGRlcHRoc1tpXSAmJiBkZXB0aHNbaV1bbmFtZV0gIT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiBkZXB0aHNbaV1bbmFtZV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGxhbWJkYTogZnVuY3Rpb24oY3VycmVudCwgY29udGV4dCkge1xuICAgICAgcmV0dXJuIHR5cGVvZiBjdXJyZW50ID09PSAnZnVuY3Rpb24nID8gY3VycmVudC5jYWxsKGNvbnRleHQpIDogY3VycmVudDtcbiAgICB9LFxuXG4gICAgZXNjYXBlRXhwcmVzc2lvbjogVXRpbHMuZXNjYXBlRXhwcmVzc2lvbixcbiAgICBpbnZva2VQYXJ0aWFsOiBpbnZva2VQYXJ0aWFsV3JhcHBlcixcblxuICAgIGZuOiBmdW5jdGlvbihpKSB7XG4gICAgICBsZXQgcmV0ID0gdGVtcGxhdGVTcGVjW2ldO1xuICAgICAgcmV0LmRlY29yYXRvciA9IHRlbXBsYXRlU3BlY1tpICsgJ19kJ107XG4gICAgICByZXR1cm4gcmV0O1xuICAgIH0sXG5cbiAgICBwcm9ncmFtczogW10sXG4gICAgcHJvZ3JhbTogZnVuY3Rpb24oaSwgZGF0YSwgZGVjbGFyZWRCbG9ja1BhcmFtcywgYmxvY2tQYXJhbXMsIGRlcHRocykge1xuICAgICAgbGV0IHByb2dyYW1XcmFwcGVyID0gdGhpcy5wcm9ncmFtc1tpXSxcbiAgICAgICAgICBmbiA9IHRoaXMuZm4oaSk7XG4gICAgICBpZiAoZGF0YSB8fCBkZXB0aHMgfHwgYmxvY2tQYXJhbXMgfHwgZGVjbGFyZWRCbG9ja1BhcmFtcykge1xuICAgICAgICBwcm9ncmFtV3JhcHBlciA9IHdyYXBQcm9ncmFtKHRoaXMsIGksIGZuLCBkYXRhLCBkZWNsYXJlZEJsb2NrUGFyYW1zLCBibG9ja1BhcmFtcywgZGVwdGhzKTtcbiAgICAgIH0gZWxzZSBpZiAoIXByb2dyYW1XcmFwcGVyKSB7XG4gICAgICAgIHByb2dyYW1XcmFwcGVyID0gdGhpcy5wcm9ncmFtc1tpXSA9IHdyYXBQcm9ncmFtKHRoaXMsIGksIGZuKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwcm9ncmFtV3JhcHBlcjtcbiAgICB9LFxuXG4gICAgZGF0YTogZnVuY3Rpb24odmFsdWUsIGRlcHRoKSB7XG4gICAgICB3aGlsZSAodmFsdWUgJiYgZGVwdGgtLSkge1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLl9wYXJlbnQ7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBtZXJnZTogZnVuY3Rpb24ocGFyYW0sIGNvbW1vbikge1xuICAgICAgbGV0IG9iaiA9IHBhcmFtIHx8IGNvbW1vbjtcblxuICAgICAgaWYgKHBhcmFtICYmIGNvbW1vbiAmJiAocGFyYW0gIT09IGNvbW1vbikpIHtcbiAgICAgICAgb2JqID0gVXRpbHMuZXh0ZW5kKHt9LCBjb21tb24sIHBhcmFtKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG9iajtcbiAgICB9LFxuXG4gICAgbm9vcDogZW52LlZNLm5vb3AsXG4gICAgY29tcGlsZXJJbmZvOiB0ZW1wbGF0ZVNwZWMuY29tcGlsZXJcbiAgfTtcblxuICBmdW5jdGlvbiByZXQoY29udGV4dCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgbGV0IGRhdGEgPSBvcHRpb25zLmRhdGE7XG5cbiAgICByZXQuX3NldHVwKG9wdGlvbnMpO1xuICAgIGlmICghb3B0aW9ucy5wYXJ0aWFsICYmIHRlbXBsYXRlU3BlYy51c2VEYXRhKSB7XG4gICAgICBkYXRhID0gaW5pdERhdGEoY29udGV4dCwgZGF0YSk7XG4gICAgfVxuICAgIGxldCBkZXB0aHMsXG4gICAgICAgIGJsb2NrUGFyYW1zID0gdGVtcGxhdGVTcGVjLnVzZUJsb2NrUGFyYW1zID8gW10gOiB1bmRlZmluZWQ7XG4gICAgaWYgKHRlbXBsYXRlU3BlYy51c2VEZXB0aHMpIHtcbiAgICAgIGlmIChvcHRpb25zLmRlcHRocykge1xuICAgICAgICBkZXB0aHMgPSBjb250ZXh0ICE9PSBvcHRpb25zLmRlcHRoc1swXSA/IFtjb250ZXh0XS5jb25jYXQob3B0aW9ucy5kZXB0aHMpIDogb3B0aW9ucy5kZXB0aHM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkZXB0aHMgPSBbY29udGV4dF07XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFpbihjb250ZXh0LyosIG9wdGlvbnMqLykge1xuICAgICAgcmV0dXJuICcnICsgdGVtcGxhdGVTcGVjLm1haW4oY29udGFpbmVyLCBjb250ZXh0LCBjb250YWluZXIuaGVscGVycywgY29udGFpbmVyLnBhcnRpYWxzLCBkYXRhLCBibG9ja1BhcmFtcywgZGVwdGhzKTtcbiAgICB9XG4gICAgbWFpbiA9IGV4ZWN1dGVEZWNvcmF0b3JzKHRlbXBsYXRlU3BlYy5tYWluLCBtYWluLCBjb250YWluZXIsIG9wdGlvbnMuZGVwdGhzIHx8IFtdLCBkYXRhLCBibG9ja1BhcmFtcyk7XG4gICAgcmV0dXJuIG1haW4oY29udGV4dCwgb3B0aW9ucyk7XG4gIH1cbiAgcmV0LmlzVG9wID0gdHJ1ZTtcblxuICByZXQuX3NldHVwID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucy5wYXJ0aWFsKSB7XG4gICAgICBjb250YWluZXIuaGVscGVycyA9IGNvbnRhaW5lci5tZXJnZShvcHRpb25zLmhlbHBlcnMsIGVudi5oZWxwZXJzKTtcblxuICAgICAgaWYgKHRlbXBsYXRlU3BlYy51c2VQYXJ0aWFsKSB7XG4gICAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IGNvbnRhaW5lci5tZXJnZShvcHRpb25zLnBhcnRpYWxzLCBlbnYucGFydGlhbHMpO1xuICAgICAgfVxuICAgICAgaWYgKHRlbXBsYXRlU3BlYy51c2VQYXJ0aWFsIHx8IHRlbXBsYXRlU3BlYy51c2VEZWNvcmF0b3JzKSB7XG4gICAgICAgIGNvbnRhaW5lci5kZWNvcmF0b3JzID0gY29udGFpbmVyLm1lcmdlKG9wdGlvbnMuZGVjb3JhdG9ycywgZW52LmRlY29yYXRvcnMpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb250YWluZXIuaGVscGVycyA9IG9wdGlvbnMuaGVscGVycztcbiAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IG9wdGlvbnMucGFydGlhbHM7XG4gICAgICBjb250YWluZXIuZGVjb3JhdG9ycyA9IG9wdGlvbnMuZGVjb3JhdG9ycztcbiAgICB9XG4gIH07XG5cbiAgcmV0Ll9jaGlsZCA9IGZ1bmN0aW9uKGksIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpIHtcbiAgICBpZiAodGVtcGxhdGVTcGVjLnVzZUJsb2NrUGFyYW1zICYmICFibG9ja1BhcmFtcykge1xuICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignbXVzdCBwYXNzIGJsb2NrIHBhcmFtcycpO1xuICAgIH1cbiAgICBpZiAodGVtcGxhdGVTcGVjLnVzZURlcHRocyAmJiAhZGVwdGhzKSB7XG4gICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdtdXN0IHBhc3MgcGFyZW50IGRlcHRocycpO1xuICAgIH1cblxuICAgIHJldHVybiB3cmFwUHJvZ3JhbShjb250YWluZXIsIGksIHRlbXBsYXRlU3BlY1tpXSwgZGF0YSwgMCwgYmxvY2tQYXJhbXMsIGRlcHRocyk7XG4gIH07XG4gIHJldHVybiByZXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3cmFwUHJvZ3JhbShjb250YWluZXIsIGksIGZuLCBkYXRhLCBkZWNsYXJlZEJsb2NrUGFyYW1zLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7XG4gIGZ1bmN0aW9uIHByb2coY29udGV4dCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgbGV0IGN1cnJlbnREZXB0aHMgPSBkZXB0aHM7XG4gICAgaWYgKGRlcHRocyAmJiBjb250ZXh0ICE9PSBkZXB0aHNbMF0pIHtcbiAgICAgIGN1cnJlbnREZXB0aHMgPSBbY29udGV4dF0uY29uY2F0KGRlcHRocyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZuKGNvbnRhaW5lcixcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgY29udGFpbmVyLmhlbHBlcnMsIGNvbnRhaW5lci5wYXJ0aWFscyxcbiAgICAgICAgb3B0aW9ucy5kYXRhIHx8IGRhdGEsXG4gICAgICAgIGJsb2NrUGFyYW1zICYmIFtvcHRpb25zLmJsb2NrUGFyYW1zXS5jb25jYXQoYmxvY2tQYXJhbXMpLFxuICAgICAgICBjdXJyZW50RGVwdGhzKTtcbiAgfVxuXG4gIHByb2cgPSBleGVjdXRlRGVjb3JhdG9ycyhmbiwgcHJvZywgY29udGFpbmVyLCBkZXB0aHMsIGRhdGEsIGJsb2NrUGFyYW1zKTtcblxuICBwcm9nLnByb2dyYW0gPSBpO1xuICBwcm9nLmRlcHRoID0gZGVwdGhzID8gZGVwdGhzLmxlbmd0aCA6IDA7XG4gIHByb2cuYmxvY2tQYXJhbXMgPSBkZWNsYXJlZEJsb2NrUGFyYW1zIHx8IDA7XG4gIHJldHVybiBwcm9nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZVBhcnRpYWwocGFydGlhbCwgY29udGV4dCwgb3B0aW9ucykge1xuICBpZiAoIXBhcnRpYWwpIHtcbiAgICBpZiAob3B0aW9ucy5uYW1lID09PSAnQHBhcnRpYWwtYmxvY2snKSB7XG4gICAgICBwYXJ0aWFsID0gb3B0aW9ucy5kYXRhWydwYXJ0aWFsLWJsb2NrJ107XG4gICAgfSBlbHNlIHtcbiAgICAgIHBhcnRpYWwgPSBvcHRpb25zLnBhcnRpYWxzW29wdGlvbnMubmFtZV07XG4gICAgfVxuICB9IGVsc2UgaWYgKCFwYXJ0aWFsLmNhbGwgJiYgIW9wdGlvbnMubmFtZSkge1xuICAgIC8vIFRoaXMgaXMgYSBkeW5hbWljIHBhcnRpYWwgdGhhdCByZXR1cm5lZCBhIHN0cmluZ1xuICAgIG9wdGlvbnMubmFtZSA9IHBhcnRpYWw7XG4gICAgcGFydGlhbCA9IG9wdGlvbnMucGFydGlhbHNbcGFydGlhbF07XG4gIH1cbiAgcmV0dXJuIHBhcnRpYWw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnZva2VQYXJ0aWFsKHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpIHtcbiAgb3B0aW9ucy5wYXJ0aWFsID0gdHJ1ZTtcbiAgaWYgKG9wdGlvbnMuaWRzKSB7XG4gICAgb3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoID0gb3B0aW9ucy5pZHNbMF0gfHwgb3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoO1xuICB9XG5cbiAgbGV0IHBhcnRpYWxCbG9jaztcbiAgaWYgKG9wdGlvbnMuZm4gJiYgb3B0aW9ucy5mbiAhPT0gbm9vcCkge1xuICAgIG9wdGlvbnMuZGF0YSA9IGNyZWF0ZUZyYW1lKG9wdGlvbnMuZGF0YSk7XG4gICAgcGFydGlhbEJsb2NrID0gb3B0aW9ucy5kYXRhWydwYXJ0aWFsLWJsb2NrJ10gPSBvcHRpb25zLmZuO1xuXG4gICAgaWYgKHBhcnRpYWxCbG9jay5wYXJ0aWFscykge1xuICAgICAgb3B0aW9ucy5wYXJ0aWFscyA9IFV0aWxzLmV4dGVuZCh7fSwgb3B0aW9ucy5wYXJ0aWFscywgcGFydGlhbEJsb2NrLnBhcnRpYWxzKTtcbiAgICB9XG4gIH1cblxuICBpZiAocGFydGlhbCA9PT0gdW5kZWZpbmVkICYmIHBhcnRpYWxCbG9jaykge1xuICAgIHBhcnRpYWwgPSBwYXJ0aWFsQmxvY2s7XG4gIH1cblxuICBpZiAocGFydGlhbCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignVGhlIHBhcnRpYWwgJyArIG9wdGlvbnMubmFtZSArICcgY291bGQgbm90IGJlIGZvdW5kJyk7XG4gIH0gZWxzZSBpZiAocGFydGlhbCBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgcmV0dXJuIHBhcnRpYWwoY29udGV4dCwgb3B0aW9ucyk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vb3AoKSB7IHJldHVybiAnJzsgfVxuXG5mdW5jdGlvbiBpbml0RGF0YShjb250ZXh0LCBkYXRhKSB7XG4gIGlmICghZGF0YSB8fCAhKCdyb290JyBpbiBkYXRhKSkge1xuICAgIGRhdGEgPSBkYXRhID8gY3JlYXRlRnJhbWUoZGF0YSkgOiB7fTtcbiAgICBkYXRhLnJvb3QgPSBjb250ZXh0O1xuICB9XG4gIHJldHVybiBkYXRhO1xufVxuXG5mdW5jdGlvbiBleGVjdXRlRGVjb3JhdG9ycyhmbiwgcHJvZywgY29udGFpbmVyLCBkZXB0aHMsIGRhdGEsIGJsb2NrUGFyYW1zKSB7XG4gIGlmIChmbi5kZWNvcmF0b3IpIHtcbiAgICBsZXQgcHJvcHMgPSB7fTtcbiAgICBwcm9nID0gZm4uZGVjb3JhdG9yKHByb2csIHByb3BzLCBjb250YWluZXIsIGRlcHRocyAmJiBkZXB0aHNbMF0sIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpO1xuICAgIFV0aWxzLmV4dGVuZChwcm9nLCBwcm9wcyk7XG4gIH1cbiAgcmV0dXJuIHByb2c7XG59XG4iLCIvLyBCdWlsZCBvdXQgb3VyIGJhc2ljIFNhZmVTdHJpbmcgdHlwZVxuZnVuY3Rpb24gU2FmZVN0cmluZyhzdHJpbmcpIHtcbiAgdGhpcy5zdHJpbmcgPSBzdHJpbmc7XG59XG5cblNhZmVTdHJpbmcucHJvdG90eXBlLnRvU3RyaW5nID0gU2FmZVN0cmluZy5wcm90b3R5cGUudG9IVE1MID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiAnJyArIHRoaXMuc3RyaW5nO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgU2FmZVN0cmluZztcbiIsImNvbnN0IGVzY2FwZSA9IHtcbiAgJyYnOiAnJmFtcDsnLFxuICAnPCc6ICcmbHQ7JyxcbiAgJz4nOiAnJmd0OycsXG4gICdcIic6ICcmcXVvdDsnLFxuICBcIidcIjogJyYjeDI3OycsXG4gICdgJzogJyYjeDYwOycsXG4gICc9JzogJyYjeDNEOydcbn07XG5cbmNvbnN0IGJhZENoYXJzID0gL1smPD5cIidgPV0vZyxcbiAgICAgIHBvc3NpYmxlID0gL1smPD5cIidgPV0vO1xuXG5mdW5jdGlvbiBlc2NhcGVDaGFyKGNocikge1xuICByZXR1cm4gZXNjYXBlW2Nocl07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRlbmQob2JqLyogLCAuLi5zb3VyY2UgKi8pIHtcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBrZXkgaW4gYXJndW1lbnRzW2ldKSB7XG4gICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGFyZ3VtZW50c1tpXSwga2V5KSkge1xuICAgICAgICBvYmpba2V5XSA9IGFyZ3VtZW50c1tpXVtrZXldO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvYmo7XG59XG5cbmV4cG9ydCBsZXQgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG4vLyBTb3VyY2VkIGZyb20gbG9kYXNoXG4vLyBodHRwczovL2dpdGh1Yi5jb20vYmVzdGllanMvbG9kYXNoL2Jsb2IvbWFzdGVyL0xJQ0VOU0UudHh0XG4vKiBlc2xpbnQtZGlzYWJsZSBmdW5jLXN0eWxlICovXG5sZXQgaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbic7XG59O1xuLy8gZmFsbGJhY2sgZm9yIG9sZGVyIHZlcnNpb25zIG9mIENocm9tZSBhbmQgU2FmYXJpXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuaWYgKGlzRnVuY3Rpb24oL3gvKSkge1xuICBpc0Z1bmN0aW9uID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nICYmIHRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAnW29iamVjdCBGdW5jdGlvbl0nO1xuICB9O1xufVxuZXhwb3J0IHtpc0Z1bmN0aW9ufTtcbi8qIGVzbGludC1lbmFibGUgZnVuYy1zdHlsZSAqL1xuXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuZXhwb3J0IGNvbnN0IGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JykgPyB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gJ1tvYmplY3QgQXJyYXldJyA6IGZhbHNlO1xufTtcblxuLy8gT2xkZXIgSUUgdmVyc2lvbnMgZG8gbm90IGRpcmVjdGx5IHN1cHBvcnQgaW5kZXhPZiBzbyB3ZSBtdXN0IGltcGxlbWVudCBvdXIgb3duLCBzYWRseS5cbmV4cG9ydCBmdW5jdGlvbiBpbmRleE9mKGFycmF5LCB2YWx1ZSkge1xuICBmb3IgKGxldCBpID0gMCwgbGVuID0gYXJyYXkubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBpZiAoYXJyYXlbaV0gPT09IHZhbHVlKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIC0xO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVFeHByZXNzaW9uKHN0cmluZykge1xuICBpZiAodHlwZW9mIHN0cmluZyAhPT0gJ3N0cmluZycpIHtcbiAgICAvLyBkb24ndCBlc2NhcGUgU2FmZVN0cmluZ3MsIHNpbmNlIHRoZXkncmUgYWxyZWFkeSBzYWZlXG4gICAgaWYgKHN0cmluZyAmJiBzdHJpbmcudG9IVE1MKSB7XG4gICAgICByZXR1cm4gc3RyaW5nLnRvSFRNTCgpO1xuICAgIH0gZWxzZSBpZiAoc3RyaW5nID09IG51bGwpIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9IGVsc2UgaWYgKCFzdHJpbmcpIHtcbiAgICAgIHJldHVybiBzdHJpbmcgKyAnJztcbiAgICB9XG5cbiAgICAvLyBGb3JjZSBhIHN0cmluZyBjb252ZXJzaW9uIGFzIHRoaXMgd2lsbCBiZSBkb25lIGJ5IHRoZSBhcHBlbmQgcmVnYXJkbGVzcyBhbmRcbiAgICAvLyB0aGUgcmVnZXggdGVzdCB3aWxsIGRvIHRoaXMgdHJhbnNwYXJlbnRseSBiZWhpbmQgdGhlIHNjZW5lcywgY2F1c2luZyBpc3N1ZXMgaWZcbiAgICAvLyBhbiBvYmplY3QncyB0byBzdHJpbmcgaGFzIGVzY2FwZWQgY2hhcmFjdGVycyBpbiBpdC5cbiAgICBzdHJpbmcgPSAnJyArIHN0cmluZztcbiAgfVxuXG4gIGlmICghcG9zc2libGUudGVzdChzdHJpbmcpKSB7IHJldHVybiBzdHJpbmc7IH1cbiAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKGJhZENoYXJzLCBlc2NhcGVDaGFyKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRW1wdHkodmFsdWUpIHtcbiAgaWYgKCF2YWx1ZSAmJiB2YWx1ZSAhPT0gMCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9IGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRnJhbWUob2JqZWN0KSB7XG4gIGxldCBmcmFtZSA9IGV4dGVuZCh7fSwgb2JqZWN0KTtcbiAgZnJhbWUuX3BhcmVudCA9IG9iamVjdDtcbiAgcmV0dXJuIGZyYW1lO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYmxvY2tQYXJhbXMocGFyYW1zLCBpZHMpIHtcbiAgcGFyYW1zLnBhdGggPSBpZHM7XG4gIHJldHVybiBwYXJhbXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhcHBlbmRDb250ZXh0UGF0aChjb250ZXh0UGF0aCwgaWQpIHtcbiAgcmV0dXJuIChjb250ZXh0UGF0aCA/IGNvbnRleHRQYXRoICsgJy4nIDogJycpICsgaWQ7XG59XG4iLCIvLyBDcmVhdGUgYSBzaW1wbGUgcGF0aCBhbGlhcyB0byBhbGxvdyBicm93c2VyaWZ5IHRvIHJlc29sdmVcbi8vIHRoZSBydW50aW1lIG9uIGEgc3VwcG9ydGVkIHBhdGguXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vZGlzdC9janMvaGFuZGxlYmFycy5ydW50aW1lJylbJ2RlZmF1bHQnXTtcbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImhhbmRsZWJhcnMvcnVudGltZVwiKVtcImRlZmF1bHRcIl07XG4iLCIoZnVuY3Rpb24gKGdsb2JhbCwgdW5kZWZpbmVkKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICBpZiAoZ2xvYmFsLnNldEltbWVkaWF0ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG5leHRIYW5kbGUgPSAxOyAvLyBTcGVjIHNheXMgZ3JlYXRlciB0aGFuIHplcm9cbiAgICB2YXIgdGFza3NCeUhhbmRsZSA9IHt9O1xuICAgIHZhciBjdXJyZW50bHlSdW5uaW5nQVRhc2sgPSBmYWxzZTtcbiAgICB2YXIgZG9jID0gZ2xvYmFsLmRvY3VtZW50O1xuICAgIHZhciByZWdpc3RlckltbWVkaWF0ZTtcblxuICAgIGZ1bmN0aW9uIHNldEltbWVkaWF0ZShjYWxsYmFjaykge1xuICAgICAgLy8gQ2FsbGJhY2sgY2FuIGVpdGhlciBiZSBhIGZ1bmN0aW9uIG9yIGEgc3RyaW5nXG4gICAgICBpZiAodHlwZW9mIGNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgICAgY2FsbGJhY2sgPSBuZXcgRnVuY3Rpb24oXCJcIiArIGNhbGxiYWNrKTtcbiAgICAgIH1cbiAgICAgIC8vIENvcHkgZnVuY3Rpb24gYXJndW1lbnRzXG4gICAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBhcmdzW2ldID0gYXJndW1lbnRzW2kgKyAxXTtcbiAgICAgIH1cbiAgICAgIC8vIFN0b3JlIGFuZCByZWdpc3RlciB0aGUgdGFza1xuICAgICAgdmFyIHRhc2sgPSB7IGNhbGxiYWNrOiBjYWxsYmFjaywgYXJnczogYXJncyB9O1xuICAgICAgdGFza3NCeUhhbmRsZVtuZXh0SGFuZGxlXSA9IHRhc2s7XG4gICAgICByZWdpc3RlckltbWVkaWF0ZShuZXh0SGFuZGxlKTtcbiAgICAgIHJldHVybiBuZXh0SGFuZGxlKys7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2xlYXJJbW1lZGlhdGUoaGFuZGxlKSB7XG4gICAgICAgIGRlbGV0ZSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcnVuKHRhc2spIHtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gdGFzay5jYWxsYmFjaztcbiAgICAgICAgdmFyIGFyZ3MgPSB0YXNrLmFyZ3M7XG4gICAgICAgIHN3aXRjaCAoYXJncy5sZW5ndGgpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICBjYWxsYmFjayhhcmdzWzBdLCBhcmdzWzFdLCBhcmdzWzJdKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY2FsbGJhY2suYXBwbHkodW5kZWZpbmVkLCBhcmdzKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcnVuSWZQcmVzZW50KGhhbmRsZSkge1xuICAgICAgICAvLyBGcm9tIHRoZSBzcGVjOiBcIldhaXQgdW50aWwgYW55IGludm9jYXRpb25zIG9mIHRoaXMgYWxnb3JpdGhtIHN0YXJ0ZWQgYmVmb3JlIHRoaXMgb25lIGhhdmUgY29tcGxldGVkLlwiXG4gICAgICAgIC8vIFNvIGlmIHdlJ3JlIGN1cnJlbnRseSBydW5uaW5nIGEgdGFzaywgd2UnbGwgbmVlZCB0byBkZWxheSB0aGlzIGludm9jYXRpb24uXG4gICAgICAgIGlmIChjdXJyZW50bHlSdW5uaW5nQVRhc2spIHtcbiAgICAgICAgICAgIC8vIERlbGF5IGJ5IGRvaW5nIGEgc2V0VGltZW91dC4gc2V0SW1tZWRpYXRlIHdhcyB0cmllZCBpbnN0ZWFkLCBidXQgaW4gRmlyZWZveCA3IGl0IGdlbmVyYXRlZCBhXG4gICAgICAgICAgICAvLyBcInRvbyBtdWNoIHJlY3Vyc2lvblwiIGVycm9yLlxuICAgICAgICAgICAgc2V0VGltZW91dChydW5JZlByZXNlbnQsIDAsIGhhbmRsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXIgdGFzayA9IHRhc2tzQnlIYW5kbGVbaGFuZGxlXTtcbiAgICAgICAgICAgIGlmICh0YXNrKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudGx5UnVubmluZ0FUYXNrID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBydW4odGFzayk7XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbW1lZGlhdGUoaGFuZGxlKTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5zdGFsbE5leHRUaWNrSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgICAgICBwcm9jZXNzLm5leHRUaWNrKGZ1bmN0aW9uICgpIHsgcnVuSWZQcmVzZW50KGhhbmRsZSk7IH0pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhblVzZVBvc3RNZXNzYWdlKCkge1xuICAgICAgICAvLyBUaGUgdGVzdCBhZ2FpbnN0IGBpbXBvcnRTY3JpcHRzYCBwcmV2ZW50cyB0aGlzIGltcGxlbWVudGF0aW9uIGZyb20gYmVpbmcgaW5zdGFsbGVkIGluc2lkZSBhIHdlYiB3b3JrZXIsXG4gICAgICAgIC8vIHdoZXJlIGBnbG9iYWwucG9zdE1lc3NhZ2VgIG1lYW5zIHNvbWV0aGluZyBjb21wbGV0ZWx5IGRpZmZlcmVudCBhbmQgY2FuJ3QgYmUgdXNlZCBmb3IgdGhpcyBwdXJwb3NlLlxuICAgICAgICBpZiAoZ2xvYmFsLnBvc3RNZXNzYWdlICYmICFnbG9iYWwuaW1wb3J0U2NyaXB0cykge1xuICAgICAgICAgICAgdmFyIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXMgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIG9sZE9uTWVzc2FnZSA9IGdsb2JhbC5vbm1lc3NhZ2U7XG4gICAgICAgICAgICBnbG9iYWwub25tZXNzYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcG9zdE1lc3NhZ2VJc0FzeW5jaHJvbm91cyA9IGZhbHNlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShcIlwiLCBcIipcIik7XG4gICAgICAgICAgICBnbG9iYWwub25tZXNzYWdlID0gb2xkT25NZXNzYWdlO1xuICAgICAgICAgICAgcmV0dXJuIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpIHtcbiAgICAgICAgLy8gSW5zdGFsbHMgYW4gZXZlbnQgaGFuZGxlciBvbiBgZ2xvYmFsYCBmb3IgdGhlIGBtZXNzYWdlYCBldmVudDogc2VlXG4gICAgICAgIC8vICogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vRE9NL3dpbmRvdy5wb3N0TWVzc2FnZVxuICAgICAgICAvLyAqIGh0dHA6Ly93d3cud2hhdHdnLm9yZy9zcGVjcy93ZWItYXBwcy9jdXJyZW50LXdvcmsvbXVsdGlwYWdlL2NvbW1zLmh0bWwjY3Jvc3NEb2N1bWVudE1lc3NhZ2VzXG5cbiAgICAgICAgdmFyIG1lc3NhZ2VQcmVmaXggPSBcInNldEltbWVkaWF0ZSRcIiArIE1hdGgucmFuZG9tKCkgKyBcIiRcIjtcbiAgICAgICAgdmFyIG9uR2xvYmFsTWVzc2FnZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBpZiAoZXZlbnQuc291cmNlID09PSBnbG9iYWwgJiZcbiAgICAgICAgICAgICAgICB0eXBlb2YgZXZlbnQuZGF0YSA9PT0gXCJzdHJpbmdcIiAmJlxuICAgICAgICAgICAgICAgIGV2ZW50LmRhdGEuaW5kZXhPZihtZXNzYWdlUHJlZml4KSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJ1bklmUHJlc2VudCgrZXZlbnQuZGF0YS5zbGljZShtZXNzYWdlUHJlZml4Lmxlbmd0aCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChnbG9iYWwuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG9uR2xvYmFsTWVzc2FnZSwgZmFsc2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2xvYmFsLmF0dGFjaEV2ZW50KFwib25tZXNzYWdlXCIsIG9uR2xvYmFsTWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgZ2xvYmFsLnBvc3RNZXNzYWdlKG1lc3NhZ2VQcmVmaXggKyBoYW5kbGUsIFwiKlwiKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsTWVzc2FnZUNoYW5uZWxJbXBsZW1lbnRhdGlvbigpIHtcbiAgICAgICAgdmFyIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTtcbiAgICAgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgdmFyIGhhbmRsZSA9IGV2ZW50LmRhdGE7XG4gICAgICAgICAgICBydW5JZlByZXNlbnQoaGFuZGxlKTtcbiAgICAgICAgfTtcblxuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZShoYW5kbGUpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHZhciBodG1sID0gZG9jLmRvY3VtZW50RWxlbWVudDtcbiAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIC8vIENyZWF0ZSBhIDxzY3JpcHQ+IGVsZW1lbnQ7IGl0cyByZWFkeXN0YXRlY2hhbmdlIGV2ZW50IHdpbGwgYmUgZmlyZWQgYXN5bmNocm9ub3VzbHkgb25jZSBpdCBpcyBpbnNlcnRlZFxuICAgICAgICAgICAgLy8gaW50byB0aGUgZG9jdW1lbnQuIERvIHNvLCB0aHVzIHF1ZXVpbmcgdXAgdGhlIHRhc2suIFJlbWVtYmVyIHRvIGNsZWFuIHVwIG9uY2UgaXQncyBiZWVuIGNhbGxlZC5cbiAgICAgICAgICAgIHZhciBzY3JpcHQgPSBkb2MuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcbiAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcnVuSWZQcmVzZW50KGhhbmRsZSk7XG4gICAgICAgICAgICAgICAgc2NyaXB0Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgaHRtbC5yZW1vdmVDaGlsZChzY3JpcHQpO1xuICAgICAgICAgICAgICAgIHNjcmlwdCA9IG51bGw7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaHRtbC5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc3RhbGxTZXRUaW1lb3V0SW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KHJ1bklmUHJlc2VudCwgMCwgaGFuZGxlKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvLyBJZiBzdXBwb3J0ZWQsIHdlIHNob3VsZCBhdHRhY2ggdG8gdGhlIHByb3RvdHlwZSBvZiBnbG9iYWwsIHNpbmNlIHRoYXQgaXMgd2hlcmUgc2V0VGltZW91dCBldCBhbC4gbGl2ZS5cbiAgICB2YXIgYXR0YWNoVG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgJiYgT2JqZWN0LmdldFByb3RvdHlwZU9mKGdsb2JhbCk7XG4gICAgYXR0YWNoVG8gPSBhdHRhY2hUbyAmJiBhdHRhY2hUby5zZXRUaW1lb3V0ID8gYXR0YWNoVG8gOiBnbG9iYWw7XG5cbiAgICAvLyBEb24ndCBnZXQgZm9vbGVkIGJ5IGUuZy4gYnJvd3NlcmlmeSBlbnZpcm9ubWVudHMuXG4gICAgaWYgKHt9LnRvU3RyaW5nLmNhbGwoZ2xvYmFsLnByb2Nlc3MpID09PSBcIltvYmplY3QgcHJvY2Vzc11cIikge1xuICAgICAgICAvLyBGb3IgTm9kZS5qcyBiZWZvcmUgMC45XG4gICAgICAgIGluc3RhbGxOZXh0VGlja0ltcGxlbWVudGF0aW9uKCk7XG5cbiAgICB9IGVsc2UgaWYgKGNhblVzZVBvc3RNZXNzYWdlKCkpIHtcbiAgICAgICAgLy8gRm9yIG5vbi1JRTEwIG1vZGVybiBicm93c2Vyc1xuICAgICAgICBpbnN0YWxsUG9zdE1lc3NhZ2VJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgfSBlbHNlIGlmIChnbG9iYWwuTWVzc2FnZUNoYW5uZWwpIHtcbiAgICAgICAgLy8gRm9yIHdlYiB3b3JrZXJzLCB3aGVyZSBzdXBwb3J0ZWRcbiAgICAgICAgaW5zdGFsbE1lc3NhZ2VDaGFubmVsSW1wbGVtZW50YXRpb24oKTtcblxuICAgIH0gZWxzZSBpZiAoZG9jICYmIFwib25yZWFkeXN0YXRlY2hhbmdlXCIgaW4gZG9jLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIikpIHtcbiAgICAgICAgLy8gRm9yIElFIDbigJM4XG4gICAgICAgIGluc3RhbGxSZWFkeVN0YXRlQ2hhbmdlSW1wbGVtZW50YXRpb24oKTtcblxuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZvciBvbGRlciBicm93c2Vyc1xuICAgICAgICBpbnN0YWxsU2V0VGltZW91dEltcGxlbWVudGF0aW9uKCk7XG4gICAgfVxuXG4gICAgYXR0YWNoVG8uc2V0SW1tZWRpYXRlID0gc2V0SW1tZWRpYXRlO1xuICAgIGF0dGFjaFRvLmNsZWFySW1tZWRpYXRlID0gY2xlYXJJbW1lZGlhdGU7XG59KHR5cGVvZiBzZWxmID09PSBcInVuZGVmaW5lZFwiID8gdHlwZW9mIGdsb2JhbCA9PT0gXCJ1bmRlZmluZWRcIiA/IHRoaXMgOiBnbG9iYWwgOiBzZWxmKSk7XG4iLCJ2YXIgdHJpbSA9IHJlcXVpcmUoJy4vdHJpbScpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRhc2hlcml6ZShzdHIpIHtcbiAgcmV0dXJuIHRyaW0oc3RyKS5yZXBsYWNlKC8oW0EtWl0pL2csICctJDEnKS5yZXBsYWNlKC9bLV9cXHNdKy9nLCAnLScpLnRvTG93ZXJDYXNlKCk7XG59O1xuIiwidmFyIGVzY2FwZVJlZ0V4cCA9IHJlcXVpcmUoJy4vZXNjYXBlUmVnRXhwJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGVmYXVsdFRvV2hpdGVTcGFjZShjaGFyYWN0ZXJzKSB7XG4gIGlmIChjaGFyYWN0ZXJzID09IG51bGwpXG4gICAgcmV0dXJuICdcXFxccyc7XG4gIGVsc2UgaWYgKGNoYXJhY3RlcnMuc291cmNlKVxuICAgIHJldHVybiBjaGFyYWN0ZXJzLnNvdXJjZTtcbiAgZWxzZVxuICAgIHJldHVybiAnWycgKyBlc2NhcGVSZWdFeHAoY2hhcmFjdGVycykgKyAnXSc7XG59O1xuIiwidmFyIG1ha2VTdHJpbmcgPSByZXF1aXJlKCcuL21ha2VTdHJpbmcnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBlc2NhcGVSZWdFeHAoc3RyKSB7XG4gIHJldHVybiBtYWtlU3RyaW5nKHN0cikucmVwbGFjZSgvKFsuKis/Xj0hOiR7fSgpfFtcXF1cXC9cXFxcXSkvZywgJ1xcXFwkMScpO1xufTtcbiIsIi8qKlxuICogRW5zdXJlIHNvbWUgb2JqZWN0IGlzIGEgY29lcmNlZCB0byBhIHN0cmluZ1xuICoqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBtYWtlU3RyaW5nKG9iamVjdCkge1xuICBpZiAob2JqZWN0ID09IG51bGwpIHJldHVybiAnJztcbiAgcmV0dXJuICcnICsgb2JqZWN0O1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gc3RyUmVwZWF0KHN0ciwgcXR5KXtcbiAgaWYgKHF0eSA8IDEpIHJldHVybiAnJztcbiAgdmFyIHJlc3VsdCA9ICcnO1xuICB3aGlsZSAocXR5ID4gMCkge1xuICAgIGlmIChxdHkgJiAxKSByZXN1bHQgKz0gc3RyO1xuICAgIHF0eSA+Pj0gMSwgc3RyICs9IHN0cjtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufTtcbiIsInZhciBwYWQgPSByZXF1aXJlKCcuL3BhZCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGxwYWQoc3RyLCBsZW5ndGgsIHBhZFN0cikge1xuICByZXR1cm4gcGFkKHN0ciwgbGVuZ3RoLCBwYWRTdHIpO1xufTtcbiIsInZhciBtYWtlU3RyaW5nID0gcmVxdWlyZSgnLi9oZWxwZXIvbWFrZVN0cmluZycpO1xudmFyIHN0clJlcGVhdCA9IHJlcXVpcmUoJy4vaGVscGVyL3N0clJlcGVhdCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHBhZChzdHIsIGxlbmd0aCwgcGFkU3RyLCB0eXBlKSB7XG4gIHN0ciA9IG1ha2VTdHJpbmcoc3RyKTtcbiAgbGVuZ3RoID0gfn5sZW5ndGg7XG5cbiAgdmFyIHBhZGxlbiA9IDA7XG5cbiAgaWYgKCFwYWRTdHIpXG4gICAgcGFkU3RyID0gJyAnO1xuICBlbHNlIGlmIChwYWRTdHIubGVuZ3RoID4gMSlcbiAgICBwYWRTdHIgPSBwYWRTdHIuY2hhckF0KDApO1xuXG4gIHN3aXRjaCAodHlwZSkge1xuICBjYXNlICdyaWdodCc6XG4gICAgcGFkbGVuID0gbGVuZ3RoIC0gc3RyLmxlbmd0aDtcbiAgICByZXR1cm4gc3RyICsgc3RyUmVwZWF0KHBhZFN0ciwgcGFkbGVuKTtcbiAgY2FzZSAnYm90aCc6XG4gICAgcGFkbGVuID0gbGVuZ3RoIC0gc3RyLmxlbmd0aDtcbiAgICByZXR1cm4gc3RyUmVwZWF0KHBhZFN0ciwgTWF0aC5jZWlsKHBhZGxlbiAvIDIpKSArIHN0ciArIHN0clJlcGVhdChwYWRTdHIsIE1hdGguZmxvb3IocGFkbGVuIC8gMikpO1xuICBkZWZhdWx0OiAvLyAnbGVmdCdcbiAgICBwYWRsZW4gPSBsZW5ndGggLSBzdHIubGVuZ3RoO1xuICAgIHJldHVybiBzdHJSZXBlYXQocGFkU3RyLCBwYWRsZW4pICsgc3RyO1xuICB9XG59O1xuIiwidmFyIHBhZCA9IHJlcXVpcmUoJy4vcGFkJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gcnBhZChzdHIsIGxlbmd0aCwgcGFkU3RyKSB7XG4gIHJldHVybiBwYWQoc3RyLCBsZW5ndGgsIHBhZFN0ciwgJ3JpZ2h0Jyk7XG59O1xuIiwidmFyIG1ha2VTdHJpbmcgPSByZXF1aXJlKCcuL2hlbHBlci9tYWtlU3RyaW5nJyk7XG52YXIgZGVmYXVsdFRvV2hpdGVTcGFjZSA9IHJlcXVpcmUoJy4vaGVscGVyL2RlZmF1bHRUb1doaXRlU3BhY2UnKTtcbnZhciBuYXRpdmVUcmltID0gU3RyaW5nLnByb3RvdHlwZS50cmltO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHRyaW0oc3RyLCBjaGFyYWN0ZXJzKSB7XG4gIHN0ciA9IG1ha2VTdHJpbmcoc3RyKTtcbiAgaWYgKCFjaGFyYWN0ZXJzICYmIG5hdGl2ZVRyaW0pIHJldHVybiBuYXRpdmVUcmltLmNhbGwoc3RyKTtcbiAgY2hhcmFjdGVycyA9IGRlZmF1bHRUb1doaXRlU3BhY2UoY2hhcmFjdGVycyk7XG4gIHJldHVybiBzdHIucmVwbGFjZShuZXcgUmVnRXhwKCdeJyArIGNoYXJhY3RlcnMgKyAnK3wnICsgY2hhcmFjdGVycyArICcrJCcsICdnJyksICcnKTtcbn07XG4iLCIvKipcbi8qIEBtb2R1bGUgYXBwL0FwcFxuLyovXG5cInVzZSBzdHJpY3RcIjtcblxuY29uc29sZS5pbmZvKFwiUG9ydGZvbGlvIEFwcCBzdGFydGVkXCIpO1xuXG5pZiAoIURFQlVHKSB7XG5cdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgZnVuY3Rpb24oZXYpIHtcblx0XHRjb25zb2xlLmVycm9yKFwiVW5jYXVnaHQgRXJyb3JcIiwgZXYpO1xuXHR9KTtcbn1cblxucmVxdWlyZShcIk1vZGVybml6clwiKTtcbnJlcXVpcmUoXCJlczYtcHJvbWlzZVwiKS5wb2x5ZmlsbCgpO1xucmVxdWlyZShcImNsYXNzbGlzdC1wb2x5ZmlsbFwiKTtcbnJlcXVpcmUoXCJyYWYtcG9seWZpbGxcIik7XG5yZXF1aXJlKFwibWF0Y2hlcy1wb2x5ZmlsbFwiKTtcbnJlcXVpcmUoXCJmdWxsc2NyZWVuLXBvbHlmaWxsXCIpO1xucmVxdWlyZShcIm1hdGgtc2lnbi1wb2x5ZmlsbFwiKTtcbnJlcXVpcmUoXCJzZXRpbW1lZGlhdGVcIik7XG5cbnJlcXVpcmUoXCJiYWNrYm9uZVwiKS4kID0gcmVxdWlyZShcImJhY2tib25lLm5hdGl2ZVwiKTtcbnJlcXVpcmUoXCJiYWNrYm9uZS5iYWJ5c2l0dGVyXCIpO1xucmVxdWlyZShcIkJhY2tib25lLk11dGF0b3JzXCIpO1xucmVxdWlyZShcImhhbW1lcmpzXCIpO1xuXG4vLyBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24oZXYpIHtcbi8vIFx0Y29uc29sZS5sb2coXCIlczpbZXZlbnQgJXNdXCIsIGV2LnRhcmdldCwgZXYudHlwZSk7XG4vLyB9KTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsIGZ1bmN0aW9uKGV2KSB7XG5cdGNvbnNvbGUubG9nKFwiJXM6W2V2ZW50ICVzXVwiLCBldi50YXJnZXQsIGV2LnR5cGUpO1xuXG5cdC8vIHByb2Nlc3MgYm9vdHN0cmFwIGRhdGEsIGxldCBlcnJvcnMgZ28gdXAgdGhlIHN0YWNrXG5cdHRyeSB7XG5cdFx0cmVxdWlyZShcImFwcC9tb2RlbC9oZWxwZXIvYm9vdHN0cmFwXCIpKHdpbmRvdy5ib290c3RyYXApO1xuXHR9IGNhdGNoIChlcnIpIHtcblx0XHR2YXIgZWwgPSBkb2N1bWVudC5zZWxlY3RRdWVyeShcIi5hcHBcIik7XG5cdFx0ZWwuY2xhc3NMaXN0LnJlbW92ZShcImFwcC1pbml0aWFsXCIpO1xuXHRcdGVsLmNsYXNzTGlzdC5hZGQoXCJhcHAtZXJyb3JcIik7XG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiYm9vdHN0cmFwIGRhdGEgZXJyb3IgKFwiICsgZXJyLm1lc3NhZ2UgKyBcIilcIiwgZXJyLmZpbGVOYW1lLCBlcnIubGluZU51bWJlcik7XG5cdH0gZmluYWxseSB7IC8vIGRldGVsZSBnbG9iYWwgdmFyXG5cdFx0ZGVsZXRlIHdpbmRvdy5ib290c3RyYXA7XG5cdH1cblxuXHRyZXF1aXJlKFwiYXBwL3ZpZXcvdGVtcGxhdGUvX2hlbHBlcnNcIik7XG5cdC8vIHJlcXVpcmUoXCJhcHAvdmlldy90ZW1wbGF0ZS9fcGFydGlhbHNcIik7XG5cdC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2hlbHBlci9jcmVhdGVDb2xvclN0eWxlU2hlZXR9ICovXG5cdHJlcXVpcmUoXCJhcHAvdmlldy9oZWxwZXIvY3JlYXRlQ29sb3JTdHlsZVNoZWV0XCIpLmNhbGwoKTtcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9BcHBWaWV3fSAqL1xuXHR2YXIgQXBwVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9BcHBWaWV3XCIpO1xuXG5cdC8qKiBAdHlwZSB7bW9kdWxlOndlYmZvbnRsb2FkZXJ9ICovXG5cdHZhciBXZWJGb250ID0gcmVxdWlyZShcIndlYmZvbnRsb2FkZXJcIik7XG5cdFdlYkZvbnQubG9hZCh7XG5cdFx0YXN5bmM6IHRydWUsXG5cdFx0Y2xhc3NlczogZmFsc2UsXG5cdFx0Y3VzdG9tOiB7XG5cdFx0XHRmYW1pbGllczogW1xuXHRcdFx0XHQvLyBcIkZyYW5rbGluIEdvdGhpYyBGUzpuNCxuN1wiLFxuXHRcdFx0XHRcIkZyYW5rbGluIEdvdGhpYyBGUzpuNCxpNCxuNyxpN1wiLFxuXHRcdFx0XHRcIkZvbGlvRmlndXJlczpuNFwiLFxuXHRcdFx0XSxcblx0XHRcdHRlc3RTdHJpbmdzOiB7XG5cdFx0XHRcdFwiRm9saW9GaWd1cmVzXCI6IFwiaG1zXCJcblx0XHRcdH0sXG5cdFx0fSxcblx0XHRhY3RpdmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0Y29uc29sZS5pbmZvKFwiV2ViRm9udDo6YWN0aXZlXCIpO1xuXHRcdFx0Ly8gQXBwVmlldy5nZXRJbnN0YW5jZSgpO1xuXHRcdH0sXG5cdFx0Zm9udGFjdGl2ZTogZnVuY3Rpb24oZmFtaWx5TmFtZSwgdmFyaWFudEZ2ZCkge1xuXHRcdFx0Y29uc29sZS5pbmZvKFwiV2ViRm9udDo6Zm9udGFjdGl2ZSAnJXMnICglcylcIiwgZmFtaWx5TmFtZSwgdmFyaWFudEZ2ZCk7XG5cdFx0fSxcblx0XHRpbmFjdGl2ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJXZWJGb250OjppbmFjdGl2ZVwiKTtcblx0XHRcdC8vIEFwcFZpZXcuZ2V0SW5zdGFuY2UoKTtcblx0XHR9LFxuXHRcdGZvbnRpbmFjdGl2ZTogZnVuY3Rpb24oZmFtaWx5TmFtZSwgdmFyaWFudEZ2ZCkge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiV2ViRm9udDo6Zm9udGluYWN0aXZlICclcycgKCVzKVwiLCBmYW1pbHlOYW1lLCB2YXJpYW50RnZkKTtcblx0XHR9LFxuXHRcdC8vIGxvYWRpbmc6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCJXZWJGb250Ojpsb2FkaW5nXCIpO1xuXHRcdC8vIH0sXG5cdFx0Ly8gZm9udGxvYWRpbmc6IGZ1bmN0aW9uKGZhbWlseU5hbWUsIHZhcmlhbnREZXNjKSB7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhcIldlYkZvbnQ6OmZvbnRsb2FkaW5nXCIsIGZhbWlseU5hbWUsIEpTT04uc3RyaW5naWZ5KHZhcmlhbnREZXNjLCBudWxsLCBcIiBcIikpO1xuXHRcdC8vIH0sXG5cdH0pO1xuXHRBcHBWaWV3LmdldEluc3RhbmNlKCk7XG59KTtcblxuXG5pZiAoREVCVUcpIHtcblx0Ly8gLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cblx0Ly8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxuXHQvLyB2YXIgaXNGRiA9IC9GaXJlZm94Ly50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcblx0Ly8gdmFyIGlzSU9TID0gL2lQYWR8aVBob25lLy50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcblx0Lypcblx0aWYgKC9GaXJlZm94Ly50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KSkge1xuXHRcdGNvbnNvbGUucHJlZml4ID0gXCIjIFwiO1xuXHRcdHZhciBzaGlmdCA9IFtdLnNoaWZ0O1xuXHRcdHZhciBsb2dXcmFwRm4gPSBmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0eXBlb2YgYXJndW1lbnRzWzFdID09IFwic3RyaW5nXCIpIGFyZ3VtZW50c1sxXSA9IGNvbnNvbGUucHJlZml4ICsgYXJndW1lbnRzWzFdO1xuXHRcdFx0cmV0dXJuIHNoaWZ0LmFwcGx5KGFyZ3VtZW50cykuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcblx0XHR9O1xuXHRcdGNvbnNvbGUuZ3JvdXAgPSBfLndyYXAoY29uc29sZS5ncm91cCwgbG9nV3JhcEZuKTtcblx0XHRjb25zb2xlLmxvZyA9IF8ud3JhcChjb25zb2xlLmxvZywgbG9nV3JhcEZuKTtcblx0XHRjb25zb2xlLmluZm8gPSBfLndyYXAoY29uc29sZS5pbmZvLCBsb2dXcmFwRm4pO1xuXHRcdGNvbnNvbGUud2FybiA9IF8ud3JhcChjb25zb2xlLndhcm4sIGxvZ1dyYXBGbik7XG5cdFx0Y29uc29sZS5lcnJvciA9IF8ud3JhcChjb25zb2xlLmVycm9yLCBsb2dXcmFwRm4pO1xuXHR9XG5cdCovXG5cdC8qXG5cdHZhciBzYXZlTG9ncyA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBsb2dXcmFwRm4gPSBmdW5jdGlvbihuYW1lLCBmbiwgbXNnKSB7XG5cdFx0XHRkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdGRvY3VtZW50LmNyZWF0ZUNvbW1lbnQoXCJbXCIgKyBuYW1lICsgXCJdIFwiICsgbXNnKSk7XG5cdFx0fTtcblx0XHRjb25zb2xlLmdyb3VwID0gXy53cmFwKGNvbnNvbGUuZ3JvdXAsIF8ucGFydGlhbChsb2dXcmFwRm4sIFwiZ3JvdXBcIikpO1xuXHRcdGNvbnNvbGUubG9nID0gXy53cmFwKGNvbnNvbGUubG9nLCBfLnBhcnRpYWwobG9nV3JhcEZuLCBcImxvZ1wiKSk7XG5cdFx0Y29uc29sZS5pbmZvID0gXy53cmFwKGNvbnNvbGUuaW5mbywgXy5wYXJ0aWFsKGxvZ1dyYXBGbiwgXCJpbmZvXCIpKTtcblx0XHRjb25zb2xlLndhcm4gPSBfLndyYXAoY29uc29sZS53YXJuLCBfLnBhcnRpYWwobG9nV3JhcEZuLCBcIndhcm5cIikpO1xuXHRcdGNvbnNvbGUuZXJyb3IgPSBfLndyYXAoY29uc29sZS5lcnJvciwgXy5wYXJ0aWFsKGxvZ1dyYXBGbiwgXCJlcnJvclwiKSk7XG5cdH07XG5cdCovXG5cblx0Ly8gaGFuZGxlIGVycm9yIGV2ZW50cyBvbiBzb21lIHBsYXRmb3JtcyBhbmQgcHJvZHVjdGlvblxuXHQvKlxuXHRpZiAoaXNJT1MpIHtcblx0XHQvLyBzYXZlTG9ncygpO1xuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpLFxuXHRcdFx0XHRlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdFx0XHRcdGh0bWwgPSBcIlwiO1xuXHRcdFx0Xy5leHRlbmQoZWwuc3R5bGUsIHtcblx0XHRcdFx0Zm9udGZhbWlseTogXCJtb25vc3BhY2VcIixcblx0XHRcdFx0ZGlzcGxheTogXCJibG9ja1wiLFxuXHRcdFx0XHRwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuXHRcdFx0XHR6SW5kZXg6IFwiOTk5XCIsXG5cdFx0XHRcdGJhY2tncm91bmRDb2xvcjogXCJ3aGl0ZVwiLFxuXHRcdFx0XHRjb2xvcjogXCJibGFja1wiLFxuXHRcdFx0XHR3aWR0aDogXCJjYWxjKDEwMCUgLSAzZW0pXCIsXG5cdFx0XHRcdGJvdHRvbTogXCIwXCIsXG5cdFx0XHRcdG1hcmdpbjogXCIxZW0gMS41ZW1cIixcblx0XHRcdFx0cGFkZGluZzogXCIxZW0gMS41ZW1cIixcblx0XHRcdFx0b3V0bGluZTogXCIwLjVlbSBzb2xpZCByZWRcIixcblx0XHRcdFx0b3V0bGluZU9mZnNldDogXCIwLjVlbVwiLFxuXHRcdFx0XHRib3hTaXppbmc6IFwiYm9yZGVyLWJveFwiLFxuXHRcdFx0XHRvdmVyZmxvdzogXCJoaWRkZW5cIixcblx0XHRcdH0pO1xuXHRcdFx0aHRtbCArPSBcIjxwcmU+PGI+bG9jYXRpb246PGI+IFwiICsgd2luZG93LmxvY2F0aW9uICsgXCI8L3ByZT5cIjtcblx0XHRcdGh0bWwgKz0gXCI8cHJlPjxiPmV2ZW50OjxiPiBcIiArIEpTT04uc3RyaW5naWZ5KGFyZ3Muc2hpZnQoKSwgbnVsbCwgXCIgXCIpICsgXCI8L3ByZT5cIjtcblx0XHRcdGlmIChhcmdzLmxlbmd0aCkgaHRtbCArPSBcIjxwcmU+PGI+cmVzdDo8Yj4gXCIgKyBKU09OLnN0cmluZ2lmeShhcmdzLCBudWxsLCBcIiBcIikgKyBcIjwvcHJlPlwiO1xuXHRcdFx0ZWwuaW5uZXJIVE1MID0gaHRtbDtcblx0XHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZWwpO1xuXHRcdH0pO1xuXHR9Ki9cbn0iLCIvKipcbi8qIEBtb2R1bGUgYXBwL2NvbnRyb2wvQ29udHJvbGxlclxuLyovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG52YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9ufSAqL1xuLy8gdmFyIHR5cGVzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9uXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vS2V5d29yZENvbGxlY3Rpb259ICovXG4vLyB2YXIga2V5d29yZHMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vS2V5d29yZENvbGxlY3Rpb25cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvbn0gKi9cbnZhciBhcnRpY2xlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvblwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb259ICovXG52YXIgYnVuZGxlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uXCIpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuLyogU3RhdGljIHByaXZhdGVcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vKipcbi8qIEBjb25zdHJ1Y3RvclxuLyogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9Db250cm9sbGVyfVxuLyovXG52YXIgQ29udHJvbGxlciA9IEJhY2tib25lLlJvdXRlci5leHRlbmQoe1xuXG5cdC8vIC8qKiBAb3ZlcnJpZGUgKi9cblx0Ly8gcm91dGVzOiB7fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLl9yb3V0ZU5hbWVzID0gW107XG5cblx0XHRpZiAoREVCVUcpIHtcblx0XHRcdHRoaXMub24oXCJyb3V0ZVwiLCBmdW5jdGlvbihyb3V0ZU5hbWUsIGFyZ3MpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJjb250cm9sbGVyOltyb3V0ZV0gJXMgWyVzXVwiLCByb3V0ZU5hbWUsIGFyZ3Muam9pbigpKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8qXG5cdFx0ICogUHJlZml4ZWQgYXJ0aWNsZSByZWdleHA6IC9eYXJ0aWNsZSg/OlxcLyhbXlxcL10rKSlcXC8/JC9cblx0XHQgKiBTaW5nbGUgYnVuZGxlIHJlZ2V4cDogL15idW5kbGVzKD86XFwvKFteXFwvXSspKD86XFwvKFxcZCspKT8pP1xcLz8kL1xuXHRcdCAqL1xuXHRcdHRoaXMucm91dGUoLyguKikvLFxuXHRcdFx0XCJub3Rmb3VuZFwiLCB0aGlzLnRvTm90Rm91bmQpO1xuXHRcdHRoaXMucm91dGUoL14oW2Etel1bYS16MC05XFwtXSopXFwvPyQvLFxuXHRcdFx0XCJhcnRpY2xlLWl0ZW1cIiwgdGhpcy50b0FydGljbGVJdGVtKTtcblx0XHR0aGlzLnJvdXRlKC9eKD86YnVuZGxlcyk/XFwvPyQvLFxuXHRcdFx0XCJyb290XCIsIHRoaXMudG9Sb290KTtcblx0XHQvLyB0aGlzLnJvdXRlKC9eYnVuZGxlc1xcLz8kLyxcblx0XHQvLyBcdFwiYnVuZGxlLWxpc3RcIiwgdGhpcy50b0J1bmRsZUxpc3QpO1xuXHRcdHRoaXMucm91dGUoL15idW5kbGVzXFwvKFteXFwvXSspXFwvPyQvLFxuXHRcdFx0XCJidW5kbGUtaXRlbVwiLCB0aGlzLnRvQnVuZGxlSXRlbSk7XG5cdFx0dGhpcy5yb3V0ZSgvXmJ1bmRsZXNcXC8oW15cXC9dKylcXC8oXFxkKylcXC8/JC8sXG5cdFx0XHRcIm1lZGlhLWl0ZW1cIiwgdGhpcy50b01lZGlhSXRlbSk7XG5cblx0XHRjb25zb2xlLmxvZyhcIiVzOjppbml0aWFsaXplIHJvdXRlczogJW9cIiwgXCJjb250cm9sbGVyXCIsIHRoaXMuX3JvdXRlTmFtZXMpO1xuXHR9LFxuXG5cdHJvdXRlOiBmdW5jdGlvbihyb3V0ZSwgbmFtZSwgY2FsbGJhY2spIHtcblx0XHR0aGlzLl9yb3V0ZU5hbWVzLnB1c2goXy5pc1N0cmluZyhuYW1lKSA/IG5hbWUgOiAnJyk7XG5cdFx0cmV0dXJuIEJhY2tib25lLlJvdXRlci5wcm90b3R5cGUucm91dGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogSlMgdG8gVVJMOiBwdWJsaWMgY29tbWFuZCBtZXRob2RzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHNlbGVjdE1lZGlhOiBmdW5jdGlvbihtZWRpYSkge1xuXHRcdHRoaXMuX2dvVG9Mb2NhdGlvbihtZWRpYS5nZXQoXCJidW5kbGVcIiksIG1lZGlhKTtcblx0fSxcblxuXHRzZWxlY3RCdW5kbGU6IGZ1bmN0aW9uKGJ1bmRsZSkge1xuXHRcdHRoaXMuX2dvVG9Mb2NhdGlvbihidW5kbGUpO1xuXHR9LFxuXG5cdGRlc2VsZWN0TWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX2dvVG9Mb2NhdGlvbihidW5kbGVzLnNlbGVjdGVkKTtcblx0fSxcblxuXHRkZXNlbGVjdEJ1bmRsZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5fZ29Ub0xvY2F0aW9uKCk7XG5cdH0sXG5cblx0c2VsZWN0QXJ0aWNsZTogZnVuY3Rpb24oYXJ0aWNsZSkge1xuXHRcdHRoaXMubmF2aWdhdGUoYXJ0aWNsZS5nZXQoXCJoYW5kbGVcIiksIHsgdHJpZ2dlcjogdHJ1ZSB9KTtcblx0fSxcblxuXHRkZXNlbGVjdEFydGljbGU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMubmF2aWdhdGUoXCJcIiwgeyB0cmlnZ2VyOiB0cnVlIH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBKUyB0byBVUkw6IHByaXZhdGUgaGVscGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogVXBkYXRlIGxvY2F0aW9uIHdoZW4gbmF2aWdhdGlvbiBoYXBwZW5zIGludGVybmFsbHkgKi9cblx0X3VwZGF0ZUxvY2F0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgYnVuZGxlLCBtZWRpYTtcblx0XHRidW5kbGUgPSBidW5kbGVzLnNlbGVjdGVkO1xuXHRcdGlmIChidW5kbGUpIHtcblx0XHRcdG1lZGlhID0gYnVuZGxlLmdldChcIm1lZGlhXCIpLnNlbGVjdGVkO1xuXHRcdH1cblx0XHR0aGlzLm5hdmlnYXRlKHRoaXMuX2dldExvY2F0aW9uKGJ1bmRsZSwgbWVkaWEpLCB7XG5cdFx0XHR0cmlnZ2VyOiBmYWxzZVxuXHRcdH0pO1xuXHR9LFxuXG5cdF9nZXRMb2NhdGlvbjogZnVuY3Rpb24oYnVuZGxlLCBtZWRpYSkge1xuXHRcdHZhciBtZWRpYUluZGV4LCBsb2NhdGlvbiA9IFtdO1xuXHRcdGlmIChidW5kbGUpIHtcblx0XHRcdGxvY2F0aW9uLnB1c2goXCJidW5kbGVzXCIpO1xuXHRcdFx0bG9jYXRpb24ucHVzaChidW5kbGUuZ2V0KFwiaGFuZGxlXCIpKTtcblx0XHRcdGlmIChtZWRpYSkge1xuXHRcdFx0XHRtZWRpYUluZGV4ID0gYnVuZGxlLmdldChcIm1lZGlhXCIpLmluZGV4T2YobWVkaWEpO1xuXHRcdFx0XHRpZiAobWVkaWFJbmRleCA+PSAwKSB7XG5cdFx0XHRcdFx0bG9jYXRpb24ucHVzaChtZWRpYUluZGV4KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHQvLyBsb2NhdGlvbi5wdXNoKFwiXCIpO1xuXHRcdHJldHVybiBsb2NhdGlvbi5qb2luKFwiL1wiKTtcblx0fSxcblxuXHRfZ29Ub0xvY2F0aW9uOiBmdW5jdGlvbihidW5kbGUsIG1lZGlhKSB7XG5cdFx0dGhpcy5uYXZpZ2F0ZSh0aGlzLl9nZXRMb2NhdGlvbihidW5kbGUsIG1lZGlhKSwge1xuXHRcdFx0dHJpZ2dlcjogdHJ1ZVxuXHRcdH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFVSTCB0byBKUzogcm91dGVyIGhhbmRsZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHRvUm9vdDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy50cmlnZ2VyKFwiY2hhbmdlOmJlZm9yZVwiKTtcblx0XHRpZiAoYnVuZGxlcy5zZWxlY3RlZCkge1xuXHRcdFx0YnVuZGxlcy5zZWxlY3RlZC5nZXQoXCJtZWRpYVwiKS5kZXNlbGVjdCgpO1xuXHRcdFx0YnVuZGxlcy5kZXNlbGVjdCgpO1xuXHRcdH1cblx0XHQvLyBrZXl3b3Jkcy5kZXNlbGVjdCgpO1xuXHRcdGFydGljbGVzLmRlc2VsZWN0KCk7XG5cdFx0dGhpcy50cmlnZ2VyKFwiY2hhbmdlOmFmdGVyXCIpO1xuXHR9LFxuXG5cdHRvTm90Rm91bmQ6IGZ1bmN0aW9uKHNsdWcpIHtcblx0XHRjb25zb2xlLmluZm8oXCJyb3V0ZTpbKjolc11cIiwgc2x1Zyk7XG5cdH0sXG5cblx0Ly8gdG9CdW5kbGVMaXN0OiBmdW5jdGlvbigpIHtcblx0Ly8gXHR0aGlzLm5hdmlnYXRlKFwiXCIsIHtcblx0Ly8gXHRcdHRyaWdnZXI6IHRydWUsXG5cdC8vIFx0XHRyZXBsYWNlOiB0cnVlXG5cdC8vIFx0fSk7XG5cdC8vIH0sXG5cblx0dG9CdW5kbGVJdGVtOiBmdW5jdGlvbihidW5kbGVIYW5kbGUpIHtcblx0XHR2YXIgYnVuZGxlID0gYnVuZGxlcy5maW5kV2hlcmUoe1xuXHRcdFx0aGFuZGxlOiBidW5kbGVIYW5kbGVcblx0XHR9KTtcblx0XHRpZiAoIWJ1bmRsZSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgYnVuZGxlIHdpdGggaGFuZGxlIFxcXCJcIiArIGJ1bmRsZUhhbmRsZSArIFwiXFxcIlwiKTtcblx0XHR9XG5cdFx0dGhpcy5fY2hhbmdlU2VsZWN0aW9uKGJ1bmRsZSk7XG5cdH0sXG5cblx0dG9NZWRpYUl0ZW06IGZ1bmN0aW9uKGJ1bmRsZUhhbmRsZSwgbWVkaWFJbmRleCkge1xuXHRcdHZhciBidW5kbGUsIG1lZGlhO1xuXHRcdC8vIGlmIChidW5kbGVIYW5kbGUpIHtcblx0XHRidW5kbGUgPSBidW5kbGVzLmZpbmRXaGVyZSh7IGhhbmRsZTogYnVuZGxlSGFuZGxlIH0pO1xuXHRcdGlmICghYnVuZGxlKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJObyBidW5kbGUgd2l0aCBoYW5kbGUgXFxcIlwiICsgYnVuZGxlSGFuZGxlICsgXCJcXFwiIGZvdW5kXCIpO1xuXHRcdH1cblx0XHQvLyBpZiAobWVkaWFJbmRleCkge1xuXHRcdG1lZGlhID0gYnVuZGxlLmdldChcIm1lZGlhXCIpLmF0KG1lZGlhSW5kZXgpO1xuXHRcdGlmICghbWVkaWEpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIk5vIG1lZGlhIGF0IGluZGV4IFwiICsgbWVkaWFJbmRleCArIFwiIGluIGJ1bmRsZSB3aXRoIGhhbmRsZSBcXFwiXCIgKyBidW5kbGVIYW5kbGUgKyBcIlxcXCIgZm91bmRcIik7XG5cdFx0fVxuXHRcdC8vIH1cblx0XHQvLyB9XG5cdFx0dGhpcy5fY2hhbmdlU2VsZWN0aW9uKGJ1bmRsZSwgbWVkaWEpO1xuXHR9LFxuXG5cdHRvQXJ0aWNsZUl0ZW06IGZ1bmN0aW9uKGFydGljbGVIYW5kbGUpIHtcblx0XHR2YXIgYXJ0aWNsZSA9IGFydGljbGVzLmZpbmRXaGVyZSh7IGhhbmRsZTogYXJ0aWNsZUhhbmRsZSB9KTtcblx0XHRpZiAoIWFydGljbGUpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIGFydGljbGUgd2l0aCBoYW5kbGUgXFxcIlwiICsgYXJ0aWNsZUhhbmRsZSArIFwiXFxcIlwiKTtcblx0XHR9XG5cdFx0dGhpcy50cmlnZ2VyKFwiY2hhbmdlOmJlZm9yZVwiLCBhcnRpY2xlKTtcblx0XHRidW5kbGVzLmRlc2VsZWN0KCk7XG5cdFx0YXJ0aWNsZXMuc2VsZWN0KGFydGljbGUpO1xuXHRcdHRoaXMudHJpZ2dlcihcImNoYW5nZTphZnRlclwiLCBhcnRpY2xlKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIFVSTCB0byBKUzogcHJpdmF0ZSBoZWxwZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKlxuXHQvKiBOT1RFOiBTZWxlY3Rpb24gb3JkZXJcblx0LyogLSBBcHBseSBtZWRpYSBzZWxlY3Rpb24gdG8gKmluY29taW5nIGJ1bmRsZSosIGFzIG5vdCB0byB0cmlnZ2VyXG5cdC8qXHR1bm5lY2Nlc2FyeSBldmVudHMgb24gYW4gb3V0Z29pbmcgYnVuZGxlLiBPdXRnb2luZyBidW5kbGUgbWVkaWEgc2VsZWN0aW9uXG5cdC8qXHRyZW1haW5zIHVudG91Y2hlZC5cblx0LyogLSBBcHBseSBtZWRpYSBzZWxlY3Rpb24gKmJlZm9yZSogc2VsZWN0aW5nIHRoZSBpbmNvbWluZyBidW5kbGUuIFZpZXdzXG5cdC8qXHRub3JtYWxseSBsaXN0ZW4gdG8gdGhlIHNlbGVjdGVkIGJ1bmRsZSBvbmx5LCBzbyBpZiB0aGUgYnVuZGxlIGlzIGNoYW5naW5nLFxuXHQvKlx0dGhleSB3aWxsIG5vdCBiZSBsaXN0ZW5pbmcgdG8gbWVkaWEgc2VsZWN0aW9uIGNoYW5nZXMgeWV0LlxuXHQvKi9cblx0X2NoYW5nZVNlbGVjdGlvbjogZnVuY3Rpb24oYnVuZGxlLCBtZWRpYSkge1xuXHRcdHZhciBsYXN0QnVuZGxlLCBsYXN0TWVkaWE7XG5cdFx0aWYgKGJ1bmRsZSA9PT0gdm9pZCAwKSBidW5kbGUgPSBudWxsO1xuXHRcdGlmIChtZWRpYSA9PT0gdm9pZCAwKSBtZWRpYSA9IG51bGw7XG5cblx0XHRsYXN0QnVuZGxlID0gYnVuZGxlcy5zZWxlY3RlZDtcblx0XHRsYXN0TWVkaWEgPSBsYXN0QnVuZGxlID8gbGFzdEJ1bmRsZS5nZXQoXCJtZWRpYVwiKS5zZWxlY3RlZCA6IG51bGw7XG5cdFx0Y29uc29sZS5sb2coXCJjb250cm9sbGVyOjpfY2hhbmdlU2VsZWN0aW9uIGJ1bmRsZTpbJXMgLT4gJXNdIG1lZGlhOlslcyAtPiAlc11cIixcblx0XHRcdChsYXN0QnVuZGxlID8gbGFzdEJ1bmRsZS5jaWQgOiBsYXN0QnVuZGxlKSwgKGJ1bmRsZSA/IGJ1bmRsZS5jaWQgOiBidW5kbGUpLFxuXHRcdFx0KGxhc3RNZWRpYSA/IGxhc3RNZWRpYS5jaWQgOiBsYXN0TWVkaWEpLCAobWVkaWEgPyBtZWRpYS5jaWQgOiBtZWRpYSlcblx0XHQpO1xuXG5cdFx0aWYgKCFhcnRpY2xlcy5zZWxlY3RlZCAmJiAobGFzdEJ1bmRsZSA9PT0gYnVuZGxlKSAmJiAobGFzdE1lZGlhID09PSBtZWRpYSkpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLnRyaWdnZXIoXCJjaGFuZ2U6YmVmb3JlXCIsIGJ1bmRsZSwgbWVkaWEpO1xuXHRcdGJ1bmRsZSAmJiBidW5kbGUuZ2V0KFwibWVkaWFcIikuc2VsZWN0KG1lZGlhKTtcblx0XHRidW5kbGVzLnNlbGVjdChidW5kbGUpO1xuXHRcdGFydGljbGVzLmRlc2VsZWN0KCk7XG5cdFx0dGhpcy50cmlnZ2VyKFwiY2hhbmdlOmFmdGVyXCIsIGJ1bmRsZSwgbWVkaWEpO1xuXHR9LFxufSk7XG5cblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgQ29udHJvbGxlcigpOyIsIi8qKlxuLyogQG1vZHVsZSBhcHAvY29udHJvbC9HbG9iYWxzXG4vKi9cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcblx0Ly8gcmV1c2FibGUgdmFyc1xuXHR2YXIgbywgcywgc287XG5cdC8vIGdsb2JhbCBoYXNoXG5cdHZhciBnID0ge307XG5cdC8vIFNBU1MgPC0tPiBKUyBzaGFyZWQgaGFzaFxuXHR2YXIgc2FzcyA9IHJlcXVpcmUoXCIuLi8uLi8uLi9zYXNzL3ZhcmlhYmxlcy5qc29uXCIpO1xuXG5cdC8vIEpVTksgRklSU1Q6IFNvbWUgYXBwLXdpZGUgZGVmYXVsdHNcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdGcuVlBBTl9EUkFHID0gMC45NTsgLy8gYXMgZmFjdG9yIG9mIHBvaW50ZXIgZGVsdGFcblx0Zy5IUEFOX09VVF9EUkFHID0gMC40OyAvLyBmYWN0b3Jcblx0Zy5WUEFOX09VVF9EUkFHID0gMC4xOyAvLyBmYWN0b3Jcblx0Zy5QQU5fVEhSRVNIT0xEID0gMTU7IC8vIHB4XG5cdGcuQ09MTEFQU0VfVEhSRVNIT0xEID0gNzU7IC8vIHB4XG5cdGcuQ09MTEFQU0VfT0ZGU0VUID0gcGFyc2VJbnQoc2Fzcy50ZW1wW1wiY29sbGFwc2Vfb2Zmc2V0XCJdKTtcblx0Zy5DTElDS19FVkVOVCA9IHdpbmRvdy5oYXNPd25Qcm9wZXJ0eShcIm9ucG9pbnRlcnVwXCIpID8gXCJwb2ludGVydXBcIiA6IFwibW91c2V1cFwiO1xuXG5cdC8vIGJyZWFrcG9pbnRzXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRnLkJSRUFLUE9JTlRTID0ge307XG5cdGZvciAocyBpbiBzYXNzLmJyZWFrcG9pbnRzKSB7XG5cdFx0byA9IHNhc3MuYnJlYWtwb2ludHNbc107XG5cdFx0LyppZiAoQXJyYXkuaXNBcnJheShvKSkge1xuXHRcdFx0Zy5CUkVBS1BPSU5UU1tzXSA9IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHt9LCB7XG5cdFx0XHRcdFwibWF0Y2hlc1wiOiB7XG5cdFx0XHRcdFx0Z2V0OiBfLnBhcnRpYWwoXy5zb21lLCBvLm1hcCh3aW5kb3cubWF0Y2hNZWRpYSksIF8ucHJvcGVydHkoXCJtYXRjaGVzXCIpKVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcIm1lZGlhXCI6IHtcblx0XHRcdFx0XHR2YWx1ZTogby5qb2luKFwiLCBcIilcblx0XHRcdFx0fSxcblx0XHRcdFx0XCJxdWVyaWVzXCI6IHtcblx0XHRcdFx0XHR2YWx1ZTogby5tYXAod2luZG93Lm1hdGNoTWVkaWEpXG5cdFx0XHRcdH0sXG5cdFx0XHR9KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Zy5CUkVBS1BPSU5UU1tzXSA9IHdpbmRvdy5tYXRjaE1lZGlhKG8pO1xuXHRcdH0qL1xuXHRcdG8gPSBBcnJheS5pc0FycmF5KG8pID8gby5qb2luKFwiLCBcIikgOiBvO1xuXHRcdG8gPSBvLnJlcGxhY2UoL1tcXCdcXFwiXS9nLCBcIlwiKTtcblx0XHRvID0gd2luZG93Lm1hdGNoTWVkaWEobyk7XG5cdFx0by5jbGFzc05hbWUgPSBzO1xuXHRcdGcuQlJFQUtQT0lOVFNbc10gPSBvO1xuXHR9XG5cdGlmIChERUJVRykge1xuXHRcdGNvbnNvbGUuZ3JvdXAoXCJCcmVha3BvaW50c1wiKTtcblx0XHRmb3IgKHMgaW4gZy5CUkVBS1BPSU5UUykge1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczogJW9cIiwgcywgZy5CUkVBS1BPSU5UU1tzXS5tZWRpYSk7XG5cdFx0fVxuXHRcdGNvbnNvbGUuZ3JvdXBFbmQoKTtcblx0fVxuXG5cdC8vIGJhc2UgY29sb3JzLCBkaW1lbnNpb25zXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRnLkRFRkFVTFRfQ09MT1JTID0gXy5jbG9uZShzYXNzLmRlZmF1bHRfY29sb3JzKTtcblx0Ly8gZy5IT1JJWk9OVEFMX1NURVAgPSBwYXJzZUZsb2F0KHNhc3MudW5pdHNbXCJodV9weFwiXSk7XG5cdC8vIGcuVkVSVElDQUxfU1RFUCA9IHBhcnNlRmxvYXQoc2Fzcy51bml0c1tcInZ1X3B4XCJdKTtcblxuXG5cdC8vIHBhdGhzLCBuZXR3b3JraW5nXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHQvLyB2YXIgdG9BYnNvbHV0ZVVSTCA9IChmdW5jdGlvbigpIHtcblx0Ly8gXHR2YXIgYSA9IG51bGw7XG5cdC8vIFx0cmV0dXJuIGZ1bmN0aW9uKHVybCkge1xuXHQvLyBcdFx0YSA9IGEgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXHQvLyBcdFx0YS5ocmVmID0gdXJsO1xuXHQvLyBcdFx0cmV0dXJuIGEuaHJlZjtcblx0Ly8gXHR9O1xuXHQvLyB9KSgpO1xuXHQvLyBnLkFQUF9ST09UID0gdG9BYnNvbHV0ZVVSTCh3aW5kb3cuYXBwcm9vdCk7XG5cdC8vIGcuTUVESUFfRElSID0gdG9BYnNvbHV0ZVVSTCh3aW5kb3cubWVkaWFkaXIpO1xuXG5cdGcuQVBQX1JPT1QgPSB3aW5kb3cuYXBwcm9vdDtcblx0Zy5NRURJQV9ESVIgPSB3aW5kb3cubWVkaWFkaXI7XG5cblx0ZGVsZXRlIHdpbmRvdy5hcHByb290O1xuXHRkZWxldGUgd2luZG93Lm1lZGlhZGlyO1xuXG5cdC8vIGhhcmRjb2RlZCBmb250IGRhdGFcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdGcuRk9OVF9NRVRSSUNTID0ge1xuXHRcdFwiRnJhbmtsaW4gR290aGljIEZTXCI6IHtcblx0XHRcdFwidW5pdHNQZXJFbVwiOiAxMDAwLFxuXHRcdFx0XCJhc2NlbnRcIjogODI3LFxuXHRcdFx0XCJkZXNjZW50XCI6IC0xNzNcblx0XHR9LFxuXHRcdFwiSVRDRnJhbmtsaW5Hb3RoaWNTdGRcIjoge1xuXHRcdFx0XCJ1bml0c1BlckVtXCI6IDEwMDAsXG5cdFx0XHRcImFzY2VudFwiOiA2ODYsXG5cdFx0XHRcImRlc2NlbnRcIjogLTMxNFxuXHRcdH0sXG5cdFx0XCJGb2xpb0ZpZ3VyZXNcIjoge1xuXHRcdFx0XCJ1bml0c1BlckVtXCI6IDEwMjQsXG5cdFx0XHRcImFzY2VudFwiOiA5MzksXG5cdFx0XHRcImRlc2NlbnRcIjogLTI1NlxuXHRcdH0sXG5cdH07XG5cblx0Zy5QQVVTRV9DSEFSID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweDIzRjgpO1xuXHRnLlBMQVlfQ0hBUiA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHgyM0Y1KTtcblx0Zy5TVE9QX0NIQVIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MjNGOSk7XG5cblx0Ly8gdHJhbnNsYXRlIGNvbW1vbiB0ZW1wbGF0ZVxuXG5cdGcuVFJBTlNMQVRFX1RFTVBMQVRFID0gZnVuY3Rpb24oeCwgeSkge1xuXHRcdHJldHVybiBcInRyYW5zbGF0ZShcIiArIHggKyBcInB4LCBcIiArIHkgKyBcInB4KVwiO1xuXHRcdC8vIHJldHVybiBcInRyYW5zbGF0ZTNkKFwiICsgeCArIFwicHgsIFwiICsgeSArIFwicHggLDBweClcIjtcblx0fTtcblx0Ly8gdGltaW5nLCBlYXNpbmdcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdHZhciBlYXNlID0gZy5UUkFOU0lUSU9OX0VBU0UgPSBzYXNzLnRyYW5zaXRpb25zW1wiZWFzZVwiXTtcblx0dmFyIGR1cmF0aW9uID0gZy5UUkFOU0lUSU9OX0RVUkFUSU9OID0gcGFyc2VGbG9hdChzYXNzLnRyYW5zaXRpb25zW1wiZHVyYXRpb25fbXNcIl0pO1xuXHR2YXIgZGVsYXlJbnRlcnZhbCA9IGcuVFJBTlNJVElPTl9ERUxBWV9JTlRFUlZBTCA9IHBhcnNlRmxvYXQoc2Fzcy50cmFuc2l0aW9uc1tcImRlbGF5X2ludGVydmFsX21zXCJdKTtcblx0dmFyIG1pbkRlbGF5ID0gZy5UUkFOU0lUSU9OX01JTl9ERUxBWSA9IHBhcnNlRmxvYXQoc2Fzcy50cmFuc2l0aW9uc1tcIm1pbl9kZWxheV9tc1wiXSk7XG5cdHZhciBkZWxheSA9IGcuVFJBTlNJVElPTl9ERUxBWSA9IGcuVFJBTlNJVElPTl9EVVJBVElPTiArIGcuVFJBTlNJVElPTl9ERUxBWV9JTlRFUlZBTDtcblxuXHQvLyBjc3MgdHJhbnNpdGlvbnNcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdG8gPSB7fTtcblxuXHQvLyBtYXRjaCB0eCgpIGluIF90cmFuc2l0aW9ucy5zY3NzXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRvLnR4ID0gZnVuY3Rpb24gdHgoZHVyYXRpb25Db3VudCwgZGVsYXlDb3VudCwgZWFzZVZhbCkge1xuXHRcdF8uaXNOdW1iZXIoZHVyYXRpb25Db3VudCkgfHwgKGR1cmF0aW9uQ291bnQgPSAxKTtcblx0XHRfLmlzTnVtYmVyKGRlbGF5Q291bnQpIHx8IChkZWxheUNvdW50ID0gLTEpO1xuXHRcdF8uaXNTdHJpbmcoZWFzZVZhbCkgfHwgKGVhc2VWYWwgPSBlYXNlKTtcblxuXHRcdHZhciBvID0ge307XG5cdFx0aWYgKGRlbGF5Q291bnQgPCAwKSB7XG5cdFx0XHRvLmR1cmF0aW9uID0gKGR1cmF0aW9uICogZHVyYXRpb25Db3VudCkgK1xuXHRcdFx0XHQoZGVsYXlJbnRlcnZhbCAqIChkdXJhdGlvbkNvdW50IC0gMSkpO1xuXHRcdFx0by5kZWxheSA9IDA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG8uZHVyYXRpb24gPSAoZHVyYXRpb24gKiBkdXJhdGlvbkNvdW50KSArXG5cdFx0XHRcdChkZWxheUludGVydmFsICogKGR1cmF0aW9uQ291bnQgLSAxKSkgLSBtaW5EZWxheTtcblx0XHRcdG8uZGVsYXkgPSAoZGVsYXkgKiBkZWxheUNvdW50KSAtIG1pbkRlbGF5O1xuXHRcdH1cblx0XHRvLmVhc2VpbmcgPSBlYXNlVmFsO1xuXHRcdHJldHVybiAwO1xuXHR9XG5cblx0Ly8gdHJhbnNpdGlvbiBwcmVzZXRzXG5cdC8vIFRPRE86IGdldCByaWQgb2YgdGhpc1xuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblxuXHRvLk5PTkUgPSB7XG5cdFx0ZGVsYXk6IDAsXG5cdFx0ZHVyYXRpb246IDAsXG5cdFx0ZWFzaW5nOiBcInN0ZXAtc3RhcnRcIlxuXHR9O1xuXHRvLk5PVyA9IHtcblx0XHRkZWxheTogMCxcblx0XHRkdXJhdGlvbjogZHVyYXRpb24sXG5cdFx0ZWFzaW5nOiBlYXNlXG5cdH07XG5cdG8uVU5TRVQgPSBfLmRlZmF1bHRzKHtcblx0XHRjc3NUZXh0OiBcIlwiXG5cdH0sIG8uTk9ORSk7XG5cblx0dmFyIHR4QWxpZ25lZCA9IF8uZGVmYXVsdHMoe1xuXHRcdGR1cmF0aW9uOiBkdXJhdGlvbiAtIG1pbkRlbGF5XG5cdH0sIG8uTk9XKTtcblx0by5GSVJTVCA9IF8uZGVmYXVsdHMoe1xuXHRcdGRlbGF5OiBkZWxheSAqIDAuMCArIG1pbkRlbGF5XG5cdH0sIHR4QWxpZ25lZCk7XG5cdG8uQkVUV0VFTiA9IF8uZGVmYXVsdHMoe1xuXHRcdGRlbGF5OiBkZWxheSAqIDEuMCArIG1pbkRlbGF5XG5cdH0sIHR4QWxpZ25lZCk7XG5cdG8uTEFTVCA9IF8uZGVmYXVsdHMoe1xuXHRcdGRlbGF5OiBkZWxheSAqIDIuMCArIG1pbkRlbGF5XG5cdH0sIHR4QWxpZ25lZCk7XG5cdG8uQUZURVIgPSBfLmRlZmF1bHRzKHtcblx0XHRkZWxheTogZGVsYXkgKiAyLjAgKyBtaW5EZWxheVxuXHR9LCB0eEFsaWduZWQpO1xuXG5cdG8uQkVUV0VFTl9FQVJMWSA9IF8uZGVmYXVsdHMoe1xuXHRcdGRlbGF5OiBkZWxheSAqIDEuMCArIG1pbkRlbGF5IC0gNjBcblx0fSwgdHhBbGlnbmVkKTtcblx0by5CRVRXRUVOX0xBVEUgPSBfLmRlZmF1bHRzKHtcblx0XHRkZWxheTogZGVsYXkgKiAxLjAgKyBtaW5EZWxheSArIDYwXG5cdH0sIHR4QWxpZ25lZCk7XG5cblx0by5GSVJTVF9MQVRFID0gXy5kZWZhdWx0cyh7XG5cdFx0ZGVsYXk6IGRlbGF5ICogMC41ICsgbWluRGVsYXlcblx0fSwgdHhBbGlnbmVkKTtcblx0by5MQVNUX0VBUkxZID0gXy5kZWZhdWx0cyh7XG5cdFx0ZGVsYXk6IGRlbGF5ICogMS41ICsgbWluRGVsYXlcblx0fSwgdHhBbGlnbmVkKTtcblx0Ly8gby5GSVJTVF9MQVRFID0gXHRcdF8uZGVmYXVsdHMoe2RlbGF5OiB0eERlbGF5KjAuMCArIHR4TWluRGVsYXkqMn0sIHR4QWxpZ25lZCk7XG5cdC8vIG8uTEFTVF9FQVJMWSA9IFx0XHRfLmRlZmF1bHRzKHtkZWxheTogdHhEZWxheSoyLjAgKyB0eE1pbkRlbGF5KjB9LCB0eEFsaWduZWQpO1xuXHQvLyBvLkFGVEVSID0gXHRcdFx0Xy5kZWZhdWx0cyh7ZGVsYXk6IHR4RGVsYXkqMi4wICsgdHhNaW5EZWxheX0sIHR4QWxpZ25lZCk7XG5cblx0Y29uc29sZS5ncm91cChcIlRyYW5zaXRpb25zXCIpO1xuXHRmb3IgKHMgaW4gbykge1xuXHRcdGlmICghXy5pc0Z1bmN0aW9uKG9bc10pKSB7XG5cdFx0XHRzbyA9IG9bc107XG5cdFx0XHRzby5uYW1lID0gcztcblx0XHRcdHNvLmNsYXNzTmFtZSA9IFwidHgtXCIgKyBzLnJlcGxhY2UoXCJfXCIsIFwiLVwiKS50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0aWYgKCFzby5oYXNPd25Qcm9wZXJ0eShcImNzc1RleHRcIikpIHtcblx0XHRcdFx0c28uY3NzVGV4dCA9IHNvLmR1cmF0aW9uIC8gMTAwMCArIFwicyBcIiArIHNvLmVhc2luZyArIFwiIFwiICsgc28uZGVsYXkgLyAxMDAwICsgXCJzXCI7XG5cdFx0XHR9XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOiAlc1wiLCBzby5uYW1lLCBzby5jc3NUZXh0KTtcblx0XHR9XG5cdH1cblx0Y29uc29sZS5ncm91cEVuZCgpO1xuXHRnLnRyYW5zaXRpb25zID0gbztcblxuXHRyZXR1cm4gZztcbn0oKSk7IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L0RlYnVnVG9vbGJhclxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vKiogQHR5cGUge21vZHVsZTpjb29raWVzLWpzfSAqL1xudmFyIENvb2tpZXMgPSByZXF1aXJlKFwiY29va2llcy1qc1wiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOm1vZGVybml6cn0gKi9cbi8vIHZhciBNb2Rlcm5penIgPSByZXF1aXJlKFwiTW9kZXJuaXpyXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0NvbnRyb2xsZXJ9ICovXG4vLyB2YXIgY29udHJvbGxlciA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9Db250cm9sbGVyXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgdmlld1RlbXBsYXRlID0gcmVxdWlyZShcIi4vdGVtcGxhdGUvRGVidWdUb29sYmFyLmhic1wiKTtcblxuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBncmlkVGVtcGxhdGUgPSByZXF1aXJlKFwiLi90ZW1wbGF0ZS9EZWJ1Z1Rvb2xiYXIuU1ZHR3JpZC5oYnNcIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgc2l6ZVRlbXBsYXRlID0gXy50ZW1wbGF0ZShcIjwlPSB3ICU+IFxcdTAwRDcgPCU9IGggJT5cIik7XG5cbi8vIHZhciBhcHBTdGF0ZVN5bWJvbHMgPSB7IHdpdGhCdW5kbGU6IFwiYlwiLCB3aXRoTWVkaWE6IFwibVwiLCBjb2xsYXBzZWQ6IFwiY1wifTtcbi8vIHZhciBhcHBTdGF0ZUtleXMgPSBPYmplY3Qua2V5cyhhcHBTdGF0ZVN5bWJvbHMpO1xuXG52YXIgRGVidWdUb29sYmFyID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2lkUHJlZml4OiBcImRlYnVnVG9vbGJhclwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwiZGl2XCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcInRvb2xiYXJcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0ZW1wbGF0ZTogdmlld1RlbXBsYXRlLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cHJvcGVydGllczoge1xuXHRcdGdyaWQ6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9ncmlkIHx8ICh0aGlzLl9ncmlkID0gdGhpcy5jcmVhdGVHcmlkRWxlbWVudCgpKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdENvb2tpZXMuZGVmYXVsdHMgPSB7XG5cdFx0XHRleHBpcmVzOiBuZXcgRGF0ZSgweDdmZmZmZmZmICogMWUzKSxcblx0XHRcdGRvbWFpbjogU3RyaW5nKHdpbmRvdy5sb2NhdGlvbilcblx0XHRcdFx0Lm1hdGNoKC9eaHR0cHM/XFw6XFwvXFwvKFteXFwvOj8jXSspKD86W1xcLzo/I118JCkvaSlbMV1cblx0XHR9O1xuXG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHtcblx0XHRcdHRlc3RzOiBNb2Rlcm5penIsXG5cdFx0XHRuYXZpZ2F0b3I6IHdpbmRvdy5uYXZpZ2F0b3Jcblx0XHR9KTtcblxuXHRcdC8qIHRvZ2dsZSdzIHRhcmdldDogY29udGFpbmVyXG5cdFx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRcdHZhciBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbnRhaW5lclwiKTsgLy8ucXVlcnlTZWxlY3RvcihcIiNjb250YWluZXJcIik7XG5cblx0XHQvKiBjcmVhdGUvYXR0YWNoIHN2ZyBncmlkIGVsZW1lbnRcblx0XHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cdFx0Y29udGFpbmVyLmluc2VydEJlZm9yZSh0aGlzLmNyZWF0ZUdyaWRFbGVtZW50KCksIGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZCk7XG5cblx0XHQvKiBpbmZvIGVsZW1lbnRzXG5cdFx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRcdHRoaXMuYmFja2VuZEVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtYmFja2VuZCBhXCIpO1xuXHRcdHRoaXMubWVkaWFJbmZvRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjbWVkaWEtaW5mbyBzcGFuXCIpO1xuXHRcdHRoaXMuYXBwU3RhdGVFbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIiNhcHAtc3RhdGVcIik7XG5cblx0XHQvKiB0b2dnbGUgdmlzaWJpbGl0eVxuXHRcdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblx0XHR0aGlzLmluaXRpYWxpemVDbGFzc1RvZ2dsZShcInNob3ctbGlua3NcIiwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmRlYnVnLWxpbmtzICNsaW5rcy10b2dnbGVcIiksIHRoaXMuZWwsXG5cdFx0XHRmdW5jdGlvbihrZXksIHZhbHVlKSB7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcIm5vdC1cIiArIGtleSwgIXZhbHVlKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczppbml0aWFsaXplQ2xhc3NUb2dnbGU6W2NhbGxiYWNrXSAlb1wiLCB0aGlzLmNpZCwgYXJndW1lbnRzKTtcblx0XHRcdH1cblx0XHQpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNsYXNzVG9nZ2xlKFwic2hvdy10ZXN0c1wiLCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdG9nZ2xlLXRlc3RzIGFcIiksIHRoaXMuZWwpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNsYXNzVG9nZ2xlKFwiaGlkZS1wYXNzZWRcIiwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI3RvZ2dsZS1wYXNzZWRcIiksIHRoaXMuZWwpO1xuXG5cdFx0LyogdG9nZ2xlIGNvbnRhaW5lciBjbGFzc2VzXG5cdFx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNsYXNzVG9nZ2xlKFwiZGVidWctZ3JpZC1iZ1wiLCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdG9nZ2xlLWdyaWQtYmcgYVwiKSwgZG9jdW1lbnQuYm9keSk7XG5cdFx0dGhpcy5pbml0aWFsaXplQ2xhc3NUb2dnbGUoXCJkZWJ1Zy1ibG9ja3NcIiwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI3RvZ2dsZS1ibG9ja3MgYVwiKSwgY29udGFpbmVyKTtcblx0XHR0aGlzLmluaXRpYWxpemVDbGFzc1RvZ2dsZShcImRlYnVnLWdyYXBoXCIsIHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIiN0b2dnbGUtZ3JhcGggYVwiKSwgY29udGFpbmVyKTtcblx0XHR0aGlzLmluaXRpYWxpemVDbGFzc1RvZ2dsZShcImRlYnVnLW1kb3duXCIsIHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIiN0b2dnbGUtbWRvd24gYVwiKSwgY29udGFpbmVyKTtcblx0XHR0aGlzLmluaXRpYWxpemVDbGFzc1RvZ2dsZShcImRlYnVnLWxvZ3NcIiwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI3RvZ2dsZS1sb2dzIGFcIiksIGNvbnRhaW5lcik7XG5cdFx0dGhpcy5pbml0aWFsaXplQ2xhc3NUb2dnbGUoXCJkZWJ1Zy10eFwiLCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdG9nZ2xlLXR4IGFcIiksIGNvbnRhaW5lcixcblx0XHRcdGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwic2hvdy10eFwiLCB2YWx1ZSk7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcIm5vdC1zaG93LXR4XCIsICF2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0KTtcblxuXHRcdHRoaXMuaW5pdGlhbGl6ZVZpZXdwb3J0SW5mbygpO1xuXG5cdFx0Ly8gdGhpcy5pbml0aWFsaXplTGF5b3V0U2VsZWN0KCk7XG5cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlXCIsIHRoaXMuX29uTW9kZWxDaGFuZ2UpO1xuXHRcdHRoaXMuX29uTW9kZWxDaGFuZ2UoKTtcblx0fSxcblxuXHRpbml0aWFsaXplVmlld3BvcnRJbmZvOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdmlld3BvcnRJbmZvRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdmlld3BvcnQtaW5mbyBzcGFuXCIpO1xuXHRcdHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmlld3BvcnRJbmZvRWwudGV4dENvbnRlbnQgPSBzaXplVGVtcGxhdGUoeyB3OiB3aW5kb3cuaW5uZXJXaWR0aCwgaDogd2luZG93LmlubmVySGVpZ2h0IH0pO1xuXHRcdH07XG5cdFx0Y2FsbGJhY2suY2FsbCgpO1xuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIF8uZGVib3VuY2UoY2FsbGJhY2ssIDEwMCwgZmFsc2UsIGZhbHNlKSk7XG5cdH0sXG5cblx0aW5pdGlhbGl6ZVRvZ2dsZTogZnVuY3Rpb24oa2V5LCB0b2dnbGVFbCwgY2FsbGJhY2spIHtcblx0XHR2YXIgY3R4ID0gdGhpcztcblx0XHR2YXIgdG9nZ2xlVmFsdWUgPSBDb29raWVzLmdldChrZXkpID09PSBcInRydWVcIjtcblx0XHRjYWxsYmFjay5jYWxsKGN0eCwga2V5LCB0b2dnbGVWYWx1ZSk7XG5cblx0XHR0b2dnbGVFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZXYpIHtcblx0XHRcdGlmIChldi5kZWZhdWx0UHJldmVudGVkKSByZXR1cm47XG5cdFx0XHRlbHNlIGV2LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0b2dnbGVWYWx1ZSA9ICF0b2dnbGVWYWx1ZTtcblx0XHRcdENvb2tpZXMuc2V0KGtleSwgdG9nZ2xlVmFsdWUgPyBcInRydWVcIiA6IFwiXCIpO1xuXHRcdFx0Y2FsbGJhY2suY2FsbChjdHgsIGtleSwgdG9nZ2xlVmFsdWUpO1xuXHRcdH0sIGZhbHNlKTtcblx0fSxcblxuXHRpbml0aWFsaXplQ2xhc3NUb2dnbGU6IGZ1bmN0aW9uKGtleSwgdG9nZ2xlRWwsIHRhcmdldEVsLCBjYWxsYmFjaykge1xuXHRcdHZhciBoYXNDYWxsYmFjayA9IF8uaXNGdW5jdGlvbihjYWxsYmFjayk7XG5cblx0XHR0aGlzLmluaXRpYWxpemVUb2dnbGUoa2V5LCB0b2dnbGVFbCwgZnVuY3Rpb24oa2V5LCB0b2dnbGVWYWx1ZSkge1xuXHRcdFx0dGFyZ2V0RWwuY2xhc3NMaXN0LnRvZ2dsZShrZXksIHRvZ2dsZVZhbHVlKTtcblx0XHRcdHRvZ2dsZUVsLmNsYXNzTGlzdC50b2dnbGUoXCJ0b2dnbGUtZW5hYmxlZFwiLCB0b2dnbGVWYWx1ZSk7XG5cdFx0XHR0b2dnbGVFbC5jbGFzc0xpc3QudG9nZ2xlKFwiY29sb3ItcmV2ZXJzZVwiLCB0b2dnbGVWYWx1ZSk7XG5cdFx0XHRoYXNDYWxsYmFjayAmJiBjYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdF9vbk1vZGVsQ2hhbmdlOiBmdW5jdGlvbigpIHtcblx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25Nb2RlbENoYW5nZSBjaGFuZ2VkQXR0cmlidXRlczogJW9cIiwgdGhpcy5jaWQsIHRoaXMubW9kZWwuY2hhbmdlZEF0dHJpYnV0ZXMoKSk7XG5cdFx0dmFyIGksIGlpLCBwcm9wLCBlbCwgZWxzID0gdGhpcy5hcHBTdGF0ZUVsLmNoaWxkcmVuO1xuXHRcdGZvciAoaSA9IDAsIGlpID0gZWxzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdGVsID0gZWxzW2ldO1xuXHRcdFx0cHJvcCA9IGVsLmdldEF0dHJpYnV0ZShcImRhdGEtcHJvcFwiKTtcblx0XHRcdGVsLmNsYXNzTGlzdC50b2dnbGUoXCJoYXMtdmFsdWVcIiwgdGhpcy5tb2RlbC5nZXQocHJvcCkpO1xuXHRcdFx0ZWwuY2xhc3NMaXN0LnRvZ2dsZShcImhhcy1jaGFuZ2VkXCIsIHRoaXMubW9kZWwuaGFzQ2hhbmdlZChwcm9wKSk7XG5cdFx0XHRlbC5jbGFzc0xpc3QudG9nZ2xlKFwiY29sb3ItcmV2ZXJzZVwiLCB0aGlzLm1vZGVsLmhhc0NoYW5nZWQocHJvcCkpO1xuXHRcdH1cblxuXHRcdC8vIE5PVEU6IEFsd2F5cyBidXQgcmV3cml0ZSBDTVMgaHJlZi5cblx0XHQvLyBPbmx5IGNvbGxhcHNlZCBtYXkgaGF2ZSBjaGFuZ2VkLCBidXQgbm90IHdvcnRoIGFsbCB0aGUgbG9naWNcblx0XHR2YXIgYXR0clZhbCA9IEdsb2JhbHMuQVBQX1JPT1QgKyBcInN5bXBob255L1wiO1xuXHRcdHN3aXRjaCAodGhpcy5tb2RlbC5nZXQoXCJyb3V0ZU5hbWVcIikpIHtcblx0XHRcdGNhc2UgXCJhcnRpY2xlLWl0ZW1cIjpcblx0XHRcdFx0YXR0clZhbCArPSBcInB1Ymxpc2gvYXJ0aWNsZXMvZWRpdC9cIiArIHRoaXMubW9kZWwuZ2V0KFwiYXJ0aWNsZVwiKS5pZDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiYnVuZGxlLWl0ZW1cIjpcblx0XHRcdFx0YXR0clZhbCArPSBcInB1Ymxpc2gvYnVuZGxlcy9lZGl0L1wiICsgdGhpcy5tb2RlbC5nZXQoXCJidW5kbGVcIikuaWQ7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcIm1lZGlhLWl0ZW1cIjpcblx0XHRcdFx0YXR0clZhbCArPSBcInB1Ymxpc2gvbWVkaWEvZWRpdC9cIiArIHRoaXMubW9kZWwuZ2V0KFwibWVkaWFcIikuaWQ7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcInJvb3RcIjpcblx0XHRcdFx0YXR0clZhbCArPSBcInB1Ymxpc2gvYnVuZGxlc1wiO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdFx0dGhpcy5iYWNrZW5kRWwuc2V0QXR0cmlidXRlKFwiaHJlZlwiLCBhdHRyVmFsKTtcblxuXHRcdGlmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJtZWRpYVwiKSkge1xuXHRcdFx0aWYgKHRoaXMubW9kZWwuaGFzKFwibWVkaWFcIikpIHtcblx0XHRcdFx0dGhpcy5tZWRpYUluZm9FbC50ZXh0Q29udGVudCA9IHNpemVUZW1wbGF0ZSh0aGlzLm1vZGVsLmdldChcIm1lZGlhXCIpLmdldChcInNvdXJjZVwiKS50b0pTT04oKSk7XG5cdFx0XHRcdHRoaXMubWVkaWFJbmZvRWwuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLm1lZGlhSW5mb0VsLnRleHRDb250ZW50ID0gXCJcIjtcblx0XHRcdFx0dGhpcy5tZWRpYUluZm9FbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdGNyZWF0ZUdyaWRFbGVtZW50OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdGVsLmlkID0gXCJncmlkLXdyYXBwZXJcIjtcblx0XHRlbC5pbm5lckhUTUwgPSBncmlkVGVtcGxhdGUoKTtcblx0XHRyZXR1cm4gZWw7XG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBEZWJ1Z1Rvb2xiYXI7IiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcImNvbXBpbGVyXCI6WzcsXCI+PSA0LjAuMFwiXSxcIm1haW5cIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHJldHVybiBcIjxzdmcgaWQ9XFxcImRlYnVnLWdyaWRcXFwiIHZlcnNpb249XFxcIjEuMVxcXCIgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB4bWxuczp4bGluaz1cXFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1xcXCIgcHJlc2VydmVBc3BlY3RSYXRpbz1cXFwieE1heFlNaWQgc2xpY2VcXFwiIHZpZXdwb3J0LWZpbGw9XFxcImhzbCgwLDAlLDEwMCUpXFxcIiB2aWV3cG9ydC1maWxsLW9wYWNpdHk9XFxcIjFcXFwiIHN0eWxlPVxcXCJmaWxsOm5vbmU7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjFweDtmaWxsOm5vbmU7ZmlsbC1ydWxlOmV2ZW5vZGQ7XFxcIj5cXG48ZGVmcz5cXG5cdDxwYXR0ZXJuIGlkPVxcXCJwYXQtYmFzZWxpbmUtMTJweFxcXCIgY2xhc3M9XFxcImJhc2VsaW5lIGJhc2UxMlxcXCIgeD1cXFwiMFxcXCIgeT1cXFwiMFxcXCIgd2lkdGg9XFxcIjIwXFxcIiBoZWlnaHQ9XFxcIjEyXFxcIiBwYXR0ZXJuVW5pdHM9XFxcInVzZXJTcGFjZU9uVXNlXFxcIj5cXG5cdFx0PGxpbmUgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjBcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIxLjBcXFwiLz5cXG5cdFx0PGxpbmUgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiM1xcXCIgeTI9XFxcIjNcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIwLjEyNVxcXCIvPlxcblx0XHQ8bGluZSB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCI2XFxcIiB5Mj1cXFwiNlxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuMzc1XFxcIi8+XFxuXHRcdDxsaW5lIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjlcXFwiIHkyPVxcXCI5XFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC4xMjVcXFwiLz5cXG5cdDwvcGF0dGVybj5cXG5cXG5cdDxwYXR0ZXJuIGlkPVxcXCJwYXQtYmFzZWxpbmUtMjRweFxcXCIgY2xhc3M9XFxcImJhc2VsaW5lIGJhc2UxMlxcXCIgeD1cXFwiMFxcXCIgeT1cXFwiMFxcXCIgd2lkdGg9XFxcIjIwXFxcIiBoZWlnaHQ9XFxcIjI0XFxcIiBwYXR0ZXJuVW5pdHM9XFxcInVzZXJTcGFjZU9uVXNlXFxcIj5cXG5cdFx0PGxpbmUgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjBcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIxLjBcXFwiLz5cXG5cdDwvcGF0dGVybj5cXG5cXG5cdDxwYXR0ZXJuIGlkPVxcXCJwYXQtYmFzZWxpbmUtMTBweFxcXCIgY2xhc3M9XFxcImJhc2VsaW5lIGJhc2UxMFxcXCIgeD1cXFwiMFxcXCIgeT1cXFwiMFxcXCIgd2lkdGg9XFxcIjIwXFxcIiBoZWlnaHQ9XFxcIjEwXFxcIiBwYXR0ZXJuVW5pdHM9XFxcInVzZXJTcGFjZU9uVXNlXFxcIj5cXG5cdFx0PGxpbmUgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjBcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIxLjAwXFxcIi8+XFxuXHRcdDxsaW5lIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjVcXFwiIHkyPVxcXCI1XFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC43NVxcXCIvPlxcblx0PC9wYXR0ZXJuPlxcblx0PHBhdHRlcm4gaWQ9XFxcInBhdC1iYXNlbGluZS0yMHB4XFxcIiBjbGFzcz1cXFwiYmFzZWxpbmUgYmFzZTEwXFxcIiB4PVxcXCIwXFxcIiB5PVxcXCIwXFxcIiB3aWR0aD1cXFwiMjBcXFwiIGhlaWdodD1cXFwiMjBcXFwiIHBhdHRlcm5Vbml0cz1cXFwidXNlclNwYWNlT25Vc2VcXFwiPlxcblx0XHQ8bGluZSB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMFxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjEuMFxcXCIvPlxcblx0PC9wYXR0ZXJuPlxcblx0PHBhdHRlcm4gaWQ9XFxcInBhdC1jb2xzLTIyMHB4XFxcIiB4PVxcXCIwXFxcIiB5PVxcXCIwXFxcIiB3aWR0aD1cXFwiMjIwXFxcIiBoZWlnaHQ9XFxcIjM2XFxcIiBwYXR0ZXJuVW5pdHM9XFxcInVzZXJTcGFjZU9uVXNlXFxcIj5cXG5cdFx0PHJlY3QgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMCwwKVxcXCIgeD1cXFwiMFxcXCIgeT1cXFwiMFxcXCIgd2lkdGg9XFxcIjIwXFxcIiBoZWlnaHQ9XFxcIjEwMCVcXFwiIGZpbGw9XFxcImhzbCgzMzYsNTAlLDQwJSlcXFwiIGZpbGwtb3BhY2l0eT1cXFwiMC4xXFxcIi8+XFxuXHRcdDxyZWN0IHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDIwMCwwKVxcXCIgeD1cXFwiMFxcXCIgeT1cXFwiMFxcXCIgd2lkdGg9XFxcIjIwXFxcIiBoZWlnaHQ9XFxcIjEwMCVcXFwiIGZpbGw9XFxcImhzbCgzMzYsNTAlLDQwJSlcXFwiIGZpbGwtb3BhY2l0eT1cXFwiMC4xXFxcIi8+XFxuXHRcdDxsaW5lIHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDIwIDApXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIgc3Ryb2tlPVxcXCJoc2woMzM2LDUwJSw2MCUpXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC4yXFxcIi8+XFxuXHRcdDxsaW5lIHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDIwMCAwKVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiIHN0cm9rZT1cXFwiaHNsKDMzNiw1MCUsNDAlKVxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuMlxcXCIvPlxcblxcblx0XHQ8bGluZSB0cmFuc2Zvcm09XFxcInRyYW5zbGF0ZSgxNDAgMClcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMFxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIiBzdHJva2U9XFxcImhzbCgzMzYsNTAlLDQwJSlcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIwLjNcXFwiLz5cXG5cdFx0PGxpbmUgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoODAgMClcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMFxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIiBzdHJva2U9XFxcImhzbCgzMzYsNTAlLDQwJSlcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIwLjNcXFwiLz5cXG5cXG5cdFx0PGxpbmUgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMCAwKVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiIHN0cm9rZT1cXFwiaHNsKDIzNiw1MCUsNDAlKVxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuNFxcXCIgc3Ryb2tlLXdpZHRoPVxcXCIxXFxcIi8+XFxuXHRcdDxsaW5lIHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDIyMCAwKVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiIHN0cm9rZT1cXFwiaHNsKDIzNiw1MCUsNDAlKVxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuNFxcXCIgc3Ryb2tlLXdpZHRoPVxcXCIxXFxcIi8+XFxuXHQ8L3BhdHRlcm4+XFxuPC9kZWZzPlxcbjxnIGlkPVxcXCJkZWJ1Zy1ncmlkLWJvZHlcXFwiIHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDAgMC41KVxcXCI+XFxuXHQ8cmVjdCBpZD1cXFwiYmFzZWxpbmVcXFwiIHg9XFxcIjBcXFwiIHk9XFxcIjBcXFwiIHdpZHRoPVxcXCIxMDAlXFxcIiBoZWlnaHQ9XFxcIjEwMCVcXFwiLz5cXG5cdDxnIGlkPVxcXCJkZWJ1Zy1ncmlkLWNvbnRhaW5lclxcXCI+XFxuXHRcdDxnIGlkPVxcXCJkZWJ1Zy1ncmlkLWNvbnRlbnRcXFwiPlxcblx0XHRcdDxyZWN0IGlkPVxcXCJiYXNlbGluZS1jb250ZW50XFxcIiB4PVxcXCIwXFxcIiB5PVxcXCIwXFxcIiB3aWR0aD1cXFwiMTAwJVxcXCIgaGVpZ2h0PVxcXCIxMDAlXFxcIi8+XFxuXHRcdFx0PGxpbmUgaWQ9XFxcImdjdDBcXFwiIGNsYXNzPVxcXCJoZ3VpZGVcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIwXFxcIi8+XFxuXHRcdFx0PGxpbmUgaWQ9XFxcImdjdDFcXFwiIGNsYXNzPVxcXCJoZ3VpZGVcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIwXFxcIi8+XFxuXHRcdDwvZz5cXG5cdFx0PGxpbmUgaWQ9XFxcImdudjBcXFwiIGNsYXNzPVxcXCJoZ3VpZGVcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIwXFxcIi8+XFxuXHRcdDxsaW5lIGlkPVxcXCJnbnYxXFxcIiBjbGFzcz1cXFwiaGd1aWRlXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMFxcXCIvPlxcblx0PC9nPlxcblxcblx0PGcgaWQ9XFxcImFicy1jb2xzXFxcIj5cXG5cdFx0PHJlY3QgaWQ9XFxcImNvbHVtbnNcXFwiIHg9XFxcIjBcXFwiIHk9XFxcIjBcXFwiIHdpZHRoPVxcXCIxMDAlXFxcIiBoZWlnaHQ9XFxcIjEwMCVcXFwiLz5cXG5cdDwvZz5cXG5cXG5cdDxnIGlkPVxcXCJyZWwtY29sc1xcXCI+XFxuXHRcdDxsaW5lIGlkPVxcXCJsZVxcXCIgY2xhc3M9XFxcInZndWlkZSBlZGdlXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIvPlxcblx0XHQ8bGluZSBpZD1cXFwicmVcXFwiIGNsYXNzPVxcXCJ2Z3VpZGUgZWRnZVxcXCIgeDE9XFxcIjEwMCVcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiLz5cXG5cXG5cdFx0PGxpbmUgaWQ9XFxcImdsMFxcXCIgY2xhc3M9XFxcInZndWlkZSBtYXJnaW5cXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMFxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIi8+XFxuXHRcdDxsaW5lIGlkPVxcXCJnbDFcXFwiIGNsYXNzPVxcXCJ2Z3VpZGUgZ3V0dGVyXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIvPlxcblxcblx0XHQ8bGluZSBpZD1cXFwiZ3IwXFxcIiBjbGFzcz1cXFwidmd1aWRlIG1hcmdpblxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiLz5cXG5cdFx0PGxpbmUgaWQ9XFxcImdyMVxcXCIgY2xhc3M9XFxcInZndWlkZSBndXR0ZXJcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMFxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIi8+XFxuXFxuXHRcdDxsaW5lIGlkPVxcXCJnbVxcXCIgY2xhc3M9XFxcInZndWlkZVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiLz5cXG5cdDwvZz5cXG48L2c+XFxuPC9zdmc+XFxuXCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCIxXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxO1xuXG4gIHJldHVybiBcIlx0PGRkIGlkPVxcXCJzZWxlY3QtbGF5b3V0XFxcIj5cXG5cdFx0PHNlbGVjdCBzaXplPTE+XFxuXCJcbiAgICArICgoc3RhY2sxID0gaGVscGVycy5lYWNoLmNhbGwoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAubGF5b3V0cyA6IGRlcHRoMCkse1wibmFtZVwiOlwiZWFjaFwiLFwiaGFzaFwiOnt9LFwiZm5cIjpjb250YWluZXIucHJvZ3JhbSgyLCBkYXRhLCAwKSxcImludmVyc2VcIjpjb250YWluZXIubm9vcCxcImRhdGFcIjpkYXRhfSkpICE9IG51bGwgPyBzdGFjazEgOiBcIlwiKVxuICAgICsgXCJcdFx0PC9zZWxlY3Q+XFxuXHQ8L2RkPlxcblwiO1xufSxcIjJcIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBhbGlhczE9Y29udGFpbmVyLmxhbWJkYSwgYWxpYXMyPWNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uO1xuXG4gIHJldHVybiBcIlx0XHRcdDxvcHRpb24gdmFsdWU9XFxcIlwiXG4gICAgKyBhbGlhczIoYWxpYXMxKGRlcHRoMCwgZGVwdGgwKSlcbiAgICArIFwiXFxcIj5cIlxuICAgICsgYWxpYXMyKGFsaWFzMShkZXB0aDAsIGRlcHRoMCkpXG4gICAgKyBcIjwvb3B0aW9uPlxcblwiO1xufSxcIjRcIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBzdGFjazEsIGhlbHBlciwgYWxpYXMxPWRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge307XG5cbiAgcmV0dXJuIFwiXHRcdDxsaSBjbGFzcz1cXFwiXCJcbiAgICArICgoc3RhY2sxID0gaGVscGVyc1tcImlmXCJdLmNhbGwoYWxpYXMxLGRlcHRoMCx7XCJuYW1lXCI6XCJpZlwiLFwiaGFzaFwiOnt9LFwiZm5cIjpjb250YWluZXIucHJvZ3JhbSg1LCBkYXRhLCAwKSxcImludmVyc2VcIjpjb250YWluZXIucHJvZ3JhbSg3LCBkYXRhLCAwKSxcImRhdGFcIjpkYXRhfSkpICE9IG51bGwgPyBzdGFjazEgOiBcIlwiKVxuICAgICsgXCJcXFwiPlwiXG4gICAgKyBjb250YWluZXIuZXNjYXBlRXhwcmVzc2lvbigoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLmtleSB8fCAoZGF0YSAmJiBkYXRhLmtleSkpICE9IG51bGwgPyBoZWxwZXIgOiBoZWxwZXJzLmhlbHBlck1pc3NpbmcpLCh0eXBlb2YgaGVscGVyID09PSBcImZ1bmN0aW9uXCIgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwia2V5XCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIjwvbGk+XFxuXCI7XG59LFwiNVwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgcmV0dXJuIFwicGFzc2VkXCI7XG59LFwiN1wiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgcmV0dXJuIFwiZmFpbGVkXCI7XG59LFwiY29tcGlsZXJcIjpbNyxcIj49IDQuMC4wXCJdLFwibWFpblwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIHN0YWNrMSwgYWxpYXMxPWRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge30sIGFsaWFzMj1jb250YWluZXIuZXNjYXBlRXhwcmVzc2lvbjtcblxuICByZXR1cm4gXCI8ZGwgY2xhc3M9XFxcImRlYnVnLWxpbmtzIGNvbG9yLWJnXFxcIj5cXG5cdDxkdCBpZD1cXFwibGlua3MtdG9nZ2xlXFxcIj5cXG5cdFx0PHN2ZyBjbGFzcz1cXFwiaWNvblxcXCIgdmlld0JveD1cXFwiLTEwMCAtMTAwIDIwMCAyMDBcXFwiIHZlcnNpb249XFxcIjEuMVxcXCIgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB4bWxuczp4bGluaz1cXFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1xcXCIgcHJlc2VydmVBc3BlY3RSYXRpbz1cXFwieE1pZFlNaWQgbWVldFxcXCI+XFxuXHRcdFx0PHBhdGggaWQ9XFxcImNvZ1xcXCIgZD1cXFwiTTExLjc1NCwtOTkuMzA3Yy03LjgwOSwtMC45MjQgLTE1LjY5OSwtMC45MjQgLTIzLjUwOCwwbC0zLjczLDIwLjgyYy02LjI1NCwxLjIzNCAtMTIuMzM4LDMuMjEgLTE4LjEyMyw1Ljg4OGwtMTUuMjU1LC0xNC42NTFjLTYuODYxLDMuODQyIC0xMy4yNDQsOC40OCAtMTkuMDE4LDEzLjgxOGw5LjIyLDE5LjAzNmMtNC4zMzUsNC42NzQgLTguMDk1LDkuODQ5IC0xMS4yMDEsMTUuNDE2bC0yMC45NTMsLTIuODg2Yy0zLjI5Miw3LjE0MSAtNS43MzEsMTQuNjQ1IC03LjI2NSwyMi4zNTdsMTguNjQ4LDkuOTgxYy0wLjc1OSw2LjMyOSAtMC43NTksMTIuNzI3IDAsMTkuMDU2bC0xOC42NDgsOS45ODFjMS41MzQsNy43MTIgMy45NzMsMTUuMjE2IDcuMjY1LDIyLjM1N2wyMC45NTMsLTIuODg2YzMuMTA2LDUuNTY3IDYuODY2LDEwLjc0MiAxMS4yMDEsMTUuNDE2bC05LjIyLDE5LjAzNmM1Ljc3NCw1LjMzOCAxMi4xNTcsOS45NzYgMTkuMDE4LDEzLjgxOGwxNS4yNTUsLTE0LjY1MWM1Ljc4NSwyLjY3OCAxMS44NjksNC42NTQgMTguMTIzLDUuODg4bDMuNzMsMjAuODJjNy44MDksMC45MjQgMTUuNjk5LDAuOTI0IDIzLjUwOCwwbDMuNzMsLTIwLjgyYzYuMjU0LC0xLjIzNCAxMi4zMzgsLTMuMjEgMTguMTIzLC01Ljg4OGwxNS4yNTUsMTQuNjUxYzYuODYxLC0zLjg0MiAxMy4yNDQsLTguNDggMTkuMDE4LC0xMy44MThsLTkuMjIsLTE5LjAzNmM0LjMzNSwtNC42NzQgOC4wOTUsLTkuODQ5IDExLjIwMSwtMTUuNDE2bDIwLjk1MywyLjg4NmMzLjI5MiwtNy4xNDEgNS43MzEsLTE0LjY0NSA3LjI2NSwtMjIuMzU3bC0xOC42NDgsLTkuOTgxYzAuNzU5LC02LjMyOSAwLjc1OSwtMTIuNzI3IDAsLTE5LjA1NmwxOC42NDgsLTkuOTgxYy0xLjUzNCwtNy43MTIgLTMuOTczLC0xNS4yMTYgLTcuMjY1LC0yMi4zNTdsLTIwLjk1MywyLjg4NmMtMy4xMDYsLTUuNTY3IC02Ljg2NiwtMTAuNzQyIC0xMS4yMDEsLTE1LjQxNmw5LjIyLC0xOS4wMzZjLTUuNzc0LC01LjMzOCAtMTIuMTU3LC05Ljk3NiAtMTkuMDE4LC0xMy44MThsLTE1LjI1NSwxNC42NTFjLTUuNzg1LC0yLjY3OCAtMTEuODY5LC00LjY1NCAtMTguMTIzLC01Ljg4OGwtMy43MywtMjAuODJaTTAsLTMzYzE4LjIxMywwIDMzLDE0Ljc4NyAzMywzM2MwLDE4LjIxMyAtMTQuNzg3LDMzIC0zMywzM2MtMTguMjEzLDAgLTMzLC0xNC43ODcgLTMzLC0zM2MwLC0xOC4yMTMgMTQuNzg3LC0zMyAzMywtMzNaXFxcIiBzdHlsZT1cXFwiZmlsbDpjdXJyZW50Q29sb3I7ZmlsbC1ydWxlOmV2ZW5vZGQ7XFxcIi8+XFxuXHRcdDwvc3ZnPlxcblx0PC9kdD5cXG5cdDxkdCBpZD1cXFwiYXBwLXN0YXRlXFxcIj5cXG5cdFx0PHNwYW4gY2xhc3M9XFxcImNvbG9yLWZnIGNvbG9yLWJnXFxcIiBkYXRhLXByb3A9XFxcImNvbGxhcHNlZFxcXCI+Yzwvc3Bhbj48c3BhbiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiIGRhdGEtcHJvcD1cXFwid2l0aEJ1bmRsZVxcXCI+Yjwvc3Bhbj48c3BhbiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiIGRhdGEtcHJvcD1cXFwid2l0aE1lZGlhXFxcIj5tPC9zcGFuPjxzcGFuIGNsYXNzPVxcXCJjb2xvci1mZyBjb2xvci1iZ1xcXCIgZGF0YS1wcm9wPVxcXCJ3aXRoQXJ0aWNsZVxcXCI+YTwvc3Bhbj5cXG5cdDwvZHQ+XFxuXCJcbiAgICArICgoc3RhY2sxID0gaGVscGVyc1tcImlmXCJdLmNhbGwoYWxpYXMxLChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5sYXlvdXRzIDogZGVwdGgwKSx7XCJuYW1lXCI6XCJpZlwiLFwiaGFzaFwiOnt9LFwiZm5cIjpjb250YWluZXIucHJvZ3JhbSgxLCBkYXRhLCAwKSxcImludmVyc2VcIjpjb250YWluZXIubm9vcCxcImRhdGFcIjpkYXRhfSkpICE9IG51bGwgPyBzdGFjazEgOiBcIlwiKVxuICAgICsgXCJcdDxkZCBpZD1cXFwiZWRpdC1iYWNrZW5kXFxcIj5cXG5cdFx0PGEgaHJlZj1cXFwiXCJcbiAgICArIGFsaWFzMigoaGVscGVycy5nbG9iYWwgfHwgKGRlcHRoMCAmJiBkZXB0aDAuZ2xvYmFsKSB8fCBoZWxwZXJzLmhlbHBlck1pc3NpbmcpLmNhbGwoYWxpYXMxLFwiQVBQX1JPT1RcIix7XCJuYW1lXCI6XCJnbG9iYWxcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkpXG4gICAgKyBcInN5bXBob255L1xcXCIgY2xhc3M9XFxcImNvbG9yLWZnIGNvbG9yLWJnXFxcIiB0YXJnZXQ9XFxcIl9ibGFua1xcXCI+Q01TPC9hPlxcblx0PC9kZD5cXG5cdDxkZCBpZD1cXFwidG9nZ2xlLXRlc3RzXFxcIj5cXG5cdFx0PGEgaHJlZj1cXFwiI3RvZ2dsZS10ZXN0c1xcXCIgY2xhc3M9XFxcImNvbG9yLWZnIGNvbG9yLWJnXFxcIj5UZXN0czwvYT5cXG5cdDwvZGQ+XFxuXHQ8ZGQgaWQ9XFxcInRvZ2dsZS1ibG9ja3NcXFwiPlxcblx0XHQ8YSBocmVmPVxcXCIjdG9nZ2xlLWJsb2Nrc1xcXCIgY2xhc3M9XFxcImNvbG9yLWZnIGNvbG9yLWJnXFxcIj5CbG9ja3M8L2E+XFxuXHQ8L2RkPlxcblx0PGRkIGlkPVxcXCJ0b2dnbGUtdHhcXFwiPlxcblx0XHQ8YSBocmVmPVxcXCIjdG9nZ2xlLWJsb2Nrc1xcXCIgY2xhc3M9XFxcImNvbG9yLWZnIGNvbG9yLWJnXFxcIj5UWC9GWDwvYT5cXG5cdDwvZGQ+XFxuXHQ8ZGQgaWQ9XFxcInRvZ2dsZS1ncmlkLWJnXFxcIj5cXG5cdFx0PGEgaHJlZj1cXFwiI3RvZ2dsZS1ncmlkLWJnXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiPkdyaWQ8L2E+XFxuXHQ8L2RkPlxcblx0PGRkIGlkPVxcXCJ0b2dnbGUtZ3JhcGhcXFwiPlxcblx0XHQ8YSBocmVmPVxcXCIjdG9nZ2xlLWdyYXBoXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiPkdyYXBoPC9hPlxcblx0PC9kZD5cXG5cdDxkZCBpZD1cXFwidG9nZ2xlLW1kb3duXFxcIj5cXG5cdFx0PGEgaHJlZj1cXFwiI3RvZ2dsZS1tZG93blxcXCIgY2xhc3M9XFxcImNvbG9yLWZnIGNvbG9yLWJnXFxcIj5NYXJrZG93bjwvYT5cXG5cdDwvZGQ+XFxuXHQ8ZGQgaWQ9XFxcInRvZ2dsZS1sb2dzXFxcIj5cXG5cdFx0PGEgaHJlZj1cXFwiI3RvZ2dsZS1sb2dzXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiPkxvZ3M8L2E+XFxuXHQ8L2RkPlxcblx0PGRkIGlkPVxcXCJtZWRpYS1pbmZvXFxcIj5cXG5cdFx0PHNwYW4+PC9zcGFuPlxcblx0PC9kZD5cXG5cdDxkZCBpZD1cXFwidmlld3BvcnQtaW5mb1xcXCI+XFxuXHRcdDxzcGFuPjwvc3Bhbj5cXG5cdDwvZGQ+XFxuPC9kbD5cXG48ZGl2IGlkPVxcXCJ0ZXN0LXJlc3VsdHNcXFwiPlxcblx0PGg2PlRlc3RzIDxhIGlkPVxcXCJ0b2dnbGUtcGFzc2VkXFxcIiBocmVmPVxcXCIjdG9nZ2xlLXBhc3NlZFxcXCI+UGFzc2VkPC9hPjwvaDY+XFxuXHQ8cD5cIlxuICAgICsgYWxpYXMyKGNvbnRhaW5lci5sYW1iZGEoKChzdGFjazEgPSAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAubmF2aWdhdG9yIDogZGVwdGgwKSkgIT0gbnVsbCA/IHN0YWNrMS51c2VyQWdlbnQgOiBzdGFjazEpLCBkZXB0aDApKVxuICAgICsgXCI8L3A+XFxuXHQ8dWw+XFxuXCJcbiAgICArICgoc3RhY2sxID0gaGVscGVycy5lYWNoLmNhbGwoYWxpYXMxLChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC50ZXN0cyA6IGRlcHRoMCkse1wibmFtZVwiOlwiZWFjaFwiLFwiaGFzaFwiOnt9LFwiZm5cIjpjb250YWluZXIucHJvZ3JhbSg0LCBkYXRhLCAwKSxcImludmVyc2VcIjpjb250YWluZXIubm9vcCxcImRhdGFcIjpkYXRhfSkpICE9IG51bGwgPyBzdGFjazEgOiBcIlwiKVxuICAgICsgXCJcdDwvdWw+XFxuPC9kaXY+XFxuXCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvQmFzZUl0ZW1cbiAqIEByZXF1aXJlcyBtb2R1bGU6YmFja2JvbmVcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcblxubW9kdWxlLmV4cG9ydHMgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xuXG5cdGRlZmF1bHRzOiB7XG5cdFx0cm91dGVOYW1lOiBcImluaXRpYWxcIixcblx0XHRjb2xsYXBzZWQ6IGZhbHNlLFxuXHRcdGFydGljbGU6IG51bGwsXG5cdFx0d2l0aEFydGljbGU6IGZhbHNlLFxuXHRcdGJ1bmRsZTogbnVsbCxcblx0XHR3aXRoQnVuZGxlOiBmYWxzZSxcblx0XHRtZWRpYTogbnVsbCxcblx0XHR3aXRoTWVkaWE6IGZhbHNlLFxuXHR9LFxuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuXHRcdE9iamVjdC5rZXlzKHRoaXMuZGVmYXVsdHMpLmZvckVhY2goZnVuY3Rpb24oZ2V0dGVyTmFtZSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGdldHRlck5hbWUsIHtcblx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5nZXQoZ2V0dGVyTmFtZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG59KTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL0Jhc2VJdGVtXG4gKiBAcmVxdWlyZXMgbW9kdWxlOmJhY2tib25lXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG52YXIgTW9kZWwgPSByZXF1aXJlKFwiYmFja2JvbmVcIikuTW9kZWw7XG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbi8vIHZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvdXRpbHMvc3RyaW5ncy9zdHJpcFRhZ3N9ICovXG4vLyB2YXIgc3RyaXBUYWdzID0gcmVxdWlyZShcInV0aWxzL3N0cmluZ3Mvc3RyaXBUYWdzXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL3BhcnNlU3ltQXR0cnN9ICovXG4vL3ZhciBwYXJzZVN5bUF0dHJzID0gcmVxdWlyZShcImFwcC9tb2RlbC9wYXJzZVN5bUF0dHJzXCIpO1xuXG52YXIgcGFyc2VTeW1BdHRycyA9IGZ1bmN0aW9uKHMpIHtcblx0cmV0dXJuIHMucmVwbGFjZSgvKFxcLHxcXDspL2csIGZ1bmN0aW9uKG0pIHtcblx0XHRyZXR1cm4gKG0gPT0gXCIsXCIpID8gXCI7XCIgOiBcIixcIjtcblx0fSk7XG59O1xudmFyIHRvQXR0cnNIYXNoID0gZnVuY3Rpb24ob2JqLCBhdHRyKSB7XG5cdGlmIChfLmlzU3RyaW5nKGF0dHIpKSB7XG5cdFx0dmFyIGlkeCA9IGF0dHIuaW5kZXhPZihcIjpcIik7XG5cdFx0aWYgKGlkeCA+IDApIHtcblx0XHRcdG9ialthdHRyLnN1YnN0cmluZygwLCBpZHgpXSA9IHBhcnNlU3ltQXR0cnMoYXR0ci5zdWJzdHJpbmcoaWR4ICsgMSkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRvYmpbYXR0cl0gPSBhdHRyOyAvLyB0byBtYXRjaCBIVE1MNTw+WEhUTUwgdmFsdWVsZXNzIGF0dHJpYnV0ZXNcblx0XHR9XG5cdH0gLy8gZWxzZSBpZ25vcmUgbm9uLXN0cmluZyB2YWx1ZXNcblx0cmV0dXJuIG9iajtcbn07XG5cbnZhciBCYXNlSXRlbVByb3RvID0ge1xuXG5cdF9kb21QcmVmaXg6IFwiX1wiLFxuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdC8vIGF0dHJzOiBmdW5jdGlvbigpIHsgcmV0dXJuIHt9OyB9LFxuXHRcdGdldCBhdHRycygpIHtcblx0XHRcdHJldHVybiB7fTtcblx0XHR9LFxuXHR9LFxuXG5cdGdldHRlcnM6IFtcImRvbWlkXCJdLFxuXG5cdG11dGF0b3JzOiB7XG5cdFx0ZG9taWQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCF0aGlzLmhhc093blByb3BlcnR5KFwiX2RvbUlkXCIpKVxuXHRcdFx0XHR0aGlzLl9kb21JZCA9IHRoaXMuX2RvbVByZWZpeCArIHRoaXMuaWQ7XG5cdFx0XHRyZXR1cm4gdGhpcy5fZG9tSWQ7XG5cdFx0fSxcblx0XHRhdHRyczoge1xuXHRcdFx0c2V0OiBmdW5jdGlvbihrZXksIHZhbHVlLCBvcHRpb25zLCBzZXQpIHtcblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG5cdFx0XHRcdFx0dmFsdWUgPSB2YWx1ZS5yZWR1Y2UodG9BdHRyc0hhc2gsIHt9KTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIV8uaXNPYmplY3QodmFsdWUpKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5lcnJvcihcIiVzOjphdHRycyB2YWx1ZSBub3QgYW4gb2JqZWN0IG9yIHN0cmluZyBhcnJheVwiLCB0aGlzLmNpZCwgdmFsdWUpO1xuXHRcdFx0XHRcdHZhbHVlID0ge307XG5cdFx0XHRcdH1cblx0XHRcdFx0c2V0KGtleSwgdmFsdWUsIG9wdGlvbnMpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdH0sXG5cblx0YXR0cjogZnVuY3Rpb24oYXR0cikge1xuXHRcdHJldHVybiB0aGlzLmF0dHJzKClbYXR0cl07XG5cdH0sXG5cblx0YXR0cnM6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmdldChcImF0dHJzXCIpO1xuXHR9LFxuXG5cdHRvU3RyaW5nOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5nZXQoXCJkb21pZFwiKTtcblx0fVxufTtcblxudmFyIEJhc2VJdGVtID0ge1xuXHRleHRlbmQ6IGZ1bmN0aW9uKHByb3RvLCBvYmopIHtcblx0XHR2YXIgY29uc3RyLCBwcm9wTmFtZTsgLy8sIHByb3BEZWY7XG5cdFx0Zm9yIChwcm9wTmFtZSBpbiBwcm90bykge1xuXHRcdFx0aWYgKHByb3RvLmhhc093blByb3BlcnR5KHByb3BOYW1lKSAmJiBfLmlzT2JqZWN0KHByb3RvW3Byb3BOYW1lXSkpIHsgLy8oT2JqZWN0LmdldFByb3RvdHlwZU9mKHByb3RvW3Byb3BOYW1lXSkgPT09IE9iamVjdC5wcm90b3R5cGUpKSB7XG5cdFx0XHRcdF8uZGVmYXVsdHMocHJvdG9bcHJvcE5hbWVdLCBCYXNlSXRlbVByb3RvW3Byb3BOYW1lXSk7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiQmFzZUl0ZW06OmV4dGVuZCAnJXM6JXMnIGlzIE9iamVjdFxcbiVzXCIsIHByb3RvLl9kb21QcmVmaXgsIHAsIEpTT04uc3RyaW5naWZ5KHByb3RvW3BdKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIGlmIChwcm90by5wcm9wZXJ0aWVzICYmIHRoaXMucHJvdG90eXBlLnByb3BlcnRpZXMpIHtcblx0XHQvLyBcdF8uZGVmYXVsdHMocHJvdG8ucHJvcGVydGllcywgdGhpcy5wcm90b3R5cGUucHJvcGVydGllcyk7XG5cdFx0Ly8gfVxuXHRcdGNvbnN0ciA9IE1vZGVsLmV4dGVuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0aWYgKEFycmF5LmlzQXJyYXkoY29uc3RyLnByb3RvdHlwZS5nZXR0ZXJzKSkge1xuXHRcdFx0Y29uc3RyLnByb3RvdHlwZS5nZXR0ZXJzLmZvckVhY2goZnVuY3Rpb24oZ2V0dGVyTmFtZSkge1xuXHRcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoY29uc3RyLnByb3RvdHlwZSwgZ2V0dGVyTmFtZSwge1xuXHRcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0XHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdHJldHVybiB0aGlzLmdldChnZXR0ZXJOYW1lKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdC8vIGlmIChfLmlzT2JqZWN0KHByb3RvLnByb3BlcnRpZXMpKSB7XG5cdFx0Ly8gXHRmb3IgKHByb3BOYW1lIGluIHByb3RvLnByb3BlcnRpZXMpIHtcblx0XHQvLyBcdFx0aWYgKHByb3RvLnByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkocHJvcE5hbWUpKSB7XG5cdFx0Ly8gXHRcdFx0cHJvcERlZiA9IHByb3RvLnByb3BlcnRpZXNbcHJvcE5hbWVdO1xuXHRcdC8vIFx0XHRcdGlmIChfLmlzRnVuY3Rpb24ocHJvcERlZikpIHtcblx0XHQvLyBcdFx0XHRcdHByb3RvLnByb3BlcnRpZXNbcHJvcE5hbWVdID0ge1xuXHRcdC8vIFx0XHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IHByb3BEZWZcblx0XHQvLyBcdFx0XHRcdH07XG5cdFx0Ly8gXHRcdFx0fSBlbHNlIGlmIChfLmlzT2JqZWN0KHByb3BEZWYpKXtcblx0XHQvLyBcdFx0XHRcdHByb3BEZWYuZW51bWVyYWJsZSA9IHRydWU7XG5cdFx0Ly8gXHRcdFx0fSBlbHNlIHtcblx0XHQvLyBcdFx0XHRcdGRlbGV0ZSBwcm90by5wcm9wZXJ0aWVzW3Byb3BOYW1lXTtcblx0XHQvLyBcdFx0XHR9XG5cdFx0Ly8gXHRcdH1cblx0XHQvLyBcdH1cblx0XHQvLyBcdE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHByb3RvLCBwcm90by5wcm9wZXJ0aWVzKTtcblx0XHQvLyBcdGRlbGV0ZSBwcm90by5wcm9wZXJ0aWVzO1xuXHRcdC8vIH1cblx0XHRyZXR1cm4gY29uc3RyO1xuXHR9XG59O1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvQmFzZUl0ZW19XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gQmFzZUl0ZW0uZXh0ZW5kLmNhbGwoTW9kZWwsIEJhc2VJdGVtUHJvdG8sIEJhc2VJdGVtKTtcbi8vIG1vZHVsZS5leHBvcnRzID0gTW9kZWwuZXh0ZW5kKEJhc2VJdGVtUHJvdG8sIEJhc2VJdGVtKTtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb25cbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xudmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb259XG4gKi9cbnZhciBTZWxlY3RhYmxlQ29sbGVjdGlvbiA9IEJhY2tib25lLkNvbGxlY3Rpb24uZXh0ZW5kKHtcblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbihtb2RlbHMsIG9wdGlvbnMpIHtcblx0XHRvcHRpb25zID0gXy5kZWZhdWx0cyh7fSwgb3B0aW9ucywge1xuXHRcdFx0aW5pdGlhbFNlbGVjdGlvbjogXCJub25lXCIsXG5cdFx0XHRzaWxlbnRJbml0aWFsOiB0cnVlXG5cdFx0fSk7XG5cdFx0dGhpcy5pbml0aWFsU2VsZWN0aW9uID0gb3B0aW9ucy5pbml0aWFsU2VsZWN0aW9uO1xuXHRcdHRoaXMuaW5pdGlhbE9wdGlvbnMgPSB7XG5cdFx0XHRzaWxlbnQ6IG9wdGlvbnMuc2lsZW50SW5pdGlhbFxuXHRcdH07XG5cdH0sXG5cblx0cmVzZXQ6IGZ1bmN0aW9uKG1vZGVscywgb3B0aW9ucykge1xuXHRcdHRoaXMuZGVzZWxlY3QodGhpcy5pbml0aWFsT3B0aW9ucyk7XG5cdFx0QmFja2JvbmUuQ29sbGVjdGlvbi5wcm90b3R5cGUucmVzZXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRpZiAodGhpcy5pbml0aWFsU2VsZWN0aW9uID09PSBcImZpcnN0XCIgJiYgdGhpcy5sZW5ndGgpIHtcblx0XHRcdHRoaXMuc2VsZWN0KHRoaXMuYXQoMCksIHRoaXMuaW5pdGlhbE9wdGlvbnMpO1xuXHRcdH1cblx0fSxcblxuXHRzZWxlY3Q6IGZ1bmN0aW9uKG5ld01vZGVsLCBvcHRpb25zKSB7XG5cdFx0aWYgKG5ld01vZGVsID09PSB2b2lkIDApIHtcblx0XHRcdG5ld01vZGVsID0gbnVsbDtcblx0XHR9XG5cdFx0aWYgKHRoaXMuc2VsZWN0ZWQgPT09IG5ld01vZGVsKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHZhciB0cmlnZ2VyRXZlbnRzID0gIShvcHRpb25zICYmIG9wdGlvbnMuc2lsZW50KTtcblx0XHR2YXIgb2xkTW9kZWwgPSB0aGlzLnNlbGVjdGVkO1xuXG5cdFx0dGhpcy5sYXN0U2VsZWN0ZWQgPSB0aGlzLnNlbGVjdGVkO1xuXHRcdHRoaXMubGFzdFNlbGVjdGVkSW5kZXggPSB0aGlzLnNlbGVjdGVkSW5kZXg7XG5cdFx0dGhpcy5zZWxlY3RlZCA9IG5ld01vZGVsO1xuXHRcdHRoaXMuc2VsZWN0ZWRJbmRleCA9IHRoaXMuaW5kZXhPZihuZXdNb2RlbCk7XG5cblx0XHRpZiAob2xkTW9kZWwpIHtcblx0XHRcdGlmIChfLmlzRnVuY3Rpb24ob2xkTW9kZWwuZGVzZWxlY3QpKSB7XG5cdFx0XHRcdG9sZE1vZGVsLmRlc2VsZWN0KG9wdGlvbnMpO1xuXHRcdFx0fSBlbHNlIGlmICh0cmlnZ2VyRXZlbnRzKSB7XG5cdFx0XHRcdG9sZE1vZGVsLnNlbGVjdGVkID0gdm9pZCAwO1xuXHRcdFx0XHRvbGRNb2RlbC50cmlnZ2VyKFwiZGVzZWxlY3RlZFwiLCBuZXdNb2RlbCwgb2xkTW9kZWwpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRyaWdnZXJFdmVudHMpIHRoaXMudHJpZ2dlcihcImRlc2VsZWN0Om9uZVwiLCBvbGRNb2RlbCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICh0cmlnZ2VyRXZlbnRzKSB0aGlzLnRyaWdnZXIoXCJkZXNlbGVjdDpub25lXCIsIG51bGwpO1xuXHRcdH1cblxuXHRcdGlmIChuZXdNb2RlbCkge1xuXHRcdFx0aWYgKF8uaXNGdW5jdGlvbihuZXdNb2RlbC5zZWxlY3QpKSB7XG5cdFx0XHRcdG5ld01vZGVsLnNlbGVjdChvcHRpb25zKTtcblx0XHRcdH0gZWxzZSBpZiAodHJpZ2dlckV2ZW50cykge1xuXHRcdFx0XHRuZXdNb2RlbC5zZWxlY3RlZCA9IHRydWU7XG5cdFx0XHRcdG5ld01vZGVsLnRyaWdnZXIoXCJzZWxlY3RlZFwiLCBuZXdNb2RlbCwgb2xkTW9kZWwpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRyaWdnZXJFdmVudHMpIHRoaXMudHJpZ2dlcihcInNlbGVjdDpvbmVcIiwgbmV3TW9kZWwpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAodHJpZ2dlckV2ZW50cykgdGhpcy50cmlnZ2VyKFwic2VsZWN0Om5vbmVcIiwgbnVsbCk7XG5cdFx0fVxuXHR9LFxuXG5cdGRlc2VsZWN0OiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dGhpcy5zZWxlY3QobnVsbCwgb3B0aW9ucyk7XG5cdH0sXG5cblx0c2VsZWN0QXQ6IGZ1bmN0aW9uKGluZGV4LCBvcHRpb25zKSB7XG5cdFx0aWYgKDAgPiBpbmRleCB8fCBpbmRleCA+PSB0aGlzLmxlbmd0aCkge1xuXHRcdFx0bmV3IFJhbmdlRXJyb3IoXCJpbmRleCBpcyBvdXQgb2YgYm91bmRzXCIpO1xuXHRcdH1cblx0XHR0aGlzLnNlbGVjdCh0aGlzLmF0KGluZGV4KSwgb3B0aW9ucyk7XG5cdH0sXG5cblx0ZGlzdGFuY2U6IGZ1bmN0aW9uKGEsIGIpIHtcblx0XHR2YXIgYUlkeCwgYklkeDtcblxuXHRcdGlmICghYSkgcmV0dXJuIE5hTjtcblx0XHRhSWR4ID0gdGhpcy5pbmRleE9mKGEpO1xuXHRcdGlmIChhSWR4ID09IC0xKSByZXR1cm4gTmFOO1xuXG5cdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMSkge1xuXHRcdFx0YklkeCA9IHRoaXMuc2VsZWN0ZWRJbmRleDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKCFiKSByZXR1cm4gTmFOO1xuXHRcdFx0YklkeCA9IHRoaXMuaW5kZXhPZihiKTtcblx0XHRcdGlmIChiSWR4ID09IC0xKSByZXR1cm4gTmFOO1xuXHRcdH1cblx0XHRyZXR1cm4gTWF0aC5hYnMoYklkeCAtIGFJZHgpO1xuXHR9LFxuXG5cdC8qIFRPRE86IE1PVkUgSU5UTyBNSVhJTiAqL1xuXG5cdC8qKiBAcmV0dXJuIGJvb2xlYW5cdC8qL1xuXHRoYXNGb2xsb3dpbmc6IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0bW9kZWwgfHwgKG1vZGVsID0gdGhpcy5zZWxlY3RlZCk7XG5cdFx0cmV0dXJuIHRoaXMuaW5kZXhPZihtb2RlbCkgPCAodGhpcy5sZW5ndGggLSAxKTtcblx0fSxcblxuXHQvKiogQHJldHVybiBuZXh0IG1vZGVsXHQqL1xuXHRmb2xsb3dpbmc6IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0bW9kZWwgfHwgKG1vZGVsID0gdGhpcy5zZWxlY3RlZCk7XG5cdFx0cmV0dXJuIHRoaXMuaGFzRm9sbG93aW5nKG1vZGVsKSA/IHRoaXMuYXQodGhpcy5pbmRleE9mKG1vZGVsKSArIDEpIDogbnVsbDtcblx0fSxcblxuXHQvKiogQHJldHVybiBuZXh0IG1vZGVsIG9yIHRoZSBiZWdpbm5pbmcgaWYgYXQgdGhlIGVuZCAqL1xuXHRmb2xsb3dpbmdPckZpcnN0OiBmdW5jdGlvbihtb2RlbCkge1xuXHRcdG1vZGVsIHx8IChtb2RlbCA9IHRoaXMuc2VsZWN0ZWQpO1xuXHRcdHJldHVybiB0aGlzLmF0KCh0aGlzLmluZGV4T2YobW9kZWwpICsgMSkgJSB0aGlzLmxlbmd0aCk7XG5cdH0sXG5cblx0LyoqIEByZXR1cm4gYm9vbGVhblx0LyovXG5cdGhhc1ByZWNlZGluZzogZnVuY3Rpb24obW9kZWwpIHtcblx0XHRtb2RlbCB8fCAobW9kZWwgPSB0aGlzLnNlbGVjdGVkKTtcblx0XHRyZXR1cm4gdGhpcy5pbmRleE9mKG1vZGVsKSA+IDA7XG5cdH0sXG5cblx0LyoqIEByZXR1cm4gdGhlIHByZXZpb3VzIG1vZGVsICovXG5cdHByZWNlZGluZzogZnVuY3Rpb24obW9kZWwpIHtcblx0XHRtb2RlbCB8fCAobW9kZWwgPSB0aGlzLnNlbGVjdGVkKTtcblx0XHRyZXR1cm4gdGhpcy5oYXNQcmVjZWRpbmcobW9kZWwpID8gdGhpcy5hdCh0aGlzLmluZGV4T2YobW9kZWwpIC0gMSkgOiBudWxsO1xuXHR9LFxuXG5cdC8qKiBAcmV0dXJuIHRoZSBwcmV2aW91cyBtb2RlbCBvciB0aGUgZW5kIGlmIGF0IHRoZSBiZWdpbm5pbmcgKi9cblx0cHJlY2VkaW5nT3JMYXN0OiBmdW5jdGlvbihtb2RlbCkge1xuXHRcdG1vZGVsIHx8IChtb2RlbCA9IHRoaXMuc2VsZWN0ZWQpO1xuXHRcdHZhciBpbmRleCA9IHRoaXMuaW5kZXhPZihtb2RlbCkgLSAxO1xuXHRcdHJldHVybiB0aGlzLmF0KGluZGV4ID4gLTEgPyBpbmRleCA6IHRoaXMubGVuZ3RoIC0gMSk7XG5cdH0sXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNlbGVjdGFibGVDb2xsZWN0aW9uO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9uXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9ufSAqL1xudmFyIFNlbGVjdGFibGVDb2xsZWN0aW9uID0gcmVxdWlyZShcImFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvblwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vQXJ0aWNsZUl0ZW19ICovXG52YXIgQXJ0aWNsZUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL2l0ZW0vQXJ0aWNsZUl0ZW1cIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9ufVxuICovXG52YXIgQXJ0aWNsZUNvbGxlY3Rpb24gPSBTZWxlY3RhYmxlQ29sbGVjdGlvbi5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7QmFja2JvbmUuTW9kZWx9ICovXG5cdG1vZGVsOiBBcnRpY2xlSXRlbVxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgQXJ0aWNsZUNvbGxlY3Rpb24oKTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvblxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvbn0gKi9cbnZhciBTZWxlY3RhYmxlQ29sbGVjdGlvbiA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb25cIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL0J1bmRsZUl0ZW19ICovXG52YXIgQnVuZGxlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9CdW5kbGVJdGVtXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9ufVxuICovXG52YXIgQnVuZGxlQ29sbGVjdGlvbiA9IFNlbGVjdGFibGVDb2xsZWN0aW9uLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtCYWNrYm9uZS5Nb2RlbH0gKi9cblx0bW9kZWw6IEJ1bmRsZUl0ZW0sXG5cblx0LyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cblx0Y29tcGFyYXRvcjogZnVuY3Rpb24ob2EsIG9iKSB7XG5cdFx0dmFyIGEgPSBvYS5nZXQoXCJjb21wbGV0ZWRcIik7XG5cdFx0dmFyIGIgPSBvYi5nZXQoXCJjb21wbGV0ZWRcIik7XG5cdFx0aWYgKGEgPiBiKSB7XG5cdFx0XHRyZXR1cm4gLTE7XG5cdFx0fSBlbHNlIGlmIChhIDwgYikge1xuXHRcdFx0cmV0dXJuIDE7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiAwO1xuXHRcdH1cblx0fSxcblxuXHQvKiogQHR5cGUge1N0cmluZ30gKi9cblx0dXJsOiBcIi9qc29uL2J1bmRsZXMvXCIsXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBCdW5kbGVDb2xsZWN0aW9uKCk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2NvbGxlY3Rpb24vS2V5d29yZENvbGxlY3Rpb25cbiAqIEByZXF1aXJlcyBtb2R1bGU6YmFja2JvbmVcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb259ICovXG52YXIgU2VsZWN0YWJsZUNvbGxlY3Rpb24gPSByZXF1aXJlKFwiYXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9uXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9LZXl3b3JkSXRlbX0gKi9cbnZhciBLZXl3b3JkSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9LZXl3b3JkSXRlbVwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vS2V5d29yZENvbGxlY3Rpb259XG4gKi9cbnZhciBLZXl3b3JkQ29sbGVjdGlvbiA9IFNlbGVjdGFibGVDb2xsZWN0aW9uLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtCYWNrYm9uZS5Nb2RlbH0gKi9cblx0bW9kZWw6IEtleXdvcmRJdGVtXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBLZXl3b3JkQ29sbGVjdGlvbigpO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9uXG4gKiBAcmVxdWlyZXMgbW9kdWxlOmJhY2tib25lXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG52YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL1R5cGVJdGVtfSAqL1xudmFyIFR5cGVJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9pdGVtL1R5cGVJdGVtXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9UeXBlQ29sbGVjdGlvbn1cbiAqL1xudmFyIFR5cGVDb2xsZWN0aW9uID0gQmFja2JvbmUuQ29sbGVjdGlvbi5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7QmFja2JvbmUuTW9kZWx9ICovXG5cdG1vZGVsOiBUeXBlSXRlbVxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBuZXcgVHlwZUNvbGxlY3Rpb24oKTtcbiIsIi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGJvb3RzdHJhcCkge1xuXG5cdC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG5cdHZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG5cblx0Ly8gR2xvYmFscy5HQV9UQUdTID0gYm9vdHN0cmFwW1wiZ2EtdGFnc1wiXTtcblx0Ly8gR2xvYmFscy5QQVJBTVMgPSBib290c3RyYXBbXCJwYXJhbXNcIl07XG5cdC8vIEdsb2JhbHMuQVBQX1JPT1QgPSBib290c3RyYXBbXCJwYXJhbXNcIl1bXCJyb290XCJdO1xuXHQvLyBHbG9iYWxzLk1FRElBX0RJUiA9IGJvb3RzdHJhcFtcInBhcmFtc1wiXVtcInVwbG9hZHNcIl07XG5cdEdsb2JhbHMuQVBQX05BTUUgPSBib290c3RyYXBbXCJwYXJhbXNcIl1bXCJ3ZWJzaXRlLW5hbWVcIl07XG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vVHlwZUNvbGxlY3Rpb259ICovXG5cdHZhciB0eXBlTGlzdCA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9UeXBlQ29sbGVjdGlvblwiKTtcblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vS2V5d29yZENvbGxlY3Rpb259ICovXG5cdHZhciBrZXl3b3JkTGlzdCA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvblwiKTtcblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvbn0gKi9cblx0dmFyIGJ1bmRsZUxpc3QgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvblwiKTtcblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb259ICovXG5cdHZhciBhcnRpY2xlTGlzdCA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvblwiKTtcblxuXHQvLyBGaXgtdXBzIHRvIGJvb3RzdHJhcCBkYXRhLlxuXHR2YXIgYXJ0aWNsZXMgPSBib290c3RyYXBbXCJhcnRpY2xlcy1hbGxcIl07XG5cdHZhciB0eXBlcyA9IGJvb3RzdHJhcFtcInR5cGVzLWFsbFwiXTtcblx0dmFyIGtleXdvcmRzID0gYm9vdHN0cmFwW1wia2V5d29yZHMtYWxsXCJdO1xuXHR2YXIgYnVuZGxlcyA9IGJvb3RzdHJhcFtcImJ1bmRsZXMtYWxsXCJdO1xuXHR2YXIgbWVkaWEgPSBib290c3RyYXBbXCJtZWRpYS1hbGxcIl07XG5cblx0Ly8gQXR0YWNoIG1lZGlhIHRvIHRoZWlyIGJ1bmRsZXNcblx0dmFyIG1lZGlhQnlCdW5kbGUgPSBfLmdyb3VwQnkobWVkaWEsIFwiYklkXCIpO1xuXG5cdC8vIEZpbGwtaW4gYmFjay1yZWZlcmVuY2VzOlxuXHQvLyBDcmVhdGUgS2V5d29yZC5idW5kbGVJZHMgZnJvbSBleGlzdGluZyBCdW5kbGUua2V5d29yZElkcyxcblx0Ly8gdGhlbiBCdW5kbGUudHlwZUlkcyBmcm9tIHVuaXF1ZSBLZXl3b3JkLnR5cGVJZFxuXG5cdC8vIF8uZWFjaChidW5kbGVzLCBmdW5jdGlvbiAoYm8sIGJpLCBiYSkge1xuXHRidW5kbGVzLmZvckVhY2goZnVuY3Rpb24oYm8sIGJpLCBiYSkge1xuXHRcdGJvLnRJZHMgPSBbXTtcblx0XHRiby5tZWRpYSA9IG1lZGlhQnlCdW5kbGVbYm8uaWRdO1xuXHRcdC8vIF8uZWFjaChrZXl3b3JkcywgZnVuY3Rpb24gKGtvLCBraSwga2EpIHtcblx0XHRrZXl3b3Jkcy5mb3JFYWNoKGZ1bmN0aW9uKGtvLCBraSwga2EpIHtcblx0XHRcdGlmIChiaSA9PT0gMCkge1xuXHRcdFx0XHRrby5iSWRzID0gW107XG5cdFx0XHR9XG5cdFx0XHQvLyBpZiAoXy5jb250YWlucyhiby5rSWRzLCBrby5pZCkpIHtcblx0XHRcdGlmIChiby5rSWRzLmluZGV4T2Yoa28uaWQpICE9IC0xKSB7XG5cdFx0XHRcdGtvLmJJZHMucHVzaChiby5pZCk7XG5cdFx0XHRcdC8vIGlmICghXy5jb250YWlucyhiby50SWRzLCBrby50SWQpKSB7XG5cdFx0XHRcdGlmIChiby50SWRzLmluZGV4T2Yoa28udElkKSA9PSAtMSkge1xuXHRcdFx0XHRcdGJvLnRJZHMucHVzaChrby50SWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pO1xuXG5cdC8vIEZpbGwgY29sbGVjdGlvbiBzaW5nbGV0b25zXG5cdGFydGljbGVMaXN0LnJlc2V0KGFydGljbGVzKTtcblx0dHlwZUxpc3QucmVzZXQodHlwZXMpO1xuXHRrZXl3b3JkTGlzdC5yZXNldChrZXl3b3Jkcyk7XG5cdGJ1bmRsZUxpc3QucmVzZXQoYnVuZGxlcyk7XG5cblx0Ly8gYm9vdHN0cmFwW1wicGFyYW1zXCJdID0gYm9vdHN0cmFwW1wiYXJ0aWNsZXMtYWxsXCJdID0gYm9vdHN0cmFwW1widHlwZXMtYWxsXCJdID0gYm9vdHN0cmFwW1wia2V5d29yZHMtYWxsXCJdID0gYm9vdHN0cmFwW1wiYnVuZGxlcy1hbGxcIl0gPSBib290c3RyYXBbXCJtZWRpYS1hbGxcIl0gPSBudWxsO1xufTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2l0ZW0vQXJ0aWNsZUl0ZW1cbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL1NvdXJjZUl0ZW19ICovXG52YXIgQmFzZUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL0Jhc2VJdGVtXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9BcnRpY2xlSXRlbX1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBCYXNlSXRlbS5leHRlbmQoe1xuXG5cdF9kb21QcmVmaXg6IFwiYVwiLFxuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdG5hbWU6IFwiXCIsXG5cdFx0aGFuZGxlOiBcIlwiLFxuXHRcdHRleHQ6IFwiXCJcblx0fSxcblxufSk7IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9pdGVtL0J1bmRsZUl0ZW1cbiAqIEByZXF1aXJlcyBtb2R1bGU6YmFja2JvbmVcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBDb2xvciA9IHJlcXVpcmUoXCJjb2xvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vU291cmNlSXRlbX0gKi9cbnZhciBCYXNlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvQmFzZUl0ZW1cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9NZWRpYUl0ZW19ICovXG52YXIgTWVkaWFJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvbn0gKi9cbnZhciBTZWxlY3RhYmxlQ29sbGVjdGlvbiA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb25cIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG52YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3V0aWxzL3N0cmluZ3Mvc3RyaXBUYWdzfSAqL1xudmFyIHN0cmlwVGFncyA9IHJlcXVpcmUoXCJ1dGlscy9zdHJpbmdzL3N0cmlwVGFnc1wiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC91dGlscy9zdHJpbmdzL3BhcnNlVGFnbGlzdH0gKi9cbi8vIHZhciBwYXJzZVN5bUF0dHJzID0gcmVxdWlyZShcImFwcC9tb2RlbC9wYXJzZVN5bUF0dHJzXCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvbn0gKi9cbi8vIHZhciBrZXl3b3JkcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvblwiKTtcblxuLy8gR2xvYmFscy5ERUZBVUxUX0NPTE9SU1tcImNvbG9yXCJdO1xuLy8gR2xvYmFscy5ERUZBVUxUX0NPTE9SU1tcImJhY2tncm91bmQtY29sb3JcIl07XG52YXIgYXR0cnNEZWZhdWx0ID0gXy5kZWZhdWx0cyh7XG5cdFwiaGFzLWNvbG9yc1wiOiBcImRlZmF1bHRzXCJcbn0sIEdsb2JhbHMuREVGQVVMVF9DT0xPUlMpO1xuXG4vKiogQHByaXZhdGUgKi9cbnZhciBNZWRpYUNvbGxlY3Rpb24gPSBTZWxlY3RhYmxlQ29sbGVjdGlvbi5leHRlbmQoe1xuXHRtb2RlbDogTWVkaWFJdGVtLFxuXHRjb21wYXJhdG9yOiBcIm9cIlxufSk7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL0J1bmRsZUl0ZW19XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gQmFzZUl0ZW0uZXh0ZW5kKHtcblxuXHRfZG9tUHJlZml4OiBcImJcIixcblxuXHQvKiogQHR5cGUge09iamVjdHxGdW5jdGlvbn0gKi9cblx0Ly8gZGVmYXVsdHM6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdHJldHVybiB7XG5cdC8vIFx0XHRuYW1lOiBcIlwiLFxuXHQvLyBcdFx0aGFuZGxlOiBcIlwiLFxuXHQvLyBcdFx0ZGVzYzogXCJcIixcblx0Ly8gXHRcdGNvbXBsZXRlZDogMCxcblx0Ly8gXHRcdGtJZHM6IFtdLFxuXHQvLyBcdH07XG5cdC8vIH0sXG5cdGRlZmF1bHRzOiB7XG5cdFx0bmFtZTogXCJcIixcblx0XHRoYW5kbGU6IFwiXCIsXG5cdFx0ZGVzYzogXCJcIixcblx0XHRjb21wbGV0ZWQ6IDAsXG5cdFx0Z2V0IGtJZHMoKSB7XG5cdFx0XHRyZXR1cm4gW107XG5cdFx0fSxcblx0XHQvLyBnZXQga2V5d29yZHMoKSB7IHJldHVybiBbXTsgfSxcblx0fSxcblxuXHRnZXR0ZXJzOiBbXCJuYW1lXCIsIFwibWVkaWFcIl0sXG5cblx0bXV0YXRvcnM6IHtcblx0XHR0ZXh0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBzdHJpcFRhZ3ModGhpcy5nZXQoXCJkZXNjXCIpKTtcblx0XHR9LFxuXHRcdC8vIGtJZHM6IHtcblx0XHQvLyBcdHNldDogZnVuY3Rpb24gKGtleSwgdmFsdWUsIG9wdGlvbnMsIHNldCkge1xuXHRcdC8vIFx0XHRpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcblx0XHQvLyBcdFx0XHRzZXQoXCJrZXl3b3Jkc1wiLCB2YWx1ZS5tYXAoZnVuY3Rpb24oaWQpIHtcblx0XHQvLyBcdFx0XHRcdHZhciBvYmogPSBrZXl3b3Jkcy5nZXQoaWQpO1xuXHRcdC8vIFx0XHRcdFx0cmV0dXJuIG9iajtcblx0XHQvLyBcdFx0XHR9LCB0aGlzKSwgb3B0aW9ucztcblx0XHQvLyBcdFx0fVxuXHRcdC8vIFx0XHRzZXQoa2V5LCB2YWx1ZSwgb3B0aW9ucyk7XG5cdFx0Ly8gXHR9LFxuXHRcdC8vIH0sXG5cdFx0bWVkaWE6IHtcblx0XHRcdHRyYW5zaWVudDogdHJ1ZSxcblx0XHRcdHNldDogZnVuY3Rpb24oa2V5LCB2YWx1ZSwgb3B0aW9ucywgc2V0KSB7XG5cdFx0XHRcdGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuXHRcdFx0XHRcdHZhbHVlLmZvckVhY2goZnVuY3Rpb24obykge1xuXHRcdFx0XHRcdFx0by5idW5kbGUgPSB0aGlzO1xuXHRcdFx0XHRcdH0sIHRoaXMpO1xuXHRcdFx0XHRcdHZhbHVlID0gbmV3IE1lZGlhQ29sbGVjdGlvbih2YWx1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0c2V0KGtleSwgdmFsdWUsIG9wdGlvbnMpO1xuXHRcdFx0fSxcblx0XHR9LFxuXHR9LFxuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKGF0dHJzLCBvcHRpb25zKSB7XG5cdFx0dGhpcy5jb2xvcnMgPSB7XG5cdFx0XHRmZ0NvbG9yOiBuZXcgQ29sb3IodGhpcy5hdHRyKFwiY29sb3JcIikpLFxuXHRcdFx0YmdDb2xvcjogbmV3IENvbG9yKHRoaXMuYXR0cihcImJhY2tncm91bmQtY29sb3JcIikpLFxuXHRcdFx0bG5Db2xvcjogbmV3IENvbG9yKHRoaXMuYXR0cihcImxpbmstY29sb3JcIikpLFxuXHRcdH07XG5cdFx0dGhpcy5jb2xvcnMuaGFzRGFya0JnID0gdGhpcy5jb2xvcnMuZmdDb2xvci5sdW1pbm9zaXR5KCkgPiB0aGlzLmNvbG9ycy5iZ0NvbG9yLmx1bWlub3NpdHkoKTtcblx0fSxcblxuXHRhdHRyczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX2F0dHJzIHx8ICh0aGlzLl9hdHRycyA9IF8uZGVmYXVsdHMoe30sIHRoaXMuZ2V0KFwiYXR0cnNcIiksIGF0dHJzRGVmYXVsdCkpO1xuXHR9LFxufSk7IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9pdGVtL0tleXdvcmRJdGVtXG4gKiBAcmVxdWlyZXMgbW9kdWxlOmFwcC9tb2RlbC9CYXNlSXRlbVxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9CYXNlSXRlbX0gKi9cbnZhciBCYXNlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvQmFzZUl0ZW1cIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9ufSAqL1xuLy8gdmFyIHR5cGVzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9uXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9LZXl3b3JkSXRlbX1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBCYXNlSXRlbS5leHRlbmQoe1xuXG5cdF9kb21QcmVmaXg6IFwia1wiLFxuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdG5hbWU6IFwiXCIsXG5cdFx0aGFuZGxlOiBcIlwiLFxuXHRcdHRJZDogLTEsXG5cdH0sXG5cblx0Ly8gbXV0YXRvcnM6IHtcblx0Ly8gXHR0SWQ6IHtcblx0Ly8gXHRcdHNldDogZnVuY3Rpb24gKGtleSwgdmFsdWUsIG9wdGlvbnMsIHNldCkge1xuXHQvLyBcdFx0XHR2YXIgdHlwZSA9IHR5cGVzLmdldCh2YWx1ZSk7XG5cdC8vIFx0XHRcdGlmICh0eXBlKSB7XG5cdC8vIFx0XHRcdFx0dHlwZS5nZXQoXCJrZXl3b3Jkc1wiKS5wdXNoKHRoaXMpO1xuXHQvLyBcdFx0XHRcdHNldChcInR5cGVcIiwgdHlwZSwgb3B0aW9ucyk7XG5cdC8vIFx0XHRcdH1cblx0Ly8gXHRcdFx0c2V0KGtleSwgdmFsdWUsIG9wdGlvbnMpO1xuXHQvLyBcdFx0fVxuXHQvLyBcdH0sXG5cdC8vIH1cbn0pO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbVxuICogQHJlcXVpcmVzIG1vZHVsZTpiYWNrYm9uZVxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtfSAqL1xudmFyIEJhc2VJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9CYXNlSXRlbVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL1NvdXJjZUl0ZW19ICovXG52YXIgU291cmNlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9ufSAqL1xudmFyIFNlbGVjdGFibGVDb2xsZWN0aW9uID0gcmVxdWlyZShcImFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvblwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdXRpbHMvc3RyaW5ncy9zdHJpcFRhZ3N9ICovXG52YXIgc3RyaXBUYWdzID0gcmVxdWlyZShcInV0aWxzL3N0cmluZ3Mvc3RyaXBUYWdzXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL3BhcnNlU3ltQXR0cnN9ICovXG4vLyB2YXIgcGFyc2VTeW1BdHRycyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvcGFyc2VTeW1BdHRyc1wiKTtcblxuLy8gY29uc29sZS5sb2coR2xvYmFscy5QQVJBTVMpO1xuXG52YXIgdXJsVGVtcGxhdGVzID0ge1xuXHRcIm9yaWdpbmFsXCI6IF8udGVtcGxhdGUoR2xvYmFscy5NRURJQV9ESVIgKyBcIi88JT0gc3JjICU+XCIpLFxuXHRcImNvbnN0cmFpbi13aWR0aFwiOiBfLnRlbXBsYXRlKEdsb2JhbHMuQVBQX1JPT1QgKyBcImltYWdlLzEvPCU9IHdpZHRoICU+LzAvdXBsb2Fkcy88JT0gc3JjICU+XCIpLFxuXHRcImNvbnN0cmFpbi1oZWlnaHRcIjogXy50ZW1wbGF0ZShHbG9iYWxzLkFQUF9ST09UICsgXCJpbWFnZS8xLzAvPCU9IGhlaWdodCAlPi91cGxvYWRzLzwlPSBzcmMgJT5cIiksXG5cdFwiZGVidWctYmFuZHdpZHRoXCI6IF8udGVtcGxhdGUoR2xvYmFscy5NRURJQV9ESVIucmVwbGFjZSgvKGh0dHBzP1xcOlxcL1xcL1teXFwvXSspLywgXCIkMS9zbG93LzwlPSBrYnBzICU+XCIpICsgXCIvPCU9IHNyYyAlPlwiKSxcbn07XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbS5Tb3VyY2VDb2xsZWN0aW9ufVxuICovXG52YXIgU291cmNlQ29sbGVjdGlvbiA9IFNlbGVjdGFibGVDb2xsZWN0aW9uLmV4dGVuZCh7XG5cdG1vZGVsOiBTb3VyY2VJdGVtXG59KTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtfVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IEJhc2VJdGVtLmV4dGVuZCh7XG5cblx0X2RvbVByZWZpeDogXCJtXCIsXG5cblx0LyoqIEB0eXBlIHtPYmplY3R9ICovXG5cdGRlZmF1bHRzOiB7XG5cdFx0bmFtZTogXCI8cD48ZW0+VW50aXRsZWQ8L2VtPjwvcD5cIixcblx0XHRzdWI6IFwiXCIsXG5cdFx0bzogMCxcblx0XHRiSWQ6IC0xLFxuXHRcdHNyY0lkeDogMCxcblx0XHRnZXQgc3Jjc2V0KCkge1xuXHRcdFx0cmV0dXJuIFtdO1xuXHRcdH0sXG5cdFx0Z2V0IHNvdXJjZXMoKSB7XG5cdFx0XHRyZXR1cm4gbmV3IFNvdXJjZUNvbGxlY3Rpb24oKTtcblx0XHR9LFxuXHR9LFxuXG5cdGdldHRlcnM6IFtcIm5hbWVcIiwgXCJidW5kbGVcIiwgXCJzb3VyY2VcIiwgXCJzb3VyY2VzXCJdLFxuXG5cdG11dGF0b3JzOiB7XG5cdFx0Ly8gZGVzYzogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gXHRyZXR1cm4gdGhpcy5nZXQoXCJuYW1lXCIpO1xuXHRcdC8vIH0sXG5cdFx0aGFuZGxlOiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLmdldChcInNyY1wiKTtcblx0XHR9LFxuXHRcdHRleHQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCF0aGlzLmhhc093blByb3BlcnR5KFwiX3RleHRcIikpXG5cdFx0XHRcdHRoaXMuX3RleHQgPSBfLnVuZXNjYXBlKHN0cmlwVGFncyh0aGlzLmdldChcIm5hbWVcIikpKTtcblx0XHRcdHJldHVybiB0aGlzLl90ZXh0O1xuXHRcdH0sXG5cdFx0YXR0cnM6IHtcblx0XHRcdHNldDogZnVuY3Rpb24oa2V5LCB2YWx1ZSwgb3B0cywgc2V0KSB7XG5cdFx0XHRcdHRoaXMuX2F0dHJzID0gbnVsbDtcblx0XHRcdFx0QmFzZUl0ZW0ucHJvdG90eXBlLm11dGF0b3JzLmF0dHJzLnNldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR0aGlzLl91cGRhdGVTb3VyY2VzKCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzcmNzZXQ6IHtcblx0XHRcdHNldDogZnVuY3Rpb24oa2V5LCB2YWx1ZSwgb3B0cywgc2V0KSB7XG5cdFx0XHRcdHNldChrZXksIHZhbHVlLCBvcHRzKTtcblx0XHRcdFx0dGhpcy5nZXQoXCJzb3VyY2VzXCIpLnJlc2V0KHZhbHVlLCBvcHRzKTtcblx0XHRcdFx0dGhpcy5fdXBkYXRlU291cmNlcygpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0c291cmNlOiB7XG5cdFx0XHR0cmFuc2llbnQ6IHRydWUsXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5nZXQoXCJzb3VyY2VzXCIpLmF0KHRoaXMuZ2V0KFwic3JjSWR4XCIpKTtcblx0XHRcdH0sXG5cdFx0fSxcblx0fSxcblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl91cGRhdGVDb2xvcnMoKTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwiY2hhbmdlOmF0dHJzIGNoYW5nZTpidW5kbGVcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLl9hdHRycyA9IG51bGw7XG5cdFx0fSk7XG5cdH0sXG5cblx0YXR0cnM6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLl9hdHRycyB8fCAodGhpcy5fYXR0cnMgPSBfLmRlZmF1bHRzKHt9LCB0aGlzLmdldChcImJ1bmRsZVwiKS5hdHRycygpLCB0aGlzLmdldChcImF0dHJzXCIpKSk7XG5cdH0sXG5cblx0X3VwZGF0ZUNvbG9yczogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5jb2xvcnMgPSB7XG5cdFx0XHRmZ0NvbG9yOiBuZXcgQ29sb3IodGhpcy5hdHRyKFwiY29sb3JcIikpLFxuXHRcdFx0YmdDb2xvcjogbmV3IENvbG9yKHRoaXMuYXR0cihcImJhY2tncm91bmQtY29sb3JcIikpXG5cdFx0fTtcblx0XHR0aGlzLmNvbG9ycy5oYXNEYXJrQmcgPSB0aGlzLmNvbG9ycy5mZ0NvbG9yLmx1bWlub3NpdHkoKSA+IHRoaXMuY29sb3JzLmJnQ29sb3IubHVtaW5vc2l0eSgpO1xuXHR9LFxuXG5cdF91cGRhdGVTb3VyY2VzOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgc3JjT2JqID0ge1xuXHRcdFx0a2JwczogdGhpcy5hdHRyKFwiQGRlYnVnLWJhbmR3aWR0aFwiKVxuXHRcdH07XG5cdFx0dmFyIHNyY1RwbCA9IHVybFRlbXBsYXRlc1tzcmNPYmoua2JwcyA/IFwiZGVidWctYmFuZHdpZHRoXCIgOiBcIm9yaWdpbmFsXCJdO1xuXHRcdHRoaXMuZ2V0KFwic291cmNlc1wiKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdHNyY09iai5zcmMgPSBpdGVtLmdldChcInNyY1wiKTtcblx0XHRcdGl0ZW0uc2V0KFwib3JpZ2luYWxcIiwgc3JjVHBsKHNyY09iaikpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8vIF91cGRhdGVTb3VyY2VzQXJyOiBmdW5jdGlvbigpIHtcblx0Ly8gXHR2YXIgc3Jjc2V0ID0gdGhpcy5nZXQoXCJzcmNzZXRcIik7XG5cdC8vIFx0aWYgKEFycmF5LmlzQXJyYXkoc3Jjc2V0KSkge1xuXHQvLyBcdFx0dmFyIHNyY09iaiA9IHsga2JwczogdGhpcy5hdHRyKFwiQGRlYnVnLWJhbmR3aWR0aFwiKSB9O1xuXHQvLyBcdFx0dmFyIHNyY1RwbCA9IEdsb2JhbHMuTUVESUFfU1JDX1RQTFtzcmNPYmoua2Jwcz8gXCJkZWJ1Zy1iYW5kd2lkdGhcIiA6IFwib3JpZ2luYWxcIl07XG5cdC8vIFx0XHRzcmNzZXQuZm9yRWFjaChmdW5jdGlvbihvKSB7XG5cdC8vIFx0XHRcdHNyY09iai5zcmMgPSBvLnNyYztcblx0Ly8gXHRcdFx0by5vcmlnaW5hbCA9IHNyY1RwbChzcmNPYmopO1xuXHQvLyBcdFx0fSwgdGhpcyk7XG5cdC8vIFx0fVxuXHQvLyBcdHRoaXMuZ2V0KFwic291cmNlc1wiKS5yZXNldChzcmNzZXQpO1xuXHQvLyB9LFxuXG59KTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2l0ZW0vU291cmNlSXRlbVxuICogQHJlcXVpcmVzIG1vZHVsZTpiYWNrYm9uZVxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbi8vIHZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtfSAqL1xudmFyIEJhc2VJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9CYXNlSXRlbVwiKTtcblxuLyoqIEB0eXBlIHtTdHJpbmd9ICovXG52YXIgbm9DYWNoZVN1ZmZpeCA9IFwiP1wiICsgRGF0ZS5ub3coKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vU291cmNlSXRlbX1cbiAqL1xuLy8gbW9kdWxlLmV4cG9ydHMgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xubW9kdWxlLmV4cG9ydHMgPSBCYXNlSXRlbS5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdHNyYzogbnVsbCxcblx0XHRtaW1lOiBudWxsLFxuXHRcdHc6IG51bGwsXG5cdFx0aDogbnVsbCxcblx0fSxcblxuXHRnZXR0ZXJzOiBbXCJzcmNcIiwgXCJvcmlnaW5hbFwiXSxcblxuXHRtdXRhdG9yczoge1xuXHRcdHNyYzoge1xuXHRcdFx0c2V0OiBmdW5jdGlvbihrZXksIHZhbHVlLCBvcHRpb25zLCBzZXQpIHtcblx0XHRcdFx0aWYgKERFQlVHKSB7XG5cdFx0XHRcdFx0dmFsdWUgKz0gbm9DYWNoZVN1ZmZpeDtcblx0XHRcdFx0fVxuXHRcdFx0XHRzZXQoa2V5LCB2YWx1ZSwgb3B0aW9ucyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHQvLyBvcmlnaW5hbDogeyBcblx0XHQvLyBcdHRyYW5zaWVudDogdHJ1ZSxcblx0XHQvLyBcdGdldDogZnVuY3Rpb24gKGtleSwgdmFsdWUsIG9wdGlvbnMsIHNldCkge1xuXHRcdC8vIFx0XHRyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLm9yaWdpbmFsIHx8ICh0aGlzLmF0dHJpYnV0ZXMub3JpZ2luYWwgPSB0aGlzLl9jb21wb3NlT3JpZ2luYWxTcmMoKSk7XG5cdFx0Ly8gXHR9LFxuXHRcdC8vIH0sXG5cdFx0Ly8gbWVkaWE6IHtcblx0XHQvLyBcdHRyYW5zaWVudDogdHJ1ZSxcblx0XHQvLyBcdGdldDogZnVuY3Rpb24gKCkge1xuXHRcdC8vIFx0XHR2YXIgcmV0dmFsO1xuXHRcdC8vIFx0XHRpZiAodGhpcy5fbm9SZWN1c2lvbikge1xuXHRcdC8vIFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Om1lZGlhIHJldHVybmluZyBudWxsXCIsIHRoaXMuY2lkKTtcblx0XHQvLyBcdFx0XHRyZXR2YWwgPSBudWxsOy8vdGhpcy5pZDtcblx0XHQvLyBcdFx0fSBlbHNlIHtcblx0XHQvLyBcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjptZWRpYSByZXR1cm5pbmcgT2JqZWN0XCIsIHRoaXMuY2lkKTtcblx0XHQvLyBcdFx0XHR0aGlzLl9ub1JlY3VzaW9uID0gdHJ1ZTtcblx0XHQvLyBcdFx0XHRyZXR2YWwgPSB0aGlzLmF0dHJpYnV0ZXMubWVkaWE7XG5cdFx0Ly8gXHRcdFx0dGhpcy5fbm9SZWN1c2lvbiA9IGZhbHNlO1xuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHRcdHJldHVybiByZXR2YWw7XG5cdFx0Ly8gXHR9LFxuXHRcdC8vIFx0c2V0OiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgb3B0aW9ucywgc2V0KSB7XG5cdFx0Ly8gXHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIEJhc2VJdGVtKSB7XG5cdFx0Ly8gXHRcdFx0c2V0KGtleSwgdmFsdWUsIG9wdGlvbnMpO1xuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHR9LFxuXHRcdC8vIH0sXG5cdH0sXG5cblx0Ly8gaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdC8vIFx0aWYgKERFQlVHKSB7XG5cdC8vIFx0XHR2YXIgY2IgPSBmdW5jdGlvbigpIHtcblx0Ly8gXHRcdFx0Ly8gY29uc29sZS5sb2coXCJAZGVidWctYmFuZHdpZHRoOlwiLCBKU09OLnN0cmluZ2lmeSh0aGlzLmdldChcIm1lZGlhXCIpLmF0dHIoXCJAZGVidWctYmFuZHdpZHRoXCIpKSk7XG5cdC8vIFx0XHRcdGNvbnNvbGUubG9nKFwibWVkaWE6XCIsIEpTT04uc3RyaW5naWZ5KHRoaXMudG9KU09OKCkpKTtcblx0Ly8gXHRcdFx0Ly8gaWYgKCh0aGlzLmdldChcIm1lZGlhXCIpIGluc3RhbmNlb2YgQmFzZUl0ZW0pICYmIHRoaXMuZ2V0KFwibWVkaWFcIikuYXR0cihcIkBkZWJ1Zy1iYW5kd2lkdGhcIikpIHtcblx0Ly8gXHRcdFx0Ly8gXHRjb25zb2xlLmxvZyhcIm9yaWdpbmFsXCIsIHRoaXMuZ2V0KFwib3JpZ2luYWxcIikpO1xuXHQvLyBcdFx0XHQvLyBcdGNvbnNvbGUubG9nKFwibWVkaWE6XCIsIEpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0KFwibWVkaWFcIikudG9KU09OKCkpKTtcblx0Ly8gXHRcdFx0Ly8gfVxuXHQvLyBcdFx0fS5iaW5kKHRoaXMpO1xuXHQvLyBcdFx0d2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShjYik7XG5cdC8vIFx0fVxuXHQvLyB9LFxuXHQvLyBcblx0Ly8gX2NvbXBvc2VPcmlnaW5hbFNyYzogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dmFyIHZhbHVlcyA9IHsgc3JjOiB0aGlzLmdldChcInNyY1wiKSB9O1xuXHQvLyBcdGlmICh0aGlzLmhhcyhcIm1lZGlhXCIpICYmICh2YWx1ZXMua2JwcyA9IHRoaXMuZ2V0KFwibWVkaWFcIikuYXR0cihcIkBkZWJ1Zy1iYW5kd2lkdGhcIikpKSB7XG5cdC8vIFx0Ly8gaWYgKHRoaXMuaGFzKFwibWVkaWFcIikgJiYgdGhpcy5nZXQoXCJtZWRpYVwiKS5hdHRycygpLmhhc093blByb3BlcnR5KFwiQGRlYnVnLWJhbmR3aWR0aFwiKSkge1xuXHQvLyBcdC8vIFx0dmFsdWVzLmticHMgPSB0aGlzLmdldChcIm1lZGlhXCIpLmF0dHJzKClbXCJAZGVidWctYmFuZHdpZHRoXCJdO1xuXHQvLyBcdFx0cmV0dXJuIEdsb2JhbHMuTUVESUFfU1JDX1RQTFtcImRlYnVnLWJhbmR3aWR0aFwiXSh2YWx1ZXMpO1xuXHQvLyBcdH1cblx0Ly8gXHRyZXR1cm4gR2xvYmFscy5NRURJQV9TUkNfVFBMW1wib3JpZ2luYWxcIl0odmFsdWVzKTtcblx0Ly8gfSxcbn0pO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9pdGVtL1R5cGVJdGVtXG4gKi9cblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtfSAqL1xudmFyIEJhc2VJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9CYXNlSXRlbVwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vVHlwZUl0ZW19XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gQmFzZUl0ZW0uZXh0ZW5kKHtcblxuXHRfZG9tUHJlZml4OiBcInRcIixcblxuXHQvKiogQHR5cGUge09iamVjdH0gKi9cblx0ZGVmYXVsdHM6IHtcblx0XHRuYW1lOiBcIlwiLFxuXHRcdGhhbmRsZTogXCJcIixcblx0XHQvLyBnZXQga0lkcygpIHsgcmV0dXJuIFtdOyB9LFxuXHRcdC8vIGdldCBrZXl3b3JkcygpIHsgcmV0dXJuIFtdOyB9LFxuXHR9LFxuXG59KTtcbiIsIi8qKlxuLyogQG1vZHVsZSBhcHAvdmlldy9BcHBWaWV3XG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3V0aWxzL2RlYnVnL3RyYWNlQXJnc30gKi9cbnZhciBzdHJpcFRhZ3MgPSByZXF1aXJlKFwidXRpbHMvc3RyaW5ncy9zdHJpcFRhZ3NcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG52YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvQ29udHJvbGxlcn0gKi9cbnZhciBjb250cm9sbGVyID0gcmVxdWlyZShcImFwcC9jb250cm9sL0NvbnRyb2xsZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvQXBwU3RhdGV9ICovXG52YXIgQXBwU3RhdGUgPSByZXF1aXJlKFwiYXBwL21vZGVsL0FwcFN0YXRlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvbn0gKi9cbnZhciBidW5kbGVzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb25cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvbn0gKi9cbnZhciBhcnRpY2xlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvblwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvTmF2aWdhdGlvblZpZXd9ICovXG52YXIgTmF2aWdhdGlvblZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvTmF2aWdhdGlvblZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9Db250ZW50Vmlld30gKi9cbnZhciBDb250ZW50VmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9Db250ZW50Vmlld1wiKTtcblxuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1RvdWNoTWFuYWdlcn0gKi9cbnZhciBUb3VjaE1hbmFnZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXJcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpoYW1tZXJqc30gKi9cbi8vIHZhciBIYW1tZXIgPSByZXF1aXJlKFwiaGFtbWVyanNcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy90b3VjaC9TbW9vdGhQYW5SZWNvZ25pemVyfSAqL1xuLy8gdmFyIFBhbiA9IHJlcXVpcmUoXCJ1dGlscy90b3VjaC9TbW9vdGhQYW5SZWNvZ25pemVyXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6aGFtbWVyanMuVGFwfSAqL1xuLy8gdmFyIFRhcCA9IEhhbW1lci5UYXA7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL2RlYnVnL3RyYWNlRWxlbWVudH0gKi9cbi8vIHZhciB0cmFjZUVsZW1lbnQgPSByZXF1aXJlKFwidXRpbHMvZGVidWcvdHJhY2VFbGVtZW50XCIpO1xuLy9cbi8vIHZhciB2cGFuTG9nRm4gPSBfLmRlYm91bmNlKGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksIDEwMCwgZmFsc2UpO1xuLy8gdmFyIGhwYW5Mb2dGbiA9IF8uZGVib3VuY2UoY29uc29sZS5sb2cuYmluZChjb25zb2xlKSwgMTAwLCBmYWxzZSk7XG5cbnZhciBBcHBWaWV3ID0ge1xuXHRnZXRJbnN0YW5jZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCEod2luZG93LmFwcCBpbnN0YW5jZW9mIHRoaXMpKSB7XG5cdFx0XHR3aW5kb3cuYXBwID0gbmV3KHRoaXMpKHtcblx0XHRcdFx0bW9kZWw6IG5ldyBBcHBTdGF0ZSgpXG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0cmV0dXJuIHdpbmRvdy5hcHA7XG5cdH1cbn07XG5cbnZhciBBcHBWaWV3UHJvdG8gPSB7XG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjaWRQcmVmaXg6IFwiYXBwXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0ZWw6IFwiaHRtbFwiLFxuXHQvLyAvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJhcHAgd2l0aG91dC1idW5kbGUgd2l0aG91dC1tZWRpYSB3aXRob3V0LWFydGljbGVcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRtb2RlbDogQXBwU3RhdGUsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRldmVudHM6IHtcblx0XHRcInZpc2liaWxpdHljaGFuZ2VcIjogZnVuY3Rpb24oZXYpIHtcblx0XHRcdGNvbnNvbGUubG9nKGV2LnR5cGUpO1xuXHRcdH0sXG5cdFx0XCJmdWxsc2NyZWVuY2hhbmdlXCI6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRjb25zb2xlLmxvZyhldi50eXBlKTtcblx0XHR9LFxuXHRcdFwiZHJhZ3N0YXJ0XCI6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRpZiAoZXYudGFyZ2V0Lm5vZGVOYW1lID09IFwiSU1HXCIgfHwgZXYudGFyZ2V0Lm5vZGVOYW1lID09IFwiQVwiKSB7XG5cdFx0XHRcdGV2LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0cHJvcGVydGllczoge1xuXHRcdGNvbnRhaW5lcjoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2NvbnRhaW5lciB8fFxuXHRcdFx0XHRcdCh0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImNvbnRhaW5lclwiKSk7XG5cdFx0XHRcdC8vICh0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5ib2R5KTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdG5hdmlnYXRpb246IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9uYXZpZ2F0aW9uIHx8XG5cdFx0XHRcdFx0KHRoaXMuX25hdmlnYXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5hdmlnYXRpb25cIikpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Y29udGVudDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2NvbnRlbnQgfHxcblx0XHRcdFx0XHQodGhpcy5fY29udGVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29udGVudFwiKSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHQvKiBlbGVtZW50cyAqL1xuXHRcdC8vIHRoaXMucm91dGVFbCA9IHRoaXMuZWw7XG5cdFx0Ly8gdGhpcy5zdGF0ZUVsID0gdGhpcy5lbFxuXHRcdHRoaXMuYnJlYWtwb2ludEVsID0gdGhpcy5lbDtcblx0XHQvLyB0aGlzLnRvdWNoRWwgPSBkb2N1bWVudC5ib2R5O1xuXHRcdC8vIHRoaXMudG91Y2hFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29udGFpbnRlclwiKTtcblxuXHRcdC8qIGluaXQgSGFtbWVySlMgaGFuZGxlcnMgKi9cblx0XHR2YXIgdnRvdWNoLCBodG91Y2g7XG5cdFx0Ly8gdmFyIHZwYW4sIGhwYW4sIHRhcDtcblxuXHRcdC8vIHRoaXMuX3ZwYW5FbmFibGVGbiA9IGZ1bmN0aW9uKG1jLCBldikge1xuXHRcdC8vIFx0dmFyIHJldHZhbCA9ICF0aGlzLl9oYXNPdmVyZmxvd1kodGhpcy5jb250YWluZXIpO1xuXHRcdC8vIFx0dnBhbkxvZ0ZuKFwiJXM6Ol92cGFuRW5hYmxlRm4gLT4gJW9cXG4lb1wiLCB0aGlzLmNpZCwgcmV0dmFsLCBhcmd1bWVudHMpO1xuXHRcdC8vIFx0cmV0dXJuIHJldHZhbDtcblx0XHQvLyB9LmJpbmQodGhpcyk7XG5cdFx0Ly9cblx0XHQvLyB0aGlzLl9ocGFuRW5hYmxlRm4gPSBmdW5jdGlvbihtYywgZXYpIHtcblx0XHQvLyBcdHZhciByZXR2YWwgPSB0aGlzLm1vZGVsLmdldChcIndpdGhCdW5kbGVcIikgJiYgdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdFx0Ly8gXHRocGFuTG9nRm4oXCIlczo6X2hwYW5FbmFibGVGbiAtPiAlb1xcbiVvXCIsIHRoaXMuY2lkLCByZXR2YWwsIGFyZ3VtZW50cyk7XG5cdFx0Ly8gXHRyZXR1cm4gISFyZXR2YWw7XG5cdFx0Ly8gfS5iaW5kKHRoaXMpO1xuXG5cdFx0dnRvdWNoID0gaHRvdWNoID0gVG91Y2hNYW5hZ2VyLmluaXQodGhpcy5jb250ZW50KTtcblx0XHQvLyB2dG91Y2guZ2V0KFwidnBhblwiKS5zZXQoeyBlbmFibGU6IHRoaXMuX3ZwYW5FbmFibGVGbiB9KTtcblx0XHQvLyBodG91Y2guZ2V0KFwiaHBhblwiKS5zZXQoeyBlbmFibGU6IHRoaXMuX2hwYW5FbmFibGVGbiB9KTtcbi8vIFx0XHR2dG91Y2guc2V0KHtcbi8vIFx0XHRcdGVuYWJsZTogZnVuY3Rpb24oKSB7XG4vLyBcdFx0XHRcdGNvbnNvbGUubG9nKFwiYXBwMTo6aGFtbWVyanMgZW5hYmxlXCIsIGFyZ3VtZW50cyk7XG4vLyBcdFx0XHRcdHJldHVybiB0cnVlO1xuLy8gXHRcdFx0fVxuLy8gXHRcdH0pO1xuXHRcdC8vIGhwYW4gPSB2cGFuO1xuXG5cdFx0Ly8gdGhpcy5lbC5zdHlsZS50b3VjaEFjdGlvbiA9IFwibm9uZVwiOyAvL1wicGFuLXggcGFuLXlcIjtcblxuXHRcdC8vIHRhcCA9IG5ldyBIYW1tZXIuVGFwKCk7XG5cdFx0Ly8gaHBhbiA9IG5ldyBQYW4oe1xuXHRcdC8vIFx0ZXZlbnQ6IFwiaHBhblwiLFxuXHRcdC8vIFx0ZGlyZWN0aW9uOiBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUxcblx0XHQvLyB9KTtcblx0XHQvLyBocGFuLnNldCh7XG5cdFx0Ly8gXHRlbmFibGU6IHRoaXMuX2hwYW5FbmFibGVGblxuXHRcdC8vIH0pO1xuXHRcdC8vIHZwYW4gPSBuZXcgUGFuKHtcblx0XHQvLyBcdGV2ZW50OiBcInZwYW5cIixcblx0XHQvLyBcdGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTFxuXHRcdC8vIH0pO1xuXHRcdC8vIHZwYW4uc2V0KHtcblx0XHQvLyBcdGVuYWJsZTogdGhpcy5fdnBhbkVuYWJsZUZuXG5cdFx0Ly8gfSk7XG5cdFx0Ly8gaHBhbi5yZXF1aXJlRmFpbHVyZSh2cGFuKTtcblx0XHQvLyB2cGFuLnJlcXVpcmVGYWlsdXJlKGhwYW4pO1xuXG5cdFx0Ly8gdnRvdWNoID0gbmV3IEhhbW1lci5NYW5hZ2VyKHRoaXMubmF2aWdhdGlvbik7XG5cdFx0Ly8gdnRvdWNoLmFkZChbXSk7XG5cblx0XHQvLyBodG91Y2ggPSB2dG91Y2ggPSBuZXcgSGFtbWVyLk1hbmFnZXIodGhpcy5jb250ZW50KTtcblx0XHQvLyBodG91Y2guYWRkKFt0YXAsIGhwYW4sIHZwYW5dKTtcblx0XHQvLyBodG91Y2guYWRkKFtocGFuLCB2cGFuXSk7XG5cdFx0Ly8gaHRvdWNoLnNldCh7IHRvdWNoQWN0aW9uOiBcInBhbi14IHBhbi15XCIgfSk7XG5cblx0XHQvLyB2cGFuID0gbmV3IEhhbW1lcih0aGlzLm5hdmlnYXRpb24sIHtcblx0XHQvLyBcdHJlY29nbml6ZXJzOiBbXG5cdFx0Ly8gXHRcdFtQYW4sIHtcblx0XHQvLyBcdFx0XHRldmVudDogJ3ZwYW4nLFxuXHRcdC8vIFx0XHRcdHRvdWNoQWN0aW9uOiBcInBhbi15XCIsXG5cdFx0Ly8gXHRcdFx0ZGlyZWN0aW9uOiBIYW1tZXIuRElSRUNUSU9OX1ZFUlRJQ0FMLFxuXHRcdC8vIFx0XHRcdGVuYWJsZTogdnBhbkVuYWJsZUZuXG5cdFx0Ly8gXHRcdH1dLFxuXHRcdC8vIFx0XVxuXHRcdC8vIH0pO1xuXHRcdC8vIGhwYW4gPSBuZXcgSGFtbWVyKHRoaXMuY29udGVudCwge1xuXHRcdC8vIFx0cmVjb2duaXplcnM6IFtcblx0XHQvLyBcdFx0W1Bhbiwge1xuXHRcdC8vIFx0XHRcdGV2ZW50OiAnaHBhbicsXG5cdFx0Ly8gXHRcdFx0dG91Y2hBY3Rpb246IFwicGFuLXhcIixcblx0XHQvLyBcdFx0XHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fSE9SSVpPTlRBTCxcblx0XHQvLyBcdFx0XHRlbmFibGU6IGhwYW5FbmFibGVGblxuXHRcdC8vIFx0XHR9XSxcblx0XHQvLyBcdFx0W1RhcF1cblx0XHQvLyBcdF1cblx0XHQvLyB9KTtcblx0XHQvLyBocGFuLmdldChcImhwYW5cIikucmVxdWlyZUZhaWx1cmUodnBhbi5nZXQoXCJ2cGFuXCIpKTtcblxuXHRcdC8vIHRoaXMuX2FmdGVyUmVuZGVyID0gdGhpcy5fYWZ0ZXJSZW5kZXIuYmluZCh0aGlzKTtcblx0XHR0aGlzLl9vblJlc2l6ZSA9IHRoaXMuX29uUmVzaXplLmJpbmQodGhpcyk7XG5cblx0XHQvKiByZW5kZXIgb24gcmVzaXplLCBvbm9yaWVudGF0aW9uY2hhbmdlLCB2aXNpYmlsaXR5Y2hhbmdlICovXG5cdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvcmllbnRhdGlvbmNoYW5nZVwiLCB0aGlzLl9vblJlc2l6ZSwgZmFsc2UpO1xuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIF8uZGVib3VuY2UodGhpcy5fb25SZXNpemUsIDMwLCBmYWxzZSksIGZhbHNlKTtcblxuXHRcdC8vIHZhciBoID0gZnVuY3Rpb24oZXYpIHsgY29uc29sZS5sb2coZXYudHlwZSwgZXYpIH07XG5cdFx0Ly8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgaCwgZmFsc2UpO1xuXHRcdC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwid2hlZWxcIiwgaCwgZmFsc2UpO1xuXG5cdFx0LyogVE9ETzogcmVwbGFjZSByZXNpemUgdy8gbWVkaWFxdWVyeSBsaXN0ZW5lcnMuIENhdmVhdDogc29tZSBjb21wb25lbnRzXG5cdFx0KHZnLiBDYXJvdXNlbCkgcmVxdWlyZSB1cGRhdGUgb24gcmVzaXplICovXG5cdFx0Ly8gdGhpcy5fb25CcmVha3BvaW50Q2hhbmdlID0gdGhpcy5fb25CcmVha3BvaW50Q2hhbmdlLmJpbmQodGhpcyk7XG5cdFx0Ly8gT2JqZWN0LmtleXMoR2xvYmFscy5CUkVBS1BPSU5UUykuZm9yRWFjaChmdW5jdGlvbihzKSB7XG5cdFx0Ly8gXHRHbG9iYWxzLkJSRUFLUE9JTlRTW3NdLmFkZExpc3RlbmVyKHRoaXMuX29uQnJlYWtwb2ludENoYW5nZSk7XG5cdFx0Ly8gfSwgdGhpcyk7XG5cblx0XHQvKiBpbml0aWFsaXplIGNvbnRyb2xsZXIvbW9kZWwgbGlzdGVuZXJzIEJFRk9SRSB2aWV3cyByZWdpc3RlciB0aGVpciBvd24gKi9cblx0XHR0aGlzLmxpc3RlblRvKGNvbnRyb2xsZXIsIFwicm91dGVcIiwgdGhpcy5fb25Sb3V0ZSk7XG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyhjb250cm9sbGVyLCBcImNoYW5nZTphZnRlclwiLCB0aGlzLl9hZnRlckNvbnRyb2xsZXJDaGFuZ2VkKTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlXCIsIHRoaXMuX29uTW9kZWxDaGFuZ2UpOyAvKiBGSVhNRSAqL1xuXG5cdFx0LyogaW5pdGlhbGl6ZSB2aWV3cyAqL1xuXHRcdHRoaXMubmF2aWdhdGlvblZpZXcgPSBuZXcgTmF2aWdhdGlvblZpZXcoe1xuXHRcdFx0ZWw6IHRoaXMubmF2aWdhdGlvbixcblx0XHRcdG1vZGVsOiB0aGlzLm1vZGVsLFxuXHRcdFx0dnBhbjogdnRvdWNoLFxuXHRcdFx0aHBhbjogaHRvdWNoXG5cdFx0fSk7XG5cblx0XHR0aGlzLmNvbnRlbnRWaWV3ID0gbmV3IENvbnRlbnRWaWV3KHtcblx0XHRcdGVsOiB0aGlzLmNvbnRlbnQsXG5cdFx0XHRtb2RlbDogdGhpcy5tb2RlbCxcblx0XHRcdHZwYW46IHZ0b3VjaCxcblx0XHRcdGhwYW46IGh0b3VjaCxcblx0XHR9KTtcblxuXHRcdC8qIEdvb2dsZSBBbmFseXRpY3MgKi9cblx0XHRpZiAod2luZG93LmdhICYmIHdpbmRvdy5HQV9JRCkge1xuXHRcdFx0Y29udHJvbGxlclxuXHRcdFx0XHQub25jZShcInJvdXRlXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHdpbmRvdy5nYShcImNyZWF0ZVwiLCB3aW5kb3cuR0FfSUQsIFwiYXV0b1wiKTtcblx0XHRcdFx0XHQvLyBpZiBsb2NhbGhvc3Qgb3IgZHVtbXkgSUQsIGRpc2FibGUgYW5hbHl0aWNzXG5cdFx0XHRcdFx0aWYgKC8oPzoobG9jYWxob3N0fFxcLmxvY2FsKSkkLy50ZXN0KGxvY2F0aW9uLmhvc3RuYW1lKVxuXHRcdFx0XHRcdFx0fHwgd2luZG93LkdBX0lEID09IFwiVUEtMDAwMDAwMC0wXCIpIHtcblx0XHRcdFx0XHRcdHdpbmRvdy5nYShcInNldFwiLCBcInNlbmRIaXRUYXNrXCIsIG51bGwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSlcblx0XHRcdFx0Lm9uKFwicm91dGVcIiwgZnVuY3Rpb24obmFtZSkge1xuXHRcdFx0XHRcdHZhciBwYWdlID0gQmFja2JvbmUuaGlzdG9yeS5nZXRGcmFnbWVudCgpO1xuXHRcdFx0XHRcdC8vIEFkZCBhIHNsYXNoIGlmIG5lY2Nlc2FyeVxuXHRcdFx0XHRcdHBhZ2UucmVwbGFjZSgvXig/IVxcLykvLCBcIi9cIik7XG5cdFx0XHRcdFx0d2luZG93LmdhKFwic2V0XCIsIFwicGFnZVwiLCBwYWdlKTtcblx0XHRcdFx0XHR3aW5kb3cuZ2EoXCJzZW5kXCIsIFwicGFnZXZpZXdcIik7XG5cdFx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8qIFN0YXJ0dXAgbGlzdGVuZXIsIGFkZGVkIGxhc3QgKi9cblx0XHR0aGlzLmxpc3RlblRvT25jZShjb250cm9sbGVyLCBcInJvdXRlXCIsIHRoaXMuX2FwcFN0YXJ0KTtcblxuXHRcdC8qIHN0YXJ0IHJvdXRlciwgd2hpY2ggd2lsbCByZXF1ZXN0IGFwcHJvcGlhdGUgc3RhdGUgKi9cblx0XHRCYWNrYm9uZS5oaXN0b3J5LnN0YXJ0KHtcblx0XHRcdHB1c2hTdGF0ZTogZmFsc2UsXG5cdFx0XHRoYXNoQ2hhbmdlOiB0cnVlLFxuXHRcdH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogX2FwcFN0YXJ0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfYXBwU3RhcnQ6IGZ1bmN0aW9uKG5hbWUsIGFyZ3MpIHtcblx0XHRjb25zb2xlLmluZm8oXCIlczo6X2FwcFN0YXJ0KCVzLCAlcylcIiwgdGhpcy5jaWQsIG5hbWUsIGFyZ3Muam9pbigpKTtcblx0XHQvLyB0aGlzLl9hcHBTdGFydENoYW5nZWQgPSB0cnVlO1xuXG5cdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcInNraXAtdHJhbnNpdGlvbnNcIik7XG5cblx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5NT0RFTF9JTlZBTElEIHwgVmlldy5TSVpFX0lOVkFMSUQpXG5cdFx0XHQubGlzdGVuVG9PbmNlKHRoaXMsIFwidmlldzpyZW5kZXI6YWZ0ZXJcIiwgZnVuY3Rpb24odmlldywgZmxhZ3MpIHtcblx0XHRcdFx0dGhpcy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Ly8gdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXCIlczo6X2FwcFN0YXJ0W3ZpZXc6cmVuZGVyOmFmdGVyXVtzZXRJbW1lZGlhdGVdXCIsIHRoaXMuY2lkKTtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpfYXBwU3RhcnRbdmlldzpyZW5kZXI6YWZ0ZXJdW3JhZl1cIiwgdGhpcy5jaWQpO1xuXHRcdFx0XHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gZmFsc2U7XG5cdFx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwic2tpcC10cmFuc2l0aW9uc1wiKTtcblx0XHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJhcHAtaW5pdGlhbFwiKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiByb3V0ZSBjaGFuZ2VkXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vblJvdXRlOiBmdW5jdGlvbihuYW1lLCBhcmdzKSB7XG5cdFx0dmFyIG8gPSBfLmRlZmF1bHRzKHsgcm91dGVOYW1lOiBuYW1lIH0sIEFwcFN0YXRlLnByb3RvdHlwZS5kZWZhdWx0cyk7XG5cdFx0c3dpdGNoIChuYW1lKSB7XG5cdFx0XHRjYXNlIFwibWVkaWEtaXRlbVwiOlxuXHRcdFx0XHRvLmJ1bmRsZSA9IGJ1bmRsZXMuc2VsZWN0ZWQ7XG5cdFx0XHRcdG8ud2l0aEJ1bmRsZSA9IHRydWU7XG5cdFx0XHRcdG8ubWVkaWEgPSBvLmJ1bmRsZS5tZWRpYS5zZWxlY3RlZDtcblx0XHRcdFx0by53aXRoTWVkaWEgPSB0cnVlO1xuXHRcdFx0XHRvLmNvbGxhcHNlZCA9IHRydWU7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcImJ1bmRsZS1pdGVtXCI6XG5cdFx0XHRcdG8uYnVuZGxlID0gYnVuZGxlcy5zZWxlY3RlZDtcblx0XHRcdFx0by53aXRoQnVuZGxlID0gdHJ1ZTtcblx0XHRcdFx0by5jb2xsYXBzZWQgPSB0cnVlO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJhcnRpY2xlLWl0ZW1cIjpcblx0XHRcdFx0by5hcnRpY2xlID0gYXJ0aWNsZXMuc2VsZWN0ZWQ7XG5cdFx0XHRcdG8ud2l0aEFydGljbGUgPSB0cnVlO1xuXHRcdFx0XHRvLmNvbGxhcHNlZCA9IHRydWU7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcImJ1bmRsZS1saXN0XCI6XG5cdFx0XHRjYXNlIFwibm90Zm91bmRcIjpcblx0XHRcdGNhc2UgXCJyb290XCI6XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRvLmNvbGxhcHNlZCA9IGZhbHNlO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdFx0Y29uc29sZS5pbmZvKFwiJXM6Ol9vblJvdXRlICVvIC0+ICVvXCIsIHRoaXMuY2lkLCB0aGlzLm1vZGVsLmdldChcInJvdXRlTmFtZVwiKSwgbmFtZSk7XG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6X29uUm91dGUgYXJnczogJW9cIiwgdGhpcy5jaWQsIG5hbWUsIGFyZ3MpO1xuXHRcdHRoaXMubW9kZWwuc2V0KG8pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIG1vZGVsIGNoYW5nZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uTW9kZWxDaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol9vbk1vZGVsQ2hhbmdlIFtTVEFSVF1cIiwgdGhpcy5jaWQpO1xuXHRcdGNvbnNvbGUuZ3JvdXAodGhpcy5jaWQgKyBcIjo6X29uTW9kZWxDaGFuZ2UgW3JlbmRlciByZXF1ZXN0XVwiKTtcblx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5NT0RFTF9JTlZBTElEKVxuXHRcdFx0Lm9uY2UoXCJ2aWV3OnJlbmRlcjphZnRlclwiLCBmdW5jdGlvbih2aWV3LCBmbGFncykge1xuXHRcdFx0XHRjb25zb2xlLmluZm8oXCIlczo6X29uTW9kZWxDaGFuZ2UgW3JlbmRlciBjb21wbGV0ZV1cIiwgdmlldy5jaWQpO1xuXHRcdFx0XHRjb25zb2xlLmdyb3VwRW5kKCk7XG5cdFx0XHRcdC8vIC53aGVuUmVuZGVyZWQoKS50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0Ly8gdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIFx0Y29uc29sZS5sb2coXCIlczo6X29uTW9kZWxDaGFuZ2UgW25leHQgZnJhbWVdXCIsIHZpZXcuY2lkKTtcblx0XHRcdFx0Ly8gfSk7XG5cdFx0XHR9KTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHJlc2l6ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uUmVzaXplOiBmdW5jdGlvbigpIHtcblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpfb25SZXNpemUgW1NUQVJUXVwiLCB0aGlzLmNpZCk7XG5cdFx0Y29uc29sZS5ncm91cCh0aGlzLmNpZCArIFwiOjpfb25SZXNpemUgW3JlbmRlciByZXF1ZXN0XVwiKTtcblx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwic2tpcC10cmFuc2l0aW9uc1wiKTtcblxuXHRcdC8vIHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCkucmVuZGVyTm93KCk7XG5cdFx0Ly8gdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG5cdFx0Ly8gXHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJza2lwLXRyYW5zaXRpb25zXCIpO1xuXHRcdC8vIH0uYmluZCh0aGlzKSk7XG5cblx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQpXG5cdFx0XHQvLyAud2hlblJlbmRlcmVkKCkudGhlbihmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHQub25jZShcInZpZXc6cmVuZGVyOmFmdGVyXCIsIGZ1bmN0aW9uKHZpZXcsIGZsYWdzKSB7XG5cdFx0XHRcdGNvbnNvbGUuaW5mbyhcIiVzOjpfb25SZXNpemUgW3JlbmRlciBjb21wbGV0ZV0gJW8gKyAlbyA9ICVvICsgJW9cIixcblx0XHRcdFx0XHR2aWV3LmNpZCwgdmlldy5lbC5jbGllbnRUb3AsIHZpZXcuZWwuY2xpZW50SGVpZ2h0LCB2aWV3LmVsLnNjcm9sbFRvcCwgdmlldy5lbC5zY3JvbGxIZWlnaHQpO1xuXG5cdFx0XHRcdC8vIGlmICgodmlldy5lbC5zY3JvbGxUb3AgPCAxKSAmJiAodmlldy5lbC5jbGllbnRIZWlnaHQgIT0gdmlldy5lbC5zY3JvbGxIZWlnaHQpKSB7XG5cdFx0XHRcdC8vIFx0dmlldy5lbC5zY3JvbGxUb3AgPSAxO1xuXHRcdFx0XHQvLyB9XG5cdFx0XHRcdC8vIGlmICgvaXBob25lL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuXHRcdFx0XHQvLyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA9IDE7XG5cdFx0XHRcdC8vIH1cblxuXHRcdFx0XHR0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcblx0XHRcdFx0XHR2aWV3LnNraXBUcmFuc2l0aW9ucyA9IGZhbHNlO1xuXHRcdFx0XHRcdHZpZXcuZWwuY2xhc3NMaXN0LnJlbW92ZShcInNraXAtdHJhbnNpdGlvbnNcIik7XG5cdFx0XHRcdFx0Ly8gd2luZG93LnNjcm9sbFRvKDAsIDEpO1xuXHRcdFx0XHRcdC8vIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gMTtcblx0XHRcdFx0XHRjb25zb2xlLmluZm8oXCIlczo6X29uUmVzaXplIFtyZW5kZXIgcmVtb3ZlZCBza2lwVHhdXCIsIHZpZXcuY2lkKTtcblx0XHRcdFx0XHRjb25zb2xlLmdyb3VwRW5kKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9KTtcblx0fSxcblxuXHQvLyBfaGFzT3ZlcmZsb3dZOiBmdW5jdGlvbihlbCkge1xuXHQvLyBcdHZhciByZXR2YWwgPSBmYWxzZTtcblx0Ly8gXHR2YXIgdHJhY2UgPSBbXTtcblx0Ly8gXHR2YXIgc2Nyb2xsRWwgPSBlbDtcblx0Ly8gXHRkbyB7XG5cdC8vIFx0XHRyZXR2YWwgPSByZXR2YWwgfHwgKHNjcm9sbEVsLnNjcm9sbEhlaWdodCAhPSBzY3JvbGxFbC5jbGllbnRIZWlnaHQpO1xuXHQvLyBcdFx0dHJhY2UucHVzaCh0cmFjZUVsZW1lbnQoc2Nyb2xsRWwpICsgXCIgXCIgKyBzY3JvbGxFbC5zY3JvbGxIZWlnaHQgKyBcIiA9PSBcIiArIHNjcm9sbEVsLmNsaWVudEhlaWdodCk7XG5cdC8vIFx0fSB3aGlsZSAoc2Nyb2xsRWwgPSBzY3JvbGxFbC5wYXJlbnRFbGVtZW50KTtcblx0Ly8gXHQvLyB0aGlzLm5hdmlnYXRpb24uc3R5bGUudG91Y2hBY3Rpb24gPSByZXR2YWwgPyBcInBhbi14XCIgOiBcImF1dG9cIjtcblx0Ly8gXHR2cGFuTG9nRm4oXCIlczo6X2hhc092ZXJmbG93WSglcykgLT4gJXMgJW9cIiwgdGhpcy5jaWQsIHRyYWNlRWxlbWVudChlbCksIHJldHZhbCwgdHJhY2UpO1xuXHQvLyBcdHJldHVybiByZXR2YWw7XG5cdC8vIH0sXG5cblx0Ly8gX29uQnJlYWtwb2ludENoYW5nZTogZnVuY3Rpb24oZXYpIHtcblx0Ly8gXHRjb25zb2xlLmxvZyhcIiVzOjpfb25CcmVha3BvaW50Q2hhbmdlXCIsIHRoaXMuY2lkLCBldi5tYXRjaGVzLCBldi5tZWRpYSwgZXYudGFyZ2V0LmNsYXNzTmFtZSk7XG5cdC8vIFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEKS5yZW5kZXJOb3coKTtcblx0Ly8gfSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cmVuZGVyRnJhbWU6IGZ1bmN0aW9uKHRzdGFtcCwgZmxhZ3MpIHtcblx0XHRjb25zb2xlLmxvZyhcIiVzOjpyZW5kZXJGcmFtZSBbJXNdXCIsIHRoaXMuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpKTtcblxuXHRcdC8qIG1vZGVsOiBzZXQgcm91dGUgJiBtb2RlbCBpZCBjbGFzc2VzICovXG5cdFx0aWYgKGZsYWdzICYgVmlldy5NT0RFTF9JTlZBTElEKSB7XG5cdFx0XHR0aGlzLnJlbmRlck1vZGVsQ2hhbmdlKGZsYWdzKTtcblx0XHR9XG5cblx0XHQvKiBzaXplOiBjaGVjayBicmVha3BvaW50cyBhbmQgc2V0IGNsYXNzZXMqL1xuXHRcdGlmIChmbGFncyAmIFZpZXcuU0laRV9JTlZBTElEKSB7XG5cdFx0XHRfLmVhY2goR2xvYmFscy5CUkVBS1BPSU5UUywgZnVuY3Rpb24obywgcykge1xuXHRcdFx0XHR0aGlzLnRvZ2dsZShzLCBvLm1hdGNoZXMpO1xuXHRcdFx0fSwgdGhpcy5icmVha3BvaW50RWwuY2xhc3NMaXN0KTtcblx0XHR9XG5cdFx0LyogcmVxdWVzdCBjaGlsZHJlbiByZW5kZXI6ICBhbHdheXMgcmVuZGVyIG5vdyAqL1xuXHRcdHRoaXMucmVxdWVzdENoaWxkcmVuUmVuZGVyKGZsYWdzLCB0cnVlKTtcblx0XHQvKiByZXF1ZXN0IGNoaWxkcmVuIHJlbmRlcjogIHNldCAnbm93JyBmbGFnIGlmIHNpemUgaXMgaW52YWxpZCAqL1xuXHRcdC8vIHRoaXMucmVxdWVzdENoaWxkcmVuUmVuZGVyKGZsYWdzLCBmbGFncyAmIFZpZXcuU0laRV9JTlZBTElEKTtcblxuXHRcdGlmIChmbGFncyAmIChWaWV3Lk1PREVMX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRCkpIHtcblx0XHRcdC8vIHRoaXMubmF2aWdhdGlvbi5zdHlsZS50b3VjaEFjdGlvbiA9ICF0aGlzLl9oYXNPdmVyZmxvd1kodGhpcy5jb250YWluZXIpID8gXCJwYW4teFwiIDogXCJcIjtcblx0XHRcdC8vIHRoaXMuY29udGVudC5zdHlsZS50b3VjaEFjdGlvbiA9IHRoaXMuX2hwYW5FbmFibGVGbigpID8gXCJwYW4teVwiIDogXCJcIjtcblx0XHRcdC8vIHRoaXMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gXHRpZiAodGhpcy5faHBhbkVuYWJsZUZuKCkgJiYgdGhpcy5fdnBhbkVuYWJsZUZuKCkpIHtcblx0XHRcdC8vIFx0XHR0aGlzLmNvbnRlbnQuc3R5bGUudG91Y2hBY3Rpb24gPSBcIm5vbmVcIjtcblx0XHRcdC8vIFx0fSBlbHNlIGlmICh0aGlzLl9ocGFuRW5hYmxlRm4oKSkge1xuXHRcdFx0Ly8gXHRcdHRoaXMuY29udGVudC5zdHlsZS50b3VjaEFjdGlvbiA9IFwicGFuLXlcIjtcblx0XHRcdC8vIFx0fSBlbHNlIGlmICh0aGlzLl92cGFuRW5hYmxlRm4oKSkge1xuXHRcdFx0Ly8gXHRcdHRoaXMuY29udGVudC5zdHlsZS50b3VjaEFjdGlvbiA9IFwicGFuLXhcIjtcblx0XHRcdC8vIFx0fSBlbHNlIHtcblx0XHRcdC8vIFx0XHR0aGlzLmNvbnRlbnQuc3R5bGUudG91Y2hBY3Rpb24gPSBcImF1dG9cIjtcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly8gXHQvLyBcdGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gMDtcblx0XHRcdC8vIFx0Ly8gXHR3aW5kb3cuc2Nyb2xsKHsgdG9wOiAwLCBiZWhhdmlvcjogXCJzbW9vdGhcIiB9KTtcblx0XHRcdC8vIH0pO1xuXG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogYm9keSBjbGFzc2VzIGV0Y1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cmVuZGVyTW9kZWxDaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXG5cdFx0dmFyIGNscyA9IHRoaXMuZWwuY2xhc3NMaXN0O1xuXHRcdHZhciBwcmV2QXR0ciA9IG51bGw7XG5cdFx0dmFyIGRvY1RpdGxlID0gW107XG5cdFx0dmFyIGhhc0RhcmtCZyA9IGZhbHNlO1xuXG5cdFx0ZG9jVGl0bGUucHVzaChHbG9iYWxzLkFQUF9OQU1FKTtcblx0XHRpZiAodGhpcy5tb2RlbC5nZXQoXCJidW5kbGVcIikpIHtcblx0XHRcdGRvY1RpdGxlLnB1c2goc3RyaXBUYWdzKHRoaXMubW9kZWwuZ2V0KFwiYnVuZGxlXCIpLmdldChcIm5hbWVcIikpKTtcblx0XHRcdGlmICh0aGlzLm1vZGVsLmdldChcIm1lZGlhXCIpKSB7XG5cdFx0XHRcdGRvY1RpdGxlLnB1c2goc3RyaXBUYWdzKHRoaXMubW9kZWwuZ2V0KFwibWVkaWFcIikuZ2V0KFwibmFtZVwiKSkpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAodGhpcy5tb2RlbC5nZXQoXCJhcnRpY2xlXCIpKSB7XG5cdFx0XHRkb2NUaXRsZS5wdXNoKHN0cmlwVGFncyh0aGlzLm1vZGVsLmdldChcImFydGljbGVcIikuZ2V0KFwibmFtZVwiKSkpO1xuXHRcdH1cblx0XHRkb2N1bWVudC50aXRsZSA9IF8udW5lc2NhcGUoZG9jVGl0bGUuam9pbihcIiAvIFwiKSk7XG5cblx0XHQvKiBTZXQgcm91dGUgY2xhc3MgKi9cblx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwicm91dGVOYW1lXCIpKSB7XG5cdFx0XHRwcmV2QXR0ciA9IHRoaXMubW9kZWwucHJldmlvdXMoXCJyb3V0ZU5hbWVcIik7XG5cdFx0XHRpZiAocHJldkF0dHIpIHtcblx0XHRcdFx0Y2xzLnJlbW92ZShcInJvdXRlLVwiICsgcHJldkF0dHIpO1xuXHRcdFx0fVxuXHRcdFx0Y2xzLmFkZChcInJvdXRlLVwiICsgdGhpcy5tb2RlbC5nZXQoXCJyb3V0ZU5hbWVcIikpO1xuXHRcdH1cblxuXHRcdC8qIFNldCBtb2RlbCBpZCBjbGFzc2VzIGZvciBjb2xvciBzdHlsZXMgKi9cblx0XHRbXCJhcnRpY2xlXCIsIFwiYnVuZGxlXCIsIFwibWVkaWFcIl0uZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG5cdFx0XHR2YXIgaXRlbSA9IHRoaXMubW9kZWwuZ2V0KHByb3ApO1xuXHRcdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChwcm9wKSkge1xuXHRcdFx0XHRwcmV2QXR0ciA9IHRoaXMubW9kZWwucHJldmlvdXMocHJvcCk7XG5cdFx0XHRcdGlmIChwcmV2QXR0cikge1xuXHRcdFx0XHRcdGNscy5yZW1vdmUocHJldkF0dHIuZ2V0KFwiZG9taWRcIikpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChpdGVtKSB7XG5cdFx0XHRcdFx0Y2xzLmFkZChpdGVtLmdldChcImRvbWlkXCIpKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Y2xzLnRvZ2dsZShcIndpdGgtXCIgKyBwcm9wLCAhIWl0ZW0pO1xuXHRcdFx0Y2xzLnRvZ2dsZShcIndpdGhvdXQtXCIgKyBwcm9wLCAhaXRlbSk7XG5cdFx0XHRoYXNEYXJrQmcgfD0gKGl0ZW0gJiYgaXRlbS5jb2xvcnMgJiYgaXRlbS5jb2xvcnMuaGFzRGFya0JnKTtcblx0XHR9LmJpbmQodGhpcykpO1xuXG5cdFx0LyogZmxhZyBkYXJrIGJhY2tncm91bmQgKi9cblx0XHRjbHMudG9nZ2xlKFwiY29sb3ItZGFya1wiLCBoYXNEYXJrQmcpO1xuXHR9LFxufTtcblxuaWYgKERFQlVHKSB7XG5cdC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9kZWJ1Zy9EZWJ1Z1Rvb2xiYXJ9ICovXG5cdHZhciBEZWJ1Z1Rvb2xiYXIgPSByZXF1aXJlKFwiYXBwL2RlYnVnL0RlYnVnVG9vbGJhclwiKTtcblxuXHRBcHBWaWV3UHJvdG8uX29uTW9kZWxDaGFuZ2UgPSAoZnVuY3Rpb24oZm4pIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcmV0dmFsO1xuXHRcdFx0Y29uc29sZS5ncm91cCh0aGlzLmNpZCArIFwiOjpfb25Nb2RlbENoYW5nZVwiKTtcblx0XHRcdE9iamVjdC5rZXlzKHRoaXMubW9kZWwuY2hhbmdlZEF0dHJpYnV0ZXMoKSkuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcblx0XHRcdFx0dmFyIHByZXYgPSB0aGlzLm1vZGVsLnByZXZpb3VzKGtleSksXG5cdFx0XHRcdFx0Y3VyciA9IHRoaXMubW9kZWwuZ2V0KGtleSk7XG5cdFx0XHRcdGNvbnNvbGUuaW5mbyhcIiVzOjpfb25Nb2RlbENoYW5nZSAlczogJXMgLT4gJXNcIiwgdGhpcy5jaWQsIGtleSxcblx0XHRcdFx0XHRwcmV2ICYmIHByZXYudG9TdHJpbmcoKSxcblx0XHRcdFx0XHRjdXJyICYmIGN1cnIudG9TdHJpbmcoKSk7XG5cdFx0XHR9LCB0aGlzKTtcblx0XHRcdGNvbnNvbGUuZ3JvdXBFbmQoKTtcblxuXHRcdFx0cmV0dmFsID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdHJldHVybiByZXR2YWw7XG5cdFx0fTtcblx0fSkoQXBwVmlld1Byb3RvLl9vbk1vZGVsQ2hhbmdlKTtcblxuXHRBcHBWaWV3UHJvdG8uaW5pdGlhbGl6ZSA9IChmdW5jdGlvbihmbikge1xuXHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdC8vIHZhciByZXQgPSBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0dmFyIHZpZXcgPSBuZXcgRGVidWdUb29sYmFyKHtcblx0XHRcdFx0aWQ6IFwiZGVidWctdG9vbGJhclwiLFxuXHRcdFx0XHRtb2RlbDogdGhpcy5tb2RlbFxuXHRcdFx0fSk7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHZpZXcucmVuZGVyKCkuZWwpO1xuXHRcdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZTpsYXlvdXROYW1lXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gXHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQpOyAvLy5yZW5kZXJOb3coKTtcblx0XHRcdC8vIH0pO1xuXHRcdFx0Ly8gcmV0dXJuIHJldDtcblx0XHRcdHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH07XG5cdH0pKEFwcFZpZXdQcm90by5pbml0aWFsaXplKTtcbn1cblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvQXBwVmlld31cbi8qL1xubW9kdWxlLmV4cG9ydHMgPSBWaWV3LmV4dGVuZChBcHBWaWV3UHJvdG8sIEFwcFZpZXcpOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9OYXZpZ2F0aW9uVmlld1xuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL1RyYW5zZm9ybUhlbHBlcn0gKi9cbnZhciBUcmFuc2Zvcm1IZWxwZXIgPSByZXF1aXJlKFwidXRpbHMvVHJhbnNmb3JtSGVscGVyXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXJ9ICovXG4vLyB2YXIgVG91Y2hNYW5hZ2VyID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVG91Y2hNYW5hZ2VyXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9Db250cm9sbGVyfSAqL1xudmFyIGNvbnRyb2xsZXIgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvQ29udHJvbGxlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb259ICovXG52YXIgYnVuZGxlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb259ICovXG52YXIgYXJ0aWNsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb25cIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUl0ZW19ICovXG4vLyB2YXIgQnVuZGxlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9CdW5kbGVJdGVtXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZVZpZXd9ICovXG52YXIgQXJ0aWNsZVZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVWaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0NvbGxlY3Rpb25TdGFja30gKi9cbnZhciBDb2xsZWN0aW9uU3RhY2sgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0NvbGxlY3Rpb25TdGFja1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uU3RhY2t9ICovXG52YXIgU2VsZWN0YWJsZUxpc3RWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9TZWxlY3RhYmxlTGlzdFZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvRG90TmF2aWdhdGlvblJlbmRlcmVyfSAqL1xudmFyIERvdE5hdmlnYXRpb25SZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvRG90TmF2aWdhdGlvblJlbmRlcmVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0Nhcm91c2VsfSAqL1xudmFyIENhcm91c2VsID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9DYXJvdXNlbFwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0Nhcm91c2VsUmVuZGVyZXJ9ICovXG52YXIgQ2Fyb3VzZWxSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvQ2Fyb3VzZWxSZW5kZXJlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9JbWFnZVJlbmRlcmVyfSAqL1xudmFyIEltYWdlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0ltYWdlUmVuZGVyZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvVmlkZW9SZW5kZXJlcn0gKi9cbnZhciBWaWRlb1JlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9WaWRlb1JlbmRlcmVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1NlcXVlbmNlUmVuZGVyZXJ9ICovXG52YXIgU2VxdWVuY2VSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyfSAqL1xuLy8gdmFyIFByb2dyZXNzTWV0ZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJcIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgY2Fyb3VzZWxFbXB0eVRlbXBsYXRlID0gcmVxdWlyZShcIi4vdGVtcGxhdGUvQ2Fyb3VzZWwuRW1wdHlSZW5kZXJlci5CdW5kbGUuaGJzXCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBtZWRpYVN0YWNrVGVtcGxhdGUgPSByZXF1aXJlKFwiLi90ZW1wbGF0ZS9Db2xsZWN0aW9uU3RhY2suTWVkaWEuaGJzXCIpO1xuXG4vLyB2YXIgdHJhbnNpdGlvbkVuZCA9IFZpZXcucHJlZml4ZWRFdmVudChcInRyYW5zaXRpb25lbmRcIik7XG52YXIgdHJhbnNmb3JtUHJvcCA9IFZpZXcucHJlZml4ZWRQcm9wZXJ0eShcInRyYW5zZm9ybVwiKTtcbnZhciB0cmFuc2l0aW9uUHJvcCA9IFZpZXcucHJlZml4ZWRQcm9wZXJ0eShcInRyYW5zaXRpb25cIik7XG5cbnZhciB0eCA9IEdsb2JhbHMudHJhbnNpdGlvbnM7XG5cblxuLy8gdmFyIGNsaWNrRXZlbnQgPSB3aW5kb3cuaGFzT3duUHJvcGVydHkoXCJvbnBvaW50ZXJ1cFwiKSA/IFwicG9pbnRlcnVwXCIgOiBcIm1vdXNldXBcIixcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvQ29udGVudFZpZXd9XG4gKi9cbnZhciBDb250ZW50VmlldyA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNpZFByZWZpeDogXCJjb250ZW50Vmlld1wiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImNvbnRhaW5lci1leHBhbmRlZFwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0ZXZlbnRzOiB7XG5cdFx0XCJ0cmFuc2l0aW9uZW5kIC5hZGRpbmctY2hpbGRcIjogXCJfb25BZGRlZFRyYW5zaXRpb25FbmRcIixcblx0XHRcInRyYW5zaXRpb25lbmQgLnJlbW92aW5nLWNoaWxkXCI6IFwiX29uUmVtb3ZlZFRyYW5zaXRpb25FbmRcIixcblx0XHQvLyBcInRyYW5zaXRpb25lbmRcIjogXCJfb25UcmFuc2l0aW9uRW5kXCIsXG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0Xy5iaW5kQWxsKHRoaXMsIFwiX29uVlBhblN0YXJ0XCIsIFwiX29uVlBhbk1vdmVcIiwgXCJfb25WUGFuRmluYWxcIiwgXCJfb25Db2xsYXBzZWRFdmVudFwiKTtcblxuXHRcdHRoaXMudHJhbnNmb3JtcyA9IG5ldyBUcmFuc2Zvcm1IZWxwZXIoKTtcblx0XHQvLyB0aGlzLnRvdWNoID0gb3B0aW9ucy50b3VjaCB8fCBuZXcgRXJyb3IoXCJubyB0b3VjaFwiKTsgLy9Ub3VjaE1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcblx0XHR0aGlzLnZwYW4gPSBvcHRpb25zLnZwYW4gfHwgbmV3IEVycm9yKFwibm8gdnBhblwiKTtcblx0XHR0aGlzLmhwYW4gPSBvcHRpb25zLmhwYW4gfHwgbmV3IEVycm9yKFwibm8gaHBhblwiKTtcblxuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJjaGFuZ2VcIiwgdGhpcy5fb25Nb2RlbENoYW5nZSk7XG5cblx0XHQvLyBkaXNjb25uZWN0IGNoaWxkcmVuIGJlZm9yZSBsYXN0IGNoYW5nZVxuXHRcdC8vIHRoaXMubGlzdGVuVG8oYnVuZGxlcywgXCJkZXNlbGVjdDpvbmVcIiwgdGhpcy5fb25EZXNlbGVjdE9uZUJ1bmRsZSk7XG5cblx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdFx0dGhpcy5pdGVtVmlld3MgPSBbXTtcblxuXHRcdC8vIHRoaXMucHJvZ3Jlc3NXcmFwcGVyID0gdGhpcy5jcmVhdGVQcm9ncmVzc1dyYXBwZXIoKSxcblx0XHQvLyB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMucHJvZ3Jlc3NXcmFwcGVyLmVsKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBSZW5kZXJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cmVuZGVyRnJhbWU6IGZ1bmN0aW9uKHRzdGFtcCwgZmxhZ3MpIHtcblx0XHQvLyB2YWx1ZXNcblx0XHR2YXIgY29sbGFwc2VkID0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdFx0dmFyIGNvbGxhcHNlZENoYW5nZWQgPSAoZmxhZ3MgJiBWaWV3Lk1PREVMX0lOVkFMSUQpXG5cdFx0XHQmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJjb2xsYXBzZWRcIik7XG5cdFx0dmFyIGNoaWxkcmVuQ2hhbmdlZCA9IChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRClcblx0XHRcdCYmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJidW5kbGVcIikgfHwgdGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiYXJ0aWNsZVwiKSk7XG5cblx0XHQvLyBmbGFnc1xuXHRcdHZhciBzaXplQ2hhbmdlZCA9ICEhKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpO1xuXHRcdHZhciB0cmFuc2Zvcm1zQ2hhbmdlZCA9ICEhKGZsYWdzICYgKFZpZXcuTU9ERUxfSU5WQUxJRCB8IFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCkpO1xuXHRcdHRyYW5zZm9ybXNDaGFuZ2VkID0gdHJhbnNmb3Jtc0NoYW5nZWQgfHwgdGhpcy5fdHJhbnNmb3Jtc0NoYW5nZWQgfHwgdGhpcy5za2lwVHJhbnNpdGlvbnM7XG5cblx0XHQvLyBkZWJ1Z1xuXHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdC8vIGlmIChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkge1xuXHRcdC8vIFx0Y29uc29sZS5ncm91cCh0aGlzLmNpZCArIFwiOjpyZW5kZXJGcmFtZSBtb2RlbCBjaGFuZ2VkOlwiKTtcblx0XHQvLyBcdE9iamVjdC5rZXlzKHRoaXMubW9kZWwuY2hhbmdlZCkuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJcXHQlczogJXMgLT4gJXNcIiwga2V5LCB0aGlzLm1vZGVsLl9wcmV2aW91c0F0dHJpYnV0ZXNba2V5XSwgdGhpcy5tb2RlbC5jaGFuZ2VkW2tleV0pO1xuXHRcdC8vIFx0fSwgdGhpcyk7XG5cdFx0Ly8gXHRjb25zb2xlLmdyb3VwRW5kKCk7XG5cdFx0Ly8gfVxuXG5cdFx0Ly8gbW9kZWw6Y2hpbGRyZW5cblx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHRpZiAoY2hpbGRyZW5DaGFuZ2VkKSB7XG5cdFx0XHR0aGlzLnJlbW92ZUNoaWxkcmVuKCk7XG5cdFx0XHRpZiAoYnVuZGxlcy5zZWxlY3RlZCkge1xuXHRcdFx0XHR0aGlzLmNyZWF0ZUNoaWxkcmVuKGJ1bmRsZXMuc2VsZWN0ZWQpO1xuXHRcdFx0fSBlbHNlXG5cdFx0XHRpZiAoYXJ0aWNsZXMuc2VsZWN0ZWQpIHtcblx0XHRcdFx0dGhpcy5jcmVhdGVDaGlsZHJlbihhcnRpY2xlcy5zZWxlY3RlZCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gbW9kZWw6Y29sbGFwc2VkXG5cdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0aWYgKGNvbGxhcHNlZENoYW5nZWQpIHtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImNvbnRhaW5lci1jb2xsYXBzZWRcIiwgY29sbGFwc2VkKTtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImNvbnRhaW5lci1leHBhbmRlZFwiLCAhY29sbGFwc2VkKTtcblx0XHR9XG5cblx0XHQvLyBzaXplXG5cdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0aWYgKHNpemVDaGFuZ2VkKSB7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMuY2xlYXJBbGxDYXB0dXJlcygpO1xuXHRcdH1cblxuXHRcdC8vIHRyYW5zZm9ybXNcblx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHRpZiAodHJhbnNmb3Jtc0NoYW5nZWQpIHtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbnRhaW5lci1jaGFuZ2luZ1wiKTtcblx0XHRcdGlmICh0aGlzLnNraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMuc3RvcEFsbFRyYW5zaXRpb25zKCk7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbnRhaW5lci1jaGFuZ2VkXCIpO1xuXHRcdFx0XHRpZiAoIWNoaWxkcmVuQ2hhbmdlZCkge1xuXHRcdFx0XHRcdC8vIHRoaXMudHJhbnNmb3Jtcy5jbGVhckFsbE9mZnNldHMoKTtcblx0XHRcdFx0XHRpZiAoY29sbGFwc2VkQ2hhbmdlZCkge1xuXHRcdFx0XHRcdFx0dGhpcy5fc2V0Q2hpbGRyZW5FbmFibGVkKGNvbGxhcHNlZCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoIWNoaWxkcmVuQ2hhbmdlZCkge1xuXHRcdFx0XHRcdGlmIChjb2xsYXBzZWRDaGFuZ2VkKSB7XG5cdFx0XHRcdFx0XHR2YXIgYWZ0ZXJUcmFuc2l0aW9uc0ZuO1xuXHRcdFx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwiY29udGFpbmVyLWNoYW5nZWRcIik7XG5cdFx0XHRcdFx0XHQvLyB0aGlzLnRyYW5zZm9ybXMuY2xlYXJBbGxPZmZzZXRzKCk7XG5cdFx0XHRcdFx0XHRpZiAoY29sbGFwc2VkKSB7XG5cdFx0XHRcdFx0XHRcdC8vIGNvbnRhaW5lci1jb2xsYXBzZWQsIGVuYWJsZSBsYXN0XG5cdFx0XHRcdFx0XHRcdGFmdGVyVHJhbnNpdGlvbnNGbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMuX3NldENoaWxkcmVuRW5hYmxlZCh0cnVlKTtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb250YWluZXItY2hhbmdlZFwiKTtcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnJ1bkFsbFRyYW5zaXRpb25zKHR4LkxBU1QpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gY29udGFpbmVyLWV4cGFuZGVkLCBkaXNhYmxlIGZpcnN0XG5cdFx0XHRcdFx0XHRcdGFmdGVyVHJhbnNpdGlvbnNGbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbnRhaW5lci1jaGFuZ2VkXCIpO1xuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHR0aGlzLl9zZXRDaGlsZHJlbkVuYWJsZWQoZmFsc2UpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMucnVuQWxsVHJhbnNpdGlvbnModHguRklSU1QpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YWZ0ZXJUcmFuc2l0aW9uc0ZuID0gYWZ0ZXJUcmFuc2l0aW9uc0ZuLmJpbmQodGhpcyk7XG5cdFx0XHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMud2hlbkFsbFRyYW5zaXRpb25zRW5kKCkudGhlbihhZnRlclRyYW5zaXRpb25zRm4sIGFmdGVyVHJhbnNpdGlvbnNGbik7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKG8pIHtcblx0XHRcdFx0XHRcdFx0aWYgKG8uaGFzT2Zmc2V0KSB7XG5cdFx0XHRcdFx0XHRcdFx0by5ydW5UcmFuc2l0aW9uKHR4Lk5PVyk7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gby5jbGVhck9mZnNldCgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmICghY2hpbGRyZW5DaGFuZ2VkKSB7XG5cdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5jbGVhckFsbE9mZnNldHMoKTtcblx0XHRcdH1cblx0XHRcdHRoaXMudHJhbnNmb3Jtcy52YWxpZGF0ZSgpO1xuXHRcdH1cblx0XHRpZiAoc2l6ZUNoYW5nZWQpIHtcblx0XHRcdHRoaXMuaXRlbVZpZXdzLmZvckVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHR2aWV3LnNraXBUcmFuc2l0aW9ucyA9IHRoaXMuc2tpcFRyYW5zaXRpb25zO1xuXHRcdFx0XHR2aWV3LnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQpLnJlbmRlck5vdygpO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0XHQvKlByb21pc2UuYWxsKHRoaXMuaXRlbVZpZXdzLm1hcChmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdFx0dmlldy5za2lwVHJhbnNpdGlvbnMgPSB0aGlzLnNraXBUcmFuc2l0aW9ucztcblx0XHRcdFx0XHRyZXR1cm4gdmlldy5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEKS53aGVuUmVuZGVyZWQoKTtcblx0XHRcdFx0fSwgdGhpcykpXG5cdFx0XHRcdC50aGVuKFxuXHRcdFx0XHRcdGZ1bmN0aW9uKHZpZXdzKSB7XG5cdFx0XHRcdFx0XHR2YXIgbmggPSB0aGlzLmVsLm9mZnNldFBhcmVudC5vZmZzZXRIZWlnaHQgLSB0aGlzLmVsLm9mZnNldFRvcDtcblx0XHRcdFx0XHRcdC8vIHZhciBvaCA9IHZpZXdzLnJlZHVjZShmdW5jdGlvbihoLCB2aWV3KSB7XG5cdFx0XHRcdFx0XHQvLyBcdHJldHVybiBNYXRoLm1heChoLCB2aWV3LmVsLm9mZnNldEhlaWdodCk7XG5cdFx0XHRcdFx0XHQvLyB9LCBuaCk7XG5cdFx0XHRcdFx0XHQvLyBvaCsrO1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczpbd2hlblJlbmRlcmVkXSBbcmVzdWx0OiAlcyAlc10gJW9cIiwgdGhpcy5jaWQsXG5cdFx0XHRcdFx0XHQvLyBcdG5oLCBvaCwgdGhpcy5lbC5wYXJlbnQsIHZpZXdzKTtcblx0XHRcdFx0XHRcdHRoaXMuZWwuc3R5bGUubWluSGVpZ2h0ID0gbmggKyBcInB4XCI7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdmlld3M7XG5cdFx0XHRcdFx0fS5iaW5kKHRoaXMpLFxuXHRcdFx0XHRcdGZ1bmN0aW9uKHJlYXNvbikge1xuXHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiJXM6W3doZW5SZW5kZXJlZF0gW3JlamVjdGVkXSAlb1wiLCB0aGlzLmNpZCwgcmVhc29uKTtcblx0XHRcdFx0XHRcdHJldHVybiByZWFzb247XG5cdFx0XHRcdFx0fS5iaW5kKHRoaXMpXG5cdFx0XHRcdCk7Ki9cblx0XHR9XG5cdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0aGlzLl90cmFuc2Zvcm1zQ2hhbmdlZCA9IGZhbHNlO1xuXHR9LFxuXG5cdF9zZXRDaGlsZHJlbkVuYWJsZWQ6IGZ1bmN0aW9uKGVuYWJsZWQpIHtcblx0XHQvLyBpZiAoZW5hYmxlZCkge1xuXHRcdC8vIFx0dGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fb25Db2xsYXBzZWRDbGljaywgZmFsc2UpO1xuXHRcdC8vIH0gZWxzZSB7XG5cdFx0Ly8gXHR0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9vbkNvbGxhcHNlZENsaWNrLCBmYWxzZSk7XG5cdFx0Ly8gfVxuXHRcdHRoaXMuaXRlbVZpZXdzLmZvckVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0dmlldy5zZXRFbmFibGVkKGVuYWJsZWQpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogQ29sbGFwc2UgVUkgZ2VzdHVyZXMvZXZlbnRzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25Db2xsYXBzZWRFdmVudDogZnVuY3Rpb24oZXYpIHtcblx0XHRjb25zb2xlLmxvZyhcIiVzOlslcyAtPiBfb25Db2xsYXBzZWRFdmVudF0gdGFyZ2V0OiAlc1wiLCB0aGlzLmNpZCwgZXYudHlwZSwgZXYudGFyZ2V0KTtcblx0XHRpZiAoIWV2LmRlZmF1bHRQcmV2ZW50ZWQgJiZcblx0XHRcdHRoaXMubW9kZWwuZ2V0KFwid2l0aEJ1bmRsZVwiKSAmJlxuXHRcdFx0IXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpICYmXG5cdFx0XHQhdGhpcy5lbmFibGVkKSB7XG5cdFx0XHQvLyB0aGlzLnNldEltbWVkaWF0ZShmdW5jdGlvbigpIHtcblx0XHRcdC8vIGlmIChldi50eXBlID09IFwiY2xpY2tcIikgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRldi5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dGhpcy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIGlmIChldi50eXBlID09IFwiY2xpY2tcIikgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdHRoaXMubW9kZWwuc2V0KFwiY29sbGFwc2VkXCIsIHRydWUpO1xuXHRcdFx0fSk7XG5cdFx0XHQvLyB9KTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogbW9kZWwgY2hhbmdlZFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25Nb2RlbENoYW5nZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdGlmICh0aGlzLm1vZGVsLmdldChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdFx0dGhpcy52cGFuLm9uKFwidnBhbnN0YXJ0XCIsIHRoaXMuX29uVlBhblN0YXJ0KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMudnBhbi5vZmYoXCJ2cGFuc3RhcnRcIiwgdGhpcy5fb25WUGFuU3RhcnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHQvKlxuXHRcdGlmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoQnVuZGxlXCIpIHx8XG5cdFx0XHR0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHRcdGlmICh0aGlzLm1vZGVsLmdldChcIndpdGhCdW5kbGVcIikgJiZcblx0XHRcdFx0IXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHRcdHRoaXMuaHBhbi5vbihcImhwYW5sZWZ0IGhwYW5yaWdodFwiLCB0aGlzLl9vbkNvbGxhcHNlZEV2ZW50KTtcblx0XHRcdFx0dGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKEdsb2JhbHMuQ0xJQ0tfRVZFTlQsIHRoaXMuX29uQ29sbGFwc2VkRXZlbnQsIGZhbHNlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuaHBhbi5vZmYoXCJocGFubGVmdCBocGFucmlnaHRcIiwgdGhpcy5fb25Db2xsYXBzZWRFdmVudCk7XG5cdFx0XHRcdHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihHbG9iYWxzLkNMSUNLX0VWRU5ULCB0aGlzLl9vbkNvbGxhcHNlZEV2ZW50LCBmYWxzZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdCovXG5cdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuTU9ERUxfSU5WQUxJRCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBWZXJ0aWNhbCB0b3VjaC9tb3ZlIChfb25WUGFuKilcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9jb2xsYXBzZWRPZmZzZXRZOiBHbG9iYWxzLkNPTExBUFNFX09GRlNFVCxcblxuXHRfb25WUGFuU3RhcnQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy52cGFuLm9uKFwidnBhbm1vdmVcIiwgdGhpcy5fb25WUGFuTW92ZSk7XG5cdFx0dGhpcy52cGFuLm9uKFwidnBhbmVuZCB2cGFuY2FuY2VsXCIsIHRoaXMuX29uVlBhbkZpbmFsKTtcblxuXHRcdHRoaXMudHJhbnNmb3Jtcy5zdG9wQWxsVHJhbnNpdGlvbnMoKTtcblx0XHQvLyB0aGlzLnRyYW5zZm9ybXMuY2xlYXJBbGxPZmZzZXRzKCk7XG5cdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLmNsZWFyQWxsQ2FwdHVyZXMoKTtcblxuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcImNvbnRhaW5lci1jaGFuZ2luZ1wiKTtcblx0XHR0aGlzLl9vblZQYW5Nb3ZlKGV2KTtcblx0fSxcblxuXHRfb25WUGFuTW92ZTogZnVuY3Rpb24oZXYpIHtcblx0XHR2YXIgY29sbGFwc2VkID0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdFx0dmFyIGRlbHRhID0gZXYuZGVsdGFZOyAvL2V2LnRocmVzaG9sZERlbHRhWTtcblx0XHR2YXIgbWF4RGVsdGEgPSB0aGlzLl9jb2xsYXBzZWRPZmZzZXRZOyAvLyArIE1hdGguYWJzKGV2LnRocmVzaG9sZE9mZnNldFkpO1xuXG5cdFx0Ly8gY2hlY2sgaWYgZGlyZWN0aW9uIGlzIGFsaWduZWQgd2l0aCBjb2xsYXBzZWQvZXhwYW5kXG5cdFx0dmFyIGlzVmFsaWREaXIgPSBjb2xsYXBzZWQgPyAoZGVsdGEgPiAwKSA6IChkZWx0YSA8IDApO1xuXHRcdHZhciBtb3ZlRmFjdG9yID0gY29sbGFwc2VkID8gR2xvYmFscy5WUEFOX0RSQUcgOiAxIC0gR2xvYmFscy5WUEFOX0RSQUc7XG5cblx0XHRkZWx0YSA9IE1hdGguYWJzKGRlbHRhKTsgLy8gcmVtb3ZlIHNpZ25cblx0XHRkZWx0YSAqPSBtb3ZlRmFjdG9yO1xuXHRcdG1heERlbHRhICo9IG1vdmVGYWN0b3I7XG5cblx0XHRpZiAoaXNWYWxpZERpcikge1xuXHRcdFx0aWYgKGRlbHRhID4gbWF4RGVsdGEpIHsgLy8gb3ZlcnNob290aW5nXG5cdFx0XHRcdGRlbHRhID0gKChkZWx0YSAtIG1heERlbHRhKSAqIEdsb2JhbHMuVlBBTl9PVVRfRFJBRykgKyBtYXhEZWx0YTtcblx0XHRcdH0gZWxzZSB7IC8vIG5vIG92ZXJzaG9vdGluZ1xuXHRcdFx0XHQvLyBkZWx0YSA9IGRlbHRhO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRkZWx0YSA9ICgtZGVsdGEpICogR2xvYmFscy5WUEFOX09VVF9EUkFHOyAvLyBkZWx0YSBpcyBvcHBvc2l0ZVxuXHRcdH1cblx0XHRkZWx0YSAqPSBjb2xsYXBzZWQgPyAxIDogLTE7IC8vIHJlYXBwbHkgc2lnblxuXG5cdFx0dGhpcy50cmFuc2Zvcm1zLm9mZnNldEFsbCgwLCBkZWx0YSk7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdH0sXG5cblx0X29uVlBhbkZpbmFsOiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMudnBhbi5vZmYoXCJ2cGFubW92ZVwiLCB0aGlzLl9vblZQYW5Nb3ZlKTtcblx0XHR0aGlzLnZwYW4ub2ZmKFwidnBhbmVuZCB2cGFuY2FuY2VsXCIsIHRoaXMuX29uVlBhbkZpbmFsKTtcblxuXHRcdC8vIEZJWE1FOiBtb2RlbC5jb2xsYXBzZWQgbWF5IGhhdmUgYWxyZWFkeSBjaGFuZ2VkLCBfb25WUGFuTW92ZSB3b3VsZCBydW4gd2l0aCB3cm9uZyB2YWx1ZXM6XG5cdFx0Ly8gbW9kZWwuY29sbGFwc2VkIGlzIGNoYW5nZWQgaW4gYSBzZXRJbW1lZGlhdGUgY2FsbGJhY2sgZnJvbSBOYXZpZ2F0aW9uVmlldy5cblxuXHRcdHRoaXMuX29uVlBhbk1vdmUoZXYpO1xuXHRcdHRoaXMuc2V0SW1tZWRpYXRlKGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5fdHJhbnNmb3Jtc0NoYW5nZWQgPSB0cnVlO1xuXHRcdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKCk7XG5cdFx0fSk7XG5cdH0sXG5cblx0Ly8gd2lsbENvbGxhcHNlZENoYW5nZTogZnVuY3Rpb24oZXYpIHtcblx0Ly8gXHR2YXIgY29sbGFwc2VkID0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdC8vIFx0cmV0dXJuIGV2LnR5cGUgPT0gXCJ2cGFuZW5kXCI/IGNvbGxhcHNlZD9cblx0Ly8gXHRcdGV2LnRocmVzaG9sZERlbHRhWSA+IEdsb2JhbHMuQ09MTEFQU0VfVEhSRVNIT0xEIDpcblx0Ly8gXHRcdGV2LnRocmVzaG9sZERlbHRhWSA8IC1HbG9iYWxzLkNPTExBUFNFX1RIUkVTSE9MRCA6XG5cdC8vIFx0XHRmYWxzZTtcblx0Ly8gfSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIGNyZWF0ZS9yZW1vdmUgY2hpbGRyZW4gb24gYnVuZGxlIHNlbGVjdGlvblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIENyZWF0ZSBjaGlsZHJlbiBvbiBidW5kbGUgc2VsZWN0ICovXG5cdGNyZWF0ZUNoaWxkcmVuOiBmdW5jdGlvbihtb2RlbCkge1xuXHRcdHZhciB2aWV3O1xuXHRcdGlmIChtb2RlbC5fX3Byb3RvX18uY29uc3RydWN0b3IgPT09IGJ1bmRsZXMubW9kZWwpIHtcblx0XHRcdC8vIHdpbGwgYmUgYXR0YWNoZWQgdG8gZG9tIGluIHRoaXMgb3JkZXJcblx0XHRcdHZpZXcgPSB0aGlzLmNyZWF0ZU1lZGlhQ2FwdGlvblN0YWNrKG1vZGVsKTtcblx0XHRcdHRoaXMuaXRlbVZpZXdzLnB1c2godmlldyk7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMuYWRkKHZpZXcuZWwpO1xuXHRcdFx0dmlldyA9IHRoaXMuY3JlYXRlTWVkaWFDYXJvdXNlbChtb2RlbCk7XG5cdFx0XHR0aGlzLml0ZW1WaWV3cy5wdXNoKHZpZXcpO1xuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLmFkZCh2aWV3LmVsKTtcblx0XHRcdHZpZXcgPSB0aGlzLmNyZWF0ZU1lZGlhRG90TmF2aWdhdGlvbihtb2RlbCk7XG5cdFx0XHR0aGlzLml0ZW1WaWV3cy5wdXNoKHZpZXcpO1xuXHRcdH0gZWxzZVxuXHRcdGlmIChtb2RlbC5fX3Byb3RvX18uY29uc3RydWN0b3IgPT09IGFydGljbGVzLm1vZGVsKSB7XG5cdFx0XHR2aWV3ID0gdGhpcy5jcmVhdGVBcnRpY2xlVmlldyhtb2RlbCk7XG5cdFx0XHR0aGlzLml0ZW1WaWV3cy5wdXNoKHZpZXcpO1xuXHRcdH1cblxuXHRcdHRoaXMuaXRlbVZpZXdzLmZvckVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0aWYgKCF0aGlzLnNraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0XHR2aWV3LmVsLmNsYXNzTGlzdC5hZGQoXCJhZGRpbmctY2hpbGRcIik7XG5cdFx0XHRcdHZpZXcuZWwuc3R5bGUub3BhY2l0eSA9IDA7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmVsLmFwcGVuZENoaWxkKHZpZXcuZWwpO1xuXHRcdFx0dmlldy5yZW5kZXIoKTtcblx0XHR9LCB0aGlzKTtcblxuXHRcdGlmICghdGhpcy5za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdHRoaXMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpjcmVhdGVDaGlsZHJlbjo6W2NhbGxiYWNrOnJlcXVlc3RBbmltYXRpb25GcmFtZV1cIiwgdGhpcy5jaWQpO1xuXHRcdFx0XHR0aGlzLml0ZW1WaWV3cy5mb3JFYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0XHRpZiAoIXRoaXMuc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0XHRcdFx0XHR2aWV3LmVsLnN0eWxlW3RyYW5zaXRpb25Qcm9wXSA9IFwib3BhY2l0eSBcIiArIHR4LkxBU1QuY3NzVGV4dDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dmlldy5lbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eShcIm9wYWNpdHlcIik7XG5cdFx0XHRcdH0sIHRoaXMpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9LFxuXG5cdHJlbW92ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLml0ZW1WaWV3cy5mb3JFYWNoKGZ1bmN0aW9uKHZpZXcsIGksIGFycikge1xuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLnJlbW92ZSh2aWV3LmVsKTtcblx0XHRcdGlmICh0aGlzLnNraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0XHR2aWV3LnJlbW92ZSgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFyIHMgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh2aWV3LmVsKTtcblx0XHRcdFx0aWYgKHMub3BhY2l0eSA9PSBcIjBcIiB8fCBzLnZpc2liaWxpdHkgPT0gXCJoaWRkZW5cIikge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6OnJlbW92ZUNoaWxkcmVuIFt2aWV3OiVzXSByZW1vdmVkIGltbWVkaWF0ZWx5IChpbnZpc2libGUpXCIsIHRoaXMuY2lkLCB2aWV3LmNpZCk7XG5cdFx0XHRcdFx0dmlldy5yZW1vdmUoKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2aWV3LmVsLmNsYXNzTGlzdC5hZGQoXCJyZW1vdmluZy1jaGlsZFwiKTtcblx0XHRcdFx0XHRpZiAoc1t0cmFuc2Zvcm1Qcm9wXSkgdmlldy5lbC5zdHlsZVt0cmFuc2Zvcm1Qcm9wXSA9IHNbdHJhbnNmb3JtUHJvcF07XG5cdFx0XHRcdFx0dmlldy5lbC5zdHlsZVt0cmFuc2l0aW9uUHJvcF0gPSBcIm9wYWNpdHkgXCIgKyB0eC5GSVJTVC5jc3NUZXh0O1xuXHRcdFx0XHRcdHZpZXcuZWwuc3R5bGUub3BhY2l0eSA9IDA7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGFycltpXSA9IG51bGw7XG5cdFx0fSwgdGhpcyk7XG5cdFx0dGhpcy5pdGVtVmlld3MubGVuZ3RoID0gMDtcblx0fSxcblxuXHRfb25BZGRlZFRyYW5zaXRpb25FbmQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0aWYgKGV2LnRhcmdldC5jaWQgJiYgdGhpcy5jaGlsZFZpZXdzLmhhc093blByb3BlcnR5KGV2LnRhcmdldC5jaWQpKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25BZGRlZFRyYW5zaXRpb25FbmQgW3ZpZXc6JXNdIFtwcm9wOiVzXSBbZXY6JXNdXCIsIHRoaXMuY2lkLCBldi50YXJnZXQuY2lkLCBldi5wcm9wZXJ0eU5hbWUsIGV2LnR5cGUpO1xuXHRcdFx0dmFyIHZpZXcgPSB0aGlzLmNoaWxkVmlld3NbZXYudGFyZ2V0LmNpZF07XG5cdFx0XHR2aWV3LmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJhZGRpbmctY2hpbGRcIik7XG5cdFx0XHR2aWV3LmVsLnN0eWxlLnJlbW92ZVByb3BlcnR5KHRyYW5zaXRpb25Qcm9wKTtcblx0XHR9XG5cdH0sXG5cblx0X29uUmVtb3ZlZFRyYW5zaXRpb25FbmQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0aWYgKGV2LnRhcmdldC5jaWQgJiYgdGhpcy5jaGlsZFZpZXdzLmhhc093blByb3BlcnR5KGV2LnRhcmdldC5jaWQpKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25SZW1vdmVkVHJhbnNpdGlvbkVuZCBbdmlldzolc10gW3Byb3A6JXNdIFtldjolc11cIiwgdGhpcy5jaWQsIGV2LnRhcmdldC5jaWQsIGV2LnByb3BlcnR5TmFtZSwgZXYudHlwZSk7XG5cdFx0XHR2YXIgdmlldyA9IHRoaXMuY2hpbGRWaWV3c1tldi50YXJnZXQuY2lkXTtcblx0XHRcdHZpZXcuZWwuY2xhc3NMaXN0LnJlbW92ZShcInJlbW92aW5nLWNoaWxkXCIpO1xuXHRcdFx0dmlldy5yZW1vdmUoKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gcHVyZ2VDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dmFyIGksIGVsLCBlbHMgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucmVtb3ZpbmctY2hpbGRcIik7XG5cdC8vIFx0Zm9yIChpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykge1xuXHQvLyBcdFx0ZWwgPSBlbHMuaXRlbShpKTtcblx0Ly8gXHRcdGlmIChlbC5wYXJlbnRFbGVtZW50ID09PSB0aGlzLmVsKSB7XG5cdC8vIFx0XHRcdHRyeSB7XG5cdC8vIFx0XHRcdFx0Y29uc29sZS5lcnJvcihcIiVzOjpwdXJnZUNoaWxkcmVuXCIsIHRoaXMuY2lkLCBlbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWNpZFwiKSk7XG5cdC8vIFx0XHRcdFx0Vmlldy5maW5kQnlFbGVtZW50KGVsKS5yZW1vdmUoKTtcblx0Ly8gXHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdC8vIFx0XHRcdFx0Y29uc29sZS5lcnJvcihcInM6OnB1cmdlQ2hpbGRyZW5cIiwgdGhpcy5jaWQsIFwib3JwaGFuZWQgZWxlbWVudFwiLCBlcnIpO1xuXHQvLyBcdFx0XHRcdHRoaXMuZWwucmVtb3ZlQ2hpbGQoZWwpO1xuXHQvLyBcdFx0XHR9XG5cdC8vIFx0XHR9XG5cdC8vIFx0fVxuXHQvLyB9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogQ29tcG9uZW50c1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblxuXHQvKipcblx0ICogbWVkaWEtY2Fyb3VzZWxcblx0ICovXG5cdGNyZWF0ZU1lZGlhQ2Fyb3VzZWw6IGZ1bmN0aW9uKGJ1bmRsZSkge1xuXHRcdC8vIENyZWF0ZSBjYXJvdXNlbFxuXHRcdHZhciBFbXB0eVJlbmRlcmVyID0gQ2Fyb3VzZWxSZW5kZXJlci5leHRlbmQoe1xuXHRcdFx0Y2xhc3NOYW1lOiBcImNhcm91c2VsLWl0ZW0gZW1wdHktaXRlbVwiLFxuXHRcdFx0bW9kZWw6IGJ1bmRsZSxcblx0XHRcdHRlbXBsYXRlOiBjYXJvdXNlbEVtcHR5VGVtcGxhdGUsXG5cdFx0fSk7XG5cdFx0dmFyIHJlbmRlcmVyRnVuY3Rpb24gPSBmdW5jdGlvbihpdGVtLCBpbmRleCwgYXJyKSB7XG5cdFx0XHRpZiAoaW5kZXggPT09IC0xKSB7XG5cdFx0XHRcdHJldHVybiBFbXB0eVJlbmRlcmVyO1xuXHRcdFx0fVxuXHRcdFx0c3dpdGNoIChpdGVtLmF0dHIoXCJAcmVuZGVyZXJcIikpIHtcblx0XHRcdFx0Y2FzZSBcInZpZGVvXCI6XG5cdFx0XHRcdFx0cmV0dXJuIFZpZGVvUmVuZGVyZXI7XG5cdFx0XHRcdGNhc2UgXCJzZXF1ZW5jZVwiOlxuXHRcdFx0XHRcdHJldHVybiBTZXF1ZW5jZVJlbmRlcmVyO1xuXHRcdFx0XHRjYXNlIFwiaW1hZ2VcIjpcblx0XHRcdFx0XHRyZXR1cm4gSW1hZ2VSZW5kZXJlcjtcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4gSW1hZ2VSZW5kZXJlcjtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHZhciB2aWV3ID0gbmV3IENhcm91c2VsKHtcblx0XHRcdGNsYXNzTmFtZTogXCJtZWRpYS1jYXJvdXNlbCBcIiArIGJ1bmRsZS5nZXQoXCJkb21pZFwiKSxcblx0XHRcdGNvbGxlY3Rpb246IGJ1bmRsZS5nZXQoXCJtZWRpYVwiKSxcblx0XHRcdHJlbmRlcmVyRnVuY3Rpb246IHJlbmRlcmVyRnVuY3Rpb24sXG5cdFx0XHRyZXF1aXJlU2VsZWN0aW9uOiBmYWxzZSxcblx0XHRcdGRpcmVjdGlvbjogQ2Fyb3VzZWwuRElSRUNUSU9OX0hPUklaT05UQUwsXG5cdFx0XHR0b3VjaDogdGhpcy5ocGFuLFxuXHRcdH0pO1xuXHRcdGNvbnRyb2xsZXIubGlzdGVuVG8odmlldywge1xuXHRcdFx0XCJ2aWV3OnNlbGVjdDpvbmVcIjogY29udHJvbGxlci5zZWxlY3RNZWRpYSxcblx0XHRcdFwidmlldzpzZWxlY3Q6bm9uZVwiOiBjb250cm9sbGVyLmRlc2VsZWN0TWVkaWEsXG5cdFx0XHQvLyBcInZpZXc6cmVtb3ZlZFwiOiBjb250cm9sbGVyLnN0b3BMaXN0ZW5pbmdcblx0XHR9KTtcblx0XHR2aWV3Lmxpc3RlblRvKGJ1bmRsZSwgXCJkZXNlbGVjdGVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMuY29sbGVjdGlvbik7XG5cdFx0XHRjb250cm9sbGVyLnN0b3BMaXN0ZW5pbmcodGhpcyk7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyoqXG5cdCAqIG1lZGlhLWNhcHRpb24tc3RhY2tcblx0ICovXG5cdGNyZWF0ZU1lZGlhQ2FwdGlvblN0YWNrOiBmdW5jdGlvbihidW5kbGUpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBDb2xsZWN0aW9uU3RhY2soe1xuXHRcdFx0Y2xhc3NOYW1lOiBcIm1lZGlhLWNhcHRpb24tc3RhY2tcIixcblx0XHRcdGNvbGxlY3Rpb246IGJ1bmRsZS5nZXQoXCJtZWRpYVwiKSxcblx0XHRcdHRlbXBsYXRlOiBtZWRpYVN0YWNrVGVtcGxhdGVcblx0XHR9KTtcblx0XHR2aWV3Lmxpc3RlblRvKGJ1bmRsZSwgXCJkZXNlbGVjdGVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMuY29sbGVjdGlvbik7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyoqXG5cdCAqIG1lZGlhLWRvdG5hdlxuXHQgKi9cblx0Y3JlYXRlTWVkaWFEb3ROYXZpZ2F0aW9uOiBmdW5jdGlvbihidW5kbGUpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBTZWxlY3RhYmxlTGlzdFZpZXcoe1xuXHRcdFx0Y2xhc3NOYW1lOiBcIm1lZGlhLWRvdG5hdiBkb3RzLWZvbnRmYWNlIGNvbG9yLWZnMDVcIixcblx0XHRcdGNvbGxlY3Rpb246IGJ1bmRsZS5nZXQoXCJtZWRpYVwiKSxcblx0XHRcdHJlbmRlcmVyOiBEb3ROYXZpZ2F0aW9uUmVuZGVyZXJcblx0XHR9KTtcblx0XHRjb250cm9sbGVyLmxpc3RlblRvKHZpZXcsIHtcblx0XHRcdFwidmlldzpzZWxlY3Q6b25lXCI6IGNvbnRyb2xsZXIuc2VsZWN0TWVkaWEsXG5cdFx0XHRcInZpZXc6c2VsZWN0Om5vbmVcIjogY29udHJvbGxlci5kZXNlbGVjdE1lZGlhLFxuXHRcdFx0Ly8gXCJ2aWV3OnJlbW92ZWRcIjogY29udHJvbGxlci5zdG9wTGlzdGVuaW5nXG5cdFx0fSk7XG5cdFx0dmlldy5saXN0ZW5UbyhidW5kbGUsIFwiZGVzZWxlY3RlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLmNvbGxlY3Rpb24pO1xuXHRcdFx0Y29udHJvbGxlci5zdG9wTGlzdGVuaW5nKHRoaXMpO1xuXHRcdH0pO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBAcGFyYW0gZWwge21vZHVsZTphcHAvbW9kZWwvaXRlbS9BcnRpY2xlVmlld31cblx0ICogQHJldHVybiB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld31cblx0ICovXG5cdGNyZWF0ZUFydGljbGVWaWV3OiBmdW5jdGlvbihhcnRpY2xlKSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgQXJ0aWNsZVZpZXcoe1xuXHRcdFx0bW9kZWw6IGFydGljbGUsXG5cdFx0fSk7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0Ly8gY3JlYXRlUHJvZ3Jlc3NXcmFwcGVyOiBmdW5jdGlvbigpIHtcblx0Ly8gXHQvLyB2YXIgdmlldyA9IG5ldyBQcm9ncmVzc01ldGVyKHtcblx0Ly8gXHQvLyBcdGlkOiBcIm1lZGlhLXByb2dyZXNzLXdyYXBwZXJcIixcblx0Ly8gXHQvLyBcdC8vIGNsYXNzTmFtZTogXCJjb2xvci1iZyBjb2xvci1mZzA1XCIsXG5cdC8vIFx0Ly8gXHR1c2VPcGFxdWU6IGZhbHNlLFxuXHQvLyBcdC8vIFx0bGFiZWxGbjogZnVuY3Rpb24oKSB7IHJldHVybiBcIjAlXCI7IH1cblx0Ly8gXHQvLyB9KTtcblx0Ly8gXHQvLyB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMucHJvZ3Jlc3NXcmFwcGVyLmVsKTtcblx0Ly8gXHQvLyByZXR1cm4gdmlldztcblx0Ly8gXHRyZXR1cm4gbnVsbDtcblx0Ly8gfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IENvbnRlbnRWaWV3OyIsIi8qIGdsb2JhbCBNdXRhdGlvbk9ic2VydmVyICovXG4vKipcbi8qIEBtb2R1bGUgYXBwL3ZpZXcvTmF2aWdhdGlvblZpZXdcbi8qL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6aGFtbWVyanN9ICovXG52YXIgSGFtbWVyID0gcmVxdWlyZShcImhhbW1lcmpzXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL1RyYW5zZm9ybUhlbHBlcn0gKi9cbnZhciBUcmFuc2Zvcm1IZWxwZXIgPSByZXF1aXJlKFwidXRpbHMvVHJhbnNmb3JtSGVscGVyXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXJ9ICovXG4vLyB2YXIgVG91Y2hNYW5hZ2VyID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVG91Y2hNYW5hZ2VyXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9Db250cm9sbGVyfSAqL1xudmFyIGNvbnRyb2xsZXIgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvQ29udHJvbGxlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9ufSAqL1xudmFyIHR5cGVzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9uXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vS2V5d29yZENvbGxlY3Rpb259ICovXG52YXIga2V5d29yZHMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vS2V5d29yZENvbGxlY3Rpb25cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9ufSAqL1xudmFyIGJ1bmRsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvblwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9ufSAqL1xudmFyIGFydGljbGVzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9uXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvRmlsdGVyYWJsZUxpc3RWaWV3fSAqL1xudmFyIEZpbHRlcmFibGVMaXN0VmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvRmlsdGVyYWJsZUxpc3RWaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0dyb3VwaW5nTGlzdFZpZXd9ICovXG52YXIgR3JvdXBpbmdMaXN0VmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvR3JvdXBpbmdMaXN0Vmlld1wiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uUGFnZXJ9ICovXG4vLyB2YXIgQ29sbGVjdGlvblBhZ2VyID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uUGFnZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvR3JhcGhWaWV3fSAqL1xudmFyIEdyYXBoVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvR3JhcGhWaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVCdXR0b259ICovXG52YXIgQXJ0aWNsZUJ1dHRvbiA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZUJ1dHRvblwiKTtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRQcm9wZXJ0eX0gKi9cbi8vIHZhciBwcmVmaXhlZFByb3BlcnR5ID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkUHJvcGVydHlcIik7XG5cbnZhciB0eCA9IEdsb2JhbHMudHJhbnNpdGlvbnM7XG5cbi8qKlxuLyogQGNvbnN0cnVjdG9yXG4vKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L05hdmlnYXRpb25WaWV3fVxuLyovXG52YXIgTmF2aWdhdGlvblZpZXcgPSBWaWV3LmV4dGVuZCh7XG5cblx0Ly8gLyoqIEBvdmVycmlkZSAqL1xuXHQvLyB0YWdOYW1lOiBcImRpdlwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNpZFByZWZpeDogXCJuYXZpZ2F0aW9uVmlld1wiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJuYXZpZ2F0aW9uIGNvbnRhaW5lci1leHBhbmRlZFwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdF8uYmluZEFsbCh0aGlzLCBcIl9vblZQYW5TdGFydFwiLCBcIl9vblZQYW5Nb3ZlXCIsIFwiX29uVlBhbkZpbmFsXCIpO1xuXHRcdF8uYmluZEFsbCh0aGlzLCBcIl9vbkhQYW5TdGFydFwiLCBcIl9vbkhQYW5Nb3ZlXCIsIFwiX29uSFBhbkZpbmFsXCIpO1xuXHRcdF8uYmluZEFsbCh0aGlzLCBcIl93aGVuVHJhbnNpdGlvbnNFbmRcIiwgXCJfd2hlblRyYW5zaXRpb25zQWJvcnRcIik7XG5cdFx0Xy5iaW5kQWxsKHRoaXMsIFwiX3doZW5MaXN0c1JlbmRlcmVkXCIpO1xuXHRcdF8uYmluZEFsbCh0aGlzLCBcIl9vbk5hdmlnYXRpb25DbGlja1wiKTtcblxuXHRcdC8vIHRoaXMuX21ldHJpY3MgPSB7XG5cdFx0Ly8gXHRtaW5IZWlnaHQ6IDBcblx0XHQvLyB9O1xuXHRcdHRoaXMuaXRlbVZpZXdzID0gW107XG5cdFx0dGhpcy50cmFuc2Zvcm1zID0gbmV3IFRyYW5zZm9ybUhlbHBlcigpO1xuXHRcdC8vIHRoaXMudG91Y2ggPSBvcHRpb25zLnRvdWNoIHx8IG5ldyBFcnJvcihcIm5vIHRvdWNoXCIpOyAvL1RvdWNoTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuXHRcdHRoaXMudnBhbiA9IG9wdGlvbnMudnBhbiB8fCBuZXcgRXJyb3IoXCJubyB2cGFuXCIpO1xuXHRcdHRoaXMuaHBhbiA9IG9wdGlvbnMuaHBhbiB8fCBuZXcgRXJyb3IoXCJubyBocGFuXCIpO1xuXG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZVwiLCB0aGlzLl9vbk1vZGVsQ2hhbmdlKTtcblxuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJ3aXRoQnVuZGxlOmNoYW5nZVwiLCB0aGlzLl9vbldpdGhCdW5kbGVDaGFuZ2UpO1xuXG5cdFx0dGhpcy5rZXl3b3JkTGlzdCA9IHRoaXMuY3JlYXRlS2V5d29yZExpc3QoKTtcblx0XHQvKiBOT1RFOiAubGlzdC1ncm91cCAubGFiZWwgbW92ZXMgaG9yaXpvbnRhbGx5IChjZi4gc2Fzcy9sYXlvdXRzLyouc2NzcykgKi9cblx0XHR0aGlzLmhHcm91cGluZ3MgPSB0aGlzLmtleXdvcmRMaXN0LmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubGlzdC1ncm91cCAubGFiZWxcIik7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLmFkZCh0aGlzLmhHcm91cGluZ3MsIHRoaXMua2V5d29yZExpc3QuZWwsIHRoaXMua2V5d29yZExpc3Qud3JhcHBlcik7XG5cdFx0dGhpcy5pdGVtVmlld3MucHVzaCh0aGlzLmtleXdvcmRMaXN0KTtcblxuXHRcdHRoaXMuYnVuZGxlTGlzdCA9IHRoaXMuY3JlYXRlQnVuZGxlTGlzdCgpO1xuXHRcdHRoaXMudHJhbnNmb3Jtcy5hZGQodGhpcy5idW5kbGVMaXN0LmVsLCB0aGlzLmJ1bmRsZUxpc3Qud3JhcHBlcik7XG5cdFx0dGhpcy5pdGVtVmlld3MucHVzaCh0aGlzLmJ1bmRsZUxpc3QpO1xuXG5cdFx0dGhpcy5zaXRlbmFtZSA9IHRoaXMuY3JlYXRlU2l0ZW5hbWVCdXR0b24oKTtcblx0XHR0aGlzLnRyYW5zZm9ybXMuYWRkKHRoaXMuc2l0ZW5hbWUud3JhcHBlciwgdGhpcy5zaXRlbmFtZS5lbCk7XG5cdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLmFkZCh0aGlzLnNpdGVuYW1lLmVsLmZpcnN0RWxlbWVudENoaWxkLCB0aGlzLnNpdGVuYW1lLmVsKTtcblxuXHRcdHRoaXMuYWJvdXQgPSB0aGlzLmNyZWF0ZUFydGljbGVCdXR0b24oYXJ0aWNsZXMuZmluZFdoZXJlKHsgaGFuZGxlOiBcImFib3V0XCIgfSkpO1xuXHRcdHRoaXMudHJhbnNmb3Jtcy5hZGQodGhpcy5hYm91dC53cmFwcGVyLCB0aGlzLmFib3V0LmVsKTtcblxuXHRcdHRoaXMuZ3JhcGggPSB0aGlzLmNyZWF0ZUdyYXBoVmlldyh0aGlzLmJ1bmRsZUxpc3QsIHRoaXMua2V5d29yZExpc3QpO1xuXHRcdC8vIHRoaXMudHJhbnNmb3Jtcy5hZGQodGhpcy5ncmFwaC5lbCk7XG5cdFx0Ly8gdGhpcy5pdGVtVmlld3MucHVzaCh0aGlzLmdyYXBoKTtcblx0XHQvLyB0aGlzLmxpc3RlblRvKHRoaXMuZ3JhcGgsIHtcblx0XHQvLyBcdFwiY2FudmFzOnVwZGF0ZVwiOiB0aGlzLl9vbkdyYXBoVXBkYXRlLFxuXHRcdC8vIFx0XCJjYW52YXM6cmVkcmF3XCI6IHRoaXMuX29uR3JhcGhSZWRyYXcsXG5cdFx0Ly8gfSk7XG5cblx0XHQvKnRoaXMubGlzdGVuVG8odGhpcy5ncmFwaCwgXCJ2aWV3OnJlbmRlcjpiZWZvcmVcIiwgZnVuY3Rpb24odmlldywgZmxhZ3MpIHtcblx0XHRcdHZhciB2bWF4O1xuXHRcdFx0aWYgKCF2aWV3LmVsLnN0eWxlLmhlaWdodCkge1xuXHRcdFx0XHQvLyBpZiAoZmxhZ3MgJiAoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3Lk1PREVMX0lOVkFMSUQpKSB7XG5cdFx0XHRcdC8vIGlmICgodGhpcy5idW5kbGVMaXN0LnJlbmRlckZsYWdzIHwgVmlldy5TSVpFX0lOVkFMSUQpIHx8XG5cdFx0XHRcdC8vIFx0KHRoaXMua2V5d29yZExpc3QucmVuZGVyRmxhZ3MgfCBWaWV3LlNJWkVfSU5WQUxJRCkpIHtcblx0XHRcdFx0Ly8gfVxuXHRcdFx0XHR2bWF4ID0gTWF0aC5tYXgoXG5cdFx0XHRcdFx0dGhpcy5idW5kbGVMaXN0Ll9tZXRyaWNzLmhlaWdodCxcblx0XHRcdFx0XHR0aGlzLmtleXdvcmRMaXN0Ll9tZXRyaWNzLmhlaWdodFxuXHRcdFx0XHQpO1xuXHRcdFx0XHRpZiAoXy5pc051bWJlcih2bWF4KSkge1xuXHRcdFx0XHRcdHZpZXcuZWwuc3R5bGUuaGVpZ2h0ID0gdm1heCArIFwicHhcIjtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOlt2aWV3OnJlbmRlcjpiZWZvcmVdW29uY2VdOiVzIFslc10gaGVpZ2h0czpbJWksICVpXSAobWF4ICVpKVwiLFxuXHRcdFx0XHRcdFx0dGhpcy5jaWQsIHZpZXcuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpLFxuXHRcdFx0XHRcdFx0dGhpcy5idW5kbGVMaXN0Ll9tZXRyaWNzLmhlaWdodCxcblx0XHRcdFx0XHRcdHRoaXMua2V5d29yZExpc3QuX21ldHJpY3MuaGVpZ2h0LFxuXHRcdFx0XHRcdFx0dm1heCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTsqL1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5idW5kbGVMaXN0LCBcInZpZXc6cmVuZGVyOmFmdGVyXCIsIGZ1bmN0aW9uKHZpZXcsIGZsYWdzKSB7XG5cdFx0Ly8gXHRjb25zb2xlLmluZm8oXCIlczpbdmlldzpyZW5kZXI6YWZ0ZXIgJXNdXCIsIHRoaXMuY2lkLCB2aWV3LmNpZCwgVmlldy5mbGFnc1RvU3RyaW5nKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpKTtcblx0XHQvLyBcdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHtcblx0XHQvLyBcdFx0XHQvLyBjb25zb2xlLmluZm8oXCIlczpbJXMgdmlldzpyZW5kZXI6YWZ0ZXJdIGJ1bmRsZUxpc3QgaGVpZ2h0XCIsIHRoaXMuY2lkLCB2aWV3LmNpZCwgdGhpcy5idW5kbGVMaXN0LmVsLnN0eWxlLmhlaWdodCk7XG5cdFx0Ly8gXHRcdFx0Ly8gdGhpcy5ncmFwaC5lbC5zdHlsZS5oZWlnaHQgPSB0aGlzLmJ1bmRsZUxpc3QuZWwuc3R5bGUuaGVpZ2h0O1xuXHRcdC8vIFx0XHRcdHRoaXMuZ3JhcGguZWwuc3R5bGUub3BhY2l0eSA9IHRoaXMuYnVuZGxlTGlzdC5jb2xsYXBzZWQ/IDAgOiAxO1xuXHRcdC8vIFx0XHRcdHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCkucmVuZGVyTm93KCk7XG5cdFx0Ly8gXHQvLyBcdH1cblx0XHQvLyB9KTtcblx0XHQvLyB0aGlzLmxpc3RlblRvKHRoaXMuYnVuZGxlTGlzdCwgXCJ2aWV3OnJlbmRlcjphZnRlclwiLCB0aGlzLl9vbkxpc3RSZXNpemUpO1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5rZXl3b3JkTGlzdCwgXCJ2aWV3OnJlbmRlcjphZnRlclwiLCB0aGlzLl9vbkxpc3RSZXNpemUpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZW5kZXJGcmFtZTogZnVuY3Rpb24odHN0YW1wLCBmbGFncykge1xuXHRcdGlmIChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkge1xuXHRcdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjb250YWluZXItY29sbGFwc2VkXCIsIHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKTtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY29udGFpbmVyLWV4cGFuZGVkXCIsICF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiY29sbGFwc2VkXCIpXG5cdFx0XHRcdHx8IHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwiY29udGFpbmVyLWNoYW5naW5nXCIpO1xuXHRcdFx0fVxuXHRcdFx0Ly8gaWYgKHRoaXMuYnVuZGxlTGlzdC5pbnZhbGlkYXRlZCkge1xuXHRcdFx0Ly8gXHR0aGlzLmJ1bmRsZUxpc3QuaW52YWxpZGF0ZShWaWV3LlNJWkVfSU5WQUxJRCk7XG5cdFx0XHQvLyB9XG5cdFx0XHQvLyBpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiYnVuZGxlXCIpKSB7XG5cdFx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwicm91dGVOYW1lXCIpKSB7XG5cdFx0XHRcdHRoaXMuYnVuZGxlTGlzdC5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCk7XG5cdFx0XHRcdHRoaXMua2V5d29yZExpc3QucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIHRyYW5zZm9ybXNcblx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHRpZiAodGhpcy5za2lwVHJhbnNpdGlvbnMgfHxcblx0XHRcdChmbGFncyAmIChWaWV3Lk1PREVMX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpKSkge1xuXHRcdFx0Ly8gaWYgKHRyYW5zZm9ybXNDaGFuZ2VkKSB7XG5cdFx0XHRpZiAodGhpcy5za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnN0b3BBbGxUcmFuc2l0aW9ucygpO1xuXHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLmNsZWFyQWxsT2Zmc2V0cygpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5yZW5kZXJUcmFuc2l0aW9ucyhmbGFncyk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OnJlbmRlckZyYW1lICVvXCIsIHRoaXMuY2lkLFxuXHRcdFx0Ly8gXHR0aGlzLnRyYW5zZm9ybXMuaXRlbXMubWFwKGZ1bmN0aW9uKG8pIHtcblx0XHRcdC8vIFx0XHRyZXR1cm4gW28uaGFzVHJhbnNpdGlvbiwgby5lbC5sb2NhbE5hbWUsIG8uZWwuaWQgfHwgby5lbC5jbGFzc05hbWVdLmpvaW4oXCIgOiBcIik7XG5cdFx0XHQvLyBcdH0pXG5cdFx0XHQvLyApO1xuXHRcdH1cblxuXHRcdC8vIGlmIChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkge1xuXHRcdC8vIFx0Ly8gaWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImNvbGxhcHNlZFwiKSkge1xuXHRcdC8vIFx0Ly9pZiAoKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImNvbGxhcHNlZFwiKSAmJiAhdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpIHx8ICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoQnVuZGxlXCIpICYmICF0aGlzLm1vZGVsLmdldChcIndpdGhCdW5kbGVcIikpKSB7XG5cdFx0Ly8gXHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiY29sbGFwc2VkXCIpXG5cdFx0Ly8gXHRcdHx8IHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhCdW5kbGVcIilcblx0XHQvLyBcdFx0fHwgdGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwid2l0aEFydGljbGVcIikpIHtcblx0XHQvLyBcdFx0dGhpcy50cmFuc2Zvcm1zLnByb21pc2UoKS50aGVuKHRoaXMuX3doZW5UcmFuc2l0aW9uc0VuZCwgdGhpcy5fd2hlblRyYW5zaXRpb25zQWJvcnQpO1xuXHRcdC8vIFx0fVxuXHRcdC8vIH1cblxuXHRcdC8vIGNoaWxkcmVuIGxvb3Bcblx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHR0aGlzLml0ZW1WaWV3cy5mb3JFYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdHZpZXcuc2tpcFRyYW5zaXRpb25zID0gdmlldy5za2lwVHJhbnNpdGlvbnMgfHwgdGhpcy5za2lwVHJhbnNpdGlvbnM7XG5cdFx0XHRpZiAoZmxhZ3MgJiBWaWV3LlNJWkVfSU5WQUxJRCkge1xuXHRcdFx0XHR2aWV3LnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCF2aWV3LnNraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0XHR2aWV3LnJlbmRlck5vdygpO1xuXHRcdFx0fVxuXHRcdH0sIHRoaXMpO1xuXG5cdFx0dmFyIHdoZW5MaXN0c1JlbmRlcmVkID0gUHJvbWlzZS5hbGwoW1xuXHRcdFx0dGhpcy5idW5kbGVMaXN0LndoZW5SZW5kZXJlZCgpLFxuXHRcdFx0dGhpcy5rZXl3b3JkTGlzdC53aGVuUmVuZGVyZWQoKVxuXHRcdF0pXG5cdFx0XHQudGhlbihcblx0XHRcdFx0ZnVuY3Rpb24ocmVzdWx0KSB7XG5cdFx0XHRcdFx0dmFyIGh2YWwgPSByZXN1bHQucmVkdWNlKGZ1bmN0aW9uKGEsIG8pIHtcblx0XHRcdFx0XHRcdHJldHVybiBNYXRoLm1heChhLCBvLl9tZXRyaWNzLmhlaWdodCk7XG5cdFx0XHRcdFx0fSwgMCk7XG5cdFx0XHRcdFx0aWYgKHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHRcdFx0XHR0aGlzLmVsLnN0eWxlLmhlaWdodCA9IFwiXCI7XG5cdFx0XHRcdFx0XHQvLyB0aGlzLmVsLnN0eWxlLm1pbkhlaWdodCA9IFwiXCI7XG5cdFx0XHRcdFx0XHQvLyB0aGlzLmdyYXBoLmVsLnN0eWxlLmhlaWdodCA9IFwiMTAwJVwiO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLmVsLnN0eWxlLmhlaWdodCA9IGh2YWwgKyBcInB4XCI7XG5cdFx0XHRcdFx0XHQvLyB0aGlzLmVsLnN0eWxlLm1pbkhlaWdodCA9IGh2YWwgKyBcInB4XCI7XG5cdFx0XHRcdFx0XHQvLyB0aGlzLmdyYXBoLmVsLnN0eWxlLmhlaWdodCA9IGh2YWwgKyBcInB4XCI7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6W3doZW5SZW5kZXJlZF1bZmxhZ3M6ICVzXSBoZWlnaHQ6ICVvXCIsIHRoaXMuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpLCBodmFsKTtcblx0XHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdFx0XHR9LmJpbmQodGhpcyksXG5cdFx0XHRcdGZ1bmN0aW9uKHJlYXNvbikge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIiVzOlt3aGVuUmVuZGVyZWRdIGZhaWxlZDogJW9cIiwgdGhpcy5jaWQsIHJlYXNvbik7XG5cdFx0XHRcdFx0cmV0dXJuIHJlYXNvbjtcblx0XHRcdFx0fS5iaW5kKHRoaXMpXG5cdFx0XHQpO1xuXG5cdFx0UHJvbWlzZS5hbGwoW1xuXHRcdFx0d2hlbkxpc3RzUmVuZGVyZWQsXG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMucHJvbWlzZSgpXG5cdFx0XSlcblx0XHRcdC50aGVuKFxuXHRcdFx0XHRmdW5jdGlvbihyZXN1bHQpIHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOltsaXN0c1JlbmRlcmVkK3RyYW5zaXRpb25zRW5kXSBbJXNdXCIsIHRoaXMuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpLCByZXN1bHQpO1xuXG5cdFx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY29udGFpbmVyLWNoYW5naW5nXCIpO1xuXHRcdFx0XHRcdHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHRcdFx0XHR9LmJpbmQodGhpcyksXG5cdFx0XHRcdGZ1bmN0aW9uKHJlYXNvbikge1xuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIiVzOltsaXN0c1JlbmRlcmVkK3RyYW5zaXRpb25zRW5kXSBbJXNdXCIsIHRoaXMuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpLCByZWFzb24pO1xuXG5cdFx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY29udGFpbmVyLWNoYW5naW5nXCIpO1xuXHRcdFx0XHRcdHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHRcdFx0XHR9LmJpbmQodGhpcylcblx0XHRcdCk7XG5cblx0XHQvLyBncmFwaFxuXHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdC8vIGlmICgoZmxhZ3MgJiAoVmlldy5TSVpFX0lOVkFMSUQgfCB+Vmlldy5NT0RFTF9JTlZBTElEKSlcblx0XHQvLyBcdC8qIGNvbGxhcHNlZCBoYXMgbm90IGNoYW5nZWQsIG5vIGJ1bmRsZSBzZWxlY3RlZCAqL1xuXHRcdC8vIFx0JiYgIXRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImNvbGxhcHNlZFwiKVxuXHRcdC8vIFx0JiYgIXRoaXMubW9kZWwuZ2V0KFwid2l0aEJ1bmRsZVwiKSkge1xuXHRcdC8vIFx0dGhpcy5ncmFwaC5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCk7XG5cdFx0Ly8gXHRpZiAoIXRoaXMuc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0Ly8gXHRcdHRoaXMuZ3JhcGgucmVuZGVyTm93KCk7XG5cdFx0Ly8gXHR9XG5cdFx0Ly8gfVxuXHRcdC8vIGVsc2UgaWYgKChmbGFncyAmIFZpZXcuU0laRV9JTlZBTElEKSAmJiAhdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHQvLyBcdC8qIE5hdmlnYXRpb25WaWV3IGhhcyByZXNpemVkIHdoaWxlIHVuY29sbGFwc2VkLFxuXHRcdC8vIFx0YnV0IG1vZGVsIGlzIHVuY2hhbmdlZCAqL1xuXHRcdC8vIFx0dGhpcy5ncmFwaC5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCk7XG5cdFx0Ly8gfVxuXHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gZmFsc2U7XG5cdH0sXG5cblx0X3doZW5MaXN0c1JlbmRlcmVkOiBmdW5jdGlvbihyZXN1bHQpIHtcblxuXHR9LFxuXG5cdF93aGVuVHJhbnNpdGlvbnNFbmQ6IGZ1bmN0aW9uKHJlc3VsdCkge1xuXHRcdGNvbnNvbGUuaW5mbyhcIiVzOjpfd2hlblRyYW5zaXRpb25zRW5kXCIsIHRoaXMuY2lkKTtcblx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb250YWluZXItY2hhbmdpbmdcIik7XG5cdFx0Ly8gaWYgKCFHbG9iYWxzLkJSRUFLUE9JTlRTW1wiZGVza3RvcC1zbWFsbFwiXS5tYXRjaGVzKVxuXHRcdC8vIFx0cmV0dXJuO1xuXHRcdC8vIGlmICghdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHQvLyBcdHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpOyAvLy5yZW5kZXJOb3coKTtcblx0XHQvLyB9XG5cdH0sXG5cblx0X3doZW5UcmFuc2l0aW9uc0Fib3J0OiBmdW5jdGlvbihyZWFzb24pIHtcblx0XHRjb25zb2xlLndhcm4oXCIlczo6X3doZW5UcmFuc2l0aW9uc0Fib3J0ICVvXCIsIHRoaXMuY2lkLCByZWFzb24pO1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbnRhaW5lci1jaGFuZ2luZ1wiKTtcblx0XHQvLyBpZiAoIUdsb2JhbHMuQlJFQUtQT0lOVFNbXCJkZXNrdG9wLXNtYWxsXCJdLm1hdGNoZXMpXG5cdFx0Ly8gXHRyZXR1cm47XG5cdFx0Ly8gaWYgKCF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdC8vIFx0dGhpcy5ncmFwaC5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCk7IC8vLnJlbmRlck5vdygpO1xuXHRcdC8vIH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHJlbmRlclRyYW5zaXRpb25zXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZW5kZXJUcmFuc2l0aW9uczogZnVuY3Rpb24oZmxhZ3MpIHtcblx0XHR2YXIgZnJvbVJvdXRlID0gdGhpcy5tb2RlbC5wcmV2aW91cyhcInJvdXRlTmFtZVwiKTtcblx0XHR2YXIgdG9Sb3V0ZSA9IHRoaXMubW9kZWwuZ2V0KFwicm91dGVOYW1lXCIpO1xuXG5cdFx0dmFyIG1vZGVsQ2hhbmdlZCA9IChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCk7XG5cdFx0LyogYnVuZGxlICovXG5cdFx0dmFyIHdpdGhCdW5kbGUgPSB0aGlzLm1vZGVsLmdldChcIndpdGhCdW5kbGVcIik7XG5cdFx0dmFyIHdpdGhCdW5kbGVDaGFuZ2VkID0gbW9kZWxDaGFuZ2VkICYmIHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhCdW5kbGVcIik7XG5cdFx0dmFyIGJ1bmRsZUNoYW5nZWQgPSBtb2RlbENoYW5nZWQgJiYgdGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiYnVuZGxlXCIpO1xuXHRcdC8qIG1lZGlhICovXG5cdFx0dmFyIHdpdGhNZWRpYSA9IHRoaXMubW9kZWwuZ2V0KFwid2l0aE1lZGlhXCIpO1xuXHRcdHZhciB3aXRoTWVkaWFDaGFuZ2VkID0gbW9kZWxDaGFuZ2VkICYmIHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhNZWRpYVwiKTtcblx0XHQvL3ZhciBtZWRpYUNoYW5nZWQgPSBtb2RlbENoYW5nZWQgJiYgdGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwibWVkaWFcIik7XG5cdFx0LyogYXJ0aWNsZSAqL1xuXHRcdC8vIHZhciB3aXRoQXJ0aWNsZSA9IHRoaXMubW9kZWwuZ2V0KFwid2l0aEFydGljbGVcIik7XG5cdFx0dmFyIHdpdGhBcnRpY2xlQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoQXJ0aWNsZVwiKTtcblx0XHQvL3ZhciBhcnRpY2xlQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJhcnRpY2xlXCIpO1xuXHRcdC8qIGNvbGxhcHNlZCAqL1xuXHRcdHZhciBjb2xsYXBzZWQgPSB0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKTtcblx0XHR2YXIgY29sbGFwc2VkQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJjb2xsYXBzZWRcIik7XG5cblx0XHR2YXIgdGY7XG5cdFx0LyogdGhpcy5idW5kbGVMaXN0LmVsICovXG5cdFx0dGYgPSB0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMuYnVuZGxlTGlzdC5lbCk7XG5cdFx0aWYgKHRmLmhhc09mZnNldCkge1xuXHRcdFx0dGYucnVuVHJhbnNpdGlvbihjb2xsYXBzZWRDaGFuZ2VkID8gdHguQkVUV0VFTiA6IHR4Lk5PVyk7XG5cdFx0fVxuXHRcdC8qIHRoaXMua2V5d29yZExpc3QuZWwgKi9cblx0XHR0ZiA9IHRoaXMudHJhbnNmb3Jtcy5nZXQodGhpcy5rZXl3b3JkTGlzdC5lbCk7XG5cdFx0aWYgKHRmLmhhc09mZnNldCkge1xuXHRcdFx0dGYucnVuVHJhbnNpdGlvbihjb2xsYXBzZWRDaGFuZ2VkID8gdHguQkVUV0VFTiA6IHR4Lk5PVyk7XG5cdFx0fVxuXHRcdC8qIHRoaXMuZ3JhcGguZWwgKi9cblx0XHR0ZiA9IHRoaXMudHJhbnNmb3Jtcy5nZXQodGhpcy5ncmFwaC5lbCk7XG5cdFx0aWYgKHRmICYmIHRmLmhhc09mZnNldCkge1xuXHRcdFx0dGYucnVuVHJhbnNpdGlvbihjb2xsYXBzZWRDaGFuZ2VkID8gdHguQkVUV0VFTiA6IHR4Lk5PVyk7XG5cdFx0XHR0Zi5jbGVhck9mZnNldCgpO1xuXHRcdH1cblxuXHRcdC8qXG5cdFx0ICogTk9URTpcblx0XHQgKiBWZXJ0aWNhbDpcblx0XHQgKlx0XHRzaXRlLW5hbWUtd3JhcHBlcixcblx0XHQgKlx0XHRhcnRpY2xlLWxpc3Qtd3JhcHBlclxuXHRcdCAqIEhvcml6b250YWw6XG5cdFx0ICpcdFx0c2l0ZS1uYW1lLFxuXHRcdCAqXHRcdGFydGljbGUtYnV0dG9ucyxcblx0XHQgKlx0XHRrZXl3b3JkTGlzdC53cmFwcGVyLFxuXHRcdCAqXHRcdGJ1bmRsZUxpc3Qud3JhcHBlcixcblx0XHQgKlx0XHRoR3JvdXBpbmdzXG5cdFx0ICovXG5cdFx0aWYgKEdsb2JhbHMuQlJFQUtQT0lOVFNbXCJkZXNrdG9wLXNtYWxsXCJdLm1hdGNoZXMpIHtcblx0XHRcdC8qIEhPUklaT05UQUwgKi9cblx0XHRcdHRmID0gdGhpcy50cmFuc2Zvcm1zLmdldCh0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpO1xuXHRcdFx0aWYgKGNvbGxhcHNlZENoYW5nZWQgJiYgIXdpdGhBcnRpY2xlQ2hhbmdlZCkge1xuXHRcdFx0XHQvLyBpZiAoY29sbGFwc2VkQ2hhbmdlZCkge1xuXHRcdFx0XHRpZiAod2l0aEJ1bmRsZUNoYW5nZWQpIHtcblx0XHRcdFx0XHRpZiAod2l0aE1lZGlhQ2hhbmdlZClcblx0XHRcdFx0XHRcdHRmLnJ1blRyYW5zaXRpb24od2l0aEJ1bmRsZSA/IHR4LkxBU1QgOiB0eC5GSVJTVCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKHdpdGhNZWRpYSlcblx0XHRcdFx0XHRcdHRmLnJ1blRyYW5zaXRpb24oY29sbGFwc2VkID8gdHguTEFTVCA6IHR4LkZJUlNUKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKCF3aXRoQnVuZGxlQ2hhbmdlZCAmJiB3aXRoTWVkaWFDaGFuZ2VkKVxuXHRcdFx0XHRcdHRmLnJ1blRyYW5zaXRpb24oYnVuZGxlQ2hhbmdlZCA/IHR4LkJFVFdFRU4gOiB0eC5OT1cpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGNvbGxhcHNlZENoYW5nZWQgXiB3aXRoQXJ0aWNsZUNoYW5nZWQpIHtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnJ1blRyYW5zaXRpb24oY29sbGFwc2VkID8gdHguTEFTVCA6IHR4LkZJUlNULFxuXHRcdFx0XHRcdHRoaXMuc2l0ZW5hbWUuZWwsIHRoaXMuYWJvdXQuZWwsIHRoaXMuYnVuZGxlTGlzdC53cmFwcGVyLCB0aGlzLmhHcm91cGluZ3MpO1xuXHRcdFx0fVxuXHRcdFx0LyogVkVSVElDQUwgKi9cblx0XHRcdGlmIChmcm9tUm91dGUgPT0gJ3Jvb3QnIHx8IHRvUm91dGUgPT0gJ3Jvb3QnKSB7XG5cdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5ydW5UcmFuc2l0aW9uKHR4LkJFVFdFRU4sXG5cdFx0XHRcdFx0dGhpcy5zaXRlbmFtZS53cmFwcGVyLCB0aGlzLmFib3V0LndyYXBwZXIpO1xuXHRcdFx0fVxuXHRcdFx0LyogdGhpcy5oR3JvdXBpbmdzICovXG5cdFx0XHQvLyBpZiAoY29sbGFwc2VkQ2hhbmdlZCBeIHdpdGhBcnRpY2xlQ2hhbmdlZCkge1xuXHRcdFx0Ly8gXHQvLyBpZiAoY29sbGFwc2VkQ2hhbmdlZCAmJiAhd2l0aEFydGljbGVDaGFuZ2VkKSB7XG5cdFx0XHQvLyBcdHRoaXMudHJhbnNmb3Jtcy5ydW5UcmFuc2l0aW9uKGNvbGxhcHNlZCA/IHR4LkxBU1QgOiB0eC5GSVJTVCwgdGhpcy5oR3JvdXBpbmdzKTtcblx0XHRcdC8vIH1cblx0XHRcdC8vIGlmIChjb2xsYXBzZWRDaGFuZ2VkKSB7XG5cdFx0XHQvLyBcdGlmICghd2l0aEFydGljbGVDaGFuZ2VkKSB7XG5cdFx0XHQvLyBcdFx0Ly8gaWYgKGZyb21Sb3V0ZSA9PSAncm9vdCcgfHwgdG9Sb3V0ZSA9PSAncm9vdCcpIHtcblx0XHRcdC8vIFx0XHR0aGlzLnRyYW5zZm9ybXMucnVuVHJhbnNpdGlvbihjb2xsYXBzZWQgPyB0eC5MQVNUIDogdHguRklSU1QsIHRoaXMuYnVuZGxlTGlzdC53cmFwcGVyKTtcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly8gfSBlbHNlIHtcblx0XHRcdC8vIFx0aWYgKHdpdGhBcnRpY2xlQ2hhbmdlZCAmJiB3aXRoQnVuZGxlQ2hhbmdlZCkge1xuXHRcdFx0Ly8gXHRcdHRoaXMudHJhbnNmb3Jtcy5ydW5UcmFuc2l0aW9uKHdpdGhBcnRpY2xlID8gdHguQkVUV0VFTiA6IHR4LkxBU1QsIHRoaXMuYnVuZGxlTGlzdC53cmFwcGVyKTtcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly8gfVxuXHRcdH0gZWxzZSBpZiAoR2xvYmFscy5CUkVBS1BPSU5UU1tcImZ1bGx3aWR0aFwiXS5tYXRjaGVzKSB7XG5cdFx0XHQvLyBpZiAoY29sbGFwc2VkQ2hhbmdlZCApIHtcblx0XHRcdGlmIChjb2xsYXBzZWRDaGFuZ2VkIF4gd2l0aEFydGljbGVDaGFuZ2VkKSB7XG5cdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5ydW5UcmFuc2l0aW9uKGNvbGxhcHNlZCA/IHR4LkZJUlNUIDogdHguTEFTVCxcblx0XHRcdFx0XHR0aGlzLnNpdGVuYW1lLmVsLCB0aGlzLmFib3V0LmVsKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHdpdGhCdW5kbGVDaGFuZ2VkKSB7XG5cdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5ydW5UcmFuc2l0aW9uKHR4LkJFVFdFRU4sXG5cdFx0XHRcdFx0dGhpcy5zaXRlbmFtZS5lbCwgdGhpcy5hYm91dC5lbCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMudHJhbnNmb3Jtcy5jbGVhck9mZnNldCh0aGlzLmJ1bmRsZUxpc3QuZWwsIHRoaXMua2V5d29yZExpc3QuZWwsXG5cdFx0XHR0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIG93biBtb2RlbCBjaGFuZ2VkXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vbk1vZGVsQ2hhbmdlOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5NT0RFTF9JTlZBTElEKTtcblx0XHQvLyBrZXl3b3Jkcy5kZXNlbGVjdCgpO1xuXHRcdGlmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHRcdGlmICh0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0XHQvLyBjbGVhciBrZXl3b3JkIHNlbGVjdGlvblxuXHRcdFx0XHRrZXl3b3Jkcy5kZXNlbGVjdCgpO1xuXHRcdFx0fSAvLyBlbHNlIHt9XG5cdFx0XHR0aGlzLmtleXdvcmRMaXN0LmNvbGxhcHNlZCA9IHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpO1xuXHRcdFx0dGhpcy5idW5kbGVMaXN0LmNvbGxhcHNlZCA9IHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiYnVuZGxlXCIpKSB7XG5cdFx0XHR0aGlzLmJ1bmRsZUxpc3Quc2VsZWN0ZWRJdGVtID0gdGhpcy5tb2RlbC5nZXQoXCJidW5kbGVcIik7XG5cdFx0XHR0aGlzLmtleXdvcmRMaXN0LnJlZnJlc2goKTtcblx0XHRcdC8vIGtleXdvcmRzLmRlc2VsZWN0KCk7XG5cdFx0XHQvLyB0aGlzLmdyYXBoICYmIHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoQnVuZGxlXCIpKSB7XG5cdFx0XHQvLyB0aGlzLmtleXdvcmRMaXN0LnJlZnJlc2goKVxuXHRcdFx0aWYgKHRoaXMubW9kZWwuZ2V0KFwid2l0aEJ1bmRsZVwiKSkge1xuXHRcdFx0XHR0aGlzLmdyYXBoLmVsLmFkZEV2ZW50TGlzdGVuZXIoR2xvYmFscy5DTElDS19FVkVOVCwgdGhpcy5fb25OYXZpZ2F0aW9uQ2xpY2spO1xuXHRcdFx0XHR0aGlzLnZwYW4ub24oXCJ2cGFuc3RhcnRcIiwgdGhpcy5fb25WUGFuU3RhcnQpO1xuXHRcdFx0XHR0aGlzLmhwYW4ub24oXCJocGFuc3RhcnRcIiwgdGhpcy5fb25IUGFuU3RhcnQpO1xuXHRcdFx0XHQvLyB0aGlzLmhwYW4ub24oXCJ0YXBcIiwgdGhpcy5fb25UYXApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5ncmFwaC5lbC5yZW1vdmVFdmVudExpc3RlbmVyKEdsb2JhbHMuQ0xJQ0tfRVZFTlQsIHRoaXMuX29uTmF2aWdhdGlvbkNsaWNrKTtcblx0XHRcdFx0dGhpcy52cGFuLm9mZihcInZwYW5zdGFydFwiLCB0aGlzLl9vblZQYW5TdGFydCk7XG5cdFx0XHRcdHRoaXMuaHBhbi5vZmYoXCJocGFuc3RhcnRcIiwgdGhpcy5fb25IUGFuU3RhcnQpO1xuXHRcdFx0XHRrZXl3b3Jkcy5kZXNlbGVjdCgpO1xuXHRcdFx0XHQvLyB0aGlzLmhwYW4ub2ZmKFwidGFwXCIsIHRoaXMuX29uVGFwKTtcblx0XHRcdH1cblx0XHRcdC8vIHRoaXMuZ3JhcGgudmFsdWVUbygpXG5cdFx0fVxuXHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3Lk1PREVMX0lOVkFMSUQpO1xuXHR9LFxuXG5cdC8vIF9vbldpdGhCdW5kbGVDaGFuZ2U6IGZ1bmN0aW9uKHdpdGhCdW5kbGUpIHtcblx0Ly8gXHRpZiAod2l0aEJ1bmRsZSkge1xuXHQvLyBcdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNvbGxhcHNlZDpjaGFuZ2VcIiwgZnVuY3Rpb24oY29sbGFwc2VkKXtcblx0Ly9cblx0Ly8gXHRcdH0pO1xuXHQvLyBcdH0gZWxzZSB7XG5cdC8vIFx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5tb2RlbCwgXCJjb2xsYXBzZWQ6Y2hhbmdlXCIsIGZ1bmN0aW9uKGNvbGxhcHNlZCl7XG5cdC8vXG5cdC8vIFx0XHR9KTtcblx0Ly8gXHR9XG5cdC8vIH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0Lyoga2V5d29yZCBjb2xsZWN0aW9uIGNoYW5nZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uS2V5d29yZFNlbGVjdDogZnVuY3Rpb24oa2V5d29yZCkge1xuXHRcdC8vIHVzZSBjb2xsZWN0aW9uIGxpc3RlbmVyIHRvIGF2b2lkIHJlZHVuZGFudCByZWZyZXNoIGNhbGxzXG5cdFx0dGhpcy5idW5kbGVMaXN0LnJlZnJlc2goKTtcblx0XHRpZiAoIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpICYmIHRoaXMuZ3JhcGgpIHtcblx0XHRcdHRoaXMubGlzdGVuVG9PbmNlKHRoaXMuYnVuZGxlTGlzdCwgXCJ2aWV3OnJlbmRlcjphZnRlclwiLCBmdW5jdGlvbih2aWV3LCBmbGFncykge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25LZXl3b3JkU2VsZWN0IC0+ICVzOlt2aWV3OnJlbmRlcjphZnRlcl0gZmxhZ3M6JXNcIiwgdGhpcy5jaWQsIHZpZXcuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpKTtcblx0XHRcdFx0dGhpcy5ncmFwaC52YWx1ZVRvKDAsIDAsIFwiYW1vdW50XCIpO1xuXHRcdFx0XHQvLyB0aGlzLmdyYXBoLnJlbmRlck5vdygpO1xuXHRcdFx0XHR0aGlzLmdyYXBoLnZhbHVlVG8oMSwgR2xvYmFscy5UUkFOU0lUSU9OX0RVUkFUSU9OLCBcImFtb3VudFwiKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBVSSBFdmVudHM6IGJ1bmRsZUxpc3Qga2V5d29yZExpc3QgYnV0dG9uc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25OYXZpZ2F0aW9uQ2xpY2s6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0aWYgKCFldi5kZWZhdWx0UHJldmVudGVkICYmIHRoaXMubW9kZWwuaGFzKFwiYnVuZGxlXCIpKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25OYXZpZ2F0aW9uQ2xpY2sgWyVzXVwiLCB0aGlzLmNpZCwgZXYudHlwZSk7IC8vLCBldi50YXJnZXQpO1xuXHRcdFx0ZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdC8vIHRoaXMubW9kZWwuc2V0KFwiY29sbGFwc2VkXCIsICF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSk7XG5cdFx0XHR0aGlzLl9zZXRDb2xsYXBzZWQoIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKTtcblx0XHR9XG5cdH0sXG5cblx0X29uQXJ0aWNsZUNsaWNrOiBmdW5jdGlvbihpdGVtKSB7XG5cdFx0c3dpdGNoICh0aGlzLm1vZGVsLmdldChcInJvdXRlTmFtZVwiKSkge1xuXHRcdFx0Y2FzZSBcImFydGljbGUtaXRlbVwiOlxuXHRcdFx0XHRjb250cm9sbGVyLmRlc2VsZWN0QXJ0aWNsZSgpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJyb290XCI6XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRjb250cm9sbGVyLnNlbGVjdEFydGljbGUoaXRlbSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSxcblxuXHRfb25TaXRlbmFtZUNsaWNrOiBmdW5jdGlvbigpIHtcblx0XHRzd2l0Y2ggKHRoaXMubW9kZWwuZ2V0KFwicm91dGVOYW1lXCIpKSB7XG5cdFx0XHRjYXNlIFwibWVkaWEtaXRlbVwiOlxuXHRcdFx0Y2FzZSBcImJ1bmRsZS1pdGVtXCI6XG5cdFx0XHRcdGlmICh0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0XHRcdHRoaXMuX3NldENvbGxhcHNlZChmYWxzZSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Y29udHJvbGxlci5kZXNlbGVjdEJ1bmRsZSgpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcImFydGljbGUtaXRlbVwiOlxuXHRcdFx0XHRjb250cm9sbGVyLmRlc2VsZWN0QXJ0aWNsZSgpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH0sXG5cblx0X29uQnVuZGxlTGlzdFNhbWU6IGZ1bmN0aW9uKGJ1bmRsZSkge1xuXHRcdHRoaXMuX3NldENvbGxhcHNlZCghdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpO1xuXHR9LFxuXG5cdF9vbktleXdvcmRMaXN0Q2hhbmdlOiBmdW5jdGlvbihrZXl3b3JkKSB7XG5cdFx0aWYgKCF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0a2V5d29yZHMuc2VsZWN0KGtleXdvcmQpO1xuXHRcdH1cblx0fSxcblxuXHRfc2V0Q29sbGFwc2VkOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdGlmICh2YWx1ZSAhPT0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHRcdHRoaXMudHJhbnNmb3Jtcy5vZmZzZXQoMCwgMSwgdGhpcy5ncmFwaC5lbCk7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0XHRcdHRoaXMuc2V0SW1tZWRpYXRlKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfc2V0Q29sbGFwc2VkIC0+ICVzIChzZXRJbW1lZGlhdGUpXCIsIHRoaXMuY2lkLCB2YWx1ZSk7XG5cdFx0XHRcdHRoaXMubW9kZWwuc2V0KFwiY29sbGFwc2VkXCIsIHZhbHVlKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIEhvcml6b250YWwgdG91Y2gvbW92ZSAoSGFtbWVySlMpXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25IUGFuU3RhcnQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLmdldCh0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpXG5cdFx0XHQuc3RvcFRyYW5zaXRpb24oKVxuXHRcdFx0LmNsZWFyT2Zmc2V0KClcblx0XHRcdC52YWxpZGF0ZSgpO1xuXHRcdC8vIGlmICh0aGlzLm1vZGVsLmdldChcImxheW91dE5hbWVcIikgIT0gXCJsZWZ0LWxheW91dFwiXG5cdFx0Ly8gXHQmJiB0aGlzLm1vZGVsLmdldChcImxheW91dE5hbWVcIikgIT0gXCJkZWZhdWx0LWxheW91dFwiKSB7XG5cdFx0Ly8gXHRyZXR1cm47XG5cdFx0Ly8gfVxuXHRcdGlmIChHbG9iYWxzLkJSRUFLUE9JTlRTW1wiZGVza3RvcC1zbWFsbFwiXS5tYXRjaGVzXG5cdFx0XHQmJiB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKS5nZXQoXCJtZWRpYVwiKS5zZWxlY3RlZEluZGV4IDw9IDBcblx0XHRcdCYmIHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcikuY2xlYXJDYXB0dXJlKCk7XG5cdFx0XHR0aGlzLl9vbkhQYW5Nb3ZlKGV2KTtcblxuXHRcdFx0dGhpcy5ocGFuLm9uKFwiaHBhbm1vdmVcIiwgdGhpcy5fb25IUGFuTW92ZSk7XG5cdFx0XHR0aGlzLmhwYW4ub24oXCJocGFuZW5kIGhwYW5jYW5jZWxcIiwgdGhpcy5fb25IUGFuRmluYWwpO1xuXHRcdH1cblx0fSxcblxuXHRfb25IUGFuTW92ZTogZnVuY3Rpb24oZXYpIHtcblx0XHQvLyB2YXIgSFBBTl9EUkFHID0gMTtcblx0XHQvLyB2YXIgSFBBTl9EUkFHID0gMC43NTtcblx0XHR2YXIgSFBBTl9EUkFHID0gNzIwIC8gOTIwO1xuXHRcdHZhciBkZWx0YSA9IGV2LmRlbHRhWDsgLy9ldi50aHJlc2hvbGREZWx0YVg7XG5cdFx0Ly8gdmFyIG1lZGlhSXRlbXMgPSB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKS5nZXQoXCJtZWRpYVwiKTtcblxuXHRcdGlmICh0aGlzLm1vZGVsLmdldChcIndpdGhNZWRpYVwiKSkge1xuXHRcdFx0Ly8gaWYgKHRoaXMubW9kZWwuZ2V0KFwid2l0aE1lZGlhXCIpIF4gKHRoaXMuX3JlbmRlckZsYWdzICYgVmlldy5NT0RFTF9JTlZBTElEKSkge1xuXHRcdFx0Ly8gaWYgKG1lZGlhSXRlbXMuc2VsZWN0ZWQgIT09IG51bGwpIHtcblx0XHRcdGRlbHRhICo9IChldi5vZmZzZXREaXJlY3Rpb24gJiBIYW1tZXIuRElSRUNUSU9OX0xFRlQpID9cblx0XHRcdFx0MC4wIDogSFBBTl9EUkFHO1xuXHRcdFx0Ly8gaWYgKGJ1bmRsZXMuc2VsZWN0ZWQuZ2V0KFwibWVkaWFcIikuc2VsZWN0ZWRJbmRleCA9PSAtMSkge1xuXHRcdH0gZWxzZSB7IC8vaWYgKG1lZGlhLnNlbGVjdGVkSW5kZXggPT0gMCkge1xuXHRcdFx0ZGVsdGEgKj0gKGV2Lm9mZnNldERpcmVjdGlvbiAmIEhhbW1lci5ESVJFQ1RJT05fTEVGVCkgP1xuXHRcdFx0XHRIUEFOX0RSQUcgOiBHbG9iYWxzLkhQQU5fT1VUX0RSQUc7XG5cdFx0fVxuXHRcdHRoaXMudHJhbnNmb3Jtcy5vZmZzZXQoZGVsdGEsIHZvaWQgMCwgdGhpcy5rZXl3b3JkTGlzdC53cmFwcGVyKTtcblx0XHR0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0fSxcblxuXHRfb25IUGFuRmluYWw6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy5ocGFuLm9mZihcImhwYW5tb3ZlXCIsIHRoaXMuX29uSFBhbk1vdmUpO1xuXHRcdHRoaXMuaHBhbi5vZmYoXCJocGFuZW5kIGhwYW5jYW5jZWxcIiwgdGhpcy5fb25IUGFuRmluYWwpO1xuXG5cdFx0LyogTk9URTogaWYgdGhlcmUgaXMgbm8gbW9kZWwgY2hhbmdlLCBzZXQgdHggaGVyZS4gT3RoZXJ3aXNlIGp1c3Qgd2FpdCBmb3IgcmVuZGVyICovXG5cdFx0dmFyIGtUZiA9IHRoaXMudHJhbnNmb3Jtcy5nZXQodGhpcy5rZXl3b3JkTGlzdC53cmFwcGVyKTtcblx0XHRpZiAoISh0aGlzLl9yZW5kZXJGbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkgJiYga1RmLmhhc09mZnNldCkge1xuXHRcdFx0aWYgKGtUZi5vZmZzZXRYICE9IDApIHtcblx0XHRcdFx0a1RmLnJ1blRyYW5zaXRpb24odHguTk9XKTtcblx0XHRcdH1cblx0XHRcdGtUZi5jbGVhck9mZnNldCgpLnZhbGlkYXRlKCk7XG5cdFx0XHQvLyBrVGYuY2xlYXJPZmZzZXQoKS5ydW5UcmFuc2l0aW9uKHR4Lk5PVykudmFsaWRhdGUoKTtcblx0XHRcdC8vIHRoaXMudHJhbnNmb3Jtcy5jbGVhck9mZnNldCh0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpO1xuXHRcdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLnJ1blRyYW5zaXRpb24odHguTk9XLCB0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpO1xuXHRcdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogVmVydGljYWwgdG91Y2gvbW92ZSAoX29uVlBhbiopXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfY29sbGFwc2VkT2Zmc2V0WTogR2xvYmFscy5DT0xMQVBTRV9PRkZTRVQsXG5cblx0X29uVlBhblN0YXJ0OiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMudnBhbi5vbihcInZwYW5tb3ZlXCIsIHRoaXMuX29uVlBhbk1vdmUpO1xuXHRcdHRoaXMudnBhbi5vbihcInZwYW5lbmQgdnBhbmNhbmNlbFwiLCB0aGlzLl9vblZQYW5GaW5hbCk7XG5cblx0XHR0aGlzLnRyYW5zZm9ybXMuc3RvcFRyYW5zaXRpb24odGhpcy5idW5kbGVMaXN0LmVsLCB0aGlzLmtleXdvcmRMaXN0LmVsKTsgLy8sIHRoaXMuZ3JhcGguZWwpO1xuXHRcdC8vIHRoaXMudHJhbnNmb3Jtcy5jbGVhck9mZnNldCh0aGlzLmJ1bmRsZUxpc3QuZWwsIHRoaXMua2V5d29yZExpc3QuZWwpO1xuXHRcdC8vIHRoaXMudHJhbnNmb3Jtcy52YWxpZGF0ZSgpO1xuXHRcdHRoaXMudHJhbnNmb3Jtcy5jbGVhckNhcHR1cmUodGhpcy5idW5kbGVMaXN0LmVsLCB0aGlzLmtleXdvcmRMaXN0LmVsKTsgLy8sIHRoaXMuZ3JhcGguZWwpO1xuXG5cdFx0aWYgKCF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLnN0b3BUcmFuc2l0aW9uKHRoaXMuZ3JhcGguZWwpO1xuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLmNsZWFyQ2FwdHVyZSh0aGlzLmdyYXBoLmVsKTtcblx0XHR9XG5cdFx0Ly8gdGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwiY29udGFpbmVyLWNoYW5naW5nXCIpO1xuXHRcdHRoaXMuX29uVlBhbk1vdmUoZXYpO1xuXHR9LFxuXG5cdF9vblZQYW5Nb3ZlOiBmdW5jdGlvbihldikge1xuXHRcdHZhciBjb2xsYXBzZWQgPSB0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKTtcblx0XHR2YXIgZGVsdGEgPSBldi5kZWx0YVk7IC8vZXYudGhyZXNob2xkRGVsdGFZO1xuXHRcdHZhciBtYXhEZWx0YSA9IHRoaXMuX2NvbGxhcHNlZE9mZnNldFk7IC8vICsgTWF0aC5hYnMoZXYudGhyZXNob2xkT2Zmc2V0WSk7XG5cblx0XHQvLyBjaGVjayBpZiBkaXJlY3Rpb24gaXMgYWxpZ25lZCB3aXRoIGNvbGxhcHNlZC9leHBhbmRcblx0XHR2YXIgaXNWYWxpZERpciA9IGNvbGxhcHNlZCA/IChkZWx0YSA+IDApIDogKGRlbHRhIDwgMCk7XG5cdFx0dmFyIG1vdmVGYWN0b3IgPSBjb2xsYXBzZWQgPyAxIC0gR2xvYmFscy5WUEFOX0RSQUcgOiBHbG9iYWxzLlZQQU5fRFJBRztcblxuXHRcdGRlbHRhID0gTWF0aC5hYnMoZGVsdGEpOyAvLyByZW1vdmUgc2lnblxuXHRcdGRlbHRhICo9IG1vdmVGYWN0b3I7XG5cdFx0bWF4RGVsdGEgKj0gbW92ZUZhY3RvcjtcblxuXHRcdGlmIChpc1ZhbGlkRGlyKSB7XG5cdFx0XHRpZiAoZGVsdGEgPiBtYXhEZWx0YSkgeyAvLyBvdmVyc2hvb3Rpbmdcblx0XHRcdFx0ZGVsdGEgPSAoKGRlbHRhIC0gbWF4RGVsdGEpICogR2xvYmFscy5WUEFOX09VVF9EUkFHKSArIG1heERlbHRhO1xuXHRcdFx0fSBlbHNlIHsgLy8gbm8gb3ZlcnNob290aW5nXG5cdFx0XHRcdC8vIGRlbHRhID0gZGVsdGE7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGRlbHRhID0gKC1kZWx0YSkgKiBHbG9iYWxzLlZQQU5fT1VUX0RSQUc7IC8vIGRlbHRhIGlzIG9wcG9zaXRlXG5cdFx0fVxuXHRcdGRlbHRhICo9IGNvbGxhcHNlZCA/IDAuNSA6IC0xOyAvLyByZWFwcGx5IHNpZ25cblxuXHRcdHRoaXMudHJhbnNmb3Jtcy5vZmZzZXQoMCwgZGVsdGEsIHRoaXMuYnVuZGxlTGlzdC5lbCwgdGhpcy5rZXl3b3JkTGlzdC5lbCk7IC8vLCB0aGlzLmdyYXBoLmVsKTtcblx0XHRpZiAoIWNvbGxhcHNlZClcblx0XHRcdHRoaXMudHJhbnNmb3Jtcy5vZmZzZXQoMCwgZGVsdGEsIHRoaXMuZ3JhcGguZWwpXG5cdFx0dGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdH0sXG5cblx0X29uVlBhbkZpbmFsOiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMudnBhbi5vZmYoXCJ2cGFubW92ZVwiLCB0aGlzLl9vblZQYW5Nb3ZlKTtcblx0XHR0aGlzLnZwYW4ub2ZmKFwidnBhbmVuZCB2cGFuY2FuY2VsXCIsIHRoaXMuX29uVlBhbkZpbmFsKTtcblxuXHRcdHRoaXMuX29uVlBhbk1vdmUoZXYpO1xuXHRcdHRoaXMuc2V0SW1tZWRpYXRlKGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKHRoaXMud2lsbENvbGxhcHNlZENoYW5nZShldikpIHtcblx0XHRcdFx0dGhpcy5tb2RlbC5zZXQoXCJjb2xsYXBzZWRcIiwgIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LkxBWU9VVF9JTlZBTElEKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fSxcblxuXHR3aWxsQ29sbGFwc2VkQ2hhbmdlOiBmdW5jdGlvbihldikge1xuXHRcdHJldHVybiBldi50eXBlID09IFwidnBhbmVuZFwiID8gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikgP1xuXHRcdFx0ZXYuZGVsdGFZID4gR2xvYmFscy5DT0xMQVBTRV9USFJFU0hPTEQgOlxuXHRcdFx0ZXYuZGVsdGFZIDwgLUdsb2JhbHMuQ09MTEFQU0VfVEhSRVNIT0xEIDpcblx0XHRcdGZhbHNlO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogQ29tcG9uZW50c1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Y3JlYXRlU2l0ZW5hbWVCdXR0b246IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB2aWV3ID0gbmV3IFZpZXcoe1xuXHRcdFx0ZWw6IFwiI3NpdGUtbmFtZVwiLFxuXHRcdFx0ZXZlbnRzOiB7XG5cdFx0XHRcdFwiY2xpY2sgYVwiOiBmdW5jdGlvbihkb21ldikge1xuXHRcdFx0XHRcdGRvbWV2LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZG9tZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OmNsaWNrXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh2aWV3LCBcInZpZXc6Y2xpY2tcIiwgdGhpcy5fb25TaXRlbmFtZUNsaWNrKTtcblx0XHR2aWV3LndyYXBwZXIgPSB2aWV3LmVsLnBhcmVudEVsZW1lbnQ7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0Y3JlYXRlQXJ0aWNsZUJ1dHRvbjogZnVuY3Rpb24oYXJ0aWNsZUl0ZW0pIHtcblx0XHR2YXIgdmlldyA9IG5ldyBBcnRpY2xlQnV0dG9uKHtcblx0XHRcdGVsOiBcIi5hcnRpY2xlLWJ1dHRvbltkYXRhLWhhbmRsZT0nYWJvdXQnXVwiLFxuXHRcdFx0bW9kZWw6IGFydGljbGVJdGVtXG5cdFx0fSkucmVuZGVyKCk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh2aWV3LCBcInZpZXc6Y2xpY2tcIiwgdGhpcy5fb25BcnRpY2xlQ2xpY2spO1xuXHRcdHZpZXcud3JhcHBlciA9IHZpZXcuZWwucGFyZW50RWxlbWVudDtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvLyBjcmVhdGVBcnRpY2xlQnV0dG9uMjogZnVuY3Rpb24oYXJ0aWNsZUl0ZW0pIHtcblx0Ly8gXHR2YXIgdmlldyA9IG5ldyBWaWV3KHtcblx0Ly8gXHRcdGVsOiBcIiNhYm91dFwiLFxuXHQvLyBcdFx0Y2xhc3NOYW1lOiBcImFydGljbGUtYnV0dG9uXCIsXG5cdC8vIFx0XHQvLyB0YWc6IFwiaDJcIixcblx0Ly8gXHRcdG1vZGVsOiBhcnRpY2xlSXRlbSxcblx0Ly8gXHR9KTtcblx0Ly8gXHQvLyB0aGlzLmxpc3RlblRvKHZpZXcsIFwidmlldzpjbGlja1wiLCB0aGlzLl9vbkFib3V0Q2xpY2spO1xuXHQvLyBcdHZpZXcubGFiZWwgPSB2aWV3LmVsLnF1ZXJ5U2VsZWN0b3IoXCJhXCIpO1xuXHQvLyBcdHZpZXcubGFiZWwuaW5uZXJIVE1MID0gYXJ0aWNsZUl0ZW0uZ2V0KFwibmFtZVwiKTtcblx0Ly8gXHR2aWV3LndyYXBwZXIgPSB2aWV3LmVsLnBhcmVudEVsZW1lbnQ7XG5cdC8vIFx0cmV0dXJuIHZpZXc7XG5cdC8vIH0sXG5cblx0LyoqXG5cdCAqIGJ1bmRsZS1saXN0XG5cdCAqL1xuXHRjcmVhdGVCdW5kbGVMaXN0OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBGaWx0ZXJhYmxlTGlzdFZpZXcoe1xuXHRcdFx0ZWw6IFwiI2J1bmRsZS1saXN0XCIsXG5cdFx0XHRjb2xsZWN0aW9uOiBidW5kbGVzLFxuXHRcdFx0Y29sbGFwc2VkOiBmYWxzZSxcblx0XHRcdGZpbHRlckZuOiBmdW5jdGlvbihidW5kbGUsIGluZGV4LCBhcnIpIHtcblx0XHRcdFx0cmV0dXJuIGtleXdvcmRzLnNlbGVjdGVkID9cblx0XHRcdFx0XHRidW5kbGUuZ2V0KFwia0lkc1wiKS5pbmRleE9mKGtleXdvcmRzLnNlbGVjdGVkLmlkKSAhPT0gLTEgOiBmYWxzZTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cdFx0Y29udHJvbGxlci5saXN0ZW5Ubyh2aWV3LCB7XG5cdFx0XHRcInZpZXc6c2VsZWN0Om9uZVwiOiBjb250cm9sbGVyLnNlbGVjdEJ1bmRsZSxcblx0XHRcdFwidmlldzpzZWxlY3Q6bm9uZVwiOiBjb250cm9sbGVyLmRlc2VsZWN0QnVuZGxlXG5cdFx0fSk7XG5cdFx0Ly8gdmlldy5saXN0ZW5UbyhidW5kbGVzLCBcInNlbGVjdDpvbmUgc2VsZWN0Om5vbmVcIiwgZnVuY3Rpb24oaXRlbSkge1xuXHRcdC8vIFx0dmlldy5zZWxlY3RlZEl0ZW0gPSBpdGVtO1xuXHRcdC8vIH0pO1xuXHRcdHRoaXMubGlzdGVuVG8odmlldywgXCJ2aWV3OnNlbGVjdDpzYW1lXCIsIHRoaXMuX29uQnVuZGxlTGlzdFNhbWUpO1xuXHRcdHRoaXMubGlzdGVuVG8oa2V5d29yZHMsIFwic2VsZWN0Om9uZSBzZWxlY3Q6bm9uZVwiLCB0aGlzLl9vbktleXdvcmRTZWxlY3QpO1xuXHRcdHZpZXcud3JhcHBlciA9IHZpZXcuZWwucGFyZW50RWxlbWVudDtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvKipcblx0ICoga2V5d29yZC1saXN0XG5cdCAqL1xuXHRjcmVhdGVLZXl3b3JkTGlzdDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgR3JvdXBpbmdMaXN0Vmlldyh7XG5cdFx0XHRlbDogXCIja2V5d29yZC1saXN0XCIsXG5cdFx0XHRjb2xsZWN0aW9uOiBrZXl3b3Jkcyxcblx0XHRcdGNvbGxhcHNlZDogZmFsc2UsXG5cdFx0XHRmaWx0ZXJGbjogZnVuY3Rpb24oaXRlbSwgaWR4LCBhcnIpIHtcblx0XHRcdFx0Ly8gcmV0dXJuICEhKGl0ZW0uZ2V0KFwiYnVuZGxlXCIpLnNlbGVjdGVkKTtcblx0XHRcdFx0cmV0dXJuIGJ1bmRsZXMuc2VsZWN0ZWQgP1xuXHRcdFx0XHRcdChidW5kbGVzLnNlbGVjdGVkLmdldChcImtJZHNcIikuaW5kZXhPZihpdGVtLmlkKSAhPT0gLTEpIDogZmFsc2U7XG5cdFx0XHR9LFxuXHRcdFx0Z3JvdXBpbmdGbjogZnVuY3Rpb24oaXRlbSwgaWR4LCBhcnIpIHtcblx0XHRcdFx0Ly8gcmV0dXJuIGl0ZW0uZ2V0KFwidHlwZVwiKTtcblx0XHRcdFx0cmV0dXJuIHR5cGVzLmdldChpdGVtLmdldChcInRJZFwiKSk7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHRcdHZpZXcubGlzdGVuVG8oa2V5d29yZHMsIFwic2VsZWN0Om9uZSBzZWxlY3Q6bm9uZVwiLCBmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHR2aWV3LnNlbGVjdGVkSXRlbSA9IGl0ZW07XG5cdFx0fSk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh2aWV3LCBcInZpZXc6c2VsZWN0Om9uZSB2aWV3OnNlbGVjdDpub25lXCIsIHRoaXMuX29uS2V5d29yZExpc3RDaGFuZ2UpO1xuXHRcdHZpZXcud3JhcHBlciA9IHZpZXcuZWwucGFyZW50RWxlbWVudDtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvKipcblx0ICogbmF2LWdyYXBoXG5cdCAqL1xuXHRjcmVhdGVHcmFwaFZpZXc6IGZ1bmN0aW9uKGxpc3RBLCBsaXN0Qikge1xuXHRcdHZhciB2aWV3ID0gbmV3IEdyYXBoVmlldyh7XG5cdFx0XHRpZDogXCJuYXYtZ3JhcGhcIixcblx0XHRcdGxpc3RBOiBsaXN0QSxcblx0XHRcdGxpc3RCOiBsaXN0Qixcblx0XHRcdG1vZGVsOiB0aGlzLm1vZGVsLFxuXHRcdFx0dXNlT3BhcXVlOiBmYWxzZVxuXHRcdH0pO1xuXHRcdC8vIHRoaXMuZWwuYXBwZW5kQ2hpbGQodmlldy5lbCk7XG5cdFx0dGhpcy5lbC5pbnNlcnRCZWZvcmUodmlldy5lbCwgdGhpcy5lbC5maXJzdEVsZW1lbnRDaGlsZCk7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBIb3Jpem9udGFsIHRvdWNoL21vdmUgKE11dGF0aW9uT2JzZXJ2ZXIpXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKlxuXHRfYmVnaW5UcmFuc2Zvcm1PYnNlcnZlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoIShHbG9iYWxzLkJSRUFLUE9JTlRTW1wiZGVza3RvcC1zbWFsbFwiXS5tYXRjaGVzICYmIHRoaXMubW9kZWwuZ2V0KFwiYnVuZGxlXCIpLmdldChcIm1lZGlhXCIpLnNlbGVjdGVkSW5kZXggPD0gMCAmJiB0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dmFyIHRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2Fyb3VzZWwgPiAuZW1wdHktaXRlbVwiKTtcblx0XHRpZiAodGFyZ2V0ID09PSBudWxsKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGlmICghdGhpcy5fdHJhbnNmb3JtT2JzZXJ2ZXIpIHtcblx0XHRcdHRoaXMuX3RyYW5zZm9ybU9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIodGhpcy5fb25UcmFuc2Zvcm1NdXRhdGlvbik7XG5cdFx0fVxuXHRcdHRoaXMuX3RyYW5zZm9ybU9ic2VydmVyLm9ic2VydmUodGFyZ2V0LCB7IGF0dHJpYnV0ZXM6IHRydWUsIGF0dHJpYnV0ZUZpbHRlcjogW1wic3R5bGVcIl0gfSk7XG5cdFx0dGhpcy5ocGFuLm9uKFwiaHBhbmVuZCBocGFuY2FuY2VsXCIsIHRoaXMuX2VuZFRyYW5zZm9ybU9ic2VydmUpO1xuXHRcdHRoaXMudHJhbnNmb3Jtcy5nZXQodGhpcy5rZXl3b3JkTGlzdC53cmFwcGVyKVxuXHRcdFx0LnN0b3BUcmFuc2l0aW9uKClcblx0XHRcdC5jbGVhck9mZnNldCgpXG5cdFx0XHQuY2xlYXJDYXB0dXJlKClcblx0XHRcdC52YWxpZGF0ZSgpO1xuXHR9LFxuXG5cdF9lbmRUcmFuc2Zvcm1PYnNlcnZlOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl90cmFuc2Zvcm1PYnNlcnZlci5kaXNjb25uZWN0KCk7XG5cdFx0dGhpcy5ocGFuLm9mZihcImhwYW5lbmQgaHBhbmNhbmNlbFwiLCB0aGlzLl9lbmRUcmFuc2Zvcm1PYnNlcnZlKTtcblx0XHR0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcilcblx0XHRcdC5jbGVhck9mZnNldCgpXG5cdFx0XHQucnVuVHJhbnNpdGlvbih0eC5OT1cpXG5cdFx0XHQudmFsaWRhdGUoKTtcblx0fSxcblxuXHRfb25UcmFuc2Zvcm1NdXRhdGlvbjogZnVuY3Rpb24obXV0YXRpb25zKSB7XG5cdFx0dmFyIHRWaWV3LCB0TWV0cmljcywgdENzcywgZFR4T2JqLCBwb3M7XG5cblx0XHQvLyB0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIuc3R5bGVbcHJlZml4ZWRQcm9wZXJ0eShcInRyYW5zZm9ybVwiKV07XG5cdFx0Ly8gdHJhbnNmb3JtID0gbXV0YXRpb25zWzBdLnRhcmdldC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKHByZWZpeGVkUHJvcGVydHkoXCJ0cmFuc2Zvcm1cIikpO1xuXG5cdFx0dFZpZXcgPSBWaWV3LmZpbmRCeUVsZW1lbnQobXV0YXRpb25zWzBdLnRhcmdldCk7XG5cdFx0aWYgKHRWaWV3KSB7XG5cdFx0XHR0TWV0cmljcyA9IHRWaWV3Lm1ldHJpY3M7XG5cdFx0XHRkVHhPYmogPSB0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcik7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25UcmFuc2Zvcm1NdXRhdGlvbiBbd2l0aE1lZGlhOiAlc10gdGFyZ2V0OiAoJWZcXCslZikgJWYgd3JhcHBlcjogKCVmKSAlZlwiLCB0aGlzLmNpZCxcblx0XHRcdFx0dGhpcy5tb2RlbC5oYXMoXCJtZWRpYVwiKSxcblx0XHRcdFx0dE1ldHJpY3MudHJhbnNsYXRlWCwgdE1ldHJpY3Mud2lkdGgsIHRNZXRyaWNzLnRyYW5zbGF0ZVggKyB0TWV0cmljcy53aWR0aCxcblx0XHRcdFx0ZFR4T2JqLmNhcHR1cmVkWCwgdE1ldHJpY3MudHJhbnNsYXRlWCAtIGRUeE9iai5jYXB0dXJlZFgsXG5cdFx0XHRcdHRNZXRyaWNzXG5cdFx0XHQpO1xuXG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMub2Zmc2V0KHRNZXRyaWNzLnRyYW5zbGF0ZVggLSBkVHhPYmouY2FwdHVyZWRYLCB2b2lkIDAsIHRoaXMua2V5d29yZExpc3Qud3JhcHBlcik7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0XHR9XG5cdH0sXG5cdCovXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBOYXZpZ2F0aW9uVmlldzsiLCIvKiBnbG9iYWwgUGF0aDJEICovXG4vKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL0NhbnZhc1ZpZXdcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmNvbG9yfSAqL1xuLy8gdmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvSW50ZXJwb2xhdG9yfSAqL1xudmFyIEludGVycG9sYXRvciA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL0ludGVycG9sYXRvclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL2Nzcy9nZXRCb3hFZGdlU3R5bGVzfSAqL1xudmFyIGdldEJveEVkZ2VTdHlsZXMgPSByZXF1aXJlKFwidXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXNcIik7XG5cbnZhciBNSU5fQ0FOVkFTX1JBVElPID0gMTsgLy8gL0ZpcmVmb3gvLnRlc3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpPyAyIDogMTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL0NhbnZhc1ZpZXd9XG4gKi9cbnZhciBDYW52YXNWaWV3ID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwiY2FudmFzVmlld1wiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0dGFnTmFtZTogXCJjYW52YXNcIixcblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNsYXNzTmFtZTogXCJjYW52YXMtdmlld1wiLFxuXG5cdHByb3BlcnRpZXM6IHtcblx0XHRjb250ZXh0OiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY3R4O1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0aW50ZXJwb2xhdG9yOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5faW50ZXJwb2xhdG9yO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Y2FudmFzUmF0aW86IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9jYW52YXNSYXRpbztcblx0XHRcdH1cblx0XHR9LFxuXHR9LFxuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdHZhbHVlczoge1xuXHRcdFx0dmFsdWU6IDBcblx0XHR9LFxuXHRcdG1heFZhbHVlczoge1xuXHRcdFx0dmFsdWU6IDFcblx0XHR9LFxuXHRcdHVzZU9wYXF1ZTogdHJ1ZSxcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBjaGlsZHJlbi9sYXlvdXRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0Ly8gVE9ETzogY2xlYW51cCB0aGlzIG9wdGlvbnMgbWVzc1xuXHRcdG9wdGlvbnMgPSBfLmRlZmF1bHRzKG9wdGlvbnMsIHRoaXMuZGVmYXVsdHMpO1xuXHRcdG9wdGlvbnMudmFsdWVzID0gXy5kZWZhdWx0cyhvcHRpb25zLnZhbHVlcywgdGhpcy5kZWZhdWx0cy52YWx1ZXMpO1xuXHRcdG9wdGlvbnMubWF4VmFsdWVzID0gXy5kZWZhdWx0cyhvcHRpb25zLm1heFZhbHVlcywgdGhpcy5kZWZhdWx0cy5tYXhWYWx1ZXMpO1xuXG5cdFx0dGhpcy5faW50ZXJwb2xhdG9yID0gbmV3IEludGVycG9sYXRvcihvcHRpb25zLnZhbHVlcywgb3B0aW9ucy5tYXhWYWx1ZXMpO1xuXHRcdHRoaXMuX3VzZU9wYXF1ZSA9IG9wdGlvbnMudXNlT3BhcXVlO1xuXHRcdHRoaXMuX29wdGlvbnMgPSBfLnBpY2sob3B0aW9ucywgXCJjb2xvclwiLCBcImJhY2tncm91bmRDb2xvclwiKTtcblxuXHRcdC8vIG9wYXF1ZSBiYWNrZ3JvdW5kXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR2YXIgY3R4T3B0cyA9IHt9O1xuXHRcdC8vIGlmICh0aGlzLl91c2VPcGFxdWUpIHtcblx0XHQvLyBcdHRoaXMuX29wYXF1ZVByb3AgPSBNb2Rlcm5penIucHJlZml4ZWQoXCJvcGFxdWVcIiwgdGhpcy5lbCwgZmFsc2UpO1xuXHRcdC8vIFx0aWYgKHRoaXMuX29wYXF1ZVByb3ApIHtcblx0XHQvLyBcdFx0dGhpcy5lbFt0aGlzLl9vcGFxdWVQcm9wXSA9IHRydWU7XG5cdFx0Ly8gXHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRjdHhPcHRzLmFscGhhID0gdHJ1ZTtcblx0XHQvLyBcdH1cblx0XHQvLyBcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcImNvbG9yLWJnXCIpO1xuXHRcdC8vIH1cblxuXHRcdC8vIGNhbnZhcycgY29udGV4dCBpbml0XG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLl9jdHggPSB0aGlzLmVsLmdldENvbnRleHQoXCIyZFwiLCBjdHhPcHRzKTtcblxuXHRcdC8vIGFkanVzdCBjYW52YXMgc2l6ZSB0byBwaXhlbCByYXRpb1xuXHRcdC8vIHVwc2NhbGUgdGhlIGNhbnZhcyBpZiB0aGUgdHdvIHJhdGlvcyBkb24ndCBtYXRjaFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIHJhdGlvID0gTUlOX0NBTlZBU19SQVRJTztcblx0XHR2YXIgY3R4UmF0aW8gPSB0aGlzLl9jdHgud2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCAxO1xuXHRcdGlmICh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyAhPT0gY3R4UmF0aW8pIHtcblx0XHRcdC8vIHJhdGlvID0gTWF0aC5tYXgod2luZG93LmRldmljZVBpeGVsUmF0aW8gLyBjdHhSYXRpbywgTUlOX0NBTlZBU19SQVRJTyk7XG5cdFx0XHRyYXRpbyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIC8gY3R4UmF0aW87XG5cdFx0XHRyYXRpbyA9IE1hdGgubWF4KHJhdGlvLCBNSU5fQ0FOVkFTX1JBVElPKTtcblx0XHR9XG5cdFx0dGhpcy5fY2FudmFzUmF0aW8gPSByYXRpbztcblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjppbml0IGNhbnZhc1JhdGlvOiAlZlwiLCB0aGlzLmNpZCwgdGhpcy5fY2FudmFzUmF0aW8pO1xuXG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLCBcInZpZXc6YXR0YWNoZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyB0aGlzLmludmFsaWRhdGVTaXplKCk7XG5cdFx0XHQvLyB0aGlzLnJlbmRlck5vdygpO1xuXHRcdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCkucmVuZGVyTm93KCk7XG5cdFx0fSk7XG5cdH0sXG5cblx0Ly8gX2NvbXB1dGVDYW52YXNSYXRpbzogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dmFyIHJhdGlvID0gTUlOX0NBTlZBU19SQVRJTztcblx0Ly8gXHR2YXIgY3R4UmF0aW8gPSB0aGlzLl9jdHgud2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCAxO1xuXHQvLyBcdGlmICh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyAhPT0gY3R4UmF0aW8pIHtcblx0Ly8gXHRcdC8vIHJhdGlvID0gTWF0aC5tYXgod2luZG93LmRldmljZVBpeGVsUmF0aW8gLyBjdHhSYXRpbywgTUlOX0NBTlZBU19SQVRJTyk7XG5cdC8vIFx0XHRyYXRpbyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIC8gY3R4UmF0aW87XG5cdC8vIFx0XHRyYXRpbyA9IE1hdGgubWF4KHJhdGlvLCBNSU5fQ0FOVkFTX1JBVElPKTtcblx0Ly8gXHR9XG5cdC8vIFx0dGhpcy5fY2FudmFzUmF0aW8gPSByYXRpbztcblx0Ly8gfSxcblxuXHRfdXBkYXRlQ2FudmFzOiBmdW5jdGlvbigpIHtcblx0XHQvLyBhZGp1c3QgY2FudmFzIHNpemUgdG8gcGl4ZWwgcmF0aW9cblx0XHQvLyB1cHNjYWxlIHRoZSBjYW52YXMgaWYgdGhlIHR3byByYXRpb3MgZG9uJ3QgbWF0Y2hcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0dmFyIHMgPSBnZXRDb21wdXRlZFN0eWxlKHRoaXMuZWwpO1xuXG5cdFx0dGhpcy5fY2FudmFzV2lkdGggPSB0aGlzLmVsLm9mZnNldFdpZHRoO1xuXHRcdHRoaXMuX2NhbnZhc0hlaWdodCA9IHRoaXMuZWwub2Zmc2V0SGVpZ2h0O1xuXG5cdFx0aWYgKHMuYm94U2l6aW5nID09PSBcImJvcmRlci1ib3hcIikge1xuXHRcdFx0dmFyIG0gPSBnZXRCb3hFZGdlU3R5bGVzKHMpO1xuXHRcdFx0dGhpcy5fY2FudmFzV2lkdGggLT0gbS5wYWRkaW5nTGVmdCArIG0ucGFkZGluZ1JpZ2h0ICsgbS5ib3JkZXJMZWZ0V2lkdGggKyBtLmJvcmRlclJpZ2h0V2lkdGg7XG5cdFx0XHR0aGlzLl9jYW52YXNIZWlnaHQgLT0gbS5wYWRkaW5nVG9wICsgbS5wYWRkaW5nQm90dG9tICsgbS5ib3JkZXJUb3BXaWR0aCArIG0uYm9yZGVyQm90dG9tV2lkdGg7XG5cdFx0fVxuXG5cdFx0dGhpcy5fY2FudmFzV2lkdGggKj0gdGhpcy5fY2FudmFzUmF0aW87XG5cdFx0dGhpcy5fY2FudmFzSGVpZ2h0ICo9IHRoaXMuX2NhbnZhc1JhdGlvO1xuXG5cdFx0dGhpcy5tZWFzdXJlQ2FudmFzKHRoaXMuX2NhbnZhc1dpZHRoLCB0aGlzLl9jYW52YXNIZWlnaHQpO1xuXHRcdHRoaXMuZWwud2lkdGggPSB0aGlzLl9jYW52YXNXaWR0aDtcblx0XHR0aGlzLmVsLmhlaWdodCA9IHRoaXMuX2NhbnZhc0hlaWdodDtcblx0XHQvLyB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IGggKyBcInB4XCI7XG5cdFx0Ly8gdGhpcy5lbC5zdHlsZS53aWR0aCA9IHcgKyBcInB4XCI7XG5cblx0XHQvLyBjb2xvcnNcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuX2NvbG9yID0gdGhpcy5fb3B0aW9ucy5jb2xvciB8fFxuXHRcdFx0cy5jb2xvciB8fCBHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wiY29sb3JcIl07XG5cdFx0dGhpcy5fYmFja2dyb3VuZENvbG9yID0gdGhpcy5fb3B0aW9ucy5iYWNrZ3JvdW5kQ29sb3IgfHxcblx0XHRcdHMuYmFja2dyb3VuZENvbG9yIHx8IEdsb2JhbHMuREVGQVVMVF9DT0xPUlNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdO1xuXG5cdFx0Ly8gbW96T3BhcXVlXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRpZiAodGhpcy5fdXNlT3BhcXVlICYmIHRoaXMuX29wYXF1ZVByb3ApIHtcblx0XHRcdC8vIHRoaXMuZWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5fYmFja2dyb3VuZENvbG9yO1xuXHRcdFx0dGhpcy5lbFt0aGlzLl9vcGFxdWVQcm9wXSA9IHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gZm9udFNpemVcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuX2ZvbnRTaXplID0gcGFyc2VGbG9hdChzLmZvbnRTaXplKSAqIHRoaXMuX2NhbnZhc1JhdGlvO1xuXHRcdHRoaXMuX2ZvbnRGYW1pbHkgPSBzLmZvbnRGYW1pbHk7XG5cblx0XHQvLyBwcmVwYXJlIGNhbnZhcyBjb250ZXh0XG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXG5cdFx0dGhpcy5fY3R4LmZvbnQgPSBbcy5mb250V2VpZ2h0LCBzLmZvbnRTdHlsZSwgdGhpcy5fZm9udFNpemUgKyBcInB4LzFcIiwgcy5mb250RmFtaWx5XS5qb2luKFwiIFwiKTtcblx0XHR0aGlzLl9jdHgudGV4dEFsaWduID0gXCJsZWZ0XCI7XG5cdFx0dGhpcy5fY3R4LmxpbmVDYXAgPSBcImJ1dHRcIjtcblx0XHR0aGlzLl9jdHgubGluZUpvaW4gPSBcIm1pdGVyXCI7XG5cdFx0dGhpcy5fY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5fY29sb3I7XG5cdFx0dGhpcy5fY3R4LmZpbGxTdHlsZSA9IHRoaXMuX2NvbG9yO1xuXG5cdFx0dGhpcy51cGRhdGVDYW52YXModGhpcy5fY3R4KTtcblx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXG5cdFx0Ly8gY29uc29sZS5ncm91cCh0aGlzLmNpZCtcIjo6X3VwZGF0ZUNhbnZhc1wiKTtcblx0XHQvLyBjb25zb2xlLmxvZyhcInJhdGlvOiAgICAlZiAobWluOiAlZiwgZGV2aWNlOiAlZiwgY29udGV4dDogJXMpXCIsIHRoaXMuX2NhbnZhc1JhdGlvLCBNSU5fQ0FOVkFTX1JBVElPLCB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbywgdGhpcy5fY3R4LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwgXCIod2Via2l0LW9ubHkpXCIpO1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiY29sb3JzOiAgIGZnOiAlcyBiZzogJXNcIiwgdGhpcy5fY29sb3IsIHRoaXMuX2JhY2tncm91bmRDb2xvcik7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJzdHlsZTogICAgJXMsICVzLCBwYWRkaW5nOiAlcyAoJXMpXCIsIHMud2lkdGgsIHMuaGVpZ2h0LCBzLnBhZGRpbmcsIHMuYm94U2l6aW5nKTtcblx0XHQvLyBjb25zb2xlLmxvZyhcImJveDogICAgICAlZiB4ICVmIHB4XCIsIG0ud2lkdGgsIG0uaGVpZ2h0KTtcblx0XHQvLyBjb25zb2xlLmxvZyhcIm1lYXN1cmVkOiAlZiB4ICVmIHB4XCIsIHcsIGgpO1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiY2FudmFzOiAgICVmIHggJWYgcHhcIiwgdGhpcy5fY2FudmFzV2lkdGgsIHRoaXMuX2NhbnZhc0hlaWdodCk7XG5cdFx0Ly8gY29uc29sZS5ncm91cEVuZCgpO1xuXHR9LFxuXG5cdHVwZGF0ZUNhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0LyogYWJzdHJhY3QgKi9cblx0fSxcblxuXHRtZWFzdXJlQ2FudmFzOiBmdW5jdGlvbigpIHtcblx0XHQvKiBhYnN0cmFjdCAqL1xuXHR9LFxuXG5cdF9nZXRGb250TWV0cmljczogZnVuY3Rpb24oc3RyKSB7XG5cdFx0dmFyIGtleSwgaWR4LCBtT2JqLCBtSWR4ID0gc3RyLmxlbmd0aDtcblx0XHRmb3IgKGtleSBpbiBHbG9iYWxzLkZPTlRfTUVUUklDUykge1xuXHRcdFx0aWR4ID0gc3RyLmluZGV4T2Yoa2V5KTtcblx0XHRcdGlmIChpZHggIT09IC0xICYmIGlkeCA8IG1JZHgpIHtcblx0XHRcdFx0bUlkeCA9IGlkeDtcblx0XHRcdFx0bU9iaiA9IEdsb2JhbHMuRk9OVF9NRVRSSUNTW2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBtT2JqO1xuXHR9LFxuXG5cdF9jbGVhckNhbnZhczogZnVuY3Rpb24oeCwgeSwgdywgaCkge1xuXHRcdHRoaXMuX2N0eC5jbGVhclJlY3QoeCwgeSwgdywgaCk7XG5cdFx0aWYgKHRoaXMuX3VzZU9wYXF1ZSkge1xuXHRcdFx0dGhpcy5fY3R4LnNhdmUoKTtcblx0XHRcdHRoaXMuX2N0eC5maWxsU3R5bGUgPSB0aGlzLl9iYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHR0aGlzLl9jdHguZmlsbFJlY3QoeCwgeSwgdywgaCk7XG5cdFx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHRcdH1cblx0fSxcblxuXHRfc2V0U3R5bGU6IGZ1bmN0aW9uKHMpIHtcblx0XHRDYW52YXNWaWV3LnNldFN0eWxlKHRoaXMuX2N0eCwgcyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcmVuZGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5hdHRhY2hlZCkge1xuXHRcdFx0cmV0dXJuIHRoaXMucmVuZGVyTm93KCk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyRnJhbWU6IGZ1bmN0aW9uKHRzdGFtcCwgZmxhZ3MpIHtcblx0XHRpZiAoIXRoaXMuYXR0YWNoZWQpIHtcblx0XHRcdHJldHVybiBmbGFncztcblx0XHR9XG5cdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHtcblx0XHRcdHRoaXMuX3VwZGF0ZUNhbnZhcygpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5faW50ZXJwb2xhdG9yLnZhbHVlc0NoYW5nZWQpIHtcblx0XHRcdGZsYWdzIHw9IFZpZXcuTEFZT1VUX0lOVkFMSUQ7XG5cdFx0XHR0aGlzLl9pbnRlcnBvbGF0b3IuaW50ZXJwb2xhdGUodHN0YW1wKTtcblx0XHR9XG5cdFx0aWYgKGZsYWdzICYgKFZpZXcuTEFZT1VUX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRCkpIHtcblx0XHRcdHRoaXMucmVkcmF3KHRoaXMuX2N0eCwgdGhpcy5faW50ZXJwb2xhdG9yKTtcblx0XHRcdGlmICh0aGlzLl9pbnRlcnBvbGF0b3IudmFsdWVzQ2hhbmdlZCkge1xuXHRcdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcHVibGljXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGdldFZhbHVlOiBmdW5jdGlvbihrZXkpIHtcblx0XHRyZXR1cm4gdGhpcy5faW50ZXJwb2xhdG9yLmdldFZhbHVlKGtleSk7XG5cdH0sXG5cblx0Z2V0UmVuZGVyZWRWYWx1ZTogZnVuY3Rpb24oa2V5KSB7XG5cdFx0cmV0dXJuIHRoaXMuX2ludGVycG9sYXRvci5nZXRSZW5kZXJlZFZhbHVlKGtleSk7XG5cdH0sXG5cblx0dmFsdWVUbzogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBrZXkpIHtcblx0XHR0aGlzLl9pbnRlcnBvbGF0b3IudmFsdWVUbyh2YWx1ZSwgZHVyYXRpb24sIGtleSk7XG5cdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuTU9ERUxfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHR9LFxuXG5cdC8vIHVwZGF0ZVZhbHVlOiBmdW5jdGlvbihrZXkpIHtcblx0Ly8gXHRyZXR1cm4gdGhpcy5faW50ZXJwb2xhdG9yLnVwZGF0ZVZhbHVlKGtleSB8fCB0aGlzLmRlZmF1bHRLZXkpO1xuXHQvLyB9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHJlZHJhd1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZWRyYXc6IGZ1bmN0aW9uKGNvbnRleHQsIGNoYW5nZWQpIHt9LFxuXG59LCB7XG5cdHNldFN0eWxlOiBmdW5jdGlvbihjdHgsIHMpIHtcblx0XHRpZiAodHlwZW9mIHMgIT0gXCJvYmplY3RcIikgcmV0dXJuO1xuXHRcdGZvciAodmFyIHAgaW4gcykge1xuXHRcdFx0c3dpdGNoICh0eXBlb2YgY3R4W3BdKSB7XG5cdFx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkoc1twXSkpIGN0eFtwXS5hcHBseShjdHgsIHNbcF0pO1xuXHRcdFx0XHRcdGVsc2UgY3R4W3BdLmNhbGwoY3R4LCBzW3BdKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRjdHhbcF0gPSBzW3BdO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufSk7XG5cbmlmIChERUJVRykge1xuXHRDYW52YXNWaWV3LnByb3RvdHlwZS5fc2tpcExvZyA9IHRydWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQ2FudmFzVmlldzsiLCIvLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9zZXRJbW1lZGlhdGV9ICovXG4vLyB2YXIgc2V0SW1tZWRpYXRlID0gcmVxdWlyZShcInV0aWxzL3NldEltbWVkaWF0ZVwiKTtcblxuLy8gZnVuY3Rpb24gc29ydEJ5UHJpb3JpdHkoYSwgYikge1xuLy8gXHRpZiAoYS5wcmlvcml0eSA+IGIucHJpb3JpdHkpXG4vLyBcdFx0cmV0dXJuIDE7XG4vLyBcdGlmIChhLnByaW9yaXR5IDwgYi5wcmlvcml0eSlcbi8vIFx0XHRyZXR1cm4gLTE7XG4vLyBcdHJldHVybiAwO1xuLy8gfVxuXG5mdW5jdGlvbiBSZXF1ZXN0UXVldWUob2Zmc2V0KSB7XG5cdHRoaXMuX29mZnNldCA9IG9mZnNldCB8IDA7XG5cdHRoaXMuX2l0ZW1zID0gW107XG5cdHRoaXMuX3ByaW9yaXRpZXMgPSBbXTtcblx0dGhpcy5fbnVtSXRlbXMgPSAwO1xufVxuXG5SZXF1ZXN0UXVldWUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSh7XG5cdGVucXVldWU6IGZ1bmN0aW9uKGl0ZW0sIHByaW9yaXR5KSB7XG5cdFx0dmFyIGkgPSB0aGlzLl9pdGVtcy5sZW5ndGg7XG5cdFx0dGhpcy5faXRlbXNbaV0gPSBpdGVtO1xuXHRcdHRoaXMuX3ByaW9yaXRpZXNbaV0gPSB7XG5cdFx0XHRwcmlvcml0eTogKHByaW9yaXR5IHwgMCksXG5cdFx0XHRpbmRleDogaVxuXHRcdH07XG5cdFx0dGhpcy5fbnVtSXRlbXMrKztcblx0XHQvLyBjb25zb2xlLmxvZyhcIkZyYW1lUXVldWU6OlJlcXVlc3RRdWV1ZTo6ZW5xdWV1ZSgpIFtudW1JdGVtczolaV0gSUQ6JWlcIiwgdGhpcy5fbnVtSXRlbXMsIHRoaXMuX29mZnNldCArIGkpO1xuXHRcdHJldHVybiB0aGlzLl9vZmZzZXQgKyBpO1xuXHR9LFxuXG5cdGNvbnRhaW5zOiBmdW5jdGlvbihpbmRleCkge1xuXHRcdGluZGV4IC09IHRoaXMub2Zmc2V0O1xuXHRcdHJldHVybiAwIDw9IGluZGV4ICYmIGluZGV4IDwgdGhpcy5faXRlbXMubGVuZ3RoO1xuXHR9LFxuXG5cdHNraXA6IGZ1bmN0aW9uKGluZGV4KSB7XG5cdFx0dmFyIGksIGl0ZW07XG5cdFx0aSA9IGluZGV4IC0gdGhpcy5fb2Zmc2V0O1xuXHRcdGlmICgwID4gaSB8fCBpID49IHRoaXMuX2l0ZW1zLmxlbmd0aCkge1xuXHRcdFx0Ly8gXHRjb25zb2xlLndhcm4oXCJGcmFtZVF1ZXVlOjpSZXF1ZXN0UXVldWU6OnNraXAoaWQ6JWkpIG91dCBvZiByYW5nZSAoJWktJWkpXCIsIGluZGV4LCB0aGlzLl9vZmZzZXQsIHRoaXMuX29mZnNldCArICh0aGlzLl9udW1JdGVtcyAtIDEpKTtcblx0XHRcdHJldHVybiB2b2lkIDA7XG5cdFx0fVxuXHRcdGl0ZW0gPSB0aGlzLl9pdGVtc1tpXTtcblx0XHRpZiAoaXRlbSAhPT0gbnVsbCkge1xuXHRcdFx0Ly8gaWYgKGl0ZW0gPSB0aGlzLl9pdGVtc1tpXSkge1xuXHRcdFx0dGhpcy5faXRlbXNbaV0gPSBudWxsO1xuXHRcdFx0dGhpcy5fbnVtSXRlbXMtLTtcblxuXHRcdFx0Ly8gaWYgKHRoaXMuX251bUl0ZW1zID09IDApIHtcblx0XHRcdC8vIFx0dGhpcy5fZW1wdHkodGhpcy5fb2Zmc2V0ICsgdGhpcy5faXRlbXMubGVuZ3RoKTtcblx0XHRcdC8vIH1cblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiRnJhbWVRdWV1ZTo6UmVxdWVzdFF1ZXVlOjpza2lwKGlkOiVpKSBbbnVtSXRlbXM6JWldIHNraXBwaW5nXCIsIGluZGV4LCB0aGlzLl9udW1JdGVtcyk7XG5cdFx0fVxuXHRcdC8vIGVsc2Uge1xuXHRcdC8vIFx0Y29uc29sZS53YXJuKFwiRnJhbWVRdWV1ZTo6UmVxdWVzdFF1ZXVlOjpza2lwKGlkOiVpKSBbbnVtSXRlbXM6JWldIGl0ZW0gaXMgbnVsbFwiLCBpbmRleCwgdGhpcy5fbnVtSXRlbXMpO1xuXHRcdC8vIH1cblx0XHRyZXR1cm4gaXRlbTtcblx0fSxcblxuXHQvLyBmb3JFYWNoOiBmdW5jdGlvbihmbiwgY29udGV4dCkge1xuXHQvLyBcdHJldHVybiB0aGlzLml0ZW1zLmZvckVhY2goZm4sIGNvbnRleHQpO1xuXHQvLyB9LFxuXG5cdGluZGV4ZXM6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIC5tYXAoZnVuY3Rpb24obywgaSwgYSkge1xuXHRcdC8vIFx0cmV0dXJuIHRoaXNbby5pbmRleF07XG5cdFx0Ly8gfSwgdGhpcy5faXRlbXMpO1xuXHRcdHZhciBpdGVtcyA9IHRoaXMuX3ByaW9yaXRpZXMuY29uY2F0KCk7XG5cdFx0aXRlbXMuc29ydChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHRpZiAoYS5wcmlvcml0eSA+IGIucHJpb3JpdHkpXG5cdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0aWYgKGEucHJpb3JpdHkgPCBiLnByaW9yaXR5KVxuXHRcdFx0XHRyZXR1cm4gLTE7XG5cdFx0XHRyZXR1cm4gMDtcblx0XHR9KTtcblx0XHRpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKG8sIGksIGEpIHtcblx0XHRcdGFbaV0gPSBvLmluZGV4O1xuXHRcdH0sIHRoaXMpO1xuXHRcdHJldHVybiBpdGVtcztcblx0fSxcblxuXHRpdGVtczogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gLm1hcChmdW5jdGlvbihvLCBpLCBhKSB7XG5cdFx0Ly8gXHRyZXR1cm4gdGhpc1tvLmluZGV4XTtcblx0XHQvLyB9LCB0aGlzLl9pdGVtcyk7XG5cdFx0dmFyIGl0ZW1zID0gdGhpcy5fcHJpb3JpdGllcy5jb25jYXQoKTtcblx0XHRpdGVtcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdGlmIChhLnByaW9yaXR5ID4gYi5wcmlvcml0eSlcblx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHRpZiAoYS5wcmlvcml0eSA8IGIucHJpb3JpdHkpXG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdHJldHVybiAwO1xuXHRcdH0pO1xuXHRcdGl0ZW1zLmZvckVhY2goZnVuY3Rpb24obywgaSwgYSkge1xuXHRcdFx0YVtpXSA9IHRoaXMuX2l0ZW1zW28uaW5kZXhdO1xuXHRcdH0sIHRoaXMpO1xuXHRcdHJldHVybiBpdGVtcztcblx0fSxcblxuXHRfZW1wdHk6IGZ1bmN0aW9uKG9mZnNldCkge1xuXHRcdHRoaXMuX29mZnNldCA9IG9mZnNldDtcblx0XHR0aGlzLl9pdGVtcy5sZW5ndGggPSAwO1xuXHRcdHRoaXMuX3ByaW9yaXRpZXMubGVuZ3RoID0gMDtcblx0XHR0aGlzLl9udW1JdGVtcyA9IDA7XG5cdH1cbn0sIHtcblxuXHRvZmZzZXQ6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX29mZnNldDtcblx0XHR9XG5cdH0sXG5cblx0bGVuZ3RoOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9pdGVtcy5sZW5ndGg7XG5cdFx0fVxuXHR9LFxuXG5cdG51bUl0ZW1zOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9udW1JdGVtcztcblx0XHR9XG5cdH0sXG59KTtcblxudmFyIF9uZXh0UXVldWUgPSBuZXcgUmVxdWVzdFF1ZXVlKDApO1xudmFyIF9jdXJyUXVldWUgPSBudWxsO1xuXG4vLyB2YXIgX3BlbmRpbmcgPSBmYWxzZTtcbnZhciBfcnVubmluZyA9IGZhbHNlO1xudmFyIF9yYWZJZCA9IC0xO1xuXG4vKipcbi8qIEBwYXJhbSB0c3RhbXAge2ludH1cbi8qL1xudmFyIF9ydW5RdWV1ZSA9IGZ1bmN0aW9uKHRzdGFtcCkge1xuXHRpZiAoX3J1bm5pbmcpIHRocm93IG5ldyBFcnJvcihcInd0ZiEhIVwiKTtcblxuXHRfcmFmSWQgPSAtMTtcblx0X3J1bm5pbmcgPSB0cnVlO1xuXHRfY3VyclF1ZXVlID0gX25leHRRdWV1ZTtcblx0X25leHRRdWV1ZSA9IG5ldyBSZXF1ZXN0UXVldWUoX2N1cnJRdWV1ZS5vZmZzZXQgKyBfY3VyclF1ZXVlLmxlbmd0aCk7XG5cblx0Ly8gX2N1cnJRdWV1ZS5pdGVtcygpLmZvckVhY2goZnVuY3Rpb24oZm4sIGksIGEpIHtcblx0Ly8gXHRpZiAoZm4gIT09IG51bGwpIHtcblx0Ly8gXHRcdGZuKHRzdGFtcCk7XG5cdC8vIFx0fVxuXHQvLyB9KTtcblx0X2N1cnJRdWV1ZS5pbmRleGVzKCkuZm9yRWFjaChmdW5jdGlvbihpbmRleCwgaSwgYSkge1xuXHRcdHZhciBmbiA9IF9jdXJyUXVldWUuX2l0ZW1zW2luZGV4XTtcblx0XHRpZiAoZm4gIT09IG51bGwpIHtcblx0XHRcdGZuKHRzdGFtcCk7XG5cdFx0fVxuXHR9KTtcblx0X3J1bm5pbmcgPSBmYWxzZTtcblx0X2N1cnJRdWV1ZSA9IG51bGw7XG5cblx0aWYgKF9uZXh0UXVldWUubnVtSXRlbXMgPiAwKSB7XG5cdFx0X3JhZklkID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShfcnVuUXVldWUpO1xuXHR9XG59O1xuXG52YXIgRnJhbWVRdWV1ZSA9IE9iamVjdC5jcmVhdGUoe1xuXHQvKipcblx0LyogQHBhcmFtIGZuIHtGdW5jdGlvbn1cblx0LyogQHBhcmFtIHByaW9yaXR5IHtpbnR9XG5cdC8qIEByZXR1cm4ge2ludH1cblx0LyovXG5cdHJlcXVlc3Q6IGZ1bmN0aW9uKGZuLCBwcmlvcml0eSkge1xuXHRcdC8vIGlmICghX3J1bm5pbmcgJiYgIV9wZW5kaW5nKSB7XG5cdFx0Ly8gXHRfcGVuZGluZyA9IHRydWU7XG5cdFx0Ly8gXHRjb25zb2xlLndhcm4oXCJGcmFtZVF1ZXVlOjpyZXF1ZXN0IHNldEltbWVkaWF0ZTogcGVuZGluZ1wiKTtcblx0XHQvLyBcdHNldEltbWVkaWF0ZShmdW5jdGlvbigpIHtcblx0XHQvLyBcdFx0X3BlbmRpbmcgPSBmYWxzZTtcblx0XHQvLyBcdFx0aWYgKF9uZXh0UXVldWUubnVtSXRlbXMgPiAwKSB7XG5cdFx0Ly8gXHRcdFx0X3JhZklkID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShfcnVuUXVldWUpO1xuXHRcdC8vIFx0XHRcdGNvbnNvbGUud2FybihcIkZyYW1lUXVldWU6OnJlcXVlc3Qgc2V0SW1tZWRpYXRlOiByYWY6JWkgZm9yICVpIGl0ZW1zXCIsIF9yYWZJZCwgX25leHRRdWV1ZS5udW1JdGVtcyk7XG5cdFx0Ly8gXHRcdH0gZWxzZSB7XG5cdFx0Ly8gXHRcdFx0Y29uc29sZS53YXJuKFwiRnJhbWVRdWV1ZTo6cmVxdWVzdCBzZXRJbW1lZGlhdGU6IG5vIGl0ZW1zXCIpO1xuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHR9KTtcblx0XHQvLyB9XG5cdFx0aWYgKCFfcnVubmluZyAmJiBfcmFmSWQgPT09IC0xKSB7XG5cdFx0XHRfcmFmSWQgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKF9ydW5RdWV1ZSk7XG5cdFx0fVxuXHRcdHJldHVybiBfbmV4dFF1ZXVlLmVucXVldWUoZm4sIHByaW9yaXR5KTtcblx0fSxcblxuXHQvKipcblx0LyogQHBhcmFtIGlkIHtpbnR9XG5cdC8qIEByZXR1cm4ge0Z1bmN0aW9uP31cblx0LyovXG5cdGNhbmNlbDogZnVuY3Rpb24oaWQpIHtcblx0XHR2YXIgZm47XG5cdFx0aWYgKF9ydW5uaW5nKSB7XG5cdFx0XHRmbiA9IF9jdXJyUXVldWUuc2tpcChpZCkgfHwgX25leHRRdWV1ZS5za2lwKGlkKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Zm4gPSBfbmV4dFF1ZXVlLnNraXAoaWQpO1xuXHRcdFx0aWYgKChfcmFmSWQgIT09IC0xKSAmJiAoX25leHRRdWV1ZS5udW1JdGVtcyA9PT0gMCkpIHtcblx0XHRcdFx0d2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKF9yYWZJZCk7XG5cdFx0XHRcdF9yYWZJZCA9IC0xO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZm47XG5cdH0sXG59LCB7XG5cdHJ1bm5pbmc6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIF9ydW5uaW5nO1xuXHRcdH1cblx0fVxufSk7XG5cbmlmIChERUJVRykge1xuXHQvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuXHR2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG5cdC8vIGNvbnNvbGUuaW5mbyhcIlVzaW5nIGFwcC92aWV3L2Jhc2UvRnJhbWVRdWV1ZVwiKTtcblxuXHQvLyBcdC8vIC8vIGxvZyBmcmFtZSBleGVjIHRpbWVcblx0Ly8gXHQvLyB2YXIgX25vdyA9IHdpbmRvdy5wZXJmb3JtYW5jZT9cblx0Ly8gXHQvLyBcdHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cuYmluZCh3aW5kb3cucGVyZm9ybWFuY2UpIDpcblx0Ly8gXHQvLyBcdERhdGUubm93LmJpbmQoRGF0ZSk7XG5cdC8vIFx0Ly8gX3J1blF1ZXVlID0gXy53cmFwKF9ydW5RdWV1ZSwgZnVuY3Rpb24oZm4sIHRzdGFtcCkge1xuXHQvLyBcdC8vIFx0dmFyIHJldHZhbCwgdGZyYW1lO1xuXHQvLyBcdC8vIFx0Y29uc29sZS5sb2coXCJbRlJBTUUgQkVHSU5dIFslaW1zXSAlaSBpdGVtcyBbaWRzOiVpLSVpXVwiLCB0c3RhbXAsIF9uZXh0UXVldWUubnVtSXRlbXMsIF9uZXh0UXVldWUub2Zmc2V0LCBfbmV4dFF1ZXVlLm9mZnNldCArIF9uZXh0UXVldWUubGVuZ3RoKTtcblx0Ly8gXHQvLyBcdHRmcmFtZSA9IF9ub3coKTtcblx0Ly8gXHQvLyBcdHJldHZhbCA9IGZuKHRzdGFtcCk7XG5cdC8vIFx0Ly8gXHR0ZnJhbWUgPSBfbm93KCkgLSB0ZnJhbWU7XG5cdC8vIFx0Ly8gXHRjb25zb2xlLmxvZyhcIltGUkFNRSBFTkRFRF0gWyVpbXNdIHRvb2sgJWltc1xcbi0tLVxcblwiLCB0c3RhbXAgKyB0ZnJhbWUsIHRmcmFtZSk7XG5cdC8vIFx0Ly8gXHRpZiAoX25leHRRdWV1ZS5udW1JdGVtcyAhPSAwKSBjb25zb2xlLmluZm8oXCJbRlJBTUUgRU5ERURdICVpIGl0ZW1zIHNjaGVkdWxlZCBmb3IgW3JhZjolaV1cIiwgX25leHRRdWV1ZS5udW1JdGVtcywgX3JhZklkKTtcblx0Ly8gXHQvLyBcdHJldHVybiByZXR2YWw7XG5cdC8vIFx0Ly8gfSk7XG5cblx0Lypcblx0dmFyIHdyYXBDb25zb2xlID0gZnVuY3Rpb24ocHJlZml4KSB7XG5cdFx0dmFyIHNoaWZ0ID0gW10uc2hpZnQ7XG5cdFx0dmFyIGZuTmFtZXMgPSBbXCJncm91cFwiLCBcImxvZ1wiLCBcImluZm9cIiwgXCJ3YXJuXCIsIFwiZXJyb3JcIl07XG5cdFx0dmFyIGZuU3JjID0ge307XG5cdFx0Zm5OYW1lcy5mb3JFYWNoKGZ1bmN0aW9uKGZuTmFtZSkge1xuXHRcdFx0Zm5TcmNbZm5OYW1lXSA9IGNvbnNvbGVbZm5OYW1lXTtcblx0XHRcdGNvbnNvbGVbZm5OYW1lXSA9IF8ud3JhcChjb25zb2xlW2ZuTmFtZV0sIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRpZiAodHlwZW9mIGFyZ3VtZW50c1sxXSA9PSBcInN0cmluZ1wiKSBhcmd1bWVudHNbMV0gPSBwcmVmaXggKyBcIiBcIiArIGFyZ3VtZW50c1sxXTtcblx0XHRcdFx0cmV0dXJuIHNoaWZ0LmFwcGx5KGFyZ3VtZW50cykuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdGZuTmFtZXMuZm9yRWFjaChmdW5jdGlvbihmbk5hbWUpIHtcblx0XHRcdFx0Y29uc29sZVtmbk5hbWVdID0gZm5TcmNbZm5OYW1lXTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fVxuXHQqL1xuXG5cdC8vIGxvZyBmcmFtZSBlbmRcblx0X3J1blF1ZXVlID0gXy53cmFwKF9ydW5RdWV1ZSwgZnVuY3Rpb24oZm4sIHRzdGFtcCkge1xuXHRcdHZhciByZXR2YWw7XG5cdFx0Ly8gdmFyIHVud3JhcCA9IHdyYXBDb25zb2xlKFwiW3JhZiBcIiArIF9yYWZJZCArIFwiXVwiKTtcblx0XHQvLyBjb25zb2xlLmdyb3VwKFwiRnJhbWVRdWV1ZSAjXCIgKyBfcmFmSWQpO1xuXHRcdHJldHZhbCA9IGZuKHRzdGFtcCk7XG5cdFx0Ly8gY29uc29sZS5ncm91cEVuZCgpO1xuXHRcdC8vIHVud3JhcCgpO1xuXHRcdHJldHVybiByZXR2YWw7XG5cdH0pO1xuXG5cdC8vIC8vIHVzZSBsb2cgcHJlZml4XG5cdC8vIGlmIChjb25zb2xlLnByZWZpeCkge1xuXHQvLyBcdF9ydW5RdWV1ZSA9IF8ud3JhcChfcnVuUXVldWUsIGZ1bmN0aW9uKGZuLCB0c3RhbXApIHtcblx0Ly8gXHRcdHZhciByZXR2YWwsIGxvZ3ByZWZpeDtcblx0Ly8gXHRcdGxvZ3ByZWZpeCA9IGNvbnNvbGUucHJlZml4O1xuXHQvLyBcdFx0Y29uc29sZS5wcmVmaXggKz0gXCJbcmFmOlwiICsgX3JhZklkICsgXCJdIFwiO1xuXHQvLyBcdFx0cmV0dmFsID0gZm4odHN0YW1wKTtcblx0Ly8gXHRcdGNvbnNvbGUucHJlZml4ID0gbG9ncHJlZml4O1xuXHQvLyBcdFx0cmV0dXJuIHJldHZhbDtcblx0Ly8gXHR9KTtcblx0Ly8gfVxuXG5cdC8vIEZyYW1lUXVldWUuY2FuY2VsID0gXy53cmFwKEZyYW1lUXVldWUuY2FuY2VsLCBmdW5jdGlvbihmbiwgaWQpIHtcblx0Ly8gXHRpZiAoKF9jdXJyUXVldWUgIT09IG51bGwpICYmIChfY3VyclF1ZXVlLm9mZnNldCA+PSBpZCkgJiYgKGlkIDwgX25leHRRdWV1ZS5vZmZzZXQpKSB7XG5cdC8vIFx0XHRjb25zb2xlLmluZm8oXCJGcmFtZVF1ZXVlOjpjYW5jZWwgSUQ6JWkgaW4gcnVubmluZyByYW5nZSAoJWktJWkpXCIsIGlkLCBfY3VyclF1ZXVlLm9mZnNldCwgX25leHRRdWV1ZS5vZmZzZXQgLSAxKTtcblx0Ly8gXHR9XG5cdC8vIFx0dmFyIHJhZklkID0gX3JhZklkO1xuXHQvLyBcdHZhciByZXR2YWwgPSBmbihpZCk7XG5cdC8vIFx0aWYgKHJldHZhbCA9PT0gdm9pZCAwKSB7XG5cdC8vIFx0XHRjb25zb2xlLndhcm4oXCJGcmFtZVF1ZXVlOjpjYW5jZWwgSUQ6JWkgbm90IGZvdW5kXCIsIGlkKTtcblx0Ly8gXHR9IGVsc2UgaWYgKHJldHZhbCA9PT0gbnVsbCkge1xuXHQvLyBcdFx0Y29uc29sZS53YXJuKFwiRnJhbWVRdWV1ZTo6Y2FuY2VsIElEOiVpIGFscmVhZHkgY2FuY2VsbGVkXCIsIGlkKTtcblx0Ly8gXHR9IGVsc2Uge1xuXHQvLyBcdFx0aWYgKCFfcnVubmluZyAmJiBfbmV4dFF1ZXVlLm51bUl0ZW1zID09IDApIHtcblx0Ly8gXHRcdFx0Y29uc29sZS5pbmZvKFwiRnJhbWVRdWV1ZTo6Y2FuY2VsIHJhZjolaSBjYW5jZWxsZWQgKElEOiVpIGNhbmNlbGxlZCwgZW1wdHkgcXVldWUpXCIsIHJhZklkLCBpZCk7XG5cdC8vIFx0XHR9XG5cdC8vIFx0fVxuXHQvLyBcdHJldHVybiByZXR2YWw7XG5cdC8vIH0pO1xufVxuXG5cbm1vZHVsZS5leHBvcnRzID0gRnJhbWVRdWV1ZTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvYmFzZS9JbnRlcnBvbGF0b3JcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL2Vhc2UvbGluZWFyfSAqL1xudmFyIGxpbmVhciA9IHJlcXVpcmUoXCJ1dGlscy9lYXNlL2xpbmVhclwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9JbnRlcnBvbGF0b3J9XG4gKi9cbmZ1bmN0aW9uIEludGVycG9sYXRvcih2YWx1ZXMsIG1heFZhbHVlcykge1xuXHR0aGlzLl92YWx1ZURhdGEgPSB7fTtcblx0dGhpcy5fbWF4VmFsdWVzID0ge307XG5cdHRoaXMuX3JlbmRlcmFibGVLZXlzID0gW107XG5cblx0dmFyIGtleSwgdmFsLCBtYXhWYWw7XG5cdGZvciAoa2V5IGluIHZhbHVlcykge1xuXHRcdHZhbCA9IHZhbHVlc1trZXldO1xuXHRcdG1heFZhbCA9IG1heFZhbHVlc1trZXldIHx8IG51bGw7XG5cdFx0Ly8gY3JlYXRlIHZhbHVlIG9iamVjdCBhbmQgc3RvcmUgaXRcblx0XHR0aGlzLl92YWx1ZURhdGFba2V5XSA9IHRoaXMuX2luaXRWYWx1ZSh2YWwsIDAsIG1heFZhbCk7XG5cdFx0Ly8gYWRkIG1heFZhbHVlIHRvIHN0b3JlXG5cdFx0dGhpcy5fbWF4VmFsdWVzW2tleV0gPSBtYXhWYWw7XG5cdFx0Ly8gYWRkIHRvIG5leHQgcmVuZGVyIGxpc3Rcblx0XHR0aGlzLl9yZW5kZXJhYmxlS2V5cy5wdXNoKGtleSk7XG5cdH1cblx0dGhpcy5fdmFsdWVzQ2hhbmdlZCA9IHRoaXMuX3JlbmRlcmFibGVLZXlzLmxlbmd0aCA+IDA7XG59XG5cbkludGVycG9sYXRvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHtcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBwdWJsaWMgaW50ZXJmYWNlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGlzQXRUYXJnZXQ6IGZ1bmN0aW9uKGtleSkge1xuXHRcdHJldHVybiB0aGlzLl9yZW5kZXJhYmxlS2V5cy5pbmRleE9mKGtleSkgPT09IC0xO1xuXHR9LFxuXG5cdGdldFZhbHVlOiBmdW5jdGlvbihrZXkpIHtcblx0XHRyZXR1cm4gdGhpcy5fdmFsdWVEYXRhW2tleV0uX3ZhbHVlO1xuXHR9LFxuXG5cdGdldFJlbmRlcmVkVmFsdWU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdHJldHVybiB0aGlzLl92YWx1ZURhdGFba2V5XS5fcmVuZGVyZWRWYWx1ZTtcblx0fSxcblxuXHR2YWx1ZVRvOiBmdW5jdGlvbih2YWx1ZSwgZHVyYXRpb24sIGtleSkge1xuXHRcdHZhciBjaGFuZ2VkLCBkYXRhT2JqID0gdGhpcy5fdmFsdWVEYXRhW2tleV07XG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6dmFsdWVUbyBbJXNdXCIsIFwiW2ludGVycG9sYXRvcl1cIiwga2V5LCB2YWx1ZSk7XG5cdFx0aWYgKEFycmF5LmlzQXJyYXkoZGF0YU9iaikpIHtcblx0XHRcdGNoYW5nZWQgPSB2YWx1ZS5yZWR1Y2UoZnVuY3Rpb24ocHJldkNoYW5nZWQsIGl0ZW1WYWx1ZSwgaSkge1xuXHRcdFx0XHRpZiAoZGF0YU9ialtpXSkge1xuXHRcdFx0XHRcdGRhdGFPYmpbaV0gPSB0aGlzLl9pbml0TnVtYmVyKGl0ZW1WYWx1ZSwgZHVyYXRpb24sIHRoaXMuX21heFZhbHVlc1trZXldKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fc2V0VmFsdWUoaXRlbVZhbHVlLCBkdXJhdGlvbiwgZGF0YU9ialtpXSkgfHwgcHJldkNoYW5nZWQ7XG5cdFx0XHRcdH1cblx0XHRcdH0uYmluZCh0aGlzKSwgY2hhbmdlZCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNoYW5nZWQgPSB0aGlzLl9zZXRWYWx1ZSh2YWx1ZSwgZHVyYXRpb24sIGRhdGFPYmopO1xuXHRcdH1cblx0XHRpZiAoY2hhbmdlZCkge1xuXHRcdFx0dGhpcy5fcmVuZGVyYWJsZUtleXMuaW5kZXhPZihrZXkpICE9PSAtMSB8fCB0aGlzLl9yZW5kZXJhYmxlS2V5cy5wdXNoKGtleSk7XG5cdFx0XHR0aGlzLl92YWx1ZXNDaGFuZ2VkID0gdHJ1ZTtcblx0XHRcdC8vIHRoaXMucmVuZGVyKCk7XG5cdFx0XHQvLyB0aGlzLnJlcXVlc3RSZW5kZXIoKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0dXBkYXRlVmFsdWU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdC8vIENhbGwgX2ludGVycG9sYXRlVmFsdWUgb25seSBpZiBuZWVkZWQuIF9pbnRlcnBvbGF0ZVZhbHVlKCkgcmV0dXJucyBmYWxzZVxuXHRcdC8vIG9uY2UgaW50ZXJwb2xhdGlvbiBpcyBkb25lLCBpbiB3aGljaCBjYXNlIHJlbW92ZSBrZXkgZnJvbSBfcmVuZGVyYWJsZUtleXMuXG5cdFx0dmFyIGtJbmRleCA9IHRoaXMuX3JlbmRlcmFibGVLZXlzLmluZGV4T2Yoa2V5KTtcblx0XHRpZiAoa0luZGV4ICE9PSAtMSAmJiAhdGhpcy5faW50ZXJwb2xhdGVWYWx1ZShrZXkpKSB7XG5cdFx0XHR0aGlzLl9yZW5kZXJhYmxlS2V5cy5zcGxpY2Uoa0luZGV4LCAxKTtcblx0XHRcdHRoaXMuX3ZhbHVlc0NoYW5nZWQgPSB0aGlzLl9yZW5kZXJhYmxlS2V5cy5sZW5ndGggPiAwO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBwcml2YXRlOiB2YWx1ZURhdGFcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2luaXRWYWx1ZTogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBtYXhWYWwpIHtcblx0XHRpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcblx0XHRcdHJldHVybiB2YWx1ZS5tYXAoZnVuY3Rpb24odmFsKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9pbml0TnVtYmVyKHZhbCwgMCwgbWF4VmFsKTtcblx0XHRcdH0sIHRoaXMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5faW5pdE51bWJlcih2YWx1ZSwgMCwgbWF4VmFsKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gX2luaXRBcnJheTogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBtYXhWYWwpIHtcblx0Ly8gXHRyZXR1cm4gdmFsLm1hcChmdW5jdGlvbih2YWwpIHtcblx0Ly8gXHRcdHJldHVybiB0aGlzLl9pbml0TnVtYmVyKHZhbCwgMCwgbWF4VmFsKTtcblx0Ly8gXHR9LCB0aGlzKTtcblx0Ly8gfSxcblxuXHRfaW5pdE51bWJlcjogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBtYXhWYWwpIHtcblx0XHR2YXIgbyA9IHt9O1xuXHRcdG8uX3ZhbHVlID0gdmFsdWU7XG5cdFx0by5fc3RhcnRWYWx1ZSA9IHZhbHVlO1xuXHRcdG8uX3ZhbHVlRGVsdGEgPSAwO1xuXG5cdFx0by5fZHVyYXRpb24gPSBkdXJhdGlvbiB8fCAwO1xuXHRcdG8uX3N0YXJ0VGltZSA9IC0xO1xuXHRcdG8uX2VsYXBzZWRUaW1lID0gMDtcblxuXHRcdG8uX2xhc3RSZW5kZXJlZFZhbHVlID0gby5fcmVuZGVyZWRWYWx1ZSA9IG51bGw7XG5cblx0XHRvLl9tYXhWYWwgPSBtYXhWYWw7XG5cdFx0Ly8gaWYgKG1heFZhbCAhPT0gdm9pZCAwKSBvLl9tYXhWYWwgPSBtYXhWYWw7XG5cdFx0Ly8gby5fbWF4VmFsID0gdGhpcy5fbWF4VmFsdWVzW2tleV07XG5cdFx0Ly8gby5fbWF4VmFsID0gdGhpcy5fbWF4VmFsOy8vIEZJWE1FXG5cdFx0cmV0dXJuIG87XG5cdH0sXG5cblx0X3NldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgZHVyYXRpb24sIG8pIHtcblx0XHRpZiAoby5fdmFsdWUgIT0gdmFsdWUpIHtcblx0XHRcdG8uX3N0YXJ0VmFsdWUgPSBvLl92YWx1ZTtcblx0XHRcdG8uX3ZhbHVlRGVsdGEgPSB2YWx1ZSAtIG8uX3ZhbHVlO1xuXHRcdFx0by5fdmFsdWUgPSB2YWx1ZTtcblxuXHRcdFx0by5fZHVyYXRpb24gPSBkdXJhdGlvbiB8fCAwO1xuXHRcdFx0by5fc3RhcnRUaW1lID0gLTE7XG5cdFx0XHRvLl9lbGFwc2VkVGltZSA9IDA7XG5cblx0XHRcdG8uX2xhc3RSZW5kZXJlZFZhbHVlID0gby5fcmVuZGVyZWRWYWx1ZTtcblxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBwcml2YXRlOiBpbnRlcnBvbGF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGludGVycG9sYXRlOiBmdW5jdGlvbih0c3RhbXApIHtcblx0XHRpZiAodGhpcy5fdmFsdWVzQ2hhbmdlZCkge1xuXHRcdFx0dGhpcy5fdmFsdWVzQ2hhbmdlZCA9IGZhbHNlO1xuXG5cdFx0XHR2YXIgY2hhbmdlZEtleXMgPSB0aGlzLl9yZW5kZXJhYmxlS2V5cztcblx0XHRcdHRoaXMuX3RzdGFtcCA9IHRzdGFtcDtcblx0XHRcdHRoaXMuX3JlbmRlcmFibGVLZXlzID0gY2hhbmdlZEtleXMuZmlsdGVyKHRoaXMuX2ludGVycG9sYXRlVmFsdWUsIHRoaXMpO1xuXHRcdFx0dGhpcy5fcmVuZGVyZWRLZXlzID0gY2hhbmdlZEtleXM7XG5cblx0XHRcdGlmICh0aGlzLl9yZW5kZXJhYmxlS2V5cy5sZW5ndGggIT09IDApIHtcblx0XHRcdFx0dGhpcy5fdmFsdWVzQ2hhbmdlZCA9IHRydWU7XG5cdFx0XHRcdC8vIFx0Ly8gdGhpcy5yZXF1ZXN0UmVuZGVyKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OmludGVycG9sYXRlIHZhbHVlc0NoYW5nZWQ6JXMgdHN0YW1wOiVmXCIsIFwiW2ludGVycG9sYXRvcl1cIiwgdGhpcy5fdmFsdWVzQ2hhbmdlZCwgdHN0YW1wKTtcblx0XHQvLyByZXR1cm4gdGhpcy5fdmFsdWVzQ2hhbmdlZDtcblx0XHQvLyByZXR1cm4gdGhpcy52YWx1ZXNDaGFuZ2VkO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X2ludGVycG9sYXRlVmFsdWU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdHZhciBkYXRhT2JqID0gdGhpcy5fdmFsdWVEYXRhW2tleV07XG5cdFx0aWYgKEFycmF5LmlzQXJyYXkoZGF0YU9iaikpIHtcblx0XHRcdHJldHVybiBkYXRhT2JqLnJlZHVjZShmdW5jdGlvbihjb250aW51ZU5leHQsIG8sIGluZGV4LCBhcnIpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2ludGVycG9sYXRlTnVtYmVyKHRoaXMuX3RzdGFtcCwgbykgfHwgY29udGludWVOZXh0O1xuXHRcdFx0fS5iaW5kKHRoaXMpLCBmYWxzZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB0aGlzLl9pbnRlcnBvbGF0ZU51bWJlcih0aGlzLl90c3RhbXAsIGRhdGFPYmopO1xuXHRcdH1cblx0fSxcblxuXHRfaW50ZXJwb2xhdGVOdW1iZXI6IGZ1bmN0aW9uKHRzdGFtcCwgbykge1xuXHRcdGlmIChvLl9zdGFydFRpbWUgPCAwKSB7XG5cdFx0XHRvLl9zdGFydFRpbWUgPSB0c3RhbXA7XG5cdFx0fVxuXHRcdHZhciBlbGFwc2VkID0gdHN0YW1wIC0gby5fc3RhcnRUaW1lO1xuXHRcdG8uX2VsYXBzZWRUaW1lID0gZWxhcHNlZDtcblx0XHRvLl9sYXN0UmVuZGVyZWRWYWx1ZSA9IG8uX3JlbmRlcmVkVmFsdWU7XG5cdFx0aWYgKGVsYXBzZWQgPCBvLl9kdXJhdGlvbikge1xuXHRcdFx0aWYgKG8uX21heFZhbCAmJiBvLl92YWx1ZURlbHRhIDwgMCkge1xuXHRcdFx0XHQvLyB1cHBlci1ib3VuZCB2YWx1ZXNcblx0XHRcdFx0by5fcmVuZGVyZWRWYWx1ZSA9IGxpbmVhcihlbGFwc2VkLCBvLl9zdGFydFZhbHVlLFxuXHRcdFx0XHRcdG8uX3ZhbHVlRGVsdGEgKyBvLl9tYXhWYWwsIG8uX2R1cmF0aW9uKSAtIG8uX21heFZhbDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIHVuYm91bmQgdmFsdWVzXG5cdFx0XHRcdG8uX3JlbmRlcmVkVmFsdWUgPSBsaW5lYXIoZWxhcHNlZCwgby5fc3RhcnRWYWx1ZSxcblx0XHRcdFx0XHRvLl92YWx1ZURlbHRhLCBvLl9kdXJhdGlvbik7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0by5fcmVuZGVyZWRWYWx1ZSA9IG8uX3ZhbHVlO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fSxcbn0sIHtcblx0dmFsdWVzQ2hhbmdlZDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fdmFsdWVzQ2hhbmdlZDtcblx0XHR9XG5cdH0sXG5cdHJlbmRlcmFibGVLZXlzOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9yZW5kZXJhYmxlS2V5cztcblx0XHR9XG5cdH0sXG5cdHJlbmRlcmVkS2V5czoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fcmVuZGVyZWRLZXlzO1xuXHRcdH1cblx0fSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEludGVycG9sYXRvcjtcbiIsIi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkRXZlbnR9ICovXG52YXIgcHJlZml4ZWRFdmVudCA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZEV2ZW50XCIpO1xuXG52YXIgZXZlbnRNYXAgPSB7XG5cdFwidHJhbnNpdGlvbmVuZFwiOiBwcmVmaXhlZEV2ZW50KFwidHJhbnNpdGlvbmVuZFwiKSxcblx0XCJmdWxsc2NyZWVuY2hhbmdlXCI6IHByZWZpeGVkRXZlbnQoXCJmdWxsc2NyZWVuY2hhbmdlXCIsIGRvY3VtZW50KSxcblx0XCJmdWxsc2NyZWVuZXJyb3JcIjogcHJlZml4ZWRFdmVudChcImZ1bGxzY3JlZW5lcnJvclwiLCBkb2N1bWVudCksXG5cdFwidmlzaWJpbGl0eWNoYW5nZVwiOiBwcmVmaXhlZEV2ZW50KFwidmlzaWJpbGl0eWNoYW5nZVwiLCBkb2N1bWVudCwgXCJoaWRkZW5cIilcbn07XG5cbnZhciBldmVudE51bSA9IDA7XG5mb3IgKHZhciBldmVudE5hbWUgaW4gZXZlbnRNYXApIHtcblx0aWYgKGV2ZW50TmFtZSA9PT0gZXZlbnRNYXBbZXZlbnROYW1lXSkge1xuXHRcdGRlbGV0ZSBldmVudE1hcFtldmVudE5hbWVdO1xuXHR9IGVsc2Uge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShldmVudE1hcCwgZXZlbnROYW1lLCB7XG5cdFx0XHR2YWx1ZTogZXZlbnRNYXBbZXZlbnROYW1lXSxcblx0XHRcdGVudW1lcmFibGU6IHRydWVcblx0XHR9KTtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnRNYXAsIGV2ZW50TnVtLCB7XG5cdFx0XHR2YWx1ZTogZXZlbnROYW1lLFxuXHRcdFx0ZW51bWVyYWJsZTogZmFsc2Vcblx0XHR9KTtcblx0XHRldmVudE51bSsrO1xuXHR9XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnRNYXAsIFwibGVuZ3RoXCIsIHtcblx0dmFsdWU6IGV2ZW50TnVtXG59KTtcblxuaWYgKERFQlVHKSB7XG5cdGNvbnNvbGUubG9nKFwicHJlZml4ZXMgZW5hYmxlZCBmb3IgJWkgZXZlbnRzXCIsIGV2ZW50TWFwLmxlbmd0aCwgT2JqZWN0LmtleXMoZXZlbnRNYXApKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBldmVudE1hcDtcblxuLy8gbW9kdWxlLmV4cG9ydHMgPSBldmVudE51bSA+IDA/IGV2ZW50TWFwIDogbnVsbDtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9iYXNlL1RvdWNoTWFuYWdlclxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG4vLyB2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6aGFtbWVyanN9ICovXG52YXIgSGFtbWVyID0gcmVxdWlyZShcImhhbW1lcmpzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzLlRhcH0gKi9cbnZhciBUYXAgPSBIYW1tZXIuVGFwO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvdG91Y2gvU21vb3RoUGFuUmVjb2duaXplcn0gKi9cbnZhciBQYW4gPSByZXF1aXJlKFwidXRpbHMvdG91Y2gvU21vb3RoUGFuUmVjb2duaXplclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzLlBhbn0gKi9cbi8vIHZhciBQYW4gPSBIYW1tZXIuUGFuO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBTdGF0aWMgcHJpdmF0ZVxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vKipcbiAqIEBwYXJhbSBlbCBIVE1MRWxlbWVudFxuICogQHJldHVybiB7SGFtbWVyLk1hbmFnZXJ9XG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUluc3RhbmNlKGVsKSB7XG5cdHZhciBtYW5hZ2VyLCBocGFuLCB2cGFuLCB0YXA7XG5cdGhwYW4gPSBuZXcgUGFuKHtcblx0XHQvLyB0aHJlc2hvbGQ6IEdsb2JhbHMuUEFOX1RIUkVTSE9MRCxcblx0XHQvLyB0b3VjaEFjdGlvbjogXCJwYW4teVwiLFxuXHRcdGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9IT1JJWk9OVEFMLFxuXHRcdGV2ZW50OiBcImhwYW5cIixcblx0fSk7XG5cdHZwYW4gPSBuZXcgUGFuKHtcblx0XHQvLyB0aHJlc2hvbGQ6IEdsb2JhbHMuUEFOX1RIUkVTSE9MRCxcblx0XHQvLyB0b3VjaEFjdGlvbjogXCJwYW4teFwiLFxuXHRcdGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTCxcblx0XHRldmVudDogXCJ2cGFuXCIsXG5cdH0pO1xuXHR0YXAgPSBuZXcgVGFwKHtcblx0XHQvLyB0aHJlc2hvbGQ6IEdsb2JhbHMuUEFOX1RIUkVTSE9MRCAtIDFcblx0fSk7XG5cdG1hbmFnZXIgPSBuZXcgSGFtbWVyLk1hbmFnZXIoZWwpO1xuXHQvLyBtYW5hZ2VyLnNldCh7IGRvbWV2ZW50czogdHJ1ZSB9KTtcblx0bWFuYWdlci5hZGQoW3RhcCwgaHBhbiwgdnBhbl0pO1xuXHQvLyBtYW5hZ2VyLmFkZChbaHBhbiwgdnBhbl0pO1xuXHR2cGFuLnJlcXVpcmVGYWlsdXJlKGhwYW4pO1xuXHQvLyBtYW5hZ2VyLmFkZChocGFuKTtcblx0cmV0dXJuIG1hbmFnZXI7XG59XG5cbi8vIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbmNlKGVsKSB7XG4vLyBcdHJldHVybiBuZXcgSGFtbWVyKGVsLCB7XG4vLyBcdFx0cmVjb2duaXplcnM6IFtcbi8vIFx0XHRcdFtUYXBdLFxuLy8gXHRcdFx0W1Bhbiwge1xuLy8gXHRcdFx0XHRldmVudDogJ2hwYW4nLFxuLy8gXHRcdFx0XHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fSE9SSVpPTlRBTCxcbi8vIFx0XHRcdFx0dGhyZXNob2xkOiBHbG9iYWxzLlRIUkVTSE9MRFxuLy8gXHRcdFx0fV0sXG4vLyBcdFx0XHRbUGFuLCB7XG4vLyBcdFx0XHRcdGV2ZW50OiAndnBhbicsXG4vLyBcdFx0XHRcdGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTCxcbi8vIFx0XHRcdFx0dGhyZXNob2xkOiBHbG9iYWxzLlRIUkVTSE9MRFxuLy8gXHRcdFx0fSwgWydocGFuJ11dXG4vLyBcdFx0XVxuLy8gXHR9KTtcbi8vIH1cblxuLy8gZnVuY3Rpb24gY3JlYXRlSW5zdGFuY2UoZWwpIHtcbi8vIFx0dmFyIHJlY29nbml6ZXJzID0gW107XG4vLyBcdHZhciBtYW5hZ2VyID0gbmV3IEhhbW1lci5NYW5hZ2VyKGVsKTtcbi8vXG4vLyBcdHZhciBocGFuID0gbmV3IFBhbih7XG4vLyBcdFx0ZXZlbnQ6IFwiaHBhblwiLFxuLy8gXHRcdHRocmVzaG9sZDogR2xvYmFscy5USFJFU0hPTEQsXG4vLyBcdFx0ZGlyZWN0aW9uOiBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUxcbi8vIFx0fSk7XG4vL1xuLy8gXHR2YXIgdnBhbiA9IG5ldyBQYW4oe1xuLy8gXHRcdGV2ZW50OiBcInZwYW5cIixcbi8vIFx0XHR0aHJlc2hvbGQ6IEdsb2JhbHMuVEhSRVNIT0xELFxuLy8gXHRcdGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTFxuLy8gXHR9KTtcbi8vXG4vLyBcdHZhciB0YXAgPSBuZXcgSGFtbWVyLlRhcCgpO1xuLy8gXHQvLyB2YXIgdGFwID0gbmV3IEhhbW1lci5UYXAoe1xuLy8gXHQvLyBcdHRocmVzaG9sZDogR2xvYmFscy5USFJFU0hPTEQgLSAxLFxuLy8gXHQvLyBcdGludGVydmFsOiA1MCxcbi8vIFx0Ly8gXHR0aW1lOiAyMDBcbi8vIFx0Ly8gfSk7XG4vLyBcdHJlY29nbml6ZXJzLnB1c2godnBhbik7XG4vLyBcdHJlY29nbml6ZXJzLnB1c2goaHBhbik7XG4vLyBcdHJlY29nbml6ZXJzLnB1c2godGFwKTtcbi8vIFx0bWFuYWdlci5hZGQocmVjb2duaXplcnMpO1xuLy9cbi8vIFx0aHBhbi5yZWNvZ25pemVXaXRoKFt2cGFuXSk7XG4vLyBcdGhwYW4ucmVxdWlyZUZhaWx1cmUoW3ZwYW5dKTtcbi8vIFx0dGFwLnJlY29nbml6ZVdpdGgoW3ZwYW4sIGhwYW5dKTtcbi8vXG4vLyBcdC8vIHRhcC5yZXF1aXJlRmFpbHVyZSh2cGFuKTtcbi8vXG4vLyBcdC8vIG1hbmFnZXIuc2V0KHsgZG9tZXZlbnRzOiB0cnVlIH0pO1xuLy8gXHRyZXR1cm4gbWFuYWdlcjtcbi8vIH1cblxuLypodHRwczovL2dpc3QuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2p0YW5nZWxkZXIvMzYxMDUyOTc2ZjA0NDIwMGVhMTcvcmF3L2Y1NGMyY2VmNzhkNTlkYTNmMzgyODZmYWQ2ODM0NzFlMWM5NzYwNzIvUHJldmVudEdob3N0Q2xpY2suanMqL1xuXG4vLyBmdW5jdGlvblx0bG9nRXZlbnQobWVzc2FnZSkge1xuLy8gXHRjb25zb2xlLmxvZyhtZXNzYWdlLCBkb21ldi50eXBlLFxuLy8gXHRcdFwicGFuU2Vzc2lvbk9wZW5lZDogXCIgKyBwYW5TZXNzaW9uT3BlbmVkLFxuLy8gXHRcdFwiZGVmYXVsdFByZXZlbnRlZDogXCIgKyBkb21ldi5kZWZhdWx0UHJldmVudGVkXG4vLyBcdCk7XG4vLyB9XG5cbnZhciBsYXN0VGltZVN0YW1wID0gLTE7XG52YXIgcGFuU2Vzc2lvbk9wZW5lZCA9IGZhbHNlO1xudmFyIHVwRXZlbnROYW1lID0gd2luZG93Lmhhc093blByb3BlcnR5KFwib25wb2ludGVydXBcIikgPyBcInBvaW50ZXJ1cFwiIDogXCJtb3VzZXVwXCI7XG5cbnZhciB0b3VjaEhhbmRsZXJzID0ge307XG50b3VjaEhhbmRsZXJzW1widnBhbnN0YXJ0IHZwYW5lbmQgdnBhbmNhbmNlbCBocGFuc3RhcnQgaHBhbmVuZCBocGFuY2FuY2VsXCJdID0gZnVuY3Rpb24oaGV2KSB7XG5cdC8vIGNvbnNvbGUubG9nKFwiVG91Y2hNYW5hZ2VyOlslc11cIiwgaGV2LnNyY0V2ZW50LnR5cGUpO1xuXHRwYW5TZXNzaW9uT3BlbmVkID0gIWhldi5pc0ZpbmFsO1xuXHRpZiAoaGV2LmlzRmluYWwpXG5cdFx0bGFzdFRpbWVTdGFtcCA9IGhldi5zcmNFdmVudC50aW1lU3RhbXA7XG59O1xuLy8gdG91Y2hIYW5kbGVyc1tcImhhbW1lci5pbnB1dCB0YXAgdnBhbm1vdmUgaHBhbm1vdmVcIl0gPSBmdW5jdGlvbihoZXYpIHtcbi8vIFx0Y29uc29sZS5sb2coXCJUb3VjaE1hbmFnZXI6WyVzIC0+ICVzXVwiLCBoZXYuc3JjRXZlbnQudHlwZSwgaGV2LnR5cGUpO1xuLy8gfTtcblxudmFyIGNhcHR1cmVIYW5kbGVycyA9IHt9O1xuY2FwdHVyZUhhbmRsZXJzW1wiY2xpY2tcIl0gPSBmdW5jdGlvbihkb21ldikge1xuXHRpZiAobGFzdFRpbWVTdGFtcCA9PSBkb21ldi50aW1lU3RhbXApIHtcblx0XHRsYXN0VGltZVN0YW1wID0gLTE7XG5cdFx0ZG9tZXYuZGVmYXVsdFByZXZlbnRlZCB8fCBkb21ldi5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdGRvbWV2LnN0b3BQcm9wYWdhdGlvbigpO1xuXHR9XG59O1xuY2FwdHVyZUhhbmRsZXJzW1wiZHJhZ3N0YXJ0XCJdID0gZnVuY3Rpb24oZG9tZXYpIHtcblx0aWYgKGRvbWV2LnRhcmdldC5ub2RlTmFtZSA9PSBcIklNR1wiKSB7XG5cdFx0ZG9tZXYuZGVmYXVsdFByZXZlbnRlZCB8fCBkb21ldi5wcmV2ZW50RGVmYXVsdCgpO1xuXHR9XG59O1xuY2FwdHVyZUhhbmRsZXJzW3VwRXZlbnROYW1lXSA9IGZ1bmN0aW9uKGRvbWV2KSB7XG5cdHBhblNlc3Npb25PcGVuZWQgJiYgZG9tZXYucHJldmVudERlZmF1bHQoKTtcbn07XG5cbnZhciBidWJibGluZ0hhbmRsZXJzID0ge307XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmZ1bmN0aW9uIGFkZEhhbmRsZXJzKCkge1xuXHR2YXIgZXZlbnROYW1lLCBlbCA9IGluc3RhbmNlLmVsZW1lbnQ7XG5cdGZvciAoZXZlbnROYW1lIGluIHRvdWNoSGFuZGxlcnMpXG5cdFx0aWYgKHRvdWNoSGFuZGxlcnMuaGFzT3duUHJvcGVydHkoZXZlbnROYW1lKSlcblx0XHRcdGluc3RhbmNlLm9uKGV2ZW50TmFtZSwgdG91Y2hIYW5kbGVyc1tldmVudE5hbWVdKTtcblx0Zm9yIChldmVudE5hbWUgaW4gY2FwdHVyZUhhbmRsZXJzKVxuXHRcdGlmIChjYXB0dXJlSGFuZGxlcnMuaGFzT3duUHJvcGVydHkoZXZlbnROYW1lKSlcblx0XHRcdGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBjYXB0dXJlSGFuZGxlcnNbZXZlbnROYW1lXSwgdHJ1ZSk7XG5cdGZvciAoZXZlbnROYW1lIGluIGJ1YmJsaW5nSGFuZGxlcnMpXG5cdFx0aWYgKGJ1YmJsaW5nSGFuZGxlcnMuaGFzT3duUHJvcGVydHkoZXZlbnROYW1lKSlcblx0XHRcdGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBidWJibGluZ0hhbmRsZXJzW2V2ZW50TmFtZV0sIGZhbHNlKTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlSGFuZGxlcnMoKSB7XG5cdHZhciBldmVudE5hbWUsIGVsID0gaW5zdGFuY2UuZWxlbWVudDtcblx0Zm9yIChldmVudE5hbWUgaW4gY2FwdHVyZUhhbmRsZXJzKVxuXHRcdGlmIChjYXB0dXJlSGFuZGxlcnMuaGFzT3duUHJvcGVydHkoZXZlbnROYW1lKSlcblx0XHRcdGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBjYXB0dXJlSGFuZGxlcnNbZXZlbnROYW1lXSwgdHJ1ZSk7XG5cdGZvciAoZXZlbnROYW1lIGluIGJ1YmJsaW5nSGFuZGxlcnMpXG5cdFx0aWYgKGNhcHR1cmVIYW5kbGVycy5oYXNPd25Qcm9wZXJ0eShldmVudE5hbWUpKVxuXHRcdFx0ZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGJ1YmJsaW5nSGFuZGxlcnNbZXZlbnROYW1lXSwgdHJ1ZSk7XG59XG5cbi8qKiBAdHlwZSB7SGFtbWVyLk1hbmFnZXJ9ICovXG52YXIgaW5zdGFuY2UgPSBudWxsO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBTdGF0aWMgcHVibGljXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbnZhciBUb3VjaE1hbmFnZXIgPSB7XG5cdGluaXQ6IGZ1bmN0aW9uKHRhcmdldCkge1xuXHRcdGlmIChpbnN0YW5jZSA9PT0gbnVsbCkge1xuXHRcdFx0aW5zdGFuY2UgPSBjcmVhdGVJbnN0YW5jZSh0YXJnZXQpO1xuXHRcdFx0YWRkSGFuZGxlcnMoKTtcblx0XHR9IGVsc2UgaWYgKGluc3RhbmNlLmVsZW1lbnQgIT09IHRhcmdldCkge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiVG91Y2hNYW5hZ2VyIGFscmVhZHkgaW5pdGlhbGl6ZWQgd2l0aCBhbm90aGVyIGVsZW1lbnRcIik7XG5cdFx0fVxuXHRcdHJldHVybiBpbnN0YW5jZTtcblx0fSxcblxuXHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHRpZiAoaW5zdGFuY2UgIT09IG51bGwpIHtcblx0XHRcdHJlbW92ZUhhbmRsZXJzKCk7XG5cdFx0XHRpbnN0YW5jZS5kZXN0cm95KCk7XG5cdFx0XHRpbnN0YW5jZSA9IG51bGw7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUud2FybihcIm5vIGluc3RhbmNlIHRvIGRlc3Ryb3lcIik7XG5cdFx0fVxuXHR9LFxuXG5cdGdldEluc3RhbmNlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoaW5zdGFuY2UgPT09IG51bGwpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJUb3VjaE1hbmFnZXIgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkXCIpO1xuXHRcdH1cblx0XHRyZXR1cm4gaW5zdGFuY2U7XG5cdH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVG91Y2hNYW5hZ2VyOyIsIi8qIGdsb2JhbCBIVE1MRWxlbWVudCwgTXV0YXRpb25PYnNlcnZlciAqL1xuLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L2Jhc2UvVmlld1xuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xudmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIE11dGF0aW9uT2JzZXJ2ZXJcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxudmFyIF9jaWRTZWVkID0gMTtcbnZhciBfdmlld3NCeUNpZCA9IHt9O1xuXG5mdW5jdGlvbiBhZGRDaGlsZFZpZXdzKGVsKSB7XG5cdHZhciB2aWV3LCBlbHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKFwiKltkYXRhLWNpZF1cIik7XG5cdGZvciAodmFyIGkgPSAwLCBpaSA9IGVscy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0dmlldyA9IFZpZXcuZmluZEJ5RWxlbWVudChlbHMuaXRlbShpKSk7XG5cdFx0aWYgKHZpZXcpIHtcblx0XHRcdGlmICghdmlldy5hdHRhY2hlZCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIlZpZXc6OlthdHRhY2hlZCAocGFyZW50KV0gJXNcIiwgdmlldy5jaWQpO1xuXHRcdFx0XHR2aWV3Ll9lbGVtZW50QXR0YWNoZWQoKTtcblx0XHRcdFx0Ly8gfSBlbHNlIHtcblx0XHRcdFx0Ly8gXHRjb25zb2xlLndhcm4oXCJWaWV3OjpbYXR0YWNoZWQgKHBhcmVudCldICVzIChpZ25vcmVkKVwiLCB2aWV3LmNpZCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUNoaWxkVmlld3MoZWwpIHtcblx0dmFyIHZpZXcsIGVscyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIqW2RhdGEtY2lkXVwiKTtcblx0Zm9yICh2YXIgaSA9IDAsIGlpID0gZWxzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHR2aWV3ID0gVmlldy5maW5kQnlFbGVtZW50KGVscy5pdGVtKGkpKTtcblx0XHRpZiAodmlldykge1xuXHRcdFx0aWYgKHZpZXcuYXR0YWNoZWQpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJWaWV3OjpbZGV0YWNoZWQgKHBhcmVudCldICVzXCIsIHZpZXcuY2lkKTtcblx0XHRcdFx0dmlldy5fZWxlbWVudERldGFjaGVkKCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJWaWV3OjpbZGV0YWNoZWQgKHBhcmVudCldICVzIChpZ25vcmVkKVwiLCB2aWV3LmNpZCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG5cbnZhciBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGZ1bmN0aW9uKG1tKSB7XG5cdC8vIGNvbnNvbGUubG9nKFwiVmlldzo6bXV0YXRpb25zICVzXCIsIEpTT04uc3RyaW5naWZ5KG1tLCBudWxsLCBcIiBcIikpO1xuXHR2YXIgaSwgaWksIG07XG5cdHZhciBqLCBqaiwgZTtcblx0dmFyIHZpZXc7XG5cdGZvciAoaSA9IDAsIGlpID0gbW0ubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdG0gPSBtbVtpXTtcblx0XHRpZiAobS50eXBlID09IFwiY2hpbGRMaXN0XCIpIHtcblx0XHRcdGZvciAoaiA9IDAsIGpqID0gbS5hZGRlZE5vZGVzLmxlbmd0aDsgaiA8IGpqOyBqKyspIHtcblx0XHRcdFx0ZSA9IG0uYWRkZWROb2Rlcy5pdGVtKGopO1xuXHRcdFx0XHR2aWV3ID0gVmlldy5maW5kQnlFbGVtZW50KGUpO1xuXHRcdFx0XHRpZiAodmlldykge1xuXHRcdFx0XHRcdGlmICghdmlldy5hdHRhY2hlZCkge1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJWaWV3OjpbYXR0YWNoZWQgKGNoaWxkTGlzdCldICVzXCIsIHZpZXcuY2lkKTtcblx0XHRcdFx0XHRcdHZpZXcuX2VsZW1lbnRBdHRhY2hlZCgpO1xuXHRcdFx0XHRcdFx0Ly8gfSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIFx0Y29uc29sZS53YXJuKFwiVmlldzo6W2F0dGFjaGVkIChjaGlsZExpc3QpXSAlcyAoaWdub3JlZClcIiwgdmlldy5jaWQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSBhZGRDaGlsZFZpZXdzKGUpO1xuXHRcdFx0fVxuXHRcdFx0Zm9yIChqID0gMCwgamogPSBtLnJlbW92ZWROb2Rlcy5sZW5ndGg7IGogPCBqajsgaisrKSB7XG5cdFx0XHRcdGUgPSBtLnJlbW92ZWROb2Rlcy5pdGVtKGopO1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIlZpZXc6OltkZXRhY2hlZCAoY2hpbGRMaXN0KV0gJXNcIiwgZS5jaWQpO1xuXHRcdFx0XHR2aWV3ID0gVmlldy5maW5kQnlFbGVtZW50KGUpO1xuXHRcdFx0XHRpZiAodmlldykge1xuXHRcdFx0XHRcdGlmICh2aWV3LmF0dGFjaGVkKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIlZpZXc6OltkZXRhY2hlZCAoY2hpbGRMaXN0KV0gJXNcIiwgdmlldy5jaWQsIHZpZXcuYXR0YWNoZWQpO1xuXHRcdFx0XHRcdFx0dmlldy5fZWxlbWVudERldGFjaGVkKCk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIlZpZXc6OltkZXRhY2hlZCAoY2hpbGRMaXN0KV0gJXMgKGlnbm9yZWQpXCIsIHZpZXcuY2lkLCB2aWV3LmF0dGFjaGVkKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgcmVtb3ZlQ2hpbGRWaWV3cyhlKTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKG0udHlwZSA9PSBcImF0dHJpYnV0ZXNcIikge1xuXHRcdFx0dmlldyA9IFZpZXcuZmluZEJ5RWxlbWVudChtLnRhcmdldCk7XG5cdFx0XHRpZiAodmlldykge1xuXHRcdFx0XHRpZiAoIXZpZXcuYXR0YWNoZWQpIHtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIlZpZXc6OlthdHRhY2hlZCAoYXR0cmlidXRlKV0gJXNcIiwgdmlldy5jaWQpO1xuXHRcdFx0XHRcdHZpZXcuX2VsZW1lbnRBdHRhY2hlZCgpO1xuXHRcdFx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gXHRjb25zb2xlLndhcm4oXCJWaWV3OjpbYXR0YWNoZWQgKGF0dHJpYnV0ZSldICVzIChpZ25vcmVkKVwiLCB2aWV3LmNpZCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdC8vIGVsc2Uge1xuXHRcdFx0Ly8gXHRjb25zb2xlLndhcm4oXCJWaWV3OjpbYXR0cmlidXRlc10gdGFyZ2V0IGhhcyBubyBjaWQgKCVzPSclcycpXCIsIG0uYXR0cmlidXRlTmFtZSwgbS50YXJnZXQuZ2V0QXR0cmlidXRlKG0uYXR0cmlidXRlTmFtZSksIG0pO1xuXHRcdFx0Ly8gfVxuXHRcdH1cblx0fVxufSk7XG5cbm9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xuXHRhdHRyaWJ1dGVzOiB0cnVlLFxuXHRjaGlsZExpc3Q6IHRydWUsXG5cdHN1YnRyZWU6IHRydWUsXG5cdGF0dHJpYnV0ZUZpbHRlcjogW1wiZGF0YS1jaWRcIl1cbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBzdGF0aWMgcHJpdmF0ZVxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL0ZyYW1lUXVldWV9ICovXG52YXIgRnJhbWVRdWV1ZSA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL0ZyYW1lUXVldWVcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvUHJlZml4ZWRFdmVudHN9ICovXG52YXIgUHJlZml4ZWRFdmVudHMgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9QcmVmaXhlZEV2ZW50c1wiKTtcblxudmFyIF9ub3cgPSB3aW5kb3cucGVyZm9ybWFuY2UgP1xuXHR3aW5kb3cucGVyZm9ybWFuY2Uubm93LmJpbmQod2luZG93LnBlcmZvcm1hbmNlKSA6XG5cdERhdGUubm93LmJpbmQoRGF0ZSk7XG4vLyB2YXIgX25vdyA9IHdpbmRvdy5wZXJmb3JtYW5jZT9cbi8vIFx0ZnVuY3Rpb24oKSB7IHJldHVybiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCk7IH06XG4vLyBcdGZ1bmN0aW9uKCkgeyByZXR1cm4gRGF0ZS5ub3coKTsgfTtcblxudmFyIGFwcGx5RXZlbnRQcmVmaXhlcyA9IGZ1bmN0aW9uKGV2ZW50cykge1xuXHR2YXIgc2VsZWN0b3IsIHVucHJlZml4ZWQ7XG5cdGZvciAoc2VsZWN0b3IgaW4gZXZlbnRzKSB7XG5cdFx0dW5wcmVmaXhlZCA9IHNlbGVjdG9yLm1hdGNoKC9eXFx3Ky9pKVswXTtcblx0XHRpZiAoUHJlZml4ZWRFdmVudHMuaGFzT3duUHJvcGVydHkodW5wcmVmaXhlZCkpIHtcblx0XHRcdGV2ZW50c1tzZWxlY3Rvci5yZXBsYWNlKHVucHJlZml4ZWQsIFByZWZpeGVkRXZlbnRzW3VucHJlZml4ZWRdKV0gPSBldmVudHNbc2VsZWN0b3JdO1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJhcHBseUV2ZW50UHJlZml4ZXNcIiwgdW5wcmVmaXhlZCwgcHJlZml4ZWRFdmVudHNbdW5wcmVmaXhlZF0pO1xuXHRcdFx0ZGVsZXRlIGV2ZW50c1tzZWxlY3Rvcl07XG5cdFx0fVxuXHR9XG5cdHJldHVybiBldmVudHM7XG59O1xuXG52YXIgZ2V0Vmlld0RlcHRoID0gZnVuY3Rpb24odmlldykge1xuXHRpZiAoIXZpZXcpIHtcblx0XHRyZXR1cm4gbnVsbDtcblx0fVxuXHRpZiAoIXZpZXcuYXR0YWNoZWQpIHtcblx0XHRyZXR1cm4gTmFOO1xuXHR9XG5cdGlmICh2aWV3LnBhcmVudFZpZXcgPT09IG51bGwpIHtcblx0XHRyZXR1cm4gMDtcblx0fVxuXHRyZXR1cm4gdmlldy5wYXJlbnRWaWV3LnZpZXdEZXB0aCArIDE7XG59O1xuXG5mdW5jdGlvbiBsb2dBdHRhY2hJbmZvKHZpZXcsIG5hbWUsIGxldmVsKSB7XG5cdGlmIChbXCJsb2dcIiwgXCJpbmZvXCIsIFwid2FyblwiLCBcImVycm9yXCJdLmluZGV4T2YobGV2ZWwpICE9IC0xKSB7XG5cdFx0bGV2ZWwgPSBcImxvZ1wiO1xuXHR9XG5cdGNvbnNvbGVbbGV2ZWxdLmNhbGwoY29uc29sZSwgXCIlczo6JXMgW3BhcmVudDolcyAlcyAlcyBkZXB0aDolc11cIiwgdmlldy5jaWQsIG5hbWUsIHZpZXcucGFyZW50VmlldyAmJiB2aWV3LnBhcmVudFZpZXcuY2lkLCB2aWV3LmF0dGFjaGVkID8gXCJhdHRhY2hlZFwiIDogXCJkZXRhY2hlZFwiLCB2aWV3Ll92aWV3UGhhc2UsIHZpZXcudmlld0RlcHRoKTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogc3RhdGljIHB1YmxpY1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cbnZhciBWaWV3ID0ge1xuXG5cdC8qKiBAY29uc3QgKi9cblx0Tk9ORV9JTlZBTElEOiAwLFxuXHQvKiogQGNvbnN0ICovXG5cdENISUxEUkVOX0lOVkFMSUQ6IDEsXG5cblx0LyoqIEBjb25zdCAqL1xuXHRNT0RFTF9JTlZBTElEOiAyLFxuXHQvKiogQGNvbnN0ICovXG5cdFNUWUxFU19JTlZBTElEOiA0LFxuXHQvKiogQGNvbnN0ICovXG5cdFNJWkVfSU5WQUxJRDogOCxcblx0LyoqIEBjb25zdCAqL1xuXHRMQVlPVVRfSU5WQUxJRDogMTYsXG5cblx0LyoqIEBjb25zdCAqL1xuXHQvLyBSRU5ERVJfSU5WQUxJRDogOCB8IDE2LFxuXG5cdC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld0Vycm9yfSAqL1xuXHRWaWV3RXJyb3I6IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdFcnJvclwiKSxcblxuXHQvKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFByb3BlcnR5fSAqL1xuXHRwcmVmaXhlZFByb3BlcnR5OiByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRQcm9wZXJ0eVwiKSxcblxuXHQvKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFN0eWxlTmFtZX0gKi9cblx0cHJlZml4ZWRTdHlsZU5hbWU6IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFN0eWxlTmFtZVwiKSxcblxuXHQvKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZEV2ZW50fSAqL1xuXHRwcmVmaXhlZEV2ZW50OiByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRFdmVudFwiKSxcblxuXHQvLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9zZXRJbW1lZGlhdGV9ICovXG5cdC8vIHNldEltbWVkaWF0ZTogcmVxdWlyZShcInV0aWxzL3NldEltbWVkaWF0ZVwiKSxcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL3doZW5WaWV3SXNBdHRhY2hlZH0gKi9cblx0d2hlblZpZXdJc0F0dGFjaGVkOiByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuVmlld0lzQXR0YWNoZWRcIiksXG5cblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL3doZW5WaWV3SXNSZW5kZXJlZH0gKi9cblx0d2hlblZpZXdJc1JlbmRlcmVkOiByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuVmlld0lzUmVuZGVyZWRcIiksXG5cblx0LyoqXG5cdC8qIEBwYXJhbSBlbCB7SFRNTEVsZW1lbnR9XG5cdC8qIEByZXR1cm4ge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9XG5cdC8qL1xuXHRmaW5kQnlFbGVtZW50OiBmdW5jdGlvbihlbCkge1xuXHRcdGlmIChfdmlld3NCeUNpZFtlbC5jaWRdKSB7XG5cdFx0XHRyZXR1cm4gX3ZpZXdzQnlDaWRbZWwuY2lkXTtcblx0XHR9XG5cdFx0cmV0dXJuIG51bGw7XG5cdH0sXG5cblx0LyoqXG5cdC8qIEBwYXJhbSBlbCB7SFRNTEVsZW1lbnR9XG5cdC8qIEByZXR1cm4ge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9XG5cdC8qL1xuXHRmaW5kQnlEZXNjZW5kYW50OiBmdW5jdGlvbihlbCkge1xuXHRcdGRvIHtcblx0XHRcdGlmIChfdmlld3NCeUNpZFtlbC5jaWRdKSB7XG5cdFx0XHRcdHJldHVybiBfdmlld3NCeUNpZFtlbC5jaWRdO1xuXHRcdFx0fVxuXHRcdH0gd2hpbGUgKChlbCA9IGVsLnBhcmVudEVsZW1lbnQgfHwgZWwucGFyZW50Tm9kZSkpO1xuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0ZXh0ZW5kOiBmdW5jdGlvbihwcm90bywgb2JqKSB7XG5cdFx0aWYgKFByZWZpeGVkRXZlbnRzLmxlbmd0aCAmJiBwcm90by5ldmVudHMpIHtcblx0XHRcdGlmIChfLmlzRnVuY3Rpb24ocHJvdG8uZXZlbnRzKSkge1xuXHRcdFx0XHRwcm90by5ldmVudHMgPSBfLndyYXAocHJvdG8uZXZlbnRzLCBmdW5jdGlvbihmbikge1xuXHRcdFx0XHRcdHJldHVybiBhcHBseUV2ZW50UHJlZml4ZXMoZm4uYXBwbHkodGhpcykpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZVxuXHRcdFx0aWYgKF8uaXNPYmplY3QocHJvdG8uZXZlbnRzKSkge1xuXHRcdFx0XHRwcm90by5ldmVudHMgPSBhcHBseUV2ZW50UHJlZml4ZXMocHJvdG8uZXZlbnRzKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHByb3RvLnByb3BlcnRpZXMgJiYgdGhpcy5wcm90b3R5cGUucHJvcGVydGllcykge1xuXHRcdFx0Xy5kZWZhdWx0cyhwcm90by5wcm9wZXJ0aWVzLCB0aGlzLnByb3RvdHlwZS5wcm9wZXJ0aWVzKTtcblx0XHR9XG5cdFx0cmV0dXJuIEJhY2tib25lLlZpZXcuZXh0ZW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdH0sXG5cblx0X2ZsYWdzVG9TdHJpbmdzOiBbXCItXCJdLFxuXG5cdGZsYWdzVG9TdHJpbmc6IGZ1bmN0aW9uKGZsYWdzKSB7XG5cdFx0dmFyIHMgPSBWaWV3Ll9mbGFnc1RvU3RyaW5nc1tmbGFncyB8IDBdO1xuXHRcdGlmICghcykge1xuXHRcdFx0cyA9IFtdO1xuXHRcdFx0aWYgKGZsYWdzICYgVmlldy5DSElMRFJFTl9JTlZBTElEKSBzLnB1c2goXCJjaGlsZHJlblwiKTtcblx0XHRcdGlmIChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkgcy5wdXNoKFwibW9kZWxcIik7XG5cdFx0XHRpZiAoZmxhZ3MgJiBWaWV3LlNUWUxFU19JTlZBTElEKSBzLnB1c2goXCJzdHlsZXNcIik7XG5cdFx0XHRpZiAoZmxhZ3MgJiBWaWV3LlNJWkVfSU5WQUxJRCkgcy5wdXNoKFwic2l6ZVwiKTtcblx0XHRcdGlmIChmbGFncyAmIFZpZXcuTEFZT1VUX0lOVkFMSUQpIHMucHVzaChcImxheW91dFwiKTtcblx0XHRcdFZpZXcuX2ZsYWdzVG9TdHJpbmdzW2ZsYWdzXSA9IHMgPSBzLmpvaW4oXCIgXCIpO1xuXHRcdH1cblx0XHRyZXR1cm4gcztcblx0XHQvLyByZXR1cm4gKGZsYWdzIHwgMCkudG9TdHJpbmcoMik7XG5cdH0sXG59O1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoVmlldywgXCJpbnN0YW5jZXNcIiwge1xuXHR2YWx1ZTogX3ZpZXdzQnlDaWQsXG5cdGVudW1lcmFibGU6IHRydWVcbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBwcm90b3R5cGVcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxudmFyIFZpZXdQcm90byA9IHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcInZpZXdcIixcblx0LyoqIEB0eXBlIHtCb29sZWFufSAqL1xuXHRfYXR0YWNoZWQ6IGZhbHNlLFxuXHQvKiogQHR5cGUge0hUTUxFbGVtZW50fG51bGx9ICovXG5cdF9wYXJlbnRWaWV3OiBudWxsLFxuXHQvKiogQHR5cGUge2ludHxudWxsfSAqL1xuXHRfdmlld0RlcHRoOiBudWxsLFxuXHQvKiogQHR5cGUge3N0cmluZ30gaW5pdGlhbGl6aW5nID4gaW5pdGlhbGl6ZWQgPiBkaXNwb3NpbmcgPiBkaXNwb3NlZCAqL1xuXHRfdmlld1BoYXNlOiBcImluaXRpYWxpemluZ1wiLFxuXHQvKiogQHR5cGUge2ludH0gKi9cblx0X2ZyYW1lUXVldWVJZDogLTEsXG5cdC8qKiBAdHlwZSB7aW50fSAqL1xuXHRfcmVuZGVyRmxhZ3M6IDAsXG5cblx0LyoqIEB0eXBlIHtvYmplY3R9ICovXG5cdHByb3BlcnRpZXM6IHtcblx0XHRjaWQ6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9jaWQgfHwgKHRoaXMuX2NpZCA9IHRoaXMuY2lkUHJlZml4ICsgX2NpZFNlZWQrKyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRhdHRhY2hlZDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2F0dGFjaGVkO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0cGFyZW50Vmlldzoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3BhcmVudFZpZXc7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHR2aWV3RGVwdGg6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9nZXRWaWV3RGVwdGgoKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGludmFsaWRhdGVkOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZnJhbWVRdWV1ZUlkICE9PSAtMTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdGVuYWJsZWQ6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9lbmFibGVkO1xuXHRcdFx0fSxcblx0XHRcdHNldDogZnVuY3Rpb24oZW5hYmxlZCkge1xuXHRcdFx0XHR0aGlzLnNldEVuYWJsZWQoZW5hYmxlZCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRyZW5kZXJGbGFnczoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3JlbmRlckZsYWdzO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvKipcblx0ICogQGNvbnN0cnVjdG9yXG5cdCAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fVxuXHQgKi9cblx0Y29uc3RydWN0b3I6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLnRyYW5zZm9ybSA9IHt9O1xuXHRcdHRoaXMuY2hpbGRWaWV3cyA9IHt9O1xuXHRcdHRoaXMuX2FwcGx5UmVuZGVyID0gdGhpcy5fYXBwbHlSZW5kZXIuYmluZCh0aGlzKTtcblxuXHRcdGlmICh0aGlzLnByb3BlcnRpZXMpIHtcblx0XHRcdC8vIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIGdldFByb3RvdHlwZUNoYWluVmFsdWUodGhpcywgXCJwcm9wZXJ0aWVzXCIsIEJhY2tib25lLlZpZXcpKTtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMsIHRoaXMucHJvcGVydGllcyk7XG5cdFx0fVxuXHRcdGlmIChvcHRpb25zICYmIG9wdGlvbnMuY2xhc3NOYW1lICYmIHRoaXMuY2xhc3NOYW1lKSB7XG5cdFx0XHRvcHRpb25zLmNsYXNzTmFtZSArPSBcIiBcIiArIF8ucmVzdWx0KHRoaXMsIFwiY2xhc3NOYW1lXCIpO1xuXHRcdH1cblx0XHRpZiAob3B0aW9ucyAmJiBvcHRpb25zLnBhcmVudFZpZXcpIHtcblx0XHRcdHRoaXMuX3NldFBhcmVudFZpZXcob3B0aW9ucy5wYXJlbnRWaWV3LCB0cnVlKTtcblx0XHR9XG5cdFx0QmFja2JvbmUuVmlldy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6aW5pdGlhbGl6ZSB2aWV3UGhhc2U6WyVzID0+IGluaXRpYWxpemVkXVwiLCB0aGlzLmNpZCwgdGhpcy5fdmlld1BoYXNlKTtcblx0XHR0aGlzLl92aWV3UGhhc2UgPSBcImluaXRpYWxpemVkXCI7XG5cblx0XHRpZiAodGhpcy5wYXJlbnRWaWV3ICE9PSBudWxsKSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnBhcmVudENoYW5nZVwiLCB0aGlzLnBhcmVudFZpZXcsIG51bGwpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5hdHRhY2hlZCkge1xuXHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzphdHRhY2hlZFwiLCB0aGlzKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiByZW1vdmVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVtb3ZlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fdmlld1BoYXNlID09IFwiZGlzcG9zaW5nXCIpIHtcblx0XHRcdGxvZ0F0dGFjaEluZm8odGhpcywgXCJyZW1vdmVcIiwgXCJ3YXJuXCIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBsb2dBdHRhY2hJbmZvKHRoaXMsIFwicmVtb3ZlXCIsIFwibG9nXCIpO1xuXHRcdH1cblxuXHRcdC8vIGJlZm9yZSByZW1vdmFsXG5cdFx0dGhpcy5fdmlld1BoYXNlID0gXCJkaXNwb3NpbmdcIjtcblx0XHR0aGlzLl9jYW5jZWxSZW5kZXIoKTtcblxuXHRcdC8vIGNhbGwgQmFja2JvbmUgaW1wbFxuXHRcdC8vIEJhY2tib25lLlZpZXcucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0Ly8gTk9URTogZnJvbSBCYWNrYm9uZSBpbXBsXG5cdFx0dGhpcy4kZWwucmVtb3ZlKCk7IC8vIGZyb20gQmFja2JvbmUgaW1wbFxuXG5cdFx0dGhpcy5fYXR0YWNoZWQgPSBmYWxzZTtcblx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnJlbW92ZWRcIiwgdGhpcyk7XG5cblx0XHQvLyByZW1vdmUgcGFyZW50L2NoaWxkIHJlZmVyZW5jZXNcblx0XHR0aGlzLl9zZXRQYXJlbnRWaWV3KG51bGwpO1xuXG5cdFx0Ly8gTk9URTogZnJvbSBCYWNrYm9uZSBpbXBsLiBObyBtb3JlIGV2ZW50cyBhZnRlciB0aGlzXG5cdFx0dGhpcy5zdG9wTGlzdGVuaW5nKCk7XG5cblx0XHQvLyBjaGVjayBmb3IgaW52YWxpZGF0aW9ucyB0aGF0IG1heSBoYXZlIGJlZW4gdHJpZ2dlcmVkIGJ5IFwidmlldzpyZW1vdmVkXCJcblx0XHRpZiAodGhpcy5pbnZhbGlkYXRlZCkge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiJXM6OnJlbW92ZSBpbnZhbGlkYXRlZCBhZnRlciByZW1vdmUoKVwiLCB0aGlzLmNpZCk7XG5cdFx0XHR0aGlzLl9jYW5jZWxSZW5kZXIoKTtcblx0XHR9XG5cdFx0Ly8gLy8gY2hlY2sgZm9yIGNoaWxkcmVuIHN0aWxsIGhlcmVcblx0XHQvLyB2YXIgY2NpZHMgPSBPYmplY3Qua2V5cyh0aGlzLmNoaWxkVmlld3MpO1xuXHRcdC8vIGlmIChjY2lkcy5sZW5ndGgpIHtcblx0XHQvLyBcdGNvbnNvbGUud2FybihcIiVzOjpyZW1vdmUgJWkgY2hpbGRyZW4gbm90IHJlbW92ZWQgWyVzXVwiLCB0aGlzLmNpZCwgY2NpZHMubGVuZ3RoLCBjY2lkcy5qb2luKFwiLCBcIiksIHRoaXMuY2hpbGRWaWV3cyk7XG5cdFx0Ly8gfVxuXHRcdC8vIC8vIHJlbW92ZSBjaGlsZFZpZXdzXG5cdFx0Ly8gZm9yICh2YXIgY2lkIGluIHRoaXMuY2hpbGRWaWV3cykge1xuXHRcdC8vIFx0dGhpcy5jaGlsZFZpZXdzW2NpZF0ucmVtb3ZlKCk7XG5cdFx0Ly8gfVxuXHRcdC8vIGNsZWFyIHJlZmVyZW5jZSBpbiB2aWV3IG1hcFxuXHRcdGRlbGV0ZSBfdmlld3NCeUNpZFt0aGlzLmNpZF07XG5cdFx0Ly8gZGVsZXRlIHRoaXMuZWwuY2lkO1xuXHRcdC8vIHVwZGF0ZSBwaGFzZVxuXHRcdHRoaXMuX3ZpZXdQaGFzZSA9IFwiZGlzcG9zZWRcIjtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIF9lbGVtZW50QXR0YWNoZWQgX2VsZW1lbnREZXRhY2hlZFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2VsZW1lbnRBdHRhY2hlZDogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gdGhpcy5fYWRkVG9QYXJlbnRWaWV3KCk7XG5cdFx0dGhpcy5fYXR0YWNoZWQgPSB0cnVlO1xuXHRcdHRoaXMuX3ZpZXdEZXB0aCA9IG51bGw7XG5cdFx0dGhpcy5fc2V0UGFyZW50VmlldyhWaWV3LmZpbmRCeURlc2NlbmRhbnQodGhpcy5lbC5wYXJlbnRFbGVtZW50KSk7XG5cblx0XHQvLyBpZiAodGhpcy5wYXJlbnRWaWV3KSB7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhcIlthdHRhY2hdIFslaV0gJXMgPiAlczo6X2VsZW1lbnRBdHRhY2hlZFwiLCB0aGlzLnZpZXdEZXB0aCwgdGhpcy5wYXJlbnRWaWV3LmNpZCwgdGhpcy5jaWQpO1xuXHRcdC8vIH0gZWxzZSB7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhcIlthdHRhY2hdIFslaV0gJXM6Ol9lbGVtZW50QXR0YWNoZWRcIiwgdGhpcy52aWV3RGVwdGgsIHRoaXMuY2lkKTtcblx0XHQvLyB9XG5cblx0XHQvLyBpZiAodGhpcy5fdmlld1BoYXNlID09IFwiaW5pdGlhbGl6aW5nXCIpIHtcblx0XHQvLyBcdC8vIHRoaXMudHJpZ2dlcihcInZpZXc6YXR0YWNoZWRcIiwgdGhpcyk7XG5cdFx0Ly8gfSBlbHNlXG5cdFx0aWYgKHRoaXMuX3ZpZXdQaGFzZSA9PSBcImluaXRpYWxpemVkXCIpIHtcblx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6YXR0YWNoZWRcIiwgdGhpcyk7XG5cdFx0fSBlbHNlXG5cdFx0aWYgKHRoaXMuX3ZpZXdQaGFzZSA9PSBcInJlcGxhY2luZ1wiKSB7XG5cdFx0XHR0aGlzLl92aWV3UGhhc2UgPSBcImluaXRpYWxpemVkXCI7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnJlcGxhY2VkXCIsIHRoaXMpO1xuXHRcdH1cblx0fSxcblxuXHRfZWxlbWVudERldGFjaGVkOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoIXRoaXMuYXR0YWNoZWQgfHwgKHRoaXMuX3ZpZXdQaGFzZSA9PSBcImRpc3Bvc2luZ1wiKSB8fCAodGhpcy5fdmlld1BoYXNlID09IFwiZGlzcG9zZWRcIikpIHtcblx0XHRcdGxvZ0F0dGFjaEluZm8odGhpcywgXCJfZWxlbWVudERldGFjaGVkXCIsIFwiZXJyb3JcIik7XG5cdFx0XHQvLyB9IGVsc2Uge1xuXHRcdFx0Ly8gXHRsb2dBdHRhY2hJbmZvKHRoaXMsIFwiX2VsZW1lbnREZXRhY2hlZFwiLCBcImxvZ1wiKTtcblx0XHR9XG5cdFx0dGhpcy5fYXR0YWNoZWQgPSBmYWxzZTtcblx0XHR0aGlzLl92aWV3RGVwdGggPSBudWxsO1xuXG5cdFx0aWYgKHRoaXMuX3ZpZXdQaGFzZSAhPSBcImRpc3Bvc2luZ1wiIHx8IHRoaXMuX3ZpZXdQaGFzZSA9PSBcImRpc3Bvc2VkXCIpIHtcblx0XHRcdHRoaXMucmVtb3ZlKCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogcGFyZW50Vmlld1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X3NldFBhcmVudFZpZXc6IGZ1bmN0aW9uKG5ld1BhcmVudCwgc2lsZW50KSB7XG5cdFx0aWYgKG5ld1BhcmVudCA9PT0gdm9pZCAwKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCIkczo6X3NldFBhcmVudFZpZXcgaW52YWxpZCB2YWx1ZSAnJXMnXCIsIHRoaXMuY2lkLCBuZXdQYXJlbnQpO1xuXHRcdFx0bmV3UGFyZW50ID0gbnVsbDtcblx0XHR9XG5cdFx0dmFyIG9sZFBhcmVudCA9IHRoaXMuX3BhcmVudFZpZXc7XG5cdFx0dGhpcy5fcGFyZW50VmlldyA9IG5ld1BhcmVudDtcblxuXHRcdC8vIGZvcmNlIHVwZGF0ZSBvZiBfdmlld0RlcHRoXG5cdFx0dGhpcy5fdmlld0RlcHRoID0gbnVsbDsgLy9nZXRWaWV3RGVwdGgodGhpcyk7XG5cblx0XHQvLyBza2lwIHRoZSByZXN0IGlmIGFyZyBpcyB0aGUgc2FtZVxuXHRcdGlmIChuZXdQYXJlbnQgPT09IG9sZFBhcmVudCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAob2xkUGFyZW50ICE9PSBudWxsKSB7XG5cdFx0XHRpZiAodGhpcy5jaWQgaW4gb2xkUGFyZW50LmNoaWxkVmlld3MpIHtcblx0XHRcdFx0ZGVsZXRlIG9sZFBhcmVudC5jaGlsZFZpZXdzW3RoaXMuY2lkXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKG5ld1BhcmVudCAhPT0gbnVsbCkge1xuXHRcdFx0bmV3UGFyZW50LmNoaWxkVmlld3NbdGhpcy5jaWRdID0gdGhpcztcblx0XHR9XG5cdFx0aWYgKCFzaWxlbnQpXG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnBhcmVudENoYW5nZVwiLCB0aGlzLCBuZXdQYXJlbnQsIG9sZFBhcmVudCk7XG5cdH0sXG5cblx0d2hlbkF0dGFjaGVkOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gVmlldy53aGVuVmlld0lzQXR0YWNoZWQodGhpcyk7XG5cdH0sXG5cblx0X2dldFZpZXdEZXB0aDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX3ZpZXdEZXB0aCA9PT0gbnVsbCkge1xuXHRcdFx0dGhpcy5fdmlld0RlcHRoID0gZ2V0Vmlld0RlcHRoKHRoaXMpO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5fdmlld0RlcHRoO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogQmFja2JvbmUuVmlldyBvdmVycmlkZXNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0c2V0RWxlbWVudDogZnVuY3Rpb24oZWxlbWVudCwgZGVsZWdhdGUpIHtcblx0XHQvLyBzZXRFbGVtZW50IGFsd2F5cyBpbml0aWFsaXplcyB0aGlzLmVsLCBzbyBjaGVjayBpdCB0byBiZSBub24tbnVsbCBiZWZvcmUgY2FsbGluZyBzdXBlclxuXHRcdGlmICh0aGlzLmVsKSB7XG5cdFx0XHRpZiAodGhpcy5lbCAhPT0gZWxlbWVudCAmJiB0aGlzLmVsLnBhcmVudEVsZW1lbnQpIHtcblx0XHRcdFx0Ly8gRWxlbWVudCBpcyBiZWluZyByZXBsYWNlZFxuXHRcdFx0XHRpZiAodGhpcy5hdHRhY2hlZCkge1xuXHRcdFx0XHRcdC8vIFNpbmNlIG9sZCBlbGVtZW50IGlzIGF0dGFjaGVkIHRvIGRvY3VtZW50IHRyZWUsIF9lbGVtZW50QXR0YWNoZWQgd2lsbCBiZVxuXHRcdFx0XHRcdC8vIHRyaWdnZXJlZCBieSByZXBsYWNlQ2hpbGQ6IHNldCBfdmlld1BoYXNlID0gXCJyZXBsYWNpbmdcIiB0byBmbGFnIHRoaXNcblx0XHRcdFx0XHQvLyBjaGFuZ2UgYW5kIHRyaWdnZXIgJ3ZpZXc6cmVwbGFjZWQnIGluc3RlYWQgb2YgJ3ZpZXc6YWRkZWQnLlxuXHRcdFx0XHRcdHRoaXMuX3ZpZXdQaGFzZSA9IFwicmVwbGFjaW5nXCI7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5lbC5wYXJlbnRFbGVtZW50LnJlcGxhY2VDaGlsZChlbGVtZW50LCB0aGlzLmVsKTtcblx0XHRcdH1cblx0XHRcdEJhY2tib25lLlZpZXcucHJvdG90eXBlLnNldEVsZW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdC8vIE1lcmdlIGNsYXNzZXMgc3BlY2lmaWVkIGJ5IHRoaXMgdmlldyB3aXRoIHRoZSBvbmVzIGFscmVhZHkgaW4gdGhlIGVsZW1lbnQsXG5cdFx0XHQvLyBhcyBiYWNrYm9uZSB3aWxsIG5vdDpcblx0XHRcdGlmICh0aGlzLmNsYXNzTmFtZSkge1xuXHRcdFx0XHRfLnJlc3VsdCh0aGlzLCBcImNsYXNzTmFtZVwiKS5zcGxpdChcIiBcIikuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKGl0ZW0pO1xuXHRcdFx0XHR9LCB0aGlzKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0QmFja2JvbmUuVmlldy5wcm90b3R5cGUuc2V0RWxlbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLmVsID09PSB2b2lkIDApIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIkJhY2tib25lIHZpZXcgaGFzIG5vIGVsZW1lbnRcIik7XG5cdFx0fVxuXHRcdF92aWV3c0J5Q2lkW3RoaXMuY2lkXSA9IHRoaXM7XG5cdFx0dGhpcy5lbC5jaWQgPSB0aGlzLmNpZDtcblx0XHR0aGlzLmVsLnNldEF0dHJpYnV0ZShcImRhdGEtY2lkXCIsIHRoaXMuY2lkKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogcmVxdWVzdEFuaW1hdGlvbkZyYW1lXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWU6IGZ1bmN0aW9uKGNhbGxiYWNrLCBwcmlvcml0eSwgY3R4KSB7XG5cdFx0cmV0dXJuIEZyYW1lUXVldWUucmVxdWVzdChjYWxsYmFjay5iaW5kKGN0eCB8fCB0aGlzKSwgcHJpb3JpdHkpO1xuXHR9LFxuXG5cdGNhbmNlbEFuaW1hdGlvbkZyYW1lOiBmdW5jdGlvbihpZCkge1xuXHRcdHJldHVybiBGcmFtZVF1ZXVlLmNhbmNlbChpZCk7XG5cdH0sXG5cblx0c2V0SW1tZWRpYXRlOiBmdW5jdGlvbihjYWxsYmFjaywgY3R4KSB7XG5cdFx0d2luZG93LnNldEltbWVkaWF0ZShjYWxsYmFjay5iaW5kKGN0eCB8fCB0aGlzKSk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBkZWZlcnJlZCByZW5kZXI6IHByaXZhdGUgbWV0aG9kc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBwcml2YXRlICovXG5cdF9hcHBseVJlbmRlcjogZnVuY3Rpb24odHN0YW1wKSB7XG5cdFx0aWYgKERFQlVHKSB7XG5cdFx0XHRpZiAoIXRoaXMuX3NraXBMb2cpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCIlczo6X2FwcGx5UmVuZGVyIFslc10gWyVzLCAlcywgJXNdXCIsIHRoaXMuY2lkLFxuXHRcdFx0XHRcdFZpZXcuZmxhZ3NUb1N0cmluZyh0aGlzLl9yZW5kZXJGbGFncyksXG5cdFx0XHRcdFx0KHRoaXMuX2ZyYW1lUXVldWVJZCAhPSAtMSA/IFwiYXN5bmMgI1wiICsgdGhpcy5fZnJhbWVRdWV1ZUlkIDogXCJzeW5jXCIpLFxuXHRcdFx0XHRcdCh0aGlzLmF0dGFjaGVkID8gXCJhdHRhY2hlZFwiIDogXCJkZXRhY2hlZFwiKSxcblx0XHRcdFx0XHQodGhpcy5za2lwVHJhbnNpdGlvbnMgPyBcInNraXBcIiA6IFwicnVuXCIpICsgXCIgdHhcIlxuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHZhciBmbGFncyA9IHRoaXMuX3JlbmRlckZsYWdzO1xuXHRcdHRoaXMudHJpZ2dlcihcInZpZXc6cmVuZGVyOmJlZm9yZVwiLCB0aGlzLCBmbGFncyk7XG5cdFx0dGhpcy5fcmVuZGVyRmxhZ3MgPSAwO1xuXHRcdHRoaXMuX2ZyYW1lUXVldWVJZCA9IC0xO1xuXHRcdHRoaXMuX3JlbmRlckZsYWdzIHw9IHRoaXMucmVuZGVyRnJhbWUodHN0YW1wLCBmbGFncyk7XG5cdFx0dGhpcy50cmlnZ2VyKFwidmlldzpyZW5kZXI6YWZ0ZXJcIiwgdGhpcywgZmxhZ3MpO1xuXG5cdFx0aWYgKHRoaXMuX3JlbmRlckZsYWdzICE9IDApIHtcblx0XHRcdGNvbnNvbGUud2FybihcIiVzOjpfYXBwbHlSZW5kZXIgW3JldHVybmVkXSBmbGFnczogJXNcIiwgdGhpcy5jaWQsIFZpZXcuZmxhZ3NUb1N0cmluZyh0aGlzLl9yZW5kZXJGbGFncyksIHRoaXMuX3JlbmRlckZsYWdzKTtcblx0XHR9XG5cdH0sXG5cblx0X2NhbmNlbFJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX2ZyYW1lUXVldWVJZCAhPSAtMSkge1xuXHRcdFx0dmFyIGNhbmNlbElkLCBjYW5jZWxGbjtcblxuXHRcdFx0Y2FuY2VsSWQgPSB0aGlzLl9mcmFtZVF1ZXVlSWQ7XG5cdFx0XHR0aGlzLl9mcmFtZVF1ZXVlSWQgPSAtMTtcblx0XHRcdGNhbmNlbEZuID0gRnJhbWVRdWV1ZS5jYW5jZWwoY2FuY2VsSWQpO1xuXG5cdFx0XHRpZiAoY2FuY2VsRm4gPT09IHZvaWQgMCkge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCIlczo6X2NhbmNlbFJlbmRlciBJRDolaSBub3QgZm91bmRcIiwgdGhpcy5jaWQsIGNhbmNlbElkKTtcblx0XHRcdH0gZWxzZSBpZiAoY2FuY2VsRm4gPT09IG51bGwpIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiJXM6Ol9jYW5jZWxSZW5kZXIgSUQ6JWkgYWxyZWFkeSBjYW5jZWxsZWRcIiwgdGhpcy5jaWQsIGNhbmNlbElkKTtcblx0XHRcdFx0Ly8gfSBlbHNlIHtcblx0XHRcdFx0Ly8gXHRpZiAoIXRoaXMuX3NraXBMb2cgJiYgIUZyYW1lUXVldWUucnVubmluZylcblx0XHRcdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9jYW5jZWxSZW5kZXIgSUQ6JWkgY2FuY2VsbGVkXCIsIHRoaXMuY2lkLCBjYW5jZWxJZCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF9yZXF1ZXN0UmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoRnJhbWVRdWV1ZS5ydW5uaW5nKSB7XG5cdFx0XHR0aGlzLl9jYW5jZWxSZW5kZXIoKTtcblx0XHRcdGlmIChERUJVRykge1xuXHRcdFx0XHRpZiAoIXRoaXMuX3NraXBMb2cpIHtcblx0XHRcdFx0XHRjb25zb2xlLmluZm8oXCIlczo6X3JlcXVlc3RSZW5kZXIgcmVzY2hlZHVsZWQgWyVzICglcyldXCIsIHRoaXMuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcodGhpcy5fcmVuZGVyRmxhZ3MpLCB0aGlzLl9yZW5kZXJGbGFncyk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHRoaXMuX2ZyYW1lUXVldWVJZCA9PSAtMSkge1xuXHRcdFx0dGhpcy5fZnJhbWVRdWV1ZUlkID0gRnJhbWVRdWV1ZS5yZXF1ZXN0KHRoaXMuX2FwcGx5UmVuZGVyLCBpc05hTih0aGlzLnZpZXdEZXB0aCkgPyBOdW1iZXIuTUFYX1ZBTFVFIDogdGhpcy52aWV3RGVwdGgpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHJlbmRlcjogcHVibGljIC8gYWJzdHJhY3QgbWV0aG9kc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0aW52YWxpZGF0ZTogZnVuY3Rpb24oZmxhZ3MpIHtcblx0XHRpZiAoZmxhZ3MgIT09IHZvaWQgMCkge1xuXHRcdFx0LyppZiAoREVCVUcpIHtcblx0XHRcdFx0aWYgKCF0aGlzLl9za2lwTG9nKSB7XG5cdFx0XHRcdFx0aWYgKHRoaXMuX3JlbmRlckZsYWdzID4gMCkge1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coXCIlczo6aW52YWxpZGF0ZSBbJXMgKCVzKV0gKyBbJXMgKCVzKV1cIiwgdGhpcy5jaWQsIFZpZXcuZmxhZ3NUb1N0cmluZyh0aGlzLl9yZW5kZXJGbGFncyksIHRoaXMuX3JlbmRlckZsYWdzLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpLCBmbGFncyk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6OmludmFsaWRhdGUgWyVzICglcyldXCIsIHRoaXMuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpLCBmbGFncyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9Ki9cblx0XHRcdHRoaXMuX3JlbmRlckZsYWdzIHw9IGZsYWdzO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRyZXF1ZXN0UmVuZGVyOiBmdW5jdGlvbihmbGFncykge1xuXHRcdC8vIGlmIChmbGFncyAhPT0gdm9pZCAwKSB7XG5cdFx0Ly8gXHR0aGlzLl9yZW5kZXJGbGFncyB8PSBmbGFncztcblx0XHQvLyB9XG5cdFx0dGhpcy5pbnZhbGlkYXRlKGZsYWdzKTtcblx0XHR0aGlzLl9yZXF1ZXN0UmVuZGVyKCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyoqIEBhYnN0cmFjdCAqL1xuXHRyZW5kZXJGcmFtZTogZnVuY3Rpb24odHN0YW1wLCBmbGFncykge1xuXHRcdC8vIHN1YmNsYXNzZXMgc2hvdWxkIG92ZXJyaWRlIHRoaXMgbWV0aG9kXG5cdFx0cmV0dXJuIFZpZXcuTk9ORV9JTlZBTElEO1xuXHR9LFxuXG5cdHJlbmRlck5vdzogZnVuY3Rpb24oYWx3YXlzUnVuKSB7XG5cdFx0aWYgKHRoaXMuX2ZyYW1lUXVldWVJZCAhPSAtMSkge1xuXHRcdFx0dGhpcy5fY2FuY2VsUmVuZGVyKCk7XG5cdFx0XHRhbHdheXNSdW4gPSB0cnVlO1xuXHRcdH1cblx0XHQvLyBpZiAoYWx3YXlzUnVuID09PSB0cnVlKSB7XG5cdFx0aWYgKGFsd2F5c1J1bikge1xuXHRcdFx0dGhpcy5fYXBwbHlSZW5kZXIoX25vdygpKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0d2hlblJlbmRlcmVkOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gVmlldy53aGVuVmlld0lzUmVuZGVyZWQodGhpcyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiByZW5kZXIgYml0d2lzZSBmbGFnc1xuXHQvKiAtIGNoZWNrOiB0aGlzLl9yZW5kZXJGbGFncyAmIGZsYWdzXG5cdC8qIC0gYWRkOiB0aGlzLl9yZW5kZXJGbGFncyB8PSBmbGFnc1xuXHQvKiAtIHJlbW92ZTogdGhpcy5fcmVuZGVyRmxhZ3MgJj0gfmZsYWdzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiBoZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlcXVlc3RDaGlsZHJlblJlbmRlcjogZnVuY3Rpb24oZmxhZ3MsIG5vdywgZm9yY2UpIHtcblx0XHR2YXIgY2NpZCwgdmlldztcblx0XHRmb3IgKGNjaWQgaW4gdGhpcy5jaGlsZFZpZXdzKSB7XG5cdFx0XHR2aWV3ID0gdGhpcy5jaGlsZFZpZXdzW2NjaWRdO1xuXHRcdFx0dmlldy5za2lwVHJhbnNpdGlvbnMgPSAhIShmbGFncyAmIFZpZXcuU0laRV9JTlZBTElEKTtcblx0XHRcdHZpZXcucmVxdWVzdFJlbmRlcihmbGFncyk7XG5cdFx0XHRpZiAobm93KSB7XG5cdFx0XHRcdHZpZXcucmVuZGVyTm93KGZvcmNlKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5yZW5kZXJOb3codHJ1ZSk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBjb21tb24gYWJzdHJhY3Rcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRfZW5hYmxlZDogdW5kZWZpbmVkLFxuXG5cdC8qKlxuXHQvKiBAcGFyYW0ge0Jvb2xlYW59XG5cdC8qL1xuXHRzZXRFbmFibGVkOiBmdW5jdGlvbihlbmFibGUpIHtcblx0XHR0aGlzLl9lbmFibGVkID0gZW5hYmxlO1xuXHR9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZChWaWV3UHJvdG8sIFZpZXcpOyIsImZ1bmN0aW9uIFZpZXdFcnJvcih2aWV3LCBlcnIpIHtcblx0dGhpcy52aWV3ID0gdmlldztcblx0dGhpcy5lcnIgPSBlcnI7XG5cdHRoaXMubWVzc2FnZSA9IGVyci5tZXNzYWdlO1xufVxuVmlld0Vycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcblZpZXdFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBWaWV3RXJyb3I7XG5WaWV3RXJyb3IucHJvdG90eXBlLm5hbWUgPSBcIlZpZXdFcnJvclwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFZpZXdFcnJvcjtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxLCBoZWxwZXIsIGFsaWFzMT1kZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LCBhbGlhczI9aGVscGVycy5oZWxwZXJNaXNzaW5nLCBhbGlhczM9Y29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24sIGFsaWFzND1cImZ1bmN0aW9uXCI7XG5cbiAgcmV0dXJuIFwiPGEgaHJlZj1cXFwiXCJcbiAgICArIGFsaWFzMygoaGVscGVycy5nbG9iYWwgfHwgKGRlcHRoMCAmJiBkZXB0aDAuZ2xvYmFsKSB8fCBhbGlhczIpLmNhbGwoYWxpYXMxLFwiQVBQX1JPT1RcIix7XCJuYW1lXCI6XCJnbG9iYWxcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkpXG4gICAgKyBcIiNcIlxuICAgICsgYWxpYXMzKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuaGFuZGxlIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5oYW5kbGUgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXM0ID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcImhhbmRsZVwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiPlwiXG4gICAgKyAoKHN0YWNrMSA9ICgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMubmFtZSB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAubmFtZSA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczQgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwibmFtZVwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKSAhPSBudWxsID8gc3RhY2sxIDogXCJcIilcbiAgICArIFwiPC9hPlxcblwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvKipcbi8qIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVWaWV3XG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciB2aWV3VGVtcGxhdGUgPSByZXF1aXJlKFwiLi9BcnRpY2xlQnV0dG9uLmhic1wiKTtcblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVCdXR0b259XG4vKi9cbnZhciBBcnRpY2xlQnV0dG9uID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwiYXJ0aWNsZUJ1dHRvblwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwiaDJcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwiYXJ0aWNsZS1idXR0b25cIixcblx0LyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cblx0dGVtcGxhdGU6IHZpZXdUZW1wbGF0ZSxcblxuXHRldmVudHM6IHtcblx0XHRcImNsaWNrIGFcIjogZnVuY3Rpb24oZG9tZXYpIHtcblx0XHRcdGRvbWV2LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZG9tZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6Y2xpY2tcIiwgdGhpcy5tb2RlbCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIC8qKiBAb3ZlcnJpZGUgKi9cblx0Ly8gaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge30sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogUmVuZGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlbmRlckZyYW1lOiBmdW5jdGlvbih0c3RhbXAsIGZsYWdzKSB7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwudG9KU09OKCkpO1xuXHR9LFxufSk7XG5tb2R1bGUuZXhwb3J0cyA9IEFydGljbGVCdXR0b247IiwiLyoqXG4vKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9BcnRpY2xlVmlld1xuLyovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvbmV0L3RvQWJzb2x1dGVVUkx9ICovXG4vLyB2YXIgdG9BYnNvbHV0ZVVSTCA9IHJlcXVpcmUoXCJ1dGlscy9uZXQvdG9BYnNvbHV0ZVVSTFwiKTtcbi8vXG4vLyAvKiogQHR5cGUge3N0cmluZ30gKi9cbi8vIHZhciBBQlNfQVBQX1JPT1QgPSB0b0Fic29sdXRlVVJMKHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpLkFQUF9ST09UKTtcblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVWaWV3fVxuLyovXG52YXIgQXJ0aWNsZVZpZXcgPSBWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJhcnRpY2xlVmlld1wiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwiYXJ0aWNsZVwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJhcnRpY2xlLXZpZXcgbWRvd25cIixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHt9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZW5kZXJGcmFtZTogZnVuY3Rpb24odHN0YW1wLCBmbGFncykge1xuXHRcdHRoaXMuZWwuaW5uZXJIVE1MID0gdGhpcy5tb2RlbC5nZXQoXCJ0ZXh0XCIpO1xuXHRcdC8vIEZJWE1FOiBub3cgZG9uZSBpbiB4c2x0XG5cdFx0Ly8gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiYVtocmVmXVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0Ly8gXHR2YXIgdXJsID0gdG9BYnNvbHV0ZVVSTChlbC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpKTtcblx0XHQvLyBcdGlmICh1cmwuaW5kZXhPZihBQlNfQVBQX1JPT1QpICE9PSAwKSB7XG5cdFx0Ly8gXHRcdGVsLnNldEF0dHJpYnV0ZShcInRhcmdldFwiLCBcIl9ibGFua1wiKTtcblx0XHQvLyBcdH1cblx0XHQvLyB9KTtcblx0fSxcbn0pO1xubW9kdWxlLmV4cG9ydHMgPSBBcnRpY2xlVmlldzsiLCIvKipcbi8qIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L0Nhcm91c2VsXG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lLmJhYnlzaXR0ZXJ9ICovXG52YXIgQ29udGFpbmVyID0gcmVxdWlyZShcImJhY2tib25lLmJhYnlzaXR0ZXJcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzfSAqL1xudmFyIEhhbW1lciA9IHJlcXVpcmUoXCJoYW1tZXJqc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3RvdWNoL1Ntb290aFBhblJlY29nbml6ZXJ9ICovXG52YXIgUGFuID0gcmVxdWlyZShcInV0aWxzL3RvdWNoL1Ntb290aFBhblJlY29nbml6ZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTpoYW1tZXJqcy5UYXB9ICovXG52YXIgVGFwID0gSGFtbWVyLlRhcDtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL0RlZmVycmVkVmlld30gKi9cbi8vIHZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvRGVmZXJyZWRWaWV3XCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvQ2Fyb3VzZWxSZW5kZXJlcn0gKi9cbnZhciBDYXJvdXNlbFJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9DYXJvdXNlbFJlbmRlcmVyXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFByb3BlcnR5fSAqL1xudmFyIHByZWZpeGVkUHJvcGVydHkgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRQcm9wZXJ0eVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkU3R5bGVOYW1lfSAqL1xudmFyIHByZWZpeGVkU3R5bGVOYW1lID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkU3R5bGVOYW1lXCIpO1xuXG52YXIgdHJhbnNmb3JtU3R5bGVOYW1lID0gcHJlZml4ZWRTdHlsZU5hbWUoXCJ0cmFuc2Zvcm1cIik7XG52YXIgdHJhbnNmb3JtUHJvcGVydHkgPSBwcmVmaXhlZFByb3BlcnR5KFwidHJhbnNmb3JtXCIpO1xudmFyIHRyYW5zbGF0ZVRlbXBsYXRlID0gR2xvYmFscy5UUkFOU0xBVEVfVEVNUExBVEU7XG5cbi8vIHZhciBjc3NUb1B4ID0gZnVuY3Rpb24oY3NzVmFsLCBlbCkge1xuLy8gXHRyZXR1cm4gcGFyc2VJbnQoY3NzVmFsKTtcbi8vIH07XG5cbi8vIHZhciBkZWZhdWx0UmVuZGVyZXJGdW5jdGlvbiA9IChmdW5jdGlvbigpIHtcbi8vIFx0dmFyIGRlZmF1bHRSZW5kZXJlciA9IENhcm91c2VsUmVuZGVyZXIuZXh0ZW5kKHsgY2xhc3NOYW1lOiBcImNhcm91c2VsLWl0ZW0gZGVmYXVsdC1yZW5kZXJlclwifSksXG4vLyBcdFx0ZW1wdHlSZW5kZXJlciA9IENhcm91c2VsUmVuZGVyZXIuZXh0ZW5kKHsgY2xhc3NOYW1lOiBcImNhcm91c2VsLWl0ZW0gZW1wdHktcmVuZGVyZXJcIn0pO1xuLy8gXHRyZXR1cm4gZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycikge1xuLy8gXHRcdHJldHVybiAoaW5kZXggPT09IC0xKT8gZW1wdHlSZW5kZXJlcjogZGVmYXVsdFJlbmRlcmVyO1xuLy8gXHR9O1xuLy8gfSkoKTtcblxuLyoqIEBjb25zdCAqL1xudmFyIE1BWF9TRUxFQ1RfVEhSRVNIT0xEID0gMjA7XG5cbi8vIC8qKiBAY29uc3QgKi9cbi8vIHZhciBDSElMRFJFTl9JTlZBTElEID0gVmlldy5DSElMRFJFTl9JTlZBTElELFxuLy8gXHRTVFlMRVNfSU5WQUxJRCA9IFZpZXcuU1RZTEVTX0lOVkFMSUQsXG4vLyBcdE1PREVMX0lOVkFMSUQgPSBWaWV3Lk1PREVMX0lOVkFMSUQsXG4vLyBcdFNJWkVfSU5WQUxJRCA9IFZpZXcuU0laRV9JTlZBTElELFxuLy8gXHRMQVlPVVRfSU5WQUxJRCA9IFZpZXcuTEFZT1VUX0lOVkFMSUQ7XG5cbnZhciBWRVJUSUNBTCA9IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwsXG5cdEhPUklaT05UQUwgPSBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUw7XG5cbi8vIHg6IFtcInhcIiwgXCJ5XCJdLFxuLy8geTogW1wieVwiLCBcInhcIl0sXG4vLyBvZmZzZXRMZWZ0OiBbXCJvZmZzZXRMZWZ0XCIsIFwib2Zmc2V0VG9wXCJdLFxuLy8gb2Zmc2V0VG9wOiBbXCJvZmZzZXRUb3BcIiwgXCJvZmZzZXRMZWZ0XCJdLFxuLy8gb2Zmc2V0V2lkdGg6IFtcIm9mZnNldFdpZHRoXCIsIFwib2Zmc2V0SGVpZ2h0XCJdLFxuLy8gb2Zmc2V0SGVpZ2h0OiBbXCJvZmZzZXRIZWlnaHRcIiwgXCJvZmZzZXRXaWR0aFwiXSxcbi8vIHdpZHRoOiBbXCJ3aWR0aFwiLFwiaGVpZ2h0XCJdLFxuLy8gaGVpZ2h0OiBbXCJoZWlnaHRcIixcIndpZHRoXCJdLFxuLy8gbWFyZ2luTGVmdDogW1wibWFyZ2luTGVmdFwiLFwibWFyZ2luVG9wXCJdLFxuLy8gbWFyZ2luUmlnaHQ6IFtcIm1hcmdpblJpZ2h0XCIsXCJtYXJnaW5Cb3R0b21cIl0sXG5cbi8qXG52YXIgSE9SSVpPTlRBTF9QUk9QUyA9IHtcblx0cG9zOiBcInhcIixcblx0c2l6ZTogXCJ3aWR0aFwiLFxuXHRvZmZzZXRQb3M6IFwib2Zmc2V0TGVmdFwiLFxuXHRvZmZzZXRTaXplOiBcIm9mZnNldFdpZHRoXCIsXG5cdG1hcmdpbkJlZm9yZTogXCJtYXJnaW5MZWZ0XCIsXG5cdG1hcmdpbkFmdGVyOiBcIm1hcmdpblJpZ2h0XCIsXG59O1xudmFyIFZFUlRJQ0FMX1BST1BTID0ge1xuXHRwb3M6IFwieVwiLFxuXHRzaXplOiBcImhlaWdodFwiLFxuXHRvZmZzZXRQb3M6IFwib2Zmc2V0VG9wXCIsXG5cdG9mZnNldFNpemU6IFwib2Zmc2V0SGVpZ2h0XCIsXG5cdG1hcmdpbkJlZm9yZTogXCJtYXJnaW5Ub3BcIixcblx0bWFyZ2luQWZ0ZXI6IFwibWFyZ2luQm90dG9tXCIsXG59O1xuKi9cblxuLy8gdmFyIERJUkVDVElPTl9OT05FID0gMTtcbi8vIHZhciBESVJFQ1RJT05fTEVGVCA9IDI7XG4vLyB2YXIgRElSRUNUSU9OX1JJR0hUID0gNDtcbi8vIHZhciBESVJFQ1RJT05fVVAgPSA4O1xuLy8gdmFyIERJUkVDVElPTl9ET1dOID0gMTY7XG5cbi8vIGZ1bmN0aW9uIGRpclRvU3RyKGRpcikge1xuLy8gXHRpZiAoZGlyID09PSBIYW1tZXIuRElSRUNUSU9OX05PTkUpIHJldHVybiAnTk9ORSc7XG4vLyBcdGlmIChkaXIgPT09IEhhbW1lci5ESVJFQ1RJT05fTEVGVCkgcmV0dXJuICdMRUZUJztcbi8vIFx0aWYgKGRpciA9PT0gSGFtbWVyLkRJUkVDVElPTl9SSUdIVCkgcmV0dXJuICdSSUdIVCc7XG4vLyBcdGlmIChkaXIgPT09IEhhbW1lci5ESVJFQ1RJT05fVVApIHJldHVybiAnVVAnO1xuLy8gXHRpZiAoZGlyID09PSBIYW1tZXIuRElSRUNUSU9OX0RPV04pIHJldHVybiAnRE9XTic7XG4vLyBcdGlmIChkaXIgPT09IEhhbW1lci5ESVJFQ1RJT05fSE9SSVpPTlRBTCkgcmV0dXJuICdIT1JJWk9OVEFMJztcbi8vIFx0aWYgKGRpciA9PT0gSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTCkgcmV0dXJuICdWRVJUSUNBTCc7XG4vLyBcdGlmIChkaXIgPT09IEhhbW1lci5ESVJFQ1RJT05fQUxMKSByZXR1cm4gJ0FMTCc7XG4vLyBcdHJldHVybiAnVU5SRUNPR05JWkVEJztcbi8vIH1cblxudmFyIGlzVmFsaWRUb3VjaE1hbmFnZXIgPSBmdW5jdGlvbih0b3VjaCwgZGlyZWN0aW9uKSB7XG5cdC8vIHZhciByZXR2YWw7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRvdWNoLmdldChcImhwYW5cIikub3B0aW9ucy5kaXJlY3Rpb24gPT0gZGlyZWN0aW9uO1xuXHR9IGNhdGNoIChlcnIpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblx0Ly8gcmV0dXJuIHJldHZhbDtcbn07XG5cbi8vIC8qKiBAdHlwZSB7aW50fSBJbiBwaXhlbHMgKi9cbi8vIHZhciBwYW5UaHJlc2hvbGQ6IDE1O1xuXG52YXIgY3JlYXRlVG91Y2hNYW5hZ2VyID0gZnVuY3Rpb24oZWwsIGRpciwgdGhyZXMpIHtcblx0dmFyIHRvdWNoID0gbmV3IEhhbW1lci5NYW5hZ2VyKGVsKTtcblx0dmFyIHBhbiA9IG5ldyBQYW4oe1xuXHRcdGV2ZW50OiBcImhwYW5cIixcblx0XHR0aHJlc2hvbGQ6IEdsb2JhbHMuVEhSRVNIT0xELFxuXHRcdGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9IT1JJWk9OVEFMLFxuXHR9KTtcblx0dmFyIHRhcCA9IG5ldyBUYXAoe1xuXHRcdHRocmVzaG9sZDogR2xvYmFscy5USFJFU0hPTEQgLSAxLFxuXHRcdGludGVydmFsOiA1MCxcblx0XHR0aW1lOiAyMDAsXG5cdH0pO1xuXHR0YXAucmVjb2duaXplV2l0aChwYW4pO1xuXHR0b3VjaC5hZGQoW3BhbiwgdGFwXSk7XG5cdHJldHVybiB0b3VjaDtcbn07XG5cblxudmFyIENhcm91c2VsID0ge1xuXHQvKiogY29uc3QgKi9cblx0QU5JTUFURUQ6IGZhbHNlLFxuXHQvKiogY29uc3QgKi9cblx0SU1NRURJQVRFOiB0cnVlLFxuXG5cdC8qKiBjb3B5IG9mIEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwgKi9cblx0RElSRUNUSU9OX1ZFUlRJQ0FMOiBWRVJUSUNBTCxcblx0LyoqIGNvcHkgb2YgSGFtbWVyLkRJUkVDVElPTl9IT1JJWk9OVEFMICovXG5cdERJUkVDVElPTl9IT1JJWk9OVEFMOiBIT1JJWk9OVEFMLFxuXHQvKiogQHR5cGUge09iamVjdH0gKi9cblx0ZGVmYXVsdHM6IHtcblx0XHQvKiogQHR5cGUge2Jvb2xlYW59ICovXG5cdFx0c2VsZWN0T25TY3JvbGxFbmQ6IGZhbHNlLFxuXHRcdC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cblx0XHRyZXF1aXJlU2VsZWN0aW9uOiBmYWxzZSxcblx0XHQvKiogQHR5cGUge2ludH0gKi9cblx0XHRkaXJlY3Rpb246IEhPUklaT05UQUwsXG5cdFx0LyoqIEB0eXBlIHtpbnR9IEluIHBpeGVscyAqL1xuXHRcdHNlbGVjdFRocmVzaG9sZDogMjAsXG5cdFx0LyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cblx0XHRyZW5kZXJlckZ1bmN0aW9uOiAoZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgZGVmYXVsdFJlbmRlcmVyID0gQ2Fyb3VzZWxSZW5kZXJlci5leHRlbmQoe1xuXHRcdFx0XHRcdGNsYXNzTmFtZTogXCJjYXJvdXNlbC1pdGVtIGRlZmF1bHQtcmVuZGVyZXJcIlxuXHRcdFx0XHR9KSxcblx0XHRcdFx0ZW1wdHlSZW5kZXJlciA9IENhcm91c2VsUmVuZGVyZXIuZXh0ZW5kKHtcblx0XHRcdFx0XHRjbGFzc05hbWU6IFwiY2Fyb3VzZWwtaXRlbSBlbXB0eS1yZW5kZXJlclwiXG5cdFx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBhcnIpIHtcblx0XHRcdFx0cmV0dXJuIChpbmRleCA9PT0gLTEpID8gZW1wdHlSZW5kZXJlciA6IGRlZmF1bHRSZW5kZXJlcjtcblx0XHRcdH07XG5cdFx0fSkoKSxcblx0fSxcbn07XG5DYXJvdXNlbC52YWxpZE9wdGlvbnMgPSBfLmtleXMoQ2Fyb3VzZWwuZGVmYXVsdHMpO1xuXG4vKipcbi8qIEBjb25zdHJ1Y3RvclxuLyogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQ2Fyb3VzZWx9XG4vKi9cbnZhciBDYXJvdXNlbFByb3RvID0ge1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2lkUHJlZml4OiBcImNhcm91c2VsXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJkaXZcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwiY2Fyb3VzZWwgc2tpcC10cmFuc2l0aW9uc1wiLFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHByb3BlcnRpZXNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cHJvcGVydGllczoge1xuXHRcdHNjcm9sbGluZzoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3Njcm9sbGluZztcblx0XHRcdH1cblx0XHR9LFxuXHRcdHNlbGVjdGVkSXRlbToge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3NlbGVjdGVkVmlldy5tb2RlbDtcblx0XHRcdH0sXG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdGlmICh2YWx1ZSlcblx0XHRcdFx0XHR0aGlzLl9vblNlbGVjdE9uZSh2YWx1ZSlcblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdHRoaXMuX29uU2VsZWN0Tm9uZSgpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdH0sXG5cblx0ZXZlbnRzOiB7XG5cdFx0Ly8gXCJtb3VzZWRvd25cIjogXCJfb25Nb3VzZURvd25cIiwgXCJtb3VzZXVwXCI6IFwiX29uTW91c2VVcFwiLFxuXHRcdFwidHJhbnNpdGlvbmVuZCAuY2Fyb3VzZWwtaXRlbS5zZWxlY3RlZFwiOiBcIl9vblNjcm9sbFRyYW5zaXRpb25FbmRcIixcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRfLmJpbmRBbGwodGhpcywgXCJfb25Ub3VjaEV2ZW50XCIpO1xuXG5cdFx0dGhpcy5pdGVtVmlld3MgPSBuZXcgQ29udGFpbmVyKCk7XG5cdFx0dGhpcy5tZXRyaWNzID0ge307XG5cblx0XHRfLmV4dGVuZCh0aGlzLCBfLmRlZmF1bHRzKF8ucGljayhvcHRpb25zLCBDYXJvdXNlbC52YWxpZE9wdGlvbnMpLCBDYXJvdXNlbC5kZWZhdWx0cykpO1xuXG5cdFx0Ly8gdGhpcy5jaGlsZEdhcCA9IDA7IC8vdGhpcy5kaXJQcm9wKDIwLCAxOCk7XG5cdFx0dGhpcy5fcHJlY2VkaW5nRGlyID0gKEhhbW1lci5ESVJFQ1RJT05fTEVGVCB8IEhhbW1lci5ESVJFQ1RJT05fVVApICYgdGhpcy5kaXJlY3Rpb247XG5cdFx0dGhpcy5fZm9sbG93aW5nRGlyID0gKEhhbW1lci5ESVJFQ1RJT05fUklHSFQgfCBIYW1tZXIuRElSRUNUSU9OX0RPV04pICYgdGhpcy5kaXJlY3Rpb247XG5cblx0XHQvLyB1c2Ugc3VwcGxpZWQgdG91Y2ggbWdyIG9yIGNyZWF0ZSBwcml2YXRlXG5cdFx0aWYgKGlzVmFsaWRUb3VjaE1hbmFnZXIob3B0aW9ucy50b3VjaCwgdGhpcy5kaXJlY3Rpb24pKSB7XG5cdFx0XHR0aGlzLnRvdWNoID0gb3B0aW9ucy50b3VjaDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiJXM6OmluaXRpYWxpemUgY3JlYXRpbmcgSGFtbWVyIGluc3RhbmNlXCIsIHRoaXMuY2lkKTtcblx0XHRcdHRoaXMudG91Y2ggPSBjcmVhdGVUb3VjaE1hbmFnZXIodGhpcy5lbCwgdGhpcy5kaXJlY3Rpb24pO1xuXHRcdFx0Ly8gdGhpcy5vbihcInZpZXc6cmVtb3ZlZFwiLCB0aGlzLnRvdWNoLmRlc3Ryb3ksIHRoaXMudG91Y2gpO1xuXHRcdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLCBcInZpZXc6cmVtb3ZlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy50b3VjaC5kZXN0cm95KCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHQvKiBjcmVhdGUgY2hpbGRyZW4gYW5kIHByb3BzICovXG5cdFx0dGhpcy5zZXRFbmFibGVkKHRydWUpO1xuXHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gdHJ1ZTtcblx0XHR0aGlzLl9yZW5kZXJGbGFncyA9IFZpZXcuQ0hJTERSRU5fSU5WQUxJRDtcblx0XHQvLyB0aGlzLmludmFsaWRhdGVDaGlsZHJlbigpO1xuXG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLCBcInZpZXc6YXR0YWNoZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdFx0XHQvLyB0aGlzLmludmFsaWRhdGVTaXplKCk7XG5cdFx0XHQvLyB0aGlzLnJlbmRlck5vdygpO1xuXHRcdFx0Ly8gdGhpcy5yZXF1ZXN0UmVuZGVyKCk7XG5cdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3LkxBWU9VVF9JTlZBTElEKTtcblx0XHR9KTtcblxuXHRcdC8qIGNvbGxlY3Rpb24gbGlzdGVuZXJzICovXG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sIHtcblx0XHRcdFwicmVzZXRcIjogdGhpcy5fb25SZXNldCxcblx0XHRcdFwic2VsZWN0Om9uZVwiOiB0aGlzLl9vblNlbGVjdE9uZSxcblx0XHRcdFwic2VsZWN0Om5vbmVcIjogdGhpcy5fb25TZWxlY3ROb25lLFxuXHRcdFx0XCJkZXNlbGVjdDpvbmVcIjogdGhpcy5fb25EZXNlbGVjdEFueSxcblx0XHRcdFwiZGVzZWxlY3Q6bm9uZVwiOiB0aGlzLl9vbkRlc2VsZWN0QW55LFxuXHRcdH0pO1xuXHR9LFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBIYW1tZXIgaW5pdFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyB2YWxpZGF0ZVRvdWNoTWFuYWdlcjogZnVuY3Rpb24odG91Y2gsIGRpcmVjdGlvbikge1xuXHQvLyBcdHRyeSB7XG5cdC8vIFx0XHRyZXR1cm4gdG91Y2guZ2V0KFwicGFuXCIpLm9wdGlvbnMuZGlyZWN0aW9uID09PSBkaXJlY3Rpb24pO1xuXHQvLyBcdH0gY2F0Y2ggKGVycikge1xuXHQvLyBcdFx0cmV0dXJuIGZhbHNlO1xuXHQvLyBcdH1cblx0Ly8gfSxcblxuXHQvLyBpbml0aWFsaXplSGFtbWVyOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdC8vIFx0Ly8gZGlyZWN0aW9uIGZyb20gb3B0cy9kZWZhdWx0c1xuXHQvLyBcdGlmIChvcHRpb25zLmRpcmVjdGlvbiA9PT0gVkVSVElDQUwpIHtcblx0Ly8gXHRcdHRoaXMuZGlyZWN0aW9uID0gVkVSVElDQUw7XG5cdC8vIFx0fSAvLyBkbyBub3RoaW5nOiB0aGUgZGVmYXVsdCBpcyBob3Jpem9udGFsXG5cdC8vXG5cdC8vIFx0Ly8gdmFsaWRhdGUgaGFtbWVyIGluc3RhbmNlIG9yIGNyZWF0ZSBsb2NhbFxuXHQvLyBcdGlmICgodG91Y2ggPSBvcHRpb25zLnRvdWNoKSAmJiAocGFuID0gdG91Y2guZ2V0KFwicGFuXCIpKSkge1xuXHQvLyBcdFx0Ly8gT3ZlcnJpZGUgZGlyZWN0aW9uIG9ubHkgaWYgc3BlY2lmaWNcblx0Ly8gXHRcdGlmIChwYW4ub3B0aW9ucy5kaXJlY3Rpb24gIT09IEhhbW1lci5ESVJFQ1RJT05fQUxMKSB7XG5cdC8vIFx0XHRcdHRoaXMuZGlyZWN0aW9uID0gcGFuLm9wdGlvbnMuZGlyZWN0aW9uO1xuXHQvLyBcdFx0fVxuXHQvLyBcdFx0dGhpcy5wYW5UaHJlc2hvbGQgPSBwYW4ub3B0aW9ucy50aHJlc2hvbGQ7XG5cdC8vIFx0fSBlbHNlIHtcblx0Ly8gXHRcdGNvbnNvbGUud2FybihcIiVzOjppbml0aWFsaXplSGFtbWVyIHVzaW5nIHByaXZhdGUgSGFtbWVyIGluc3RhbmNlXCIsIHRoaXMuY2lkKTtcblx0Ly8gXHRcdHRvdWNoID0gY3JlYXRlSGFtbWVySW5zdGFuY2UodGhpcy5lbCwgdGhpcy5wYW5UaHJlc2hvbGQsIHRoaXMuZGlyZWN0aW9uKTtcblx0Ly8gXHRcdHRoaXMub24oXCJ2aWV3OnJlbW92ZWRcIiwgdG91Y2guZGVzdHJveSwgdG91Y2gpO1xuXHQvLyBcdH1cblx0Ly8gXHR0aGlzLnRvdWNoID0gdG91Y2g7XG5cdC8vIH0sXG5cblx0cmVtb3ZlOiBmdW5jdGlvbigpIHtcblx0XHQvLyB0aGlzLl9zY3JvbGxQZW5kaW5nQWN0aW9uICYmIHRoaXMuX3Njcm9sbFBlbmRpbmdBY3Rpb24odHJ1ZSk7XG5cdFx0Ly8gaWYgKHRoaXMuX2VuYWJsZWQpIHtcblx0XHQvLyBcdHRoaXMudG91Y2gub2ZmKFwidGFwXCIsIHRoaXMuX29uVGFwKTtcblx0XHQvLyBcdHRoaXMudG91Y2gub2ZmKFwiaHBhbnN0YXJ0IGhwYW5tb3ZlIGhwYW5lbmQgaHBhbmNhbmNlbFwiLCB0aGlzLl9vblBhbik7XG5cdFx0Ly8gfVxuXHRcdHRoaXMuX3RvZ2dsZVRvdWNoRXZlbnRzKGZhbHNlKTtcblx0XHR0aGlzLnJlbW92ZUNoaWxkcmVuKCk7XG5cdFx0Vmlldy5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBoZWxwZXIgZnVuY3Rpb25zXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGRpclByb3A6IGZ1bmN0aW9uKGhQcm9wLCB2UHJvcCkge1xuXHRcdHJldHVybiAodGhpcy5kaXJlY3Rpb24gJiBIT1JJWk9OVEFMKSA/IGhQcm9wIDogdlByb3A7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogUmVuZGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdC8vIFx0aWYgKHRoaXMuYXR0YWNoZWQpIHtcblx0Ly8gXHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gdHJ1ZTtcblx0Ly8gXHRcdC8vIHRoaXMuaW52YWxpZGF0ZVNpemUoKTtcblx0Ly8gXHRcdHRoaXMucmVuZGVyTm93KHRydWUpO1xuXHQvLyBcdH1cblx0Ly8gfSxcblxuXHQvLyAvKiogQG92ZXJyaWRlICovXG5cdC8vIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuXHQvLyBcdGlmICghdGhpcy5hdHRhY2hlZCkge1xuXHQvLyBcdFx0aWYgKCF0aGlzLl9yZW5kZXJQZW5kaW5nKSB7XG5cdC8vIFx0XHRcdHRoaXMuX3JlbmRlclBlbmRpbmcgPSB0cnVlO1xuXHQvLyBcdFx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwidmlldzphdHRhY2hlZFwiLCB0aGlzLnJlbmRlcik7XG5cdC8vIFx0XHR9XG5cdC8vIFx0fSBlbHNlIHtcblx0Ly8gXHRcdGlmICh0aGlzLl9yZW5kZXJQZW5kaW5nKSB7XG5cdC8vIFx0XHRcdHRoaXMuX3JlbmRlclBlbmRpbmcgPSBmYWxzZTtcblx0Ly8gXHRcdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMsIFwidmlldzphdHRhY2hlZFwiLCB0aGlzLnJlbmRlcik7XG5cdC8vIFx0XHR9XG5cdC8vIFx0XHR0aGlzLl9kZWx0YSA9IDA7XG5cdC8vIFx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdC8vIFx0XHR0aGlzLmludmFsaWRhdGVTaXplKCk7XG5cdC8vIFx0XHQvLyB0aGlzLmludmFsaWRhdGVMYXlvdXQoKTtcblx0Ly8gXHRcdHRoaXMucmVuZGVyTm93KCk7XG5cdC8vIFx0fVxuXHQvLyBcdHJldHVybiB0aGlzO1xuXHQvLyB9LFxuXG5cdC8vIHJlbmRlcjogZnVuY3Rpb24gKCkge1xuXHQvLyBcdHRoaXMubWVhc3VyZUxhdGVyKCk7XG5cdC8vIFx0dGhpcy5zY3JvbGxCeSgwLCBDYXJvdXNlbC5JTU1FRElBVEUpO1xuXHQvL1xuXHQvLyBcdGlmICh0aGlzLmVsLnBhcmVudEVsZW1lbnQpIHtcblx0Ly8gXHRcdHRoaXMucmVuZGVyTm93KCk7XG5cdC8vIFx0fVxuXHQvLyBcdHJldHVybiB0aGlzO1xuXHQvLyB9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyRnJhbWU6IGZ1bmN0aW9uKHRzdGFtcCwgZmxhZ3MpIHtcblx0XHRpZiAoZmxhZ3MgJiBWaWV3LkNISUxEUkVOX0lOVkFMSUQpIHtcblx0XHRcdHRoaXMuX2NyZWF0ZUNoaWxkcmVuKCk7XG5cdFx0XHQvLyBjbGVhciB0aGlzIGZsYWcgbm93OiByZW5kZXIgbWF5IGJlIGRlZmVycmVkIHVudGlsIGF0dGFjaGVkXG5cdFx0XHRmbGFncyAmPSB+Vmlldy5DSElMRFJFTl9JTlZBTElEO1xuXHRcdH1cblx0XHRpZiAodGhpcy5hdHRhY2hlZCkge1xuXHRcdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHtcblx0XHRcdFx0dGhpcy5fbWVhc3VyZSgpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGZsYWdzICYgKFZpZXcuTEFZT1VUX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRCkpIHtcblx0XHRcdFx0dGhpcy5fc2Nyb2xsQnkodGhpcy5fZGVsdGEsIHRoaXMuc2tpcFRyYW5zaXRpb25zKTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKGZsYWdzKSB7XG5cdFx0XHR0aGlzLmxpc3RlblRvT25jZSh0aGlzLCBcInZpZXc6YXR0YWNoZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcihmbGFncyk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogZW5hYmxlZFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdF9lbmFibGVkOiB1bmRlZmluZWQsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRzZXRFbmFibGVkOiBmdW5jdGlvbihlbmFibGVkKSB7XG5cdFx0aWYgKHRoaXMuX2VuYWJsZWQgIT09IGVuYWJsZWQpIHtcblx0XHRcdHRoaXMuX2VuYWJsZWQgPSBlbmFibGVkO1xuXHRcdFx0Ly8gdG9nZ2xlIGV2ZW50cyBpbW1lZGlhdGVseVxuXHRcdFx0dGhpcy5fdG9nZ2xlVG91Y2hFdmVudHMoZW5hYmxlZCk7XG5cdFx0XHQvLyBkb20gbWFuaXB1bGF0aW9uIG9uIHJlbmRlciAoX3JlbmRlckVuYWJsZWQpXG5cdFx0XHQvLyB0aGlzLl9yZW5kZXJGbGFncyB8PSBWaWV3LlNUWUxFU19JTlZBTElEO1xuXHRcdFx0Ly8gdGhpcy5yZXF1ZXN0UmVuZGVyKCk7XG5cblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImRpc2FibGVkXCIsICF0aGlzLmVuYWJsZWQpO1xuXHRcdFx0dGhpcy5pdGVtVmlld3MuZWFjaChmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdHZpZXcuc2V0RW5hYmxlZCh0aGlzLmVuYWJsZWQpO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0fVxuXHR9LFxuXG5cdF9yZW5kZXJFbmFibGVkOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJkaXNhYmxlZFwiLCAhdGhpcy5lbmFibGVkKTtcblx0XHR0aGlzLml0ZW1WaWV3cy5lYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdHZpZXcuc2V0RW5hYmxlZCh0aGlzLmVuYWJsZWQpO1xuXHRcdH0sIHRoaXMpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIENyZWF0ZSBjaGlsZHJlblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfY3JlYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHZhciBzSW5kZXg7XG5cdFx0dmFyIGJ1ZmZlciwgcmVuZGVyZXIsIHZpZXcsIHZpZXdPcHRzO1xuXG5cdFx0dGhpcy5yZW1vdmVDaGlsZHJlbigpO1xuXG5cdFx0aWYgKHRoaXMuY29sbGVjdGlvbi5sZW5ndGgpIHtcblx0XHRcdHZpZXdPcHRzID0ge1xuXHRcdFx0XHQvLyB2aWV3RGVwdGg6IHRoaXMudmlld0RlcHRoICsgMSxcblx0XHRcdFx0Ly8gcGFyZW50VmlldzogdGhpcyxcblx0XHRcdFx0ZW5hYmxlZDogdGhpcy5lbmFibGVkXG5cdFx0XHR9O1xuXHRcdFx0YnVmZmVyID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXHRcdFx0Ly8gYnVmZmVyID0gdGhpcy5lbDtcblxuXHRcdFx0aWYgKCF0aGlzLnJlcXVpcmVTZWxlY3Rpb24pIHtcblx0XHRcdFx0cmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyRnVuY3Rpb24obnVsbCwgLTEsIHRoaXMuY29sbGVjdGlvbik7XG5cdFx0XHRcdHZpZXcgPSBuZXcgcmVuZGVyZXIodmlld09wdHMpO1xuXHRcdFx0XHR0aGlzLml0ZW1WaWV3cy5hZGQodmlldyk7XG5cdFx0XHRcdGJ1ZmZlci5hcHBlbmRDaGlsZCh2aWV3LmVsKTtcblx0XHRcdFx0dGhpcy5lbXB0eVZpZXcgPSB2aWV3O1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLmNvbGxlY3Rpb24uZWFjaChmdW5jdGlvbihpdGVtLCBpbmRleCwgYXJyKSB7XG5cdFx0XHRcdHZpZXdPcHRzLm1vZGVsID0gaXRlbTtcblx0XHRcdFx0cmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyRnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycik7XG5cdFx0XHRcdHZpZXcgPSBuZXcgcmVuZGVyZXIodmlld09wdHMpO1xuXHRcdFx0XHR0aGlzLml0ZW1WaWV3cy5hZGQodmlldyk7XG5cdFx0XHRcdGJ1ZmZlci5hcHBlbmRDaGlsZCh2aWV3LmVsKTtcblx0XHRcdH0sIHRoaXMpO1xuXG5cdFx0XHQvLyBpZiAoIXRoaXMucmVxdWlyZVNlbGVjdGlvbikge1xuXHRcdFx0Ly8gXHRidWZmZXIgPSB0aGlzLmFwcGVuZEl0ZW1WaWV3KGJ1ZmZlciwgdGhpcy5tb2RlbCwgLTEsIHRoaXMuY29sbGVjdGlvbik7XG5cdFx0XHQvLyBcdHRoaXMuZW1wdHlWaWV3ID0gdGhpcy5pdGVtVmlld3MuZmlyc3QoKTtcblx0XHRcdC8vIH1cblx0XHRcdC8vIGJ1ZmZlciA9IHRoaXMuY29sbGVjdGlvbi5yZWR1Y2UodGhpcy5hcHBlbmRJdGVtVmlldywgYnVmZmVyLCB0aGlzKTtcblxuXHRcdFx0dGhpcy5hZGp1c3RUb1NlbGVjdGlvbigpO1xuXHRcdFx0dGhpcy5fc2VsZWN0ZWRWaWV3LmVsLmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZFwiKTtcblxuXHRcdFx0dGhpcy5lbC5hcHBlbmRDaGlsZChidWZmZXIpO1xuXHRcdH1cblx0fSxcblxuXHQvLyBhcHBlbmRJdGVtVmlldzogZnVuY3Rpb24gKHBhcmVudEVsLCBtb2RlbCwgaW5kZXgsIGFycikge1xuXHQvLyBcdHZhciByZW5kZXJlciA9IHRoaXMucmVuZGVyZXJGdW5jdGlvbihtb2RlbCwgaW5kZXgsIGFycik7XG5cdC8vIFx0dmFyIHZpZXcgPSBuZXcgcmVuZGVyZXIoe1xuXHQvLyBcdFx0bW9kZWw6IG1vZGVsLFxuXHQvLyBcdFx0cGFyZW50VmlldzogdGhpcyxcblx0Ly8gXHRcdGVuYWJsZWQ6IHRoaXMuZW5hYmxlZFxuXHQvLyBcdH0pO1xuXHQvLyBcdHRoaXMuaXRlbVZpZXdzLmFkZCh2aWV3KTtcblx0Ly8gXHRwYXJlbnRFbC5hcHBlbmRDaGlsZCh2aWV3LmVsKTtcblx0Ly8gXHRyZXR1cm4gcGFyZW50RWw7XG5cdC8vIH0sXG5cblx0Ly8gY3JlYXRlSXRlbVZpZXc6IGZ1bmN0aW9uIChyZW5kZXJlciwgb3B0cykge1xuXHQvLyBcdHZhciB2aWV3ID0gbmV3IHJlbmRlcmVyKG9wdHMpO1xuXHQvLyBcdHRoaXMuaXRlbVZpZXdzLmFkZCh2aWV3KTtcblx0Ly8gXHRyZXR1cm4gdmlldztcblx0Ly8gfSxcblxuXHRyZW1vdmVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5pdGVtVmlld3MuZWFjaCh0aGlzLnJlbW92ZUl0ZW1WaWV3LCB0aGlzKTtcblx0XHR0aGlzLmVtcHR5VmlldyA9IHZvaWQgMDtcblx0fSxcblxuXHRyZW1vdmVJdGVtVmlldzogZnVuY3Rpb24odmlldykge1xuXHRcdHRoaXMuaXRlbVZpZXdzLnJlbW92ZSh2aWV3KTtcblx0XHR2aWV3LnJlbW92ZSgpO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIG1lYXN1cmVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X21lYXN1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBtLCBtbTtcblx0XHR2YXIgcG9zID0gMCxcblx0XHRcdHBvc0lubmVyID0gMDtcblx0XHR2YXIgbWF4QWNyb3NzID0gMCxcblx0XHRcdG1heE91dGVyID0gMDtcblx0XHR2YXIgbWF4T3V0ZXJWaWV3LCBtYXhBY3Jvc3NWaWV3O1xuXG5cdFx0bWF4T3V0ZXJWaWV3ID0gbWF4QWNyb3NzVmlldyA9IHRoaXMuZW1wdHlWaWV3IHx8IHRoaXMuaXRlbVZpZXdzLmZpcnN0KCk7XG5cblx0XHQvLyBjaGlkcmVuIG1ldHJpY3Ncblx0XHR0aGlzLml0ZW1WaWV3cy5lYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdHZpZXcucmVuZGVyKCk7XG5cdFx0fSk7XG5cblx0XHR0aGlzLml0ZW1WaWV3cy5lYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdG0gPSB0aGlzLm1lYXN1cmVJdGVtVmlldyh2aWV3KTtcblx0XHRcdG0ucG9zID0gcG9zO1xuXHRcdFx0cG9zICs9IG0ub3V0ZXI7IC8vICsgdGhpcy5jaGlsZEdhcDtcblx0XHRcdG0ucG9zSW5uZXIgPSBwb3NJbm5lcjtcblx0XHRcdHBvc0lubmVyICs9IG0uaW5uZXI7IC8vKyB0aGlzLmNoaWxkR2FwO1xuXHRcdFx0aWYgKHZpZXcgIT09IHRoaXMuZW1wdHlWaWV3KSB7XG5cdFx0XHRcdGlmIChtLmFjcm9zcyA+IG1heEFjcm9zcykge1xuXHRcdFx0XHRcdG1heEFjcm9zcyA9IG0uYWNyb3NzO1xuXHRcdFx0XHRcdG1heEFjcm9zc1ZpZXcgPSB2aWV3O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChtLm91dGVyID4gbWF4T3V0ZXIpIHtcblx0XHRcdFx0XHRtYXhPdXRlciA9IG0ub3V0ZXI7XG5cdFx0XHRcdFx0bWF4T3V0ZXJWaWV3ID0gdmlldztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0sIHRoaXMpO1xuXG5cdFx0Ly8gbWVhc3VyZSBzZWxmICsgbWF4IGNoaWxkIG1ldHJpY3Ncblx0XHRtbSA9IHRoaXMubWV0cmljc1t0aGlzLmNpZF0gfHwgKHRoaXMubWV0cmljc1t0aGlzLmNpZF0gPSB7fSk7XG5cdFx0bW0ub3V0ZXIgPSB0aGlzLmVsW3RoaXMuZGlyUHJvcChcIm9mZnNldFdpZHRoXCIsIFwib2Zmc2V0SGVpZ2h0XCIpXTtcblx0XHRtbS5iZWZvcmUgPSBtYXhPdXRlclZpZXcuZWxbdGhpcy5kaXJQcm9wKFwib2Zmc2V0TGVmdFwiLCBcIm9mZnNldFRvcFwiKV07XG5cdFx0bW0uaW5uZXIgPSBtYXhPdXRlclZpZXcuZWxbdGhpcy5kaXJQcm9wKFwib2Zmc2V0V2lkdGhcIiwgXCJvZmZzZXRIZWlnaHRcIildO1xuXHRcdG1tLmFmdGVyID0gbW0ub3V0ZXIgLSAobW0uaW5uZXIgKyBtbS5iZWZvcmUpO1xuXHRcdG1tLmFjcm9zcyA9IG1heEFjcm9zcztcblxuXHRcdC8vIG0gPSB0aGlzLm1ldHJpY3NbbWF4T3V0ZXJWaWV3LmNpZF07XG5cdFx0Ly8gbW0uaW5uZXIgPSBtLmlubmVyO1xuXG5cdFx0Ly8gdGFwIGFyZWFcblx0XHR0aGlzLl90YXBBY3Jvc3NCZWZvcmUgPSBtYXhBY3Jvc3NWaWV3LmVsW3RoaXMuZGlyUHJvcChcIm9mZnNldFRvcFwiLCBcIm9mZnNldExlZnRcIildO1xuXHRcdHRoaXMuX3RhcEFjcm9zc0FmdGVyID0gdGhpcy5fdGFwQWNyb3NzQmVmb3JlICsgbWF4QWNyb3NzO1xuXHRcdHRoaXMuX3RhcEJlZm9yZSA9IG1tLmJlZm9yZSArIHRoaXMuX3RhcEdyb3c7XG5cdFx0dGhpcy5fdGFwQWZ0ZXIgPSBtbS5iZWZvcmUgKyBtbS5pbm5lciAtIHRoaXMuX3RhcEdyb3c7XG5cblx0XHR0aGlzLnNlbGVjdFRocmVzaG9sZCA9IE1hdGgubWluKE1BWF9TRUxFQ1RfVEhSRVNIT0xELCBtbS5vdXRlciAqIDAuMSk7XG5cdH0sXG5cblx0bWVhc3VyZUl0ZW1WaWV3OiBmdW5jdGlvbih2aWV3KSB7XG5cdFx0dmFyIG0sIHZpZXdFbDtcblx0XHQvLyB2YXIgcywgc2l6ZUVsO1xuXG5cdFx0dmlld0VsID0gdmlldy5lbDtcblx0XHRtID0gdGhpcy5tZXRyaWNzW3ZpZXcuY2lkXSB8fCAodGhpcy5tZXRyaWNzW3ZpZXcuY2lkXSA9IHt9KTtcblxuXHRcdG0ub3V0ZXIgPSB2aWV3RWxbdGhpcy5kaXJQcm9wKFwib2Zmc2V0V2lkdGhcIiwgXCJvZmZzZXRIZWlnaHRcIildO1xuXHRcdG0uYWNyb3NzID0gdmlld0VsW3RoaXMuZGlyUHJvcChcIm9mZnNldEhlaWdodFwiLCBcIm9mZnNldFdpZHRoXCIpXTtcblxuXHRcdGlmICh2aWV3Lm1ldHJpY3MpIHtcblx0XHRcdG0uYmVmb3JlID0gdmlldy5tZXRyaWNzW3RoaXMuZGlyUHJvcChcIm1hcmdpbkxlZnRcIiwgXCJtYXJnaW5Ub3BcIildO1xuXHRcdFx0bS5vdXRlciArPSBtLmJlZm9yZTtcblx0XHRcdG0ub3V0ZXIgKz0gdmlldy5tZXRyaWNzW3RoaXMuZGlyUHJvcChcIm1hcmdpblJpZ2h0XCIsIFwibWFyZ2luQm90dG9tXCIpXTtcblx0XHRcdG0uaW5uZXIgPSB2aWV3Lm1ldHJpY3MuY29udGVudFt0aGlzLmRpclByb3AoXCJ3aWR0aFwiLCBcImhlaWdodFwiKV07XG5cdFx0XHRtLmJlZm9yZSArPSB2aWV3Lm1ldHJpY3MuY29udGVudFt0aGlzLmRpclByb3AoXCJ4XCIsIFwieVwiKV07XG5cdFx0XHRtLmFmdGVyID0gbS5vdXRlciAtIChtLmlubmVyICsgbS5iZWZvcmUpO1xuXG5cdFx0XHQvLyB2YXIgbWFyZ2luQmVmb3JlID0gdmlldy5tZXRyaWNzW3RoaXMuZGlyUHJvcChcIm1hcmdpbkxlZnRcIixcIm1hcmdpblRvcFwiKV07XG5cdFx0XHQvLyB2YXIgbWFyZ2luQWZ0ZXIgPSB2aWV3Lm1ldHJpY3NbdGhpcy5kaXJQcm9wKFwibWFyZ2luUmlnaHRcIixcIm1hcmdpbkJvdHRvbVwiKV07XG5cdFx0XHQvLyB2YXIgcG9zID0gdmlldy5tZXRyaWNzLmNvbnRlbnRbdGhpcy5kaXJQcm9wKFwieFwiLFwieVwiKV07XG5cdFx0XHQvL1xuXHRcdFx0Ly8gbS5pbm5lciA9IHZpZXcubWV0cmljcy5jb250ZW50W3RoaXMuZGlyUHJvcChcIndpZHRoXCIsXCJoZWlnaHRcIildO1xuXHRcdFx0Ly8gbS5iZWZvcmUgPSBtYXJnaW5CZWZvcmUgKyBwb3M7XG5cdFx0XHQvLyBtLm91dGVyICs9IG1hcmdpbkJlZm9yZSArIG1hcmdpbkFmdGVyO1xuXHRcdFx0Ly8gbS5hZnRlciA9IG0ub3V0ZXIgLSAobS5pbm5lciArIG0uYmVmb3JlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gdGhyb3cgbmV3IEVycm9yKFwicmVuZGVyZXIgaGFzIG5vIG1ldHJpY3NcIik7XG5cdFx0XHRjb25zb2xlLndhcm4oXCIlczo6bWVhc3VyZUl0ZW1WaWV3IHZpZXcgJyVzJyBoYXMgbm8gbWV0cmljc1wiLCB0aGlzLmNpZCwgdmlldy5jaWQpO1xuXHRcdFx0bS5pbm5lciA9IG0ub3V0ZXI7XG5cdFx0XHRtLmFmdGVyID0gbS5iZWZvcmUgPSAwO1xuXHRcdH1cblxuXHRcdHJldHVybiBtO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHNjcm9sbGluZyBwcm9wZXJ0eVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfZGVsdGE6IDAsXG5cblx0X3Njcm9sbGluZzogZmFsc2UsXG5cblx0X3NldFNjcm9sbGluZzogZnVuY3Rpb24oc2Nyb2xsaW5nKSB7XG5cdFx0Ly8gY29uc29sZS53YXJuKFwiX3NldFNjcm9sbGluZyBjdXJyZW50L3JlcXVlc3RlZFwiLCB0aGlzLl9zY3JvbGxpbmcsIHNjcm9sbGluZyk7XG5cdFx0aWYgKHRoaXMuX3Njcm9sbGluZyAhPSBzY3JvbGxpbmcpIHtcblx0XHRcdHRoaXMuX3Njcm9sbGluZyA9IHNjcm9sbGluZztcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcInNjcm9sbGluZ1wiLCBzY3JvbGxpbmcpO1xuXHRcdFx0dGhpcy50cmlnZ2VyKHNjcm9sbGluZyA/IFwidmlldzpzY3JvbGxzdGFydFwiIDogXCJ2aWV3OnNjcm9sbGVuZFwiKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogU2Nyb2xsL2xheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRzY3JvbGxCeTogZnVuY3Rpb24oZGVsdGEsIHNraXBUcmFuc2l0aW9ucykge1xuXHRcdHRoaXMuX2RlbHRhID0gZGVsdGEgfHwgMDtcblx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9ICEhc2tpcFRyYW5zaXRpb25zO1xuXHRcdC8vIHRoaXMuaW52YWxpZGF0ZUxheW91dCgpO1xuXHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LkxBWU9VVF9JTlZBTElEKTtcblx0fSxcblxuXHRfc2Nyb2xsQnk6IGZ1bmN0aW9uKGRlbHRhLCBza2lwVHJhbnNpdGlvbnMpIHtcblx0XHR2YXIgc01ldHJpY3MsIG1ldHJpY3MsIHBvcztcblxuXHRcdHNNZXRyaWNzID0gdGhpcy5tZXRyaWNzWyh0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3IHx8IHRoaXMuX3NlbGVjdGVkVmlldykuY2lkXTtcblx0XHR0aGlzLml0ZW1WaWV3cy5lYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdG1ldHJpY3MgPSB0aGlzLm1ldHJpY3Nbdmlldy5jaWRdO1xuXHRcdFx0cG9zID0gTWF0aC5mbG9vcih0aGlzLl9nZXRTY3JvbGxPZmZzZXQoZGVsdGEsIG1ldHJpY3MsIHNNZXRyaWNzKSk7XG5cdFx0XHR2aWV3Lm1ldHJpY3MudHJhbnNsYXRlWCA9ICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpID8gcG9zIDogMDtcblx0XHRcdHZpZXcubWV0cmljcy50cmFuc2xhdGVZID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyAwIDogcG9zO1xuXHRcdFx0dmlldy5tZXRyaWNzLl90cmFuc2Zvcm0gPSB0cmFuc2xhdGVUZW1wbGF0ZSh2aWV3Lm1ldHJpY3MudHJhbnNsYXRlWCwgdmlldy5tZXRyaWNzLnRyYW5zbGF0ZVkpO1xuXHRcdFx0dmlldy5lbC5zdHlsZVt0cmFuc2Zvcm1Qcm9wZXJ0eV0gPSB2aWV3Lm1ldHJpY3MuX3RyYW5zZm9ybTtcblx0XHRcdC8vIHZpZXcuZWwuc3R5bGVbdHJhbnNmb3JtUHJvcGVydHldID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCk/XG5cdFx0XHQvLyBcdFwidHJhbnNsYXRlM2QoXCIgKyBwb3MgKyBcInB4LDAsMClcIjpcblx0XHRcdC8vIFx0XCJ0cmFuc2xhdGUzZCgwLFwiICsgcG9zICsgXCJweCwwKVwiO1xuXHRcdH0sIHRoaXMpO1xuXG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwic2tpcC10cmFuc2l0aW9uc1wiLCBza2lwVHJhbnNpdGlvbnMpO1xuXHRcdHRoaXMuc2VsZWN0RnJvbVZpZXcoKTtcblx0fSxcblxuXHRfZ2V0U2Nyb2xsT2Zmc2V0OiBmdW5jdGlvbihkZWx0YSwgbUN1cnIsIG1TZWwpIHtcblx0XHR2YXIgcG9zLCBvZmZzZXQgPSAwO1xuXG5cdFx0cG9zID0gbUN1cnIucG9zIC0gbVNlbC5wb3MgKyBkZWx0YTtcblx0XHRpZiAocG9zIDwgMCkge1xuXHRcdFx0aWYgKE1hdGguYWJzKHBvcykgPCBtU2VsLm91dGVyKSB7XG5cdFx0XHRcdG9mZnNldCArPSAoLW1DdXJyLmFmdGVyKSAvIG1TZWwub3V0ZXIgKiBwb3M7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRvZmZzZXQgKz0gbUN1cnIuYWZ0ZXI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlXG5cdFx0aWYgKDAgPD0gcG9zKSB7XG5cdFx0XHRpZiAoTWF0aC5hYnMocG9zKSA8IG1TZWwub3V0ZXIpIHtcblx0XHRcdFx0b2Zmc2V0IC09IG1DdXJyLmJlZm9yZSAvIG1TZWwub3V0ZXIgKiBwb3M7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRvZmZzZXQgLT0gbUN1cnIuYmVmb3JlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gcG9zICsgb2Zmc2V0O1xuXHR9LFxuXG5cdF9vblNjcm9sbFRyYW5zaXRpb25FbmQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0aWYgKGV2LnByb3BlcnR5TmFtZSA9PT0gdHJhbnNmb3JtU3R5bGVOYW1lICYmIHRoaXMuc2Nyb2xsaW5nKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25TY3JvbGxUcmFuc2l0aW9uRW5kIHNlbGVjdGVkOiAlc1wiLCB0aGlzLmNpZCwgZXYudGFyZ2V0LmNpZCk7XG5cdFx0XHR0aGlzLl9zZXRTY3JvbGxpbmcoZmFsc2UpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiB0b2dnbGUgdG91Y2ggZXZlbnRzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF90b2dnbGVUb3VjaEV2ZW50czogZnVuY3Rpb24oZW5hYmxlKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6X3RvZ2dsZVRvdWNoRXZlbnRzXCIsIHRoaXMuY2lkLCBlbmFibGUpO1xuXHRcdGlmICh0aGlzLl90b3VjaEV2ZW50c0VuYWJsZWQgIT09IGVuYWJsZSkge1xuXHRcdFx0dGhpcy5fdG91Y2hFdmVudHNFbmFibGVkID0gZW5hYmxlO1xuXHRcdFx0aWYgKGVuYWJsZSkge1xuXHRcdFx0XHR0aGlzLnRvdWNoLm9uKFwiaHBhbnN0YXJ0IGhwYW5tb3ZlIGhwYW5lbmQgaHBhbmNhbmNlbCB0YXBcIiwgdGhpcy5fb25Ub3VjaEV2ZW50KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMudG91Y2gub2ZmKFwiaHBhbnN0YXJ0IGhwYW5tb3ZlIGhwYW5lbmQgaHBhbmNhbmNlbCB0YXBcIiwgdGhpcy5fb25Ub3VjaEV2ZW50KTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0X29uVG91Y2hFdmVudDogZnVuY3Rpb24oZXYpIHtcblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpfb25Ub3VjaEV2ZW50XCIsIHRoaXMuY2lkLCBldi50eXBlKTtcblx0XHRzd2l0Y2ggKGV2LnR5cGUpIHtcblx0XHRcdGNhc2UgXCJ0YXBcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMuX29uVGFwKGV2KTtcblx0XHRcdGNhc2UgXCJocGFuc3RhcnRcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMuX29uUGFuU3RhcnQoZXYpO1xuXHRcdFx0Y2FzZSBcImhwYW5tb3ZlXCI6XG5cdFx0XHRcdHJldHVybiB0aGlzLl9vblBhbk1vdmUoZXYpO1xuXHRcdFx0Y2FzZSBcImhwYW5lbmRcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMuX29uUGFuRmluYWwoZXYpO1xuXHRcdFx0Y2FzZSBcImhwYW5jYW5jZWxcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMuX29uUGFuRmluYWwoZXYpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiB0b3VjaCBldmVudDogcGFuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIF9wYW5DYXB0dXJlZE9mZnNldDogMCxcblxuXHQvKiogQHBhcmFtIHtPYmplY3R9IGV2ICovXG5cdF9vblBhblN0YXJ0OiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMuc2VsZWN0RnJvbVZpZXcoKTtcblx0XHR0aGlzLmVsLmNsYXNzTGlzdC5hZGQoXCJwYW5uaW5nXCIpO1xuXHRcdHRoaXMuX3NldFNjcm9sbGluZyh0cnVlKTtcblx0fSxcblxuXHQvKiogQHBhcmFtIHtPYmplY3R9IGV2ICovXG5cdF9vblBhbk1vdmU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dmFyIHZpZXcgPSB0aGlzLmdldFZpZXdBdFBhbkRpcihldi5vZmZzZXREaXJlY3Rpb24pO1xuXHRcdHZhciBkZWx0YSA9ICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpID8gZXYudGhyZXNob2xkRGVsdGFYIDogZXYudGhyZXNob2xkRGVsdGFZO1xuXHRcdC8vIHZhciBkZWx0YSA9ICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpID8gZXYuZGVsdGFYIDogZXYuZGVsdGFZO1xuXG5cdFx0aWYgKHRoaXMuX3BhbkNhbmRpZGF0ZVZpZXcgIT09IHZpZXcpIHtcblx0XHRcdHRoaXMuX3BhbkNhbmRpZGF0ZVZpZXcgJiYgdGhpcy5fcGFuQ2FuZGlkYXRlVmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FuZGlkYXRlXCIpO1xuXHRcdFx0dGhpcy5fcGFuQ2FuZGlkYXRlVmlldyA9IHZpZXc7XG5cdFx0XHR0aGlzLl9wYW5DYW5kaWRhdGVWaWV3ICYmIHRoaXMuX3BhbkNhbmRpZGF0ZVZpZXcuZWwuY2xhc3NMaXN0LmFkZChcImNhbmRpZGF0ZVwiKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuX3BhbkNhbmRpZGF0ZVZpZXcgPT09IHZvaWQgMCkge1xuXHRcdFx0ZGVsdGEgKj0gR2xvYmFscy5IUEFOX09VVF9EUkFHO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLl9yZW5kZXJSYWZJZCAhPT0gLTEpIHtcblx0XHRcdHRoaXMuc2Nyb2xsQnkoZGVsdGEsIENhcm91c2VsLklNTUVESUFURSk7XG5cdFx0XHR0aGlzLnJlbmRlck5vdygpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9zY3JvbGxCeShkZWx0YSwgQ2Fyb3VzZWwuSU1NRURJQVRFKTtcblx0XHR9XG5cdH0sXG5cblx0LyoqIEBwYXJhbSB7T2JqZWN0fSBldiAqL1xuXHRfb25QYW5GaW5hbDogZnVuY3Rpb24oZXYpIHtcblx0XHR2YXIgc2Nyb2xsQ2FuZGlkYXRlO1xuXHRcdC8vIE5PVEU6IHRoaXMgZGVsdGEgaXMgdXNlZCBmb3IgZGV0ZXJtaW5pbmcgc2VsZWN0aW9uLCBOT1QgZm9yIGxheW91dFxuXHRcdHZhciBkZWx0YSA9ICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpID8gZXYudGhyZXNob2xkRGVsdGFYIDogZXYudGhyZXNob2xkRGVsdGFZO1xuXHRcdC8vIHZhciBkZWx0YSA9ICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpID8gZXYuZGVsdGFYIDogZXYuZGVsdGFZO1xuXG5cdFx0aWYgKChldi50eXBlID09IFwiaHBhbmVuZFwiKVxuXHRcdFx0LyogcGFuIGRpcmVjdGlvbiAoY3VycmVudCBldmVudCkgYW5kIG9mZnNldERpcmVjdGlvbiAod2hvbGUgZ2VzdHVyZSkgbXVzdCBtYXRjaCAqL1xuXHRcdFx0JiYgKGV2LmRpcmVjdGlvbiBeIGV2Lm9mZnNldERpcmVjdGlvbiBeIHRoaXMuZGlyZWN0aW9uKVxuXHRcdFx0Ly8gJiYgKGV2LmRpcmVjdGlvbiAmIGV2Lm9mZnNldERpcmVjdGlvbiAmIHRoaXMuZGlyZWN0aW9uKVxuXHRcdFx0LyogZ2VzdHVyZSBtdXN0IG92ZXJzaG9vdCBzZWxlY3RUaHJlc2hvbGQgKi9cblx0XHRcdCYmIChNYXRoLmFicyhkZWx0YSkgPiB0aGlzLnNlbGVjdFRocmVzaG9sZCkpIHtcblx0XHRcdC8qIGNob29zZSBuZXh0IHNjcm9sbCB0YXJnZXQgKi9cblx0XHRcdHNjcm9sbENhbmRpZGF0ZSA9IHRoaXMuZ2V0Vmlld0F0UGFuRGlyKGV2Lm9mZnNldERpcmVjdGlvbik7XG5cdFx0fVxuXHRcdHRoaXMuX3Njcm9sbENhbmRpZGF0ZVZpZXcgPSBzY3JvbGxDYW5kaWRhdGUgfHwgdm9pZCAwO1xuXG5cdFx0aWYgKHRoaXMuX3BhbkNhbmRpZGF0ZVZpZXcgJiYgKHRoaXMuX3BhbkNhbmRpZGF0ZVZpZXcgIT09IHNjcm9sbENhbmRpZGF0ZSkpIHtcblx0XHRcdHRoaXMuX3BhbkNhbmRpZGF0ZVZpZXcuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNhbmRpZGF0ZVwiKTtcblx0XHR9XG5cdFx0dGhpcy5fcGFuQ2FuZGlkYXRlVmlldyA9IHZvaWQgMDtcblx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJwYW5uaW5nXCIpO1xuXG5cdFx0dGhpcy5zY3JvbGxCeSgwLCBDYXJvdXNlbC5BTklNQVRFRCk7XG5cdFx0dGhpcy5zZWxlY3RGcm9tVmlldygpO1xuXG5cdFx0Ly8gaWYgKHRoaXMuX3JlbmRlclJhZklkICE9PSAtMSkge1xuXHRcdC8vIFx0dGhpcy5zY3JvbGxCeSgwLCBDYXJvdXNlbC5BTklNQVRFRCk7XG5cdFx0Ly8gXHR0aGlzLnJlbmRlck5vdygpO1xuXHRcdC8vIH0gZWxzZSB7XG5cdFx0Ly8gXHR0aGlzLl9zY3JvbGxCeSgwLCBDYXJvdXNlbC5BTklNQVRFRCk7XG5cdFx0Ly8gfVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHRvdWNoIGV2ZW50OiB0YXBcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Z2V0Vmlld0F0UGFuRGlyOiBmdW5jdGlvbihkaXIpIHtcblx0XHQvLyByZXR1cm4gKGRpciAmIHRoaXMuX3ByZWNlZGluZ0RpcikgPyB0aGlzLl9wcmVjZWRpbmdWaWV3IDogdGhpcy5fZm9sbG93aW5nVmlldztcblx0XHRyZXR1cm4gKGRpciAmIHRoaXMuX2ZvbGxvd2luZ0RpcikgPyB0aGlzLl9wcmVjZWRpbmdWaWV3IDogdGhpcy5fZm9sbG93aW5nVmlldztcblx0fSxcblxuXHQvKiogQHR5cGUge2ludH0gSW4gcGl4ZWxzICovXG5cdF90YXBHcm93OiAxMCxcblxuXHRnZXRWaWV3QXRUYXBQb3M6IGZ1bmN0aW9uKHBvcywgcG9zQWNyb3NzKSB7XG5cdFx0aWYgKHRoaXMuX3RhcEFjcm9zc0JlZm9yZSA8IHBvc0Fjcm9zcyAmJiBwb3NBY3Jvc3MgPCB0aGlzLl90YXBBY3Jvc3NBZnRlcikge1xuXHRcdFx0aWYgKHBvcyA8IHRoaXMuX3RhcEJlZm9yZSkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fcHJlY2VkaW5nVmlldztcblx0XHRcdH0gZWxzZSBpZiAocG9zID4gdGhpcy5fdGFwQWZ0ZXIpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2ZvbGxvd2luZ1ZpZXc7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2b2lkIDA7XG5cdH0sXG5cblx0X29uVGFwOiBmdW5jdGlvbihldikge1xuXHRcdHZhciB0YXJnZXRWaWV3ID0gVmlldy5maW5kQnlEZXNjZW5kYW50KGV2LnRhcmdldCk7XG5cdFx0Ly8gaWYgKCF0aGlzLml0ZW1WaWV3cy5jb250YWlucyh0YXJnZXRWaWV3KSkge1xuXHRcdC8vIFx0cmV0dXJuO1xuXHRcdC8vIH1cblx0XHRkbyB7XG5cdFx0XHRpZiAodGhpcy5fc2VsZWN0ZWRWaWV3ID09PSB0YXJnZXRWaWV3KSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXMgdGFwIG9jdXJyZWQgb24gc2VsZWN0ZWQ6ICVvXCIsIHRoaXMuY2lkLCB0YXJnZXRWaWV3KTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fSBlbHNlIGlmICh0aGlzID09PSB0YXJnZXRWaWV3KSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXMgdGFwIG9jdXJyZWQgb24gY2Fyb3VzZWw6ICVvXCIsIHRoaXMuY2lkLCB0YXJnZXRWaWV3KTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSB3aGlsZSAoKHRhcmdldFZpZXcgPSB0YXJnZXRWaWV3LnBhcmVudFZpZXcpKVxuXG5cdFx0Ly8gdGhpcy5zZWxlY3RGcm9tVmlldygpO1xuXG5cdFx0dmFyIGJvdW5kcyA9IHRoaXMuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0dmFyIHRhcFggPSBldi5jZW50ZXIueCAtIGJvdW5kcy5sZWZ0O1xuXHRcdHZhciB0YXBZID0gZXYuY2VudGVyLnkgLSBib3VuZHMudG9wO1xuXHRcdHZhciB0YXBDYW5kaWRhdGUgPSB0aGlzLmdldFZpZXdBdFRhcFBvcyhcblx0XHRcdHRoaXMuZGlyUHJvcCh0YXBYLCB0YXBZKSxcblx0XHRcdHRoaXMuZGlyUHJvcCh0YXBZLCB0YXBYKVxuXHRcdCk7XG5cblx0XHRpZiAodGFwQ2FuZGlkYXRlKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25UYXAgJW9cIiwgdGhpcy5jaWQsIGV2KTtcblx0XHRcdGV2LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHQvLyBldi5zdG9wUHJvcGFnYXRpb24oKTtcblxuXHRcdFx0Ly8gdGhpcy5fc2Nyb2xsQ2FuZGlkYXRlVmlldyA9IHRhcENhbmRpZGF0ZTtcblx0XHRcdC8vIHRoaXMuX3NldFNjcm9sbGluZyh0cnVlKTtcblx0XHRcdC8vIHRoaXMuc2Nyb2xsQnkoMCwgQ2Fyb3VzZWwuQU5JTUFURUQpO1xuXHRcdFx0Ly8gdGhpcy5fc2Nyb2xsQ2FuZGlkYXRlVmlldy5lbC5jbGFzc0xpc3QuYWRkKFwiY2FuZGlkYXRlXCIpO1xuXHRcdFx0Ly8gdGhpcy5zZWxlY3RGcm9tVmlldygpO1xuXG5cdFx0XHQvLy8vIE5PVCB1c2luZyBpbnRlcm5hbFNlbGVjdGlvblxuXHRcdFx0Ly8gdGhpcy50cmlnZ2VyU2VsZWN0aW9uRXZlbnRzKHRhcENhbmRpZGF0ZSwgZmFsc2UpO1xuXG5cdFx0XHQvLyB1c2luZyBpbnRlcm5hbFNlbGVjdGlvblxuXHRcdFx0dGhpcy5fc2Nyb2xsQ2FuZGlkYXRlVmlldyA9IHRhcENhbmRpZGF0ZTtcblx0XHRcdHRoaXMuX3NldFNjcm9sbGluZyh0cnVlKTtcblx0XHRcdHRoaXMuc2Nyb2xsQnkoMCwgQ2Fyb3VzZWwuQU5JTUFURUQpO1xuXG5cdFx0XHR0aGlzLnRyaWdnZXJTZWxlY3Rpb25FdmVudHModGFwQ2FuZGlkYXRlLCB0cnVlKTtcblx0XHRcdC8vIHRoaXMucmVuZGVyTm93KCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFByaXZhdGVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0dHJpZ2dlclNlbGVjdGlvbkV2ZW50czogZnVuY3Rpb24odmlldywgaW50ZXJuYWwpIHtcblx0XHRpZiAodmlldyA9PT0gdm9pZCAwIHx8IHRoaXMuX2ludGVybmFsU2VsZWN0aW9uKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy5faW50ZXJuYWxTZWxlY3Rpb24gPSAhIWludGVybmFsO1xuXHRcdGlmICh2aWV3ID09PSB0aGlzLmVtcHR5Vmlldykge1xuXHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpzZWxlY3Q6bm9uZVwiKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpzZWxlY3Q6b25lXCIsIHZpZXcubW9kZWwpO1xuXHRcdH1cblx0XHR0aGlzLl9pbnRlcm5hbFNlbGVjdGlvbiA9IGZhbHNlO1xuXHR9LFxuXG5cdHNlbGVjdEZyb21WaWV3OiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fc2Nyb2xsQ2FuZGlkYXRlVmlldyA9PT0gdm9pZCAwKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHZhciB2aWV3ID0gdGhpcy5fc2Nyb2xsQ2FuZGlkYXRlVmlldztcblx0XHR0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3ID0gdm9pZCAwO1xuXHRcdHZpZXcuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNhbmRpZGF0ZVwiKTtcblxuXHRcdHRoaXMudHJpZ2dlclNlbGVjdGlvbkV2ZW50cyh2aWV3LCB0cnVlKTtcblx0fSxcblxuXHRhZGp1c3RUb1NlbGVjdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG0sIGkgPSB0aGlzLmNvbGxlY3Rpb24uc2VsZWN0ZWRJbmRleDtcblx0XHQvLyBhc3N1bWUgLTEgPCBpbmRleCA8IHRoaXMuY29sbGVjdGlvbi5sZW5ndGhcblx0XHRpZiAodGhpcy5yZXF1aXJlU2VsZWN0aW9uKSB7XG5cdFx0XHQoaSA9PSAtMSkgJiYgaSsrOyAvLyBpZiBzZWxlY3Rpb24gaXMgbnVsbCAoaW5kZXggLTEpLCBzZXQgX3NlbGVjdGVkVmlldyB0byBmaXJzdCBpdGVtIChpbmRleCAwKVxuXHRcdFx0dGhpcy5fc2VsZWN0ZWRWaWV3ID0gKG0gPSB0aGlzLmNvbGxlY3Rpb24uYXQoaSkpICYmIHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKG0pO1xuXHRcdFx0dGhpcy5fcHJlY2VkaW5nVmlldyA9IChtID0gdGhpcy5jb2xsZWN0aW9uLmF0KGkgLSAxKSkgJiYgdGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwobSk7XG5cdFx0XHR0aGlzLl9mb2xsb3dpbmdWaWV3ID0gKG0gPSB0aGlzLmNvbGxlY3Rpb24uYXQoaSArIDEpKSAmJiB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChtKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5fc2VsZWN0ZWRWaWV3ID0gKG0gPSB0aGlzLmNvbGxlY3Rpb24uYXQoaSkpID8gdGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwobSkgOiB0aGlzLmVtcHR5Vmlldztcblx0XHRcdHRoaXMuX3ByZWNlZGluZ1ZpZXcgPSBtICYmICgobSA9IHRoaXMuY29sbGVjdGlvbi5hdChpIC0gMSkpID8gdGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwobSkgOiB0aGlzLmVtcHR5Vmlldyk7XG5cdFx0XHR0aGlzLl9mb2xsb3dpbmdWaWV3ID0gKG0gPSB0aGlzLmNvbGxlY3Rpb24uYXQoaSArIDEpKSAmJiB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChtKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogTW9kZWwgbGlzdGVuZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRfb25TZWxlY3RPbmU6IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0aWYgKG1vZGVsID09PSB0aGlzLl9zZWxlY3RlZFZpZXcubW9kZWwpIHtcblx0XHRcdC8vIGNvbnNvbGUuaW5mbyhcIklOVEVSTkFMXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLl9vblNlbGVjdEFueShtb2RlbCk7XG5cdH0sXG5cblx0LyoqIEBwcml2YXRlICovXG5cdF9vblNlbGVjdE5vbmU6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICgodGhpcy5yZXF1aXJlU2VsZWN0aW9uID8gdGhpcy5pdGVtVmlld3MuZmlyc3QoKSA6IHRoaXMuZW1wdHlWaWV3KSA9PT0gdGhpcy5fc2VsZWN0ZWRWaWV3KSB7XG5cdFx0XHQvLyBjb25zb2xlLmluZm8oXCJJTlRFUk5BTFwiKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dGhpcy5fb25TZWxlY3RBbnkoKTtcblx0fSxcblxuXHQvKiogQHByaXZhdGUgKi9cblx0X29uU2VsZWN0QW55OiBmdW5jdGlvbihtb2RlbCkge1xuXHRcdHRoaXMuX3NlbGVjdGVkVmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwic2VsZWN0ZWRcIik7XG5cdFx0dGhpcy5hZGp1c3RUb1NlbGVjdGlvbigpO1xuXHRcdHRoaXMuX3NlbGVjdGVkVmlldy5lbC5jbGFzc0xpc3QuYWRkKFwic2VsZWN0ZWRcIik7XG5cblx0XHRpZiAoIXRoaXMuX2ludGVybmFsU2VsZWN0aW9uKSB7XG5cdFx0XHR0aGlzLl9zZXRTY3JvbGxpbmcodHJ1ZSk7XG5cdFx0XHR0aGlzLnNjcm9sbEJ5KDAsIENhcm91c2VsLkFOSU1BVEVEKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gX29uRGVzZWxlY3RBbnk6IGZ1bmN0aW9uIChtb2RlbCkge30sXG5cblx0LyoqIEBwcml2YXRlICovXG5cdF9vblJlc2V0OiBmdW5jdGlvbigpIHtcblx0XHQvLyB0aGlzLl9jcmVhdGVDaGlsZHJlbigpO1xuXHRcdC8vIHRoaXMuaW52YWxpZGF0ZUNoaWxkcmVuKCk7XG5cdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuQ0hJTERSRU5fSU5WQUxJRCB8IFZpZXcuTU9ERUxfSU5WQUxJRCk7XG5cdH0sXG5cblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBURU1QXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIF9zY3JvbGxCeTI6IGZ1bmN0aW9uIChkZWx0YSwgc2tpcFRyYW5zaXRpb25zKSB7XG5cdC8vIFx0dmFyIG1ldHJpY3MsIHBvcztcblx0Ly8gXHR2YXIgc01ldHJpY3MgPSB0aGlzLm1ldHJpY3NbKHRoaXMuX3Njcm9sbENhbmRpZGF0ZVZpZXcgfHwgdGhpcy5fc2VsZWN0ZWRWaWV3KS5jaWRdO1xuXHQvLyBcdHZhciBjTWV0cmljcyA9IHRoaXMubWV0cmljc1sodGhpcy5fcGFuQ2FuZGlkYXRlVmlldyB8fCB0aGlzLl9zZWxlY3RlZFZpZXcpLmNpZF07XG5cdC8vXG5cdC8vIFx0dGhpcy5pdGVtVmlld3MuZWFjaChmdW5jdGlvbiAodmlldykge1xuXHQvLyBcdFx0bWV0cmljcyA9IHRoaXMubWV0cmljc1t2aWV3LmNpZF07XG5cdC8vIFx0XHRwb3MgPSBNYXRoLmZsb29yKHRoaXMuX2dldFNjcm9sbE9mZnNldChkZWx0YSwgbWV0cmljcywgc01ldHJpY3MsIGNNZXRyaWNzKSk7XG5cdC8vIFx0XHR2aWV3LmVsLnN0eWxlW3RyYW5zZm9ybVByb3BlcnR5XSA9ICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpP1xuXHQvLyBcdFx0XHRcdFwidHJhbnNsYXRlM2QoXCIgKyBwb3MgKyBcInB4LDAsMClcIiA6IFwidHJhbnNsYXRlM2QoMCxcIiArIHBvcyArIFwicHgsMClcIjtcblx0Ly8gXHRcdFx0XHQvLyBcInRyYW5zbGF0ZShcIiArIHBvcyArIFwicHgsMClcIiA6IFwidHJhbnNsYXRlKDAsXCIgKyBwb3MgKyBcInB4KVwiO1xuXHQvLyBcdFx0XHRcdC8vIFwidHJhbnNsYXRlWChcIiArIHBvcyArIFwicHgpXCIgOiBcInRyYW5zbGF0ZVkoXCIgKyBwb3MgKyBcInB4KVwiO1xuXHQvLyBcdH0sIHRoaXMpO1xuXHQvLyBcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcInNraXAtdHJhbnNpdGlvbnNcIiwgc2tpcFRyYW5zaXRpb25zKTtcblx0Ly8gXHR0aGlzLnNlbGVjdEZyb21WaWV3KCk7XG5cdC8vIH0sXG5cblx0Ly8gX2dldFNjcm9sbE9mZnNldDI6IGZ1bmN0aW9uIChkZWx0YSwgbUN1cnIsIG1TZWwsIG1DYW4pIHtcblx0Ly8gXHR2YXIgb2Zmc2V0ID0gMDtcblx0Ly8gXHR2YXIgcG9zSW5uZXIgPSBtQ3Vyci5wb3NJbm5lciAtIG1TZWwucG9zSW5uZXIgKyBkZWx0YTtcblx0Ly9cblx0Ly8gXHRpZiAocG9zSW5uZXIgPCAtbVNlbC5pbm5lcikge1xuXHQvLyBcdFx0b2Zmc2V0ID0gLShtQ3Vyci5iZWZvcmUpO1xuXHQvLyBcdH0gZWxzZSBpZiAocG9zSW5uZXIgPiBtU2VsLmlubmVyKSB7XG5cdC8vIFx0XHRvZmZzZXQgPSAobVNlbC5hZnRlcik7XG5cdC8vIFx0fSBlbHNlIHtcblx0Ly8gXHRcdGlmIChwb3NJbm5lciA8IDApIHtcblx0Ly8gXHRcdFx0b2Zmc2V0ID0gKG1DdXJyLmJlZm9yZSkgLyAobUN1cnIuaW5uZXIpICogcG9zSW5uZXI7XG5cdC8vIFx0XHR9IGVsc2Uge1xuXHQvLyBcdFx0XHRvZmZzZXQgPSAobVNlbC5hZnRlcikgLyAobUNhbi5pbm5lcikgKiBwb3NJbm5lcjtcblx0Ly8gXHRcdH1cblx0Ly8gXHR9XG5cdC8vIFx0cmV0dXJuIHBvc0lubmVyICsgb2Zmc2V0O1xuXHQvLyB9LFxuXG5cdC8vIGNhcHR1cmVTZWxlY3RlZE9mZnNldDogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dmFyIHZhbCwgdmlldywgY3NzdmFsLCBtLCBtbTtcblx0Ly9cblx0Ly8gXHR2YWwgPSAwO1xuXHQvLyBcdHZpZXcgPSB0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3IHx8IHRoaXMuX3NlbGVjdGVkVmlldztcblx0Ly8gXHRjc3N2YWwgPSBnZXRDb21wdXRlZFN0eWxlKHZpZXcuZWwpW3RyYW5zZm9ybVByb3BlcnR5XTtcblx0Ly9cblx0Ly8gXHRtbSA9IGNzc3ZhbC5tYXRjaCgvKG1hdHJpeHxtYXRyaXgzZClcXCgoW15cXCldKylcXCkvKTtcblx0Ly8gXHRpZiAobW0pIHtcblx0Ly8gXHRcdG0gPSBtbVsyXS5zcGxpdChcIixcIik7XG5cdC8vIFx0XHRpZiAodGhpcy5kaXJlY3Rpb24gJiBIT1JJWk9OVEFMKSB7XG5cdC8vIFx0XHRcdHZhbCA9IG1bbW1bMV09PVwibWF0cml4XCI/IDQgOiAxMl07XG5cdC8vIFx0XHR9IGVsc2Uge1xuXHQvLyBcdFx0XHR2YWwgPSBtW21tWzFdPT1cIm1hdHJpeFwiPyA1IDogMTNdO1xuXHQvLyBcdFx0fVxuXHQvLyBcdFx0dmFsID0gcGFyc2VGbG9hdCh2YWwpO1xuXHQvLyBcdH1cblx0Ly9cblx0Ly8gXHRjb25zb2xlLmxvZyhcIiVzOjpjYXB0dXJlU2VsZWN0ZWRPZmZzZXRcIiwgdGhpcy5jaWQsIGNzc3ZhbCwgdmFsLCBjc3N2YWwubWF0Y2goL21hdHJpeFxcKCg/OlxcZFxcLCl7M30oXFxkKVxcLChcXGQpfG1hdHJpeDNkXFwoKD86XFxkXFwsKXsxMX0oXFxkKVxcLChcXGQpLykpO1xuXHQvL1xuXHQvLyBcdHJldHVybiB2YWw7XG5cdC8vIH0sXG5cblx0Ly8gX29uU2Nyb2xsRW5kOiBmdW5jdGlvbihleGVjKSB7XG5cdC8vIFx0dGhpcy5fc2Nyb2xsRW5kQ2FuY2VsbGFibGUgPSB2b2lkIDA7XG5cdC8vIFx0Ly8gdGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiZGlzYWJsZWQtY2hhbmdpbmdcIik7XG5cdC8vIFx0aWYgKGV4ZWMpIHtcblx0Ly8gXHRcdHRoaXMuX3NldFNjcm9sbGluZyhmYWxzZSk7XG5cdC8vIFx0XHQvLyB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJzY3JvbGxpbmdcIik7XG5cdC8vIFx0XHQvLyB0aGlzLnRyaWdnZXIoXCJ2aWV3OnNjcm9sbGVuZFwiKTtcblx0Ly8gXHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vblNjcm9sbEVuZFwiLCB0aGlzLmNpZCk7XG5cdC8vIFx0fVxuXHQvLyB9LFxuXHQvLyBfb25Nb3VzZURvd246IGZ1bmN0aW9uKGV2KSB7XG5cdC8vIFx0aWYgKHRoaXMuX3Njcm9sbGluZykge1xuXHQvLyBcdFx0dGhpcy5fcGFuQ2FwdHVyZWRPZmZzZXQgPSB0aGlzLmNhcHR1cmVTZWxlY3RlZE9mZnNldCgpO1xuXHQvLyBcdFx0Y29uc29sZS5sb2coXCIlczo6ZXZlbnRzW21vdXNlZG93bl0gc2Nyb2xsaW5nIGludGVycnVwdGVkIChwb3MgJWYpXCIsIHRoaXMuY2lkLCB0aGlzLl9wYW5DYXB0dXJlZE9mZnNldCk7XG5cdC8vIFx0fVxuXHQvLyB9LFxuXHQvLyBfb25Nb3VzZVVwOmZ1bmN0aW9uKGV2KSB7XG5cdC8vIFx0dGhpcy5fcGFuQ2FwdHVyZWRPZmZzZXQgPSAwO1xuXHQvLyB9LFxuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IENhcm91c2VsID0gVmlldy5leHRlbmQoQ2Fyb3VzZWxQcm90bywgQ2Fyb3VzZWwpOyIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgaGVscGVyO1xuXG4gIHJldHVybiBjb250YWluZXIuZXNjYXBlRXhwcmVzc2lvbigoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLmlkIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5pZCA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBoZWxwZXJzLmhlbHBlck1pc3NpbmcpLCh0eXBlb2YgaGVscGVyID09PSBcImZ1bmN0aW9uXCIgPyBoZWxwZXIuY2FsbChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LHtcIm5hbWVcIjpcImlkXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L0NvbGxlY3Rpb25TdGFja1xuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG4vLyB2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG4vLyB2YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuLy8gLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbi8vIHZhciB0cmFuc2l0aW9uRW5kID0gcmVxdWlyZShcInV0aWxzL2V2ZW50L3RyYW5zaXRpb25FbmRcIik7XG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIHNldEltbWVkaWF0ZSA9IHJlcXVpcmUoXCJ1dGlscy9zZXRJbW1lZGlhdGVcIik7XG5cbi8qKiBAdHlwZSB7c3RyaW5nfSAqL1xudmFyIHZpZXdUZW1wbGF0ZSA9IHJlcXVpcmUoXCIuL0NvbGxlY3Rpb25TdGFjay5oYnNcIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9jb21wb25lbnQvQ29sbGVjdGlvblN0YWNrfVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNpZFByZWZpeDogXCJzdGFja1wiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwiZGl2XCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcInN0YWNrXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGVtcGxhdGU6IHZpZXdUZW1wbGF0ZSxcblxuXHRldmVudHM6IHtcblx0XHRcInRyYW5zaXRpb25lbmRcIjogZnVuY3Rpb24oZXYpIHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OnRyYW5zaXRpb25lbmQgW2ludmFsaWQ6ICVzXSBbdHJhbnNpdGlvbjogJXNdXCIsIHRoaXMuY2lkLCB0aGlzLl9jb250ZW50SW52YWxpZCwgKHRoaXMuX3NraXBUcmFuc2l0aW9ucz8gXCJza2lwXCI6IFwicnVuXCIpLCBldi50YXJnZXQuaWQsIGV2LnRhcmdldC5jbGFzc05hbWUpO1xuXHRcdFx0dGhpcy5fcmVuZGVyQ29udGVudCgpO1xuXHRcdH1cblx0fSxcblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dGhpcy5fZW5hYmxlZCA9IHRydWU7XG5cdFx0dGhpcy5fc2tpcFRyYW5zaXRpb25zID0gdHJ1ZTtcblx0XHR0aGlzLl9jb250ZW50SW52YWxpZCA9IHRydWU7XG5cblx0XHRvcHRpb25zLnRlbXBsYXRlICYmICh0aGlzLnRlbXBsYXRlID0gb3B0aW9ucy50ZW1wbGF0ZSk7XG5cdFx0dGhpcy5jb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHR0aGlzLmNvbnRlbnQuY2xhc3NOYW1lID0gXCJzdGFjay1pdGVtXCI7XG5cdFx0dGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLmNvbnRlbnQpO1xuXG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sIFwic2VsZWN0Om9uZSBzZWxlY3Q6bm9uZVwiLCB0aGlzLl9vblNlbGVjdENoYW5nZSk7XG5cdH0sXG5cblx0c2V0RW5hYmxlZDogZnVuY3Rpb24oZW5hYmxlZCkge1xuXHRcdGlmICh0aGlzLl9lbmFibGVkICE9PSBlbmFibGVkKSB7XG5cdFx0XHR0aGlzLl9lbmFibGVkID0gZW5hYmxlZDtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImRpc2FibGVkXCIsICF0aGlzLl9lbmFibGVkKTtcblx0XHR9XG5cdH0sXG5cblx0X29uU2VsZWN0Q2hhbmdlOiBmdW5jdGlvbihpdGVtKSB7XG5cdFx0aWYgKHRoaXMuX3JlbmRlcmVkSXRlbSA9PT0gdGhpcy5jb2xsZWN0aW9uLnNlbGVjdGVkKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJjaGFuZ2UgZXZlbnQgcmVjZWl2ZWQgYnV0IGl0ZW0gaXMgaWRlbnRpY2FsXCIpO1xuXHRcdH1cblx0XHR0aGlzLl9yZW5kZXJlZEl0ZW0gPSB0aGlzLmNvbGxlY3Rpb24uc2VsZWN0ZWQ7XG5cblx0XHR0aGlzLl9jb250ZW50SW52YWxpZCA9IHRydWU7XG5cdFx0dGhpcy5yZW5kZXIoKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiByZW5kZXJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0XHQvLyBleGVjdXRlIGV2ZW4gaWYgY29udGVudCBoYXMgbm90IGNoYW5nZWQgdG8gYXBwbHkgc3R5bGVzIGltbWVkaWF0ZWx5XG5cdFx0XHR0aGlzLl9za2lwVHJhbnNpdGlvbnMgPSBmYWxzZTtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcInNraXAtdHJhbnNpdGlvbnNcIik7XG5cdFx0XHRzZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcInNraXAtdHJhbnNpdGlvbnNcIik7XG5cdFx0XHR9LmJpbmQodGhpcykpO1xuXG5cdFx0XHQvLyByZW5kZXIgY2hhbmdlZCBjb250ZW50IGltbWVkaWF0ZWx5XG5cdFx0XHRpZiAodGhpcy5fY29udGVudEludmFsaWQpIHtcblx0XHRcdFx0dGhpcy5fcmVuZGVyQ29udGVudCgpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBlbHNlIHJlbW92ZSAnY3VycmVudCcgY2xhc3MgYW5kIHJlbmRlciBvbiB0cmFuc2l0aW9uZW5kXG5cdFx0XHRpZiAodGhpcy5fY29udGVudEludmFsaWQpIHtcblx0XHRcdFx0dGhpcy5jb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJjdXJyZW50XCIpO1xuXHRcdFx0XHQvLyB0aGlzLmNvbnRlbnQuY2xhc3NOYW1lID0gXCJzdGFjay1pdGVtXCI7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdF9yZW5kZXJDb250ZW50OiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fY29udGVudEludmFsaWQpIHtcblx0XHRcdHRoaXMuX2NvbnRlbnRJbnZhbGlkID0gZmFsc2U7XG5cdFx0XHR2YXIgaXRlbSA9IHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZDtcblx0XHRcdHRoaXMuY29udGVudC5pbm5lckhUTUwgPSBpdGVtID8gdGhpcy50ZW1wbGF0ZShpdGVtLnRvSlNPTigpKSA6IFwiXCI7XG5cdFx0XHR0aGlzLmNvbnRlbnQuY2xhc3NMaXN0LmFkZChcImN1cnJlbnRcIik7XG5cdFx0XHQvLyB0aGlzLmNvbnRlbnQuY2xhc3NOYW1lID0gXCJzdGFjay1pdGVtIGN1cnJlbnRcIjtcblx0XHR9XG5cdH0sXG59KTtcbiIsIi8qKlxuLyogQG1vZHVsZSBhcHAvdmlldy9jb21wb25lbnQvRmlsdGVyYWJsZUxpc3RWaWV3XG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lLmJhYnlzaXR0ZXJ9ICovXG52YXIgQ29udGFpbmVyID0gcmVxdWlyZShcImJhY2tib25lLmJhYnlzaXR0ZXJcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9DbGlja2FibGVSZW5kZXJlcn0gKi9cbnZhciBDbGlja2FibGVSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFByb3BlcnR5fSAqL1xudmFyIHByZWZpeGVkUHJvcGVydHkgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRQcm9wZXJ0eVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL2Nzcy9nZXRCb3hFZGdlU3R5bGVzfSAqL1xudmFyIGdldEJveEVkZ2VTdHlsZXMgPSByZXF1aXJlKFwidXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXNcIik7XG5cbnZhciBkaWZmID0gZnVuY3Rpb24oYTEsIGEyLCBkZXN0KSB7XG5cdHJldHVybiBhMS5yZWR1Y2UoZnVuY3Rpb24ocmVzLCBvLCBpLCBhKSB7XG5cdFx0aWYgKGEyLmluZGV4T2YobykgPT0gLTEpIHJlcy5wdXNoKG8pO1xuXHRcdHJldHVybiByZXM7XG5cdH0sIGRlc3QgfHwgW10pO1xufTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFscy5UUkFOU0xBVEVfVEVNUExBVEV9ICovXG52YXIgdHJhbnNsYXRlQ3NzVmFsdWUgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKS5UUkFOU0xBVEVfVEVNUExBVEU7XG5cbi8qKiBAY29uc3QgKi9cbnZhciB0cmFuc2Zvcm1Qcm9wID0gcHJlZml4ZWRQcm9wZXJ0eShcInRyYW5zZm9ybVwiKTtcblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0ZpbHRlcmFibGVMaXN0Vmlld31cbi8qL1xudmFyIEZpbHRlcmFibGVMaXN0VmlldyA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcImZpbHRlcmFibGVMaXN0XCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJ1bFwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJsaXN0IHNlbGVjdGFibGUgZmlsdGVyYWJsZVwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0ZGVmYXVsdHM6IHtcblx0XHRjb2xsYXBzZWQ6IHRydWUsXG5cdFx0ZmlsdGVyRm46IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fSxcblx0XHRyZW5kZXJlcjogQ2xpY2thYmxlUmVuZGVyZXIuZXh0ZW5kKHtcblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGNpZFByZWZpeDogXCJsaXN0SXRlbVwiLFxuXHRcdH0pLFxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cHJvcGVydGllczoge1xuXHRcdGNvbGxhcHNlZDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2NvbGxhcHNlZDtcblx0XHRcdH0sXG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHRoaXMuX3NldENvbGxhcHNlZCh2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzZWxlY3RlZEl0ZW06IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9zZWxlY3RlZEl0ZW07XG5cdFx0XHR9LFxuXHRcdFx0c2V0OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdFx0XHR0aGlzLl9zZXRTZWxlY3Rpb24odmFsdWUpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0ZmlsdGVyZWRJdGVtczoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2ZpbHRlcmVkSXRlbXM7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0ZXZlbnRzOiB7XG5cdFx0XCJ0cmFuc2l0aW9uZW5kIC5saXN0LWl0ZW1cIjogZnVuY3Rpb24oZXYpIHtcblx0XHRcdGlmICh0aGlzLl9jb2xsYXBzZWRUcmFuc2l0aW9uaW5nICYmIGV2LnByb3BlcnR5TmFtZSA9PT0gXCJ2aXNpYmlsaXR5XCIgLyomJiB0aGlzLmVsLmNsYXNzTGlzdC5jb250YWlucyhcImNvbGxhcHNlZC1jaGFuZ2VkXCIpKi8gKSB7XG5cdFx0XHRcdHRoaXMuX2NvbGxhcHNlZFRyYW5zaXRpb25pbmcgPSBmYWxzZTtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY29sbGFwc2VkLWNoYW5nZWRcIik7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6OmV2ZW50c1t0cmFuc2l0aW9uZW5kIC5saXN0LWl0ZW1dIGNvbGxhcHNlZC1jaGFuZ2VkIGVuZFwiLCB0aGlzLmNpZCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLl9tZXRyaWNzID0ge307XG5cdFx0dGhpcy5faXRlbU1ldHJpY3MgPSBbXTtcblx0XHR0aGlzLml0ZW1WaWV3cyA9IG5ldyBDb250YWluZXIoKTtcblxuXHRcdF8uZGVmYXVsdHMob3B0aW9ucywgdGhpcy5kZWZhdWx0cyk7XG5cdFx0dGhpcy5yZW5kZXJlciA9IG9wdGlvbnMucmVuZGVyZXI7XG5cdFx0dGhpcy5fZmlsdGVyRm4gPSBvcHRpb25zLmZpbHRlckZuO1xuXHRcdHRoaXMuX2ZpbHRlcmVkSXRlbXMgPSBbXTtcblxuXHRcdHRoaXMuY29sbGVjdGlvbi5lYWNoKHRoaXMuY3JlYXRlSXRlbVZpZXcsIHRoaXMpO1xuXHRcdHRoaXMucmVmcmVzaCgpO1xuXHRcdHRoaXMuX3NldFNlbGVjdGlvbih0aGlzLmNvbGxlY3Rpb24uc2VsZWN0ZWQpO1xuXHRcdHRoaXMuX3NldENvbGxhcHNlZChvcHRpb25zLmNvbGxhcHNlZCk7XG5cblx0XHQvLyB3aWxsIHRyaWdnZXIgb24gcmV0dXJuIGlmIHRoaXMuZWwgaXMgYWxyZWFkeSBhdHRhY2hlZFxuXHRcdC8vIHRoaXMuc2tpcFRyYW5zaXRpb25zID0gdHJ1ZTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwidmlldzphdHRhY2hlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gdHJ1ZTtcblx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpOyAvLy5yZW5kZXJOb3coKTtcblx0XHR9KTtcblxuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCBcInNlbGVjdDpvbmUgc2VsZWN0Om5vbmVcIiwgdGhpcy5fc2V0U2VsZWN0aW9uKTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwgXCJyZXNldFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuX2FsbEl0ZW1zID0gbnVsbDtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIm5vdCBpbXBsZW1lbnRlZFwiKTtcblx0XHR9KTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBSZW5kZXJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW5kZXJGcmFtZTogZnVuY3Rpb24odHN0YW1wLCBmbGFncykge1xuXHRcdGlmIChERUJVRykge1xuXHRcdFx0dmFyIGNoYW5nZWQgPSBbXTtcblx0XHRcdHRoaXMuX2NvbGxhcHNlZENoYW5nZWQgJiYgY2hhbmdlZC5wdXNoKFwiY29sbGFwc2VkXCIpO1xuXHRcdFx0dGhpcy5fc2VsZWN0aW9uQ2hhbmdlZCAmJiBjaGFuZ2VkLnB1c2goXCJzZWxlY3Rpb25cIik7XG5cdFx0XHR0aGlzLl9maWx0ZXJDaGFuZ2VkICYmIGNoYW5nZWQucHVzaChcImZpbHRlclwiKTtcblx0XHRcdC8vY29uc29sZS5sb2coXCIlczo6cmVuZGVyRnJhbWUgWyVzXVwiLCB0aGlzLmNpZCwgY2hhbmdlZC5qb2luKFwiIFwiKSk7XG5cdFx0fVxuXG5cdFx0Ly8gY29sbGFwc2VkIHRyYW5zaXRpb24gZmxhZ1xuXHRcdGlmICh0aGlzLl9jb2xsYXBzZWRUcmFuc2l0aW9uaW5nKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCIlczo6cmVuZGVyRnJhbWUgY29sbGFwc2VkIHR4IGludGVycnVwdGVkXCIsIHRoaXMuY2lkKTtcblx0XHR9XG5cblx0XHR0aGlzLl9jb2xsYXBzZWRUcmFuc2l0aW9uaW5nID0gIXRoaXMuc2tpcFRyYW5zaXRpb25zICYmIHRoaXMuX2NvbGxhcHNlZENoYW5nZWQ7XG5cblx0XHQvLyB0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJhbmltYXRlXCIsICF0aGlzLnNraXBUcmFuc2l0aW9ucyk7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY29sbGFwc2VkLWNoYW5nZWRcIiwgdGhpcy5fY29sbGFwc2VkVHJhbnNpdGlvbmluZyk7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwic2tpcC10cmFuc2l0aW9uc1wiLCB0aGlzLnNraXBUcmFuc2l0aW9ucyk7XG5cdFx0aWYgKHRoaXMuc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IGZhbHNlO1xuXHRcdFx0Ly8gSW52YWxpZGF0ZSBhZ2FpbiBhZnRlciBmcmFtZSByZW5kZXIgbG9vcCB0byByZWFwcGx5IHRyYW5zZm9ybXM6XG5cdFx0XHQvLyB0aGF0IHNob3VsZCBraWxsIGFueSBydW5uaW5nIHRyYW5zaXRpb25zLlxuXHRcdFx0dGhpcy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LkxBWU9VVF9JTlZBTElEKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fY29sbGFwc2VkQ2hhbmdlZCkge1xuXHRcdFx0ZmxhZ3MgfD0gKFZpZXcuU0laRV9JTlZBTElEKTtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImNvbGxhcHNlZFwiLCB0aGlzLl9jb2xsYXBzZWQpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fc2VsZWN0aW9uQ2hhbmdlZCkge1xuXHRcdFx0ZmxhZ3MgfD0gVmlldy5MQVlPVVRfSU5WQUxJRDtcblx0XHRcdHRoaXMucmVuZGVyU2VsZWN0aW9uKHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZCwgdGhpcy5jb2xsZWN0aW9uLmxhc3RTZWxlY3RlZCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLl9maWx0ZXJDaGFuZ2VkKSB7XG5cdFx0XHRmbGFncyB8PSBWaWV3LkxBWU9VVF9JTlZBTElEO1xuXHRcdFx0dGhpcy5yZW5kZXJGaWx0ZXJGbigpO1xuXHRcdH1cblx0XHRpZiAoZmxhZ3MgJiBWaWV3LlNJWkVfSU5WQUxJRCkge1xuXHRcdFx0dGhpcy5tZWFzdXJlKCk7XG5cdFx0fVxuXHRcdGlmIChmbGFncyAmIChWaWV3LkxBWU9VVF9JTlZBTElEIHwgVmlldy5TSVpFX0lOVkFMSUQpKSB7XG5cdFx0XHR0aGlzLnJlbmRlckxheW91dCgpO1xuXHRcdH1cblx0XHR0aGlzLl9jb2xsYXBzZWRDaGFuZ2VkID0gdGhpcy5fc2VsZWN0aW9uQ2hhbmdlZCA9IHRoaXMuX2ZpbHRlckNoYW5nZWQgPSBmYWxzZTtcblx0fSxcblxuXHRtZWFzdXJlOiBmdW5jdGlvbigpIHtcblx0XHQvLyB2YXIgaSwgaWksIGVsLCBlbHMsIG0sIG1tO1xuXHRcdC8vIGVscyA9IHRoaXMuZWwuY2hpbGRyZW47XG5cdFx0Ly8gaWkgPSBlbHMubGVuZ3RoO1xuXHRcdC8vIG1tID0gdGhpcy5faXRlbU1ldHJpY3M7XG5cdFx0Ly8gZm9yIChpID0gMDsgaSA8IGlpOyBpKyspIHtcblx0XHQvLyBcdG1tW2ldID0gXy5waWNrKGVsc1tpXSwgXCJvZmZzZXRUb3BcIiwgXCJvZmZzZXRIZWlnaHRcIik7XG5cdFx0Ly8gfVxuXG5cdFx0dGhpcy5fbWV0cmljcyA9IGdldEJveEVkZ2VTdHlsZXModGhpcy5lbCwgdGhpcy5fbWV0cmljcyk7XG5cblx0XHQvLyB2YXIgaXRlbUVsLCBpdGVtVmlldywgYmFzZWxpbmUgPSAwO1xuXHRcdC8vIGlmIChpdGVtRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIubGlzdC1pdGVtOm5vdCguZXhjbHVkZWQpIC5sYWJlbFwiKSkge1xuXHRcdC8vIFx0Ly8gaXRlbVZpZXcgPSB0aGlzLml0ZW1WaWV3cy5maW5kQnlDaWQoaXRlbUVsLmNpZCk7XG5cdFx0Ly8gXHR2YXIgZWxBID0gaXRlbUVsLCBlbEIgPSBpdGVtRWwucGFyZW50RWxlbWVudDtcblx0XHQvLyBcdHZhciB5QSA9IGVsQS5vZmZzZXRUb3AsXG5cdFx0Ly8gXHRcdGhBID0gZWxBLm9mZnNldEhlaWdodCxcblx0XHQvLyBcdFx0eUIgPSBlbEIub2Zmc2V0VG9wLFxuXHRcdC8vIFx0XHRoQiA9IGVsQi5vZmZzZXRIZWlnaHQ7XG5cdFx0Ly8gXHRiYXNlbGluZSA9ICgoeUEgKyBoQSkgLSAoeUIgKyBoQikpO1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCIlczo6bWVhc3VyZSBmb250U2l6ZTogJXNweCAoJXMrJXMpLSglcyslcyk9JXNcIiwgdGhpcy5jaWQsIHRoaXMuX21ldHJpY3MuZm9udFNpemUsXG5cdFx0Ly8gXHRcdHlBLCBoQSwgeUIsIGhCLCBiYXNlbGluZVxuXHRcdC8vIFx0KTtcblx0XHQvLyB9XG5cblx0XHR0aGlzLml0ZW1WaWV3cy5mb3JFYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdGlmICghdmlldy5fbWV0cmljcykgdmlldy5fbWV0cmljcyA9IHt9O1xuXHRcdFx0Ly8gdmlldy5fbWV0cmljcy5iYXNlbGluZSA9IHRoaXMuX21ldHJpY3MuZm9udFNpemUgLSBiYXNlbGluZTtcblx0XHRcdHZpZXcuX21ldHJpY3Mub2Zmc2V0VG9wID0gdmlldy5lbC5vZmZzZXRUb3A7XG5cdFx0XHR2aWV3Ll9tZXRyaWNzLm9mZnNldEhlaWdodCA9IHZpZXcuZWwub2Zmc2V0SGVpZ2h0O1xuXHRcdFx0dmlldy5fbWV0cmljcy5vZmZzZXRMZWZ0ID0gdmlldy5lbC5vZmZzZXRMZWZ0O1xuXHRcdFx0dmlldy5fbWV0cmljcy5vZmZzZXRXaWR0aCA9IHZpZXcuZWwub2Zmc2V0V2lkdGg7XG5cdFx0XHRpZiAoIXRoaXMuX2NvbGxhcHNlZCAmJiB2aWV3LmxhYmVsKSB7XG5cdFx0XHRcdHZpZXcuX21ldHJpY3MudGV4dExlZnQgPSB2aWV3LmxhYmVsLm9mZnNldExlZnQ7XG5cdFx0XHRcdHZpZXcuX21ldHJpY3MudGV4dFdpZHRoID0gdmlldy5sYWJlbC5vZmZzZXRXaWR0aDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHZpZXcuX21ldHJpY3MudGV4dExlZnQgPSB2aWV3Ll9tZXRyaWNzLm9mZnNldExlZnQ7XG5cdFx0XHRcdHZpZXcuX21ldHJpY3MudGV4dFdpZHRoID0gdmlldy5fbWV0cmljcy5vZmZzZXRXaWR0aDtcblx0XHRcdH1cblx0XHR9LCB0aGlzKTtcblxuXHRcdC8vIHRoaXMuX21ldHJpY3MuYmFzZWxpbmUgPSB0aGlzLl9tZXRyaWNzLmZvbnRTaXplIC0gYmFzZWxpbmU7XG5cdH0sXG5cblx0cmVuZGVyTGF5b3V0OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgcG9zWCwgcG9zWTtcblx0XHRwb3NYID0gdGhpcy5fbWV0cmljcy5wYWRkaW5nTGVmdDtcblx0XHRwb3NZID0gdGhpcy5fbWV0cmljcy5wYWRkaW5nVG9wO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5lbC5jaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHR2YXIgdmlldyA9IHRoaXMuaXRlbVZpZXdzLmZpbmRCeUNpZCh0aGlzLmVsLmNoaWxkcmVuW2ldLmNpZCk7XG5cdFx0XHRpZiAoKCh0aGlzLmNvbGxlY3Rpb24uc2VsZWN0ZWQgJiYgIXZpZXcubW9kZWwuc2VsZWN0ZWQpIHx8XG5cdFx0XHRcdFx0dmlldy5lbC5jbGFzc0xpc3QuY29udGFpbnMoXCJleGNsdWRlZFwiKSkgJiYgdGhpcy5fY29sbGFwc2VkKSB7XG5cdFx0XHRcdHZpZXcudHJhbnNmb3JtLnR4ID0gcG9zWDtcblx0XHRcdFx0dmlldy50cmFuc2Zvcm0udHkgPSBwb3NZO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKHZpZXcuX21ldHJpY3Mub2Zmc2V0SGVpZ2h0ID09IDApXG5cdFx0XHRcdFx0cG9zWSAtPSB2aWV3Ll9tZXRyaWNzLm9mZnNldFRvcDtcblx0XHRcdFx0dmlldy50cmFuc2Zvcm0udHggPSBwb3NYO1xuXHRcdFx0XHR2aWV3LnRyYW5zZm9ybS50eSA9IHBvc1k7XG5cdFx0XHRcdHBvc1kgKz0gdmlldy5fbWV0cmljcy5vZmZzZXRIZWlnaHQgKyB2aWV3Ll9tZXRyaWNzLm9mZnNldFRvcDtcblx0XHRcdH1cblx0XHRcdHZpZXcuZWwuc3R5bGVbdHJhbnNmb3JtUHJvcF0gPSB0cmFuc2xhdGVDc3NWYWx1ZSh2aWV3LnRyYW5zZm9ybS50eCwgdmlldy50cmFuc2Zvcm0udHkpO1xuXHRcdH1cblxuXHRcdC8vIHBvc1kgKz0gdGhpcy5fbWV0cmljcy5wYWRkaW5nQm90dG9tO1xuXHRcdHRoaXMuX21ldHJpY3MuaGVpZ2h0ID0gTWF0aC5tYXgoMCwgcG9zWSArIHRoaXMuX21ldHJpY3MucGFkZGluZ0JvdHRvbSk7XG5cdFx0dGhpcy5lbC5zdHlsZS5oZWlnaHQgPSB0aGlzLl9tZXRyaWNzLmhlaWdodCArIFwicHhcIjtcblx0XHQvLyB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IChwb3NZID4gMCkgPyBwb3NZICsgXCJweFwiIDogXCJcIjtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBDaGlsZCB2aWV3c1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQHByaXZhdGUgKi9cblx0Y3JlYXRlSXRlbVZpZXc6IGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgdGhpcy5yZW5kZXJlcih7XG5cdFx0XHRtb2RlbDogaXRlbSxcblx0XHRcdGVsOiB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIubGlzdC1pdGVtW2RhdGEtaWQ9XFxcIlwiICsgaXRlbS5pZCArIFwiXFxcIl1cIilcblx0XHR9KTtcblx0XHRpdGVtLnNldChcImV4Y2x1ZGVkXCIsIGZhbHNlLCB7IHNpbGVudDogdHJ1ZSB9KTtcblx0XHR0aGlzLmxpc3RlblRvKHZpZXcsIFwicmVuZGVyZXI6Y2xpY2tcIiwgdGhpcy5fb25SZW5kZXJlckNsaWNrKTtcblx0XHR2aWV3Lmxpc3RlblRvKGl0ZW0sIFwiY2hhbmdlOmV4Y2x1ZGVkXCIsIGZ1bmN0aW9uKGl0ZW0sIG5ld1ZhbCkge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coYXJndW1lbnRzKTtcblx0XHRcdGlmICh0aGlzLmVsLmNsYXNzTGlzdC5jb250YWlucyhcImV4Y2x1ZGVkXCIpICE9PSBuZXdWYWwpIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiJXM6W2NoYW5nZTpleGNsdWRlZF0gbTolbyBjc3M6ICVvXCIsIHRoaXMuY2lkLCBuZXdWYWwsIHRoaXMuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZXhjbHVkZWRcIikpO1xuXHRcdFx0fVxuXHRcdFx0Ly8gdGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZXhjbHVkZWRcIiwgZXhjbHVkZWQpO1xuXHRcdH0pO1xuXHRcdHRoaXMuaXRlbVZpZXdzLmFkZCh2aWV3KTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvKiogQHByaXZhdGUgKi9cblx0X29uUmVuZGVyZXJDbGljazogZnVuY3Rpb24oaXRlbSwgZXYpIHtcblx0XHRpZiAodGhpcy5fY29sbGFwc2VkVHJhbnNpdGlvbmluZ1xuXHRcdFx0fHwgKHRoaXMuX2NvbGxhcHNlZCAmJiBpdGVtLmdldChcImV4Y2x1ZGVkXCIpKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAodGhpcy5jb2xsZWN0aW9uLnNlbGVjdGVkICE9PSBpdGVtKSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpvbmVcIiwgaXRlbSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmIChldi5hbHRLZXkpIHtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpzZWxlY3Q6bm9uZVwiKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6c2VsZWN0OnNhbWVcIiwgaXRlbSk7XG5cdFx0XHR9XG5cdFx0XHQvLyB0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpub25lXCIpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBDb2xsYXBzZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBwcml2YXRlICovXG5cdF9jb2xsYXBzZWQ6IHVuZGVmaW5lZCxcblxuXHQvKipcblx0LyogQHBhcmFtIHtCb29sZWFufVxuXHQvKi9cblx0X3NldENvbGxhcHNlZDogZnVuY3Rpb24oY29sbGFwc2VkKSB7XG5cdFx0aWYgKGNvbGxhcHNlZCAhPT0gdGhpcy5fY29sbGFwc2VkKSB7XG5cdFx0XHR0aGlzLl9jb2xsYXBzZWQgPSBjb2xsYXBzZWQ7XG5cdFx0XHR0aGlzLl9jb2xsYXBzZWRDaGFuZ2VkID0gdHJ1ZTtcblx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcigpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBTZWxlY3Rpb25cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBwcml2YXRlICovXG5cdF9zZWxlY3RlZEl0ZW06IHVuZGVmaW5lZCxcblxuXHQvKiogQHBhcmFtIHtCYWNrYm9uZS5Nb2RlbHxudWxsfSAqL1xuXHRfc2V0U2VsZWN0aW9uOiBmdW5jdGlvbihpdGVtKSB7XG5cdFx0aWYgKGl0ZW0gIT09IHRoaXMuX3NlbGVjdGVkSXRlbSkge1xuXHRcdFx0dGhpcy5fc2VsZWN0ZWRJdGVtID0gaXRlbTtcblx0XHRcdHRoaXMuX3NlbGVjdGlvbkNoYW5nZWQgPSB0cnVlO1xuXHRcdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuTU9ERUxfSU5WQUxJRCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRyZW5kZXJTZWxlY3Rpb246IGZ1bmN0aW9uKG5ld0l0ZW0sIG9sZEl0ZW0pIHtcblx0XHR2YXIgdmlldztcblx0XHRpZiAob2xkSXRlbSkge1xuXHRcdFx0dmlldyA9IHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKG9sZEl0ZW0pO1xuXHRcdFx0dmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwic2VsZWN0ZWRcIik7XG5cdFx0XHQvLyB2aWV3LmxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb2xvci1mZ1wiKTtcblx0XHRcdC8vIHZpZXcubGFiZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbG9yLXJldmVyc2VcIik7XG5cdFx0fVxuXHRcdGlmIChuZXdJdGVtKSB7XG5cdFx0XHR2aWV3ID0gdGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwobmV3SXRlbSk7XG5cdFx0XHR2aWV3LmVsLmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZFwiKTtcblx0XHRcdC8vIHZpZXcubGFiZWwuY2xhc3NMaXN0LmFkZChcImNvbG9yLWZnXCIpO1xuXHRcdFx0Ly8gdmlldy5sYWJlbC5jbGFzc0xpc3QuYWRkKFwiY29sb3ItcmV2ZXJzZVwiKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogRmlsdGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9maWx0ZXJGbikge1xuXHRcdFx0dGhpcy5fZmlsdGVyQ2hhbmdlZCA9IHRydWU7XG5cdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5NT0RFTF9JTlZBTElEKTtcblx0XHR9XG5cdH0sXG5cblx0cmVuZGVyRmlsdGVyRm46IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBpdGVtcyA9IHRoaXMuX2ZpbHRlckZuID8gdGhpcy5jb2xsZWN0aW9uLmZpbHRlcih0aGlzLl9maWx0ZXJGbiwgdGhpcykgOiB0aGlzLl9nZXRBbGxJdGVtcygpO1xuXHRcdHRoaXMucmVuZGVyRmlsdGVycyhpdGVtcywgdGhpcy5fZmlsdGVyZWRJdGVtcyk7XG5cdFx0dGhpcy5fZmlsdGVyZWRJdGVtcyA9IGl0ZW1zO1xuXHR9LFxuXG5cdHJlbmRlckZpbHRlcnM6IGZ1bmN0aW9uKG5ld0l0ZW1zLCBvbGRJdGVtcykge1xuXHRcdHZhciBoYXNOZXcgPSAhIShuZXdJdGVtcyAmJiBuZXdJdGVtcy5sZW5ndGgpO1xuXHRcdHZhciBoYXNPbGQgPSAhIShvbGRJdGVtcyAmJiBvbGRJdGVtcy5sZW5ndGgpO1xuXG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6cmVuZGVyRmlsdGVyRm5cIiwgdGhpcy5jaWQsIG5ld0l0ZW1zKTtcblxuXHRcdGlmIChoYXNOZXcpIHtcblx0XHRcdGRpZmYoKGhhc09sZCA/IG9sZEl0ZW1zIDogdGhpcy5fZ2V0QWxsSXRlbXMoKSksIG5ld0l0ZW1zKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0dGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoaXRlbSkuZWwuY2xhc3NMaXN0LmFkZChcImV4Y2x1ZGVkXCIpO1xuXHRcdFx0XHRpdGVtLnNldChcImV4Y2x1ZGVkXCIsIHRydWUpO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0fVxuXHRcdGlmIChoYXNPbGQpIHtcblx0XHRcdGRpZmYoKGhhc05ldyA/IG5ld0l0ZW1zIDogdGhpcy5fZ2V0QWxsSXRlbXMoKSksIG9sZEl0ZW1zKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0dGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoaXRlbSkuZWwuY2xhc3NMaXN0LnJlbW92ZShcImV4Y2x1ZGVkXCIpO1xuXHRcdFx0XHRpdGVtLnNldChcImV4Y2x1ZGVkXCIsIGZhbHNlKTtcblx0XHRcdH0sIHRoaXMpO1xuXHRcdH1cblx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJoYXMtZXhjbHVkZWRcIiwgaGFzTmV3KTtcblx0fSxcblxuXHRfZ2V0QWxsSXRlbXM6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLl9hbGxJdGVtcyB8fCAodGhpcy5fYWxsSXRlbXMgPSB0aGlzLmNvbGxlY3Rpb24uc2xpY2UoKSk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogRmlsdGVyIDJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gY29tcHV0ZUZpbHRlcmVkOiBmdW5jdGlvbigpIHtcblx0Ly8gXHR0aGlzLl9maWx0ZXJSZXN1bHQgPSB0aGlzLmNvbGxlY3Rpb24ubWFwKHRoaXMuX2ZpbHRlckZuLCB0aGlzKTtcblx0Ly8gfSxcblx0Ly9cblx0Ly8gcmVuZGVyRmlsdGVyZWQ6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdHRoaXMuY29sbGVjdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG5cdC8vIFx0XHR0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChpdGVtKS5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZXhjbHVkZWRcIiwgIXRoaXMuX2ZpbHRlclJlc3VsdFtpbmRleF0pO1xuXHQvLyBcdH0sIHRoaXMpO1xuXHQvLyB9LFxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBGaWx0ZXJhYmxlTGlzdFZpZXc7IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9HcmFwaFZpZXdcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBDb2xvciA9IHJlcXVpcmUoXCJjb2xvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3fSAqL1xudmFyIENhbnZhc1ZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3XCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY2FudmFzL2NhbGNBcmNIQ29ubmVjdG9yfSAqL1xudmFyIGNhbGNBcmNIQ29ubmVjdG9yID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9jYWxjQXJjSENvbm5lY3RvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY2FudmFzL0NhbnZhc0hlbHBlcn0gKi9cbnZhciBDYW52YXNIZWxwZXIgPSByZXF1aXJlKFwidXRpbHMvY2FudmFzL0NhbnZhc0hlbHBlclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvZ2VvbS9pbmZsYXRlUmVjdH0gKi9cbnZhciBpbmZsYXRlUmVjdCA9IHJlcXVpcmUoXCJ1dGlscy9nZW9tL2luZmxhdGVSZWN0XCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9kb20vZ2V0QWJzb2x1dGVDbGllbnRSZWN0fSAqL1xuLy8gdmFyIGdldEFic29sdXRlQ2xpZW50UmVjdCA9IHJlcXVpcmUoXCJ1dGlscy9kb20vZ2V0QWJzb2x1dGVDbGllbnRSZWN0XCIpO1xuXG5cbi8vIHZhciBCRVpJRVJfQ0lSQ0xFID0gMC41NTE5MTUwMjQ0OTQ7XG4vLyB2YXIgTUlOX0NBTlZBU19SQVRJTyA9IDI7XG4vLyB2YXIgUEkyID0gTWF0aC5QSSAqIDI7XG5cbnZhciBzdHlsZUJhc2UgPSB7XG5cdGxpbmVDYXA6IFwiYnV0dFwiLCAvLyByb3VuZCwgYnV0dCwgc3F1YXJlXG5cdGxpbmVXaWR0aDogMC43NSxcblx0bGluZURhc2hPZmZzZXQ6IDAsXG5cdHNldExpbmVEYXNoOiBbW11dLFxuXHRyYWRpdXNCYXNlOiAwLjc1LFxuXHQvKiBmYWN0b3JlZCB0byByZW0gdW5pdCAqLyAvLzYsXG5cdHJhZGl1c0luY3JlbWVudDogMC4yMSwgLy8zLCAvLzAuMjUsXG5cdC8qIHVzZXMgbGluZVdpZHRoIG11bHRpcGxpZXIgKi9cblx0b3V0bGluZVdpZHRoOiAxLjUsXG5cdGFycm93U2l6ZTogMC4zXG59O1xuXG5pZiAoREVCVUcpIHtcblx0LyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMgKi9cblx0dmFyIF9kU3R5bGVzID0ge307XG5cdF9kU3R5bGVzW1wiZGVmYXVsdHNcIl0gPSB7XG5cdFx0bGluZVdpZHRoOiAwLFxuXHRcdGZpbGxTdHlsZTogXCJ0cmFuc3BhcmVudFwiLFxuXHRcdHN0cm9rZVN0eWxlOiBcInRyYW5zcGFyZW50XCIsXG5cdFx0bGluZURhc2hPZmZzZXQ6IDAsXG5cdFx0c2V0TGluZURhc2g6IFtbXV1cblx0fTtcblxuXHQvKiBTdHJva2UgKi9cblx0W1xuXHRcdFwicmVkXCIsIFwic2FsbW9uXCIsIFwic2llbm5hXCIsXG5cdFx0XCJncmVlblwiLCBcInllbGxvd2dyZWVuXCIsIFwib2xpdmVcIixcblx0XHRcImJsdWVcIiwgXCJsaWdodHNreWJsdWVcIiwgXCJtaWRuaWdodGJsdWVcIixcblx0XHRcImdyZXlcIiwgXCJzaWx2ZXJcIlxuXHRdXG5cdC5mb3JFYWNoKGZ1bmN0aW9uKGNvbG9yTmFtZSkge1xuXHRcdHZhciByZ2JhVmFsdWUgPSBDb2xvcihjb2xvck5hbWUpLmFscGhhKDAuNSkucmdiYVN0cmluZygpO1xuXG5cdFx0X2RTdHlsZXNbY29sb3JOYW1lXSA9IF8uZGVmYXVsdHMoe1xuXHRcdFx0bGluZVdpZHRoOiAwLjc1LFxuXHRcdFx0c3Ryb2tlU3R5bGU6IHJnYmFWYWx1ZSxcblx0XHR9LCBfZFN0eWxlc1tcImRlZmF1bHRzXCJdKTtcblxuXHRcdF9kU3R5bGVzW2NvbG9yTmFtZSArIFwiX2ZpbGxcIl0gPSBfLmRlZmF1bHRzKHtcblx0XHRcdGZpbGxTdHlsZTogcmdiYVZhbHVlXG5cdFx0fSwgX2RTdHlsZXNbXCJkZWZhdWx0c1wiXSk7XG5cdH0pXG5cdC8qIGVzbGludC1lbmFibGUgbm8tdW51c2VkLXZhcnMgKi9cbn1cblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0dyYXBoVmlld31cbiAqL1xudmFyIEdyYXBoVmlldyA9IENhbnZhc1ZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcImdyYXBoXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJjYW52YXNcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwiZ3JhcGhcIixcblx0Ly8gLyoqIEBvdmVycmlkZSAqL1xuXHQvLyBtb2RlbDogQmFja2JvbmUuTW9kZWwsXG5cblx0ZGVmYXVsdEtleTogXCJhbW91bnRcIixcblxuXHRkZWZhdWx0czoge1xuXHRcdHZhbHVlczoge1xuXHRcdFx0YW1vdW50OiAwLFxuXHRcdFx0Ly8gYXZhaWxhYmxlOiAwLFxuXHRcdFx0Ly8gX2xvb3A6IDAsXG5cdFx0fSxcblx0XHRtYXhWYWx1ZXM6IHtcblx0XHRcdGFtb3VudDogMSxcblx0XHRcdC8vIGF2YWlsYWJsZTogMSxcblx0XHR9LFxuXHRcdC8vIHVzZU9wYXF1ZTogdHJ1ZSxcblx0XHQvLyBsYWJlbEZuOiBmdW5jdGlvbih2YWx1ZSwgbWF4KSB7XG5cdFx0Ly8gXHRyZXR1cm4gKCh2YWx1ZSAvIG1heCkgKiAxMDApIHwgMDtcblx0XHQvLyB9LFxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdENhbnZhc1ZpZXcucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdHRoaXMuX2xpc3RBID0gb3B0aW9ucy5saXN0QTtcblx0XHR0aGlzLl9saXN0QiA9IG9wdGlvbnMubGlzdEI7XG5cdFx0dGhpcy5fYTJiID0ge1xuXHRcdFx0c3JjVmlldzogb3B0aW9ucy5saXN0QSxcblx0XHRcdGRlc3RWaWV3OiBvcHRpb25zLmxpc3RCLFxuXHRcdFx0czogXy5kZWZhdWx0cyh7XG5cdFx0XHRcdGxpbmVXaWR0aDogMS4yNVxuXHRcdFx0XHQvLyByYWRpdXNJbmNyZW1lbnQ6IDAuMjUsXG5cdFx0XHR9LCBzdHlsZUJhc2UpLFxuXHRcdFx0c3Ryb2tlU3R5bGVGbjogZnVuY3Rpb24oZmcsIGJnLCBsbikge1xuXHRcdFx0XHRyZXR1cm4gQ29sb3IobG4pLm1peChiZywgMC45KS5oZXhTdHJpbmcoKTtcblx0XHRcdFx0Ly8gcmV0dXJuIENvbG9yKGZnKS5taXgoYmcsIDAuOSkuaGV4U3RyaW5nKCk7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHR0aGlzLl9iMmEgPSB7XG5cdFx0XHRzcmNWaWV3OiBvcHRpb25zLmxpc3RCLFxuXHRcdFx0ZGVzdFZpZXc6IG9wdGlvbnMubGlzdEEsXG5cdFx0XHRzOiBfLmRlZmF1bHRzKHtcblx0XHRcdFx0bGluZVdpZHRoOiAwLjcsXG5cdFx0XHRcdC8vIGFycm93U2l6ZTogMC4yNSxcblx0XHRcdFx0Ly8gcmFkaXVzSW5jcmVtZW50OiAwLFxuXHRcdFx0XHQvLyBvdXRsaW5lV2lkdGg6IDAsXG5cdFx0XHR9LCBzdHlsZUJhc2UpLFxuXHRcdFx0c3Ryb2tlU3R5bGVGbjogZnVuY3Rpb24oZmcsIGJnLCBsbikge1xuXHRcdFx0XHRyZXR1cm4gQ29sb3IoZmcpLm1peChiZywgMC42KS5oZXhTdHJpbmcoKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnJlbmRlcjpiZWZvcmVcIiwgdGhpcy5fYmVmb3JlVmlld1JlbmRlcik7XG5cblx0XHQvLyB0aGlzLl9fdHJhY2VTY3JvbGwgPSBfLmRlYm91bmNlKHRoaXMuX190cmFjZVNjcm9sbCwgMTAwLCBmYWxzZSk7XG5cblx0XHR2YXIgdmlld3BvcnRDaGFuZ2VkID0gZnVuY3Rpb24oZXYpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6WyVzXVwiLCB0aGlzLmNpZCwgZXYudHlwZSk7XG5cblx0XHRcdC8vIHRoaXMuX190cmFjZVNjcm9sbChldi50eXBlKTtcblx0XHRcdC8vIHRoaXMuX2dyb3VwUmVjdHMgPSBudWxsO1xuXHRcdFx0Ly8gdGhpcy5pbnZhbGlkYXRlKENhbnZhc1ZpZXcuTEFZT1VUX0lOVkFMSUQgfCBDYW52YXNWaWV3LlNJWkVfSU5WQUxJRCk7XG5cdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoQ2FudmFzVmlldy5MQVlPVVRfSU5WQUxJRCB8IENhbnZhc1ZpZXcuU0laRV9JTlZBTElEKTtcblx0XHR9LmJpbmQodGhpcyk7XG5cdFx0Ly8gdmlld3BvcnRDaGFuZ2VkID0gXy5kZWJvdW5jZSh2aWV3cG9ydENoYW5nZWQsIDEwMCwgZmFsc2UpO1xuXG5cdFx0Ly8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIixcblx0XHQvLyBcdFx0Xy5kZWJvdW5jZSh2aWV3cG9ydENoYW5nZWQsIDEwMCwgZmFsc2UpLCBmYWxzZSk7XG5cdFx0Ly8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLFxuXHRcdC8vIFx0Xy5kZWJvdW5jZSh2aWV3cG9ydENoYW5nZWQsIDEwMCwgZmFsc2UpLCBmYWxzZSk7XG5cdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgdmlld3BvcnRDaGFuZ2VkLCBmYWxzZSk7XG5cdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ3aGVlbFwiLCB2aWV3cG9ydENoYW5nZWQsIGZhbHNlKTtcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB2aWV3cG9ydENoYW5nZWQsIGZhbHNlKTtcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9yaWVudGF0aW9uY2hhbmdlXCIsIHZpZXdwb3J0Q2hhbmdlZCwgZmFsc2UpO1xuXG5cdFx0Ly8gdGhpcy5fYWRkTGlzdExpc3RlbmVycyh0aGlzLl9hMmIpO1xuXHRcdC8vIHRoaXMuX2FkZExpc3RMaXN0ZW5lcnModGhpcy5fYjJhKTtcblx0fSxcblxuXHRfX3RyYWNlU2Nyb2xsOiBmdW5jdGlvbih0eXBlKSB7XG5cdFx0dmFyIHRwbCA9IFwiJXM6WyVzXSBEUFI6JWkgXCIgK1xuXHRcdFx0XCJbd2luZG93OiAlaSAlaV0gXCIgK1xuXHRcdFx0XCJbaHRtbDogJWkgJWkgJWldIFwiICtcblx0XHRcdFwiW2JvZHk6ICVpICVpICVpXSBcIiArXG5cdFx0XHRcIltjb250YWluZXI6ICVpICVpICVpXSBcIiArXG5cdFx0XHRcIltncmFwaDogJWkgJWkgJWldXCI7XG5cdFx0Y29uc29sZS5sb2codHBsLCB0aGlzLmNpZCwgdHlwZSwgdGhpcy5fY2FudmFzUmF0aW8sXG5cdFx0XHR3aW5kb3cuc2Nyb2xsWSxcblx0XHRcdHdpbmRvdy5wYWdlWU9mZnNldCxcblx0XHRcdGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQsXG5cdFx0XHRkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wLFxuXHRcdFx0ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodCxcblx0XHRcdGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0LFxuXHRcdFx0ZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AsXG5cdFx0XHRkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCxcblx0XHRcdGRvY3VtZW50LmJvZHkuZmlyc3RFbGVtZW50Q2hpbGQuY2xpZW50SGVpZ2h0LFxuXHRcdFx0ZG9jdW1lbnQuYm9keS5maXJzdEVsZW1lbnRDaGlsZC5zY3JvbGxUb3AsXG5cdFx0XHRkb2N1bWVudC5ib2R5LmZpcnN0RWxlbWVudENoaWxkLnNjcm9sbEhlaWdodCxcblx0XHRcdHRoaXMuZWwuY2xpZW50SGVpZ2h0LFxuXHRcdFx0dGhpcy5lbC5zY3JvbGxUb3AsXG5cdFx0XHR0aGlzLmVsLnNjcm9sbEhlaWdodFxuXHRcdCk7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRtZWFzdXJlQ2FudmFzOiBmdW5jdGlvbih3LCBoKSB7XG5cdFx0Y29uc29sZS5sb2coXCIlczo6bWVhc3VyZUNhbnZhcyBzdHlsZTolbyBvZmZzZXQ6JW8gY2xpZW50OiVvIGFyZzolb1wiLCB0aGlzLmNpZCwgcGFyc2VJbnQodGhpcy5lbC5zdHlsZS5oZWlnaHQpLCB0aGlzLmVsLm9mZnNldEhlaWdodCwgdGhpcy5lbC5jbGllbnRIZWlnaHQsIGgpO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dXBkYXRlQ2FudmFzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl91cGRhdGVNZXRyaWNzKCk7XG5cdFx0dGhpcy5fdXBkYXRlU3R5bGVzKCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0Lyogc3R5bGVzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF91cGRhdGVTdHlsZXM6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBiLCBiZ0NvbG9yLCBsbkNvbG9yO1xuXHRcdGlmICh0aGlzLm1vZGVsLmdldChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdGIgPSB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKTtcblx0XHRcdGxuQ29sb3IgPSBiLmNvbG9ycy5sbkNvbG9yLmNsb25lKCk7XG5cdFx0XHRiZ0NvbG9yID0gYi5jb2xvcnMuYmdDb2xvci5jbG9uZSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRiZ0NvbG9yID0gQ29sb3IoR2xvYmFscy5ERUZBVUxUX0NPTE9SU1tcImJhY2tncm91bmQtY29sb3JcIl0pO1xuXHRcdFx0bG5Db2xvciA9IENvbG9yKEdsb2JhbHMuREVGQVVMVF9DT0xPUlNbXCJsaW5rLWNvbG9yXCJdKTtcblx0XHR9XG5cblx0XHR0aGlzLl9hMmIucy5zdHJva2VTdHlsZSA9IHRoaXMuX2EyYi5zLmZpbGxTdHlsZSA9XG5cdFx0XHR0aGlzLl9hMmIuc3Ryb2tlU3R5bGVGbih0aGlzLl9jb2xvciwgYmdDb2xvciwgbG5Db2xvcik7XG5cdFx0dGhpcy5fYjJhLnMuc3Ryb2tlU3R5bGUgPSB0aGlzLl9iMmEucy5maWxsU3R5bGUgPVxuXHRcdFx0dGhpcy5fYjJhLnN0cm9rZVN0eWxlRm4odGhpcy5fY29sb3IsIGJnQ29sb3IsIGxuQ29sb3IpO1xuXG5cdFx0aWYgKERFQlVHKSB7XG5cdFx0XHR0aGlzLl9kZWJ1Z0Jsb2NrcyA9IHRoaXMuZWwubWF0Y2hlcyhcIi5kZWJ1Zy1ibG9ja3MgLlwiICsgdGhpcy5jbGFzc05hbWUpO1xuXHRcdFx0dGhpcy5fZGVidWdHcmFwaCA9IHRoaXMuZWwubWF0Y2hlcyhcIi5kZWJ1Zy1ncmFwaCAuXCIgKyB0aGlzLmNsYXNzTmFtZSk7XG5cdFx0fVxuXHR9LFxuXG5cdF9zZXRTdHlsZTogZnVuY3Rpb24ocykge1xuXHRcdGlmICh0eXBlb2YgcyA9PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRzID0gdGhpcy5fc3R5bGVEYXRhW3NdO1xuXHRcdH1cblx0XHRDYW52YXNWaWV3LnNldFN0eWxlKHRoaXMuX2N0eCwgcyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogbWV0cmljc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfdXBkYXRlTWV0cmljczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGJvdW5kcztcblx0XHR2YXIgaSwgaWksIGVscztcblx0XHR2YXIgYVJlY3QsIGJSZWN0O1xuXHRcdHZhciBhTWluLCBiTWluO1xuXG5cdFx0dGhpcy5fcm9vdEZvbnRTaXplID0gcGFyc2VGbG9hdChcblx0XHRcdGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5mb250U2l6ZSk7XG5cblx0XHRib3VuZHMgPSB0aGlzLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdC8vIGJvdW5kcyA9IGdldEFic29sdXRlQ2xpZW50UmVjdCh0aGlzLmVsKTtcblx0XHR0aGlzLl9jdHguc2V0VHJhbnNmb3JtKHRoaXMuX2NhbnZhc1JhdGlvLCAwLCAwLCB0aGlzLl9jYW52YXNSYXRpbyxcblx0XHRcdCgtYm91bmRzLmxlZnQgKiB0aGlzLl9jYW52YXNSYXRpbykgLSAwLjUsXG5cdFx0XHQoLWJvdW5kcy50b3AgKiB0aGlzLl9jYW52YXNSYXRpbykgLSAwLjVcblx0XHQpO1xuXG5cdFx0YVJlY3QgPSB0aGlzLl9saXN0QS5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRhTWluID0gYVJlY3QubGVmdDtcblx0XHRlbHMgPSB0aGlzLl9saXN0QS5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLmxhYmVsXCIpO1xuXHRcdGZvciAoaSA9IDAsIGlpID0gZWxzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdGFNaW4gPSBNYXRoLm1heChhTWluLFxuXHRcdFx0XHRlbHNbaV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkucmlnaHQpO1xuXHRcdH1cblxuXHRcdGJSZWN0ID0gdGhpcy5fbGlzdEIuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0Yk1pbiA9IGJSZWN0LmxlZnQ7XG5cdFx0ZWxzID0gdGhpcy5fbGlzdEIuZWwucXVlcnlTZWxlY3RvckFsbChcIi5sYWJlbFwiKTtcblx0XHRmb3IgKGkgPSAwLCBpaSA9IGVscy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHRiTWluID0gTWF0aC5taW4oYk1pbixcblx0XHRcdFx0ZWxzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQpO1xuXHRcdH1cblx0XHR0aGlzLl9iMmEuZGVzdFJlY3QgPSB0aGlzLl9hMmIucmVjdCA9IGFSZWN0O1xuXHRcdHRoaXMuX2IyYS5kZXN0TWluWCA9IHRoaXMuX2EyYi54TWluID0gYU1pbjtcblx0XHR0aGlzLl9hMmIuZGVzdFJlY3QgPSB0aGlzLl9iMmEucmVjdCA9IGJSZWN0O1xuXHRcdHRoaXMuX2EyYi5kZXN0TWluWCA9IHRoaXMuX2IyYS54TWluID0gYk1pbjtcblxuXHRcdC8vIHZhciBzID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpO1xuXHRcdC8vIHRoaXMuX3Jvb3RGb250U2l6ZSA9IHBhcnNlRmxvYXQocy5mb250U2l6ZSk7IC8vICogdGhpcy5fY2FudmFzUmF0aW87XG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6X3VwZGF0ZU1ldHJpY3MgX3Jvb3RGb250U2l6ZTogJXMgJW9cIiwgdGhpcy5jaWQsIHRoaXMuX3Jvb3RGb250U2l6ZSwgcyk7XG5cblx0XHQvLyB2YXIgYyA9IE1hdGguYWJzKHNEYXRhLnhNaW4gLSBkRGF0YS54TWluKSAvIDY7XG5cdFx0Ly8gc01pbiA9IHNEYXRhLnhNaW4gKyBjICogcXg7XG5cdFx0Ly8gZE1pbiA9IGREYXRhLnhNaW4gLSBjICogcXg7XG5cblx0XHQvLyB0aGlzLl9hMmIudGFyZ2V0cyA9IHRoaXMuX21lYXN1cmVMaXN0SXRlbXMobGlzdFZpZXcpO1xuXHRcdC8vIHRoaXMuX2IyYS50YXJnZXRzID0gdGhpcy5fbWVhc3VyZUxpc3RJdGVtcyhsaXN0Vmlldyk7XG5cblx0XHQvLyAvLyBjb25uZWN0b3IgbWluaW11bSBicmFuY2ggeDJcblx0XHQvLyBsaXN0VmlldyA9IHRoaXMuX2xpc3RCO1xuXHRcdC8vIGZvciAoaSA9IDAsIGlpID0gbGlzdFZpZXcuZ3JvdXBzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHQvLyBcdGl0ZW1WaWV3ID0gbGlzdFZpZXcuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKGxpc3RWaWV3Lmdyb3Vwc1tpXSk7XG5cdFx0Ly8gXHRpdGVtUmVjdCA9IChpdGVtVmlldy5sYWJlbCB8fCBpdGVtVmlldy5lbCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0Ly8gXHR0aGlzLl9iMmEueE1pbiA9IE1hdGgubWluKHRoaXMuX2IyYS54TWluLCBpdGVtUmVjdC5sZWZ0KTtcblx0XHQvLyBcdC8vIGlmIChpdGVtVmlldy5fbWV0cmljcykgdGhpcy5fYjJhLnJlY3QubGVmdCArIGl0ZW1WaWV3LnRyYW5zZm9ybS50eCArIGl0ZW1WaWV3Ll9tZXRyaWNzLnRleHRMZWZ0O1xuXHRcdC8vIH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiByZWRyYXdcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2JlZm9yZVZpZXdSZW5kZXI6IGZ1bmN0aW9uKHZpZXcsIGZsYWdzKSB7XG5cdFx0aWYgKGZsYWdzICYgKENhbnZhc1ZpZXcuU0laRV9JTlZBTElEIHwgQ2FudmFzVmlldy5NT0RFTF9JTlZBTElEKSkge1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczo6X2JlZm9yZVZpZXdSZW5kZXIgW2ZsYWdzOiAlc11cIiwgdGhpcy5jaWQsIENhbnZhc1ZpZXcuZmxhZ3NUb1N0cmluZyhmbGFncykpO1xuXG5cdFx0XHR0aGlzLl9hMmIucG9pbnRzT3V0ID0gdGhpcy5fYTJiLnBvaW50cztcblx0XHRcdHRoaXMuX2EyYi5yb290T3V0ID0gdGhpcy5fYTJiLnJvb3Q7XG5cdFx0XHR0aGlzLl9hMmIucG9pbnRzID0gbnVsbDtcblx0XHRcdHRoaXMuX2EyYi5yb290ID0gbnVsbDtcblxuXHRcdFx0dGhpcy5fYjJhLnBvaW50c091dCA9IHRoaXMuX2IyYS5wb2ludHM7XG5cdFx0XHR0aGlzLl9iMmEucm9vdE91dCA9IHRoaXMuX2IyYS5yb290O1xuXHRcdFx0dGhpcy5fYjJhLnBvaW50cyA9IG51bGw7XG5cdFx0XHR0aGlzLl9iMmEucm9vdCA9IG51bGw7XG5cblx0XHRcdHRoaXMuX2dyb3VwUmVjdHMgPSBudWxsO1xuXHRcdH1cblx0fSxcblxuXHRyZWRyYXc6IGZ1bmN0aW9uKGN0eCwgaW50ZXJwb2xhdG9yKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6cmVkcmF3IFt2YWx1ZXNDaGFuZ2VkOiAlc11cIiwgdGhpcy5jaWQsIGludGVycG9sYXRvci52YWx1ZXNDaGFuZ2VkKTtcblx0XHR0aGlzLl9jbGVhckNhbnZhcygwLCAwLCB0aGlzLl9jYW52YXNXaWR0aCwgdGhpcy5fY2FudmFzSGVpZ2h0KTtcblx0XHRjdHguc2F2ZSgpO1xuXHRcdHRoaXMuX3JlZHJhd19mcm9tRWxlbWVudHMoY3R4LCBpbnRlcnBvbGF0b3IpO1xuXHRcdC8vIHRoaXMuX3JlZHJhd19mcm9tVmlld3MoY3R4LCBpbnRlcnBvbGF0b3IpO1xuXHRcdGN0eC5yZXN0b3JlKCk7XG5cdH0sXG5cblx0X3JlZHJhd19mcm9tRWxlbWVudHM6IGZ1bmN0aW9uKGN0eCwgaW50ZXJwb2xhdG9yKSB7XG5cdFx0Ly8gYjJhOiBrZXl3b3JkIHRvIGJ1bmRsZXMsIHJpZ2h0IHRvIGxlZnRcblx0XHQvLyBhMmI6IGJ1bmRsZSB0byBrZXl3b3JkcywgbGVmdCB0byByaWdodFxuXHRcdGlmICh0aGlzLl9iMmEucG9pbnRzID09PSBudWxsKSB7XG5cdFx0XHR0aGlzLl9jb21wdXRlQ29ubmVjdG9ycyh0aGlzLl9iMmEpOyAvLywgdGhpcy5fbGlzdEIsIHRoaXMuX2xpc3RBKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuX2EyYi5wb2ludHMgPT09IG51bGwpIHtcblx0XHRcdHRoaXMuX2NvbXB1dGVDb25uZWN0b3JzKHRoaXMuX2EyYik7IC8vLCB0aGlzLl9saXN0QSwgdGhpcy5fbGlzdEIpO1xuXHRcdH1cblxuXHRcdC8qIGxpbmUgZGFzaCB2YWx1ZSBpbnRlcnBvbGF0aW9uICovXG5cdFx0dmFyIGxWYWwgPSBpbnRlcnBvbGF0b3IuX3ZhbHVlRGF0YVtcImFtb3VudFwiXS5fcmVuZGVyZWRWYWx1ZSAvIGludGVycG9sYXRvci5fdmFsdWVEYXRhW1wiYW1vdW50XCJdLl9tYXhWYWw7XG5cblx0XHQvKiBkcmF3ICovXG5cdFx0dGhpcy5fZHJhd0Nvbm5lY3RvcnModGhpcy5fYjJhLnJvb3QsIHRoaXMuX2IyYS5wb2ludHMsIHRoaXMuX2IyYS5zLCBsVmFsLCAxKTtcblx0XHR0aGlzLl9kcmF3Q29ubmVjdG9ycyh0aGlzLl9iMmEucm9vdE91dCwgdGhpcy5fYjJhLnBvaW50c091dCwgdGhpcy5fYjJhLnMsIDEgLSBsVmFsLCAxKTtcblx0XHR0aGlzLl9kcmF3Q29ubmVjdG9ycyh0aGlzLl9hMmIucm9vdCwgdGhpcy5fYTJiLnBvaW50cywgdGhpcy5fYTJiLnMsIDEsIDIpO1xuXG5cdFx0Ly8gdGhpcy5fZHJhd092ZXJsYXlzKHRoaXMuX2EyYi5kZXN0VmlldywgdGhpcy5fYTJiLmRlc3RSZWN0KTtcblxuXHRcdC8vIGNsZWFyIHNvbWUgbGFiZWwgYmFja2dyb3VuZHNcblx0XHRpZiAodGhpcy5fZ3JvdXBSZWN0cyA9PT0gbnVsbCkge1xuXHRcdFx0dGhpcy5fZ3JvdXBSZWN0cyA9IFtdO1xuXHRcdFx0dmFyIGVscyA9IHRoaXMuX2xpc3RCLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubGlzdC1ncm91cCAubGFiZWwgc3BhblwiKTtcblx0XHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IGVscy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHRcdHRoaXMuX2dyb3VwUmVjdHNbaV0gPSBlbHNbaV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsc1tpXSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIGlmIChsVmFsID09PSAxKSB7XG5cdFx0Ly8gXHR0aGlzLl9fdHJhY2VTY3JvbGwoXCJyZWRyYXdcIik7XG5cdFx0Ly8gfVxuXG5cdFx0dGhpcy5fZ3JvdXBSZWN0cy5mb3JFYWNoKGZ1bmN0aW9uKHIpIHtcblx0XHRcdHRoaXMuX2N0eC5jbGVhclJlY3Qoci5sZWZ0LCByLnRvcCwgci53aWR0aCwgci5oZWlnaHQpO1xuXHRcdFx0aWYgKHRoaXMuX2RlYnVnR3JhcGggfHwgdGhpcy5fZGVidWdCbG9ja3MpIHtcblx0XHRcdFx0ciA9IGluZmxhdGVSZWN0KHIsIDIsIDIpO1xuXHRcdFx0XHRDYW52YXNIZWxwZXIuZHJhd1JlY3QodGhpcy5fY3R4LCBfZFN0eWxlc1tcInNhbG1vblwiXSxcblx0XHRcdFx0XHRyLmxlZnQsIHIudG9wLCByLndpZHRoLCByLmhlaWdodCk7XG5cdFx0XHR9XG5cdFx0fSwgdGhpcyk7XG5cdH0sXG5cblx0X2RyYXdPdmVybGF5czogZnVuY3Rpb24obGlzdCwgcmVjdCkge1xuXHRcdHZhciByID0ge30sXG5cdFx0XHRpdGVtcyA9IGxpc3QuZ3JvdXBzO1xuXHRcdGZvciAodmFyIGkgPSAwLCBudW0gPSBpdGVtcy5sZW5ndGgsIGl0ZW07IGkgPCBudW07IGkrKykge1xuXHRcdFx0aXRlbSA9IGxpc3QuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKGl0ZW1zW2ldKTtcblx0XHRcdGlmIChpdGVtLl9tZXRyaWNzICYmIGl0ZW0udHJhbnNmb3JtKSB7XG5cdFx0XHRcdHIubGVmdCA9IHJlY3QubGVmdCArIGl0ZW0udHJhbnNmb3JtLnR4ICsgaXRlbS5fbWV0cmljcy5vZmZzZXRMZWZ0O1xuXHRcdFx0XHRyLnRvcCA9IHJlY3QudG9wICsgaXRlbS50cmFuc2Zvcm0udHkgKyBpdGVtLl9tZXRyaWNzLm9mZnNldFRvcCAtIDU7XG5cdFx0XHRcdHIud2lkdGggPSBpdGVtLl9tZXRyaWNzLm9mZnNldFdpZHRoO1xuXHRcdFx0XHRyLmhlaWdodCA9IGl0ZW0uX21ldHJpY3Mub2Zmc2V0SGVpZ2h0O1xuXHRcdFx0XHRyID0gaW5mbGF0ZVJlY3QociwgNCwgNCk7XG5cdFx0XHRcdENhbnZhc0hlbHBlci5kcmF3UmVjdCh0aGlzLl9jdHgsIF9kU3R5bGVzW1wiZ3JlZW5cIl0sXG5cdFx0XHRcdFx0ci5sZWZ0LCByLnRvcCwgci53aWR0aCwgci5oZWlnaHQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRfY29tcHV0ZUNvbm5lY3RvcnM6IGZ1bmN0aW9uKGQpIHtcblx0XHR2YXIgc01pbiA9IGQueE1pbjtcblx0XHR2YXIgZE1pbiA9IGQuZGVzdE1pblg7XG5cblx0XHR2YXIgcm9vdCA9IHt9O1xuXHRcdHZhciBwLCBwb2ludHMgPSBbXTtcblx0XHR2YXIgcXgsIHgxLCB5MSwgdHg7XG5cdFx0dmFyIHJCYXNlLCBySW5jO1xuXG5cdFx0ckJhc2UgPSB0aGlzLl9yb3VuZFRvKGQucy5yYWRpdXNCYXNlICogdGhpcy5fcm9vdEZvbnRTaXplLCAwLjUpO1xuXHRcdHJJbmMgPSB0aGlzLl9yb3VuZFRvKGQucy5yYWRpdXNJbmNyZW1lbnQgKiB0aGlzLl9yb290Rm9udFNpemUsIDAuNSk7XG5cblx0XHRpZiAoZC5yZWN0LnJpZ2h0IDwgZC5kZXN0UmVjdC5sZWZ0KSB7XG5cdFx0XHRxeCA9IDE7XG5cdFx0fSBlbHNlIGlmIChkLmRlc3RSZWN0LnJpZ2h0IDwgZC5yZWN0LmxlZnQpIHtcblx0XHRcdHF4ID0gLTE7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHF4ID0gMDtcblx0XHR9XG5cblx0XHR2YXIgc1ZpZXcsIGRkVmlldywgZGRJdGVtcywgZGROdW0sIGk7XG5cdFx0aWYgKGQuc3JjVmlldy5jb2xsZWN0aW9uLnNlbGVjdGVkICYmIGQuZGVzdFZpZXcuZmlsdGVyZWRJdGVtcykge1xuXHRcdFx0c1ZpZXcgPSBkLnNyY1ZpZXcuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKGQuc3JjVmlldy5jb2xsZWN0aW9uLnNlbGVjdGVkKTtcblxuXHRcdFx0Ly8gdmFyIHJlY3QgPSBzVmlldy5sYWJlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRcdC8vIHgxID0gcmVjdC5sZWZ0O1xuXHRcdFx0Ly8geTEgPSByZWN0LnRvcCArIHJlY3QuaGVpZ2h0IC8gMjtcblx0XHRcdC8vIGlmIChxeCA+IDApIHgxICs9IHJlY3Qud2lkdGg7XG5cdFx0XHQvLyB4MSArPSBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7XG5cdFx0XHQvLyB5MSArPSBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDtcblx0XHRcdGlmICghc1ZpZXcuX21ldHJpY3MpIHJldHVybjtcblxuXHRcdFx0eDEgPSBkLnJlY3QubGVmdCArIHNWaWV3LnRyYW5zZm9ybS50eFxuXHRcdFx0XHQrIHNWaWV3Ll9tZXRyaWNzLnRleHRMZWZ0O1xuXHRcdFx0eTEgPSBkLnJlY3QudG9wICsgc1ZpZXcudHJhbnNmb3JtLnR5XG5cdFx0XHRcdCsgc1ZpZXcuX21ldHJpY3Mub2Zmc2V0SGVpZ2h0IC8gMjtcblx0XHRcdGlmIChxeCA+IDApIHgxICs9IHNWaWV3Ll9tZXRyaWNzLnRleHRXaWR0aDtcblxuXHRcdFx0ZGRJdGVtcyA9IGQuZGVzdFZpZXcuZmlsdGVyZWRJdGVtcztcblx0XHRcdGRkTnVtID0gZC5kZXN0Vmlldy5maWx0ZXJlZEl0ZW1zLmxlbmd0aDtcblxuXHRcdFx0Zm9yIChpID0gMDsgaSA8IGRkTnVtOyBpKyspIHtcblx0XHRcdFx0cCA9IHt9O1xuXHRcdFx0XHRkZFZpZXcgPSBkLmRlc3RWaWV3Lml0ZW1WaWV3cy5maW5kQnlNb2RlbChkZEl0ZW1zW2ldKTtcblxuXHRcdFx0XHQvLyByZWN0ID0gZGRWaWV3LmxhYmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdFx0XHQvLyBwLngyID0gcmVjdC5sZWZ0O1xuXHRcdFx0XHQvLyBwLnkyID0gcmVjdC50b3AgKyByZWN0LmhlaWdodCAvIDI7XG5cdFx0XHRcdC8vIGlmIChxeCA8IDApIHAueDIgKz0gcmVjdC53aWR0aDtcblx0XHRcdFx0Ly8gcC54MiArPSBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7XG5cdFx0XHRcdC8vIHAueTIgKz0gZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7XG5cblx0XHRcdFx0cC54MiA9IGQuZGVzdFJlY3QubGVmdCArIGRkVmlldy50cmFuc2Zvcm0udHhcblx0XHRcdFx0XHQrIGRkVmlldy5fbWV0cmljcy50ZXh0TGVmdDtcblx0XHRcdFx0cC55MiA9IGQuZGVzdFJlY3QudG9wICsgZGRWaWV3LnRyYW5zZm9ybS50eVxuXHRcdFx0XHRcdCsgZGRWaWV3Ll9tZXRyaWNzLm9mZnNldEhlaWdodCAvIDI7XG5cdFx0XHRcdGlmIChxeCA8IDApIHAueDIgKz0gZGRWaWV3Ll9tZXRyaWNzLnRleHRXaWR0aDtcblxuXHRcdFx0XHRwLngxID0geDE7XG5cdFx0XHRcdHAueTEgPSB5MTtcblx0XHRcdFx0cC5xeCA9IHF4O1xuXHRcdFx0XHRwb2ludHNbaV0gPSBwO1xuXHRcdFx0fVxuXHRcdFx0cG9pbnRzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuXHRcdFx0XHRyZXR1cm4gYS55MiAtIGIueTI7XG5cdFx0XHR9KTtcblx0XHRcdHZhciBzaSA9IDA7IC8vIHNzRWwncyBudW1iZXIgb2YgaXRlbXMgYWJvdmUgaW4gdGhlIFkgYXhpc1xuXHRcdFx0dmFyIHJNYXgwID0gZGROdW0gKiAwLjUgKiBySW5jOyAvLyBmaXJzdCBhcmMgKHIwKSBtYXggcmFkaXVzIChjeDApXG5cdFx0XHR2YXIgYTsgLy8gY3kxIG9mZnNldCBmcm9tIHkxXG5cblx0XHRcdGZvciAoaSA9IDA7IGkgPCBkZE51bTsgaSsrKSB7XG5cdFx0XHRcdHAgPSBwb2ludHNbaV07XG5cblx0XHRcdFx0YSA9IChpIC0gKGRkTnVtIC0gMSkgLyAyKSAqIHJJbmM7XG5cdFx0XHRcdHAuY3kxID0gcC55MSArIGE7XG5cdFx0XHRcdHAuY3kyID0gcC55MjtcblxuXHRcdFx0XHRhID0gTWF0aC5hYnMoYSk7XG5cdFx0XHRcdHAucjAgPSBhO1xuXHRcdFx0XHRwLmN4MCA9IHAueDEgKyAock1heDAgLSBhKSAqIHF4O1xuXG5cdFx0XHRcdC8vIHAuZHggPSB4MSAtIHAueDI7XG5cdFx0XHRcdC8vIHAuZHkgPSB5MSAtIHAueTI7XG5cblx0XHRcdFx0cC5kaSA9ICgocC5jeTEgLSBwLnkyKSA+IDApID8gaSA6IGRkTnVtIC0gKGkgKyAxKTtcblx0XHRcdFx0c2kgPSBNYXRoLm1heChzaSwgcC5kaSk7XG5cdFx0XHR9XG5cblx0XHRcdC8vIE5PVEVcblx0XHRcdC8vc01pbiA9IHAueDEgKyAock1heDAgKiBxeCk7XG5cblx0XHRcdGZvciAoaSA9IDA7IGkgPCBkZE51bTsgaSsrKSB7XG5cdFx0XHRcdHAgPSBwb2ludHNbaV07XG5cdFx0XHRcdHAucjEgPSBwLmRpICogckluYyArIHJCYXNlO1xuXHRcdFx0XHRwLnIyID0gckJhc2U7XG5cdFx0XHRcdC8vIHAucjIgPSByQmFzZSArIChzaSAtIHAuZGkpICogckluYztcblxuXHRcdFx0XHRwLmN4MSA9IHNNaW4gKyAock1heDAgKiBxeCk7XG5cdFx0XHRcdHAuY3gyID0gZE1pbiAtICgoc2kgLSBwLmRpKSAqIHJJbmMpICogcXg7XG5cdFx0XHRcdC8vIHAuY3gyID0gZE1pbjtcblxuXHRcdFx0XHR0eCA9IGNhbGNBcmNIQ29ubmVjdG9yKHAuY3gxLCBwLmN5MSwgcC5yMSwgcC5jeDIsIHAuY3kyLCBwLnIyLCAwLjkpO1xuXHRcdFx0XHRpZiAodHgpIHtcblx0XHRcdFx0XHRwLnR4MSA9IHR4WzBdO1xuXHRcdFx0XHRcdHAudHgyID0gdHhbMV07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cC50eDEgPSBwLmN4MTtcblx0XHRcdFx0XHRwLnR4MiA9IHAuY3gyO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHAubGVuZ3RoID0gTWF0aC5hYnMocC54MSAtIHAueDIpICsgTWF0aC5hYnMocC5jeTEgLSBwLmN5Mik7XG5cblx0XHRcdFx0Ly8gRmluZCBvdXQgbG9uZ2VzdCBub2RlIGNvbm5lY3Rpb24gZm9yIHNldExpbmVEYXNoXG5cdFx0XHRcdHJvb3QubWF4TGVuZ3RoID0gTWF0aC5tYXgocm9vdC5tYXhMZW5ndGgsIHAubGVuZ3RoKTtcblx0XHRcdH1cblx0XHRcdHBvaW50cy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdFx0cmV0dXJuIGEuZGkgLSBiLmRpOyAvLyBTb3J0IGJ5IGRpc3RhbmNlIHRvIHNlbGVjdGVkIHZpZXdcblx0XHRcdH0pO1xuXG5cdFx0XHRyb290LnggPSB4MTtcblx0XHRcdHJvb3QueSA9IHkxO1xuXHRcdFx0cm9vdC5xeCA9IHF4O1xuXHRcdFx0cm9vdC5yMCA9IHNpICogckluYztcblx0XHR9XG5cdFx0ZC5wb2ludHMgPSBwb2ludHM7XG5cdFx0ZC5yb290ID0gcm9vdDtcblx0fSxcblxuXHRfZHJhd0Nvbm5lY3RvcnM6IGZ1bmN0aW9uKHJvb3QsIHBwLCBzLCBsVmFsLCBkaXIpIHtcblx0XHR2YXIgaSwgaWksIHA7XG5cdFx0dmFyIG93LCByYTEsIHJhMiwgdGE7XG5cblx0XHRpZiAoIShwcCAmJiBwcC5sZW5ndGggJiYgbFZhbCkpIHJldHVybjtcblxuXHRcdGlpID0gcHAubGVuZ3RoO1xuXG5cdFx0Lyogb3V0bGluZSB3aWR0aCAqL1xuXHRcdC8vIG93ID0gcy5saW5lV2lkdGggKyBzLm91dGxpbmVXaWR0aDtcblx0XHRvdyA9IE1hdGgubWluKFxuXHRcdFx0dGhpcy5fcm91bmRUbyhzLnJhZGl1c0luY3JlbWVudCAqIHRoaXMuX3Jvb3RGb250U2l6ZSwgMC41KSxcblx0XHRcdHRoaXMuX3JvdW5kVG8ocy5saW5lV2lkdGggKiAoMSArIHMub3V0bGluZVdpZHRoKSwgMC41KVxuXHRcdCk7XG5cblx0XHQvKiBhcnJvdyByYWRpdXNlcywgZGlyZWN0aW9uICovXG5cdFx0Ly8gcmExID0gKHMucmFkaXVzSW5jcmVtZW50ICogdGhpcy5fcm9vdEZvbnRTaXplKSArIHMubGluZVdpZHRoO1xuXHRcdHJhMSA9IHMuYXJyb3dTaXplICogdGhpcy5fcm9vdEZvbnRTaXplO1xuXHRcdHJhMiA9IHJhMSArIChvdyAtIHMubGluZVdpZHRoKTtcblx0XHR0YSA9IE1hdGguUEkgKiBkaXI7XG5cblx0XHR0aGlzLl9zZXRTdHlsZShzKTtcblxuXHRcdC8vIGlmIChsVmFsIDwgMSkge1xuXHRcdC8vIFx0dGhpcy5fY3R4LmxpbmVEYXNoT2Zmc2V0ID0gbE1heCAqICgxICsgbFZhbCk7XG5cdFx0Ly8gXHR0aGlzLl9jdHguc2V0TGluZURhc2goW2xNYXgsIGxNYXhdKVxuXHRcdC8vIFx0Ly8gdGhpcy5fY3R4LmxpbmVEYXNoT2Zmc2V0ID0gbE1heCAqICgxICsgbFZhbCk7O1xuXHRcdC8vIFx0Ly8gdGhpcy5fY3R4LnNldExpbmVEYXNoKFtsTWF4ICogKDEgLSBsVmFsKSwgbE1heF0pO1xuXHRcdC8vIH1cblxuXHRcdC8vIGZvciAoaSA9IDA7IGkgPCBpaTsgaSsrKSB7XG5cdFx0Ly8gcCA9IHBwW2ldO1xuXHRcdGlmIChzLm91dGxpbmVXaWR0aCkge1xuXHRcdFx0dGhpcy5fY3R4LnNhdmUoKTtcblx0XHRcdHRoaXMuX2N0eC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSBcImRlc3RpbmF0aW9uLW91dFwiO1xuXHRcdFx0dGhpcy5fY3R4LmxpbmVXaWR0aCA9IG93O1xuXHRcdFx0Zm9yIChpID0gMDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdFx0cCA9IHBwW2ldO1xuXG5cdFx0XHRcdGlmIChsVmFsIDwgMSkge1xuXHRcdFx0XHRcdHRoaXMuX2N0eC5saW5lRGFzaE9mZnNldCA9IHAubGVuZ3RoICogKDEgKyBsVmFsKTtcblx0XHRcdFx0XHR0aGlzLl9jdHguc2V0TGluZURhc2goW3AubGVuZ3RoLCBwLmxlbmd0aF0pXG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5fZHJhd0Nvbm5lY3RvcihwLCBpLCBwcCk7XG5cdFx0XHRcdGlmIChsVmFsID09IDEpIHtcblx0XHRcdFx0XHRDYW52YXNIZWxwZXIuYXJyb3doZWFkKHRoaXMuX2N0eCwgcC54MiwgcC55MiwgcmEyLCB0YSk7XG5cdFx0XHRcdFx0dGhpcy5fY3R4LmZpbGwoKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0dGhpcy5fY3R4LnJlc3RvcmUoKTtcblx0XHR9XG5cblx0XHRmb3IgKGkgPSAwOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0cCA9IHBwW2ldO1xuXHRcdFx0aWYgKGxWYWwgPCAxKSB7XG5cdFx0XHRcdHRoaXMuX2N0eC5saW5lRGFzaE9mZnNldCA9IHAubGVuZ3RoICogKDEgKyBsVmFsKTtcblx0XHRcdFx0dGhpcy5fY3R4LnNldExpbmVEYXNoKFtwLmxlbmd0aCwgcC5sZW5ndGhdKVxuXHRcdFx0fVxuXHRcdFx0dGhpcy5fZHJhd0Nvbm5lY3RvcihwLCBpLCBwcCk7XG5cdFx0XHRpZiAobFZhbCA9PSAxKSB7XG5cdFx0XHRcdENhbnZhc0hlbHBlci5hcnJvd2hlYWQodGhpcy5fY3R4LCBwLngyLCBwLnkyLCByYTEsIHRhKTtcblx0XHRcdFx0dGhpcy5fY3R4LmZpbGwoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0X2RyYXdDb25uZWN0b3I6IGZ1bmN0aW9uKHAsIGksIHBwKSB7XG5cdFx0aWYgKERFQlVHKSB7XG5cdFx0XHRpZiAodGhpcy5fZGVidWdHcmFwaCkge1xuXHRcdFx0XHRpZiAoaSA9PT0gMCkge1xuXHRcdFx0XHRcdENhbnZhc0hlbHBlci5kcmF3Vkd1aWRlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJncmV5XCJdLCBwLngxKTtcblx0XHRcdFx0XHRDYW52YXNIZWxwZXIuZHJhd1ZHdWlkZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wiZ3JleVwiXSwgcC5jeDEpO1xuXHRcdFx0XHRcdENhbnZhc0hlbHBlci5kcmF3SEd1aWRlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJncmV5XCJdLCBwLnkxKTtcblx0XHRcdFx0XHRDYW52YXNIZWxwZXIuZHJhd0NpcmNsZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wibWlkbmlnaHRibHVlXCJdLCBwLngxLCBwLnkxLCAxMCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdWR3VpZGUodGhpcy5fY3R4LCBfZFN0eWxlc1tcImdyZXlcIl0sIHAuY3gyKTtcblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdIR3VpZGUodGhpcy5fY3R4LCBfZFN0eWxlc1tcImdyZXlcIl0sIHAuY3kyKTtcblx0XHRcdFx0Ly8gX2RTdHlsZXNbcC5keSA+IDAgPyBcImxpZ2h0Z3JlZW5cIiA6IFwic2FsbW9uXCJdLCBwLmN5Mik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5fY3R4LmJlZ2luUGF0aCgpO1xuXHRcdHRoaXMuX2N0eC5tb3ZlVG8ocC54MiwgcC5jeTIpO1xuXHRcdHRoaXMuX2N0eC5hcmNUbyhwLnR4MiwgcC5jeTIsIHAudHgxLCBwLmN5MSwgcC5yMik7XG5cdFx0dGhpcy5fY3R4LmFyY1RvKHAudHgxLCBwLmN5MSwgcC5jeDEsIHAuY3kxLCBwLnIxKTtcblx0XHR0aGlzLl9jdHguYXJjVG8ocC5jeDAsIHAuY3kxLCBwLmN4MCwgcC55MSwgcC5yMCk7XG5cblx0XHQvLyBwLmN4MDAgPSBwLngxICsgKChwLnIwICsgcC5kaSkgKiBwLnF4KTtcblx0XHQvLyBwLmN5MDAgPSAocC5jeTEgKyBwLnkxKSAvIDI7XG5cdFx0Ly8gdGhpcy5fY3R4LmFyY1RvKHAuY3gwMCwgcC5jeTEsIHAuY3gwMCwgcC5jeTAwLCBwLnIwIC8gMik7XG5cdFx0Ly8gdGhpcy5fY3R4LmFyY1RvKHAuY3gwMCwgcC55MSwgcC54MSwgcC55MSwgcC5yMCAvIDIpO1xuXHRcdC8vIHRoaXMuX2N0eC5saW5lVG8ocC54MSwgcC55MSk7XG5cblx0XHQvLyBwLmN4MDAgPSBwLngxICsgKHAucjAgKiBwLnF4ICogMik7XG5cdFx0Ly8gdGhpcy5fY3R4LmxpbmVUbyhwLmN4MDAsIHAuY3kxKTtcblx0XHQvLyB0aGlzLl9jdHgucXVhZHJhdGljQ3VydmVUbyhwLmN4MCwgcC5jeTEsIHAuY3gwLCBwLnkxKTtcblxuXHRcdC8vIHRoaXMuX2N0eC5saW5lVG8ocC5jeDAsIHAueTEpO1xuXG5cdFx0dGhpcy5fY3R4LnN0cm9rZSgpO1xuXHRcdGlmIChERUJVRykge1xuXHRcdFx0aWYgKHRoaXMuX2RlYnVnR3JhcGgpIHtcblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdDcm9zc2hhaXIodGhpcy5fY3R4LCBfZFN0eWxlc1tcImJsdWVcIl0sXG5cdFx0XHRcdFx0cC54MSArICgocC5yMCArIHAuZGkpICogcC5xeCksIHAuY3kxLCAzKTtcblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdTcXVhcmUodGhpcy5fY3R4LCBfZFN0eWxlc1tcIm1pZG5pZ2h0Ymx1ZVwiXSwgcC5jeDAsIHAuY3kxLCAyKTtcblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdDaXJjbGUodGhpcy5fY3R4LCBfZFN0eWxlc1tcImJsdWVcIl0sIHAuY3gxLCBwLmN5MSwgMSk7XG5cdFx0XHRcdENhbnZhc0hlbHBlci5kcmF3U3F1YXJlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJibHVlXCJdLCBwLnR4MSwgcC5jeTEsIDIpO1xuXHRcdFx0XHRDYW52YXNIZWxwZXIuZHJhd1NxdWFyZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wiZ3JlZW5cIl0sIHAudHgyLCBwLmN5MiwgMik7XG5cdFx0XHRcdENhbnZhc0hlbHBlci5kcmF3Q2lyY2xlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJncmVlblwiXSwgcC5jeDIsIHAuY3kyLCAxKTtcblxuXHRcdFx0XHRDYW52YXNIZWxwZXIuZHJhd0NpcmNsZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wib2xpdmVcIl0sIHAueDIsIHAuY3kyLCAzKTtcblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdDcm9zc2hhaXIodGhpcy5fY3R4LCBfZFN0eWxlc1tcIm9saXZlXCJdLCBwLngyLCBwLnkyLCA2KTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0X3JvdW5kVG86IGZ1bmN0aW9uKG4sIHApIHtcblx0XHRpZiAocCA+IDEpIHAgPSAxIC8gcDtcblx0XHRyZXR1cm4gTWF0aC5yb3VuZChuIC8gcCkgKiBwO1xuXHR9LFxuXG5cdC8qXG5cdF9jb21wdXRlQ29ubmVjdG9yczogZnVuY3Rpb24oZCkge1xuXHRcdHZhciByQmFzZSA9IGQucy5yYWRpdXNCYXNlO1xuXHRcdHZhciBySW5jID0gZC5zLnJhZGl1c0luY3JlbWVudDtcblx0XHR2YXIgc01pbiA9IGQueE1pbjtcblx0XHR2YXIgZE1pbiA9IGQuZGVzdE1pblg7XG5cblx0XHR2YXIgbE1heCA9IDA7XG5cdFx0dmFyIHAsIHBvaW50cyA9IFtdO1xuXHRcdHZhciBxeCwgeDEsIHkxLCB0eDtcblx0XHR2YXIgc2k7IC8vIHNzRWwncyBudW1iZXIgb2YgaXRlbXMgYWJvdmUgaW4gdGhlIFkgYXhpc1xuXG5cdFx0aWYgKGQucmVjdC5yaWdodCA8IGQuZGVzdFJlY3QubGVmdCkge1xuXHRcdFx0cXggPSAxO1xuXHRcdH0gZWxzZSBpZiAoZC5kZXN0UmVjdC5yaWdodCA8IGQucmVjdC5sZWZ0KSB7XG5cdFx0XHRxeCA9IC0xO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRxeCA9IDA7XG5cdFx0fVxuXG5cdFx0dmFyIHNzRWwsIGRkRWxzLCBkZE51bSwgc3NSZWN0LCBkZFJlY3QsIGk7XG5cdFx0c3NFbCA9IGQuc3JjVmlldy5lbC5xdWVyeVNlbGVjdG9yKFwiLmxpc3QtaXRlbS5zZWxlY3RlZCAubGFiZWxcIik7XG5cdFx0aWYgKHNzRWwpIHtcblx0XHRcdHNzUmVjdCA9IHNzRWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHR4MSA9IHNzUmVjdC5sZWZ0O1xuXHRcdFx0aWYgKHF4ID4gMCkgeDEgKz0gc3NSZWN0LndpZHRoO1xuXHRcdFx0eTEgPSBzc1JlY3QudG9wICsgc3NSZWN0LmhlaWdodCAvIDI7XG5cdFx0XHQvLyByMiA9IHJCYXNlO1xuXHRcdFx0Ly8gY3gxID0gZC54TWluO1xuXG5cdFx0XHRzaSA9IDA7XG5cdFx0XHRkZEVscyA9IGQuZGVzdFZpZXcuZWwucXVlcnlTZWxlY3RvckFsbChcIi5saXN0LWl0ZW06bm90KC5leGNsdWRlZCkgLmxhYmVsXCIpO1xuXHRcdFx0ZGROdW0gPSBkZEVscy5sZW5ndGg7XG5cdFx0XHQvLyBkeCA9IE1hdGguYWJzKGQueE1pbiAtIGREYXRhLnhNaW4pO1xuXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgZGROdW07IGkrKykge1xuXHRcdFx0XHRwID0ge307XG5cdFx0XHRcdGRkUmVjdCA9IGRkRWxzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdFx0XHRwLngyID0gZGRSZWN0LmxlZnQ7XG5cdFx0XHRcdGlmIChxeCA8IDApIHAueDIgKz0gZGRSZWN0LndpZHRoO1xuXHRcdFx0XHRwLnkyID0gZGRSZWN0LnRvcCArIGRkUmVjdC5oZWlnaHQgLyAyO1xuXHRcdFx0XHRwLngxID0geDE7XG5cdFx0XHRcdHAueTEgPSB5MTtcblx0XHRcdFx0cC5keCA9IHAueDEgLSBwLngyO1xuXHRcdFx0XHRwLmR5ID0gcC55MSAtIHAueTI7XG5cdFx0XHRcdHAucXggPSBxeDtcblx0XHRcdFx0cC5xeSA9IE1hdGguc2lnbihwLmR5KTtcblx0XHRcdFx0Ly8gcC5kTGVuZ3RoID0gTWF0aC5hYnMocC54KSArIE1hdGguYWJzKHAueSk7XG5cdFx0XHRcdHAuZGkgPSBwLmR5ID4gMCA/IGkgOiBkZE51bSAtIChpICsgMSk7XG5cdFx0XHRcdHNpID0gTWF0aC5tYXgoc2ksIHAuZGkpO1xuXHRcdFx0XHRwb2ludHNbaV0gPSBwO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgYSwgck1heDAgPSBkZE51bSAqIDAuNSAqIHJJbmM7XG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgZGROdW07IGkrKykge1xuXHRcdFx0XHRwID0gcG9pbnRzW2ldO1xuXHRcdFx0XHRwLnIxID0gcC5kaSAqIHJJbmMgKyByQmFzZTtcblx0XHRcdFx0cC5yMiA9IHJCYXNlO1xuXHRcdFx0XHQvLyBwLnIyID0gKHNpIC0gcC5kaSkgKiBySW5jICsgckJhc2U7XG5cblx0XHRcdFx0cC5jeDEgPSBzTWluO1xuXHRcdFx0XHRwLmN4MiA9IGRNaW4gLSAoKHNpIC0gcC5kaSkgKiBySW5jKSAqIHF4O1xuXHRcdFx0XHQvLyBwLmN4MiA9IGRNaW47XG5cblx0XHRcdFx0YSA9IChpIC0gKGRkTnVtIC0gMSkgLyAyKSAqIHJJbmM7XG5cdFx0XHRcdHAuY3kxID0gcC55MSArIGE7XG5cdFx0XHRcdHAuY3kyID0gcC55MjtcblxuXHRcdFx0XHRhID0gTWF0aC5hYnMoYSk7XG5cdFx0XHRcdHAucjAgPSBhO1xuXHRcdFx0XHRwLmN4MCA9IHAueDEgKyAock1heDAgLSBhKSAqIHF4O1xuXG5cdFx0XHRcdHR4ID0gY2FsY0FyY0hDb25uZWN0b3IocC5jeDEsIHAuY3kxLCBwLnIxLCBwLmN4MiwgcC5jeTIsIHAucjIsIDAuOCk7XG5cdFx0XHRcdHAudHgxID0gdHhbMF07XG5cdFx0XHRcdHAudHgyID0gdHhbMV07XG5cblx0XHRcdFx0Ly8gRmluZCBvdXQgbG9uZ2VzdCBub2RlIGNvbm5lY3Rpb24gZm9yIHNldExpbmVEYXNoXG5cdFx0XHRcdGxNYXggPSBNYXRoLm1heChsTWF4LCBNYXRoLmFicyhwLngxIC0gcC54MikgKyBNYXRoLmFicyhwLmN5MSAtIHAuY3kyKSk7XG5cdFx0XHR9XG5cdFx0XHQvLyBTb3J0IGJ5IGRpc3RhbmNlIHkxIChvcmlnaW5hbCkgPiBjeTEgKHJJbmMgb2Zmc2V0KSBkaXN0YW5jZVxuXHRcdFx0cG9pbnRzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuXHRcdFx0XHQvLyByZXR1cm4gTWF0aC5hYnMoYi55MSAtIGIuY3kxKSAtIE1hdGguYWJzKGEueTEgLSBhLmN5MSk7XG5cdFx0XHRcdC8vIHJldHVybiBhLnIwIC0gYi5yMDtcblx0XHRcdFx0cmV0dXJuIGIuZGkgLSBhLmRpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGQucG9pbnRzID0gcG9pbnRzO1xuXHRcdGQubWF4TGVuZ3RoID0gbE1heDtcblx0XHRkLm1heExlbmd0aCA9IHF4O1xuXHR9LCAqL1xuXG59KTtcblxuaWYgKERFQlVHKSB7XG5cdEdyYXBoVmlldy5wcm90b3R5cGUuX3NraXBMb2cgPSBmYWxzZTtcblxuXHR2YXIgZGVib3VuY2VkTG9nID0gXy5kZWJvdW5jZShfLmJpbmQoY29uc29sZS5sb2csIGNvbnNvbGUpLCA1MDAsIHRydWUpO1xuXHR2YXIgYXBwbHlNZXRob2QgPSBmdW5jdGlvbihjb250ZXh0LCBhcmdzKSB7XG5cdFx0cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zaGlmdC5hcHBseShhcmdzKS5hcHBseShjb250ZXh0LCBhcmdzKTtcblx0fVxuXHRpZiAoIUdyYXBoVmlldy5wcm90b3R5cGUuX3NraXBMb2cpIHtcblx0XHQvLyBHcmFwaFZpZXcucHJvdG90eXBlLl9yZXF1ZXN0UmVuZGVyID0gXy53cmFwKENhbnZhc1ZpZXcucHJvdG90eXBlLl9yZXF1ZXN0UmVuZGVyLCBmdW5jdGlvbihmbikge1xuXHRcdC8vIFx0ZGVib3VuY2VkTG9nKFwiJXM6Ol9yZXF1ZXN0UmVuZGVyXCIsIHRoaXMuY2lkKTtcblx0XHQvLyBcdHJldHVybiBhcHBseU1ldGhvZCh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdC8vIH0pO1xuXHRcdEdyYXBoVmlldy5wcm90b3R5cGUuX2FwcGx5UmVuZGVyID0gXy53cmFwKENhbnZhc1ZpZXcucHJvdG90eXBlLl9hcHBseVJlbmRlciwgZnVuY3Rpb24oZm4pIHtcblx0XHRcdHRoaXMuX3NraXBMb2cgPSB0cnVlO1xuXHRcdFx0ZGVib3VuY2VkTG9nKFwiJXM6Ol9hcHBseVJlbmRlciBbZGVib3VuY2VkXVwiLCB0aGlzLmNpZCk7XG5cdFx0XHR2YXIgcmV0dmFsID0gYXBwbHlNZXRob2QodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdHRoaXMuX3NraXBMb2cgPSBmYWxzZTtcblx0XHRcdHJldHVybiByZXR2YWw7XG5cblx0XHR9KTtcblx0fVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEdyYXBoVmlldzsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L0dyb3VwaW5nTGlzdFZpZXdcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmUuYmFieXNpdHRlcn0gKi9cbi8vIHZhciBDb250YWluZXIgPSByZXF1aXJlKFwiYmFja2JvbmUuYmFieXNpdHRlclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbi8vIHZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9GaWx0ZXJhYmxlTGlzdFZpZXd9ICovXG52YXIgRmlsdGVyYWJsZUxpc3RWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9GaWx0ZXJhYmxlTGlzdFZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQ2xpY2thYmxlUmVuZGVyZXJ9ICovXG52YXIgQ2xpY2thYmxlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0NsaWNrYWJsZVJlbmRlcmVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0xhYmVsUmVuZGVyZXJ9ICovXG52YXIgTGFiZWxSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvTGFiZWxSZW5kZXJlclwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0dyb3VwaW5nTGlzdFZpZXd9XG4gKi9cbnZhciBHcm91cGluZ0xpc3RWaWV3ID0gRmlsdGVyYWJsZUxpc3RWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJncm91cGluZ0xpc3RcIixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwiZGxcIixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJncm91cGVkXCIsXG5cblx0LyoqIEB0eXBlIHtGdW5jdGlvbnxudWxsfSBlbXB0eSBhcnJheSAqL1xuXHRfZ3JvdXBpbmdGbjogbnVsbCwgLy9mdW5jdGlvbigpIHsgcmV0dXJuIG51bGw7IH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRkZWZhdWx0czogXy5kZWZhdWx0cyh7XG5cdFx0Ly8gZGVmYXVsdHM6IHtcblx0XHRyZW5kZXJlcjogQ2xpY2thYmxlUmVuZGVyZXIuZXh0ZW5kKHtcblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGNpZFByZWZpeDogXCJncm91cGluZ0xpc3RJdGVtXCIsXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHR0YWdOYW1lOiBcImRsXCIsXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRjbGFzc05hbWU6IFwibGlzdC1pdGVtIGxpc3QtbGFiZWxcIixcblx0XHR9KSxcblx0XHRncm91cGluZ1JlbmRlcmVyOiBMYWJlbFJlbmRlcmVyLmV4dGVuZCh7XG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRjaWRQcmVmaXg6IFwiZ3JvdXBpbmdMaXN0R3JvdXBcIixcblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdHRhZ05hbWU6IFwiZHRcIixcblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGNsYXNzTmFtZTogXCJsaXN0LWdyb3VwIGxpc3QtbGFiZWxcIixcblx0XHR9KSxcblx0XHRncm91cGluZ0ZuOiBudWxsLFxuXHRcdC8vIH0sXG5cdH0sIEZpbHRlcmFibGVMaXN0Vmlldy5wcm90b3R5cGUuZGVmYXVsdHMpLFxuXG5cdHByb3BlcnRpZXM6IHtcblx0XHRncm91cHM6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9ncm91cHM7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRmaWx0ZXJlZEdyb3Vwczoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2ZpbHRlcmVkR3JvdXBzO1xuXHRcdFx0fVxuXHRcdH0sXG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0RmlsdGVyYWJsZUxpc3RWaWV3LnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR0aGlzLl9ncm91cHMgPSBbXTtcblx0XHR0aGlzLl9maWx0ZXJlZEdyb3VwcyA9IFtdO1xuXG5cdFx0dGhpcy5fZ3JvdXBzQnlJdGVtQ2lkID0ge307XG5cdFx0dGhpcy5fZ3JvdXBpbmdGbiA9IG9wdGlvbnMuZ3JvdXBpbmdGbjtcblx0XHR0aGlzLmdyb3VwaW5nUmVuZGVyZXIgPSBvcHRpb25zLmdyb3VwaW5nUmVuZGVyZXI7XG5cblx0XHR0aGlzLl9yZWZyZXNoR3JvdXBzKCk7XG5cdFx0aWYgKHRoaXMuX2dyb3VwaW5nRm4pIHtcblx0XHRcdHRoaXMuX2dyb3Vwcy5mb3JFYWNoKHRoaXMuY3JlYXRlR3JvdXBpbmdWaWV3LCB0aGlzKTtcblx0XHR9XG5cdH0sXG5cblx0X3JlZnJlc2hHcm91cHM6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHRoaXMuX2dyb3VwcyA9IF8udW5pcSh0aGlzLmNvbGxlY3Rpb24ubWFwKHRoaXMuX2dyb3VwaW5nRm4sIHRoaXMpKTtcblx0XHR0aGlzLl9ncm91cHMubGVuZ3RoID0gMDtcblx0XHQvLyB0aGlzLl9ncm91cEl0ZW1zLmxlbmd0aCA9IDA7XG5cdFx0aWYgKHRoaXMuX2dyb3VwaW5nRm4pIHtcblx0XHRcdHRoaXMuY29sbGVjdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0dmFyIGdJZHgsIGdPYmogPSB0aGlzLl9ncm91cGluZ0ZuLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdGlmIChnT2JqKSB7XG5cdFx0XHRcdFx0Z0lkeCA9IHRoaXMuX2dyb3Vwcy5pbmRleE9mKGdPYmopO1xuXHRcdFx0XHRcdGlmIChnSWR4ID09IC0xKSB7XG5cdFx0XHRcdFx0XHRnSWR4ID0gdGhpcy5fZ3JvdXBzLmxlbmd0aDtcblx0XHRcdFx0XHRcdHRoaXMuX2dyb3Vwc1tnSWR4XSA9IGdPYmo7XG5cdFx0XHRcdFx0XHQvLyB0aGlzLl9ncm91cEl0ZW1zW2dJZHhdID0gW107XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdC8vIHRoaXMuX2dyb3VwSXRlbXNbZ0lkeF0ucHVzaChpdGVtKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLl9ncm91cHNCeUl0ZW1DaWRbaXRlbS5jaWRdID0gZ09iajtcblx0XHRcdH0sIHRoaXMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNvbGxlY3Rpb24uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHRcdHRoaXMuX2dyb3Vwc0J5SXRlbUNpZFtpdGVtLmNpZF0gPSBudWxsO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0fVxuXHR9LFxuXG5cdHJlbmRlckZpbHRlckZuOiBmdW5jdGlvbigpIHtcblx0XHRGaWx0ZXJhYmxlTGlzdFZpZXcucHJvdG90eXBlLnJlbmRlckZpbHRlckZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHRpZiAodGhpcy5fZ3JvdXBpbmdGbikge1xuXHRcdFx0aWYgKHRoaXMuX2ZpbHRlcmVkSXRlbXMubGVuZ3RoID09IDApIHtcblx0XHRcdFx0dGhpcy5fZmlsdGVyZWRHcm91cHMgPSBbXTtcblx0XHRcdFx0dGhpcy5fZ3JvdXBzLmZvckVhY2goZnVuY3Rpb24oZ3JvdXApIHtcblx0XHRcdFx0XHR0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChncm91cCkuZWwuY2xhc3NMaXN0LnJlbW92ZShcImV4Y2x1ZGVkXCIpO1xuXHRcdFx0XHR9LCB0aGlzKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuX2ZpbHRlcmVkR3JvdXBzID0gXy51bmlxKHRoaXMuX2ZpbHRlcmVkSXRlbXMubWFwKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fZ3JvdXBzQnlJdGVtQ2lkW2l0ZW0uY2lkXTtcblx0XHRcdFx0fSwgdGhpcykpO1xuXHRcdFx0XHR0aGlzLl9ncm91cHMuZm9yRWFjaChmdW5jdGlvbihncm91cCkge1xuXHRcdFx0XHRcdHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKGdyb3VwKS5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZXhjbHVkZWRcIiwgdGhpcy5fZmlsdGVyZWRHcm91cHMuaW5kZXhPZihncm91cCkgPT0gLTEpO1xuXHRcdFx0XHR9LCB0aGlzKTtcblx0XHRcdH1cblx0XHRcdC8vIHRoaXMuX2dyb3Vwc0V4Y2x1c2lvbkluZGV4ID0gdGhpcy5fZ3JvdXBzLm1hcChmdW5jdGlvbiAoZ3JvdXApIHtcblx0XHRcdC8vIFx0cmV0dXJuIGdyb3Vwcy5pbmRleE9mKGdyb3VwKSA9PSAtMSk7XG5cdFx0XHQvLyB9LCB0aGlzKTtcblx0XHR9XG5cdH0sXG5cblx0LyoqIEBwcml2YXRlIENyZWF0ZSBjaGlsZHJlbiB2aWV3cyAqL1xuXHRjcmVhdGVHcm91cGluZ1ZpZXc6IGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHR2YXIgdmlldyA9IG5ldyB0aGlzLmdyb3VwaW5nUmVuZGVyZXIoe1xuXHRcdFx0bW9kZWw6IGl0ZW0sXG5cdFx0XHRlbDogdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmxpc3QtZ3JvdXBbZGF0YS1pZD1cXFwiXCIgKyBpdGVtLmlkICsgXCJcXFwiXVwiKVxuXHRcdH0pO1xuXHRcdHRoaXMuaXRlbVZpZXdzLmFkZCh2aWV3KTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBGaWx0ZXIgMlxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyBjb21wdXRlRmlsdGVyZWQ6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdEZpbHRlcmFibGVMaXN0Vmlldy5wcm90b3R5cGUuY29tcHV0ZUZpbHRlcmVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdC8vIH0sXG5cdC8vXG5cdC8vIHJlbmRlckZpbHRlcmVkOiBmdW5jdGlvbigpIHtcblx0Ly8gXHRGaWx0ZXJhYmxlTGlzdFZpZXcucHJvdG90eXBlLnJlbmRlckZpbHRlcmVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdC8vIH0sXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdyb3VwaW5nTGlzdFZpZXc7IiwiLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL0NhbnZhc1Byb2dyZXNzTWV0ZXJ9ICovXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvQ2FudmFzUHJvZ3Jlc3NNZXRlcjNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvU1ZHUGF0aFByb2dyZXNzTWV0ZXJ9ICovXG4vLyBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvU1ZHUGF0aFByb2dyZXNzTWV0ZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvU1ZHQ2lyY2xlUHJvZ3Jlc3NNZXRlcn0gKi9cbi8vIG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9wcm9ncmVzcy9TVkdDaXJjbGVQcm9ncmVzc01ldGVyXCIpO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9TZWxlY3RhYmxlTGlzdFZpZXdcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmUuYmFieXNpdHRlcn0gKi9cbnZhciBDb250YWluZXIgPSByZXF1aXJlKFwiYmFja2JvbmUuYmFieXNpdHRlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9EZWZhdWx0U2VsZWN0YWJsZVJlbmRlcmVyfSAqL1xudmFyIERlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0RlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQ2xpY2thYmxlUmVuZGVyZXJ9ICovXG52YXIgQ2xpY2thYmxlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0NsaWNrYWJsZVJlbmRlcmVyXCIpO1xuXG52YXIgU2VsZWN0YWJsZUxpc3RWaWV3ID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwic2VsZWN0YWJsZUxpc3RcIixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwidWxcIixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJsaXN0IHNlbGVjdGFibGVcIixcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlcn0gKi9cblx0cmVuZGVyZXI6IERlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXIsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dGhpcy5fZW5hYmxlZCA9IHRydWU7XG5cdFx0dGhpcy5fY2hpbGRyZW5JbnZhbGlkID0gdHJ1ZTtcblxuXHRcdG9wdGlvbnMucmVuZGVyZXIgJiYgKHRoaXMucmVuZGVyZXIgPSBvcHRpb25zLnJlbmRlcmVyKTtcblx0XHR0aGlzLnNob3dFbXB0eSA9ICEhb3B0aW9ucy5zaG93RW1wdHk7XG5cdFx0dGhpcy5pdGVtVmlld3MgPSBuZXcgQ29udGFpbmVyKCk7XG5cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwgXCJhZGQgcmVtb3ZlIHJlc2V0XCIsIHRoaXMuX29uQ29sbGVjdGlvbkNoYW5nZSk7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMucmVtb3ZlQ2hpbGRyZW4oKTtcblx0XHRWaWV3LnByb3RvdHlwZS5yZW1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfb25Db2xsZWN0aW9uQ2hhbmdlOiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMuX2NoaWxkcmVuSW52YWxpZCA9IHRydWU7XG5cdFx0dGhpcy5yZW5kZXIoKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX2NoaWxkcmVuSW52YWxpZCkge1xuXHRcdFx0dGhpcy5fY2hpbGRyZW5JbnZhbGlkID0gZmFsc2U7XG5cdFx0XHR0aGlzLmNyZWF0ZUNoaWxkcmVuKCk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0c2V0RW5hYmxlZDogZnVuY3Rpb24oZW5hYmxlZCkge1xuXHRcdGlmICh0aGlzLl9lbmFibGVkICE9PSBlbmFibGVkKSB7XG5cdFx0XHR0aGlzLl9lbmFibGVkID0gZW5hYmxlZDtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImRpc2FibGVkXCIsICF0aGlzLl9lbmFibGVkKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogQ2hpbGQgdmlld3Ncblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Y3JlYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBlbHRCdWZmZXIsIHZpZXc7XG5cblx0XHR0aGlzLnJlbW92ZUNoaWxkcmVuKCk7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSBcIlwiO1xuXG5cdFx0aWYgKHRoaXMuY29sbGVjdGlvbi5sZW5ndGgpIHtcblx0XHRcdGVsdEJ1ZmZlciA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblx0XHRcdGlmICh0aGlzLnNob3dFbXB0eSkge1xuXHRcdFx0XHR2aWV3ID0gdGhpcy5jcmVhdGVFbXB0eVZpZXcoKTtcblx0XHRcdFx0ZWx0QnVmZmVyLmFwcGVuZENoaWxkKHZpZXcucmVuZGVyKCkuZWwpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5jb2xsZWN0aW9uLmVhY2goZnVuY3Rpb24obW9kZWwsIGluZGV4LCBhcnIpIHtcblx0XHRcdFx0dmlldyA9IHRoaXMuY3JlYXRlSXRlbVZpZXcobW9kZWwsIGluZGV4KTtcblx0XHRcdFx0ZWx0QnVmZmVyLmFwcGVuZENoaWxkKHZpZXcucmVuZGVyKCkuZWwpO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0XHR0aGlzLmVsLmFwcGVuZENoaWxkKGVsdEJ1ZmZlcik7XG5cdFx0fVxuXHR9LFxuXG5cdGNyZWF0ZUl0ZW1WaWV3OiBmdW5jdGlvbihtb2RlbCwgaW5kZXgpIHtcblx0XHR2YXIgdmlldyA9IG5ldyh0aGlzLnJlbmRlcmVyKSh7XG5cdFx0XHRtb2RlbDogbW9kZWxcblx0XHR9KTtcblx0XHR0aGlzLml0ZW1WaWV3cy5hZGQodmlldyk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh2aWV3LCBcInJlbmRlcmVyOmNsaWNrXCIsIHRoaXMub25JdGVtVmlld0NsaWNrKTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHRyZW1vdmVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5pdGVtVmlld3MuZWFjaCh0aGlzLnJlbW92ZUl0ZW1WaWV3LCB0aGlzKTtcblx0fSxcblxuXHRyZW1vdmVJdGVtVmlldzogZnVuY3Rpb24odmlldykge1xuXHRcdHRoaXMuc3RvcExpc3RlbmluZyh2aWV3KTtcblx0XHR0aGlzLml0ZW1WaWV3cy5yZW1vdmUodmlldyk7XG5cdFx0dmlldy5yZW1vdmUoKTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBDaGlsZCBldmVudCBoYW5kbGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQHByaXZhdGUgKi9cblx0b25JdGVtVmlld0NsaWNrOiBmdW5jdGlvbihpdGVtKSB7XG5cdFx0aWYgKHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZCAhPT0gaXRlbSAmJiB0aGlzLl9lbmFibGVkKSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpvbmVcIiwgaXRlbSk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIEVtcHR5IHZpZXdcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Y3JlYXRlRW1wdHlWaWV3OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBTZWxlY3RhYmxlTGlzdFZpZXcuRW1wdHlSZW5kZXJlcih7XG5cdFx0XHRtb2RlbDogdGhpcy5jb2xsZWN0aW9uXG5cdFx0fSk7XG5cdFx0dGhpcy5pdGVtVmlld3MuYWRkKHZpZXcpO1xuXHRcdHRoaXMubGlzdGVuVG8odmlldywgXCJyZW5kZXJlcjpjbGlja1wiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuX2VuYWJsZWQgJiYgdGhpcy50cmlnZ2VyKFwidmlldzpzZWxlY3Q6bm9uZVwiKTtcblx0XHR9KTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcbn0sIHtcblx0RW1wdHlSZW5kZXJlcjogQ2xpY2thYmxlUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHR0YWdOYW1lOiBcImxpXCIsXG5cdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdGNsYXNzTmFtZTogXCJsaXN0LWl0ZW0gZW1wdHktaXRlbVwiLFxuXG5cdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJzZWxlY3RlZCBkZXNlbGVjdGVkXCIsIHRoaXMucmVuZGVyQ2xhc3NMaXN0KTtcblx0XHRcdHRoaXMucmVuZGVyQ2xhc3NMaXN0KCk7XG5cdFx0fSxcblxuXHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5lbC5pbm5lckhUTUwgPSBcIjxhIGhyZWY9XFxcIiNjbGVhclxcXCI+PGI+IDwvYj48L2E+XCI7XG5cdFx0XHR0aGlzLnJlbmRlckNsYXNzTGlzdCgpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblxuXHRcdHJlbmRlckNsYXNzTGlzdDogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJzZWxlY3RlZFwiLCB0aGlzLm1vZGVsLnNlbGVjdGVkSW5kZXggPT09IC0xKTtcblx0XHR9LFxuXHR9KVxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gU2VsZWN0YWJsZUxpc3RWaWV3O1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9wcm9ncmVzcy9DYW52YXNQcm9ncmVzc01ldGVyXG4gKi9cblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbi8vIHZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG4vLyB2YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3fSAqL1xudmFyIENhbnZhc1ZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3XCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9JbnRlcnBvbGF0b3J9ICovXG4vLyB2YXIgSW50ZXJwb2xhdG9yID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvSW50ZXJwb2xhdG9yXCIpO1xuXG4vLyB2YXIgQVJDX0VSUiA9IDAuMDAwMDE7XG4vLyB2YXIgQVJDX0VSUiA9IDAuMDtcbi8vIHZhciBQSSA9IE1hdGguUEk7XG52YXIgUEkyID0gTWF0aC5QSSAqIDI7XG5cbnZhciBHQVBfQVJDID0gUEkyIC8gNDg7XG4vLyB2YXIgQ0FQX1NDQUxFID0gMjsgLy8gY2FwIGFyYyA9IEdBUF9BUkMgKiBDQVBfU0NBTEVcbi8vIHZhciBXQUlUX0NZQ0xFX1ZBTFVFID0gMTtcbi8vIHZhciBXQUlUX0NZQ0xFX01TID0gMzAwOyAvLyBtaWxsaXNlY29uZHMgcGVyIGludGVycG9sYXRpb24gbG9vcFxuXG52YXIgQVJDX0RFRkFVTFRTID0ge1xuXHRcImFtb3VudFwiOiB7XG5cdFx0bGluZVdpZHRoOiAwLjgsXG5cdFx0cmFkaXVzT2Zmc2V0OiAwXG5cdH0sXG5cdFwibm90LWF2YWlsYWJsZVwiOiB7XG5cdFx0bGluZVdpZHRoOiAxLjAsXG5cdFx0bGluZURhc2g6IFswLjMsIDAuN11cblx0fSxcblx0XCJhdmFpbGFibGVcIjoge1xuXHRcdGxpbmVXaWR0aDogMC44LFxuXHRcdGludmVyc2U6IFwibm90LWF2YWlsYWJsZVwiXG5cdH0sXG59O1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvQ2FudmFzUHJvZ3Jlc3NNZXRlcn1cbiAqL1xudmFyIENhbnZhc1Byb2dyZXNzTWV0ZXIgPSBDYW52YXNWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJjYW52YXNQcm9ncmVzc01ldGVyXCIsXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjbGFzc05hbWU6IFwicHJvZ3Jlc3MtbWV0ZXIgY2FudmFzLXByb2dyZXNzLW1ldGVyXCIsXG5cblx0ZGVmYXVsdEtleTogXCJhbW91bnRcIixcblxuXHRkZWZhdWx0czoge1xuXHRcdHZhbHVlczoge1xuXHRcdFx0YW1vdW50OiAwLFxuXHRcdFx0YXZhaWxhYmxlOiAwLFxuXHRcdFx0X2xvb3A6IDAsXG5cdFx0fSxcblx0XHRtYXhWYWx1ZXM6IHtcblx0XHRcdGFtb3VudDogMSxcblx0XHRcdGF2YWlsYWJsZTogMSxcblx0XHR9LFxuXHRcdHVzZU9wYXF1ZTogdHJ1ZSxcblx0XHRsYWJlbEZuOiBmdW5jdGlvbih2YWx1ZSwgbWF4KSB7XG5cdFx0XHRyZXR1cm4gKCh2YWx1ZSAvIG1heCkgKiAxMDApIHwgMDtcblx0XHR9LFxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGNoaWxkcmVuL2xheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHQvLyBUT0RPOiBjbGVhbnVwIG9wdGlvbnMgbWVzcyBpbiBDYW52YXNWaWV3XG5cdFx0Q2FudmFzVmlldy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdC8vIG9wdGlvbnMgPSBfLmRlZmF1bHRzKG9wdGlvbnMsIHRoaXMuZGVmYXVsdHMpO1xuXG5cdFx0dGhpcy5fbGFiZWxGbiA9IG9wdGlvbnMubGFiZWxGbjtcblx0XHR0aGlzLl92YWx1ZVN0eWxlcyA9IHt9O1xuXHRcdHRoaXMuX2NhbnZhc1NpemUgPSBudWxsO1xuXHRcdHRoaXMuX2NhbnZhc09yaWdpbiA9IG51bGw7XG5cdH0sXG5cblx0bWVhc3VyZUNhbnZhczogZnVuY3Rpb24odywgaCkge1xuXHRcdHRoaXMuX2NhbnZhc0hlaWdodCA9IHRoaXMuX2NhbnZhc1dpZHRoID0gTWF0aC5taW4odGhpcy5fY2FudmFzV2lkdGgsIHRoaXMuX2NhbnZhc0hlaWdodCk7XG5cdH0sXG5cblx0X3VwZGF0ZUNhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0Q2FudmFzVmlldy5wcm90b3R5cGUuX3VwZGF0ZUNhbnZhcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0Ly8gc2l6ZSwgbGluZXMsIGdhcHMsIGRhc2hlcyAodGhpcy5fdmFsdWVTdHlsZXMsIEdBUF9BUkMsIHRoaXMuX2FyY1JhZGl1cylcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHZhciBhcmNOYW1lLCBhcmNPYmosIGFyY0RlZmF1bHQ7XG5cdFx0dmFyIG1hcExpbmVEYXNoID0gZnVuY3Rpb24obikge1xuXHRcdFx0cmV0dXJuIG4gKiB0aGlzLnJhZGl1cyAqIEdBUF9BUkM7XG5cdFx0fTtcblx0XHR2YXIgc3VtRm4gPSBmdW5jdGlvbihzLCBuKSB7XG5cdFx0XHRyZXR1cm4gcyArIG47XG5cdFx0fTtcblxuXHRcdHRoaXMuX2NhbnZhc1NpemUgPSBNYXRoLm1pbih0aGlzLl9jYW52YXNXaWR0aCwgdGhpcy5fY2FudmFzSGVpZ2h0KTsgLy8gLyB0aGlzLl9jYW52YXNSYXRpbztcblx0XHR0aGlzLl9tYXhEYXNoQXJjID0gMDtcblxuXHRcdGZvciAoYXJjTmFtZSBpbiBBUkNfREVGQVVMVFMpIHtcblx0XHRcdGFyY0RlZmF1bHQgPSBBUkNfREVGQVVMVFNbYXJjTmFtZV07XG5cdFx0XHRhcmNPYmogPSB0aGlzLl92YWx1ZVN0eWxlc1thcmNOYW1lXSA9IHt9O1xuXHRcdFx0YXJjT2JqLmludmVyc2UgPSBhcmNEZWZhdWx0LmludmVyc2U7IC8vIGNvcHkgaW52ZXJzZSBrZXlcblx0XHRcdC8vIGFyY09iai5pbnZlcnNlMiA9IGFyY0RlZmF1bHQuaW52ZXJzZTI7XG5cdFx0XHRhcmNPYmoubGluZVdpZHRoID0gYXJjRGVmYXVsdC5saW5lV2lkdGggKiB0aGlzLl9jYW52YXNSYXRpbztcblx0XHRcdGFyY09iai5yYWRpdXMgPSAodGhpcy5fY2FudmFzU2l6ZSAtIGFyY09iai5saW5lV2lkdGgpIC8gMjtcblx0XHRcdGlmIChhcmNEZWZhdWx0LnJhZGl1c09mZnNldCkge1xuXHRcdFx0XHRhcmNPYmoucmFkaXVzICs9IGFyY0RlZmF1bHQucmFkaXVzT2Zmc2V0ICogdGhpcy5fY2FudmFzUmF0aW87XG5cdFx0XHR9XG5cdFx0XHRpZiAoYXJjRGVmYXVsdC5saW5lRGFzaCAmJiBhcmNEZWZhdWx0LmxpbmVEYXNoLmxlbmd0aCkge1xuXHRcdFx0XHRhcmNPYmoubGluZURhc2ggPSBhcmNEZWZhdWx0LmxpbmVEYXNoLm1hcChtYXBMaW5lRGFzaCwgYXJjT2JqKTtcblx0XHRcdFx0YXJjT2JqLmxpbmVEYXNoQXJjID0gYXJjRGVmYXVsdC5saW5lRGFzaFswXSAqIEdBUF9BUkM7XG5cdFx0XHRcdGFyY09iai5saW5lRGFzaExlbmd0aCA9IGFyY09iai5saW5lRGFzaC5yZWR1Y2Uoc3VtRm4pO1xuXHRcdFx0XHR0aGlzLl9tYXhEYXNoQXJjID0gTWF0aC5tYXgodGhpcy5fbWF4RGFzaEFyYywgYXJjT2JqLmxpbmVEYXNoQXJjKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGFyY09iai5saW5lRGFzaEFyYyA9IDA7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gYmFzZWxpbmVTaGlmdFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ly8gTk9URTogQ2VudGVyIGJhc2VsaW5lOiB1c2UgYXNjZW50IGRhdGEgdG8gY2VudGVyIHRvIHgtaGVpZ2h0LCBvciBzb3J0LW9mLlxuXHRcdC8vIHdpdGggYXNjZW50L2Rlc2NlbnQgdmFsdWVzICgwLjcsIC0wLjMpLCB4LWhlaWdodCBpcyAwLjRcblx0XHR2YXIgbU9iaiA9IHRoaXMuX2dldEZvbnRNZXRyaWNzKHRoaXMuX2ZvbnRGYW1pbHkpO1xuXHRcdHRoaXMuX2Jhc2VsaW5lU2hpZnQgPSBtT2JqID8gKG1PYmouYXNjZW50ICsgbU9iai5kZXNjZW50KSAvIG1PYmoudW5pdHNQZXJFbSA6IDAuNzsgLy8gZGVmYXVsdCB2YWx1ZVxuXHRcdHRoaXMuX2Jhc2VsaW5lU2hpZnQgKj0gdGhpcy5fZm9udFNpemUgKiAwLjU7IC8vIGFwcGx5IHRvIGZvbnQtc2l6ZSwgaGFsdmUgaXRcblx0XHR0aGlzLl9iYXNlbGluZVNoaWZ0ID0gTWF0aC5yb3VuZCh0aGlzLl9iYXNlbGluZVNoaWZ0KTtcblxuXHRcdC8vIHNhdmUgY2FudmFzIGNvbnRleHRcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vIHJlc2V0IG1hdHJpeCBhbmQgdHJhbnNsYXRlIDAsMCB0byBjZW50ZXJcblx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHRcdHRoaXMuX2N0eC5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgdGhpcy5fY2FudmFzV2lkdGggLyAyLCB0aGlzLl9jYW52YXNIZWlnaHQgLyAyKTtcblx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHByaXZhdGVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZWRyYXc6IGZ1bmN0aW9uKGNvbnRleHQsIGludGVycG9sYXRvcikge1xuXHRcdHRoaXMuX2NsZWFyQ2FudmFzKC10aGlzLl9jYW52YXNXaWR0aCAvIDIsIC10aGlzLl9jYW52YXNIZWlnaHQgLyAyLCB0aGlzLl9jYW52YXNXaWR0aCwgdGhpcy5fY2FudmFzSGVpZ2h0KTtcblxuXHRcdHZhciBsb29wVmFsdWUgPSBpbnRlcnBvbGF0b3IuX3ZhbHVlRGF0YVtcIl9sb29wXCJdLl9yZW5kZXJlZFZhbHVlIHx8IDA7XG5cdFx0dmFyIGFtb3VudERhdGEgPSBpbnRlcnBvbGF0b3IuX3ZhbHVlRGF0YVtcImFtb3VudFwiXTtcblx0XHR2YXIgYXZhaWxhYmxlRGF0YSA9IGludGVycG9sYXRvci5fdmFsdWVEYXRhW1wiYXZhaWxhYmxlXCJdO1xuXG5cdFx0dmFyIGFtb3VudFN0eWxlID0gdGhpcy5fdmFsdWVTdHlsZXNbXCJhbW91bnRcIl07XG5cdFx0dmFyIGF2YWlsYWJsZVN0eWxlID0gdGhpcy5fdmFsdWVTdHlsZXNbXCJhdmFpbGFibGVcIl07XG5cblx0XHQvLyBhbW91bnQgbGFiZWxcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuZHJhd0xhYmVsKHRoaXMuX2xhYmVsRm4oYW1vdW50RGF0YS5fcmVuZGVyZWRWYWx1ZSwgYW1vdW50RGF0YS5fbWF4VmFsKSk7XG5cblx0XHQvLyBzYXZlIGN0eCBiZWZvcmUgZHJhd2luZyBhcmNzXG5cdFx0dGhpcy5fY3R4LnNhdmUoKTtcblxuXHRcdC8vIGxvb3Agcm90YXRpb25cblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vIGlmIChpbnRlcnBvbGF0b3IucmVuZGVyZWRLZXlzICYmIChpbnRlcnBvbGF0b3IucmVuZGVyZWRLZXlzLmluZGV4T2YoXCJhbW91bnRcIikgIT09IC0xKSkge1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCIlczo6cmVkcmF3IChfbG9vcCkgbWF4OiAlcyBsYXN0OiAlcyBjdXJyOiAlc1wiLCB0aGlzLmNpZCxcblx0XHQvLyBcdFx0YW1vdW50RGF0YS5fbWF4VmFsLFxuXHRcdC8vIFx0XHRhbW91bnREYXRhLl9sYXN0UmVuZGVyZWRWYWx1ZSxcblx0XHQvLyBcdFx0YW1vdW50RGF0YS5fcmVuZGVyZWRWYWx1ZVxuXHRcdC8vIFx0KTtcblx0XHQvLyB9XG5cdFx0aWYgKGludGVycG9sYXRvci5yZW5kZXJlZEtleXMgJiYgKGludGVycG9sYXRvci5yZW5kZXJlZEtleXMuaW5kZXhPZihcImFtb3VudFwiKSAhPT0gLTEpICYmIChhbW91bnREYXRhLl9sYXN0UmVuZGVyZWRWYWx1ZSA+IGFtb3VudERhdGEuX3JlbmRlcmVkVmFsdWUpKSB7XG5cdFx0XHQvLyB0cmlnZ2VyIGxvb3Bcblx0XHRcdGludGVycG9sYXRvci52YWx1ZVRvKDEsIDAsIFwiX2xvb3BcIik7XG5cdFx0XHRpbnRlcnBvbGF0b3IudmFsdWVUbygwLCA3NTAsIFwiX2xvb3BcIik7XG5cdFx0XHRpbnRlcnBvbGF0b3IudXBkYXRlVmFsdWUoXCJfbG9vcFwiKTtcblx0XHR9XG5cdFx0dGhpcy5fY3R4LnJvdGF0ZShQSTIgKiAoKDEgLSBsb29wVmFsdWUpIC0gMC4yNSkpO1xuXG5cdFx0Ly8gYW1vdW50IGFyY1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIGFtb3VudEdhcEFyYyA9IEdBUF9BUkM7XG5cdFx0dmFyIGFtb3VudEVuZEFyYyA9IDA7XG5cdFx0dmFyIGFtb3VudFZhbHVlID0gbG9vcFZhbHVlICsgYW1vdW50RGF0YS5fcmVuZGVyZWRWYWx1ZSAvIGFtb3VudERhdGEuX21heFZhbDtcblxuXHRcdGlmIChhbW91bnRWYWx1ZSA+IDApIHtcblx0XHRcdGFtb3VudEVuZEFyYyA9IHRoaXMuZHJhd0FyYyhhbW91bnRTdHlsZSwgYW1vdW50VmFsdWUsIGFtb3VudEdhcEFyYywgUEkyIC0gYW1vdW50R2FwQXJjKTtcblx0XHRcdHRoaXMuZHJhd0VuZENhcChhbW91bnRTdHlsZSwgYW1vdW50RW5kQXJjKTtcblx0XHRcdGFtb3VudEVuZEFyYyA9IGFtb3VudEVuZEFyYyArIGFtb3VudEdhcEFyYyAqIDI7XG5cdFx0fVxuXG5cdFx0Ly8gYXZhaWxhYmxlIGFyY1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIHN0ZXBzTnVtID0gYXZhaWxhYmxlRGF0YS5sZW5ndGggfHwgMTtcblx0XHR2YXIgc3RlcEJhc2VBcmMgPSBQSTIgLyBzdGVwc051bTtcblx0XHR2YXIgc3RlcEFkanVzdEFyYyA9IHN0ZXBCYXNlQXJjICUgR0FQX0FSQztcblx0XHR2YXIgc3RlcEdhcEFyYyA9IEdBUF9BUkMgKyAoc3RlcEFkanVzdEFyYyAtIGF2YWlsYWJsZVN0eWxlLmxpbmVEYXNoQXJjKSAvIDI7XG5cblx0XHRpZiAoQXJyYXkuaXNBcnJheShhdmFpbGFibGVEYXRhKSkge1xuXHRcdFx0Zm9yICh2YXIgbywgaSA9IDA7IGkgPCBzdGVwc051bTsgaSsrKSB7XG5cdFx0XHRcdG8gPSBhdmFpbGFibGVEYXRhW2ldO1xuXHRcdFx0XHR0aGlzLmRyYXdBcmMoYXZhaWxhYmxlU3R5bGUsIG8uX3JlbmRlcmVkVmFsdWUgLyAoby5fbWF4VmFsIC8gc3RlcHNOdW0pLCAoaSAqIHN0ZXBCYXNlQXJjKSArIHN0ZXBHYXBBcmMsICgoaSArIDEpICogc3RlcEJhc2VBcmMpIC0gc3RlcEdhcEFyYywgYW1vdW50RW5kQXJjKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5kcmF3QXJjKGF2YWlsYWJsZVN0eWxlLCBhdmFpbGFibGVEYXRhLl9yZW5kZXJlZFZhbHVlIC8gYXZhaWxhYmxlRGF0YS5fbWF4VmFsLCBzdGVwR2FwQXJjLCBQSTIgLSBzdGVwR2FwQXJjLCBhbW91bnRFbmRBcmMpO1xuXHRcdH1cblx0XHQvLyByZXN0b3JlIGN0eCBhZnRlciBkcmF3aW5nIGFyY3Ncblx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHR9LFxuXG5cdGRyYXdBcmM6IGZ1bmN0aW9uKHZhbHVlU3R5bGUsIHZhbHVlLCBzdGFydEFyYywgZW5kQXJjLCBwcmV2QXJjKSB7XG5cdFx0dmFyIHZhbEFyYywgaW52U3R5bGUsXG5cdFx0XHR2YWxTdGFydEFyYywgdmFsRW5kQXJjLFxuXHRcdFx0aW52U3RhcnRBcmMsIGludkVuZEFyYztcblx0XHRwcmV2QXJjIHx8IChwcmV2QXJjID0gMCk7XG5cblx0XHR2YWxBcmMgPSBlbmRBcmMgLSBzdGFydEFyYztcblx0XHR2YWxFbmRBcmMgPSBzdGFydEFyYyArICh2YWxBcmMgKiB2YWx1ZSk7XG5cdFx0dmFsU3RhcnRBcmMgPSBNYXRoLm1heChzdGFydEFyYywgcHJldkFyYyk7XG5cdFx0aWYgKHZhbEVuZEFyYyA+IHZhbFN0YXJ0QXJjKSB7XG5cdFx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXHRcdFx0dGhpcy5hcHBseVZhbHVlU3R5bGUodmFsdWVTdHlsZSk7XG5cdFx0XHR0aGlzLl9jdHguYmVnaW5QYXRoKCk7XG5cdFx0XHR0aGlzLl9jdHguYXJjKDAsIDAsIHZhbHVlU3R5bGUucmFkaXVzLCB2YWxFbmRBcmMsIHZhbFN0YXJ0QXJjLCB0cnVlKTtcblx0XHRcdHRoaXMuX2N0eC5zdHJva2UoKTtcblx0XHRcdHRoaXMuX2N0eC5yZXN0b3JlKCk7XG5cdFx0fVxuXHRcdC8vIGlmIHRoZXJlJ3MgdmFsdWVTdHlsZSwgZHJhdyByZXN0IG9mIHNwYW4sIG1pbnVzIHByZXZBcmMgb3ZlcmxhcCB0b29cblx0XHRpZiAodmFsdWVTdHlsZS5pbnZlcnNlICE9PSB2b2lkIDApIHtcblx0XHRcdGludlN0eWxlID0gdGhpcy5fdmFsdWVTdHlsZXNbdmFsdWVTdHlsZS5pbnZlcnNlXTtcblx0XHRcdGludkVuZEFyYyA9IHZhbEVuZEFyYyArICh2YWxBcmMgKiAoMSAtIHZhbHVlKSk7XG5cdFx0XHRpbnZTdGFydEFyYyA9IE1hdGgubWF4KHZhbEVuZEFyYywgcHJldkFyYyk7XG5cdFx0XHRpZiAoaW52RW5kQXJjID4gaW52U3RhcnRBcmMpIHtcblx0XHRcdFx0dGhpcy5fY3R4LnNhdmUoKTtcblx0XHRcdFx0dGhpcy5hcHBseVZhbHVlU3R5bGUoaW52U3R5bGUpO1xuXHRcdFx0XHR0aGlzLl9jdHguYmVnaW5QYXRoKCk7XG5cdFx0XHRcdHRoaXMuX2N0eC5hcmMoMCwgMCwgaW52U3R5bGUucmFkaXVzLCBpbnZFbmRBcmMsIGludlN0YXJ0QXJjLCB0cnVlKTtcblx0XHRcdFx0dGhpcy5fY3R4LnN0cm9rZSgpO1xuXHRcdFx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsRW5kQXJjO1xuXHR9LFxuXG5cdGFwcGx5VmFsdWVTdHlsZTogZnVuY3Rpb24oc3R5bGVPYmopIHtcblx0XHR0aGlzLl9jdHgubGluZVdpZHRoID0gc3R5bGVPYmoubGluZVdpZHRoO1xuXHRcdGlmIChzdHlsZU9iai5saW5lRGFzaCkge1xuXHRcdFx0dGhpcy5fY3R4LnNldExpbmVEYXNoKHN0eWxlT2JqLmxpbmVEYXNoKTtcblx0XHR9XG5cdFx0aWYgKHN0eWxlT2JqLmxpbmVEYXNoT2Zmc2V0KSB7XG5cdFx0XHR0aGlzLl9jdHgubGluZURhc2hPZmZzZXQgPSBzdHlsZU9iai5saW5lRGFzaE9mZnNldDtcblx0XHR9XG5cdH0sXG5cblx0ZHJhd0xhYmVsOiBmdW5jdGlvbihsYWJlbFN0cmluZykge1xuXHRcdHZhciBsYWJlbFdpZHRoID0gdGhpcy5fY3R4Lm1lYXN1cmVUZXh0KGxhYmVsU3RyaW5nKS53aWR0aDtcblx0XHR0aGlzLl9jdHguZmlsbFRleHQobGFiZWxTdHJpbmcsXG5cdFx0XHRsYWJlbFdpZHRoICogLTAuNSxcblx0XHRcdHRoaXMuX2Jhc2VsaW5lU2hpZnQsIGxhYmVsV2lkdGgpO1xuXHR9LFxuXG5cdGRyYXdFbmRDYXA6IGZ1bmN0aW9uKHZhbHVlU3R5bGUsIGFyY1Bvcykge1xuXHRcdHZhciByYWRpdXMgPSB2YWx1ZVN0eWxlLnJhZGl1cztcblx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXHRcdHRoaXMuX2N0eC5saW5lV2lkdGggPSB2YWx1ZVN0eWxlLmxpbmVXaWR0aDtcblxuXHRcdHRoaXMuX2N0eC5yb3RhdGUoYXJjUG9zIC0gR0FQX0FSQyAqIDEuNSk7XG5cdFx0dGhpcy5fY3R4LmJlZ2luUGF0aCgpO1xuXHRcdHRoaXMuX2N0eC5hcmMoMCwgMCwgcmFkaXVzLCBHQVBfQVJDICogMC41LCBHQVBfQVJDICogMiwgZmFsc2UpO1xuXHRcdHRoaXMuX2N0eC5saW5lVG8ocmFkaXVzIC0gKEdBUF9BUkMgKiByYWRpdXMpLCAwKTtcblx0XHR0aGlzLl9jdHguY2xvc2VQYXRoKCk7XG5cblx0XHR0aGlzLl9jdHguZmlsbCgpO1xuXHRcdHRoaXMuX2N0eC5zdHJva2UoKTtcblx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHR9LFxufSk7XG5cbmlmIChERUJVRykge1xuXHRDYW52YXNQcm9ncmVzc01ldGVyLnByb3RvdHlwZS5fc2tpcExvZyA9IHRydWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQ2FudmFzUHJvZ3Jlc3NNZXRlcjtcbiIsIi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBDb2xvciA9IHJlcXVpcmUoXCJjb2xvclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG52YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvbn0gKi9cbnZhciBidW5kbGVzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb25cIik7XG5cbi8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cbi8vICB1dGlsc1xuLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXG5mdW5jdGlvbiBpbnNlcnRDU1NSdWxlKHNoZWV0LCBzZWxlY3Rvciwgc3R5bGUpIHtcblx0dmFyIGNzc1RleHQgPSBcIlwiO1xuXHRmb3IgKHZhciBwcm9wIGluIHN0eWxlKSB7XG5cdFx0Y3NzVGV4dCArPSBwcm9wICsgXCI6XCIgKyBzdHlsZVtwcm9wXSArIFwiO1wiO1xuXHR9XG5cdHNoZWV0Lmluc2VydFJ1bGUoc2VsZWN0b3IgKyBcIntcIiArIGNzc1RleHQgKyBcIn1cIiwgc2hlZXQuY3NzUnVsZXMubGVuZ3RoKTtcbn1cblxuZnVuY3Rpb24gc2VsZkFuZERlc2NlbmRhbnQoc2VsZkNscywgY2xzKSB7XG5cdHJldHVybiBzZWxmQ2xzICsgXCIgXCIgKyBjbHMgKyBcIiwgXCIgKyBzZWxmQ2xzICsgY2xzO1xufVxuXG4vLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG4vLyAgcm9vdCBydWxlc1xuLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXG52YXIgcm9vdFN0eWxlcyA9IFtcblx0XCJjb2xvclwiLFxuXHRcImJhY2tncm91bmRcIixcblx0XCJiYWNrZ3JvdW5kLWNvbG9yXCIsXG5cdC8vIFwiLS1saW5rLWNvbG9yXCJcbl07XG5cbmZ1bmN0aW9uIGluaXRSb290U3R5bGVzKHNoZWV0LCByb290U2VsZWN0b3IsIGF0dHJzLCBmZ0NvbG9yLCBiZ0NvbG9yLCBsbkNvbG9yLCBoYXNEYXJrQmcpIHtcblx0dmFyIHMsIHJldlNlbGVjdG9yLCBmZ0NvbG9yVmFsLCBiZ0NvbG9yVmFsO1xuXHQvLyB2YXIgcmV2RmdDb2xvclZhbCwgcmV2QmdDb2xvclZhbDtcblxuXHRzID0gXy5waWNrKGF0dHJzLCByb290U3R5bGVzKTtcblx0c1tcIi13ZWJraXQtZm9udC1zbW9vdGhpbmdcIl0gPSAoaGFzRGFya0JnID8gXCJhbnRpYWxpYXNlZFwiIDogXCJhdXRvXCIpO1xuXHQvKiBOT1RFOiBJbiBGaXJlZm94ICctbW96LW9zeC1mb250LXNtb290aGluZzogZ3JheXNjYWxlOydcblx0Lyogd29ya3MgYm90aCBpbiBsaWdodCBvdmVyIGRhcmsgYW5kIGRhcmsgb3ZlciBsaWdodCwgaGFyZGNvZGVkIGluIF9iYXNlLnNjc3MgKi9cblx0Ly9zW1wiLW1vei1vc3gtZm9udC1zbW9vdGhpbmdcIl0gPSAoaGFzRGFya0JnPyBcImdyYXlzY2FsZVwiIDogXCJhdXRvXCIpO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCByb290U2VsZWN0b3IsIHMpO1xuXG5cdC8vIEEgZWxlbWVudFxuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdHMgPSB7fVxuXHRzW1wiY29sb3JcIl0gPSBsbkNvbG9yLnJnYlN0cmluZygpO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCByb290U2VsZWN0b3IgKyBcIiBhXCIsIHMpO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCByb290U2VsZWN0b3IgKyBcIiAuY29sb3ItbG5cIiwgcyk7XG5cblx0Ly8gLmNvbG9yLWZnMDVcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRzID0ge307XG5cdHNbXCJjb2xvclwiXSA9IGZnQ29sb3IuY2xvbmUoKS5taXgoYmdDb2xvciwgMC41KS5yZ2JTdHJpbmcoKTtcblx0c1tcImJvcmRlci1jb2xvclwiXSA9IGZnQ29sb3IuY2xvbmUoKS5taXgoYmdDb2xvciwgMC43KS5yZ2JTdHJpbmcoKTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yICsgXCIgLmNvbG9yLWZnMDVcIiwgcyk7XG5cblx0ZmdDb2xvclZhbCA9IGZnQ29sb3IucmdiU3RyaW5nKCk7XG5cdGJnQ29sb3JWYWwgPSBiZ0NvbG9yLnJnYlN0cmluZygpO1xuXHQvLyByZXZGZ0NvbG9yVmFsID0gYmdDb2xvci5jbG9uZSgpLm1peChmZ0NvbG9yLCAwLjkpLnJnYlN0cmluZygpO1xuXHQvLyByZXZCZ0NvbG9yVmFsID0gZmdDb2xvci5jbG9uZSgpLm1peChiZ0NvbG9yLCAwLjYpLnJnYlN0cmluZygpO1xuXHRyZXZTZWxlY3RvciA9IHJvb3RTZWxlY3RvciArIFwiIC5jb2xvci1yZXZlcnNlXCI7XG5cblx0Ly8gLmNvbG9yLWZnIC5jb2xvci1iZ1xuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdHMgPSB7XG5cdFx0XCJjb2xvclwiOiBmZ0NvbG9yVmFsXG5cdH07XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHJvb3RTZWxlY3RvciArIFwiIC5jb2xvci1mZ1wiLCBzKTtcblx0cyA9IHtcblx0XHRcImJhY2tncm91bmQtY29sb3JcIjogYmdDb2xvclZhbFxuXHR9O1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCByb290U2VsZWN0b3IgKyBcIiAuY29sb3ItYmdcIiwgcyk7XG5cdC8vIGh0bWwgaW52ZXJ0ZWQgdGV4dC9iYWNrZ3JvdW5kXG5cdHMgPSB7XG5cdFx0XCJjb2xvclwiOiBiZ0NvbG9yVmFsXG5cdH07IC8vIHMgPSB7IFwiY29sb3JcIiA6IHJldkZnQ29sb3JWYWwgfTtcblx0c1tcIi13ZWJraXQtZm9udC1zbW9vdGhpbmdcIl0gPSAoaGFzRGFya0JnID8gXCJhdXRvXCIgOiBcImFudGlhbGlhc2VkXCIpO1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByZXZTZWxlY3RvciArIFwiIC5jb2xvci1mZ1wiLCBzKTtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIi5jb2xvci1mZ1wiLCBzKTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgc2VsZkFuZERlc2NlbmRhbnQocmV2U2VsZWN0b3IsIFwiLmNvbG9yLWZnXCIpLCBzKTtcblxuXHRzID0ge1xuXHRcdFwiYmFja2dyb3VuZC1jb2xvclwiOiBmZ0NvbG9yVmFsXG5cdH07XG5cdC8vIHMgPSB7IFwiYmFja2dyb3VuZC1jb2xvclwiIDogcmV2QmdDb2xvclZhbCB9O1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByZXZTZWxlY3RvciArIFwiIC5jb2xvci1iZ1wiLCBzKTtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIi5jb2xvci1iZ1wiLCBzKTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgc2VsZkFuZERlc2NlbmRhbnQocmV2U2VsZWN0b3IsIFwiLmNvbG9yLWJnXCIpLCBzKTtcblxuXHQvLyAuY29sb3Itc3Ryb2tlIC5jb2xvci1maWxsIChTVkcpXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0cyA9IHtcblx0XHRcInN0cm9rZVwiOiBmZ0NvbG9yVmFsXG5cdH07XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHJvb3RTZWxlY3RvciArIFwiIC5jb2xvci1zdHJva2VcIiwgcyk7XG5cdHMgPSB7XG5cdFx0XCJmaWxsXCI6IGJnQ29sb3JWYWxcblx0fTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yICsgXCIgLmNvbG9yLWZpbGxcIiwgcyk7XG5cdC8vIHN2ZyBpbnZlcnRlZCBmaWxsL3N0cm9rZVxuXHRzID0ge1xuXHRcdFwic3Ryb2tlXCI6IGJnQ29sb3JWYWxcblx0fTtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIiAuY29sb3Itc3Ryb2tlXCIsIHMpO1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByZXZTZWxlY3RvciArIFwiLmNvbG9yLXN0cm9rZVwiLCBzKTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgc2VsZkFuZERlc2NlbmRhbnQocmV2U2VsZWN0b3IsIFwiLmNvbG9yLXN0cm9rZVwiKSwgcyk7XG5cdHMgPSB7XG5cdFx0XCJmaWxsXCI6IGZnQ29sb3JWYWxcblx0fTtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIiAuY29sb3ItZmlsbFwiLCBzKTtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIi5jb2xvci1maWxsXCIsIHMpO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCBzZWxmQW5kRGVzY2VuZGFudChyZXZTZWxlY3RvciwgXCIuY29sb3ItZmlsbFwiKSwgcyk7XG5cblx0Ly8gLnRleHQtb3V0bGluZVxuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdC8vIHMgPSB7XG5cdC8vIFx0XCJ0ZXh0LXNoYWRvd1wiOiBcIi0xcHggLTFweCAwIFwiICsgYmdDb2xvclZhbCArXG5cdC8vIFx0XHRcIiwgMXB4IC0xcHggMCBcIiArIGJnQ29sb3JWYWwgK1xuXHQvLyBcdFx0XCIsIC0xcHggMXB4IDAgXCIgKyBiZ0NvbG9yVmFsICtcblx0Ly8gXHRcdFwiLCAxcHggMXB4IDAgXCIgKyBiZ0NvbG9yVmFsXG5cdC8vIH07XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJvb3RTZWxlY3RvciArIFwiIDpub3QoLmNvbGxhcHNlZC1jaGFuZ2VkKSAudGV4dC1vdXRsaW5lLWJnXCIsIHMpO1xuXG59XG5cbi8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cbi8vIGNhcm91c2VsIHN0eWxlc1xuLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXG52YXIgY2Fyb3VzZWxTdHlsZXMgPSBbXCJib3gtc2hhZG93XCIsIFwiYm9yZGVyXCIsIFwiYm9yZGVyLXJhZGl1c1wiXTtcblxuZnVuY3Rpb24gaW5pdENhcm91c2VsU3R5bGVzKHNoZWV0LCBjYXJvdXNlbFNlbGVjdG9yLCBhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnKSB7XG5cdHZhciBzID0gXy5waWNrKGF0dHJzLCBjYXJvdXNlbFN0eWxlcyk7IC8vLCBcImJhY2tncm91bmQtY29sb3JcIl0pO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCBjYXJvdXNlbFNlbGVjdG9yICsgXCIgLm1lZGlhLWl0ZW0gLmNvbnRlbnRcIiwgcyk7XG5cblx0Ly8gLm1lZGlhLWl0ZW0gLmNvbG9yLWJnMDlcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRzID0ge307XG5cdHNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdID0gYmdDb2xvci5jbG9uZSgpLm1peChmZ0NvbG9yLCAwLjk1KS5yZ2JTdHJpbmcoKTtcblx0Ly8gc1tcImJhY2tncm91bmQtY29sb3JcIl0gPSBiZ0NvbG9yLmNsb25lKClbaGFzRGFya0JnID8gXCJkYXJrZW5cIiA6IFwibGlnaHRlblwiXSgwLjA0NSkucmdiU3RyaW5nKCk7XG5cdC8vIHNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdID0gYmdDb2xvci5jbG9uZSgpW2hhc0RhcmtCZyA/IFwibGlnaHRlblwiIDogXCJkYXJrZW5cIl0oMC4wMykucmdiU3RyaW5nKCk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIGNhcm91c2VsU2VsZWN0b3IgKyBcIiAubWVkaWEtaXRlbSAuY29sb3ItYmcwOVwiLCBzKTtcblxuXHQvLyAubWVkaWEtaXRlbSAucGxhY2Vob2xkZXJcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRzID0ge307XG5cdHNbXCItd2Via2l0LWZvbnQtc21vb3RoaW5nXCJdID0gKGhhc0RhcmtCZyA/IFwiYXV0b1wiIDogXCJhbnRpYWxpYXNlZFwiKTtcblx0Ly8gdGV4dCBjb2xvciBsdW1pbm9zaXR5IGlzIGludmVyc2UgZnJvbSBib2R5LCBhcHBseSBvcG9zaXRlIHJlbmRlcmluZyBtb2RlXG5cdHNbXCJjb2xvclwiXSA9IGJnQ29sb3IucmdiU3RyaW5nKCk7XG5cdC8vIHNbXCJjb2xvclwiXSA9IGJnQ29sb3IuY2xvbmUoKVtoYXNEYXJrQmcgPyBcImRhcmtlblwiIDogXCJsaWdodGVuXCJdKDAuMDQ1KS5yZ2JTdHJpbmcoKTtcblx0c1tcImJhY2tncm91bmQtY29sb3JcIl0gPSBiZ0NvbG9yLmNsb25lKCkubWl4KGZnQ29sb3IsIDAuOTUpLnJnYlN0cmluZygpO1xuXHQvLyBzW1wiYmFja2dyb3VuZC1jb2xvclwiXSA9IGJnQ29sb3IuY2xvbmUoKS5taXgoZmdDb2xvciwgMC44KS5hbHBoYSgwLjMpLnJnYmFTdHJpbmcoKTtcblx0Ly8gc1tcImJhY2tncm91bmQtY29sb3JcIl0gPSBiZ0NvbG9yLmNsb25lKClbaGFzRGFya0JnID8gXCJsaWdodGVuXCIgOiBcImRhcmtlblwiXSgwLjAzKS5yZ2JTdHJpbmcoKTtcblx0KFwiYm9yZGVyLXJhZGl1c1wiIGluIGF0dHJzKSAmJiAoc1tcImJvcmRlci1yYWRpdXNcIl0gPSBhdHRyc1tcImJvcmRlci1yYWRpdXNcIl0pO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCBjYXJvdXNlbFNlbGVjdG9yICsgXCIgLm1lZGlhLWl0ZW0gLnBsYWNlaG9sZGVyXCIsIHMpO1xuXG5cdC8vIC5lbXB0eS1pdGVtIEFcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRzID0ge307XG5cdHNbXCJ0ZXh0LWRlY29yYXRpb24tY29sb3JcIl0gPSBmZ0NvbG9yLmNsb25lKCkubWl4KGJnQ29sb3IsIDAuMykucmdiU3RyaW5nKCk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIGNhcm91c2VsU2VsZWN0b3IgKyBcIiAuZW1wdHktaXRlbSBBXCIsIHMpO1xuXHQvLyAvLyAuY29sb3ItZ3JhZGllbnRcblx0Ly8gLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHQvLyBzID0ge307XG5cdC8vIHNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdID0gXCJ0cmFuc3BhcmVudFwiO1xuXHQvLyBzW1wiYmFja2dyb3VuZFwiXSA9IFwibGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgXCIgK1xuXHQvLyBcdFx0YmdDb2xvci5jbG9uZSgpLmFscGhhKDAuMDApLnJnYmFTdHJpbmcoKSArIFwiIDAlLCBcIiArXG5cdC8vIFx0XHRiZ0NvbG9yLmNsb25lKCkuYWxwaGEoMC4xMSkucmdiYVN0cmluZygpICsgXCIgMTAwJSlcIjtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yICsgXCIgLmNvbG9yLWdyYWRpZW50XCIsIHMpO1xuXHQvLyBzID0ge307XG5cdC8vIHNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdID0gXCJ0cmFuc3BhcmVudFwiO1xuXHQvLyBzW1wiYmFja2dyb3VuZFwiXSA9IFwibGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgXCIgK1xuXHQvLyBcdFx0ZmdDb2xvci5jbG9uZSgpLmFscGhhKDAuMDApLnJnYmFTdHJpbmcoKSArIFwiIDAlLCBcIiArXG5cdC8vIFx0XHRmZ0NvbG9yLmNsb25lKCkuYWxwaGEoMC4xMSkucmdiYVN0cmluZygpICsgXCIgMTAwJSlcIjtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIiAuY29sb3ItZ3JhZGllbnRcIiwgcyk7XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJldlNlbGVjdG9yICsgXCIuY29sb3ItZ3JhZGllbnRcIiwgcyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG5cdHZhciBhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnO1xuXG5cdGF0dHJzID0gR2xvYmFscy5ERUZBVUxUX0NPTE9SUztcblx0ZmdDb2xvciA9IG5ldyBDb2xvcihHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wiY29sb3JcIl0pO1xuXHRiZ0NvbG9yID0gbmV3IENvbG9yKEdsb2JhbHMuREVGQVVMVF9DT0xPUlNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdKTtcblx0bG5Db2xvciA9IG5ldyBDb2xvcihHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wibGluay1jb2xvclwiXSlcblx0aGFzRGFya0JnID0gZmdDb2xvci5sdW1pbm9zaXR5KCkgPiBiZ0NvbG9yLmx1bWlub3NpdHkoKTtcblxuXHR2YXIgY29sb3JTdHlsZXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG5cdGNvbG9yU3R5bGVzLmlkID0gXCJjb2xvcnNcIjtcblx0Y29sb3JTdHlsZXMudHlwZSA9IFwidGV4dC9jc3NcIjtcblx0ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjb2xvclN0eWxlcyk7XG5cdC8vIHZhciBjb2xvclN0eWxlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsaW5rI2ZvbGlvXCIpO1xuXG5cdGluaXRSb290U3R5bGVzKGNvbG9yU3R5bGVzLnNoZWV0LCBcIi5hcHBcIixcblx0XHRhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnKTtcblx0aW5pdENhcm91c2VsU3R5bGVzKGNvbG9yU3R5bGVzLnNoZWV0LCBcIi5jYXJvdXNlbFwiLFxuXHRcdGF0dHJzLCBmZ0NvbG9yLCBiZ0NvbG9yLCBsbkNvbG9yLCBoYXNEYXJrQmcpO1xuXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0Ly8gcGVyLWJ1bmRsZSBydWxlc1xuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdGJ1bmRsZXMuZWFjaChmdW5jdGlvbihidW5kbGUpIHtcblx0XHRhdHRycyA9IGJ1bmRsZS5hdHRycygpOyAvL2dldChcImF0dHJzXCIpO1xuXHRcdGZnQ29sb3IgPSBidW5kbGUuY29sb3JzLmZnQ29sb3I7XG5cdFx0YmdDb2xvciA9IGJ1bmRsZS5jb2xvcnMuYmdDb2xvcjtcblx0XHRsbkNvbG9yID0gYnVuZGxlLmNvbG9ycy5sbkNvbG9yO1xuXHRcdGhhc0RhcmtCZyA9IGJ1bmRsZS5jb2xvcnMuaGFzRGFya0JnO1xuXG5cdFx0aW5pdFJvb3RTdHlsZXMoY29sb3JTdHlsZXMuc2hlZXQsXG5cdFx0XHRcIi5hcHAuXCIgKyBidW5kbGUuZ2V0KFwiZG9taWRcIiksXG5cdFx0XHRhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnKTtcblx0XHRpbml0Q2Fyb3VzZWxTdHlsZXMoY29sb3JTdHlsZXMuc2hlZXQsXG5cdFx0XHRcIi5jYXJvdXNlbC5cIiArIGJ1bmRsZS5nZXQoXCJkb21pZFwiKSxcblx0XHRcdGF0dHJzLCBmZ0NvbG9yLCBiZ0NvbG9yLCBsbkNvbG9yLCBoYXNEYXJrQmcpO1xuXHR9KTtcbn07IiwiLypnbG9iYWwgWE1MSHR0cFJlcXVlc3QgKi9cblxuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmUuc3RyaW5nL2xwYWR9ICovXG4vLyB2YXIgY2xhc3NpZnkgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvY2xhc3NpZnlcIik7XG5cbi8vIHZhciBzdGF0dXNNc2cgPSBfLnRlbXBsYXRlKFwiPCU9IHN0YXR1cyAlPiByZWNlaXZlZCBmcm9tIDwlPSB1cmwgJT4gKDwlPSBzdGF0dXNUZXh0ICU+KVwiKTtcbi8vIHZhciBlcnJNc2cgPSBfLnRlbXBsYXRlKFwiJzwlPSBlcnJOYW1lICU+JyBvY3VycmVkIGR1cmluZyByZXF1ZXN0IDwlPSB1cmwgJT5cIik7XG5cbmlmICh3aW5kb3cuWE1MSHR0cFJlcXVlc3QgJiYgd2luZG93LlVSTCAmJiB3aW5kb3cuQmxvYikge1xuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHVybCwgcHJvZ3Jlc3NGbikge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cdFx0XHRyZXF1ZXN0Lm9wZW4oXCJHRVRcIiwgdXJsLCB0cnVlKTtcblx0XHRcdC8vIHJlcXVlc3QudGltZW91dCA9IDEwMDAwOyAvLyBpbiBtaWxsaXNlY29uZHNcblx0XHRcdHJlcXVlc3QucmVzcG9uc2VUeXBlID0gXCJibG9iXCI7XG5cblx0XHRcdC8vIGlmIHByb2dyZXNzRm4gaXMgc3VwcGxpZWRcblx0XHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0XHRpZiAocHJvZ3Jlc3NGbikge1xuXHRcdFx0XHRyZXF1ZXN0Lm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbihldikge1xuXHRcdFx0XHRcdHByb2dyZXNzRm4oZXYubG9hZGVkIC8gZXYudG90YWwpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdFx0Ly8gcmVzb2x2ZWQvc3VjY2Vzc1xuXHRcdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHRcdHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0Ly8gV2hlbiB0aGUgcmVxdWVzdCBsb2FkcywgY2hlY2sgd2hldGhlciBpdCB3YXMgc3VjY2Vzc2Z1bFxuXHRcdFx0XHRpZiAocmVxdWVzdC5zdGF0dXMgPT0gMjAwKSB7XG5cdFx0XHRcdFx0Ly8gSWYgc3VjY2Vzc2Z1bCwgcmVzb2x2ZSB0aGUgcHJvbWlzZSBieSBwYXNzaW5nIGJhY2sgYSByZWZlcmVuY2UgdXJsXG5cdFx0XHRcdFx0cmVzb2x2ZShVUkwuY3JlYXRlT2JqZWN0VVJMKHJlcXVlc3QucmVzcG9uc2UpKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YXIgZXJyID0gbmV3IEVycm9yKChcImh0dHBfXCIgKyByZXF1ZXN0LnN0YXR1c1RleHQucmVwbGFjZSgvXFxzL2csIFwiX1wiKSkudG9VcHBlckNhc2UoKSk7XG5cdFx0XHRcdFx0ZXJyLmluZm9Db2RlID0gcmVxdWVzdC5zdGF0dXM7XG5cdFx0XHRcdFx0ZXJyLmluZm9TcmMgPSB1cmw7XG5cdFx0XHRcdFx0ZXJyLmxvZ0V2ZW50ID0gZXY7XG5cdFx0XHRcdFx0ZXJyLmxvZ01lc3NhZ2UgPSBcIl9sb2FkSW1hZ2VBc09iamVjdFVSTDo6XCIgKyBldi50eXBlICsgXCIgW3JlamVjdF1cIjtcblx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdC8vIHJlamVjdC9mYWlsdXJlXG5cdFx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdFx0cmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0dmFyIGVyciA9IG5ldyBFcnJvcigoZXYudHlwZSArIFwiX2V2ZW50XCIpLnRvVXBwZXJDYXNlKCkpO1xuXHRcdFx0XHRlcnIuaW5mb0NvZGUgPSAtMTtcblx0XHRcdFx0ZXJyLmluZm9TcmMgPSB1cmw7XG5cdFx0XHRcdGVyci5sb2dFdmVudCA9IGV2O1xuXHRcdFx0XHRlcnIubG9nTWVzc2FnZSA9IFwiX2xvYWRJbWFnZUFzT2JqZWN0VVJMOjpcIiArIGV2LnR5cGUgKyBcIiBbcmVqZWN0XVwiO1xuXHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdH07XG5cdFx0XHRyZXF1ZXN0Lm9uYWJvcnQgPSByZXF1ZXN0Lm9udGltZW91dCA9IHJlcXVlc3Qub25lcnJvcjtcblx0XHRcdC8vIGZpbmFsbHlcblx0XHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0XHRyZXF1ZXN0Lm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXF1ZXN0Lm9uYWJvcnQgPSByZXF1ZXN0Lm9udGltZW91dCA9IHJlcXVlc3Qub25lcnJvciA9IHZvaWQgMDtcblx0XHRcdFx0cmVxdWVzdC5vbmxvYWQgPSByZXF1ZXN0Lm9ubG9hZGVuZCA9IHZvaWQgMDtcblx0XHRcdFx0aWYgKHByb2dyZXNzRm4pIHtcblx0XHRcdFx0XHRyZXF1ZXN0Lm9ucHJvZ3Jlc3MgPSB2b2lkIDA7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cblx0XHRcdHJlcXVlc3Quc2VuZCgpO1xuXHRcdH0pO1xuXHR9O1xufSBlbHNlIHtcblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih1cmwpIHtcblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHVybCk7XG5cdH07XG59IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpbWFnZSwgcmVzb2x2ZUVtcHR5KSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRpZiAoIShpbWFnZSBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MSW1hZ2VFbGVtZW50KSkge1xuXHRcdFx0Ly9yZWplY3QobmV3IEVycm9yKFwibm90IGFuIEhUTUxJbWFnZUVsZW1lbnRcIikpO1xuXHRcdFx0cmVqZWN0KFwiRXJyb3I6IG5vdCBhbiBIVE1MSW1hZ2VFbGVtZW50XCIpO1xuXHRcdH0gZWxzZSBpZiAoaW1hZ2UuY29tcGxldGUgJiYgKGltYWdlLnNyYy5sZW5ndGggPiAwIHx8IHJlc29sdmVFbXB0eSkpIHtcblx0XHRcdC8vIGlmIChpbWFnZS5zcmMgPT09IFwiXCIpIGNvbnNvbGUud2FybihcIl93aGVuSW1hZ2VMb2FkcyByZXNvbHZlZCB3aXRoIGVtcHR5IHNyY1wiKTtcblx0XHRcdC8vIGVsc2UgY29uc29sZS5sb2coXCJfd2hlbkltYWdlTG9hZHMgcmVzb2x2ZS1zeW5jXCIsIGltYWdlLnNyYyk7XG5cdFx0XHRyZXNvbHZlKGltYWdlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dmFyIGhhbmRsZXJzID0ge1xuXHRcdFx0XHRsb2FkOiBmdW5jdGlvbihldikge1xuXHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiX3doZW5JbWFnZUxvYWRzX2RvbSByZXNvbHZlLWFzeW5jXCIsIGV2LnR5cGUsIGltYWdlLnNyYyk7XG5cdFx0XHRcdFx0cmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcdFx0XHRyZXNvbHZlKGltYWdlKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRcdFx0dmFyIGVyciA9IG5ldyBFcnJvcihcIkxvYWRpbmcgZmFpbGVkIChcIiArIGV2LnR5cGUgKyBcIiBldmVudClcIik7XG5cdFx0XHRcdFx0ZXJyLmluZm9Db2RlID0gLTE7XG5cdFx0XHRcdFx0ZXJyLmluZm9TcmMgPSBpbWFnZS5zcmM7XG5cdFx0XHRcdFx0ZXJyLmxvZ0V2ZW50ID0gZXY7XG5cdFx0XHRcdFx0ZXJyLmxvZ01lc3NhZ2UgPSBcIl93aGVuSW1hZ2VMb2Fkczo6XCIgKyBldi50eXBlICsgXCIgW3JlamVjdF1cIjtcblx0XHRcdFx0XHRyZW1vdmVFdmVudExpc3RlbmVycygpO1xuXHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdFx0aGFuZGxlcnMuYWJvcnQgPSBoYW5kbGVycy5lcnJvcjtcblx0XHRcdHZhciByZW1vdmVFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRmb3IgKHZhciBldmVudCBpbiBoYW5kbGVycykge1xuXHRcdFx0XHRcdGlmIChoYW5kbGVycy5oYXNPd25Qcm9wZXJ0eShldmVudCkpIHtcblx0XHRcdFx0XHRcdGltYWdlLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXJzW2V2ZW50XSwgZmFsc2UpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdGZvciAodmFyIGV2ZW50IGluIGhhbmRsZXJzKSB7XG5cdFx0XHRcdGlmIChoYW5kbGVycy5oYXNPd25Qcm9wZXJ0eShldmVudCkpIHtcblx0XHRcdFx0XHRpbWFnZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyc1tldmVudF0sIGZhbHNlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59O1xuIiwiLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL193aGVuSW1hZ2VMb2Fkc30gKi9cbnZhciBfd2hlbkltYWdlTG9hZHMgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS9fd2hlbkltYWdlTG9hZHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL19sb2FkSW1hZ2VBc09iamVjdFVSTH0gKi9cbnZhciBfbG9hZEltYWdlQXNPYmplY3RVUkwgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS9fbG9hZEltYWdlQXNPYmplY3RVUkxcIik7XG5cbi8vIHZhciBpc0Jsb2JSRSA9IC9eYmxvYlxcOi4qLztcblxuLy8gdmFyIGxvZ01lc3NhZ2UgPSBcIiVzOjp3aGVuRGVmYXVsdEltYWdlTG9hZHMgWyVzXTogJXNcIjtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih2aWV3KSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgc291cmNlID0gdmlldy5tb2RlbC5nZXQoXCJzb3VyY2VcIik7XG5cdFx0aWYgKHNvdXJjZS5oYXMoXCJwcmVmZXRjaGVkXCIpKSB7XG5cdFx0XHR2aWV3LmRlZmF1bHRJbWFnZS5zcmMgPSBzb3VyY2UuZ2V0KFwicHJlZmV0Y2hlZFwiKTtcblx0XHRcdF93aGVuSW1hZ2VMb2Fkcyh2aWV3LmRlZmF1bHRJbWFnZSlcblx0XHRcdFx0LnRoZW4oXG5cdFx0XHRcdFx0ZnVuY3Rpb24odGFyZ2V0RWwpIHtcblx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKGxvZ01lc3NhZ2UsIHZpZXcuY2lkLCBcInJlc29sdmVkXCIsIFwicHJlZmV0Y2hlZFwiKTtcblx0XHRcdFx0XHRcdHJlc29sdmUodmlldyk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZpZXcubWVkaWFTdGF0ZSA9IFwicGVuZGluZ1wiO1xuXG5cdFx0XHR2YXIgc1VybCA9IHNvdXJjZS5nZXQoXCJvcmlnaW5hbFwiKTtcblx0XHRcdHZhciBwcm9ncmVzc0ZuID0gZnVuY3Rpb24ocHJvZ3Jlc3MpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2cobG9nTWVzc2FnZSwgdmlldy5jaWQsIFwicHJvZ3Jlc3NcIiwgcHJvZ3Jlc3MpO1xuXHRcdFx0XHR2aWV3LnVwZGF0ZU1lZGlhUHJvZ3Jlc3MocHJvZ3Jlc3MsIHNVcmwpO1xuXHRcdFx0fTtcblx0XHRcdHByb2dyZXNzRm4gPSBfLnRocm90dGxlKHByb2dyZXNzRm4sIDEwMCwge1xuXHRcdFx0XHRsZWFkaW5nOiB0cnVlLFxuXHRcdFx0XHR0cmFpbGluZzogZmFsc2Vcblx0XHRcdH0pO1xuXHRcdFx0X2xvYWRJbWFnZUFzT2JqZWN0VVJMKHNVcmwsIHByb2dyZXNzRm4pXG5cdFx0XHRcdC50aGVuKFxuXHRcdFx0XHRcdGZ1bmN0aW9uKHVybCkge1xuXHRcdFx0XHRcdFx0aWYgKC9eYmxvYlxcOi4qLy50ZXN0KHVybCkpIHtcblx0XHRcdFx0XHRcdFx0c291cmNlLnNldChcInByZWZldGNoZWRcIiwgdXJsKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHZpZXcuZGVmYXVsdEltYWdlLnNyYyA9IHVybDtcblx0XHRcdFx0XHRcdC8vIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcblx0XHRcdFx0XHRcdHJldHVybiB2aWV3LmRlZmF1bHRJbWFnZTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHQudGhlbihfd2hlbkltYWdlTG9hZHMpXG5cdFx0XHRcdC50aGVuKFxuXHRcdFx0XHRcdGZ1bmN0aW9uKHRhcmdldEVsKSB7XG5cdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhsb2dNZXNzYWdlLCB2aWV3LmNpZCwgXCJyZXNvbHZlZFwiLCB0YXJnZXRFbC5zcmMpO1xuXHRcdFx0XHRcdFx0dmlldy5vbihcInZpZXc6cmVtb3ZlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0dmFyIHByZWZldGNoZWQgPSBzb3VyY2UuZ2V0KFwicHJlZmV0Y2hlZFwiKTtcblx0XHRcdFx0XHRcdFx0aWYgKHByZWZldGNoZWQgJiYgL15ibG9iXFw6Ly50ZXN0KHByZWZldGNoZWQpKSB7XG5cdFx0XHRcdFx0XHRcdFx0c291cmNlLnVuc2V0KFwicHJlZmV0Y2hlZFwiLCB7XG5cdFx0XHRcdFx0XHRcdFx0XHRzaWxlbnQ6IHRydWVcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHRVUkwucmV2b2tlT2JqZWN0VVJMKHByZWZldGNoZWQpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdC8vIHZpZXcucGxhY2Vob2xkZXIucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcm9ncmVzc1wiKTtcblx0XHRcdFx0XHRcdC8vIHZpZXcudXBkYXRlTWVkaWFQcm9ncmVzcyhpbWFnZVVybCwgXCJjb21wbGV0ZVwiKTtcblx0XHRcdFx0XHRcdHJlc29sdmUodmlldyk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHQvLyBcdH0pXG5cdFx0XHRcdFx0Ly8gLmNhdGNoKFxuXHRcdFx0XHRcdGZ1bmN0aW9uKGVycikge1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS53YXJuKGxvZ01lc3NhZ2UsIHZpZXcuY2lkLCBcInJlamVjdGVkXCIsIGVyci5tZXNzYWdlKTtcblx0XHRcdFx0XHRcdC8vIHZpZXcucGxhY2Vob2xkZXIucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcm9ncmVzc1wiKTtcblx0XHRcdFx0XHRcdC8vIHZpZXcudXBkYXRlTWVkaWFQcm9ncmVzcyhpbWFnZVVybCwgcHJvZ3Jlc3MpO1xuXHRcdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn07IiwiLyogZ2xvYmFsIFByb21pc2UgKi9cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld0Vycm9yfSAqL1xudmFyIFZpZXdFcnJvciA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdFcnJvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3RXJyb3J9ICovXG52YXIgd2hlblZpZXdJc0F0dGFjaGVkID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblZpZXdJc0F0dGFjaGVkXCIpO1xuXG5mdW5jdGlvbiB3aGVuU2Nyb2xsaW5nRW5kcyh2aWV3KSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgcGFyZW50ID0gdmlldy5wYXJlbnRWaWV3O1xuXHRcdGlmIChwYXJlbnQgPT09IG51bGwpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCIlczo6d2hlblNjcm9sbGluZ0VuZHMgWyVzXSAoc3luYylcIiwgdmlldy5jaWQsIFwicmVqZWN0ZWRcIiwgdmlldy5hdHRhY2hlZCk7XG5cdFx0XHRyZWplY3QobmV3IFZpZXdFcnJvcih2aWV3LCBuZXcgRXJyb3IoXCJ3aGVuU2Nyb2xsaW5nRW5kczogdmlldyBoYXMgbm8gcGFyZW50XCIpKSk7XG5cdFx0fSBlbHNlIGlmICghcGFyZW50LnNjcm9sbGluZykge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6d2hlblNjcm9sbGluZ0VuZHMgWyVzXSAoc3luYylcIiwgdmlldy5jaWQsIFwicmVzb2x2ZWRcIiwgdmlldy5hdHRhY2hlZCk7XG5cdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgY2xlYW51cCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRwYXJlbnQub2ZmKFwidmlldzpzY3JvbGxlbmRcIiwgb25TY3JvbGxlbmQpO1xuXHRcdFx0XHRwYXJlbnQub2ZmKFwidmlldzpyZW1vdmVcIiwgb25SZW1vdmUpO1xuXHRcdFx0fTtcblx0XHRcdHZhciBvblNjcm9sbGVuZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp3aGVuU2Nyb2xsaW5nRW5kcyBbJXNdXCIsIHZpZXcuY2lkLCBcInJlc29sdmVkXCIsIHZpZXcuYXR0YWNoZWQpO1xuXHRcdFx0XHRjbGVhbnVwKCk7XG5cdFx0XHRcdHJlc29sdmUodmlldyk7XG5cdFx0XHR9O1xuXHRcdFx0dmFyIG9uUmVtb3ZlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OndoZW5TY3JvbGxpbmdFbmRzIFslc11cIiwgdmlldy5jaWQsIFwicmVqZWN0ZWRcIiwgdmlldy5hdHRhY2hlZCk7XG5cdFx0XHRcdGNsZWFudXAoKTtcblx0XHRcdFx0cmVqZWN0KG5ldyBWaWV3RXJyb3IodmlldywgbmV3IEVycm9yKFwid2hlblNjcm9sbGluZ0VuZHM6IHZpZXcgd2FzIHJlbW92ZWRcIikpKTtcblx0XHRcdH07XG5cdFx0XHRwYXJlbnQub24oXCJ2aWV3OnNjcm9sbGVuZFwiLCBvblNjcm9sbGVuZCk7XG5cdFx0XHRwYXJlbnQub24oXCJ2aWV3OnJlbW92ZVwiLCBvblJlbW92ZSk7XG5cdFx0fVxuXHR9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih2aWV3KSB7XG5cdHJldHVybiBQcm9taXNlLnJlc29sdmUodmlldylcblx0XHQudGhlbih3aGVuVmlld0lzQXR0YWNoZWQpXG5cdFx0LnRoZW4od2hlblNjcm9sbGluZ0VuZHMpO1xufTtcblxuLypcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odmlldykge1xuXHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZpZXcpXG5cdFx0LnRoZW4oZnVuY3Rpb24odmlldykge1xuXHRcdFx0aWYgKHZpZXcuYXR0YWNoZWQpIHtcblx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRcdFx0dmlldy5vbmNlKFwidmlldzphdHRhY2hlZFwiLCBmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KVxuXHRcdC50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdGlmICghdmlldy5wYXJlbnRWaWV3LnNjcm9sbGluZykge1xuXHRcdFx0XHRyZXR1cm4gdmlldztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdFx0XHR2YXIgcmVzb2x2ZU9uU2Nyb2xsZW5kID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp3aGVuU2Nyb2xsaW5nRW5kcyBbJXNdXCIsIHZpZXcuY2lkLCBcInJlc29sdmVkXCIpO1xuXHRcdFx0XHRcdFx0dmlldy5vZmYoXCJ2aWV3OnJlbW92ZVwiLCByZWplY3RPblJlbW92ZSk7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0dmFyIHJlamVjdE9uUmVtb3ZlID0gZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6d2hlblNjcm9sbGluZ0VuZHMgWyVzXVwiLCB2aWV3LmNpZCwgXCJyZWplY3RlZFwiKTtcblx0XHRcdFx0XHRcdHZpZXcucGFyZW50Vmlldy5vZmYoXCJ2aWV3OnNjcm9sbGVuZFwiLCByZXNvbHZlT25TY3JvbGxlbmQpO1xuXHRcdFx0XHRcdFx0cmVqZWN0KG5ldyBWaWV3RXJyb3Iodmlldyxcblx0XHRcdFx0XHRcdFx0bmV3IEVycm9yKFwid2hlblNlbGVjdFNjcm9sbGluZ0VuZHM6IHZpZXcgd2FzIHJlbW92ZWQgKFwiKyB2aWV3LmNpZCArXCIpXCIpKSk7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR2aWV3LnBhcmVudFZpZXcub25jZShcInZpZXc6c2Nyb2xsZW5kXCIsIHJlc29sdmVPblNjcm9sbGVuZCk7XG5cdFx0XHRcdFx0dmlldy5vbmNlKFwidmlldzpyZW1vdmVcIiwgcmVqZWN0T25SZW1vdmUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcbn07XG4qL1xuIiwiLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3RXJyb3J9ICovXG52YXIgVmlld0Vycm9yID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld0Vycm9yXCIpO1xuXG4vLyB2YXIgbG9nTWVzc2FnZSA9IFwiJXM6OndoZW5TZWxlY3Rpb25EaXN0YW5jZUlzIFslc106ICVzXCI7XG5cbi8qKlxuICogQHBhcmFtIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fVxuICogQHBhcmFtIHtudW1iZXJ9IGRpc3RhbmNlXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odmlldywgZGlzdGFuY2UpIHtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdC8vIGlmICghKHZpZXcubW9kZWwgJiYgdmlldy5tb2RlbC5jb2xsZWN0aW9uKSkge1xuXHRcdC8vIFx0cmVqZWN0KG5ldyBWaWV3RXJyb3IodmlldywgbmV3IEVycm9yKFwid2hlblNlbGVjdGlvbklzQ29udGlndW91czogbW9kZWwuY29sbGVjdGlvbiBpcyBlbXB0eVwiKSkpO1xuXHRcdC8vIH1cblx0XHR2YXIgbW9kZWwgPSB2aWV3Lm1vZGVsO1xuXHRcdHZhciBjb2xsZWN0aW9uID0gbW9kZWwuY29sbGVjdGlvbjtcblxuXHRcdHZhciBjaGVjayA9IGZ1bmN0aW9uKG4pIHsgLy8gQ2hlY2sgaW5kaWNlcyBmb3IgY29udGlndWl0eVxuXHRcdFx0cmV0dXJuIE1hdGguYWJzKGNvbGxlY3Rpb24uaW5kZXhPZihtb2RlbCkgLSBjb2xsZWN0aW9uLnNlbGVjdGVkSW5kZXgpIDw9IGRpc3RhbmNlO1xuXHRcdH07XG5cblx0XHRpZiAoY2hlY2soKSkge1xuXHRcdFx0Ly8gY29uc29sZS5sb2cobG9nTWVzc2FnZSwgdmlldy5jaWQsIFwicmVzb2x2ZVwiLCBcInN5bmNcIik7XG5cdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgY2xlYW51cE9uU2V0dGxlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKGxvZ01lc3NhZ2UsIHZpZXcuY2lkLCBcImNsZWFudXBcIiwgXCJhc3luY1wiKTtcblx0XHRcdFx0Y29sbGVjdGlvbi5vZmYoXCJzZWxlY3Q6b25lIHNlbGVjdDpub25lXCIsIHJlc29sdmVPblNlbGVjdCk7XG5cdFx0XHRcdHZpZXcub2ZmKFwidmlldzpyZW1vdmVkXCIsIHJlamVjdE9uUmVtb3ZlKTtcblx0XHRcdH07XG5cdFx0XHR2YXIgcmVzb2x2ZU9uU2VsZWN0ID0gZnVuY3Rpb24obW9kZWwpIHtcblx0XHRcdFx0aWYgKGNoZWNrKCkpIHtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhsb2dNZXNzYWdlLCB2aWV3LmNpZCwgXCJyZXNvbHZlXCIsIFwiYXN5bmNcIik7XG5cdFx0XHRcdFx0Y2xlYW51cE9uU2V0dGxlKCk7XG5cdFx0XHRcdFx0cmVzb2x2ZSh2aWV3KTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdHZhciByZWplY3RPblJlbW92ZSA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0Y2xlYW51cE9uU2V0dGxlKCk7XG5cdFx0XHRcdHJlamVjdChuZXcgVmlld0Vycm9yKHZpZXcsIG5ldyBFcnJvcihcIndoZW5TZWxlY3Rpb25EaXN0YW5jZUlzOiB2aWV3IHdhcyByZW1vdmVkXCIpKSk7XG5cdFx0XHR9O1xuXHRcdFx0Y29sbGVjdGlvbi5vbihcInNlbGVjdDpvbmUgc2VsZWN0Om5vbmVcIiwgcmVzb2x2ZU9uU2VsZWN0KTtcblx0XHRcdHZpZXcub24oXCJ2aWV3OnJlbW92ZWRcIiwgcmVqZWN0T25SZW1vdmUpO1xuXHRcdH1cblx0fSk7XG59O1xuIiwiLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3RXJyb3J9ICovXG4vLyB2YXIgVmlld0Vycm9yID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld0Vycm9yXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3Rpb25EaXN0YW5jZUlzfSAqL1xudmFyIHdoZW5TZWxlY3Rpb25EaXN0YW5jZUlzID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblNlbGVjdGlvbkRpc3RhbmNlSXNcIik7XG5cbi8qKiBAcGFyYW0ge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0cmV0dXJuIHdoZW5TZWxlY3Rpb25EaXN0YW5jZUlzKHZpZXcsIDEpO1xufTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdGlmICh2aWV3LmF0dGFjaGVkKSB7XG5cdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2aWV3Lm9uKFwidmlldzphdHRhY2hlZFwiLCBmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdHJlc29sdmUodmlldyk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH0pO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odmlldykge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0aWYgKCF2aWV3LmludmFsaWRhdGVkKSB7XG5cdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2aWV3Lm9uY2UoXCJ2aWV3OnJlbmRlcjphZnRlclwiLCBmdW5jdGlvbih2aWV3LCBmbGFncykge1xuXHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn07IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L3JlbmRlci9DYXJvdXNlbFJlbmRlcmVyXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgZ2V0Qm94RWRnZVN0eWxlcyA9IHJlcXVpcmUoXCJ1dGlscy9jc3MvZ2V0Qm94RWRnZVN0eWxlc1wiKTtcblxuLy8gRklYTUU6IHRoaXMgZml4dXAgc2hvdWxkIG5vdCBiZSBkb25lIGhlcmVcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL25ldC90b0Fic29sdXRlVVJMfSAqL1xuLy8gdmFyIHRvQWJzb2x1dGVVUkwgPSByZXF1aXJlKFwidXRpbHMvbmV0L3RvQWJzb2x1dGVVUkxcIik7XG4vLyAvKiogQHR5cGUge3N0cmluZ30gKi9cbi8vIHZhciBBQlNfQVBQX1JPT1QgPSB0b0Fic29sdXRlVVJMKHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpLkFQUF9ST09UKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0Nhcm91c2VsUmVuZGVyZXJ9XG4gKi9cbnZhciBDYXJvdXNlbFJlbmRlcmVyID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwiY2Fyb3VzZWxSZW5kZXJlclwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwiZGl2XCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImNhcm91c2VsLWl0ZW1cIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0ZW1wbGF0ZTogXy50ZW1wbGF0ZShcIjxkaXYgY2xhc3M9XFxcImNvbnRlbnQgc2l6aW5nXFxcIj48JT0gbmFtZSAlPjwvZGl2PlwiKSxcblxuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0Y29udGVudDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2NvbnRlbnQgfHwgKHRoaXMuX2NvbnRlbnQgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudFwiKSk7XG5cdFx0XHR9LFxuXHRcdH0sXG5cdFx0c2l6aW5nOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fc2l6aW5nIHx8ICh0aGlzLl9zaXppbmcgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIuc2l6aW5nXCIpKTtcblx0XHRcdH0sXG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdGlmICh0aGlzLm1vZGVsLmF0dHIoXCJAY2xhc3NuYW1lXCIpICE9PSB2b2lkIDApIHtcblx0XHRcdHZhciBjbHNBdHRyID0gdGhpcy5tb2RlbC5hdHRyKFwiQGNsYXNzbmFtZVwiKS5zcGxpdChcIiBcIik7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGNsc0F0dHIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKGNsc0F0dHJbaV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRvcHRpb25zLnBhcmVudFZpZXcgJiYgKHRoaXMucGFyZW50VmlldyA9IG9wdGlvbnMucGFyZW50Vmlldyk7XG5cdFx0dGhpcy5tZXRyaWNzID0ge307XG5cdFx0dGhpcy5tZXRyaWNzLmNvbnRlbnQgPSB7fTtcblx0XHR0aGlzLmNyZWF0ZUNoaWxkcmVuKCk7XG5cdFx0Ly8gdGhpcy5lbmFibGVkID0gISFvcHRpb25zLmVuYWJsZWQ7IC8vIGZvcmNlIGJvb2xcblx0XHR0aGlzLnNldEVuYWJsZWQoISFvcHRpb25zLmVuYWJsZWQpO1xuXHR9LFxuXG5cdGNyZWF0ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsLmlubmVySFRNTCA9IHRoaXMudGVtcGxhdGUodGhpcy5tb2RlbC50b0pTT04oKSk7XG5cdFx0Ly8gRklYTUU6IHRoaXMgZml4dXAgc2hvdWxkIG5vdCBiZSBkb25lIGhlcmVcblx0XHQvLyBGSVhFRDogbm93IGRvbmUgaW4geHNsdFxuXHRcdC8qdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiYVtocmVmXVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHR2YXIgdXJsID0gdG9BYnNvbHV0ZVVSTChlbC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpKTtcblx0XHRcdGlmICh1cmwuaW5kZXhPZihBQlNfQVBQX1JPT1QpICE9PSAwKSB7XG5cdFx0XHRcdGVsLnNldEF0dHJpYnV0ZShcInRhcmdldFwiLCBcIl9ibGFua1wiKTtcblx0XHRcdH1cblx0XHR9KTsqL1xuXHR9LFxuXG5cdC8qKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gKi9cblx0Z2V0U2l6aW5nRWw6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLl9zaXppbmcgfHwgKHRoaXMuX3NpemluZyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5zaXppbmdcIikpO1xuXHR9LFxuXG5cdC8qKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gKi9cblx0Z2V0Q29udGVudEVsOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5fY29udGVudCB8fCAodGhpcy5fY29udGVudCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5jb250ZW50XCIpKTtcblx0fSxcblxuXHQvKiogQHJldHVybiB7dGhpc30gKi9cblx0bWVhc3VyZTogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHNpemluZyA9IHRoaXMuZ2V0U2l6aW5nRWwoKTtcblxuXHRcdHRoaXMubWV0cmljcyA9IGdldEJveEVkZ2VTdHlsZXModGhpcy5lbCwgdGhpcy5tZXRyaWNzKTtcblx0XHR0aGlzLm1ldHJpY3MuY29udGVudCA9IGdldEJveEVkZ2VTdHlsZXModGhpcy5nZXRDb250ZW50RWwoKSwgdGhpcy5tZXRyaWNzLmNvbnRlbnQpO1xuXG5cdFx0c2l6aW5nLnN0eWxlLm1heFdpZHRoID0gXCJcIjtcblx0XHRzaXppbmcuc3R5bGUubWF4SGVpZ2h0ID0gXCJcIjtcblxuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LnggPSBzaXppbmcub2Zmc2V0TGVmdCArIHNpemluZy5jbGllbnRMZWZ0O1xuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LnkgPSBzaXppbmcub2Zmc2V0VG9wICsgc2l6aW5nLmNsaWVudFRvcDtcblx0XHR0aGlzLm1ldHJpY3MuY29udGVudC53aWR0aCA9IHNpemluZy5jbGllbnRXaWR0aDtcblx0XHR0aGlzLm1ldHJpY3MuY29udGVudC5oZWlnaHQgPSBzaXppbmcuY2xpZW50SGVpZ2h0O1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMubWVhc3VyZSgpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGdldFNlbGVjdGlvbkRpc3RhbmNlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gTWF0aC5hYnModGhpcy5tb2RlbC5jb2xsZWN0aW9uLmluZGV4T2YodGhpcy5tb2RlbCkgLSB0aGlzLm1vZGVsLmNvbGxlY3Rpb24uc2VsZWN0ZWRJbmRleCk7XG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYXJvdXNlbFJlbmRlcmVyOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXJcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvTGFiZWxSZW5kZXJlcn0gKi9cbnZhciBMYWJlbFJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9MYWJlbFJlbmRlcmVyXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXJ9XG4gKi9cbnZhciBDbGlja2FibGVSZW5kZXJlciA9IExhYmVsUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcImNsaWNrYWJsZVJlbmRlcmVyXCIsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRldmVudHM6IHtcblx0XHRcImNsaWNrXCI6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJyZW5kZXJlcjpjbGlja1wiLCB0aGlzLm1vZGVsLCBldik7XG5cdFx0fSxcblx0XHRcImNsaWNrIGFcIjogZnVuY3Rpb24oZXYpIHtcblx0XHRcdGV2LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZXYucHJldmVudERlZmF1bHQoKTtcblx0XHR9XG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBDbGlja2FibGVSZW5kZXJlcjtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxLCBoZWxwZXIsIGFsaWFzMT1kZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LCBhbGlhczI9aGVscGVycy5oZWxwZXJNaXNzaW5nLCBhbGlhczM9XCJmdW5jdGlvblwiO1xuXG4gIHJldHVybiBcIjxhIGhyZWY9XFxcIiNcIlxuICAgICsgY29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24oKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5kb21pZCB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuZG9taWQgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcImRvbWlkXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIlxcXCI+PHNwYW4gY2xhc3M9XFxcImxhYmVsXFxcIj5cIlxuICAgICsgKChzdGFjazEgPSAoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLm5hbWUgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLm5hbWUgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcIm5hbWVcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIjwvc3Bhbj48L2E+XCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlclxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9DbGlja2FibGVSZW5kZXJlcn0gKi9cbnZhciBDbGlja2FibGVSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXJcIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9EZWZhdWx0U2VsZWN0YWJsZVJlbmRlcmVyfVxuICovXG52YXIgRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlciA9IENsaWNrYWJsZVJlbmRlcmVyLmV4dGVuZCh7XG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0YWdOYW1lOiBcImxpXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImxpc3QtaXRlbVwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRlbXBsYXRlOiByZXF1aXJlKFwiLi9EZWZhdWx0U2VsZWN0YWJsZVJlbmRlcmVyLmhic1wiKSxcblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkIGRlc2VsZWN0ZWRcIiwgdGhpcy5fcmVuZGVyQ2xhc3NMaXN0KTtcblx0XHR0aGlzLl9yZW5kZXJDbGFzc0xpc3QoKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwudG9KU09OKCkpO1xuXHRcdHRoaXMuX3JlbmRlckNsYXNzTGlzdCgpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdF9yZW5kZXJDbGFzc0xpc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcInNlbGVjdGVkXCIsIHRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHR9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlcjtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWhlbHBlcnMuaGVscGVyTWlzc2luZywgYWxpYXMzPVwiZnVuY3Rpb25cIiwgYWxpYXM0PWNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uO1xuXG4gIHJldHVybiBcIjxzcGFuIGNsYXNzPVxcXCJsYWJlbFxcXCI+XCJcbiAgICArIGFsaWFzNCgoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLm5hbWUgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLm5hbWUgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcIm5hbWVcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiPC9zcGFuPjxhIGhyZWY9XFxcIiNcIlxuICAgICsgYWxpYXM0KCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuZG9taWQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmRvbWlkIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJkb21pZFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiPjxiPiA8L2I+PC9hPlwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL0RvdE5hdmlnYXRpb25SZW5kZXJlclxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG4vLyB2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vKiogQHR5cGUge3N0cmluZ30gKi9cbnZhciB2aWV3VGVtcGxhdGUgPSByZXF1aXJlKFwiLi9Eb3ROYXZpZ2F0aW9uUmVuZGVyZXIuaGJzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0NsaWNrYWJsZVJlbmRlcmVyfSAqL1xudmFyIENsaWNrYWJsZVJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9DbGlja2FibGVSZW5kZXJlclwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0RvdE5hdmlnYXRpb25SZW5kZXJlcn1cbiAqL1xudmFyIERvdE5hdmlnYXRpb25SZW5kZXJlciA9IENsaWNrYWJsZVJlbmRlcmVyLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJkb3RSZW5kZXJlclwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwibGlcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwibGlzdC1pdGVtXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGVtcGxhdGU6IHZpZXdUZW1wbGF0ZSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwic2VsZWN0ZWQgZGVzZWxlY3RlZFwiLCB0aGlzLnJlbmRlckNsYXNzTGlzdCk7XG5cdFx0dGhpcy5yZW5kZXJDbGFzc0xpc3QoKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwudG9KU09OKCkpO1xuXHRcdHRoaXMucmVuZGVyQ2xhc3NMaXN0KCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0cmVuZGVyQ2xhc3NMaXN0OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJzZWxlY3RlZFwiLCB0aGlzLm1vZGVsLnNlbGVjdGVkKTtcblx0fSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IERvdE5hdmlnYXRpb25SZW5kZXJlcjtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWhlbHBlcnMuaGVscGVyTWlzc2luZywgYWxpYXMzPVwiZnVuY3Rpb25cIiwgYWxpYXM0PWNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uO1xuXG4gIHJldHVybiBcIjxkaXYgY2xhc3M9XFxcInBsYWNlaG9sZGVyIHNpemluZ1xcXCI+PC9kaXY+XFxuPGltZyBjbGFzcz1cXFwiY29udGVudCBtZWRpYS1ib3JkZXIgZGVmYXVsdFxcXCIgYWx0PVxcXCJcIlxuICAgICsgYWxpYXM0KCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMudGV4dCB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAudGV4dCA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwidGV4dFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiIGxvbmdkZXNjPVxcXCIjZGVzY19tXCJcbiAgICArIGFsaWFzNCgoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLmlkIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5pZCA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwiaWRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiXFxcIiAvPlxcblwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL0ltYWdlUmVuZGVyZXJcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xuLy8gdmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbX0gKi9cbi8vIHZhciBNZWRpYUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9NZWRpYVJlbmRlcmVyfSAqL1xudmFyIE1lZGlhUmVuZGVyZXIgPSByZXF1aXJlKFwiLi9NZWRpYVJlbmRlcmVyXCIpO1xuXG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIHZpZXdUZW1wbGF0ZSA9IHJlcXVpcmUoXCIuL0ltYWdlUmVuZGVyZXIuaGJzXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvSW1hZ2VSZW5kZXJlcn1cbiAqL1xudmFyIEltYWdlUmVuZGVyZXIgPSBNZWRpYVJlbmRlcmVyLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJpbWFnZVJlbmRlcmVyXCIsXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjbGFzc05hbWU6IE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmNsYXNzTmFtZSArIFwiIGltYWdlLXJlbmRlcmVyXCIsXG5cdC8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG5cdHRlbXBsYXRlOiB2aWV3VGVtcGxhdGUsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG5cdFx0TWVkaWFSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdC8vIHRoaXMuY3JlYXRlQ2hpbGRyZW4oKTtcblx0XHQvLyB0aGlzLmluaXRpYWxpemVBc3luYygpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGNoaWxkcmVuL2xheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNyZWF0ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHRNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5jcmVhdGVDaGlsZHJlbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdC8vIHRoaXMuZWwuaW5uZXJIVE1MID0gdGhpcy50ZW1wbGF0ZSh0aGlzLm1vZGVsLnRvSlNPTigpKTtcblx0XHR0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlaG9sZGVyXCIpO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdC8vIHRoaXMubWVhc3VyZSgpO1xuXG5cdFx0dmFyIGltZyA9IHRoaXMuZ2V0RGVmYXVsdEltYWdlKCk7XG5cdFx0aW1nLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIHRoaXMubWV0cmljcy5tZWRpYS53aWR0aCk7XG5cdFx0aW1nLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0KTtcblxuXHRcdHZhciBjb250ZW50ID0gdGhpcy5nZXRDb250ZW50RWwoKTtcblx0XHRjb250ZW50LnN0eWxlLmxlZnQgPSB0aGlzLm1ldHJpY3MuY29udGVudC54ICsgXCJweFwiO1xuXHRcdGNvbnRlbnQuc3R5bGUudG9wID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQueSArIFwicHhcIjtcblxuXHRcdC8vIHZhciBzaXppbmcgPSB0aGlzLmdldFNpemluZ0VsKCk7XG5cdFx0Ly8gc2l6aW5nLnN0eWxlLm1heFdpZHRoID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQud2lkdGggKyBcInB4XCI7XG5cdFx0Ly8gc2l6aW5nLnN0eWxlLm1heEhlaWdodCA9IHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCArIFwicHhcIjtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGluaXRpYWxpemVBc3luY1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRpbml0aWFsaXplQXN5bmM6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplQXN5bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKVxuXHRcdC8vIHJldHVybiBNZWRpYVJlbmRlcmVyLndoZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXModGhpcylcblx0XHQvLyAvLyByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMpXG5cdFx0Ly8gLy8gXHQudGhlbihNZWRpYVJlbmRlcmVyLndoZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXMpXG5cdFx0Ly8gXHQudGhlbihNZWRpYVJlbmRlcmVyLndoZW5TZWxlY3RUcmFuc2l0aW9uRW5kcylcblx0XHQvLyBcdC50aGVuKE1lZGlhUmVuZGVyZXIud2hlbkRlZmF1bHRJbWFnZUxvYWRzKVxuXHRcdC8vIC50aGVuKFxuXHRcdC8vIFx0ZnVuY3Rpb24odmlldykge1xuXHRcdC8vIFx0XHR2aWV3Lm1lZGlhU3RhdGUgPSBcInJlYWR5XCI7XG5cdFx0Ly8gXHR9KVxuXHRcdC8vIC5jYXRjaChcblx0XHQvLyBcdGZ1bmN0aW9uKGVycikge1xuXHRcdC8vIFx0XHRpZiAoZXJyIGluc3RhbmNlb2YgVmlld0Vycm9yKSB7XG5cdFx0Ly8gXHRcdFx0Ly8gTk9URTogaWdub3JlIFZpZXdFcnJvciB0eXBlXG5cdFx0Ly8gXHRcdFx0Ly8gY29uc29sZS5sb2coZXJyLnZpZXcuY2lkLCBlcnIudmlldy5tb2RlbC5jaWQsIFwiSW1hZ2VSZW5kZXJlcjogXCIgKyBlcnIubWVzc2FnZSk7XG5cdFx0Ly8gXHRcdH0gZWxzZSB7XG5cdFx0Ly8gXHRcdFx0Y29uc29sZS5lcnJvcih0aGlzLmNpZCwgZXJyLm5hbWUsIGVycik7XG5cdFx0Ly8gXHRcdFx0dGhpcy5wbGFjZWhvbGRlci5pbm5lckhUTUwgPSBcIjxwIGNsYXNzPVxcXCJjb2xvci1mZ1xcXCIgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO2JvdHRvbTowO3BhZGRpbmc6M3JlbTtcXFwiPjxzdHJvbmc+XCIgKyBlcnIubmFtZSArIFwiPC9zdHJvbmc+IFwiICsgZXJyLm1lc3NhZ2UgKyBcIjwvcD5cIjtcblx0XHQvLyBcdFx0XHR0aGlzLm1lZGlhU3RhdGUgPSBcImVycm9yXCI7XG5cdFx0Ly8gXHRcdH1cblx0XHQvLyBcdH0uYmluZCh0aGlzKSlcblx0XHQ7XG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBJbWFnZVJlbmRlcmVyO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L3JlbmRlci9MYWJlbFJlbmRlcmVyXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvTGFiZWxSZW5kZXJlcn1cbiAqL1xudmFyIExhYmVsUmVuZGVyZXIgPSBWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJsYWJlbFJlbmRlcmVyXCIsXG5cblx0cHJvcGVydGllczoge1xuXHRcdGxhYmVsOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fbGFiZWwgfHwgKHRoaXMuX2xhYmVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmxhYmVsXCIpKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Ly8gbWVhc3VyZWRXaWR0aDoge1xuXHRcdC8vIFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHQvLyBcdFx0cmV0dXJuIHRoaXMuX21lYXN1cmVkV2lkdGg7XG5cdFx0Ly8gXHR9XG5cdFx0Ly8gfSxcblx0XHQvLyBtZWFzdXJlZEhlaWdodDoge1xuXHRcdC8vIFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHQvLyBcdFx0cmV0dXJuIHRoaXMuX21lYXN1cmVkSGVpZ2h0O1xuXHRcdC8vIFx0fVxuXHRcdC8vIH0sXG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBtZWFzdXJlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyBfbWVhc3VyZWRXaWR0aDogbnVsbCxcblx0Ly8gX21lYXN1cmVkSGVpZ2h0OiBudWxsLFxuXHQvLyBtZWFzdXJlOiBmdW5jdGlvbigpIHt9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gTGFiZWxSZW5kZXJlcjtcbiIsIi8qZ2xvYmFsIFhNTEh0dHBSZXF1ZXN0LCBIVE1MTWVkaWFFbGVtZW50LCBNZWRpYUVycm9yKi9cbi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvTWVkaWFSZW5kZXJlclxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZS5zdHJpbmdzL2xwYWR9ICovXG52YXIgbHBhZCA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlLnN0cmluZy9scGFkXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXN9ICovXG4vLyB2YXIgZ2V0Qm94RWRnZVN0eWxlcyA9IHJlcXVpcmUoXCJ1dGlscy9jc3MvZ2V0Qm94RWRnZVN0eWxlc1wiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtfSAqL1xudmFyIE1lZGlhSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9NZWRpYUl0ZW1cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9DYXJvdXNlbFJlbmRlcmVyfSAqL1xudmFyIENhcm91c2VsUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0Nhcm91c2VsUmVuZGVyZXJcIik7XG5cbnZhciBlcnJvclRlbXBsYXRlID0gcmVxdWlyZShcIi4uL3RlbXBsYXRlL0Vycm9yQmxvY2suaGJzXCIpO1xuXG52YXIgTWVkaWFSZW5kZXJlciA9IENhcm91c2VsUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcIm1lZGlhUmVuZGVyZXJcIixcblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNsYXNzTmFtZTogQ2Fyb3VzZWxSZW5kZXJlci5wcm90b3R5cGUuY2xhc3NOYW1lICsgXCIgbWVkaWEtaXRlbVwiLFxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvTWVkaWFJdGVtfSAqL1xuXHRtb2RlbDogTWVkaWFJdGVtLFxuXG5cdHByb3BlcnRpZXM6IHtcblx0XHRkZWZhdWx0SW1hZ2U6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9kZWZhdWx0SW1hZ2UgfHwgKHRoaXMuX2RlZmF1bHRJbWFnZSA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcImltZy5kZWZhdWx0XCIpKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdG1lZGlhU3RhdGU6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9tZWRpYVN0YXRlO1xuXHRcdFx0fSxcblx0XHRcdHNldDogZnVuY3Rpb24oc3RhdGUpIHtcblx0XHRcdFx0dGhpcy5fc2V0TWVkaWFTdGF0ZShzdGF0ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuXHRcdC8vIGlmICh0aGlzLm1vZGVsLmF0dHJzKCkuaGFzT3duUHJvcGVydHkoXCJAY2xhc3NuYW1lXCIpKSB7XG5cdFx0Ly8gXHR0aGlzLmVsLmNsYXNzTmFtZSArPSBcIiBcIiArIHRoaXMubW9kZWwuYXR0cihcIkBjbGFzc25hbWVcIik7XG5cdFx0Ly8gfVxuXG5cdFx0Ly8gTk9URTogQGNsYXNzbmFtZSBhdHRyIGhhbmRsaW5nIG1vdmVkIHRvIENhcm91c2VsUmVuZGVyZXJcblx0XHQvLyBpZiAodGhpcy5tb2RlbC5hdHRyKFwiQGNsYXNzbmFtZVwiKSAhPT0gdm9pZCAwKSB7XG5cdFx0Ly8gXHR2YXIgY2xzQXR0ciA9IHRoaXMubW9kZWwuYXR0cihcIkBjbGFzc25hbWVcIikuc3BsaXQoXCIgXCIpO1xuXHRcdC8vIFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjbHNBdHRyLmxlbmd0aDsgaSsrKSB7XG5cdFx0Ly8gXHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChjbHNBdHRyW2ldKTtcblx0XHQvLyBcdH1cblx0XHQvLyB9XG5cdFx0Q2Fyb3VzZWxSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhID0ge307XG5cdFx0dGhpcy5tZWRpYVN0YXRlID0gXCJpZGxlXCI7XG5cblx0XHR0aGlzLmluaXRpYWxpemVBc3luYygpXG5cdFx0XHQudGhlbih0aGlzLndoZW5Jbml0aWFsaXplZClcblx0XHRcdC5jYXRjaCh0aGlzLndoZW5Jbml0aWFsaXplRXJyb3IuYmluZCh0aGlzKSk7XG5cdH0sXG5cblx0aW5pdGlhbGl6ZUFzeW5jOiBmdW5jdGlvbigpIHtcblx0XHQvLyB2YXIgTWVkaWFSZW5kZXJlciA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3Rvcjtcblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMpXG5cdFx0XHQudGhlbihNZWRpYVJlbmRlcmVyLndoZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXMpXG5cdFx0XHQudGhlbihNZWRpYVJlbmRlcmVyLndoZW5TY3JvbGxpbmdFbmRzKVxuXHRcdFx0LnRoZW4oTWVkaWFSZW5kZXJlci53aGVuRGVmYXVsdEltYWdlTG9hZHMpO1xuXHR9LFxuXG5cdHdoZW5Jbml0aWFsaXplZDogZnVuY3Rpb24odmlldykge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OndoZW5Jbml0aWFsaXplZCBbJXNdXCIsIHZpZXcuY2lkLCBcInJlc29sdmVkXCIpO1xuXHRcdHZpZXcubWVkaWFTdGF0ZSA9IFwicmVhZHlcIjtcblx0XHR2aWV3LnBsYWNlaG9sZGVyLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHJvZ3Jlc3NcIik7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0d2hlbkluaXRpYWxpemVFcnJvcjogZnVuY3Rpb24oZXJyKSB7XG5cdFx0aWYgKGVyciBpbnN0YW5jZW9mIENhcm91c2VsUmVuZGVyZXIuVmlld0Vycm9yKSB7XG5cdFx0XHQvLyBOT1RFOiBpZ25vcmUgVmlld0Vycm9yIHR5cGVcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OndoZW5Jbml0aWFsaXplRXJyb3JcIiwgZXJyLnZpZXcuY2lkLCBlcnIubWVzc2FnZSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fSBlbHNlIGlmIChlcnIgaW5zdGFuY2VvZiBFcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcihlcnIuc3RhY2spO1xuXHRcdH1cblx0XHR0aGlzLnJlbmRlck1lZGlhRXJyb3IoZXJyKTtcblx0XHR0aGlzLnBsYWNlaG9sZGVyLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHJvZ3Jlc3NcIik7XG5cdFx0dGhpcy5tZWRpYVN0YXRlID0gXCJlcnJvclwiO1xuXHRcdC8vIHRoaXMucGxhY2Vob2xkZXIuaW5uZXJIVE1MID0gZXJyb3JUZW1wbGF0ZShlcnIpO1xuXHRcdC8vIHRoaXMucGxhY2Vob2xkZXIucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcm9ncmVzc1wiKTtcblx0XHQvLyB0aGlzLm1lZGlhU3RhdGUgPSBcImVycm9yXCI7XG5cblx0XHRjb25zb2xlLmVycm9yKFwiJXM6OmluaXRpYWxpemVBc3luYyBbJXMgKGNhdWdodCldOiAlc1wiLCB0aGlzLmNpZCwgZXJyLm5hbWUsXG5cdFx0XHQoZXJyLmluZm8gJiYgZXJyLmluZm8ubG9nTWVzc2FnZSkgfHwgZXJyLm1lc3NhZ2UpO1xuXHRcdGVyci5sb2dFdmVudCAmJiBjb25zb2xlLmxvZyhlcnIubG9nRXZlbnQpO1xuXHR9LFxuXG5cdHJlbmRlck1lZGlhRXJyb3I6IGZ1bmN0aW9uKGVycikge1xuXHRcdHRoaXMucGxhY2Vob2xkZXIuaW5uZXJIVE1MID0gZXJyID8gZXJyb3JUZW1wbGF0ZShlcnIpIDogXCJcIjtcblx0fSxcblxuXHR1cGRhdGVNZWRpYVByb2dyZXNzOiBmdW5jdGlvbihwcm9ncmVzcywgaWQpIHtcblx0XHRpZiAoXy5pc051bWJlcihwcm9ncmVzcykpIHtcblx0XHRcdHRoaXMucGxhY2Vob2xkZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1wcm9ncmVzc1wiLCBscGFkKE1hdGguZmxvb3IocHJvZ3Jlc3MgKiAxMDApLCAyLCAnMCcpKTtcblx0XHR9XG5cdFx0Ly8gZWxzZSBpZiAocHJvZ3Jlc3MgPT09IFwiY29tcGxldGVcIikge1xuXHRcdC8vIFx0dGhpcy5wbGFjZWhvbGRlci5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXByb2dyZXNzXCIpO1xuXHRcdC8vIH1cblx0fSxcblxuXHQvLyB3aGVuTWVkaWFJc1JlYWR5OiBmdW5jdGlvbih2aWV3KSB7XG5cdC8vIFx0cmV0dXJuIE1lZGlhUmVuZGVyZXIud2hlbkRlZmF1bHRJbWFnZUxvYWRzKHRoaXMsIHRoaXMudXBkYXRlTWVkaWFQcm9ncmVzcy5iaW5kKHRoaXMpKTtcblx0Ly8gfSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBjaGlsZCBnZXR0ZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gKi9cblx0Z2V0RGVmYXVsdEltYWdlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5kZWZhdWx0SW1hZ2U7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogY2hpbGRyZW4vbGF5b3V0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGNyZWF0ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsLmlubmVySFRNTCA9IHRoaXMudGVtcGxhdGUodGhpcy5tb2RlbC50b0pTT04oKSk7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRtZWFzdXJlOiBmdW5jdGlvbigpIHtcblx0XHRDYXJvdXNlbFJlbmRlcmVyLnByb3RvdHlwZS5tZWFzdXJlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR2YXIgc3csIHNoOyAvLyBzb3VyY2UgZGltZW5zaW9uc1xuXHRcdHZhciBwY3csIHBjaDsgLy8gbWVhc3VyZWQgdmFsdWVzXG5cdFx0dmFyIGN4LCBjeSwgY3csIGNoLCBjczsgLy8gY29tcHV0ZWQgdmFsdWVzXG5cdFx0dmFyIGV3LCBlaDsgLy8gY29udGVudCBlZGdlIHRvdGFsc1xuXHRcdHZhciBjbTsgLy8gY29udGVudCBtZXRyaWNzXG5cblx0XHRjbSA9IHRoaXMubWV0cmljcy5jb250ZW50O1xuXHRcdGN4ID0gY20ueDtcblx0XHRjeSA9IGNtLnk7XG5cdFx0cGN3ID0gY20ud2lkdGg7XG5cdFx0cGNoID0gY20uaGVpZ2h0O1xuXG5cdFx0ZXcgPSAoY20ucGFkZGluZ0xlZnQgKyBjbS5wYWRkaW5nUmlnaHQgKyBjbS5ib3JkZXJMZWZ0V2lkdGggKyBjbS5ib3JkZXJSaWdodFdpZHRoKTtcblx0XHRlaCA9IChjbS5wYWRkaW5nVG9wICsgY20ucGFkZGluZ0JvdHRvbSArIGNtLmJvcmRlclRvcFdpZHRoICsgY20uYm9yZGVyQm90dG9tV2lkdGgpO1xuXHRcdHBjdyAtPSBldztcblx0XHRwY2ggLT0gZWg7XG5cblx0XHRzdyA9IHRoaXMubW9kZWwuZ2V0KFwic291cmNlXCIpLmdldChcIndcIik7XG5cdFx0c2ggPSB0aGlzLm1vZGVsLmdldChcInNvdXJjZVwiKS5nZXQoXCJoXCIpO1xuXG5cdFx0Ly8gVW5sZXNzIGJvdGggY2xpZW50IGRpbWVuc2lvbnMgYXJlIGxhcmdlciB0aGFuIHRoZSBzb3VyY2Unc1xuXHRcdC8vIGNob29zZSBjb25zdHJhaW50IGRpcmVjdGlvbiBieSBhc3BlY3QgcmF0aW9cblx0XHRpZiAoc3cgPCBwY3cgJiYgc2ggPCBwY2gpIHtcblx0XHRcdGNzID0gMTtcblx0XHRcdGN3ID0gc3c7XG5cdFx0XHRjaCA9IHNoO1xuXHRcdFx0dGhpcy5tZXRyaWNzLmZpdERpcmVjdGlvbiA9IFwiYm90aFwiO1xuXHRcdH0gZWxzZSBpZiAoKHBjdyAvIHBjaCkgPCAoc3cgLyBzaCkpIHtcblx0XHRcdC8vIGZpdCB3aWR0aFxuXHRcdFx0Y3cgPSBwY3c7XG5cdFx0XHRjcyA9IGN3IC8gc3c7XG5cdFx0XHQvLyBjaCA9IGNzICogc2g7XG5cdFx0XHRjaCA9IE1hdGgucm91bmQoY3MgKiBzaCk7XG5cdFx0XHR0aGlzLm1ldHJpY3MuZml0RGlyZWN0aW9uID0gXCJ3aWR0aFwiO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBmaXQgaGVpZ2h0XG5cdFx0XHRjaCA9IHBjaDtcblx0XHRcdGNzID0gY2ggLyBzaDtcblx0XHRcdC8vIGN3ID0gY3MgKiBzdztcblx0XHRcdGN3ID0gTWF0aC5yb3VuZChjcyAqIHN3KTtcblx0XHRcdHRoaXMubWV0cmljcy5maXREaXJlY3Rpb24gPSBcImhlaWdodFwiO1xuXHRcdH1cblxuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LnggPSBjeDtcblx0XHR0aGlzLm1ldHJpY3MuY29udGVudC55ID0gY3k7XG5cdFx0dGhpcy5tZXRyaWNzLmNvbnRlbnQud2lkdGggPSBjdyArIGV3O1xuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCA9IGNoICsgZWg7XG5cblx0XHR0aGlzLm1ldHJpY3MubWVkaWEueCA9IGN4ICsgY20ucGFkZGluZ0xlZnQgKyBjbS5ib3JkZXJMZWZ0V2lkdGg7XG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhLnkgPSBjeSArIGNtLnBhZGRpbmdUb3AgKyBjbS5ib3JkZXJUb3BXaWR0aDtcblx0XHR0aGlzLm1ldHJpY3MubWVkaWEud2lkdGggPSBjdztcblx0XHR0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0ID0gY2g7XG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhLnNjYWxlID0gY3M7XG5cblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjptZWFzdXJlIGNvbnN0cmFpbnQ6ICVzIG1ldHJpY3M6ICVvXCIsIHRoaXMuY2lkLCB0aGlzLm1ldHJpY3MuY29uc3RyYWludCwgdGhpcy5tZXRyaWNzKTtcblx0XHQvLyB2YXIgc2l6aW5nID0gdGhpcy5nZXRTaXppbmdFbCgpO1xuXHRcdC8vIHNpemluZy5zdHlsZS5tYXhXaWR0aCA9IChjdyArIGV3KSArIFwicHhcIjtcblx0XHQvLyBzaXppbmcuc3R5bGUubWF4SGVpZ2h0ID0gKGNoICsgZWgpICsgXCJweFwiO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHQvLyBOT1RFOiBub3QgY2FsbGluZyBzdXBlci5yZW5kZXIsIGNhbGxpbmcgbWVhc3VyZSBvdXJzZWx2ZXNcblx0XHR0aGlzLm1lYXN1cmUoKTtcblxuXHRcdHZhciBzaXppbmcgPSB0aGlzLmdldFNpemluZ0VsKCk7XG5cdFx0c2l6aW5nLnN0eWxlLm1heFdpZHRoID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQud2lkdGggKyBcInB4XCI7XG5cdFx0c2l6aW5nLnN0eWxlLm1heEhlaWdodCA9IHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCArIFwicHhcIjtcblxuXHRcdHRoaXMuZWwuc2V0QXR0cmlidXRlKFwiZGF0YS1maXQtZGlyXCIsIHRoaXMubWV0cmljcy5maXREaXJlY3Rpb24pO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogbWVkaWFTdGF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfbWVkaWFTdGF0ZUVudW06IFtcImlkbGVcIiwgXCJwZW5kaW5nXCIsIFwicmVhZHlcIiwgXCJlcnJvclwiXSxcblxuXHRfc2V0TWVkaWFTdGF0ZTogZnVuY3Rpb24oa2V5KSB7XG5cdFx0aWYgKHRoaXMuX21lZGlhU3RhdGVFbnVtLmluZGV4T2Yoa2V5KSA9PT0gLTEpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIkFyZ3VtZW50IFwiICsga2V5ICsgXCIgaW52YWxpZC4gTXVzdCBiZSBvbmUgb2Y6IFwiICsgdGhpcy5fbWVkaWFTdGF0ZUVudW0uam9pbihcIiwgXCIpKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuX21lZGlhU3RhdGUgIT09IGtleSkge1xuXHRcdFx0aWYgKHRoaXMuX21lZGlhU3RhdGUpIHtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX21lZGlhU3RhdGUpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKGtleSk7XG5cdFx0XHR0aGlzLl9tZWRpYVN0YXRlID0ga2V5O1xuXHRcdFx0dGhpcy50cmlnZ2VyKFwibWVkaWE6XCIgKyBrZXkpO1xuXHRcdH1cblx0fSxcbn0sIHtcblx0TE9HX1RPX1NDUkVFTjogdHJ1ZSxcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXN9ICovXG5cdHdoZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXM6IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXNcIiksXG5cblx0Ly8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS93aGVuU2VsZWN0VHJhbnNpdGlvbkVuZHN9ICovXG5cdC8vIHdoZW5TZWxlY3RUcmFuc2l0aW9uRW5kczogcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblNlbGVjdFRyYW5zaXRpb25FbmRzXCIpLFxuXG5cdC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3Byb21pc2Uvd2hlblNjcm9sbGluZ0VuZHN9ICovXG5cdHdoZW5TY3JvbGxpbmdFbmRzOiByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuU2Nyb2xsaW5nRW5kc1wiKSxcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL3doZW5EZWZhdWx0SW1hZ2VMb2Fkc30gKi9cblx0d2hlbkRlZmF1bHRJbWFnZUxvYWRzOiByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuRGVmYXVsdEltYWdlTG9hZHNcIiksXG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBsb2cgdG8gc2NyZWVuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmlmIChERUJVRykge1xuXG5cdE1lZGlhUmVuZGVyZXIgPSAoZnVuY3Rpb24oTWVkaWFSZW5kZXJlcikge1xuXHRcdGlmICghTWVkaWFSZW5kZXJlci5MT0dfVE9fU0NSRUVOKSByZXR1cm4gTWVkaWFSZW5kZXJlcjtcblxuXHRcdC8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG5cdFx0dmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuXHRcdC8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmUuc3RyaW5nL2xwYWR9ICovXG5cdFx0Ly8gdmFyIGxwYWQgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvbHBhZFwiKTtcblx0XHQvLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZy9ycGFkfSAqL1xuXHRcdC8vIHZhciBycGFkID0gcmVxdWlyZShcInVuZGVyc2NvcmUuc3RyaW5nL3JwYWRcIik7XG5cblx0XHRyZXR1cm4gTWVkaWFSZW5kZXJlci5leHRlbmQoe1xuXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0TWVkaWFSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0XHRcdHZhciBmZ0NvbG9yID0gbmV3IENvbG9yKHRoaXMubW9kZWwuYXR0cihcImNvbG9yXCIpKTtcblx0XHRcdFx0dmFyIGJnQ29sb3IgPSBuZXcgQ29sb3IodGhpcy5tb2RlbC5hdHRyKFwiYmFja2dyb3VuZC1jb2xvclwiKSk7XG5cdFx0XHRcdHRoaXMuX19sb2dDb2xvcnMgPSB7XG5cdFx0XHRcdFx0bm9ybWFsOiBmZ0NvbG9yLmNsb25lKCkubWl4KGJnQ29sb3IsIDAuNzUpLmhzbFN0cmluZygpLFxuXHRcdFx0XHRcdGlnbm9yZWQ6IGZnQ29sb3IuY2xvbmUoKS5taXgoYmdDb2xvciwgMC4yNSkuaHNsU3RyaW5nKCksXG5cdFx0XHRcdFx0ZXJyb3I6IFwiYnJvd25cIixcblx0XHRcdFx0XHRhYm9ydDogXCJvcmFuZ2VcIlxuXHRcdFx0XHR9O1xuXHRcdFx0XHR0aGlzLl9fbG9nRnJhbWVTdHlsZSA9IFwiMXB4IGRhc2hlZCBcIiArIGZnQ29sb3IuY2xvbmUoKS5taXgoYmdDb2xvciwgMC41KS5oc2xTdHJpbmcoKTtcblx0XHRcdFx0dGhpcy5fX2xvZ1N0YXJ0VGltZSA9IERhdGUubm93KCk7XG5cdFx0XHRcdHRoaXMuX19yYWZJZCA9IC0xO1xuXHRcdFx0XHR0aGlzLl9fb25GcmFtZSA9IHRoaXMuX19vbkZyYW1lLmJpbmQodGhpcyk7XG5cdFx0XHR9LFxuXG5cdFx0XHRpbml0aWFsaXplQXN5bmM6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gTWVkaWFSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG5cdFx0XHRcdFx0aWYgKCEoZXJyIGluc3RhbmNlb2YgTWVkaWFSZW5kZXJlci5WaWV3RXJyb3IpKSB7XG5cdFx0XHRcdFx0XHR0aGlzLl9fbG9nTWVzc2FnZShlcnIubWVzc2FnZSwgZXJyLm5hbWUsIHRoaXMuX19sb2dDb2xvcnNbXCJlcnJvclwiXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuXHRcdFx0XHR9LmJpbmQodGhpcykpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0Y3JlYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgcmV0ID0gTWVkaWFSZW5kZXJlci5wcm90b3R5cGUuY3JlYXRlQ2hpbGRyZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50LmNsYXNzTmFtZSA9IFwiZGVidWctbG9nXCI7XG5cdFx0XHRcdHRoaXMuX19sb2dIZWFkZXJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwcmVcIik7XG5cdFx0XHRcdHRoaXMuX19sb2dIZWFkZXJFbC5jbGFzc05hbWUgPSBcImxvZy1oZWFkZXIgY29sb3ItYmdcIjtcblx0XHRcdFx0Ly8gdGhpcy5tb2RlbC5jb2xvcnMuZmdDb2xvci5jbG9uZSgpLm1peChmZ0NvbG9yLCAwLjkpLnJnYlN0cmluZygpXG5cdFx0XHRcdC8vIHRoaXMubW9kZWwuY29sb3JzLmZnQ29sb3IuY2xvbmUoKS5hbHBoYVxuXHRcdFx0XHR0aGlzLl9fbG9nSGVhZGVyRWwudGV4dENvbnRlbnQgPSB0aGlzLl9fZ2V0SGVhZGVyVGV4dCgpO1xuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLl9fbG9nSGVhZGVyRWwpO1xuXHRcdFx0XHR0aGlzLmVsLmluc2VydEJlZm9yZSh0aGlzLl9fbG9nRWxlbWVudCwgdGhpcy5lbC5maXJzdEVsZW1lbnRDaGlsZCk7XG5cdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5zdHlsZS5tYXJnaW5Ub3AgPSBcIjNyZW1cIjtcblx0XHRcdFx0dGhpcy5fX2xvZ0VsZW1lbnQuc3R5bGUubWF4SGVpZ2h0ID0gXCJjYWxjKDEwMCUgLSBcIiArICh0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0KSArIFwicHggLSAzcmVtKVwiO1xuXHRcdFx0XHQvL3RoaXMuX19sb2dFbGVtZW50LnN0eWxlLndpZHRoID0gdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoICsgXCJweFwiO1xuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5zY3JvbGxUb3AgPSB0aGlzLl9fbG9nRWxlbWVudC5zY3JvbGxIZWlnaHQ7XG5cblx0XHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0XHR9LFxuXG5cdFx0XHRfX2xvZ01lc3NhZ2U6IGZ1bmN0aW9uKG1zZywgbG9ndHlwZSwgY29sb3IpIHtcblx0XHRcdFx0dmFyIGxvZ0VudHJ5RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicHJlXCIpO1xuXG5cdFx0XHRcdGxvZ0VudHJ5RWwudGV4dENvbnRlbnQgPSB0aGlzLl9fZ2V0VFN0YW1wKCkgKyBcIiBcIiArIG1zZztcblx0XHRcdFx0bG9nRW50cnlFbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWxvZ3R5cGVcIiwgbG9ndHlwZSB8fCBcIi1cIik7XG5cdFx0XHRcdGxvZ0VudHJ5RWwuc3R5bGUuY29sb3IgPSBjb2xvciB8fCB0aGlzLl9fbG9nQ29sb3JzW2xvZ3R5cGVdIHx8IHRoaXMuX19sb2dDb2xvcnMubm9ybWFsO1xuXG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50LmFwcGVuZENoaWxkKGxvZ0VudHJ5RWwpO1xuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5zY3JvbGxUb3AgPSB0aGlzLl9fbG9nRWxlbWVudC5zY3JvbGxIZWlnaHQ7XG5cblx0XHRcdFx0aWYgKHRoaXMuX19yYWZJZCA9PSAtMSkge1xuXHRcdFx0XHRcdHRoaXMuX19yYWZJZCA9IHRoaXMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX19vbkZyYW1lKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0X19vbkZyYW1lOiBmdW5jdGlvbih0c3RhbXApIHtcblx0XHRcdFx0dGhpcy5fX3JhZklkID0gLTE7XG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50Lmxhc3RFbGVtZW50Q2hpbGQuc3R5bGUuYm9yZGVyQm90dG9tID0gdGhpcy5fX2xvZ0ZyYW1lU3R5bGU7XG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50Lmxhc3RFbGVtZW50Q2hpbGQuc3R5bGUucGFkZGluZ0JvdHRvbSA9IFwiMnB4XCI7XG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50Lmxhc3RFbGVtZW50Q2hpbGQuc3R5bGUubWFyZ2luQm90dG9tID0gXCIycHhcIjtcblx0XHRcdH0sXG5cblx0XHRcdF9fZ2V0VFN0YW1wOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gcmV0dXJuIG5ldyBEYXRlKERhdGUubm93KCkgLSB0aGlzLl9fbG9nU3RhcnRUaW1lKS50b0lTT1N0cmluZygpLnN1YnN0cigxMSwgMTIpO1xuXHRcdFx0XHRyZXR1cm4gbHBhZCgoKERhdGUubm93KCkgLSB0aGlzLl9fbG9nU3RhcnRUaW1lKSAvIDEwMDApLnRvRml4ZWQoMyksIDgsIFwiMFwiKTtcblx0XHRcdH0sXG5cblx0XHRcdF9fZ2V0SGVhZGVyVGV4dDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiAnJztcblx0XHRcdH0sXG5cdFx0fSk7XG5cdH0pKE1lZGlhUmVuZGVyZXIpO1xuXG59IC8vIGVuZCBkZWJ1Z1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvTWVkaWFSZW5kZXJlcn1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBNZWRpYVJlbmRlcmVyOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvUGxheWFibGVSZW5kZXJlclxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbi8vIHZhciBDb2xvciA9IHJlcXVpcmUoXCJjb2xvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvTWVkaWFSZW5kZXJlcn0gKi9cbnZhciBNZWRpYVJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9NZWRpYVJlbmRlcmVyXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJ9ICovXG4vLyB2YXIgUHJvZ3Jlc3NNZXRlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvUHJvZ3Jlc3NNZXRlclwiKTtcblxuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBwcmVmaXhlZFByb3BlcnR5ID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkUHJvcGVydHlcIik7XG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIHByZWZpeGVkRXZlbnQgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRFdmVudFwiKTtcblxuLy8gdmFyIHZpc2liaWxpdHlIaWRkZW5Qcm9wID0gcHJlZml4ZWRQcm9wZXJ0eShcImhpZGRlblwiLCBkb2N1bWVudCk7XG4vKiogQHR5cGUge1N0cmluZ30gKi9cbnZhciB2aXNpYmlsaXR5U3RhdGVQcm9wID0gcHJlZml4ZWRQcm9wZXJ0eShcInZpc2liaWxpdHlTdGF0ZVwiLCBkb2N1bWVudCk7XG4vKiogQHR5cGUge1N0cmluZ30gKi9cbnZhciB2aXNpYmlsaXR5Q2hhbmdlRXZlbnQgPSBwcmVmaXhlZEV2ZW50KFwidmlzaWJpbGl0eWNoYW5nZVwiLCBkb2N1bWVudCwgXCJoaWRkZW5cIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG4vLyB2YXIgZHVvdG9uZSA9IHJlcXVpcmUoXCJ1dGlscy9jYW52YXMvYml0bWFwL2R1b3RvbmVcIik7XG4vLyB2YXIgc3RhY2tCbHVyUkdCID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9iaXRtYXAvc3RhY2tCbHVyUkdCXCIpO1xuLy8gdmFyIHN0YWNrQmx1ck1vbm8gPSByZXF1aXJlKFwidXRpbHMvY2FudmFzL2JpdG1hcC9zdGFja0JsdXJNb25vXCIpO1xuLy8gdmFyIGdldEF2ZXJhZ2VSR0JBID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9iaXRtYXAvZ2V0QXZlcmFnZVJHQkFcIik7XG4vLyB2YXIgZ2V0QXZlcmFnZVJHQiA9IHJlcXVpcmUoXCJ1dGlscy9jYW52YXMvYml0bWFwL2dldEF2ZXJhZ2VSR0JcIik7XG5cbi8vIC8qKiBAdHlwZSB7SFRNTENhbnZhc0VsZW1lbnR9ICovXG4vLyB2YXIgX3NoYXJlZENhbnZhcyA9IG51bGw7XG4vLyAvKiogQHJldHVybiB7SFRNTENhbnZhc0VsZW1lbnR9ICovXG4vLyB2YXIgZ2V0U2hhcmVkQ2FudmFzID0gZnVuY3Rpb24oKSB7XG4vLyBcdGlmIChfc2hhcmVkQ2FudmFzID09PSBudWxsKSB7XG4vLyBcdFx0X3NoYXJlZENhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG4vLyBcdH1cbi8vIFx0cmV0dXJuIF9zaGFyZWRDYW52YXM7XG4vLyB9O1xuXG4vLyBmdW5jdGlvbiBsb2dBdHRhY2hJbmZvKHZpZXcsIG5hbWUsIGxldmVsKSB7XG4vLyBcdGlmIChbXCJsb2dcIiwgXCJpbmZvXCIsIFwid2FyblwiLCBcImVycm9yXCJdLmluZGV4T2YobGV2ZWwpICE9IC0xKSB7XG4vLyBcdFx0bGV2ZWwgPSBcImxvZ1wiO1xuLy8gXHR9XG4vLyBcdGNvbnNvbGVbbGV2ZWxdLmNhbGwoY29uc29sZSwgXCIlczo6JXMgW3BhcmVudDolcyAlcyAlcyBkZXB0aDolc11cIiwgdmlldy5jaWQsIG5hbWUsIHZpZXcucGFyZW50VmlldyAmJiB2aWV3LnBhcmVudFZpZXcuY2lkLCB2aWV3LmF0dGFjaGVkID8gXCJhdHRhY2hlZFwiIDogXCJkZXRhY2hlZFwiLCB2aWV3Ll92aWV3UGhhc2UsIHZpZXcudmlld0RlcHRoKTtcbi8vIH1cblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1BsYXlhYmxlUmVuZGVyZXJ9XG4gKi9cbnZhciBQbGF5YWJsZVJlbmRlcmVyID0gTWVkaWFSZW5kZXJlci5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwicGxheWFibGVSZW5kZXJlclwiLFxuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfEZ1bmN0aW9ufSAqL1xuXHRjbGFzc05hbWU6IE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmNsYXNzTmFtZSArIFwiIHBsYXlhYmxlLXJlbmRlcmVyXCIsXG5cblx0cHJvcGVydGllczoge1xuXHRcdHBhdXNlZDoge1xuXHRcdFx0LyoqIEByZXR1cm4ge0Jvb2xlYW59ICovXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5faXNNZWRpYVBhdXNlZCgpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0cGxheWJhY2tSZXF1ZXN0ZWQ6IHtcblx0XHRcdC8qKiBAcmV0dXJuIHtCb29sZWFufSAqL1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3BsYXliYWNrUmVxdWVzdGVkO1xuXHRcdFx0fSxcblx0XHRcdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0dGhpcy5fc2V0UGxheWJhY2tSZXF1ZXN0ZWQodmFsdWUpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0cGxheVRvZ2dsZToge1xuXHRcdFx0LyoqIEByZXR1cm4ge0hUTUxFbGVtZW50fSAqL1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3BsYXlUb2dnbGUgfHwgKHRoaXMuX3BsYXlUb2dnbGUgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIucGxheS10b2dnbGVcIikpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0b3ZlcmxheToge1xuXHRcdFx0LyoqIEByZXR1cm4ge0hUTUxFbGVtZW50fSAqL1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX292ZXJsYXkgfHwgKHRoaXMuX292ZXJsYXkgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheVwiKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuXHRcdE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRfLmJpbmRBbGwodGhpcyxcblx0XHRcdFwiX29uUGxheWJhY2tUb2dnbGVcIixcblx0XHRcdFwiX29uVmlzaWJpbGl0eUNoYW5nZVwiXG5cdFx0KTtcblx0XHR0aGlzLl9zZXRQbGF5YmFja1JlcXVlc3RlZCh0aGlzLl9wbGF5YmFja1JlcXVlc3RlZCk7XG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLCBcInZpZXc6cGFyZW50Q2hhbmdlXCIsIGZ1bmN0aW9uKGNoaWxkVmlldywgbmV3UGFyZW50LCBvbGRQYXJlbnQpIHtcblx0XHQvLyBcdC8vIGxvZ0F0dGFjaEluZm8odGhpcywgXCJbdmlldzpwYXJlbnRDaGFuZ2VdXCIsIFwiaW5mb1wiKTtcblx0XHQvLyBcdGNvbnNvbGUuaW5mbyhcIiVzOjpbdmlldzpwYXJlbnRDaGFuZ2VdICclcycgdG8gJyVzJ1wiLCB0aGlzLmNpZCwgb2xkUGFyZW50ICYmIG9sZFBhcmVudC5jaWQsIG5ld1BhcmVudCAmJiBuZXdQYXJlbnQuY2lkKTtcblx0XHQvLyB9KTtcblx0fSxcblxuXHQvLyAvKiogQG92ZXJyaWRlICovXG5cdC8vIGluaXRpYWxpemVBc3luYzogZnVuY3Rpb24oKSB7XG5cdC8vIFx0cmV0dXJuIE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuaW5pdGlhbGl6ZUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdC8vIH0sXG5cblx0Ly8gLyoqIEBvdmVycmlkZSAqL1xuXHQvLyByZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQvLyBcdHJldHVybiB0aGlzO1xuXHQvLyB9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGNoaWxkcmVuL2xheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyBjcmVhdGVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwudG9KU09OKCkpO1xuXHQvLyBcdHRoaXMucGxhY2Vob2xkZXIgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2Vob2xkZXJcIik7XG5cdC8vIFx0dGhpcy5jb250ZW50ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRlbnRcIik7XG5cdC8vIFx0dGhpcy5pbWFnZSA9IHRoaXMuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiaW1nLmN1cnJlbnRcIik7XG5cdC8vIH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0Lyogc2V0RW5hYmxlZFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHNldEVuYWJsZWQ6IGZ1bmN0aW9uKGVuYWJsZWQpIHtcblx0XHRNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5zZXRFbmFibGVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0Ly8gdGhpcy5fdmFsaWRhdGVQbGF5YmFjayhlbmFibGVkKTtcblx0XHQvLyBpZiAoZW5hYmxlZCkge1xuXHRcdHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0Ly8gaWYgc2VsZWN0ZWQsIHBhdXNlIG1lZGlhXG5cdFx0Ly8gXHR0aGlzLm1vZGVsLnNlbGVjdGVkICYmIHRoaXMudG9nZ2xlUGxheWJhY2soZmFsc2UpO1xuXHRcdC8vIFx0Ly8gdGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdFx0Ly8gfVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBzZWxlY3Rpb24gaGFuZGxlcnNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0YWRkU2VsZWN0aW9uTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fdmlld1BoYXNlICE9IFwiaW5pdGlhbGl6ZWRcIilcblx0XHRcdHRocm93IG5ldyBFcnJvcih0aGlzLmNpZCArIFwiOjphZGRTZWxlY3Rpb25MaXN0ZW5lcnMgY2FsbGVkIHdoaWxlIFwiICsgdGhpcy5fdmlld1BoYXNlKTtcblxuXHRcdC8vIGxvZ0F0dGFjaEluZm8odGhpcywgXCJhZGRTZWxlY3Rpb25MaXN0ZW5lcnNcIiwgXCJsb2dcIik7XG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLCBcInZpZXc6cmVtb3ZlZFwiLCB0aGlzLnJlbW92ZVNlbGVjdGlvbkxpc3RlbmVycyk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkXCIsIHRoaXMuX29uTW9kZWxTZWxlY3RlZCk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImRlc2VsZWN0ZWRcIiwgdGhpcy5fb25Nb2RlbERlc2VsZWN0ZWQpO1xuXHRcdGlmICh0aGlzLm1vZGVsLnNlbGVjdGVkKSB7XG5cdFx0XHR0aGlzLl9vbk1vZGVsU2VsZWN0ZWQoKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gcmVtb3ZlU2VsZWN0aW9uTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcblx0Ly8gXHQvLyBsb2dBdHRhY2hJbmZvKHRoaXMsIFwicmVtb3ZlU2VsZWN0aW9uTGlzdGVuZXJzXCIsIFwibG9nXCIpO1xuXHQvLyBcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLCBcInZpZXc6cmVtb3ZlZFwiLCB0aGlzLnJlbW92ZVNlbGVjdGlvbkxpc3RlbmVycyk7XG5cdC8vIFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMubW9kZWwsIFwic2VsZWN0ZWRcIiwgdGhpcy5fb25Nb2RlbFNlbGVjdGVkKTtcblx0Ly8gXHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5tb2RlbCwgXCJkZXNlbGVjdGVkXCIsIHRoaXMuX29uTW9kZWxEZXNlbGVjdGVkKTtcblx0Ly8gXHRpZiAodGhpcy5tb2RlbC5zZWxlY3RlZCkge1xuXHQvLyBcdFx0dGhpcy5fb25Nb2RlbERlc2VsZWN0ZWQoKTtcblx0Ly8gXHR9XG5cdC8vIH0sXG5cblx0LyogbW9kZWwgc2VsZWN0ZWQgaGFuZGxlcnM6XG5cdC8qIG1vZGVsIHNlbGVjdGlvbiB0b2dnbGVzIHBsYXliYWNrXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vbk1vZGVsU2VsZWN0ZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vbk1vZGVsU2VsZWN0ZWQgX3BsYXliYWNrUmVxdWVzdGVkOiAlcywgZXZlbnQ6ICVzXCIsIHRoaXMuY2lkLCB0aGlzLl9wbGF5YmFja1JlcXVlc3RlZCwgdGhpcy5fdG9nZ2xlRXZlbnQpO1xuXHRcdC8vIGxvZ0F0dGFjaEluZm8odGhpcywgXCJfb25Nb2RlbFNlbGVjdGVkXCIsIFwibG9nXCIpO1xuXHRcdC8vIHRoaXMuX2FkZFBhcmVudExpc3RlbmVycygpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnBhcmVudENoYW5nZVwiLCB0aGlzLl9vblBhcmVudENoYW5nZSk7XG5cdFx0aWYgKHRoaXMucGFyZW50VmlldykgdGhpcy5fb25QYXJlbnRDaGFuZ2UodGhpcywgdGhpcy5wYXJlbnRWaWV3LCBudWxsKTtcblxuXHRcdHRoaXMuX2FkZERPTUxpc3RlbmVycygpO1xuXHRcdHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0fSxcblxuXHRfb25Nb2RlbERlc2VsZWN0ZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGxvZ0F0dGFjaEluZm8odGhpcywgXCJfb25Nb2RlbERlc2VsZWN0ZWRcIiwgXCJsb2dcIik7XG5cdFx0Ly8gdGhpcy5fcmVtb3ZlUGFyZW50TGlzdGVuZXJzKCk7XG5cdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMsIFwidmlldzpwYXJlbnRDaGFuZ2VcIiwgdGhpcy5fb25QYXJlbnRDaGFuZ2UpO1xuXHRcdGlmICh0aGlzLnBhcmVudFZpZXcpIHRoaXMuX29uUGFyZW50Q2hhbmdlKHRoaXMsIG51bGwsIHRoaXMucGFyZW50Vmlldyk7XG5cblx0XHR0aGlzLl9yZW1vdmVET01MaXN0ZW5lcnMoKTtcblx0XHR0aGlzLnRvZ2dsZVBsYXliYWNrKGZhbHNlKTtcblx0XHQvLyB0aGlzLl92YWxpZGF0ZVBsYXliYWNrKHRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHRcdC8vIHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0fSxcblxuXHQvKiB2aWV3OnBhcmVudENoYW5nZSBoYW5kbGVycyAzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vblBhcmVudENoYW5nZTogZnVuY3Rpb24oY2hpbGRWaWV3LCBuZXdQYXJlbnQsIG9sZFBhcmVudCkge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiW3Njcm9sbF0gJXM6Ol9vblBhcmVudENoYW5nZSAnJXMnIHRvICclcydcIiwgdGhpcy5jaWQsIG9sZFBhcmVudCAmJiBvbGRQYXJlbnQuY2lkLCBuZXdQYXJlbnQgJiYgbmV3UGFyZW50LmNpZCk7XG5cdFx0aWYgKG9sZFBhcmVudCkgdGhpcy5zdG9wTGlzdGVuaW5nKG9sZFBhcmVudCwgXCJ2aWV3OnNjcm9sbHN0YXJ0IHZpZXc6c2Nyb2xsZW5kXCIsIHRoaXMuX29uU2Nyb2xsQ2hhbmdlKTtcblx0XHRpZiAobmV3UGFyZW50KSB0aGlzLmxpc3RlblRvKG5ld1BhcmVudCwgXCJ2aWV3OnNjcm9sbHN0YXJ0IHZpZXc6c2Nyb2xsZW5kXCIsIHRoaXMuX29uU2Nyb2xsQ2hhbmdlKTtcblx0fSxcblxuXHRfb25TY3JvbGxDaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLnBhcmVudFZpZXcgPT09IG51bGwpIHtcblx0XHRcdHRoaXMudG9nZ2xlUGxheWJhY2soZmFsc2UpO1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKHRoaXMuY2lkICsgXCI6Ol9vblNjcm9sbENoYW5nZSBwYXJlbnRWaWV3IGlzIG51bGxcIik7XG5cdFx0fVxuXHRcdC8vIGNvbnNvbGUubG9nKFwiW3Njcm9sbF0gJXM6Ol9vblNjcm9sbENoYW5nZSAlcy5zY3JvbGxpbmc6ICVzXCIsIHRoaXMuY2lkLCB0aGlzLnBhcmVudFZpZXcuY2lkLCB0aGlzLnBhcmVudFZpZXcuc2Nyb2xsaW5nKTtcblxuXHRcdC8vIHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soIXRoaXMucGFyZW50Vmlldy5zY3JvbGxpbmcpO1xuXHRcdC8vIGlmICghdGhpcy5wYXJlbnRWaWV3LnNjcm9sbGluZykge1xuXHRcdHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0dGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdFx0Ly8gfVxuXHR9LFxuXG5cdC8qIHZpZXc6cGFyZW50Q2hhbmdlIGhhbmRsZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qX2FkZFBhcmVudExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCF0aGlzLnBhcmVudFZpZXcpIHtcblx0XHRcdGxvZ0F0dGFjaEluZm8odGhpcywgXCJfYWRkUGFyZW50TGlzdGVuZXJzXCIsIFwiZXJyb3JcIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnJlbW92ZVwiLCB0aGlzLl9yZW1vdmVQYXJlbnRMaXN0ZW5lcnMpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5wYXJlbnRWaWV3LCBcInZpZXc6cmVtb3ZlXCIsIHRoaXMuX3JlbW92ZVBhcmVudExpc3RlbmVycyk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLnBhcmVudFZpZXcsIFwidmlldzpzY3JvbGxzdGFydFwiLCB0aGlzLl9vblNjcm9sbFN0YXJ0KTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMucGFyZW50VmlldywgXCJ2aWV3OnNjcm9sbGVuZFwiLCB0aGlzLl9vblNjcm9sbEVuZCk7XG5cdH0sXG5cblx0X3JlbW92ZVBhcmVudExpc3RlbmVyczogZnVuY3Rpb24odmlldykge1xuXHRcdGlmICghdGhpcy5wYXJlbnRWaWV3KSB7XG5cdFx0XHRsb2dBdHRhY2hJbmZvKHRoaXMsIFwiX3JlbW92ZVBhcmVudExpc3RlbmVyc1wiLCBcImVycm9yXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAodmlldyAhPT0gdm9pZCAwKSB7XG5cdFx0XHRsb2dBdHRhY2hJbmZvKHRoaXMsIFwiX3JlbW92ZVBhcmVudExpc3RlbmVycyBbZXZlbnQgc291cmNlIHZpZXddXCIsIFwiaW5mb1wiKTtcblx0XHRcdC8vIGNvbnNvbGUuaW5mbyhcIiVzW3BsYXlhYmxlXTo6X3JlbW92ZVBhcmVudExpc3RlbmVycyBldmVudCBzb3VyY2UgdmlldzogJXNcIiwgdGhpcy5jaWQsIHZpZXcgJiYgdmlldy5jaWQpO1xuXHRcdH1cblxuXHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLCBcInZpZXc6cmVtb3ZlXCIsIHRoaXMuX3JlbW92ZVBhcmVudExpc3RlbmVycyk7XG5cdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMucGFyZW50VmlldywgXCJ2aWV3OnJlbW92ZVwiLCB0aGlzLl9yZW1vdmVQYXJlbnRMaXN0ZW5lcnMpO1xuXHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLnBhcmVudFZpZXcsIFwidmlldzpzY3JvbGxzdGFydFwiLCB0aGlzLl9vblNjcm9sbFN0YXJ0KTtcblx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5wYXJlbnRWaWV3LCBcInZpZXc6c2Nyb2xsZW5kXCIsIHRoaXMuX29uU2Nyb2xsRW5kKTtcblx0fSwqL1xuXG5cdC8qIHZpZXc6c2Nyb2xsc3RhcnQgdmlldzpzY3JvbGxlbmRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Lypfb25TY3JvbGxTdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdH0sXG5cblx0X29uU2Nyb2xsRW5kOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl92YWxpZGF0ZVBsYXliYWNrKCk7XG5cdH0sKi9cblxuXHQvKiBsaXN0ZW4gdG8gRE9NIGV2ZW50c1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfYWRkRE9NTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwidmlldzpyZW1vdmVkXCIsIHRoaXMuX3JlbW92ZURPTUxpc3RlbmVycyk7XG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcih2aXNpYmlsaXR5Q2hhbmdlRXZlbnQsIHRoaXMuX29uVmlzaWJpbGl0eUNoYW5nZSwgZmFsc2UpO1xuXHRcdHRoaXMucGxheVRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKHRoaXMuX3RvZ2dsZUV2ZW50LCB0aGlzLl9vblBsYXliYWNrVG9nZ2xlLCB0cnVlKTtcblx0fSxcblxuXHRfcmVtb3ZlRE9NTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcywgXCJ2aWV3OnJlbW92ZWRcIiwgdGhpcy5fcmVtb3ZlRE9NTGlzdGVuZXJzKTtcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKHZpc2liaWxpdHlDaGFuZ2VFdmVudCwgdGhpcy5fb25WaXNpYmlsaXR5Q2hhbmdlLCBmYWxzZSk7XG5cdFx0dGhpcy5wbGF5VG9nZ2xlLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5fdG9nZ2xlRXZlbnQsIHRoaXMuX29uUGxheWJhY2tUb2dnbGUsIHRydWUpO1xuXHR9LFxuXG5cdC8qIHZpc2liaWxpdHkgZG9tIGV2ZW50XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXHRfb25WaXNpYmlsaXR5Q2hhbmdlOiBmdW5jdGlvbihldikge1xuXHRcdC8vIHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soIWRvY3VtZW50W3Zpc2liaWxpdHlIaWRkZW5Qcm9wXSk7XG5cdFx0Ly8gdGhpcy5fdmFsaWRhdGVQbGF5YmFjayhkb2N1bWVudFt2aXNpYmlsaXR5U3RhdGVQcm9wXSAhPSBcImhpZGRlblwiKTtcblx0XHQvLyBpZiAoZG9jdW1lbnRbdmlzaWJpbGl0eVN0YXRlUHJvcF0gIT0gXCJoaWRkZW5cIikge1xuXHRcdHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0dGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdFx0Ly8gfVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHBsYXktdG9nZ2xlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAdHlwZSB7U3RyaW5nfSAqL1xuXHRfdG9nZ2xlRXZlbnQ6IHdpbmRvdy5oYXNPd25Qcm9wZXJ0eShcIm9ucG9pbnRlcnVwXCIpID8gXCJwb2ludGVydXBcIiA6IFwibW91c2V1cFwiLFxuXG5cdF9vblBsYXliYWNrVG9nZ2xlOiBmdW5jdGlvbihldikge1xuXHRcdGNvbnNvbGUubG9nKFwiJXNbJXNhYmxlZF06Ol9vblBsYXliYWNrVG9nZ2xlWyVzXSBkZWZhdWx0UHJldmVudGVkOiAlc1wiLCB0aGlzLmNpZCwgdGhpcy5lbmFibGVkID8gXCJlblwiIDogXCJkaXNcIiwgZXYudHlwZSwgZXYuZGVmYXVsdFByZXZlbnRlZCk7XG5cdFx0Ly8gTk9URTogUGVyZm9ybSBhY3Rpb24gaWYgTW91c2VFdmVudC5idXR0b24gaXMgMCBvciB1bmRlZmluZWQgKDA6IGxlZnQtYnV0dG9uKVxuXHRcdGlmICh0aGlzLmVuYWJsZWQgJiYgIWV2LmRlZmF1bHRQcmV2ZW50ZWQgJiYgIWV2LmJ1dHRvbikge1xuXHRcdFx0ZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQgPSAhdGhpcy5wbGF5YmFja1JlcXVlc3RlZDtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcGxheWJhY2tSZXF1ZXN0ZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEB0eXBlIHtCb29sZWFuP30gKi9cblx0X3BsYXliYWNrUmVxdWVzdGVkOiBudWxsLFxuXG5cdF9zZXRQbGF5YmFja1JlcXVlc3RlZDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHR0aGlzLl9wbGF5YmFja1JlcXVlc3RlZCA9IHZhbHVlO1xuXG5cdFx0dmFyIGNsYXNzTGlzdCA9IHRoaXMuY29udGVudC5jbGFzc0xpc3Q7XG5cdFx0Y2xhc3NMaXN0LnRvZ2dsZShcInBsYXlpbmdcIiwgdmFsdWUgPT09IHRydWUpO1xuXHRcdGNsYXNzTGlzdC50b2dnbGUoXCJwYXVzZWRcIiwgdmFsdWUgPT09IGZhbHNlKTtcblx0XHRjbGFzc0xpc3QudG9nZ2xlKFwicmVxdWVzdGVkXCIsIHZhbHVlID09PSB0cnVlIHx8IHZhbHVlID09PSBmYWxzZSk7XG5cblx0XHQvLyB0aGlzLl92YWxpZGF0ZVBsYXliYWNrKHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQpO1xuXHRcdC8vIGlmICh0aGlzLnBsYXliYWNrUmVxdWVzdGVkKSB7XG5cdFx0dGhpcy5fdmFsaWRhdGVQbGF5YmFjaygpO1xuXHRcdC8vIH0gZWxzZSB7XG5cdFx0Ly8gXHR0aGlzLnRvZ2dsZVBsYXliYWNrKGZhbHNlKTtcblx0XHQvLyB9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogdG9nZ2xlUGxheWJhY2tcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0b2dnbGVQbGF5YmFjazogZnVuY3Rpb24obmV3UGxheVN0YXRlKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJbc2Nyb2xsXSAlczo6dG9nZ2xlUGxheWJhY2sgWyVzIC0+ICVzXSAocmVxdWVzdGVkOiAlcylcIiwgdGhpcy5jaWQsXG5cdFx0Ly8gXHRcdCh0aGlzLl9pc01lZGlhUGF1c2VkKCk/IFwicGF1c2VcIiA6IFwicGxheVwiKSxcblx0XHQvLyBcdFx0KG5ld1BsYXlTdGF0ZT8gXCJwbGF5XCIgOiBcInBhdXNlXCIpLFxuXHRcdC8vIFx0XHR0aGlzLnBsYXliYWNrUmVxdWVzdGVkXG5cdFx0Ly8gXHQpO1xuXHRcdGlmIChfLmlzQm9vbGVhbihuZXdQbGF5U3RhdGUpICYmIG5ld1BsYXlTdGF0ZSAhPT0gdGhpcy5faXNNZWRpYVBhdXNlZCgpKSB7XG5cdFx0XHRyZXR1cm47IC8vIHJlcXVlc3RlZCBzdGF0ZSBpcyBjdXJyZW50LCBkbyBub3RoaW5nXG5cdFx0fSBlbHNlIHtcblx0XHRcdG5ld1BsYXlTdGF0ZSA9IHRoaXMuX2lzTWVkaWFQYXVzZWQoKTtcblx0XHR9XG5cdFx0aWYgKG5ld1BsYXlTdGF0ZSkgeyAvLyBjaGFuZ2luZyB0byB3aGF0P1xuXHRcdFx0dGhpcy5fcGxheU1lZGlhKCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX3BhdXNlTWVkaWEoKTtcblx0XHR9XG5cdH0sXG5cblx0X2NhblJlc3VtZVBsYXliYWNrOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gISEoXG5cdFx0XHR0aGlzLmVuYWJsZWQgJiZcblx0XHRcdHRoaXMubW9kZWwuc2VsZWN0ZWQgJiZcblx0XHRcdHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQgJiZcblx0XHRcdCh0aGlzLm1lZGlhU3RhdGUgPT09IFwicmVhZHlcIikgJiZcblx0XHRcdHRoaXMuYXR0YWNoZWQgJiZcblx0XHRcdCh0aGlzLnBhcmVudFZpZXcgIT09IG51bGwpICYmXG5cdFx0XHQoIXRoaXMucGFyZW50Vmlldy5zY3JvbGxpbmcpICYmXG5cdFx0XHQoZG9jdW1lbnRbdmlzaWJpbGl0eVN0YXRlUHJvcF0gIT0gXCJoaWRkZW5cIilcblx0XHQpO1xuXHR9LFxuXG5cdF92YWxpZGF0ZVBsYXliYWNrOiBmdW5jdGlvbihzaG9ydGNpcmN1aXQpIHtcblx0XHQvLyBhICdzaG9ydGNpcmN1aXQnIGJvb2xlYW4gYXJndW1lbnQgY2FuIGJlIHBhc3NlZCwgYW5kIGlmIGZhbHNlLFxuXHRcdC8vIHNraXAgX2NhblJlc3VtZVBsYXliYWNrIGFuZCBwYXVzZSBwbGF5YmFjayByaWdodCBhd2F5XG5cdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggIT0gMCAmJiAhc2hvcnRjaXJjdWl0KSB7XG5cdFx0XHR0aGlzLnRvZ2dsZVBsYXliYWNrKGZhbHNlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50b2dnbGVQbGF5YmFjayh0aGlzLl9jYW5SZXN1bWVQbGF5YmFjaygpKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogYWJzdHJhY3Rcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2lzTWVkaWFQYXVzZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUud2FybihcIiVzOjpfaXNNZWRpYVBhdXNlZCBOb3QgaW1wbGVtZW50ZWRcIiwgdGhpcy5jaWQpO1xuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXG5cdF9wbGF5TWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUud2FybihcIiVzOjpfcGxheU1lZGlhIE5vdCBpbXBsZW1lbnRlZFwiLCB0aGlzLmNpZCk7XG5cdH0sXG5cblx0X3BhdXNlTWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUud2FybihcIiVzOjpfcGF1c2VNZWRpYSBOb3QgaW1wbGVtZW50ZWRcIiwgdGhpcy5jaWQpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHV0aWxcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0dXBkYXRlT3ZlcmxheTogZnVuY3Rpb24obWVkaWFFbCwgdGFyZ2V0RWwsIHJlY3RFbCkge1xuXHRcdC8vIC8vIHRoaXMgbWV0aG9kIGlzIG5vdCBjcml0aWNhbCwganVzdCBjYXRjaCBhbmQgbG9nIGFsbCBlcnJvcnNcblx0XHQvLyB0cnkge1xuXHRcdC8vIFx0dGhpcy5fdXBkYXRlT3ZlcmxheShtZWRpYUVsLCB0YXJnZXRFbCwgcmVjdEVsKVxuXHRcdC8vIH0gY2F0Y2ggKGVycikge1xuXHRcdC8vIFx0Y29uc29sZS5lcnJvcihcIiVzOjp1cGRhdGVPdmVybGF5XCIsIHRoaXMuY2lkLCBlcnIpO1xuXHRcdC8vIH1cblx0fSxcblxuXHRfZHJhd01lZGlhRWxlbWVudDogZnVuY3Rpb24oY29udGV4dCwgbWVkaWFFbCwgZGVzdCkge1xuXHRcdC8vIGRlc3RpbmF0aW9uIHJlY3Rcblx0XHQvLyBOT1RFOiBtZWRpYUVsIGlzIGV4cGVjdGVkIHRvIGhhdmUgdGhlIHNhbWUgZGltZW5zaW9ucyBpbiB0aGlzLm1ldHJpY3MubWVkaWFcblx0XHRtZWRpYUVsIHx8IChtZWRpYUVsID0gdGhpcy5kZWZhdWx0SW1hZ2UpO1xuXHRcdGRlc3QgfHwgKGRlc3QgPSB7XG5cdFx0XHR4OiAwLFxuXHRcdFx0eTogMCxcblx0XHRcdHdpZHRoOiB0aGlzLm1ldHJpY3MubWVkaWEud2lkdGgsXG5cdFx0XHRoZWlnaHQ6IHRoaXMubWV0cmljcy5tZWRpYS5oZWlnaHRcblx0XHR9KTtcblxuXHRcdC8vIG5hdGl2ZS9kaXNwbGF5IHNjYWxlXG5cdFx0dmFyIHNXID0gdGhpcy5tb2RlbC5nZXQoXCJzb3VyY2VcIikuZ2V0KFwid1wiKSxcblx0XHRcdHNIID0gdGhpcy5tb2RlbC5nZXQoXCJzb3VyY2VcIikuZ2V0KFwiaFwiKSxcblx0XHRcdHJzWCA9IHNXIC8gdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoLFxuXHRcdFx0cnNZID0gc0ggLyB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0O1xuXG5cdFx0Ly8gZGVzdCwgc2NhbGVkIHRvIG5hdGl2ZVxuXHRcdHZhciBzcmMgPSB7XG5cdFx0XHR4OiBNYXRoLm1heCgwLCBkZXN0LnggKiByc1gpLFxuXHRcdFx0eTogTWF0aC5tYXgoMCwgZGVzdC55ICogcnNZKSxcblx0XHRcdHdpZHRoOiBNYXRoLm1pbihzVywgZGVzdC53aWR0aCAqIHJzWCksXG5cdFx0XHRoZWlnaHQ6IE1hdGgubWluKHNILCBkZXN0LmhlaWdodCAqIHJzWSlcblx0XHR9O1xuXG5cdFx0Ly8gcmVzaXplIGNhbnZhc1xuXHRcdC8vIHZhciBjYW52YXMgPSBjb250ZXh0LmNhbnZhcztcblx0XHQvLyBpZiAoY2FudmFzLndpZHRoICE9PSBkZXN0LndpZHRoIHx8IGNhbnZhcy5oZWlnaHQgIT09IGRlc3QuaGVpZ2h0KSB7XG5cdFx0Ly8gXHRjYW52YXMud2lkdGggPSBkZXN0LndpZHRoO1xuXHRcdC8vIFx0Y2FudmFzLmhlaWdodCA9IGRlc3QuaGVpZ2h0O1xuXHRcdC8vIH1cblx0XHRjb250ZXh0LmNhbnZhcy53aWR0aCA9IGRlc3Qud2lkdGg7XG5cdFx0Y29udGV4dC5jYW52YXMuaGVpZ2h0ID0gZGVzdC5oZWlnaHQ7XG5cblx0XHQvLyBjb3B5IGltYWdlIHRvIGNhbnZhc1xuXHRcdGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGRlc3Qud2lkdGgsIGRlc3QuaGVpZ2h0KTtcblx0XHRjb250ZXh0LmRyYXdJbWFnZShtZWRpYUVsLFxuXHRcdFx0c3JjLngsIHNyYy55LCBzcmMud2lkdGgsIHNyYy5oZWlnaHQsXG5cdFx0XHQwLCAwLCBkZXN0LndpZHRoLCBkZXN0LmhlaWdodCAvLyBkZXN0aW5hdGlvbiByZWN0XG5cdFx0KTtcblxuXHRcdHJldHVybiBjb250ZXh0O1xuXHR9LFxuXG5cdC8qXG5cdF91cGRhdGVPdmVybGF5OiBmdW5jdGlvbihtZWRpYUVsLCB0YXJnZXRFbCwgcmVjdEVsKSB7XG5cdFx0Ly8gc3JjL2Rlc3QgcmVjdHNcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRyZWN0RWwgfHwgKHJlY3RFbCA9IHRhcmdldEVsKTtcblxuXHRcdC8vIE5PVEU6IGRvZXMgbm90IHdvcmsgd2l0aCBzdmcgZWxlbWVudFxuXHRcdC8vIHZhciB0UmVjdCA9IHJlY3RFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHQvLyB2YXIgY1JlY3QgPSBtZWRpYUVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdC8vIHZhciB0WCA9IHRSZWN0LnggLSBjUmVjdC54LFxuXHRcdC8vIFx0dFkgPSB0UmVjdC55IC0gY1JlY3QueSxcblx0XHQvLyBcdHRXID0gdFJlY3Qud2lkdGgsXG5cdFx0Ly8gXHR0SCA9IHRSZWN0LmhlaWdodDtcblxuXHRcdC8vIHRhcmdldCBib3VuZHNcblx0XHR2YXIgdFggPSByZWN0RWwub2Zmc2V0TGVmdCxcblx0XHRcdHRZID0gcmVjdEVsLm9mZnNldFRvcCxcblx0XHRcdHRXID0gcmVjdEVsLm9mZnNldFdpZHRoLFxuXHRcdFx0dEggPSByZWN0RWwub2Zmc2V0SGVpZ2h0O1xuXG5cdFx0aWYgKHRYID09PSB2b2lkIDAgfHwgdFkgPT09IHZvaWQgMCB8fCB0VyA9PT0gdm9pZCAwIHx8IHRIID09PSB2b2lkIDApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBkZXN0aW5hdGlvbiByZWN0XG5cdFx0dmFyIFJFQ1RfR1JPVyA9IDIwO1xuXHRcdHZhciBkZXN0ID0ge1xuXHRcdFx0eDogdFggLSBSRUNUX0dST1csXG5cdFx0XHR5OiB0WSAtIFJFQ1RfR1JPVyxcblx0XHRcdHdpZHRoOiB0VyArIFJFQ1RfR1JPVyAqIDIsXG5cdFx0XHRoZWlnaHQ6IHRIICsgUkVDVF9HUk9XICogMlxuXHRcdH07XG5cblx0XHQvLyBuYXRpdmUvZGlzcGxheSBzY2FsZVxuXHRcdHZhciBzVyA9IHRoaXMubW9kZWwuZ2V0KFwid1wiKSxcblx0XHRcdHNIID0gdGhpcy5tb2RlbC5nZXQoXCJoXCIpLFxuXHRcdFx0cnNYID0gc1cvdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoLFxuXHRcdFx0cnNZID0gc0gvdGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodDtcblxuXHRcdC8vIGRlc3QsIHNjYWxlZCB0byBuYXRpdmVcblx0XHR2YXIgc3JjID0ge1xuXHRcdFx0eDogTWF0aC5tYXgoMCwgZGVzdC54ICogcnNYKSxcblx0XHRcdHk6IE1hdGgubWF4KDAsIGRlc3QueSAqIHJzWSksXG5cdFx0XHR3aWR0aDogTWF0aC5taW4oc1csIGRlc3Qud2lkdGggKiByc1gpLFxuXHRcdFx0aGVpZ2h0OiBNYXRoLm1pbihzSCwgZGVzdC5oZWlnaHQgKiByc1kpXG5cdFx0fTtcblxuXHRcdC8vIENvcHkgaW1hZ2UgdG8gY2FudmFzXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIGNhbnZhcywgY29udGV4dCwgaW1hZ2VEYXRhO1xuXG5cdFx0Ly8gY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcblx0XHQvLyBjYW52YXMuc3R5bGUud2lkdGggID0gZGVzdC53aWR0aCArIFwicHhcIjtcblx0XHQvLyBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gZGVzdC5oZWlnaHQgKyBcInB4XCI7XG5cblx0XHRjYW52YXMgPSBnZXRTaGFyZWRDYW52YXMoKTtcblx0XHRpZiAoY2FudmFzLndpZHRoICE9PSBkZXN0LndpZHRoIHx8IGNhbnZhcy5oZWlnaHQgIT09IGRlc3QuaGVpZ2h0KSB7XG5cdFx0XHRjYW52YXMud2lkdGggPSBkZXN0LndpZHRoO1xuXHRcdFx0Y2FudmFzLmhlaWdodCA9IGRlc3QuaGVpZ2h0O1xuXHRcdH1cblx0XHRjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblx0XHRjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBkZXN0LndpZHRoLCBkZXN0LmhlaWdodCk7XG5cdFx0Y29udGV4dC5kcmF3SW1hZ2UobWVkaWFFbCxcblx0XHRcdHNyYy54LCBzcmMueSwgc3JjLndpZHRoLCBzcmMuaGVpZ2h0LFxuXHRcdFx0MCwgMCwgZGVzdC53aWR0aCwgZGVzdC5oZWlnaHQgLy8gZGVzdGluYXRpb24gcmVjdFxuXHRcdCk7XG5cdFx0aW1hZ2VEYXRhID0gY29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgZGVzdC53aWR0aCwgZGVzdC5oZWlnaHQpO1xuXG5cdFx0dmFyIGF2Z0NvbG9yID0gQ29sb3IoKS5yZ2IoZ2V0QXZlcmFnZVJHQihpbWFnZURhdGEpKTtcblx0XHQvLyB2YXIgYXZnSGV4ID0gYXZnQ29sb3IuaGV4U3RyaW5nKCksIGVscyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcImltZywgdmlkZW9cIik7XG5cdFx0Ly8gZm9yICh2YXIgaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspIHtcblx0XHQvLyBcdGVscy5pdGVtKGkpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGF2Z0hleDtcblx0XHQvLyB9XG5cblx0XHR0YXJnZXRFbC5jbGFzc0xpc3QudG9nZ2xlKFwib3Zlci1kYXJrXCIsIGF2Z0NvbG9yLmRhcmsoKSk7XG5cblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp1cGRhdGVPdmVybGF5KCkgYXZnQ29sb3I6JXMgKCVzKVwiLCB0aGlzLmNpZCwgYXZnQ29sb3IucmdiU3RyaW5nKCksIGF2Z0NvbG9yLmRhcmsoKT9cImRhcmtcIjpcImxpZ2h0XCIsIHRhcmdldEVsKTtcblxuXHRcdC8vIENvbG9yLCBmaWx0ZXIgb3B0c1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0Ly8gdGhpcy5mZ0NvbG9yIHx8ICh0aGlzLmZnQ29sb3IgPSBuZXcgQ29sb3IodGhpcy5tb2RlbC5hdHRyKFwiY29sb3JcIikpKTtcblx0XHQvLyB0aGlzLmJnQ29sb3IgfHwgKHRoaXMuYmdDb2xvciA9IG5ldyBDb2xvcih0aGlzLm1vZGVsLmF0dHIoXCJiYWNrZ3JvdW5kLWNvbG9yXCIpKSk7XG5cdFx0Ly9cblx0XHQvLyB2YXIgb3B0cyA9IHsgcmFkaXVzOiAyMCB9O1xuXHRcdC8vIHZhciBpc0ZnRGFyayA9IHRoaXMuZmdDb2xvci5sdW1pbm9zaXR5KCkgPCB0aGlzLmJnQ29sb3IubHVtaW5vc2l0eSgpO1xuXHRcdC8vIG9wdHMueDAwID0gaXNGZ0Rhcms/IHRoaXMuZmdDb2xvci5jbG9uZSgpLmxpZ2h0ZW4oMC41KSA6IHRoaXMuYmdDb2xvci5jbG9uZSgpLmRhcmtlbigwLjUpO1xuXHRcdC8vIG9wdHMueEZGID0gaXNGZ0Rhcms/IHRoaXMuYmdDb2xvci5jbG9uZSgpLmxpZ2h0ZW4oMC41KSA6IHRoaXMuZmdDb2xvci5jbG9uZSgpLmRhcmtlbigwLjUpO1xuXHRcdC8vXG5cdFx0Ly8gc3RhY2tCbHVyTW9ubyhpbWFnZURhdGEsIG9wdHMpO1xuXHRcdC8vIGR1b3RvbmUoaW1hZ2VEYXRhLCBvcHRzKTtcblx0XHQvLyBzdGFja0JsdXJSR0IoaW1hZ2VEYXRhLCB7IHJhZGl1czogMjAgfSk7XG5cdFx0Ly9cblx0XHQvLyBjb250ZXh0LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApO1xuXHRcdC8vIHRhcmdldEVsLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgY2FudmFzLnRvRGF0YVVSTCgpICsgXCIpXCI7XG5cdH0qL1xufSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogR29vZ2xlIEFuYWx5dGljc1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5pZiAoR0EpIHtcblx0UGxheWFibGVSZW5kZXJlciA9IChmdW5jdGlvbihQbGF5YWJsZVJlbmRlcmVyKSB7XG5cblx0XHQvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZ3MvZGFzaGVyaXplfSAqL1xuXHRcdHZhciBkYXNoZXJpemUgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvZGFzaGVyaXplXCIpO1xuXG5cdFx0Ly8gdmFyIHJlYWR5RXZlbnRzID0gW1wicGxheWluZ1wiLCBcIndhaXRpbmdcIiwgXCJlbmRlZFwiXTtcblx0XHQvLyB2YXIgdXNlckV2ZW50cyA9IFtcInBsYXlcIiwgXCJwYXVzZVwiXTtcblxuXG5cdFx0cmV0dXJuIFBsYXlhYmxlUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciByZXR2YWwgPSBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdHRoaXMuX3BsYXliYWNrUmVxdWVzdGVkRGVmYXVsdCA9IHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQ7XG5cdFx0XHRcdHJldHVybiByZXR2YWw7XG5cdFx0XHR9LFxuXG5cdFx0XHRfb25QbGF5YmFja1RvZ2dsZTogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0dmFyIHJldHZhbCA9IFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLl9vblBsYXliYWNrVG9nZ2xlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdHZhciBvID0ge1xuXHRcdFx0XHRcdGhpdFR5cGU6IFwiZXZlbnRcIixcblx0XHRcdFx0XHRldmVudENhdGVnb3J5OiBkYXNoZXJpemUodGhpcy5jaWRQcmVmaXgpLFxuXHRcdFx0XHRcdGV2ZW50QWN0aW9uOiB0aGlzLnBsYXliYWNrUmVxdWVzdGVkID8gXCJwbGF5XCIgOiBcInBhdXNlXCIsXG5cdFx0XHRcdFx0ZXZlbnRMYWJlbDogdGhpcy5tb2RlbC5nZXQoXCJ0ZXh0XCIpLFxuXHRcdFx0XHR9O1xuXHRcdFx0XHRpZiAodGhpcy5fcGxheWJhY2tSZXF1ZXN0ZWREZWZhdWx0KVxuXHRcdFx0XHRcdG8uZXZlbnRBY3Rpb24gKz0gXCItYXV0b3BsYXlcIjtcblx0XHRcdFx0d2luZG93LmdhKFwic2VuZFwiLCBvKTtcblx0XHRcdFx0cmV0dXJuIHJldHZhbDtcblx0XHRcdH0sXG5cblx0XHRcdC8vIC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdC8vIHRvZ2dsZVBsYXliYWNrOiBmdW5jdGlvbihuZXdQbGF5U3RhdGUpIHtcblx0XHRcdC8vIFx0dmFyIHJldHZhbCA9IFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLnRvZ2dsZVBsYXliYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHQvLyBcdHdpbmRvdy5nYShcInNlbmRcIiwge1xuXHRcdFx0Ly8gXHRcdGhpdFR5cGU6IFwiZXZlbnRcIixcblx0XHRcdC8vIFx0XHRldmVudENhdGVnb3J5OiBcIlBsYXlhYmxlXCIsXG5cdFx0XHQvLyBcdFx0ZXZlbnRBY3Rpb246IHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQgPyBcInBsYXlcIiA6IFwicGF1c2VcIixcblx0XHRcdC8vIFx0XHRldmVudExhYmVsOiB0aGlzLm1vZGVsLmdldChcInRleHRcIiksXG5cdFx0XHQvLyBcdH0pO1xuXHRcdFx0Ly8gXHRyZXR1cm4gcmV0dmFsO1xuXHRcdFx0Ly8gfSxcblx0XHR9KTtcblx0fSkoUGxheWFibGVSZW5kZXJlcik7XG59XG5cbi8vIGlmIChERUJVRykge1xuLy9cbi8vIFBsYXlhYmxlUmVuZGVyZXIgPSAoZnVuY3Rpb24oUGxheWFibGVSZW5kZXJlcikge1xuLy8gXHRpZiAoIVBsYXlhYmxlUmVuZGVyZXIuTE9HX1RPX1NDUkVFTikgcmV0dXJuIFBsYXlhYmxlUmVuZGVyZXI7XG4vL1xuLy8gXHQvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZ3MvbHBhZH0gKi9cbi8vIFx0dmFyIGxwYWQgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvbHBhZFwiKTtcbi8vXG4vLyBcdHJldHVybiBQbGF5YWJsZVJlbmRlcmVyLmV4dGVuZCh7XG4vLyBcdFx0X2NhblJlc3VtZVBsYXliYWNrOiBmdW5jdGlvbigpIHtcbi8vIFx0XHRcdHZhciByZXR2YWwgPSBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5fY2FuUmVzdW1lUGxheWJhY2suYXBwbHkodGhpcy5hcmd1bWVudHMpO1xuLy8gXHRcdFx0Y29uc29sZS5sb2coXCJbc2Nyb2xsXSAlczo6X2NhblJlc3VtZVBsYXliYWNrKCk6JXNcIiwgdGhpcy5jaWQsIHJldHZhbCxcbi8vIFx0XHRcdHtcbi8vIFx0XHRcdFx0XCJlbmFibGVkXCI6IHRoaXMuZW5hYmxlZCxcbi8vIFx0XHRcdFx0XCJzZWxlY3RlZFwiOiAoISF0aGlzLm1vZGVsLnNlbGVjdGVkKSxcbi8vIFx0XHRcdFx0XCJwbGF5YmFja1JlcXVlc3RlZFwiOiB0aGlzLnBsYXliYWNrUmVxdWVzdGVkLFxuLy8gXHRcdFx0XHRcImF0dGFjaGVkXCI6IHRoaXMuYXR0YWNoZWQsXG4vLyBcdFx0XHRcdFwicGFyZW50Vmlld1wiOiAodGhpcy5wYXJlbnRWaWV3ICYmIHRoaXMucGFyZW50Vmlldy5jaWQpLFxuLy8gXHRcdFx0XHRcIiFzY3JvbGxpbmdcIjogKHRoaXMucGFyZW50VmlldyAmJiAhdGhpcy5wYXJlbnRWaWV3LnNjcm9sbGluZyksXG4vLyBcdFx0XHRcdFwibWVkaWFTdGF0ZVwiOiB0aGlzLm1lZGlhU3RhdGUsXG4vLyBcdFx0XHRcdC8vIFwiIWRvY3VtZW50LmhpZGRlblwiOiAhZG9jdW1lbnRbdmlzaWJpbGl0eUhpZGRlblByb3BdLFxuLy8gXHRcdFx0XHRcInZpc2liaWxpdHlTdGF0ZVwiOiBkb2N1bWVudFt2aXNpYmlsaXR5U3RhdGVQcm9wXVxuLy8gXHRcdFx0fSk7XG4vLyBcdFx0XHRyZXR1cm4gcmV0dmFsO1xuLy8gXHRcdH0sXG4vLyBcdH0pO1xuLy8gfSkoUGxheWFibGVSZW5kZXJlcik7XG4vL1xuLy8gfVxuXG5tb2R1bGUuZXhwb3J0cyA9IFBsYXlhYmxlUmVuZGVyZXI7IiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcImNvbXBpbGVyXCI6WzcsXCI+PSA0LjAuMFwiXSxcIm1haW5cIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBoZWxwZXIsIGFsaWFzMT1kZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LCBhbGlhczI9aGVscGVycy5oZWxwZXJNaXNzaW5nLCBhbGlhczM9XCJmdW5jdGlvblwiLCBhbGlhczQ9Y29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb247XG5cbiAgcmV0dXJuIFwiPGRpdiBjbGFzcz1cXFwicGxhY2Vob2xkZXIgc2l6aW5nXFxcIj48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJjb250ZW50XFxcIj5cXG5cdDxkaXYgY2xhc3M9XFxcIm1lZGlhLWJvcmRlciBjb250ZW50LXNpemVcXFwiPjwvZGl2Plxcblx0PGRpdiBjbGFzcz1cXFwiY29udHJvbHMgY29udGVudC1zaXplXFxcIj5cXG5cdFx0PGNhbnZhcyBjbGFzcz1cXFwicHJvZ3Jlc3MtbWV0ZXJcXFwiPjwvY2FudmFzPlxcblx0PC9kaXY+XFxuXHQ8ZGl2IGNsYXNzPVxcXCJzZXF1ZW5jZSBtZWRpYS1zaXplXFxcIj5cXG5cdFx0PGltZyBjbGFzcz1cXFwic2VxdWVuY2Utc3RlcCBjdXJyZW50IGRlZmF1bHRcXFwiIGFsdD1cXFwiXCJcbiAgICArIGFsaWFzNCgoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLnRleHQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLnRleHQgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcInRleHRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiXFxcIiBsb25nZGVzYz1cXFwiI2Rlc2NfbVwiXG4gICAgKyBhbGlhczQoKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5pZCB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuaWQgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcImlkXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIlxcXCIgLz5cXG5cdDwvZGl2Plxcblx0PGRpdiBjbGFzcz1cXFwib3ZlcmxheSBtZWRpYS1zaXplXFxcIj5cXG5cdFx0PGRpdiBjbGFzcz1cXFwicGxheS10b2dnbGUtaGl0YXJlYSBwbGF5LXRvZ2dsZVxcXCI+XFxuXHRcdDwvZGl2Plxcblx0PC9kaXY+XFxuPC9kaXY+XFxuXCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlclxuICovXG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG4vKiBJbXBvcnRzXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lLmJhYnlzaXR0ZXJ9ICovXG52YXIgQ29udGFpbmVyID0gcmVxdWlyZShcImJhY2tib25lLmJhYnlzaXR0ZXJcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9QbGF5YWJsZVJlbmRlcmVyfSAqL1xudmFyIFBsYXlhYmxlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL1BsYXlhYmxlUmVuZGVyZXJcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb259ICovXG4vLyB2YXIgU2VsZWN0YWJsZUNvbGxlY3Rpb24gPSByZXF1aXJlKFwiYXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9uXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyfSAqL1xudmFyIFByb2dyZXNzTWV0ZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL1RpbWVyfSAqL1xudmFyIFRpbWVyID0gcmVxdWlyZShcInV0aWxzL1RpbWVyXCIpO1xuLy8gLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbi8vIHZhciB0cmFuc2l0aW9uRW5kID0gcmVxdWlyZShcInV0aWxzL2V2ZW50L3RyYW5zaXRpb25FbmRcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFByb3BlcnR5fSAqL1xuLy8gdmFyIHByZWZpeGVkID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkUHJvcGVydHlcIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgX3doZW5JbWFnZUxvYWRzID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2UvX3doZW5JbWFnZUxvYWRzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS9fbG9hZEltYWdlQXNPYmplY3RVUkx9ICovXG52YXIgX2xvYWRJbWFnZUFzT2JqZWN0VVJMID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2UvX2xvYWRJbWFnZUFzT2JqZWN0VVJMXCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciB3aGVuU2VsZWN0aW9uRGlzdGFuY2VJcyA9IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3Rpb25EaXN0YW5jZUlzXCIpO1xuLy8gdmFyIHdoZW5TZWxlY3RUcmFuc2l0aW9uRW5kcyA9IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3RUcmFuc2l0aW9uRW5kc1wiKTtcbi8vIHZhciB3aGVuRGVmYXVsdEltYWdlTG9hZHMgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuRGVmYXVsdEltYWdlTG9hZHNcIik7XG5cbi8vIC8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG4vLyB2YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG4vLyB2YXIgZHVvdG9uZSA9IHJlcXVpcmUoXCJ1dGlscy9jYW52YXMvYml0bWFwL2R1b3RvbmVcIik7XG4vLyB2YXIgc3RhY2tCbHVyUkdCID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9iaXRtYXAvc3RhY2tCbHVyUkdCXCIpO1xuLy8gdmFyIHN0YWNrQmx1ck1vbm8gPSByZXF1aXJlKFwidXRpbHMvY2FudmFzL2JpdG1hcC9zdGFja0JsdXJNb25vXCIpO1xuLy8gdmFyIGdldEF2ZXJhZ2VSR0JBID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9iaXRtYXAvZ2V0QXZlcmFnZVJHQkFcIik7XG5cbnZhciBlcnJvclRlbXBsYXRlID0gcmVxdWlyZShcIi4uL3RlbXBsYXRlL0Vycm9yQmxvY2suaGJzXCIpO1xuXG52YXIgTUlOX1NURVBfSU5URVJWQUwgPSAyICogR2xvYmFscy5UUkFOU0lUSU9OX0RVUkFUSU9OICsgR2xvYmFscy5UUkFOU0lUSU9OX0RFTEFZX0lOVEVSVkFMO1xudmFyIERFRkFVTFRfU1RFUF9JTlRFUlZBTCA9IDYgKiBHbG9iYWxzLlRSQU5TSVRJT05fRFVSQVRJT04gKyBHbG9iYWxzLlRSQU5TSVRJT05fREVMQVlfSU5URVJWQUw7XG5cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcbi8qIFByaXZhdGUgY2xhc3Nlc1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIC8qKlxuLy8gKiBAY29uc3RydWN0b3Jcbi8vICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlci5Tb3VyY2VDb2xsZWN0aW9ufVxuLy8gKi9cbi8vIHZhciBTb3VyY2VDb2xsZWN0aW9uID0gU2VsZWN0YWJsZUNvbGxlY3Rpb24uZXh0ZW5kKHtcbi8vIFx0bW9kZWw6IEJhY2tib25lLk1vZGVsXG4vLyB9KTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1NlcXVlbmNlUmVuZGVyZXIuUHJlZmV0ZWNoZWRTb3VyY2VSZW5kZXJlcn1cbiAqL1xudmFyIFByZWZldGVjaGVkU291cmNlUmVuZGVyZXIgPSBWaWV3LmV4dGVuZCh7XG5cblx0Y2lkUHJlZml4OiBcInNlcXVlbmNlU3RlcFJlbmRlcmVyXCIsXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjbGFzc05hbWU6IFwic2VxdWVuY2Utc3RlcFwiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0dGFnTmFtZTogXCJpbWdcIixcblxuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0cmVhZHk6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9yZWFkeTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0IXRoaXMuZWwuaGFzQXR0cmlidXRlKFwiYWx0XCIpICYmIHRoaXMuZWwuc2V0QXR0cmlidXRlKFwiYWx0XCIsIHRoaXMubW9kZWwuZ2V0KFwic3JjXCIpKTtcblx0XHQvLyB0aGlzLmVsLnNldEF0dHJpYnV0ZShcImxvbmdkZXNjXCIsIHRoaXMubW9kZWwuZ2V0KFwib3JpZ2luYWxcIikpO1xuXG5cdFx0aWYgKHRoaXMubW9kZWwuaGFzKFwicHJlZmV0Y2hlZFwiKSkge1xuXHRcdFx0dGhpcy5fcmVuZGVyUHJlZmV0Y2hlZCgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlOnByZWZldGNoZWRcIiwgdGhpcy5fcmVuZGVyUHJlZmV0Y2hlZCk7XG5cdFx0fVxuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJzZWxlY3RlZCBkZXNlbGVjdGVkXCIsIHRoaXMuX3JlbmRlclNlbGVjdGlvbik7XG5cdFx0dGhpcy5fcmVuZGVyU2VsZWN0aW9uKCk7XG5cdH0sXG5cblx0X3JlbmRlclNlbGVjdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCAhIXRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHR9LFxuXG5cdF9yZW5kZXJQcmVmZXRjaGVkOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgcHJlZmV0Y2hlZCA9IHRoaXMubW9kZWwuZ2V0KFwicHJlZmV0Y2hlZFwiKTtcblx0XHRpZiAocHJlZmV0Y2hlZCAhPT0gdGhpcy5lbC5zcmMpIHtcblx0XHRcdHRoaXMuZWwuc3JjID0gcHJlZmV0Y2hlZDtcblx0XHR9XG5cdFx0X3doZW5JbWFnZUxvYWRzKHRoaXMuZWwpLnRoZW4oXG5cdFx0XHRmdW5jdGlvbihlbCkge1xuXHRcdFx0XHR0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbih0c3RhbXApIHtcblx0XHRcdFx0XHR0aGlzLl9zZXRSZWFkeSh0cnVlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9LmJpbmQodGhpcyksXG5cdFx0XHRmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0Ly8gdGhpcy5fc2V0UmVhZHkoZmFsc2UpO1xuXHRcdFx0XHQoZXJyIGluc3RhbmNlb2YgRXJyb3IpIHx8IChlcnIgPSBuZXcgRXJyb3IoXCJjYW5ub3QgbG9hZCBwcmVmZXRjaGVkIHVybFwiKSk7XG5cdFx0XHRcdHRocm93IGVycjtcblx0XHRcdH0uYmluZCh0aGlzKVxuXHRcdCk7XG5cdH0sXG5cblx0LyoqIEB0eXBlIHtib29sZWFufSAqL1xuXHRfcmVhZHk6IGZhbHNlLFxuXG5cdF9zZXRSZWFkeTogZnVuY3Rpb24ocmVhZHkpIHtcblx0XHRpZiAodGhpcy5fcmVhZHkgPT09IHJlYWR5KSByZXR1cm47XG5cdFx0dGhpcy5fcmVhZHkgPSAhIShyZWFkeSk7IC8vIG1ha2UgYm9vbFxuXHRcdHRoaXMudHJpZ2dlcihcInJlbmRlcmVyOnJlYWR5XCIsIHRoaXMpO1xuXHR9LFxuXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gaWYgKHRoaXMubW9kZWwuaGFzKFwicHJlZmV0Y2hlZFwiKSkge1xuXHRcdC8vIFx0dGhpcy5fcmVuZGVyUHJlZmV0Y2hlZCgpO1xuXHRcdC8vIH1cblx0XHQvLyB0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjdXJyZW50XCIsICEhdGhpcy5tb2RlbC5zZWxlY3RlZCk7XG5cdFx0Y29uc29sZS5sb2coXCIlczo6cmVuZGVyXCIsIHRoaXMuY2lkKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcbn0pO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlci5TaW1wbGVTb3VyY2VSZW5kZXJlcn1cbiAqL1xuLy8gdmFyIFNpbXBsZVNvdXJjZVJlbmRlcmVyID0gVmlldy5leHRlbmQoe1xuLy9cbi8vIFx0Y2lkUHJlZml4OiBcInNlcXVlbmNlU3RlcFJlbmRlcmVyXCIsXG4vLyBcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuLy8gXHRjbGFzc05hbWU6IFwic2VxdWVuY2Utc3RlcFwiLFxuLy8gXHQvKiogQHR5cGUge3N0cmluZ30gKi9cbi8vIFx0dGFnTmFtZTogXCJpbWdcIixcbi8vXG4vLyBcdC8qKiBAb3ZlcnJpZGUgKi9cbi8vIFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbi8vIFx0XHQvLyB0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjdXJyZW50XCIsIHRoaXMubW9kZWwuaGFzT3duUHJvcGVydHkoXCJzZWxlY3RlZFwiKSk7XG4vLyBcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCAhIXRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuLy8gXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwge1xuLy8gXHRcdFx0XCJzZWxlY3RlZFwiOiBmdW5jdGlvbiAoKSB7XG4vLyBcdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcImN1cnJlbnRcIik7XG4vLyBcdFx0XHR9LFxuLy8gXHRcdFx0XCJkZXNlbGVjdGVkXCI6IGZ1bmN0aW9uICgpIHtcbi8vIFx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY3VycmVudFwiKTtcbi8vIFx0XHRcdH1cbi8vIFx0XHR9KTtcbi8vIFx0XHRpZiAodGhpcy5lbC5zcmMgPT09IFwiXCIpIHtcbi8vIFx0XHRcdHRoaXMuZWwuc3JjID0gR2xvYmFscy5NRURJQV9ESVIgKyBcIi9cIiArIHRoaXMubW9kZWwuZ2V0KFwic3JjXCIpO1xuLy8gXHRcdH1cbi8vXG4vLyBcdFx0aWYgKHRoaXMubW9kZWwuaGFzKFwiZXJyb3JcIikpIHtcbi8vIFx0XHRcdHRoaXMuX29uTW9kZWxFcnJvcigpO1xuLy8gXHRcdH0gZWxzZSB7XG4vLyBcdFx0XHR0aGlzLmxpc3RlblRvT25jZSh0aGlzLm1vZGVsLCBcImNoYW5nZTplcnJvclwiLCB0aGlzLl9vbk1vZGVsRXJyb3IpO1xuLy8gXHRcdFx0Ly8gdGhpcy5saXN0ZW5Ub09uY2UodGhpcy5tb2RlbCwge1xuLy8gXHRcdFx0Ly8gXHRcImNoYW5nZTpzb3VyY2VcIjogdGhpcy5fb25Nb2RlbFNvdXJjZSxcbi8vIFx0XHRcdC8vIFx0XCJjaGFuZ2U6ZXJyb3JcIjogdGhpcy5fb25Nb2RlbEVycm9yLFxuLy8gXHRcdFx0Ly8gfSk7XG4vLyBcdFx0fVxuLy8gXHR9LFxuLy9cbi8vIFx0Ly8gX29uTW9kZWxTb3VyY2U6IGZ1bmN0aW9uKCkge1xuLy8gXHQvLyBcdHRoaXMuZWwuc3JjID0gR2xvYmFscy5NRURJQV9ESVIgKyBcIi9cIiArIHRoaXMubW9kZWwuZ2V0KFwic3JjXCIpO1xuLy8gXHQvLyBcdC8vIGNvbnNvbGUubG9nKFwiJXM6OmNoYW5nZTpzcmNcIiwgdGhpcy5jaWQsIHRoaXMubW9kZWwuZ2V0KFwic3JjXCIpKTtcbi8vIFx0Ly8gfSxcbi8vXG4vLyBcdF9vbk1vZGVsRXJyb3I6IGZ1bmN0aW9uKCkge1xuLy8gXHRcdHZhciBlcnIgPSB0aGlzLm1vZGVsLmdldChcImVycm9yXCIpO1xuLy8gXHRcdHZhciBlcnJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4vLyBcdFx0ZXJyRWwuY2xhc3NOYW1lID0gXCJlcnJvciBjb2xvci1iZ1wiICsgKHRoaXMubW9kZWwuc2VsZWN0ZWQ/IFwiIGN1cnJlbnRcIiA6IFwiXCIpO1xuLy8gXHRcdGVyckVsLmlubmVySFRNTCA9IGVycm9yVGVtcGxhdGUoZXJyKTtcbi8vIFx0XHR0aGlzLnNldEVsZW1lbnQoZXJyRWwsIHRydWUpO1xuLy8gXHRcdGNvbnNvbGUubG9nKFwiJXM6OmNoYW5nZTplcnJvclwiLCB0aGlzLmNpZCwgZXJyLm1lc3NhZ2UsIGVyci5pbmZvU3JjKTtcbi8vIFx0fSxcbi8vIH0pO1xuXG52YXIgU291cmNlRXJyb3JSZW5kZXJlciA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2xhc3NOYW1lOiBcInNlcXVlbmNlLXN0ZXAgZXJyb3JcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjaWRQcmVmaXg6IFwic291cmNlRXJyb3JSZW5kZXJlclwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRlbXBsYXRlOiBlcnJvclRlbXBsYXRlLFxuXHQvKiogQHR5cGUge2Jvb2xlYW59ICovXG5cdHJlYWR5OiB0cnVlLFxuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHQvLyB2YXIgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24gb25TZWxlY3Rpb25DaGFuZ2UgKCkge1xuXHRcdC8vIFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCAhIXRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHRcdC8vIH07XG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkIGRlc2VsZWN0ZWRcIiwgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKTtcblx0XHQvLyAvLyB0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjdXJyZW50XCIsICEhdGhpcy5tb2RlbC5zZWxlY3RlZCk7XG5cdFx0Ly8gaGFuZGxlU2VsZWN0aW9uQ2hhbmdlLmNhbGwodGhpcyk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkIGRlc2VsZWN0ZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjdXJyZW50XCIsICEhdGhpcy5tb2RlbC5zZWxlY3RlZCk7XG5cdFx0fSk7XG5cdH0sXG5cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjdXJyZW50XCIsICEhdGhpcy5tb2RlbC5zZWxlY3RlZCk7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwuZ2V0KFwiZXJyb3JcIikpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxufSk7XG5cbnZhciBTZXF1ZW5jZVN0ZXBSZW5kZXJlciA9IFByZWZldGVjaGVkU291cmNlUmVuZGVyZXI7XG4vLyB2YXIgU2VxdWVuY2VTdGVwUmVuZGVyZXIgPSBTaW1wbGVTb3VyY2VSZW5kZXJlcjtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1NlcXVlbmNlUmVuZGVyZXJ9XG4gKi9cbnZhciBTZXF1ZW5jZVJlbmRlcmVyID0gUGxheWFibGVSZW5kZXJlci5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwic2VxdWVuY2VSZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2xhc3NOYW1lOiBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5jbGFzc05hbWUgKyBcIiBzZXF1ZW5jZS1yZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHR0ZW1wbGF0ZTogcmVxdWlyZShcIi4vU2VxdWVuY2VSZW5kZXJlci5oYnNcIiksXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogaW5pdGlhbGl6ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnNvdXJjZXMgPSB0aGlzLm1vZGVsLmdldChcInNvdXJjZXNcIik7XG5cdFx0UGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdGluaXRpYWxpemVBc3luYzogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemVBc3luYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG5cdFx0XHQudGhlbihcblx0XHRcdFx0ZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHRcdHJldHVybiB2aWV3LndoZW5BdHRhY2hlZCgpO1xuXHRcdFx0XHR9KVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHR2aWV3LmluaXRpYWxpemVQbGF5YWJsZSgpO1xuXHRcdFx0XHR2aWV3LnVwZGF0ZU92ZXJsYXkodmlldy5kZWZhdWx0SW1hZ2UsIHZpZXcub3ZlcmxheSk7XG5cdFx0XHRcdHZpZXcuYWRkU2VsZWN0aW9uTGlzdGVuZXJzKCk7XG5cdFx0XHRcdHJldHVybiB2aWV3O1xuXHRcdFx0fSk7XG5cdH0sXG5cblx0d2hlbkluaXRpYWxpemVkOiBmdW5jdGlvbih2aWV3KSB7XG5cdFx0dmFyIHJldHZhbCA9IFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLndoZW5Jbml0aWFsaXplZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdHZpZXcuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0XHRyZXR1cm4gcmV0dmFsO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGNoaWxkcmVuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y3JlYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLmNyZWF0ZUNoaWxkcmVuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlaG9sZGVyXCIpO1xuXHRcdHRoaXMuc2VxdWVuY2UgPSB0aGlzLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5zZXF1ZW5jZVwiKTtcblxuXHRcdHRoaXMuY29udGVudC5jbGFzc0xpc3QuYWRkKFwic3RhcnRlZFwiKTtcblxuXHRcdC8vIHN0eWxlc1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHZhciBzLCBhdHRycyA9IHRoaXMubW9kZWwuYXR0cnMoKTtcblx0XHQvLyB2YXIgcywgYXR0cnMgPSB0aGlzLm1vZGVsLmdldChcImF0dHJzXCIpO1xuXHRcdHMgPSBfLnBpY2soYXR0cnMsIFwiYm94LXNoYWRvd1wiLCBcImJvcmRlclwiLCBcImJvcmRlci1yYWRpdXNcIik7XG5cdFx0Xy5leHRlbmQodGhpcy5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVkaWEtYm9yZGVyXCIpLnN0eWxlLCBzKTtcblx0XHRzID0gXy5waWNrKGF0dHJzLCBcImJvcmRlci1yYWRpdXNcIik7XG5cdFx0Xy5leHRlbmQodGhpcy5zZXF1ZW5jZS5zdHlsZSwgcyk7XG5cdFx0Xy5leHRlbmQodGhpcy5wbGFjZWhvbGRlci5zdHlsZSwgcyk7XG5cblx0XHQvLyBtb2RlbFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuc291cmNlcy5zZWxlY3QodGhpcy5tb2RlbC5nZXQoXCJzb3VyY2VcIikpO1xuXG5cdFx0Ly8gaXRlbVZpZXdzXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dGhpcy5pdGVtVmlld3MgPSBuZXcgQ29udGFpbmVyKCk7XG5cdFx0Ly8gYWRkIGRlZmF1bHQgaW1hZ2UgYXMgcmVuZGVyZXIgKGFscmVhZHkgaW4gRE9NKVxuXHRcdHRoaXMuaXRlbVZpZXdzLmFkZChuZXcgU2VxdWVuY2VTdGVwUmVuZGVyZXIoe1xuXHRcdFx0ZWw6IHRoaXMuZ2V0RGVmYXVsdEltYWdlKCksXG5cdFx0XHRtb2RlbDogdGhpcy5zb3VyY2VzLnNlbGVjdGVkXG5cdFx0fSkpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGxheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0UGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR2YXIgZWxzLCBlbCwgaSwgY3NzVywgY3NzSDtcblx0XHR2YXIgY29udGVudCA9IHRoaXMuY29udGVudDtcblxuXHRcdC8vIG1lZGlhLXNpemVcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRjc3NXID0gdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoICsgXCJweFwiO1xuXHRcdGNzc0ggPSB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0ICsgXCJweFwiO1xuXG5cdFx0ZWxzID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1lZGlhLXNpemVcIik7XG5cdFx0Zm9yIChpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykge1xuXHRcdFx0ZWwgPSBlbHMuaXRlbShpKTtcblx0XHRcdGVsLnN0eWxlLndpZHRoID0gY3NzVztcblx0XHRcdGVsLnN0eWxlLmhlaWdodCA9IGNzc0g7XG5cdFx0fVxuXHRcdGNvbnRlbnQuc3R5bGUud2lkdGggPSBjc3NXO1xuXHRcdGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gY3NzSDtcblxuXHRcdC8vIGNvbnRlbnQtcG9zaXRpb25cblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR2YXIgY3NzWCwgY3NzWTtcblx0XHRjc3NYID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQueCArIFwicHhcIjtcblx0XHRjc3NZID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQueSArIFwicHhcIjtcblx0XHRjb250ZW50LnN0eWxlLmxlZnQgPSBjc3NYO1xuXHRcdGNvbnRlbnQuc3R5bGUudG9wID0gY3NzWTtcblxuXHRcdGVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRyb2xzXCIpO1xuXHRcdC8vIGVsLnN0eWxlLmxlZnQgPSBjc3NYO1xuXHRcdC8vIGVsLnN0eWxlLnRvcCA9IGNzc1k7XG5cdFx0ZWwuc3R5bGUud2lkdGggPSB0aGlzLm1ldHJpY3MuY29udGVudC53aWR0aCArIFwicHhcIjtcblx0XHRlbC5zdHlsZS5oZWlnaHQgPSB0aGlzLm1ldHJpY3MuY29udGVudC5oZWlnaHQgKyBcInB4XCI7XG5cblx0XHQvLyAvLyBjb250ZW50LXNpemVcblx0XHQvLyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvLyBjc3NXID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQud2lkdGggKyBcInB4XCI7XG5cdFx0Ly8gY3NzSCA9IHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCArIFwicHhcIjtcblx0XHQvL1xuXHRcdC8vIGVscyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcIi5jb250ZW50LXNpemVcIik7XG5cdFx0Ly8gZm9yIChpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykge1xuXHRcdC8vIFx0ZWwgPSBlbHMuaXRlbShpKTtcblx0XHQvLyBcdGVsLnN0eWxlLndpZHRoID0gY3NzVztcblx0XHQvLyBcdGVsLnN0eWxlLmhlaWdodCA9IGNzc0g7XG5cdFx0Ly8gfVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0aW5pdGlhbGl6ZVBsYXlhYmxlOiBmdW5jdGlvbigpIHtcblx0XHQvLyBTZXF1ZW5jZSBtb2RlbFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vIHRoaXMuc291cmNlcyA9IHRoaXMuX2NyZWF0ZVNvdXJjZUNvbGxlY3Rpb24odGhpcy5tb2RlbCk7XG5cdFx0d2hlblNlbGVjdGlvbkRpc3RhbmNlSXModGhpcywgMCkudGhlbih0aGlzLl9wcmVsb2FkQWxsSXRlbXMsIGZ1bmN0aW9uKGVycikge1xuXHRcdFx0aWYgKGVyciBpbnN0YW5jZW9mIFZpZXcuVmlld0Vycm9yKSB7IC8vIElnbm9yZSBWaWV3RXJyb3Jcblx0XHRcdFx0Ly8gY29uc29sZS53YXJuKGVyci5uYW1lLCBlcnIubWVzc2FnZSk7Ly8sIGVyci52aWV3LmNpZCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHJldHVybiBlcnI7XG5cdFx0fSk7XG5cblx0XHQvLyB0aW1lclxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuX3NlcXVlbmNlSW50ZXJ2YWwgPSBNYXRoLm1heChwYXJzZUludCh0aGlzLm1vZGVsLmF0dHIoXCJAc2VxdWVuY2UtaW50ZXJ2YWxcIikpLCBNSU5fU1RFUF9JTlRFUlZBTCkgfHwgREVGQVVMVF9TVEVQX0lOVEVSVkFMO1xuXG5cdFx0dGhpcy50aW1lciA9IG5ldyBUaW1lcigpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnJlbW92ZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnRpbWVyLnN0b3AoKTtcblx0XHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLnRpbWVyKTtcblx0XHR9KTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMudGltZXIsIHtcblx0XHRcdFwic3RhcnRcIjogdGhpcy5fb25UaW1lclN0YXJ0LFxuXHRcdFx0XCJyZXN1bWVcIjogdGhpcy5fb25UaW1lclJlc3VtZSxcblx0XHRcdFwicGF1c2VcIjogdGhpcy5fb25UaW1lclBhdXNlLFxuXHRcdFx0XCJlbmRcIjogdGhpcy5fb25UaW1lckVuZCxcblx0XHRcdC8vIFwic3RvcFwiOiBmdW5jdGlvbiAoKSB7IC8vIHN0b3AgaXMgb25seSBjYWxsZWQgb24gdmlldyByZW1vdmV9LFxuXHRcdH0pO1xuXG5cdFx0Ly8gcHJvZ3Jlc3MtbWV0ZXIgbW9kZWxcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLl9zb3VyY2VQcm9ncmVzc0J5SWR4ID0gdGhpcy5zb3VyY2VzLm1hcChmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiAwO1xuXHRcdH0pO1xuXHRcdHRoaXMuX3NvdXJjZVByb2dyZXNzQnlJZHhbMF0gPSAxOyAvLyBmaXJzdCBpdGVtIGlzIGFscmVhZHkgbG9hZGVkXG5cblx0XHQvLyBwcm9ncmVzcy1tZXRlclxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMucHJvZ3Jlc3NNZXRlciA9IG5ldyBQcm9ncmVzc01ldGVyKHtcblx0XHRcdGVsOiB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZ3Jlc3MtbWV0ZXJcIiksXG5cdFx0XHR2YWx1ZXM6IHtcblx0XHRcdFx0YXZhaWxhYmxlOiB0aGlzLl9zb3VyY2VQcm9ncmVzc0J5SWR4LmNvbmNhdCgpLFxuXHRcdFx0fSxcblx0XHRcdG1heFZhbHVlczoge1xuXHRcdFx0XHRhbW91bnQ6IHRoaXMuc291cmNlcy5sZW5ndGgsXG5cdFx0XHRcdGF2YWlsYWJsZTogdGhpcy5zb3VyY2VzLmxlbmd0aCxcblx0XHRcdH0sXG5cdFx0XHRjb2xvcjogdGhpcy5tb2RlbC5hdHRyKFwiY29sb3JcIiksXG5cdFx0XHQvLyBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMubW9kZWwuYXR0cihcImJhY2tncm91bmQtY29sb3JcIiksXG5cdFx0XHRsYWJlbEZuOiB0aGlzLl9wcm9ncmVzc0xhYmVsRm4uYmluZCh0aGlzKVxuXHRcdH0pO1xuXG5cdFx0Ly8gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnRvcC1iYXJcIilcblx0XHQvL1x0XHQuYXBwZW5kQ2hpbGQodGhpcy5wcm9ncmVzc01ldGVyLnJlbmRlcigpLmVsKTtcblx0fSxcblxuXHRfcHJvZ3Jlc3NMYWJlbEZuOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5wbGF5YmFja1JlcXVlc3RlZCA9PT0gZmFsc2UpIHJldHVybiBHbG9iYWxzLlBBVVNFX0NIQVI7XG5cdFx0cmV0dXJuICh0aGlzLnNvdXJjZXMuc2VsZWN0ZWRJbmRleCArIDEpICsgXCIvXCIgKyB0aGlzLnNvdXJjZXMubGVuZ3RoO1xuXHR9LFxuXG5cdF9wcmVsb2FkQWxsSXRlbXM6IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHR2aWV3Lm9uY2UoXCJ2aWV3OnJlbW92ZVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzaWxlbnQgPSB7XG5cdFx0XHRcdHNpbGVudDogdHJ1ZVxuXHRcdFx0fTtcblx0XHRcdHZpZXcuc291cmNlcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBzb3VyY2VzKSB7XG5cdFx0XHRcdHZhciBwcmVmZXRjaGVkID0gaXRlbS5nZXQoXCJwcmVmZXRjaGVkXCIpO1xuXHRcdFx0XHRpZiAocHJlZmV0Y2hlZCAmJiAvXmJsb2JcXDovLnRlc3QocHJlZmV0Y2hlZCkpIHtcblx0XHRcdFx0XHRpdGVtLnVuc2V0KFwicHJlZmV0Y2hlZFwiLCBzaWxlbnQpO1xuXHRcdFx0XHRcdGl0ZW0uc2V0KFwicHJvZ3Jlc3NcIiwgMCwgc2lsZW50KTtcblx0XHRcdFx0XHRVUkwucmV2b2tlT2JqZWN0VVJMKHByZWZldGNoZWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0XHRyZXR1cm4gdmlldy5zb3VyY2VzLnJlZHVjZShmdW5jdGlvbihsYXN0UHJvbWlzZSwgaXRlbSwgaW5kZXgsIHNvdXJjZXMpIHtcblx0XHRcdHJldHVybiBsYXN0UHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0aWYgKGl0ZW0uaGFzKFwicHJlZmV0Y2hlZFwiKSkge1xuXHRcdFx0XHRcdHZpZXcuX3VwZGF0ZUl0ZW1Qcm9ncmVzcygxLCBpbmRleCk7XG5cdFx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIF9sb2FkSW1hZ2VBc09iamVjdFVSTChpdGVtLmdldChcIm9yaWdpbmFsXCIpLFxuXHRcdFx0XHRcdFx0XHRmdW5jdGlvbihwcm9ncmVzcykge1xuXHRcdFx0XHRcdFx0XHRcdHZpZXcuX3VwZGF0ZUl0ZW1Qcm9ncmVzcyhwcm9ncmVzcywgaW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdGl0ZW0uc2V0KFwicHJvZ3Jlc3NcIiwgcHJvZ3Jlc3MpO1xuXHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0LnRoZW4oXG5cdFx0XHRcdFx0XHRcdGZ1bmN0aW9uKHBVcmwpIHtcblx0XHRcdFx0XHRcdFx0XHR2aWV3Ll91cGRhdGVJdGVtUHJvZ3Jlc3MoMSwgaW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdGl0ZW0uc2V0KHtcblx0XHRcdFx0XHRcdFx0XHRcdHByZWZldGNoZWQ6IHBVcmwsXG5cdFx0XHRcdFx0XHRcdFx0XHRwcm9ncmVzczogMVxuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRcdC8vIGl0ZW0uc2V0KFwicHJlZmV0Y2hlZFwiLCBwVXJsKTtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmlldztcblx0XHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdFx0ZnVuY3Rpb24oZXJyKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmlldy5fdXBkYXRlSXRlbVByb2dyZXNzKDAsIGluZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRpdGVtLnNldCh7XG5cdFx0XHRcdFx0XHRcdFx0XHRlcnJvcjogZXJyLFxuXHRcdFx0XHRcdFx0XHRcdFx0cHJvZ3Jlc3M6IDBcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHQvLyBpdGVtLnNldChcImVycm9yXCIsIGVycik7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sIFByb21pc2UucmVzb2x2ZSh2aWV3KSk7XG5cdH0sXG5cblx0Ly8gX3ByZWxvYWRBbGxJdGVtczI6IGZ1bmN0aW9uKHZpZXcpIHtcblx0Ly8gXHRyZXR1cm4gdmlldy5zb3VyY2VzLnJlZHVjZShmdW5jdGlvbihsYXN0UHJvbWlzZSwgaXRlbSwgaW5kZXgsIHNvdXJjZXMpIHtcblx0Ly8gXHRcdHJldHVybiBsYXN0UHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0Ly8gXHRcdFx0dmFyIGl0ZW1WaWV3ID0gdmlldy5fZ2V0SXRlbVJlbmRlcmVyKGl0ZW0pO1xuXHQvLyBcdFx0XHRyZXR1cm4gX3doZW5JbWFnZUxvYWRzKGl0ZW1WaWV3LmVsKS50aGVuKGZ1bmN0aW9uKHVybCl7XG5cdC8vIFx0XHRcdFx0dmlldy5fdXBkYXRlSXRlbVByb2dyZXNzKDEsIGluZGV4KTtcblx0Ly8gXHRcdFx0XHRyZXR1cm4gdmlldztcblx0Ly8gXHRcdFx0fSwgZnVuY3Rpb24oZXJyKSB7XG5cdC8vIFx0XHRcdFx0dmlldy5fdXBkYXRlSXRlbVByb2dyZXNzKDAsIGluZGV4KTtcblx0Ly8gXHRcdFx0XHRpdGVtLnNldChcImVycm9yXCIsIGVycik7XG5cdC8vIFx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdC8vIFx0XHRcdH0pO1xuXHQvLyBcdFx0fSk7XG5cdC8vIFx0fSwgUHJvbWlzZS5yZXNvbHZlKHZpZXcpKTtcblx0Ly8gfSxcblxuXHQvLyBfZ2V0SXRlbVJlbmRlcmVyOiBmdW5jdGlvbihpdGVtKSB7fVxuXG5cdF91cGRhdGVJdGVtUHJvZ3Jlc3M6IGZ1bmN0aW9uKHByb2dyZXNzLCBpbmRleCkge1xuXHRcdHRoaXMuX3NvdXJjZVByb2dyZXNzQnlJZHhbaW5kZXhdID0gcHJvZ3Jlc3M7XG5cdFx0aWYgKHRoaXMucHJvZ3Jlc3NNZXRlcikge1xuXHRcdFx0dGhpcy5wcm9ncmVzc01ldGVyLnZhbHVlVG8odGhpcy5fc291cmNlUHJvZ3Jlc3NCeUlkeCwgMzAwLCBcImF2YWlsYWJsZVwiKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIFBsYXlhYmxlUmVuZGVyZXIgaW1wbGVtZW50YXRpb25cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSBpbml0aWFsIHZhbHVlICovXG5cdF9wbGF5YmFja1JlcXVlc3RlZDogdHJ1ZSxcblxuXHQvKiogQHR5cGUge0Jvb2xlYW59IGludGVybmFsIHN0b3JlICovXG5cdF9wYXVzZWQ6IHRydWUsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRfaXNNZWRpYVBhdXNlZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3BhdXNlZDtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdF9wbGF5TWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICghdGhpcy5fcGF1c2VkKSByZXR1cm47XG5cdFx0dGhpcy5fcGF1c2VkID0gZmFsc2U7XG5cdFx0aWYgKHRoaXMudGltZXIuc3RhdHVzID09IFRpbWVyLlBBVVNFRCkge1xuXHRcdFx0dGhpcy50aW1lci5zdGFydCgpOyAvLyByZXN1bWUsIGFjdHVhbGx5XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMudGltZXIuc3RhcnQodGhpcy5fc2VxdWVuY2VJbnRlcnZhbCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0X3BhdXNlTWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9wYXVzZWQpIHJldHVybjtcblx0XHR0aGlzLl9wYXVzZWQgPSB0cnVlO1xuXHRcdGlmICh0aGlzLnRpbWVyLnN0YXR1cyA9PSBUaW1lci5TVEFSVEVEKSB7XG5cdFx0XHR0aGlzLnRpbWVyLnBhdXNlKCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHNlcXVlbmNlIHByaXZhdGVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uVGltZXJTdGFydDogZnVuY3Rpb24oZHVyYXRpb24pIHtcblx0XHR0aGlzLnByb2dyZXNzTWV0ZXIudmFsdWVUbyh0aGlzLnNvdXJjZXMuc2VsZWN0ZWRJbmRleCArIDEsIGR1cmF0aW9uLCBcImFtb3VudFwiKTtcblx0XHQvLyBpbml0IG5leHQgcmVuZGVyZXIgbm93IHRvIGhhdmUgc21vb3RoIHRyYW5zaXRpb25zXG5cdFx0dGhpcy5fZ2V0SXRlbVJlbmRlcmVyKHRoaXMuc291cmNlcy5mb2xsb3dpbmdPckZpcnN0KCkpO1xuXHR9LFxuXG5cdF9vblRpbWVyUmVzdW1lOiBmdW5jdGlvbihkdXJhdGlvbikge1xuXHRcdHRoaXMucHJvZ3Jlc3NNZXRlci52YWx1ZVRvKHRoaXMuc291cmNlcy5zZWxlY3RlZEluZGV4ICsgMSwgZHVyYXRpb24sIFwiYW1vdW50XCIpO1xuXHR9LFxuXG5cdF9vblRpbWVyUGF1c2U6IGZ1bmN0aW9uKGR1cmF0aW9uKSB7XG5cdFx0Ly8gdmFyIG1ldGVyRHVyID0gdGhpcy5wcm9ncmVzc01ldGVyLl92YWx1ZURhdGFbXCJhbW91bnRcIl0uX2R1cmF0aW9uIC0gdGhpcy5wcm9ncmVzc01ldGVyLl92YWx1ZURhdGFbXCJhbW91bnRcIl0uX2VsYXBzZWRUaW1lO1xuXHRcdC8vIHZhciBtZXRlclZhbCA9IHRoaXMucHJvZ3Jlc3NNZXRlci5nZXRSZW5kZXJlZFZhbHVlKFwiYW1vdW50XCIpO1xuXHRcdC8vIHZhciB0aW1lclZhbCA9ICh0aGlzLl9zZXF1ZW5jZUludGVydmFsIC0gZHVyYXRpb24pIC8gdGhpcy5fc2VxdWVuY2VJbnRlcnZhbCArIHRoaXMuc291cmNlcy5zZWxlY3RlZEluZGV4O1xuXHRcdC8vXG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6X29uVGltZXJQYXVzZSBbaW50ZXJ2YWw6JXNtc11cXG5cXHRtZXRlcjolcyAoJXNtcylcXG5cXHR0aW1lcjolcyAoJXNtcylcXG5cXHRkaWZmczolcyAoJXNtcylcIixcblx0XHQvLyBcdFx0dGhpcy5jaWQsIHRoaXMuX3NlcXVlbmNlSW50ZXJ2YWwsXG5cdFx0Ly8gXHRcdG1ldGVyVmFsLCBtZXRlckR1cixcblx0XHQvLyBcdFx0dGltZXJWYWwsIGR1cmF0aW9uLFxuXHRcdC8vIFx0XHRNYXRoLmFicyhtZXRlclZhbC10aW1lclZhbCksIE1hdGguYWJzKG1ldGVyRHVyLWR1cmF0aW9uKSk7XG5cblx0XHQvLyB0aGlzLnByb2dyZXNzTWV0ZXIudmFsdWVUbyh0aW1lclZhbCk7XG5cdFx0Ly8gdGhpcy5wcm9ncmVzc01ldGVyLnZhbHVlVG8obWV0ZXJWYWwpO1xuXG5cdFx0dGhpcy5wcm9ncmVzc01ldGVyLnZhbHVlVG8odGhpcy5wcm9ncmVzc01ldGVyLmdldFJlbmRlcmVkVmFsdWUoXCJhbW91bnRcIiksIDAsIFwiYW1vdW50XCIpO1xuXHR9LFxuXG5cdF9vblRpbWVyRW5kOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgY29udGV4dCA9IHRoaXM7XG5cdFx0dmFyIG5leHRTb3VyY2UsIG5leHRWaWV3O1xuXG5cdFx0bmV4dFNvdXJjZSA9IHRoaXMuc291cmNlcy5mb2xsb3dpbmdPckZpcnN0KCk7XG5cdFx0Ly8gaW5pdCBuZXh0IHJlbmRlcmVyXG5cdFx0bmV4dFZpZXcgPSB0aGlzLl9nZXRJdGVtUmVuZGVyZXIobmV4dFNvdXJjZSk7XG5cdFx0Ly8gaW5pdCBzZWNvbmQgbmV4dCByZW5kZXJlclxuXHRcdC8vIHRoaXMuX2dldEl0ZW1SZW5kZXJlcih0aGlzLnNvdXJjZXMuZm9sbG93aW5nT3JGaXJzdChuZXh0U291cmNlKSk7XG5cblx0XHR2YXIgc2hvd05leHRWaWV3ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRjb250ZXh0LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcblx0XHRcdFx0Y29udGV4dC5jb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ3YWl0aW5nXCIpO1xuXHRcdFx0XHRpZiAoIWNvbnRleHQuX3BhdXNlZCkge1xuXHRcdFx0XHRcdC8vIGlmIChjb250ZXh0LnBsYXliYWNrUmVxdWVzdGVkKSB7XG5cdFx0XHRcdFx0Y29udGV4dC5jb250ZW50LmNsYXNzTGlzdC50b2dnbGUoXCJwbGF5YmFjay1lcnJvclwiLCBuZXh0U291cmNlLmhhcyhcImVycm9yXCIpKTtcblx0XHRcdFx0XHRjb250ZXh0LnNvdXJjZXMuc2VsZWN0KG5leHRTb3VyY2UpOyAvLyBOT1RFOiBzdGVwIGluY3JlYXNlIGRvbmUgaGVyZVxuXHRcdFx0XHRcdC8vIHZpZXcudXBkYXRlT3ZlcmxheShuZXh0Vmlldy5lbCwgdmlldy5vdmVybGF5KTtcblx0XHRcdFx0XHRjb250ZXh0LnRpbWVyLnN0YXJ0KGNvbnRleHQuX3NlcXVlbmNlSW50ZXJ2YWwpO1xuXHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OnNob3dOZXh0VmlldyAlc21zICVzXCIsIGNvbnRleHQuY2lkLCBjb250ZXh0Ll9zZXF1ZW5jZUludGVydmFsLCBuZXh0U291cmNlLmNpZClcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fTtcblxuXHRcdGlmIChuZXh0U291cmNlLmhhcyhcInByZWZldGNoZWRcIikpIHtcblx0XHRcdC8vIG5leHRWaWV3ID0gY29udGV4dC5fZ2V0SXRlbVJlbmRlcmVyKG5leHRTb3VyY2UpLmVsO1xuXHRcdFx0X3doZW5JbWFnZUxvYWRzKG5leHRWaWV3LmVsKS50aGVuKHNob3dOZXh0Vmlldywgc2hvd05leHRWaWV3KTtcblx0XHR9IGVsc2UgaWYgKG5leHRTb3VyY2UuaGFzKFwiZXJyb3JcIikpIHtcblx0XHRcdHNob3dOZXh0VmlldygpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNvbnRlbnQuY2xhc3NMaXN0LmFkZChcIndhaXRpbmdcIik7XG5cdFx0XHQvKiBUT0RPOiBhZGQgZ2EgZXZlbnQgJ21lZGlhLXdhaXRpbmcnICovXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOlt3YWl0aW5nXSAlc21zICVzXCIsIGNvbnRleHQuY2lkLCBuZXh0U291cmNlLmNpZCk7XG5cdFx0XHR3aW5kb3cuZ2EoXCJzZW5kXCIsIFwiZXZlbnRcIiwgXCJzZXF1ZW5jZS1yZW5kZXJlclwiLCBcIndhaXRpbmdcIiwgdGhpcy5tb2RlbC5nZXQoXCJ0ZXh0XCIpKTtcblx0XHRcdHRoaXMubGlzdGVuVG8obmV4dFNvdXJjZSwgXCJjaGFuZ2U6cHJlZmV0Y2hlZCBjaGFuZ2U6ZXJyb3JcIixcblx0XHRcdFx0ZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dGhpcy5zdG9wTGlzdGVuaW5nKG5leHRTb3VyY2UsIFwiY2hhbmdlOnByZWZldGNoZWQgY2hhbmdlOmVycm9yXCIpO1xuXHRcdFx0XHRcdC8qIFRPRE86IGFkZCBnYSBldmVudCAnbWVkaWEtcGxheWluZycgKi9cblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOltwbGF5aW5nXSAlc21zICVzXCIsIGNvbnRleHQuY2lkLCBuZXh0U291cmNlLmNpZCk7XG5cdFx0XHRcdFx0d2luZG93LmdhKFwic2VuZFwiLCBcImV2ZW50XCIsIFwic2VxdWVuY2UtcmVuZGVyZXJcIiwgXCJwbGF5aW5nXCIsIHRoaXMubW9kZWwuZ2V0KFwidGV4dFwiKSk7XG5cdFx0XHRcdFx0X3doZW5JbWFnZUxvYWRzKG5leHRWaWV3LmVsKS50aGVuKHNob3dOZXh0Vmlldywgc2hvd05leHRWaWV3KTtcblx0XHRcdFx0XHQvLyBjb250ZXh0LmNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZShcIndhaXRpbmdcIik7XG5cdFx0XHRcdFx0Ly8gbmV4dFZpZXcgPSBjb250ZXh0Ll9nZXRJdGVtUmVuZGVyZXIobmV4dFNvdXJjZSkuZWw7XG5cdFx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHRfZ2V0SXRlbVJlbmRlcmVyOiBmdW5jdGlvbihpdGVtKSB7XG5cdFx0dmFyIHZpZXcgPSB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChpdGVtKTtcblx0XHRpZiAoIXZpZXcpIHtcblx0XHRcdHZhciByZW5kZXJlciA9IGl0ZW0uaGFzKFwiZXJyb3JcIikgPyBTb3VyY2VFcnJvclJlbmRlcmVyIDogU2VxdWVuY2VTdGVwUmVuZGVyZXI7XG5cdFx0XHR2aWV3ID0gbmV3IHJlbmRlcmVyKHtcblx0XHRcdFx0bW9kZWw6IGl0ZW1cblx0XHRcdH0pO1xuXHRcdFx0Ly8gdmlldyA9IG5ldyBTZXF1ZW5jZVN0ZXBSZW5kZXJlcih7IG1vZGVsOiBpdGVtIH0pO1xuXHRcdFx0dGhpcy5pdGVtVmlld3MuYWRkKHZpZXcpO1xuXHRcdFx0dGhpcy5zZXF1ZW5jZS5hcHBlbmRDaGlsZCh2aWV3LnJlbmRlcigpLmVsKTtcblx0XHR9XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcHJvZ3Jlc3MgbWV0ZXJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gX2NyZWF0ZURlZmF1bHRJdGVtRGF0YTogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG5cdC8vIFx0dmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXHQvLyBcdHZhciBpbWFnZURhdGEgPSB0aGlzLl9kcmF3TWVkaWFFbGVtZW50KGNvbnRleHQpLmdldEltYWdlRGF0YSgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuXHQvL1xuXHQvLyBcdHZhciBvcHRzID0geyByYWRpdXM6IDIwIH07XG5cdC8vIFx0dmFyIGZnQ29sb3IgPSBuZXcgQ29sb3IodGhpcy5tb2RlbC5hdHRyKFwiY29sb3JcIikpO1xuXHQvLyBcdHZhciBiZ0NvbG9yID0gbmV3IENvbG9yKHRoaXMubW9kZWwuYXR0cihcImJhY2tncm91bmQtY29sb3JcIikpO1xuXHQvLyBcdHZhciBpc0ZnRGFyayA9IGZnQ29sb3IubHVtaW5vc2l0eSgpIDwgYmdDb2xvci5sdW1pbm9zaXR5KCk7XG5cdC8vIFx0b3B0cy54MDAgPSBpc0ZnRGFyaz8gZmdDb2xvci5jbG9uZSgpLmxpZ2h0ZW4oMC4zMykgOiBiZ0NvbG9yLmNsb25lKCkuZGFya2VuKDAuMzMpO1xuXHQvLyBcdG9wdHMueEZGID0gaXNGZ0Rhcms/IGJnQ29sb3IuY2xvbmUoKS5saWdodGVuKDAuMzMpIDogZmdDb2xvci5jbG9uZSgpLmRhcmtlbigwLjMzKTtcblx0Ly9cblx0Ly8gXHRzdGFja0JsdXJNb25vKGltYWdlRGF0YSwgb3B0cyk7XG5cdC8vIFx0ZHVvdG9uZShpbWFnZURhdGEsIG9wdHMpO1xuXHQvLyBcdC8vIHN0YWNrQmx1clJHQihpbWFnZURhdGEsIG9wdHMpO1xuXHQvL1xuXHQvLyBcdGNvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG5cdC8vIFx0cmV0dXJuIGNhbnZhcy50b0RhdGFVUkwoKTtcblx0Ly8gfSxcbn0pO1xuXG5pZiAoREVCVUcpIHtcblxuXHRTZXF1ZW5jZVJlbmRlcmVyID0gKGZ1bmN0aW9uKFNlcXVlbmNlUmVuZGVyZXIpIHtcblx0XHRpZiAoIVNlcXVlbmNlUmVuZGVyZXIuTE9HX1RPX1NDUkVFTikgcmV0dXJuIFNlcXVlbmNlUmVuZGVyZXI7XG5cblx0XHQvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZ3MvbHBhZH0gKi9cblx0XHR2YXIgbHBhZCA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlLnN0cmluZy9scGFkXCIpO1xuXG5cdFx0cmV0dXJuIFNlcXVlbmNlUmVuZGVyZXIuZXh0ZW5kKHtcblx0XHRcdF9fbG9nVGltZXJFdmVudDogZnVuY3Rpb24oZXZuYW1lLCBtc2cpIHtcblx0XHRcdFx0dmFyIGxvZ01zZyA9IFtcblx0XHRcdFx0XCJzb3VyY2U6IFwiLCBscGFkKHRoaXMuc291cmNlcy5zZWxlY3RlZEluZGV4LCAyKSxcblx0XHRcdFx0XCJkdXJhdGlvbjpcIiwgbHBhZCh0aGlzLnRpbWVyLmdldER1cmF0aW9uKCksIDQpLFxuXHRcdFx0XHRcInBhdXNlZDpcIiwgdGhpcy5wYXVzZWQsXG5cdFx0XHRcdFwicmVxdWVzdGVkOlwiLCB0aGlzLnBsYXliYWNrUmVxdWVzdGVkLFxuXHRcdFx0XHRcInN0YXR1czpcIiwgdGhpcy50aW1lci5nZXRTdGF0dXMoKSxcblx0XHRcdF07XG5cdFx0XHRcdG1zZyAmJiBsb2dNc2cucHVzaChtc2cpO1xuXHRcdFx0XHRsb2dNc2cgPSBsb2dNc2cuam9pbihcIiBcIik7XG5cblx0XHRcdFx0dGhpcy5fX2xvZ01lc3NhZ2UobG9nTXNnLCBldm5hbWUpO1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpbJXNdICVzXCIsIHRoaXMuY2lkLCBldm5hbWUsIGxvZ01zZyk7XG5cdFx0XHR9LFxuXHRcdFx0X3BsYXlNZWRpYTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwicGxheWJhY2tcIik7XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl9wbGF5TWVkaWEuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6X3BsYXlNZWRpYSgpXCIsIHRoaXMuY2lkKTtcblx0XHRcdH0sXG5cdFx0XHRfcGF1c2VNZWRpYTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwicGxheWJhY2tcIik7XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl9wYXVzZU1lZGlhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol9wYXVzZU1lZGlhKClcIiwgdGhpcy5jaWQpO1xuXHRcdFx0fSxcblxuXHRcdFx0X29uVGltZXJTdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwidGltZXI6c3RhcnRcIik7XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl9vblRpbWVyU3RhcnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cdFx0XHRfb25UaW1lclJlc3VtZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwidGltZXI6cmVzdW1lXCIpO1xuXHRcdFx0XHRTZXF1ZW5jZVJlbmRlcmVyLnByb3RvdHlwZS5fb25UaW1lclN0YXJ0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LFxuXHRcdFx0X29uVGltZXJQYXVzZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwidGltZXI6cGF1c2VcIik7XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl9vblRpbWVyUGF1c2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cdFx0XHRfb25UaW1lckVuZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwidGltZXI6ZW5kXCIpO1xuXHRcdFx0XHRTZXF1ZW5jZVJlbmRlcmVyLnByb3RvdHlwZS5fb25UaW1lckVuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0fSxcblxuXHRcdFx0X3VwZGF0ZUl0ZW1Qcm9ncmVzczogZnVuY3Rpb24ocHJvZ3Jlc3MsIHNyY0lkeCkge1xuXHRcdFx0XHRpZiAocHJvZ3Jlc3MgPT0gMSkge1xuXHRcdFx0XHRcdHRoaXMuX19sb2dNZXNzYWdlKFwiaWR4OlwiICsgc3JjSWR4ICsgXCIgcHJvZ3Jlc3M6XCIgKyBwcm9ncmVzcywgXCJsb2FkOnByb2dyZXNzXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl91cGRhdGVJdGVtUHJvZ3Jlc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cblx0XHRcdF9wcmVsb2FkQWxsSXRlbXM6IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0dmlldy5fX2xvZ01lc3NhZ2Uodmlldy5jaWQgKyBcIjo6X3ByZWxvYWRBbGxJdGVtc1wiLCBcImxvYWQ6c3RhcnRcIik7XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl9wcmVsb2FkQWxsSXRlbXMuYXBwbHkodmlldywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cdH0pKFNlcXVlbmNlUmVuZGVyZXIpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFNlcXVlbmNlUmVuZGVyZXI7IiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcImNvbXBpbGVyXCI6WzcsXCI+PSA0LjAuMFwiXSxcIm1haW5cIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBoZWxwZXI7XG5cbiAgcmV0dXJuIFwiPGRpdiBjbGFzcz1cXFwicGxhY2Vob2xkZXIgc2l6aW5nXFxcIj48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJjb250ZW50IG1lZGlhLWJvcmRlclxcXCI+XFxuXHQ8ZGl2IGNsYXNzPVxcXCJjb250cm9scyBjb250ZW50LXNpemVcXFwiPlxcblx0XHRcdDxjYW52YXMgY2xhc3M9XFxcInByb2dyZXNzLW1ldGVyXFxcIj48L2NhbnZhcz5cXG5cdFx0XHQ8YSBjbGFzcz1cXFwiZnVsbHNjcmVlbi10b2dnbGVcXFwiIGhyZWY9XFxcImphdmFzY3JpcHQ6KHZvaWQgMClcXFwiPlxcblx0XHRcdFx0PHN2ZyB2ZXJzaW9uPVxcXCIxLjFcXFwiIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgcHJlc2VydmVBc3BlY3RSYXRpbz1cXFwieE1pZFlNaWQgbWVldFxcXCIgdmlld0JveD1cXFwiLTIxIC0yMSA0MiA0MlxcXCIgc3R5bGU9XFxcIm1heC13aWR0aDoxNHB4O21heC1oZWlnaHQ6MTRweFxcXCI+XFxuXHRcdFx0XHRcdDxwYXRoIGQ9XFxcIk0tNSw1IEwtMjAsMjAgTS03LDIwIEwtMjAsMjAgTC0yMCw3IE01LC01IEwyMCwtMjAgTTcsLTIwIEwyMCwtMjAgTDIwLC03XFxcIiBjbGFzcz1cXFwiY29sb3Itc3Ryb2tlXFxcIiBzdHlsZT1cXFwic3Ryb2tlLXdpZHRoOjE7ZmlsbDpub25lO1xcXCIgdmVjdG9yLWVmZmVjdD1cXFwibm9uLXNjYWxpbmctc3Ryb2tlXFxcIiAvPlxcblx0XHRcdFx0PC9zdmc+XFxuXHRcdFx0PC9hPlxcblx0PC9kaXY+XFxuXHQ8ZGl2IGNsYXNzPVxcXCJjcm9wLWJveCBtZWRpYS1zaXplXFxcIj5cXG5cdFx0PHZpZGVvIHByZWxvYWQ9XFxcIm5vbmVcXFwiIHdpZHRoPVxcXCIyNDBcXFwiIGhlaWdodD1cXFwiMTgwXFxcIj48L3ZpZGVvPlxcblx0XHQ8aW1nIGNsYXNzPVxcXCJwb3N0ZXIgZGVmYXVsdFxcXCIgYWx0PVxcXCJcIlxuICAgICsgY29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24oKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy50ZXh0IHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC50ZXh0IDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGhlbHBlcnMuaGVscGVyTWlzc2luZyksKHR5cGVvZiBoZWxwZXIgPT09IFwiZnVuY3Rpb25cIiA/IGhlbHBlci5jYWxsKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge30se1wibmFtZVwiOlwidGV4dFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiIHdpZHRoPVxcXCIyNDBcXFwiIGhlaWdodD1cXFwiMTgwXFxcIiAvPlxcblx0PC9kaXY+XFxuXHQ8ZGl2IGNsYXNzPVxcXCJvdmVybGF5IG1lZGlhLXNpemVcXFwiPlxcblx0XHQ8ZGl2IGNsYXNzPVxcXCJwbGF5LXRvZ2dsZS1oaXRhcmVhIHBsYXktdG9nZ2xlXFxcIj5cXG5cdFx0PC9kaXY+XFxuXHQ8L2Rpdj5cXG48L2Rpdj5cXG5cIjtcbn0sXCJ1c2VEYXRhXCI6dHJ1ZX0pO1xuIiwiLypnbG9iYWwgSFRNTE1lZGlhRWxlbWVudCwgTWVkaWFFcnJvciovXG4vKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL1ZpZGVvUmVuZGVyZXJcbiAqXG4gKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUTUwvRWxlbWVudC92aWRlb1xuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSFRNTE1lZGlhRWxlbWVudFxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9HdWlkZS9FdmVudHMvTWVkaWFfZXZlbnRzXG4gKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0d1aWRlL0hUTUwvVXNpbmdfSFRNTDVfYXVkaW9fYW5kX3ZpZGVvXG4gKi9cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcbi8qIEltcG9ydHNcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvUGxheWFibGVSZW5kZXJlcn0gKi9cbnZhciBQbGF5YWJsZVJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9QbGF5YWJsZVJlbmRlcmVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJ9ICovXG52YXIgUHJvZ3Jlc3NNZXRlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvUHJvZ3Jlc3NNZXRlclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkU3R5bGVOYW1lfSAqL1xuLy8gdmFyIHByZWZpeGVkU3R5bGVOYW1lID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkU3R5bGVOYW1lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRFdmVudH0gKi9cbnZhciBwcmVmaXhlZEV2ZW50ID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkRXZlbnRcIik7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG4vKiBwcml2YXRlIHN0YXRpY1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIHZhciB3aGVuVmlld0lzQXR0YWNoZWQgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuVmlld0lzQXR0YWNoZWRcIik7XG5cbnZhciBmdWxsc2NyZWVuQ2hhbmdlRXZlbnQgPSBwcmVmaXhlZEV2ZW50KFwiZnVsbHNjcmVlbmNoYW5nZVwiLCBkb2N1bWVudCk7XG4vLyB2YXIgZnVsbHNjcmVlbkVycm9yRXZlbnQgPSBwcmVmaXhlZEV2ZW50KFwiZnVsbHNjcmVlbmVycm9yXCIsIGRvY3VtZW50KTtcblxudmFyIGZvcm1hdFRpbWVjb2RlID0gZnVuY3Rpb24odmFsdWUpIHtcblx0aWYgKGlzTmFOKHZhbHVlKSkgcmV0dXJuIFwiXCI7IC8vdmFsdWUgPSAwO1xuXHRpZiAodmFsdWUgPj0gMzYwMCkgcmV0dXJuICgodmFsdWUgLyAzNjAwKSB8IDApICsgXCJIXCI7XG5cdGlmICh2YWx1ZSA+PSA2MCkgcmV0dXJuICgodmFsdWUgLyA2MCkgfCAwKSArIFwiTVwiO1xuXHQvLyBpZiAodmFsdWUgPj0gMTApIHJldHVybiBcIjBcIiArICh2YWx1ZSB8IDApICsgXCJTXCI7XG5cdHJldHVybiAodmFsdWUgfCAwKSArIFwiU1wiO1xufTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1ZpZGVvUmVuZGVyZXJ9XG4gKi9cbnZhciBWaWRlb1JlbmRlcmVyID0gUGxheWFibGVSZW5kZXJlci5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwidmlkZW9SZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2xhc3NOYW1lOiBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5jbGFzc05hbWUgKyBcIiB2aWRlby1yZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHR0ZW1wbGF0ZTogcmVxdWlyZShcIi4vVmlkZW9SZW5kZXJlci5oYnNcIiksXG5cblx0ZXZlbnRzOiAoZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHJldCA9IHt9O1xuXHRcdHJldFtHbG9iYWxzLkNMSUNLX0VWRU5UICsgXCIgZnVsbHNjcmVlbi10b2dnbGVcIl0gPSBcIl9vbkZ1bGxzY3JlZW5Ub2dnbGVcIjtcblx0XHRyZXR1cm4gcmV0O1xuXHR9KCkpLFxuXG5cdC8vIGV2ZW50czoge1xuXHQvLyBcdFwiY2xpY2sgLmZ1bGxzY3JlZW4tdG9nZ2xlXCI6IFwiX29uRnVsbHNjcmVlblRvZ2dsZVwiLFxuXHQvLyB9LFxuXG5cdC8vIHByb3BlcnRpZXM6IHtcblx0Ly8gXHRwYXVzZWQ6IHtcblx0Ly8gXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdC8vIFx0XHRcdHJldHVybiB0aGlzLnZpZGVvLnBhdXNlZDtcblx0Ly8gXHRcdH1cblx0Ly8gXHR9LFxuXHQvLyB9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdF8uYmluZEFsbCh0aGlzLFxuXHRcdFx0XCJfdXBkYXRlUGxheWJhY2tTdGF0ZVwiLFxuXHRcdFx0XCJfdXBkYXRlUGxheWVkVmFsdWVcIixcblx0XHRcdFwiX3VwZGF0ZUJ1ZmZlcmVkVmFsdWVcIixcblx0XHRcdFwiX29uTWVkaWFFcnJvclwiLFxuXHRcdFx0XCJfb25NZWRpYUVuZGVkXCIsXG5cdFx0XHRcIl9vbk1lZGlhUGxheWluZ09uY2VcIixcblx0XHRcdFwiX29uRnVsbHNjcmVlbkNoYW5nZVwiXG5cdFx0KTtcblx0XHQvLyB2YXIgb25QZWVyU2VsZWN0ID0gZnVuY3Rpb24oKSB7XG5cdFx0Ly8gXHR0aGlzLmNvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICh0aGlzLmdldFNlbGVjdGlvbkRpc3RhbmNlKCkgPiAxKT8gXCJub25lXCI6IFwiXCI7XG5cdFx0Ly8gfTtcblx0XHQvLyB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwuY29sbGVjdGlvbiwgXCJzZWxlY3Q6b25lIHNlbGVjdDpub25lXCIsIG9uUGVlclNlbGVjdCk7XG5cdFx0Ly8gb25QZWVyU2VsZWN0KCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogY2hpbGRyZW4vbGF5b3V0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y3JlYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLmNyZWF0ZUNoaWxkcmVuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlaG9sZGVyXCIpO1xuXHRcdC8vIHRoaXMub3ZlcmxheSA9IHRoaXMuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlcIik7XG5cdFx0dGhpcy52aWRlbyA9IHRoaXMuY29udGVudC5xdWVyeVNlbGVjdG9yKFwidmlkZW9cIik7XG5cdFx0Ly8gdGhpcy52aWRlby5sb29wID0gdGhpcy5tb2RlbC5hdHRycygpLmhhc093blByb3BlcnR5KFwiQHZpZGVvLWxvb3BcIik7XG5cdFx0dGhpcy52aWRlby5sb29wID0gdGhpcy5tb2RlbC5hdHRyKFwiQHZpZGVvLWxvb3BcIikgIT09IHZvaWQgMDtcblx0XHR0aGlzLnZpZGVvLnNyYyA9IHRoaXMuZmluZFBsYXlhYmxlU291cmNlKHRoaXMudmlkZW8pO1xuXHR9LFxuXG5cdG1lYXN1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLm1lYXN1cmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdC8vIE5PVEU6IFRvcC9ib3R0b20gMXB4IHZpZGVvIGNyb3Bcblx0XHQvLyAtIENyb3BwZWQgaW4gQ1NTOiB2aWRlbywgLnBvc3RlciB7IG1hcmdpbi10b3A6IC0xcHg7IG1hcmdpbi1ib3R0b206IC0xcHg7fVxuXHRcdC8vIC0gQ3JvcHBlZCBoZWlnaHQgaXMgYWRqdXN0ZWQgaW4gbWV0cmljcyBvYmpcblx0XHQvLyAtIENyb3AgYW1vdW50IGFkZGVkIGJhY2sgdG8gYWN0dWFsIHZpZGVvIG9uIHJlbmRlcigpXG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCAtPSAyO1xuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCAtPSAyO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdHZhciBlbHMsIGVsLCBpLCBjc3NXLCBjc3NIO1xuXHRcdHZhciBpbWcgPSB0aGlzLmRlZmF1bHRJbWFnZTtcblx0XHR2YXIgY29udGVudCA9IHRoaXMuY29udGVudDtcblxuXHRcdC8vIG1lZGlhLXNpemVcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRjc3NXID0gdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoICsgXCJweFwiO1xuXHRcdGNzc0ggPSB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0ICsgXCJweFwiO1xuXG5cdFx0ZWxzID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1lZGlhLXNpemVcIik7XG5cdFx0Zm9yIChpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykge1xuXHRcdFx0ZWwgPSBlbHMuaXRlbShpKTtcblx0XHRcdGVsLnN0eWxlLndpZHRoID0gY3NzVztcblx0XHRcdGVsLnN0eWxlLmhlaWdodCA9IGNzc0g7XG5cdFx0fVxuXG5cdFx0Y29udGVudC5zdHlsZS53aWR0aCA9IGNzc1c7XG5cdFx0Y29udGVudC5zdHlsZS5oZWlnaHQgPSAodGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCAtIDEpICsgXCJweFwiO1xuXG5cdFx0Ly8gY29udGVudC1wb3NpdGlvblxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHZhciBjc3NYLCBjc3NZO1xuXHRcdGNzc1ggPSB0aGlzLm1ldHJpY3MuY29udGVudC54ICsgXCJweFwiO1xuXHRcdGNzc1kgPSB0aGlzLm1ldHJpY3MuY29udGVudC55ICsgXCJweFwiO1xuXHRcdGNvbnRlbnQuc3R5bGUubGVmdCA9IGNzc1g7XG5cdFx0Y29udGVudC5zdHlsZS50b3AgPSBjc3NZO1xuXG5cdFx0ZWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIuY29udHJvbHNcIik7XG5cdFx0Ly8gZWwuc3R5bGUubGVmdCA9IGNzc1g7XG5cdFx0Ly8gY29udHJvbHMuc3R5bGUudG9wID0gY3NzWTtcblx0XHRlbC5zdHlsZS53aWR0aCA9IHRoaXMubWV0cmljcy5jb250ZW50LndpZHRoICsgXCJweFwiO1xuXHRcdGVsLnN0eWxlLmhlaWdodCA9IHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCArIFwicHhcIjtcblxuXHRcdC8vIC8vIGNvbnRlbnQtc2l6ZVxuXHRcdC8vIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vIGNzc1cgPSB0aGlzLm1ldHJpY3MuY29udGVudC53aWR0aCArIFwicHhcIjtcblx0XHQvLyBjc3NIID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQuaGVpZ2h0ICsgXCJweFwiO1xuXHRcdC8vXG5cdFx0Ly8gZWxzID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNvbnRlbnQtc2l6ZVwiKTtcblx0XHQvLyBmb3IgKGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Ly8gXHRlbCA9IGVscy5pdGVtKGkpO1xuXHRcdC8vIFx0ZWwuc3R5bGUud2lkdGggPSBjc3NXO1xuXHRcdC8vIFx0ZWwuc3R5bGUuaGVpZ2h0ID0gY3NzSDtcblx0XHQvLyB9XG5cblx0XHQvLyBOT1RFOiBlbGVtZW50cyBiZWxvdyBtdXN0IHVzZSB2aWRlbydzIFVOQ1JPUFBFRCBoZWlnaHQsIHNvICsycHhcblx0XHR0aGlzLnZpZGVvLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIHRoaXMubWV0cmljcy5tZWRpYS53aWR0aCk7XG5cdFx0dGhpcy52aWRlby5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgdGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCArIDIpO1xuXHRcdGltZy5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCB0aGlzLm1ldHJpY3MubWVkaWEud2lkdGgpO1xuXHRcdGltZy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgdGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCArIDIpO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogaW5pdGlhbGl6ZUFzeW5jXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGluaXRpYWxpemVBc3luYzogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzKVxuXHRcdFx0LnRoZW4oUGxheWFibGVSZW5kZXJlci53aGVuU2VsZWN0aW9uSXNDb250aWd1b3VzKVxuXHRcdFx0LnRoZW4oUGxheWFibGVSZW5kZXJlci53aGVuU2Nyb2xsaW5nRW5kcylcblx0XHRcdC50aGVuKFxuXHRcdFx0XHRmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdFx0cmV0dXJuIFByb21pc2UuYWxsKFtcblx0XHRcdFx0XHRcdHZpZXcud2hlblZpZGVvSGFzTWV0YWRhdGEodmlldyksXG5cdFx0XHRcdFx0XHRQbGF5YWJsZVJlbmRlcmVyLndoZW5EZWZhdWx0SW1hZ2VMb2Fkcyh2aWV3KSxcblx0XHRcdFx0XHRdKS50aGVuKFxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24oYXJyKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUodmlldyk7XG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24oZXJyKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH0pXG5cdFx0XHQudGhlbihcblx0XHRcdFx0ZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHRcdHJldHVybiB2aWV3LndoZW5BdHRhY2hlZCgpO1xuXHRcdFx0XHR9KVxuXHRcdFx0LnRoZW4oXG5cdFx0XHRcdGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0XHR2aWV3LmluaXRpYWxpemVQbGF5YWJsZSgpO1xuXHRcdFx0XHRcdHZpZXcudXBkYXRlT3ZlcmxheSh2aWV3LmRlZmF1bHRJbWFnZSwgdmlldy5vdmVybGF5KTtcblx0XHRcdFx0XHR2aWV3LmFkZFNlbGVjdGlvbkxpc3RlbmVycygpO1xuXHRcdFx0XHRcdHJldHVybiB2aWV3O1xuXHRcdFx0XHR9KTtcblx0fSxcblxuXHRpbml0aWFsaXplUGxheWFibGU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHZpZGVvXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dGhpcy5hZGRNZWRpYUxpc3RlbmVycygpO1xuXG5cdFx0Ly8gcHJvZ3Jlc3MtbWV0ZXJcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLnByb2dyZXNzTWV0ZXIgPSBuZXcgUHJvZ3Jlc3NNZXRlcih7XG5cdFx0XHRlbDogdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnByb2dyZXNzLW1ldGVyXCIpLFxuXHRcdFx0bWF4VmFsdWVzOiB7XG5cdFx0XHRcdGFtb3VudDogdGhpcy52aWRlby5kdXJhdGlvbixcblx0XHRcdFx0YXZhaWxhYmxlOiB0aGlzLnZpZGVvLmR1cmF0aW9uLFxuXHRcdFx0fSxcblx0XHRcdGNvbG9yOiB0aGlzLm1vZGVsLmF0dHIoXCJjb2xvclwiKSxcblx0XHRcdC8vIGJhY2tncm91bmRDb2xvcjogdGhpcy5tb2RlbC5hdHRyKFwiYmFja2dyb3VuZC1jb2xvclwiKSxcblx0XHRcdGxhYmVsRm46IHRoaXMuX3Byb2dyZXNzTGFiZWxGbi5iaW5kKHRoaXMpXG5cdFx0fSk7XG5cdFx0Ly8gdmFyIHBhcmVudEVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnRvcC1iYXJcIik7XG5cdFx0Ly8gcGFyZW50RWwuaW5zZXJ0QmVmb3JlKHRoaXMucHJvZ3Jlc3NNZXRlci5yZW5kZXIoKS5lbCwgcGFyZW50RWwuZmlyc3RDaGlsZCk7XG5cdH0sXG5cblx0X3Byb2dyZXNzTGFiZWxGbjogZnVuY3Rpb24odmFsdWUsIHRvdGFsKSB7XG5cdFx0aWYgKCF0aGlzLl9zdGFydGVkIHx8IHRoaXMudmlkZW8uZW5kZWQgfHwgaXNOYU4odmFsdWUpKSB7XG5cdFx0XHRyZXR1cm4gZm9ybWF0VGltZWNvZGUodG90YWwpO1xuXHRcdH0gZWxzZSBpZiAoIXRoaXMucGxheWJhY2tSZXF1ZXN0ZWQpIHtcblx0XHRcdHJldHVybiBHbG9iYWxzLlBBVVNFX0NIQVI7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBmb3JtYXRUaW1lY29kZSh0b3RhbCAtIHZhbHVlKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHdoZW5WaWRlb0hhc01ldGFkYXRhIHByb21pc2Vcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0d2hlblZpZGVvSGFzTWV0YWRhdGE6IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHQvLyBOT1RFOiBub3QgcHJldHR5ICEhIVxuXHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdHZhciBtZWRpYUVsID0gdmlldy52aWRlbztcblx0XHRcdHZhciBldmVudEhhbmRsZXJzID0ge1xuXHRcdFx0XHRsb2FkZWRtZXRhZGF0YTogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0XHRpZiAoZXYpIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6d2hlblZpZGVvSGFzTWV0YWRhdGEgWyVzXSAlc1wiLCB2aWV3LmNpZCwgXCJyZXNvbHZlZFwiLCBldj8gZXYudHlwZSA6IFwic3luY1wiKTtcblx0XHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRhYm9ydDogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0XHRpZiAoZXYpIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0cmVqZWN0KG5ldyBQbGF5YWJsZVJlbmRlcmVyLlZpZXdFcnJvcih2aWV3LCBuZXcgRXJyb3IoXCJ3aGVuVmlkZW9IYXNNZXRhZGF0YTogdmlldyB3YXMgcmVtb3ZlZFwiKSkpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0XHRpZiAoZXYpIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0dmFyIGVycjtcblx0XHRcdFx0XHRpZiAobWVkaWFFbC5lcnJvcikge1xuXHRcdFx0XHRcdFx0ZXJyID0gbmV3IEVycm9yKF8uaW52ZXJ0KE1lZGlhRXJyb3IpW21lZGlhRWwuZXJyb3IuY29kZV0pO1xuXHRcdFx0XHRcdFx0ZXJyLmluZm9Db2RlID0gbWVkaWFFbC5lcnJvci5jb2RlO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRlcnIgPSBuZXcgRXJyb3IoXCJVbnNwZWNpZmllZCBlcnJvclwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZXJyLmluZm9TcmMgPSBtZWRpYUVsLnNyYztcblx0XHRcdFx0XHRlcnIubG9nTWVzc2FnZSA9IFwid2hlblZpZGVvSGFzTWV0YWRhdGE6IFwiICsgZXJyLm5hbWUgKyBcIiBcIiArIGVyci5pbmZvU3JjO1xuXHRcdFx0XHRcdGVyci5sb2dFdmVudCA9IGV2O1xuXHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHR9LFxuXHRcdFx0fTtcblx0XHRcdC8vICAobWVkaWFFbC5wcmVsb2FkID09IFwiYXV0b1wiICYmIG1lZGlhRWwucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfQ1VSUkVOVF9EQVRBKVxuXHRcdFx0Ly8gXHQobWVkaWFFbC5wcmVsb2FkID09IFwibWV0YWRhdGFcIiAmJiBtZWRpYUVsLnJlYWR5U3RhdGUgPj0gSFRNTE1lZGlhRWxlbWVudC5IQVZFX01FVEFEQVRBKVxuXHRcdFx0aWYgKG1lZGlhRWwuZXJyb3IpIHtcblx0XHRcdFx0ZXZlbnRIYW5kbGVycy5lcnJvcigpO1xuXHRcdFx0fSBlbHNlIGlmIChtZWRpYUVsLnJlYWR5U3RhdGUgPj0gSFRNTE1lZGlhRWxlbWVudC5IQVZFX01FVEFEQVRBKSB7XG5cdFx0XHRcdGV2ZW50SGFuZGxlcnMubG9hZGVkbWV0YWRhdGEoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHZhciBzb3VyY2VzID0gbWVkaWFFbC5xdWVyeVNlbGVjdG9yQWxsKFwic291cmNlXCIpO1xuXHRcdFx0XHR2YXIgZXJyVGFyZ2V0ID0gc291cmNlcy5sZW5ndGggPiAwID8gc291cmNlcy5pdGVtKHNvdXJjZXMubGVuZ3RoIC0gMSkgOiBtZWRpYUVsO1xuXHRcdFx0XHR2YXIgZXJyQ2FwdHVyZSA9IGVyclRhcmdldCA9PT0gbWVkaWFFbDsgLy8gdXNlIGNhcHR1cmUgd2l0aCBIVE1MTWVkaWFFbGVtZW50XG5cblx0XHRcdFx0dmFyIHJlbW92ZUV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0ZXJyVGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBldmVudEhhbmRsZXJzLmVycm9yLCBlcnJDYXB0dXJlKTtcblx0XHRcdFx0XHRmb3IgKHZhciBldiBpbiBldmVudEhhbmRsZXJzKSB7XG5cdFx0XHRcdFx0XHRpZiAoZXYgIT09IFwiZXJyb3JcIiAmJiBldmVudEhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2KSkge1xuXHRcdFx0XHRcdFx0XHRtZWRpYUVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXYsIGV2ZW50SGFuZGxlcnNbZXZdLCBmYWxzZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRlcnJUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIGV2ZW50SGFuZGxlcnMuZXJyb3IsIGVyckNhcHR1cmUpO1xuXHRcdFx0XHRmb3IgKHZhciBldiBpbiBldmVudEhhbmRsZXJzKSB7XG5cdFx0XHRcdFx0aWYgKGV2ICE9PSBcImVycm9yXCIgJiYgZXZlbnRIYW5kbGVycy5oYXNPd25Qcm9wZXJ0eShldikpIHtcblx0XHRcdFx0XHRcdG1lZGlhRWwuYWRkRXZlbnRMaXN0ZW5lcihldiwgZXZlbnRIYW5kbGVyc1tldl0sIGZhbHNlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0bWVkaWFFbC5wcmVsb2FkID0gXCJtZXRhZGF0YVwiO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdGZpbmRQbGF5YWJsZVNvdXJjZTogZnVuY3Rpb24odmlkZW8pIHtcblx0XHR2YXIgcGxheWFibGUgPSB0aGlzLm1vZGVsLmdldChcInNvdXJjZXNcIikuZmluZChmdW5jdGlvbihzb3VyY2UpIHtcblx0XHRcdHJldHVybiAvXnZpZGVvXFwvLy50ZXN0KHNvdXJjZS5nZXQoXCJtaW1lXCIpKSAmJiB2aWRlby5jYW5QbGF5VHlwZShzb3VyY2UuZ2V0KFwibWltZVwiKSkgIT0gXCJcIjtcblx0XHR9KTtcblx0XHRyZXR1cm4gcGxheWFibGUgPyBwbGF5YWJsZS5nZXQoXCJvcmlnaW5hbFwiKSA6IFwiXCI7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIFBsYXlhYmxlUmVuZGVyZXIgaW1wbGVtZW50YXRpb25cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSBpbml0aWFsIHZhbHVlICovXG5cdF9wbGF5YmFja1JlcXVlc3RlZDogZmFsc2UsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRfaXNNZWRpYVBhdXNlZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMudmlkZW8ucGF1c2VkO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0X3BsYXlNZWRpYTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMudmlkZW8ucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfQ1VSUkVOVF9EQVRBICYmIHRoaXMudmlkZW8uc2Vla2FibGUubGVuZ3RoID09IDApIHtcblx0XHRcdGNvbnNvbGUud2Fybih0aGlzLmNpZCwgXCJXVEYhIGdvdCB2aWRlbyBkYXRhLCBidXQgY2Fubm90IHNlZWssIGNhbGxpbmcgbG9hZCgpXCIpO1xuXHRcdFx0Ly8gdGhpcy5fbG9nTWVzc2FnZShcImNhbGw6bG9hZFwiLCBcImdvdCB2aWRlbyBkYXRhLCBidXQgY2Fubm90IHNlZWssIGNhbGxpbmcgbG9hZCgpXCIsIFwib3JhbmdlXCIpO1xuXHRcdFx0dGhpcy52aWRlby5sb2FkKCk7XG5cdFx0XHQvLyB0aGlzLnZpZGVvLmN1cnJlbnRUaW1lID0gMDtcblx0XHR9IGVsc2UgaWYgKHRoaXMudmlkZW8uZW5kZWQpIHtcblx0XHRcdHRoaXMudmlkZW8uY3VycmVudFRpbWUgPSB0aGlzLnZpZGVvLnNlZWthYmxlLnN0YXJ0KDApO1xuXHRcdH1cblx0XHR0aGlzLnZpZGVvLnBsYXkoKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdF9wYXVzZU1lZGlhOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnZpZGVvLnBhdXNlKCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIG1lZGlhIGV2ZW50c1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyB1cGRhdGVQbGF5YmFja0V2ZW50czogXCJwbGF5IHBsYXlpbmcgd2FpdGluZyBwYXVzZSBzZWVraW5nIHNlZWtlZCBlbmRlZFwiLFxuXHQvLyB1cGRhdGVCdWZmZXJlZEV2ZW50czogXCJwcm9ncmVzcyBjYW5wbGF5IGNhbnBsYXl0aHJvdWdoIHBsYXlpbmcgdGltZXVwZGF0ZVwiLC8vbG9hZGVkZGF0YVxuXHR1cGRhdGVQbGF5YmFja0V2ZW50czogXCJwbGF5aW5nIHdhaXRpbmcgcGF1c2VcIixcblx0dXBkYXRlQnVmZmVyZWRFdmVudHM6IFwicHJvZ3Jlc3MgY2FucGxheSBjYW5wbGF5dGhyb3VnaCBwbGF5IHBsYXlpbmdcIixcblx0dXBkYXRlUGxheWVkRXZlbnRzOiBcInRpbWV1cGRhdGUgc2Vla2VkXCIsXG5cblx0YWRkTWVkaWFMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICghdGhpcy5fc3RhcnRlZCkgdGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKFwicGxheWluZ1wiLCB0aGlzLl9vbk1lZGlhUGxheWluZ09uY2UsIGZhbHNlKTtcblx0XHR0aGlzLmFkZExpc3RlbmVyKHRoaXMudmlkZW8sIHRoaXMudXBkYXRlUGxheWJhY2tFdmVudHMsIHRoaXMuX3VwZGF0ZVBsYXliYWNrU3RhdGUpO1xuXHRcdHRoaXMuYWRkTGlzdGVuZXIodGhpcy52aWRlbywgdGhpcy51cGRhdGVCdWZmZXJlZEV2ZW50cywgdGhpcy5fdXBkYXRlQnVmZmVyZWRWYWx1ZSk7XG5cdFx0dGhpcy5hZGRMaXN0ZW5lcih0aGlzLnZpZGVvLCB0aGlzLnVwZGF0ZVBsYXllZEV2ZW50cywgdGhpcy5fdXBkYXRlUGxheWVkVmFsdWUpO1xuXHRcdHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImVuZGVkXCIsIHRoaXMuX29uTWVkaWFFbmRlZCwgZmFsc2UpO1xuXHRcdHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIHRoaXMuX29uTWVkaWFFcnJvciwgdHJ1ZSk7XG5cblx0XHR0aGlzLm9uKFwidmlldzpyZW1vdmVkXCIsIHRoaXMucmVtb3ZlTWVkaWFMaXN0ZW5lcnMsIHRoaXMpO1xuXHR9LFxuXG5cdHJlbW92ZU1lZGlhTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLm9mZihcInZpZXc6cmVtb3ZlZFwiLCB0aGlzLnJlbW92ZU1lZGlhTGlzdGVuZXJzLCB0aGlzKTtcblxuXHRcdGlmICghdGhpcy5fc3RhcnRlZCkgdGhpcy52aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwicGxheWluZ1wiLCB0aGlzLl9vbk1lZGlhUGxheWluZ09uY2UsIGZhbHNlKTtcblx0XHR0aGlzLnJlbW92ZUxpc3RlbmVyKHRoaXMudmlkZW8sIHRoaXMudXBkYXRlUGxheWJhY2tFdmVudHMsIHRoaXMuX3VwZGF0ZVBsYXliYWNrU3RhdGUpO1xuXHRcdHRoaXMucmVtb3ZlTGlzdGVuZXIodGhpcy52aWRlbywgdGhpcy51cGRhdGVCdWZmZXJlZEV2ZW50cywgdGhpcy5fdXBkYXRlQnVmZmVyZWRWYWx1ZSk7XG5cdFx0dGhpcy5yZW1vdmVMaXN0ZW5lcih0aGlzLnZpZGVvLCB0aGlzLnVwZGF0ZVBsYXllZEV2ZW50cywgdGhpcy5fdXBkYXRlUGxheWVkVmFsdWUpO1xuXHRcdHRoaXMudmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImVuZGVkXCIsIHRoaXMuX29uTWVkaWFFbmRlZCwgZmFsc2UpO1xuXHRcdHRoaXMudmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIHRoaXMuX29uTWVkaWFFcnJvciwgdHJ1ZSk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIG1lZGlhIGV2ZW50IGhhbmRsZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vbk1lZGlhRXJyb3I6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy5yZW1vdmVNZWRpYUxpc3RlbmVycygpO1xuXHRcdHRoaXMucmVtb3ZlU2VsZWN0aW9uTGlzdGVuZXJzKCk7XG5cblx0XHR0aGlzLl9vbk1lZGlhRW5kZWQoZXYpO1xuXHRcdHRoaXMuY29udGVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZW5kZWRcIik7XG5cdFx0dGhpcy5jb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ3YWl0aW5nXCIpO1xuXHRcdHRoaXMuY29udGVudC5jbGFzc0xpc3QucmVtb3ZlKFwic3RhcnRlZFwiKTtcblx0XHR0aGlzLl9zdGFydGVkID0gZmFsc2U7XG5cblx0XHR0aGlzLm1lZGlhU3RhdGUgPSBcImVycm9yXCI7XG5cdH0sXG5cblx0X29uTWVkaWFQbGF5aW5nT25jZTogZnVuY3Rpb24oZXYpIHtcblx0XHR0aGlzLnZpZGVvLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwbGF5aW5nXCIsIHRoaXMuX29uTWVkaWFQbGF5aW5nT25jZSwgZmFsc2UpO1xuXHRcdGlmICghdGhpcy5fc3RhcnRlZCkge1xuXHRcdFx0dGhpcy5fc3RhcnRlZCA9IHRydWU7XG5cdFx0XHR0aGlzLmNvbnRlbnQuY2xhc3NMaXN0LmFkZChcInN0YXJ0ZWRcIik7XG5cdFx0fVxuXHR9LFxuXG5cdF9vbk1lZGlhRW5kZWQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy5wbGF5YmFja1JlcXVlc3RlZCA9IGZhbHNlO1xuXHRcdGlmICh0aGlzLnZpZGVvLndlYmtpdERpc3BsYXlpbmdGdWxsc2NyZWVuKSB7XG5cdFx0XHR0aGlzLnZpZGVvLndlYmtpdEV4aXRGdWxsc2NyZWVuKCk7XG5cdFx0fVxuXHRcdGlmIChkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCA9PT0gdGhpcy52aWRlbykge1xuXHRcdFx0dGhpcy52aWRlby5leGl0RnVsbHNjcmVlbigpO1xuXHRcdH1cblx0fSxcblxuXHRfdXBkYXRlUGxheWJhY2tTdGF0ZTogZnVuY3Rpb24oZXYpIHtcblx0XHR2YXIgY2xhc3NMaXN0ID0gdGhpcy5jb250ZW50LmNsYXNzTGlzdDtcblx0XHRpZiAodGhpcy5wbGF5YmFja1JlcXVlc3RlZCkge1xuXHRcdFx0c3dpdGNoIChldi50eXBlKSB7XG5cdFx0XHRcdGNhc2UgXCJwYXVzZVwiOlxuXHRcdFx0XHRjYXNlIFwicGxheWluZ1wiOlxuXHRcdFx0XHRcdGNsYXNzTGlzdC5yZW1vdmUoXCJ3YWl0aW5nXCIpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwid2FpdGluZ1wiOlxuXHRcdFx0XHRcdGNsYXNzTGlzdC5hZGQoXCJ3YWl0aW5nXCIpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjbGFzc0xpc3QucmVtb3ZlKFwid2FpdGluZ1wiKTtcblx0XHR9XG5cdFx0Y2xhc3NMaXN0LnRvZ2dsZShcImVuZGVkXCIsIHRoaXMudmlkZW8uZW5kZWQpO1xuXG5cdFx0dGhpcy5fdXBkYXRlUGxheWVkVmFsdWUoZXYpO1xuXHR9LFxuXG5cdF91cGRhdGVQbGF5ZWRWYWx1ZTogZnVuY3Rpb24oZXYpIHtcblx0XHR0aGlzLl9jdXJyZW50VGltZVZhbHVlID0gdGhpcy52aWRlby5jdXJyZW50VGltZTtcblx0XHRpZiAodGhpcy5wcm9ncmVzc01ldGVyKSB7XG5cdFx0XHR0aGlzLnByb2dyZXNzTWV0ZXIudmFsdWVUbyh0aGlzLl9jdXJyZW50VGltZVZhbHVlLCAwLCBcImFtb3VudFwiKTtcblx0XHR9XG5cdH0sXG5cblx0X3VwZGF0ZUJ1ZmZlcmVkVmFsdWU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dmFyIGJSYW5nZXMgPSB0aGlzLnZpZGVvLmJ1ZmZlcmVkO1xuXHRcdGlmIChiUmFuZ2VzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRoaXMuX2J1ZmZlcmVkVmFsdWUgPSBiUmFuZ2VzLmVuZChiUmFuZ2VzLmxlbmd0aCAtIDEpO1xuXHRcdFx0aWYgKHRoaXMucHJvZ3Jlc3NNZXRlciAmJiAoKHRoaXMudmlkZW8ucmVhZHlTdGF0ZSA9PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfRU5PVUdIX0RBVEEpIC8qfHwgKHRoaXMudmlkZW8ucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfQ1VSUkVOVF9EQVRBICYmIHRoaXMudmlkZW8ubmV0d29ya1N0YXRlID09IEhUTUxNZWRpYUVsZW1lbnQuTkVUV09SS19MT0FESU5HKSovICkpIHtcblx0XHRcdFx0dGhpcy5wcm9ncmVzc01ldGVyLnZhbHVlVG8odGhpcy5fYnVmZmVyZWRWYWx1ZSwgMzAwLCBcImF2YWlsYWJsZVwiKTtcblx0XHRcdFx0Ly8gdGhpcy5wcm9ncmVzc01ldGVyLnZhbHVlVG8odGhpcy5fYnVmZmVyZWRWYWx1ZSwgTWF0aC5tYXgoMCwgMTAwMCAqICh0aGlzLl9idWZmZXJlZFZhbHVlIC0gKHRoaXMucHJvZ3Jlc3NNZXRlci5nZXRWYWx1ZShcImF2YWlsYWJsZVwiKSB8IDApKSksIFwiYXZhaWxhYmxlXCIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogZnVsbHNjcmVlbiBhcGlcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uRnVsbHNjcmVlblRvZ2dsZTogZnVuY3Rpb24oZXYpIHtcblx0XHQvLyBOT1RFOiBJZ25vcmUgaWYgTW91c2VFdmVudC5idXR0b24gaXMgMCBvciB1bmRlZmluZWQgKDA6IGxlZnQtYnV0dG9uKVxuXHRcdGlmICghZXYuZGVmYXVsdFByZXZlbnRlZCAmJiAhZXYuYnV0dG9uICYmIHRoaXMubW9kZWwuc2VsZWN0ZWQpIHtcblx0XHRcdC8vIGV2LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0cnkge1xuXHRcdFx0XHRpZiAoZG9jdW1lbnQuaGFzT3duUHJvcGVydHkoXCJmdWxsc2NyZWVuRWxlbWVudFwiKSAmJlxuXHRcdFx0XHRcdGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50ICE9PSB0aGlzLnZpZGVvKSB7XG5cdFx0XHRcdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihmdWxsc2NyZWVuQ2hhbmdlRXZlbnQsIHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSwgZmFsc2UpO1xuXHRcdFx0XHRcdHRoaXMudmlkZW8ucmVxdWVzdEZ1bGxzY3JlZW4oKTtcblx0XHRcdFx0fSBlbHNlXG5cdFx0XHRcdGlmICh0aGlzLnZpZGVvLndlYmtpdFN1cHBvcnRzRnVsbHNjcmVlbiAmJiAhdGhpcy52aWRlby53ZWJraXREaXNwbGF5aW5nRnVsbHNjcmVlbikge1xuXHRcdFx0XHRcdHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcIndlYmtpdGJlZ2luZnVsbHNjcmVlblwiLCB0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UsIGZhbHNlKTtcblx0XHRcdFx0XHR0aGlzLnZpZGVvLndlYmtpdEVudGVyRnVsbFNjcmVlbigpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGNhdGNoIChlcnIpIHtcblx0XHRcdFx0dGhpcy52aWRlby5jb250cm9scyA9IGZhbHNlO1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKGVycik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF9vbkZ1bGxzY3JlZW5DaGFuZ2U6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0c3dpdGNoIChldi50eXBlKSB7XG5cdFx0XHRjYXNlIGZ1bGxzY3JlZW5DaGFuZ2VFdmVudDpcblx0XHRcdFx0Ly8gdmFyIGlzT3duRnVsbHNjcmVlbiA9IE1vZGVybml6ci5wcmVmaXhlZChcImZ1bGxzY3JlZW5FbGVtZW50XCIsIGRvY3VtZW50KSA9PT0gdGhpcy52aWRlbztcblx0XHRcdFx0dmFyIGlzT3duRnVsbHNjcmVlbiA9IGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50ID09PSB0aGlzLnZpZGVvO1xuXHRcdFx0XHR0aGlzLnZpZGVvLmNvbnRyb2xzID0gaXNPd25GdWxsc2NyZWVuO1xuXHRcdFx0XHRpZiAoIWlzT3duRnVsbHNjcmVlbikge1xuXHRcdFx0XHRcdGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoZnVsbHNjcmVlbkNoYW5nZUV2ZW50LCB0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UsIGZhbHNlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJ3ZWJraXRiZWdpbmZ1bGxzY3JlZW5cIjpcblx0XHRcdFx0dGhpcy52aWRlby5jb250cm9scyA9IHRydWU7XG5cdFx0XHRcdHRoaXMudmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIndlYmtpdGJlZ2luZnVsbHNjcmVlblwiLCB0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UsIGZhbHNlKTtcblx0XHRcdFx0dGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKFwid2Via2l0ZW5kZnVsbHNjcmVlblwiLCB0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UsIGZhbHNlKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwid2Via2l0ZW5kZnVsbHNjcmVlblwiOlxuXHRcdFx0XHR0aGlzLnZpZGVvLmNvbnRyb2xzID0gZmFsc2U7XG5cdFx0XHRcdHRoaXMudmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIndlYmtpdGVuZGZ1bGxzY3JlZW5cIiwgdGhpcy5fb25GdWxsc2NyZWVuQ2hhbmdlLCBmYWxzZSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogZXZlbnQgaGVscGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRhZGRMaXN0ZW5lcjogZnVuY3Rpb24odGFyZ2V0LCBldmVudHMsIGhhbmRsZXIsIHVzZUNhcHR1cmUpIHtcblx0XHQodHlwZW9mIGV2ZW50cyA9PT0gXCJzdHJpbmdcIikgJiYgKGV2ZW50cyA9IGV2ZW50cy5zcGxpdChcIiBcIikpO1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZXZlbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR0YXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihldmVudHNbaV0sIGhhbmRsZXIsICEhdXNlQ2FwdHVyZSk7XG5cdFx0fVxuXHR9LFxuXG5cdHJlbW92ZUxpc3RlbmVyOiBmdW5jdGlvbih0YXJnZXQsIGV2ZW50cywgaGFuZGxlciwgdXNlQ2FwdHVyZSkge1xuXHRcdCh0eXBlb2YgZXZlbnRzID09PSBcInN0cmluZ1wiKSAmJiAoZXZlbnRzID0gZXZlbnRzLnNwbGl0KFwiIFwiKSk7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50c1tpXSwgaGFuZGxlciwgISF1c2VDYXB0dXJlKTtcblx0XHR9XG5cdH0sXG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBsb2cgdG8gc2NyZWVuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmlmIChERUJVRykge1xuXG5cdFZpZGVvUmVuZGVyZXIgPSAoZnVuY3Rpb24oVmlkZW9SZW5kZXJlcikge1xuXHRcdGlmICghVmlkZW9SZW5kZXJlci5MT0dfVE9fU0NSRUVOKSByZXR1cm4gVmlkZW9SZW5kZXJlcjtcblxuXHRcdC8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG5cdFx0dmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuXHRcdC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmUuc3RyaW5ncy9scGFkfSAqL1xuXHRcdHZhciBscGFkID0gcmVxdWlyZShcInVuZGVyc2NvcmUuc3RyaW5nL2xwYWRcIik7XG5cdFx0LyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZS5zdHJpbmdzL3JwYWR9ICovXG5cdFx0dmFyIHJwYWQgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvcnBhZFwiKTtcblxuXHRcdC8vIHZhciBmdWxsc2NyZWVuRXZlbnRzID0gW1xuXHRcdC8vIFx0ZnVsbHNjcmVlbkNoYW5nZUV2ZW50LCBmdWxsc2NyZWVuRXJyb3JFdmVudCxcblx0XHQvLyBcdFwid2Via2l0YmVnaW5mdWxsc2NyZWVuXCIsIFwid2Via2l0ZW5kZnVsbHNjcmVlblwiLFxuXHRcdC8vIF07XG5cblx0XHR2YXIgbWVkaWFFdmVudHMgPSByZXF1aXJlKFwidXRpbHMvZXZlbnQvbWVkaWFFdmVudHNFbnVtXCIpO1xuXHRcdHZhciB1cGRhdGVQbGF5YmFja1N0YXRlRXZlbnRzLCB1cGRhdGVCdWZmZXJlZEV2ZW50cywgdXBkYXRlUGxheWVkRXZlbnRzO1xuXG5cdFx0Ly8gdXBkYXRlUGxheWJhY2tTdGF0ZUV2ZW50cyA9IFtcInBsYXlpbmdcIiwgXCJ3YWl0aW5nXCIsIFwiZW5kZWRcIiwgXCJwYXVzZVwiLCBcInNlZWtpbmdcIiwgXCJzZWVrZWRcIl07XG5cdFx0Ly8gdXBkYXRlQnVmZmVyZWRFdmVudHMgPSBbXCJwcm9ncmVzc1wiLCBcImR1cmF0aW9uY2hhbmdlXCIsIFwiY2FucGxheVwiLCBcInBsYXlcIl07XG5cdFx0Ly8gdXBkYXRlUGxheWVkRXZlbnRzID0gW1wicGxheWluZ1wiLCBcInRpbWV1cGRhdGVcIl07XG5cblx0XHR1cGRhdGVQbGF5YmFja1N0YXRlRXZlbnRzID0gW1xuXHRcdFx0XCJsb2Fkc3RhcnRcIixcblx0XHRcdFwicHJvZ3Jlc3NcIixcblx0XHRcdFwic3VzcGVuZFwiLFxuXHRcdFx0XCJhYm9ydFwiLFxuXHRcdFx0XCJlcnJvclwiLFxuXHRcdFx0XCJlbXB0aWVkXCIsXG5cdFx0XHRcInN0YWxsZWRcIixcblx0XHRdO1xuXHRcdHVwZGF0ZUJ1ZmZlcmVkRXZlbnRzID0gW1xuXHRcdFx0XCJsb2FkZWRtZXRhZGF0YVwiLFxuXHRcdFx0XCJsb2FkZWRkYXRhXCIsXG5cdFx0XHRcImNhbnBsYXlcIixcblx0XHRcdFwiY2FucGxheXRocm91Z2hcIixcblx0XHRcdFwicGxheWluZ1wiLFxuXHRcdFx0XCJ3YWl0aW5nXCIsXG5cdFx0XHRcInNlZWtpbmdcIiwgLy8gc2Vla2luZyBjaGFuZ2VkIHRvIHRydWVcblx0XHRcdFwic2Vla2VkXCIsIC8vIHNlZWtpbmcgY2hhbmdlZCB0byBmYWxzZVxuXHRcdFx0XCJlbmRlZFwiLCAvLyBlbmRlZCBpcyB0cnVlXG5cdFx0XTtcblx0XHR1cGRhdGVQbGF5ZWRFdmVudHMgPSBbXCJwbGF5XCIsIFwicGF1c2VcIl07XG5cblx0XHQvLyBFeGNsdWRlIHNvbWUgZXZlbnRzIGZyb20gbG9nXG5cdFx0bWVkaWFFdmVudHMgPSBfLndpdGhvdXQobWVkaWFFdmVudHMsIFwicmVzaXplXCIsIFwiZXJyb3JcIik7XG5cdFx0Ly8gTWFrZSBzdXJlIGV2ZW50IHN1YnNldHMgZXhpc3QgaW4gdGhlIG1haW4gc2V0XG5cdFx0dXBkYXRlUGxheWJhY2tTdGF0ZUV2ZW50cyA9IF8uaW50ZXJzZWN0aW9uKG1lZGlhRXZlbnRzLCB1cGRhdGVQbGF5YmFja1N0YXRlRXZlbnRzKTtcblx0XHR1cGRhdGVCdWZmZXJlZEV2ZW50cyA9IF8uaW50ZXJzZWN0aW9uKG1lZGlhRXZlbnRzLCB1cGRhdGVCdWZmZXJlZEV2ZW50cyk7XG5cdFx0dXBkYXRlUGxheWVkRXZlbnRzID0gXy5pbnRlcnNlY3Rpb24obWVkaWFFdmVudHMsIHVwZGF0ZVBsYXllZEV2ZW50cyk7XG5cblx0XHR2YXIgcmVhZHlTdGF0ZVN5bWJvbHMgPSBfLmludmVydChfLnBpY2soSFRNTE1lZGlhRWxlbWVudCxcblx0XHRcdGZ1bmN0aW9uKHZhbCwga2V5LCBvYmopIHtcblx0XHRcdFx0cmV0dXJuIC9eSEFWRV8vLnRlc3Qoa2V5KTtcblx0XHRcdH0pKTtcblx0XHR2YXIgcmVhZHlTdGF0ZVRvU3RyaW5nID0gZnVuY3Rpb24oZWwpIHtcblx0XHRcdHJldHVybiByZWFkeVN0YXRlU3ltYm9sc1tlbC5yZWFkeVN0YXRlXSArIFwiKFwiICsgZWwucmVhZHlTdGF0ZSArIFwiKVwiO1xuXHRcdH07XG5cblx0XHR2YXIgbmV0d29ya1N0YXRlU3ltYm9scyA9IF8uaW52ZXJ0KF8ucGljayhIVE1MTWVkaWFFbGVtZW50LFxuXHRcdFx0ZnVuY3Rpb24odmFsLCBrZXksIG9iaikge1xuXHRcdFx0XHRyZXR1cm4gL15ORVRXT1JLXy8udGVzdChrZXkpO1xuXHRcdFx0fSkpO1xuXHRcdHZhciBuZXR3b3JrU3RhdGVUb1N0cmluZyA9IGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRyZXR1cm4gbmV0d29ya1N0YXRlU3ltYm9sc1tlbC5uZXR3b3JrU3RhdGVdICsgXCIoXCIgKyBlbC5uZXR3b3JrU3RhdGUgKyBcIilcIjtcblx0XHR9O1xuXG5cdFx0dmFyIG1lZGlhRXJyb3JTeW1ib2xzID0gXy5pbnZlcnQoTWVkaWFFcnJvcik7XG5cdFx0dmFyIG1lZGlhRXJyb3JUb1N0cmluZyA9IGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRyZXR1cm4gZWwuZXJyb3IgPyBtZWRpYUVycm9yU3ltYm9sc1tlbC5lcnJvci5jb2RlXSArIFwiKFwiICsgZWwuZXJyb3IuY29kZSArIFwiKVwiIDogXCJbTWVkaWFFcnJvciBudWxsXVwiO1xuXHRcdH07XG5cblx0XHR2YXIgZmluZFJhbmdlSW5kZXggPSBmdW5jdGlvbihyYW5nZSwgY3VyclRpbWUpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IHJhbmdlLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdFx0aWYgKHJhbmdlLnN0YXJ0KGkpIDw9IGN1cnJUaW1lICYmIGN1cnJUaW1lIDw9IHJhbmdlLmVuZChpKSkge1xuXHRcdFx0XHRcdHJldHVybiBpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gLTE7XG5cdFx0fTtcblxuXHRcdHZhciBmb3JtYXRWaWRlb0Vycm9yID0gZnVuY3Rpb24odmlkZW8pIHtcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdG1lZGlhRXJyb3JUb1N0cmluZyh2aWRlbyksXG5cdFx0XHRcdG5ldHdvcmtTdGF0ZVRvU3RyaW5nKHZpZGVvKSxcblx0XHRcdFx0cmVhZHlTdGF0ZVRvU3RyaW5nKHZpZGVvKSxcblx0XHRcdF0uam9pbihcIiBcIik7XG5cdFx0fTtcblxuXHRcdHZhciBnZXRWaWRlb1N0YXRzQ29scyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIFwiMDAwMC4wMDAgW0N1cnJlbnQvVG90YWxdIFtTZWVrYWJsZSAgIF0gW0J1ZmZlcmVkICAgXSBuZXR3b3JrU3RhdGUgcmVhZHlTdGF0ZSAgICAgIFBsYXlpbmdcIjtcblx0XHRcdC8vIHJldHVybiBcIjAwMDAuNjIwIFt0OiAgMC4wICAyNy40XSBbczogMjcuNCAwLzFdIFtiOiAgMC41IDAvMV0gTE9BRElORygyKSAgIEZVVFVSRV9EQVRBKDMpICA6OiAoOjopXCI7XG5cdFx0fVxuXG5cdFx0dmFyIGZvcm1hdFZpZGVvU3RhdHMgPSBmdW5jdGlvbih2aWRlbykge1xuXHRcdFx0dmFyIGN1cnJUaW1lID0gdmlkZW8uY3VycmVudFRpbWUsXG5cdFx0XHRcdGR1clRpbWUgPSB2aWRlby5kdXJhdGlvbixcblx0XHRcdFx0YlJhbmdlcyA9IHZpZGVvLmJ1ZmZlcmVkLFxuXHRcdFx0XHRiUmFuZ2VJZHgsXG5cdFx0XHRcdHNSYW5nZXMgPSB2aWRlby5zZWVrYWJsZSxcblx0XHRcdFx0c1JhbmdlSWR4O1xuXG5cdFx0XHRiUmFuZ2VJZHggPSBmaW5kUmFuZ2VJbmRleChiUmFuZ2VzLCBjdXJyVGltZSk7XG5cdFx0XHRzUmFuZ2VJZHggPSBmaW5kUmFuZ2VJbmRleChzUmFuZ2VzLCBjdXJyVGltZSk7XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHRcIlt0OlwiICsgbHBhZChjdXJyVGltZS50b0ZpeGVkKDEpLCA1KSArXG5cdFx0XHRcdFx0XCIgXCIgKyBscGFkKCghaXNOYU4oZHVyVGltZSkgPyBkdXJUaW1lLnRvRml4ZWQoMSkgOiBcIi1cIiksIDUpICsgXCJdXCIsXG5cdFx0XHRcdFwiW3M6XCIgKyBscGFkKChzUmFuZ2VJZHggPj0gMCA/IHNSYW5nZXMuZW5kKHNSYW5nZUlkeCkudG9GaXhlZCgxKSA6IFwiLVwiKSwgNSkgK1xuXHRcdFx0XHRcdFwiIFwiICsgKHNSYW5nZUlkeCA+PSAwID8gc1JhbmdlSWR4IDogXCItXCIpICsgXCIvXCIgKyBzUmFuZ2VzLmxlbmd0aCArIFwiXVwiLFxuXHRcdFx0XHRcIltiOlwiICsgbHBhZCgoYlJhbmdlSWR4ID49IDAgPyBiUmFuZ2VzLmVuZChiUmFuZ2VJZHgpLnRvRml4ZWQoMSkgOiBcIi1cIiksIDUpICtcblx0XHRcdFx0XHRcIiBcIiArIChiUmFuZ2VJZHggPj0gMCA/IGJSYW5nZUlkeCA6IFwiLVwiKSArIFwiL1wiICsgYlJhbmdlcy5sZW5ndGggKyBcIl1cIixcblx0XHRcdFx0cnBhZChuZXR3b3JrU3RhdGVUb1N0cmluZyh2aWRlbykuc3Vic3RyKDgpLCAxMiksXG5cdFx0XHRcdHJwYWQocmVhZHlTdGF0ZVRvU3RyaW5nKHZpZGVvKS5zdWJzdHIoNSksIDE1KSxcblx0XHRcdFx0KHZpZGVvLmVuZGVkID8gXCI+OlwiIDogKHZpZGVvLnBhdXNlZCA/IFwiOjpcIiA6IFwiPj5cIikpLFxuXHRcdFx0XS5qb2luKFwiIFwiKTtcblx0XHR9O1xuXG5cdFx0cmV0dXJuIFZpZGVvUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFZpZGVvUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdFx0XHRfLmJpbmRBbGwodGhpcywgXCJfX2hhbmRsZU1lZGlhRXZlbnRcIik7XG5cblx0XHRcdFx0dmFyIGZnQ29sb3IgPSB0aGlzLm1vZGVsLmF0dHIoXCJjb2xvclwiKSxcblx0XHRcdFx0XHRyZWQgPSBuZXcgQ29sb3IoXCJyZWRcIiksXG5cdFx0XHRcdFx0Ymx1ZSA9IG5ldyBDb2xvcihcImJsdWVcIiksXG5cdFx0XHRcdFx0Z3JlZW4gPSBuZXcgQ29sb3IoXCJncmVlblwiKTtcblxuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG1lZGlhRXZlbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0dmFyIGV2ID0gbWVkaWFFdmVudHNbaV07XG5cdFx0XHRcdFx0dGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKGV2LCB0aGlzLl9faGFuZGxlTWVkaWFFdmVudCwgZmFsc2UpO1xuXG5cdFx0XHRcdFx0dmFyIGMgPSBuZXcgQ29sb3IoZmdDb2xvciksXG5cdFx0XHRcdFx0XHRjYyA9IDE7XG5cdFx0XHRcdFx0aWYgKHVwZGF0ZUJ1ZmZlcmVkRXZlbnRzLmluZGV4T2YoZXYpICE9IC0xKSBjLm1peChncmVlbiwgKGNjIC89IDIpKTtcblx0XHRcdFx0XHRpZiAodXBkYXRlUGxheWVkRXZlbnRzLmluZGV4T2YoZXYpICE9IC0xKSBjLm1peChyZWQsIChjYyAvPSAyKSk7XG5cdFx0XHRcdFx0aWYgKHVwZGF0ZVBsYXliYWNrU3RhdGVFdmVudHMuaW5kZXhPZihldikgIT0gLTEpIGMubWl4KGJsdWUsIChjYyAvPSAyKSk7XG5cdFx0XHRcdFx0dGhpcy5fX2xvZ0NvbG9yc1tldl0gPSBjLnJnYlN0cmluZygpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIHRoaXMuX19oYW5kbGVNZWRpYUV2ZW50LCB0cnVlKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdHJlbW92ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFZpZGVvUmVuZGVyZXIucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG1lZGlhRXZlbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKG1lZGlhRXZlbnRzW2ldID09IFwiZXJyb3JcIikgY29udGludWU7XG5cdFx0XHRcdFx0dGhpcy52aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKG1lZGlhRXZlbnRzW2ldLCB0aGlzLl9faGFuZGxlTWVkaWFFdmVudCwgZmFsc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMudmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIHRoaXMuX19oYW5kbGVNZWRpYUV2ZW50LCB0cnVlKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdF9vblZpc2liaWxpdHlDaGFuZ2U6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRcdFZpZGVvUmVuZGVyZXIucHJvdG90eXBlLl9vblZpc2liaWxpdHlDaGFuZ2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0dmFyIHN0YXRlVmFsID0gTW9kZXJuaXpyLnByZWZpeGVkKFwidmlzaWJpbGl0eVN0YXRlXCIsIGRvY3VtZW50KTtcblx0XHRcdFx0dGhpcy5fX2xvZ0V2ZW50KFwidmlzaWJpbGl0eVN0YXRlOlwiICsgc3RhdGVWYWwsIGV2LnR5cGUgKyBcIjpcIiArIHN0YXRlVmFsKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdF9vbkZ1bGxzY3JlZW5DaGFuZ2U6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRcdFZpZGVvUmVuZGVyZXIucHJvdG90eXBlLl9vbkZ1bGxzY3JlZW5DaGFuZ2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0dmFyIGxvZ3R5cGUgPSAoZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgPT09IHRoaXMudmlkZW8gPyBcImVudGVyOlwiIDogXCJleGl0OlwiKSArIGV2LnR5cGU7XG5cdFx0XHRcdHRoaXMuX19sb2dFdmVudChcImRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50OiBcIiArIHRoaXMuY2lkLCBsb2d0eXBlKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdF9vbkZ1bGxzY3JlZW5Ub2dnbGU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRcdFZpZGVvUmVuZGVyZXIucHJvdG90eXBlLl9vbkZ1bGxzY3JlZW5Ub2dnbGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0aWYgKCFldi5kZWZhdWx0UHJldmVudGVkICYmIHRoaXMubW9kZWwuc2VsZWN0ZWQpIHtcblx0XHRcdFx0XHR0aGlzLl9fbG9nRXZlbnQoXCJmdWxsc2NyZWVuLXRvZ2dsZVwiLCBldi50eXBlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0X19oYW5kbGVNZWRpYUV2ZW50OiBmdW5jdGlvbihldikge1xuXHRcdFx0XHR2YXIgZXZtc2c7IC8vLCBlcnJtc2c7XG5cdFx0XHRcdC8vIGV2bXNnID0gZm9ybWF0VmlkZW9TdGF0cyh0aGlzLnZpZGVvKSArIFwiIFwiICsgcnBhZCh0aGlzLl9sYXN0UGxheWJhY2tTdGF0ZXMgfHwgXCItXCIsIDkpO1xuXHRcdFx0XHRldm1zZyA9IGZvcm1hdFZpZGVvU3RhdHModGhpcy52aWRlbyk7XG5cdFx0XHRcdGlmICh0aGlzLnBsYXliYWNrUmVxdWVzdGVkID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0ZXZtc2cgKz0gXCIgKD4+KVwiO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQgPT09IGZhbHNlKSB7XG5cdFx0XHRcdFx0ZXZtc2cgKz0gXCIgKDo6KVwiO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGV2bXNnICs9IFwiICgtLSlcIjtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLl9fbG9nRXZlbnQoZXZtc2csIGV2LnR5cGUpO1xuXHRcdFx0XHRpZiAoZXYudHlwZSA9PT0gXCJlcnJvclwiIHx8IGV2LnR5cGUgPT09IFwiYWJvcnRcIikge1xuXHRcdFx0XHRcdHRoaXMuX19sb2dNZXNzYWdlKGZvcm1hdFZpZGVvRXJyb3IodGhpcy52aWRlbyksIGV2LnR5cGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRfX2xvZ0V2ZW50OiBmdW5jdGlvbihtc2csIGxvZ3R5cGUsIGNvbG9yKSB7XG5cdFx0XHRcdHZhciBsb2dFbnRyeUVsID0gdGhpcy5fX2xvZ0VsZW1lbnQubGFzdEVsZW1lbnRDaGlsZDtcblx0XHRcdFx0aWYgKChsb2dFbnRyeUVsICYmIGxvZ0VudHJ5RWwuZ2V0QXR0cmlidXRlKFwiZGF0YS1sb2d0eXBlXCIpID09IGxvZ3R5cGUpICYmXG5cdFx0XHRcdFx0KChsb2d0eXBlID09PSBcInRpbWV1cGRhdGVcIikgfHwgKGxvZ3R5cGUgPT09IFwicHJvZ3Jlc3NcIikpKSB7XG5cdFx0XHRcdFx0dmFyIGxvZ1JlcGVhdFZhbCA9IHBhcnNlSW50KGxvZ0VudHJ5RWwuZ2V0QXR0cmlidXRlKFwiZGF0YS1sb2dyZXBlYXRcIikpO1xuXHRcdFx0XHRcdGxvZ0VudHJ5RWwudGV4dENvbnRlbnQgPSB0aGlzLl9fZ2V0VFN0YW1wKCkgKyBcIiBcIiArIG1zZztcblx0XHRcdFx0XHRsb2dFbnRyeUVsLnNldEF0dHJpYnV0ZShcImRhdGEtbG9ncmVwZWF0XCIsIGlzTmFOKGxvZ1JlcGVhdFZhbCkgPyAyIDogKytsb2dSZXBlYXRWYWwpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuX19sb2dNZXNzYWdlKG1zZywgbG9ndHlwZSwgY29sb3IpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRfX2dldEhlYWRlclRleHQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gZ2V0VmlkZW9TdGF0c0NvbHMoKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cdH0pKFZpZGVvUmVuZGVyZXIpO1xuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gVmlkZW9SZW5kZXJlcjsiLCIvLyBoYnNmeSBjb21waWxlZCBIYW5kbGViYXJzIHRlbXBsYXRlXG52YXIgSGFuZGxlYmFyc0NvbXBpbGVyID0gcmVxdWlyZSgnaGJzZnkvcnVudGltZScpO1xubW9kdWxlLmV4cG9ydHMgPSBIYW5kbGViYXJzQ29tcGlsZXIudGVtcGxhdGUoe1wiY29tcGlsZXJcIjpbNyxcIj49IDQuMC4wXCJdLFwibWFpblwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIHN0YWNrMSwgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWhlbHBlcnMuaGVscGVyTWlzc2luZywgYWxpYXMzPVwiZnVuY3Rpb25cIjtcblxuICByZXR1cm4gXCI8ZGl2IGlkPVxcXCJkZXNjX2JcIlxuICAgICsgY29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24oKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5pZCB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuaWQgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcImlkXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIlxcXCIgY2xhc3M9XFxcImNvbnRlbnQgc2l6aW5nIG1kb3duXFxcIj5cIlxuICAgICsgKChzdGFjazEgPSAoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLmRlc2MgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmRlc2MgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcImRlc2NcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIjwvZGl2PlxcblwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvLyBoYnNmeSBjb21waWxlZCBIYW5kbGViYXJzIHRlbXBsYXRlXG52YXIgSGFuZGxlYmFyc0NvbXBpbGVyID0gcmVxdWlyZSgnaGJzZnkvcnVudGltZScpO1xubW9kdWxlLmV4cG9ydHMgPSBIYW5kbGViYXJzQ29tcGlsZXIudGVtcGxhdGUoe1wiY29tcGlsZXJcIjpbNyxcIj49IDQuMC4wXCJdLFwibWFpblwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIHN0YWNrMSwgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWhlbHBlcnMuaGVscGVyTWlzc2luZywgYWxpYXMzPVwiZnVuY3Rpb25cIjtcblxuICByZXR1cm4gXCI8ZGl2IGlkPVxcXCJkZXNjX21cIlxuICAgICsgY29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24oKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5pZCB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuaWQgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcImlkXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIlxcXCIgY2xhc3M9XFxcImNvbnRlbnQgc2l6aW5nXFxcIj48cD5cIlxuICAgICsgKChzdGFjazEgPSAoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLm5hbWUgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLm5hbWUgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcIm5hbWVcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIjwvcD5cIlxuICAgICsgKChzdGFjazEgPSAoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLnN1YiB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuc3ViIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJzdWJcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIjwvZGl2PlxcblwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvLyBoYnNmeSBjb21waWxlZCBIYW5kbGViYXJzIHRlbXBsYXRlXG52YXIgSGFuZGxlYmFyc0NvbXBpbGVyID0gcmVxdWlyZSgnaGJzZnkvcnVudGltZScpO1xubW9kdWxlLmV4cG9ydHMgPSBIYW5kbGViYXJzQ29tcGlsZXIudGVtcGxhdGUoe1wiMVwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIGhlbHBlcjtcblxuICByZXR1cm4gXCJcdFx0PHA+PGNvZGU+XCJcbiAgICArIGNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuaW5mb1NyYyB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuaW5mb1NyYyA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBoZWxwZXJzLmhlbHBlck1pc3NpbmcpLCh0eXBlb2YgaGVscGVyID09PSBcImZ1bmN0aW9uXCIgPyBoZWxwZXIuY2FsbChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LHtcIm5hbWVcIjpcImluZm9TcmNcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiPC9jb2RlPjwvcD5cXG5cIjtcbn0sXCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxLCBoZWxwZXIsIGFsaWFzMT1kZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LCBhbGlhczI9aGVscGVycy5oZWxwZXJNaXNzaW5nLCBhbGlhczM9XCJmdW5jdGlvblwiLCBhbGlhczQ9Y29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb247XG5cbiAgcmV0dXJuIFwiPGRpdiBjbGFzcz1cXFwiZXJyb3ItbWVzc2FnZSBjb2xvci1mZ1xcXCI+XFxuXHQ8cD48c3Ryb25nPlwiXG4gICAgKyBhbGlhczQoKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5uYW1lIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5uYW1lIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJuYW1lXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIjwvc3Ryb25nPiA8Y29kZT5cIlxuICAgICsgYWxpYXM0KCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMubWVzc2FnZSB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAubWVzc2FnZSA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwibWVzc2FnZVwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCI8L2NvZGU+PC9wPlxcblwiXG4gICAgKyAoKHN0YWNrMSA9IGhlbHBlcnNbXCJpZlwiXS5jYWxsKGFsaWFzMSwoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuaW5mb1NyYyA6IGRlcHRoMCkse1wibmFtZVwiOlwiaWZcIixcImhhc2hcIjp7fSxcImZuXCI6Y29udGFpbmVyLnByb2dyYW0oMSwgZGF0YSwgMCksXCJpbnZlcnNlXCI6Y29udGFpbmVyLm5vb3AsXCJkYXRhXCI6ZGF0YX0pKSAhPSBudWxsID8gc3RhY2sxIDogXCJcIilcbiAgICArIFwiPC9kaXY+XCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8vIHZhciBIYW5kbGViYXJzID0gcmVxdWlyZShcImhhbmRsZWJhcnNcIilbXCJkZWZhdWx0XCJdO1xudmFyIEhhbmRsZWJhcnMgPSByZXF1aXJlKFwiaGJzZnkvcnVudGltZVwiKTtcbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcblxuLy8gKGZ1bmN0aW9uKCkge1xudmFyIGhlbHBlcnMgPSB7XG5cdC8qXG5cdC8qIEFyaXRobWV0aWMgaGVscGVyc1xuXHQvKi9cblx0YWRkOiBmdW5jdGlvbih2YWx1ZSwgYWRkaXRpb24pIHtcblx0XHRyZXR1cm4gdmFsdWUgKyBhZGRpdGlvbjtcblx0fSxcblx0c3VidHJhY3Q6IGZ1bmN0aW9uKHZhbHVlLCBzdWJzdHJhY3Rpb24pIHtcblx0XHRyZXR1cm4gdmFsdWUgLSBzdWJzdHJhY3Rpb247XG5cdH0sXG5cdGRpdmlkZTogZnVuY3Rpb24odmFsdWUsIGRpdmlzb3IpIHtcblx0XHRyZXR1cm4gdmFsdWUgLyBkaXZpc29yO1xuXHR9LFxuXHRtdWx0aXBseTogZnVuY3Rpb24odmFsdWUsIG11bHRpcGxpZXIpIHtcblx0XHRyZXR1cm4gdmFsdWUgKiBtdWx0aXBsaWVyO1xuXHR9LFxuXHRmbG9vcjogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRyZXR1cm4gTWF0aC5mbG9vcih2YWx1ZSk7XG5cdH0sXG5cdGNlaWw6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0cmV0dXJuIE1hdGguY2VpbCh2YWx1ZSk7XG5cdH0sXG5cdHJvdW5kOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdHJldHVybiBNYXRoLnJvdW5kKHZhbHVlKTtcblx0fSxcblx0Z2xvYmFsOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdHJldHVybiBHbG9iYWxzW3ZhbHVlXTtcblx0fSxcblxuXHQvKlxuXHQvKiBGbG93IGNvbnRyb2wgaGVscGVyc1xuXHQvKi9cblx0aXM6IGZ1bmN0aW9uKGEsIGIsIG9wdHMpIHtcblx0XHRyZXR1cm4gKGEgPT09IGIpID8gb3B0cy5mbih0aGlzKSA6IG9wdHMuaW52ZXJzZSh0aGlzKTtcblx0fSxcblx0aXNub3Q6IGZ1bmN0aW9uKGEsIGIsIG9wdHMpIHtcblx0XHRyZXR1cm4gKGEgIT09IGIpID8gb3B0cy5mbih0aGlzKSA6IG9wdHMuaW52ZXJzZSh0aGlzKTtcblx0fSxcblx0aXNhbnk6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0dmFyIGkgPSAwLFxuXHRcdFx0aWkgPSBhcmd1bWVudHMubGVuZ3RoIC0gMixcblx0XHRcdG9wdHMgPSBhcmd1bWVudHNbaWkgKyAxXTtcblx0XHRkb1xuXHRcdFx0aWYgKHZhbHVlID09PSBhcmd1bWVudHNbKytpXSkge1xuXHRcdFx0XHRyZXR1cm4gb3B0cy5mbih0aGlzKTtcblx0XHRcdH1cblx0XHR3aGlsZSAoaSA8IGlpKTtcblx0XHRyZXR1cm4gb3B0cy5pbnZlcnNlKHRoaXMpO1xuXHR9LFxuXHRjb250YWluczogZnVuY3Rpb24oYSwgYiwgb3B0cykge1xuXHRcdHJldHVybiAoYS5pbmRleE9mKGIpICE9PSAtMSkgPyBvcHRzLmZuKHRoaXMpIDogb3B0cy5pbnZlcnNlKHRoaXMpO1xuXHR9LFxuXHRpZ25vcmU6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBcIlwiO1xuXHR9LFxuXG5cdC8qXG5cdC8qIENvbG9yIGhlbHBlcnNcblx0LyovXG5cdG1peDogZnVuY3Rpb24oY29sb3JhLCBjb2xvcmIsIGFtb3VudCkge1xuXHRcdHJldHVybiBuZXcgQ29sb3IoY29sb3JhKS5taXgobmV3IENvbG9yKGNvbG9yYiksIGFtb3VudCkucmdiU3RyaW5nKCk7XG5cdH0sXG5cdGxpZ2h0ZW46IGZ1bmN0aW9uKGNvbG9yLCBhbW91bnQpIHtcblx0XHRyZXR1cm4gbmV3IENvbG9yKGNvbG9yKS5saWdodGVuKGFtb3VudCkucmdiU3RyaW5nKCk7XG5cdH0sXG5cdGRhcmtlbjogZnVuY3Rpb24oY29sb3IsIGFtb3VudCkge1xuXHRcdHJldHVybiBuZXcgQ29sb3IoY29sb3IpLmRhcmtlbihhbW91bnQpLnJnYlN0cmluZygpO1xuXHR9LFxuXHQvLyBjb2xvckZvcm1hdDogZnVuY3Rpb24oY29sb3IsIGZtdCkge1xuXHQvLyBcdHN3aXRjaCAoZm10KSB7XG5cdC8vIFx0XHRjYXNlIFwicmdiXCI6XG5cdC8vIFx0XHRcdHJldHVybiBuZXcgQ29sb3IoY29sb3IpLnJnYlN0cmluZygpO1xuXHQvLyBcdFx0Y2FzZSBcImhzbFwiOlxuXHQvLyBcdFx0XHRyZXR1cm4gbmV3IENvbG9yKGNvbG9yKS5oc2xTdHJpbmcoKTtcblx0Ly8gXHRcdGNhc2UgXCJoZXhcIjogZGVmYXVsdDpcblx0Ly8gXHRcdFx0cmV0dXJuIG5ldyBDb2xvcihjb2xvcikuaGV4U3RyaW5nKCk7XG5cdC8vIFx0fVxuXHQvLyB9LFxufTtcbmZvciAodmFyIGhlbHBlciBpbiBoZWxwZXJzKSB7XG5cdGlmIChoZWxwZXJzLmhhc093blByb3BlcnR5KGhlbHBlcikpIHtcblx0XHRIYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKGhlbHBlciwgaGVscGVyc1toZWxwZXJdKTtcblx0fVxufVxuLy8gfSkoKTtcblxuLy8gbW9kdWxlLmV4cG9ydHMgPSBIYW5kbGViYXJzO1xuIiwiLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBFdmVudHMgPSByZXF1aXJlKFwiYmFja2JvbmVcIikuRXZlbnRzO1xuXG5cbi8vIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbi8vIFx0dGljazogMSxcbi8vIFx0b25zdGFydDogbnVsbCxcbi8vIFx0b250aWNrOiBudWxsLFxuLy8gXHRvbnBhdXNlOiBudWxsLFxuLy8gXHRvbnN0b3A6IG51bGwsXG4vLyBcdG9uZW5kOiBudWxsXG4vLyB9XG52YXIgaWRTZWVkID0gMDtcblxudmFyIFRpbWVyID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHQvLyBpZiAoISh0aGlzIGluc3RhbmNlb2YgVGltZXIpKSB7XG5cdC8vIFx0cmV0dXJuIG5ldyBUaW1lcihvcHRpb25zKTtcblx0Ly8gfVxuXHR0aGlzLl9pZCA9IGlkU2VlZCsrO1xuXHQvLyB0aGlzLl9vcHRpb25zID0ge307XG5cdHRoaXMuX2R1cmF0aW9uID0gMDtcblx0dGhpcy5fc3RhdHVzID0gXCJpbml0aWFsaXplZFwiO1xuXHR0aGlzLl9zdGFydCA9IDA7XG5cdC8vIHRoaXMuX21lYXN1cmVzID0gW107XG5cblx0Ly8gZm9yICh2YXIgcHJvcCBpbiBkZWZhdWx0T3B0aW9ucykge1xuXHQvLyBcdHRoaXMuX29wdGlvbnNbcHJvcF0gPSBkZWZhdWx0T3B0aW9uc1twcm9wXTtcblx0Ly8gfVxuXHQvLyB0aGlzLm9wdGlvbnMob3B0aW9ucyk7XG59O1xuXG5fLmV4dGVuZChUaW1lci5wcm90b3R5cGUsIEV2ZW50cywge1xuXG5cdHN0YXJ0OiBmdW5jdGlvbihkdXJhdGlvbikge1xuXHRcdGlmICghXy5pc051bWJlcihkdXJhdGlvbikgJiYgIXRoaXMuX2R1cmF0aW9uKSB7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdFx0Ly8gZHVyYXRpb24gJiYgKGR1cmF0aW9uICo9IDEwMDApXG5cdFx0aWYgKHRoaXMuX3RpbWVvdXQgJiYgdGhpcy5fc3RhdHVzID09PSBcInN0YXJ0ZWRcIikge1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHRcdHZhciBldk5hbWUgPSAodGhpcy5fc3RhdHVzID09PSBcInN0b3BwZWRcIikgPyBcInN0YXJ0XCIgOiBcInJlc3VtZVwiO1xuXHRcdHRoaXMuX2R1cmF0aW9uID0gZHVyYXRpb24gfHwgdGhpcy5fZHVyYXRpb247XG5cdFx0dGhpcy5fdGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KGVuZC5iaW5kKHRoaXMpLCB0aGlzLl9kdXJhdGlvbik7XG5cdFx0Ly8gaWYgKHR5cGVvZiB0aGlzLl9vcHRpb25zLm9udGljayA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0Ly8gXHR0aGlzLl9pbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuXHRcdC8vIFx0XHR0aGlzLnRyaWdnZXIoXCJ0aWNrXCIsIHRoaXMuZ2V0RHVyYXRpb24oKSlcblx0XHQvLyBcdH0uYmluZCh0aGlzKSwgK3RoaXMuX29wdGlvbnMudGljayAqIDEwMDApXG5cdFx0Ly8gfVxuXHRcdHRoaXMuX3N0YXJ0ID0gX25vdygpO1xuXHRcdHRoaXMuX3N0YXR1cyA9IFwic3RhcnRlZFwiO1xuXHRcdHRoaXMudHJpZ2dlcihldk5hbWUsIHRoaXMuZ2V0RHVyYXRpb24oKSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0cGF1c2U6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9zdGF0dXMgIT09IFwic3RhcnRlZFwiKSB7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdFx0dGhpcy5fZHVyYXRpb24gLT0gKF9ub3coKSAtIHRoaXMuX3N0YXJ0KTtcblx0XHRjbGVhci5jYWxsKHRoaXMsIGZhbHNlKTtcblx0XHR0aGlzLl9zdGF0dXMgPSBcInBhdXNlZFwiO1xuXHRcdHRoaXMudHJpZ2dlcihcInBhdXNlXCIsIHRoaXMuZ2V0RHVyYXRpb24oKSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0c3RvcDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCEvc3RhcnRlZHxwYXVzZWQvLnRlc3QodGhpcy5fc3RhdHVzKSkge1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHRcdGNsZWFyLmNhbGwodGhpcywgdHJ1ZSk7XG5cdFx0dGhpcy5fc3RhdHVzID0gXCJzdG9wcGVkXCI7XG5cdFx0dGhpcy50cmlnZ2VyKFwic3RvcFwiKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRnZXREdXJhdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX3N0YXR1cyA9PT0gXCJzdGFydGVkXCIpIHtcblx0XHRcdHJldHVybiB0aGlzLl9kdXJhdGlvbiAtIChfbm93KCkgLSB0aGlzLl9zdGFydCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLl9zdGF0dXMgPT09IFwicGF1c2VkXCIpIHtcblx0XHRcdHJldHVybiB0aGlzLl9kdXJhdGlvbjtcblx0XHR9XG5cdFx0cmV0dXJuIDA7XG5cdH0sXG5cblx0Z2V0U3RhdHVzOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5fc3RhdHVzO1xuXHR9LFxufSk7XG5cbnZhciBfbm93ID0gd2luZG93LnBlcmZvcm1hbmNlID9cblx0d2luZG93LnBlcmZvcm1hbmNlLm5vdy5iaW5kKHdpbmRvdy5wZXJmb3JtYW5jZSkgOlxuXHREYXRlLm5vdy5iaW5kKERhdGUpO1xuXG5mdW5jdGlvbiBlbmQoKSB7XG5cdGNsZWFyLmNhbGwodGhpcyk7XG5cdHRoaXMuX3N0YXR1cyA9IFwic3RvcHBlZFwiO1xuXHR0aGlzLnRyaWdnZXIoXCJlbmRcIik7XG59XG5cbmZ1bmN0aW9uIGNsZWFyKGNsZWFyRHVyYXRpb24pIHtcblx0d2luZG93LmNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0KTtcblx0Ly8gd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5faW50ZXJ2YWwpO1xuXHRpZiAoY2xlYXJEdXJhdGlvbiA9PT0gdHJ1ZSkge1xuXHRcdHRoaXMuX2R1cmF0aW9uID0gMDtcblx0fVxufVxuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhUaW1lci5wcm90b3R5cGUsIHtcblx0ZHVyYXRpb246IHtcblx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5nZXREdXJhdGlvbigpO1xuXHRcdH1cblx0fSxcblx0c3RhdHVzOiB7XG5cdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZ2V0U3RhdHVzKCk7XG5cdFx0fVxuXHR9XG59KTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoVGltZXIsIHtcblx0U1RPUFBFRDoge1xuXHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0dmFsdWU6IFwic3RvcHBlZFwiXG5cdH0sXG5cdFNUQVJURUQ6IHtcblx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdHZhbHVlOiBcInN0YXJ0ZWRcIlxuXHR9LFxuXHRQQVVTRUQ6IHtcblx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdHZhbHVlOiBcInBhdXNlZFwiXG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBUaW1lcjtcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIEltcG9ydHNcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvVHJhbnNmb3JtSXRlbX0gKi9cbnZhciBUcmFuc2Zvcm1JdGVtID0gcmVxdWlyZShcIi4vVHJhbnNmb3JtSXRlbVwiKTtcblxudmFyIGlkU2VlZCA9IDA7XG52YXIgY2lkU2VlZCA9IDEwMDtcbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL2hlbHBlci9UcmFuc2Zvcm1IZWxwZXJ9XG4gKi9cbmZ1bmN0aW9uIFRyYW5zZm9ybUhlbHBlcigpIHtcblx0dGhpcy5pZCA9IGlkU2VlZCsrO1xuXHR0aGlzLl9pdGVtcyA9IFtdO1xuXHR0aGlzLl9pdGVtc0J5SWQgPSB7fTtcbn1cblxuVHJhbnNmb3JtSGVscGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoe1xuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogUHJpdmF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2dldDogZnVuY3Rpb24oZWwpIHtcblx0XHRpZiAodGhpcy5oYXMoZWwpKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5faXRlbXNCeUlkW2VsLmVpZF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB0aGlzLl9hZGQoZWwpO1xuXHRcdH1cblx0fSxcblxuXHRfYWRkOiBmdW5jdGlvbihlbCkge1xuXHRcdHZhciBpdGVtLCBpZDtcblx0XHQvLyBpZCA9IGVsLmVpZCB8fCBlbC5jaWQgfHwgZWwuaWQ7XG5cdFx0Ly8gaWYgKCFpZCB8fCAodGhpcy5faXRlbXNCeUlkW2lkXSAmJiAodGhpcy5faXRlbXNCeUlkW2lkXS5lbCAhPT0gZWwpKSkge1xuXHRcdC8vIFx0aWQgPSBcImVsdFwiICsgY2lkU2VlZCsrO1xuXHRcdC8vIH1cblx0XHQvLyBpZiAoIWVsLmVpZCkge1xuXHRcdC8vIFx0aWQgPSBlbC5laWQgfHwgZWwuY2lkIHx8IChcImVsdFwiICsgY2lkU2VlZCsrKTtcblx0XHQvLyB9XG5cdFx0aWQgPSBlbC5laWQgfHwgZWwuY2lkIHx8IChcImVsdFwiICsgY2lkU2VlZCsrKTtcblx0XHRpdGVtID0gbmV3IFRyYW5zZm9ybUl0ZW0oZWwsIGlkKTtcblx0XHR0aGlzLl9pdGVtc0J5SWRbaWRdID0gaXRlbTtcblx0XHR0aGlzLl9pdGVtcy5wdXNoKGl0ZW0pO1xuXHRcdHJldHVybiBpdGVtO1xuXHR9LFxuXG5cdF9yZW1vdmU6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0aWYgKHRoaXMuaGFzKGVsKSkge1xuXHRcdFx0dmFyIG8gPSB0aGlzLl9pdGVtc0J5SWRbZWwuZWlkXTtcblx0XHRcdHRoaXMuX2l0ZW1zLnNwbGljZSh0aGlzLl9pdGVtcy5pbmRleE9mKG8pLCAxKTtcblx0XHRcdG8uZGVzdHJveSgpO1xuXHRcdFx0ZGVsZXRlIHRoaXMuX2l0ZW1zQnlJZFtlbC5laWRdO1xuXHRcdH1cblx0fSxcblxuXHRfaW52b2tlOiBmdW5jdGlvbihmdW5jTmFtZSwgYXJncywgc3RhcnRJbmRleCkge1xuXHRcdHZhciBpLCBpaSwgaiwgamosIGVsLCBvLCBycjtcblx0XHR2YXIgZnVuY0FyZ3MgPSBudWxsO1xuXHRcdGlmIChzdGFydEluZGV4ICE9PSB2b2lkIDApIHtcblx0XHRcdGZ1bmNBcmdzID0gc2xpY2UuY2FsbChhcmdzLCAwLCBzdGFydEluZGV4KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3RhcnRJbmRleCA9IDA7XG5cdFx0fVxuXHRcdGZvciAoaSA9IHN0YXJ0SW5kZXgsIGlpID0gYXJncy5sZW5ndGgsIHJyID0gW107IGkgPCBpaTsgKytpKSB7XG5cdFx0XHRlbCA9IGFyZ3NbaV07XG5cdFx0XHQvLyBpdGVyYXRlIG9uIE5vZGVMaXN0LCBBcmd1bWVudHMsIEFycmF5Li4uXG5cdFx0XHRpZiAoZWwubGVuZ3RoKSB7XG5cdFx0XHRcdGZvciAoaiA9IDAsIGpqID0gZWwubGVuZ3RoOyBqIDwgamo7ICsraikge1xuXHRcdFx0XHRcdG8gPSB0aGlzLl9nZXQoZWxbal0pO1xuXHRcdFx0XHRcdHJyLnB1c2gob1tmdW5jTmFtZV0uYXBwbHkobywgZnVuY0FyZ3MpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0byA9IHRoaXMuX2dldChlbCk7XG5cdFx0XHRcdHJyLnB1c2gob1tmdW5jTmFtZV0uYXBwbHkobywgZnVuY0FyZ3MpKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHJyO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogUHVibGljXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRoYXM6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0cmV0dXJuIGVsLmVpZCAmJiB0aGlzLl9pdGVtc0J5SWRbZWwuZWlkXSAhPT0gdm9pZCAwO1xuXHR9LFxuXG5cdGdldEl0ZW1zOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgaSwgaiwgZWwsIHJldCA9IFtdO1xuXHRcdGZvciAoaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyArK2kpIHtcblx0XHRcdGVsID0gYXJndW1lbnRzW2ldO1xuXHRcdFx0aWYgKGVsLmxlbmd0aCkge1xuXHRcdFx0XHRmb3IgKGogPSAwOyBqIDwgZWwubGVuZ3RoOyArK2opIHtcblx0XHRcdFx0XHRyZXQucHVzaCh0aGlzLl9nZXQoZWxbal0pKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0LnB1c2godGhpcy5fZ2V0KGVsKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXQ7XG5cdH0sXG5cblx0Z2V0OiBmdW5jdGlvbihlbCkge1xuXHRcdHJldHVybiB0aGlzLl9nZXQoZWwpO1xuXHR9LFxuXG5cdGFkZDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGksIGosIGVsO1xuXHRcdGZvciAoaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyArK2kpIHtcblx0XHRcdGVsID0gYXJndW1lbnRzW2ldO1xuXHRcdFx0aWYgKGVsLmxlbmd0aCkge1xuXHRcdFx0XHRmb3IgKGogPSAwOyBqIDwgZWwubGVuZ3RoOyArK2opIHtcblx0XHRcdFx0XHR0aGlzLl9nZXQoZWxbal0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLl9nZXQoZWwpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBpLCBqLCBlbDtcblx0XHRmb3IgKGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgKytpKSB7XG5cdFx0XHRlbCA9IGFyZ3VtZW50c1tpXTtcblx0XHRcdGlmIChlbC5sZW5ndGgpIHtcblx0XHRcdFx0Zm9yIChqID0gMDsgaiA8IGVsLmxlbmd0aDsgKytqKSB7XG5cdFx0XHRcdFx0dGhpcy5fcmVtb3ZlKGVsW2pdKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5fcmVtb3ZlKGVsKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogcHVibGljXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyogcHVibGljOiBzaW5nbGUgYXJnXG5cdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblxuXHRoYXNPZmZzZXQ6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0cmV0dXJuIHRoaXMuaGFzKGVsKSA/IHRoaXMuX2l0ZW1zQnlJZFtlbC5laWRdLmhhc09mZnNldCA6ICh2b2lkIDApO1xuXHR9LFxuXG5cdC8qIHB1YmxpYzogY2FwdHVyZVxuXHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cblx0Y2FwdHVyZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5faW52b2tlKFwiY2FwdHVyZVwiLCBhcmd1bWVudHMpO1xuXHR9LFxuXHRjYXB0dXJlQWxsOiBmdW5jdGlvbigpIHtcblx0XHRmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLl9pdGVtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHR0aGlzLl9pdGVtc1tpXS5jYXB0dXJlKCk7XG5cdFx0fVxuXHR9LFxuXG5cdGNsZWFyQ2FwdHVyZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5faW52b2tlKFwiY2xlYXJDYXB0dXJlXCIsIGFyZ3VtZW50cyk7XG5cdH0sXG5cdGNsZWFyQWxsQ2FwdHVyZXM6IGZ1bmN0aW9uKCkge1xuXHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMuX2l0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHRoaXMuX2l0ZW1zW2ldLmNsZWFyQ2FwdHVyZSgpO1xuXHRcdH1cblx0fSxcblxuXHQvKiBwdWJsaWM6IG9mZnNldFxuXHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cdG9mZnNldDogZnVuY3Rpb24oeCwgeSkge1xuXHRcdHRoaXMuX2ludm9rZShcIm9mZnNldFwiLCBhcmd1bWVudHMsIDIpO1xuXHR9LFxuXHRvZmZzZXRBbGw6IGZ1bmN0aW9uKHgsIHkpIHtcblx0XHRmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLl9pdGVtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHR0aGlzLl9pdGVtc1tpXS5vZmZzZXQoeCwgeSk7XG5cdFx0fVxuXHR9LFxuXG5cdGNsZWFyT2Zmc2V0OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9pbnZva2UoXCJjbGVhck9mZnNldFwiLCBhcmd1bWVudHMpO1xuXHR9LFxuXHRjbGVhckFsbE9mZnNldHM6IGZ1bmN0aW9uKCkge1xuXHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMuX2l0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHRoaXMuX2l0ZW1zW2ldLmNsZWFyT2Zmc2V0KCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIHB1YmxpYzogdHJhbnNpdGlvbnNcblx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXG5cdHJ1blRyYW5zaXRpb246IGZ1bmN0aW9uKHRyYW5zaXRpb24pIHtcblx0XHR0aGlzLl9pbnZva2UoXCJydW5UcmFuc2l0aW9uXCIsIGFyZ3VtZW50cywgMSk7XG5cdH0sXG5cdHJ1bkFsbFRyYW5zaXRpb25zOiBmdW5jdGlvbih0cmFuc2l0aW9uKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5faXRlbXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0dGhpcy5faXRlbXNbaV0ucnVuVHJhbnNpdGlvbih0cmFuc2l0aW9uKTtcblx0XHR9XG5cdH0sXG5cblx0Y2xlYXJUcmFuc2l0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9pbnZva2UoXCJjbGVhclRyYW5zaXRpb25cIiwgYXJndW1lbnRzKTtcblx0fSxcblx0Y2xlYXJBbGxUcmFuc2l0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5faXRlbXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0dGhpcy5faXRlbXNbaV0uY2xlYXJUcmFuc2l0aW9uKCk7XG5cdFx0fVxuXHR9LFxuXG5cdHN0b3BUcmFuc2l0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9pbnZva2UoXCJzdG9wVHJhbnNpdGlvblwiLCBhcmd1bWVudHMpO1xuXHR9LFxuXHRzdG9wQWxsVHJhbnNpdGlvbnM6IGZ1bmN0aW9uKCkge1xuXHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMuX2l0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHRoaXMuX2l0ZW1zW2ldLnN0b3BUcmFuc2l0aW9uKCk7XG5cdFx0fVxuXHR9LFxuXG5cdHdoZW5UcmFuc2l0aW9uRW5kczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHJlcyA9IHRoaXMuX2ludm9rZShcIndoZW5UcmFuc2l0aW9uRW5kc1wiLCBhcmd1bWVudHMpO1xuXHRcdHJldHVybiByZXMubGVuZ3RoICE9IDAgP1xuXHRcdFx0UHJvbWlzZS5hbGwocmVzKSA6XG5cdFx0XHRQcm9taXNlLnJlc29sdmUobnVsbCk7XG5cdH0sXG5cdHdoZW5BbGxUcmFuc2l0aW9uc0VuZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICh0aGlzLl9pdGVtcy5sZW5ndGggIT0gMCkgPyBQcm9taXNlLmFsbCh0aGlzLl9pdGVtcy5tYXAoZnVuY3Rpb24obykge1xuXHRcdFx0cmV0dXJuIG8ud2hlblRyYW5zaXRpb25FbmRzKCk7XG5cdFx0fSkpIDogUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuXHR9LFxuXG5cdHByb21pc2U6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09IDAgP1xuXHRcdFx0dGhpcy53aGVuQWxsVHJhbnNpdGlvbnNFbmQoKSA6XG5cdFx0XHR0aGlzLndoZW5UcmFuc2l0aW9uRW5kcy5jYWxsKHRoaXMsIGFyZ3VtZW50cyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiB2YWxpZGF0aW9uXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHR2YWxpZGF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5faXRlbXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0dGhpcy5faXRlbXNbaV0udmFsaWRhdGUoKTtcblx0XHR9XG5cdH0sXG59LCB7XG5cdGl0ZW1zOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9pdGVtcztcblx0XHR9XG5cdH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRyYW5zZm9ybUhlbHBlcjtcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIEltcG9ydHNcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkUHJvcGVydHl9ICovXG52YXIgcHJlZml4ZWRQcm9wZXJ0eSA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFByb3BlcnR5XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRTdHlsZU5hbWV9ICovXG52YXIgcHJlZml4ZWRTdHlsZU5hbWUgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRTdHlsZU5hbWVcIik7XG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZEV2ZW50fSAqL1xudmFyIHByZWZpeGVkRXZlbnQgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRFdmVudFwiKTtcblxuLyoqIEB0eXBlIHtTdHJpbmd9ICovXG52YXIgdHJhbnNpdGlvbkVuZCA9IHByZWZpeGVkRXZlbnQoXCJ0cmFuc2l0aW9uZW5kXCIpOyAvL3JlcXVpcmUoXCJ1dGlscy9ldmVudC90cmFuc2l0aW9uRW5kXCIpO1xuLy8gLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi8vLyB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL2RlYnVnL3RyYWNlRWxlbWVudH0gKi9cbi8vIHZhciB0cmFjZUVsdCA9IHJlcXVpcmUoXCIuL2RlYnVnL3RyYWNlRWxlbWVudFwiKTtcbi8vIHZhciB0cmFjZUVsdENhY2hlID0ge307XG4vLyB2YXIgbG9nID0gZnVuY3Rpb24oKSB7XG4vLyBcdHZhciBsb2dGbiA9IFwibG9nXCI7XG4vLyBcdHZhciBhcmdzID0gc2xpY2UuYXBwbHkoYXJndW1lbnRzKTtcbi8vIFx0c3dpdGNoKGFyZ3NbMF0pIHtcbi8vIFx0XHRjYXNlIFwiZXJyb3JcIjpcbi8vIFx0XHRjYXNlIFwid2FyblwiOlxuLy8gXHRcdGNhc2UgXCJpbmZvXCI6XG4vLyBcdFx0XHRsb2dGbiA9IGFyZ3Muc2hpZnQoKTtcbi8vIFx0XHRcdGJyZWFrO1xuLy8gXHRcdGRlZmF1bHQ6XG4vLyBcdFx0XHQvLyBicmVhaztcbi8vIFx0XHRcdHJldHVybjtcbi8vIFx0fVxuLy8gXHR2YXIgZWwsIHR4SWQ7XG4vLyBcdGlmICgoZWwgPSBhcmdzWzBdKSAmJiAodHhJZCA9IGVsLmVpZCkpIHtcbi8vIFx0XHRhcmdzWzBdID0gdHJhY2VFbHRDYWNoZVt0eElkXSB8fCAodHJhY2VFbHRDYWNoZVt0eElkXSA9IGVsKTtcbi8vIFx0fVxuLy8gXHRhcmdzWzBdID0gXCJcXHRcIiArIGFyZ3NbMF07XG4vLyBcdGNvbnNvbGVbbG9nRm5dLmFwcGx5KGNvbnNvbGUsIGFyZ3MpO1xuLy8gfTtcblxuLyoganNoaW50IC1XMDc5ICovXG4vLyB2YXIgY29uc29sZSA9IChmdW5jdGlvbih0YXJnZXQpIHtcbi8vIFx0cmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRhcmdldCkucmVkdWNlKGZ1bmN0aW9uKHByb3h5LCBwcm9wKSB7XG4vLyBcdFx0aWYgKCh0eXBlb2YgdGFyZ2V0W3Byb3BdKSA9PSBcImZ1bmN0aW9uXCIpIHtcbi8vIFx0XHRcdHN3aXRjaCAocHJvcCkge1xuLy8gXHRcdFx0XHRjYXNlIFwiZXJyb3JcIjpcbi8vIFx0XHRcdFx0Y2FzZSBcIndhcm5cIjpcbi8vIFx0XHRcdFx0Y2FzZSBcImluZm9cIjpcbi8vIFx0XHRcdFx0XHRwcm94eVtwcm9wXSA9IGZ1bmN0aW9uICgpIHtcbi8vIFx0XHRcdFx0XHRcdHZhciBhcmdzID0gc2xpY2UuYXBwbHkoYXJndW1lbnRzKTtcbi8vIFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgYXJnc1swXSA9PSBcInN0cmluZ1wiKSB7XG4vLyBcdFx0XHRcdFx0XHRcdGFyZ3NbMF0gPSBwcm9wICsgXCI6OlwiICsgYXJnc1swXTtcbi8vIFx0XHRcdFx0XHRcdH1cbi8vIFx0XHRcdFx0XHRcdHJldHVybiB0YXJnZXRbcHJvcF0uYXBwbHkodGFyZ2V0LCBhcmdzKTtcbi8vIFx0XHRcdFx0XHR9O1xuLy8gXHRcdFx0XHRcdGJyZWFrO1xuLy8gXHRcdFx0XHRjYXNlIFwibG9nXCI6XG4vLyBcdFx0XHRcdFx0cHJveHlbcHJvcF0gPSBmdW5jdGlvbigpIHt9O1xuLy8gXHRcdFx0XHRcdGJyZWFrO1xuLy8gXHRcdFx0XHRkZWZhdWx0OlxuLy8gXHRcdFx0XHRcdHByb3h5W3Byb3BdID0gdGFyZ2V0W3Byb3BdLmJpbmQodGFyZ2V0KTtcbi8vIFx0XHRcdFx0XHRicmVhaztcbi8vIFx0XHRcdH1cbi8vIFx0XHR9IGVsc2Uge1xuLy8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3h5LCBwcm9wLCB7XG4vLyBcdFx0XHRcdGdldDogZnVuY3Rpb24oKSB7IHJldHVybiB0YXJnZXRbcHJvcF07IH0sXG4vLyBcdFx0XHRcdHNldDogZnVuY3Rpb24odmFsKSB7IHRhcmdldFtwcm9wXSA9IHZhbDsgfVxuLy8gXHRcdFx0fSk7XG4vLyBcdFx0fVxuLy8gXHRcdHJldHVybiBwcm94eTtcbi8vIFx0fSwge30pO1xuLy8gfSkod2luZG93LmNvbnNvbGUpO1xuLyoganNoaW50ICtXMDc5ICovXG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIFByaXZhdGUgc3RhdGljXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbnZhciBOT19UUkFOU0lUSU9OID0gXCJub25lIDBzIHN0ZXAtc3RhcnQgMHNcIjtcblxuXG4vLyB2YXIgdHJhbnNsYXRlVGVtcGxhdGUgPSBmdW5jdGlvbihvKSB7XG4vLyBcdC8vIHJldHVybiBcInRyYW5zbGF0ZShcIiArIG8uX3JlbmRlcmVkWCArIFwicHgsIFwiICsgby5fcmVuZGVyZWRZICsgXCJweClcIjtcbi8vIFx0Ly8gcmV0dXJuIFwidHJhbnNsYXRlM2QoXCIgKyBvLl9yZW5kZXJlZFggKyBcInB4LCBcIiArIG8uX3JlbmRlcmVkWSArIFwicHgsIDBweClcIjtcbi8vIH07XG5cbnZhciB0cmFuc2xhdGVUZW1wbGF0ZSA9IChmdW5jdGlvbigpIHtcblx0dmFyIGZuID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIikuVFJBTlNMQVRFX1RFTVBMQVRFO1xuXHRyZXR1cm4gZnVuY3Rpb24obykge1xuXHRcdHJldHVybiBmbihvLl9yZW5kZXJlZFgsIG8uX3JlbmRlcmVkWSk7XG5cdH07XG59KCkpO1xuXG52YXIgdHJhbnNpdGlvblRlbXBsYXRlID0gZnVuY3Rpb24obykge1xuXHRyZXR1cm4gby5wcm9wZXJ0eSArIFwiIFwiICsgby5kdXJhdGlvbiAvIDEwMDAgKyBcInMgXCIgKyBvLmVhc2luZyArIFwiIFwiICsgby5kZWxheSAvIDEwMDAgKyBcInNcIjtcbn07XG5cbnZhciBVTlNFVF9UUkFOU0lUSU9OID0ge1xuXHRuYW1lOiBcInVuc2V0XCIsXG5cdGNsYXNzTmFtZTogXCJ0eC11bnNldFwiLFxuXHRwcm9wZXJ0eTogXCJub25lXCIsXG5cdGVhc2luZzogXCJlYXNlXCIsXG5cdGRlbGF5OiAwLFxuXHRkdXJhdGlvbjogMCxcblx0Y3NzVGV4dDogXCJ1bnNldFwiLFxufTtcblxuLy8gdmFyIHRyYW5zaXRpb25UZW1wbGF0ZSA9IF8udGVtcGxhdGUoXCI8JT0gcHJvcGVydHkgJT4gPCUgZHVyYXRpb24vMTAwMCAlPnMgPCU9IGVhc2luZyAlPiA8JSBkZWxheS8xMDAwICU+c1wiKTtcbi8vIHZhciBOT19UUkFOU0lUSU9OID0gXCJhbGwgMC4wMDFzIHN0ZXAtc3RhcnQgMC4wMDFzXCI7XG5cbnZhciBwcm9wRGVmYXVsdHMgPSB7XG5cdFwib3BhY2l0eVwiOiBcIjFcIixcblx0XCJ2aXNpYmlsaXR5XCI6IFwidmlzaWJsZVwiLFxuXHRcInRyYW5zZm9ybVwiOiBcIm1hdHJpeCgxLCAwLCAwLCAxLCAwLCAwKVwiLFxuXHRcInRyYW5zZm9ybVN0eWxlXCI6IFwiXCIsXG5cdFwidHJhbnNpdGlvblwiOiBcIlwiLFxuXHQvLyBcIndpbGxDaGFuZ2VcIjogXCJcIixcblx0Ly8gXCJ0cmFuc2l0aW9uRHVyYXRpb25cIjogXCIwc1wiLFxuXHQvLyBcInRyYW5zaXRpb25EZWxheVwiOiBcIjBzXCIsXG5cdC8vIFwidHJhbnNpdGlvblByb3BlcnR5XCI6IFwibm9uZVwiLFxuXHQvLyBcInRyYW5zaXRpb25UaW1pbmdGdW5jdGlvblwiOiBcImVhc2VcIlxufTtcbnZhciBwcm9wS2V5cyA9IE9iamVjdC5rZXlzKHByb3BEZWZhdWx0cyk7XG52YXIgcHJvcE5hbWVzID0gcHJvcEtleXMucmVkdWNlKGZ1bmN0aW9uKG9iaiwgcHJvcE5hbWUpIHtcblx0b2JqW3Byb3BOYW1lXSA9IHByZWZpeGVkUHJvcGVydHkocHJvcE5hbWUpO1xuXHRyZXR1cm4gb2JqO1xufSwge30pO1xuXG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9zdHJpbmdzL2NhbWVsVG9EYXNoZWR9ICovXG52YXIgY2FtZWxUb0Rhc2hlZCA9IHJlcXVpcmUoXCJ1dGlscy9zdHJpbmdzL2NhbWVsVG9EYXNoZWRcIik7XG52YXIgc3R5bGVOYW1lcyA9IHByb3BLZXlzLm1hcChjYW1lbFRvRGFzaGVkKS5yZWR1Y2UoZnVuY3Rpb24ob2JqLCBwcm9wTmFtZSkge1xuXHRvYmpbcHJvcE5hbWVdID0gcHJlZml4ZWRTdHlsZU5hbWUocHJvcE5hbWUpO1xuXHRyZXR1cm4gb2JqO1xufSwge30pO1xuXG52YXIgcmVzb2x2ZUFsbCA9IGZ1bmN0aW9uKHBwLCByZXN1bHQpIHtcblx0aWYgKHBwLmxlbmd0aCAhPSAwKSB7XG5cdFx0cHAuZm9yRWFjaChmdW5jdGlvbihwLCBpLCBhKSB7XG5cdFx0XHRwLnJlc29sdmUocmVzdWx0KTtcblx0XHRcdGFbaV0gPSBudWxsO1xuXHRcdH0pO1xuXHRcdHBwLmxlbmd0aCA9IDA7XG5cdH1cblx0cmV0dXJuIHBwO1xufTtcblxudmFyIHJlamVjdEFsbCA9IGZ1bmN0aW9uKHBwLCByZWFzb24pIHtcblx0aWYgKHBwLmxlbmd0aCAhPSAwKSB7XG5cdFx0cHAuZm9yRWFjaChmdW5jdGlvbihwLCBpLCBhKSB7XG5cdFx0XHRwLnJlamVjdChyZWFzb24pO1xuXHRcdFx0YVtpXSA9IG51bGw7XG5cdFx0fSk7XG5cdFx0cHAubGVuZ3RoID0gMDtcblx0fVxuXHRyZXR1cm4gcHA7XG59O1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBUcmFuc2Zvcm1JdGVtXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIFRyYW5zZm9ybUl0ZW0oZWwsIGlkKSB7XG5cdF8uYmluZEFsbCh0aGlzLCBcIl9vblRyYW5zaXRpb25FbmRcIik7XG5cblx0dGhpcy5lbCA9IGVsO1xuXHR0aGlzLmlkID0gaWQ7XG5cdHRoaXMuZWwuZWlkID0gaWQ7XG5cdHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kLCB0aGlzLl9vblRyYW5zaXRpb25FbmQsIGZhbHNlKTtcblxuXHR0aGlzLl9jYXB0dXJlSW52YWxpZCA9IGZhbHNlO1xuXHR0aGlzLl9jYXB0dXJlZENoYW5nZWQgPSBmYWxzZTtcblx0dGhpcy5fY2FwdHVyZWRYID0gbnVsbDtcblx0dGhpcy5fY2FwdHVyZWRZID0gbnVsbDtcblx0dGhpcy5fY3VyckNhcHR1cmUgPSB7fTtcblx0dGhpcy5fbGFzdENhcHR1cmUgPSB7fTtcblxuXHR0aGlzLl9oYXNPZmZzZXQgPSBmYWxzZTtcblx0dGhpcy5fb2Zmc2V0SW52YWxpZCA9IGZhbHNlO1xuXHR0aGlzLl9vZmZzZXRYID0gbnVsbDtcblx0dGhpcy5fb2Zmc2V0WSA9IG51bGw7XG5cblx0dGhpcy5fcmVuZGVyZWRYID0gbnVsbDtcblx0dGhpcy5fcmVuZGVyZWRZID0gbnVsbDtcblxuXHR0aGlzLl9oYXNUcmFuc2l0aW9uID0gZmFsc2U7XG5cdHRoaXMuX3RyYW5zaXRpb25JbnZhbGlkID0gZmFsc2U7XG5cdHRoaXMuX3RyYW5zaXRpb25SdW5uaW5nID0gZmFsc2U7XG5cdHRoaXMuX3RyYW5zaXRpb24gPSBfLmV4dGVuZCh7fSwgVU5TRVRfVFJBTlNJVElPTik7IC8ve307XG5cblx0dGhpcy5fcHJvbWlzZXMgPSBbXTtcblx0dGhpcy5fcGVuZGluZ1Byb21pc2VzID0gW107XG59XG5cblRyYW5zZm9ybUl0ZW0ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSh7XG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBQdWJsaWNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qIGRlc3Ryb3lcblx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHQvLyBOT1RFOiBzdHlsZSBwcm9wZXJ0eSBtYXkgaGF2ZSBiZWVuIG1vZGlmaWVkOyBjbGVhck9mZnNldChlbGVtZW50KSBzaG91bGRcblx0XHQvLyBiZSBjYWxsZWQgZXhwbGljaXRseSBpZiBjbGVhbiB1cCBpcyByZXF1aXJlZC5cblx0XHR0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIodHJhbnNpdGlvbkVuZCwgdGhpcy5fb25UcmFuc2l0aW9uRW5kLCBmYWxzZSk7XG5cdFx0cmVqZWN0QWxsKHRoaXMuX3BlbmRpbmdQcm9taXNlcywgdGhpcy5lbCk7XG5cdFx0cmVqZWN0QWxsKHRoaXMuX3Byb21pc2VzLCB0aGlzLmVsKTtcblx0XHQvLyBkZWxldGUgdGhpcy5lbC5laWQ7XG5cdH0sXG5cblx0LyogY2FwdHVyZVxuXHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cdGNhcHR1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwidHhbJXNdOjpjYXB0dXJlXCIsIHRoaXMuaWQpO1xuXHRcdHRoaXMuX3ZhbGlkYXRlQ2FwdHVyZSgpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGNsZWFyQ2FwdHVyZTogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106OmNsZWFyQ2FwdHVyZVwiLCB0aGlzLmlkKTtcblx0XHQvLyB0aGlzLl9oYXNPZmZzZXQgPSBmYWxzZTtcblx0XHR0aGlzLl9jYXB0dXJlSW52YWxpZCA9IHRydWU7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0Lyogb2Zmc2V0L2NsZWFyXG5cdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblx0b2Zmc2V0OiBmdW5jdGlvbih4LCB5KSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106Om9mZnNldFwiLCB0aGlzLmlkKTtcblxuXHRcdHRoaXMuX2hhc09mZnNldCA9IHRydWU7XG5cdFx0dGhpcy5fb2Zmc2V0SW52YWxpZCA9IHRydWU7XG5cdFx0dGhpcy5fb2Zmc2V0WCA9IHggfHwgMDtcblx0XHR0aGlzLl9vZmZzZXRZID0geSB8fCAwO1xuXHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRjbGVhck9mZnNldDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX2hhc09mZnNldCkge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106OmNsZWFyT2Zmc2V0XCIsIHRoaXMuaWQpO1xuXG5cdFx0XHR0aGlzLl9oYXNPZmZzZXQgPSBmYWxzZTtcblx0XHRcdHRoaXMuX29mZnNldEludmFsaWQgPSB0cnVlO1xuXHRcdFx0dGhpcy5fb2Zmc2V0WCA9IG51bGw7XG5cdFx0XHR0aGlzLl9vZmZzZXRZID0gbnVsbDtcblx0XHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106OmNsZWFyT2Zmc2V0IG5vIG9mZnNldCB0byBjbGVhclwiLCB0aGlzLmlkKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyogdHJhbnNpdGlvbnNcblx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRydW5UcmFuc2l0aW9uOiBmdW5jdGlvbih0cmFuc2l0aW9uKSB7XG5cdFx0aWYgKCF0cmFuc2l0aW9uKSB7IC8vIHx8ICh0cmFuc2l0aW9uLmR1cmF0aW9uICsgdHJhbnNpdGlvbi5kZWxheSkgPT0gMCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2xlYXJUcmFuc2l0aW9uKCk7XG5cdFx0fVxuXHRcdHZhciBsYXN0VmFsdWUgPSB0aGlzLl90cmFuc2l0aW9uVmFsdWU7XG5cdFx0dmFyIGxhc3ROYW1lID0gdGhpcy5fdHJhbnNpdGlvbi5uYW1lO1xuXHRcdHRoaXMuX3RyYW5zaXRpb24ucHJvcGVydHkgPSBzdHlsZU5hbWVzW1widHJhbnNmb3JtXCJdO1xuXHRcdHRoaXMuX3RyYW5zaXRpb24gPSBfLmV4dGVuZCh0aGlzLl90cmFuc2l0aW9uLCB0cmFuc2l0aW9uKTtcblx0XHR0aGlzLl90cmFuc2l0aW9uVmFsdWUgPSB0cmFuc2l0aW9uVGVtcGxhdGUodGhpcy5fdHJhbnNpdGlvbik7XG5cblx0XHRpZiAodGhpcy5fdHJhbnNpdGlvbkludmFsaWQpIHtcblx0XHRcdGNvbnNvbGUud2FybihcInR4WyVzXTo6cnVuVHJhbnNpdGlvbiBzZXQgb3ZlciAoJXM6JyVzJyA9PiAlczonJXMnKVwiLCB0aGlzLmlkLFxuXHRcdFx0XHRsYXN0TmFtZSwgbGFzdFZhbHVlLCB0aGlzLl90cmFuc2l0aW9uLm5hbWUsIHRoaXMuX3RyYW5zaXRpb25WYWx1ZSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5faGFzVHJhbnNpdGlvbiA9IHRydWU7XG5cdFx0dGhpcy5fdHJhbnNpdGlvbkludmFsaWQgPSB0cnVlO1xuXHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVUcmFuc2l0aW9uKCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0Y2xlYXJUcmFuc2l0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl90cmFuc2l0aW9uID0gXy5leHRlbmQodGhpcy5fdHJhbnNpdGlvbiwgVU5TRVRfVFJBTlNJVElPTik7XG5cdFx0dGhpcy5fdHJhbnNpdGlvblZhbHVlID0gTk9fVFJBTlNJVElPTjtcblxuXHRcdHRoaXMuX2hhc1RyYW5zaXRpb24gPSBmYWxzZTtcblx0XHR0aGlzLl90cmFuc2l0aW9uSW52YWxpZCA9IHRydWU7XG5cdFx0Ly8gaWYgKHRoaXMuaW1tZWRpYXRlKSB0aGlzLl92YWxpZGF0ZVRyYW5zaXRpb24oKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRzdG9wVHJhbnNpdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gdGhpcy5fdHJhbnNpdGlvbi5uYW1lID0gXCJbbm9uZV1cIjtcblx0XHQvLyB0aGlzLl90cmFuc2l0aW9uLnByb3BlcnR5ID0gXCJub25lXCI7XG5cdFx0dGhpcy5fdHJhbnNpdGlvbiA9IF8uZXh0ZW5kKHRoaXMuX3RyYW5zaXRpb24sIFVOU0VUX1RSQU5TSVRJT04pO1xuXHRcdHRoaXMuX3RyYW5zaXRpb25WYWx1ZSA9IE5PX1RSQU5TSVRJT047XG5cblx0XHR0aGlzLl9oYXNUcmFuc2l0aW9uID0gZmFsc2U7XG5cdFx0dGhpcy5fdHJhbnNpdGlvbkludmFsaWQgPSB0cnVlO1xuXHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVUcmFuc2l0aW9uKCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0d2hlblRyYW5zaXRpb25FbmRzOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZCwgcCwgcHA7XG5cdFx0aWYgKHRoaXMuX3RyYW5zaXRpb25JbnZhbGlkIHx8IHRoaXMuX3RyYW5zaXRpb25SdW5uaW5nKSB7XG5cdFx0XHRkID0ge307XG5cdFx0XHRwID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRcdGQucmVzb2x2ZSA9IHJlc29sdmU7XG5cdFx0XHRcdGQucmVqZWN0ID0gcmVqZWN0O1xuXHRcdFx0fSk7XG5cdFx0XHRwcCA9IHRoaXMuX3RyYW5zaXRpb25JbnZhbGlkID8gdGhpcy5fcGVuZGluZ1Byb21pc2VzIDogdGhpcy5fcHJvbWlzZXM7XG5cdFx0XHRwcC5wdXNoKGQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRwID0gUHJvbWlzZS5yZXNvbHZlKHRoaXMuZWwpO1xuXHRcdH1cblx0XHRyZXR1cm4gcDtcblx0fSxcblxuXHQvKiB2YWxpZGF0aW9uXG5cdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblx0dmFsaWRhdGU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kLCB0aGlzLl9vblRyYW5zaXRpb25FbmQsIGZhbHNlKTtcblx0XHR0aGlzLl9pZ25vcmVFdmVudCA9IHRydWU7XG5cblx0XHRpZiAodGhpcy5fY2FwdHVyZUludmFsaWQpIHtcblx0XHRcdHZhciBsYXN0WCA9ICh0aGlzLl9yZW5kZXJlZFggIT09IG51bGwgPyB0aGlzLl9yZW5kZXJlZFggOiB0aGlzLl9jYXB0dXJlZFgpLFxuXHRcdFx0XHRsYXN0WSA9ICh0aGlzLl9yZW5kZXJlZFkgIT09IG51bGwgPyB0aGlzLl9yZW5kZXJlZFkgOiB0aGlzLl9jYXB0dXJlZFkpO1xuXG5cdFx0XHQvLyB0aGlzLl92YWxpZGF0ZVRyYW5zaXRpb24oKTtcblx0XHRcdHRoaXMuX3ZhbGlkYXRlQ2FwdHVyZSgpO1xuXHRcdFx0dGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblxuXHRcdFx0dmFyIGN1cnJYID0gKHRoaXMuX3JlbmRlcmVkWCAhPT0gbnVsbCA/IHRoaXMuX3JlbmRlcmVkWCA6IHRoaXMuX2NhcHR1cmVkWCksXG5cdFx0XHRcdGN1cnJZID0gKHRoaXMuX3JlbmRlcmVkWSAhPT0gbnVsbCA/IHRoaXMuX3JlbmRlcmVkWSA6IHRoaXMuX2NhcHR1cmVkWSk7XG5cblx0XHRcdGlmIChsYXN0WCA9PT0gY3VyclggJiYgbGFzdFkgPT09IGN1cnJZKSB7XG5cdFx0XHRcdHRoaXMuX2hhc1RyYW5zaXRpb24gJiYgY29uc29sZS53YXJuKFwidHhbJXNdOjp2YWxpZGF0ZSB1bmNoYW5nZWQ6IGxhc3Q6WyVpLCVpXSBjdXJyOlslaSwlaV1cIiwgdGhpcy5lbC5pZCB8fCB0aGlzLmlkLCBsYXN0WCwgbGFzdFksIGN1cnJYLCBjdXJyWSk7XG5cdFx0XHRcdC8vIGNvbnNvbGUuaW5mbyhcInR4WyVzXTo6dmFsaWRhdGUgdW5jaGFuZ2VkOiBsYXN0OlslZiwlZl0gY3VycjpbJWYsJWZdIHJlbmRlcjpbJWYsJWZdIGNhcHR1cmVkWyVmLCVmXVwiLCB0aGlzLmVsLmlkIHx8IHRoaXMuaWQsIGxhc3RYLCBsYXN0WSwgY3VyclgsIGN1cnJZLCB0aGlzLl9yZW5kZXJlZFgsIHRoaXMuX3JlbmRlcmVkWSwgdGhpcy5fY2FwdHVyZWRYLCB0aGlzLl9jYXB0dXJlZFkpO1xuXHRcdFx0XHR0aGlzLmNsZWFyVHJhbnNpdGlvbigpO1xuXHRcdFx0XHQvLyB0aGlzLl92YWxpZGF0ZVRyYW5zaXRpb24oKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3ZhbGlkYXRlVHJhbnNpdGlvbigpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyB0aGlzLl92YWxpZGF0ZUNhcHR1cmUoKTtcblx0XHRcdHRoaXMuX3ZhbGlkYXRlVHJhbnNpdGlvbigpO1xuXHRcdFx0dGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblx0XHR9XG5cblx0XHQvLyB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIodHJhbnNpdGlvbkVuZCwgdGhpcy5fb25UcmFuc2l0aW9uRW5kLCBmYWxzZSk7XG5cdFx0dGhpcy5faWdub3JlRXZlbnQgPSBmYWxzZTtcblxuXHRcdC8vIGlmICh0aGlzLl9jYXB0dXJlZENoYW5nZWQpIHtcblx0XHQvLyBcdGNvbnNvbGUuZXJyb3IoXCJ0eFslc106OnZhbGlkYXRlIGNhcHR1cmUgY2hhbmdlZDogWyVmLCVmXVwiLCB0aGlzLmlkLCB0aGlzLl9jYXB0dXJlZFgsIHRoaXMuX2NhcHR1cmVkWSk7XG5cdFx0Ly8gfVxuXHRcdHRoaXMuX2NhcHR1cmVkQ2hhbmdlZCA9IGZhbHNlO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogUHJpdmF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X3ZhbGlkYXRlQ2FwdHVyZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCF0aGlzLl9jYXB0dXJlSW52YWxpZCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHQvLyB2YXIgY29tcHV0ZWQsIGNhcHR1cmVkVmFsdWVzO1xuXHRcdHZhciB0cmFuc2Zvcm1WYWx1ZSA9IG51bGw7XG5cblx0XHRpZiAodGhpcy5faGFzT2Zmc2V0ICYmICF0aGlzLl9vZmZzZXRJbnZhbGlkKSB7XG5cdFx0XHQvLyB0aGlzIGlzIGFuIGV4cGxpY2l0IGNhbGwgdG8gY2FwdHVyZSgpIGluc3RlYWQgb2YgYSBzdWJjYWxsIGZyb20gX3ZhbGlkYXRlT2Zmc2V0KClcblx0XHRcdHRyYW5zZm9ybVZhbHVlID0gdGhpcy5fZ2V0Q1NTUHJvcChcInRyYW5zZm9ybVwiKTtcblx0XHRcdGlmICh0cmFuc2Zvcm1WYWx1ZSA9PT0gXCJcIikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKFwidHhbJXNdOjpfY2FwdHVyZSB2YWxpZCBvZmZzZXQgKCVpLCRpKSBidXQgdHJhbnNmb3JtVmFsdWU9XFxcIlxcXCJcIiwgdGhpcy5pZCwgdGhpcy5fb2Zmc2V0WCwgdGhpcy5fb2Zmc2V0WSk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl9yZW1vdmVDU1NQcm9wKFwidHJhbnNmb3JtXCIpO1xuXHRcdH1cblxuXHRcdC8vIE5PVEU6IHJldXNpbmcgb2JqZWN0LCBhbGwgcHJvcHMgd2lsbCBiZSBvdmVyd3JpdHRlblxuXHRcdHRoaXMuX2xhc3RDYXB0dXJlID0gdGhpcy5fY3VyckNhcHR1cmU7XG5cdFx0dGhpcy5fY3VyckNhcHR1cmUgPSB0aGlzLl9nZXRDb21wdXRlZENTU1Byb3BzKCk7XG5cblx0XHRpZiAodGhpcy5fY3VyckNhcHR1cmUudHJhbnNmb3JtICE9PSB0aGlzLl9sYXN0Q2FwdHVyZS50cmFuc2Zvcm0pIHtcblx0XHRcdHZhciBtLCBtbTsgLy8sIHJldCA9IHt9O1xuXHRcdFx0bW0gPSB0aGlzLl9jdXJyQ2FwdHVyZS50cmFuc2Zvcm0ubWF0Y2goLyhtYXRyaXh8bWF0cml4M2QpXFwoKFteXFwpXSspXFwpLyk7XG5cdFx0XHRpZiAobW0pIHtcblx0XHRcdFx0bSA9IG1tWzJdLnNwbGl0KFwiLFwiKTtcblx0XHRcdFx0aWYgKG1tWzFdID09PSBcIm1hdHJpeFwiKSB7XG5cdFx0XHRcdFx0dGhpcy5fY2FwdHVyZWRYID0gcGFyc2VGbG9hdChtWzRdKTtcblx0XHRcdFx0XHR0aGlzLl9jYXB0dXJlZFkgPSBwYXJzZUZsb2F0KG1bNV0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuX2NhcHR1cmVkWCA9IHBhcnNlRmxvYXQobVsxMl0pO1xuXHRcdFx0XHRcdHRoaXMuX2NhcHR1cmVkWSA9IHBhcnNlRmxvYXQobVsxM10pO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLl9jYXB0dXJlZFggPSAwO1xuXHRcdFx0XHR0aGlzLl9jYXB0dXJlZFkgPSAwO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5fY2FwdHVyZWRDaGFuZ2VkID0gdHJ1ZTtcblx0XHR9XG5cdFx0aWYgKHRyYW5zZm9ybVZhbHVlICE9PSBudWxsKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcInR4WyVzXTo6X2NhcHR1cmUgcmVhcHBseWluZyAnJXMnXCIsIHRoaXMuaWQsIHRyYW5zZm9ybVZhbHVlKTtcblx0XHRcdHRoaXMuX3NldENTU1Byb3AoXCJ0cmFuc2Zvcm1cIiwgdHJhbnNmb3JtVmFsdWUpO1xuXHRcdH1cblx0XHR0aGlzLl9jYXB0dXJlSW52YWxpZCA9IGZhbHNlO1xuXHR9LFxuXG5cdF92YWxpZGF0ZU9mZnNldDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX29mZnNldEludmFsaWQpIHtcblx0XHRcdC8vIHRoaXMuX3ZhbGlkYXRlQ2FwdHVyZSgpO1xuXHRcdFx0dGhpcy5fb2Zmc2V0SW52YWxpZCA9IGZhbHNlO1xuXHRcdFx0aWYgKHRoaXMuX2hhc09mZnNldCkge1xuXHRcdFx0XHR2YXIgdHggPSB0aGlzLl9vZmZzZXRYICsgdGhpcy5fY2FwdHVyZWRYO1xuXHRcdFx0XHR2YXIgdHkgPSB0aGlzLl9vZmZzZXRZICsgdGhpcy5fY2FwdHVyZWRZO1xuXHRcdFx0XHRpZiAodHggIT09IHRoaXMuX3JlbmRlcmVkWCB8fCB0eSAhPT0gdGhpcy5fcmVuZGVyZWRZKSB7XG5cdFx0XHRcdFx0dGhpcy5fcmVuZGVyZWRYID0gdHg7XG5cdFx0XHRcdFx0dGhpcy5fcmVuZGVyZWRZID0gdHk7XG5cdFx0XHRcdFx0dGhpcy5fc2V0Q1NTUHJvcChcInRyYW5zZm9ybVwiLCB0cmFuc2xhdGVUZW1wbGF0ZSh0aGlzKSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuX3JlbmRlcmVkWCA9IG51bGw7XG5cdFx0XHRcdHRoaXMuX3JlbmRlcmVkWSA9IG51bGw7XG5cdFx0XHRcdHRoaXMuX3JlbW92ZUNTU1Byb3AoXCJ0cmFuc2Zvcm1cIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF92YWxpZGF0ZVRyYW5zaXRpb246IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl90cmFuc2l0aW9uSW52YWxpZCkge1xuXHRcdFx0Ly8gdGhpcy5fdmFsaWRhdGVDYXB0dXJlKCk7XG5cdFx0XHR0aGlzLl90cmFuc2l0aW9uSW52YWxpZCA9IGZhbHNlO1xuXG5cdFx0XHQvLyBzYXZlIHByb21pc2VzIG1hZGUgd2hpbGUgaW52YWxpZFxuXHRcdFx0dmFyIHJlamVjdCA9IHRoaXMuX3Byb21pc2VzO1xuXHRcdFx0Ly8gcHJlcGFyZSBfcHJvbWlzZXMgYW5kIHB1c2ggaW4gbmV3IG9uZXNcblx0XHRcdHRoaXMuX3Byb21pc2VzID0gdGhpcy5fcGVuZGluZ1Byb21pc2VzO1xuXHRcdFx0Ly8gd2hhdGV2ZXIgc3RpbGwgaGVyZSBpcyB0byBiZSByZWplY3RlZC4gcmV1c2UgYXJyYXlcblx0XHRcdHRoaXMuX3BlbmRpbmdQcm9taXNlcyA9IHJlamVjdEFsbChyZWplY3QsIHRoaXMuZWwpO1xuXG5cdFx0XHR0aGlzLl90cmFuc2l0aW9uUnVubmluZyA9IHRoaXMuX2hhc1RyYW5zaXRpb247XG5cdFx0XHR0aGlzLl9zZXRDU1NQcm9wKFwidHJhbnNpdGlvblwiLCB0aGlzLl90cmFuc2l0aW9uVmFsdWUpO1xuXG5cdFx0XHRpZiAoIXRoaXMuX2hhc1RyYW5zaXRpb24pIHtcblx0XHRcdFx0Ly8gbm8gdHJhbnNpdGlvbiwgcmVzb2x2ZSBub3dcblx0XHRcdFx0cmVzb2x2ZUFsbCh0aGlzLl9wcm9taXNlcywgdGhpcy5lbCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF9vblRyYW5zaXRpb25FbmQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0aWYgKHRoaXMuX2lnbm9yZUV2ZW50KSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGlmICh0aGlzLl90cmFuc2l0aW9uUnVubmluZyAmJiAodGhpcy5lbCA9PT0gZXYudGFyZ2V0KSAmJlxuXHRcdFx0KHRoaXMuX3RyYW5zaXRpb24ucHJvcGVydHkgPT0gZXYucHJvcGVydHlOYW1lKSkge1xuXHRcdFx0dGhpcy5faGFzVHJhbnNpdGlvbiA9IGZhbHNlO1xuXHRcdFx0dGhpcy5fdHJhbnNpdGlvblJ1bm5pbmcgPSBmYWxzZTtcblx0XHRcdHRoaXMuX3JlbW92ZUNTU1Byb3AoXCJ0cmFuc2l0aW9uXCIpO1xuXHRcdFx0cmVzb2x2ZUFsbCh0aGlzLl9wcm9taXNlcywgdGhpcy5lbCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogQ1NTXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfZ2V0Q1NTUHJvcDogZnVuY3Rpb24ocHJvcCkge1xuXHRcdHJldHVybiB0aGlzLmVsLnN0eWxlW3Byb3BOYW1lc1twcm9wXV07XG5cdFx0Ly8gcmV0dXJuIHRoaXMuZWwuc3R5bGVbcHJlZml4ZWRQcm9wZXJ0eShwcm9wKV07XG5cdFx0Ly8gcmV0dXJuIHRoaXMuZWwuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShzdHlsZU5hbWVzW3Byb3BdKTtcblx0fSxcblxuXHRfc2V0Q1NTUHJvcDogZnVuY3Rpb24ocHJvcCwgdmFsdWUpIHtcblx0XHRpZiAocHJvcCA9PT0gXCJ0cmFuc2l0aW9uXCIgJiYgdmFsdWUgPT0gTk9fVFJBTlNJVElPTikge1xuXHRcdFx0dmFsdWUgPSBcIlwiO1xuXHRcdH1cblx0XHRpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCB8fCB2YWx1ZSA9PT0gXCJcIikge1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ1NTUHJvcChwcm9wKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5lbC5zdHlsZVtwcm9wTmFtZXNbcHJvcF1dID0gdmFsdWU7XG5cdFx0XHQvLyB0aGlzLmVsLnN0eWxlLnNldFByb3BlcnR5KHN0eWxlTmFtZXNbcHJvcF0sIHZhbHVlKTtcblx0XHR9XG5cdH0sXG5cblx0X3JlbW92ZUNTU1Byb3A6IGZ1bmN0aW9uKHByb3ApIHtcblx0XHR0aGlzLmVsLnN0eWxlW3Byb3BOYW1lc1twcm9wXV0gPSBcIlwiO1xuXHRcdC8vIHRoaXMuZWwuc3R5bGUucmVtb3ZlUHJvcGVydHkoc3R5bGVOYW1lc1twcm9wXSk7XG5cdH0sXG5cblx0X2dldENvbXB1dGVkQ1NTUHJvcHM6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB2YWx1ZXMgPSB7fTtcblx0XHR2YXIgY29tcHV0ZWQgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsKTtcblx0XHRmb3IgKHZhciBwIGluIHByb3BOYW1lcykge1xuXHRcdFx0dmFsdWVzW3BdID0gY29tcHV0ZWRbcHJvcE5hbWVzW3BdXTtcblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlcztcblx0fSxcbn0sIHtcblx0dHJhbnNpdGlvbjoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fdHJhbnNpdGlvbjtcblx0XHR9XG5cdH0sXG5cdGhhc1RyYW5zaXRpb246IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2hhc1RyYW5zaXRpb247XG5cdFx0fVxuXHR9LFxuXHRjYXB0dXJlZENoYW5nZWQ6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2NhcHR1cmVkQ2hhbmdlZDtcblx0XHR9XG5cdH0sXG5cdGNhcHR1cmVkWDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fY2FwdHVyZWRYO1xuXHRcdH1cblx0fSxcblx0Y2FwdHVyZWRZOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9jYXB0dXJlZFk7XG5cdFx0fVxuXHR9LFxuXG5cdGhhc09mZnNldDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5faGFzT2Zmc2V0O1xuXHRcdH1cblx0fSxcblx0b2Zmc2V0WDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fb2Zmc2V0WDtcblx0XHR9XG5cdH0sXG5cdG9mZnNldFk6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX29mZnNldFk7XG5cdFx0fVxuXHR9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gVHJhbnNmb3JtSXRlbTsiLCJ2YXIgUEkyID0gTWF0aC5QSSAqIDI7XG5cbnZhciBzcGxpY2UgPSBBcnJheS5wcm90b3R5cGUuc3BsaWNlO1xuLy8gdmFyIGNvbmNhdCA9IEFycmF5LnByb3RvdHlwZS5jb25jYXQ7XG5cbnZhciBzZXRTdHlsZSA9IGZ1bmN0aW9uKGN0eCwgcykge1xuXHRpZiAodHlwZW9mIHMgIT0gXCJvYmplY3RcIikgcmV0dXJuO1xuXHRmb3IgKHZhciBwIGluIHMpIHtcblx0XHRzd2l0Y2ggKHR5cGVvZiBjdHhbcF0pIHtcblx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkoc1twXSkpIGN0eFtwXS5hcHBseShjdHgsIHNbcF0pO1xuXHRcdFx0XHRlbHNlIGN0eFtwXS5jYWxsKGN0eCwgc1twXSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0Y3R4W3BdID0gc1twXTtcblx0XHR9XG5cdH1cbn07XG5cbnZhciBfZHJhd1NoYXBlID0gZnVuY3Rpb24oZm4sIHMsIGN0eCkge1xuXHRjdHguc2F2ZSgpO1xuXHRpZiAocykgc2V0U3R5bGUoY3R4LCBzKTtcblx0Zm4uYXBwbHkobnVsbCwgc3BsaWNlLmNhbGwoYXJndW1lbnRzLCAyKSk7XG5cdGlmIChjdHgubGluZVdpZHRoICE9PSBcInRyYW5zcGFyZW50XCIpIGN0eC5zdHJva2UoKTtcblx0aWYgKGN0eC5maWxsU3R5bGUgIT09IFwidHJhbnNwYXJlbnRcIikgY3R4LmZpbGwoKTtcblx0Y3R4LnJlc3RvcmUoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXHRzZXRTdHlsZTogc2V0U3R5bGUsXG5cblx0dkd1aWRlOiBmdW5jdGlvbihjdHgsIHgpIHtcblx0XHRjdHguYmVnaW5QYXRoKCk7XG5cdFx0Y3R4Lm1vdmVUbyh4LCAwKTtcblx0XHRjdHgubGluZVRvKHgsIGN0eC5jYW52YXMuaGVpZ2h0KTtcblx0fSxcblx0ZHJhd1ZHdWlkZTogZnVuY3Rpb24oY3R4LCBzLCB4KSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLnZHdWlkZSwgcywgY3R4LCB4KTtcblx0fSxcblxuXHRoR3VpZGU6IGZ1bmN0aW9uKGN0eCwgeSkge1xuXHRcdGN0eC5iZWdpblBhdGgoKTtcblx0XHRjdHgubW92ZVRvKDAsIHkpO1xuXHRcdGN0eC5saW5lVG8oY3R4LmNhbnZhcy53aWR0aCwgeSk7XG5cdH0sXG5cdGRyYXdIR3VpZGU6IGZ1bmN0aW9uKGN0eCwgcywgeSkge1xuXHRcdF9kcmF3U2hhcGUodGhpcy5oR3VpZGUsIHMsIGN0eCwgeSk7XG5cdH0sXG5cblx0Y3Jvc3NoYWlyOiBmdW5jdGlvbihjdHgsIHgsIHksIHIpIHtcblx0XHRjdHguc2F2ZSgpO1xuXHRcdGN0eC50cmFuc2xhdGUoeCwgeSk7XG5cdFx0Y3R4LnJvdGF0ZShNYXRoLlBJIC8gNCk7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5tb3ZlVG8oMCwgLXIpO1xuXHRcdGN0eC5saW5lVG8oMCwgcik7XG5cdFx0Y3R4Lm1vdmVUbygtciwgMCk7XG5cdFx0Y3R4LmxpbmVUbyhyLCAwKTtcblx0XHRjdHgucmVzdG9yZSgpO1xuXHR9LFxuXHRkcmF3Q3Jvc3NoYWlyOiBmdW5jdGlvbihjdHgsIHMsIHgsIHksIHIpIHtcblx0XHRfZHJhd1NoYXBlKHRoaXMuY3Jvc3NoYWlyLCBzLCBjdHgsIHgsIHksIHIpO1xuXHR9LFxuXG5cdGNpcmNsZTogZnVuY3Rpb24oY3R4LCB4LCB5LCByKSB7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5hcmMoeCwgeSwgciwgMCwgUEkyKTtcblx0fSxcblx0ZHJhd0NpcmNsZTogZnVuY3Rpb24oY3R4LCBzLCB4LCB5LCByKSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLmNpcmNsZSwgcywgY3R4LCB4LCB5LCByKTtcblx0fSxcblxuXHRzcXVhcmU6IGZ1bmN0aW9uKGN0eCwgeCwgeSwgcikge1xuXHRcdHIgPSBNYXRoLmZsb29yKHIgLyAyKSAqIDI7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5yZWN0KHggLSByLCB5IC0gciwgciAqIDIsIHIgKiAyKTtcblx0fSxcblx0ZHJhd1NxdWFyZTogZnVuY3Rpb24oY3R4LCBzLCB4LCB5LCByKSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLnNxdWFyZSwgcywgY3R4LCB4LCB5LCByKTtcblx0fSxcblxuXHRhcnJvd2hlYWQ6IGZ1bmN0aW9uKGN0eCwgeCwgeSwgciwgdCkge1xuXHRcdGN0eC5zYXZlKCk7XG5cdFx0Y3R4LnRyYW5zbGF0ZSh4LCB5KTtcblx0XHRjdHgucm90YXRlKHQpOyAvLyAtIE1hdGguUEkgKiAwLjUpO1xuXHRcdGN0eC50cmFuc2xhdGUociAqIDAuNSwgMCk7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5tb3ZlVG8oMCwgMCk7XG5cdFx0Ly8gY3R4LmxpbmVUbygtciwgciAqIE1hdGguU1FSVDFfMik7XG5cdFx0Ly8gY3R4LmxpbmVUbygtciwgLXIgKiBNYXRoLlNRUlQxXzIpO1xuXHRcdGN0eC5saW5lVG8oLXIgKiBNYXRoLlNRUlQyLCByICogTWF0aC5TUVJUMV8yKTtcblx0XHRjdHguYXJjVG8oMCwgMCwgLXIgKiBNYXRoLlNRUlQyLCAtciAqIE1hdGguU1FSVDFfMiwgcik7XG5cdFx0Ly8gY3R4LnF1YWRyYXRpY0N1cnZlVG8oMCwgMCwgLXIgKiBNYXRoLlNRUlQyLCAtciAqIE1hdGguU1FSVDFfMik7XG5cdFx0Y3R4LmxpbmVUbygwLCAwKTtcblx0XHRjdHguY2xvc2VQYXRoKCk7XG5cdFx0Y3R4LnJlc3RvcmUoKTtcblx0fSxcblx0ZHJhd0Fycm93aGVhZDogZnVuY3Rpb24oY3R4LCBzLCB4LCB5LCByLCB0KSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLmFycm93aGVhZCwgcywgY3R4LCB4LCB5LCByLCB0KTtcblx0fSxcblxuXHRyZWN0OiBmdW5jdGlvbihjdHgsIGExLCBhMiwgYTMsIGE0KSB7XG5cblx0XHRjdHguYmVnaW5QYXRoKCk7XG5cdFx0aWYgKGlzTmFOKGExKSkge1xuXHRcdFx0Y3R4LnJlY3QoYTEubGVmdCwgYTEudG9wLCBhMS53aWR0aCwgYTEuaGVpZ2h0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y3R4LnJlY3QoYTEsIGEyLCBhMywgYTQpO1xuXHRcdH1cblx0fSxcblx0ZHJhd1JlY3Q6IGZ1bmN0aW9uKGN0eCwgcywgYTEsIGEyLCBhMywgYTQpIHtcblx0XHRfZHJhd1NoYXBlKHRoaXMucmVjdCwgcywgY3R4LCBhMSwgYTIsIGEzLCBhNCk7XG5cdH0sXG59OyIsIi8qKlxuICogQG1vZHVsZSB1dGlscy9jYW52YXMvY2FsY0FyY0hDb25uZWN0b3JcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHgxLCB5MSwgcjEsIHgyLCB5MiwgcjIsIHJvKSB7XG5cdHZhciBxeCA9IHgyID4geDEgPyAxIDogLTE7XG5cdHZhciBxeSA9IHkyID4geTEgPyAxIDogLTE7XG5cdHZhciBkeSA9IE1hdGguYWJzKHkyIC0geTEpO1xuXHR2YXIgZHggPSBNYXRoLmFicyh4MiAtIHgxKTtcblx0dmFyIHJyID0gcjEgKyByMjtcblx0dmFyIHR4MSwgdHgyLCBjLCB0eCwgdHk7XG5cblx0aWYgKGR5IDwgMSkge1xuXHRcdC8vIHBvaW50cyBhcmUgYWxpZ25lZCBob3Jpem9udGFsbHksIG5vIGFyY3MgbmVlZGVkXG5cdFx0dHgxID0gMDtcblx0XHR0eDIgPSBkeFxuXHRcdC8vIHJldHVybiBbeDEsIHgyXTtcblx0fVxuXG5cdGlmIChkeSA+PSByciAmJiBkeCA+PSBycikge1xuXHRcdC8vIGFyY3MgZml0IGhvcml6b250YWxseTpcblx0XHQvLyBzZWNvbmQgY2lyY2xlIGNlbnRlciBpcyByMStyMiwgdGFuZ2VudCBpbnRlcnNlY3QgYXQgeD1yMVxuXHRcdGMgPSBycjtcblx0XHR0eDEgPSByMTtcblx0XHR0eDIgPSByMTtcblx0fSBlbHNlIHtcblx0XHQvLyBhcmNzIG92ZXJsYXAgaG9yaXpvbnRhbGx5OlxuXHRcdC8vIGZpbmQgc2Vjb25kIGNpcmNsZSBjZW50ZXJcblx0XHRjID0gTWF0aC5zcXJ0KGR5ICogcjIgKiAyICsgZHkgKiByMSAqIDIgLSBkeSAqIGR5KTtcblxuXHRcdC8vIGNpcmNsZXMgdGFuZ2VudCBwb2ludFxuXHRcdHR4ID0gKGMgKiByMSkgLyBycjtcblx0XHR0eSA9IChkeSAqIHIxKSAvIHJyO1xuXG5cdFx0aWYgKHIxIDwgdHkgfHwgYyA+IGR4KSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gdGFuZ2VudCBwZXJwZW5kaWN1bGFyIHNsb3BlXG5cdFx0dmFyIHNsb3BlID0gKHJyIC0gZHkpIC8gYztcblx0XHQvLyB0YW5nZW50IGludGVyc2VjdGlvbnNcblx0XHR0eDEgPSB0eCAtICh0eSAqIHNsb3BlKTtcblx0XHR0eDIgPSAoZHkgKiBzbG9wZSkgKyB0eDE7XG5cblx0XHQvKlxuXHRcdC8vIGNpcmNsZSBjZW50ZXJzXG5cdFx0dmFyIGNjeDEsIGNjeTEsIGNjeDIsIGNjeTI7XG5cdFx0Y2N4MSA9IDA7XG5cdFx0Y2N5MSA9IHIxO1xuXHRcdGNjeDIgPSBjO1xuXHRcdGNjeTIgPSBkeSAtIHIyO1xuXHRcdC8vIHRhbmdlbnQgcGVycGVuZGljdWxhciBzbG9wZVxuXHRcdHZhciBzbG9wZSA9IChjY3kxIC0gY2N5MikgLyAoY2N4MiAtIGNjeDEpO1xuXHRcdHZhciB4U2VjID0gdHggLSAodHkgKiBzbG9wZSk7XG5cdFx0Ly8gdGFuZ2VudCBpbnRlcnNlY3Rpb25zXG5cdFx0dHgxID0geFNlYztcblx0XHR0eDIgPSAoZHkgKiBzbG9wZSkgKyB4U2VjO1xuXHRcdCovXG5cdH1cblxuXHQvLyBvZmZzZXQgYXJjVG8ncyBpbiB4LWF4aXNcblx0aWYgKHJvID4gMCkge1xuXHRcdGlmIChybyA+IDEpIHtcblx0XHRcdHJvID0gTWF0aC5taW4oZHggLSByciwgcm8pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRybyAqPSBkeCAtIHJyO1xuXHRcdH1cblx0XHR0eDEgKz0gcm87XG5cdFx0dHgyICs9IHJvO1xuXHR9XG5cblx0cmV0dXJuIFt0eDEgKiBxeCArIHgxLCB0eDIgKiBxeCArIHgxLCB0eDEsIHR4Ml07XG59O1xuXG4vKlxudmFyIGRyYXdBcmNDb25uZWN0b3IgPSBmdW5jdGlvbihjdHgsIHgxLCB5MSwgeDIsIHkyLCByKSB7XG5cdHZhciBkeCwgZHksIGh4LCBoeSwgZ3gsIGd5O1xuXG5cdGh4ID0gMDtcblx0aHkgPSAwO1xuXHRneCA9ICh4MSArIHgyKSAvIDI7XG5cdGd5ID0gKHkxICsgeTIpIC8gMjtcblx0ZHggPSBNYXRoLmFicyh4MSAtIGd4KTtcblx0ZHkgPSBNYXRoLmFicyh5MSAtIGd5KTtcblxuXHRpZiAoZHggPCByICYmIGR5IDwgcikge1xuXHRcdHIgPSBNYXRoLm1pbihkeCAqIE1hdGguU1FSVDFfMiwgZHkgKiBNYXRoLlNRUlQxXzIpO1xuXHR9IGVsc2Uge1xuXHRcdGlmIChkeCA8IHIpIHtcblx0XHRcdGh5ID0gTWF0aC5hY29zKGR4IC8gcikgKiByICogMC41O1xuXHRcdFx0aWYgKHkxID4geTIpIGh5ICo9IC0xO1xuXHRcdH1cblx0XHRpZiAoZHkgPCByKSB7XG5cdFx0XHRoeCA9IE1hdGguYWNvcyhkeSAvIHIpICogciAqIDAuNTtcblx0XHRcdGlmICh4MSA+IHgyKSBoeCAqPSAtMTtcblx0XHR9XG5cdH1cblx0Y3R4LmFyY1RvKGd4IC0gaHgsIHkxLCBneCArIGh4LCB5Miwgcik7XG5cdGN0eC5hcmNUbyhneCArIGh4LCB5MiwgeDIsIHkyLCByKTtcbn07XG5cbnZhciBkcmF3QXJjQ29ubmVjdG9yMiA9IGZ1bmN0aW9uKGN0eCwgeDEsIHkxLCB4MiwgeTIsIHIpIHtcblx0dmFyIGR4LCBkeSwgaHgsIGh5LCBjeDEsIGN4MjtcblxuXHRoeCA9IDA7XG5cdGh5ID0gMDtcblx0ZHggPSBNYXRoLmFicyh4MiAtIHgxKSAvIDI7XG5cdGR5ID0gTWF0aC5hYnMoeTEgLSB5MikgLyAyO1xuXG5cdGlmIChkeCA8IHIgJiYgZHkgPCByKSB7XG5cdFx0ciA9IE1hdGgubWluKGR4ICogTWF0aC5TUVJUMV8yLCBkeSAqIE1hdGguU1FSVDFfMik7XG5cdH0gZWxzZSB7XG5cdFx0aWYgKGR4IDwgcikge1xuXHRcdFx0aHkgPSBNYXRoLmFjb3MoZHggLyByKSAqIHI7XG5cdFx0fVxuXHRcdGlmIChkeSA8IHIpIHtcblx0XHRcdGh4ID0gTWF0aC5hY29zKGR5IC8gcikgKiByO1xuXHRcdH1cblx0fVxuXHRjeDEgPSB4MSArIGR4O1xuXHRjeDIgPSB4MiAtIChkeCAtIGh4IC8gMik7XG5cdGN0eC5hcmNUbyhjeDEsIHkxLCBjeDIsIHkyLCByKTtcblx0Y3R4LmFyY1RvKGN4MiwgeTIsIHgyLCB5Miwgcik7XG59O1xuXG52YXIgZHJhd0FyY0Nvbm5lY3RvcjEgPSBmdW5jdGlvbihjdHgsIHgxLCB5MSwgeDIsIHkyLCByKSB7XG5cdHZhciBkeCwgZHksIGN4O1xuXG5cdGR4ID0gTWF0aC5hYnMoeDIgLSB4MSkgLyAyO1xuXHRkeSA9IE1hdGguYWJzKHkxIC0geTIpIC8gMjtcblx0ciA9IE1hdGgubWluKHIsIGR5ICogTWF0aC5TUVJUMV8yKTtcblx0aWYgKHgxIDwgeDIpIHtcblx0XHRjeCA9IHgxICsgZHggKyByO1xuXHR9IGVsc2Uge1xuXHRcdGN4ID0geDIgLSBkeCAtIHI7XG5cdH1cblx0Ly8gY3ggPSAoeDIgKyB4MSkgLyAyO1xuXHQvLyBjeCArPSB4MSA8IHgyID8gciA6IC1yO1xuXG5cdGN0eC5hcmNUbyhjeCwgeTEsIGN4LCB5Miwgcik7XG5cdGN0eC5hcmNUbyhjeCwgeTIsIHgyLCB5Miwgcik7XG59O1xuKi9cbiIsIi8qIGdsb2JhbCBIVE1MRWxlbWVudCwgQ1NTU3R5bGVEZWNsYXJhdGlvbiAqL1xuXG4vLyB2YXIgcGFyc2VTaXplID0gcmVxdWlyZShcIi4vcGFyc2VTaXplXCIpO1xuXG52YXIgQ1NTX0JPWF9QUk9QUyA9IFtcblx0XCJib3hTaXppbmdcIiwgXCJwb3NpdGlvblwiLCBcIm9iamVjdEZpdFwiXG5dO1xudmFyIENTU19FREdFX1BST1BTID0gW1xuXHRcIm1hcmdpblRvcFwiLCBcIm1hcmdpbkJvdHRvbVwiLCBcIm1hcmdpbkxlZnRcIiwgXCJtYXJnaW5SaWdodFwiLFxuXHRcImJvcmRlclRvcFdpZHRoXCIsIFwiYm9yZGVyQm90dG9tV2lkdGhcIiwgXCJib3JkZXJMZWZ0V2lkdGhcIiwgXCJib3JkZXJSaWdodFdpZHRoXCIsXG5cdFwicGFkZGluZ1RvcFwiLCBcInBhZGRpbmdCb3R0b21cIiwgXCJwYWRkaW5nTGVmdFwiLCBcInBhZGRpbmdSaWdodFwiLFxuXTtcbnZhciBDU1NfUE9TX1BST1BTID0gW1widG9wXCIsIFwiYm90dG9tXCIsIFwibGVmdFwiLCBcInJpZ2h0XCJdO1xudmFyIENTU19TSVpFX1BST1BTID0gW1wid2lkdGhcIiwgXCJoZWlnaHRcIiwgXCJtaW5XaWR0aFwiLCBcIm1pbkhlaWdodFwiLCBcIm1heFdpZHRoXCIsIFwibWF4SGVpZ2h0XCJdO1xudmFyIENTU19BTExfUFJPUFMgPSBDU1NfRURHRV9QUk9QUy5jb25jYXQoQ1NTX1NJWkVfUFJPUFMsIENTU19QT1NfUFJPUFMpO1xuXG4vLyB2YXIgQ09NUFVURURfUFJPUFMgPSBbXG4vLyBcdFwiY2xpZW50TGVmdFwiLCBcImNsaWVudFRvcFwiLCBcImNsaWVudFdpZHRoXCIsIFwiY2xpZW50SGVpZ2h0XCIsXG4vLyBcdFwib2Zmc2V0TGVmdFwiLCBcIm9mZnNldFRvcFwiLCBcIm9mZnNldFdpZHRoXCIsIFwib2Zmc2V0SGVpZ2h0XCJcbi8vIF07XG4vLyB2YXIgbyA9IF8ucGljayhlbGVtZW50LCBmdW5jdGlvbih2YWwpIHtcbi8vIFx0cmV0dXJuIC9eKG9mZnNldHxjbGllbnQpKExlZnR8VG9wfFdpZHRofEhlaWdodCkvLnRlc3QodmFsKTtcbi8vIH0pO1xuXG52YXIgY3NzRGltZW5zaW9uUkUgPSAvXigtP1tcXGRcXC5dKykocHh8ZW18cmVtKSQvO1xuLy8gdmFyIGNzc0RpbVJlID0gL14oWy1cXC4wLTldKykoW3JlbV0rKSQvO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHMsIG0sIGluY2x1ZGVTaXplUG9zKSB7XG5cdGlmIChzIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcblx0XHRzID0gZ2V0Q29tcHV0ZWRTdHlsZShzKTtcblx0fVxuXHRpZiAoREVCVUcpIHtcblx0XHRpZiAoIShzIGluc3RhbmNlb2YgQ1NTU3R5bGVEZWNsYXJhdGlvbikpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIk5vdCBhIENTU1N0eWxlRGVjbGFyYXRpb24gbm9yIEhUTUxFbGVtZW50XCIpO1xuXHRcdH1cblx0fVxuXHR2YXIgdiwgcCwgaSwgaWksIGVtUHgsIHJlbVB4O1xuXHRtIHx8IChtID0ge30pO1xuXG5cdGVtUHggPSBtLmZvbnRTaXplID0gcGFyc2VGbG9hdChzLmZvbnRTaXplKTtcblxuXHRmb3IgKGkgPSAwLCBpaSA9IENTU19CT1hfUFJPUFMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdHAgPSBDU1NfQk9YX1BST1BTW2ldO1xuXHRcdGlmIChwIGluIHMpIHtcblx0XHRcdG1bcF0gPSBzW3BdO1xuXHRcdH1cblx0fVxuXHR2YXIgY3NzUHJvcHMgPSBpbmNsdWRlU2l6ZVBvcyA/IENTU19FREdFX1BST1BTIDogQ1NTX0FMTF9QUk9QUztcblx0Zm9yIChpID0gMCwgaWkgPSBjc3NQcm9wcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0cCA9IGNzc1Byb3BzW2ldO1xuXHRcdG1bXCJfXCIgKyBwXSA9IHNbcF07XG5cdFx0aWYgKHNbcF0gJiYgKHYgPSBjc3NEaW1lbnNpb25SRS5leGVjKHNbcF0pKSkge1xuXHRcdFx0aWYgKHZbMl0gPT09IFwicHhcIikge1xuXHRcdFx0XHRtW3BdID0gcGFyc2VGbG9hdCh2WzFdKTtcblx0XHRcdH0gZWxzZSBpZiAodlsyXSA9PT0gXCJlbVwiKSB7XG5cdFx0XHRcdG1bcF0gPSBwYXJzZUZsb2F0KHZbMV0pICogZW1QeDtcblx0XHRcdH0gZWxzZSBpZiAodlsyXSA9PT0gXCJyZW1cIikge1xuXHRcdFx0XHRyZW1QeCB8fCAocmVtUHggPSBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5mb250U2l6ZSkpO1xuXHRcdFx0XHRtW3BdID0gcGFyc2VGbG9hdCh2WzFdKSAqIHJlbVB4O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiSWdub3JpbmcgdmFsdWVcIiwgcCwgdlsxXSwgdlsyXSk7XG5cdFx0XHRcdG1bcF0gPSBudWxsO1xuXHRcdFx0fVxuXHRcdH0gLy8gZWxzZSB7XG5cdFx0Ly9cdGNvbnNvbGUud2FybihcIklnbm9yaW5nIHVuaXRsZXNzIHZhbHVlXCIsIHAsIHYpO1xuXHRcdC8vfVxuXHR9XG5cdHJldHVybiBtO1xufTtcbiIsIi8qKlxuICogQHBhcmFtIHtudW1iZXJ9IGkgY3VycmVudCBpdGVyYXRpb25cbiAqIEBwYXJhbSB7bnVtYmVyfSBzIHN0YXJ0IHZhbHVlXG4gKiBAcGFyYW0ge251bWJlcn0gZCBjaGFuZ2UgaW4gdmFsdWVcbiAqIEBwYXJhbSB7bnVtYmVyfSB0IHRvdGFsIGl0ZXJhdGlvbnNcbiAqIEByZXR1cm4ge251bWJlcn1cbiAqL1xudmFyIGxpbmVhciA9IGZ1bmN0aW9uKGksIHMsIGQsIHQpIHtcblx0cmV0dXJuIGQgKiBpIC8gdCArIHM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGxpbmVhcjtcbiIsIi8qIGh0dHBzOi8vaHRtbC5zcGVjLndoYXR3Zy5vcmcvbXVsdGlwYWdlL21lZGlhLmh0bWwjZXZlbnQtbWVkaWEtY2FucGxheVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IFtcblx0Ly8gbmV0d29ya1N0YXRlXG5cdFwibG9hZHN0YXJ0XCIsXG5cdFwicHJvZ3Jlc3NcIixcblx0XCJzdXNwZW5kXCIsXG5cdFwiYWJvcnRcIixcblx0XCJlcnJvclwiLFxuXHRcImVtcHRpZWRcIixcblx0XCJzdGFsbGVkXCIsXG5cdC8vIHJlYWR5U3RhdGVcblx0XCJsb2FkZWRtZXRhZGF0YVwiLFxuXHRcImxvYWRlZGRhdGFcIixcblx0XCJjYW5wbGF5XCIsXG5cdFwiY2FucGxheXRocm91Z2hcIixcblx0XCJwbGF5aW5nXCIsXG5cdFwid2FpdGluZ1wiLFxuXHQvL1xuXHRcInNlZWtpbmdcIiwgLy8gc2Vla2luZyBjaGFuZ2VkIHRvIHRydWVcblx0XCJzZWVrZWRcIiwgLy8gc2Vla2luZyBjaGFuZ2VkIHRvIGZhbHNlXG5cdFwiZW5kZWRcIiwgLy8gZW5kZWQgaXMgdHJ1ZVxuXHQvL1xuXHRcImR1cmF0aW9uY2hhbmdlXCIsIC8vIGR1cmF0aW9uIHVwZGF0ZWRcblx0XCJ0aW1ldXBkYXRlXCIsIC8vIGN1cnJlbnRUaW1lIHVwZGF0ZWRcblx0XCJwbGF5XCIsIC8vIHBhdXNlZCBpcyBmYWxzZVxuXHRcInBhdXNlXCIsIC8vIHBhdXNlZCBpcyBmYWxzZVxuXHRcInBhdXNlZFwiLCAvLyA/P1xuXHRcInJhdGVjaGFuZ2VcIixcblx0Ly9cblx0XCJyZXNpemVcIixcblx0XCJ2b2x1bWVjaGFuZ2VcIixcbl07IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9HcmFwaFZpZXdcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihyZWN0LCBkeCwgZHkpIHtcblx0ZHkgfHwgKGR5ID0gZHgpO1xuXHR2YXIgciA9IHtcblx0XHR3aWR0aDogcmVjdC53aWR0aCArIGR4ICogMixcblx0XHRoZWlnaHQ6IHJlY3QuaGVpZ2h0ICsgZHkgKiAyXG5cdH07XG5cdGlmIChyLndpZHRoID49IDApIHtcblx0XHRyLmxlZnQgPSByZWN0LmxlZnQgLSBkeDtcblx0XHRyLnJpZ2h0ID0gci5sZWZ0ICsgci53aWR0aDtcblx0XHRyLnggPSByLmxlZnQ7XG5cdH0gZWxzZSB7XG5cdFx0ci5yaWdodCA9IHJlY3QucmlnaHQgKyBkeDtcblx0XHRyLmxlZnQgPSByZWN0LnJpZ2h0IC0gci53aWR0aDtcblx0XHRyLnkgPSByLnJpZ2h0O1xuXHR9XG5cdGlmIChyLmhlaWdodCA+PSAwKSB7XG5cdFx0ci50b3AgPSByZWN0LnRvcCAtIGR5O1xuXHRcdHIuYm90dG9tID0gci50b3AgKyByLmhlaWdodDtcblx0XHRyLnkgPSByLnRvcDtcblx0fSBlbHNlIHtcblx0XHRyLmJvdHRvbSA9IHJlY3QuYm90dG9tICsgZHk7XG5cdFx0ci50b3AgPSByZWN0LmJvdHRvbSAtIHIuaGVpZ2h0O1xuXHRcdHIueSA9IHIuYm90dG9tO1xuXHR9XG5cblx0cmV0dXJuIHI7XG59O1xuIiwiLyoqIEB0eXBlIHtBcnJheX0gbG93ZXJjYXNlIHByZWZpeGVzICovXG52YXIgbGNQcmVmaXhlcyA9IFtcIlwiXS5jb25jYXQocmVxdWlyZShcIi4vcHJlZml4ZXNcIikpO1xuXG4vKiogQHR5cGUge0FycmF5fSBjYXBpdGFsaXplZCBwcmVmaXhlcyAqL1xudmFyIHVjUHJlZml4ZXMgPSBsY1ByZWZpeGVzLm1hcChmdW5jdGlvbihzKSB7XG5cdHJldHVybiAocyA9PT0gXCJcIikgPyBzIDogcy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHMuc3Vic3RyKDEpO1xufSk7XG5cbi8qKiBAdHlwZSB7T2JqZWN0fSBzcGVjaWZpYyBldmVudCBzb2x2ZXJzICovXG52YXIgX3NvbHZlcnMgPSB7fTtcblxuLyoqIEB0eXBlIHtPYmplY3R9IGNhY2hlZCB2YWx1ZXMgKi9cbnZhciBfY2FjaGUgPSB7fTtcblxuLyoqXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBVbnByZWZpeGVkIGV2ZW50IG5hbWVcbiAqIEBwYXJhbSB7P09iamVjdH0gb2JqIFByZWZpeCB0ZXN0IHRhcmdldFxuICogQHBhcmFtIHs/U3RyaW5nfSB0ZXN0UHJvcCBQcm94eSBwcm9wZXJ0eSB0byB0ZXN0IHByZWZpeGVzXG4gKiBAcmV0dXJuIHtTdHJpbmd8bnVsbH1cbiAqL1xudmFyIF9wcmVmaXhlZEV2ZW50ID0gZnVuY3Rpb24obmFtZSwgb2JqLCB0ZXN0UHJvcCkge1xuXHR2YXIgcHJlZml4ZXMgPSAvXltBLVpdLy50ZXN0KG5hbWUpID8gdWNQcmVmaXhlcyA6IGxjUHJlZml4ZXM7XG5cdG9iaiB8fCAob2JqID0gZG9jdW1lbnQpO1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IHByZWZpeGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0aWYgKHRlc3RQcm9wKSB7XG5cdFx0XHRpZiAoKHByZWZpeGVzW2ldICsgdGVzdFByb3ApIGluIG9iaikge1xuXHRcdFx0XHRyZXR1cm4gcHJlZml4ZXNbaV0gKyBuYW1lO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAoKFwib25cIiArIHByZWZpeGVzW2ldICsgbmFtZSkgaW4gb2JqKSB7XG5cdFx0XHRyZXR1cm4gcHJlZml4ZXNbaV0gKyBuYW1lO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gbnVsbDtcbn07XG5cbi8vIHRyYW5zaXRpb25lbmRcbl9zb2x2ZXJzW1widHJhbnNpdGlvbmVuZFwiXSA9IGZ1bmN0aW9uKCkge1xuXHR2YXIgcHJvcCwgc3R5bGUgPSBkb2N1bWVudC5ib2R5LnN0eWxlLFxuXHRcdG1hcCA9IHtcblx0XHRcdFwidHJhbnNpdGlvblwiOiBcInRyYW5zaXRpb25lbmRcIixcblx0XHRcdFwiV2Via2l0VHJhbnNpdGlvblwiOiBcIndlYmtpdFRyYW5zaXRpb25FbmRcIixcblx0XHRcdFwiTW96VHJhbnNpdGlvblwiOiBcInRyYW5zaXRpb25lbmRcIixcblx0XHRcdC8vIFwibXNUcmFuc2l0aW9uXCIgOiBcIk1TVHJhbnNpdGlvbkVuZFwiLFxuXHRcdFx0XCJPVHJhbnNpdGlvblwiOiBcIm9UcmFuc2l0aW9uRW5kXCJcblx0XHR9O1xuXHRmb3IgKHByb3AgaW4gbWFwKSB7XG5cdFx0aWYgKHByb3AgaW4gc3R5bGUpIHtcblx0XHRcdHJldHVybiBtYXBbcHJvcF07XG5cdFx0fVxuXHR9XG5cdHJldHVybiBudWxsO1xufTtcblxuLyoqXG4gKiBnZXQgdGhlIHByZWZpeGVkIHByb3BlcnR5XG4gKiBAcGFyYW0ge1N0cmluZ30gcHJvcGVydHkgbmFtZVxuICogQHBhcmFtIHtPYmplY3R9IGxvb2stdXAgb2JqZWN0XG4gKiBAcmV0dXJucyB7U3RyaW5nfG51bGx9IHByZWZpeGVkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oZXZOYW1lKSB7XG5cdGlmICghX2NhY2hlLmhhc093blByb3BlcnR5KGV2TmFtZSkpIHtcblx0XHRfY2FjaGVbZXZOYW1lXSA9IF9zb2x2ZXJzLmhhc093blByb3BlcnR5KGV2TmFtZSkgPyBfc29sdmVyc1tldk5hbWVdKCkgOiBfcHJlZml4ZWRFdmVudC5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuXHRcdGlmIChfY2FjaGVbZXZOYW1lXSA9PT0gbnVsbCkge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiRXZlbnQgJyVzJyBub3QgZm91bmRcIiwgZXZOYW1lKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc29sZS5sb2coXCJFdmVudCAnJXMnIGZvdW5kIGFzICclcydcIiwgZXZOYW1lLCBfY2FjaGVbZXZOYW1lXSk7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBfY2FjaGVbZXZOYW1lXTtcblx0Ly8gcmV0dXJuIF9jYWNoZVtldk5hbWVdIHx8IChfY2FjaGVbZXZOYW1lXSA9IF9zb2x2ZXJzW2V2TmFtZV0/IF9zb2x2ZXJzW2V2TmFtZV0uY2FsbCgpIDogX3ByZWZpeGVkUHJvcGVydHkuYXBwbHkobnVsbCwgYXJndW1lbnRzKSk7XG59O1xuXG4vKlxudmFyIGRlZmF1bHRUZXN0ID0gZnVuY3Rpb24obmFtZSwgb2JqKSB7XG5cdHZhciBwcmVmaXhlcyA9IC9eW0EtWl0vLnRlc3QobmFtZSk/IHVjUHJlZml4ZXMgOiBsY1ByZWZpeGVzO1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IHByZWZpeGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0aWYgKChcIm9uXCIgKyBwcmVmaXhlc1tpXSArIG5hbWUpIGluIG9iaikge1xuXHRcdFx0Y29uc29sZS5sb2coXCJFdmVudCAnJXMnIGZvdW5kIGFzICclcydcIiwgbmFtZSwgcHJlZml4ZXNbaV0gKyBuYW1lKTtcblx0XHRcdHJldHVybiBwcmVmaXhlc1tpXSArIG5hbWU7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBudWxsO1xufTtcblxudmFyIHByb3h5VGVzdCA9IGZ1bmN0aW9uKG5hbWUsIG9iaiwgdGVzdFByb3ApIHtcblx0dmFyIHByZWZpeGVzID0gL15bQS1aXS8udGVzdChuYW1lKT8gdWNQcmVmaXhlcyA6IGxjUHJlZml4ZXM7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpKyspIHtcblx0XHRpZiAoKHByZWZpeGVzW2ldICsgdGVzdFByb3ApIGluIG9iaikge1xuXHRcdFx0Y29uc29sZS5sb2coXCJFdmVudCAlcyBpbmZlcnJlZCBhcyAnJXMnIGZyb20gcHJvcGVydHkgJyVzJ1wiLCBuYW1lLCBwcmVmaXhlc1tpXSArIG5hbWUsIHRlc3RQcm9wKTtcblx0XHRcdHJldHVybiBwcmVmaXhlc1tpXSArIG5hbWU7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBudWxsO1xufTtcbiovXG4iLCIvKipcbi8qIEBtb2R1bGUgdXRpbHMvcHJlZml4ZWRQcm9wZXJ0eVxuLyovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVzfSAqL1xudmFyIHByZWZpeGVzID0gcmVxdWlyZShcIi4vcHJlZml4ZXNcIik7XG4vKiogQHR5cGUge051bWJlcn0gcHJlZml4IGNvdW50ICovXG52YXIgX3ByZWZpeE51bSA9IHByZWZpeGVzLmxlbmd0aDtcbi8qKiBAdHlwZSB7QXJyYXl9IGNhY2hlZCB2YWx1ZXMgKi9cbnZhciBfY2FjaGUgPSB7fTtcblxudmFyIF9wcmVmaXhlZFByb3BlcnR5ID0gZnVuY3Rpb24ocHJvcCwgb2JqKSB7XG5cdHZhciBwcmVmaXhlZFByb3AsIGNhbWVsUHJvcDtcblxuXHRpZiAocHJvcCBpbiBvYmopIHtcblx0XHRjb25zb2xlLmxvZyhcIlByb3BlcnR5ICclcycgZm91bmQgdW5wcmVmaXhlZFwiLCBwcm9wKTtcblx0XHRyZXR1cm4gcHJvcDtcblx0fVxuXHRjYW1lbFByb3AgPSBwcm9wWzBdLnRvVXBwZXJDYXNlKCkgKyBwcm9wLnNsaWNlKDEpO1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IF9wcmVmaXhOdW07IGkrKykge1xuXHRcdHByZWZpeGVkUHJvcCA9IHByZWZpeGVzW2ldICsgY2FtZWxQcm9wO1xuXHRcdGlmIChwcmVmaXhlZFByb3AgaW4gb2JqKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIlByb3BlcnR5ICclcycgZm91bmQgYXMgJyVzJ1wiLCBwcm9wLCBwcmVmaXhlZFByb3ApO1xuXHRcdFx0cmV0dXJuIHByZWZpeGVkUHJvcDtcblx0XHR9XG5cdH1cblx0Y29uc29sZS5lcnJvcihcIlByb3BlcnR5ICclcycgbm90IGZvdW5kXCIsIHByb3ApO1xuXHRyZXR1cm4gbnVsbDtcbn07XG5cbi8qKlxuICogZ2V0IHRoZSBwcmVmaXhlZCBwcm9wZXJ0eVxuICogQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5IG5hbWVcbiAqIEBwYXJhbSB7T2JqZWN0fSBsb29rLXVwIG9iamVjdFxuICogQHJldHVybnMge1N0cmluZ3xudWxsfSBwcmVmaXhlZFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHByb3AsIG9iaikge1xuXHRyZXR1cm4gX2NhY2hlW3Byb3BdIHx8IChfY2FjaGVbcHJvcF0gPSBfcHJlZml4ZWRQcm9wZXJ0eShwcm9wLCBvYmogfHwgZG9jdW1lbnQuYm9keS5zdHlsZSkpO1xufTtcbiIsIi8qKlxuLyogQG1vZHVsZSB1dGlscy9wcmVmaXhlZFN0eWxlTmFtZVxuLyovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVzfSAqL1xudmFyIHByZWZpeGVzID0gcmVxdWlyZShcIi4vcHJlZml4ZXNcIik7IC8vLm1hcChmdW5jdGlvbihwcmVmaXgpIHsgcmV0dXJuIFwiLVwiICsgcHJlZml4ICsgXCItXCI7IH0pO1xuLyoqIEB0eXBlIHtOdW1iZXJ9IHByZWZpeCBjb3VudCAqL1xudmFyIF9wcmVmaXhOdW0gPSBwcmVmaXhlcy5sZW5ndGg7XG4vKiogQHR5cGUge0FycmF5fSBjYWNoZWQgdmFsdWVzICovXG52YXIgX2NhY2hlID0ge307XG5cbnZhciBfcHJlZml4ZWRTdHlsZU5hbWUgPSBmdW5jdGlvbihzdHlsZSwgc3R5bGVPYmopIHtcblx0dmFyIHByZWZpeGVkU3R5bGU7XG5cblx0aWYgKHN0eWxlIGluIHN0eWxlT2JqKSB7XG5cdFx0Y29uc29sZS5sb2coXCJDU1Mgc3R5bGUgJyVzJyBmb3VuZCB1bnByZWZpeGVkXCIsIHN0eWxlKTtcblx0XHRyZXR1cm4gc3R5bGU7XG5cdH1cblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBfcHJlZml4TnVtOyBpKyspIHtcblx0XHRwcmVmaXhlZFN0eWxlID0gXCItXCIgKyBwcmVmaXhlc1tpXSArIFwiLVwiICsgc3R5bGU7XG5cdFx0Ly8gcHJlZml4ZWRTdHlsZSA9IHByZWZpeGVzW2ldICsgc3R5bGU7XG5cdFx0aWYgKHByZWZpeGVkU3R5bGUgaW4gc3R5bGVPYmopIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiQ1NTIHN0eWxlICclcycgZm91bmQgYXMgJyVzJ1wiLCBzdHlsZSwgcHJlZml4ZWRTdHlsZSk7XG5cdFx0XHRyZXR1cm4gcHJlZml4ZWRTdHlsZTtcblx0XHR9XG5cdH1cblx0Y29uc29sZS53YXJuKFwiQ1NTIHN0eWxlICclcycgbm90IGZvdW5kXCIsIHN0eWxlKTtcblx0cmV0dXJuIG51bGw7XG59O1xuXG4vKipcbiAqIGdldCB0aGUgcHJlZml4ZWQgc3R5bGUgbmFtZVxuICogQHBhcmFtIHtTdHJpbmd9IHN0eWxlIG5hbWVcbiAqIEBwYXJhbSB7T2JqZWN0fSBsb29rLXVwIHN0eWxlIG9iamVjdFxuICogQHJldHVybnMge1N0cmluZ3xVbmRlZmluZWR9IHByZWZpeGVkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oc3R5bGUsIHN0eWxlT2JqKSB7XG5cdC8vIHJldHVybiBfY2FjaGVbc3R5bGVdIHx8IChfY2FjaGVbc3R5bGVdID0gX3ByZWZpeGVkU3R5bGVOYW1lX3JldmVyc2Uoc3R5bGUsIHN0eWxlT2JqIHx8IGRvY3VtZW50LmJvZHkuc3R5bGUpKTtcblx0cmV0dXJuIF9jYWNoZVtzdHlsZV0gfHwgKF9jYWNoZVtzdHlsZV0gPSBfcHJlZml4ZWRTdHlsZU5hbWUoc3R5bGUsIHN0eWxlT2JqIHx8IGRvY3VtZW50LmJvZHkuc3R5bGUpKTtcbn07XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3N0cmluZ3MvY2FtZWxUb0Rhc2hlZH0gKi9cbi8vIHZhciBjYW1lbFRvRGFzaGVkID0gcmVxdWlyZShcIi4vc3RyaW5ncy9jYW1lbFRvRGFzaGVkXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRQcm9wZXJ0eX0gKi9cbi8vIHZhciBwcmVmaXhlZFByb3BlcnR5ID0gcmVxdWlyZShcIi4vcHJlZml4ZWRQcm9wZXJ0eVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3N0cmluZ3MvZGFzaGVkVG9DYW1lbH0gKi9cbi8vIHZhciBkYXNoZWRUb0NhbWVsID0gcmVxdWlyZShcIi4vc3RyaW5ncy9kYXNoZWRUb0NhbWVsXCIpO1xuLy9cbi8vIHZhciBfcHJlZml4ZWRTdHlsZU5hbWVfcmV2ZXJzZSA9IGZ1bmN0aW9uIChzdHlsZSwgc3R5bGVPYmopIHtcbi8vIFx0dmFyIGNhbWVsUHJvcCwgcHJlZml4ZWRQcm9wO1xuLy8gXHRjYW1lbFByb3AgPSBkYXNoZWRUb0NhbWVsKHN0eWxlKTtcbi8vIFx0cHJlZml4ZWRQcm9wID0gcHJlZml4ZWRQcm9wZXJ0eShjYW1lbFByb3AsIHN0eWxlT2JqKTtcbi8vIFx0cmV0dXJuIHByZWZpeGVkUHJvcD8gKGNhbWVsUHJvcCA9PT0gcHJlZml4ZWRQcm9wPyBcIlwiIDogXCItXCIpICsgY2FtZWxUb0Rhc2hlZChwcmVmaXhlZFByb3ApIDogbnVsbDtcbi8vIH07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IFtcIndlYmtpdFwiLCBcIm1velwiLCBcIm1zXCIsIFwib1wiXTtcbiIsIi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbi8qXG5UYWtlbiBmcm9tOlxuaHR0cHM6Ly9naXRodWIuY29tL3dlYmNvbXBvbmVudHMvd2ViY29tcG9uZW50c2pzL2Jsb2IvbWFzdGVyL3NyYy9NdXRhdGlvbk9ic2VydmVyL011dGF0aW9uT2JzZXJ2ZXIuanNcbiovXG4vKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAoYykgMjAxNCBUaGUgUG9seW1lciBQcm9qZWN0IEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBUaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9DT05UUklCVVRPUlMudHh0XG4gKiBDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhcyBwYXJ0IG9mIHRoZSBwb2x5bWVyIHByb2plY3QgaXMgYWxzb1xuICogc3ViamVjdCB0byBhbiBhZGRpdGlvbmFsIElQIHJpZ2h0cyBncmFudCBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vUEFURU5UUy50eHRcbiAqL1xuXG52YXIgc2V0SW1tZWRpYXRlO1xuXG4vLyBBcyBtdWNoIGFzIHdlIHdvdWxkIGxpa2UgdG8gdXNlIHRoZSBuYXRpdmUgaW1wbGVtZW50YXRpb24sIElFXG4vLyAoYWxsIHZlcnNpb25zKSBzdWZmZXJzIGEgcmF0aGVyIGFubm95aW5nIGJ1ZyB3aGVyZSBpdCB3aWxsIGRyb3Agb3IgZGVmZXJcbi8vIGNhbGxiYWNrcyB3aGVuIGhlYXZ5IERPTSBvcGVyYXRpb25zIGFyZSBiZWluZyBwZXJmb3JtZWQgY29uY3VycmVudGx5LlxuLy9cbi8vIEZvciBhIHRob3JvdWdoIGRpc2N1c3Npb24gb24gdGhpcywgc2VlOlxuLy8gaHR0cDovL2NvZGVmb3JoaXJlLmNvbS8yMDEzLzA5LzIxL3NldGltbWVkaWF0ZS1hbmQtbWVzc2FnZWNoYW5uZWwtYnJva2VuLW9uLWludGVybmV0LWV4cGxvcmVyLTEwL1xuaWYgKC9UcmlkZW50fEVkZ2UvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcblx0Ly8gU2FkbHksIHRoaXMgYnVnIGFsc28gYWZmZWN0cyBwb3N0TWVzc2FnZSBhbmQgTWVzc2FnZVF1ZXVlcy5cblx0Ly9cblx0Ly8gV2Ugd291bGQgbGlrZSB0byB1c2UgdGhlIG9ucmVhZHlzdGF0ZWNoYW5nZSBoYWNrIGZvciBJRSA8PSAxMCwgYnV0IGl0IGlzXG5cdC8vIGRhbmdlcm91cyBpbiB0aGUgcG9seWZpbGxlZCBlbnZpcm9ubWVudCBkdWUgdG8gcmVxdWlyaW5nIHRoYXQgdGhlXG5cdC8vIG9ic2VydmVkIHNjcmlwdCBlbGVtZW50IGJlIGluIHRoZSBkb2N1bWVudC5cblx0c2V0SW1tZWRpYXRlID0gc2V0VGltZW91dDtcblxuXHQvLyBJZiBzb21lIG90aGVyIGJyb3dzZXIgZXZlciBpbXBsZW1lbnRzIGl0LCBsZXQncyBwcmVmZXIgdGhlaXIgbmF0aXZlXG5cdC8vIGltcGxlbWVudGF0aW9uOlxufSBlbHNlIGlmICh3aW5kb3cuc2V0SW1tZWRpYXRlKSB7XG5cdHNldEltbWVkaWF0ZSA9IHdpbmRvdy5zZXRJbW1lZGlhdGU7XG5cblx0Ly8gT3RoZXJ3aXNlLCB3ZSBmYWxsIGJhY2sgdG8gcG9zdE1lc3NhZ2UgYXMgYSBtZWFucyBvZiBlbXVsYXRpbmcgdGhlIG5leHRcblx0Ly8gdGFzayBzZW1hbnRpY3Mgb2Ygc2V0SW1tZWRpYXRlLlxufSBlbHNlIHtcblx0dmFyIHNldEltbWVkaWF0ZVF1ZXVlID0gW107XG5cdHZhciBzZW50aW5lbCA9IFN0cmluZyhNYXRoLnJhbmRvbSgpKTtcblx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGZ1bmN0aW9uKGUpIHtcblx0XHRpZiAoZS5kYXRhID09PSBzZW50aW5lbCkge1xuXHRcdFx0dmFyIHF1ZXVlID0gc2V0SW1tZWRpYXRlUXVldWU7XG5cdFx0XHRzZXRJbW1lZGlhdGVRdWV1ZSA9IFtdO1xuXHRcdFx0cXVldWUuZm9yRWFjaChmdW5jdGlvbihmdW5jKSB7XG5cdFx0XHRcdGZ1bmMoKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSk7XG5cdHNldEltbWVkaWF0ZSA9IGZ1bmN0aW9uKGZ1bmMpIHtcblx0XHRzZXRJbW1lZGlhdGVRdWV1ZS5wdXNoKGZ1bmMpO1xuXHRcdHdpbmRvdy5wb3N0TWVzc2FnZShzZW50aW5lbCwgXCIqXCIpO1xuXHR9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHNldEltbWVkaWF0ZTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHN0cikge1xuXHRyZXR1cm4gc3RyLnJlcGxhY2UoL1tBLVpdL2csIGZ1bmN0aW9uKCQwKSB7XG5cdFx0cmV0dXJuIFwiLVwiICsgJDAudG9Mb3dlckNhc2UoKTtcblx0fSk7XG59O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihzKSB7XG5cdHJldHVybiBzLnJlcGxhY2UoLzxbXj5dKz4vZywgXCJcIik7XG59O1xuIiwiLyoqIEB0eXBlIHttb2R1bGU6aGFtbWVyanN9ICovXG52YXIgSGFtbWVyID0gcmVxdWlyZShcImhhbW1lcmpzXCIpO1xuXG4vLyAvKipcbi8vICAqIGdldCBhIHVzYWJsZSBzdHJpbmcsIHVzZWQgYXMgZXZlbnQgcG9zdGZpeFxuLy8gICogQHBhcmFtIHtDb25zdH0gc3RhdGVcbi8vICAqIEByZXR1cm5zIHtTdHJpbmd9IHN0YXRlXG4vLyAgKi9cbi8vIGZ1bmN0aW9uIHN0YXRlU3RyKHN0YXRlKSB7XG4vLyBcdGlmIChzdGF0ZSAmIEhhbW1lci5TVEFURV9DQU5DRUxMRUQpIHtcbi8vIFx0XHRyZXR1cm4gXCJjYW5jZWxcIjtcbi8vIFx0fSBlbHNlIGlmIChzdGF0ZSAmIEhhbW1lci5TVEFURV9FTkRFRCkge1xuLy8gXHRcdHJldHVybiBcImVuZFwiO1xuLy8gXHR9IGVsc2UgaWYgKHN0YXRlICYgSGFtbWVyLlNUQVRFX0NIQU5HRUQpIHtcbi8vIFx0XHRyZXR1cm4gXCJtb3ZlXCI7XG4vLyBcdH0gZWxzZSBpZiAoc3RhdGUgJiBIYW1tZXIuU1RBVEVfQkVHQU4pIHtcbi8vIFx0XHRyZXR1cm4gXCJzdGFydFwiO1xuLy8gXHR9XG4vLyBcdHJldHVybiBcIlwiO1xuLy8gfVxuXG4vKipcbiAqIGRpcmVjdGlvbiBjb25zIHRvIHN0cmluZ1xuICogQHBhcmFtIHtDb25zdH0gZGlyZWN0aW9uXG4gKiBAcmV0dXJucyB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBkaXJTdHIoZGlyZWN0aW9uKSB7XG5cdGlmIChkaXJlY3Rpb24gPT0gSGFtbWVyLkRJUkVDVElPTl9ET1dOKSB7XG5cdFx0cmV0dXJuIFwiZG93blwiO1xuXHR9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PSBIYW1tZXIuRElSRUNUSU9OX1VQKSB7XG5cdFx0cmV0dXJuIFwidXBcIjtcblx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gSGFtbWVyLkRJUkVDVElPTl9MRUZUKSB7XG5cdFx0cmV0dXJuIFwibGVmdFwiO1xuXHR9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PSBIYW1tZXIuRElSRUNUSU9OX1JJR0hUKSB7XG5cdFx0cmV0dXJuIFwicmlnaHRcIjtcblx0fVxuXHRyZXR1cm4gXCJcIjtcbn1cblxuLy8vKipcbi8vICogUGFuXG4vLyAqIFJlY29nbml6ZWQgd2hlbiB0aGUgcG9pbnRlciBpcyBkb3duIGFuZCBtb3ZlZCBpbiB0aGUgYWxsb3dlZCBkaXJlY3Rpb24uXG4vLyAqIEBjb25zdHJ1Y3RvclxuLy8gKiBAZXh0ZW5kcyBBdHRyUmVjb2duaXplclxuLy8gKi9cbi8vZnVuY3Rpb24gUGFuUmVjb2duaXplcigpIHtcbi8vXHRIYW1tZXIuQXR0clJlY29nbml6ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbi8vXG4vL1x0dGhpcy5wWCA9IG51bGw7XG4vL1x0dGhpcy5wWSA9IG51bGw7XG4vL31cbi8vXG4vL2luaGVyaXQoUGFuUmVjb2duaXplciwgSGFtbWVyLkF0dHJSZWNvZ25pemVyLCB7XG4vL1x0LyoqXG4vL1x0LyogQG5hbWVzcGFjZVxuLy9cdC8qIEBtZW1iZXJvZiBQYW5SZWNvZ25pemVyXG4vL1x0LyovXG4vL1x0ZGVmYXVsdHM6IHtcbi8vXHRcdGV2ZW50OiBcInBhblwiLFxuLy9cdFx0dGhyZXNob2xkOiAxMCxcbi8vXHRcdHBvaW50ZXJzOiAxLFxuLy9cdFx0ZGlyZWN0aW9uOiBESVJFQ1RJT05fQUxMXG4vL1x0fSxcbi8vXG4vL1x0Z2V0VG91Y2hBY3Rpb246IGZ1bmN0aW9uKCkge1xuLy9cdFx0dmFyIGRpcmVjdGlvbiA9IHRoaXMub3B0aW9ucy5kaXJlY3Rpb247XG4vL1x0XHR2YXIgYWN0aW9ucyA9IFtdO1xuLy9cdFx0aWYgKGRpcmVjdGlvbiAmIERJUkVDVElPTl9IT1JJWk9OVEFMKSB7XG4vL1x0XHRcdGFjdGlvbnMucHVzaChUT1VDSF9BQ1RJT05fUEFOX1kpO1xuLy9cdFx0fVxuLy9cdFx0aWYgKGRpcmVjdGlvbiAmIERJUkVDVElPTl9WRVJUSUNBTCkge1xuLy9cdFx0XHRhY3Rpb25zLnB1c2goVE9VQ0hfQUNUSU9OX1BBTl9YKTtcbi8vXHRcdH1cbi8vXHRcdHJldHVybiBhY3Rpb25zO1xuLy9cdH0sXG4vL1xuLy9cdGRpcmVjdGlvblRlc3Q6IGZ1bmN0aW9uKGlucHV0KSB7XG4vL1x0XHR2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9ucztcbi8vXHRcdHZhciBoYXNNb3ZlZCA9IHRydWU7XG4vL1x0XHR2YXIgZGlzdGFuY2UgPSBpbnB1dC5kaXN0YW5jZTtcbi8vXHRcdHZhciBkaXJlY3Rpb24gPSBpbnB1dC5kaXJlY3Rpb247XG4vL1x0XHR2YXIgeCA9IGlucHV0LmRlbHRhWDtcbi8vXHRcdHZhciB5ID0gaW5wdXQuZGVsdGFZO1xuLy9cbi8vXHRcdC8vIGxvY2sgdG8gYXhpcz9cbi8vXHRcdGlmICghKGRpcmVjdGlvbiAmIG9wdGlvbnMuZGlyZWN0aW9uKSkge1xuLy9cdFx0XHRpZiAob3B0aW9ucy5kaXJlY3Rpb24gJiBESVJFQ1RJT05fSE9SSVpPTlRBTCkge1xuLy9cdFx0XHRcdGRpcmVjdGlvbiA9ICh4ID09PSAwKSA/IERJUkVDVElPTl9OT05FIDogKHggPCAwKSA/IERJUkVDVElPTl9MRUZUIDogRElSRUNUSU9OX1JJR0hUO1xuLy9cdFx0XHRcdGhhc01vdmVkID0geCAhPSB0aGlzLnBYO1xuLy9cdFx0XHRcdGRpc3RhbmNlID0gTWF0aC5hYnMoaW5wdXQuZGVsdGFYKTtcbi8vXHRcdFx0fSBlbHNlIHtcbi8vXHRcdFx0XHRkaXJlY3Rpb24gPSAoeSA9PT0gMCkgPyBESVJFQ1RJT05fTk9ORSA6ICh5IDwgMCkgPyBESVJFQ1RJT05fVVAgOiBESVJFQ1RJT05fRE9XTjtcbi8vXHRcdFx0XHRoYXNNb3ZlZCA9IHkgIT0gdGhpcy5wWTtcbi8vXHRcdFx0XHRkaXN0YW5jZSA9IE1hdGguYWJzKGlucHV0LmRlbHRhWSk7XG4vL1x0XHRcdH1cbi8vXHRcdH1cbi8vXHRcdGlucHV0LmRpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbi8vXHRcdHJldHVybiBoYXNNb3ZlZCAmJiBkaXN0YW5jZSA+IG9wdGlvbnMudGhyZXNob2xkICYmIGRpcmVjdGlvbiAmIG9wdGlvbnMuZGlyZWN0aW9uO1xuLy9cdH0sXG4vL1xuLy9cdGF0dHJUZXN0OiBmdW5jdGlvbihpbnB1dCkge1xuLy9cdFx0cmV0dXJuIEF0dHJSZWNvZ25pemVyLnByb3RvdHlwZS5hdHRyVGVzdC5jYWxsKHRoaXMsIGlucHV0KSAmJlxuLy9cdFx0XHQodGhpcy5zdGF0ZSAmIFNUQVRFX0JFR0FOIHx8ICghKHRoaXMuc3RhdGUgJiBTVEFURV9CRUdBTikgJiYgdGhpcy5kaXJlY3Rpb25UZXN0KGlucHV0KSkpO1xuLy9cdH0sXG4vL1xuLy9cdGVtaXQ6IGZ1bmN0aW9uKGlucHV0KSB7XG4vL1x0XHR0aGlzLnBYID0gaW5wdXQuZGVsdGFYO1xuLy9cdFx0dGhpcy5wWSA9IGlucHV0LmRlbHRhWTtcbi8vXG4vL1x0XHR2YXIgZGlyZWN0aW9uID0gZGlyU3RyKGlucHV0LmRpcmVjdGlvbik7XG4vL1x0XHRpZiAoZGlyZWN0aW9uKSB7XG4vL1x0XHRcdHRoaXMubWFuYWdlci5lbWl0KHRoaXMub3B0aW9ucy5ldmVudCArIGRpcmVjdGlvbiwgaW5wdXQpO1xuLy9cdFx0fVxuLy9cbi8vXHRcdHRoaXMuX3N1cGVyLmVtaXQuY2FsbCh0aGlzLCBpbnB1dCk7XG4vL1x0fVxuLy99KTtcblxuLyoqXG4gKiBTbW9vdGhQYW5cbiAqIEBjb25zdHJ1Y3RvclxuICogQGV4dGVuZHMgSGFtbWVyLlBhblxuICovXG5mdW5jdGlvbiBTbW9vdGhQYW4oKSB7XG5cdHZhciByZXQgPSBIYW1tZXIuUGFuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdHRoaXMudGhyZXNob2xkT2Zmc2V0WCA9IG51bGw7XG5cdHRoaXMudGhyZXNob2xkT2Zmc2V0WSA9IG51bGw7XG5cdHRoaXMudGhyZXNob2xkT2Zmc2V0ID0gbnVsbDtcblx0cmV0dXJuIHJldDtcbn1cblxuSGFtbWVyLmluaGVyaXQoU21vb3RoUGFuLCBIYW1tZXIuUGFuLCB7XG5cdGVtaXQ6IGZ1bmN0aW9uKGlucHV0KSB7XG5cdFx0Ly8gSW5oZXJpdGFuY2UgYnJlYWtzLCBzbyB0aGlzIGNvZGUgaXMgdGFrZW4gZnJvbSBQYW5SZWNvZ25pemVyLmVtaXRcblx0XHQvL1x0dGhpcy5fc3VwZXIuZW1pdC5jYWxsKHRoaXMsIGlucHV0KTsgLy8gVHJpZ2dlcnMgaW5maW5pdGUgcmVjdXJzaW9uXG5cdFx0Ly9cdEhhbW1lci5QYW4ucHJvdG90eXBlLmVtaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsgLy8gVGhpcyBicmVha3MgdG9vXG5cblx0XHR2YXIgdGhyZXNob2xkID0gdGhpcy5vcHRpb25zLnRocmVzaG9sZDtcblx0XHR2YXIgZGlyZWN0aW9uID0gaW5wdXQuZGlyZWN0aW9uO1xuXG5cdFx0aWYgKHRoaXMuc3RhdGUgPT0gSGFtbWVyLlNUQVRFX0JFR0FOKSB7XG5cdFx0XHR0aGlzLnRocmVzaG9sZE9mZnNldFggPSAoZGlyZWN0aW9uICYgSGFtbWVyLkRJUkVDVElPTl9IT1JJWk9OVEFMKSA/ICgoZGlyZWN0aW9uICYgSGFtbWVyLkRJUkVDVElPTl9MRUZUKSA/IHRocmVzaG9sZCA6IC10aHJlc2hvbGQpIDogMDtcblx0XHRcdHRoaXMudGhyZXNob2xkT2Zmc2V0WSA9IChkaXJlY3Rpb24gJiBIYW1tZXIuRElSRUNUSU9OX1ZFUlRJQ0FMKSA/ICgoZGlyZWN0aW9uICYgSGFtbWVyLkRJUkVDVElPTl9VUCkgPyB0aHJlc2hvbGQgOiAtdGhyZXNob2xkKSA6IDA7XG5cdFx0XHQvLyB0aGlzLnRocmVzaG9sZE9mZnNldCA9IChkaXJlY3Rpb24gJiBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUwpPyBpbnB1dC50aHJlc2hvbGRPZmZzZXRYIDogaW5wdXQudGhyZXNob2xkT2Zmc2V0WTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiUkVDT0dOSVpFUiBTVEFURVwiLCBkaXJTdHIoZGlyZWN0aW9uKSwgc3RhdGVTdHIodGhpcy5zdGF0ZSksIHRoaXMudGhyZXNob2xkT2Zmc2V0WCk7XG5cdFx0fVxuXHRcdGlucHV0LnRocmVzaG9sZE9mZnNldFggPSB0aGlzLnRocmVzaG9sZE9mZnNldFg7XG5cdFx0aW5wdXQudGhyZXNob2xkT2Zmc2V0WSA9IHRoaXMudGhyZXNob2xkT2Zmc2V0WTtcblx0XHRpbnB1dC50aHJlc2hvbGREZWx0YVggPSBpbnB1dC5kZWx0YVggKyB0aGlzLnRocmVzaG9sZE9mZnNldFg7XG5cdFx0aW5wdXQudGhyZXNob2xkRGVsdGFZID0gaW5wdXQuZGVsdGFZICsgdGhpcy50aHJlc2hvbGRPZmZzZXRZO1xuXG5cdFx0dGhpcy5wWCA9IGlucHV0LmRlbHRhWDtcblx0XHR0aGlzLnBZID0gaW5wdXQuZGVsdGFZO1xuXG5cdFx0ZGlyZWN0aW9uID0gZGlyU3RyKGRpcmVjdGlvbik7XG5cdFx0aWYgKGRpcmVjdGlvbikge1xuXHRcdFx0dGhpcy5tYW5hZ2VyLmVtaXQodGhpcy5vcHRpb25zLmV2ZW50ICsgZGlyZWN0aW9uLCBpbnB1dCk7XG5cdFx0fVxuXHRcdHJldHVybiBIYW1tZXIuUmVjb2duaXplci5wcm90b3R5cGUuZW1pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBTbW9vdGhQYW47XG4iLCJtb2R1bGUuZXhwb3J0cz17XG5cdFwidHJhbnNpdGlvbnNcIjoge1xuXHRcdFwiZWFzZVwiOiBcImVhc2VcIixcblx0XHRcImR1cmF0aW9uX21zXCI6IFwiNDAwXCIsXG5cdFx0XCJkZWxheV9pbnRlcnZhbF9tc1wiOiBcIjEwMFwiLFxuXHRcdFwibWluX2RlbGF5X21zXCI6IFwiNTBcIlxuXHR9LFxuXHRcImJyZWFrcG9pbnRzXCI6IHtcblx0XHRcImxhbmRzY2FwZVwiOiBcIicob3JpZW50YXRpb246IGxhbmRzY2FwZSknXCIsXG5cdFx0XCJwb3J0cmFpdFwiOiBcIicob3JpZW50YXRpb246IHBvcnRyYWl0KSdcIixcblx0XHRcImZ1bGx3aWR0aC1zbWFsbFwiOiBcIidub3Qgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA0NjBweCknXCIsXG5cdFx0XCJmdWxsd2lkdGhcIjogXCInbm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpLCBub3Qgc2NyZWVuIGFuZCAobWluLWhlaWdodDogNTQwcHgpJ1wiLFxuXHRcdFwiZGVza3RvcC1zbWFsbFwiOiBcIidvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogMTAyNHB4KSBhbmQgKG1pbi1oZWlnaHQ6IDU0MHB4KSdcIixcblx0XHRcImRlc2t0b3AtbWVkaXVtXCI6IFwiJ29ubHkgc2NyZWVuIGFuZCAobWluLXdpZHRoOiAxMjI0cHgpIGFuZCAobWluLWhlaWdodDogNzA0cHgpJ1wiLFxuXHRcdFwiZGVza3RvcC1sYXJnZVwiOiBcIidvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogMTgyNHB4KSBhbmQgKG1pbi1oZWlnaHQ6IDEwMjRweCknXCJcblx0fSxcblx0XCJkZWZhdWx0X2NvbG9yc1wiOiB7XG5cdFx0XCJjb2xvclwiOiBcImhzbCg0NywgNSUsIDE1JSlcIixcblx0XHRcImJhY2tncm91bmQtY29sb3JcIjogXCJoc2woNDcsIDUlLCA5NSUpXCIsXG5cdFx0XCJsaW5rLWNvbG9yXCI6IFwiaHNsKDEwLCA4MCUsIDUwJSlcIlxuXHR9LFxuXHRcInRlbXBcIjoge1xuXHRcdFwiY29sbGFwc2Vfb2Zmc2V0XCI6IFwiMzYwXCJcblx0fSxcblx0XCJfaWdub3JlXCI6IHtcblx0XHRcInRyYW5zaXRpb25zXCI6IHtcblx0XHRcdFwiZWFzZVwiOiBcImVhc2VcIixcblx0XHRcdFwiZHVyYXRpb25fbXNcIjogXCI0MDBcIixcblx0XHRcdFwiZGVsYXlfaW50ZXJ2YWxfbXNcIjogXCIxMzRcIixcblx0XHRcdFwibWluX2RlbGF5X21zXCI6IFwiMzRcIlxuXHRcdH0sXG5cdFx0XCJkZWZhdWx0X2NvbG9yc1wiOiB7XG5cdFx0XHRcIi0tbGluay1jb2xvclwiOiBcImhzbCgxMCwgODAlLCA1MCUpXCIsXG5cdFx0XHRcIi0tYWx0LWJhY2tncm91bmQtY29sb3JcIjogXCJ1bnNldFwiXG5cdFx0fSxcblx0XHRcInVuaXRzXCI6IHtcblx0XHRcdFwiaHVfcHhcIjogXCIyMFwiLFxuXHRcdFx0XCJ2dV9weFwiOiBcIjEyXCJcblx0XHR9LFxuXHRcdFwiYnJlYWtwb2ludHNcIjoge1xuXHRcdFx0XCJtb2JpbGVcIjogXCInbm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpLCBub3Qgc2NyZWVuIGFuZCAobWluLWhlaWdodDogNTQwcHgpJ1wiLFxuXHRcdFx0XCJ1bnN1cHBvcnRlZFwiOiBcIidub3Qgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA3MDRweCknXCIsXG5cdFx0XHRcInVucXVvdGVkXCI6IFwib25seSBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDE4MjRweClcIixcblx0XHRcdFwidW5xdW90ZWRfbmVnXCI6IFwibm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpXCIsXG5cdFx0XHRcInF1b3RlZF9jb21iaW5lZFwiOiBcIidub3Qgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA3MDRweCksIG5vdCBzY3JlZW4gYW5kIChtaW4taGVpZ2h0OiA1NDBweCknXCIsXG5cdFx0XHRcImFycmF5XCI6IFtcblx0XHRcdFx0XCJvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpXCIsXG5cdFx0XHRcdFwibm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpXCIsXG5cdFx0XHRcdFwibm90IHNjcmVlbiBhbmQgKG1pbi1oZWlnaHQ6IDU0MHB4KVwiXG5cdFx0XHRdXG5cdFx0fVxuXHR9XG59XG4iXX0=
