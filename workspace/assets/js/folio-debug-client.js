(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';

exports.__esModule = true;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

// istanbul ignore next

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }

var _handlebarsBase = require('./handlebars/base');

var base = _interopRequireWildcard(_handlebarsBase);

// Each of these augment the Handlebars object. No need to setup here.
// (This is done to easily share code between commonjs and browse envs)

var _handlebarsSafeString = require('./handlebars/safe-string');

var _handlebarsSafeString2 = _interopRequireDefault(_handlebarsSafeString);

var _handlebarsException = require('./handlebars/exception');

var _handlebarsException2 = _interopRequireDefault(_handlebarsException);

var _handlebarsUtils = require('./handlebars/utils');

var Utils = _interopRequireWildcard(_handlebarsUtils);

var _handlebarsRuntime = require('./handlebars/runtime');

var runtime = _interopRequireWildcard(_handlebarsRuntime);

var _handlebarsNoConflict = require('./handlebars/no-conflict');

var _handlebarsNoConflict2 = _interopRequireDefault(_handlebarsNoConflict);

// For compatibility and usage outside of module systems, make the Handlebars object a namespace
function create() {
  var hb = new base.HandlebarsEnvironment();

  Utils.extend(hb, base);
  hb.SafeString = _handlebarsSafeString2['default'];
  hb.Exception = _handlebarsException2['default'];
  hb.Utils = Utils;
  hb.escapeExpression = Utils.escapeExpression;

  hb.VM = runtime;
  hb.template = function (spec) {
    return runtime.template(spec, hb);
  };

  return hb;
}

var inst = create();
inst.create = create;

_handlebarsNoConflict2['default'](inst);

inst['default'] = inst;

exports['default'] = inst;
module.exports = exports['default'];


},{"./handlebars/base":2,"./handlebars/exception":5,"./handlebars/no-conflict":15,"./handlebars/runtime":16,"./handlebars/safe-string":17,"./handlebars/utils":18}],2:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.HandlebarsEnvironment = HandlebarsEnvironment;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _utils = require('./utils');

var _exception = require('./exception');

var _exception2 = _interopRequireDefault(_exception);

var _helpers = require('./helpers');

var _decorators = require('./decorators');

var _logger = require('./logger');

var _logger2 = _interopRequireDefault(_logger);

var VERSION = '4.0.5';
exports.VERSION = VERSION;
var COMPILER_REVISION = 7;

exports.COMPILER_REVISION = COMPILER_REVISION;
var REVISION_CHANGES = {
  1: '<= 1.0.rc.2', // 1.0.rc.2 is actually rev2 but doesn't report it
  2: '== 1.0.0-rc.3',
  3: '== 1.0.0-rc.4',
  4: '== 1.x.x',
  5: '== 2.0.0-alpha.x',
  6: '>= 2.0.0-beta.1',
  7: '>= 4.0.0'
};

exports.REVISION_CHANGES = REVISION_CHANGES;
var objectType = '[object Object]';

function HandlebarsEnvironment(helpers, partials, decorators) {
  this.helpers = helpers || {};
  this.partials = partials || {};
  this.decorators = decorators || {};

  _helpers.registerDefaultHelpers(this);
  _decorators.registerDefaultDecorators(this);
}

HandlebarsEnvironment.prototype = {
  constructor: HandlebarsEnvironment,

  logger: _logger2['default'],
  log: _logger2['default'].log,

  registerHelper: function registerHelper(name, fn) {
    if (_utils.toString.call(name) === objectType) {
      if (fn) {
        throw new _exception2['default']('Arg not supported with multiple helpers');
      }
      _utils.extend(this.helpers, name);
    } else {
      this.helpers[name] = fn;
    }
  },
  unregisterHelper: function unregisterHelper(name) {
    delete this.helpers[name];
  },

  registerPartial: function registerPartial(name, partial) {
    if (_utils.toString.call(name) === objectType) {
      _utils.extend(this.partials, name);
    } else {
      if (typeof partial === 'undefined') {
        throw new _exception2['default']('Attempting to register a partial called "' + name + '" as undefined');
      }
      this.partials[name] = partial;
    }
  },
  unregisterPartial: function unregisterPartial(name) {
    delete this.partials[name];
  },

  registerDecorator: function registerDecorator(name, fn) {
    if (_utils.toString.call(name) === objectType) {
      if (fn) {
        throw new _exception2['default']('Arg not supported with multiple decorators');
      }
      _utils.extend(this.decorators, name);
    } else {
      this.decorators[name] = fn;
    }
  },
  unregisterDecorator: function unregisterDecorator(name) {
    delete this.decorators[name];
  }
};

var log = _logger2['default'].log;

exports.log = log;
exports.createFrame = _utils.createFrame;
exports.logger = _logger2['default'];


},{"./decorators":3,"./exception":5,"./helpers":6,"./logger":14,"./utils":18}],3:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.registerDefaultDecorators = registerDefaultDecorators;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _decoratorsInline = require('./decorators/inline');

var _decoratorsInline2 = _interopRequireDefault(_decoratorsInline);

function registerDefaultDecorators(instance) {
  _decoratorsInline2['default'](instance);
}


},{"./decorators/inline":4}],4:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerDecorator('inline', function (fn, props, container, options) {
    var ret = fn;
    if (!props.partials) {
      props.partials = {};
      ret = function (context, options) {
        // Create a new partials stack frame prior to exec.
        var original = container.partials;
        container.partials = _utils.extend({}, original, props.partials);
        var ret = fn(context, options);
        container.partials = original;
        return ret;
      };
    }

    props.partials[options.args[0]] = options.fn;

    return ret;
  });
};

module.exports = exports['default'];


},{"../utils":18}],5:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var errorProps = ['description', 'fileName', 'lineNumber', 'message', 'name', 'number', 'stack'];

function Exception(message, node) {
  var loc = node && node.loc,
      line = undefined,
      column = undefined;
  if (loc) {
    line = loc.start.line;
    column = loc.start.column;

    message += ' - ' + line + ':' + column;
  }

  var tmp = Error.prototype.constructor.call(this, message);

  // Unfortunately errors are not enumerable in Chrome (at least), so `for prop in tmp` doesn't work.
  for (var idx = 0; idx < errorProps.length; idx++) {
    this[errorProps[idx]] = tmp[errorProps[idx]];
  }

  /* istanbul ignore else */
  if (Error.captureStackTrace) {
    Error.captureStackTrace(this, Exception);
  }

  if (loc) {
    this.lineNumber = line;
    this.column = column;
  }
}

Exception.prototype = new Error();

exports['default'] = Exception;
module.exports = exports['default'];


},{}],6:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.registerDefaultHelpers = registerDefaultHelpers;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _helpersBlockHelperMissing = require('./helpers/block-helper-missing');

var _helpersBlockHelperMissing2 = _interopRequireDefault(_helpersBlockHelperMissing);

var _helpersEach = require('./helpers/each');

var _helpersEach2 = _interopRequireDefault(_helpersEach);

var _helpersHelperMissing = require('./helpers/helper-missing');

var _helpersHelperMissing2 = _interopRequireDefault(_helpersHelperMissing);

var _helpersIf = require('./helpers/if');

var _helpersIf2 = _interopRequireDefault(_helpersIf);

var _helpersLog = require('./helpers/log');

var _helpersLog2 = _interopRequireDefault(_helpersLog);

var _helpersLookup = require('./helpers/lookup');

var _helpersLookup2 = _interopRequireDefault(_helpersLookup);

var _helpersWith = require('./helpers/with');

var _helpersWith2 = _interopRequireDefault(_helpersWith);

function registerDefaultHelpers(instance) {
  _helpersBlockHelperMissing2['default'](instance);
  _helpersEach2['default'](instance);
  _helpersHelperMissing2['default'](instance);
  _helpersIf2['default'](instance);
  _helpersLog2['default'](instance);
  _helpersLookup2['default'](instance);
  _helpersWith2['default'](instance);
}


},{"./helpers/block-helper-missing":7,"./helpers/each":8,"./helpers/helper-missing":9,"./helpers/if":10,"./helpers/log":11,"./helpers/lookup":12,"./helpers/with":13}],7:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerHelper('blockHelperMissing', function (context, options) {
    var inverse = options.inverse,
        fn = options.fn;

    if (context === true) {
      return fn(this);
    } else if (context === false || context == null) {
      return inverse(this);
    } else if (_utils.isArray(context)) {
      if (context.length > 0) {
        if (options.ids) {
          options.ids = [options.name];
        }

        return instance.helpers.each(context, options);
      } else {
        return inverse(this);
      }
    } else {
      if (options.data && options.ids) {
        var data = _utils.createFrame(options.data);
        data.contextPath = _utils.appendContextPath(options.data.contextPath, options.name);
        options = { data: data };
      }

      return fn(context, options);
    }
  });
};

module.exports = exports['default'];


},{"../utils":18}],8:[function(require,module,exports){
'use strict';

exports.__esModule = true;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _utils = require('../utils');

var _exception = require('../exception');

var _exception2 = _interopRequireDefault(_exception);

exports['default'] = function (instance) {
  instance.registerHelper('each', function (context, options) {
    if (!options) {
      throw new _exception2['default']('Must pass iterator to #each');
    }

    var fn = options.fn,
        inverse = options.inverse,
        i = 0,
        ret = '',
        data = undefined,
        contextPath = undefined;

    if (options.data && options.ids) {
      contextPath = _utils.appendContextPath(options.data.contextPath, options.ids[0]) + '.';
    }

    if (_utils.isFunction(context)) {
      context = context.call(this);
    }

    if (options.data) {
      data = _utils.createFrame(options.data);
    }

    function execIteration(field, index, last) {
      if (data) {
        data.key = field;
        data.index = index;
        data.first = index === 0;
        data.last = !!last;

        if (contextPath) {
          data.contextPath = contextPath + field;
        }
      }

      ret = ret + fn(context[field], {
        data: data,
        blockParams: _utils.blockParams([context[field], field], [contextPath + field, null])
      });
    }

    if (context && typeof context === 'object') {
      if (_utils.isArray(context)) {
        for (var j = context.length; i < j; i++) {
          if (i in context) {
            execIteration(i, i, i === context.length - 1);
          }
        }
      } else {
        var priorKey = undefined;

        for (var key in context) {
          if (context.hasOwnProperty(key)) {
            // We're running the iterations one step out of sync so we can detect
            // the last iteration without have to scan the object twice and create
            // an itermediate keys array.
            if (priorKey !== undefined) {
              execIteration(priorKey, i - 1);
            }
            priorKey = key;
            i++;
          }
        }
        if (priorKey !== undefined) {
          execIteration(priorKey, i - 1, true);
        }
      }
    }

    if (i === 0) {
      ret = inverse(this);
    }

    return ret;
  });
};

module.exports = exports['default'];


},{"../exception":5,"../utils":18}],9:[function(require,module,exports){
'use strict';

exports.__esModule = true;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _exception = require('../exception');

var _exception2 = _interopRequireDefault(_exception);

exports['default'] = function (instance) {
  instance.registerHelper('helperMissing', function () /* [args, ]options */{
    if (arguments.length === 1) {
      // A missing field in a {{foo}} construct.
      return undefined;
    } else {
      // Someone is actually trying to call something, blow up.
      throw new _exception2['default']('Missing helper: "' + arguments[arguments.length - 1].name + '"');
    }
  });
};

module.exports = exports['default'];


},{"../exception":5}],10:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerHelper('if', function (conditional, options) {
    if (_utils.isFunction(conditional)) {
      conditional = conditional.call(this);
    }

    // Default behavior is to render the positive path if the value is truthy and not empty.
    // The `includeZero` option may be set to treat the condtional as purely not empty based on the
    // behavior of isEmpty. Effectively this determines if 0 is handled by the positive path or negative.
    if (!options.hash.includeZero && !conditional || _utils.isEmpty(conditional)) {
      return options.inverse(this);
    } else {
      return options.fn(this);
    }
  });

  instance.registerHelper('unless', function (conditional, options) {
    return instance.helpers['if'].call(this, conditional, { fn: options.inverse, inverse: options.fn, hash: options.hash });
  });
};

module.exports = exports['default'];


},{"../utils":18}],11:[function(require,module,exports){
'use strict';

exports.__esModule = true;

exports['default'] = function (instance) {
  instance.registerHelper('log', function () /* message, options */{
    var args = [undefined],
        options = arguments[arguments.length - 1];
    for (var i = 0; i < arguments.length - 1; i++) {
      args.push(arguments[i]);
    }

    var level = 1;
    if (options.hash.level != null) {
      level = options.hash.level;
    } else if (options.data && options.data.level != null) {
      level = options.data.level;
    }
    args[0] = level;

    instance.log.apply(instance, args);
  });
};

module.exports = exports['default'];


},{}],12:[function(require,module,exports){
'use strict';

exports.__esModule = true;

exports['default'] = function (instance) {
  instance.registerHelper('lookup', function (obj, field) {
    return obj && obj[field];
  });
};

module.exports = exports['default'];


},{}],13:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerHelper('with', function (context, options) {
    if (_utils.isFunction(context)) {
      context = context.call(this);
    }

    var fn = options.fn;

    if (!_utils.isEmpty(context)) {
      var data = options.data;
      if (options.data && options.ids) {
        data = _utils.createFrame(options.data);
        data.contextPath = _utils.appendContextPath(options.data.contextPath, options.ids[0]);
      }

      return fn(context, {
        data: data,
        blockParams: _utils.blockParams([context], [data && data.contextPath])
      });
    } else {
      return options.inverse(this);
    }
  });
};

module.exports = exports['default'];


},{"../utils":18}],14:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('./utils');

var logger = {
  methodMap: ['debug', 'info', 'warn', 'error'],
  level: 'info',

  // Maps a given level value to the `methodMap` indexes above.
  lookupLevel: function lookupLevel(level) {
    if (typeof level === 'string') {
      var levelMap = _utils.indexOf(logger.methodMap, level.toLowerCase());
      if (levelMap >= 0) {
        level = levelMap;
      } else {
        level = parseInt(level, 10);
      }
    }

    return level;
  },

  // Can be overridden in the host environment
  log: function log(level) {
    level = logger.lookupLevel(level);

    if (typeof console !== 'undefined' && logger.lookupLevel(logger.level) <= level) {
      var method = logger.methodMap[level];
      if (!console[method]) {
        // eslint-disable-line no-console
        method = 'log';
      }

      for (var _len = arguments.length, message = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        message[_key - 1] = arguments[_key];
      }

      console[method].apply(console, message); // eslint-disable-line no-console
    }
  }
};

exports['default'] = logger;
module.exports = exports['default'];


},{"./utils":18}],15:[function(require,module,exports){
(function (global){
/* global window */
'use strict';

exports.__esModule = true;

exports['default'] = function (Handlebars) {
  /* istanbul ignore next */
  var root = typeof global !== 'undefined' ? global : window,
      $Handlebars = root.Handlebars;
  /* istanbul ignore next */
  Handlebars.noConflict = function () {
    if (root.Handlebars === Handlebars) {
      root.Handlebars = $Handlebars;
    }
    return Handlebars;
  };
};

module.exports = exports['default'];


}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],16:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.checkRevision = checkRevision;
exports.template = template;
exports.wrapProgram = wrapProgram;
exports.resolvePartial = resolvePartial;
exports.invokePartial = invokePartial;
exports.noop = noop;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

// istanbul ignore next

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }

var _utils = require('./utils');

var Utils = _interopRequireWildcard(_utils);

var _exception = require('./exception');

var _exception2 = _interopRequireDefault(_exception);

var _base = require('./base');

function checkRevision(compilerInfo) {
  var compilerRevision = compilerInfo && compilerInfo[0] || 1,
      currentRevision = _base.COMPILER_REVISION;

  if (compilerRevision !== currentRevision) {
    if (compilerRevision < currentRevision) {
      var runtimeVersions = _base.REVISION_CHANGES[currentRevision],
          compilerVersions = _base.REVISION_CHANGES[compilerRevision];
      throw new _exception2['default']('Template was precompiled with an older version of Handlebars than the current runtime. ' + 'Please update your precompiler to a newer version (' + runtimeVersions + ') or downgrade your runtime to an older version (' + compilerVersions + ').');
    } else {
      // Use the embedded version info since the runtime doesn't know about this revision yet
      throw new _exception2['default']('Template was precompiled with a newer version of Handlebars than the current runtime. ' + 'Please update your runtime to a newer version (' + compilerInfo[1] + ').');
    }
  }
}

function template(templateSpec, env) {
  /* istanbul ignore next */
  if (!env) {
    throw new _exception2['default']('No environment passed to template');
  }
  if (!templateSpec || !templateSpec.main) {
    throw new _exception2['default']('Unknown template object: ' + typeof templateSpec);
  }

  templateSpec.main.decorator = templateSpec.main_d;

  // Note: Using env.VM references rather than local var references throughout this section to allow
  // for external users to override these as psuedo-supported APIs.
  env.VM.checkRevision(templateSpec.compiler);

  function invokePartialWrapper(partial, context, options) {
    if (options.hash) {
      context = Utils.extend({}, context, options.hash);
      if (options.ids) {
        options.ids[0] = true;
      }
    }

    partial = env.VM.resolvePartial.call(this, partial, context, options);
    var result = env.VM.invokePartial.call(this, partial, context, options);

    if (result == null && env.compile) {
      options.partials[options.name] = env.compile(partial, templateSpec.compilerOptions, env);
      result = options.partials[options.name](context, options);
    }
    if (result != null) {
      if (options.indent) {
        var lines = result.split('\n');
        for (var i = 0, l = lines.length; i < l; i++) {
          if (!lines[i] && i + 1 === l) {
            break;
          }

          lines[i] = options.indent + lines[i];
        }
        result = lines.join('\n');
      }
      return result;
    } else {
      throw new _exception2['default']('The partial ' + options.name + ' could not be compiled when running in runtime-only mode');
    }
  }

  // Just add water
  var container = {
    strict: function strict(obj, name) {
      if (!(name in obj)) {
        throw new _exception2['default']('"' + name + '" not defined in ' + obj);
      }
      return obj[name];
    },
    lookup: function lookup(depths, name) {
      var len = depths.length;
      for (var i = 0; i < len; i++) {
        if (depths[i] && depths[i][name] != null) {
          return depths[i][name];
        }
      }
    },
    lambda: function lambda(current, context) {
      return typeof current === 'function' ? current.call(context) : current;
    },

    escapeExpression: Utils.escapeExpression,
    invokePartial: invokePartialWrapper,

    fn: function fn(i) {
      var ret = templateSpec[i];
      ret.decorator = templateSpec[i + '_d'];
      return ret;
    },

    programs: [],
    program: function program(i, data, declaredBlockParams, blockParams, depths) {
      var programWrapper = this.programs[i],
          fn = this.fn(i);
      if (data || depths || blockParams || declaredBlockParams) {
        programWrapper = wrapProgram(this, i, fn, data, declaredBlockParams, blockParams, depths);
      } else if (!programWrapper) {
        programWrapper = this.programs[i] = wrapProgram(this, i, fn);
      }
      return programWrapper;
    },

    data: function data(value, depth) {
      while (value && depth--) {
        value = value._parent;
      }
      return value;
    },
    merge: function merge(param, common) {
      var obj = param || common;

      if (param && common && param !== common) {
        obj = Utils.extend({}, common, param);
      }

      return obj;
    },

    noop: env.VM.noop,
    compilerInfo: templateSpec.compiler
  };

  function ret(context) {
    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var data = options.data;

    ret._setup(options);
    if (!options.partial && templateSpec.useData) {
      data = initData(context, data);
    }
    var depths = undefined,
        blockParams = templateSpec.useBlockParams ? [] : undefined;
    if (templateSpec.useDepths) {
      if (options.depths) {
        depths = context !== options.depths[0] ? [context].concat(options.depths) : options.depths;
      } else {
        depths = [context];
      }
    }

    function main(context /*, options*/) {
      return '' + templateSpec.main(container, context, container.helpers, container.partials, data, blockParams, depths);
    }
    main = executeDecorators(templateSpec.main, main, container, options.depths || [], data, blockParams);
    return main(context, options);
  }
  ret.isTop = true;

  ret._setup = function (options) {
    if (!options.partial) {
      container.helpers = container.merge(options.helpers, env.helpers);

      if (templateSpec.usePartial) {
        container.partials = container.merge(options.partials, env.partials);
      }
      if (templateSpec.usePartial || templateSpec.useDecorators) {
        container.decorators = container.merge(options.decorators, env.decorators);
      }
    } else {
      container.helpers = options.helpers;
      container.partials = options.partials;
      container.decorators = options.decorators;
    }
  };

  ret._child = function (i, data, blockParams, depths) {
    if (templateSpec.useBlockParams && !blockParams) {
      throw new _exception2['default']('must pass block params');
    }
    if (templateSpec.useDepths && !depths) {
      throw new _exception2['default']('must pass parent depths');
    }

    return wrapProgram(container, i, templateSpec[i], data, 0, blockParams, depths);
  };
  return ret;
}

function wrapProgram(container, i, fn, data, declaredBlockParams, blockParams, depths) {
  function prog(context) {
    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var currentDepths = depths;
    if (depths && context !== depths[0]) {
      currentDepths = [context].concat(depths);
    }

    return fn(container, context, container.helpers, container.partials, options.data || data, blockParams && [options.blockParams].concat(blockParams), currentDepths);
  }

  prog = executeDecorators(fn, prog, container, depths, data, blockParams);

  prog.program = i;
  prog.depth = depths ? depths.length : 0;
  prog.blockParams = declaredBlockParams || 0;
  return prog;
}

function resolvePartial(partial, context, options) {
  if (!partial) {
    if (options.name === '@partial-block') {
      partial = options.data['partial-block'];
    } else {
      partial = options.partials[options.name];
    }
  } else if (!partial.call && !options.name) {
    // This is a dynamic partial that returned a string
    options.name = partial;
    partial = options.partials[partial];
  }
  return partial;
}

function invokePartial(partial, context, options) {
  options.partial = true;
  if (options.ids) {
    options.data.contextPath = options.ids[0] || options.data.contextPath;
  }

  var partialBlock = undefined;
  if (options.fn && options.fn !== noop) {
    options.data = _base.createFrame(options.data);
    partialBlock = options.data['partial-block'] = options.fn;

    if (partialBlock.partials) {
      options.partials = Utils.extend({}, options.partials, partialBlock.partials);
    }
  }

  if (partial === undefined && partialBlock) {
    partial = partialBlock;
  }

  if (partial === undefined) {
    throw new _exception2['default']('The partial ' + options.name + ' could not be found');
  } else if (partial instanceof Function) {
    return partial(context, options);
  }
}

function noop() {
  return '';
}

function initData(context, data) {
  if (!data || !('root' in data)) {
    data = data ? _base.createFrame(data) : {};
    data.root = context;
  }
  return data;
}

function executeDecorators(fn, prog, container, depths, data, blockParams) {
  if (fn.decorator) {
    var props = {};
    prog = fn.decorator(prog, props, container, depths && depths[0], data, blockParams, depths);
    Utils.extend(prog, props);
  }
  return prog;
}


},{"./base":2,"./exception":5,"./utils":18}],17:[function(require,module,exports){
// Build out our basic SafeString type
'use strict';

exports.__esModule = true;
function SafeString(string) {
  this.string = string;
}

SafeString.prototype.toString = SafeString.prototype.toHTML = function () {
  return '' + this.string;
};

exports['default'] = SafeString;
module.exports = exports['default'];


},{}],18:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.extend = extend;
exports.indexOf = indexOf;
exports.escapeExpression = escapeExpression;
exports.isEmpty = isEmpty;
exports.createFrame = createFrame;
exports.blockParams = blockParams;
exports.appendContextPath = appendContextPath;
var escape = {
  '&': '&amp;',
  '<': '&lt;',
  '>': '&gt;',
  '"': '&quot;',
  "'": '&#x27;',
  '`': '&#x60;',
  '=': '&#x3D;'
};

var badChars = /[&<>"'`=]/g,
    possible = /[&<>"'`=]/;

function escapeChar(chr) {
  return escape[chr];
}

function extend(obj /* , ...source */) {
  for (var i = 1; i < arguments.length; i++) {
    for (var key in arguments[i]) {
      if (Object.prototype.hasOwnProperty.call(arguments[i], key)) {
        obj[key] = arguments[i][key];
      }
    }
  }

  return obj;
}

var toString = Object.prototype.toString;

exports.toString = toString;
// Sourced from lodash
// https://github.com/bestiejs/lodash/blob/master/LICENSE.txt
/* eslint-disable func-style */
var isFunction = function isFunction(value) {
  return typeof value === 'function';
};
// fallback for older versions of Chrome and Safari
/* istanbul ignore next */
if (isFunction(/x/)) {
  exports.isFunction = isFunction = function (value) {
    return typeof value === 'function' && toString.call(value) === '[object Function]';
  };
}
exports.isFunction = isFunction;

/* eslint-enable func-style */

/* istanbul ignore next */
var isArray = Array.isArray || function (value) {
  return value && typeof value === 'object' ? toString.call(value) === '[object Array]' : false;
};

exports.isArray = isArray;
// Older IE versions do not directly support indexOf so we must implement our own, sadly.

function indexOf(array, value) {
  for (var i = 0, len = array.length; i < len; i++) {
    if (array[i] === value) {
      return i;
    }
  }
  return -1;
}

function escapeExpression(string) {
  if (typeof string !== 'string') {
    // don't escape SafeStrings, since they're already safe
    if (string && string.toHTML) {
      return string.toHTML();
    } else if (string == null) {
      return '';
    } else if (!string) {
      return string + '';
    }

    // Force a string conversion as this will be done by the append regardless and
    // the regex test will do this transparently behind the scenes, causing issues if
    // an object's to string has escaped characters in it.
    string = '' + string;
  }

  if (!possible.test(string)) {
    return string;
  }
  return string.replace(badChars, escapeChar);
}

function isEmpty(value) {
  if (!value && value !== 0) {
    return true;
  } else if (isArray(value) && value.length === 0) {
    return true;
  } else {
    return false;
  }
}

function createFrame(object) {
  var frame = extend({}, object);
  frame._parent = object;
  return frame;
}

function blockParams(params, ids) {
  params.path = ids;
  return params;
}

function appendContextPath(contextPath, id) {
  return (contextPath ? contextPath + '.' : '') + id;
}


},{}],19:[function(require,module,exports){
// Create a simple path alias to allow browserify to resolve
// the runtime on a supported path.
module.exports = require('./dist/cjs/handlebars.runtime')['default'];

},{"./dist/cjs/handlebars.runtime":1}],20:[function(require,module,exports){
module.exports = require("handlebars/runtime")["default"];

},{"handlebars/runtime":19}],21:[function(require,module,exports){
// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],22:[function(require,module,exports){
(function (process,global){
(function (global, undefined) {
    "use strict";

    if (global.setImmediate) {
        return;
    }

    var nextHandle = 1; // Spec says greater than zero
    var tasksByHandle = {};
    var currentlyRunningATask = false;
    var doc = global.document;
    var registerImmediate;

    function setImmediate(callback) {
      // Callback can either be a function or a string
      if (typeof callback !== "function") {
        callback = new Function("" + callback);
      }
      // Copy function arguments
      var args = new Array(arguments.length - 1);
      for (var i = 0; i < args.length; i++) {
          args[i] = arguments[i + 1];
      }
      // Store and register the task
      var task = { callback: callback, args: args };
      tasksByHandle[nextHandle] = task;
      registerImmediate(nextHandle);
      return nextHandle++;
    }

    function clearImmediate(handle) {
        delete tasksByHandle[handle];
    }

    function run(task) {
        var callback = task.callback;
        var args = task.args;
        switch (args.length) {
        case 0:
            callback();
            break;
        case 1:
            callback(args[0]);
            break;
        case 2:
            callback(args[0], args[1]);
            break;
        case 3:
            callback(args[0], args[1], args[2]);
            break;
        default:
            callback.apply(undefined, args);
            break;
        }
    }

    function runIfPresent(handle) {
        // From the spec: "Wait until any invocations of this algorithm started before this one have completed."
        // So if we're currently running a task, we'll need to delay this invocation.
        if (currentlyRunningATask) {
            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a
            // "too much recursion" error.
            setTimeout(runIfPresent, 0, handle);
        } else {
            var task = tasksByHandle[handle];
            if (task) {
                currentlyRunningATask = true;
                try {
                    run(task);
                } finally {
                    clearImmediate(handle);
                    currentlyRunningATask = false;
                }
            }
        }
    }

    function installNextTickImplementation() {
        registerImmediate = function(handle) {
            process.nextTick(function () { runIfPresent(handle); });
        };
    }

    function canUsePostMessage() {
        // The test against `importScripts` prevents this implementation from being installed inside a web worker,
        // where `global.postMessage` means something completely different and can't be used for this purpose.
        if (global.postMessage && !global.importScripts) {
            var postMessageIsAsynchronous = true;
            var oldOnMessage = global.onmessage;
            global.onmessage = function() {
                postMessageIsAsynchronous = false;
            };
            global.postMessage("", "*");
            global.onmessage = oldOnMessage;
            return postMessageIsAsynchronous;
        }
    }

    function installPostMessageImplementation() {
        // Installs an event handler on `global` for the `message` event: see
        // * https://developer.mozilla.org/en/DOM/window.postMessage
        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages

        var messagePrefix = "setImmediate$" + Math.random() + "$";
        var onGlobalMessage = function(event) {
            if (event.source === global &&
                typeof event.data === "string" &&
                event.data.indexOf(messagePrefix) === 0) {
                runIfPresent(+event.data.slice(messagePrefix.length));
            }
        };

        if (global.addEventListener) {
            global.addEventListener("message", onGlobalMessage, false);
        } else {
            global.attachEvent("onmessage", onGlobalMessage);
        }

        registerImmediate = function(handle) {
            global.postMessage(messagePrefix + handle, "*");
        };
    }

    function installMessageChannelImplementation() {
        var channel = new MessageChannel();
        channel.port1.onmessage = function(event) {
            var handle = event.data;
            runIfPresent(handle);
        };

        registerImmediate = function(handle) {
            channel.port2.postMessage(handle);
        };
    }

    function installReadyStateChangeImplementation() {
        var html = doc.documentElement;
        registerImmediate = function(handle) {
            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted
            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.
            var script = doc.createElement("script");
            script.onreadystatechange = function () {
                runIfPresent(handle);
                script.onreadystatechange = null;
                html.removeChild(script);
                script = null;
            };
            html.appendChild(script);
        };
    }

    function installSetTimeoutImplementation() {
        registerImmediate = function(handle) {
            setTimeout(runIfPresent, 0, handle);
        };
    }

    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.
    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);
    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;

    // Don't get fooled by e.g. browserify environments.
    if ({}.toString.call(global.process) === "[object process]") {
        // For Node.js before 0.9
        installNextTickImplementation();

    } else if (canUsePostMessage()) {
        // For non-IE10 modern browsers
        installPostMessageImplementation();

    } else if (global.MessageChannel) {
        // For web workers, where supported
        installMessageChannelImplementation();

    } else if (doc && "onreadystatechange" in doc.createElement("script")) {
        // For IE 6â€“8
        installReadyStateChangeImplementation();

    } else {
        // For older browsers
        installSetTimeoutImplementation();
    }

    attachTo.setImmediate = setImmediate;
    attachTo.clearImmediate = clearImmediate;
}(typeof self === "undefined" ? typeof global === "undefined" ? this : global : self));

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"_process":21}],23:[function(require,module,exports){
var trim = require('./trim');

module.exports = function dasherize(str) {
  return trim(str).replace(/([A-Z])/g, '-$1').replace(/[-_\s]+/g, '-').toLowerCase();
};

},{"./trim":31}],24:[function(require,module,exports){
var escapeRegExp = require('./escapeRegExp');

module.exports = function defaultToWhiteSpace(characters) {
  if (characters == null)
    return '\\s';
  else if (characters.source)
    return characters.source;
  else
    return '[' + escapeRegExp(characters) + ']';
};

},{"./escapeRegExp":25}],25:[function(require,module,exports){
var makeString = require('./makeString');

module.exports = function escapeRegExp(str) {
  return makeString(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g, '\\$1');
};

},{"./makeString":26}],26:[function(require,module,exports){
/**
 * Ensure some object is a coerced to a string
 **/
module.exports = function makeString(object) {
  if (object == null) return '';
  return '' + object;
};

},{}],27:[function(require,module,exports){
module.exports = function strRepeat(str, qty){
  if (qty < 1) return '';
  var result = '';
  while (qty > 0) {
    if (qty & 1) result += str;
    qty >>= 1, str += str;
  }
  return result;
};

},{}],28:[function(require,module,exports){
var pad = require('./pad');

module.exports = function lpad(str, length, padStr) {
  return pad(str, length, padStr);
};

},{"./pad":29}],29:[function(require,module,exports){
var makeString = require('./helper/makeString');
var strRepeat = require('./helper/strRepeat');

module.exports = function pad(str, length, padStr, type) {
  str = makeString(str);
  length = ~~length;

  var padlen = 0;

  if (!padStr)
    padStr = ' ';
  else if (padStr.length > 1)
    padStr = padStr.charAt(0);

  switch (type) {
  case 'right':
    padlen = length - str.length;
    return str + strRepeat(padStr, padlen);
  case 'both':
    padlen = length - str.length;
    return strRepeat(padStr, Math.ceil(padlen / 2)) + str + strRepeat(padStr, Math.floor(padlen / 2));
  default: // 'left'
    padlen = length - str.length;
    return strRepeat(padStr, padlen) + str;
  }
};

},{"./helper/makeString":26,"./helper/strRepeat":27}],30:[function(require,module,exports){
var pad = require('./pad');

module.exports = function rpad(str, length, padStr) {
  return pad(str, length, padStr, 'right');
};

},{"./pad":29}],31:[function(require,module,exports){
var makeString = require('./helper/makeString');
var defaultToWhiteSpace = require('./helper/defaultToWhiteSpace');
var nativeTrim = String.prototype.trim;

module.exports = function trim(str, characters) {
  str = makeString(str);
  if (!characters && nativeTrim) return nativeTrim.call(str);
  characters = defaultToWhiteSpace(characters);
  return str.replace(new RegExp('^' + characters + '+|' + characters + '+$', 'g'), '');
};

},{"./helper/defaultToWhiteSpace":24,"./helper/makeString":26}],32:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/App
/*/
"use strict";

console.info("Portfolio App started");

if (!DEBUG) {
	window.addEventListener("error", function(ev) {
		console.error("Uncaught Error", ev);
	});
}

require("Modernizr");
require("es6-promise").polyfill();
require("classlist-polyfill");
require("raf-polyfill");
require("matches-polyfill");
require("fullscreen-polyfill");
require("math-sign-polyfill");
require("setimmediate");

require("backbone").$ = require("backbone.native");
require("backbone.babysitter");
require("Backbone.Mutators");
require("hammerjs");

// document.addEventListener('DOMContentLoaded', function(ev) {
// 	console.log("%s:[event %s]", ev.target, ev.type);
// });

window.addEventListener("load", function(ev) {
	console.log("%s:[event %s]", ev.target, ev.type);

	// process bootstrap data, let errors go up the stack
	try {
		require("app/model/helper/bootstrap")(window.bootstrap);
	} catch (err) {
		var el = document.selectQuery(".app");
		el.classList.remove("app-initial");
		el.classList.add("app-error");
		throw new Error("bootstrap data error (" + err.message + ")", err.fileName, err.lineNumber);
	} finally { // detele global var
		delete window.bootstrap;
	}

	require("app/view/template/_helpers");
	// require("app/view/template/_partials");
	/** @type {module:app/view/helper/createColorStyleSheet} */
	require("app/view/helper/createColorStyleSheet").call();

	/** @type {module:app/view/AppView} */
	var AppView = require("app/view/AppView");

	/** @type {module:webfontloader} */
	var WebFont = require("webfontloader");
	WebFont.load({
		async: true,
		classes: false,
		custom: {
			families: [
				// "Franklin Gothic FS:n4,n7",
				"Franklin Gothic FS:n4,i4,n7,i7",
				"FolioFigures:n4",
			],
			testStrings: {
				"FolioFigures": "hms"
			},
		},
		active: function() {
			console.info("WebFont::active");
			// AppView.getInstance();
		},
		fontactive: function(familyName, variantFvd) {
			console.info("WebFont::fontactive '%s' (%s)", familyName, variantFvd);
		},
		inactive: function() {
			console.warn("WebFont::inactive");
			// AppView.getInstance();
		},
		fontinactive: function(familyName, variantFvd) {
			console.warn("WebFont::fontinactive '%s' (%s)", familyName, variantFvd);
		},
		// loading: function() {
		// 	console.log("WebFont::loading");
		// },
		// fontloading: function(familyName, variantDesc) {
		// 	console.log("WebFont::fontloading", familyName, JSON.stringify(variantDesc, null, " "));
		// },
	});
	AppView.getInstance();
});


if (DEBUG) {
	// /** @type {module:underscore} */
	// var _ = require("underscore");

	// var isFF = /Firefox/.test(window.navigator.userAgent);
	// var isIOS = /iPad|iPhone/.test(window.navigator.userAgent);
	/*
	if (/Firefox/.test(window.navigator.userAgent)) {
		console.prefix = "# ";
		var shift = [].shift;
		var logWrapFn = function() {
			if (typeof arguments[1] == "string") arguments[1] = console.prefix + arguments[1];
			return shift.apply(arguments).apply(console, arguments);
		};
		console.group = _.wrap(console.group, logWrapFn);
		console.log = _.wrap(console.log, logWrapFn);
		console.info = _.wrap(console.info, logWrapFn);
		console.warn = _.wrap(console.warn, logWrapFn);
		console.error = _.wrap(console.error, logWrapFn);
	}
	*/
	/*
	var saveLogs = function() {
		var logWrapFn = function(name, fn, msg) {
			document.documentElement.appendChild(
				document.createComment("[" + name + "] " + msg));
		};
		console.group = _.wrap(console.group, _.partial(logWrapFn, "group"));
		console.log = _.wrap(console.log, _.partial(logWrapFn, "log"));
		console.info = _.wrap(console.info, _.partial(logWrapFn, "info"));
		console.warn = _.wrap(console.warn, _.partial(logWrapFn, "warn"));
		console.error = _.wrap(console.error, _.partial(logWrapFn, "error"));
	};
	*/

	// handle error events on some platforms and production
	/*
	if (isIOS) {
		// saveLogs();
		window.addEventListener("error", function() {
			var args = Array.prototype.slice.apply(arguments),
				el = document.createElement("div"),
				html = "";
			_.extend(el.style, {
				fontfamily: "monospace",
				display: "block",
				position: "absolute",
				zIndex: "999",
				backgroundColor: "white",
				color: "black",
				width: "calc(100% - 3em)",
				bottom: "0",
				margin: "1em 1.5em",
				padding: "1em 1.5em",
				outline: "0.5em solid red",
				outlineOffset: "0.5em",
				boxSizing: "border-box",
				overflow: "hidden",
			});
			html += "<pre><b>location:<b> " + window.location + "</pre>";
			html += "<pre><b>event:<b> " + JSON.stringify(args.shift(), null, " ") + "</pre>";
			if (args.length) html += "<pre><b>rest:<b> " + JSON.stringify(args, null, " ") + "</pre>";
			el.innerHTML = html;
			document.body.appendChild(el);
		});
	}*/
}
}).call(this,true)

},{"Backbone.Mutators":"Backbone.Mutators","Modernizr":"Modernizr","app/model/helper/bootstrap":45,"app/view/AppView":52,"app/view/helper/createColorStyleSheet":74,"app/view/template/_helpers":101,"backbone":"backbone","backbone.babysitter":"backbone.babysitter","backbone.native":"backbone.native","classlist-polyfill":"classlist-polyfill","es6-promise":"es6-promise","fullscreen-polyfill":"fullscreen-polyfill","hammerjs":"hammerjs","matches-polyfill":"matches-polyfill","math-sign-polyfill":"math-sign-polyfill","raf-polyfill":"raf-polyfill","setimmediate":22,"webfontloader":"webfontloader"}],33:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/control/Controller
/*/

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Backbone = require("backbone");

// /** @type {module:app/model/collection/TypeCollection} */
// var types = require("app/model/collection/TypeCollection");
// /** @type {module:app/model/collection/KeywordCollection} */
// var keywords = require("app/model/collection/KeywordCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");

/* --------------------------- *
/* Static private
/* --------------------------- */

/**
/* @constructor
/* @type {module:app/control/Controller}
/*/
var Controller = Backbone.Router.extend({

	// /** @override */
	// routes: {},

	/** @override */
	initialize: function(options) {

		if (DEBUG) {
			this._routeNames = [];
			this.route = function(route, name, callback) {
				this._routeNames.push(_.isString(name) ? name : '');
				return Backbone.Router.prototype.route.apply(this, arguments);
			};
			this.on("route", function(routeName, args) {
				console.log("controller:[route] %s [%s]", routeName, args.join());
			});
		}

		/*
		 * Prefixed article regexp: /^article(?:\/([^\/]+))\/?$/
		 * Single bundle regexp: /^bundles(?:\/([^\/]+)(?:\/(\d+))?)?\/?$/
		 */
		this.route(/(.*)/,
			"notfound", this.toNotFound);
		this.route(/^([a-z][a-z0-9\-]*)\/?$/,
			"article-item", this.toArticleItem);
		this.route(/^(?:bundles)?\/?$/,
			"root", this.toRoot);
		// this.route(/^bundles\/?$/,
		// 	"bundle-list", this.toBundleList);
		this.route(/^bundles\/([^\/]+)\/?$/,
			"bundle-item", this.toBundleItem);
		this.route(/^bundles\/([^\/]+)\/(\d+)\/?$/,
			"media-item", this.toMediaItem);

		if (DEBUG) {
			console.log("%s::initialize routes: %o", "controller", this._routeNames);
		}
	},



	/* ---------------------------
	/* JS to URL: public command methods
	/* --------------------------- */

	selectMedia: function(media) {
		this._goToLocation(media.get("bundle"), media);
	},

	selectBundle: function(bundle) {
		this._goToLocation(bundle);
	},

	deselectMedia: function() {
		this._goToLocation(bundles.selected);
	},

	deselectBundle: function() {
		this._goToLocation();
	},

	selectArticle: function(article) {
		this.navigate(article.get("handle"), { trigger: true });
	},

	deselectArticle: function() {
		this.navigate("", { trigger: true });
	},

	/* ---------------------------
	/* JS to URL: private helpers
	/* --------------------------- */

	/** Update location when navigation happens internally */
	/*_updateLocation: function() {
		var bundle, media;
		bundle = bundles.selected;
		if (bundle) {
			media = bundle.get("media").selected;
		}
		this.navigate(this._getLocation(bundle, media), {
			trigger: false
		});
	},*/

	_getLocation: function(bundle, media) {
		var mediaIndex, location = [];
		if (bundle) {
			location.push("bundles");
			location.push(bundle.get("handle"));
			if (media) {
				mediaIndex = bundle.get("media").indexOf(media);
				if (mediaIndex >= 0) {
					location.push(mediaIndex);
				}
			}
		}
		// location.push("");
		return location.join("/");
	},

	_goToLocation: function(bundle, media) {
		this.navigate(this._getLocation(bundle, media), {
			trigger: true
		});
	},

	/* --------------------------- *
	/* URL to JS: router handlers
	/* --------------------------- */

	toRoot: function() {
		this.trigger("change:before");
		if (bundles.selected) {
			// bundles.selected.get("media").deselect();
			bundles.deselect();
		}
		// keywords.deselect();
		articles.deselect();
		this.trigger("change:after");
	},

	toNotFound: function(slug) {
		console.info("route:[*:%s]", slug);
	},

	// toBundleList: function() {
	// 	this.navigate("", {
	// 		trigger: true,
	// 		replace: true
	// 	});
	// },

	toBundleItem: function(bundleHandle) {
		var bundle = bundles.findWhere({
			handle: bundleHandle
		});
		if (!bundle) {
			throw new Error("Cannot find bundle with handle \"" + bundleHandle + "\"");
		}
		this._changeSelection(bundle);
	},

	toMediaItem: function(bundleHandle, mediaIndex) {
		var bundle, media;
		// if (bundleHandle) {
		bundle = bundles.findWhere({ handle: bundleHandle });
		if (!bundle) {
			throw new Error("No bundle with handle \"" + bundleHandle + "\" found");
		}
		// if (mediaIndex) {
		media = bundle.get("media").at(mediaIndex);
		if (!media) {
			throw new Error("No media at index " + mediaIndex + " in bundle with handle \"" + bundleHandle + "\" found");
		}
		// }
		// }
		this._changeSelection(bundle, media);
	},

	toArticleItem: function(articleHandle) {
		var article = articles.findWhere({ handle: articleHandle });
		if (!article) {
			throw new Error("Cannot find article with handle \"" + articleHandle + "\"");
		}
		this.trigger("change:before", article);
		bundles.deselect();
		articles.select(article);
		this.trigger("change:after", article);
	},

	/* -------------------------------
	/* URL to JS: private helpers
	/* ------------------------------- */

	/*
	/* NOTE: Selection order
	/* - Apply media selection to *incoming bundle*, as not to trigger
	/*	unneccesary events on an outgoing bundle. Outgoing bundle media selection
	/*	remains untouched.
	/* - Apply media selection *before* selecting the incoming bundle. Views
	/*	normally listen to the selected bundle only, so if the bundle is changing,
	/*	they will not be listening to media selection changes yet.
	/*/
	_changeSelection: function(bundle, media) {
		var lastBundle, lastMedia;
		if (bundle === void 0) bundle = null;
		if (media === void 0) media = null;

		lastBundle = bundles.selected;
		lastMedia = lastBundle ? lastBundle.get("media").selected : null;
		console.log("controller::_changeSelection bundle:[%s -> %s] media:[%s -> %s]",
			(lastBundle ? lastBundle.cid : lastBundle), (bundle ? bundle.cid : bundle),
			(lastMedia ? lastMedia.cid : lastMedia), (media ? media.cid : media)
		);

		if (!articles.selected && (lastBundle === bundle) && (lastMedia === media)) {
			return;
		}

		this.trigger("change:before", bundle, media);
		bundle && bundle.get("media").select(media);
		bundles.select(bundle);
		articles.deselect();
		this.trigger("change:after", bundle, media);
	},
});


module.exports = new Controller();
}).call(this,true)

},{"app/model/collection/ArticleCollection":41,"app/model/collection/BundleCollection":42,"backbone":"backbone","underscore":"underscore"}],34:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/control/Globals
/*/
/** @type {module:underscore} */
var _ = require("underscore");

module.exports = (function() {
	// reusable vars
	var o, s, so;
	// global hash
	var g = {};
	// SASS <--> JS shared hash
	var sass = require("../../../sass/variables.json");

	// JUNK FIRST: Some app-wide defaults
	// - - - - - - - - - - - - - - - - -
	g.VPAN_DRAG = 0.95; // as factor of pointer delta
	g.HPAN_OUT_DRAG = 0.4; // factor
	g.VPAN_OUT_DRAG = 0.1; // factor
	g.PAN_THRESHOLD = 15; // px
	g.COLLAPSE_THRESHOLD = 75; // px
	g.COLLAPSE_OFFSET = parseInt(sass.temp["collapse_offset"]);
	g.CLICK_EVENT = window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup";

	// breakpoints
	// - - - - - - - - - - - - - - - - -
	g.BREAKPOINTS = {};
	for (s in sass.breakpoints) {
		o = sass.breakpoints[s];
		/*if (Array.isArray(o)) {
			g.BREAKPOINTS[s] = Object.defineProperties({}, {
				"matches": {
					get: _.partial(_.some, o.map(window.matchMedia), _.property("matches"))
				},
				"media": {
					value: o.join(", ")
				},
				"queries": {
					value: o.map(window.matchMedia)
				},
			});
		} else {
			g.BREAKPOINTS[s] = window.matchMedia(o);
		}*/
		o = Array.isArray(o) ? o.join(", ") : o;
		o = o.replace(/[\'\"]/g, "");
		o = window.matchMedia(o);
		o.className = s;
		g.BREAKPOINTS[s] = o;
	}
	if (DEBUG) {
		console.groupCollapsed("Breakpoints");
		for (s in g.BREAKPOINTS) {
			console.log("%s: %o", s, g.BREAKPOINTS[s].media);
		}
		console.groupEnd();
	}

	// base colors, dimensions
	// - - - - - - - - - - - - - - - - -
	g.DEFAULT_COLORS = _.clone(sass.default_colors);
	// g.HORIZONTAL_STEP = parseFloat(sass.units["hu_px"]);
	// g.VERTICAL_STEP = parseFloat(sass.units["vu_px"]);


	// paths, networking
	// - - - - - - - - - - - - - - - - -
	// var toAbsoluteURL = (function() {
	// 	var a = null;
	// 	return function(url) {
	// 		a = a || document.createElement('a');
	// 		a.href = url;
	// 		return a.href;
	// 	};
	// })();
	// g.APP_ROOT = toAbsoluteURL(window.approot);
	// g.MEDIA_DIR = toAbsoluteURL(window.mediadir);

	g.APP_ROOT = window.approot;
	g.MEDIA_DIR = window.mediadir;

	delete window.approot;
	delete window.mediadir;

	// hardcoded font data
	// - - - - - - - - - - - - - - - - -
	g.FONT_METRICS = {
		"Franklin Gothic FS": {
			"unitsPerEm": 1000,
			"ascent": 827,
			"descent": -173
		},
		"ITCFranklinGothicStd": {
			"unitsPerEm": 1000,
			"ascent": 686,
			"descent": -314
		},
		"FolioFigures": {
			"unitsPerEm": 1024,
			"ascent": 939,
			"descent": -256
		},
	};

	g.PAUSE_CHAR = String.fromCharCode(0x23F8);
	g.PLAY_CHAR = String.fromCharCode(0x23F5);
	g.STOP_CHAR = String.fromCharCode(0x23F9);

	// translate common template

	g.TRANSLATE_TEMPLATE = function(x, y) {
		return "translate(" + x + "px, " + y + "px)";
		// return "translate3d(" + x + "px, " + y + "px ,0px)";
	};
	// timing, easing
	// - - - - - - - - - - - - - - - - -
	var ease = g.TRANSITION_EASE = sass.transitions["ease"];
	var duration = g.TRANSITION_DURATION = parseFloat(sass.transitions["duration_ms"]);
	var delayInterval = g.TRANSITION_DELAY_INTERVAL = parseFloat(sass.transitions["delay_interval_ms"]);
	var minDelay = g.TRANSITION_MIN_DELAY = parseFloat(sass.transitions["min_delay_ms"]);
	var delay = g.TRANSITION_DELAY = g.TRANSITION_DURATION + g.TRANSITION_DELAY_INTERVAL;

	// css transitions
	// - - - - - - - - - - - - - - - - -
	o = {};

	// match tx() in _transitions.scss
	// - - - - - - - - - - - - - - - - -
	o.tx = function tx(durationCount, delayCount, easeVal) {
		_.isNumber(durationCount) || (durationCount = 1);
		_.isNumber(delayCount) || (delayCount = -1);
		_.isString(easeVal) || (easeVal = ease);

		var o = {};
		if (delayCount < 0) {
			o.duration = (duration * durationCount) +
				(delayInterval * (durationCount - 1));
			o.delay = 0;
		} else {
			o.duration = (duration * durationCount) +
				(delayInterval * (durationCount - 1)) - minDelay;
			o.delay = (delay * delayCount) - minDelay;
		}
		o.easeing = easeVal;
		return 0;
	}

	// transition presets
	// TODO: get rid of this
	// - - - - - - - - - - - - - - - - -

	o.NONE = {
		delay: 0,
		duration: 0,
		easing: "step-start"
	};
	o.NOW = {
		delay: 0,
		duration: duration,
		easing: ease
	};
	o.UNSET = _.defaults({
		cssText: ""
	}, o.NONE);

	var txAligned = _.defaults({
		duration: duration - minDelay
	}, o.NOW);
	o.FIRST = _.defaults({
		delay: delay * 0.0 + minDelay
	}, txAligned);
	o.BETWEEN = _.defaults({
		delay: delay * 1.0 + minDelay
	}, txAligned);
	o.LAST = _.defaults({
		delay: delay * 2.0 + minDelay
	}, txAligned);
	o.AFTER = _.defaults({
		delay: delay * 2.0 + minDelay
	}, txAligned);

	o.BETWEEN_EARLY = _.defaults({
		delay: delay * 1.0 + minDelay - 60
	}, txAligned);
	o.BETWEEN_LATE = _.defaults({
		delay: delay * 1.0 + minDelay + 60
	}, txAligned);

	o.FIRST_LATE = _.defaults({
		delay: delay * 0.5 + minDelay
	}, txAligned);
	o.LAST_EARLY = _.defaults({
		delay: delay * 1.5 + minDelay
	}, txAligned);
	// o.FIRST_LATE = 		_.defaults({delay: txDelay*0.0 + txMinDelay*2}, txAligned);
	// o.LAST_EARLY = 		_.defaults({delay: txDelay*2.0 + txMinDelay*0}, txAligned);
	// o.AFTER = 			_.defaults({delay: txDelay*2.0 + txMinDelay}, txAligned);

	console.groupCollapsed("Transitions");
	for (s in o) {
		if (!_.isFunction(o[s])) {
			so = o[s];
			so.name = s;
			so.className = "tx-" + s.replace("_", "-").toLowerCase();
			if (!so.hasOwnProperty("cssText")) {
				so.cssText = so.duration / 1000 + "s " + so.easing + " " + so.delay / 1000 + "s";
			}
			console.log("%s: %s", so.name, so.cssText);
		}
	}
	console.groupEnd();
	g.transitions = o;

	return g;
}());
}).call(this,true)

},{"../../../sass/variables.json":121,"underscore":"underscore"}],35:[function(require,module,exports){
/**
 * @module app/view/DebugToolbar
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:cookies-js} */
var Cookies = require("cookies-js");
// /** @type {module:modernizr} */
// var Modernizr = require("Modernizr");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
// /** @type {module:app/control/Controller} */
// var controller = require("app/control/Controller");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");

/** @type {Function} */
var viewTemplate = require("./template/DebugToolbar.hbs");

/** @type {Function} */
var gridTemplate = require("./template/DebugToolbar.SVGGrid.hbs");

/** @type {Function} */
var sizeTemplate = _.template("<%= w %> \u00D7 <%= h %>");

// var appStateSymbols = { withBundle: "b", withMedia: "m", collapsed: "c"};
// var appStateKeys = Object.keys(appStateSymbols);

module.exports = View.extend({

	/** @override */
	cidPrefix: "debugToolbar",
	/** @override */
	tagName: "div",
	/** @override */
	className: "toolbar",
	/** @override */
	template: viewTemplate,

	/** @override */
	properties: {
		grid: {
			get: function() {
				return this._grid || (this._grid = this.createGridElement());
			}
		}
	},

	initialize: function(options) {
		Cookies.defaults = {
			expires: new Date(0x7fffffff * 1e3),
			domain: String(window.location)
				.match(/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i)[1]
		};

		this.el.innerHTML = this.template({
			tests: Modernizr,
			navigator: window.navigator
		});

		/* toggle's target: container
		/* - - - - - - - - - - - - - - - - */
		var container = document.getElementById("container"); //.querySelector("#container");

		/* create/attach svg grid element
		/* - - - - - - - - - - - - - - - - */
		container.insertBefore(this.createGridElement(), container.firstElementChild);

		/* info elements
		/* - - - - - - - - - - - - - - - - */
		this.backendEl = this.el.querySelector("#edit-backend a");
		this.mediaInfoEl = this.el.querySelector("#media-info span");
		this.appStateEl = this.el.querySelector("#app-state");

		/* toggle visibility
		/* - - - - - - - - - - - - - - - - */
		this.initializeClassToggle("show-links", this.el.querySelector(".debug-links #links-toggle"), this.el,
			function(key, value) {
				this.el.classList.toggle("not-" + key, !value);
				// console.log("%s:initializeClassToggle:[callback] %o", this.cid, arguments);
			}
		);
		this.initializeClassToggle("show-tests", this.el.querySelector("#toggle-tests a"), this.el);
		this.initializeClassToggle("hide-passed", this.el.querySelector("#toggle-passed"), this.el);

		/* toggle container classes
		/* - - - - - - - - - - - - - - - - */
		this.initializeClassToggle("debug-grid-bg", this.el.querySelector("#toggle-grid-bg a"), document.body);
		this.initializeClassToggle("debug-blocks", this.el.querySelector("#toggle-blocks a"), container);
		this.initializeClassToggle("debug-graph", this.el.querySelector("#toggle-graph a"), container);
		this.initializeClassToggle("debug-mdown", this.el.querySelector("#toggle-mdown a"), container);
		this.initializeClassToggle("debug-logs", this.el.querySelector("#toggle-logs a"), container);
		this.initializeClassToggle("debug-tx", this.el.querySelector("#toggle-tx a"), container,
			function(key, value) {
				this.el.classList.toggle("show-tx", value);
				this.el.classList.toggle("not-show-tx", !value);
			}
		);

		this.initializeViewportInfo();

		// this.initializeLayoutSelect();

		this.listenTo(this.model, "change", this._onModelChange);
		this._onModelChange();
	},

	initializeViewportInfo: function() {
		var viewportInfoEl = this.el.querySelector("#viewport-info span");
		var callback = function() {
			viewportInfoEl.textContent = sizeTemplate({ w: window.innerWidth, h: window.innerHeight });
		};
		callback.call();
		window.addEventListener("resize", _.debounce(callback, 100, false, false));
	},

	initializeToggle: function(key, toggleEl, callback) {
		var ctx = this;
		var toggleValue = Cookies.get(key) === "true";
		callback.call(ctx, key, toggleValue);

		toggleEl.addEventListener("click", function(ev) {
			if (ev.defaultPrevented) return;
			else ev.preventDefault();
			toggleValue = !toggleValue;
			Cookies.set(key, toggleValue ? "true" : "");
			callback.call(ctx, key, toggleValue);
		}, false);
	},

	initializeClassToggle: function(key, toggleEl, targetEl, callback) {
		var hasCallback = _.isFunction(callback);

		this.initializeToggle(key, toggleEl, function(key, toggleValue) {
			targetEl.classList.toggle(key, toggleValue);
			toggleEl.classList.toggle("toggle-enabled", toggleValue);
			toggleEl.classList.toggle("color-reverse", toggleValue);
			hasCallback && callback.apply(this, arguments);
		});
	},

	_onModelChange: function() {
		// console.log("%s::_onModelChange changedAttributes: %o", this.cid, this.model.changedAttributes());
		var i, ii, prop, el, els = this.appStateEl.children;
		for (i = 0, ii = els.length; i < ii; i++) {
			el = els[i];
			prop = el.getAttribute("data-prop");
			el.classList.toggle("has-value", this.model.get(prop));
			el.classList.toggle("has-changed", this.model.hasChanged(prop));
			el.classList.toggle("color-reverse", this.model.hasChanged(prop));
		}

		// NOTE: Always but rewrite CMS href.
		// Only collapsed may have changed, but not worth all the logic
		var attrVal = Globals.APP_ROOT + "symphony/";
		switch (this.model.get("routeName")) {
			case "article-item":
				attrVal += "publish/articles/edit/" + this.model.get("article").id;
				break;
			case "bundle-item":
				attrVal += "publish/bundles/edit/" + this.model.get("bundle").id;
				break;
			case "media-item":
				attrVal += "publish/media/edit/" + this.model.get("media").id;
				break;
			case "root":
				attrVal += "publish/bundles";
				break;
		}
		this.backendEl.setAttribute("href", attrVal);

		if (this.model.hasChanged("media")) {
			if (this.model.has("media")) {
				this.mediaInfoEl.textContent = sizeTemplate(this.model.get("media").get("source").toJSON());
				this.mediaInfoEl.style.display = "";
			} else {
				this.mediaInfoEl.textContent = "";
				this.mediaInfoEl.style.display = "none";
			}
		}
	},

	createGridElement: function() {
		var el = document.createElement("div");
		el.id = "grid-wrapper";
		el.innerHTML = gridTemplate();
		return el;
	},
});

module.exports.prototype._logFlags = "";
},{"./template/DebugToolbar.SVGGrid.hbs":36,"./template/DebugToolbar.hbs":37,"app/control/Globals":34,"app/view/base/View":60,"cookies-js":"cookies-js","underscore":"underscore"}],36:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    return "<svg id=\"debug-grid\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" preserveAspectRatio=\"xMaxYMid slice\" viewport-fill=\"hsl(0,0%,100%)\" viewport-fill-opacity=\"1\" style=\"fill:none;stroke:none;stroke-width:1px;fill:none;fill-rule:evenodd;\">\n<defs>\n	<pattern id=\"pat-baseline-12px\" class=\"baseline base12\" x=\"0\" y=\"0\" width=\"20\" height=\"12\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.0\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"3\" y2=\"3\" stroke-opacity=\"0.125\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"6\" y2=\"6\" stroke-opacity=\"0.375\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"9\" y2=\"9\" stroke-opacity=\"0.125\"/>\n	</pattern>\n\n	<pattern id=\"pat-baseline-24px\" class=\"baseline base12\" x=\"0\" y=\"0\" width=\"20\" height=\"24\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.0\"/>\n	</pattern>\n\n	<pattern id=\"pat-baseline-10px\" class=\"baseline base10\" x=\"0\" y=\"0\" width=\"20\" height=\"10\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.00\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"5\" y2=\"5\" stroke-opacity=\"0.75\"/>\n	</pattern>\n	<pattern id=\"pat-baseline-20px\" class=\"baseline base10\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.0\"/>\n	</pattern>\n	<pattern id=\"pat-cols-220px\" x=\"0\" y=\"0\" width=\"220\" height=\"36\" patternUnits=\"userSpaceOnUse\">\n		<rect transform=\"translate(0,0)\" x=\"0\" y=\"0\" width=\"20\" height=\"100%\" fill=\"hsl(336,50%,40%)\" fill-opacity=\"0.1\"/>\n		<rect transform=\"translate(200,0)\" x=\"0\" y=\"0\" width=\"20\" height=\"100%\" fill=\"hsl(336,50%,40%)\" fill-opacity=\"0.1\"/>\n		<line transform=\"translate(20 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,60%)\" stroke-opacity=\"0.2\"/>\n		<line transform=\"translate(200 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,40%)\" stroke-opacity=\"0.2\"/>\n\n		<line transform=\"translate(140 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,40%)\" stroke-opacity=\"0.3\"/>\n		<line transform=\"translate(80 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,40%)\" stroke-opacity=\"0.3\"/>\n\n		<line transform=\"translate(0 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(236,50%,40%)\" stroke-opacity=\"0.4\" stroke-width=\"1\"/>\n		<line transform=\"translate(220 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(236,50%,40%)\" stroke-opacity=\"0.4\" stroke-width=\"1\"/>\n	</pattern>\n</defs>\n<g id=\"debug-grid-body\" transform=\"translate(0 0.5)\">\n	<rect id=\"baseline\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\"/>\n	<g id=\"debug-grid-container\">\n		<g id=\"debug-grid-content\">\n			<rect id=\"baseline-content\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\"/>\n			<line id=\"gct0\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n			<line id=\"gct1\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n		</g>\n		<line id=\"gnv0\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n		<line id=\"gnv1\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n	</g>\n\n	<g id=\"abs-cols\">\n		<rect id=\"columns\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\"/>\n	</g>\n\n	<g id=\"rel-cols\">\n		<line id=\"le\" class=\"vguide edge\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n		<line id=\"re\" class=\"vguide edge\" x1=\"100%\" x2=\"100%\" y1=\"0\" y2=\"100%\"/>\n\n		<line id=\"gl0\" class=\"vguide margin\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n		<line id=\"gl1\" class=\"vguide gutter\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n\n		<line id=\"gr0\" class=\"vguide margin\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n		<line id=\"gr1\" class=\"vguide gutter\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n\n		<line id=\"gm\" class=\"vguide\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n	</g>\n</g>\n</svg>\n";
},"useData":true});

},{"hbsfy/runtime":20}],37:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"1":function(container,depth0,helpers,partials,data) {
    var stack1;

  return "	<dd id=\"select-layout\">\n		<select size=1>\n"
    + ((stack1 = helpers.each.call(depth0 != null ? depth0 : {},(depth0 != null ? depth0.layouts : depth0),{"name":"each","hash":{},"fn":container.program(2, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "		</select>\n	</dd>\n";
},"2":function(container,depth0,helpers,partials,data) {
    var alias1=container.lambda, alias2=container.escapeExpression;

  return "			<option value=\""
    + alias2(alias1(depth0, depth0))
    + "\">"
    + alias2(alias1(depth0, depth0))
    + "</option>\n";
},"4":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {};

  return "		<li class=\""
    + ((stack1 = helpers["if"].call(alias1,depth0,{"name":"if","hash":{},"fn":container.program(5, data, 0),"inverse":container.program(7, data, 0),"data":data})) != null ? stack1 : "")
    + "\">"
    + container.escapeExpression(((helper = (helper = helpers.key || (data && data.key)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(alias1,{"name":"key","hash":{},"data":data}) : helper)))
    + "</li>\n";
},"5":function(container,depth0,helpers,partials,data) {
    return "passed";
},"7":function(container,depth0,helpers,partials,data) {
    return "failed";
},"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, alias1=depth0 != null ? depth0 : {}, alias2=container.escapeExpression;

  return "<dl class=\"debug-links color-bg\">\n	<dt id=\"links-toggle\">\n		<svg class=\"icon\" viewBox=\"-100 -100 200 200\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" preserveAspectRatio=\"xMidYMid meet\">\n			<path id=\"cog\" d=\"M11.754,-99.307c-7.809,-0.924 -15.699,-0.924 -23.508,0l-3.73,20.82c-6.254,1.234 -12.338,3.21 -18.123,5.888l-15.255,-14.651c-6.861,3.842 -13.244,8.48 -19.018,13.818l9.22,19.036c-4.335,4.674 -8.095,9.849 -11.201,15.416l-20.953,-2.886c-3.292,7.141 -5.731,14.645 -7.265,22.357l18.648,9.981c-0.759,6.329 -0.759,12.727 0,19.056l-18.648,9.981c1.534,7.712 3.973,15.216 7.265,22.357l20.953,-2.886c3.106,5.567 6.866,10.742 11.201,15.416l-9.22,19.036c5.774,5.338 12.157,9.976 19.018,13.818l15.255,-14.651c5.785,2.678 11.869,4.654 18.123,5.888l3.73,20.82c7.809,0.924 15.699,0.924 23.508,0l3.73,-20.82c6.254,-1.234 12.338,-3.21 18.123,-5.888l15.255,14.651c6.861,-3.842 13.244,-8.48 19.018,-13.818l-9.22,-19.036c4.335,-4.674 8.095,-9.849 11.201,-15.416l20.953,2.886c3.292,-7.141 5.731,-14.645 7.265,-22.357l-18.648,-9.981c0.759,-6.329 0.759,-12.727 0,-19.056l18.648,-9.981c-1.534,-7.712 -3.973,-15.216 -7.265,-22.357l-20.953,2.886c-3.106,-5.567 -6.866,-10.742 -11.201,-15.416l9.22,-19.036c-5.774,-5.338 -12.157,-9.976 -19.018,-13.818l-15.255,14.651c-5.785,-2.678 -11.869,-4.654 -18.123,-5.888l-3.73,-20.82ZM0,-33c18.213,0 33,14.787 33,33c0,18.213 -14.787,33 -33,33c-18.213,0 -33,-14.787 -33,-33c0,-18.213 14.787,-33 33,-33Z\" style=\"fill:currentColor;fill-rule:evenodd;\"/>\n		</svg>\n	</dt>\n	<dt id=\"app-state\">\n		<span class=\"color-fg color-bg\" data-prop=\"collapsed\">c</span><span class=\"color-fg color-bg\" data-prop=\"withBundle\">b</span><span class=\"color-fg color-bg\" data-prop=\"withMedia\">m</span><span class=\"color-fg color-bg\" data-prop=\"withArticle\">a</span>\n	</dt>\n"
    + ((stack1 = helpers["if"].call(alias1,(depth0 != null ? depth0.layouts : depth0),{"name":"if","hash":{},"fn":container.program(1, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "	<dd id=\"edit-backend\">\n		<a href=\""
    + alias2((helpers.global || (depth0 && depth0.global) || helpers.helperMissing).call(alias1,"APP_ROOT",{"name":"global","hash":{},"data":data}))
    + "symphony/\" class=\"color-fg color-bg\" target=\"_blank\">CMS</a>\n	</dd>\n	<dd id=\"toggle-tests\">\n		<a href=\"#toggle-tests\" class=\"color-fg color-bg\">Tests</a>\n	</dd>\n	<dd id=\"toggle-blocks\">\n		<a href=\"#toggle-blocks\" class=\"color-fg color-bg\">Blocks</a>\n	</dd>\n	<dd id=\"toggle-tx\">\n		<a href=\"#toggle-blocks\" class=\"color-fg color-bg\">TX/FX</a>\n	</dd>\n	<dd id=\"toggle-grid-bg\">\n		<a href=\"#toggle-grid-bg\" class=\"color-fg color-bg\">Grid</a>\n	</dd>\n	<dd id=\"toggle-graph\">\n		<a href=\"#toggle-graph\" class=\"color-fg color-bg\">Graph</a>\n	</dd>\n	<dd id=\"toggle-mdown\">\n		<a href=\"#toggle-mdown\" class=\"color-fg color-bg\">Markdown</a>\n	</dd>\n	<dd id=\"toggle-logs\">\n		<a href=\"#toggle-logs\" class=\"color-fg color-bg\">Logs</a>\n	</dd>\n	<dd id=\"media-info\">\n		<span></span>\n	</dd>\n	<dd id=\"viewport-info\">\n		<span></span>\n	</dd>\n</dl>\n<div id=\"test-results\">\n	<h6>Tests <a id=\"toggle-passed\" href=\"#toggle-passed\">Passed</a></h6>\n	<p>"
    + alias2(container.lambda(((stack1 = (depth0 != null ? depth0.navigator : depth0)) != null ? stack1.userAgent : stack1), depth0))
    + "</p>\n	<ul>\n"
    + ((stack1 = helpers.each.call(alias1,(depth0 != null ? depth0.tests : depth0),{"name":"each","hash":{},"fn":container.program(4, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "	</ul>\n</div>\n";
},"useData":true});

},{"hbsfy/runtime":20}],38:[function(require,module,exports){
/**
 * @module app/model/BaseItem
 * @requires module:backbone
 */

/** @type {module:backbone} */
var Backbone = require("backbone");

module.exports = Backbone.Model.extend({

	defaults: {
		routeName: "initial",
		collapsed: false,
		article: null,
		withArticle: false,
		bundle: null,
		withBundle: false,
		media: null,
		withMedia: false,
	},

	initialize: function() {
		Object.keys(this.defaults).forEach(function(getterName) {
			Object.defineProperty(this, getterName, {
				enumerable: true,
				get: function() {
					return this.get(getterName);
				}
			});
		});
	}
});
},{"backbone":"backbone"}],39:[function(require,module,exports){
/**
 * @module app/model/BaseItem
 * @requires module:backbone
 */

/** @type {module:backbone} */
var Model = require("backbone").Model;
/** @type {module:underscore} */
var _ = require("underscore");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
// /** @type {module:app/utils/strings/stripTags} */
// var stripTags = require("utils/strings/stripTags");
// /** @type {module:app/model/parseSymAttrs} */
//var parseSymAttrs = require("app/model/parseSymAttrs");

var parseSymAttrs = function(s) {
	return s.replace(/(\,|\;)/g, function(m) {
		return (m == ",") ? ";" : ",";
	});
};
var toAttrsHash = function(obj, attr) {
	if (_.isString(attr)) {
		var idx = attr.indexOf(":");
		if (idx > 0) {
			obj[attr.substring(0, idx)] = parseSymAttrs(attr.substring(idx + 1));
		} else {
			obj[attr] = attr; // to match HTML5<>XHTML valueless attributes
		}
	} // else ignore non-string values
	return obj;
};

var BaseItemProto = {

	_domPrefix: "_",

	/** @type {Object} */
	defaults: {
		// attrs: function() { return {}; },
		get attrs() {
			return {};
		},
	},

	getters: ["domid"],

	mutators: {
		domid: function() {
			if (!this.hasOwnProperty("_domId"))
				this._domId = this._domPrefix + this.id;
			return this._domId;
		},
		attrs: {
			set: function(key, value, options, set) {
				if (Array.isArray(value)) {
					value = value.reduce(toAttrsHash, {});
				}
				if (!_.isObject(value)) {
					console.error("%s::attrs value not an object or string array", this.cid, value);
					value = {};
				}
				set(key, value, options);
			}
		},
	},

	attr: function(attr) {
		return this.attrs()[attr];
	},

	attrs: function() {
		return this.get("attrs");
	},

	toString: function() {
		return this.get("domid");
	}
};

var BaseItem = {
	extend: function(proto, obj) {
		var constr, propName; //, propDef;
		for (propName in proto) {
			if (proto.hasOwnProperty(propName) && _.isObject(proto[propName])) { //(Object.getPrototypeOf(proto[propName]) === Object.prototype)) {
				_.defaults(proto[propName], BaseItemProto[propName]);
				// console.log("BaseItem::extend '%s:%s' is Object\n%s", proto._domPrefix, p, JSON.stringify(proto[p]));
			}
		}
		// if (proto.properties && this.prototype.properties) {
		// 	_.defaults(proto.properties, this.prototype.properties);
		// }
		constr = Model.extend.apply(this, arguments);

		if (Array.isArray(constr.prototype.getters)) {
			constr.prototype.getters.forEach(function(getterName) {
				Object.defineProperty(constr.prototype, getterName, {
					enumerable: true,
					get: function() {
						return this.get(getterName);
					}
				});
			});
		}
		// if (_.isObject(proto.properties)) {
		// 	for (propName in proto.properties) {
		// 		if (proto.properties.hasOwnProperty(propName)) {
		// 			propDef = proto.properties[propName];
		// 			if (_.isFunction(propDef)) {
		// 				proto.properties[propName] = {
		// 					enumerable: true, get: propDef
		// 				};
		// 			} else if (_.isObject(propDef)){
		// 				propDef.enumerable = true;
		// 			} else {
		// 				delete proto.properties[propName];
		// 			}
		// 		}
		// 	}
		// 	Object.defineProperties(proto, proto.properties);
		// 	delete proto.properties;
		// }
		return constr;
	}
};

/**
 * @constructor
 * @type {module:app/model/BaseItem}
 */
module.exports = BaseItem.extend.call(Model, BaseItemProto, BaseItem);
// module.exports = Model.extend(BaseItemProto, BaseItem);

},{"backbone":"backbone","underscore":"underscore"}],40:[function(require,module,exports){
/**
 * @module app/model/SelectableCollection
 */

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Backbone = require("backbone");

/**
 * @constructor
 * @type {module:app/model/SelectableCollection}
 */
var SelectableCollection = Backbone.Collection.extend({

	initialize: function(models, options) {
		options = _.defaults({}, options, {
			initialSelection: "none",
			silentInitial: true
		});
		this.initialSelection = options.initialSelection;
		this.initialOptions = {
			silent: options.silentInitial
		};
	},

	reset: function(models, options) {
		this.deselect(this.initialOptions);
		Backbone.Collection.prototype.reset.apply(this, arguments);
		if (this.initialSelection === "first" && this.length) {
			this.select(this.at(0), this.initialOptions);
		}
	},

	select: function(newModel, options) {
		if (newModel === void 0) {
			newModel = null;
		}
		if (this.selected === newModel) {
			return;
		}
		var triggerEvents = !(options && options.silent);
		var oldModel = this.selected;

		this.lastSelected = this.selected;
		this.lastSelectedIndex = this.selectedIndex;
		this.selected = newModel;
		this.selectedIndex = this.indexOf(newModel);

		if (oldModel) {
			if (_.isFunction(oldModel.deselect)) {
				oldModel.deselect(options);
			} else if (triggerEvents) {
				oldModel.selected = void 0;
				oldModel.trigger("deselected", newModel, oldModel);
			}
			if (triggerEvents) this.trigger("deselect:one", oldModel);
		} else {
			if (triggerEvents) this.trigger("deselect:none", null);
		}

		if (newModel) {
			if (_.isFunction(newModel.select)) {
				newModel.select(options);
			} else if (triggerEvents) {
				newModel.selected = true;
				newModel.trigger("selected", newModel, oldModel);
			}
			if (triggerEvents) this.trigger("select:one", newModel);
		} else {
			if (triggerEvents) this.trigger("select:none", null);
		}
	},

	deselect: function(options) {
		this.select(null, options);
	},

	selectAt: function(index, options) {
		if (0 > index || index >= this.length) {
			new RangeError("index is out of bounds");
		}
		this.select(this.at(index), options);
	},

	distance: function(a, b) {
		var aIdx, bIdx;

		if (!a) return NaN;
		aIdx = this.indexOf(a);
		if (aIdx == -1) return NaN;

		if (arguments.length == 1) {
			bIdx = this.selectedIndex;
		} else {
			if (!b) return NaN;
			bIdx = this.indexOf(b);
			if (bIdx == -1) return NaN;
		}
		return Math.abs(bIdx - aIdx);
	},

	/* TODO: MOVE INTO MIXIN */

	/** @return boolean	/*/
	hasFollowing: function(model) {
		model || (model = this.selected);
		return this.indexOf(model) < (this.length - 1);
	},

	/** @return next model	*/
	following: function(model) {
		model || (model = this.selected);
		return this.hasFollowing(model) ? this.at(this.indexOf(model) + 1) : null;
	},

	/** @return next model or the beginning if at the end */
	followingOrFirst: function(model) {
		model || (model = this.selected);
		return this.at((this.indexOf(model) + 1) % this.length);
	},

	/** @return boolean	/*/
	hasPreceding: function(model) {
		model || (model = this.selected);
		return this.indexOf(model) > 0;
	},

	/** @return the previous model */
	preceding: function(model) {
		model || (model = this.selected);
		return this.hasPreceding(model) ? this.at(this.indexOf(model) - 1) : null;
	},

	/** @return the previous model or the end if at the beginning */
	precedingOrLast: function(model) {
		model || (model = this.selected);
		var index = this.indexOf(model) - 1;
		return this.at(index > -1 ? index : this.length - 1);
	},

});

module.exports = SelectableCollection;

},{"backbone":"backbone","underscore":"underscore"}],41:[function(require,module,exports){
/**
 * @module app/model/collection/ArticleCollection
 */

/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/model/item/ArticleItem} */
var ArticleItem = require("app/model/item/ArticleItem");

/**
 * @constructor
 * @type {module:app/model/collection/ArticleCollection}
 */
var ArticleCollection = SelectableCollection.extend({

	/** @type {Backbone.Model} */
	model: ArticleItem

});

module.exports = new ArticleCollection();
},{"app/model/SelectableCollection":40,"app/model/item/ArticleItem":46}],42:[function(require,module,exports){
/**
 * @module app/model/collection/BundleCollection
 */

/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/model/item/BundleItem} */
var BundleItem = require("app/model/item/BundleItem");

/**
 * @constructor
 * @type {module:app/model/collection/BundleCollection}
 */
var BundleCollection = SelectableCollection.extend({

	/** @type {Backbone.Model} */
	model: BundleItem,

	/** @type {Function} */
	comparator: function(oa, ob) {
		var a = oa.get("completed");
		var b = ob.get("completed");
		if (a > b) {
			return -1;
		} else if (a < b) {
			return 1;
		} else {
			return 0;
		}
	},

	/** @type {String} */
	url: "/json/bundles/",

});

module.exports = new BundleCollection();

},{"app/model/SelectableCollection":40,"app/model/item/BundleItem":47}],43:[function(require,module,exports){
/**
 * @module app/model/collection/KeywordCollection
 * @requires module:backbone
 */

/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/model/item/KeywordItem} */
var KeywordItem = require("app/model/item/KeywordItem");

/**
 * @constructor
 * @type {module:app/model/collection/KeywordCollection}
 */
var KeywordCollection = SelectableCollection.extend({

	/** @type {Backbone.Model} */
	model: KeywordItem

});

module.exports = new KeywordCollection();

},{"app/model/SelectableCollection":40,"app/model/item/KeywordItem":48}],44:[function(require,module,exports){
/**
 * @module app/model/collection/TypeCollection
 * @requires module:backbone
 */

/** @type {module:backbone} */
var Backbone = require("backbone");

/** @type {module:app/model/item/TypeItem} */
var TypeItem = require("app/model/item/TypeItem");

/**
 * @constructor
 * @type {module:app/model/collection/TypeCollection}
 */
var TypeCollection = Backbone.Collection.extend({

	/** @type {Backbone.Model} */
	model: TypeItem

});

module.exports = new TypeCollection();

},{"app/model/item/TypeItem":51,"backbone":"backbone"}],45:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");

module.exports = function(bootstrap) {

	/** @type {module:app/control/Globals} */
	var Globals = require("app/control/Globals");

	// Globals.GA_TAGS = bootstrap["ga-tags"];
	// Globals.PARAMS = bootstrap["params"];
	// Globals.APP_ROOT = bootstrap["params"]["root"];
	// Globals.MEDIA_DIR = bootstrap["params"]["uploads"];
	Globals.APP_NAME = bootstrap["params"]["website-name"];

	/** @type {module:app/model/collection/TypeCollection} */
	var typeList = require("app/model/collection/TypeCollection");
	/** @type {module:app/model/collection/KeywordCollection} */
	var keywordList = require("app/model/collection/KeywordCollection");
	/** @type {module:app/model/collection/BundleCollection} */
	var bundleList = require("app/model/collection/BundleCollection");
	/** @type {module:app/model/collection/ArticleCollection} */
	var articleList = require("app/model/collection/ArticleCollection");

	// Fix-ups to bootstrap data.
	var articles = bootstrap["articles-all"];
	var types = bootstrap["types-all"];
	var keywords = bootstrap["keywords-all"];
	var bundles = bootstrap["bundles-all"];
	var media = bootstrap["media-all"];

	// Attach media to their bundles
	var mediaByBundle = _.groupBy(media, "bId");

	// Fill-in back-references:
	// Create Keyword.bundleIds from existing Bundle.keywordIds,
	// then Bundle.typeIds from unique Keyword.typeId

	// _.each(bundles, function (bo, bi, ba) {
	bundles.forEach(function(bo, bi, ba) {
		bo.tIds = [];
		bo.media = mediaByBundle[bo.id];
		// _.each(keywords, function (ko, ki, ka) {
		keywords.forEach(function(ko, ki, ka) {
			if (bi === 0) {
				ko.bIds = [];
			}
			// if (_.contains(bo.kIds, ko.id)) {
			if (bo.kIds.indexOf(ko.id) != -1) {
				ko.bIds.push(bo.id);
				// if (!_.contains(bo.tIds, ko.tId)) {
				if (bo.tIds.indexOf(ko.tId) == -1) {
					bo.tIds.push(ko.tId);
				}
			}
		});
	});

	// Fill collection singletons
	articleList.reset(articles);
	typeList.reset(types);
	keywordList.reset(keywords);
	bundleList.reset(bundles);

	// bootstrap["params"] = bootstrap["articles-all"] = bootstrap["types-all"] = bootstrap["keywords-all"] = bootstrap["bundles-all"] = bootstrap["media-all"] = null;
};
},{"app/control/Globals":34,"app/model/collection/ArticleCollection":41,"app/model/collection/BundleCollection":42,"app/model/collection/KeywordCollection":43,"app/model/collection/TypeCollection":44,"underscore":"underscore"}],46:[function(require,module,exports){
/**
 * @module app/model/item/ArticleItem
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");

/**
 * @constructor
 * @type {module:app/model/item/ArticleItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "a",

	/** @type {Object} */
	defaults: {
		name: "",
		handle: "",
		text: ""
	},

});
},{"app/model/BaseItem":39}],47:[function(require,module,exports){
/**
 * @module app/model/item/BundleItem
 * @requires module:backbone
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
var Color = require("color");

/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");
/** @type {module:app/model/item/MediaItem} */
var MediaItem = require("app/model/item/MediaItem");
/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/utils/strings/stripTags} */
var stripTags = require("utils/strings/stripTags");
// /** @type {module:app/utils/strings/parseTaglist} */
// var parseSymAttrs = require("app/model/parseSymAttrs");

// /** @type {module:app/model/collection/KeywordCollection} */
// var keywords = require("app/model/collection/KeywordCollection");

// Globals.DEFAULT_COLORS["color"];
// Globals.DEFAULT_COLORS["background-color"];
var attrsDefault = _.defaults({
	"has-colors": "defaults"
}, Globals.DEFAULT_COLORS);

/** @private */
var MediaCollection = SelectableCollection.extend({
	model: MediaItem,
	comparator: "o"
});

/**
 * @constructor
 * @type {module:app/model/item/BundleItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "b",

	/** @type {Object|Function} */
	// defaults: function() {
	// 	return {
	// 		name: "",
	// 		handle: "",
	// 		desc: "",
	// 		completed: 0,
	// 		kIds: [],
	// 	};
	// },
	defaults: {
		name: "",
		handle: "",
		desc: "",
		completed: 0,
		get kIds() {
			return [];
		},
		// get keywords() { return []; },
	},

	getters: ["name", "media"],

	mutators: {
		text: function() {
			return stripTags(this.get("desc"));
		},
		// kIds: {
		// 	set: function (key, value, options, set) {
		// 		if (Array.isArray(value)) {
		// 			set("keywords", value.map(function(id) {
		// 				var obj = keywords.get(id);
		// 				return obj;
		// 			}, this), options;
		// 		}
		// 		set(key, value, options);
		// 	},
		// },
		media: {
			transient: true,
			set: function(key, value, options, set) {
				if (Array.isArray(value)) {
					value.forEach(function(o) {
						o.bundle = this;
					}, this);
					value = new MediaCollection(value);
				}
				set(key, value, options);
			},
		},
	},

	initialize: function(attrs, options) {
		this.colors = {
			fgColor: new Color(this.attr("color")),
			bgColor: new Color(this.attr("background-color")),
			lnColor: new Color(this.attr("link-color")),
		};
		this.colors.hasDarkBg = this.colors.fgColor.luminosity() > this.colors.bgColor.luminosity();
	},

	attrs: function() {
		return this._attrs || (this._attrs = _.defaults({}, this.get("attrs"), attrsDefault));
	},
});
},{"app/control/Globals":34,"app/model/BaseItem":39,"app/model/SelectableCollection":40,"app/model/item/MediaItem":49,"color":"color","underscore":"underscore","utils/strings/stripTags":119}],48:[function(require,module,exports){
/**
 * @module app/model/item/KeywordItem
 * @requires module:app/model/BaseItem
 */

/** @type {module:app/model/BaseItem} */
var BaseItem = require("app/model/BaseItem");

// /** @type {module:app/model/collection/TypeCollection} */
// var types = require("app/model/collection/TypeCollection");

/**
 * @constructor
 * @type {module:app/model/item/KeywordItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "k",

	/** @type {Object} */
	defaults: {
		name: "",
		handle: "",
		tId: -1,
	},

	// mutators: {
	// 	tId: {
	// 		set: function (key, value, options, set) {
	// 			var type = types.get(value);
	// 			if (type) {
	// 				type.get("keywords").push(this);
	// 				set("type", type, options);
	// 			}
	// 			set(key, value, options);
	// 		}
	// 	},
	// }
});

},{"app/model/BaseItem":39}],49:[function(require,module,exports){
/**
 * @module app/model/item/MediaItem
 * @requires module:backbone
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
var Color = require("color");

/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");
/** @type {module:app/model/item/SourceItem} */
var SourceItem = require("app/model/item/SourceItem");
/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/utils/strings/stripTags} */
var stripTags = require("utils/strings/stripTags");
// /** @type {module:app/model/parseSymAttrs} */
// var parseSymAttrs = require("app/model/parseSymAttrs");

// console.log(Globals.PARAMS);

var urlTemplates = {
	"original": _.template(Globals.MEDIA_DIR + "/<%= src %>"),
	"constrain-width": _.template(Globals.APP_ROOT + "image/1/<%= width %>/0/uploads/<%= src %>"),
	"constrain-height": _.template(Globals.APP_ROOT + "image/1/0/<%= height %>/uploads/<%= src %>"),
	"debug-bandwidth": _.template(Globals.MEDIA_DIR.replace(/(https?\:\/\/[^\/]+)/, "$1/slow/<%= kbps %>") + "/<%= src %>"),
};

/**
 * @constructor
 * @type {module:app/model/item/MediaItem.SourceCollection}
 */
var SourceCollection = SelectableCollection.extend({
	model: SourceItem
});

/**
 * @constructor
 * @type {module:app/model/item/MediaItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "m",

	/** @type {Object} */
	defaults: {
		name: "<p><em>Untitled</em></p>",
		sub: "",
		o: 0,
		bId: -1,
		srcIdx: 0,
		get srcset() {
			return [];
		},
		get sources() {
			return new SourceCollection();
		},
	},

	getters: ["name", "bundle", "source", "sources"],

	mutators: {
		// desc: function() {
		// 	return this.get("name");
		// },
		handle: function() {
			return this.get("src");
		},
		text: function() {
			if (!this.hasOwnProperty("_text"))
				this._text = _.unescape(stripTags(this.get("name")));
			return this._text;
		},
		attrs: {
			set: function(key, value, opts, set) {
				this._attrs = null;
				BaseItem.prototype.mutators.attrs.set.apply(this, arguments);
				this._updateSources();
			}
		},
		srcset: {
			set: function(key, value, opts, set) {
				set(key, value, opts);
				this.get("sources").reset(value, opts);
				this._updateSources();
			}
		},
		source: {
			transient: true,
			get: function() {
				return this.get("sources").at(this.get("srcIdx"));
			},
		},
	},

	initialize: function() {
		this._updateColors();
		this.listenTo(this, "change:attrs change:bundle", function() {
			this._attrs = null;
		});
	},

	attrs: function() {
		return this._attrs || (this._attrs = _.defaults({}, this.get("bundle").attrs(), this.get("attrs")));
	},

	_updateColors: function() {
		this.colors = {
			fgColor: new Color(this.attr("color")),
			bgColor: new Color(this.attr("background-color"))
		};
		this.colors.hasDarkBg = this.colors.fgColor.luminosity() > this.colors.bgColor.luminosity();
	},

	_updateSources: function() {
		var srcObj = {
			kbps: this.attr("@debug-bandwidth")
		};
		var srcTpl = urlTemplates[srcObj.kbps ? "debug-bandwidth" : "original"];
		this.get("sources").forEach(function(item) {
			srcObj.src = item.get("src");
			item.set("original", srcTpl(srcObj));
		});
	},

	// _updateSourcesArr: function() {
	// 	var srcset = this.get("srcset");
	// 	if (Array.isArray(srcset)) {
	// 		var srcObj = { kbps: this.attr("@debug-bandwidth") };
	// 		var srcTpl = Globals.MEDIA_SRC_TPL[srcObj.kbps? "debug-bandwidth" : "original"];
	// 		srcset.forEach(function(o) {
	// 			srcObj.src = o.src;
	// 			o.original = srcTpl(srcObj);
	// 		}, this);
	// 	}
	// 	this.get("sources").reset(srcset);
	// },

});
},{"app/control/Globals":34,"app/model/BaseItem":39,"app/model/SelectableCollection":40,"app/model/item/SourceItem":50,"color":"color","underscore":"underscore","utils/strings/stripTags":119}],50:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/model/item/SourceItem
 * @requires module:backbone
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");

/** @type {String} */
var noCacheSuffix = "?" + Date.now();

/**
 * @constructor
 * @type {module:app/model/item/SourceItem}
 */
// module.exports = Backbone.Model.extend({
module.exports = BaseItem.extend({

	/** @type {Object} */
	defaults: {
		src: null,
		mime: null,
		w: null,
		h: null,
	},

	getters: ["src", "original"],

	mutators: {
		src: {
			set: function(key, value, options, set) {
				if (DEBUG) {
					value += noCacheSuffix;
				}
				set(key, value, options);
			}
		},
		// original: { 
		// 	transient: true,
		// 	get: function (key, value, options, set) {
		// 		return this.attributes.original || (this.attributes.original = this._composeOriginalSrc());
		// 	},
		// },
		// media: {
		// 	transient: true,
		// 	get: function () {
		// 		var retval;
		// 		if (this._noRecusion) {
		// 			console.log("%s::media returning null", this.cid);
		// 			retval = null;//this.id;
		// 		} else {
		// 			console.log("%s::media returning Object", this.cid);
		// 			this._noRecusion = true;
		// 			retval = this.attributes.media;
		// 			this._noRecusion = false;
		// 		}
		// 		return retval;
		// 	},
		// 	set: function (key, value, options, set) {
		// 		if (value instanceof BaseItem) {
		// 			set(key, value, options);
		// 		}
		// 	},
		// },
	},

	// initialize: function() {
	// 	if (DEBUG) {
	// 		var cb = function() {
	// 			// console.log("@debug-bandwidth:", JSON.stringify(this.get("media").attr("@debug-bandwidth")));
	// 			console.log("media:", JSON.stringify(this.toJSON()));
	// 			// if ((this.get("media") instanceof BaseItem) && this.get("media").attr("@debug-bandwidth")) {
	// 			// 	console.log("original", this.get("original"));
	// 			// 	console.log("media:", JSON.stringify(this.get("media").toJSON()));
	// 			// }
	// 		}.bind(this);
	// 		window.requestAnimationFrame(cb);
	// 	}
	// },
	// 
	// _composeOriginalSrc: function() {
	// 	var values = { src: this.get("src") };
	// 	if (this.has("media") && (values.kbps = this.get("media").attr("@debug-bandwidth"))) {
	// 	// if (this.has("media") && this.get("media").attrs().hasOwnProperty("@debug-bandwidth")) {
	// 	// 	values.kbps = this.get("media").attrs()["@debug-bandwidth"];
	// 		return Globals.MEDIA_SRC_TPL["debug-bandwidth"](values);
	// 	}
	// 	return Globals.MEDIA_SRC_TPL["original"](values);
	// },
});

}).call(this,true)

},{"app/model/BaseItem":39}],51:[function(require,module,exports){
/**
 * @module app/model/item/TypeItem
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");

/**
 * @constructor
 * @type {module:app/model/item/TypeItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "t",

	/** @type {Object} */
	defaults: {
		name: "",
		handle: "",
		// get kIds() { return []; },
		// get keywords() { return []; },
	},

});

},{"app/model/BaseItem":39}],52:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/view/AppView
/*/

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Backbone = require("backbone");

/** @type {module:app/utils/debug/traceArgs} */
var stripTags = require("utils/strings/stripTags");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/control/Controller} */
var controller = require("app/control/Controller");
/** @type {module:app/model/AppState} */
var AppState = require("app/model/AppState");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/NavigationView} */
var NavigationView = require("app/view/NavigationView");
/** @type {module:app/view/ContentView} */
var ContentView = require("app/view/ContentView");


/** @type {module:app/view/base/TouchManager} */
var TouchManager = require("app/view/base/TouchManager");
// /** @type {module:hammerjs} */
// var Hammer = require("hammerjs");
// /** @type {module:utils/touch/SmoothPanRecognizer} */
// var Pan = require("utils/touch/SmoothPanRecognizer");
// /** @type {module:hammerjs.Tap} */
// var Tap = Hammer.Tap;

// /** @type {module:utils/debug/traceElement} */
// var traceElement = require("utils/debug/traceElement");
//
// var vpanLogFn = _.debounce(console.log.bind(console), 100, false);
// var hpanLogFn = _.debounce(console.log.bind(console), 100, false);

var AppView = {
	getInstance: function() {
		if (!(window.app instanceof this)) {
			window.app = new(this)({
				model: new AppState()
			});
		}
		return window.app;
	}
};

var AppViewProto = {

	/** @override */
	cidPrefix: "app",
	/** @override */
	el: "html",
	// /** @override */
	className: "app without-bundle without-media without-article",
	/** @override */
	model: AppState,

	/** @override */
	events: {
		"visibilitychange": function(ev) {
			console.log(ev.type);
		},
		"fullscreenchange": function(ev) {
			console.log(ev.type);
		},
		"dragstart": function(ev) {
			if (ev.target.nodeName == "IMG" || ev.target.nodeName == "A") {
				ev.defaultPrevented || ev.preventDefault();
			}
		}
	},

	properties: {
		container: {
			get: function() {
				return this._container ||
					(this._container = document.getElementById("container"));
				// (this._container = document.body);
			}
		},
		navigation: {
			get: function() {
				return this._navigation ||
					(this._navigation = document.getElementById("navigation"));
			}
		},
		content: {
			get: function() {
				return this._content ||
					(this._content = document.getElementById("content"));
			}
		},
	},

	/** @override */
	initialize: function(options) {
		/* elements */
		// this.routeEl = this.el;
		// this.stateEl = this.el
		this.breakpointEl = this.el;
		// this.touchEl = document.body;
		// this.touchEl = document.getElementById("containter");

		/* init HammerJS handlers */
		var vtouch, htouch;
		// var vpan, hpan, tap;

		// this._vpanEnableFn = function(mc, ev) {
		// 	var retval = !this._hasOverflowY(this.container);
		// 	vpanLogFn("%s::_vpanEnableFn -> %o\n%o", this.cid, retval, arguments);
		// 	return retval;
		// }.bind(this);
		//
		// this._hpanEnableFn = function(mc, ev) {
		// 	var retval = this.model.get("withBundle") && this.model.get("collapsed");
		// 	hpanLogFn("%s::_hpanEnableFn -> %o\n%o", this.cid, retval, arguments);
		// 	return !!retval;
		// }.bind(this);

		vtouch = htouch = TouchManager.init(this.content);
		// vtouch.get("vpan").set({ enable: this._vpanEnableFn });
		// htouch.get("hpan").set({ enable: this._hpanEnableFn });
		// 		vtouch.set({
		// 			enable: function() {
		// 				console.log("app1::hammerjs enable", arguments);
		// 				return true;
		// 			}
		// 		});
		// hpan = vpan;

		// this.el.style.touchAction = "none"; //"pan-x pan-y";

		// tap = new Hammer.Tap();
		// hpan = new Pan({
		// 	event: "hpan",
		// 	direction: Hammer.DIRECTION_HORIZONTAL
		// });
		// hpan.set({
		// 	enable: this._hpanEnableFn
		// });
		// vpan = new Pan({
		// 	event: "vpan",
		// 	direction: Hammer.DIRECTION_VERTICAL
		// });
		// vpan.set({
		// 	enable: this._vpanEnableFn
		// });
		// hpan.requireFailure(vpan);
		// vpan.requireFailure(hpan);

		// vtouch = new Hammer.Manager(this.navigation);
		// vtouch.add([]);

		// htouch = vtouch = new Hammer.Manager(this.content);
		// htouch.add([tap, hpan, vpan]);
		// htouch.add([hpan, vpan]);
		// htouch.set({ touchAction: "pan-x pan-y" });

		// vpan = new Hammer(this.navigation, {
		// 	recognizers: [
		// 		[Pan, {
		// 			event: 'vpan',
		// 			touchAction: "pan-y",
		// 			direction: Hammer.DIRECTION_VERTICAL,
		// 			enable: vpanEnableFn
		// 		}],
		// 	]
		// });
		// hpan = new Hammer(this.content, {
		// 	recognizers: [
		// 		[Pan, {
		// 			event: 'hpan',
		// 			touchAction: "pan-x",
		// 			direction: Hammer.DIRECTION_HORIZONTAL,
		// 			enable: hpanEnableFn
		// 		}],
		// 		[Tap]
		// 	]
		// });
		// hpan.get("hpan").requireFailure(vpan.get("vpan"));

		// this._afterRender = this._afterRender.bind(this);
		this._onResize = this._onResize.bind(this);

		/* render on resize, onorientationchange, visibilitychange */
		// window.addEventListener("orientationchange", this._onResize, false);
		// window.addEventListener("resize", _.debounce(this._onResize.bind(this), 30, false), false);
		window.addEventListener("resize", this._onResize, false);

		// var h = function(ev) { console.log(ev.type, ev) };
		// window.addEventListener("scroll", h, false);
		// window.addEventListener("wheel", h, false);

		/* TODO: replace resize w/ mediaquery listeners. Caveat: some components
		(vg. Carousel) require update on resize */
		// this._onBreakpointChange = this._onBreakpointChange.bind(this);
		// Object.keys(Globals.BREAKPOINTS).forEach(function(s) {
		// 	Globals.BREAKPOINTS[s].addListener(this._onBreakpointChange);
		// }, this);

		/* initialize controller/model listeners BEFORE views register their own */
		this.listenTo(controller, "route", this._onRoute);
		// this.listenTo(controller, "change:after", this._afterControllerChanged);
		this.listenTo(this.model, "change", this._onModelChange); /* FIXME */

		/* initialize views */
		this.navigationView = new NavigationView({
			el: this.navigation,
			model: this.model,
			vpan: vtouch,
			hpan: htouch
		});

		this.contentView = new ContentView({
			el: this.content,
			model: this.model,
			vpan: vtouch,
			hpan: htouch,
		});

		/* Google Analytics */
		if (window.ga && window.GA_ID) {
			controller
				.once("route", function() {
					window.ga("create", window.GA_ID, "auto");
					// if localhost or dummy ID, disable analytics
					if (/(?:(localhost|\.local))$/.test(location.hostname)
						|| window.GA_ID == "UA-9123564-8") {
						window.ga("set", "sendHitTask", null);
					}
				})
				.on("route", function(name) {
					var page = Backbone.history.getFragment();
					// Add a slash if neccesary
					page.replace(/^(?!\/)/, "/");
					window.ga("set", "page", page);
					window.ga("send", "pageview");
				});
		}

		/* Startup listener, added last */
		this.listenToOnce(controller, "route", this._appStart);

		/* start router, which will request appropiate state */
		Backbone.history.start({
			pushState: false,
			hashChange: true,
		});
	},

	/* -------------------------------
	/* _appStart
	/* ------------------------------- */

	_appStart: function(name, args) {
		console.info("%s::_appStart(%s, %s)", this.cid, name, args.join());
		this.skipTransitions = true;
		this.el.classList.add("skip-transitions");

		this.requestRender(View.MODEL_INVALID | View.SIZE_INVALID)
			.requestChildrenRender(View.MODEL_INVALID | View.SIZE_INVALID)
			.listenToOnce(this, "view:render:after", function(view, flags) {
				// this.setImmediate(function() {
				this.requestAnimationFrame(function() {
					console.log("%s::_appStart[view:render:after][raf]", this.cid);
					this.skipTransitions = false;
					this.el.classList.remove("skip-transitions");
					this.el.classList.remove("app-initial");
				});
			});
	},

	/* --------------------------- *
	/* route changed
	/* --------------------------- */

	_onRoute: function(name, args) {
		console.info("%s::_onRoute %o -> %o", this.cid, this.model.get("routeName"), name);
		var o = _.defaults({ routeName: name }, AppState.prototype.defaults);
		switch (name) {
			case "media-item":
				o.bundle = bundles.selected;
				o.withBundle = true;
				o.media = o.bundle.media.selected;
				o.withMedia = true;
				o.collapsed = true;
				break;
			case "bundle-item":
				o.bundle = bundles.selected;
				o.withBundle = true;
				o.collapsed = true;
				break;
			case "article-item":
				o.article = articles.selected;
				o.withArticle = true;
				o.collapsed = true;
				break;
			case "bundle-list":
			case "notfound":
			case "root":
			default:
				o.collapsed = false;
				break;
		}
		// console.log("%s::_onRoute args: %o", this.cid, name, args);
		this.model.set(o);
	},

	/* --------------------------- *
	/* model changed
	/* --------------------------- */

	_onModelChange: function() {
		// console.log("%s::_onModelChange [START]", this.cid);
		console.group(this.cid + "::_onModelChange");
		Object.keys(this.model.changedAttributes()).forEach(function(key) {
			console.info("%s::_onModelChange %s: %s -> %s", this.cid, key,
				this.model.previous(key),
				this.model.get(key));
		}, this);

		this.requestRender(View.MODEL_INVALID)
			// .requestChildrenRender(View.MODEL_INVALID)
			.once("view:render:after", function(view, flags) {
				console.info("%s::_onModelChange [render complete]", view.cid);
				console.groupEnd();
			});
	},

	/* -------------------------------
	/* resize
	/* ------------------------------- */

	_onResize: function(ev) {
		console.group(this.cid + "::_onResize [event]");
		this.skipTransitions = true;
		this.el.classList.add("skip-transitions");

		this.requestRender(View.SIZE_INVALID)
			// .whenRendered().then(function(view) {
			.once("view:render:after", function(view, flags) {
				// this.requestChildrenRender(View.SIZE_INVALID, true);
				// this.setImmediate(function() {
				this.requestAnimationFrame(function() {
					console.info("%s::_onResize [view:render:after][raf]", view.cid);
					view.skipTransitions = false;
					view.el.classList.remove("skip-transitions");
					console.groupEnd();
				})
			}).renderNow();
	},

	/* -------------------------------
	/* render
	/* ------------------------------- */

	renderFrame: function(tstamp, flags) {
		console.log("%s::renderFrame [%s]", this.cid, View.flagsToString(flags));

		/* model: set route & model id classes */
		if (flags & View.MODEL_INVALID) {
			this.renderModelChange(flags);
		}

		/* size: check breakpoints and set classes*/
		if (flags & View.SIZE_INVALID) {
			_.each(Globals.BREAKPOINTS, function(o, s) {
				this.toggle(s, o.matches);
			}, this.breakpointEl.classList);
		}
		/* request children render:  always render now */
		this.requestChildrenRender(flags, true);
		/* request children render:  set 'now' flag if size is invalid */
		// this.requestChildrenRender(flags, flags & View.SIZE_INVALID);

		// if (flags & (View.MODEL_INVALID | View.SIZE_INVALID)) {
		// 	this.navigation.style.touchAction = !this._hasOverflowY(this.container) ? "pan-x" : "";
		// 	this.content.style.touchAction = this._hpanEnableFn() ? "pan-y" : "";
		// 	this.requestAnimationFrame(function() {
		// 		if (this._hpanEnableFn() && this._vpanEnableFn()) {
		// 			this.content.style.touchAction = "none";
		// 		} else if (this._hpanEnableFn()) {
		// 			this.content.style.touchAction = "pan-y";
		// 		} else if (this._vpanEnableFn()) {
		// 			this.content.style.touchAction = "pan-x";
		// 		} else {
		// 			this.content.style.touchAction = "auto";
		// 		}
		// 		// 	document.body.scrollTop = 0;
		// 		// 	window.scroll({ top: 0, behavior: "smooth" });
		// 	});
		// }
	},

	/* -------------------------------
	/* body classes etc
	/* ------------------------------- */

	renderModelChange: function() {

		var cls = this.el.classList;
		var prevAttr = null;
		var docTitle = [];
		var hasDarkBg = false;

		docTitle.push(Globals.APP_NAME);
		if (this.model.get("bundle")) {
			docTitle.push(stripTags(this.model.get("bundle").get("name")));
			if (this.model.get("media")) {
				docTitle.push(stripTags(this.model.get("media").get("name")));
			}
		} else if (this.model.get("article")) {
			docTitle.push(stripTags(this.model.get("article").get("name")));
		}
		document.title = _.unescape(docTitle.join(" / "));

		/* Set route class */
		if (this.model.hasChanged("routeName")) {
			prevAttr = this.model.previous("routeName");
			if (prevAttr) {
				cls.remove("route-" + prevAttr);
			}
			cls.add("route-" + this.model.get("routeName"));
		}

		/* Set model id classes for color styles */
		["article", "bundle", "media"].forEach(function(prop) {
			var item = this.model.get(prop);
			if (this.model.hasChanged(prop)) {
				prevAttr = this.model.previous(prop);
				if (prevAttr) {
					cls.remove(prevAttr.get("domid"));
				}
				if (item) {
					cls.add(item.get("domid"));
				}
			}
			cls.toggle("with-" + prop, !!item);
			cls.toggle("without-" + prop, !item);
			hasDarkBg |= (item && item.colors && item.colors.hasDarkBg);
		}.bind(this));

		/* flag dark background */
		cls.toggle("color-dark", hasDarkBg);
	},
};

if (DEBUG) {
	/** @type {module:app/debug/DebugToolbar} */
	var DebugToolbar = require("app/debug/DebugToolbar");

	AppViewProto.initialize = (function(fn) {
		return function() {
			var retval;
			var view = new DebugToolbar({
				id: "debug-toolbar",
				model: this.model
			});
			document.body.appendChild(view.render().el);
			// this.listenTo(this.model, "change:layoutName", function() {
			// 	this.requestRender(View.SIZE_INVALID); //.renderNow();
			// });
			retval = fn.apply(this, arguments);
			this._logFlags["view.trace"] = true;
			this.navigationView._logFlags["view.trace"] = true;
			// this.navigationView.graph._logFlags["view.trace"] = true;
			// this.navigationView.bundleList._logFlags["view.trace"] = true;
			// this.navigationView.keywordList._logFlags["view.trace"] = true;
			return retval;
		};
	})(AppViewProto.initialize);
}

/**
/* @constructor
/* @type {module:app/view/AppView}
/*/
module.exports = View.extend(AppViewProto, AppView);
}).call(this,true)

},{"app/control/Controller":33,"app/control/Globals":34,"app/debug/DebugToolbar":35,"app/model/AppState":38,"app/model/collection/ArticleCollection":41,"app/model/collection/BundleCollection":42,"app/view/ContentView":53,"app/view/NavigationView":54,"app/view/base/TouchManager":59,"app/view/base/View":60,"backbone":"backbone","underscore":"underscore","utils/strings/stripTags":119}],53:[function(require,module,exports){
/**
 * @module app/view/NavigationView
 */

/** @type {module:underscore} */
var _ = require("underscore");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:utils/TransformHelper} */
var TransformHelper = require("utils/TransformHelper");
// /** @type {module:app/view/base/TouchManager} */
// var TouchManager = require("app/view/base/TouchManager");

/** @type {module:app/control/Controller} */
var controller = require("app/control/Controller");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");

// /** @type {module:app/model/collection/BundleItem} */
// var BundleItem = require("app/model/item/BundleItem");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/ArticleView} */
var ArticleView = require("app/view/component/ArticleView");
/** @type {module:app/view/component/CollectionStack} */
var CollectionStack = require("app/view/component/CollectionStack");
/** @type {module:app/view/component/CollectionStack} */
var SelectableListView = require("app/view/component/SelectableListView");
/** @type {module:app/view/render/DotNavigationRenderer} */
var DotNavigationRenderer = require("app/view/render/DotNavigationRenderer");
/** @type {module:app/view/component/Carousel} */
var Carousel = require("app/view/component/Carousel");

/** @type {module:app/view/render/CarouselRenderer} */
var CarouselRenderer = require("app/view/render/CarouselRenderer");
/** @type {module:app/view/render/ImageRenderer} */
var ImageRenderer = require("app/view/render/ImageRenderer");
/** @type {module:app/view/render/VideoRenderer} */
var VideoRenderer = require("app/view/render/VideoRenderer");
/** @type {module:app/view/render/SequenceRenderer} */
var SequenceRenderer = require("app/view/render/SequenceRenderer");
// /** @type {module:app/view/component/ProgressMeter} */
// var ProgressMeter = require("app/view/component/ProgressMeter");

/** @type {Function} */
var carouselEmptyTemplate = require("./template/Carousel.EmptyRenderer.Bundle.hbs");
/** @type {Function} */
var mediaStackTemplate = require("./template/CollectionStack.Media.hbs");

// var transitionEnd = View.prefixedEvent("transitionend");
var transformProp = View.prefixedProperty("transform");
var transitionProp = View.prefixedProperty("transition");

var tx = Globals.transitions;


// var clickEvent = window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup",

/**
 * @constructor
 * @type {module:app/view/ContentView}
 */
var ContentView = View.extend({

	/** @override */
	cidPrefix: "contentView",

	/** @override */
	className: "container-expanded",

	/** @override */
	events: {
		"transitionend .adding-child": "_onAddedTransitionEnd",
		"transitionend .removing-child": "_onRemovedTransitionEnd",
		// "transitionend": "_onTransitionEnd",
	},

	/** @override */
	initialize: function(options) {
		_.bindAll(this, "_onVPanStart", "_onVPanMove", "_onVPanFinal", "_onCollapsedEvent");

		this.transforms = new TransformHelper();
		// this.touch = options.touch || new Error("no touch"); //TouchManager.getInstance();
		this.vpan = options.vpan || new Error("no vpan");
		this.hpan = options.hpan || new Error("no hpan");

		this.listenTo(this.model, "change", this._onModelChange);

		// disconnect children before last change
		// this.listenTo(bundles, "deselect:one", this._onDeselectOneBundle);

		this.skipTransitions = true;
		this.itemViews = [];

		// this.progressWrapper = this.createProgressWrapper(),
		// this.el.appendChild(this.progressWrapper.el);
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		// values
		var collapsed = this.model.get("collapsed");
		var collapsedChanged = (flags & View.MODEL_INVALID)
			&& this.model.hasChanged("collapsed");
		var childrenChanged = (flags & View.MODEL_INVALID)
			&& (this.model.hasChanged("bundle") || this.model.hasChanged("article"));

		// flags
		var sizeChanged = !!(flags & View.SIZE_INVALID);
		var transformsChanged = !!(flags & (View.MODEL_INVALID | View.SIZE_INVALID | View.LAYOUT_INVALID));
		transformsChanged = transformsChanged || this._transformsChanged || this.skipTransitions;

		// debug
		// - - - - - - - - - - - - - - - - -
		// if (flags & View.MODEL_INVALID) {
		// 	console.group(this.cid + "::renderFrame model changed:");
		// 	Object.keys(this.model.changed).forEach(function(key) {
		// 		console.log("\t%s: %s -> %s", key, this.model._previousAttributes[key], this.model.changed[key]);
		// 	}, this);
		// 	console.groupEnd();
		// }

		// model:children
		// - - - - - - - - - - - - - - - - -
		if (childrenChanged) {
			this.removeChildren();
			if (bundles.selected) {
				this.createChildren(bundles.selected);
			} else
			if (articles.selected) {
				this.createChildren(articles.selected);
			}
		}

		// model:collapsed
		// - - - - - - - - - - - - - - - - -
		if (collapsedChanged) {
			this.el.classList.toggle("container-collapsed", collapsed);
			this.el.classList.toggle("container-expanded", !collapsed);
		}

		// size
		// - - - - - - - - - - - - - - - - -
		if (sizeChanged) {
			this.transforms.clearAllCaptures();
		}

		// transforms
		// - - - - - - - - - - - - - - - - -
		if (transformsChanged) {
			this.el.classList.remove("container-changing");
			if (this.skipTransitions) {
				this.transforms.stopAllTransitions();
				this.el.classList.remove("container-changed");
				if (!childrenChanged) {
					// this.transforms.clearAllOffsets();
					if (collapsedChanged) {
						this._setChildrenEnabled(collapsed);
					}
				}
			} else {
				if (!childrenChanged) {
					if (collapsedChanged) {
						var afterTransitionsFn;
						this.el.classList.add("container-changed");
						// this.transforms.clearAllOffsets();
						if (collapsed) {
							// container-collapsed, enable last
							afterTransitionsFn = function() {
								this._setChildrenEnabled(true);
								this.el.classList.remove("container-changed");
							};
							this.transforms.runAllTransitions(tx.LAST);
						} else {
							// container-expanded, disable first
							afterTransitionsFn = function() {
								this.el.classList.remove("container-changed");
							};
							this._setChildrenEnabled(false);
							this.transforms.runAllTransitions(tx.FIRST);
						}
						afterTransitionsFn = afterTransitionsFn.bind(this);
						this.transforms.whenAllTransitionsEnd().then(afterTransitionsFn, afterTransitionsFn);
					} else {
						this.transforms.items.forEach(function(o) {
							if (o.hasOffset) {
								o.runTransition(tx.NOW);
								// o.clearOffset();
							}
						});
					}
				}
			}
			if (!childrenChanged) {
				this.transforms.clearAllOffsets();
			}
			this.transforms.validate();
		}
		if (sizeChanged) {
			this.itemViews.forEach(function(view) {
				view.skipTransitions = this.skipTransitions;
				view.requestRender(View.SIZE_INVALID).renderNow();
			}, this);
			/*Promise.all(this.itemViews.map(function(view) {
					view.skipTransitions = this.skipTransitions;
					return view.requestRender(View.SIZE_INVALID).whenRendered();
				}, this))
				.then(
					function(views) {
						var nh = this.el.offsetParent.offsetHeight - this.el.offsetTop;
						// var oh = views.reduce(function(h, view) {
						// 	return Math.max(h, view.el.offsetHeight);
						// }, nh);
						// oh++;
						// console.log("%s:[whenRendered] [result: %s %s] %o", this.cid,
						// 	nh, oh, this.el.parent, views);
						this.el.style.minHeight = nh + "px";
						return views;
					}.bind(this),
					function(reason) {
						console.warn("%s:[whenRendered] [rejected] %o", this.cid, reason);
						return reason;
					}.bind(this)
				);*/
		}
		this.skipTransitions = this._transformsChanged = false;
	},

	_setChildrenEnabled: function(enabled) {
		// if (enabled) {
		// 	this.el.removeEventListener("click", this._onCollapsedClick, false);
		// } else {
		// 	this.el.addEventListener("click", this._onCollapsedClick, false);
		// }
		this.itemViews.forEach(function(view) {
			view.setEnabled(enabled);
		});
	},

	/* -------------------------------
	/* Collapse UI gestures/events
	/* ------------------------------- */

	_onCollapsedEvent: function(ev) {
		console.log("%s:[%s -> _onCollapsedEvent] target: %s", this.cid, ev.type, ev.target);
		if (!ev.defaultPrevented &&
			this.model.has("bundle") &&
			!this.model.get("collapsed") &&
			!this.enabled) {
			// this.setImmediate(function() {
			// if (ev.type == "click") ev.stopPropagation();
			ev.preventDefault();
			this.setImmediate(function() {
				// if (ev.type == "click") ev.stopPropagation();
				this.model.set("collapsed", true);
			});
			// });
		}
	},

	/* --------------------------- *
	/* model changed
	/* --------------------------- */

	_onModelChange: function() {
		if (this.model.hasChanged("withBundle")) {
			if (this.model.has("bundle")) {
				this.vpan.on("vpanstart", this._onVPanStart);
			} else {
				this.vpan.off("vpanstart", this._onVPanStart);
			}
		}
		/*
		if (this.model.hasChanged("withBundle") ||
			this.model.hasChanged("collapsed")) {
			if (this.model.get("withBundle") &&
				!this.model.get("collapsed")) {
				this.hpan.on("hpanleft hpanright", this._onCollapsedEvent);
				this.el.addEventListener(Globals.CLICK_EVENT, this._onCollapsedEvent, false);
			} else {
				this.hpan.off("hpanleft hpanright", this._onCollapsedEvent);
				this.el.removeEventListener(Globals.CLICK_EVENT, this._onCollapsedEvent, false);
			}
		}
		*/
		this.requestRender(View.MODEL_INVALID);
	},

	/* -------------------------------
	/* Vertical touch/move (_onVPan*)
	/* ------------------------------- */

	_collapsedOffsetY: Globals.COLLAPSE_OFFSET,

	_onVPanStart: function(ev) {
		this.vpan.on("vpanmove", this._onVPanMove);
		this.vpan.on("vpanend vpancancel", this._onVPanFinal);

		this.transforms.stopAllTransitions();
		// this.transforms.clearAllOffsets();
		// this.transforms.validate();
		this.transforms.clearAllCaptures();

		this.el.classList.add("container-changing");
		this._onVPanMove(ev);
	},

	_onVPanMove: function(ev) {
		var collapsed = this.model.get("collapsed");
		var delta = ev.deltaY; //ev.thresholdDeltaY;
		var maxDelta = this._collapsedOffsetY; // + Math.abs(ev.thresholdOffsetY);

		// check if direction is aligned with collapsed/expand
		var isValidDir = collapsed ? (delta > 0) : (delta < 0);
		var moveFactor = collapsed ? Globals.VPAN_DRAG : 1 - Globals.VPAN_DRAG;

		delta = Math.abs(delta); // remove sign
		delta *= moveFactor;
		maxDelta *= moveFactor;

		if (isValidDir) {
			if (delta > maxDelta) { // overshooting
				delta = ((delta - maxDelta) * Globals.VPAN_OUT_DRAG) + maxDelta;
			} else { // no overshooting
				// delta = delta;
			}
		} else {
			delta = (-delta) * Globals.VPAN_OUT_DRAG; // delta is opposite
		}
		delta *= collapsed ? 1 : -1; // reapply sign

		this.transforms.offsetAll(0, delta);
		this.transforms.validate();
	},

	_onVPanFinal: function(ev) {
		this.vpan.off("vpanmove", this._onVPanMove);
		this.vpan.off("vpanend vpancancel", this._onVPanFinal);

		// FIXME: model.collapsed may have already changed, _onVPanMove would run with wrong values:
		// model.collapsed is changed in a setImmediate callback from NavigationView.

		this._onVPanMove(ev);
		this.setImmediate(function() {
			this._transformsChanged = true;
			this.requestRender();
		});
	},

	// willCollapsedChange: function(ev) {
	// 	var collapsed = this.model.get("collapsed");
	// 	return ev.type == "vpanend"? collapsed?
	// 		ev.thresholdDeltaY > Globals.COLLAPSE_THRESHOLD :
	// 		ev.thresholdDeltaY < -Globals.COLLAPSE_THRESHOLD :
	// 		false;
	// },

	/* -------------------------------
	/* create/remove children on bundle selection
	/* ------------------------------- */

	/** Create children on bundle select */
	createChildren: function(model) {
		var view;
		if (model.__proto__.constructor === bundles.model) {
			// will be attached to dom in this order
			view = this.createMediaCaptionStack(model);
			this.itemViews.push(view);
			this.transforms.add(view.el);
			view = this.createMediaCarousel(model);
			this.itemViews.push(view);
			this.transforms.add(view.el);
			view = this.createMediaDotNavigation(model);
			this.itemViews.push(view);
		} else
		if (model.__proto__.constructor === articles.model) {
			view = this.createArticleView(model);
			this.itemViews.push(view);
		}

		this.itemViews.forEach(function(view) {
			if (!this.skipTransitions) {
				view.el.classList.add("adding-child");
				view.el.style.opacity = 0;
			}
			this.el.appendChild(view.el);
			view.render();
		}, this);

		if (!this.skipTransitions) {
			this.requestAnimationFrame(function() {
				console.log("%s::createChildren::[callback:requestAnimationFrame]", this.cid);
				this.itemViews.forEach(function(view) {
					if (!this.skipTransitions) {
						view.el.style[transitionProp] = "opacity " + tx.LAST.cssText;
					}
					view.el.style.removeProperty("opacity");
				}, this);
			});
		}
	},

	removeChildren: function() {
		this.itemViews.forEach(function(view, i, arr) {
			this.transforms.remove(view.el);
			if (this.skipTransitions) {
				view.remove();
			} else {
				var s = window.getComputedStyle(view.el);
				if (s.opacity == "0" || s.visibility == "hidden") {
					console.log("%s::removeChildren [view:%s] removed immediately (invisible)", this.cid, view.cid);
					view.remove();
				} else {
					view.el.classList.add("removing-child");
					if (s[transformProp]) view.el.style[transformProp] = s[transformProp];
					view.el.style[transitionProp] = "opacity " + tx.FIRST.cssText;
					view.el.style.opacity = 0;
				}
			}
			arr[i] = null;
		}, this);
		this.itemViews.length = 0;
	},

	_onAddedTransitionEnd: function(ev) {
		if (ev.target.cid && this.childViews.hasOwnProperty(ev.target.cid)) {
			console.log("%s::_onAddedTransitionEnd [view:%s] [prop:%s] [ev:%s]", this.cid, ev.target.cid, ev.propertyName, ev.type);
			var view = this.childViews[ev.target.cid];
			view.el.classList.remove("adding-child");
			view.el.style.removeProperty(transitionProp);
		}
	},

	_onRemovedTransitionEnd: function(ev) {
		if (ev.target.cid && this.childViews.hasOwnProperty(ev.target.cid)) {
			console.log("%s::_onRemovedTransitionEnd [view:%s] [prop:%s] [ev:%s]", this.cid, ev.target.cid, ev.propertyName, ev.type);
			var view = this.childViews[ev.target.cid];
			view.el.classList.remove("removing-child");
			view.remove();
		}
	},

	// purgeChildren: function() {
	// 	var i, el, els = this.el.querySelectorAll(".removing-child");
	// 	for (i = 0; i < els.length; i++) {
	// 		el = els.item(i);
	// 		if (el.parentElement === this.el) {
	// 			try {
	// 				console.error("%s::purgeChildren", this.cid, el.getAttribute("data-cid"));
	// 				View.findByElement(el).remove();
	// 			} catch (err) {
	// 				console.error("s::purgeChildren", this.cid, "orphaned element", err);
	// 				this.el.removeChild(el);
	// 			}
	// 		}
	// 	}
	// },

	/* -------------------------------
	/* Components
	/* ------------------------------- */


	/**
	 * media-carousel
	 */
	createMediaCarousel: function(bundle) {
		// Create carousel
		var EmptyRenderer = CarouselRenderer.extend({
			className: "carousel-item empty-item",
			model: bundle,
			template: carouselEmptyTemplate,
		});
		var rendererFunction = function(item, index, arr) {
			if (index === -1) {
				return EmptyRenderer;
			}
			switch (item.attr("@renderer")) {
				case "video":
					return VideoRenderer;
				case "sequence":
					return SequenceRenderer;
				case "image":
					return ImageRenderer;
				default:
					return ImageRenderer;
			}
		};
		var view = new Carousel({
			className: "media-carousel " + bundle.get("domid"),
			collection: bundle.get("media"),
			rendererFunction: rendererFunction,
			requireSelection: false,
			direction: Carousel.DIRECTION_HORIZONTAL,
			touch: this.hpan,
		});
		controller.listenTo(view, {
			"view:select:one": controller.selectMedia,
			"view:select:none": controller.deselectMedia,
			// "view:removed": controller.stopListening
		});
		view.listenTo(bundle, "deselected", function() {
			this.stopListening(this.collection);
			controller.stopListening(this);
		});
		return view;
	},

	/**
	 * media-caption-stack
	 */
	createMediaCaptionStack: function(bundle) {
		var view = new CollectionStack({
			className: "media-caption-stack",
			collection: bundle.get("media"),
			template: mediaStackTemplate
		});
		view.listenTo(bundle, "deselected", function() {
			this.stopListening(this.collection);
		});
		return view;
	},

	/**
	 * media-dotnav
	 */
	createMediaDotNavigation: function(bundle) {
		var view = new SelectableListView({
			className: "media-dotnav dots-fontface color-fg05",
			collection: bundle.get("media"),
			renderer: DotNavigationRenderer
		});
		controller.listenTo(view, {
			"view:select:one": controller.selectMedia,
			"view:select:none": controller.deselectMedia,
			// "view:removed": controller.stopListening
		});
		view.listenTo(bundle, "deselected", function() {
			this.stopListening(this.collection);
			controller.stopListening(this);
		});
		return view;
	},

	/**
	 * @param el {module:app/model/item/ArticleView}
	 * @return {module:app/view/base/View}
	 */
	createArticleView: function(article) {
		var view = new ArticleView({
			model: article,
		});
		return view;
	},

	// createProgressWrapper: function() {
	// 	// var view = new ProgressMeter({
	// 	// 	id: "media-progress-wrapper",
	// 	// 	// className: "color-bg color-fg05",
	// 	// 	useOpaque: false,
	// 	// 	labelFn: function() { return "0%"; }
	// 	// });
	// 	// this.el.appendChild(this.progressWrapper.el);
	// 	// return view;
	// 	return null;
	// },
});

module.exports = ContentView;
},{"./template/Carousel.EmptyRenderer.Bundle.hbs":98,"./template/CollectionStack.Media.hbs":99,"app/control/Controller":33,"app/control/Globals":34,"app/model/collection/ArticleCollection":41,"app/model/collection/BundleCollection":42,"app/view/base/View":60,"app/view/component/ArticleView":64,"app/view/component/Carousel":65,"app/view/component/CollectionStack":67,"app/view/component/SelectableListView":72,"app/view/render/CarouselRenderer":83,"app/view/render/DotNavigationRenderer":88,"app/view/render/ImageRenderer":90,"app/view/render/SequenceRenderer":95,"app/view/render/VideoRenderer":97,"underscore":"underscore","utils/TransformHelper":103}],54:[function(require,module,exports){
/* global MutationObserver */
/**
/* @module app/view/NavigationView
/*/

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:hammerjs} */
var Hammer = require("hammerjs");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:utils/TransformHelper} */
var TransformHelper = require("utils/TransformHelper");
// /** @type {module:app/view/base/TouchManager} */
// var TouchManager = require("app/view/base/TouchManager");

/** @type {module:app/control/Controller} */
var controller = require("app/control/Controller");
/** @type {module:app/model/collection/TypeCollection} */
var types = require("app/model/collection/TypeCollection");
/** @type {module:app/model/collection/KeywordCollection} */
var keywords = require("app/model/collection/KeywordCollection");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/FilterableListView} */
var FilterableListView = require("app/view/component/FilterableListView");
/** @type {module:app/view/component/GroupingListView} */
var GroupingListView = require("app/view/component/GroupingListView");
// /** @type {module:app/view/component/CollectionPager} */
// var CollectionPager = require("app/view/component/CollectionPager");
/** @type {module:app/view/component/GraphView} */
var GraphView = require("app/view/component/GraphView");
/** @type {module:app/view/component/ArticleButton} */
var ArticleButton = require("app/view/component/ArticleButton");

// /** @type {module:utils/prefixedProperty} */
// var prefixedProperty = require("utils/prefixedProperty");

// var traceElement = require("utils/debug/traceElement");

var tx = Globals.transitions;

/**
/* @constructor
/* @type {module:app/view/NavigationView}
/*/
var NavigationView = View.extend({

	// /** @override */
	// tagName: "div",
	/** @override */
	cidPrefix: "navigationView",
	/** @override */
	className: "navigation container-expanded",

	/** @override */
	initialize: function(options) {
		_.bindAll(this, "_onVPanStart", "_onVPanMove", "_onVPanFinal");
		_.bindAll(this, "_onHPanStart", "_onHPanMove", "_onHPanFinal");
		_.bindAll(this, "_onNavigationClick");
		// _.bindAll(this, "_whenTransitionsEnd", "_whenTransitionsAbort");
		// _.bindAll(this, "_whenListsRendered");

		// this._metrics = {
		// 	minHeight: 0
		// };
		this.itemViews = [];
		this.transforms = new TransformHelper();
		// this.touch = options.touch || new Error("no touch"); //TouchManager.getInstance();
		this.vpan = options.vpan || new Error("no vpan");
		this.hpan = options.hpan || new Error("no hpan");

		this.listenTo(this.model, "change", this._onModelChange);
		this.listenTo(keywords, "select:one select:none", this._onKeywordSelect);
		// this.listenTo(this.model, "withBundle:change", this._onwithBundleChange);

		this.vpanGroup = this.el.querySelector("#vpan-group");
		this.keywordList = this.createKeywordList();
		this.bundleList = this.createBundleList();
		this.itemViews.push(this.keywordList);
		this.itemViews.push(this.bundleList);

		this.graph = this.createGraphView(this.bundleList,
			this.keywordList, this.vpanGroup);

		this.sitename = this.createSitenameButton();
		this.about = this.createAboutButton();

		/* NOTE: .list-group .label moves horizontally (cf. sass/layouts/*.scss) */
		this.hGroupings = this.keywordList.el.querySelectorAll(".list-group .label");

		this.transforms.add(
			this.vpanGroup,
			this.bundleList.wrapper,
			this.keywordList.wrapper,
			this.bundleList.el,
			this.keywordList.el,
			this.hGroupings,
			this.sitename.wrapper,
			this.about.wrapper,
			this.sitename.el,
			this.about.el,
			this.graph.el
		);
		// this.itemViews.push(this.graph);
		// this.listenTo(this.graph, {
		// 	"canvas:update": this._onGraphUpdate,
		// 	"canvas:redraw": this._onGraphRedraw,
		// });

		/*this.listenTo(this.graph, "view:render:before", function(view, flags) {
			var vmax;
			if (!view.el.style.height) {
				// if (flags & (View.SIZE_INVALID | View.MODEL_INVALID)) {
				// if ((this.bundleList.renderFlags | View.SIZE_INVALID) ||
				// 	(this.keywordList.renderFlags | View.SIZE_INVALID)) {
				// }
				vmax = Math.max(
					this.bundleList._metrics.height,
					this.keywordList._metrics.height
				);
				if (_.isNumber(vmax)) {
					view.el.style.height = vmax + "px";
					console.log("%s:[view:render:before][once]:%s [%s] heights:[%i, %i] (max %i)",
						this.cid, view.cid, View.flagsToString(flags),
						this.bundleList._metrics.height,
						this.keywordList._metrics.height,
						vmax);
				}
			}
		});*/
		// this.listenTo(this.bundleList, "view:render:after", function(view, flags) {
		// 	console.info("%s:[view:render:after %s]", this.cid, view.cid, View.flagsToString(flags & View.SIZE_INVALID));
		// 		if (flags & View.SIZE_INVALID) {
		// 			// console.info("%s:[%s view:render:after] bundleList height", this.cid, view.cid, this.bundleList.el.style.height);
		// 			// this.graph.el.style.height = this.bundleList.el.style.height;
		// 			this.graph.el.style.opacity = this.bundleList.collapsed? 0 : 1;
		// 			this.graph.requestRender(View.SIZE_INVALID).renderNow();
		// 	// 	}
		// });
		// this.listenTo(this.bundleList, "view:render:after", this._onListResize);
		// this.listenTo(this.keywordList, "view:render:after", this._onListResize);
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		if (flags & View.MODEL_INVALID) {
			if (this.model.hasChanged("collapsed")) {
				this.el.classList.toggle("container-collapsed", this.model.get("collapsed"));
				this.el.classList.toggle("container-expanded", !this.model.get("collapsed"));
			}
			if (this.model.hasChanged("collapsed")
				|| this.model.hasChanged("withBundle")) {
				this.el.classList.add("container-changing");
			}
			if (this.model.hasChanged("routeName")) {
				this.bundleList.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
				this.keywordList.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
			}
		}

		// transforms
		// - - - - - - - - - - - - - - - - -
		if (this.skipTransitions ||
			(flags & (View.MODEL_INVALID | View.SIZE_INVALID | View.LAYOUT_INVALID))) {
			// if (transformsChanged) {
			if (this.skipTransitions) {
				this.transforms.stopAllTransitions();
				this.transforms.validate();
				this.transforms.clearAllOffsets();
			} else {
				this.renderTransitions(flags);
			}
			this.transforms.validate();
			// console.group(this.cid + "::renderFrame (" + this.transforms.items.length + ")");
			// this.transforms.items.forEach(function(o) {
			// 	console.log(traceElement(o.el), (o.hasTransition ? o.transition.name : "-"));
			// });
			// console.groupEnd();
			// console.log("%s::renderFrame %o", this.cid,
			// 	this.transforms.items.map(function(o) {
			// 		return traceElement(o.el) + ":" + (o.hasTransition ? o.transition.name : "-");
			// 	})
			// );
		}


		// promise handlers
		// - - - - - - - - - - - - - - - - -
		var whenListsRenderedDone = function(result) {
			// var hval = result.reduce(function(a, o) {
			// 	return Math.max(a, o.metrics.height);
			// }, 0);
			var hval = this.model.get("collapsed") ?
				"" : Math.max(
					this.bundleList.metrics.height,
					this.keywordList.metrics.height) + "px";

			this.el.style.height = hval; //this.model.get("collapsed") ? "" : "100%";
			// this.vpanGroup.style.height = hval;
			this.graph.el.style.height = hval;
			this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
			console.log("%s:[whenListsRenderedDone] height set to %s", this.cid, hval || "[not set]", result);
			return result;
		}.bind(this);

		var whenCollapsedChangeDone = function(result) {
			console.log("%s:[whenCollapsedChangeDone][flags: %s]", this.cid, View.flagsToString(flags), result);
			this.el.classList.remove("container-changing");
			this.graph.enabled = !this.model.get("collapsed");
			this.graph.valueTo(0, 0, "a2b");
			if (!this.model.get("collapsed")) {
				this.graph.valueTo(1, Globals.TRANSITION_DURATION, "a2b");
			}
			return result;
		}.bind(this);

		// promises
		// - - - - - - - - - - - - - - - - -
		Promise.all([
				this.bundleList.whenRendered(),
				this.keywordList.whenRendered(),
				this.bundleList.whenCollapseChangeEnds(),
				this.keywordList.whenCollapseChangeEnds(),
				this.transforms.whenAllTransitionsEnd(),
			])
			.then(whenListsRenderedDone)
			.then(whenCollapsedChangeDone)
			.catch(function(r) {
				console.warn("collapse promise rejected", r);
				return r;
			});

		/*
		var whenListsRendered = Promise.all([
			this.bundleList.whenRendered(),
			this.keywordList.whenRendered()
		]);

		var whenTransformsEnd = this.transforms.promise();

		whenListsRendered.then(
			whenListsRenderedDone,
			function(reason) {
				console.warn("%s:[whenListsRendered] failed: %o", this.cid, reason);
				return reason;
			}.bind(this)
		);

		Promise.all([
			whenListsRendered,
			whenTransformsEnd
		])
			.then(
				function(result) {
					console.log("%s:[whenListsRendered+whenTransformsEnd] [%s]", this.cid, View.flagsToString(flags), result);
					this.el.classList.remove("container-changing");
					this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
				}.bind(this),
				function(reason) {
					console.warn("%s:[whenListsRendered+whenTransformsEnd] [%s]", this.cid, View.flagsToString(flags), reason);
					this.el.classList.remove("container-changing");
					this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
				}.bind(this)
			);*/


		// trace result handlers
		// - - - - - - - - - - - - - - - - -
		/*if (this.model.hasChanged("collapsed")) {
			var msgBase = this.model.get("collapsed") ? "collaps" : "expand";
			Promise.all([
				Promise.all([
						this.bundleList.whenRendered(),
						this.keywordList.whenRendered()
					])
					.then(
						function() {
							console.log("nav-tx:%sing", msgBase, arguments);
						}),
				this.transforms.promise()
			])
				.catch(
					function() {
						console.warn("nav-tx:%sed [rejected]", msgBase, arguments);
					})
				.finally(
					function() {
						console.log("nav-tx:%sed", msgBase, arguments);
					}
				);
		}*/

		// graph
		// - - - - - - - - - - - - - - - - -
		// if ((flags & (View.SIZE_INVALID | ~View.MODEL_INVALID))
		// 	/* collapsed has not changed, no bundle selected */
		// 	&& !this.model.hasChanged("collapsed")
		// 	&& !this.model.get("withBundle")) {
		// 	this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
		// 	if (!this.skipTransitions) {
		// 		this.graph.renderNow();
		// 	}
		// }
		// else
		// if ((flags & View.SIZE_INVALID) && !this.model.get("collapsed")) {
		// 	/* NavigationView has resized while uncollapsed,
		// 	but model is unchanged */
		// 	this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
		// }


		// children loop
		// - - - - - - - - - - - - - - - - -
		this.itemViews.forEach(function(view) {
			// view.skipTransitions = view.skipTransitions || this.skipTransitions;
			if (this.skipTransitions) {
				view.skipTransitions = true;
			}
			if (flags & View.SIZE_INVALID) {
				view.requestRender(View.SIZE_INVALID);
			}
			// if (!view.skipTransitions) {
			view.renderNow();
			// }
		}, this);

		this.requestAnimationFrame(function() {
			this.skipTransitions = false;
		});
	},

	/*_whenListsRendered: function(result) {
		var hval;
		if (this.model.get("collapsed")) {
			this.el.style.height = "";
			// this.graph.el.style.height = "100%";
		} else {
			// hval = result.reduce(function(a, o) {
			// 	return Math.max(a, o.metrics.height);
			// }, 0);
			hval = Math.max(
				this.bundleList.metrics.height,
				this.keywordList.metrics.height);
			this.el.style.height = hval + "px";
			// this.graph.el.style.height = hval + "px";
		}
		this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();
		console.log("%s:[_whenListsRendered] height set to %opx", this.cid, hval ? hval : "[empty]", arguments);
		return result
	},

	_whenTransitionsEnd: function(result) {
		console.info("%s::_whenTransitionsEnd", this.cid);
		this.el.classList.remove("container-changing");
		// if (!Globals.BREAKPOINTS["desktop-small"].matches)
		// 	return;
		// if (!this.model.get("collapsed")) {
		// 	this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID); //.renderNow();
		// }
		return result;
	},

	_whenTransitionsAbort: function(reason) {
		console.warn("%s::_whenTransitionsAbort %o", this.cid, reason);
		this.el.classList.remove("container-changing");
		// if (!Globals.BREAKPOINTS["desktop-small"].matches)
		// 	return;
		// if (!this.model.get("collapsed")) {
		// 	this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID); //.renderNow();
		// }
		return result;
	},*/

	/* -------------------------------
	/* renderTransitions
	/* ------------------------------- */

	renderTransitions: function(flags) {
		var fromRoute = this.model.previous("routeName");
		var toRoute = this.model.get("routeName");

		var modelChanged = (flags & View.MODEL_INVALID);
		/* bundle */
		var withBundle = this.model.has("bundle");
		var withBundleChanged = modelChanged && this.model.hasChanged("withBundle");
		var bundleChanged = modelChanged && this.model.hasChanged("bundle");
		/* media */
		var withMedia = this.model.has("media");
		var withMediaChanged = modelChanged && this.model.hasChanged("withMedia");
		//var mediaChanged = modelChanged && this.model.hasChanged("media");
		/* article */
		// var withArticle = this.model.has("article");
		var withArticleChanged = modelChanged && this.model.hasChanged("withArticle");
		//var articleChanged = modelChanged && this.model.hasChanged("article");
		/* collapsed */
		var collapsed = this.model.get("collapsed");
		var collapsedChanged = modelChanged && this.model.hasChanged("collapsed");

		var tf;
		/* this.vpanGroup */
		tf = this.transforms.get(this.vpanGroup);
		if (tf && tf.hasOffset) {
			tf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);
			tf.clearOffset();
		}
		/* this.bundleList.el */
		// tf = this.transforms.get(this.bundleList.el);
		// if (tf.hasOffset) {
		// 	tf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);
		// 	tf.clearOffset();
		// }
		/* this.keywordList.el */
		// tf = this.transforms.get(this.keywordList.el);
		// if (tf.hasOffset) {
		// 	tf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);
		// 	tf.clearOffset();
		// }
		/* this.graph.el */
		// tf = this.transforms.get(this.graph.el);
		// if (tf && tf.hasOffset) {
		// 	tf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);
		// 	tf.clearOffset();
		// }

		/*
		 * NOTE:
		 * Vertical:
		 *		site-name-wrapper,
		 *		article-list-wrapper
		 * Horizontal:
		 *		site-name,
		 *		article-buttons,
		 *		keywordList.wrapper,
		 *		bundleList.wrapper,
		 *		hGroupings
		 */
		if (Globals.BREAKPOINTS["desktop-small"].matches) {
			/* HORIZONTAL: keywordList.wrapper */
			tf = this.transforms.get(this.keywordList.wrapper);
			if (collapsedChanged && !withArticleChanged) {
				// if (collapsedChanged) {
				if (withBundleChanged) {
					if (withMediaChanged)
						tf.runTransition(withBundle ? tx.LAST : tx.FIRST);
				} else {
					if (withMedia)
						tf.runTransition(collapsed ? tx.LAST : tx.FIRST);
				}
			} else {
				if (!withBundleChanged && withMediaChanged)
					tf.runTransition(bundleChanged ? tx.BETWEEN : tx.NOW);
			}
			if (tf.hasOffset)
				tf.clearOffset();

			/* HORIZONTAL: the rest */
			if (collapsedChanged ^ withArticleChanged) {
				this.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST,
					this.sitename.el, this.about.el,
					this.bundleList.wrapper,
					this.hGroupings);
			}
			/* VERTICAL */
			if (fromRoute == 'root' || toRoute == 'root') {
				this.transforms.runTransition(tx.BETWEEN,
					this.sitename.wrapper, this.about.wrapper);
			}
			/* this.hGroupings */
			// if (collapsedChanged ^ withArticleChanged) {
			// 	// if (collapsedChanged && !withArticleChanged) {
			// 	this.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.hGroupings);
			// }
			// if (collapsedChanged) {
			// 	if (!withArticleChanged) {
			// 		// if (fromRoute == 'root' || toRoute == 'root') {
			// 		this.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.bundleList.wrapper);
			// 	}
			// } else {
			// 	if (withArticleChanged && withBundleChanged) {
			// 		this.transforms.runTransition(withArticle ? tx.BETWEEN : tx.LAST, this.bundleList.wrapper);
			// 	}
			// }
		} else if (Globals.BREAKPOINTS["fullwidth"].matches) {
			// if (collapsedChanged ) {
			if (collapsedChanged ^ withArticleChanged) {
				this.transforms.runTransition(collapsed ? tx.FIRST : tx.LAST,
					this.sitename.el, this.about.el);
			}
		} else {
			if (withBundleChanged) {
				this.transforms.runTransition(tx.BETWEEN,
					this.sitename.el, this.about.el);
			}
		}
		// this.transforms.clearOffset(
		// 	// this.bundleList.el,
		// 	// this.keywordList.el,
		// 	this.bundleList.wrapper);
	},

	/* --------------------------- *
	/* own model changed
	/* --------------------------- */

	_onModelChange: function() {
		// 	this.setImmediate(this.commitModel);
		// },
		//
		// commitModel: function() {
		// this.requestRender(View.MODEL_INVALID | View.LAYOUT_INVALID);
		this.requestRender(View.MODEL_INVALID);
		// keywords.deselect();
		if (this.model.hasChanged("collapsed")) {
			if (this.model.get("collapsed")) {
				// clear keyword selection
				keywords.deselect();
			} // else {}
			this.keywordList.collapsed = this.model.get("collapsed");
			this.bundleList.collapsed = this.model.get("collapsed");
		}
		if (this.model.hasChanged("bundle")) {
			this.bundleList.selectedItem = this.model.get("bundle");
			this.keywordList.refreshFilter();

			// if (!this.model.get("collapsed") && this.graph) {
			// 	this.listenToOnce(this.keywordList, "view:render:after", function(view, flags) {
			// 		console.log("%s::_onBundleSelect -> %s:[view:render:after] flags:%s", this.cid, view.cid, View.flagsToString(flags));
			// 		this.graph.valueTo(0, 0, "a2b");
			// 		// this.graph.renderNow();
			// 		this.graph.valueTo(1, Globals.TRANSITION_DURATION, "a2b");
			// 	});
			// }
			// keywords.deselect();
			// this.graph && this.graph.requestRender(View.SIZE_INVALID);
		}
		if (this.model.hasChanged("withBundle")) {
			// this.keywordList.refreshFilter()
			if (this.model.get("withBundle")) {
				this.graph.el.addEventListener(Globals.CLICK_EVENT, this._onNavigationClick);
				this.vpan.on("vpanstart", this._onVPanStart);
				this.hpan.on("hpanstart", this._onHPanStart);
				// this.hpan.on("tap", this._onTap);
			} else {
				this.graph.el.removeEventListener(Globals.CLICK_EVENT, this._onNavigationClick);
				this.vpan.off("vpanstart", this._onVPanStart);
				this.hpan.off("hpanstart", this._onHPanStart);
				keywords.deselect();
				// this.hpan.off("tap", this._onTap);
			}
			// this.graph.valueTo()
		}
	},

	// _onwithBundleChange: function(withBundle) {
	// 	if (withBundle) {
	// 		this.listenTo(this.model, "collapsed:change", function(collapsed){
	//
	// 		});
	// 	} else {
	// 		this.stopListening(this.model, "collapsed:change", function(collapsed){
	//
	// 		});
	// 	}
	// },

	/* --------------------------- *
	/* keyword collection changed
	/* --------------------------- */

	_onKeywordSelect: function(keyword) {
		// use collection listener to avoid redundant refreshFilter calls
		this.bundleList.refreshFilter();
		if (!this.model.get("collapsed") && this.graph) {
			this.listenToOnce(this.bundleList, "view:render:after", function(view, flags) {
				console.log("%s::_onKeywordSelect -> %s:[view:render:after] flags:%s", this.cid, view.cid, View.flagsToString(flags));
				this.graph.valueTo(0, 0, "b2a");
				// this.graph.renderNow();
				this.graph.valueTo(1, Globals.TRANSITION_DURATION, "b2a");
			});
		}
	},

	/* --------------------------- *
	/* UI Events: bundleList keywordList buttons
	/* --------------------------- */

	_onNavigationClick: function(ev) {
		if (ev.defaultPrevented || ev.target !== this.graph.el) {
			return;
		}
		ev.preventDefault();
		if (this.model.has("bundle")) {
			console.log("%s::_onNavigationClick [%s]", this.cid, ev.type, ev); //, ev.target);
			// this.transforms.offset(0, 1, this.graph.el);
			// this.transforms.validate();
			// this._setCollapsed(!this.model.get("collapsed"));
			this.setImmediate(function() {
				this.model.set("collapsed", !this.model.get("collapsed"));
			});
		}
	},

	_setCollapsed: function(value) {
		if (value !== this.model.get("collapsed")) {
			// this.transforms.offset(0, 1, this.graph.el);
			// this.transforms.validate();
			this.setImmediate(function() {
				// console.log("%s::_setCollapsed -> %s (setImmediate)", this.cid, value);
				this.model.set("collapsed", value);
			});
		}
	},

	/* -------------------------------
	/* Horizontal touch/move (HammerJS)
	/* ------------------------------- */

	_onHPanStart: function(ev) {
		this.transforms.get(this.keywordList.wrapper)
			.stopTransition()
			.clearOffset()
			.validate();
		// if (this.model.get("layoutName") != "left-layout"
		// 	&& this.model.get("layoutName") != "default-layout") {
		// 	return;
		// }
		if (Globals.BREAKPOINTS["desktop-small"].matches
			&& this.model.get("bundle").get("media").selectedIndex <= 0
			&& this.model.get("collapsed")) {
			this.transforms.get(this.keywordList.wrapper).clearCapture();
			this._onHPanMove(ev);

			this.hpan.on("hpanmove", this._onHPanMove);
			this.hpan.on("hpanend hpancancel", this._onHPanFinal);
		}
	},

	_onHPanMove: function(ev) {
		// var HPAN_DRAG = 1;
		// var HPAN_DRAG = 0.75;
		var HPAN_DRAG = 720 / 920;
		var delta = ev.deltaX; //ev.thresholdDeltaX;
		// var mediaItems = this.model.get("bundle").get("media");

		if (this.model.has("media")) {
			delta *= (ev.offsetDirection & Hammer.DIRECTION_LEFT) ?
				0.0 : HPAN_DRAG;
		} else {
			delta *= (ev.offsetDirection & Hammer.DIRECTION_LEFT) ?
				HPAN_DRAG : Globals.HPAN_OUT_DRAG;
		}
		this.transforms.offset(delta, null, this.keywordList.wrapper);
		this.transforms.validate();
	},

	_onHPanFinal: function(ev) {
		this.hpan.off("hpanmove", this._onHPanMove);
		this.hpan.off("hpanend hpancancel", this._onHPanFinal);

		/* NOTE: if there is no model change, set tx here. Otherwise just wait for render */
		var kTf = this.transforms.get(this.keywordList.wrapper);
		if (!(this._renderFlags & View.MODEL_INVALID) && kTf.hasOffset) {
			if (kTf.offsetX != 0) {
				kTf.runTransition(tx.NOW);
			}
			kTf.clearOffset().validate();
		}
	},

	/* -------------------------------
	/* Vertical touch/move (_onVPan*)
	/* ------------------------------- */

	_collapsedOffsetY: Globals.COLLAPSE_OFFSET,

	_onVPanStart: function(ev) {
		this.vpan.on("vpanmove", this._onVPanMove);
		this.vpan.on("vpanend vpancancel", this._onVPanFinal);


		this.transforms.stopTransition(this.vpanGroup);
		this.transforms.clearCapture(this.vpanGroup);
		// this.transforms.stopTransition(this.bundleList.el, this.keywordList.el); //, this.graph.el);
		// // this.transforms.clearOffset(this.bundleList.el, this.keywordList.el);
		// // this.transforms.validate();
		// this.transforms.clearCapture(this.bundleList.el, this.keywordList.el); //, this.graph.el);
		//
		// if (!this.model.get("collapsed")) {
		// 	this.transforms.stopTransition(this.graph.el);
		// 	this.transforms.clearCapture(this.graph.el);
		// }
		// // this.el.classList.add("container-changing");
		this._onVPanMove(ev);
	},

	_onVPanMove: function(ev) {
		var delta = this._computeVPanDelta(ev.deltaY); //ev.thresholdDeltaY);

		this.transforms.offset(0, delta, this.vpanGroup);
		// this.transforms.offset(0, delta,
		// 	this.bundleList.el, this.keywordList.el);
		// if (!this.model.get("collapsed")) {
		// 	this.transforms.offset(0, delta, this.graph.el);
		// }
		this.transforms.validate();
	},

	_onVPanFinal: function(ev) {
		this.vpan.off("vpanmove", this._onVPanMove);
		this.vpan.off("vpanend vpancancel", this._onVPanFinal);

		this._onVPanMove(ev);
		// this.transforms.validate();

		this.setImmediate(function() {
			// this.transforms.clearOffset(this.bundleList.el, this.keywordList.el, this.graph.el);
			if (this.willCollapsedChange(ev)) {
				// this._setCollapsed(!this.model.get("collapsed"));
				this.model.set("collapsed", !this.model.get("collapsed"));
			}
			this.requestRender(View.LAYOUT_INVALID).renderNow();
		});
	},

	willCollapsedChange: function(ev) {
		return ev.type == "vpanend" ? this.model.get("collapsed") ?
			ev.deltaY > Globals.COLLAPSE_THRESHOLD :
			ev.deltaY < -Globals.COLLAPSE_THRESHOLD :
			false;
	},

	_computeVPanDelta: function(delta) {
		var collapsed = this.model.get("collapsed");
		var maxDelta = this._collapsedOffsetY; // + Math.abs(ev.thresholdOffsetY);
		// check if direction is aligned with collapsed/expand
		var isValidDir = collapsed ? (delta > 0) : (delta < 0);
		var moveFactor = collapsed ? 1 - Globals.VPAN_DRAG : Globals.VPAN_DRAG;

		delta = Math.abs(delta); // remove sign
		delta *= moveFactor;
		maxDelta *= moveFactor;

		if (isValidDir) {
			if (delta > maxDelta) { // overshooting
				delta = ((delta - maxDelta) * Globals.VPAN_OUT_DRAG) + maxDelta;
			} else { // no overshooting
				// delta = delta;
			}
		} else {
			delta = (-delta) * Globals.VPAN_OUT_DRAG; // delta is opposite
		}
		delta *= collapsed ? 0.5 : -1; // reapply sign
		return delta;
	},

	/* -------------------------------
	/* Create children components
	/* ------------------------------- */

	// -------------------------------
	// #site-name
	// -------------------------------

	createSitenameButton: function() {
		var view = new View({
			el: "#site-name",
			events: {
				"click a": function(domev) {
					domev.defaultPrevented || domev.preventDefault();
					this.trigger("view:click");
				}
			}
		});
		view.wrapper = view.el.parentElement;
		this.listenTo(view, "view:click", this._onSitenameClick);
		return view;
	},

	_onSitenameClick: function() {
		switch (this.model.get("routeName")) {
			case "media-item":
			case "bundle-item":
				// if (this.model.get("collapsed")) {
				// 	this._setCollapsed(false);
				// } else {
				controller.deselectBundle();
				// }
				break;
			case "article-item":
				controller.deselectArticle();
				break;
		}
	},

	// -------------------------------
	// .article-button
	// -------------------------------

	createArticleButton: function(articleItem) {
		var view = new ArticleButton({
			el: ".article-button[data-handle='about']",
			model: articleItem
		}).render();
		view.wrapper = view.el.parentElement;
		this.listenTo(view, "view:click", this._onArticleClick);
		return view;
	},

	_onArticleClick: function(item) {
		switch (this.model.get("routeName")) {
			case "article-item":
				controller.deselectArticle();
				break;
			case "root":
			default:
				controller.selectArticle(item);
				break;
		}
	},

	createAboutButton: function() {
		return this.createArticleButton(articles.findWhere({ handle: "about" }));
	},

	// -------------------------------
	// #bundle-list
	// -------------------------------

	/**
	 * @param el {HTMLElement}
	 * @return {module:app/base/view/component/FilterableListView}
	 */
	createBundleList: function(el) {
		var view = new FilterableListView({
			el: (el || "#bundle-list"),
			collection: bundles,
			collapsed: false,
			filterFn: function(bundle, index, arr) {
				return keywords.selected ?
					bundle.get("kIds").indexOf(keywords.selected.id) !== -1 : false;
			},
		});
		view.wrapper = view.el.parentElement;
		this.listenTo(view, "view:select:one view:select:none", function(bundle) {
			this.setImmediate(function() {
				controller.selectBundle(bundle);
			});
		})
		this.listenTo(view, "view:select:same", this._onBundleListSame);
		return view;
	},

	_onBundleListSame: function(bundle) {
		this.transforms.offset(0, 1, this.graph.el);
		this.transforms.validate();
		this.setImmediate(function() {
			this.model.set("collapsed", !this.model.get("collapsed"));
		});
	},

	// -------------------------------
	// #keyword-list
	// -------------------------------

	/**
	 * @param el {HTMLElement}
	 * @return {module:app/base/view/component/GroupingListView}
	 */
	createKeywordList: function(el) {
		var view = new GroupingListView({
			el: (el || "#keyword-list"),
			collection: keywords,
			collapsed: false,
			filterFn: function(item, idx, arr) {
				// return !!(item.get("bundle").selected);
				return bundles.selected ?
					(bundles.selected.get("kIds").indexOf(item.id) !== -1) : false;
			},
			groupingFn: function(item, idx, arr) {
				// return item.get("type");
				return types.get(item.get("tId"));
			},
		});
		view.wrapper = view.el.parentElement;
		view.listenTo(keywords, "select:one select:none", function(item) {
			view.selectedItem = item;
		});
		this.listenTo(view, "view:select:one view:select:none", this._onKeywordListChange);
		return view;
	},

	_onKeywordListChange: function(keyword) {
		if (!this.model.get("collapsed")) {
			keywords.select(keyword);
		}
	},

	// -------------------------------
	// #nav-graph
	// -------------------------------

	/**
	 * @param listA {module:app/base/view/component/FilterableListView}
	 * @param listB {module:app/base/view/component/FilterableListView}
	 * @param parentEl {HTMLElement}
	 * @return {module:app/base/view/component/GraphView}
	 */
	createGraphView: function(listA, listB, parentEl) {
		var view = new GraphView({
			id: "nav-graph",
			listA: listA,
			listB: listB,
			model: this.model,
			useOpaque: false
		});
		parentEl || (parentEl = this.el);
		parentEl.insertBefore(view.el, parentEl.firstElementChild);
		return view;
	},

	/* -------------------------------
	/* Horizontal touch/move (MutationObserver)
	/* ------------------------------- */

	/*
	_beginTransformObserve: function() {
		if (!(Globals.BREAKPOINTS["desktop-small"].matches && this.model.get("bundle").get("media").selectedIndex <= 0 && this.model.get("collapsed"))) {
			return;
		}
		var target = document.querySelector(".carousel > .empty-item");
		if (target === null) {
			return;
		}
		if (!this._transformObserver) {
			this._transformObserver = new MutationObserver(this._onTransformMutation);
		}
		this._transformObserver.observe(target, { attributes: true, attributeFilter: ["style"] });
		this.hpan.on("hpanend hpancancel", this._endTransformObserve);
		this.transforms.get(this.keywordList.wrapper)
			.stopTransition()
			.clearOffset()
			.clearCapture()
			.validate();
	},

	_endTransformObserve: function() {
		this._transformObserver.disconnect();
		this.hpan.off("hpanend hpancancel", this._endTransformObserve);
		this.transforms.get(this.keywordList.wrapper)
			.clearOffset()
			.runTransition(tx.NOW)
			.validate();
	},

	_onTransformMutation: function(mutations) {
		var tView, tMetrics, tCss, dTxObj, pos;

		// this.keywordList.wrapper.style[prefixedProperty("transform")];
		// transform = mutations[0].target.style.getPropertyValue(prefixedProperty("transform"));

		tView = View.findByElement(mutations[0].target);
		if (tView) {
			tMetrics = tView.metrics;
			dTxObj = this.transforms.get(this.keywordList.wrapper);
			console.log("%s::_onTransformMutation [withMedia: %s] target: (%f\+%f) %f wrapper: (%f) %f", this.cid,
				this.model.has("media"),
				tMetrics.translateX, tMetrics.width, tMetrics.translateX + tMetrics.width,
				dTxObj.capturedX, tMetrics.translateX - dTxObj.capturedX,
				tMetrics
			);

			this.transforms.offset(tMetrics.translateX - dTxObj.capturedX, void 0, this.keywordList.wrapper);
			this.transforms.validate();
		}
	},
	*/
});

module.exports = NavigationView;
},{"app/control/Controller":33,"app/control/Globals":34,"app/model/collection/ArticleCollection":41,"app/model/collection/BundleCollection":42,"app/model/collection/KeywordCollection":43,"app/model/collection/TypeCollection":44,"app/view/base/View":60,"app/view/component/ArticleButton":63,"app/view/component/FilterableListView":68,"app/view/component/GraphView":69,"app/view/component/GroupingListView":70,"hammerjs":"hammerjs","underscore":"underscore","utils/TransformHelper":103}],55:[function(require,module,exports){
var PriorityQueue = function(offset) {
	this._offset = offset | 0;
	this._items = [];
	this._priorities = [];
	this._numItems = 0;
};

PriorityQueue.prototype = Object.create({
	enqueue: function(item, priority) {
		var i = this._items.length;
		this._items[i] = item;
		this._priorities[i] = {
			priority: (priority | 0),
			index: i
		};
		this._numItems++;
		// console.log("FrameQueue::RequestQueue::enqueue() [numItems:%i] ID:%i", this._numItems, this._offset + i);
		return this._offset + i;
	},

	contains: function(index) {
		index -= this.offset;
		return 0 <= index && index < this._items.length;
	},

	skip: function(index) {
		var i, item;
		i = index - this._offset;
		if (0 > i || i >= this._items.length) {
			// 	console.warn("FrameQueue::RequestQueue::skip(id:%i) out of range (%i-%i)", index, this._offset, this._offset + (this._numItems - 1));
			return void 0;
		}
		item = this._items[i];
		if (item !== null) {
			// if (item = this._items[i]) {
			this._items[i] = null;
			this._numItems--;
		}
		return item;
	},

	indexes: function() {
		var items = this._priorities.concat();
		items.sort(function(a, b) {
			if (a.priority > b.priority)
				return 1;
			if (a.priority < b.priority)
				return -1;
			return 0;
		});
		items.forEach(function(o, i, a) {
			a[i] = o.index;
		}, this);
		return items;
	},

	items: function() {
		var items = this._priorities.concat();
		items.sort(function(a, b) {
			if (a.priority > b.priority)
				return 1;
			if (a.priority < b.priority)
				return -1;
			return 0;
		});
		items.forEach(function(o, i, a) {
			a[i] = this._items[o.index];
		}, this);
		return items;
	},

	_empty: function(offset) {
		this._offset = offset;
		this._items.length = 0;
		this._priorities.length = 0;
		this._numItems = 0;
	}
}, {

	offset: {
		get: function() {
			return this._offset;
		}
	},

	length: {
		get: function() {
			return this._items.length;
		}
	},

	numItems: {
		get: function() {
			return this._numItems;
		}
	},
});

var CallbackQueue = function(requestFn, cancelFn) {
	this._nextQueue = new PriorityQueue(0);
	this._currQueue = null;

	// this._pending = false;
	this._running = false;
	this._runId = -1;

	this._requestFn = requestFn;
	this._cancelFn = cancelFn;
	this._runQueue = this._runQueue.bind(this)
};

CallbackQueue.prototype = Object.create({
	/**
	 * @param tstamp {int}
	 */
	_runQueue: function() {
		if (this._running) throw new Error("wtf!!!");

		this._currQueue = this._nextQueue;
		this._nextQueue = new PriorityQueue(this._currQueue.offset + this._currQueue.length);

		this._runId = -1;
		this._running = true;

		var i, item;
		var indexes = this._currQueue.indexes();
		var items = this._currQueue._items;
		for (i = 0; i < indexes.length; i++) {
			item = items[indexes[i]];
			if (item !== null) {
				item.apply(null, arguments);
			}
		}

		// var self = this;
		// this._currQueue.indexes().forEach(function(index) {
		// 	var fn = self._currQueue._items[index];
		// 	if (fn !== null) {
		// 		fn.apply(null, arguments);
		// 	}
		// });
		this._running = false;
		this._currQueue = null;

		if (this._nextQueue.numItems > 0) {
			this._runId = this._requestFn.call(null, this._runQueue);
			// this._runId = this._requestFn(this._runQueue);
		}
	},

	/**
	 * @param fn {Function}
	 * @param priority {int}
	 * @return {int}
	 */
	request: function(fn, priority) {
		// if (!this._running && !this._pending) {
		// 	this._pending = true;
		// 	console.warn("FrameQueue::request setImmediate: pending");
		// 	setImmediate(function() {
		// 		this._pending = false;
		// 		if (this._nextQueue.numItems > 0) {
		// 			this._runId = window.requestAnimationFrame(_runQueue);
		// 			console.warn("FrameQueue::request setImmediate: raf:%i for %i items", this._runId, this._nextQueue.numItems);
		// 		} else {
		// 			console.warn("FrameQueue::request setImmediate: no items");
		// 		}
		// 	});
		// }
		if (!this._running && this._runId === -1) {
			this._runId = this._requestFn.call(null, this._runQueue);
			// this._runId = this._requestFn(this._runQueue);
		}
		return this._nextQueue.enqueue(fn, priority);
	},

	/**
	 * @param id {int}
	 * @return {Function?}
	 */
	cancel: function(id) {
		var fn;
		if (this._running) {
			fn = this._currQueue.skip(id) || this._nextQueue.skip(id);
		} else {
			fn = this._nextQueue.skip(id);
			if ((this._runId !== -1) && (this._nextQueue.numItems === 0)) {
				this._cancelFn.call(null, this._runId);
				// this._cancelFn(this._runId);
				this._runId = -1;
			}
		}
		return fn;
	},
}, {
	running: {
		get: function() {
			return this._running;
		}
	}
});

module.exports = CallbackQueue;
},{}],56:[function(require,module,exports){
(function (DEBUG){
/* global Path2D */
/**
 * @module app/view/component/progress/CanvasView
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:color} */
// var Color = require("color");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/view/base/Interpolator} */
var Interpolator = require("app/view/base/Interpolator");
/** @type {module:utils/css/getBoxEdgeStyles} */
var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

var MIN_CANVAS_RATIO = 1; // /Firefox/.test(window.navigator.userAgent)? 2 : 1;

/**
 * @constructor
 * @type {module:app/view/component/progress/CanvasView}
 */
var CanvasView = View.extend({

	/** @type {string} */
	cidPrefix: "canvasView",
	/** @type {string} */
	tagName: "canvas",
	/** @type {string} */
	className: "canvas-view",

	properties: {
		context: {
			get: function() {
				return this._ctx;
			}
		},
		interpolator: {
			get: function() {
				return this._interpolator;
			}
		},
		canvasRatio: {
			get: function() {
				return this._canvasRatio;
			}
		},
	},

	/** @type {Object} */
	defaults: {
		values: {
			value: 0
		},
		maxValues: {
			value: 1
		},
		useOpaque: true,
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	initialize: function(options) {
		// TODO: cleanup this options mess
		options = _.defaults(options, this.defaults);
		options.values = _.defaults(options.values, this.defaults.values);
		options.maxValues = _.defaults(options.maxValues, this.defaults.maxValues);

		this._interpolator = new Interpolator(options.values, options.maxValues);
		this._useOpaque = options.useOpaque;
		this._options = _.pick(options, "color", "backgroundColor");

		// opaque background
		// --------------------------------
		var ctxOpts = {};
		// if (this._useOpaque) {
		// 	this._opaqueProp = Modernizr.prefixed("opaque", this.el, false);
		// 	if (this._opaqueProp) {
		// 		this.el[this._opaqueProp] = true;
		// 	} else {
		// 		ctxOpts.alpha = true;
		// 	}
		// 	this.el.classList.add("color-bg");
		// }

		// canvas' context init
		// --------------------------------
		this._ctx = this.el.getContext("2d", ctxOpts);

		// adjust canvas size to pixel ratio
		// upscale the canvas if the two ratios don't match
		// --------------------------------
		var ratio = MIN_CANVAS_RATIO;
		var ctxRatio = this._ctx.webkitBackingStorePixelRatio || 1;
		if (window.devicePixelRatio !== ctxRatio) {
			// ratio = Math.max(window.devicePixelRatio / ctxRatio, MIN_CANVAS_RATIO);
			ratio = window.devicePixelRatio / ctxRatio;
			ratio = Math.max(ratio, MIN_CANVAS_RATIO);
		}
		this._canvasRatio = ratio;
		// console.log("%s::init canvasRatio: %f", this.cid, this._canvasRatio);

		this.listenTo(this, "view:attached", function() {
			// this.invalidateSize();
			// this.renderNow();
			this.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();
		});
	},

	// _computeCanvasRatio: function() {
	// 	var ratio = MIN_CANVAS_RATIO;
	// 	var ctxRatio = this._ctx.webkitBackingStorePixelRatio || 1;
	// 	if (window.devicePixelRatio !== ctxRatio) {
	// 		// ratio = Math.max(window.devicePixelRatio / ctxRatio, MIN_CANVAS_RATIO);
	// 		ratio = window.devicePixelRatio / ctxRatio;
	// 		ratio = Math.max(ratio, MIN_CANVAS_RATIO);
	// 	}
	// 	this._canvasRatio = ratio;
	// },

	_updateCanvas: function() {
		// adjust canvas size to pixel ratio
		// upscale the canvas if the two ratios don't match
		// --------------------------------

		var s = getComputedStyle(this.el);

		// this._canvasWidth = this.el.offsetWidth;
		// this._canvasHeight = this.el.offsetHeight;
		this._canvasWidth = this.el.scrollWidth;
		this._canvasHeight = this.el.scrollHeight;

		if (s.boxSizing === "border-box") {
			var m = getBoxEdgeStyles(s);
			this._canvasWidth -= m.paddingLeft + m.paddingRight + m.borderLeftWidth + m.borderRightWidth;
			this._canvasHeight -= m.paddingTop + m.paddingBottom + m.borderTopWidth + m.borderBottomWidth;
		}

		this._canvasWidth *= this._canvasRatio;
		this._canvasHeight *= this._canvasRatio;

		this.measureCanvas(this._canvasWidth, this._canvasHeight, s);
		this.el.width = this._canvasWidth;
		this.el.height = this._canvasHeight;
		// this.el.style.height = h + "px";
		// this.el.style.width = w + "px";

		// colors
		// --------------------------------
		this._color = this._options.color ||
			s.color || Globals.DEFAULT_COLORS["color"];
		this._backgroundColor = this._options.backgroundColor ||
			s.backgroundColor || Globals.DEFAULT_COLORS["background-color"];

		// mozOpaque
		// --------------------------------
		if (this._useOpaque && this._opaqueProp) {
			// this.el.style.backgroundColor = this._backgroundColor;
			this.el[this._opaqueProp] = true;
		}

		// fontSize
		// --------------------------------
		this._fontSize = parseFloat(s.fontSize) * this._canvasRatio;
		this._fontFamily = s.fontFamily;

		// prepare canvas context
		// --------------------------------
		this._ctx.restore();

		this._ctx.font = [s.fontWeight, s.fontStyle, this._fontSize + "px/1", s.fontFamily].join(" ");
		this._ctx.textAlign = "left";
		this._ctx.lineCap = "butt";
		this._ctx.lineJoin = "miter";
		this._ctx.strokeStyle = this._color;
		this._ctx.fillStyle = this._color;

		this.updateCanvas(this._ctx);
		this._ctx.save();

		// console.group(this.cid+"::_updateCanvas");
		// console.log("ratio:    %f (min: %f, device: %f, context: %s)", this._canvasRatio, MIN_CANVAS_RATIO, window.devicePixelRatio, this._ctx.webkitBackingStorePixelRatio || "(webkit-only)");
		// console.log("colors:   fg: %s bg: %s", this._color, this._backgroundColor);
		// console.log("style:    %s, %s, padding: %s (%s)", s.width, s.height, s.padding, s.boxSizing);
		// console.log("box:      %f x %f px", m.width, m.height);
		// console.log("measured: %f x %f px", w, h);
		// console.log("canvas:   %f x %f px", this._canvasWidth, this._canvasHeight);
		// console.groupEnd();
	},

	updateCanvas: function() {
		/* abstract */
	},

	measureCanvas: function() {
		/* abstract */
	},

	_getFontMetrics: function(str) {
		var key, idx, mObj, mIdx = str.length;
		for (key in Globals.FONT_METRICS) {
			idx = str.indexOf(key);
			if (idx !== -1 && idx < mIdx) {
				mIdx = idx;
				mObj = Globals.FONT_METRICS[key];
			}
		}
		return mObj;
	},

	_clearCanvas: function(x, y, w, h) {
		this._ctx.clearRect(x, y, w, h);
		if (this._useOpaque) {
			this._ctx.save();
			this._ctx.fillStyle = this._backgroundColor;
			this._ctx.fillRect(x, y, w, h);
			this._ctx.restore();
		}
	},

	_setStyle: function(s) {
		CanvasView.setStyle(this._ctx, s);
	},

	/* --------------------------- *
	/* render
	/* --------------------------- */

	/** @override */
	render: function() {
		if (this.attached) {
			return this.renderNow();
		}
		return this;
	},

	/** @override */
	renderFrame: function(tstamp, flags) {
		if (!this.attached) {
			return flags;
		}
		if (flags & View.SIZE_INVALID) {
			this._updateCanvas();
		}
		if (this._interpolator.valuesChanged) {
			flags |= View.LAYOUT_INVALID;
			this._interpolator.interpolate(tstamp);
		}
		if (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {
			this.redraw(this._ctx, this._interpolator, flags);
			if (this._interpolator.valuesChanged) {
				this.requestRender();
			}
		}
	},

	/* --------------------------- *
	/* public
	/* --------------------------- */

	getValue: function(key) {
		return this._interpolator.getValue(key);
	},

	getRenderedValue: function(key) {
		return this._interpolator.getRenderedValue(key);
	},

	valueTo: function(value, duration, key) {
		this._interpolator.valueTo(value, duration, key);
		this.requestRender(View.MODEL_INVALID | View.LAYOUT_INVALID);
	},

	// updateValue: function(key) {
	// 	return this._interpolator.updateValue(key || this.defaultKey);
	// },

	/* --------------------------- *
	/* redraw
	/* --------------------------- */

	redraw: function(context, changed) {},

}, {
	setStyle: function(ctx, s) {
		if (typeof s != "object") return;
		for (var p in s) {
			switch (typeof ctx[p]) {
				case "undefined":
					break;
				case "function":
					if (Array.isArray(s[p])) ctx[p].apply(ctx, s[p]);
					else ctx[p].call(ctx, s[p]);
					break;
				default:
					ctx[p] = s[p];
			}
		}
	}
});

if (DEBUG) {
	CanvasView.prototype._logFlags = "";
}

module.exports = CanvasView;
}).call(this,true)

},{"app/control/Globals":34,"app/view/base/Interpolator":57,"app/view/base/View":60,"underscore":"underscore","utils/css/getBoxEdgeStyles":108}],57:[function(require,module,exports){
/**
 * @module app/view/base/Interpolator
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
/** @type {module:utils/ease/linear} */
var linear = require("utils/ease/linear");

/**
 * @constructor
 * @type {module:app/view/base/Interpolator}
 */
var Interpolator = function(values, maxValues) {
	this._valueData = {};
	this._maxValues = {};
	this._renderableKeys = [];

	var key, val, maxVal;
	for (key in values) {
		val = values[key];
		maxVal = maxValues[key] || null;
		// create value object and store it
		this._valueData[key] = this._initValue(val, 0, maxVal);
		// add maxValue to store
		this._maxValues[key] = maxVal;
		// add to next render list
		this._renderableKeys.push(key);
	}
	this._valuesChanged = this._renderableKeys.length > 0;
};

Interpolator.prototype = Object.create({

	/* --------------------------- *
	/* public interface
	/* --------------------------- */

	isAtTarget: function(key) {
		return this._renderableKeys.indexOf(key) === -1;
	},

	getValue: function(key) {
		return this._valueData[key]._value;
	},

	getRenderedValue: function(key) {
		return this._valueData[key]._renderedValue;
	},

	valueTo: function(value, duration, key) {
		var changed, dataObj = this._valueData[key];
		// console.log("%s::valueTo [%s]", "[interpolator]", key, value);
		if (Array.isArray(dataObj)) {
			changed = value.reduce(function(prevChanged, itemValue, i) {
				if (dataObj[i]) {
					dataObj[i] = this._initNumber(itemValue, duration, this._maxValues[key]);
					return true;
				} else {
					return this._setValue(itemValue, duration, dataObj[i]) || prevChanged;
				}
			}.bind(this), changed);
		} else {
			changed = this._setValue(value, duration, dataObj);
		}
		if (changed) {
			this._renderableKeys.indexOf(key) !== -1 || this._renderableKeys.push(key);
			this._valuesChanged = true;
			// this.render();
			// this.requestRender();
		}
		return this;
	},

	updateValue: function(key) {
		// Call _interpolateValue only if needed. _interpolateValue() returns false
		// once interpolation is done, in which case remove key from _renderableKeys.
		var kIndex = this._renderableKeys.indexOf(key);
		if (kIndex !== -1 && !this._interpolateValue(key)) {
			this._renderableKeys.splice(kIndex, 1);
			this._valuesChanged = this._renderableKeys.length > 0;
		}
		return this;
	},

	/* --------------------------- *
	/* private: valueData
	/* --------------------------- */

	_initValue: function(value, duration, maxVal) {
		if (Array.isArray(value)) {
			return value.map(function(val) {
				return this._initNumber(val, 0, maxVal);
			}, this);
		} else {
			return this._initNumber(value, 0, maxVal);
		}
	},

	// _initArray: function(value, duration, maxVal) {
	// 	return val.map(function(val) {
	// 		return this._initNumber(val, 0, maxVal);
	// 	}, this);
	// },

	_initNumber: function(value, duration, maxVal) {
		var o = {};
		o._value = value;
		o._startValue = value;
		o._valueDelta = 0;

		o._duration = duration || 0;
		o._startTime = -1;
		o._elapsedTime = 0;

		o._lastRenderedValue = o._renderedValue = null;

		o._maxVal = maxVal;
		// if (maxVal !== void 0) o._maxVal = maxVal;
		// o._maxVal = this._maxValues[key];
		// o._maxVal = this._maxVal;// FIXME
		return o;
	},

	_setValue: function(value, duration, o) {
		if (o._value != value) {
			o._startValue = o._value;
			o._valueDelta = value - o._value;
			o._value = value;

			o._duration = duration || 0;
			o._startTime = -1;
			o._elapsedTime = 0;

			o._lastRenderedValue = o._renderedValue;

			return true;
		}
		return false;
	},

	/* --------------------------- *
	/* private: interpolate
	/* --------------------------- */

	/** @override */
	interpolate: function(tstamp) {
		if (this._valuesChanged) {
			this._valuesChanged = false;

			var changedKeys = this._renderableKeys;
			this._tstamp = tstamp;
			this._renderableKeys = changedKeys.filter(this._interpolateValue, this);
			this._renderedKeys = changedKeys;

			if (this._renderableKeys.length !== 0) {
				this._valuesChanged = true;
				// 	// this.requestRender();
			}
		}
		// console.log("%s::interpolate valuesChanged:%s tstamp:%f", "[interpolator]", this._valuesChanged, tstamp);
		// return this._valuesChanged;
		// return this.valuesChanged;

		return this;
	},

	_interpolateValue: function(key) {
		var dataObj = this._valueData[key];
		if (Array.isArray(dataObj)) {
			return dataObj.reduce(function(continueNext, o, index, arr) {
				return this._interpolateNumber(this._tstamp, o) || continueNext;
			}.bind(this), false);
		} else {
			return this._interpolateNumber(this._tstamp, dataObj);
		}
	},

	_interpolateNumber: function(tstamp, o) {
		if (o._startTime < 0) {
			o._startTime = tstamp;
		}
		var elapsed = tstamp - o._startTime;
		o._elapsedTime = elapsed;
		o._lastRenderedValue = o._renderedValue;
		if (elapsed < o._duration) {
			if (o._maxVal && o._valueDelta < 0) {
				// upper-bound values
				o._renderedValue = linear(elapsed, o._startValue,
					o._valueDelta + o._maxVal, o._duration) - o._maxVal;
			} else {
				// unbound values
				o._renderedValue = linear(elapsed, o._startValue,
					o._valueDelta, o._duration);
			}
			return true;
		} else {
			o._renderedValue = o._value;
			return false;
		}
	},
}, {
	valuesChanged: {
		get: function() {
			return this._valuesChanged;
		}
	},
	renderableKeys: {
		get: function() {
			return this._renderableKeys;
		}
	},
	renderedKeys: {
		get: function() {
			return this._renderedKeys;
		}
	},
});

module.exports = Interpolator;
},{"utils/ease/linear":109}],58:[function(require,module,exports){
(function (DEBUG){
/** @type {module:utils/prefixedEvent} */
var prefixedEvent = require("utils/prefixedEvent");

var eventMap = {
	"transitionend": prefixedEvent("transitionend"),
	"fullscreenchange": prefixedEvent("fullscreenchange", document),
	"fullscreenerror": prefixedEvent("fullscreenerror", document),
	"visibilitychange": prefixedEvent("visibilitychange", document, "hidden")
};

var eventNum = 0;
for (var eventName in eventMap) {
	if (eventName === eventMap[eventName]) {
		delete eventMap[eventName];
	} else {
		Object.defineProperty(eventMap, eventName, {
			value: eventMap[eventName],
			enumerable: true
		});
		Object.defineProperty(eventMap, eventNum, {
			value: eventName,
			enumerable: false
		});
		eventNum++;
	}
}
Object.defineProperty(eventMap, "length", {
	value: eventNum
});

if (DEBUG) {
	console.log("prefixes enabled for %i events", eventMap.length, Object.keys(eventMap));
}

module.exports = eventMap;

// module.exports = eventNum > 0? eventMap : null;

}).call(this,true)

},{"utils/prefixedEvent":112}],59:[function(require,module,exports){
/**
 * @module app/view/base/TouchManager
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
/** @type {module:hammerjs} */
var Hammer = require("hammerjs");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

/** @type {module:hammerjs.Tap} */
var Tap = Hammer.Tap;
/** @type {module:utils/touch/SmoothPanRecognizer} */
var Pan = require("utils/touch/SmoothPanRecognizer");
// /** @type {module:hammerjs.Pan} */
// var Pan = Hammer.Pan;

/* -------------------------------
/* Static private
/* ------------------------------- */

/**
 * @param el HTMLElement
 * @return {Hammer.Manager}
 */
function createInstance(el) {
	var manager, hpan, vpan, tap;
	hpan = new Pan({
		// threshold: Globals.PAN_THRESHOLD,
		// touchAction: "pan-y",
		direction: Hammer.DIRECTION_HORIZONTAL,
		event: "hpan",
	});
	vpan = new Pan({
		// threshold: Globals.PAN_THRESHOLD,
		// touchAction: "pan-x",
		direction: Hammer.DIRECTION_VERTICAL,
		event: "vpan",
	});
	tap = new Tap({
		// threshold: Globals.PAN_THRESHOLD - 1
	});
	manager = new Hammer.Manager(el);
	// manager.set({ domevents: true });
	manager.add([tap, hpan, vpan]);
	// manager.add([hpan, vpan]);
	vpan.requireFailure(hpan);
	// manager.add(hpan);
	return manager;
}

// function createInstance(el) {
// 	return new Hammer(el, {
// 		recognizers: [
// 			[Tap],
// 			[Pan, {
// 				event: 'hpan',
// 				direction: Hammer.DIRECTION_HORIZONTAL,
// 				threshold: Globals.THRESHOLD
// 			}],
// 			[Pan, {
// 				event: 'vpan',
// 				direction: Hammer.DIRECTION_VERTICAL,
// 				threshold: Globals.THRESHOLD
// 			}, ['hpan']]
// 		]
// 	});
// }

// function createInstance(el) {
// 	var recognizers = [];
// 	var manager = new Hammer.Manager(el);
//
// 	var hpan = new Pan({
// 		event: "hpan",
// 		threshold: Globals.THRESHOLD,
// 		direction: Hammer.DIRECTION_HORIZONTAL
// 	});
//
// 	var vpan = new Pan({
// 		event: "vpan",
// 		threshold: Globals.THRESHOLD,
// 		direction: Hammer.DIRECTION_VERTICAL
// 	});
//
// 	var tap = new Hammer.Tap();
// 	// var tap = new Hammer.Tap({
// 	// 	threshold: Globals.THRESHOLD - 1,
// 	// 	interval: 50,
// 	// 	time: 200
// 	// });
// 	recognizers.push(vpan);
// 	recognizers.push(hpan);
// 	recognizers.push(tap);
// 	manager.add(recognizers);
//
// 	hpan.recognizeWith([vpan]);
// 	hpan.requireFailure([vpan]);
// 	tap.recognizeWith([vpan, hpan]);
//
// 	// tap.requireFailure(vpan);
//
// 	// manager.set({ domevents: true });
// 	return manager;
// }

/*https://gist.githubusercontent.com/jtangelder/361052976f044200ea17/raw/f54c2cef78d59da3f38286fad683471e1c976072/PreventGhostClick.js*/

// function	logEvent(message) {
// 	console.log(message, domev.type,
// 		"panSessionOpened: " + panSessionOpened,
// 		"defaultPrevented: " + domev.defaultPrevented
// 	);
// }

var lastTimeStamp = -1;
var panSessionOpened = false;
var upEventName = window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup";

var touchHandlers = {};
touchHandlers["vpanstart vpanend vpancancel hpanstart hpanend hpancancel"] = function(hev) {
	// console.log("TouchManager:[%s]", hev.srcEvent.type);
	panSessionOpened = !hev.isFinal;
	if (hev.isFinal)
		lastTimeStamp = hev.srcEvent.timeStamp;
};
// touchHandlers["hammer.input tap vpanmove hpanmove"] = function(hev) {
// 	console.log("TouchManager:[%s -> %s]", hev.srcEvent.type, hev.type);
// };

var captureHandlers = {};
captureHandlers["click"] = function(domev) {
	if (lastTimeStamp == domev.timeStamp) {
		lastTimeStamp = -1;
		domev.defaultPrevented || domev.preventDefault();
		domev.stopPropagation();
	}
};
captureHandlers["dragstart"] = function(domev) {
	if (domev.target.nodeName == "IMG") {
		domev.defaultPrevented || domev.preventDefault();
	}
};
captureHandlers[upEventName] = function(domev) {
	panSessionOpened && domev.preventDefault();
};

var bubblingHandlers = {};

// -------------------------------
//
// -------------------------------

function addHandlers() {
	var eventName, el = instance.element;
	for (eventName in touchHandlers)
		if (touchHandlers.hasOwnProperty(eventName))
			instance.on(eventName, touchHandlers[eventName]);
	for (eventName in captureHandlers)
		if (captureHandlers.hasOwnProperty(eventName))
			el.addEventListener(eventName, captureHandlers[eventName], true);
	for (eventName in bubblingHandlers)
		if (bubblingHandlers.hasOwnProperty(eventName))
			el.addEventListener(eventName, bubblingHandlers[eventName], false);
}

function removeHandlers() {
	var eventName, el = instance.element;
	for (eventName in captureHandlers)
		if (captureHandlers.hasOwnProperty(eventName))
			el.removeEventListener(eventName, captureHandlers[eventName], true);
	for (eventName in bubblingHandlers)
		if (captureHandlers.hasOwnProperty(eventName))
			el.removeEventListener(eventName, bubblingHandlers[eventName], true);
}

/** @type {Hammer.Manager} */
var instance = null;

/* -------------------------------
/* Static public
/* ------------------------------- */

var TouchManager = {
	init: function(target) {
		if (instance === null) {
			instance = createInstance(target);
			addHandlers();
		} else if (instance.element !== target) {
			console.warn("TouchManager already initialized with another element");
		}
		return instance;
	},

	destroy: function() {
		if (instance !== null) {
			removeHandlers();
			instance.destroy();
			instance = null;
		} else {
			console.warn("no instance to destroy");
		}
	},

	getInstance: function() {
		if (instance === null) {
			console.error("TouchManager has not been initialized");
		}
		return instance;
	}
};

module.exports = TouchManager;
},{"app/control/Globals":34,"hammerjs":"hammerjs","utils/touch/SmoothPanRecognizer":120}],60:[function(require,module,exports){
(function (DEBUG){
/* global HTMLElement, MutationObserver */
/**
 * @module app/view/base/View
 */

/** @type {module:backbone} */
var Backbone = require("backbone");
/** @type {module:underscore} */
var _ = require("underscore");

/* -------------------------------
/* MutationObserver
/* ------------------------------- */

var _cidSeed = 1;
var _viewsByCid = {};

function addChildViews(el) {
	var view, els = el.querySelectorAll("*[data-cid]");
	for (var i = 0, ii = els.length; i < ii; i++) {
		view = View.findByElement(els.item(i));
		if (view) {
			if (!view.attached) {
				// console.log("View::[attached (parent)] %s", view.cid);
				view._elementAttached();
				// } else {
				// 	console.warn("View::[attached (parent)] %s (ignored)", view.cid);
			}
		}
	}
}

function removeChildViews(el) {
	var view, els = el.querySelectorAll("*[data-cid]");
	for (var i = 0, ii = els.length; i < ii; i++) {
		view = View.findByElement(els.item(i));
		if (view) {
			if (view.attached) {
				console.log("View::[detached (parent)] %s", view.cid);
				view._elementDetached();
			} else {
				console.warn("View::[detached (parent)] %s (ignored)", view.cid);
			}
		}
	}
}

var observer = new MutationObserver(function(mm) {
	// console.log("View::mutations %s", JSON.stringify(mm, null, " "));
	var i, ii, m;
	var j, jj, e;
	var view;
	for (i = 0, ii = mm.length; i < ii; i++) {
		m = mm[i];
		if (m.type == "childList") {
			for (j = 0, jj = m.addedNodes.length; j < jj; j++) {
				e = m.addedNodes.item(j);
				view = View.findByElement(e);
				if (view) {
					if (!view.attached) {
						// console.log("View::[attached (childList)] %s", view.cid);
						view._elementAttached();
						// } else {
						// 	console.warn("View::[attached (childList)] %s (ignored)", view.cid);
					}
				}
				if (e instanceof HTMLElement) addChildViews(e);
			}
			for (j = 0, jj = m.removedNodes.length; j < jj; j++) {
				e = m.removedNodes.item(j);
				// console.log("View::[detached (childList)] %s", e.cid);
				view = View.findByElement(e);
				if (view) {
					if (view.attached) {
						console.log("View::[detached (childList)] %s", view.cid, view.attached);
						view._elementDetached();
					} else {
						console.warn("View::[detached (childList)] %s (ignored)", view.cid, view.attached);
					}
				}
				if (e instanceof HTMLElement) removeChildViews(e);
			}
		} else if (m.type == "attributes") {
			view = View.findByElement(m.target);
			if (view) {
				if (!view.attached) {
					// console.log("View::[attached (attribute)] %s", view.cid);
					view._elementAttached();
					// } else {
					// 	console.warn("View::[attached (attribute)] %s (ignored)", view.cid);
				}
			}
			// else {
			// 	console.warn("View::[attributes] target has no cid (%s='%s')", m.attributeName, m.target.getAttribute(m.attributeName), m);
			// }
		}
	}
});

observer.observe(document.body, {
	attributes: true,
	childList: true,
	subtree: true,
	attributeFilter: ["data-cid"]
});

/* -------------------------------
/* static private
/* ------------------------------- */

var _now = window.performance ?
	window.performance.now.bind(window.performance) :
	Date.now.bind(Date);
// var _now = window.performance?
// 	function() { return window.performance.now(); }:
// 	function() { return Date.now(); };

// /** @type {module:app/view/base/renderQueue} */
// var renderQueue = require("app/view/base/renderQueue");
//
/** @type {module:app/view/base/CallbackQueue} */
var renderQueue = (function(CallbackQueue) {
	return new CallbackQueue(
		function(callback) {
			return window.requestAnimationFrame(callback);
		},
		function(id) {
			return window.cancelAnimationFrame(id);
		}
	);
})(require("app/view/base/CallbackQueue"));

/** @type {module:app/view/base/CallbackQueue} */
var modelQueue = (function(CallbackQueue) {
	return new CallbackQueue(
		function(callback) {
			return window.setImmediate(function() {
				callback.call(null, _now());
			});
		},
		function(id) {
			return window.clearImmediate(id);
		}
	);
})(require("app/view/base/CallbackQueue"));

/** @type {module:app/view/base/PrefixedEvents} */
var PrefixedEvents = require("app/view/base/PrefixedEvents");

var applyEventPrefixes = function(events) {
	var selector, unprefixed;
	for (selector in events) {
		unprefixed = selector.match(/^\w+/i)[0];
		if (PrefixedEvents.hasOwnProperty(unprefixed)) {
			events[selector.replace(unprefixed, PrefixedEvents[unprefixed])] = events[selector];
			// console.log("applyEventPrefixes", unprefixed, prefixedEvents[unprefixed]);
			delete events[selector];
		}
	}
	return events;
};

var getViewDepth = function(view) {
	if (!view) {
		return null;
	}
	if (!view.attached) {
		return NaN;
	}
	if (view.parentView === null) {
		return 0;
	}
	return view.parentView.viewDepth + 1;
};

function logAttachInfo(view, name, level) {
	if (["log", "info", "warn", "error"].indexOf(level) != -1) {
		level = "log";
	}
	console[level].call(console, "%s::%s [parent:%s %s %s depth:%s]", view.cid, name, view.parentView && view.parentView.cid, view.attached ? "attached" : "detached", view._viewPhase, view.viewDepth);
}

/* -------------------------------
/* static public
/* ------------------------------- */


var View = {

	/** @const */
	NONE_INVALID: 0,
	/** @const */
	CHILDREN_INVALID: 1,

	/** @const */
	MODEL_INVALID: 2,
	/** @const */
	STYLES_INVALID: 4,
	/** @const */
	SIZE_INVALID: 8,
	/** @const */
	LAYOUT_INVALID: 16,

	/** @const */
	// RENDER_INVALID: 8 | 16,

	/** @type {module:app/view/base/ViewError} */
	ViewError: require("app/view/base/ViewError"),

	/** @type {module:utils/prefixedProperty} */
	prefixedProperty: require("utils/prefixedProperty"),

	/** @type {module:utils/prefixedStyleName} */
	prefixedStyleName: require("utils/prefixedStyleName"),

	/** @type {module:utils/prefixedEvent} */
	prefixedEvent: require("utils/prefixedEvent"),

	// /** @type {module:utils/setImmediate} */
	// setImmediate: require("utils/setImmediate"),

	/** @type {module:app/view/promise/whenViewIsAttached} */
	whenViewIsAttached: require("app/view/promise/whenViewIsAttached"),


	/** @type {module:app/view/promise/whenViewIsRendered} */
	whenViewIsRendered: require("app/view/promise/whenViewIsRendered"),

	/**
	/* @param el {HTMLElement}
	/* @return {module:app/view/base/View}
	/*/
	findByElement: function(el) {
		if (_viewsByCid[el.cid]) {
			return _viewsByCid[el.cid];
		}
		return null;
	},

	/**
	/* @param el {HTMLElement}
	/* @return {module:app/view/base/View}
	/*/
	findByDescendant: function(el) {
		do {
			if (_viewsByCid[el.cid]) {
				return _viewsByCid[el.cid];
			}
		} while ((el = el.parentElement || el.parentNode));
		return null;
	},

	/** @override */
	extend: function(proto, obj) {
		if (PrefixedEvents.length && proto.events) {
			if (_.isFunction(proto.events)) {
				proto.events = _.wrap(proto.events, function(fn) {
					return applyEventPrefixes(fn.apply(this));
				});
			} else
			if (_.isObject(proto.events)) {
				proto.events = applyEventPrefixes(proto.events);
			}
		}
		if (proto.properties && this.prototype.properties) {
			_.defaults(proto.properties, this.prototype.properties);
		}
		return Backbone.View.extend.apply(this, arguments);
	},

	_flagsToStrings: ["-"],

	flagsToString: function(flags) {
		var s = View._flagsToStrings[flags | 0];
		if (!s) {
			s = [];
			if (flags & View.CHILDREN_INVALID) s.push("children");
			if (flags & View.MODEL_INVALID) s.push("model");
			if (flags & View.STYLES_INVALID) s.push("styles");
			if (flags & View.SIZE_INVALID) s.push("size");
			if (flags & View.LAYOUT_INVALID) s.push("layout");
			View._flagsToStrings[flags] = s = s.join(" ");
		}
		return s;
		// return (flags | 0).toString(2);
	},
};

Object.defineProperty(View, "instances", {
	value: _viewsByCid,
	enumerable: true
});

/* -------------------------------
/* prototype
/* ------------------------------- */

// module.exports = Backbone.View.extend({
var ViewProto = {

	/** @type {string} */
	cidPrefix: "view",
	/** @type {Boolean} */
	_attached: false,
	/** @type {HTMLElement|null} */
	_parentView: null,
	/** @type {int|null} */
	_viewDepth: null,
	/** @type {string} initializing > initialized > disposing > disposed */
	_viewPhase: "initializing",
	/** @type {int} */
	_renderQueueId: -1,
	/** @type {int} */
	_renderFlags: 0,
	/** @type {Boolean} */
	_enabled: null,

	/** @type {object} */
	properties: {
		cid: {
			get: function() {
				return this._cid || (this._cid = this.cidPrefix + _cidSeed++);
			}
		},
		attached: {
			get: function() {
				return this._attached;
			}
		},
		parentView: {
			get: function() {
				return this._parentView;
			}
		},
		viewDepth: {
			get: function() {
				return this._getViewDepth();
			}
		},
		invalidated: {
			get: function() {
				return this._renderQueueId !== -1;
			}
		},
		enabled: {
			get: function() {
				return this._enabled;
			},
			set: function(enabled) {
				this.setEnabled(enabled);
			}
		},
		renderFlags: {
			get: function() {
				return this._renderFlags;
			}
		}
	},

	/**
	 * @constructor
	 * @type {module:app/view/base/View}
	 */
	constructor: function(options) {
		this.transform = {};
		this.childViews = {};
		this._applyRender = this._applyRender.bind(this);

		if (this.properties) {
			// Object.defineProperties(this, getPrototypeChainValue(this, "properties", Backbone.View));
			Object.defineProperties(this, this.properties);
		}
		if (options && options.className && this.className) {
			options.className += " " + _.result(this, "className");
		}
		if (options && options.parentView) {
			this._setParentView(options.parentView, true);
		}
		Backbone.View.apply(this, arguments);

		// console.log("%s::initialize viewPhase:[%s => initialized]", this.cid, this._viewPhase);
		this._viewPhase = "initialized";

		if (this.parentView !== null) {
			this.trigger("view:parentChange", this.parentView, null);
		}
		if (this.attached) {
			this.trigger("view:attached", this);
		}
	},

	/* -------------------------------
	/* remove
	/* ------------------------------- */

	/** @override */
	remove: function() {
		if (this._viewPhase == "disposing") {
			logAttachInfo(this, "remove", "warn");
		} else {
			// logAttachInfo(this, "remove", "log");
		}

		// before removal
		this._viewPhase = "disposing";
		this._cancelRender();

		// call Backbone impl
		// Backbone.View.prototype.remove.apply(this, arguments);

		// NOTE: from Backbone impl
		this.$el.remove(); // from Backbone impl

		this._attached = false;
		this.trigger("view:removed", this);

		// remove parent/child references
		this._setParentView(null);

		// NOTE: from Backbone impl. No more events after this
		this.stopListening();

		// check for invalidations that may have been triggered by "view:removed"
		if (this.invalidated) {
			console.warn("%s::remove invalidated after remove()", this.cid);
			this._cancelRender();
		}
		// // check for children still here
		// var ccids = Object.keys(this.childViews);
		// if (ccids.length) {
		// 	console.warn("%s::remove %i children not removed [%s]", this.cid, ccids.length, ccids.join(", "), this.childViews);
		// }
		// // remove childViews
		// for (var cid in this.childViews) {
		// 	this.childViews[cid].remove();
		// }
		// clear reference in view map
		delete _viewsByCid[this.cid];
		// delete this.el.cid;
		// update phase
		this._viewPhase = "disposed";
		return this;
	},

	/* -------------------------------
	/* _elementAttached _elementDetached
	/* ------------------------------- */

	_elementAttached: function() {
		// this._addToParentView();
		this._attached = true;
		this._viewDepth = null;
		this._setParentView(View.findByDescendant(this.el.parentElement));

		// if (this.parentView) {
		// 	console.log("[attach] [%i] %s > %s::_elementAttached", this.viewDepth, this.parentView.cid, this.cid);
		// } else {
		// 	console.log("[attach] [%i] %s::_elementAttached", this.viewDepth, this.cid);
		// }

		// if (this._viewPhase == "initializing") {
		// 	// this.trigger("view:attached", this);
		// } else
		if (this._viewPhase == "initialized") {
			this.trigger("view:attached", this);
		} else
		if (this._viewPhase == "replacing") {
			this._viewPhase = "initialized";
			this.trigger("view:replaced", this);
		}
	},

	_elementDetached: function() {
		if (!this.attached || (this._viewPhase == "disposing") || (this._viewPhase == "disposed")) {
			logAttachInfo(this, "_elementDetached", "error");
			// } else {
			// 	logAttachInfo(this, "_elementDetached", "log");
		}
		this._attached = false;
		this._viewDepth = null;

		if (this._viewPhase != "disposing" || this._viewPhase == "disposed") {
			this.remove();
		}
	},

	/* -------------------------------
	/* parentView
	/* ------------------------------- */

	_setParentView: function(newParent, silent) {
		if (newParent === void 0) {
			console.warn("$s::_setParentView invalid value '%s'", this.cid, newParent);
			newParent = null;
		}
		var oldParent = this._parentView;
		this._parentView = newParent;

		// force update of _viewDepth
		this._viewDepth = null; //getViewDepth(this);

		// skip the rest if arg is the same
		if (newParent === oldParent) {
			return;
		}
		if (oldParent !== null) {
			if (this.cid in oldParent.childViews) {
				delete oldParent.childViews[this.cid];
			}
		}
		if (newParent !== null) {
			newParent.childViews[this.cid] = this;
		}
		if (!silent)
			this.trigger("view:parentChange", this, newParent, oldParent);
	},

	whenAttached: function() {
		return View.whenViewIsAttached(this);
	},

	_getViewDepth: function() {
		if (this._viewDepth === null) {
			this._viewDepth = getViewDepth(this);
		}
		return this._viewDepth;
	},

	/* -------------------------------
	/* Backbone.View overrides
	/* ------------------------------- */

	/** @override */
	setElement: function(element, delegate) {
		// setElement always initializes this.el, so check it to be non-null before calling super
		if (this.el) {
			if (this.el !== element && this.el.parentElement) {
				// Element is being replaced
				if (this.attached) {
					// Since old element is attached to document tree, _elementAttached will be
					// triggered by replaceChild: set _viewPhase = "replacing" to flag this
					// change and trigger 'view:replaced' instead of 'view:added'.
					this._viewPhase = "replacing";
				}
				this.el.parentElement.replaceChild(element, this.el);
			}
			Backbone.View.prototype.setElement.apply(this, arguments);
			// Merge classes specified by this view with the ones already in the element,
			// as backbone will not:
			if (this.className) {
				_.result(this, "className").split(" ").forEach(function(item) {
					this.el.classList.add(item);
				}, this);
			}
		} else {
			Backbone.View.prototype.setElement.apply(this, arguments);
		}

		if (this.el === void 0) {
			throw new Error("Backbone view has no element");
		}
		_viewsByCid[this.cid] = this;
		this.el.cid = this.cid;
		this.el.setAttribute("data-cid", this.cid);

		return this;
	},

	/* -------------------------------
	/* requestAnimationFrame
	/* ------------------------------- */

	requestAnimationFrame: function(callback, priority, ctx) {
		return renderQueue.request(callback.bind(ctx || this), priority);
	},

	cancelAnimationFrame: function(id) {
		return renderQueue.cancel(id);
	},

	setImmediate: function(callback, priority, ctx) {
		return modelQueue.request(callback.bind(ctx || this), priority);
		// return window.setImmediate(callback.bind(ctx || this));
	},

	clearImmediate: function(id) {
		return modelQueue.cancel(id);
		// return window.clearImmediate(id);
	},

	/* -------------------------------
	/* deferred render: private methods
	/* ------------------------------- */

	_traceRenderStatus: function() {
		return [
			(this._renderQueueId != -1 ? "async id:" + this._renderQueueId : "sync"),
			View.flagsToString(this._renderFlags),
			(this.attached ? "attached" : "detached"),
			(this.skipTransitions ? "skip" : "run") + "-tx"
		].join(", ");
	},

	/** @private */
	_applyRender: function(tstamp) {
		if (DEBUG) {
			if (this._logFlags["view.render"]) {
				console.log("%s::_applyRender   [%s]",
					this.cid, this._traceRenderStatus(),
					this._logFlags["view.trace"] ?
					this._logRenderCallers.join("\n") : "");
			}
			this._logRenderCallers.length = 0;
		}

		var flags = this._renderFlags;
		this.trigger("view:render:before", this, flags);
		this._renderFlags = 0;
		this._renderQueueId = -1;
		this._renderFlags |= this.renderFrame(tstamp, flags);
		this.trigger("view:render:after", this, flags);

		if (this._renderFlags != 0) {
			console.warn("%s::_applyRender [returned] flags: %s", this.cid, View.flagsToString(this._renderFlags), this._renderFlags);
		}
	},

	_cancelRender: function() {
		if (this._renderQueueId != -1) {
			var cancelId, cancelFn;

			cancelId = this._renderQueueId;
			this._renderQueueId = -1;
			cancelFn = renderQueue.cancel(cancelId);

			if (cancelFn === void 0) {
				console.warn("%s::_cancelRender [id:%i] not found", this.cid, cancelId);
			} else if (cancelFn === null) {
				console.warn("%s::_cancelRender [id:%i] already cancelled", this.cid, cancelId);
				// } else {
				// 	if (this._logFlags["view.render"] && !renderQueue.running)
				// 		console.log("%s::_cancelRender ID:%i cancelled", this.cid, cancelId);
			}
		}
	},

	_requestRender: function() {
		if (renderQueue.running) {
			this._cancelRender();
			// if (DEBUG) {
			// 	if (this._logFlags["view.render"]) {
			// 		console.info("%s::_requestRender rescheduled [%s (%s)]", this.cid, View.flagsToString(this._renderFlags), this._renderFlags);
			// 	}
			// }
		}
		if (this._renderQueueId == -1) {
			this._renderQueueId = renderQueue.request(this._applyRender, isNaN(this.viewDepth) ? Number.MAX_VALUE : this.viewDepth);
		}
		if (DEBUG) {
			if (this._logFlags["view.render"]) {
				// if (this._logFlags["view.trace"]) {
				// 	console.groupCollapsed(this.cid + "::_requestRender [" + this._traceRenderStatus() + "] trace");
				// 	console.trace();
				// 	console.groupEnd();
				// } else {
				console.log("%s::_requestRender %s [%s]", this.cid,
					(renderQueue.running ? "rescheduled " : ""),
					this._traceRenderStatus()
				);
				// }
			}
		}
	},

	/* -------------------------------
	/* render: public / abstract methods
	/* ------------------------------- */

	invalidate: function(flags) {
		if (flags !== void 0) {
			/*if (DEBUG) {
				if (this._logFlags["view.render"]) {
					if (this._renderFlags > 0) {
						console.log("%s::invalidate [%s (%s)] + [%s (%s)]", this.cid, View.flagsToString(this._renderFlags), this._renderFlags, View.flagsToString(flags), flags);
					} else {
						console.log("%s::invalidate [%s (%s)]", this.cid, View.flagsToString(flags), flags);
					}
				}
			}*/
			this._renderFlags |= flags;
		}
		return this;
	},

	requestRender: function(flags) {
		// if (DEBUG) {
		// 	if (this._logFlags["view.trace"]) {
		// 		var fnPath = [];
		// 		var fn = arguments.callee.caller;
		// 		while (fn) {
		// 			if (fnPath.length > 5) break;
		// 			fnPath.push(fn.name);
		// 			fn = fn.caller;
		// 		}
		// 		// this._logRenderCallers.push(fnPath.join("\n\t->"));
		// 		this._logRenderCallers.push(fnPath.join(" -> "));
		// 	}
		// }
		// if (flags !== void 0) {
		// 	this._renderFlags |= flags;
		// }
		this.invalidate(flags);
		this._requestRender();
		return this;
	},

	/** @abstract */
	renderFrame: function(tstamp, flags) {
		// subclasses should override this method
		return View.NONE_INVALID;
	},

	renderNow: function(alwaysRun) {
		if (this._renderQueueId != -1) {
			this._cancelRender();
			alwaysRun = true;
		}
		// if (alwaysRun === true) {
		if (alwaysRun) {
			this._applyRender(_now());
		}
		return this;
	},

	whenRendered: function() {
		return View.whenViewIsRendered(this);
	},

	/* -------------------------------
	/* render bitwise flags
	/* - check: this._renderFlags & flags
	/* - add: this._renderFlags |= flags
	/* - remove: this._renderFlags &= ~flags
	/* ------------------------------- */

	/* helpers ------------------ */

	requestChildrenRender: function(flags, now, force) {
		var ccid, view;
		for (ccid in this.childViews) {
			view = this.childViews[ccid];
			view.skipTransitions = view.skipTransitions || this.skipTransitions;
			view.requestRender(flags);
			if (now) {
				view.renderNow(force);
			}
		}
		return this;
	},

	render: function() {
		return this.renderNow(true);
	},

	/* -------------------------------
	/* common abstract
	/* ------------------------------- */

	/**
	/* @param {Boolean}
	/*/
	setEnabled: function(enable) {
		this._enabled = enable;
	},
};
//, View);

if (DEBUG) {
	ViewProto._logFlags = [
		"view.render",
		// "view.trace"
	].join(" ");

	ViewProto.constructor = (function(fn) {
		return function() {
			var retval;
			this._logRenderCallers = [];
			this._logFlags = this._logFlags.split(" ").reduce(function(r, o) {
				r[o] = true;
				return r;
			}, {});
			retval = fn.apply(this, arguments);
			// console.log("------ %s %o", this.cid, this._logFlags);
			return retval;
		};
	})(ViewProto.constructor);
}

module.exports = Backbone.View.extend(ViewProto, View);
}).call(this,true)

},{"app/view/base/CallbackQueue":55,"app/view/base/PrefixedEvents":58,"app/view/base/ViewError":61,"app/view/promise/whenViewIsAttached":81,"app/view/promise/whenViewIsRendered":82,"backbone":"backbone","underscore":"underscore","utils/prefixedEvent":112,"utils/prefixedProperty":113,"utils/prefixedStyleName":114}],61:[function(require,module,exports){
function ViewError(view, err) {
	this.view = view;
	this.err = err;
	this.message = err.message;
}
ViewError.prototype = Object.create(Error.prototype);
ViewError.prototype.constructor = ViewError;
ViewError.prototype.name = "ViewError";

module.exports = ViewError;

},{}],62:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=container.escapeExpression, alias4="function";

  return "<a href=\""
    + alias3((helpers.global || (depth0 && depth0.global) || alias2).call(alias1,"APP_ROOT",{"name":"global","hash":{},"data":data}))
    + "#"
    + alias3(((helper = (helper = helpers.handle || (depth0 != null ? depth0.handle : depth0)) != null ? helper : alias2),(typeof helper === alias4 ? helper.call(alias1,{"name":"handle","hash":{},"data":data}) : helper)))
    + "\">"
    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias4 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</a>\n";
},"useData":true});

},{"hbsfy/runtime":20}],63:[function(require,module,exports){
/**
/* @module app/view/component/ArticleView
/*/

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {Function} */
var viewTemplate = require("./ArticleButton.hbs");

/**
/* @constructor
/* @type {module:app/view/component/ArticleButton}
/*/
var ArticleButton = View.extend({

	/** @type {string} */
	cidPrefix: "articleButton",
	/** @override */
	tagName: "h2",
	/** @override */
	className: "article-button",
	/** @type {Function} */
	template: viewTemplate,

	events: {
		"click a": function(domev) {
			domev.defaultPrevented || domev.preventDefault();
			this.trigger("view:click", this.model);
		}
	},

	// /** @override */
	// initialize: function(options) {},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		this.el.innerHTML = this.template(this.model.toJSON());
	},
});
module.exports = ArticleButton;
},{"./ArticleButton.hbs":62,"app/view/base/View":60}],64:[function(require,module,exports){
/**
/* @module app/view/component/ArticleView
/*/

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");

// /** @type {module:utils/net/toAbsoluteURL} */
// var toAbsoluteURL = require("utils/net/toAbsoluteURL");
//
// /** @type {string} */
// var ABS_APP_ROOT = toAbsoluteURL(require("app/control/Globals").APP_ROOT);

/**
/* @constructor
/* @type {module:app/view/component/ArticleView}
/*/
var ArticleView = View.extend({

	/** @type {string} */
	cidPrefix: "articleView",
	/** @override */
	tagName: "article",
	/** @override */
	className: "article-view mdown",

	/** @override */
	initialize: function(options) {},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		this.el.innerHTML = this.model.get("text");
		// FIXME: now done in xslt
		// this.el.querySelectorAll("a[href]").forEach(function(el) {
		// 	var url = toAbsoluteURL(el.getAttribute("href"));
		// 	if (url.indexOf(ABS_APP_ROOT) !== 0) {
		// 		el.setAttribute("target", "_blank");
		// 	}
		// });
	},
});
module.exports = ArticleView;
},{"app/view/base/View":60}],65:[function(require,module,exports){
/**
/* @module app/view/component/Carousel
/*/

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");

/** @type {module:hammerjs} */
var Hammer = require("hammerjs");
/** @type {module:utils/touch/SmoothPanRecognizer} */
var Pan = require("utils/touch/SmoothPanRecognizer");
/** @type {module:hammerjs.Tap} */
var Tap = Hammer.Tap;

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
// /** @type {module:app/view/base/DeferredView} */
// var View = require("app/view/base/DeferredView");

/** @type {module:app/view/render/CarouselRenderer} */
var CarouselRenderer = require("app/view/render/CarouselRenderer");

/** @type {module:utils/prefixedProperty} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {module:utils/prefixedStyleName} */
var prefixedStyleName = require("utils/prefixedStyleName");

var transformStyleName = prefixedStyleName("transform");
var transformProperty = prefixedProperty("transform");
var translateTemplate = Globals.TRANSLATE_TEMPLATE;

// var cssToPx = function(cssVal, el) {
// 	return parseInt(cssVal);
// };

// var defaultRendererFunction = (function() {
// 	var defaultRenderer = CarouselRenderer.extend({ className: "carousel-item default-renderer"}),
// 		emptyRenderer = CarouselRenderer.extend({ className: "carousel-item empty-renderer"});
// 	return function(item, index, arr) {
// 		return (index === -1)? emptyRenderer: defaultRenderer;
// 	};
// })();

/** @const */
var MAX_SELECT_THRESHOLD = 20;

// /** @const */
// var CHILDREN_INVALID = View.CHILDREN_INVALID,
// 	STYLES_INVALID = View.STYLES_INVALID,
// 	MODEL_INVALID = View.MODEL_INVALID,
// 	SIZE_INVALID = View.SIZE_INVALID,
// 	LAYOUT_INVALID = View.LAYOUT_INVALID;

var VERTICAL = Hammer.DIRECTION_VERTICAL,
	HORIZONTAL = Hammer.DIRECTION_HORIZONTAL;

// x: ["x", "y"],
// y: ["y", "x"],
// offsetLeft: ["offsetLeft", "offsetTop"],
// offsetTop: ["offsetTop", "offsetLeft"],
// offsetWidth: ["offsetWidth", "offsetHeight"],
// offsetHeight: ["offsetHeight", "offsetWidth"],
// width: ["width","height"],
// height: ["height","width"],
// marginLeft: ["marginLeft","marginTop"],
// marginRight: ["marginRight","marginBottom"],

/*
var HORIZONTAL_PROPS = {
	pos: "x",
	size: "width",
	offsetPos: "offsetLeft",
	offsetSize: "offsetWidth",
	marginBefore: "marginLeft",
	marginAfter: "marginRight",
};
var VERTICAL_PROPS = {
	pos: "y",
	size: "height",
	offsetPos: "offsetTop",
	offsetSize: "offsetHeight",
	marginBefore: "marginTop",
	marginAfter: "marginBottom",
};
*/

// var DIRECTION_NONE = 1;
// var DIRECTION_LEFT = 2;
// var DIRECTION_RIGHT = 4;
// var DIRECTION_UP = 8;
// var DIRECTION_DOWN = 16;

// function dirToStr(dir) {
// 	if (dir === Hammer.DIRECTION_NONE) return 'NONE';
// 	if (dir === Hammer.DIRECTION_LEFT) return 'LEFT';
// 	if (dir === Hammer.DIRECTION_RIGHT) return 'RIGHT';
// 	if (dir === Hammer.DIRECTION_UP) return 'UP';
// 	if (dir === Hammer.DIRECTION_DOWN) return 'DOWN';
// 	if (dir === Hammer.DIRECTION_HORIZONTAL) return 'HORIZONTAL';
// 	if (dir === Hammer.DIRECTION_VERTICAL) return 'VERTICAL';
// 	if (dir === Hammer.DIRECTION_ALL) return 'ALL';
// 	return 'UNRECOGNIZED';
// }

var isValidTouchManager = function(touch, direction) {
	// var retval;
	try {
		return touch.get("hpan").options.direction == direction;
	} catch (err) {
		return false;
	}
	// return retval;
};

// /** @type {int} In pixels */
// var panThreshold: 15;

var createTouchManager = function(el, dir, thres) {
	var touch = new Hammer.Manager(el);
	var pan = new Pan({
		event: "hpan",
		threshold: Globals.THRESHOLD,
		direction: Hammer.DIRECTION_HORIZONTAL,
	});
	var tap = new Tap({
		threshold: Globals.THRESHOLD - 1,
		interval: 50,
		time: 200,
	});
	tap.recognizeWith(pan);
	touch.add([pan, tap]);
	return touch;
};


var Carousel = {
	/** const */
	ANIMATED: false,
	/** const */
	IMMEDIATE: true,

	/** copy of Hammer.DIRECTION_VERTICAL */
	DIRECTION_VERTICAL: VERTICAL,
	/** copy of Hammer.DIRECTION_HORIZONTAL */
	DIRECTION_HORIZONTAL: HORIZONTAL,
	/** @type {Object} */
	defaults: {
		/** @type {boolean} */
		selectOnScrollEnd: false,
		/** @type {boolean} */
		requireSelection: false,
		/** @type {int} */
		direction: HORIZONTAL,
		/** @type {int} In pixels */
		selectThreshold: 20,
		/** @type {Function} */
		rendererFunction: (function() {
			var defaultRenderer = CarouselRenderer.extend({
					className: "carousel-item default-renderer"
				}),
				emptyRenderer = CarouselRenderer.extend({
					className: "carousel-item empty-renderer"
				});
			return function(item, index, arr) {
				return (index === -1) ? emptyRenderer : defaultRenderer;
			};
		})(),
	},
};
Carousel.validOptions = _.keys(Carousel.defaults);

/**
/* @constructor
/* @type {module:app/view/component/Carousel}
/*/
var CarouselProto = {

	/** @override */
	cidPrefix: "carousel",
	/** @override */
	tagName: "div",
	/** @override */
	className: "carousel skip-transitions",

	/* --------------------------- *
	/* properties
	/* --------------------------- */

	properties: {
		scrolling: {
			get: function() {
				return this._scrolling;
			}
		},
		selectedItem: {
			get: function() {
				return this._selectedView.model;
			},
			set: function(value) {
				if (value)
					this._onSelectOne(value)
				else
					this._onSelectNone();
			}
		},
	},

	events: {
		// "mousedown": "_onMouseDown", "mouseup": "_onMouseUp",
		"transitionend .carousel-item.selected": "_onScrollTransitionEnd",
	},

	/** @override */
	initialize: function(options) {
		_.bindAll(this, "_onTouchEvent");

		this.itemViews = new Container();
		this.metrics = {};

		_.extend(this, _.defaults(_.pick(options, Carousel.validOptions), Carousel.defaults));

		// this.childGap = 0; //this.dirProp(20, 18);
		this._precedingDir = (Hammer.DIRECTION_LEFT | Hammer.DIRECTION_UP) & this.direction;
		this._followingDir = (Hammer.DIRECTION_RIGHT | Hammer.DIRECTION_DOWN) & this.direction;

		// use supplied touch mgr or create private
		if (isValidTouchManager(options.touch, this.direction)) {
			this.touch = options.touch;
		} else {
			console.warn("%s::initialize creating Hammer instance", this.cid);
			this.touch = createTouchManager(this.el, this.direction);
			// this.on("view:removed", this.touch.destroy, this.touch);
			this.listenTo(this, "view:removed", function() {
				this.touch.destroy();
			});
		}

		/* create children and props */
		this.setEnabled(true);
		this.skipTransitions = true;
		this._renderFlags = View.CHILDREN_INVALID;
		// this.invalidateChildren();

		this.listenTo(this, "view:attached", function() {
			this.skipTransitions = true;
			// this.invalidateSize();
			// this.renderNow();
			// this.requestRender();
			this.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
		});

		/* collection listeners */
		this.listenTo(this.collection, {
			"reset": this._onReset,
			"select:one": this._onSelectOne,
			"select:none": this._onSelectNone,
			"deselect:one": this._onDeselectAny,
			"deselect:none": this._onDeselectAny,
		});
	},
	/* --------------------------- *
	/* Hammer init
	/* --------------------------- */

	// validateTouchManager: function(touch, direction) {
	// 	try {
	// 		return touch.get("pan").options.direction === direction);
	// 	} catch (err) {
	// 		return false;
	// 	}
	// },

	// initializeHammer: function(options) {
	// 	// direction from opts/defaults
	// 	if (options.direction === VERTICAL) {
	// 		this.direction = VERTICAL;
	// 	} // do nothing: the default is horizontal
	//
	// 	// validate hammer instance or create local
	// 	if ((touch = options.touch) && (pan = touch.get("pan"))) {
	// 		// Override direction only if specific
	// 		if (pan.options.direction !== Hammer.DIRECTION_ALL) {
	// 			this.direction = pan.options.direction;
	// 		}
	// 		this.panThreshold = pan.options.threshold;
	// 	} else {
	// 		console.warn("%s::initializeHammer using private Hammer instance", this.cid);
	// 		touch = createHammerInstance(this.el, this.panThreshold, this.direction);
	// 		this.on("view:removed", touch.destroy, touch);
	// 	}
	// 	this.touch = touch;
	// },

	remove: function() {
		// this._scrollPendingAction && this._scrollPendingAction(true);
		// if (this._enabled) {
		// 	this.touch.off("tap", this._onTap);
		// 	this.touch.off("hpanstart hpanmove hpanend hpancancel", this._onPan);
		// }
		this._toggleTouchEvents(false);
		this.removeChildren();
		View.prototype.remove.apply(this, arguments);
		return this;
	},


	/* --------------------------- *
	/* helper functions
	/* --------------------------- */

	dirProp: function(hProp, vProp) {
		return (this.direction & HORIZONTAL) ? hProp : vProp;
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	// render: function() {
	// 	if (this.attached) {
	// 		this.skipTransitions = true;
	// 		// this.invalidateSize();
	// 		this.renderNow(true);
	// 	}
	// },

	// /** @override */
	// render: function () {
	// 	if (!this.attached) {
	// 		if (!this._renderPending) {
	// 			this._renderPending = true;
	// 			this.listenTo(this, "view:attached", this.render);
	// 		}
	// 	} else {
	// 		if (this._renderPending) {
	// 			this._renderPending = false;
	// 			this.stopListening(this, "view:attached", this.render);
	// 		}
	// 		this._delta = 0;
	// 		this.skipTransitions = true;
	// 		this.invalidateSize();
	// 		// this.invalidateLayout();
	// 		this.renderNow();
	// 	}
	// 	return this;
	// },

	// render: function () {
	// 	this.measureLater();
	// 	this.scrollBy(0, Carousel.IMMEDIATE);
	//
	// 	if (this.el.parentElement) {
	// 		this.renderNow();
	// 	}
	// 	return this;
	// },

	/** @override */
	renderFrame: function(tstamp, flags) {
		if (flags & View.CHILDREN_INVALID) {
			this._createChildren();
			// clear this flag now: render may be deferred until attached
			flags &= ~View.CHILDREN_INVALID;
		}
		if (this.attached) {
			if (flags & View.SIZE_INVALID) {
				this._measure();
			}
			if (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {
				this._scrollBy(this._delta, this.skipTransitions);
			}
		} else if (flags) {
			this.listenToOnce(this, "view:attached", function() {
				this.requestRender(flags);
			});
		}
	},

	/* --------------------------- *
	/* enabled
	/* --------------------------- */

	// /** @override */
	// _enabled: undefined,

	/** @override */
	setEnabled: function(enabled) {
		if (this._enabled !== enabled) {
			this._enabled = enabled;
			// toggle events immediately
			this._toggleTouchEvents(enabled);
			// dom manipulation on render (_renderEnabled)
			// this._renderFlags |= View.STYLES_INVALID;
			// this.requestRender();

			this.el.classList.toggle("disabled", !this.enabled);
			this.itemViews.each(function(view) {
				view.setEnabled(this.enabled);
			}, this);
		}
	},

	_renderEnabled: function() {
		this.el.classList.toggle("disabled", !this.enabled);
		this.itemViews.each(function(view) {
			view.setEnabled(this.enabled);
		}, this);
	},

	/* --------------------------- *
	/* Create children
	/* --------------------------- */

	_createChildren: function() {
		// var sIndex;
		var buffer, renderer, view, viewOpts;

		this.removeChildren();

		if (this.collection.length) {
			viewOpts = {
				// viewDepth: this.viewDepth + 1,
				// parentView: this,
				enabled: this.enabled
			};
			buffer = document.createDocumentFragment();
			// buffer = this.el;

			if (!this.requireSelection) {
				renderer = this.rendererFunction(null, -1, this.collection);
				view = new renderer(viewOpts);
				this.itemViews.add(view);
				buffer.appendChild(view.el);
				this.emptyView = view;
			}

			this.collection.each(function(item, index, arr) {
				viewOpts.model = item;
				renderer = this.rendererFunction(item, index, arr);
				view = new renderer(viewOpts);
				this.itemViews.add(view);
				buffer.appendChild(view.el);
			}, this);

			// if (!this.requireSelection) {
			// 	buffer = this.appendItemView(buffer, this.model, -1, this.collection);
			// 	this.emptyView = this.itemViews.first();
			// }
			// buffer = this.collection.reduce(this.appendItemView, buffer, this);

			this.adjustToSelection();
			this._selectedView.el.classList.add("selected");

			this.el.appendChild(buffer);
		}
	},

	// appendItemView: function (parentEl, model, index, arr) {
	// 	var renderer = this.rendererFunction(model, index, arr);
	// 	var view = new renderer({
	// 		model: model,
	// 		parentView: this,
	// 		enabled: this.enabled
	// 	});
	// 	this.itemViews.add(view);
	// 	parentEl.appendChild(view.el);
	// 	return parentEl;
	// },

	// createItemView: function (renderer, opts) {
	// 	var view = new renderer(opts);
	// 	this.itemViews.add(view);
	// 	return view;
	// },

	removeChildren: function() {
		this.itemViews.each(this.removeItemView, this);
		this.emptyView = void 0;
	},

	removeItemView: function(view) {
		this.itemViews.remove(view);
		view.remove();
		return view;
	},

	/* --------------------------- *
	/* measure
	/* --------------------------- */

	_measure: function() {
		var m, mm;
		var pos = 0,
			posInner = 0;
		var maxAcross = 0,
			maxOuter = 0;
		var maxOuterView, maxAcrossView;

		maxOuterView = maxAcrossView = this.emptyView || this.itemViews.first();

		// chidren metrics
		this.itemViews.each(function(view) {
			view.render();
		});

		this.itemViews.each(function(view) {
			m = this.measureItemView(view);
			m.pos = pos;
			pos += m.outer; // + this.childGap;
			m.posInner = posInner;
			posInner += m.inner; //+ this.childGap;
			if (view !== this.emptyView) {
				if (m.across > maxAcross) {
					maxAcross = m.across;
					maxAcrossView = view;
				}
				if (m.outer > maxOuter) {
					maxOuter = m.outer;
					maxOuterView = view;
				}
			}
		}, this);

		// measure self + max child metrics
		mm = this.metrics[this.cid] || (this.metrics[this.cid] = {});
		mm.outer = this.el[this.dirProp("offsetWidth", "offsetHeight")];
		mm.before = maxOuterView.el[this.dirProp("offsetLeft", "offsetTop")];
		mm.inner = maxOuterView.el[this.dirProp("offsetWidth", "offsetHeight")];
		mm.after = mm.outer - (mm.inner + mm.before);
		mm.across = maxAcross;

		// m = this.metrics[maxOuterView.cid];
		// mm.inner = m.inner;

		// tap area
		this._tapAcrossBefore = maxAcrossView.el[this.dirProp("offsetTop", "offsetLeft")];
		this._tapAcrossAfter = this._tapAcrossBefore + maxAcross;
		this._tapBefore = mm.before + this._tapGrow;
		this._tapAfter = mm.before + mm.inner - this._tapGrow;

		this.selectThreshold = Math.min(MAX_SELECT_THRESHOLD, mm.outer * 0.1);
	},

	measureItemView: function(view) {
		var m, viewEl;
		// var s, sizeEl;

		viewEl = view.el;
		m = this.metrics[view.cid] || (this.metrics[view.cid] = {});

		m.outer = viewEl[this.dirProp("offsetWidth", "offsetHeight")];
		m.across = viewEl[this.dirProp("offsetHeight", "offsetWidth")];

		if (view.metrics) {
			m.before = view.metrics[this.dirProp("marginLeft", "marginTop")];
			m.outer += m.before;
			m.outer += view.metrics[this.dirProp("marginRight", "marginBottom")];
			m.inner = view.metrics.content[this.dirProp("width", "height")];
			m.before += view.metrics.content[this.dirProp("x", "y")];
			m.after = m.outer - (m.inner + m.before);

			// var marginBefore = view.metrics[this.dirProp("marginLeft","marginTop")];
			// var marginAfter = view.metrics[this.dirProp("marginRight","marginBottom")];
			// var pos = view.metrics.content[this.dirProp("x","y")];
			//
			// m.inner = view.metrics.content[this.dirProp("width","height")];
			// m.before = marginBefore + pos;
			// m.outer += marginBefore + marginAfter;
			// m.after = m.outer - (m.inner + m.before);
		} else {
			// throw new Error("renderer has no metrics");
			console.warn("%s::measureItemView view '%s' has no metrics", this.cid, view.cid);
			m.inner = m.outer;
			m.after = m.before = 0;
		}

		return m;
	},

	/* --------------------------- *
	/* scrolling property
	/* --------------------------- */

	_delta: 0,

	_scrolling: false,

	_setScrolling: function(scrolling) {
		// console.warn("_setScrolling current/requested", this._scrolling, scrolling);
		if (this._scrolling != scrolling) {
			this._scrolling = scrolling;
			this.el.classList.toggle("scrolling", scrolling);
			this.trigger(scrolling ? "view:scrollstart" : "view:scrollend");
		}
	},

	/* --------------------------- *
	/* Scroll/layout
	/* --------------------------- */

	scrollBy: function(delta, skipTransitions) {
		this._delta = delta || 0;
		this.skipTransitions = !!skipTransitions;
		// this.invalidateLayout();
		this.requestRender(View.LAYOUT_INVALID);
	},

	_scrollBy: function(delta, skipTransitions) {
		var sMetrics, metrics, pos;

		sMetrics = this.metrics[(this._scrollCandidateView || this._selectedView).cid];
		this.itemViews.each(function(view) {
			metrics = this.metrics[view.cid];
			pos = Math.floor(this._getScrollOffset(delta, metrics, sMetrics));
			view.metrics.translateX = (this.direction & HORIZONTAL) ? pos : 0;
			view.metrics.translateY = (this.direction & HORIZONTAL) ? 0 : pos;
			view.metrics._transform = translateTemplate(view.metrics.translateX, view.metrics.translateY);
			view.el.style[transformProperty] = view.metrics._transform;
			// view.el.style[transformProperty] = (this.direction & HORIZONTAL)?
			// 	"translate3d(" + pos + "px,0,0)":
			// 	"translate3d(0," + pos + "px,0)";
		}, this);

		this.el.classList.toggle("skip-transitions", skipTransitions);
		this.selectFromView();
	},

	_getScrollOffset: function(delta, mCurr, mSel) {
		var pos, offset = 0;

		pos = mCurr.pos - mSel.pos + delta;
		if (pos < 0) {
			if (Math.abs(pos) < mSel.outer) {
				offset += (-mCurr.after) / mSel.outer * pos;
			} else {
				offset += mCurr.after;
			}
		} else
		if (0 <= pos) {
			if (Math.abs(pos) < mSel.outer) {
				offset -= mCurr.before / mSel.outer * pos;
			} else {
				offset -= mCurr.before;
			}
		}
		return pos + offset;
	},

	_onScrollTransitionEnd: function(ev) {
		if (ev.propertyName === transformStyleName && this.scrolling) {
			console.log("%s::_onScrollTransitionEnd selected: %s", this.cid, ev.target.cid);
			this._setScrolling(false);
		}
	},

	/* --------------------------- *
	/* toggle touch events
	/* --------------------------- */

	_toggleTouchEvents: function(enable) {
		// console.log("%s::_toggleTouchEvents", this.cid, enable);
		if (this._touchEventsEnabled !== enable) {
			this._touchEventsEnabled = enable;
			if (enable) {
				this.touch.on("hpanstart hpanmove hpanend hpancancel tap", this._onTouchEvent);
			} else {
				this.touch.off("hpanstart hpanmove hpanend hpancancel tap", this._onTouchEvent);
			}
		}
	},

	_onTouchEvent: function(ev) {
		// console.log("%s::_onTouchEvent", this.cid, ev.type);
		switch (ev.type) {
			case "tap":
				return this._onTap(ev);
			case "hpanstart":
				return this._onPanStart(ev);
			case "hpanmove":
				return this._onPanMove(ev);
			case "hpanend":
				return this._onPanFinal(ev);
			case "hpancancel":
				return this._onPanFinal(ev);
		}
	},

	/* --------------------------- *
	/* touch event: pan
	/* --------------------------- */

	// _panCapturedOffset: 0,

	/** @param {Object} ev */
	_onPanStart: function(ev) {
		this.selectFromView();
		this.el.classList.add("panning");
		this._setScrolling(true);
	},

	/** @param {Object} ev */
	_onPanMove: function(ev) {
		var view = this.getViewAtPanDir(ev.offsetDirection);
		var delta = (this.direction & HORIZONTAL) ? ev.thresholdDeltaX : ev.thresholdDeltaY;
		// var delta = (this.direction & HORIZONTAL) ? ev.deltaX : ev.deltaY;

		if (this._panCandidateView !== view) {
			this._panCandidateView && this._panCandidateView.el.classList.remove("candidate");
			this._panCandidateView = view;
			this._panCandidateView && this._panCandidateView.el.classList.add("candidate");
		}
		if (this._panCandidateView === void 0) {
			delta *= Globals.HPAN_OUT_DRAG;
		}

		if (this._renderRafId !== -1) {
			this.scrollBy(delta, Carousel.IMMEDIATE);
			this.renderNow();
		} else {
			this._scrollBy(delta, Carousel.IMMEDIATE);
		}
	},

	/** @param {Object} ev */
	_onPanFinal: function(ev) {
		var scrollCandidate;
		// NOTE: this delta is used for determining selection, NOT for layout
		var delta = (this.direction & HORIZONTAL) ? ev.thresholdDeltaX : ev.thresholdDeltaY;
		// var delta = (this.direction & HORIZONTAL) ? ev.deltaX : ev.deltaY;

		if ((ev.type == "hpanend")
			/* pan direction (current event) and offsetDirection (whole gesture) must match */
			&& (ev.direction ^ ev.offsetDirection ^ this.direction)
			// && (ev.direction & ev.offsetDirection & this.direction)
			/* gesture must overshoot selectThreshold */
			&& (Math.abs(delta) > this.selectThreshold)) {
			/* choose next scroll target */
			scrollCandidate = this.getViewAtPanDir(ev.offsetDirection);
		}
		this._scrollCandidateView = scrollCandidate || void 0;

		if (this._panCandidateView && (this._panCandidateView !== scrollCandidate)) {
			this._panCandidateView.el.classList.remove("candidate");
		}
		this._panCandidateView = void 0;
		this.el.classList.remove("panning");

		this.scrollBy(0, Carousel.ANIMATED);
		this.selectFromView();

		// if (this._renderRafId !== -1) {
		// 	this.scrollBy(0, Carousel.ANIMATED);
		// 	this.renderNow();
		// } else {
		// 	this._scrollBy(0, Carousel.ANIMATED);
		// }
	},

	/* --------------------------- *
	/* touch event: tap
	/* --------------------------- */

	getViewAtPanDir: function(dir) {
		// return (dir & this._precedingDir) ? this._precedingView : this._followingView;
		return (dir & this._followingDir) ? this._precedingView : this._followingView;
	},

	/** @type {int} In pixels */
	_tapGrow: 10,

	getViewAtTapPos: function(pos, posAcross) {
		if (this._tapAcrossBefore < posAcross && posAcross < this._tapAcrossAfter) {
			if (pos < this._tapBefore) {
				return this._precedingView;
			} else if (pos > this._tapAfter) {
				return this._followingView;
			}
		}
		return void 0;
	},

	_onTap: function(ev) {
		var targetView = View.findByDescendant(ev.target);
		// if (!this.itemViews.contains(targetView)) {
		// 	return;
		// }
		do {
			if (this._selectedView === targetView) {
				// console.log("%s tap ocurred on selected: %o", this.cid, targetView);
				return;
			} else if (this === targetView) {
				// console.log("%s tap ocurred on carousel: %o", this.cid, targetView);
				break;
			}
		} while ((targetView = targetView.parentView))

		// this.selectFromView();

		var bounds = this.el.getBoundingClientRect();
		var tapX = ev.center.x - bounds.left;
		var tapY = ev.center.y - bounds.top;
		var tapCandidate = this.getViewAtTapPos(
			this.dirProp(tapX, tapY),
			this.dirProp(tapY, tapX)
		);

		if (tapCandidate) {
			console.log("%s::_onTap %o", this.cid, ev);
			ev.preventDefault();
			// ev.stopPropagation();

			// this._scrollCandidateView = tapCandidate;
			// this._setScrolling(true);
			// this.scrollBy(0, Carousel.ANIMATED);
			// this._scrollCandidateView.el.classList.add("candidate");
			// this.selectFromView();

			//// NOT using internalSelection
			// this.triggerSelectionEvents(tapCandidate, false);

			// using internalSelection
			this._scrollCandidateView = tapCandidate;
			this._setScrolling(true);
			this.scrollBy(0, Carousel.ANIMATED);

			this.triggerSelectionEvents(tapCandidate, true);
			// this.renderNow();
		}
	},

	/* --------------------------- *
	/* Private
	/* --------------------------- */

	triggerSelectionEvents: function(view, internal) {
		if (view === void 0 || this._internalSelection) {
			return;
		}

		this._internalSelection = !!internal;
		if (view === this.emptyView) {
			this.trigger("view:select:none");
		} else {
			this.trigger("view:select:one", view.model);
		}
		this._internalSelection = false;
	},

	selectFromView: function() {
		if (this._scrollCandidateView === void 0) {
			return;
		}
		var view = this._scrollCandidateView;
		this._scrollCandidateView = void 0;
		view.el.classList.remove("candidate");

		this.triggerSelectionEvents(view, true);
	},

	adjustToSelection: function() {
		var m, i = this.collection.selectedIndex;
		// assume -1 < index < this.collection.length
		if (this.requireSelection) {
			(i == -1) && i++; // if selection is null (index -1), set _selectedView to first item (index 0)
			this._selectedView = (m = this.collection.at(i)) && this.itemViews.findByModel(m);
			this._precedingView = (m = this.collection.at(i - 1)) && this.itemViews.findByModel(m);
			this._followingView = (m = this.collection.at(i + 1)) && this.itemViews.findByModel(m);
		} else {
			this._selectedView = (m = this.collection.at(i)) ? this.itemViews.findByModel(m) : this.emptyView;
			this._precedingView = m && ((m = this.collection.at(i - 1)) ? this.itemViews.findByModel(m) : this.emptyView);
			this._followingView = (m = this.collection.at(i + 1)) && this.itemViews.findByModel(m);
		}
	},

	/* --------------------------- *
	/* Model listeners
	/* --------------------------- */

	/** @private */
	_onSelectOne: function(model) {
		if (model === this._selectedView.model) {
			// console.info("INTERNAL");
			return;
		}
		this._onSelectAny(model);
	},

	/** @private */
	_onSelectNone: function() {
		if ((this.requireSelection ? this.itemViews.first() : this.emptyView) === this._selectedView) {
			// console.info("INTERNAL");
			return;
		}
		this._onSelectAny();
	},

	/** @private */
	_onSelectAny: function(model) {
		this._selectedView.el.classList.remove("selected");
		this.adjustToSelection();
		this._selectedView.el.classList.add("selected");

		if (!this._internalSelection) {
			this._setScrolling(true);
			this.scrollBy(0, Carousel.ANIMATED);
		}
	},

	// _onDeselectAny: function (model) {},

	/** @private */
	_onReset: function() {
		// this._createChildren();
		// this.invalidateChildren();
		this.requestRender(View.CHILDREN_INVALID | View.MODEL_INVALID);
	},


	/* --------------------------- *
	/* TEMP
	/* --------------------------- */

	// _scrollBy2: function (delta, skipTransitions) {
	// 	var metrics, pos;
	// 	var sMetrics = this.metrics[(this._scrollCandidateView || this._selectedView).cid];
	// 	var cMetrics = this.metrics[(this._panCandidateView || this._selectedView).cid];
	//
	// 	this.itemViews.each(function (view) {
	// 		metrics = this.metrics[view.cid];
	// 		pos = Math.floor(this._getScrollOffset(delta, metrics, sMetrics, cMetrics));
	// 		view.el.style[transformProperty] = (this.direction & HORIZONTAL)?
	// 				"translate3d(" + pos + "px,0,0)" : "translate3d(0," + pos + "px,0)";
	// 				// "translate(" + pos + "px,0)" : "translate(0," + pos + "px)";
	// 				// "translateX(" + pos + "px)" : "translateY(" + pos + "px)";
	// 	}, this);
	// 	this.el.classList.toggle("skip-transitions", skipTransitions);
	// 	this.selectFromView();
	// },

	// _getScrollOffset2: function (delta, mCurr, mSel, mCan) {
	// 	var offset = 0;
	// 	var posInner = mCurr.posInner - mSel.posInner + delta;
	//
	// 	if (posInner < -mSel.inner) {
	// 		offset = -(mCurr.before);
	// 	} else if (posInner > mSel.inner) {
	// 		offset = (mSel.after);
	// 	} else {
	// 		if (posInner < 0) {
	// 			offset = (mCurr.before) / (mCurr.inner) * posInner;
	// 		} else {
	// 			offset = (mSel.after) / (mCan.inner) * posInner;
	// 		}
	// 	}
	// 	return posInner + offset;
	// },

	// captureSelectedOffset: function() {
	// 	var val, view, cssval, m, mm;
	//
	// 	val = 0;
	// 	view = this._scrollCandidateView || this._selectedView;
	// 	cssval = getComputedStyle(view.el)[transformProperty];
	//
	// 	mm = cssval.match(/(matrix|matrix3d)\(([^\)]+)\)/);
	// 	if (mm) {
	// 		m = mm[2].split(",");
	// 		if (this.direction & HORIZONTAL) {
	// 			val = m[mm[1]=="matrix"? 4 : 12];
	// 		} else {
	// 			val = m[mm[1]=="matrix"? 5 : 13];
	// 		}
	// 		val = parseFloat(val);
	// 	}
	//
	// 	console.log("%s::captureSelectedOffset", this.cid, cssval, val, cssval.match(/matrix\((?:\d\,){3}(\d)\,(\d)|matrix3d\((?:\d\,){11}(\d)\,(\d)/));
	//
	// 	return val;
	// },

	// _onScrollEnd: function(exec) {
	// 	this._scrollEndCancellable = void 0;
	// 	// this.el.classList.remove("disabled-changing");
	// 	if (exec) {
	// 		this._setScrolling(false);
	// 		// this.el.classList.remove("scrolling");
	// 		// this.trigger("view:scrollend");
	// 		console.log("%s::_onScrollEnd", this.cid);
	// 	}
	// },
	// _onMouseDown: function(ev) {
	// 	if (this._scrolling) {
	// 		this._panCapturedOffset = this.captureSelectedOffset();
	// 		console.log("%s::events[mousedown] scrolling interrupted (pos %f)", this.cid, this._panCapturedOffset);
	// 	}
	// },
	// _onMouseUp:function(ev) {
	// 	this._panCapturedOffset = 0;
	// },

};

module.exports = Carousel = View.extend(CarouselProto, Carousel);
},{"app/control/Globals":34,"app/view/base/View":60,"app/view/render/CarouselRenderer":83,"backbone.babysitter":"backbone.babysitter","hammerjs":"hammerjs","underscore":"underscore","utils/prefixedProperty":113,"utils/prefixedStyleName":114,"utils/touch/SmoothPanRecognizer":120}],66:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper;

  return container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(depth0 != null ? depth0 : {},{"name":"id","hash":{},"data":data}) : helper)));
},"useData":true});

},{"hbsfy/runtime":20}],67:[function(require,module,exports){
/**
 * @module app/view/component/CollectionStack
 */

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");

/** @type {string} */
var viewTemplate = require("./CollectionStack.hbs");

/**
 * @constructor
 * @type {module:app/component/CollectionStack}
 */
module.exports = View.extend({

	/** @override */
	cidPrefix: "stack",
	/** @override */
	tagName: "div",
	/** @override */
	className: "stack",
	/** @override */
	template: viewTemplate,

	events: {
		"transitionend": function(ev) {
			// console.log("%s::transitionend [invalid: %s] [transition: %s]", this.cid, this._contentInvalid, (this._skipTransitions? "skip": "run"), ev.target.id, ev.target.className);
			this._renderContent();
		}
	},

	initialize: function(options) {
		this._enabled = true;
		this._skipTransitions = true;
		this._contentInvalid = true;

		options.template && (this.template = options.template);
		this.content = document.createElement("div");
		this.content.className = "stack-item";
		this.el.appendChild(this.content);

		this.listenTo(this.collection, "select:one select:none", this._onSelectChange);
	},

	setEnabled: function(enabled) {
		if (this._enabled !== enabled) {
			this._enabled = enabled;
			this.el.classList.toggle("disabled", !this._enabled);
		}
	},

	_onSelectChange: function(item) {
		if (this._renderedItem === this.collection.selected) {
			throw new Error("change event received but item is identical");
		}
		this._renderedItem = this.collection.selected;

		this._contentInvalid = true;
		this.render();
	},

	/* --------------------------- *
	/* render
	/* --------------------------- */

	render: function() {
		if (this._skipTransitions) {
			// execute even if content has not changed to apply styles immediately
			this._skipTransitions = false;
			this.el.classList.add("skip-transitions");
			this.setImmediate(function() {
				this.el.classList.remove("skip-transitions");
			});

			// render changed content immediately
			if (this._contentInvalid) {
				this._renderContent();
			}
		} else {
			// else remove 'current' class and render on transitionend
			if (this._contentInvalid) {
				this.content.classList.remove("current");
				// this.content.className = "stack-item";
			}
		}
		return this;
	},

	_renderContent: function() {
		if (this._contentInvalid) {
			this._contentInvalid = false;
			var item = this.collection.selected;
			this.content.innerHTML = item ? this.template(item.toJSON()) : "";
			this.content.classList.add("current");
			// this.content.className = "stack-item current";
		}
	},
});
},{"./CollectionStack.hbs":66,"app/view/base/View":60}],68:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/view/component/FilterableListView
/*/

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");
/** @type {module:utils/prefixedProperty} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {module:utils/css/getBoxEdgeStyles} */
var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");
/** @type {module:utils/array/difference} */
var diff = require("utils/array/difference");
/** @type {module:utils/promise/resolveAll} */
var resolveAll = require("utils/promise/resolveAll");
/** @type {module:utils/promise/rejectAll} */
var rejectAll = require("utils/promise/rejectAll");

// var resolveAll = function(pp, result) {
// 	if (pp.length != 0) {
// 		pp.forEach(function(p, i, a) {
// 			p.resolve(result);
// 			a[i] = null;
// 		});
// 		pp.length = 0;
// 	}
// 	return pp;
// };

// var rejectAll = function(pp, reason) {
// 	if (pp.length != 0) {
// 		pp.forEach(function(p, i, a) {
// 			p.reject(reason);
// 			a[i] = null;
// 		});
// 		pp.length = 0;
// 	}
// 	return pp;
// };

/** @type {module:app/control/Globals.TRANSLATE_TEMPLATE} */
var translateCssValue = require("app/control/Globals").TRANSLATE_TEMPLATE;

/** @const */
var transformProp = prefixedProperty("transform");

/**
/* @constructor
/* @type {module:app/view/component/FilterableListView}
/*/
var FilterableListView = View.extend({

	/** @type {string} */
	cidPrefix: "filterableList",
	/** @override */
	tagName: "ul",
	/** @override */
	className: "list selectable filterable",

	/** @override */
	defaults: {
		collapsed: true,
		filterFn: function() {
			return true;
		},
		renderer: ClickableRenderer.extend({
			/** @override */
			cidPrefix: "listItem",
		}),
	},

	/** @override */
	properties: {
		collapsed: {
			get: function() {
				return this._collapsed;
			},
			set: function(value) {
				this._setCollapsed(value);
			}
		},
		selectedItem: {
			get: function() {
				return this._selectedItem;
			},
			set: function(value) {
				this._setSelection(value);
			}
		},
		filteredItems: {
			get: function() {
				return this._filteredItems;
			}
		},
		metrics: {
			get: function() {
				return this._metrics;
			}
		}
	},

	/** @override */
	events: {
		"transitionend .list-item": function(ev) {
			if (this._collapsedChanging && ev.propertyName === "visibility" /*&& this.el.classList.contains(".collapsed-changing")*/ ) {
				console.log("%s::events[transitionend .list-item] collapsed-changing end (resolving %s promises)", this.cid, this._collapsePromises.length);

				this._collapsedChanging = false;
				this.el.classList.remove("collapsed-changing");
				resolveAll(this._collapsePromises, this);
			}
		},
	},

	/** @override */
	initialize: function(options) {
		this._filteredItems = [];
		this._filteredIncoming = [];
		this._filteredOutgoing = [];

		this._metrics = {};
		this._itemMetrics = [];
		this._collapsePromises = [];
		this.itemViews = new Container();

		_.defaults(options, this.defaults);
		this.renderer = options.renderer;
		this._filterFn = options.filterFn;

		// this.computeFilter();
		// this.collection.each(this.createItemView, this);

		this.collection.each(this.createItemView, this);
		this._setSelection(this.collection.selected);
		this._setCollapsed(options.collapsed);
		this.refreshFilter();
		// this.skipTransitions = true;
		// this.renderNow();

		// this.listenTo(this.collection, "select:one select:none", this._setSelection);
		this.listenTo(this.collection, "reset", function() {
			this._allItems = null;
			throw new Error("not implemented");
		});

		// will trigger on return if this.el is already attached
		// this.skipTransitions = true;
		// this.el.classList.add("skip-transitions");
		// this.requestRender(View.ALL_INVALID);

		console.log("%s::initialize attached: %o", this.cid, this.attached);

		this.once("view:attached", function(view) {
			console.log("%s::initialize -> [view:attached] attached: %o", view.cid, view.attached);
			// view.requestRender(View.ALL_INVALID).renderNow();
			view.skipTransitions = true;
			view.el.classList.add("skip-transitions");
			view.setImmediate(function() {
				// this.skipTransitions = true;
				view.renderNow();
			});
		});
	},

	/**
	 * Get an array with a collection contens
	 * @private
	 */
	_getAllItems: function() {
		return this._allItems || (this._allItems = this.collection.slice());
	},

	/* --------------------------- *
	/* Transition promises
	/* --------------------------- */

	_whenCollapseChangeEnds: function() {
		if (this._collapsedChanged) {
			var view = this;
			return new Promise(function(resolve, reject) {
				view.on("view:render:after", resolve);
			})
		} else {
			return Promise.resolve(this);
		}
	},

	whenCollapseChangeEnds: function() {
		var d, p, pp;
		if (this._collapsedChanging || this._collapsedChanged) {
			d = {};
			p = new Promise(function(resolve, reject) {
				d.resolve = resolve;
				d.reject = reject;
			});
			pp = this._collapsePromises;
			pp.push(d);
		} else {
			p = Promise.resolve(this);
		}
		return p;
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	/** @override */
	renderFrame: function(tstamp, flags) {
		// if (DEBUG) {
		// 	var changed = [];
		// 	this._collapsedChanged && changed.push("collapsed");
		// 	this._selectionChanged && changed.push("selection");
		// 	this._filterChanged && changed.push("filter");
		// 	console.log("%s::renderFrame [%s]", this.cid, changed.join(" "));
		// }

		// collapsed transition flag
		if (this._collapsedChanging) {
			console.warn("%s::renderFrame collapsed tx interrupted", this.cid);
			this._collapsedChanging = false;
			this.el.classList.remove("collapsed-changing");
			rejectAll(this._collapsePromises, this);
		}
		if (this.skipTransitions) {
			this.el.classList.add("skip-transitions");
			// this.requestAnimationFrame(function() {
			this.setImmediate(function() {
				this.skipTransitions = false;
				this.el.classList.remove("skip-transitions");
			});
		}

		if (this._collapsedChanged) {
			this._collapsedChanged = false;
			flags |= View.SIZE_INVALID;
			this.el.classList.toggle("collapsed", this._collapsed);

			if (this.skipTransitions) {
				this._collapsedChanging = false;
				// resolveAll(this._collapsePromises, this.el);
				this.once("view:render:after", function(view) {
					resolveAll(view._collapsePromises, view);
				});
			} else {
				this._collapsedChanging = true;
				this.el.classList.add("collapsed-changing");
				// this will be resolved on transitionend
			}
			console.log("%s:[collapse changed] %s promises", this.cid,
				this._collapsePromises.length,
				this._collapsedChanging ?
				"resolving now" :
				"resolving on transititionend"
			);
		}

		if (this._selectionChanged) {
			this._selectionChanged = false;
			flags |= View.LAYOUT_INVALID;
			this.renderSelection(this.collection.selected, this.collection.lastSelected);
		}

		if (this._filterChanged) {
			this._filterChanged = false;
			flags |= View.LAYOUT_INVALID;
			var lastFilteredItems = this.filteredItems;
			// this._printStats(lastFilteredItems);
			this.computeFilter();
			this.applyFilter();
			this._printStats(lastFilteredItems);
		}

		if (flags & View.SIZE_INVALID) {
			this.measure(); // NOTE: measures children
		}

		if (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {
			this.renderLayout();
		}
	},

	measure: function() {
		// var i, ii, el, els, m, mm;
		// els = this.el.children;
		// ii = els.length;
		// mm = this._itemMetrics;
		// for (i = 0; i < ii; i++) {
		// 	mm[i] = _.pick(els[i], "offsetTop", "offsetHeight");
		// }

		this._metrics = getBoxEdgeStyles(this.el, this._metrics);

		// var itemEl, itemView, baseline = 0;
		// if (itemEl = this.el.querySelector(".list-item:not(.excluded) .label")) {
		// 	// itemView = this.itemViews.findByCid(itemEl.cid);
		// 	var elA = itemEl, elB = itemEl.parentElement;
		// 	var yA = elA.offsetTop,
		// 		hA = elA.offsetHeight,
		// 		yB = elB.offsetTop,
		// 		hB = elB.offsetHeight;
		// 	baseline = ((yA + hA) - (yB + hB));
		// 	console.log("%s::measure fontSize: %spx (%s+%s)-(%s+%s)=%s", this.cid, this._metrics.fontSize,
		// 		yA, hA, yB, hB, baseline
		// 	);
		// }

		this.itemViews.forEach(function(view) {
			if (!view._metrics) view._metrics = {};
			// view._metrics.baseline = this._metrics.fontSize - baseline;
			view._metrics.offsetTop = view.el.offsetTop;
			view._metrics.offsetHeight = view.el.offsetHeight;
			view._metrics.offsetLeft = view.el.offsetLeft;
			view._metrics.offsetWidth = view.el.offsetWidth;
			if (!this._collapsed && view.label) {
				view._metrics.textLeft = view.label.offsetLeft;
				view._metrics.textWidth = view.label.offsetWidth;
			} else {
				view._metrics.textLeft = view._metrics.offsetLeft;
				view._metrics.textWidth = view._metrics.offsetWidth;
			}
		}, this);

		// this._metrics.baseline = this._metrics.fontSize - baseline;
	},

	renderLayout: function() {
		var posX, posY;
		posX = this._metrics.paddingLeft;
		posY = this._metrics.paddingTop;

		// use HTMLElement.children to keep layout order
		for (var i = 0, ii = this.el.children.length; i < ii; i++) {
			var view = this.itemViews.findByCid(this.el.children[i].cid);
			if (((this.collection.selected && !view.model.selected) ||
					view.el.classList.contains("excluded")) && this._collapsed) {
				view.transform.tx = posX;
				view.transform.ty = posY;
			} else {
				if (view._metrics.offsetHeight == 0) {
					posY -= view._metrics.offsetTop;
				}
				view.transform.tx = posX;
				view.transform.ty = posY;
				posY += view._metrics.offsetHeight + view._metrics.offsetTop;
			}
			view.el.style[transformProp] = translateCssValue(view.transform.tx, view.transform.ty);
		}

		// posY += this._metrics.paddingBottom;
		this._metrics.height = Math.max(0, posY + this._metrics.paddingBottom);
		this.el.style.height = this._metrics.height + "px";
		// this.el.style.height = (posY > 0) ? posY + "px" : "";
	},

	/* --------------------------- *
	/* Child views
	/* --------------------------- */

	/** @private */
	createItemView: function(item, index) {
		var view = new this.renderer({
			model: item,
			el: this.el.querySelector(".list-item[data-id=\"" + item.id + "\"]")
		});
		// item.set("excluded", false, { silent: true });
		// view.listenTo(item, "change:excluded", function(item, newVal) {
		// 	// console.log(arguments);
		// 	if (this.el.classList.contains("excluded") !== newVal) {
		// 		console.warn("%s:[change:excluded] m:%o css: %o", this.cid, newVal, this.el.classList.contains("excluded"));
		// 	}
		// 	// this.el.classList.toggle("excluded", excluded);
		// });
		this.listenTo(view, "renderer:click", this._onRendererClick);
		this.itemViews.add(view);
		return view;
	},

	/** @private */
	_onRendererClick: function(item, ev) {
		if (this._collapsedChanging
			|| (this._collapsed && item.get("excluded"))) {
			return;
		}
		if (this.collection.selected !== item) {
			this.trigger("view:select:one", item);
		} else {
			if (ev.altKey) {
				this.trigger("view:select:none");
			} else {
				this.trigger("view:select:same", item);
			}
			// this.trigger("view:select:none");
		}
	},

	/* --------------------------- *
	/* Collapsed
	/* --------------------------- */

	/** @private */
	_collapsed: undefined,

	/**
	 * @param {Boolean}
	 */
	_setCollapsed: function(collapsed) {
		if (collapsed !== this._collapsed) {
			this._collapsed = collapsed;
			this._collapsedChanged = true;
			this.requestRender();
		}
	},

	/* --------------------------- *
	/* Selection
	/* --------------------------- */

	/** @private */
	_selectedItem: undefined,

	/** @param {Backbone.Model|null} */
	_setSelection: function(item) {
		if (item !== this._selectedItem) {
			this._selectedItem = item;
			this._selectionChanged = true;
			this.requestRender(View.MODEL_INVALID);
		}
	},

	/** @private */
	renderSelection: function(newItem, oldItem) {
		var view;
		if (oldItem) {
			view = this.itemViews.findByModel(oldItem);
			view.el.classList.remove("selected");
			// view.label.classList.remove("color-fg");
			// view.label.classList.remove("color-reverse");
		}
		if (newItem) {
			view = this.itemViews.findByModel(newItem);
			view.el.classList.add("selected");
			// view.label.classList.add("color-fg");
			// view.label.classList.add("color-reverse");
		}
		this.el.classList.toggle("has-selected", this.selectedItem !== null);
	},

	_printStats: function(lastFilteredItems) {
		console.log("%o::renderFrame %s filtered:%o(=%o)/%o (changed:%o, in:%o, out:%o)", this.cid,
			this.filteredItems.length > 0 ? "has" : "has not",
			this.filteredItems.length,
			lastFilteredItems ? (this.filteredItems.length + this._filteredIncoming.length) - this._filteredOutgoing.length : this.filteredItems.length,
			this.collection.length,
			(this._filteredIncoming.length + this._filteredOutgoing.length),
			this._filteredIncoming.length,
			this._filteredOutgoing.length);
	},

	/* --------------------------- *
	/* Filter
	/* --------------------------- */

	refreshFilter: function() {
		if (this._filterFn) {
			this._filterChanged = true;
			this.requestRender(View.MODEL_INVALID);
		}
	},

	/* --------------------------- *
	/* Filter impl 2
	/* --------------------------- */

	computeFilter: function() {
		var newItems, oldItems;
		var hasNew, hasOld;
		this._filteredIncoming.length = 0;
		this._filteredOutgoing.length = 0;

		newItems = this._filterFn ? this.collection.filter(this._filterFn, this) : this._getAllItems();
		oldItems = this._filteredItems;
		hasNew = !!(newItems && newItems.length);
		hasOld = !!(oldItems && oldItems.length);
		// NOTE: diff third arg is destination array
		if (hasNew) {
			// incoming exclusions
			diff((hasOld ? oldItems : this._getAllItems()), newItems, this._filteredIncoming);
			// this._filteredIncoming.forEach(function(item) {
			// 	item.set("excluded", true);
			// });
		}
		if (hasOld) {
			// outgoing exclusions
			diff((hasNew ? newItems : this._getAllItems()), oldItems, this._filteredOutgoing);
			// this._filteredOutgoing.forEach(function(item) {
			// 	item.set("excluded", false);
			// });
		}
		// console.log("%s::renderFilterFn", this.cid, newItems);
		this._filteredItems = newItems;
	},

	applyFilter: function() {
		// this.itemViews.forEach(function(view) {
		// 	view.el.classList.toggle("excluded", view.model.get("excluded"));
		// });
		this._filteredIncoming.forEach(function(item) {
			this.itemViews.findByModel(item).el.classList.add("excluded");
			item.set("excluded", true);
		}, this);
		this._filteredOutgoing.forEach(function(item) {
			this.itemViews.findByModel(item).el.classList.remove("excluded");
			item.set("excluded", false);
		}, this);

		this.el.classList.toggle("has-excluded", this.filteredItems.length > 0);
	},

	/* --------------------------- *
	/* Filter impl 1
	/* --------------------------- */

	/*
	computeFilter_1: function() {
		var items = this._filterFn ? this.collection.filter(this._filterFn, this) : this._getAllItems();
		this.renderFilters(items, this._filteredItems);
		this._filteredItems = items;
	},

	renderFilters: function(newItems, oldItems) {
		var hasNew = !!(newItems && newItems.length);
		var hasOld = !!(oldItems && oldItems.length);
		var inExcl = [];
		var outExcl = [];

		// console.log("%s::renderFilterFn", this.cid, newItems);
		// NOTE: diff third arg is destination array
		if (hasNew) {
			diff((hasOld ? oldItems : this._getAllItems()), newItems, inExcl)
			// .forEach(function(item) {
			// 	this.itemViews.findByModel(item).el.classList.add("excluded");
			// 	item.set("excluded", true);
			// }, this);
		}
		if (hasOld) {
			diff((hasNew ? newItems : this._getAllItems()), oldItems, outExcl)
			// .forEach(function(item) {
			// 	this.itemViews.findByModel(item).el.classList.remove("excluded");
			// 	item.set("excluded", false);
			// }, this);
		}
		this._filteredIncoming = inExcl;
		this._filteredOutgoing = outExcl;
		// this.el.classList.toggle("has-excluded", hasNew);
		// this.applyFilter();
	},
	*/

	// computeFiltered: function() {
	// 	this._filterResult = this.collection.map(this._filterFn, this);
	// },
	//
	// renderFiltered: function() {
	// 	this.collection.forEach(function(item, index) {
	// 		this.itemViews.findByModel(item).el.classList.toggle("excluded", !this._filterResult[index]);
	// 	}, this);
	// },

});

if (DEBUG) {
	FilterableListView.prototype._logFlags = [
		"view.render",
		// "view.trace"
	].join(" ");
}

module.exports = FilterableListView;
}).call(this,true)

},{"app/control/Globals":34,"app/view/base/View":60,"app/view/render/ClickableRenderer":84,"backbone.babysitter":"backbone.babysitter","underscore":"underscore","utils/array/difference":105,"utils/css/getBoxEdgeStyles":108,"utils/prefixedProperty":113,"utils/promise/rejectAll":116,"utils/promise/resolveAll":117}],69:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/view/component/GraphView
 */

/** @type {module:underscore} */
var _ = require("underscore");

/** @type {Function} */
var Color = require("color");

/** @type {module:app/view/base/CanvasView} */
var CanvasView = require("app/view/base/CanvasView");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

/** @type {module:utils/canvas/calcArcHConnector} */
var calcArcHConnector = require("utils/canvas/calcArcHConnector");

/** @type {module:utils/canvas/CanvasHelper} */
var CanvasHelper = require("utils/canvas/CanvasHelper");

/** @type {module:utils/geom/inflateRect} */
var inflateRect = require("utils/geom/inflateRect");

// /** @type {module:utils/dom/getAbsoluteClientRect} */
// var getAbsoluteClientRect = require("utils/dom/getAbsoluteClientRect");


// var BEZIER_CIRCLE = 0.551915024494;
// var MIN_CANVAS_RATIO = 2;
// var PI2 = Math.PI * 2;

var styleBase = {
	lineCap: "butt", // round, butt, square
	lineWidth: 0.75,
	lineDashOffset: 0,
	setLineDash: [[]],
	radiusBase: 0.75,
	/* factored to rem unit */ //6,
	radiusIncrement: 0.21, //3, //0.25,
	/* uses lineWidth multiplier */
	outlineWidth: 3.5,
	arrowSize: 0.3,
};

// var overlayStyleBase = {
// 	globalAlpha: 0.75,
// 	globalCompositeOperation: "destination-out",
// 	lineWidth: 4,
// 	lineJoin: "round",
// 	textBaseline: "top",
// 	textAlign: "left",
// };

if (DEBUG) {
	/* eslint-disable no-unused-vars */
	var _dStyles = {};
	_dStyles["defaults"] = {
		lineWidth: 0,
		fillStyle: "transparent",
		strokeStyle: "transparent",
		lineDashOffset: 0,
		setLineDash: [[]]
	};

	/* Stroke */
	[
		"red", "salmon", "sienna",
		"green", "yellowgreen", "olive",
		"blue", "lightskyblue", "midnightblue",
		"grey", "silver"
	]
	.forEach(function(colorName) {
		var rgbaValue = Color(colorName).alpha(0.5).rgbaString();

		_dStyles[colorName] = _.defaults({
			lineWidth: 0.75,
			strokeStyle: rgbaValue,
		}, _dStyles["defaults"]);

		_dStyles[colorName + "_thick"] = _.defaults({
			lineWidth: 5,
			strokeStyle: rgbaValue,
		}, _dStyles["defaults"]);

		_dStyles[colorName + "_fill"] = _.defaults({
			fillStyle: rgbaValue
		}, _dStyles["defaults"]);
	})
	/* eslint-enable no-unused-vars */
}

var getRectDirX = function(r1, r2) {
	if (r1.right < r2.left) {
		return 1;
	}
	if (r2.right < r1.left) {
		return -1;
	}
	return 0;
};

/**
 * @constructor
 * @type {module:app/view/component/GraphView}
 */
var GraphView = CanvasView.extend({

	/** @type {string} */
	cidPrefix: "graph",
	/** @override */
	tagName: "canvas",
	/** @override */
	className: "graph",

	defaultKey: "a2b",

	defaults: {
		values: {
			a2b: 0,
			b2a: 0,
		},
		maxValues: {
			a2b: 1,
			b2a: 1,
		},
		// useOpaque: true,
		// labelFn: function(value, max) {
		// 	return ((value / max) * 100) | 0;
		// },
	},

	/** @override */
	initialize: function(options) {
		CanvasView.prototype.initialize.apply(this, arguments);

		this._listA = options.listA;
		this._listB = options.listB;
		this._a2b = {
			srcView: options.listA,
			destView: options.listB,
			s: _.defaults({
				lineWidth: 1.25
				// radiusIncrement: 0.25,
			}, styleBase),
			strokeStyleFn: function(fg, bg, ln) {
				return Color(ln).mix(bg, 0.9).hexString();
				// return Color(fg).mix(bg, 0.9).hexString();
			}
		};
		this._b2a = {
			srcView: options.listB,
			destView: options.listA,
			s: _.defaults({
				lineWidth: 0.7,
				// arrowSize: 0.25,
				// radiusIncrement: 0,
				// outlineWidth: 0,
			}, styleBase),
			strokeStyleFn: function(fg, bg, ln) {
				return Color(fg).mix(bg, 0.6).hexString();
			}
		};
		// this.listenTo(this, "view:render:before", this._beforeViewRender);

		// this._traceScroll = _.debounce(this.__raceScroll, 100, false);

		// var viewportChanged = function(ev) {
		// 	console.log("%s:[%s]", this.cid, ev.type);
		//
		// 	// this._traceScroll(ev.type);
		// 	// this._labelOverlays = null;
		// 	this.invalidate(CanvasView.LAYOUT_INVALID | CanvasView.SIZE_INVALID);
		// 	// this.requestRender(CanvasView.LAYOUT_INVALID | CanvasView.SIZE_INVALID);
		// 	// this.requestRender().renderNow();
		// }.bind(this);
		// viewportChanged = _.debounce(viewportChanged, 60, false);

		// window.addEventListener("scroll",
		// 		_.debounce(viewportChanged, 100, false), false);
		// window.addEventListener("wheel",
		// 	_.debounce(viewportChanged, 100, false), false);
		// window.addEventListener("scroll", viewportChanged, false);
		// window.addEventListener("wheel", viewportChanged, false);
		// window.addEventListener("resize", viewportChanged, false);
		// window.addEventListener("orientationchange", viewportChanged, false);

		// this._addListListeners(this._a2b);
		// this._addListListeners(this._b2a);
	},

	/** @override */
	measureCanvas: function(w, h, s) {
		console.log("%s::measureCanvas style:%o scroll:%o offset:%o client:%o arg:%o", this.cid, s.height, this.el.offsetHeight, this.el.scrollHeight, this.el.clientHeight, h);
	},

	/** @override */
	updateCanvas: function() {
		this._updateMetrics();
		this._updateStyles();
	},

	/* --------------------------- *
	/* styles
	/* --------------------------- */

	_updateStyles: function() {
		var b, bgColor, lnColor;
		if (this.model.has("bundle")) {
			b = this.model.get("bundle");
			lnColor = b.colors.lnColor.clone();
			bgColor = b.colors.bgColor.clone();
		} else {
			bgColor = Color(Globals.DEFAULT_COLORS["background-color"]);
			lnColor = Color(Globals.DEFAULT_COLORS["link-color"]);
		}

		this._a2b.s.strokeStyle = this._a2b.s.fillStyle =
			this._a2b.strokeStyleFn(this._color, bgColor, lnColor);
		this._b2a.s.strokeStyle = this._b2a.s.fillStyle =
			this._b2a.strokeStyleFn(this._color, bgColor, lnColor);

		if (DEBUG) {
			this._debugBlocks = this.el.matches(".debug-blocks ." + this.className);
			this._debugGraph = this.el.matches(".debug-graph ." + this.className);
		}
	},

	_setStyle: function(s) {
		if (typeof s == "string") {
			s = this._styleData[s];
		}
		CanvasView.setStyle(this._ctx, s);
	},

	/* --------------------------- *
	/* metrics
	/* --------------------------- */

	_updateMetrics: function() {
		var bounds;
		var i, ii, els;
		var aRect, bRect;
		var aMin, bMin;

		this._rootFontSize = parseFloat(
			getComputedStyle(document.documentElement).fontSize);

		bounds = this.el.getBoundingClientRect();
		// bounds = getAbsoluteClientRect(this.el);
		this._ctx.setTransform(this._canvasRatio, 0, 0, this._canvasRatio,
			(-(bounds.left + window.scrollX) * this._canvasRatio) - 0.5,
			(-(bounds.top + window.scrollY) * this._canvasRatio) - 0.5
		);

		aRect = this._listA.el.getBoundingClientRect();
		aMin = aRect.left + window.scrollX;
		els = this._listA.el.querySelectorAll(".label");
		for (i = 0, ii = els.length; i < ii; i++) {
			aMin = Math.max(aMin,
				els[i].getBoundingClientRect().right + window.scrollX);
		}

		bRect = this._listB.el.getBoundingClientRect();
		bMin = bRect.left + window.scrollX;
		els = this._listB.el.querySelectorAll(".label");
		for (i = 0, ii = els.length; i < ii; i++) {
			bMin = Math.min(bMin,
				els[i].getBoundingClientRect().left + window.scrollX);
		}
		// this._b2a.destRect = this._a2b.rect = aRect;
		this._b2a.destMinX = this._a2b.xMin = aMin;
		this._b2a.qx = getRectDirX(bRect, aRect);

		// this._a2b.destRect = this._b2a.rect = bRect;
		this._a2b.destMinX = this._b2a.xMin = bMin;
		this._a2b.qx = getRectDirX(aRect, bRect);

		// var s = getComputedStyle(document.documentElement);
		// this._rootFontSize = parseFloat(s.fontSize); // * this._canvasRatio;
		// console.log("%s::_updateMetrics _rootFontSize: %s %o", this.cid, this._rootFontSize, s);

		// var c = Math.abs(sData.xMin - dData.xMin) / 6;
		// sMin = sData.xMin + c * qx;
		// dMin = dData.xMin - c * qx;

		// this._a2b.targets = this._measureListItems(listView);
		// this._b2a.targets = this._measureListItems(listView);

		// // connector minimum branch x2
		// listView = this._listB;
		// for (i = 0, ii = listView.groups.length; i < ii; i++) {
		// 	itemView = listView.itemViews.findByModel(listView.groups[i]);
		// 	itemRect = (itemView.label || itemView.el).getBoundingClientRect();
		// 	this._b2a.xMin = Math.min(this._b2a.xMin, itemRect.left);
		// 	// if (itemView._metrics) this._b2a.rect.left + itemView.transform.tx + itemView._metrics.textLeft;
		// }
	},

	/* --------------------------- *
	/* redraw
	/* --------------------------- */

	_beforeViewRender: function(view, flags) {
		if (flags & (CanvasView.SIZE_INVALID | CanvasView.MODEL_INVALID)) {
			console.log("%s::_beforeViewRender [flags: %s]", this.cid, CanvasView.flagsToString(flags));

			this._a2b.pointsOut = this._a2b.points;
			this._a2b.rootOut = this._a2b.root;
			this._b2a.pointsOut = this._b2a.points;
			this._b2a.rootOut = this._b2a.root;

			this._a2b.points = null;
			this._a2b.root = null;
			this._b2a.points = null;
			this._b2a.root = null;

			this._labelOverlays = null;
		}
	},

	redraw: function(ctx, interpolator, flags) {

		this._clearCanvas(0, 0, this._canvasWidth, this._canvasHeight);
		ctx.save();
		this._redraw_fromElements(ctx, interpolator, flags);
		// this._redraw_fromViews(ctx, interpolator);
		ctx.restore();
	},

	_redraw_fromElements: function(ctx, interpolator, flags) {
		// b2a: keyword to bundles, right to left
		// a2b: bundle to keywords, left to right
		if (flags & (CanvasView.SIZE_INVALID | CanvasView.MODEL_INVALID)) {
			console.log("%s::redraw [valuesChanged: %s] [flags: %s]", this.cid, interpolator.valuesChanged, CanvasView.flagsToString(flags));

			this._a2b.pointsOut = this._a2b.points;
			this._b2a.pointsOut = this._b2a.points;
			this._b2a.points = this._computeConnectors(this._b2a);
			this._a2b.points = this._computeConnectors(this._a2b);
			this._labelOverlays = this._computeLabelOverlays(this._listB);
		}

		/* line dash value interpolation */
		var b2aVal = interpolator._valueData["b2a"]._renderedValue / interpolator._valueData["b2a"]._maxVal;
		var a2bVal = interpolator._valueData["a2b"]._renderedValue / interpolator._valueData["a2b"]._maxVal;

		/* draw */
		this._drawConnectors(this._b2a.points, this._b2a.s, b2aVal, 1);
		this._drawConnectors(this._b2a.pointsOut, this._b2a.s, 1 - b2aVal, 1);
		this._drawConnectors(this._a2b.points, this._a2b.s, a2bVal, 2);
		// this._drawConnectors(this._a2b.pointsOut, this._a2b.s, 1 - a2bVal, 2);
		this._drawLabelOverlays(this._labelOverlays);
	},

	/* --------------------------- *
	 * label overlays
	 * --------------------------- */

	_computeLabelOverlays: function(list) {
		var data = { rects: [] };
		var els = list.el.querySelectorAll(".list-group .label span");

		var i, ii, r;
		for (i = 0, ii = els.length; i < ii; i++) {
			// r = inflateRect(els[i].getBoundingClientRect(), 0, 0);
			r = _.clone(els[i].getBoundingClientRect());
			r.top += window.scrollY; // - 0.5;
			r.left += window.scrollX; // - 0.5;
			// r.innerText = els[i].innerText;
			data.rects[i] = r;
		}
		// data.cssStyle = getComputedStyle(els[0]);
		// data.boxStyle = getBoxEdgeStyles(overlayData.cssStyle);
		// data.ctxStyle = {
		// 	font: [s.fontWeight, s.fontStyle, s.fontSize + "/" + s.lineHeight, s.fontFamily].join(" ")
		// };
		return data;
	},

	_drawLabelOverlays: function(data) {
		this._ctx.save();

		// CanvasView.setStyle(this._ctx, s);
		this._ctx.globalAlpha = 0.75;
		this._ctx.globalCompositeOperation = "destination-out";
		// this._ctx.canvas.style.letterSpacing = overlayData.cssStyle.letterSpacing;

		data.rects.forEach(function(r) {
			// this._ctx.clearRect(r.left, r.top, r.width, r.height);
			this._ctx.fillRect(r.left, r.top, r.width, r.height);
			// this._ctx.strokeText(r.innerText, r.left, r.top);
		}, this);

		this._ctx.restore();

		if (DEBUG) {
			if (this._debugGraph || this._debugBlocks) {
				data.rects.forEach(function(r) {
					r = inflateRect(r, 2, 2);
					CanvasHelper.drawRect(this._ctx, _dStyles["salmon"],
						r.left, r.top, r.width, r.height);
				}, this);
			}
		}
	},

	/* --------------------------- *
	 * connectors
	 * --------------------------- */

	_computeConnectors: function(d) {
		var sMin = d.xMin;
		var dMin = d.destMinX;
		var qx = d.qx;

		// var root = {};
		var p, points = [];
		var x1, y1, tx;
		var rBase, rInc;

		rBase = this._roundTo(d.s.radiusBase * this._rootFontSize, 0.5);
		rInc = this._roundTo(d.s.radiusIncrement * this._rootFontSize, 0.5);

		var sView, ddView, ddItems, ddNum, i;
		if (d.srcView.collection.selected && d.destView.filteredItems) {
			sView = d.srcView.itemViews.findByModel(d.srcView.collection.selected);

			var rect = sView.label.getBoundingClientRect();
			x1 = rect.left;
			y1 = rect.top + rect.height / 2;
			if (qx > 0) x1 += rect.width;
			x1 += window.scrollX;
			y1 += window.scrollY;

			// if (!sView._metrics) return;
			// x1 = d.rect.left + sView.transform.tx
			// 	+ sView._metrics.textLeft;
			// y1 = d.rect.top + sView.transform.ty
			// 	+ sView._metrics.offsetHeight / 2;
			// if (qx > 0) x1 += sView._metrics.textWidth;

			ddItems = d.destView.filteredItems;
			ddNum = d.destView.filteredItems.length;

			for (i = 0; i < ddNum; i++) {
				p = {};
				ddView = d.destView.itemViews.findByModel(ddItems[i]);

				rect = ddView.label.getBoundingClientRect();
				p.x2 = rect.left;
				p.y2 = rect.top + rect.height / 2;
				if (qx < 0) p.x2 += rect.width;
				p.x2 += window.scrollX;
				p.y2 += window.scrollY;

				// p.x2 = d.destRect.left + ddView.transform.tx
				// 	+ ddView._metrics.textLeft;
				// p.y2 = d.destRect.top + ddView.transform.ty
				// 	+ ddView._metrics.offsetHeight / 2;
				// if (qx < 0) p.x2 += ddView._metrics.textWidth;

				p.x1 = x1;
				p.y1 = y1;
				p.qx = qx;
				points[i] = p;
			}
			points.sort(function(a, b) {
				return a.y2 - b.y2;
			});
			var si = 0; // ssEl's number of items above in the Y axis
			var rMax0 = ddNum * 0.5 * rInc; // first arc (r0) max radius (cx0)
			var a; // cy1 offset from y1

			for (i = 0; i < ddNum; i++) {
				p = points[i];

				a = (i - (ddNum - 1) / 2) * rInc;
				p.cy1 = p.y1 + a;
				p.cy2 = p.y2;

				a = Math.abs(a);
				p.r0 = a;
				p.cx0 = p.x1 + (rMax0 - a) * qx;

				// p.dx = x1 - p.x2;
				// p.dy = y1 - p.y2;

				p.di = ((p.cy1 - p.y2) > 0) ? i : ddNum - (i + 1);
				si = Math.max(si, p.di);
			}

			// NOTE
			//sMin = p.x1 + (rMax0 * qx);

			for (i = 0; i < ddNum; i++) {
				p = points[i];
				p.r1 = p.di * rInc + rBase;
				p.r2 = rBase;
				// p.r2 = rBase + (si - p.di) * rInc;

				p.cx1 = sMin + (rMax0 * qx);
				p.cx2 = dMin - ((si - p.di) * rInc) * qx;
				// p.cx2 = dMin;

				tx = calcArcHConnector(p.cx1, p.cy1, p.r1, p.cx2, p.cy2, p.r2, 0.9);
				if (tx) {
					p.tx1 = tx[0];
					p.tx2 = tx[1];
				} else {
					p.tx1 = p.cx1;
					p.tx2 = p.cx2;
				}
				p.length = Math.abs(p.x1 - p.x2) + Math.abs(p.cy1 - p.cy2);

				// Find out longest node connection for setLineDash
				// root.maxLength = Math.max(root.maxLength, p.length);
			}
			points.sort(function(a, b) {
				return a.di - b.di; // Sort by distance to selected view
			});

			// root.x = x1;
			// root.y = y1;
			// root.qx = qx;
			// root.r0 = si * rInc;
		}
		// d.points = points;
		// d.root = root;
		// return d;
		return points;
	},

	_drawConnectors: function(pp, s, lVal, dir) {
		var i, ii, p;
		var ow, ra1, ra2, ta;

		if (!(pp && pp.length && lVal)) return;

		ii = pp.length;

		/* outline width */
		ow = s.lineWidth + s.outlineWidth;
		// ow = Math.min(
		// 	this._roundTo(s.radiusIncrement * this._rootFontSize, 0.5),
		// 	this._roundTo(s.lineWidth * (1 + s.outlineWidth), 0.5)
		// );

		/* arrow radiuses, direction */
		// ra1 = (s.radiusIncrement * this._rootFontSize) + s.lineWidth;
		ra1 = s.arrowSize * this._rootFontSize;
		ra2 = ra1 + (ow - s.lineWidth);
		ta = Math.PI * dir;
		// dir -= 2;

		this._setStyle(s);

		// if (lVal < 1) {
		// 	this._ctx.lineDashOffset = lMax * (1 + lVal);
		// 	this._ctx.setLineDash([lMax, lMax])
		// 	// this._ctx.lineDashOffset = lMax * (1 + lVal);;
		// 	// this._ctx.setLineDash([lMax * (1 - lVal), lMax]);
		// }

		// for (i = 0; i < ii; i++) {
		// p = pp[i];
		if (s.outlineWidth) {
			this._ctx.save();
			this._ctx.globalCompositeOperation = "destination-out";
			this._ctx.lineWidth = ow;
			for (i = 0; i < ii; i++) {
				p = pp[i];

				if (lVal < 1) {
					this._ctx.lineDashOffset = p.length * (1 + lVal);
					this._ctx.setLineDash([p.length, p.length])
				}
				this._drawConnector(p, i, pp);
				if (lVal == 1) {
					CanvasHelper.arrowhead(this._ctx, p.x2, p.y2, ra2, ta);
					this._ctx.fill();
				}
			}
			this._ctx.restore();
		}

		for (i = 0; i < ii; i++) {
			p = pp[i];
			if (lVal < 1) {
				this._ctx.lineDashOffset = p.length * (1 + lVal);
				this._ctx.setLineDash([p.length, p.length])
			}
			this._drawConnector(p, i, pp);
			if (lVal == 1) {
				CanvasHelper.arrowhead(this._ctx, p.x2, p.y2, ra1, dir * ta);
				this._ctx.fill();
			}
		}
	},

	_drawConnector: function(p, i, pp) {
		if (DEBUG) {
			if (this._debugGraph) {
				if (i == 0) {
					CanvasHelper.drawVGuide(this._ctx, _dStyles["grey"], p.x1);
					CanvasHelper.drawVGuide(this._ctx, _dStyles["grey"], p.cx1);
					CanvasHelper.drawHGuide(this._ctx, _dStyles["grey"], p.y1);
					CanvasHelper.drawCircle(this._ctx, _dStyles["midnightblue"], p.x1, p.y1, 10);
				}
				// CanvasHelper.drawVGuide(this._ctx, _dStyles["grey"], p.cx2);
				CanvasHelper.drawHGuide(this._ctx, _dStyles["grey"], p.cy2);
				// _dStyles[p.dy > 0 ? "lightgreen" : "salmon"], p.cy2);
			}
		}

		this._ctx.beginPath();
		this._ctx.moveTo(p.x2, p.cy2);
		this._ctx.arcTo(p.tx2, p.cy2, p.tx1, p.cy1, p.r2);
		this._ctx.arcTo(p.tx1, p.cy1, p.cx1, p.cy1, p.r1);
		this._ctx.arcTo(p.cx0, p.cy1, p.cx0, p.y1, p.r0);

		// p.cx00 = p.x1 + ((p.r0 + p.di) * p.qx);
		// p.cy00 = (p.cy1 + p.y1) / 2;
		// this._ctx.arcTo(p.cx00, p.cy1, p.cx00, p.cy00, p.r0 / 2);
		// this._ctx.arcTo(p.cx00, p.y1, p.x1, p.y1, p.r0 / 2);
		// this._ctx.lineTo(p.x1, p.y1);

		// p.cx00 = p.x1 + (p.r0 * p.qx * 2);
		// this._ctx.lineTo(p.cx00, p.cy1);
		// this._ctx.quadraticCurveTo(p.cx0, p.cy1, p.cx0, p.y1);

		// this._ctx.lineTo(p.cx0, p.y1);
		this._ctx.stroke();

		if (DEBUG) {
			if (this._debugGraph) {
				CanvasHelper.drawCrosshair(this._ctx, _dStyles["blue"],
					p.x1 + ((p.r0 + p.di) * p.qx), p.cy1, 3);
				CanvasHelper.drawSquare(this._ctx, _dStyles["midnightblue"], p.cx0, p.cy1, 2);
				CanvasHelper.drawCircle(this._ctx, _dStyles["blue"], p.cx1, p.cy1, 1);
				CanvasHelper.drawSquare(this._ctx, _dStyles["blue"], p.tx1, p.cy1, 2);
				CanvasHelper.drawSquare(this._ctx, _dStyles["green"], p.tx2, p.cy2, 2);
				CanvasHelper.drawCircle(this._ctx, _dStyles["green"], p.cx2, p.cy2, 1);

				CanvasHelper.drawCircle(this._ctx, _dStyles["olive"], p.x2, p.cy2, 3);
				CanvasHelper.drawCrosshair(this._ctx, _dStyles["olive"], p.x2, p.y2, 6);
			}
		}
	},

	_roundTo: function(n, p) {
		if (p > 1) p = 1 / p;
		return Math.round(n / p) * p;
	},

	/*
	_computeConnectors: function(d) {
		var rBase = d.s.radiusBase;
		var rInc = d.s.radiusIncrement;
		var sMin = d.xMin;
		var dMin = d.destMinX;

		var lMax = 0;
		var p, points = [];
		var qx, x1, y1, tx;
		var si; // ssEl's number of items above in the Y axis

		if (d.rect.right < d.destRect.left) {
			qx = 1;
		} else if (d.destRect.right < d.rect.left) {
			qx = -1;
		} else {
			qx = 0;
		}

		var ssEl, ddEls, ddNum, ssRect, ddRect, i;
		ssEl = d.srcView.el.querySelector(".list-item.selected .label");
		if (ssEl) {
			ssRect = ssEl.getBoundingClientRect();
			x1 = ssRect.left;
			if (qx > 0) x1 += ssRect.width;
			y1 = ssRect.top + ssRect.height / 2;
			// r2 = rBase;
			// cx1 = d.xMin;

			si = 0;
			ddEls = d.destView.el.querySelectorAll(".list-item:not(.excluded) .label");
			ddNum = ddEls.length;
			// dx = Math.abs(d.xMin - dData.xMin);

			for (i = 0; i < ddNum; i++) {
				p = {};
				ddRect = ddEls[i].getBoundingClientRect();
				p.x2 = ddRect.left;
				if (qx < 0) p.x2 += ddRect.width;
				p.y2 = ddRect.top + ddRect.height / 2;
				p.x1 = x1;
				p.y1 = y1;
				p.dx = p.x1 - p.x2;
				p.dy = p.y1 - p.y2;
				p.qx = qx;
				p.qy = Math.sign(p.dy);
				// p.dLength = Math.abs(p.x) + Math.abs(p.y);
				p.di = p.dy > 0 ? i : ddNum - (i + 1);
				si = Math.max(si, p.di);
				points[i] = p;
			}

			var a, rMax0 = ddNum * 0.5 * rInc;
			for (i = 0; i < ddNum; i++) {
				p = points[i];
				p.r1 = p.di * rInc + rBase;
				p.r2 = rBase;
				// p.r2 = (si - p.di) * rInc + rBase;

				p.cx1 = sMin;
				p.cx2 = dMin - ((si - p.di) * rInc) * qx;
				// p.cx2 = dMin;

				a = (i - (ddNum - 1) / 2) * rInc;
				p.cy1 = p.y1 + a;
				p.cy2 = p.y2;

				a = Math.abs(a);
				p.r0 = a;
				p.cx0 = p.x1 + (rMax0 - a) * qx;

				tx = calcArcHConnector(p.cx1, p.cy1, p.r1, p.cx2, p.cy2, p.r2, 0.8);
				p.tx1 = tx[0];
				p.tx2 = tx[1];

				// Find out longest node connection for setLineDash
				lMax = Math.max(lMax, Math.abs(p.x1 - p.x2) + Math.abs(p.cy1 - p.cy2));
			}
			// Sort by distance y1 (original) > cy1 (rInc offset) distance
			points.sort(function(a, b) {
				// return Math.abs(b.y1 - b.cy1) - Math.abs(a.y1 - a.cy1);
				// return a.r0 - b.r0;
				return b.di - a.di;
			});
		}
		d.points = points;
		d.maxLength = lMax;
		d.maxLength = qx;
	}, */

});

if (DEBUG) {
	// GraphView.prototype._logFlags = "";

	GraphView.prototype._traceScroll = function(type) {
		var tpl = "%s:[%s] DPR:%i " +
			"[window: %i %i] " +
			"[html: %i %i %i] " +
			"[body: %i %i %i] " +
			"[container: %i %i %i] " +
			"[graph: %i %i %i]";
		console.log(tpl, this.cid, type, this._canvasRatio,
			window.scrollY,
			window.pageYOffset,
			document.documentElement.clientHeight,
			document.documentElement.scrollTop,
			document.documentElement.scrollHeight,
			document.body.clientHeight,
			document.body.scrollTop,
			document.body.scrollHeight,
			document.body.firstElementChild.clientHeight,
			document.body.firstElementChild.scrollTop,
			document.body.firstElementChild.scrollHeight,
			this.el.clientHeight,
			this.el.scrollTop,
			this.el.scrollHeight
		);
	};

	var debouncedLog = _.debounce(_.bind(console.log, console), 500, true);
	var applyMethod = function(context, args) {
		return Array.prototype.shift.apply(args).apply(context, args);
	}
	if (GraphView.prototype._logFlags.split(" ")["view.render"]) {
		// GraphView.prototype._requestRender = _.wrap(CanvasView.prototype._requestRender, function(fn) {
		// 	debouncedLog("%s::_requestRender", this.cid);
		// 	return applyMethod(this, arguments);
		// });
		GraphView.prototype._applyRender = _.wrap(CanvasView.prototype._applyRender, function(fn) {
			var retval;
			this._logFlags["view.render"] = false;
			debouncedLog("%s::_applyRender [debounced]", this.cid);
			retval = applyMethod(this, arguments);
			this._logFlags["view.render"] = true;
			return retval;
		});
	}
}

module.exports = GraphView;
}).call(this,true)

},{"app/control/Globals":34,"app/view/base/CanvasView":56,"color":"color","underscore":"underscore","utils/canvas/CanvasHelper":106,"utils/canvas/calcArcHConnector":107,"utils/geom/inflateRect":111}],70:[function(require,module,exports){
/**
 * @module app/view/component/GroupingListView
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
// /** @type {module:backbone.babysitter} */
// var Container = require("backbone.babysitter");
// /** @type {module:app/view/base/View} */
// var View = require("app/view/base/View");
/** @type {module:app/view/component/FilterableListView} */
var FilterableListView = require("app/view/component/FilterableListView");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");
/** @type {module:app/view/render/LabelRenderer} */
var LabelRenderer = require("app/view/render/LabelRenderer");
// /** @type {module:utils/array/difference} */
// var diff = require("utils/array/difference");

/**
 * @constructor
 * @type {module:app/view/component/GroupingListView}
 */
var GroupingListView = FilterableListView.extend({

	/** @type {string} */
	cidPrefix: "groupingList",

	/** @override */
	tagName: "dl",

	/** @override */
	className: "grouped",

	/** @type {Function|null} empty array */
	_groupingFn: null, //function() { return null; },

	/** @override */
	defaults: _.defaults({
		// defaults: {
		renderer: ClickableRenderer.extend({
			/** @override */
			cidPrefix: "groupingListItem",
			/** @override */
			tagName: "dl",
			/** @override */
			className: "list-item list-label",
		}),
		groupingRenderer: LabelRenderer.extend({
			/** @override */
			cidPrefix: "groupingListGroup",
			/** @override */
			tagName: "dt",
			/** @override */
			className: "list-group list-label",
		}),
		groupingFn: null,
		// },
	}, FilterableListView.prototype.defaults),

	properties: {
		groups: {
			get: function() {
				return this._groups;
			}
		},
		filteredGroups: {
			get: function() {
				return this._filteredGroups;
			}
		},
	},

	/** @override */
	initialize: function(options) {
		FilterableListView.prototype.initialize.apply(this, arguments);

		this._groups = [];
		this._filteredGroups = [];
		this._changedFilteredGroups = [];
		this._groupsByItemCid = {};

		this._groupingFn = options.groupingFn;
		this.groupingRenderer = options.groupingRenderer;
		this._computeGroups();
		if (this._groupingFn) {
			this._groups.forEach(this.createGroupingView, this);
		}
	},

	/**
	 * Called once on collection change
	 * @private
	 */
	_computeGroups: function() {
		// this._groups = _.uniq(this.collection.map(this._groupingFn, this));
		this._groups.length = 0;
		// this._groupItems.length = 0;
		if (this._groupingFn) {
			this.collection.forEach(function(item) {
				var gIdx, gObj;
				gObj = this._groupingFn.apply(null, arguments);
				if (gObj) {
					gIdx = this._groups.indexOf(gObj);
					if (gIdx == -1) {
						gIdx = this._groups.length;
						this._groups[gIdx] = gObj;
						// this._groupItems[gIdx] = [];
					}
					// this._groupItems[gIdx].push(item);
				}
				this._groupsByItemCid[item.cid] = gObj;
			}, this);
		} else {
			this.collection.forEach(function(item) {
				this._groupsByItemCid[item.cid] = null;
			}, this);
		}
	},

	/** @private Create children views */
	createGroupingView: function(item) {
		var view = new this.groupingRenderer({
			model: item,
			el: this.el.querySelector(".list-group[data-id=\"" + item.id + "\"]")
		});
		this.itemViews.add(view);
		return view;
	},

	/* --------------------------- *
	/* Filter impl 1
	/* --------------------------- */

	/** @override */
	/*
	computeFilter_1: function() {
		FilterableListView.prototype.computeFilter_1.apply(this, arguments);

		if (this._groupingFn) {
			if (this._filteredItems.length == 0) {
				this._filteredGroups = [];
			} else {
				this._filteredGroups = _.uniq(this._filteredItems.map(function(item) {
					return this._groupsByItemCid[item.cid];
				}, this));
			}
		}
		// if (this._groupingFn) {
		// 	if (this._filteredItems.length == 0) {
		// 		this._filteredGroups = [];
		// 		this._groups.forEach(function(group) {
		// 			this.itemViews.findByModel(group).el.classList.remove("excluded");
		// 		}, this);
		// 	} else {
		// 		this._filteredGroups = _.uniq(this._filteredItems.map(function(item) {
		// 			return this._groupsByItemCid[item.cid];
		// 		}, this));
		// 		this._groups.forEach(function(group) {
		// 			this.itemViews.findByModel(group).el.classList.toggle("excluded", this._filteredGroups.indexOf(group) == -1);
		// 		}, this);
		// 	}
		// }
	},
	*/

	/* --------------------------- *
	/* Filter impl 2
	/* --------------------------- */

	// /** @override */
	// renderFilterFn_2: function() {
	// 	FilterableListView.prototype.renderFilterFn_2.apply(this, arguments);
	// },

	/** @override */
	computeFilter: function() {
		FilterableListView.prototype.computeFilter.apply(this, arguments);

		if (this._groupingFn) {
			if (this._filteredItems.length == 0) {
				this._filteredGroups = this._groups.concat(); //[];
			} else {
				this._filteredGroups = _.uniq(this._filteredItems.map(function(item) {
					return this._groupsByItemCid[item.cid];
				}, this));
			}
		}
	},

	/** @override */
	applyFilter: function() {
		FilterableListView.prototype.applyFilter.apply(this, arguments);

		this._groups.forEach(function(group) {
			this.itemViews.findByModel(group).el.classList.toggle("excluded", (this._filteredGroups.indexOf(group) == -1));
		}, this);
	},

	// computeFiltered: function() {
	// 	FilterableListView.prototype.computeFiltered.apply(this, arguments);
	// },
	//
	// renderFiltered: function() {
	// 	FilterableListView.prototype.renderFiltered.apply(this, arguments);
	// },

});

module.exports = GroupingListView;
},{"app/view/component/FilterableListView":68,"app/view/render/ClickableRenderer":84,"app/view/render/LabelRenderer":91,"underscore":"underscore"}],71:[function(require,module,exports){
/** @type {module:app/view/component/progress/CanvasProgressMeter} */
module.exports = require("app/view/component/progress/CanvasProgressMeter3");
/** @type {module:app/view/component/progress/SVGPathProgressMeter} */
// module.exports = require("app/view/component/progress/SVGPathProgressMeter");
/** @type {module:app/view/component/progress/SVGCircleProgressMeter} */
// module.exports = require("app/view/component/progress/SVGCircleProgressMeter");

},{"app/view/component/progress/CanvasProgressMeter3":73}],72:[function(require,module,exports){
/**
 * @module app/view/component/SelectableListView
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/DefaultSelectableRenderer} */
var DefaultSelectableRenderer = require("app/view/render/DefaultSelectableRenderer");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");

var SelectableListView = View.extend({

	/** @type {string} */
	cidPrefix: "selectableList",

	/** @override */
	tagName: "ul",

	/** @override */
	className: "list selectable",

	/** @type {module:app/view/component/DefaultSelectableRenderer} */
	renderer: DefaultSelectableRenderer,

	/** @override */
	initialize: function(options) {
		this._enabled = true;
		this._childrenInvalid = true;

		options.renderer && (this.renderer = options.renderer);
		this.showEmpty = !!options.showEmpty;
		this.itemViews = new Container();

		this.listenTo(this.collection, "add remove reset", this._onCollectionChange);
	},

	/** @override */
	remove: function() {
		this.removeChildren();
		View.prototype.remove.apply(this, arguments);
		return this;
	},

	_onCollectionChange: function(ev) {
		this._childrenInvalid = true;
		this.render();
	},

	/** @override */
	render: function() {
		if (this._childrenInvalid) {
			this._childrenInvalid = false;
			this.createChildren();
		}
		return this;
	},

	/** @override */
	setEnabled: function(enabled) {
		if (this._enabled !== enabled) {
			this._enabled = enabled;
			this.el.classList.toggle("disabled", !this._enabled);
		}
	},

	/* --------------------------- *
	/* Child views
	/* --------------------------- */

	createChildren: function() {
		var eltBuffer, view;

		this.removeChildren();
		this.el.innerHTML = "";

		if (this.collection.length) {
			eltBuffer = document.createDocumentFragment();
			if (this.showEmpty) {
				view = this.createEmptyView();
				eltBuffer.appendChild(view.render().el);
			}
			this.collection.each(function(model, index, arr) {
				view = this.createItemView(model, index);
				eltBuffer.appendChild(view.render().el);
			}, this);
			this.el.appendChild(eltBuffer);
		}
	},

	createItemView: function(model, index) {
		var view = new(this.renderer)({
			model: model
		});
		this.itemViews.add(view);
		this.listenTo(view, "renderer:click", this.onItemViewClick);
		return view;
	},

	removeChildren: function() {
		this.itemViews.each(this.removeItemView, this);
	},

	removeItemView: function(view) {
		this.stopListening(view);
		this.itemViews.remove(view);
		view.remove();
		return view;
	},

	/* --------------------------- *
	/* Child event handlers
	/* --------------------------- */

	/** @private */
	onItemViewClick: function(item) {
		if (this.collection.selected !== item && this._enabled) {
			this.trigger("view:select:one", item);
		}
	},

	/* --------------------------- *
	/* Empty view
	/* --------------------------- */

	createEmptyView: function() {
		var view = new SelectableListView.EmptyRenderer({
			model: this.collection
		});
		this.itemViews.add(view);
		this.listenTo(view, "renderer:click", function() {
			this._enabled && this.trigger("view:select:none");
		});
		return view;
	},
}, {
	EmptyRenderer: ClickableRenderer.extend({

		/** @override */
		tagName: "li",
		/** @override */
		className: "list-item empty-item",

		/** @override */
		initialize: function(options) {
			this.listenTo(this.model, "selected deselected", this.renderClassList);
			this.renderClassList();
		},

		/** @override */
		render: function() {
			this.el.innerHTML = "<a href=\"#clear\"><b> </b></a>";
			this.renderClassList();
			return this;
		},

		renderClassList: function() {
			this.el.classList.toggle("selected", this.model.selectedIndex === -1);
		},
	})
});

module.exports = SelectableListView;

},{"app/view/base/View":60,"app/view/render/ClickableRenderer":84,"app/view/render/DefaultSelectableRenderer":86,"backbone.babysitter":"backbone.babysitter"}],73:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/view/component/progress/CanvasProgressMeter
 */

// /** @type {module:underscore} */
// var _ = require("underscore");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
/** @type {module:app/view/base/CanvasView} */
var CanvasView = require("app/view/base/CanvasView");
// /** @type {module:app/view/base/Interpolator} */
// var Interpolator = require("app/view/base/Interpolator");

// var ARC_ERR = 0.00001;
// var ARC_ERR = 0.0;
// var PI = Math.PI;
var PI2 = Math.PI * 2;

var GAP_ARC = PI2 / 48;
// var CAP_SCALE = 2; // cap arc = GAP_ARC * CAP_SCALE
// var WAIT_CYCLE_VALUE = 1;
// var WAIT_CYCLE_MS = 300; // milliseconds per interpolation loop

var ARC_DEFAULTS = {
	"amount": {
		lineWidth: 0.8,
		radiusOffset: 0
	},
	"not-available": {
		lineWidth: 1.0,
		lineDash: [0.3, 0.7]
	},
	"available": {
		lineWidth: 0.8,
		inverse: "not-available"
	},
};

/**
 * @constructor
 * @type {module:app/view/component/progress/CanvasProgressMeter}
 */
module.exports = CanvasView.extend({

	/** @type {string} */
	cidPrefix: "canvasProgressMeter",
	/** @type {string} */
	className: "progress-meter canvas-progress-meter",

	defaultKey: "amount",

	defaults: {
		values: {
			amount: 0,
			available: 0,
			_loop: 0,
		},
		maxValues: {
			amount: 1,
			available: 1,
		},
		useOpaque: true,
		labelFn: function(value, max) {
			return ((value / max) * 100) | 0;
		},
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	initialize: function(options) {
		// TODO: cleanup options mess in CanvasView
		CanvasView.prototype.initialize.apply(this, arguments);
		// options = _.defaults(options, this.defaults);

		this._labelFn = options.labelFn;
		this._valueStyles = {};
		this._canvasSize = null;
		this._canvasOrigin = null;
	},

	measureCanvas: function(w, h) {
		this._canvasHeight = this._canvasWidth = Math.min(this._canvasWidth, this._canvasHeight);
	},

	_updateCanvas: function() {
		CanvasView.prototype._updateCanvas.apply(this, arguments);

		// size, lines, gaps, dashes (this._valueStyles, GAP_ARC, this._arcRadius)
		// --------------------------------
		var arcName, arcObj, arcDefault;
		var mapLineDash = function(n) {
			return n * this.radius * GAP_ARC;
		};
		var sumFn = function(s, n) {
			return s + n;
		};

		this._canvasSize = Math.min(this._canvasWidth, this._canvasHeight); // / this._canvasRatio;
		this._maxDashArc = 0;

		for (arcName in ARC_DEFAULTS) {
			arcDefault = ARC_DEFAULTS[arcName];
			arcObj = this._valueStyles[arcName] = {};
			arcObj.inverse = arcDefault.inverse; // copy inverse key
			// arcObj.inverse2 = arcDefault.inverse2;
			arcObj.lineWidth = arcDefault.lineWidth * this._canvasRatio;
			arcObj.radius = (this._canvasSize - arcObj.lineWidth) / 2;
			if (arcDefault.radiusOffset) {
				arcObj.radius += arcDefault.radiusOffset * this._canvasRatio;
			}
			if (arcDefault.lineDash && arcDefault.lineDash.length) {
				arcObj.lineDash = arcDefault.lineDash.map(mapLineDash, arcObj);
				arcObj.lineDashArc = arcDefault.lineDash[0] * GAP_ARC;
				arcObj.lineDashLength = arcObj.lineDash.reduce(sumFn);
				this._maxDashArc = Math.max(this._maxDashArc, arcObj.lineDashArc);
			} else {
				arcObj.lineDashArc = 0;
			}
		}

		// baselineShift
		// --------------------------------
		// NOTE: Center baseline: use ascent data to center to x-height, or sort-of.
		// with ascent/descent values (0.7, -0.3), x-height is 0.4
		var mObj = this._getFontMetrics(this._fontFamily);
		this._baselineShift = mObj ? (mObj.ascent + mObj.descent) / mObj.unitsPerEm : 0.7; // default value
		this._baselineShift *= this._fontSize * 0.5; // apply to font-size, halve it
		this._baselineShift = Math.round(this._baselineShift);

		// save canvas context
		// --------------------------------
		// reset matrix and translate 0,0 to center
		this._ctx.restore();
		this._ctx.setTransform(1, 0, 0, 1, this._canvasWidth / 2, this._canvasHeight / 2);
		this._ctx.save();
	},

	/* --------------------------- *
	/* private
	/* --------------------------- */

	/** @override */
	redraw: function(context, interpolator) {
		this._clearCanvas(-this._canvasWidth / 2, -this._canvasHeight / 2, this._canvasWidth, this._canvasHeight);

		var loopValue = interpolator._valueData["_loop"]._renderedValue || 0;
		var amountData = interpolator._valueData["amount"];
		var availableData = interpolator._valueData["available"];

		var amountStyle = this._valueStyles["amount"];
		var availableStyle = this._valueStyles["available"];

		// amount label
		// --------------------------------
		this.drawLabel(this._labelFn(amountData._renderedValue, amountData._maxVal));

		// save ctx before drawing arcs
		this._ctx.save();

		// loop rotation
		// --------------------------------
		// if (interpolator.renderedKeys && (interpolator.renderedKeys.indexOf("amount") !== -1)) {
		// 	console.log("%s::redraw (_loop) max: %s last: %s curr: %s", this.cid,
		// 		amountData._maxVal,
		// 		amountData._lastRenderedValue,
		// 		amountData._renderedValue
		// 	);
		// }
		if (interpolator.renderedKeys && (interpolator.renderedKeys.indexOf("amount") !== -1) && (amountData._lastRenderedValue > amountData._renderedValue)) {
			// trigger loop
			interpolator.valueTo(1, 0, "_loop");
			interpolator.valueTo(0, 750, "_loop");
			interpolator.updateValue("_loop");
		}
		this._ctx.rotate(PI2 * ((1 - loopValue) - 0.25));

		// amount arc
		// --------------------------------
		var amountGapArc = GAP_ARC;
		var amountEndArc = 0;
		var amountValue = loopValue + amountData._renderedValue / amountData._maxVal;

		if (amountValue > 0) {
			amountEndArc = this.drawArc(amountStyle, amountValue, amountGapArc, PI2 - amountGapArc);
			this.drawEndCap(amountStyle, amountEndArc);
			amountEndArc = amountEndArc + amountGapArc * 2;
		}

		// available arc
		// --------------------------------
		var stepsNum = availableData.length || 1;
		var stepBaseArc = PI2 / stepsNum;
		var stepAdjustArc = stepBaseArc % GAP_ARC;
		var stepGapArc = GAP_ARC + (stepAdjustArc - availableStyle.lineDashArc) / 2;

		if (Array.isArray(availableData)) {
			for (var o, i = 0; i < stepsNum; i++) {
				o = availableData[i];
				this.drawArc(availableStyle, o._renderedValue / (o._maxVal / stepsNum), (i * stepBaseArc) + stepGapArc, ((i + 1) * stepBaseArc) - stepGapArc, amountEndArc);
			}
		} else {
			this.drawArc(availableStyle, availableData._renderedValue / availableData._maxVal, stepGapArc, PI2 - stepGapArc, amountEndArc);
		}
		// restore ctx after drawing arcs
		this._ctx.restore();
	},

	drawArc: function(valueStyle, value, startArc, endArc, prevArc) {
		var valArc, invStyle,
			valStartArc, valEndArc,
			invStartArc, invEndArc;
		prevArc || (prevArc = 0);

		valArc = endArc - startArc;
		valEndArc = startArc + (valArc * value);
		valStartArc = Math.max(startArc, prevArc);
		if (valEndArc > valStartArc) {
			this._ctx.save();
			this.applyValueStyle(valueStyle);
			this._ctx.beginPath();
			this._ctx.arc(0, 0, valueStyle.radius, valEndArc, valStartArc, true);
			this._ctx.stroke();
			this._ctx.restore();
		}
		// if there's valueStyle, draw rest of span, minus prevArc overlap too
		if (valueStyle.inverse !== void 0) {
			invStyle = this._valueStyles[valueStyle.inverse];
			invEndArc = valEndArc + (valArc * (1 - value));
			invStartArc = Math.max(valEndArc, prevArc);
			if (invEndArc > invStartArc) {
				this._ctx.save();
				this.applyValueStyle(invStyle);
				this._ctx.beginPath();
				this._ctx.arc(0, 0, invStyle.radius, invEndArc, invStartArc, true);
				this._ctx.stroke();
				this._ctx.restore();
			}
		}
		return valEndArc;
	},

	applyValueStyle: function(styleObj) {
		this._ctx.lineWidth = styleObj.lineWidth;
		if (styleObj.lineDash) {
			this._ctx.setLineDash(styleObj.lineDash);
		}
		if (styleObj.lineDashOffset) {
			this._ctx.lineDashOffset = styleObj.lineDashOffset;
		}
	},

	drawLabel: function(labelString) {
		var labelWidth = this._ctx.measureText(labelString).width;
		this._ctx.fillText(labelString,
			labelWidth * -0.5,
			this._baselineShift, labelWidth);
	},

	drawEndCap: function(valueStyle, arcPos) {
		var radius = valueStyle.radius;
		this._ctx.save();
		this._ctx.lineWidth = valueStyle.lineWidth;

		this._ctx.rotate(arcPos - GAP_ARC * 1.5);
		this._ctx.beginPath();
		this._ctx.arc(0, 0, radius, GAP_ARC * 0.5, GAP_ARC * 2, false);
		this._ctx.lineTo(radius - (GAP_ARC * radius), 0);
		this._ctx.closePath();

		this._ctx.fill();
		this._ctx.stroke();
		this._ctx.restore();
	},
});

if (DEBUG) {
	module.exports.prototype._logFlags = "";
}
}).call(this,true)

},{"app/view/base/CanvasView":56}],74:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
var Color = require("color");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");

// - - - - - - - - - - - - - - - -
//  utils
// - - - - - - - - - - - - - - - -

function insertCSSRule(sheet, selector, style) {
	var cssText = "";
	for (var prop in style) {
		cssText += prop + ":" + style[prop] + ";";
	}
	sheet.insertRule(selector + "{" + cssText + "}", sheet.cssRules.length);
}

function selfAndDescendant(selfCls, cls) {
	return selfCls + " " + cls + ", " + selfCls + cls;
}

// - - - - - - - - - - - - - - - -
//  root rules
// - - - - - - - - - - - - - - - -

var rootStyles = [
	"color",
	"background",
	"background-color",
	// "--link-color"
];

function initRootStyles(sheet, rootSelector, attrs, fgColor, bgColor, lnColor, hasDarkBg) {
	var s, revSelector, fgColorVal, bgColorVal;
	// var revFgColorVal, revBgColorVal;

	s = _.pick(attrs, rootStyles);
	s["-webkit-font-smoothing"] = (hasDarkBg ? "antialiased" : "auto");
	/* NOTE: In Firefox '-moz-osx-font-smoothing: grayscale;'
	/* works both in light over dark and dark over light, hardcoded in _base.scss */
	//s["-moz-osx-font-smoothing"] = (hasDarkBg? "grayscale" : "auto");
	insertCSSRule(sheet, rootSelector, s);

	// A element
	// - - - - - - - - - - - - - - - -
	s = {}
	s["color"] = lnColor.rgbString();
	insertCSSRule(sheet, rootSelector + " a", s);
	insertCSSRule(sheet, rootSelector + " .color-ln", s);

	// .color-fg05
	// - - - - - - - - - - - - - - - -
	s = {};
	s["color"] = fgColor.clone().mix(bgColor, 0.5).rgbString();
	s["border-color"] = fgColor.clone().mix(bgColor, 0.7).rgbString();
	insertCSSRule(sheet, rootSelector + " .color-fg05", s);

	fgColorVal = fgColor.rgbString();
	bgColorVal = bgColor.rgbString();
	// revFgColorVal = bgColor.clone().mix(fgColor, 0.9).rgbString();
	// revBgColorVal = fgColor.clone().mix(bgColor, 0.6).rgbString();
	revSelector = rootSelector + " .color-reverse";

	// .color-fg .color-bg
	// - - - - - - - - - - - - - - - -
	s = {
		"color": fgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-fg", s);
	s = {
		"background-color": bgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-bg", s);
	// html inverted text/background
	s = {
		"color": bgColorVal
	}; // s = { "color" : revFgColorVal };
	s["-webkit-font-smoothing"] = (hasDarkBg ? "auto" : "antialiased");
	// insertCSSRule(sheet, revSelector + " .color-fg", s);
	// insertCSSRule(sheet, revSelector + ".color-fg", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-fg"), s);

	s = {
		"background-color": fgColorVal
	};
	// s = { "background-color" : revBgColorVal };
	// insertCSSRule(sheet, revSelector + " .color-bg", s);
	// insertCSSRule(sheet, revSelector + ".color-bg", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-bg"), s);

	// .color-stroke .color-fill (SVG)
	// - - - - - - - - - - - - - - - -
	s = {
		"stroke": fgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-stroke", s);
	s = {
		"fill": bgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-fill", s);
	// svg inverted fill/stroke
	s = {
		"stroke": bgColorVal
	};
	// insertCSSRule(sheet, revSelector + " .color-stroke", s);
	// insertCSSRule(sheet, revSelector + ".color-stroke", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-stroke"), s);
	s = {
		"fill": fgColorVal
	};
	// insertCSSRule(sheet, revSelector + " .color-fill", s);
	// insertCSSRule(sheet, revSelector + ".color-fill", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-fill"), s);

	// .text-outline
	// - - - - - - - - - - - - - - - -
	// s = {
	// 	"text-shadow": "-1px -1px 0 " + bgColorVal +
	// 		", 1px -1px 0 " + bgColorVal +
	// 		", -1px 1px 0 " + bgColorVal +
	// 		", 1px 1px 0 " + bgColorVal
	// };
	// insertCSSRule(sheet, rootSelector + " :not(..collapsed-changing) .text-outline-bg", s);

}

// - - - - - - - - - - - - - - - -
// carousel styles
// - - - - - - - - - - - - - - - -

var carouselStyles = ["box-shadow", "border", "border-radius"];

function initCarouselStyles(sheet, carouselSelector, attrs, fgColor, bgColor, lnColor, hasDarkBg) {
	var s = _.pick(attrs, carouselStyles); //, "background-color"]);
	insertCSSRule(sheet, carouselSelector + " .media-item .content", s);

	// .media-item .color-bg09
	// - - - - - - - - - - - - - - - -
	s = {};
	s["background-color"] = bgColor.clone().mix(fgColor, 0.95).rgbString();
	// s["background-color"] = bgColor.clone()[hasDarkBg ? "darken" : "lighten"](0.045).rgbString();
	// s["background-color"] = bgColor.clone()[hasDarkBg ? "lighten" : "darken"](0.03).rgbString();
	insertCSSRule(sheet, carouselSelector + " .media-item .color-bg09", s);

	// .media-item .placeholder
	// - - - - - - - - - - - - - - - -
	s = {};
	s["-webkit-font-smoothing"] = (hasDarkBg ? "auto" : "antialiased");
	// text color luminosity is inverse from body, apply oposite rendering mode
	s["color"] = bgColor.rgbString();
	// s["color"] = bgColor.clone()[hasDarkBg ? "darken" : "lighten"](0.045).rgbString();
	s["background-color"] = bgColor.clone().mix(fgColor, 0.95).rgbString();
	// s["background-color"] = bgColor.clone().mix(fgColor, 0.8).alpha(0.3).rgbaString();
	// s["background-color"] = bgColor.clone()[hasDarkBg ? "lighten" : "darken"](0.03).rgbString();
	("border-radius" in attrs) && (s["border-radius"] = attrs["border-radius"]);
	insertCSSRule(sheet, carouselSelector + " .media-item .placeholder", s);

	// .empty-item A
	// - - - - - - - - - - - - - - - -
	s = {};
	s["text-decoration-color"] = fgColor.clone().mix(bgColor, 0.3).rgbString();
	insertCSSRule(sheet, carouselSelector + " .empty-item A", s);
	// // .color-gradient
	// // - - - - - - - - - - - - - - - -
	// s = {};
	// s["background-color"] = "transparent";
	// s["background"] = "linear-gradient(to bottom, " +
	// 		bgColor.clone().alpha(0.00).rgbaString() + " 0%, " +
	// 		bgColor.clone().alpha(0.11).rgbaString() + " 100%)";
	// insertCSSRule(sheet, rootSelector + " .color-gradient", s);
	// s = {};
	// s["background-color"] = "transparent";
	// s["background"] = "linear-gradient(to bottom, " +
	// 		fgColor.clone().alpha(0.00).rgbaString() + " 0%, " +
	// 		fgColor.clone().alpha(0.11).rgbaString() + " 100%)";
	// insertCSSRule(sheet, revSelector + " .color-gradient", s);
	// insertCSSRule(sheet, revSelector + ".color-gradient", s);
}

module.exports = function() {
	var attrs, fgColor, bgColor, lnColor, hasDarkBg;

	attrs = Globals.DEFAULT_COLORS;
	fgColor = new Color(Globals.DEFAULT_COLORS["color"]);
	bgColor = new Color(Globals.DEFAULT_COLORS["background-color"]);
	lnColor = new Color(Globals.DEFAULT_COLORS["link-color"])
	hasDarkBg = fgColor.luminosity() > bgColor.luminosity();

	var colorStyles = document.createElement("style");
	colorStyles.id = "colors";
	colorStyles.type = "text/css";
	document.head.appendChild(colorStyles);
	// var colorStyles = document.querySelector("link#folio");

	initRootStyles(colorStyles.sheet, ".app",
		attrs, fgColor, bgColor, lnColor, hasDarkBg);
	initCarouselStyles(colorStyles.sheet, ".carousel",
		attrs, fgColor, bgColor, lnColor, hasDarkBg);

	// - - - - - - - - - - - - - - - -
	// per-bundle rules
	// - - - - - - - - - - - - - - - -
	bundles.each(function(bundle) {
		attrs = bundle.attrs(); //get("attrs");
		fgColor = bundle.colors.fgColor;
		bgColor = bundle.colors.bgColor;
		lnColor = bundle.colors.lnColor;
		hasDarkBg = bundle.colors.hasDarkBg;

		initRootStyles(colorStyles.sheet,
			".app." + bundle.get("domid"),
			attrs, fgColor, bgColor, lnColor, hasDarkBg);
		initCarouselStyles(colorStyles.sheet,
			".carousel." + bundle.get("domid"),
			attrs, fgColor, bgColor, lnColor, hasDarkBg);
	});
};
},{"app/control/Globals":34,"app/model/collection/BundleCollection":42,"color":"color","underscore":"underscore"}],75:[function(require,module,exports){
/*global XMLHttpRequest */

// var _ = require("underscore");
// /** @type {module:underscore.string/lpad} */
// var classify = require("underscore.string/classify");

// var statusMsg = _.template("<%= status %> received from <%= url %> (<%= statusText %>)");
// var errMsg = _.template("'<%= errName %>' ocurred during request <%= url %>");

if (window.XMLHttpRequest && window.URL && window.Blob) {
	module.exports = function(url, progressFn) {
		return new Promise(function(resolve, reject) {
			var request = new XMLHttpRequest();
			request.open("GET", url, true);
			// request.timeout = 10000; // in milliseconds
			request.responseType = "blob";

			// if progressFn is supplied
			// - - - - - - - - - - - - - - - - - -
			if (progressFn) {
				request.onprogress = function(ev) {
					progressFn(ev.loaded / ev.total);
				};
			}
			// resolved/success
			// - - - - - - - - - - - - - - - - - -
			request.onload = function(ev) {
				// When the request loads, check whether it was successful
				if (request.status == 200) {
					// If successful, resolve the promise by passing back a reference url
					resolve(URL.createObjectURL(request.response));
				} else {
					var err = new Error(("http_" + request.statusText.replace(/\s/g, "_")).toUpperCase());
					err.infoCode = request.status;
					err.infoSrc = url;
					err.logEvent = ev;
					err.logMessage = "_loadImageAsObjectURL::" + ev.type + " [reject]";
					reject(err);
				}
			};
			// reject/failure
			// - - - - - - - - - - - - - - - - - -
			request.onerror = function(ev) {
				var err = new Error((ev.type + "_event").toUpperCase());
				err.infoCode = -1;
				err.infoSrc = url;
				err.logEvent = ev;
				err.logMessage = "_loadImageAsObjectURL::" + ev.type + " [reject]";
				reject(err);
			};
			request.onabort = request.ontimeout = request.onerror;
			// finally
			// - - - - - - - - - - - - - - - - - -
			request.onloadend = function() {
				request.onabort = request.ontimeout = request.onerror = void 0;
				request.onload = request.onloadend = void 0;
				if (progressFn) {
					request.onprogress = void 0;
				}
			};

			request.send();
		});
	};
} else {
	module.exports = function(url) {
		return Promise.resolve(url);
	};
}
},{}],76:[function(require,module,exports){
module.exports = function(image, resolveEmpty) {
	return new Promise(function(resolve, reject) {
		if (!(image instanceof window.HTMLImageElement)) {
			//reject(new Error("not an HTMLImageElement"));
			reject("Error: not an HTMLImageElement");
		} else if (image.complete && (image.src.length > 0 || resolveEmpty)) {
			// if (image.src === "") console.warn("_whenImageLoads resolved with empty src");
			// else console.log("_whenImageLoads resolve-sync", image.src);
			resolve(image);
		} else {
			var handlers = {
				load: function(ev) {
					// console.log("_whenImageLoads_dom resolve-async", ev.type, image.src);
					removeEventListeners();
					resolve(image);
				},
				error: function(ev) {
					var err = new Error("Loading failed (" + ev.type + " event)");
					err.infoCode = -1;
					err.infoSrc = image.src;
					err.logEvent = ev;
					err.logMessage = "_whenImageLoads::" + ev.type + " [reject]";
					removeEventListeners();
					reject(err);
				}
			};
			handlers.abort = handlers.error;
			var removeEventListeners = function() {
				for (var event in handlers) {
					if (handlers.hasOwnProperty(event)) {
						image.removeEventListener(event, handlers[event], false);
					}
				}
			};
			for (var event in handlers) {
				if (handlers.hasOwnProperty(event)) {
					image.addEventListener(event, handlers[event], false);
				}
			}
		}
	});
};

},{}],77:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:app/view/promise/_whenImageLoads} */
var _whenImageLoads = require("app/view/promise/_whenImageLoads");
/** @type {module:app/view/promise/_loadImageAsObjectURL} */
var _loadImageAsObjectURL = require("app/view/promise/_loadImageAsObjectURL");

// var isBlobRE = /^blob\:.*/;

// var logMessage = "%s::whenDefaultImageLoads [%s]: %s";

module.exports = function(view) {
	return new Promise(function(resolve, reject) {
		var source = view.model.get("source");
		if (source.has("prefetched")) {
			view.defaultImage.src = source.get("prefetched");
			_whenImageLoads(view.defaultImage)
				.then(
					function(targetEl) {
						// console.log(logMessage, view.cid, "resolved", "prefetched");
						resolve(view);
					});
		} else {
			view.mediaState = "pending";

			var sUrl = source.get("original");
			var progressFn = function(progress) {
				// console.log(logMessage, view.cid, "progress", progress);
				view.updateMediaProgress(progress, sUrl);
			};
			progressFn = _.throttle(progressFn, 100, {
				leading: true,
				trailing: false
			});
			_loadImageAsObjectURL(sUrl, progressFn)
				.then(
					function(url) {
						if (/^blob\:.*/.test(url)) {
							source.set("prefetched", url);
						}
						view.defaultImage.src = url;
						// URL.revokeObjectURL(url);
						return view.defaultImage;
					})
				.then(_whenImageLoads)
				.then(
					function(targetEl) {
						// console.log(logMessage, view.cid, "resolved", targetEl.src);
						view.on("view:removed", function() {
							var prefetched = source.get("prefetched");
							if (prefetched && /^blob\:/.test(prefetched)) {
								source.unset("prefetched", {
									silent: true
								});
								URL.revokeObjectURL(prefetched);
							}
						});
						// view.placeholder.removeAttribute("data-progress");
						// view.updateMediaProgress(imageUrl, "complete");
						resolve(view);
					},
					// 	})
					// .catch(
					function(err) {
						// console.warn(logMessage, view.cid, "rejected", err.message);
						// view.placeholder.removeAttribute("data-progress");
						// view.updateMediaProgress(imageUrl, progress);
						reject(err);
					});
		}
	});
};
},{"app/view/promise/_loadImageAsObjectURL":75,"app/view/promise/_whenImageLoads":76,"underscore":"underscore"}],78:[function(require,module,exports){
/* global Promise */
/** @type {module:app/view/base/ViewError} */
var ViewError = require("app/view/base/ViewError");

/** @type {module:app/view/base/ViewError} */
var whenViewIsAttached = require("app/view/promise/whenViewIsAttached");

function whenScrollingEnds(view) {
	return new Promise(function(resolve, reject) {
		var parent = view.parentView;
		if (parent === null) {
			console.error("%s::whenScrollingEnds [%s] (sync)", view.cid, "rejected", view.attached);
			reject(new ViewError(view, new Error("whenScrollingEnds: view has no parent")));
		} else if (!parent.scrolling) {
			// console.log("%s::whenScrollingEnds [%s] (sync)", view.cid, "resolved", view.attached);
			resolve(view);
		} else {
			var cleanup = function() {
				parent.off("view:scrollend", onScrollend);
				parent.off("view:remove", onRemove);
			};
			var onScrollend = function() {
				// console.log("%s::whenScrollingEnds [%s]", view.cid, "resolved", view.attached);
				cleanup();
				resolve(view);
			};
			var onRemove = function() {
				// console.log("%s::whenScrollingEnds [%s]", view.cid, "rejected", view.attached);
				cleanup();
				reject(new ViewError(view, new Error("whenScrollingEnds: view was removed")));
			};
			parent.on("view:scrollend", onScrollend);
			parent.on("view:remove", onRemove);
		}
	});
}

module.exports = function(view) {
	return Promise.resolve(view)
		.then(whenViewIsAttached)
		.then(whenScrollingEnds);
};

/*
module.exports = function(view) {
	return Promise.resolve(view)
		.then(function(view) {
			if (view.attached) {
				return view;
			} else {
				return new Promise(function(resolve, reject) {
					view.once("view:attached", function(view) {
						resolve(view);
					});
				});
			}
		})
		.then(function(view) {
			if (!view.parentView.scrolling) {
				return view;
			} else {
				return new Promise(function(resolve, reject) {
					var resolveOnScrollend = function() {
						// console.log("%s::whenScrollingEnds [%s]", view.cid, "resolved");
						view.off("view:remove", rejectOnRemove);
						resolve(view);
					};
					var rejectOnRemove = function(view) {
						// console.log("%s::whenScrollingEnds [%s]", view.cid, "rejected");
						view.parentView.off("view:scrollend", resolveOnScrollend);
						reject(new ViewError(view,
							new Error("whenSelectScrollingEnds: view was removed ("+ view.cid +")")));
					};
					view.parentView.once("view:scrollend", resolveOnScrollend);
					view.once("view:remove", rejectOnRemove);
				});
			}
		});
};
*/

},{"app/view/base/ViewError":61,"app/view/promise/whenViewIsAttached":81}],79:[function(require,module,exports){
/** @type {module:app/view/base/ViewError} */
var ViewError = require("app/view/base/ViewError");

// var logMessage = "%s::whenSelectionDistanceIs [%s]: %s";

/**
 * @param {module:app/view/base/View}
 * @param {number} distance
 */
module.exports = function(view, distance) {
	return new Promise(function(resolve, reject) {
		// if (!(view.model && view.model.collection)) {
		// 	reject(new ViewError(view, new Error("whenSelectionIsContiguous: model.collection is empty")));
		// }
		var model = view.model;
		var collection = model.collection;

		var check = function(n) { // Check indices for contiguity
			return Math.abs(collection.indexOf(model) - collection.selectedIndex) <= distance;
		};

		if (check()) {
			// console.log(logMessage, view.cid, "resolve", "sync");
			resolve(view);
		} else {
			var cleanupOnSettle = function() {
				// console.log(logMessage, view.cid, "cleanup", "async");
				collection.off("select:one select:none", resolveOnSelect);
				view.off("view:removed", rejectOnRemove);
			};
			var resolveOnSelect = function(model) {
				if (check()) {
					// console.log(logMessage, view.cid, "resolve", "async");
					cleanupOnSettle();
					resolve(view);
				}
			};
			var rejectOnRemove = function(view) {
				cleanupOnSettle();
				reject(new ViewError(view, new Error("whenSelectionDistanceIs: view was removed")));
			};
			collection.on("select:one select:none", resolveOnSelect);
			view.on("view:removed", rejectOnRemove);
		}
	});
};

},{"app/view/base/ViewError":61}],80:[function(require,module,exports){
// /** @type {module:app/view/base/ViewError} */
// var ViewError = require("app/view/base/ViewError");

/** @type {module:app/view/promise/whenSelectionDistanceIs} */
var whenSelectionDistanceIs = require("app/view/promise/whenSelectionDistanceIs");

/** @param {module:app/view/base/View} */
module.exports = function(view) {
	return whenSelectionDistanceIs(view, 1);
};
},{"app/view/promise/whenSelectionDistanceIs":79}],81:[function(require,module,exports){
module.exports = function(view) {
	return new Promise(function(resolve, reject) {
		if (view.attached) {
			resolve(view);
		} else {
			view.on("view:attached", function(view) {
				resolve(view);
			});
		}
	});
};

},{}],82:[function(require,module,exports){
module.exports = function(view) {
	return new Promise(function(resolve, reject) {
		if (!view.invalidated) {
			resolve(view);
		} else {
			view.once("view:render:after", function(view, flags) {
				resolve(view);
			});
		}
	});
};
},{}],83:[function(require,module,exports){
/**
 * @module app/view/render/CarouselRenderer
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:underscore} */
var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

// FIXME: this fixup should not be done here
// /** @type {module:utils/net/toAbsoluteURL} */
// var toAbsoluteURL = require("utils/net/toAbsoluteURL");
// /** @type {string} */
// var ABS_APP_ROOT = toAbsoluteURL(require("app/control/Globals").APP_ROOT);

/**
 * @constructor
 * @type {module:app/view/render/CarouselRenderer}
 */
var CarouselRenderer = View.extend({

	/** @type {string} */
	cidPrefix: "carouselRenderer",
	/** @override */
	tagName: "div",
	/** @override */
	className: "carousel-item",
	/** @override */
	template: _.template("<div class=\"content sizing\"><%= name %></div>"),

	properties: {
		content: {
			get: function() {
				return this._content || (this._content = this.el.querySelector(".content"));
			},
		},
		sizing: {
			get: function() {
				return this._sizing || (this._sizing = this.el.querySelector(".sizing"));
			},
		}
	},

	/** @override */
	initialize: function(options) {
		if (this.model.attr("@classname") !== void 0) {
			var clsAttr = this.model.attr("@classname").split(" ");
			for (var i = 0; i < clsAttr.length; i++) {
				this.el.classList.add(clsAttr[i]);
			}
		}
		options.parentView && (this.parentView = options.parentView);
		this.metrics = {};
		this.metrics.content = {};
		this.createChildren();
		// this.enabled = !!options.enabled; // force bool
		this.setEnabled(!!options.enabled);
	},

	createChildren: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
		// FIXME: this fixup should not be done here
		// FIXED: now done in xslt
		/*this.el.querySelectorAll("a[href]").forEach(function(el) {
			var url = toAbsoluteURL(el.getAttribute("href"));
			if (url.indexOf(ABS_APP_ROOT) !== 0) {
				el.setAttribute("target", "_blank");
			}
		});*/
	},

	/** @return {HTMLElement} */
	getSizingEl: function() {
		return this._sizing || (this._sizing = this.el.querySelector(".sizing"));
	},

	/** @return {HTMLElement} */
	getContentEl: function() {
		return this._content || (this._content = this.el.querySelector(".content"));
	},

	/** @return {this} */
	measure: function() {
		var sizing = this.getSizingEl();

		this.metrics = getBoxEdgeStyles(this.el, this.metrics);
		this.metrics.content = getBoxEdgeStyles(this.getContentEl(), this.metrics.content);

		sizing.style.maxWidth = "";
		sizing.style.maxHeight = "";

		this.metrics.content.x = sizing.offsetLeft + sizing.clientLeft;
		this.metrics.content.y = sizing.offsetTop + sizing.clientTop;
		this.metrics.content.width = sizing.clientWidth;
		this.metrics.content.height = sizing.clientHeight;

		return this;
	},

	/** @override */
	render: function() {
		this.measure();
		return this;
	},

	getSelectionDistance: function() {
		return Math.abs(this.model.collection.indexOf(this.model) - this.model.collection.selectedIndex);
	},
});

module.exports = CarouselRenderer;
},{"app/view/base/View":60,"underscore":"underscore","utils/css/getBoxEdgeStyles":108}],84:[function(require,module,exports){
/**
 * @module app/view/render/ClickableRenderer
 */

/** @type {module:app/view/render/LabelRenderer} */
var LabelRenderer = require("app/view/render/LabelRenderer");

/**
 * @constructor
 * @type {module:app/view/render/ClickableRenderer}
 */
var ClickableRenderer = LabelRenderer.extend({

	/** @type {string} */
	cidPrefix: "clickableRenderer",

	/** @override */
	events: {
		"click": function(ev) {
			this.trigger("renderer:click", this.model, ev);
		},
		"click a": function(ev) {
			ev.defaultPrevented || ev.preventDefault();
		}
	},
});

module.exports = ClickableRenderer;

},{"app/view/render/LabelRenderer":91}],85:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function";

  return "<a href=\"#"
    + container.escapeExpression(((helper = (helper = helpers.domid || (depth0 != null ? depth0.domid : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"domid","hash":{},"data":data}) : helper)))
    + "\"><span class=\"label\">"
    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</span></a>";
},"useData":true});

},{"hbsfy/runtime":20}],86:[function(require,module,exports){
/**
 * @module app/view/render/DefaultSelectableRenderer
 */

/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");

/**
 * @constructor
 * @type {module:app/view/render/DefaultSelectableRenderer}
 */
var DefaultSelectableRenderer = ClickableRenderer.extend({

	/** @override */
	tagName: "li",
	/** @override */
	className: "list-item",
	/** @override */
	template: require("./DefaultSelectableRenderer.hbs"),

	initialize: function(options) {
		this.listenTo(this.model, "selected deselected", this._renderClassList);
		this._renderClassList();
	},

	/** @override */
	render: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
		this._renderClassList();
		return this;
	},

	_renderClassList: function() {
		this.el.classList.toggle("selected", this.model.selected);
	},
});

module.exports = DefaultSelectableRenderer;

},{"./DefaultSelectableRenderer.hbs":85,"app/view/render/ClickableRenderer":84}],87:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<span class=\"label\">"
    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper)))
    + "</span><a href=\"#"
    + alias4(((helper = (helper = helpers.domid || (depth0 != null ? depth0.domid : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"domid","hash":{},"data":data}) : helper)))
    + "\"><b> </b></a>";
},"useData":true});

},{"hbsfy/runtime":20}],88:[function(require,module,exports){
/**
 * @module app/view/render/DotNavigationRenderer
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {string} */
var viewTemplate = require("./DotNavigationRenderer.hbs");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");

/**
 * @constructor
 * @type {module:app/view/render/DotNavigationRenderer}
 */
var DotNavigationRenderer = ClickableRenderer.extend({

	/** @type {string} */
	cidPrefix: "dotRenderer",
	/** @override */
	tagName: "li",
	/** @override */
	className: "list-item",
	/** @override */
	template: viewTemplate,

	/** @override */
	initialize: function(options) {
		this.listenTo(this.model, "selected deselected", this.renderClassList);
		this.renderClassList();
	},

	/** @override */
	render: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
		this.renderClassList();
		return this;
	},

	renderClassList: function() {
		this.el.classList.toggle("selected", this.model.selected);
	},
});

module.exports = DotNavigationRenderer;

},{"./DotNavigationRenderer.hbs":87,"app/view/render/ClickableRenderer":84}],89:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<div class=\"placeholder sizing\"></div>\n<img class=\"content media-border default\" alt=\""
    + alias4(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"text","hash":{},"data":data}) : helper)))
    + "\" longdesc=\"#desc_m"
    + alias4(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" />\n";
},"useData":true});

},{"hbsfy/runtime":20}],90:[function(require,module,exports){
/**
 * @module app/view/render/ImageRenderer
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
// /** @type {module:app/model/item/MediaItem} */
// var MediaItem = require("app/model/item/MediaItem");

/** @type {module:app/view/MediaRenderer} */
var MediaRenderer = require("./MediaRenderer");

/** @type {Function} */
var viewTemplate = require("./ImageRenderer.hbs");

/**
 * @constructor
 * @type {module:app/view/render/ImageRenderer}
 */
var ImageRenderer = MediaRenderer.extend({

	/** @type {string} */
	cidPrefix: "imageRenderer",
	/** @type {string} */
	className: MediaRenderer.prototype.className + " image-renderer",
	/** @type {Function} */
	template: viewTemplate,

	/** @override */
	initialize: function(opts) {
		MediaRenderer.prototype.initialize.apply(this, arguments);
		// this.createChildren();
		// this.initializeAsync();
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	createChildren: function() {
		MediaRenderer.prototype.createChildren.apply(this, arguments);
		// this.el.innerHTML = this.template(this.model.toJSON());
		this.placeholder = this.el.querySelector(".placeholder");
	},

	/** @override */
	render: function() {
		MediaRenderer.prototype.render.apply(this, arguments);

		// this.measure();

		var img = this.getDefaultImage();
		img.setAttribute("width", this.metrics.media.width);
		img.setAttribute("height", this.metrics.media.height);

		var content = this.getContentEl();
		content.style.left = this.metrics.content.x + "px";
		content.style.top = this.metrics.content.y + "px";

		// var sizing = this.getSizingEl();
		// sizing.style.maxWidth = this.metrics.content.width + "px";
		// sizing.style.maxHeight = this.metrics.content.height + "px";

		return this;
	},

	/* --------------------------- *
	/* initializeAsync
	/* --------------------------- */

	initializeAsync: function() {
		return MediaRenderer.prototype.initializeAsync.apply(this, arguments)
		// return MediaRenderer.whenSelectionIsContiguous(this)
		// // return Promise.resolve(this)
		// // 	.then(MediaRenderer.whenSelectionIsContiguous)
		// 	.then(MediaRenderer.whenSelectTransitionEnds)
		// 	.then(MediaRenderer.whenDefaultImageLoads)
		// .then(
		// 	function(view) {
		// 		view.mediaState = "ready";
		// 	})
		// .catch(
		// 	function(err) {
		// 		if (err instanceof ViewError) {
		// 			// NOTE: ignore ViewError type
		// 			// console.log(err.view.cid, err.view.model.cid, "ImageRenderer: " + err.message);
		// 		} else {
		// 			console.error(this.cid, err.name, err);
		// 			this.placeholder.innerHTML = "<p class=\"color-fg\" style=\"position:absolute;bottom:0;padding:3rem;\"><strong>" + err.name + "</strong> " + err.message + "</p>";
		// 			this.mediaState = "error";
		// 		}
		// 	}.bind(this))
		;
	},
});

module.exports = ImageRenderer;

},{"./ImageRenderer.hbs":89,"./MediaRenderer":92}],91:[function(require,module,exports){
/**
 * @module app/view/render/LabelRenderer
 */

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");

/**
 * @constructor
 * @type {module:app/view/render/LabelRenderer}
 */
var LabelRenderer = View.extend({

	/** @type {string} */
	cidPrefix: "labelRenderer",

	properties: {
		label: {
			get: function() {
				return this._label || (this._label = this.el.querySelector(".label"));
			}
		}
		// measuredWidth: {
		// 	get: function() {
		// 		return this._measuredWidth;
		// 	}
		// },
		// measuredHeight: {
		// 	get: function() {
		// 		return this._measuredHeight;
		// 	}
		// },
	},

	/* -------------------------------
	/* measure
	/* ------------------------------- */

	// _measuredWidth: null,
	// _measuredHeight: null,
	// measure: function() {},
});

module.exports = LabelRenderer;

},{"app/view/base/View":60}],92:[function(require,module,exports){
(function (DEBUG){
/*global XMLHttpRequest, HTMLMediaElement, MediaError*/
/**
 * @module app/view/render/MediaRenderer
 */

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:underscore.strings/lpad} */
var lpad = require("underscore.string/lpad");
// /** @type {module:utils/css/getBoxEdgeStyles} */
// var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

/** @type {module:app/model/item/MediaItem} */
var MediaItem = require("app/model/item/MediaItem");
/** @type {module:app/view/CarouselRenderer} */
var CarouselRenderer = require("app/view/render/CarouselRenderer");

var errorTemplate = require("../template/ErrorBlock.hbs");

var MediaRenderer = CarouselRenderer.extend({

	/** @type {string} */
	cidPrefix: "mediaRenderer",
	/** @type {string} */
	className: CarouselRenderer.prototype.className + " media-item",
	/** @type {module:app/model/MediaItem} */
	model: MediaItem,

	properties: {
		defaultImage: {
			get: function() {
				return this._defaultImage || (this._defaultImage = this.el.querySelector("img.default"));
			}
		},
		mediaState: {
			get: function() {
				return this._mediaState;
			},
			set: function(state) {
				this._setMediaState(state);
			}
		}
	},

	/** @override */
	initialize: function(opts) {
		// if (this.model.attrs().hasOwnProperty("@classname")) {
		// 	this.el.className += " " + this.model.attr("@classname");
		// }

		// NOTE: @classname attr handling moved to CarouselRenderer
		// if (this.model.attr("@classname") !== void 0) {
		// 	var clsAttr = this.model.attr("@classname").split(" ");
		// 	for (var i = 0; i < clsAttr.length; i++) {
		// 		this.el.classList.add(clsAttr[i]);
		// 	}
		// }
		CarouselRenderer.prototype.initialize.apply(this, arguments);

		this.metrics.media = {};
		this.mediaState = "idle";

		this.initializeAsync()
			.then(this.whenInitialized)
			.catch(this.whenInitializeError.bind(this));
	},

	initializeAsync: function() {
		// var MediaRenderer = Object.getPrototypeOf(this).constructor;
		return Promise.resolve(this)
			.then(MediaRenderer.whenSelectionIsContiguous)
			.then(MediaRenderer.whenScrollingEnds)
			.then(MediaRenderer.whenDefaultImageLoads);
	},

	whenInitialized: function(view) {
		// console.log("%s::whenInitialized [%s]", view.cid, "resolved");
		view.mediaState = "ready";
		view.placeholder.removeAttribute("data-progress");
		return view;
	},

	whenInitializeError: function(err) {
		if (err instanceof CarouselRenderer.ViewError) {
			// NOTE: ignore ViewError type
			// console.log("%s::whenInitializeError", err.view.cid, err.message);
			return;
		} else if (err instanceof Error) {
			console.error(err.stack);
		}
		this.renderMediaError(err);
		this.placeholder.removeAttribute("data-progress");
		this.mediaState = "error";
		// this.placeholder.innerHTML = errorTemplate(err);
		// this.placeholder.removeAttribute("data-progress");
		// this.mediaState = "error";

		console.error("%s::initializeAsync [%s (caught)]: %s", this.cid, err.name,
			(err.info && err.info.logMessage) || err.message);
		err.logEvent && console.log(err.logEvent);
	},

	renderMediaError: function(err) {
		this.placeholder.innerHTML = err ? errorTemplate(err) : "";
	},

	updateMediaProgress: function(progress, id) {
		if (_.isNumber(progress)) {
			this.placeholder.setAttribute("data-progress", lpad(Math.floor(progress * 100), 2, '0'));
		}
		// else if (progress === "complete") {
		// 	this.placeholder.removeAttribute("data-progress");
		// }
	},

	// whenMediaIsReady: function(view) {
	// 	return MediaRenderer.whenDefaultImageLoads(this, this.updateMediaProgress.bind(this));
	// },

	/* --------------------------- *
	/* child getters
	/* --------------------------- */

	/** @return {HTMLElement} */
	getDefaultImage: function() {
		return this.defaultImage;
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	createChildren: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
	},

	/** @override */
	measure: function() {
		CarouselRenderer.prototype.measure.apply(this, arguments);

		var sw, sh; // source dimensions
		var pcw, pch; // measured values
		var cx, cy, cw, ch, cs; // computed values
		var ew, eh; // content edge totals
		var cm; // content metrics

		cm = this.metrics.content;
		cx = cm.x;
		cy = cm.y;
		pcw = cm.width;
		pch = cm.height;

		ew = (cm.paddingLeft + cm.paddingRight + cm.borderLeftWidth + cm.borderRightWidth);
		eh = (cm.paddingTop + cm.paddingBottom + cm.borderTopWidth + cm.borderBottomWidth);
		pcw -= ew;
		pch -= eh;

		sw = this.model.get("source").get("w");
		sh = this.model.get("source").get("h");

		// Unless both client dimensions are larger than the source's
		// choose constraint direction by aspect ratio
		if (sw < pcw && sh < pch) {
			cs = 1;
			cw = sw;
			ch = sh;
			this.metrics.fitDirection = "both";
		} else if ((pcw / pch) < (sw / sh)) {
			// fit width
			cw = pcw;
			cs = cw / sw;
			// ch = cs * sh;
			ch = Math.round(cs * sh);
			this.metrics.fitDirection = "width";
		} else {
			// fit height
			ch = pch;
			cs = ch / sh;
			// cw = cs * sw;
			cw = Math.round(cs * sw);
			this.metrics.fitDirection = "height";
		}

		this.metrics.content.x = cx;
		this.metrics.content.y = cy;
		this.metrics.content.width = cw + ew;
		this.metrics.content.height = ch + eh;

		this.metrics.media.x = cx + cm.paddingLeft + cm.borderLeftWidth;
		this.metrics.media.y = cy + cm.paddingTop + cm.borderTopWidth;
		this.metrics.media.width = cw;
		this.metrics.media.height = ch;
		this.metrics.media.scale = cs;

		console.log("%s::measure mw:%s mh:%s fit: %s metrics: %o", this.cid, pcw, pch, this.metrics.fitDirection, this.metrics);
		// var sizing = this.getSizingEl();
		// sizing.style.maxWidth = (cw + ew) + "px";
		// sizing.style.maxHeight = (ch + eh) + "px";

		return this;
	},

	render: function() {
		// NOTE: not calling super.render, calling measure ourselves
		this.measure();

		var sizing = this.getSizingEl();
		sizing.style.maxWidth = this.metrics.content.width + "px";
		sizing.style.maxHeight = this.metrics.content.height + "px";

		this.el.setAttribute("data-fit-dir", this.metrics.fitDirection);

		return this;
	},

	/* --------------------------- *
	/* mediaState
	/* --------------------------- */

	_mediaStateEnum: ["idle", "pending", "ready", "error"],

	_setMediaState: function(key) {
		if (this._mediaStateEnum.indexOf(key) === -1) {
			throw new Error("Argument " + key + " invalid. Must be one of: " + this._mediaStateEnum.join(", "));
		}
		if (this._mediaState !== key) {
			if (this._mediaState) {
				this.el.classList.remove(this._mediaState);
			}
			this.el.classList.add(key);
			this._mediaState = key;
			this.trigger("media:" + key);
		}
	},
}, {
	LOG_TO_SCREEN: true,

	/** @type {module:app/view/promise/whenSelectionIsContiguous} */
	whenSelectionIsContiguous: require("app/view/promise/whenSelectionIsContiguous"),

	// /** @type {module:app/view/promise/whenSelectTransitionEnds} */
	// whenSelectTransitionEnds: require("app/view/promise/whenSelectTransitionEnds"),

	/** @type {module:app/view/promise/whenScrollingEnds} */
	whenScrollingEnds: require("app/view/promise/whenScrollingEnds"),

	/** @type {module:app/view/promise/whenDefaultImageLoads} */
	whenDefaultImageLoads: require("app/view/promise/whenDefaultImageLoads"),
});

/* ---------------------------
/* log to screen
/* --------------------------- */
if (DEBUG) {

	MediaRenderer = (function(MediaRenderer) {
		if (!MediaRenderer.LOG_TO_SCREEN) return MediaRenderer;

		/** @type {Function} */
		var Color = require("color");
		// /** @type {module:underscore.string/lpad} */
		// var lpad = require("underscore.string/lpad");
		// /** @type {module:underscore.string/rpad} */
		// var rpad = require("underscore.string/rpad");

		return MediaRenderer.extend({

			/** @override */
			initialize: function() {
				MediaRenderer.prototype.initialize.apply(this, arguments);

				var fgColor = new Color(this.model.attr("color"));
				var bgColor = new Color(this.model.attr("background-color"));
				this.__logColors = {
					normal: fgColor.clone().mix(bgColor, 0.75).hslString(),
					ignored: fgColor.clone().mix(bgColor, 0.25).hslString(),
					error: "brown",
					abort: "orange"
				};
				this.__logFrameStyle = "1px dashed " + fgColor.clone().mix(bgColor, 0.5).hslString();
				this.__logStartTime = Date.now();
				this.__rafId = -1;
				this.__onFrame = this.__onFrame.bind(this);
			},

			initializeAsync: function() {
				return MediaRenderer.prototype.initializeAsync.apply(this, arguments).catch(function(err) {
					if (!(err instanceof MediaRenderer.ViewError)) {
						this.__logMessage(err.message, err.name, this.__logColors["error"]);
					}
					return Promise.reject(err);
				}.bind(this));
			},

			/** @override */
			createChildren: function() {
				var ret = MediaRenderer.prototype.createChildren.apply(this, arguments);

				this.__logElement = document.createElement("div");
				this.__logElement.className = "debug-log";
				// this.__logElement.style.touchAction = "pan-y";
				this.__logHeaderEl = document.createElement("pre");
				this.__logHeaderEl.className = "log-header color-bg";
				// this.model.colors.fgColor.clone().mix(fgColor, 0.9).rgbString()
				// this.model.colors.fgColor.clone().alpha
				this.__logHeaderEl.textContent = this.__getHeaderText();
				this.__logElement.appendChild(this.__logHeaderEl);
				this.el.insertBefore(this.__logElement, this.el.firstElementChild);
				return ret;
			},

			/** @override */
			render: function() {
				var ret = MediaRenderer.prototype.render.apply(this, arguments);

				this.__logElement.style.top = (this.metrics.content.height + this.metrics.content.y) + "px";
				this.__logElement.style.left = this.metrics.content.x + "px";
				this.__logElement.style.width = this.metrics.content.width + "px";
				this.__logElement.scrollTop = this.__logElement.scrollHeight;

				return ret;
			},

			__logMessage: function(msg, logtype, color) {
				var logEntryEl = document.createElement("pre");

				logEntryEl.textContent = this.__getTStamp() + " " + msg;
				logEntryEl.setAttribute("data-logtype", logtype || "-");
				logEntryEl.style.color = color || this.__logColors[logtype] || this.__logColors.normal;

				this.__logElement.appendChild(logEntryEl);
				this.__logElement.scrollTop = this.__logElement.scrollHeight;

				if (this.__rafId == -1) {
					this.__rafId = this.requestAnimationFrame(this.__onFrame);
				}
			},

			__onFrame: function(tstamp) {
				this.__rafId = -1;
				this.__logElement.lastElementChild.style.borderBottom = this.__logFrameStyle;
				this.__logElement.lastElementChild.style.paddingBottom = "2px";
				this.__logElement.lastElementChild.style.marginBottom = "2px";
			},

			__getTStamp: function() {
				// return new Date(Date.now() - this.__logStartTime).toISOString().substr(11, 12);
				return lpad(((Date.now() - this.__logStartTime) / 1000).toFixed(3), 8, "0");
			},

			__getHeaderText: function() {
				return '';
			},
		});
	})(MediaRenderer);

} // end debug

/**
 * @constructor
 * @type {module:app/view/render/MediaRenderer}
 */
module.exports = MediaRenderer;
}).call(this,true)

},{"../template/ErrorBlock.hbs":100,"app/model/item/MediaItem":49,"app/view/promise/whenDefaultImageLoads":77,"app/view/promise/whenScrollingEnds":78,"app/view/promise/whenSelectionIsContiguous":80,"app/view/render/CarouselRenderer":83,"color":"color","underscore":"underscore","underscore.string/lpad":28}],93:[function(require,module,exports){
(function (GA){
/**
 * @module app/view/render/PlayableRenderer
 */

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
// var Color = require("color");

/** @type {module:app/view/MediaRenderer} */
var MediaRenderer = require("app/view/render/MediaRenderer");
// /** @type {module:app/view/component/ProgressMeter} */
// var ProgressMeter = require("app/view/component/ProgressMeter");

/** @type {Function} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {Function} */
var prefixedEvent = require("utils/prefixedEvent");

// var visibilityHiddenProp = prefixedProperty("hidden", document);
/** @type {String} */
var visibilityStateProp = prefixedProperty("visibilityState", document);
/** @type {String} */
var visibilityChangeEvent = prefixedEvent("visibilitychange", document, "hidden");

/** @type {Function} */
// var duotone = require("utils/canvas/bitmap/duotone");
// var stackBlurRGB = require("utils/canvas/bitmap/stackBlurRGB");
// var stackBlurMono = require("utils/canvas/bitmap/stackBlurMono");
// var getAverageRGBA = require("utils/canvas/bitmap/getAverageRGBA");
// var getAverageRGB = require("utils/canvas/bitmap/getAverageRGB");

// /** @type {HTMLCanvasElement} */
// var _sharedCanvas = null;
// /** @return {HTMLCanvasElement} */
// var getSharedCanvas = function() {
// 	if (_sharedCanvas === null) {
// 		_sharedCanvas = document.createElement("canvas");
// 	}
// 	return _sharedCanvas;
// };

// function logAttachInfo(view, name, level) {
// 	if (["log", "info", "warn", "error"].indexOf(level) != -1) {
// 		level = "log";
// 	}
// 	console[level].call(console, "%s::%s [parent:%s %s %s depth:%s]", view.cid, name, view.parentView && view.parentView.cid, view.attached ? "attached" : "detached", view._viewPhase, view.viewDepth);
// }

/**
 * @constructor
 * @type {module:app/view/render/PlayableRenderer}
 */
var PlayableRenderer = MediaRenderer.extend({

	/** @type {string} */
	cidPrefix: "playableRenderer",

	/** @type {string|Function} */
	className: MediaRenderer.prototype.className + " playable-renderer",

	properties: {
		paused: {
			/** @return {Boolean} */
			get: function() {
				return this._isMediaPaused();
			}
		},
		playbackRequested: {
			/** @return {Boolean} */
			get: function() {
				return this._playbackRequested;
			},
			set: function(value) {
				this._setPlaybackRequested(value);
			}
		},
		playToggle: {
			/** @return {HTMLElement} */
			get: function() {
				return this._playToggle || (this._playToggle = this.el.querySelector(".play-toggle"));
			}
		},
		overlay: {
			/** @return {HTMLElement} */
			get: function() {
				return this._overlay || (this._overlay = this.el.querySelector(".overlay"));
			}
		}
	},

	/** @override */
	initialize: function(opts) {
		MediaRenderer.prototype.initialize.apply(this, arguments);
		_.bindAll(this,
			"_onPlaybackToggle",
			"_onVisibilityChange"
		);
		this._setPlaybackRequested(this._playbackRequested);
		// this.listenTo(this, "view:parentChange", function(childView, newParent, oldParent) {
		// 	// logAttachInfo(this, "[view:parentChange]", "info");
		// 	console.info("%s::[view:parentChange] '%s' to '%s'", this.cid, oldParent && oldParent.cid, newParent && newParent.cid);
		// });
	},

	// /** @override */
	// initializeAsync: function() {
	// 	return MediaRenderer.prototype.initialize.initializeAsync.apply(this, arguments);
	// },

	// /** @override */
	// remove: function() {
	// 	MediaRenderer.prototype.remove.apply(this, arguments);
	// 	return this;
	// },

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	// createChildren: function() {
	// 	this.el.innerHTML = this.template(this.model.toJSON());
	// 	this.placeholder = this.el.querySelector(".placeholder");
	// 	this.content = this.el.querySelector(".content");
	// 	this.image = this.content.querySelector("img.current");
	// },

	/* --------------------------- *
	/* setEnabled
	/* --------------------------- */

	/** @override */
	setEnabled: function(enabled) {
		MediaRenderer.prototype.setEnabled.apply(this, arguments);
		// this._validatePlayback(enabled);
		// if (enabled) {
		this._validatePlayback();
		// } else {
		// 	// if selected, pause media
		// 	this.model.selected && this.togglePlayback(false);
		// 	// this.togglePlayback(false);
		// }
	},

	/* ---------------------------
	/* selection handlers
	/* --------------------------- */

	addSelectionListeners: function() {
		if (this._viewPhase != "initialized")
			throw new Error(this.cid + "::addSelectionListeners called while " + this._viewPhase);

		// logAttachInfo(this, "addSelectionListeners", "log");
		// this.listenTo(this, "view:removed", this.removeSelectionListeners);
		this.listenTo(this.model, "selected", this._onModelSelected);
		this.listenTo(this.model, "deselected", this._onModelDeselected);
		if (this.model.selected) {
			this._onModelSelected();
		}
	},

	// removeSelectionListeners: function() {
	// 	// logAttachInfo(this, "removeSelectionListeners", "log");
	// 	this.stopListening(this, "view:removed", this.removeSelectionListeners);
	// 	this.stopListening(this.model, "selected", this._onModelSelected);
	// 	this.stopListening(this.model, "deselected", this._onModelDeselected);
	// 	if (this.model.selected) {
	// 		this._onModelDeselected();
	// 	}
	// },

	/* model selected handlers:
	/* model selection toggles playback
	/* --------------------------- */

	_onModelSelected: function() {
		console.log("%s::_onModelSelected _playbackRequested: %s, event: %s", this.cid, this._playbackRequested, this._toggleEvent);
		// logAttachInfo(this, "_onModelSelected", "log");
		// this._addParentListeners();
		this.listenTo(this, "view:parentChange", this._onParentChange);
		if (this.parentView) this._onParentChange(this, this.parentView, null);

		this._addDOMListeners();
		this._validatePlayback();
	},

	_onModelDeselected: function() {
		// logAttachInfo(this, "_onModelDeselected", "log");
		// this._removeParentListeners();
		this.stopListening(this, "view:parentChange", this._onParentChange);
		if (this.parentView) this._onParentChange(this, null, this.parentView);

		this._removeDOMListeners();
		this.togglePlayback(false);
		// this._validatePlayback(this.model.selected);
		// this._validatePlayback();
	},

	/* view:parentChange handlers 3
	/* --------------------------- */

	_onParentChange: function(childView, newParent, oldParent) {
		// console.log("[scroll] %s::_onParentChange '%s' to '%s'", this.cid, oldParent && oldParent.cid, newParent && newParent.cid);
		if (oldParent) this.stopListening(oldParent, "view:scrollstart view:scrollend", this._onScrollChange);
		if (newParent) this.listenTo(newParent, "view:scrollstart view:scrollend", this._onScrollChange);
	},

	_onScrollChange: function() {
		if (this.parentView === null) {
			this.togglePlayback(false);
			throw new Error(this.cid + "::_onScrollChange parentView is null");
		}
		// console.log("[scroll] %s::_onScrollChange %s.scrolling: %s", this.cid, this.parentView.cid, this.parentView.scrolling);

		// this._validatePlayback(!this.parentView.scrolling);
		// if (!this.parentView.scrolling) {
		this._validatePlayback();
		// } else {
		// 	this.togglePlayback(false);
		// }
	},

	/* view:parentChange handlers
	/* --------------------------- */

	/*_addParentListeners: function() {
		if (!this.parentView) {
			logAttachInfo(this, "_addParentListeners", "error");
			return;
		}
		this.listenTo(this, "view:remove", this._removeParentListeners);
		this.listenTo(this.parentView, "view:remove", this._removeParentListeners);
		this.listenTo(this.parentView, "view:scrollstart", this._onScrollStart);
		this.listenTo(this.parentView, "view:scrollend", this._onScrollEnd);
	},

	_removeParentListeners: function(view) {
		if (!this.parentView) {
			logAttachInfo(this, "_removeParentListeners", "error");
			return;
		}
		if (view !== void 0) {
			logAttachInfo(this, "_removeParentListeners [event source view]", "info");
			// console.info("%s[playable]::_removeParentListeners event source view: %s", this.cid, view && view.cid);
		}

		this.stopListening(this, "view:remove", this._removeParentListeners);
		this.stopListening(this.parentView, "view:remove", this._removeParentListeners);
		this.stopListening(this.parentView, "view:scrollstart", this._onScrollStart);
		this.stopListening(this.parentView, "view:scrollend", this._onScrollEnd);
	},*/

	/* view:scrollstart view:scrollend
	/* --------------------------- */

	/*_onScrollStart: function() {
		this.togglePlayback(false);
	},

	_onScrollEnd: function() {
		this._validatePlayback();
	},*/

	/* listen to DOM events
	/* --------------------------- */

	_addDOMListeners: function() {
		this.listenTo(this, "view:removed", this._removeDOMListeners);
		document.addEventListener(visibilityChangeEvent, this._onVisibilityChange, false);
		this.playToggle.addEventListener(this._toggleEvent, this._onPlaybackToggle, true);
	},

	_removeDOMListeners: function() {
		this.stopListening(this, "view:removed", this._removeDOMListeners);
		document.removeEventListener(visibilityChangeEvent, this._onVisibilityChange, false);
		this.playToggle.removeEventListener(this._toggleEvent, this._onPlaybackToggle, true);
	},

	/* visibility dom event
	/* --------------------------- */
	_onVisibilityChange: function(ev) {
		// this._validatePlayback(!document[visibilityHiddenProp]);
		// this._validatePlayback(document[visibilityStateProp] != "hidden");
		// if (document[visibilityStateProp] != "hidden") {
		this._validatePlayback();
		// } else {
		// 	this.togglePlayback(false);
		// }
	},

	/* --------------------------- *
	/* play-toggle
	/* --------------------------- */

	/** @type {String} */
	_toggleEvent: window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup",

	_onPlaybackToggle: function(ev) {
		console.log("%s[%sabled]::_onPlaybackToggle[%s] defaultPrevented: %s", this.cid, this.enabled ? "en" : "dis", ev.type, ev.defaultPrevented);
		// NOTE: Perform action if MouseEvent.button is 0 or undefined (0: left-button)
		if (this.enabled && !ev.defaultPrevented && !ev.button) {
			ev.preventDefault();
			this.playbackRequested = !this.playbackRequested;
		}
	},

	/* --------------------------- *
	/* playbackRequested
	/* --------------------------- */

	/** @type {Boolean?} */
	_playbackRequested: null,

	_setPlaybackRequested: function(value) {
		this._playbackRequested = value;

		var classList = this.content.classList;
		classList.toggle("playing", value === true);
		classList.toggle("paused", value === false);
		classList.toggle("requested", value === true || value === false);

		// this._validatePlayback(this.playbackRequested);
		// if (this.playbackRequested) {
		this._validatePlayback();
		// } else {
		// 	this.togglePlayback(false);
		// }
	},

	/* --------------------------- *
	/* togglePlayback
	/* --------------------------- */

	/** @override */
	togglePlayback: function(newPlayState) {
		// console.log("[scroll] %s::togglePlayback [%s -> %s] (requested: %s)", this.cid,
		// 		(this._isMediaPaused()? "pause" : "play"),
		// 		(newPlayState? "play" : "pause"),
		// 		this.playbackRequested
		// 	);
		if (_.isBoolean(newPlayState) && newPlayState !== this._isMediaPaused()) {
			return; // requested state is current, do nothing
		} else {
			newPlayState = this._isMediaPaused();
		}
		if (newPlayState) { // changing to what?
			this._playMedia();
		} else {
			this._pauseMedia();
		}
	},

	_canResumePlayback: function() {
		return !!(
			this.enabled &&
			this.model.selected &&
			this.playbackRequested &&
			(this.mediaState === "ready") &&
			this.attached &&
			(this.parentView !== null) &&
			(!this.parentView.scrolling) &&
			(document[visibilityStateProp] != "hidden")
		);
	},

	_validatePlayback: function(shortcircuit) {
		// a 'shortcircuit' boolean argument can be passed, and if false,
		// skip _canResumePlayback and pause playback right away
		if (arguments.length != 0 && !shortcircuit) {
			this.togglePlayback(false);
		} else {
			this.togglePlayback(this._canResumePlayback());
		}
	},

	/* --------------------------- *
	/* abstract
	/* --------------------------- */

	_isMediaPaused: function() {
		console.warn("%s::_isMediaPaused Not implemented", this.cid);
		return true;
	},

	_playMedia: function() {
		console.warn("%s::_playMedia Not implemented", this.cid);
	},

	_pauseMedia: function() {
		console.warn("%s::_pauseMedia Not implemented", this.cid);
	},

	/* --------------------------- *
	/* util
	/* --------------------------- */

	updateOverlay: function(mediaEl, targetEl, rectEl) {
		// // this method is not critical, just catch and log all errors
		// try {
		// 	this._updateOverlay(mediaEl, targetEl, rectEl)
		// } catch (err) {
		// 	console.error("%s::updateOverlay", this.cid, err);
		// }
	},

	_drawMediaElement: function(context, mediaEl, dest) {
		// destination rect
		// NOTE: mediaEl is expected to have the same dimensions in this.metrics.media
		mediaEl || (mediaEl = this.defaultImage);
		dest || (dest = {
			x: 0,
			y: 0,
			width: this.metrics.media.width,
			height: this.metrics.media.height
		});

		// native/display scale
		var sW = this.model.get("source").get("w"),
			sH = this.model.get("source").get("h"),
			rsX = sW / this.metrics.media.width,
			rsY = sH / this.metrics.media.height;

		// dest, scaled to native
		var src = {
			x: Math.max(0, dest.x * rsX),
			y: Math.max(0, dest.y * rsY),
			width: Math.min(sW, dest.width * rsX),
			height: Math.min(sH, dest.height * rsY)
		};

		// resize canvas
		// var canvas = context.canvas;
		// if (canvas.width !== dest.width || canvas.height !== dest.height) {
		// 	canvas.width = dest.width;
		// 	canvas.height = dest.height;
		// }
		context.canvas.width = dest.width;
		context.canvas.height = dest.height;

		// copy image to canvas
		context.clearRect(0, 0, dest.width, dest.height);
		context.drawImage(mediaEl,
			src.x, src.y, src.width, src.height,
			0, 0, dest.width, dest.height // destination rect
		);

		return context;
	},

	/*
	_updateOverlay: function(mediaEl, targetEl, rectEl) {
		// src/dest rects
		// ------------------------------
		rectEl || (rectEl = targetEl);

		// NOTE: does not work with svg element
		// var tRect = rectEl.getBoundingClientRect();
		// var cRect = mediaEl.getBoundingClientRect();
		// var tX = tRect.x - cRect.x,
		// 	tY = tRect.y - cRect.y,
		// 	tW = tRect.width,
		// 	tH = tRect.height;

		// target bounds
		var tX = rectEl.offsetLeft,
			tY = rectEl.offsetTop,
			tW = rectEl.offsetWidth,
			tH = rectEl.offsetHeight;

		if (tX === void 0 || tY === void 0 || tW === void 0 || tH === void 0) {
			return;
		}

		// destination rect
		var RECT_GROW = 20;
		var dest = {
			x: tX - RECT_GROW,
			y: tY - RECT_GROW,
			width: tW + RECT_GROW * 2,
			height: tH + RECT_GROW * 2
		};

		// native/display scale
		var sW = this.model.get("w"),
			sH = this.model.get("h"),
			rsX = sW/this.metrics.media.width,
			rsY = sH/this.metrics.media.height;

		// dest, scaled to native
		var src = {
			x: Math.max(0, dest.x * rsX),
			y: Math.max(0, dest.y * rsY),
			width: Math.min(sW, dest.width * rsX),
			height: Math.min(sH, dest.height * rsY)
		};

		// Copy image to canvas
		// ------------------------------
		var canvas, context, imageData;

		// canvas = document.createElement("canvas");
		// canvas.style.width  = dest.width + "px";
		// canvas.style.height = dest.height + "px";

		canvas = getSharedCanvas();
		if (canvas.width !== dest.width || canvas.height !== dest.height) {
			canvas.width = dest.width;
			canvas.height = dest.height;
		}
		context = canvas.getContext("2d");
		context.clearRect(0, 0, dest.width, dest.height);
		context.drawImage(mediaEl,
			src.x, src.y, src.width, src.height,
			0, 0, dest.width, dest.height // destination rect
		);
		imageData = context.getImageData(0, 0, dest.width, dest.height);

		var avgColor = Color().rgb(getAverageRGB(imageData));
		// var avgHex = avgColor.hexString(), els = this.el.querySelectorAll("img, video");
		// for (var i = 0; i < els.length; i++) {
		// 	els.item(i).style.backgroundColor = avgHex;
		// }

		targetEl.classList.toggle("over-dark", avgColor.dark());

		// console.log("%s::updateOverlay() avgColor:%s (%s)", this.cid, avgColor.rgbString(), avgColor.dark()?"dark":"light", targetEl);

		// Color, filter opts
		// ------------------------------

		// this.fgColor || (this.fgColor = new Color(this.model.attr("color")));
		// this.bgColor || (this.bgColor = new Color(this.model.attr("background-color")));
		//
		// var opts = { radius: 20 };
		// var isFgDark = this.fgColor.luminosity() < this.bgColor.luminosity();
		// opts.x00 = isFgDark? this.fgColor.clone().lighten(0.5) : this.bgColor.clone().darken(0.5);
		// opts.xFF = isFgDark? this.bgColor.clone().lighten(0.5) : this.fgColor.clone().darken(0.5);
		//
		// stackBlurMono(imageData, opts);
		// duotone(imageData, opts);
		// stackBlurRGB(imageData, { radius: 20 });
		//
		// context.putImageData(imageData, 0, 0);
		// targetEl.style.backgroundImage = "url(" + canvas.toDataURL() + ")";
	}*/
});

/* ---------------------------
/* Google Analytics
/* --------------------------- */
if (GA) {
	PlayableRenderer = (function(PlayableRenderer) {

		/** @type {module:underscore.strings/dasherize} */
		var dasherize = require("underscore.string/dasherize");

		// var readyEvents = ["playing", "waiting", "ended"];
		// var userEvents = ["play", "pause"];


		return PlayableRenderer.extend({

			/** @override */
			initialize: function() {
				var retval = PlayableRenderer.prototype.initialize.apply(this, arguments);
				this._playbackRequestedDefault = this.playbackRequested;
				return retval;
			},

			_onPlaybackToggle: function(ev) {
				var retval = PlayableRenderer.prototype._onPlaybackToggle.apply(this, arguments);
				var o = {
					hitType: "event",
					eventCategory: dasherize(this.cidPrefix),
					eventAction: this.playbackRequested ? "play" : "pause",
					eventLabel: this.model.get("text"),
				};
				if (this._playbackRequestedDefault)
					o.eventAction += "-autoplay";
				window.ga("send", o);
				return retval;
			},

			// /** @override */
			// togglePlayback: function(newPlayState) {
			// 	var retval = PlayableRenderer.prototype.togglePlayback.apply(this, arguments);
			// 	window.ga("send", {
			// 		hitType: "event",
			// 		eventCategory: "Playable",
			// 		eventAction: this.playbackRequested ? "play" : "pause",
			// 		eventLabel: this.model.get("text"),
			// 	});
			// 	return retval;
			// },
		});
	})(PlayableRenderer);
}

// if (DEBUG) {
//
// PlayableRenderer = (function(PlayableRenderer) {
// 	if (!PlayableRenderer.LOG_TO_SCREEN) return PlayableRenderer;
//
// 	/** @type {module:underscore.strings/lpad} */
// 	var lpad = require("underscore.string/lpad");
//
// 	return PlayableRenderer.extend({
// 		_canResumePlayback: function() {
// 			var retval = PlayableRenderer.prototype._canResumePlayback.apply(this.arguments);
// 			console.log("[scroll] %s::_canResumePlayback():%s", this.cid, retval,
// 			{
// 				"enabled": this.enabled,
// 				"selected": (!!this.model.selected),
// 				"playbackRequested": this.playbackRequested,
// 				"attached": this.attached,
// 				"parentView": (this.parentView && this.parentView.cid),
// 				"!scrolling": (this.parentView && !this.parentView.scrolling),
// 				"mediaState": this.mediaState,
// 				// "!document.hidden": !document[visibilityHiddenProp],
// 				"visibilityState": document[visibilityStateProp]
// 			});
// 			return retval;
// 		},
// 	});
// })(PlayableRenderer);
//
// }

module.exports = PlayableRenderer;
}).call(this,true)

},{"app/view/render/MediaRenderer":92,"underscore":"underscore","underscore.string/dasherize":23,"utils/prefixedEvent":112,"utils/prefixedProperty":113}],94:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<div class=\"placeholder sizing\"></div>\n<div class=\"content\">\n	<div class=\"media-border content-size\"></div>\n	<div class=\"controls content-size\">\n		<canvas class=\"progress-meter\"></canvas>\n	</div>\n	<div class=\"sequence media-size\">\n		<img class=\"sequence-step current default\" alt=\""
    + alias4(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"text","hash":{},"data":data}) : helper)))
    + "\" longdesc=\"#desc_m"
    + alias4(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" />\n	</div>\n	<div class=\"overlay media-size\">\n		<div class=\"play-toggle-hitarea play-toggle\">\n		</div>\n	</div>\n</div>\n";
},"useData":true});

},{"hbsfy/runtime":20}],95:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/view/render/SequenceRenderer
 */

/* --------------------------- *
/* Imports
/* --------------------------- */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/render/PlayableRenderer} */
var PlayableRenderer = require("app/view/render/PlayableRenderer");
// /** @type {module:app/model/SelectableCollection} */
// var SelectableCollection = require("app/model/SelectableCollection");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

/** @type {module:app/view/component/ProgressMeter} */
var ProgressMeter = require("app/view/component/ProgressMeter");

/** @type {module:utils/Timer} */
var Timer = require("utils/Timer");
// /** @type {Function} */
// var transitionEnd = require("utils/event/transitionEnd");
// /** @type {module:utils/prefixedProperty} */
// var prefixed = require("utils/prefixedProperty");

/** @type {Function} */
var _whenImageLoads = require("app/view/promise/_whenImageLoads");
/** @type {module:app/view/promise/_loadImageAsObjectURL} */
var _loadImageAsObjectURL = require("app/view/promise/_loadImageAsObjectURL");
/** @type {Function} */
var whenSelectionDistanceIs = require("app/view/promise/whenSelectionDistanceIs");
// var whenSelectTransitionEnds = require("app/view/promise/whenSelectTransitionEnds");
// var whenDefaultImageLoads = require("app/view/promise/whenDefaultImageLoads");

// /** @type {Function} */
// var Color = require("color");
// var duotone = require("utils/canvas/bitmap/duotone");
// var stackBlurRGB = require("utils/canvas/bitmap/stackBlurRGB");
// var stackBlurMono = require("utils/canvas/bitmap/stackBlurMono");
// var getAverageRGBA = require("utils/canvas/bitmap/getAverageRGBA");

var errorTemplate = require("../template/ErrorBlock.hbs");

var MIN_STEP_INTERVAL = 2 * Globals.TRANSITION_DURATION + Globals.TRANSITION_DELAY_INTERVAL;
var DEFAULT_STEP_INTERVAL = 6 * Globals.TRANSITION_DURATION + Globals.TRANSITION_DELAY_INTERVAL;


/* --------------------------- *
/* Private classes
/* --------------------------- */

// /**
// * @constructor
// * @type {module:app/view/render/SequenceRenderer.SourceCollection}
// */
// var SourceCollection = SelectableCollection.extend({
// 	model: Backbone.Model
// });

/**
 * @constructor
 * @type {module:app/view/render/SequenceRenderer.PrefetechedSourceRenderer}
 */
var PrefetechedSourceRenderer = View.extend({

	cidPrefix: "sequenceStepRenderer",
	/** @type {string} */
	className: "sequence-step",
	/** @type {string} */
	tagName: "img",

	properties: {
		ready: {
			get: function() {
				return this._ready;
			}
		}
	},

	/** @override */
	initialize: function(options) {
		!this.el.hasAttribute("alt") && this.el.setAttribute("alt", this.model.get("src"));
		// this.el.setAttribute("longdesc", this.model.get("original"));

		if (this.model.has("prefetched")) {
			this._renderPrefetched();
		} else {
			this.listenTo(this.model, "change:prefetched", this._renderPrefetched);
		}
		this.listenTo(this.model, "selected deselected", this._renderSelection);
		this._renderSelection();
	},

	_renderSelection: function() {
		this.el.classList.toggle("current", !!this.model.selected);
	},

	_renderPrefetched: function() {
		var prefetched = this.model.get("prefetched");
		if (prefetched !== this.el.src) {
			this.el.src = prefetched;
		}
		_whenImageLoads(this.el).then(
			function(el) {
				this.requestAnimationFrame(function(tstamp) {
					this._setReady(true);
				});
			}.bind(this),
			function(err) {
				// this._setReady(false);
				(err instanceof Error) || (err = new Error("cannot load prefetched url"));
				throw err;
			}.bind(this)
		);
	},

	/** @type {boolean} */
	_ready: false,

	_setReady: function(ready) {
		if (this._ready === ready) return;
		this._ready = !!(ready); // make bool
		this.trigger("renderer:ready", this);
	},

	render: function() {
		// if (this.model.has("prefetched")) {
		// 	this._renderPrefetched();
		// }
		// this.el.classList.toggle("current", !!this.model.selected);
		console.log("%s::render", this.cid);
		return this;
	},
});

/**
 * @constructor
 * @type {module:app/view/render/SequenceRenderer.SimpleSourceRenderer}
 */
// var SimpleSourceRenderer = View.extend({
//
// 	cidPrefix: "sequenceStepRenderer",
// 	/** @type {string} */
// 	className: "sequence-step",
// 	/** @type {string} */
// 	tagName: "img",
//
// 	/** @override */
// 	initialize: function (options) {
// 		// this.el.classList.toggle("current", this.model.hasOwnProperty("selected"));
// 		this.el.classList.toggle("current", !!this.model.selected);
// 		this.listenTo(this.model, {
// 			"selected": function () {
// 				this.el.classList.add("current");
// 			},
// 			"deselected": function () {
// 				this.el.classList.remove("current");
// 			}
// 		});
// 		if (this.el.src === "") {
// 			this.el.src = Globals.MEDIA_DIR + "/" + this.model.get("src");
// 		}
//
// 		if (this.model.has("error")) {
// 			this._onModelError();
// 		} else {
// 			this.listenToOnce(this.model, "change:error", this._onModelError);
// 			// this.listenToOnce(this.model, {
// 			// 	"change:source": this._onModelSource,
// 			// 	"change:error": this._onModelError,
// 			// });
// 		}
// 	},
//
// 	// _onModelSource: function() {
// 	// 	this.el.src = Globals.MEDIA_DIR + "/" + this.model.get("src");
// 	// 	// console.log("%s::change:src", this.cid, this.model.get("src"));
// 	// },
//
// 	_onModelError: function() {
// 		var err = this.model.get("error");
// 		var errEl = document.createElement("div");
// 		errEl.className = "error color-bg" + (this.model.selected? " current" : "");
// 		errEl.innerHTML = errorTemplate(err);
// 		this.setElement(errEl, true);
// 		console.log("%s::change:error", this.cid, err.message, err.infoSrc);
// 	},
// });

var SourceErrorRenderer = View.extend({

	/** @type {string} */
	className: "sequence-step error",
	/** @override */
	cidPrefix: "sourceErrorRenderer",
	/** @override */
	template: errorTemplate,
	/** @type {boolean} */
	ready: true,

	initialize: function(options) {
		// var handleSelectionChange = function onSelectionChange () {
		// 	this.el.classList.toggle("current", !!this.model.selected);
		// };
		// this.listenTo(this.model, "selected deselected", handleSelectionChange);
		// // this.el.classList.toggle("current", !!this.model.selected);
		// handleSelectionChange.call(this);
		this.listenTo(this.model, "selected deselected", function() {
			this.el.classList.toggle("current", !!this.model.selected);
		});
	},

	render: function() {
		this.el.classList.toggle("current", !!this.model.selected);
		this.el.innerHTML = this.template(this.model.get("error"));
		return this;
	},
});

var SequenceStepRenderer = PrefetechedSourceRenderer;
// var SequenceStepRenderer = SimpleSourceRenderer;

/**
 * @constructor
 * @type {module:app/view/render/SequenceRenderer}
 */
var SequenceRenderer = PlayableRenderer.extend({

	/** @type {string} */
	cidPrefix: "sequenceRenderer",
	/** @type {string} */
	className: PlayableRenderer.prototype.className + " sequence-renderer",
	/** @type {Function} */
	template: require("./SequenceRenderer.hbs"),

	/* --------------------------- *
	/* initialize
	/* --------------------------- */

	initialize: function() {
		this.sources = this.model.get("sources");
		PlayableRenderer.prototype.initialize.apply(this, arguments);
	},

	initializeAsync: function() {
		return PlayableRenderer.prototype.initializeAsync.apply(this, arguments)
			.then(
				function(view) {
					return view.whenAttached();
				})
			.then(function(view) {
				view.initializePlayable();
				view.updateOverlay(view.defaultImage, view.overlay);
				view.addSelectionListeners();
				return view;
			});
	},

	whenInitialized: function(view) {
		var retval = PlayableRenderer.prototype.whenInitialized.apply(this, arguments);
		view._validatePlayback();
		return retval;
	},

	/* --------------------------- *
	/* children
	/* --------------------------- */

	/** @override */
	createChildren: function() {
		PlayableRenderer.prototype.createChildren.apply(this, arguments);

		this.placeholder = this.el.querySelector(".placeholder");
		this.sequence = this.content.querySelector(".sequence");

		this.content.classList.add("started");

		// styles
		// ---------------------------------
		var s, attrs = this.model.attrs();
		// var s, attrs = this.model.get("attrs");
		s = _.pick(attrs, "box-shadow", "border", "border-radius");
		_.extend(this.content.querySelector(".media-border").style, s);
		s = _.pick(attrs, "border-radius");
		_.extend(this.sequence.style, s);
		_.extend(this.placeholder.style, s);

		// model
		// ---------------------------------
		this.sources.select(this.model.get("source"));

		// itemViews
		// ---------------------------------
		this.itemViews = new Container();
		// add default image as renderer (already in DOM)
		this.itemViews.add(new SequenceStepRenderer({
			el: this.getDefaultImage(),
			model: this.sources.selected
		}));
	},

	/* --------------------------- *
	/* layout
	/* --------------------------- */

	/** @override */
	render: function() {
		PlayableRenderer.prototype.render.apply(this, arguments);

		var els, el, i, cssW, cssH;
		var content = this.content;

		// media-size
		// ---------------------------------
		cssW = this.metrics.media.width + "px";
		cssH = this.metrics.media.height + "px";

		els = this.el.querySelectorAll(".media-size");
		for (i = 0; i < els.length; i++) {
			el = els.item(i);
			el.style.width = cssW;
			el.style.height = cssH;
		}
		content.style.width = cssW;
		content.style.height = cssH;

		// content-position
		// ---------------------------------
		var cssX, cssY;
		cssX = this.metrics.content.x + "px";
		cssY = this.metrics.content.y + "px";
		content.style.left = cssX;
		content.style.top = cssY;

		el = this.el.querySelector(".controls");
		// el.style.left = cssX;
		// el.style.top = cssY;
		el.style.width = this.metrics.content.width + "px";
		el.style.height = this.metrics.content.height + "px";

		// // content-size
		// // ---------------------------------
		// cssW = this.metrics.content.width + "px";
		// cssH = this.metrics.content.height + "px";
		//
		// els = this.el.querySelectorAll(".content-size");
		// for (i = 0; i < els.length; i++) {
		// 	el = els.item(i);
		// 	el.style.width = cssW;
		// 	el.style.height = cssH;
		// }

		return this;
	},

	initializePlayable: function() {
		// Sequence model
		// ---------------------------------
		// this.sources = this._createSourceCollection(this.model);
		whenSelectionDistanceIs(this, 0).then(this._preloadAllItems, function(err) {
			if (err instanceof View.ViewError) { // Ignore ViewError
				// console.warn(err.name, err.message);//, err.view.cid);
				return;
			}
			return err;
		});

		// timer
		// ---------------------------------
		this._sequenceInterval = Math.max(parseInt(this.model.attr("@sequence-interval")), MIN_STEP_INTERVAL) || DEFAULT_STEP_INTERVAL;

		this.timer = new Timer();
		this.listenTo(this, "view:removed", function() {
			this.timer.stop();
			this.stopListening(this.timer);
		});
		this.listenTo(this.timer, {
			"start": this._onTimerStart,
			"resume": this._onTimerResume,
			"pause": this._onTimerPause,
			"end": this._onTimerEnd,
			// "stop": function () { // stop is only called on view remove},
		});

		// progress-meter model
		// ---------------------------------
		this._sourceProgressByIdx = this.sources.map(function() {
			return 0;
		});
		this._sourceProgressByIdx[0] = 1; // first item is already loaded

		// progress-meter
		// ---------------------------------
		this.progressMeter = new ProgressMeter({
			el: this.el.querySelector(".progress-meter"),
			values: {
				available: this._sourceProgressByIdx.concat(),
			},
			maxValues: {
				amount: this.sources.length,
				available: this.sources.length,
			},
			color: this.model.attr("color"),
			// backgroundColor: this.model.attr("background-color"),
			labelFn: this._progressLabelFn.bind(this)
		});

		// this.el.querySelector(".top-bar")
		//		.appendChild(this.progressMeter.render().el);
	},

	_progressLabelFn: function() {
		if (this.playbackRequested === false) return Globals.PAUSE_CHAR;
		return (this.sources.selectedIndex + 1) + "/" + this.sources.length;
	},

	_preloadAllItems: function(view) {
		view.once("view:remove", function() {
			var silent = {
				silent: true
			};
			view.sources.forEach(function(item, index, sources) {
				var prefetched = item.get("prefetched");
				if (prefetched && /^blob\:/.test(prefetched)) {
					item.unset("prefetched", silent);
					item.set("progress", 0, silent);
					URL.revokeObjectURL(prefetched);
				}
			});
		});
		return view.sources.reduce(function(lastPromise, item, index, sources) {
			return lastPromise.then(function(view) {
				if (item.has("prefetched")) {
					view._updateItemProgress(1, index);
					return view;
				} else {
					return _loadImageAsObjectURL(item.get("original"),
							function(progress) {
								view._updateItemProgress(progress, index);
								item.set("progress", progress);
							})
						.then(
							function(pUrl) {
								view._updateItemProgress(1, index);
								item.set({
									prefetched: pUrl,
									progress: 1
								});
								// item.set("prefetched", pUrl);
								return view;
							},
							function(err) {
								view._updateItemProgress(0, index);
								item.set({
									error: err,
									progress: 0
								});
								// item.set("error", err);
								return view;
							}
						);
				}
			});
		}, Promise.resolve(view));
	},

	// _preloadAllItems2: function(view) {
	// 	return view.sources.reduce(function(lastPromise, item, index, sources) {
	// 		return lastPromise.then(function(view) {
	// 			var itemView = view._getItemRenderer(item);
	// 			return _whenImageLoads(itemView.el).then(function(url){
	// 				view._updateItemProgress(1, index);
	// 				return view;
	// 			}, function(err) {
	// 				view._updateItemProgress(0, index);
	// 				item.set("error", err);
	// 				return view;
	// 			});
	// 		});
	// 	}, Promise.resolve(view));
	// },

	// _getItemRenderer: function(item) {}

	_updateItemProgress: function(progress, index) {
		this._sourceProgressByIdx[index] = progress;
		if (this.progressMeter) {
			this.progressMeter.valueTo(this._sourceProgressByIdx, 300, "available");
		}
	},

	/* ---------------------------
	/* PlayableRenderer implementation
	/* --------------------------- */

	/** @override initial value */
	_playbackRequested: true,

	/** @type {Boolean} internal store */
	_paused: true,

	/** @override */
	_isMediaPaused: function() {
		return this._paused;
	},

	/** @override */
	_playMedia: function() {
		if (!this._paused) return;
		this._paused = false;
		if (this.timer.status == Timer.PAUSED) {
			this.timer.start(); // resume, actually
		} else {
			this.timer.start(this._sequenceInterval);
		}
	},

	/** @override */
	_pauseMedia: function() {
		if (this._paused) return;
		this._paused = true;
		if (this.timer.status == Timer.STARTED) {
			this.timer.pause();
		}
	},

	/* --------------------------- *
	/* sequence private
	/* --------------------------- */

	_onTimerStart: function(duration) {
		this.progressMeter.valueTo(this.sources.selectedIndex + 1, duration, "amount");
		// init next renderer now to have smooth transitions
		this._getItemRenderer(this.sources.followingOrFirst());
	},

	_onTimerResume: function(duration) {
		this.progressMeter.valueTo(this.sources.selectedIndex + 1, duration, "amount");
	},

	_onTimerPause: function(duration) {
		// var meterDur = this.progressMeter._valueData["amount"]._duration - this.progressMeter._valueData["amount"]._elapsedTime;
		// var meterVal = this.progressMeter.getRenderedValue("amount");
		// var timerVal = (this._sequenceInterval - duration) / this._sequenceInterval + this.sources.selectedIndex;
		//
		// console.log("%s::_onTimerPause [interval:%sms]\n\tmeter:%s (%sms)\n\ttimer:%s (%sms)\n\tdiffs:%s (%sms)",
		// 		this.cid, this._sequenceInterval,
		// 		meterVal, meterDur,
		// 		timerVal, duration,
		// 		Math.abs(meterVal-timerVal), Math.abs(meterDur-duration));

		// this.progressMeter.valueTo(timerVal);
		// this.progressMeter.valueTo(meterVal);

		this.progressMeter.valueTo(this.progressMeter.getRenderedValue("amount"), 0, "amount");
	},

	_onTimerEnd: function() {
		var context = this;
		var nextSource, nextView;

		nextSource = this.sources.followingOrFirst();
		// init next renderer
		nextView = this._getItemRenderer(nextSource);
		// init second next renderer
		// this._getItemRenderer(this.sources.followingOrFirst(nextSource));

		var showNextView = function() {
			context.requestAnimationFrame(function() {
				context.content.classList.remove("waiting");
				if (!context._paused) {
					// if (context.playbackRequested) {
					context.content.classList.toggle("playback-error", nextSource.has("error"));
					context.sources.select(nextSource); // NOTE: step increase done here
					// view.updateOverlay(nextView.el, view.overlay);
					context.timer.start(context._sequenceInterval);
					// console.log("%s::showNextView %sms %s", context.cid, context._sequenceInterval, nextSource.cid)
				}
			});
		};

		if (nextSource.has("prefetched")) {
			// nextView = context._getItemRenderer(nextSource).el;
			_whenImageLoads(nextView.el).then(showNextView, showNextView);
		} else if (nextSource.has("error")) {
			showNextView();
		} else {
			this.content.classList.add("waiting");
			/* TODO: add ga event 'media-waiting' */
			// console.log("%s:[waiting] %sms %s", context.cid, nextSource.cid);
			window.ga("send", "event", "sequence-renderer", "waiting", this.model.get("text"));
			this.listenTo(nextSource, "change:prefetched change:error",
				function() {
					this.stopListening(nextSource, "change:prefetched change:error");
					/* TODO: add ga event 'media-playing' */
					// console.log("%s:[playing] %sms %s", context.cid, nextSource.cid);
					window.ga("send", "event", "sequence-renderer", "playing", this.model.get("text"));
					_whenImageLoads(nextView.el).then(showNextView, showNextView);
					// context.content.classList.remove("waiting");
					// nextView = context._getItemRenderer(nextSource).el;
				});
		}
	},

	_getItemRenderer: function(item) {
		var view = this.itemViews.findByModel(item);
		if (!view) {
			var renderer = item.has("error") ? SourceErrorRenderer : SequenceStepRenderer;
			view = new renderer({
				model: item
			});
			// view = new SequenceStepRenderer({ model: item });
			this.itemViews.add(view);
			this.sequence.appendChild(view.render().el);
		}
		return view;
	},

	/* --------------------------- *
	/* progress meter
	/* --------------------------- */

	// _createDefaultItemData: function() {
	// 	var canvas = document.createElement("canvas");
	// 	var context = canvas.getContext("2d");
	// 	var imageData = this._drawMediaElement(context).getImageData(0, 0, canvas.width, canvas.height);
	//
	// 	var opts = { radius: 20 };
	// 	var fgColor = new Color(this.model.attr("color"));
	// 	var bgColor = new Color(this.model.attr("background-color"));
	// 	var isFgDark = fgColor.luminosity() < bgColor.luminosity();
	// 	opts.x00 = isFgDark? fgColor.clone().lighten(0.33) : bgColor.clone().darken(0.33);
	// 	opts.xFF = isFgDark? bgColor.clone().lighten(0.33) : fgColor.clone().darken(0.33);
	//
	// 	stackBlurMono(imageData, opts);
	// 	duotone(imageData, opts);
	// 	// stackBlurRGB(imageData, opts);
	//
	// 	context.putImageData(imageData, 0, 0);
	// 	return canvas.toDataURL();
	// },
});

if (DEBUG) {

	SequenceRenderer = (function(SequenceRenderer) {
		if (!SequenceRenderer.LOG_TO_SCREEN) return SequenceRenderer;

		/** @type {module:underscore.strings/lpad} */
		var lpad = require("underscore.string/lpad");

		return SequenceRenderer.extend({
			__logTimerEvent: function(evname, msg) {
				var logMsg = [
				"source: ", lpad(this.sources.selectedIndex, 2),
				"duration:", lpad(this.timer.getDuration(), 4),
				"paused:", this.paused,
				"requested:", this.playbackRequested,
				"status:", this.timer.getStatus(),
			];
				msg && logMsg.push(msg);
				logMsg = logMsg.join(" ");

				this.__logMessage(logMsg, evname);
				// console.log("%s::[%s] %s", this.cid, evname, logMsg);
			},
			_playMedia: function() {
				this.__logTimerEvent("playback");
				SequenceRenderer.prototype._playMedia.apply(this, arguments);
				// console.log("%s::_playMedia()", this.cid);
			},
			_pauseMedia: function() {
				this.__logTimerEvent("playback");
				SequenceRenderer.prototype._pauseMedia.apply(this, arguments);
				// console.log("%s::_pauseMedia()", this.cid);
			},

			_onTimerStart: function() {
				this.__logTimerEvent("timer:start");
				SequenceRenderer.prototype._onTimerStart.apply(this, arguments);
			},
			_onTimerResume: function() {
				this.__logTimerEvent("timer:resume");
				SequenceRenderer.prototype._onTimerStart.apply(this, arguments);
			},
			_onTimerPause: function() {
				this.__logTimerEvent("timer:pause");
				SequenceRenderer.prototype._onTimerPause.apply(this, arguments);
			},
			_onTimerEnd: function() {
				this.__logTimerEvent("timer:end");
				SequenceRenderer.prototype._onTimerEnd.apply(this, arguments);
			},

			_updateItemProgress: function(progress, srcIdx) {
				if (progress == 1) {
					this.__logMessage("idx:" + srcIdx + " progress:" + progress, "load:progress");
				}
				SequenceRenderer.prototype._updateItemProgress.apply(this, arguments);
			},

			_preloadAllItems: function(view) {
				view.__logMessage(view.cid + "::_preloadAllItems", "load:start");
				SequenceRenderer.prototype._preloadAllItems.apply(view, arguments);
			},
		});
	})(SequenceRenderer);
}

module.exports = SequenceRenderer;
}).call(this,true)

},{"../template/ErrorBlock.hbs":100,"./SequenceRenderer.hbs":94,"app/control/Globals":34,"app/view/base/View":60,"app/view/component/ProgressMeter":71,"app/view/promise/_loadImageAsObjectURL":75,"app/view/promise/_whenImageLoads":76,"app/view/promise/whenSelectionDistanceIs":79,"app/view/render/PlayableRenderer":93,"backbone.babysitter":"backbone.babysitter","underscore":"underscore","underscore.string/lpad":28,"utils/Timer":102}],96:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper;

  return "<div class=\"placeholder sizing\"></div>\n<div class=\"content media-border\">\n	<div class=\"controls content-size\">\n			<canvas class=\"progress-meter\"></canvas>\n			<a class=\"fullscreen-toggle\" href=\"javascript:(void 0)\">\n				<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" preserveAspectRatio=\"xMidYMid meet\" viewBox=\"-21 -21 42 42\" style=\"max-width:14px;max-height:14px\">\n					<path d=\"M-5,5 L-20,20 M-7,20 L-20,20 L-20,7 M5,-5 L20,-20 M7,-20 L20,-20 L20,-7\" class=\"color-stroke\" style=\"stroke-width:1;fill:none;\" vector-effect=\"non-scaling-stroke\" />\n				</svg>\n			</a>\n	</div>\n	<div class=\"crop-box media-size\">\n		<video preload=\"none\" width=\"240\" height=\"180\"></video>\n		<img class=\"poster default\" alt=\""
    + container.escapeExpression(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(depth0 != null ? depth0 : {},{"name":"text","hash":{},"data":data}) : helper)))
    + "\" width=\"240\" height=\"180\" />\n	</div>\n	<div class=\"overlay media-size\">\n		<div class=\"play-toggle-hitarea play-toggle\">\n		</div>\n	</div>\n</div>\n";
},"useData":true});

},{"hbsfy/runtime":20}],97:[function(require,module,exports){
(function (DEBUG){
/*global HTMLMediaElement, MediaError*/
/**
 * @module app/view/render/VideoRenderer
 *
 * @see https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video
 * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement
 * @see https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Media_events
 * @see https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Using_HTML5_audio_and_video
 */

/* --------------------------- *
/* Imports
/* --------------------------- */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/view/render/PlayableRenderer} */
var PlayableRenderer = require("app/view/render/PlayableRenderer");
/** @type {module:app/view/component/ProgressMeter} */
var ProgressMeter = require("app/view/component/ProgressMeter");
// /** @type {module:utils/prefixedStyleName} */
// var prefixedStyleName = require("utils/prefixedStyleName");
/** @type {module:utils/prefixedEvent} */
var prefixedEvent = require("utils/prefixedEvent");

/* --------------------------- *
/* private static
/* --------------------------- */

// var whenViewIsAttached = require("app/view/promise/whenViewIsAttached");

var fullscreenChangeEvent = prefixedEvent("fullscreenchange", document);
// var fullscreenErrorEvent = prefixedEvent("fullscreenerror", document);

var formatTimecode = function(value) {
	if (isNaN(value)) return ""; //value = 0;
	if (value >= 3600) return ((value / 3600) | 0) + "H";
	if (value >= 60) return ((value / 60) | 0) + "M";
	// if (value >= 10) return "0" + (value | 0) + "S";
	return (value | 0) + "S";
};

/**
 * @constructor
 * @type {module:app/view/render/VideoRenderer}
 */
var VideoRenderer = PlayableRenderer.extend({

	/** @type {string} */
	cidPrefix: "videoRenderer",
	/** @type {string} */
	className: PlayableRenderer.prototype.className + " video-renderer",
	/** @type {Function} */
	template: require("./VideoRenderer.hbs"),

	events: (function() {
		var ret = {};
		ret[Globals.CLICK_EVENT + " fullscreen-toggle"] = "_onFullscreenToggle";
		return ret;
	}()),

	// events: {
	// 	"click .fullscreen-toggle": "_onFullscreenToggle",
	// },

	// properties: {
	// 	paused: {
	// 		get: function() {
	// 			return this.video.paused;
	// 		}
	// 	},
	// },

	/** @override */
	initialize: function(opts) {
		PlayableRenderer.prototype.initialize.apply(this, arguments);

		_.bindAll(this,
			"_updatePlaybackState",
			"_updatePlayedValue",
			"_updateBufferedValue",
			"_onMediaError",
			"_onMediaEnded",
			"_onMediaPlayingOnce",
			"_onFullscreenChange"
		);
		// var onPeerSelect = function() {
		// 	this.content.style.display = (this.getSelectionDistance() > 1)? "none": "";
		// };
		// this.listenTo(this.model.collection, "select:one select:none", onPeerSelect);
		// onPeerSelect();
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	createChildren: function() {
		PlayableRenderer.prototype.createChildren.apply(this, arguments);

		this.placeholder = this.el.querySelector(".placeholder");
		// this.overlay = this.content.querySelector(".overlay");
		this.video = this.content.querySelector("video");
		// this.video.loop = this.model.attrs().hasOwnProperty("@video-loop");
		this.video.loop = this.model.attr("@video-loop") !== void 0;
		this.video.src = this.findPlayableSource(this.video);
	},

	measure: function() {
		PlayableRenderer.prototype.measure.apply(this, arguments);

		// NOTE: Top/bottom 1px video crop
		// - Cropped in CSS: video, .poster { margin-top: -1px; margin-bottom: -1px;}
		// - Cropped height is adjusted in metrics obj
		// - Crop amount added back to actual video on render()
		this.metrics.media.height -= 2;
		this.metrics.content.height -= 2;
	},

	/** @override */
	render: function() {
		PlayableRenderer.prototype.render.apply(this, arguments);

		var els, el, i, cssW, cssH;
		var img = this.defaultImage;
		var content = this.content;

		// media-size
		// ---------------------------------
		cssW = this.metrics.media.width + "px";
		cssH = this.metrics.media.height + "px";

		els = this.el.querySelectorAll(".media-size");
		for (i = 0; i < els.length; i++) {
			el = els.item(i);
			el.style.width = cssW;
			el.style.height = cssH;
		}

		content.style.width = cssW;
		content.style.height = (this.metrics.media.height - 1) + "px";

		// content-position
		// ---------------------------------
		var cssX, cssY;
		cssX = this.metrics.content.x + "px";
		cssY = this.metrics.content.y + "px";
		content.style.left = cssX;
		content.style.top = cssY;

		el = this.el.querySelector(".controls");
		// el.style.left = cssX;
		// controls.style.top = cssY;
		el.style.width = this.metrics.content.width + "px";
		el.style.height = this.metrics.content.height + "px";

		// // content-size
		// // ---------------------------------
		// cssW = this.metrics.content.width + "px";
		// cssH = this.metrics.content.height + "px";
		//
		// els = this.el.querySelectorAll(".content-size");
		// for (i = 0; i < els.length; i++) {
		// 	el = els.item(i);
		// 	el.style.width = cssW;
		// 	el.style.height = cssH;
		// }

		// NOTE: elements below must use video's UNCROPPED height, so +2px
		this.video.setAttribute("width", this.metrics.media.width);
		this.video.setAttribute("height", this.metrics.media.height + 2);
		img.setAttribute("width", this.metrics.media.width);
		img.setAttribute("height", this.metrics.media.height + 2);

		return this;
	},

	/* --------------------------- *
	/* initializeAsync
	/* --------------------------- */

	initializeAsync: function() {
		return Promise.resolve(this)
			.then(PlayableRenderer.whenSelectionIsContiguous)
			.then(PlayableRenderer.whenScrollingEnds)
			.then(
				function(view) {
					return Promise.all([
						view.whenVideoHasMetadata(view),
						PlayableRenderer.whenDefaultImageLoads(view),
					]).then(
						function(arr) {
							return Promise.resolve(view);
						},
						function(err) {
							return Promise.reject(err);
						}
					);
				})
			.then(
				function(view) {
					return view.whenAttached();
				})
			.then(
				function(view) {
					view.initializePlayable();
					view.updateOverlay(view.defaultImage, view.overlay);
					view.addSelectionListeners();
					return view;
				});
	},

	initializePlayable: function() {
		// video
		// ---------------------------------
		this.addMediaListeners();

		// progress-meter
		// ---------------------------------
		this.progressMeter = new ProgressMeter({
			el: this.el.querySelector(".progress-meter"),
			maxValues: {
				amount: this.video.duration,
				available: this.video.duration,
			},
			color: this.model.attr("color"),
			// backgroundColor: this.model.attr("background-color"),
			labelFn: this._progressLabelFn.bind(this)
		});
		// var parentEl = this.el.querySelector(".top-bar");
		// parentEl.insertBefore(this.progressMeter.render().el, parentEl.firstChild);
	},

	_progressLabelFn: function(value, total) {
		if (!this._started || this.video.ended || isNaN(value)) {
			return formatTimecode(total);
		} else if (!this.playbackRequested) {
			return Globals.PAUSE_CHAR;
		} else {
			return formatTimecode(total - value);
		}
	},

	/* ---------------------------
	/* whenVideoHasMetadata promise
	/* --------------------------- */

	whenVideoHasMetadata: function(view) {
		// NOTE: not pretty !!!
		return new Promise(function(resolve, reject) {
			var mediaEl = view.video;
			var eventHandlers = {
				loadedmetadata: function(ev) {
					if (ev) removeEventListeners();
					// console.log("%s::whenVideoHasMetadata [%s] %s", view.cid, "resolved", ev? ev.type : "sync");
					resolve(view);
				},
				abort: function(ev) {
					if (ev) removeEventListeners();
					reject(new PlayableRenderer.ViewError(view, new Error("whenVideoHasMetadata: view was removed")));
				},
				error: function(ev) {
					if (ev) removeEventListeners();
					var err;
					if (mediaEl.error) {
						err = new Error(_.invert(MediaError)[mediaEl.error.code]);
						err.infoCode = mediaEl.error.code;
					} else {
						err = new Error("Unspecified error");
					}
					err.infoSrc = mediaEl.src;
					err.logMessage = "whenVideoHasMetadata: " + err.name + " " + err.infoSrc;
					err.logEvent = ev;
					reject(err);
				},
			};
			//  (mediaEl.preload == "auto" && mediaEl.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA)
			// 	(mediaEl.preload == "metadata" && mediaEl.readyState >= HTMLMediaElement.HAVE_METADATA)
			if (mediaEl.error) {
				eventHandlers.error();
			} else if (mediaEl.readyState >= HTMLMediaElement.HAVE_METADATA) {
				eventHandlers.loadedmetadata();
			} else {
				var sources = mediaEl.querySelectorAll("source");
				var errTarget = sources.length > 0 ? sources.item(sources.length - 1) : mediaEl;
				var errCapture = errTarget === mediaEl; // use capture with HTMLMediaElement

				var removeEventListeners = function() {
					errTarget.removeEventListener("error", eventHandlers.error, errCapture);
					for (var ev in eventHandlers) {
						if (ev !== "error" && eventHandlers.hasOwnProperty(ev)) {
							mediaEl.removeEventListener(ev, eventHandlers[ev], false);
						}
					}
				};
				errTarget.addEventListener("error", eventHandlers.error, errCapture);
				for (var ev in eventHandlers) {
					if (ev !== "error" && eventHandlers.hasOwnProperty(ev)) {
						mediaEl.addEventListener(ev, eventHandlers[ev], false);
					}
				}
				mediaEl.preload = "metadata";
			}
		});
	},

	findPlayableSource: function(video) {
		var playable = this.model.get("sources").find(function(source) {
			return /^video\//.test(source.get("mime")) && video.canPlayType(source.get("mime")) != "";
		});
		return playable ? playable.get("original") : "";
	},

	/* ---------------------------
	/* PlayableRenderer implementation
	/* --------------------------- */

	/** @override initial value */
	_playbackRequested: false,

	/** @override */
	_isMediaPaused: function() {
		return this.video.paused;
	},

	/** @override */
	_playMedia: function() {
		if (this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA && this.video.seekable.length == 0) {
			console.warn(this.cid, "WTF! got video data, but cannot seek, calling load()");
			// this._logMessage("call:load", "got video data, but cannot seek, calling load()", "orange");
			this.video.load();
			// this.video.currentTime = 0;
		} else if (this.video.ended) {
			this.video.currentTime = this.video.seekable.start(0);
		}
		this.video.play();
	},

	/** @override */
	_pauseMedia: function() {
		this.video.pause();
	},

	/* ---------------------------
	/* media events
	/* --------------------------- */

	// updatePlaybackEvents: "play playing waiting pause seeking seeked ended",
	// updateBufferedEvents: "progress canplay canplaythrough playing timeupdate",//loadeddata

	playingOnceEvent: "playing",
	updatePlaybackEvents: "playing waiting pause",
	updateBufferedEvents: "progress canplay canplaythrough play playing",
	updatePlayedEvents: "timeupdate seeked",

	addMediaListeners: function() {
		if (!this._started) this.video.addEventListener(this.playingOnceEvent, this._onMediaPlayingOnce, false);
		this.addListener(this.video, this.updatePlaybackEvents, this._updatePlaybackState);
		this.addListener(this.video, this.updateBufferedEvents, this._updateBufferedValue);
		this.addListener(this.video, this.updatePlayedEvents, this._updatePlayedValue);
		this.video.addEventListener("ended", this._onMediaEnded, false);
		this.video.addEventListener("error", this._onMediaError, true);

		this.on("view:removed", this.removeMediaListeners, this);
	},

	removeMediaListeners: function() {
		this.off("view:removed", this.removeMediaListeners, this);

		if (!this._started) this.video.removeEventListener(this.playingOnceEvent, this._onMediaPlayingOnce, false);
		this.removeListener(this.video, this.updatePlaybackEvents, this._updatePlaybackState);
		this.removeListener(this.video, this.updateBufferedEvents, this._updateBufferedValue);
		this.removeListener(this.video, this.updatePlayedEvents, this._updatePlayedValue);
		this.video.removeEventListener("ended", this._onMediaEnded, false);
		this.video.removeEventListener("error", this._onMediaError, true);
	},

	/* ---------------------------
	/* media event handlers
	/* --------------------------- */

	_onMediaError: function(ev) {
		this.removeMediaListeners();
		this.removeSelectionListeners();

		this._onMediaEnded(ev);
		this.content.classList.remove("ended");
		this.content.classList.remove("waiting");
		this.content.classList.remove("started");
		this._started = false;

		this.mediaState = "error";
	},

	_onMediaPlayingOnce: function(ev) {
		this.video.removeEventListener(this.playingOnceEvent, this._onMediaPlayingOnce, false);
		if (!this._started) {
			this._started = true;
			this.content.classList.add("started");
		}
	},

	_onMediaEnded: function(ev) {
		this.playbackRequested = false;
		if (this.video.webkitDisplayingFullscreen) {
			this.video.webkitExitFullscreen();
		}
		if (document.fullscreenElement === this.video) {
			this.video.exitFullscreen();
		}
	},

	_updatePlaybackState: function(ev) {
		var classList = this.content.classList;
		if (this.playbackRequested) {
			switch (ev.type) {
				case "pause":
				case "playing":
					classList.remove("waiting");
					break;
				case "waiting":
					classList.add("waiting");
					break;
			}
		} else {
			classList.remove("waiting");
		}
		classList.toggle("ended", this.video.ended);

		this._updatePlayedValue(ev);
	},

	_updatePlayedValue: function(ev) {
		this._currentTimeValue = this.video.currentTime;
		if (this.progressMeter) {
			this.progressMeter.valueTo(this._currentTimeValue, 0, "amount");
		}
	},

	_updateBufferedValue: function(ev) {
		var bRanges = this.video.buffered;
		if (bRanges.length > 0) {
			this._bufferedValue = bRanges.end(bRanges.length - 1);
			if (this.progressMeter && ((this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA) /*|| (this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA && this.video.networkState == HTMLMediaElement.NETWORK_LOADING)*/ )) {
				this.progressMeter.valueTo(this._bufferedValue, 300, "available");
				// this.progressMeter.valueTo(this._bufferedValue, Math.max(0, 1000 * (this._bufferedValue - (this.progressMeter.getValue("available") | 0))), "available");
			}
		}
	},

	/* ---------------------------
	/* fullscreen api
	/* --------------------------- */

	_onFullscreenToggle: function(ev) {
		// NOTE: Ignore if MouseEvent.button is 0 or undefined (0: left-button)
		if (!ev.defaultPrevented && !ev.button && this.model.selected) {
			// ev.preventDefault();
			try {
				if (document.hasOwnProperty("fullscreenElement") &&
					document.fullscreenElement !== this.video) {
					document.addEventListener(fullscreenChangeEvent, this._onFullscreenChange, false);
					this.video.requestFullscreen();
				} else
				if (this.video.webkitSupportsFullscreen && !this.video.webkitDisplayingFullscreen) {
					this.video.addEventListener("webkitbeginfullscreen", this._onFullscreenChange, false);
					this.video.webkitEnterFullScreen();
				}
			} catch (err) {
				this.video.controls = false;
				console.error(err);
			}
		}
	},

	_onFullscreenChange: function(ev) {
		switch (ev.type) {
			case fullscreenChangeEvent:
				// var isOwnFullscreen = Modernizr.prefixed("fullscreenElement", document) === this.video;
				var isOwnFullscreen = document.fullscreenElement === this.video;
				this.video.controls = isOwnFullscreen;
				if (!isOwnFullscreen) {
					document.removeEventListener(fullscreenChangeEvent, this._onFullscreenChange, false);
				}
				break;
			case "webkitbeginfullscreen":
				this.video.controls = true;
				this.video.removeEventListener("webkitbeginfullscreen", this._onFullscreenChange, false);
				this.video.addEventListener("webkitendfullscreen", this._onFullscreenChange, false);
				break;
			case "webkitendfullscreen":
				this.video.controls = false;
				this.video.removeEventListener("webkitendfullscreen", this._onFullscreenChange, false);
				break;
		}
	},

	/* ---------------------------
	/* event helpers
	/* --------------------------- */

	addListener: function(target, events, handler, useCapture) {
		(typeof events === "string") && (events = events.split(" "));
		for (var i = 0; i < events.length; i++) {
			target.addEventListener(events[i], handler, !!useCapture);
		}
	},

	removeListener: function(target, events, handler, useCapture) {
		(typeof events === "string") && (events = events.split(" "));
		for (var i = 0; i < events.length; i++) {
			target.removeEventListener(events[i], handler, !!useCapture);
		}
	},
});

/* ---------------------------
/* log to screen
/* --------------------------- */
if (DEBUG) {

	VideoRenderer = (function(VideoRenderer) {
		if (!VideoRenderer.LOG_TO_SCREEN) return VideoRenderer;

		/** @type {Function} */
		var Color = require("color");
		/** @type {module:underscore.strings/lpad} */
		var lpad = require("underscore.string/lpad");
		/** @type {module:underscore.strings/rpad} */
		var rpad = require("underscore.string/rpad");

		// var fullscreenEvents = [
		// 	fullscreenChangeEvent, fullscreenErrorEvent,
		// 	"webkitbeginfullscreen", "webkitendfullscreen",
		// ];

		var mediaEvents = require("utils/event/mediaEventsEnum");
		var updatePlaybackStateEvents, updateBufferedEvents, updatePlayedEvents;

		// updatePlaybackStateEvents = ["playing", "waiting", "ended", "pause", "seeking", "seeked"];
		// updateBufferedEvents = ["progress", "durationchange", "canplay", "play"];
		// updatePlayedEvents = ["playing", "timeupdate"];

		updatePlaybackStateEvents = [
			"loadstart",
			"progress",
			"suspend",
			"abort",
			"error",
			"emptied",
			"stalled",
		];
		updateBufferedEvents = [
			"loadedmetadata",
			"loadeddata",
			"canplay",
			"canplaythrough",
			"playing",
			"waiting",
			"seeking", // seeking changed to true
			"seeked", // seeking changed to false
			"ended", // ended is true
		];
		updatePlayedEvents = ["play", "pause"];

		// Exclude some events from log
		mediaEvents = _.without(mediaEvents, "resize", "error");
		// Make sure event subsets exist in the main set
		updatePlaybackStateEvents = _.intersection(mediaEvents, updatePlaybackStateEvents);
		updateBufferedEvents = _.intersection(mediaEvents, updateBufferedEvents);
		updatePlayedEvents = _.intersection(mediaEvents, updatePlayedEvents);

		var readyStateSymbols = _.invert(_.pick(HTMLMediaElement,
			function(val, key, obj) {
				return /^HAVE_/.test(key);
			}));
		var readyStateToString = function(el) {
			return readyStateSymbols[el.readyState] + "(" + el.readyState + ")";
		};

		var networkStateSymbols = _.invert(_.pick(HTMLMediaElement,
			function(val, key, obj) {
				return /^NETWORK_/.test(key);
			}));
		var networkStateToString = function(el) {
			return networkStateSymbols[el.networkState] + "(" + el.networkState + ")";
		};

		var mediaErrorSymbols = _.invert(MediaError);
		var mediaErrorToString = function(el) {
			return el.error ? mediaErrorSymbols[el.error.code] + "(" + el.error.code + ")" : "[MediaError null]";
		};

		var findRangeIndex = function(range, currTime) {
			for (var i = 0, ii = range.length; i < ii; i++) {
				if (range.start(i) <= currTime && currTime <= range.end(i)) {
					return i;
				}
			}
			return -1;
		};

		var formatVideoError = function(video) {
			return [
				mediaErrorToString(video),
				networkStateToString(video),
				readyStateToString(video),
			].join(" ");
		};

		var getVideoStatsCols = function() {
			return "0000.000 [Current/Total] [Seekable   ] [Buffered   ] networkState readyState      Playing";
			// return "0000.620 [t:  0.0  27.4] [s: 27.4 0/1] [b:  0.5 0/1] LOADING(2)   FUTURE_DATA(3)  :: (::)";
		}

		var formatVideoStats = function(video) {
			var currTime = video.currentTime,
				durTime = video.duration,
				bRanges = video.buffered,
				bRangeIdx,
				sRanges = video.seekable,
				sRangeIdx;

			bRangeIdx = findRangeIndex(bRanges, currTime);
			sRangeIdx = findRangeIndex(sRanges, currTime);
			return [
				"[t:" + lpad(currTime.toFixed(1), 5) +
					" " + lpad((!isNaN(durTime) ? durTime.toFixed(1) : "-"), 5) + "]",
				"[s:" + lpad((sRangeIdx >= 0 ? sRanges.end(sRangeIdx).toFixed(1) : "-"), 5) +
					" " + (sRangeIdx >= 0 ? sRangeIdx : "-") + "/" + sRanges.length + "]",
				"[b:" + lpad((bRangeIdx >= 0 ? bRanges.end(bRangeIdx).toFixed(1) : "-"), 5) +
					" " + (bRangeIdx >= 0 ? bRangeIdx : "-") + "/" + bRanges.length + "]",
				rpad(networkStateToString(video).substr(8), 12),
				rpad(readyStateToString(video).substr(5), 15),
				(video.ended ? ">:" : (video.paused ? "::" : ">>")),
			].join(" ");
		};

		return VideoRenderer.extend({

			/** @override */
			initialize: function() {
				VideoRenderer.prototype.initialize.apply(this, arguments);

				_.bindAll(this, "__handleMediaEvent");

				var fgColor = this.model.attr("color"),
					red = new Color("red"),
					blue = new Color("blue"),
					green = new Color("green");

				for (var i = 0; i < mediaEvents.length; i++) {
					var ev = mediaEvents[i];
					this.video.addEventListener(ev, this.__handleMediaEvent, false);

					var c = new Color(fgColor),
						cc = 1;
					if (updateBufferedEvents.indexOf(ev) != -1) c.mix(green, (cc /= 2));
					if (updatePlayedEvents.indexOf(ev) != -1) c.mix(red, (cc /= 2));
					if (updatePlaybackStateEvents.indexOf(ev) != -1) c.mix(blue, (cc /= 2));
					this.__logColors[ev] = c.rgbString();
				}
				this.video.addEventListener("error", this.__handleMediaEvent, true);
			},

			/** @override */
			remove: function() {
				VideoRenderer.prototype.remove.apply(this, arguments);
				for (var i = 0; i < mediaEvents.length; i++) {
					if (mediaEvents[i] == "error") continue;
					this.video.removeEventListener(mediaEvents[i], this.__handleMediaEvent, false);
				}
				this.video.removeEventListener("error", this.__handleMediaEvent, true);
			},

			/** @override */
			_onVisibilityChange: function(ev) {
				VideoRenderer.prototype._onVisibilityChange.apply(this, arguments);
				var stateVal = Modernizr.prefixed("visibilityState", document);
				this.__logEvent("visibilityState:" + stateVal, ev.type + ":" + stateVal);
			},

			/** @override */
			_onFullscreenChange: function(ev) {
				VideoRenderer.prototype._onFullscreenChange.apply(this, arguments);
				var logtype = (document.fullscreenElement === this.video ? "enter:" : "exit:") + ev.type;
				this.__logEvent("document.fullscreenElement: " + this.cid, logtype);
			},

			/** @override */
			_onFullscreenToggle: function(ev) {
				VideoRenderer.prototype._onFullscreenToggle.apply(this, arguments);
				if (!ev.defaultPrevented && this.model.selected) {
					this.__logEvent("fullscreen-toggle", ev.type);
				}
			},

			__handleMediaEvent: function(ev) {
				var evmsg; //, errmsg;
				// evmsg = formatVideoStats(this.video) + " " + rpad(this._lastPlaybackStates || "-", 9);
				evmsg = formatVideoStats(this.video);
				if (this.playbackRequested === true) {
					evmsg += " (>>)";
				} else if (this.playbackRequested === false) {
					evmsg += " (::)";
				} else {
					evmsg += " (--)";
				}
				this.__logEvent(evmsg, ev.type);
				if (ev.type === "error" || ev.type === "abort") {
					this.__logMessage(formatVideoError(this.video), ev.type);
				}
			},

			__logEvent: function(msg, logtype, color) {
				var logEntryEl = this.__logElement.lastElementChild;
				if ((logEntryEl && logEntryEl.getAttribute("data-logtype") == logtype) &&
					((logtype === "timeupdate") || (logtype === "progress"))) {
					var logRepeatVal = parseInt(logEntryEl.getAttribute("data-logrepeat"));
					logEntryEl.textContent = this.__getTStamp() + " " + msg;
					logEntryEl.setAttribute("data-logrepeat", isNaN(logRepeatVal) ? 2 : ++logRepeatVal);
				} else {
					this.__logMessage(msg, logtype, color);
				}
			},

			__getHeaderText: function() {
				return getVideoStatsCols();
			},
		});
	})(VideoRenderer);

}

module.exports = VideoRenderer;
}).call(this,true)

},{"./VideoRenderer.hbs":96,"app/control/Globals":34,"app/view/component/ProgressMeter":71,"app/view/render/PlayableRenderer":93,"color":"color","underscore":"underscore","underscore.string/lpad":28,"underscore.string/rpad":30,"utils/event/mediaEventsEnum":110,"utils/prefixedEvent":112}],98:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function";

  return "<div id=\"desc_b"
    + container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" class=\"content sizing mdown\">"
    + ((stack1 = ((helper = (helper = helpers.desc || (depth0 != null ? depth0.desc : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"desc","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</div>\n";
},"useData":true});

},{"hbsfy/runtime":20}],99:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function";

  return "<div id=\"desc_m"
    + container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" class=\"content sizing\"><p>"
    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</p>"
    + ((stack1 = ((helper = (helper = helpers.sub || (depth0 != null ? depth0.sub : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"sub","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</div>\n";
},"useData":true});

},{"hbsfy/runtime":20}],100:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"1":function(container,depth0,helpers,partials,data) {
    var helper;

  return "		<p><code>"
    + container.escapeExpression(((helper = (helper = helpers.infoSrc || (depth0 != null ? depth0.infoSrc : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(depth0 != null ? depth0 : {},{"name":"infoSrc","hash":{},"data":data}) : helper)))
    + "</code></p>\n";
},"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<div class=\"error-message color-fg\">\n	<p><strong>"
    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper)))
    + "</strong> <code>"
    + alias4(((helper = (helper = helpers.message || (depth0 != null ? depth0.message : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"message","hash":{},"data":data}) : helper)))
    + "</code></p>\n"
    + ((stack1 = helpers["if"].call(alias1,(depth0 != null ? depth0.infoSrc : depth0),{"name":"if","hash":{},"fn":container.program(1, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "</div>";
},"useData":true});

},{"hbsfy/runtime":20}],101:[function(require,module,exports){
// var Handlebars = require("handlebars")["default"];
var Handlebars = require("hbsfy/runtime");
/** @type {Function} */
var Color = require("color");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

// (function() {
var helpers = {
	/*
	/* Arithmetic helpers
	/*/
	add: function(value, addition) {
		return value + addition;
	},
	subtract: function(value, substraction) {
		return value - substraction;
	},
	divide: function(value, divisor) {
		return value / divisor;
	},
	multiply: function(value, multiplier) {
		return value * multiplier;
	},
	floor: function(value) {
		return Math.floor(value);
	},
	ceil: function(value) {
		return Math.ceil(value);
	},
	round: function(value) {
		return Math.round(value);
	},
	global: function(value) {
		return Globals[value];
	},

	/*
	/* Flow control helpers
	/*/
	is: function(a, b, opts) {
		return (a === b) ? opts.fn(this) : opts.inverse(this);
	},
	isnot: function(a, b, opts) {
		return (a !== b) ? opts.fn(this) : opts.inverse(this);
	},
	isany: function(value) {
		var i = 0,
			ii = arguments.length - 2,
			opts = arguments[ii + 1];
		do
			if (value === arguments[++i]) {
				return opts.fn(this);
			}
		while (i < ii);
		return opts.inverse(this);
	},
	contains: function(a, b, opts) {
		return (a.indexOf(b) !== -1) ? opts.fn(this) : opts.inverse(this);
	},
	ignore: function() {
		return "";
	},

	/*
	/* Color helpers
	/*/
	mix: function(colora, colorb, amount) {
		return new Color(colora).mix(new Color(colorb), amount).rgbString();
	},
	lighten: function(color, amount) {
		return new Color(color).lighten(amount).rgbString();
	},
	darken: function(color, amount) {
		return new Color(color).darken(amount).rgbString();
	},
	// colorFormat: function(color, fmt) {
	// 	switch (fmt) {
	// 		case "rgb":
	// 			return new Color(color).rgbString();
	// 		case "hsl":
	// 			return new Color(color).hslString();
	// 		case "hex": default:
	// 			return new Color(color).hexString();
	// 	}
	// },
};
for (var helper in helpers) {
	if (helpers.hasOwnProperty(helper)) {
		Handlebars.registerHelper(helper, helpers[helper]);
	}
}
// })();

// module.exports = Handlebars;

},{"app/control/Globals":34,"color":"color","hbsfy/runtime":20}],102:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Events = require("backbone").Events;


// var defaultOptions = {
// 	tick: 1,
// 	onstart: null,
// 	ontick: null,
// 	onpause: null,
// 	onstop: null,
// 	onend: null
// }
var idSeed = 0;

var Timer = function(options) {
	// if (!(this instanceof Timer)) {
	// 	return new Timer(options);
	// }
	this._id = idSeed++;
	// this._options = {};
	this._duration = 0;
	this._status = "initialized";
	this._start = 0;
	// this._measures = [];

	// for (var prop in defaultOptions) {
	// 	this._options[prop] = defaultOptions[prop];
	// }
	// this.options(options);
};

_.extend(Timer.prototype, Events, {

	start: function(duration) {
		if (!_.isNumber(duration) && !this._duration) {
			return this;
		}
		// duration && (duration *= 1000)
		if (this._timeout && this._status === "started") {
			return this;
		}
		var evName = (this._status === "stopped") ? "start" : "resume";
		this._duration = duration || this._duration;
		this._timeout = window.setTimeout(end.bind(this), this._duration);
		// if (typeof this._options.ontick === "function") {
		// 	this._interval = setInterval(function() {
		// 		this.trigger("tick", this.getDuration())
		// 	}.bind(this), +this._options.tick * 1000)
		// }
		this._start = _now();
		this._status = "started";
		this.trigger(evName, this.getDuration());
		return this;
	},

	pause: function() {
		if (this._status !== "started") {
			return this;
		}
		this._duration -= (_now() - this._start);
		clear.call(this, false);
		this._status = "paused";
		this.trigger("pause", this.getDuration());
		return this;
	},

	stop: function() {
		if (!/started|paused/.test(this._status)) {
			return this;
		}
		clear.call(this, true);
		this._status = "stopped";
		this.trigger("stop");
		return this;
	},

	getDuration: function() {
		if (this._status === "started") {
			return this._duration - (_now() - this._start);
		}
		if (this._status === "paused") {
			return this._duration;
		}
		return 0;
	},

	getStatus: function() {
		return this._status;
	},
});

var _now = window.performance ?
	window.performance.now.bind(window.performance) :
	Date.now.bind(Date);

function end() {
	clear.call(this);
	this._status = "stopped";
	this.trigger("end");
}

function clear(clearDuration) {
	window.clearTimeout(this._timeout);
	// window.clearInterval(this._interval);
	if (clearDuration === true) {
		this._duration = 0;
	}
}

Object.defineProperties(Timer.prototype, {
	duration: {
		enumerable: true,
		get: function() {
			return this.getDuration();
		}
	},
	status: {
		enumerable: true,
		get: function() {
			return this.getStatus();
		}
	}
});

Object.defineProperties(Timer, {
	STOPPED: {
		enumerable: true,
		value: "stopped"
	},
	STARTED: {
		enumerable: true,
		value: "started"
	},
	PAUSED: {
		enumerable: true,
		value: "paused"
	},
});

module.exports = Timer;

},{"backbone":"backbone","underscore":"underscore"}],103:[function(require,module,exports){
/* -------------------------------
/* Imports
/* ------------------------------- */


/** @type {module:underscore} */
var _ = require("underscore");

/** @type {module:utils/TransformItem} */
var TransformItem = require("./TransformItem");

var idSeed = 0;
var cidSeed = 100;
var slice = Array.prototype.slice;

/**
 * @constructor
 * @type {module:app/helper/TransformHelper}
 */
function TransformHelper() {
	this.id = idSeed++;
	this._items = [];
	this._itemsById = {};
}

TransformHelper.prototype = Object.create({

	/* -------------------------------
	/* Private
	/* ------------------------------- */

	_get: function(el) {
		if (this.has(el)) {
			return this._itemsById[el.eid];
		} else {
			return this._add(el);
		}
	},

	_add: function(el) {
		var item, id;
		// id = el.eid || el.cid || el.id;
		// if (!id || (this._itemsById[id] && (this._itemsById[id].el !== el))) {
		// 	id = "elt" + cidSeed++;
		// }
		// if (!el.eid) {
		// 	id = el.eid || el.cid || ("elt" + cidSeed++);
		// }
		id = el.eid || el.cid || ("elt" + cidSeed++);
		item = new TransformItem(el, id);
		this._itemsById[id] = item;
		this._items.push(item);
		return item;
	},

	_remove: function(el) {
		if (this.has(el)) {
			var o = this._itemsById[el.eid];
			this._items.splice(this._items.indexOf(o), 1);
			o.destroy();
			delete this._itemsById[el.eid];
		}
	},

	_invoke: function(funcName, args, startIndex) {
		var i, ii, j, jj, el, o, rr;
		var funcArgs = null;
		if (startIndex !== void 0) {
			funcArgs = slice.call(args, 0, startIndex);
		} else {
			startIndex = 0;
		}
		for (i = startIndex, ii = args.length, rr = []; i < ii; ++i) {
			el = args[i];
			// iterate on NodeList, Arguments, Array...
			if (el.length) {
				for (j = 0, jj = el.length; j < jj; ++j) {
					o = this._get(el[j]);
					rr.push(o[funcName].apply(o, funcArgs));
				}
			} else {
				o = this._get(el);
				rr.push(o[funcName].apply(o, funcArgs));
			}
		}
		return rr;
	},

	/* -------------------------------
	/* Public
	/* ------------------------------- */

	has: function(el) {
		return el.eid && this._itemsById[el.eid] !== void 0;
	},

	getItems: function() {
		var i, j, el, ret = [];
		for (i = 0; i < arguments.length; ++i) {
			el = arguments[i];
			if (el.length) {
				for (j = 0; j < el.length; ++j) {
					ret.push(this._get(el[j]));
				}
			} else {
				ret.push(this._get(el));
			}
		}
		return ret;
	},

	get: function(el) {
		return this._get(el);
	},

	add: function() {
		var i, j, el;
		for (i = 0; i < arguments.length; ++i) {
			el = arguments[i];
			if (el.length) {
				for (j = 0; j < el.length; ++j) {
					this._get(el[j]);
				}
			} else {
				this._get(el);
			}
		}
	},

	remove: function() {
		var i, j, el;
		for (i = 0; i < arguments.length; ++i) {
			el = arguments[i];
			if (el.length) {
				for (j = 0; j < el.length; ++j) {
					this._remove(el[j]);
				}
			} else {
				this._remove(el);
			}
		}
	},

	/* --------------------------------
	/* public
	/* -------------------------------- */

	/* public: single arg
	/* - - - - - - - - - - - - - - - - */

	hasOffset: function(el) {
		return this.has(el) ? this._itemsById[el.eid].hasOffset : (void 0);
	},

	/* public: capture
	/* - - - - - - - - - - - - - - - - */

	capture: function() {
		this._invoke("capture", arguments);
	},
	captureAll: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].capture();
		}
	},

	clearCapture: function() {
		this._invoke("clearCapture", arguments);
	},
	clearAllCaptures: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].clearCapture();
		}
	},

	/* public: offset
	/* - - - - - - - - - - - - - - - - */
	offset: function(x, y) {
		this._invoke("offset", arguments, 2);
	},
	offsetAll: function(x, y) {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].offset(x, y);
		}
	},

	clearOffset: function() {
		this._invoke("clearOffset", arguments);
	},
	clearAllOffsets: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].clearOffset();
		}
	},

	/* public: transitions
	/* - - - - - - - - - - - - - - - - */

	runTransition: function(transition) {
		this._invoke("runTransition", arguments, 1);
	},
	runAllTransitions: function(transition) {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].runTransition(transition);
		}
	},

	clearTransition: function() {
		this._invoke("clearTransition", arguments);
	},
	clearAllTransitions: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].clearTransition();
		}
	},

	stopTransition: function() {
		this._invoke("stopTransition", arguments);
	},
	stopAllTransitions: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].stopTransition();
		}
	},

	whenTransitionEnds: function() {
		var res = this._invoke("whenTransitionEnds", arguments);
		return res.length != 0 ?
			Promise.all(res) :
			Promise.resolve(null);
	},
	whenAllTransitionsEnd: function() {
		return (this._items.length != 0) ? Promise.all(this._items.map(function(o) {
			return o.whenTransitionEnds();
		})) : Promise.resolve(null);
	},

	promise: function() {
		return arguments.length == 0 ?
			this.whenAllTransitionsEnd() :
			this.whenTransitionEnds.call(this, arguments);
	},

	/* -------------------------------
	/* validation
	/* ------------------------------- */

	validate: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].validate();
		}
	},
}, {
	items: {
		get: function() {
			return this._items;
		}
	}
});

module.exports = TransformHelper;

},{"./TransformItem":104,"underscore":"underscore"}],104:[function(require,module,exports){
(function (DEBUG){
/* -------------------------------
 * Imports
 * ------------------------------- */

/** @type {module:underscore} */
var _ = require("underscore");

/** @type {module:utils/prefixedProperty} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {module:utils/prefixedStyleName} */
var prefixedStyleName = require("utils/prefixedStyleName");
/** @type {module:utils/prefixedEvent} */
var prefixedEvent = require("utils/prefixedEvent");

/** @type {String} */
var transitionEnd = prefixedEvent("transitionend"); //require("utils/event/transitionEnd");
// /** @type {Function} */// var slice = Array.prototype.slice;

// /** @type {module:utils/debug/traceElement} */
// var traceElt = require("./debug/traceElement");
// var traceEltCache = {};
// var log = function() {
// 	var logFn = "log";
// 	var args = slice.apply(arguments);
// 	switch(args[0]) {
// 		case "error":
// 		case "warn":
// 		case "info":
// 			logFn = args.shift();
// 			break;
// 		default:
// 			// break;
// 			return;
// 	}
// 	var el, txId;
// 	if ((el = args[0]) && (txId = el.eid)) {
// 		args[0] = traceEltCache[txId] || (traceEltCache[txId] = el);
// 	}
// 	args[0] = "\t" + args[0];
// 	console[logFn].apply(console, args);
// };

/* jshint -W079 */
// var console = (function(target) {
// 	return Object.getOwnPropertyNames(target).reduce(function(proxy, prop) {
// 		if ((typeof target[prop]) == "function") {
// 			switch (prop) {
// 				case "error":
// 				case "warn":
// 				case "info":
// 					proxy[prop] = function () {
// 						var args = slice.apply(arguments);
// 						if (typeof args[0] == "string") {
// 							args[0] = prop + "::" + args[0];
// 						}
// 						return target[prop].apply(target, args);
// 					};
// 					break;
// 				case "log":
// 					proxy[prop] = function() {};
// 					break;
// 				default:
// 					proxy[prop] = target[prop].bind(target);
// 					break;
// 			}
// 		} else {
// 			Object.defineProperty(proxy, prop, {
// 				get: function() { return target[prop]; },
// 				set: function(val) { target[prop] = val; }
// 			});
// 		}
// 		return proxy;
// 	}, {});
// })(window.console);
/* jshint +W079 */

/* -------------------------------
/* Private static
/* ------------------------------- */

var NO_TRANSITION_VALUE = "none 0s step-start 0s";
// var NO_TRANSITION_VALUE = "all 0.001s step-start 0.001s";

var UNSET_TRANSITION = {
	name: "unset",
	className: "tx-unset",
	property: "none",
	easing: "ease",
	delay: 0,
	duration: 0,
	cssText: "unset",
};


// var translateTemplate = function(o) {
// 	// return "translate(" + o._renderedX + "px, " + o._renderedY + "px)";
// 	// return "translate3d(" + o._renderedX + "px, " + o._renderedY + "px, 0px)";
// };
var translateTemplate = (function() {
	var fn = require("app/control/Globals").TRANSLATE_TEMPLATE;
	return function(o) {
		return fn(o._renderedX, o._renderedY);
	};
}());

// var transitionTemplate = _.template("<%= property %> <% duration/1000 %>s <%= easing %> <% delay/1000 %>s");
var transitionTemplate = function(o) {
	return o.property + " " + o.duration / 1000 + "s " + o.easing + " " + o.delay / 1000 + "s";
};

var propDefaults = {
	"opacity": "1",
	"visibility": "visible",
	"transform": "matrix(1, 0, 0, 1, 0, 0)",
	"transformStyle": "",
	"transition": "",
	// "willChange": "",
	// "transitionDuration": "0s",
	// "transitionDelay": "0s",
	// "transitionProperty": "none",
	// "transitionTimingFunction": "ease"
};
var propKeys = Object.keys(propDefaults);
var propNames = propKeys.reduce(function(obj, propName) {
	obj[propName] = prefixedProperty(propName);
	return obj;
}, {});

/** @type {module:utils/strings/camelToDashed} */
var camelToDashed = require("utils/strings/camelToDashed");
var styleNames = propKeys.map(camelToDashed).reduce(function(obj, propName) {
	obj[propName] = prefixedStyleName(propName);
	return obj;
}, {});

var resolveAll = function(pp, result) {
	if (pp.length != 0) {
		pp.forEach(function(p, i, a) {
			p.resolve(result);
			a[i] = null;
		});
		pp.length = 0;
	}
	return pp;
};

var rejectAll = function(pp, reason) {
	if (pp.length != 0) {
		pp.forEach(function(p, i, a) {
			p.reject(reason);
			a[i] = null;
		});
		pp.length = 0;
	}
	return pp;
};

/* -------------------------------
 * TransformItem
 * ------------------------------- */

/**
 * @constructor
 */
var TransformItem = function(el, id) {
	_.bindAll(this, "_onTransitionEnd");

	this.el = el;
	this.id = id;
	this.el.eid = id;
	this.el.addEventListener(transitionEnd, this._onTransitionEnd, false);

	this._captureInvalid = false;
	this._capturedChanged = false;
	this._capturedX = null;
	this._capturedY = null;
	this._currCapture = {};
	this._lastCapture = {};

	this._hasOffset = false;
	this._offsetInvalid = false;
	this._offsetX = null;
	this._offsetY = null;

	this._renderedX = null;
	this._renderedY = null;

	this._hasTransition = false;
	this._transitionInvalid = false;
	this._transitionRunning = false;
	this._transition = _.extend({}, UNSET_TRANSITION); //{};

	this._promises = [];
	this._pendingPromises = [];
}

TransformItem.prototype = Object.create({

	/* -------------------------------
	/* Public
	/* ------------------------------- */

	/* destroy
	/* - - - - - - - - - - - - - - - - */
	destroy: function() {
		// NOTE: style property may have been modified; clearOffset(element) should
		// be called explicitly if clean up is required.
		this.el.removeEventListener(transitionEnd, this._onTransitionEnd, false);
		rejectAll(this._pendingPromises, this);
		rejectAll(this._promises, this);
		// delete this.el.eid;
	},

	/* capture
	/* - - - - - - - - - - - - - - - - */
	capture: function() {
		// console.log("tx[%s]::capture", this.id);
		this._validateCapture();
		return this;
	},

	clearCapture: function() {
		// console.log("tx[%s]::clearCapture", this.id);
		// this._hasOffset = false;
		this._captureInvalid = true;
		return this;
	},

	/* offset/clear
	/* - - - - - - - - - - - - - - - - */
	offset: function(x, y) {
		// console.log("tx[%s]::offset", this.id);

		this._hasOffset = true;
		this._offsetInvalid = true;
		this._offsetX = x || 0;
		this._offsetY = y || 0;
		// if (this.immediate) this._validateOffset();
		return this;
	},

	clearOffset: function() {
		if (this._hasOffset) {
			// console.log("tx[%s]::clearOffset", this.id);

			this._hasOffset = false;
			this._offsetInvalid = true;
			this._offsetX = null;
			this._offsetY = null;
			// if (this.immediate) this._validateOffset();
		} else {
			// console.log("tx[%s]::clearOffset no offset to clear", this.id);
		}
		return this;
	},

	/* transitions
	/* - - - - - - - - - - - - - - - - */
	runTransition: function(transition) {
		if (!transition) { // || (transition.duration + transition.delay) == 0) {
			return this.clearTransition();
		}
		var lastValue = this._transitionValue;
		var lastName = this._transition.name;
		this._transition.property = styleNames["transform"];
		this._transition = _.extend(this._transition, transition);
		this._transitionValue = transitionTemplate(this._transition);

		if (this._transitionInvalid) {
			console.warn("tx[%s]::runTransition set over (%s:'%s' => %s:'%s')", this.id,
				lastName, lastValue, this._transition.name, this._transitionValue);
		}

		this._hasTransition = true;
		this._transitionInvalid = true;
		// if (this.immediate) this._validateTransition();
		return this;
	},

	clearTransition: function() {
		this._transition = _.extend(this._transition, UNSET_TRANSITION);
		this._transitionValue = NO_TRANSITION_VALUE;

		this._hasTransition = false;
		this._transitionInvalid = true;
		// if (this.immediate) this._validateTransition();
		return this;
	},

	stopTransition: function() {
		// this._transition.name = "[none]";
		// this._transition.property = "none";
		this._transition = _.extend(this._transition, UNSET_TRANSITION);
		this._transitionValue = NO_TRANSITION_VALUE;

		this._hasTransition = false;
		this._transitionInvalid = true;
		// if (this.immediate) this._validateTransition();
		return this;
	},

	whenTransitionEnds: function() {
		var d, p, pp;
		if (this._transitionInvalid || this._transitionRunning) {
			d = {};
			p = new Promise(function(resolve, reject) {
				d.resolve = resolve;
				d.reject = reject;
			});
			pp = this._transitionInvalid ? this._pendingPromises : this._promises;
			pp.push(d);
		} else {
			p = Promise.resolve(this);
		}
		return p;
	},

	/* validation
	/* - - - - - - - - - - - - - - - - */
	validate: function() {
		// this.el.removeEventListener(transitionEnd, this._onTransitionEnd, false);
		this._ignoreEvent = true;

		if (this._captureInvalid) {
			var lastX = (this._renderedX !== null ? this._renderedX : this._capturedX),
				lastY = (this._renderedY !== null ? this._renderedY : this._capturedY);

			// this._validateTransition();
			this._validateCapture();
			this._validateOffset();

			var currX = (this._renderedX !== null ? this._renderedX : this._capturedX),
				currY = (this._renderedY !== null ? this._renderedY : this._capturedY);

			if (lastX === currX && lastY === currY) {
				this._hasTransition && console.warn("tx[%s]::validate unchanged: last:[%i,%i] curr:[%i,%i]", this.el.id || this.id, lastX, lastY, currX, currY);
				// console.info("tx[%s]::validate unchanged: last:[%f,%f] curr:[%f,%f] render:[%f,%f] captured[%f,%f]", this.el.id || this.id, lastX, lastY, currX, currY, this._renderedX, this._renderedY, this._capturedX, this._capturedY);
				this.clearTransition();
				// this._validateTransition();
			}
			this._validateTransition();
		} else {
			// this._validateCapture();
			this._validateTransition();
			this._validateOffset();
		}

		// this.el.addEventListener(transitionEnd, this._onTransitionEnd, false);
		this._ignoreEvent = false;

		// if (this._capturedChanged) {
		// 	console.error("tx[%s]::validate capture changed: [%f,%f]", this.id, this._capturedX, this._capturedY);
		// }
		this._capturedChanged = false;
		return this;
	},

	/* -------------------------------
	/* Private
	/* ------------------------------- */

	_validateCapture: function() {
		if (!this._captureInvalid) {
			return;
		}
		// var computed, capturedValues;
		var transformValue = null;

		if (this._hasOffset && !this._offsetInvalid) {
			// this is an explicit call to capture() instead of a subcall from _validateOffset()
			transformValue = this._getCSSProp("transform");
			if (transformValue === "") {
				console.error("tx[%s]::_capture valid offset (%i,$i) but transformValue=\"\"", this.id, this._offsetX, this._offsetY);
			}
			this._removeCSSProp("transform");
		}

		// NOTE: reusing object, all props will be overwritten
		this._lastCapture = this._currCapture;
		this._currCapture = this._getComputedCSSProps();

		if (this._currCapture.transform !== this._lastCapture.transform) {
			var m, mm; //, ret = {};
			mm = this._currCapture.transform.match(/(matrix|matrix3d)\(([^\)]+)\)/);
			if (mm) {
				m = mm[2].split(",");
				if (mm[1] === "matrix") {
					this._capturedX = parseFloat(m[4]);
					this._capturedY = parseFloat(m[5]);
				} else {
					this._capturedX = parseFloat(m[12]);
					this._capturedY = parseFloat(m[13]);
				}
			} else {
				this._capturedX = 0;
				this._capturedY = 0;
			}
			this._capturedChanged = true;
		}
		if (transformValue !== null) {
			console.log("tx[%s]::_capture reapplying '%s'", this.id, transformValue);
			this._setCSSProp("transform", transformValue);
		}
		this._captureInvalid = false;
	},

	_validateOffset: function() {
		if (this._offsetInvalid) {
			// this._validateCapture();
			this._offsetInvalid = false;
			if (this._hasOffset) {
				var tx = this._offsetX + this._capturedX;
				var ty = this._offsetY + this._capturedY;
				if (tx !== this._renderedX || ty !== this._renderedY) {
					this._renderedX = tx;
					this._renderedY = ty;
					this._setCSSProp("transform", translateTemplate(this));
				}
			} else {
				this._renderedX = null;
				this._renderedY = null;
				this._removeCSSProp("transform");
			}
		}
	},

	_validateTransition: function() {
		if (this._transitionInvalid) {
			// this._validateCapture();
			this._transitionInvalid = false;

			// save promises made while invalid
			var reject = this._promises;
			// prepare _promises and push in new ones
			this._promises = this._pendingPromises;
			// whatever still here is to be rejected. reuse array
			this._pendingPromises = rejectAll(reject, this);

			// Set running flag, if there's a transition to run
			this._transitionRunning = this._hasTransition;
			// Set the css value (which will be empty string if there's no transition)
			this._setCSSProp("transition", this._transitionValue);
			if (DEBUG) {
				if (this._hasTransition) {
					this.el.setAttribute("data-tx", this._transition.name);
				}
			}

			if (!this._hasTransition) {
				// if there is no transition, resolve promises now
				resolveAll(this._promises, this);
			}
		}
	},

	_onTransitionEnd: function(ev) {
		if (this._ignoreEvent) {
			return;
		}
		if (this._transitionRunning && (this.el === ev.target) &&
			(this._transition.property == ev.propertyName)) {
			this._hasTransition = false;
			this._transitionRunning = false;
			this._removeCSSProp("transition");
			resolveAll(this._promises, this);

			if (DEBUG) {
				if (this.el.hasAttribute("data-tx")) {
					// this.el.setAttribute("data-tx-last", this.el.getAttribute("data-tx"));
					this.el.removeAttribute("data-tx");
				}
			}
		}
	},

	/* -------------------------------
	/* CSS
	/* ------------------------------- */

	_getCSSProp: function(prop) {
		return this.el.style[propNames[prop]];
		// return this.el.style[prefixedProperty(prop)];
		// return this.el.style.getPropertyValue(styleNames[prop]);
	},

	_setCSSProp: function(prop, value) {
		if (prop === "transition" && value == NO_TRANSITION_VALUE) {
			value = "";
		}
		if (value === null || value === void 0 || value === "") {
			this._removeCSSProp(prop);
		} else {
			this.el.style[propNames[prop]] = value;
			// this.el.style.setProperty(styleNames[prop], value);
		}
	},

	_removeCSSProp: function(prop) {
		this.el.style[propNames[prop]] = "";
		// this.el.style.removeProperty(styleNames[prop]);
	},

	_getComputedCSSProps: function() {
		var values = {};
		var computed = window.getComputedStyle(this.el);
		for (var p in propNames) {
			values[p] = computed[propNames[p]];
		}
		return values;
	},
}, {
	transition: {
		get: function() {
			return this._transition;
		}
	},
	hasTransition: {
		get: function() {
			return this._hasTransition;
		}
	},
	capturedChanged: {
		get: function() {
			return this._capturedChanged;
		}
	},
	capturedX: {
		get: function() {
			return this._capturedX;
		}
	},
	capturedY: {
		get: function() {
			return this._capturedY;
		}
	},

	hasOffset: {
		get: function() {
			return this._hasOffset;
		}
	},
	offsetX: {
		get: function() {
			return this._offsetX;
		}
	},
	offsetY: {
		get: function() {
			return this._offsetY;
		}
	},
});

module.exports = TransformItem;
}).call(this,true)

},{"app/control/Globals":34,"underscore":"underscore","utils/prefixedEvent":112,"utils/prefixedProperty":113,"utils/prefixedStyleName":114,"utils/strings/camelToDashed":118}],105:[function(require,module,exports){
module.exports = function(a1, a2, dest) {
	return a1.reduce(function(res, o, i, a) {
		if (a2.indexOf(o) == -1) res.push(o);
		return res;
	}, (dest !== void 0) ? dest : []);
};
},{}],106:[function(require,module,exports){
var PI2 = Math.PI * 2;

var splice = Array.prototype.splice;
// var concat = Array.prototype.concat;

var _mod = function(n, m) {
	return ((n % m) + m) % m;
};

var setStyle = function(ctx, s) {
	if (typeof s != "object") return;
	for (var p in s) {
		switch (typeof ctx[p]) {
			case "undefined":
				break;
			case "function":
				if (Array.isArray(s[p])) ctx[p].apply(ctx, s[p]);
				else ctx[p].call(ctx, s[p]);
				break;
			default:
				ctx[p] = s[p];
		}
	}
};

var _drawShape = function(fn, s, ctx) {
	ctx.save();
	if (s) setStyle(ctx, s);
	fn.apply(null, splice.call(arguments, 2));
	if (ctx.lineWidth !== "transparent") ctx.stroke();
	if (ctx.fillStyle !== "transparent") ctx.fill();
	ctx.restore();
};

module.exports = {
	setStyle: setStyle,

	vGuide: function(ctx, x) {
		ctx.beginPath();
		ctx.moveTo(x, 0);
		ctx.lineTo(x, ctx.canvas.height);
	},
	drawVGuide: function(ctx, s, x) {
		_drawShape(this.vGuide, s, ctx, x);
	},

	hGuide: function(ctx, y) {
		ctx.beginPath();
		ctx.moveTo(0, y);
		ctx.lineTo(ctx.canvas.width, y);
	},
	drawHGuide: function(ctx, s, y) {
		_drawShape(this.hGuide, s, ctx, y);
	},

	crosshair: function(ctx, x, y, r) {
		ctx.save();
		ctx.translate(x, y);
		ctx.rotate(Math.PI / 4);
		ctx.beginPath();
		ctx.moveTo(0, -r);
		ctx.lineTo(0, r);
		ctx.moveTo(-r, 0);
		ctx.lineTo(r, 0);
		ctx.restore();
	},
	drawCrosshair: function(ctx, s, x, y, r) {
		_drawShape(this.crosshair, s, ctx, x, y, r);
	},

	circle: function(ctx, x, y, r) {
		ctx.beginPath();
		ctx.arc(x, y, r, 0, PI2);
	},
	drawCircle: function(ctx, s, x, y, r) {
		_drawShape(this.circle, s, ctx, x, y, r);
	},

	square: function(ctx, x, y, r) {
		r = Math.floor(r / 2) * 2;
		ctx.beginPath();
		ctx.rect(x - r, y - r, r * 2, r * 2);
	},
	drawSquare: function(ctx, s, x, y, r) {
		_drawShape(this.square, s, ctx, x, y, r);
	},

	/* https://stackoverflow.com/questions/29588404/using-javascript-to-convert-radians-to-degrees-with-positive-and-negative-values
		(((r * (180/Math.PI)) % 360) + 360) % 360;
		function mod(n, m) {
  return ((n % m) + m) % m;
}
	*/

	arrowhead: function(ctx, x, y, r, t) {
		ctx.save();
		ctx.translate(x, y);
		ctx.rotate(_mod(t, PI2));
		ctx.translate(r * 0.5, 0);
		ctx.beginPath();
		ctx.moveTo(0, 0);
		// ctx.lineTo(-r, r * Math.SQRT1_2);
		// ctx.lineTo(-r, -r * Math.SQRT1_2);
		ctx.lineTo(-r * Math.SQRT2, r * Math.SQRT1_2);
		ctx.arcTo(0, 0, -r * Math.SQRT2, -r * Math.SQRT1_2, r);
		// ctx.quadraticCurveTo(0, 0, -r * Math.SQRT2, -r * Math.SQRT1_2);
		ctx.lineTo(0, 0);
		ctx.closePath();
		ctx.restore();
	},
	drawArrowhead: function(ctx, s, x, y, r, t) {
		_drawShape(this.arrowhead, s, ctx, x, y, r, t);
	},

	rect: function(ctx, a1, a2, a3, a4) {

		ctx.beginPath();
		if (isNaN(a1)) {
			ctx.rect(a1.left, a1.top, a1.width, a1.height);
		} else {
			ctx.rect(a1, a2, a3, a4);
		}
	},
	drawRect: function(ctx, s, a1, a2, a3, a4) {
		_drawShape(this.rect, s, ctx, a1, a2, a3, a4);
	},
};
},{}],107:[function(require,module,exports){
/**
 * @module utils/canvas/calcArcHConnector
 */

module.exports = function(x1, y1, r1, x2, y2, r2, ro) {
	var qx = x2 > x1 ? 1 : -1;
	var qy = y2 > y1 ? 1 : -1;
	var dy = Math.abs(y2 - y1);
	var dx = Math.abs(x2 - x1);
	var rr = r1 + r2;
	var tx1, tx2, c, tx, ty;

	if (dy < 1) {
		// points are aligned horizontally, no arcs needed
		tx1 = 0;
		tx2 = dx
		// return [x1, x2];
	}

	if (dy >= rr && dx >= rr) {
		// arcs fit horizontally:
		// second circle center is r1+r2, tangent intersect at x=r1
		c = rr;
		tx1 = r1;
		tx2 = r1;
	} else {
		// arcs overlap horizontally:
		// find second circle center
		c = Math.sqrt(dy * r2 * 2 + dy * r1 * 2 - dy * dy);

		// circles tangent point
		tx = (c * r1) / rr;
		ty = (dy * r1) / rr;

		if (r1 < ty || c > dx) {
			return;
		}

		// tangent perpendicular slope
		var slope = (rr - dy) / c;
		// tangent intersections
		tx1 = tx - (ty * slope);
		tx2 = (dy * slope) + tx1;

		/*
		// circle centers
		var ccx1, ccy1, ccx2, ccy2;
		ccx1 = 0;
		ccy1 = r1;
		ccx2 = c;
		ccy2 = dy - r2;
		// tangent perpendicular slope
		var slope = (ccy1 - ccy2) / (ccx2 - ccx1);
		var xSec = tx - (ty * slope);
		// tangent intersections
		tx1 = xSec;
		tx2 = (dy * slope) + xSec;
		*/
	}

	// offset arcTo's in x-axis
	if (ro > 0) {
		if (ro > 1) {
			ro = Math.min(dx - rr, ro);
		} else {
			ro *= dx - rr;
		}
		tx1 += ro;
		tx2 += ro;
	}

	return [tx1 * qx + x1, tx2 * qx + x1, tx1, tx2];
};

/*
var drawArcConnector = function(ctx, x1, y1, x2, y2, r) {
	var dx, dy, hx, hy, gx, gy;

	hx = 0;
	hy = 0;
	gx = (x1 + x2) / 2;
	gy = (y1 + y2) / 2;
	dx = Math.abs(x1 - gx);
	dy = Math.abs(y1 - gy);

	if (dx < r && dy < r) {
		r = Math.min(dx * Math.SQRT1_2, dy * Math.SQRT1_2);
	} else {
		if (dx < r) {
			hy = Math.acos(dx / r) * r * 0.5;
			if (y1 > y2) hy *= -1;
		}
		if (dy < r) {
			hx = Math.acos(dy / r) * r * 0.5;
			if (x1 > x2) hx *= -1;
		}
	}
	ctx.arcTo(gx - hx, y1, gx + hx, y2, r);
	ctx.arcTo(gx + hx, y2, x2, y2, r);
};

var drawArcConnector2 = function(ctx, x1, y1, x2, y2, r) {
	var dx, dy, hx, hy, cx1, cx2;

	hx = 0;
	hy = 0;
	dx = Math.abs(x2 - x1) / 2;
	dy = Math.abs(y1 - y2) / 2;

	if (dx < r && dy < r) {
		r = Math.min(dx * Math.SQRT1_2, dy * Math.SQRT1_2);
	} else {
		if (dx < r) {
			hy = Math.acos(dx / r) * r;
		}
		if (dy < r) {
			hx = Math.acos(dy / r) * r;
		}
	}
	cx1 = x1 + dx;
	cx2 = x2 - (dx - hx / 2);
	ctx.arcTo(cx1, y1, cx2, y2, r);
	ctx.arcTo(cx2, y2, x2, y2, r);
};

var drawArcConnector1 = function(ctx, x1, y1, x2, y2, r) {
	var dx, dy, cx;

	dx = Math.abs(x2 - x1) / 2;
	dy = Math.abs(y1 - y2) / 2;
	r = Math.min(r, dy * Math.SQRT1_2);
	if (x1 < x2) {
		cx = x1 + dx + r;
	} else {
		cx = x2 - dx - r;
	}
	// cx = (x2 + x1) / 2;
	// cx += x1 < x2 ? r : -r;

	ctx.arcTo(cx, y1, cx, y2, r);
	ctx.arcTo(cx, y2, x2, y2, r);
};
*/

},{}],108:[function(require,module,exports){
(function (DEBUG){
/* global HTMLElement, CSSStyleDeclaration */

// var parseSize = require("./parseSize");

var CSS_BOX_PROPS = [
	"boxSizing", "position", "objectFit"
];
var CSS_EDGE_PROPS = [
	"marginTop", "marginBottom", "marginLeft", "marginRight",
	"borderTopWidth", "borderBottomWidth", "borderLeftWidth", "borderRightWidth",
	"paddingTop", "paddingBottom", "paddingLeft", "paddingRight",
];
var CSS_POS_PROPS = ["top", "bottom", "left", "right"];
var CSS_SIZE_PROPS = ["width", "height", "minWidth", "minHeight", "maxWidth", "maxHeight"];
var CSS_ALL_PROPS = CSS_EDGE_PROPS.concat(CSS_SIZE_PROPS, CSS_POS_PROPS);

// var COMPUTED_PROPS = [
// 	"clientLeft", "clientTop", "clientWidth", "clientHeight",
// 	"offsetLeft", "offsetTop", "offsetWidth", "offsetHeight"
// ];
// var o = _.pick(element, function(val) {
// 	return /^(offset|client)(Left|Top|Width|Height)/.test(val);
// });

var cssDimensionRE = /^(-?[\d\.]+)(px|em|rem)$/;
// var cssDimRe = /^([-\.0-9]+)([rem]+)$/;

module.exports = function(s, m, includeSizePos) {
	if (s instanceof HTMLElement) {
		s = getComputedStyle(s);
	}
	if (DEBUG) {
		if (!(s instanceof CSSStyleDeclaration)) {
			throw new Error("Not a CSSStyleDeclaration nor HTMLElement");
		}
	}
	var v, p, i, ii, emPx, remPx;
	m || (m = {});

	emPx = m.fontSize = parseFloat(s.fontSize);

	for (i = 0, ii = CSS_BOX_PROPS.length; i < ii; i++) {
		p = CSS_BOX_PROPS[i];
		if (p in s) {
			m[p] = s[p];
		}
	}
	var cssProps = includeSizePos ? CSS_EDGE_PROPS : CSS_ALL_PROPS;
	for (i = 0, ii = cssProps.length; i < ii; i++) {
		p = cssProps[i];
		m["_" + p] = s[p];
		if (s[p] && (v = cssDimensionRE.exec(s[p]))) {
			if (v[2] === "px") {
				m[p] = parseFloat(v[1]);
			} else if (v[2] === "em") {
				m[p] = parseFloat(v[1]) * emPx;
			} else if (v[2] === "rem") {
				remPx || (remPx = parseFloat(getComputedStyle(document.documentElement).fontSize));
				m[p] = parseFloat(v[1]) * remPx;
			} else {
				console.warn("Ignoring value", p, v[1], v[2]);
				m[p] = null;
			}
		} // else {
		//	console.warn("Ignoring unitless value", p, v);
		//}
	}
	return m;
};

}).call(this,true)

},{}],109:[function(require,module,exports){
/**
 * @param {number} i current iteration
 * @param {number} s start value
 * @param {number} d change in value
 * @param {number} t total iterations
 * @return {number}
 */
var linear = function(i, s, d, t) {
	return d * i / t + s;
};

module.exports = linear;

},{}],110:[function(require,module,exports){
/* https://html.spec.whatwg.org/multipage/media.html#event-media-canplay
 */
module.exports = [
	// networkState
	"loadstart",
	"progress",
	"suspend",
	"abort",
	"error",
	"emptied",
	"stalled",
	// readyState
	"loadedmetadata",
	"loadeddata",
	"canplay",
	"canplaythrough",
	"playing",
	"waiting",
	//
	"seeking", // seeking changed to true
	"seeked", // seeking changed to false
	"ended", // ended is true
	//
	"durationchange", // duration updated
	"timeupdate", // currentTime updated
	"play", // paused is false
	"pause", // paused is false
	"paused", // ??
	"ratechange",
	//
	"resize",
	"volumechange",
];
},{}],111:[function(require,module,exports){
/**
 * @module app/view/component/GraphView
 */

// /** @type {module:underscore} */
// var _ = require("underscore");

module.exports = function(rect, dx, dy) {
	if (arguments.length == 2) {
		dy = dx;
	}
	var r = {
		width: rect.width + dx * 2,
		height: rect.height + dy * 2
	};
	if (r.width >= 0) {
		r.left = rect.left - dx;
		r.right = r.left + r.width;
		r.x = r.left;
	} else {
		r.right = rect.right + dx;
		r.left = rect.right - r.width;
		r.y = r.right;
	}
	if (r.height >= 0) {
		r.top = rect.top - dy;
		r.bottom = r.top + r.height;
		r.y = r.top;
	} else {
		r.bottom = rect.bottom + dy;
		r.top = rect.bottom - r.height;
		r.y = r.bottom;
	}

	return r;
};
},{}],112:[function(require,module,exports){
/** @type {Array} lowercase prefixes */
var lcPrefixes = [""].concat(require("./prefixes"));

/** @type {Array} capitalized prefixes */
var ucPrefixes = lcPrefixes.map(function(s) {
	return (s === "") ? s : s.charAt(0).toUpperCase() + s.substr(1);
});

/** @type {Object} specific event solvers */
var _solvers = {};

/** @type {Object} cached values */
var _cache = {};

/**
 * @param {String} name Unprefixed event name
 * @param {?Object} obj Prefix test target
 * @param {?String} testProp Proxy property to test prefixes
 * @return {String|null}
 */
var _prefixedEvent = function(name, obj, testProp) {
	var prefixes = /^[A-Z]/.test(name) ? ucPrefixes : lcPrefixes;
	obj || (obj = document);
	for (var i = 0; i < prefixes.length; i++) {
		if (testProp) {
			if ((prefixes[i] + testProp) in obj) {
				return prefixes[i] + name;
			}
		}
		if (("on" + prefixes[i] + name) in obj) {
			return prefixes[i] + name;
		}
	}
	return null;
};

// transitionend
_solvers["transitionend"] = function() {
	var prop, style = document.body.style,
		map = {
			"transition": "transitionend",
			"WebkitTransition": "webkitTransitionEnd",
			"MozTransition": "transitionend",
			// "msTransition" : "MSTransitionEnd",
			"OTransition": "oTransitionEnd"
		};
	for (prop in map) {
		if (prop in style) {
			return map[prop];
		}
	}
	return null;
};

/**
 * get the prefixed property
 * @param {String} property name
 * @param {Object} look-up object
 * @returns {String|null} prefixed
 */
module.exports = function(evName) {
	if (!_cache.hasOwnProperty(evName)) {
		_cache[evName] = _solvers.hasOwnProperty(evName) ? _solvers[evName]() : _prefixedEvent.apply(null, arguments);
		if (_cache[evName] === null) {
			console.warn("Event '%s' not found", evName);
		} else {
			console.log("Event '%s' found as '%s'", evName, _cache[evName]);
		}
	}
	return _cache[evName];
	// return _cache[evName] || (_cache[evName] = _solvers[evName]? _solvers[evName].call() : _prefixedProperty.apply(null, arguments));
};

/*
var defaultTest = function(name, obj) {
	var prefixes = /^[A-Z]/.test(name)? ucPrefixes : lcPrefixes;
	for (var i = 0; i < prefixes.length; i++) {
		if (("on" + prefixes[i] + name) in obj) {
			console.log("Event '%s' found as '%s'", name, prefixes[i] + name);
			return prefixes[i] + name;
		}
	}
	return null;
};

var proxyTest = function(name, obj, testProp) {
	var prefixes = /^[A-Z]/.test(name)? ucPrefixes : lcPrefixes;
	for (var i = 0; i < prefixes.length; i++) {
		if ((prefixes[i] + testProp) in obj) {
			console.log("Event %s inferred as '%s' from property '%s'", name, prefixes[i] + name, testProp);
			return prefixes[i] + name;
		}
	}
	return null;
};
*/

},{"./prefixes":115}],113:[function(require,module,exports){
/**
/* @module utils/prefixedProperty
/*/

/** @type {module:utils/prefixes} */
var prefixes = require("./prefixes");
/** @type {Number} prefix count */
var _prefixNum = prefixes.length;
/** @type {Array} cached values */
var _cache = {};

var _prefixedProperty = function(prop, obj) {
	var prefixedProp, camelProp;

	if (prop in obj) {
		console.log("Property '%s' found unprefixed", prop);
		return prop;
	}
	camelProp = prop[0].toUpperCase() + prop.slice(1);
	for (var i = 0; i < _prefixNum; i++) {
		prefixedProp = prefixes[i] + camelProp;
		if (prefixedProp in obj) {
			console.log("Property '%s' found as '%s'", prop, prefixedProp);
			return prefixedProp;
		}
	}
	console.error("Property '%s' not found", prop);
	return null;
};

/**
 * get the prefixed property
 * @param {String} property name
 * @param {Object} look-up object
 * @returns {String|null} prefixed
 */
module.exports = function(prop, obj) {
	return _cache[prop] || (_cache[prop] = _prefixedProperty(prop, obj || document.body.style));
};

},{"./prefixes":115}],114:[function(require,module,exports){
/**
/* @module utils/prefixedStyleName
/*/

/** @type {module:utils/prefixes} */
var prefixes = require("./prefixes"); //.map(function(prefix) { return "-" + prefix + "-"; });
/** @type {Number} prefix count */
var _prefixNum = prefixes.length;
/** @type {Array} cached values */
var _cache = {};

var _prefixedStyleName = function(style, styleObj) {
	var prefixedStyle;

	if (style in styleObj) {
		console.log("CSS style '%s' found unprefixed", style);
		return style;
	}
	for (var i = 0; i < _prefixNum; i++) {
		prefixedStyle = "-" + prefixes[i] + "-" + style;
		// prefixedStyle = prefixes[i] + style;
		if (prefixedStyle in styleObj) {
			console.log("CSS style '%s' found as '%s'", style, prefixedStyle);
			return prefixedStyle;
		}
	}
	console.warn("CSS style '%s' not found", style);
	return null;
};

/**
 * get the prefixed style name
 * @param {String} style name
 * @param {Object} look-up style object
 * @returns {String|Undefined} prefixed
 */
module.exports = function(style, styleObj) {
	// return _cache[style] || (_cache[style] = _prefixedStyleName_reverse(style, styleObj || document.body.style));
	return _cache[style] || (_cache[style] = _prefixedStyleName(style, styleObj || document.body.style));
};

// /** @type {module:utils/strings/camelToDashed} */
// var camelToDashed = require("./strings/camelToDashed");
// /** @type {module:utils/prefixedProperty} */
// var prefixedProperty = require("./prefixedProperty");
// /** @type {module:utils/strings/dashedToCamel} */
// var dashedToCamel = require("./strings/dashedToCamel");
//
// var _prefixedStyleName_reverse = function (style, styleObj) {
// 	var camelProp, prefixedProp;
// 	camelProp = dashedToCamel(style);
// 	prefixedProp = prefixedProperty(camelProp, styleObj);
// 	return prefixedProp? (camelProp === prefixedProp? "" : "-") + camelToDashed(prefixedProp) : null;
// };

},{"./prefixes":115}],115:[function(require,module,exports){
module.exports = ["webkit", "moz", "ms", "o"];

},{}],116:[function(require,module,exports){
module.exports = function(pp, reason) {
	if (pp.length > 0) {
		pp.forEach(function(p, i, a) {
			p.reject(reason);
			a[i] = null;
		});
		pp.length = 0;
	}
	return pp;
};
},{}],117:[function(require,module,exports){
module.exports = function(pp, result) {
	if (pp.length != 0) {
		pp.forEach(function(p, i, a) {
			p.resolve(result);
			a[i] = null;
		});
		pp.length = 0;
	}
	return pp;
};
},{}],118:[function(require,module,exports){
module.exports = function(str) {
	return str.replace(/[A-Z]/g, function($0) {
		return "-" + $0.toLowerCase();
	});
};

},{}],119:[function(require,module,exports){
module.exports = function(s) {
	return s.replace(/<[^>]+>/g, "");
};

},{}],120:[function(require,module,exports){
/** @type {module:hammerjs} */
var Hammer = require("hammerjs");

// /**
//  * get a usable string, used as event postfix
//  * @param {Const} state
//  * @returns {String} state
//  */
// function stateStr(state) {
// 	if (state & Hammer.STATE_CANCELLED) {
// 		return "cancel";
// 	} else if (state & Hammer.STATE_ENDED) {
// 		return "end";
// 	} else if (state & Hammer.STATE_CHANGED) {
// 		return "move";
// 	} else if (state & Hammer.STATE_BEGAN) {
// 		return "start";
// 	}
// 	return "";
// }

/**
 * direction cons to string
 * @param {Const} direction
 * @returns {String}
 */
function dirStr(direction) {
	if (direction == Hammer.DIRECTION_DOWN) {
		return "down";
	} else if (direction == Hammer.DIRECTION_UP) {
		return "up";
	} else if (direction == Hammer.DIRECTION_LEFT) {
		return "left";
	} else if (direction == Hammer.DIRECTION_RIGHT) {
		return "right";
	}
	return "";
}

///**
// * Pan
// * Recognized when the pointer is down and moved in the allowed direction.
// * @constructor
// * @extends AttrRecognizer
// */
//function PanRecognizer() {
//	Hammer.AttrRecognizer.apply(this, arguments);
//
//	this.pX = null;
//	this.pY = null;
//}
//
//inherit(PanRecognizer, Hammer.AttrRecognizer, {
//	/**
//	/* @namespace
//	/* @memberof PanRecognizer
//	/*/
//	defaults: {
//		event: "pan",
//		threshold: 10,
//		pointers: 1,
//		direction: DIRECTION_ALL
//	},
//
//	getTouchAction: function() {
//		var direction = this.options.direction;
//		var actions = [];
//		if (direction & DIRECTION_HORIZONTAL) {
//			actions.push(TOUCH_ACTION_PAN_Y);
//		}
//		if (direction & DIRECTION_VERTICAL) {
//			actions.push(TOUCH_ACTION_PAN_X);
//		}
//		return actions;
//	},
//
//	directionTest: function(input) {
//		var options = this.options;
//		var hasMoved = true;
//		var distance = input.distance;
//		var direction = input.direction;
//		var x = input.deltaX;
//		var y = input.deltaY;
//
//		// lock to axis?
//		if (!(direction & options.direction)) {
//			if (options.direction & DIRECTION_HORIZONTAL) {
//				direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;
//				hasMoved = x != this.pX;
//				distance = Math.abs(input.deltaX);
//			} else {
//				direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;
//				hasMoved = y != this.pY;
//				distance = Math.abs(input.deltaY);
//			}
//		}
//		input.direction = direction;
//		return hasMoved && distance > options.threshold && direction & options.direction;
//	},
//
//	attrTest: function(input) {
//		return AttrRecognizer.prototype.attrTest.call(this, input) &&
//			(this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));
//	},
//
//	emit: function(input) {
//		this.pX = input.deltaX;
//		this.pY = input.deltaY;
//
//		var direction = dirStr(input.direction);
//		if (direction) {
//			this.manager.emit(this.options.event + direction, input);
//		}
//
//		this._super.emit.call(this, input);
//	}
//});

/**
 * SmoothPan
 * @constructor
 * @extends Hammer.Pan
 */
function SmoothPan() {
	var ret = Hammer.Pan.apply(this, arguments);
	this.thresholdOffsetX = null;
	this.thresholdOffsetY = null;
	this.thresholdOffset = null;
	return ret;
}

Hammer.inherit(SmoothPan, Hammer.Pan, {
	emit: function(input) {
		// Inheritance breaks, so this code is taken from PanRecognizer.emit
		//	this._super.emit.call(this, input); // Triggers infinite recursion
		//	Hammer.Pan.prototype.emit.apply(this, arguments); // This breaks too

		var threshold = this.options.threshold;
		var direction = input.direction;

		if (this.state == Hammer.STATE_BEGAN) {
			this.thresholdOffsetX = (direction & Hammer.DIRECTION_HORIZONTAL) ? ((direction & Hammer.DIRECTION_LEFT) ? threshold : -threshold) : 0;
			this.thresholdOffsetY = (direction & Hammer.DIRECTION_VERTICAL) ? ((direction & Hammer.DIRECTION_UP) ? threshold : -threshold) : 0;
			// this.thresholdOffset = (direction & Hammer.DIRECTION_HORIZONTAL)? input.thresholdOffsetX : input.thresholdOffsetY;
			// console.log("RECOGNIZER STATE", dirStr(direction), stateStr(this.state), this.thresholdOffsetX);
		}
		input.thresholdOffsetX = this.thresholdOffsetX;
		input.thresholdOffsetY = this.thresholdOffsetY;
		input.thresholdDeltaX = input.deltaX + this.thresholdOffsetX;
		input.thresholdDeltaY = input.deltaY + this.thresholdOffsetY;

		this.pX = input.deltaX;
		this.pY = input.deltaY;

		direction = dirStr(direction);
		if (direction) {
			this.manager.emit(this.options.event + direction, input);
		}
		return Hammer.Recognizer.prototype.emit.apply(this, arguments);
	}
});

module.exports = SmoothPan;

},{"hammerjs":"hammerjs"}],121:[function(require,module,exports){
module.exports={
	"transitions": {
		"ease": "ease",
		"duration_ms": "400",
		"delay_interval_ms": "100",
		"min_delay_ms": "50"
	},
	"breakpoints": {
		"landscape": "'(orientation: landscape)'",
		"portrait": "'(orientation: portrait)'",
		"fullwidth-small": "'not screen and (min-width: 460px)'",
		"fullwidth": "'not screen and (min-width: 704px), not screen and (min-height: 540px)'",
		"default":"'only screen and (min-width: 704px) and (min-height: 540px)'",
		"desktop-small": "'only screen and (min-width: 1024px) and (min-height: 540px)'",
		"desktop-medium": "'only screen and (min-width: 1224px) and (min-height: 704px)'",
		"desktop-large": "'only screen and (min-width: 1824px) and (min-height: 1024px)'"
	},
	"default_colors": {
		"color": "hsl(47, 5%, 15%)",
		"background-color": "hsl(47, 5%, 95%)",
		"link-color": "hsl(10, 80%, 50%)"
	},
	"temp": {
		"collapse_offset": "360"
	},
	"_ignore": {
		"transitions": {
			"ease": "ease",
			"duration_ms": "400",
			"delay_interval_ms": "134",
			"min_delay_ms": "34"
		},
		"default_colors": {
			"--link-color": "hsl(10, 80%, 50%)",
			"--alt-background-color": "unset"
		},
		"units": {
			"hu_px": "20",
			"vu_px": "12"
		},
		"breakpoints": {
			"mobile": "'not screen and (min-width: 704px), not screen and (min-height: 540px)'",
			"unsupported": "'not screen and (min-width: 704px)'",
			"unquoted": "only screen and (min-width: 1824px)",
			"unquoted_neg": "not screen and (min-width: 704px)",
			"quoted_combined": "'not screen and (min-width: 704px), not screen and (min-height: 540px)'",
			"array": [
				"only screen and (min-width: 704px)",
				"not screen and (min-width: 704px)",
				"not screen and (min-height: 540px)"
			]
		}
	}
}

},{}]},{},[32])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy5ydW50aW1lLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvYmFzZS5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2RlY29yYXRvcnMuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9kZWNvcmF0b3JzL2lubGluZS5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2V4Y2VwdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2hlbHBlcnMuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9oZWxwZXJzL2Jsb2NrLWhlbHBlci1taXNzaW5nLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvaGVscGVycy9lYWNoLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvaGVscGVycy9oZWxwZXItbWlzc2luZy5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2hlbHBlcnMvaWYuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9oZWxwZXJzL2xvZy5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2hlbHBlcnMvbG9va3VwLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvaGVscGVycy93aXRoLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvbG9nZ2VyLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvZGlzdC9janMvaGFuZGxlYmFycy9ub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9uby1jb25mbGljdC5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL3J1bnRpbWUuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9zYWZlLXN0cmluZy5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL3V0aWxzLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvcnVudGltZS5qcyIsIm5vZGVfbW9kdWxlcy9oYnNmeS9ydW50aW1lLmpzIiwibm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsIm5vZGVfbW9kdWxlcy9zZXRpbW1lZGlhdGUvc2V0SW1tZWRpYXRlLmpzIiwibm9kZV9tb2R1bGVzL3VuZGVyc2NvcmUuc3RyaW5nL2Rhc2hlcml6ZS5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy9oZWxwZXIvZGVmYXVsdFRvV2hpdGVTcGFjZS5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy9oZWxwZXIvZXNjYXBlUmVnRXhwLmpzIiwibm9kZV9tb2R1bGVzL3VuZGVyc2NvcmUuc3RyaW5nL2hlbHBlci9tYWtlU3RyaW5nLmpzIiwibm9kZV9tb2R1bGVzL3VuZGVyc2NvcmUuc3RyaW5nL2hlbHBlci9zdHJSZXBlYXQuanMiLCJub2RlX21vZHVsZXMvdW5kZXJzY29yZS5zdHJpbmcvbHBhZC5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy9wYWQuanMiLCJub2RlX21vZHVsZXMvdW5kZXJzY29yZS5zdHJpbmcvcnBhZC5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy90cmltLmpzIiwic3JjL2pzL2FwcC9BcHAuanMiLCJzcmMvanMvYXBwL2NvbnRyb2wvQ29udHJvbGxlci5qcyIsInNyYy9qcy9hcHAvY29udHJvbC9HbG9iYWxzLmpzIiwic3JjL2pzL2FwcC9kZWJ1Zy9EZWJ1Z1Rvb2xiYXIuanMiLCJzcmMvanMvYXBwL2RlYnVnL3RlbXBsYXRlL0RlYnVnVG9vbGJhci5TVkdHcmlkLmhicyIsInNyYy9qcy9hcHAvZGVidWcvdGVtcGxhdGUvRGVidWdUb29sYmFyLmhicyIsInNyYy9qcy9hcHAvbW9kZWwvQXBwU3RhdGUuanMiLCJzcmMvanMvYXBwL21vZGVsL0Jhc2VJdGVtLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvbi5qcyIsInNyYy9qcy9hcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvbi5qcyIsInNyYy9qcy9hcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9uLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9uLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9oZWxwZXIvYm9vdHN0cmFwLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9pdGVtL0FydGljbGVJdGVtLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9pdGVtL0J1bmRsZUl0ZW0uanMiLCJzcmMvanMvYXBwL21vZGVsL2l0ZW0vS2V5d29yZEl0ZW0uanMiLCJzcmMvanMvYXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9pdGVtL1NvdXJjZUl0ZW0uanMiLCJzcmMvanMvYXBwL21vZGVsL2l0ZW0vVHlwZUl0ZW0uanMiLCJzcmMvanMvYXBwL3ZpZXcvQXBwVmlldy5qcyIsInNyYy9qcy9hcHAvdmlldy9Db250ZW50Vmlldy5qcyIsInNyYy9qcy9hcHAvdmlldy9OYXZpZ2F0aW9uVmlldy5qcyIsInNyYy9qcy9hcHAvdmlldy9iYXNlL0NhbGxiYWNrUXVldWUuanMiLCJzcmMvanMvYXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L2Jhc2UvSW50ZXJwb2xhdG9yLmpzIiwic3JjL2pzL2FwcC92aWV3L2Jhc2UvUHJlZml4ZWRFdmVudHMuanMiLCJzcmMvanMvYXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvYmFzZS9WaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L2Jhc2UvVmlld0Vycm9yLmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9BcnRpY2xlQnV0dG9uLmhicyIsInNyYy9qcy9hcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZUJ1dHRvbi5qcyIsInNyYy9qcy9hcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZVZpZXcuanMiLCJzcmMvanMvYXBwL3ZpZXcvY29tcG9uZW50L0Nhcm91c2VsLmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uU3RhY2suaGJzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uU3RhY2suanMiLCJzcmMvanMvYXBwL3ZpZXcvY29tcG9uZW50L0ZpbHRlcmFibGVMaXN0Vmlldy5qcyIsInNyYy9qcy9hcHAvdmlldy9jb21wb25lbnQvR3JhcGhWaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Hcm91cGluZ0xpc3RWaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyLmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9TZWxlY3RhYmxlTGlzdFZpZXcuanMiLCJzcmMvanMvYXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL0NhbnZhc1Byb2dyZXNzTWV0ZXIzLmpzIiwic3JjL2pzL2FwcC92aWV3L2hlbHBlci9jcmVhdGVDb2xvclN0eWxlU2hlZXQuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS9fbG9hZEltYWdlQXNPYmplY3RVUkwuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS9fd2hlbkltYWdlTG9hZHMuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS93aGVuRGVmYXVsdEltYWdlTG9hZHMuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS93aGVuU2Nyb2xsaW5nRW5kcy5qcyIsInNyYy9qcy9hcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3Rpb25EaXN0YW5jZUlzLmpzIiwic3JjL2pzL2FwcC92aWV3L3Byb21pc2Uvd2hlblNlbGVjdGlvbklzQ29udGlndW91cy5qcyIsInNyYy9qcy9hcHAvdmlldy9wcm9taXNlL3doZW5WaWV3SXNBdHRhY2hlZC5qcyIsInNyYy9qcy9hcHAvdmlldy9wcm9taXNlL3doZW5WaWV3SXNSZW5kZXJlZC5qcyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvQ2Fyb3VzZWxSZW5kZXJlci5qcyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvcmVuZGVyL0RlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXIuaGJzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9EZWZhdWx0U2VsZWN0YWJsZVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9Eb3ROYXZpZ2F0aW9uUmVuZGVyZXIuaGJzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9Eb3ROYXZpZ2F0aW9uUmVuZGVyZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvcmVuZGVyL0ltYWdlUmVuZGVyZXIuaGJzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9JbWFnZVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9MYWJlbFJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9NZWRpYVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9QbGF5YWJsZVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9TZXF1ZW5jZVJlbmRlcmVyLmhicyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlci5qcyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvVmlkZW9SZW5kZXJlci5oYnMiLCJzcmMvanMvYXBwL3ZpZXcvcmVuZGVyL1ZpZGVvUmVuZGVyZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvdGVtcGxhdGUvQ2Fyb3VzZWwuRW1wdHlSZW5kZXJlci5CdW5kbGUuaGJzIiwic3JjL2pzL2FwcC92aWV3L3RlbXBsYXRlL0NvbGxlY3Rpb25TdGFjay5NZWRpYS5oYnMiLCJzcmMvanMvYXBwL3ZpZXcvdGVtcGxhdGUvRXJyb3JCbG9jay5oYnMiLCJzcmMvanMvYXBwL3ZpZXcvdGVtcGxhdGUvX2hlbHBlcnMuanMiLCJzcmMvanMvdXRpbHMvVGltZXIuanMiLCJzcmMvanMvdXRpbHMvVHJhbnNmb3JtSGVscGVyLmpzIiwic3JjL2pzL3V0aWxzL1RyYW5zZm9ybUl0ZW0uanMiLCJzcmMvanMvdXRpbHMvYXJyYXkvZGlmZmVyZW5jZS5qcyIsInNyYy9qcy91dGlscy9jYW52YXMvQ2FudmFzSGVscGVyLmpzIiwic3JjL2pzL3V0aWxzL2NhbnZhcy9jYWxjQXJjSENvbm5lY3Rvci5qcyIsInNyYy9qcy91dGlscy9jc3MvZ2V0Qm94RWRnZVN0eWxlcy5qcyIsInNyYy9qcy91dGlscy9lYXNlL2xpbmVhci5qcyIsInNyYy9qcy91dGlscy9ldmVudC9tZWRpYUV2ZW50c0VudW0uanMiLCJzcmMvanMvdXRpbHMvZ2VvbS9pbmZsYXRlUmVjdC5qcyIsInNyYy9qcy91dGlscy9wcmVmaXhlZEV2ZW50LmpzIiwic3JjL2pzL3V0aWxzL3ByZWZpeGVkUHJvcGVydHkuanMiLCJzcmMvanMvdXRpbHMvcHJlZml4ZWRTdHlsZU5hbWUuanMiLCJzcmMvanMvdXRpbHMvcHJlZml4ZXMuanMiLCJzcmMvanMvdXRpbHMvcHJvbWlzZS9yZWplY3RBbGwuanMiLCJzcmMvanMvdXRpbHMvcHJvbWlzZS9yZXNvbHZlQWxsLmpzIiwic3JjL2pzL3V0aWxzL3N0cmluZ3MvY2FtZWxUb0Rhc2hlZC5qcyIsInNyYy9qcy91dGlscy9zdHJpbmdzL3N0cmlwVGFncy5qcyIsInNyYy9qcy91dGlscy90b3VjaC9TbW9vdGhQYW5SZWNvZ25pemVyLmpzIiwic3JjL3Nhc3MvdmFyaWFibGVzLmpzb24iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs4QkNBc0IsbUJBQW1COztJQUE3QixJQUFJOzs7OztvQ0FJTywwQkFBMEI7Ozs7bUNBQzNCLHdCQUF3Qjs7OzsrQkFDdkIsb0JBQW9COztJQUEvQixLQUFLOztpQ0FDUSxzQkFBc0I7O0lBQW5DLE9BQU87O29DQUVJLDBCQUEwQjs7Ozs7QUFHakQsU0FBUyxNQUFNLEdBQUc7QUFDaEIsTUFBSSxFQUFFLEdBQUcsSUFBSSxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQzs7QUFFMUMsT0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDdkIsSUFBRSxDQUFDLFVBQVUsb0NBQWEsQ0FBQztBQUMzQixJQUFFLENBQUMsU0FBUyxtQ0FBWSxDQUFDO0FBQ3pCLElBQUUsQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO0FBQ2pCLElBQUUsQ0FBQyxnQkFBZ0IsR0FBRyxLQUFLLENBQUMsZ0JBQWdCLENBQUM7O0FBRTdDLElBQUUsQ0FBQyxFQUFFLEdBQUcsT0FBTyxDQUFDO0FBQ2hCLElBQUUsQ0FBQyxRQUFRLEdBQUcsVUFBUyxJQUFJLEVBQUU7QUFDM0IsV0FBTyxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQztHQUNuQyxDQUFDOztBQUVGLFNBQU8sRUFBRSxDQUFDO0NBQ1g7O0FBRUQsSUFBSSxJQUFJLEdBQUcsTUFBTSxFQUFFLENBQUM7QUFDcEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7O0FBRXJCLGtDQUFXLElBQUksQ0FBQyxDQUFDOztBQUVqQixJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsSUFBSSxDQUFDOztxQkFFUixJQUFJOzs7Ozs7Ozs7Ozs7O3FCQ3BDeUIsU0FBUzs7eUJBQy9CLGFBQWE7Ozs7dUJBQ0UsV0FBVzs7MEJBQ1IsY0FBYzs7c0JBQ25DLFVBQVU7Ozs7QUFFdEIsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDOztBQUN4QixJQUFNLGlCQUFpQixHQUFHLENBQUMsQ0FBQzs7O0FBRTVCLElBQU0sZ0JBQWdCLEdBQUc7QUFDOUIsR0FBQyxFQUFFLGFBQWE7QUFDaEIsR0FBQyxFQUFFLGVBQWU7QUFDbEIsR0FBQyxFQUFFLGVBQWU7QUFDbEIsR0FBQyxFQUFFLFVBQVU7QUFDYixHQUFDLEVBQUUsa0JBQWtCO0FBQ3JCLEdBQUMsRUFBRSxpQkFBaUI7QUFDcEIsR0FBQyxFQUFFLFVBQVU7Q0FDZCxDQUFDOzs7QUFFRixJQUFNLFVBQVUsR0FBRyxpQkFBaUIsQ0FBQzs7QUFFOUIsU0FBUyxxQkFBcUIsQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRTtBQUNuRSxNQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sSUFBSSxFQUFFLENBQUM7QUFDN0IsTUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLElBQUksRUFBRSxDQUFDO0FBQy9CLE1BQUksQ0FBQyxVQUFVLEdBQUcsVUFBVSxJQUFJLEVBQUUsQ0FBQzs7QUFFbkMsa0NBQXVCLElBQUksQ0FBQyxDQUFDO0FBQzdCLHdDQUEwQixJQUFJLENBQUMsQ0FBQztDQUNqQzs7QUFFRCxxQkFBcUIsQ0FBQyxTQUFTLEdBQUc7QUFDaEMsYUFBVyxFQUFFLHFCQUFxQjs7QUFFbEMsUUFBTSxxQkFBUTtBQUNkLEtBQUcsRUFBRSxvQkFBTyxHQUFHOztBQUVmLGdCQUFjLEVBQUUsd0JBQVMsSUFBSSxFQUFFLEVBQUUsRUFBRTtBQUNqQyxRQUFJLGdCQUFTLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxVQUFVLEVBQUU7QUFDdEMsVUFBSSxFQUFFLEVBQUU7QUFBRSxjQUFNLDJCQUFjLHlDQUF5QyxDQUFDLENBQUM7T0FBRTtBQUMzRSxvQkFBTyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQzVCLE1BQU07QUFDTCxVQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztLQUN6QjtHQUNGO0FBQ0Qsa0JBQWdCLEVBQUUsMEJBQVMsSUFBSSxFQUFFO0FBQy9CLFdBQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztHQUMzQjs7QUFFRCxpQkFBZSxFQUFFLHlCQUFTLElBQUksRUFBRSxPQUFPLEVBQUU7QUFDdkMsUUFBSSxnQkFBUyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssVUFBVSxFQUFFO0FBQ3RDLG9CQUFPLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7S0FDN0IsTUFBTTtBQUNMLFVBQUksT0FBTyxPQUFPLEtBQUssV0FBVyxFQUFFO0FBQ2xDLGNBQU0seUVBQTBELElBQUksb0JBQWlCLENBQUM7T0FDdkY7QUFDRCxVQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLE9BQU8sQ0FBQztLQUMvQjtHQUNGO0FBQ0QsbUJBQWlCLEVBQUUsMkJBQVMsSUFBSSxFQUFFO0FBQ2hDLFdBQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztHQUM1Qjs7QUFFRCxtQkFBaUIsRUFBRSwyQkFBUyxJQUFJLEVBQUUsRUFBRSxFQUFFO0FBQ3BDLFFBQUksZ0JBQVMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLFVBQVUsRUFBRTtBQUN0QyxVQUFJLEVBQUUsRUFBRTtBQUFFLGNBQU0sMkJBQWMsNENBQTRDLENBQUMsQ0FBQztPQUFFO0FBQzlFLG9CQUFPLElBQUksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUM7S0FDL0IsTUFBTTtBQUNMLFVBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO0tBQzVCO0dBQ0Y7QUFDRCxxQkFBbUIsRUFBRSw2QkFBUyxJQUFJLEVBQUU7QUFDbEMsV0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0dBQzlCO0NBQ0YsQ0FBQzs7QUFFSyxJQUFJLEdBQUcsR0FBRyxvQkFBTyxHQUFHLENBQUM7OztRQUVwQixXQUFXO1FBQUUsTUFBTTs7Ozs7Ozs7Ozs7O2dDQzdFQSxxQkFBcUI7Ozs7QUFFekMsU0FBUyx5QkFBeUIsQ0FBQyxRQUFRLEVBQUU7QUFDbEQsZ0NBQWUsUUFBUSxDQUFDLENBQUM7Q0FDMUI7Ozs7Ozs7O3FCQ0pvQixVQUFVOztxQkFFaEIsVUFBUyxRQUFRLEVBQUU7QUFDaEMsVUFBUSxDQUFDLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxVQUFTLEVBQUUsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRTtBQUMzRSxRQUFJLEdBQUcsR0FBRyxFQUFFLENBQUM7QUFDYixRQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRTtBQUNuQixXQUFLLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztBQUNwQixTQUFHLEdBQUcsVUFBUyxPQUFPLEVBQUUsT0FBTyxFQUFFOztBQUUvQixZQUFJLFFBQVEsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDO0FBQ2xDLGlCQUFTLENBQUMsUUFBUSxHQUFHLGNBQU8sRUFBRSxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDMUQsWUFBSSxHQUFHLEdBQUcsRUFBRSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztBQUMvQixpQkFBUyxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7QUFDOUIsZUFBTyxHQUFHLENBQUM7T0FDWixDQUFDO0tBQ0g7O0FBRUQsU0FBSyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQzs7QUFFN0MsV0FBTyxHQUFHLENBQUM7R0FDWixDQUFDLENBQUM7Q0FDSjs7Ozs7Ozs7OztBQ3BCRCxJQUFNLFVBQVUsR0FBRyxDQUFDLGFBQWEsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDOztBQUVuRyxTQUFTLFNBQVMsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFO0FBQ2hDLE1BQUksR0FBRyxHQUFHLElBQUksSUFBSSxJQUFJLENBQUMsR0FBRztNQUN0QixJQUFJLFlBQUE7TUFDSixNQUFNLFlBQUEsQ0FBQztBQUNYLE1BQUksR0FBRyxFQUFFO0FBQ1AsUUFBSSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO0FBQ3RCLFVBQU0sR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQzs7QUFFMUIsV0FBTyxJQUFJLEtBQUssR0FBRyxJQUFJLEdBQUcsR0FBRyxHQUFHLE1BQU0sQ0FBQztHQUN4Qzs7QUFFRCxNQUFJLEdBQUcsR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDOzs7QUFHMUQsT0FBSyxJQUFJLEdBQUcsR0FBRyxDQUFDLEVBQUUsR0FBRyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLEVBQUU7QUFDaEQsUUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztHQUM5Qzs7O0FBR0QsTUFBSSxLQUFLLENBQUMsaUJBQWlCLEVBQUU7QUFDM0IsU0FBSyxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztHQUMxQzs7QUFFRCxNQUFJLEdBQUcsRUFBRTtBQUNQLFFBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO0FBQ3ZCLFFBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0dBQ3RCO0NBQ0Y7O0FBRUQsU0FBUyxDQUFDLFNBQVMsR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDOztxQkFFbkIsU0FBUzs7Ozs7Ozs7Ozs7Ozt5Q0NsQ2UsZ0NBQWdDOzs7OzJCQUM5QyxnQkFBZ0I7Ozs7b0NBQ1AsMEJBQTBCOzs7O3lCQUNyQyxjQUFjOzs7OzBCQUNiLGVBQWU7Ozs7NkJBQ1osa0JBQWtCOzs7OzJCQUNwQixnQkFBZ0I7Ozs7QUFFbEMsU0FBUyxzQkFBc0IsQ0FBQyxRQUFRLEVBQUU7QUFDL0MseUNBQTJCLFFBQVEsQ0FBQyxDQUFDO0FBQ3JDLDJCQUFhLFFBQVEsQ0FBQyxDQUFDO0FBQ3ZCLG9DQUFzQixRQUFRLENBQUMsQ0FBQztBQUNoQyx5QkFBVyxRQUFRLENBQUMsQ0FBQztBQUNyQiwwQkFBWSxRQUFRLENBQUMsQ0FBQztBQUN0Qiw2QkFBZSxRQUFRLENBQUMsQ0FBQztBQUN6QiwyQkFBYSxRQUFRLENBQUMsQ0FBQztDQUN4Qjs7Ozs7Ozs7cUJDaEJxRCxVQUFVOztxQkFFakQsVUFBUyxRQUFRLEVBQUU7QUFDaEMsVUFBUSxDQUFDLGNBQWMsQ0FBQyxvQkFBb0IsRUFBRSxVQUFTLE9BQU8sRUFBRSxPQUFPLEVBQUU7QUFDdkUsUUFBSSxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU87UUFDekIsRUFBRSxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUM7O0FBRXBCLFFBQUksT0FBTyxLQUFLLElBQUksRUFBRTtBQUNwQixhQUFPLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUNqQixNQUFNLElBQUksT0FBTyxLQUFLLEtBQUssSUFBSSxPQUFPLElBQUksSUFBSSxFQUFFO0FBQy9DLGFBQU8sT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ3RCLE1BQU0sSUFBSSxlQUFRLE9BQU8sQ0FBQyxFQUFFO0FBQzNCLFVBQUksT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7QUFDdEIsWUFBSSxPQUFPLENBQUMsR0FBRyxFQUFFO0FBQ2YsaUJBQU8sQ0FBQyxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDOUI7O0FBRUQsZUFBTyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7T0FDaEQsTUFBTTtBQUNMLGVBQU8sT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO09BQ3RCO0tBQ0YsTUFBTTtBQUNMLFVBQUksT0FBTyxDQUFDLElBQUksSUFBSSxPQUFPLENBQUMsR0FBRyxFQUFFO0FBQy9CLFlBQUksSUFBSSxHQUFHLG1CQUFZLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNyQyxZQUFJLENBQUMsV0FBVyxHQUFHLHlCQUFrQixPQUFPLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDN0UsZUFBTyxHQUFHLEVBQUMsSUFBSSxFQUFFLElBQUksRUFBQyxDQUFDO09BQ3hCOztBQUVELGFBQU8sRUFBRSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztLQUM3QjtHQUNGLENBQUMsQ0FBQztDQUNKOzs7Ozs7Ozs7Ozs7O3FCQy9COEUsVUFBVTs7eUJBQ25FLGNBQWM7Ozs7cUJBRXJCLFVBQVMsUUFBUSxFQUFFO0FBQ2hDLFVBQVEsQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLFVBQVMsT0FBTyxFQUFFLE9BQU8sRUFBRTtBQUN6RCxRQUFJLENBQUMsT0FBTyxFQUFFO0FBQ1osWUFBTSwyQkFBYyw2QkFBNkIsQ0FBQyxDQUFDO0tBQ3BEOztBQUVELFFBQUksRUFBRSxHQUFHLE9BQU8sQ0FBQyxFQUFFO1FBQ2YsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPO1FBQ3pCLENBQUMsR0FBRyxDQUFDO1FBQ0wsR0FBRyxHQUFHLEVBQUU7UUFDUixJQUFJLFlBQUE7UUFDSixXQUFXLFlBQUEsQ0FBQzs7QUFFaEIsUUFBSSxPQUFPLENBQUMsSUFBSSxJQUFJLE9BQU8sQ0FBQyxHQUFHLEVBQUU7QUFDL0IsaUJBQVcsR0FBRyx5QkFBa0IsT0FBTyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztLQUNqRjs7QUFFRCxRQUFJLGtCQUFXLE9BQU8sQ0FBQyxFQUFFO0FBQUUsYUFBTyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7S0FBRTs7QUFFMUQsUUFBSSxPQUFPLENBQUMsSUFBSSxFQUFFO0FBQ2hCLFVBQUksR0FBRyxtQkFBWSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDbEM7O0FBRUQsYUFBUyxhQUFhLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUU7QUFDekMsVUFBSSxJQUFJLEVBQUU7QUFDUixZQUFJLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQztBQUNqQixZQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztBQUNuQixZQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssS0FBSyxDQUFDLENBQUM7QUFDekIsWUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDOztBQUVuQixZQUFJLFdBQVcsRUFBRTtBQUNmLGNBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxHQUFHLEtBQUssQ0FBQztTQUN4QztPQUNGOztBQUVELFNBQUcsR0FBRyxHQUFHLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtBQUM3QixZQUFJLEVBQUUsSUFBSTtBQUNWLG1CQUFXLEVBQUUsbUJBQVksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQyxXQUFXLEdBQUcsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO09BQy9FLENBQUMsQ0FBQztLQUNKOztBQUVELFFBQUksT0FBTyxJQUFJLE9BQU8sT0FBTyxLQUFLLFFBQVEsRUFBRTtBQUMxQyxVQUFJLGVBQVEsT0FBTyxDQUFDLEVBQUU7QUFDcEIsYUFBSyxJQUFJLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDdkMsY0FBSSxDQUFDLElBQUksT0FBTyxFQUFFO0FBQ2hCLHlCQUFhLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEtBQUssT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztXQUMvQztTQUNGO09BQ0YsTUFBTTtBQUNMLFlBQUksUUFBUSxZQUFBLENBQUM7O0FBRWIsYUFBSyxJQUFJLEdBQUcsSUFBSSxPQUFPLEVBQUU7QUFDdkIsY0FBSSxPQUFPLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxFQUFFOzs7O0FBSS9CLGdCQUFJLFFBQVEsS0FBSyxTQUFTLEVBQUU7QUFDMUIsMkJBQWEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO2FBQ2hDO0FBQ0Qsb0JBQVEsR0FBRyxHQUFHLENBQUM7QUFDZixhQUFDLEVBQUUsQ0FBQztXQUNMO1NBQ0Y7QUFDRCxZQUFJLFFBQVEsS0FBSyxTQUFTLEVBQUU7QUFDMUIsdUJBQWEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztTQUN0QztPQUNGO0tBQ0Y7O0FBRUQsUUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFO0FBQ1gsU0FBRyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUNyQjs7QUFFRCxXQUFPLEdBQUcsQ0FBQztHQUNaLENBQUMsQ0FBQztDQUNKOzs7Ozs7Ozs7Ozs7O3lCQzlFcUIsY0FBYzs7OztxQkFFckIsVUFBUyxRQUFRLEVBQUU7QUFDaEMsVUFBUSxDQUFDLGNBQWMsQ0FBQyxlQUFlLEVBQUUsaUNBQWdDO0FBQ3ZFLFFBQUksU0FBUyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7O0FBRTFCLGFBQU8sU0FBUyxDQUFDO0tBQ2xCLE1BQU07O0FBRUwsWUFBTSwyQkFBYyxtQkFBbUIsR0FBRyxTQUFTLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDLENBQUM7S0FDdkY7R0FDRixDQUFDLENBQUM7Q0FDSjs7Ozs7Ozs7OztxQkNaaUMsVUFBVTs7cUJBRTdCLFVBQVMsUUFBUSxFQUFFO0FBQ2hDLFVBQVEsQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLFVBQVMsV0FBVyxFQUFFLE9BQU8sRUFBRTtBQUMzRCxRQUFJLGtCQUFXLFdBQVcsQ0FBQyxFQUFFO0FBQUUsaUJBQVcsR0FBRyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQUU7Ozs7O0FBS3RFLFFBQUksQUFBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFJLENBQUMsV0FBVyxJQUFLLGVBQVEsV0FBVyxDQUFDLEVBQUU7QUFDdkUsYUFBTyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQzlCLE1BQU07QUFDTCxhQUFPLE9BQU8sQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDekI7R0FDRixDQUFDLENBQUM7O0FBRUgsVUFBUSxDQUFDLGNBQWMsQ0FBQyxRQUFRLEVBQUUsVUFBUyxXQUFXLEVBQUUsT0FBTyxFQUFFO0FBQy9ELFdBQU8sUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRSxFQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztHQUN2SCxDQUFDLENBQUM7Q0FDSjs7Ozs7Ozs7OztxQkNuQmMsVUFBUyxRQUFRLEVBQUU7QUFDaEMsVUFBUSxDQUFDLGNBQWMsQ0FBQyxLQUFLLEVBQUUsa0NBQWlDO0FBQzlELFFBQUksSUFBSSxHQUFHLENBQUMsU0FBUyxDQUFDO1FBQ2xCLE9BQU8sR0FBRyxTQUFTLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztBQUM5QyxTQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDN0MsVUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUN6Qjs7QUFFRCxRQUFJLEtBQUssR0FBRyxDQUFDLENBQUM7QUFDZCxRQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLElBQUksRUFBRTtBQUM5QixXQUFLLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7S0FDNUIsTUFBTSxJQUFJLE9BQU8sQ0FBQyxJQUFJLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLElBQUksSUFBSSxFQUFFO0FBQ3JELFdBQUssR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztLQUM1QjtBQUNELFFBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7O0FBRWhCLFlBQVEsQ0FBQyxHQUFHLE1BQUEsQ0FBWixRQUFRLEVBQVMsSUFBSSxDQUFDLENBQUM7R0FDeEIsQ0FBQyxDQUFDO0NBQ0o7Ozs7Ozs7Ozs7cUJDbEJjLFVBQVMsUUFBUSxFQUFFO0FBQ2hDLFVBQVEsQ0FBQyxjQUFjLENBQUMsUUFBUSxFQUFFLFVBQVMsR0FBRyxFQUFFLEtBQUssRUFBRTtBQUNyRCxXQUFPLEdBQUcsSUFBSSxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7R0FDMUIsQ0FBQyxDQUFDO0NBQ0o7Ozs7Ozs7Ozs7cUJDSjhFLFVBQVU7O3FCQUUxRSxVQUFTLFFBQVEsRUFBRTtBQUNoQyxVQUFRLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRSxVQUFTLE9BQU8sRUFBRSxPQUFPLEVBQUU7QUFDekQsUUFBSSxrQkFBVyxPQUFPLENBQUMsRUFBRTtBQUFFLGFBQU8sR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQUU7O0FBRTFELFFBQUksRUFBRSxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUM7O0FBRXBCLFFBQUksQ0FBQyxlQUFRLE9BQU8sQ0FBQyxFQUFFO0FBQ3JCLFVBQUksSUFBSSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7QUFDeEIsVUFBSSxPQUFPLENBQUMsSUFBSSxJQUFJLE9BQU8sQ0FBQyxHQUFHLEVBQUU7QUFDL0IsWUFBSSxHQUFHLG1CQUFZLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNqQyxZQUFJLENBQUMsV0FBVyxHQUFHLHlCQUFrQixPQUFPLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7T0FDaEY7O0FBRUQsYUFBTyxFQUFFLENBQUMsT0FBTyxFQUFFO0FBQ2pCLFlBQUksRUFBRSxJQUFJO0FBQ1YsbUJBQVcsRUFBRSxtQkFBWSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztPQUNoRSxDQUFDLENBQUM7S0FDSixNQUFNO0FBQ0wsYUFBTyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQzlCO0dBQ0YsQ0FBQyxDQUFDO0NBQ0o7Ozs7Ozs7Ozs7cUJDdkJxQixTQUFTOztBQUUvQixJQUFJLE1BQU0sR0FBRztBQUNYLFdBQVMsRUFBRSxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLE9BQU8sQ0FBQztBQUM3QyxPQUFLLEVBQUUsTUFBTTs7O0FBR2IsYUFBVyxFQUFFLHFCQUFTLEtBQUssRUFBRTtBQUMzQixRQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRTtBQUM3QixVQUFJLFFBQVEsR0FBRyxlQUFRLE1BQU0sQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7QUFDOUQsVUFBSSxRQUFRLElBQUksQ0FBQyxFQUFFO0FBQ2pCLGFBQUssR0FBRyxRQUFRLENBQUM7T0FDbEIsTUFBTTtBQUNMLGFBQUssR0FBRyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO09BQzdCO0tBQ0Y7O0FBRUQsV0FBTyxLQUFLLENBQUM7R0FDZDs7O0FBR0QsS0FBRyxFQUFFLGFBQVMsS0FBSyxFQUFjO0FBQy9CLFNBQUssR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDOztBQUVsQyxRQUFJLE9BQU8sT0FBTyxLQUFLLFdBQVcsSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLEVBQUU7QUFDL0UsVUFBSSxNQUFNLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNyQyxVQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFOztBQUNwQixjQUFNLEdBQUcsS0FBSyxDQUFDO09BQ2hCOzt3Q0FQbUIsT0FBTztBQUFQLGVBQU87OztBQVEzQixhQUFPLENBQUMsTUFBTSxPQUFDLENBQWYsT0FBTyxFQUFZLE9BQU8sQ0FBQyxDQUFDO0tBQzdCO0dBQ0Y7Q0FDRixDQUFDOztxQkFFYSxNQUFNOzs7Ozs7Ozs7OztxQkNqQ04sVUFBUyxVQUFVLEVBQUU7O0FBRWxDLE1BQUksSUFBSSxHQUFHLE9BQU8sTUFBTSxLQUFLLFdBQVcsR0FBRyxNQUFNLEdBQUcsTUFBTTtNQUN0RCxXQUFXLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQzs7QUFFbEMsWUFBVSxDQUFDLFVBQVUsR0FBRyxZQUFXO0FBQ2pDLFFBQUksSUFBSSxDQUFDLFVBQVUsS0FBSyxVQUFVLEVBQUU7QUFDbEMsVUFBSSxDQUFDLFVBQVUsR0FBRyxXQUFXLENBQUM7S0FDL0I7QUFDRCxXQUFPLFVBQVUsQ0FBQztHQUNuQixDQUFDO0NBQ0g7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7cUJDWnNCLFNBQVM7O0lBQXBCLEtBQUs7O3lCQUNLLGFBQWE7Ozs7b0JBQzhCLFFBQVE7O0FBRWxFLFNBQVMsYUFBYSxDQUFDLFlBQVksRUFBRTtBQUMxQyxNQUFNLGdCQUFnQixHQUFHLFlBQVksSUFBSSxZQUFZLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztNQUN2RCxlQUFlLDBCQUFvQixDQUFDOztBQUUxQyxNQUFJLGdCQUFnQixLQUFLLGVBQWUsRUFBRTtBQUN4QyxRQUFJLGdCQUFnQixHQUFHLGVBQWUsRUFBRTtBQUN0QyxVQUFNLGVBQWUsR0FBRyx1QkFBaUIsZUFBZSxDQUFDO1VBQ25ELGdCQUFnQixHQUFHLHVCQUFpQixnQkFBZ0IsQ0FBQyxDQUFDO0FBQzVELFlBQU0sMkJBQWMseUZBQXlGLEdBQ3ZHLHFEQUFxRCxHQUFHLGVBQWUsR0FBRyxtREFBbUQsR0FBRyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsQ0FBQztLQUNoSyxNQUFNOztBQUVMLFlBQU0sMkJBQWMsd0ZBQXdGLEdBQ3RHLGlEQUFpRCxHQUFHLFlBQVksQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztLQUNuRjtHQUNGO0NBQ0Y7O0FBRU0sU0FBUyxRQUFRLENBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRTs7QUFFMUMsTUFBSSxDQUFDLEdBQUcsRUFBRTtBQUNSLFVBQU0sMkJBQWMsbUNBQW1DLENBQUMsQ0FBQztHQUMxRDtBQUNELE1BQUksQ0FBQyxZQUFZLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFO0FBQ3ZDLFVBQU0sMkJBQWMsMkJBQTJCLEdBQUcsT0FBTyxZQUFZLENBQUMsQ0FBQztHQUN4RTs7QUFFRCxjQUFZLENBQUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxZQUFZLENBQUMsTUFBTSxDQUFDOzs7O0FBSWxELEtBQUcsQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQzs7QUFFNUMsV0FBUyxvQkFBb0IsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRTtBQUN2RCxRQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUU7QUFDaEIsYUFBTyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDbEQsVUFBSSxPQUFPLENBQUMsR0FBRyxFQUFFO0FBQ2YsZUFBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUM7T0FDdkI7S0FDRjs7QUFFRCxXQUFPLEdBQUcsR0FBRyxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3RFLFFBQUksTUFBTSxHQUFHLEdBQUcsQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQzs7QUFFeEUsUUFBSSxNQUFNLElBQUksSUFBSSxJQUFJLEdBQUcsQ0FBQyxPQUFPLEVBQUU7QUFDakMsYUFBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsWUFBWSxDQUFDLGVBQWUsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUN6RixZQUFNLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0tBQzNEO0FBQ0QsUUFBSSxNQUFNLElBQUksSUFBSSxFQUFFO0FBQ2xCLFVBQUksT0FBTyxDQUFDLE1BQU0sRUFBRTtBQUNsQixZQUFJLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQy9CLGFBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDNUMsY0FBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsRUFBRTtBQUM1QixrQkFBTTtXQUNQOztBQUVELGVBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUN0QztBQUNELGNBQU0sR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO09BQzNCO0FBQ0QsYUFBTyxNQUFNLENBQUM7S0FDZixNQUFNO0FBQ0wsWUFBTSwyQkFBYyxjQUFjLEdBQUcsT0FBTyxDQUFDLElBQUksR0FBRywwREFBMEQsQ0FBQyxDQUFDO0tBQ2pIO0dBQ0Y7OztBQUdELE1BQUksU0FBUyxHQUFHO0FBQ2QsVUFBTSxFQUFFLGdCQUFTLEdBQUcsRUFBRSxJQUFJLEVBQUU7QUFDMUIsVUFBSSxFQUFFLElBQUksSUFBSSxHQUFHLENBQUEsQUFBQyxFQUFFO0FBQ2xCLGNBQU0sMkJBQWMsR0FBRyxHQUFHLElBQUksR0FBRyxtQkFBbUIsR0FBRyxHQUFHLENBQUMsQ0FBQztPQUM3RDtBQUNELGFBQU8sR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ2xCO0FBQ0QsVUFBTSxFQUFFLGdCQUFTLE1BQU0sRUFBRSxJQUFJLEVBQUU7QUFDN0IsVUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUMxQixXQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQzVCLFlBQUksTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLEVBQUU7QUFDeEMsaUJBQU8sTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3hCO09BQ0Y7S0FDRjtBQUNELFVBQU0sRUFBRSxnQkFBUyxPQUFPLEVBQUUsT0FBTyxFQUFFO0FBQ2pDLGFBQU8sT0FBTyxPQUFPLEtBQUssVUFBVSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsT0FBTyxDQUFDO0tBQ3hFOztBQUVELG9CQUFnQixFQUFFLEtBQUssQ0FBQyxnQkFBZ0I7QUFDeEMsaUJBQWEsRUFBRSxvQkFBb0I7O0FBRW5DLE1BQUUsRUFBRSxZQUFTLENBQUMsRUFBRTtBQUNkLFVBQUksR0FBRyxHQUFHLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMxQixTQUFHLENBQUMsU0FBUyxHQUFHLFlBQVksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7QUFDdkMsYUFBTyxHQUFHLENBQUM7S0FDWjs7QUFFRCxZQUFRLEVBQUUsRUFBRTtBQUNaLFdBQU8sRUFBRSxpQkFBUyxDQUFDLEVBQUUsSUFBSSxFQUFFLG1CQUFtQixFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUU7QUFDbkUsVUFBSSxjQUFjLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7VUFDakMsRUFBRSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDcEIsVUFBSSxJQUFJLElBQUksTUFBTSxJQUFJLFdBQVcsSUFBSSxtQkFBbUIsRUFBRTtBQUN4RCxzQkFBYyxHQUFHLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsbUJBQW1CLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO09BQzNGLE1BQU0sSUFBSSxDQUFDLGNBQWMsRUFBRTtBQUMxQixzQkFBYyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsV0FBVyxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7T0FDOUQ7QUFDRCxhQUFPLGNBQWMsQ0FBQztLQUN2Qjs7QUFFRCxRQUFJLEVBQUUsY0FBUyxLQUFLLEVBQUUsS0FBSyxFQUFFO0FBQzNCLGFBQU8sS0FBSyxJQUFJLEtBQUssRUFBRSxFQUFFO0FBQ3ZCLGFBQUssR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDO09BQ3ZCO0FBQ0QsYUFBTyxLQUFLLENBQUM7S0FDZDtBQUNELFNBQUssRUFBRSxlQUFTLEtBQUssRUFBRSxNQUFNLEVBQUU7QUFDN0IsVUFBSSxHQUFHLEdBQUcsS0FBSyxJQUFJLE1BQU0sQ0FBQzs7QUFFMUIsVUFBSSxLQUFLLElBQUksTUFBTSxJQUFLLEtBQUssS0FBSyxNQUFNLEFBQUMsRUFBRTtBQUN6QyxXQUFHLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO09BQ3ZDOztBQUVELGFBQU8sR0FBRyxDQUFDO0tBQ1o7O0FBRUQsUUFBSSxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSTtBQUNqQixnQkFBWSxFQUFFLFlBQVksQ0FBQyxRQUFRO0dBQ3BDLENBQUM7O0FBRUYsV0FBUyxHQUFHLENBQUMsT0FBTyxFQUFnQjtRQUFkLE9BQU8seURBQUcsRUFBRTs7QUFDaEMsUUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQzs7QUFFeEIsT0FBRyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNwQixRQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sSUFBSSxZQUFZLENBQUMsT0FBTyxFQUFFO0FBQzVDLFVBQUksR0FBRyxRQUFRLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQ2hDO0FBQ0QsUUFBSSxNQUFNLFlBQUE7UUFDTixXQUFXLEdBQUcsWUFBWSxDQUFDLGNBQWMsR0FBRyxFQUFFLEdBQUcsU0FBUyxDQUFDO0FBQy9ELFFBQUksWUFBWSxDQUFDLFNBQVMsRUFBRTtBQUMxQixVQUFJLE9BQU8sQ0FBQyxNQUFNLEVBQUU7QUFDbEIsY0FBTSxHQUFHLE9BQU8sS0FBSyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDO09BQzVGLE1BQU07QUFDTCxjQUFNLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztPQUNwQjtLQUNGOztBQUVELGFBQVMsSUFBSSxDQUFDLE9BQU8sZ0JBQWU7QUFDbEMsYUFBTyxFQUFFLEdBQUcsWUFBWSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsT0FBTyxFQUFFLFNBQVMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0tBQ3JIO0FBQ0QsUUFBSSxHQUFHLGlCQUFpQixDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsTUFBTSxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxDQUFDLENBQUM7QUFDdEcsV0FBTyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0dBQy9CO0FBQ0QsS0FBRyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7O0FBRWpCLEtBQUcsQ0FBQyxNQUFNLEdBQUcsVUFBUyxPQUFPLEVBQUU7QUFDN0IsUUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUU7QUFDcEIsZUFBUyxDQUFDLE9BQU8sR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDOztBQUVsRSxVQUFJLFlBQVksQ0FBQyxVQUFVLEVBQUU7QUFDM0IsaUJBQVMsQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztPQUN0RTtBQUNELFVBQUksWUFBWSxDQUFDLFVBQVUsSUFBSSxZQUFZLENBQUMsYUFBYSxFQUFFO0FBQ3pELGlCQUFTLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7T0FDNUU7S0FDRixNQUFNO0FBQ0wsZUFBUyxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO0FBQ3BDLGVBQVMsQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUN0QyxlQUFTLENBQUMsVUFBVSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUM7S0FDM0M7R0FDRixDQUFDOztBQUVGLEtBQUcsQ0FBQyxNQUFNLEdBQUcsVUFBUyxDQUFDLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUU7QUFDbEQsUUFBSSxZQUFZLENBQUMsY0FBYyxJQUFJLENBQUMsV0FBVyxFQUFFO0FBQy9DLFlBQU0sMkJBQWMsd0JBQXdCLENBQUMsQ0FBQztLQUMvQztBQUNELFFBQUksWUFBWSxDQUFDLFNBQVMsSUFBSSxDQUFDLE1BQU0sRUFBRTtBQUNyQyxZQUFNLDJCQUFjLHlCQUF5QixDQUFDLENBQUM7S0FDaEQ7O0FBRUQsV0FBTyxXQUFXLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxXQUFXLEVBQUUsTUFBTSxDQUFDLENBQUM7R0FDakYsQ0FBQztBQUNGLFNBQU8sR0FBRyxDQUFDO0NBQ1o7O0FBRU0sU0FBUyxXQUFXLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLG1CQUFtQixFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUU7QUFDNUYsV0FBUyxJQUFJLENBQUMsT0FBTyxFQUFnQjtRQUFkLE9BQU8seURBQUcsRUFBRTs7QUFDakMsUUFBSSxhQUFhLEdBQUcsTUFBTSxDQUFDO0FBQzNCLFFBQUksTUFBTSxJQUFJLE9BQU8sS0FBSyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUU7QUFDbkMsbUJBQWEsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztLQUMxQzs7QUFFRCxXQUFPLEVBQUUsQ0FBQyxTQUFTLEVBQ2YsT0FBTyxFQUNQLFNBQVMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLFFBQVEsRUFDckMsT0FBTyxDQUFDLElBQUksSUFBSSxJQUFJLEVBQ3BCLFdBQVcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQ3hELGFBQWEsQ0FBQyxDQUFDO0dBQ3BCOztBQUVELE1BQUksR0FBRyxpQkFBaUIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLFdBQVcsQ0FBQyxDQUFDOztBQUV6RSxNQUFJLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQztBQUNqQixNQUFJLENBQUMsS0FBSyxHQUFHLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztBQUN4QyxNQUFJLENBQUMsV0FBVyxHQUFHLG1CQUFtQixJQUFJLENBQUMsQ0FBQztBQUM1QyxTQUFPLElBQUksQ0FBQztDQUNiOztBQUVNLFNBQVMsY0FBYyxDQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFO0FBQ3hELE1BQUksQ0FBQyxPQUFPLEVBQUU7QUFDWixRQUFJLE9BQU8sQ0FBQyxJQUFJLEtBQUssZ0JBQWdCLEVBQUU7QUFDckMsYUFBTyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7S0FDekMsTUFBTTtBQUNMLGFBQU8sR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUMxQztHQUNGLE1BQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFOztBQUV6QyxXQUFPLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQztBQUN2QixXQUFPLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztHQUNyQztBQUNELFNBQU8sT0FBTyxDQUFDO0NBQ2hCOztBQUVNLFNBQVMsYUFBYSxDQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFO0FBQ3ZELFNBQU8sQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO0FBQ3ZCLE1BQUksT0FBTyxDQUFDLEdBQUcsRUFBRTtBQUNmLFdBQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUM7R0FDdkU7O0FBRUQsTUFBSSxZQUFZLFlBQUEsQ0FBQztBQUNqQixNQUFJLE9BQU8sQ0FBQyxFQUFFLElBQUksT0FBTyxDQUFDLEVBQUUsS0FBSyxJQUFJLEVBQUU7QUFDckMsV0FBTyxDQUFDLElBQUksR0FBRyxrQkFBWSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDekMsZ0JBQVksR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUM7O0FBRTFELFFBQUksWUFBWSxDQUFDLFFBQVEsRUFBRTtBQUN6QixhQUFPLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLE9BQU8sQ0FBQyxRQUFRLEVBQUUsWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0tBQzlFO0dBQ0Y7O0FBRUQsTUFBSSxPQUFPLEtBQUssU0FBUyxJQUFJLFlBQVksRUFBRTtBQUN6QyxXQUFPLEdBQUcsWUFBWSxDQUFDO0dBQ3hCOztBQUVELE1BQUksT0FBTyxLQUFLLFNBQVMsRUFBRTtBQUN6QixVQUFNLDJCQUFjLGNBQWMsR0FBRyxPQUFPLENBQUMsSUFBSSxHQUFHLHFCQUFxQixDQUFDLENBQUM7R0FDNUUsTUFBTSxJQUFJLE9BQU8sWUFBWSxRQUFRLEVBQUU7QUFDdEMsV0FBTyxPQUFPLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0dBQ2xDO0NBQ0Y7O0FBRU0sU0FBUyxJQUFJLEdBQUc7QUFBRSxTQUFPLEVBQUUsQ0FBQztDQUFFOztBQUVyQyxTQUFTLFFBQVEsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFO0FBQy9CLE1BQUksQ0FBQyxJQUFJLElBQUksRUFBRSxNQUFNLElBQUksSUFBSSxDQUFBLEFBQUMsRUFBRTtBQUM5QixRQUFJLEdBQUcsSUFBSSxHQUFHLGtCQUFZLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztBQUNyQyxRQUFJLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQztHQUNyQjtBQUNELFNBQU8sSUFBSSxDQUFDO0NBQ2I7O0FBRUQsU0FBUyxpQkFBaUIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRTtBQUN6RSxNQUFJLEVBQUUsQ0FBQyxTQUFTLEVBQUU7QUFDaEIsUUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDO0FBQ2YsUUFBSSxHQUFHLEVBQUUsQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsTUFBTSxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQzVGLFNBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO0dBQzNCO0FBQ0QsU0FBTyxJQUFJLENBQUM7Q0FDYjs7Ozs7Ozs7QUMzUUQsU0FBUyxVQUFVLENBQUMsTUFBTSxFQUFFO0FBQzFCLE1BQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0NBQ3RCOztBQUVELFVBQVUsQ0FBQyxTQUFTLENBQUMsUUFBUSxHQUFHLFVBQVUsQ0FBQyxTQUFTLENBQUMsTUFBTSxHQUFHLFlBQVc7QUFDdkUsU0FBTyxFQUFFLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztDQUN6QixDQUFDOztxQkFFYSxVQUFVOzs7Ozs7Ozs7Ozs7Ozs7QUNUekIsSUFBTSxNQUFNLEdBQUc7QUFDYixLQUFHLEVBQUUsT0FBTztBQUNaLEtBQUcsRUFBRSxNQUFNO0FBQ1gsS0FBRyxFQUFFLE1BQU07QUFDWCxLQUFHLEVBQUUsUUFBUTtBQUNiLEtBQUcsRUFBRSxRQUFRO0FBQ2IsS0FBRyxFQUFFLFFBQVE7QUFDYixLQUFHLEVBQUUsUUFBUTtDQUNkLENBQUM7O0FBRUYsSUFBTSxRQUFRLEdBQUcsWUFBWTtJQUN2QixRQUFRLEdBQUcsV0FBVyxDQUFDOztBQUU3QixTQUFTLFVBQVUsQ0FBQyxHQUFHLEVBQUU7QUFDdkIsU0FBTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7Q0FDcEI7O0FBRU0sU0FBUyxNQUFNLENBQUMsR0FBRyxvQkFBbUI7QUFDM0MsT0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDekMsU0FBSyxJQUFJLEdBQUcsSUFBSSxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUU7QUFDNUIsVUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFO0FBQzNELFdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7T0FDOUI7S0FDRjtHQUNGOztBQUVELFNBQU8sR0FBRyxDQUFDO0NBQ1o7O0FBRU0sSUFBSSxRQUFRLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUM7Ozs7OztBQUtoRCxJQUFJLFVBQVUsR0FBRyxvQkFBUyxLQUFLLEVBQUU7QUFDL0IsU0FBTyxPQUFPLEtBQUssS0FBSyxVQUFVLENBQUM7Q0FDcEMsQ0FBQzs7O0FBR0YsSUFBSSxVQUFVLENBQUMsR0FBRyxDQUFDLEVBQUU7QUFDbkIsVUFJTSxVQUFVLEdBSmhCLFVBQVUsR0FBRyxVQUFTLEtBQUssRUFBRTtBQUMzQixXQUFPLE9BQU8sS0FBSyxLQUFLLFVBQVUsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLG1CQUFtQixDQUFDO0dBQ3BGLENBQUM7Q0FDSDtRQUNPLFVBQVUsR0FBVixVQUFVOzs7OztBQUlYLElBQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFPLElBQUksVUFBUyxLQUFLLEVBQUU7QUFDdEQsU0FBTyxBQUFDLEtBQUssSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLEdBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxnQkFBZ0IsR0FBRyxLQUFLLENBQUM7Q0FDakcsQ0FBQzs7Ozs7QUFHSyxTQUFTLE9BQU8sQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFO0FBQ3BDLE9BQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDaEQsUUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssS0FBSyxFQUFFO0FBQ3RCLGFBQU8sQ0FBQyxDQUFDO0tBQ1Y7R0FDRjtBQUNELFNBQU8sQ0FBQyxDQUFDLENBQUM7Q0FDWDs7QUFHTSxTQUFTLGdCQUFnQixDQUFDLE1BQU0sRUFBRTtBQUN2QyxNQUFJLE9BQU8sTUFBTSxLQUFLLFFBQVEsRUFBRTs7QUFFOUIsUUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLE1BQU0sRUFBRTtBQUMzQixhQUFPLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQztLQUN4QixNQUFNLElBQUksTUFBTSxJQUFJLElBQUksRUFBRTtBQUN6QixhQUFPLEVBQUUsQ0FBQztLQUNYLE1BQU0sSUFBSSxDQUFDLE1BQU0sRUFBRTtBQUNsQixhQUFPLE1BQU0sR0FBRyxFQUFFLENBQUM7S0FDcEI7Ozs7O0FBS0QsVUFBTSxHQUFHLEVBQUUsR0FBRyxNQUFNLENBQUM7R0FDdEI7O0FBRUQsTUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUU7QUFBRSxXQUFPLE1BQU0sQ0FBQztHQUFFO0FBQzlDLFNBQU8sTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsVUFBVSxDQUFDLENBQUM7Q0FDN0M7O0FBRU0sU0FBUyxPQUFPLENBQUMsS0FBSyxFQUFFO0FBQzdCLE1BQUksQ0FBQyxLQUFLLElBQUksS0FBSyxLQUFLLENBQUMsRUFBRTtBQUN6QixXQUFPLElBQUksQ0FBQztHQUNiLE1BQU0sSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7QUFDL0MsV0FBTyxJQUFJLENBQUM7R0FDYixNQUFNO0FBQ0wsV0FBTyxLQUFLLENBQUM7R0FDZDtDQUNGOztBQUVNLFNBQVMsV0FBVyxDQUFDLE1BQU0sRUFBRTtBQUNsQyxNQUFJLEtBQUssR0FBRyxNQUFNLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQy9CLE9BQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO0FBQ3ZCLFNBQU8sS0FBSyxDQUFDO0NBQ2Q7O0FBRU0sU0FBUyxXQUFXLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRTtBQUN2QyxRQUFNLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQztBQUNsQixTQUFPLE1BQU0sQ0FBQztDQUNmOztBQUVNLFNBQVMsaUJBQWlCLENBQUMsV0FBVyxFQUFFLEVBQUUsRUFBRTtBQUNqRCxTQUFPLENBQUMsV0FBVyxHQUFHLFdBQVcsR0FBRyxHQUFHLEdBQUcsRUFBRSxDQUFBLEdBQUksRUFBRSxDQUFDO0NBQ3BEOzs7O0FDM0dEO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDeExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDMUxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ2hLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUM3T0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ3ROQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDakpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUM5RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDeGVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzk5QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDMU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ3ZUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDM05BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3JOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzl4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2gvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ2xHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQzFrQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDN3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25OQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUN6S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDelJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUMxV0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ3BuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDOXNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ251QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDclFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzFpQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQy9JQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ3JFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0REE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTEE7QUFDQTtBQUNBO0FBQ0E7O0FDSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJpbXBvcnQgKiBhcyBiYXNlIGZyb20gJy4vaGFuZGxlYmFycy9iYXNlJztcblxuLy8gRWFjaCBvZiB0aGVzZSBhdWdtZW50IHRoZSBIYW5kbGViYXJzIG9iamVjdC4gTm8gbmVlZCB0byBzZXR1cCBoZXJlLlxuLy8gKFRoaXMgaXMgZG9uZSB0byBlYXNpbHkgc2hhcmUgY29kZSBiZXR3ZWVuIGNvbW1vbmpzIGFuZCBicm93c2UgZW52cylcbmltcG9ydCBTYWZlU3RyaW5nIGZyb20gJy4vaGFuZGxlYmFycy9zYWZlLXN0cmluZyc7XG5pbXBvcnQgRXhjZXB0aW9uIGZyb20gJy4vaGFuZGxlYmFycy9leGNlcHRpb24nO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSAnLi9oYW5kbGViYXJzL3V0aWxzJztcbmltcG9ydCAqIGFzIHJ1bnRpbWUgZnJvbSAnLi9oYW5kbGViYXJzL3J1bnRpbWUnO1xuXG5pbXBvcnQgbm9Db25mbGljdCBmcm9tICcuL2hhbmRsZWJhcnMvbm8tY29uZmxpY3QnO1xuXG4vLyBGb3IgY29tcGF0aWJpbGl0eSBhbmQgdXNhZ2Ugb3V0c2lkZSBvZiBtb2R1bGUgc3lzdGVtcywgbWFrZSB0aGUgSGFuZGxlYmFycyBvYmplY3QgYSBuYW1lc3BhY2VcbmZ1bmN0aW9uIGNyZWF0ZSgpIHtcbiAgbGV0IGhiID0gbmV3IGJhc2UuSGFuZGxlYmFyc0Vudmlyb25tZW50KCk7XG5cbiAgVXRpbHMuZXh0ZW5kKGhiLCBiYXNlKTtcbiAgaGIuU2FmZVN0cmluZyA9IFNhZmVTdHJpbmc7XG4gIGhiLkV4Y2VwdGlvbiA9IEV4Y2VwdGlvbjtcbiAgaGIuVXRpbHMgPSBVdGlscztcbiAgaGIuZXNjYXBlRXhwcmVzc2lvbiA9IFV0aWxzLmVzY2FwZUV4cHJlc3Npb247XG5cbiAgaGIuVk0gPSBydW50aW1lO1xuICBoYi50ZW1wbGF0ZSA9IGZ1bmN0aW9uKHNwZWMpIHtcbiAgICByZXR1cm4gcnVudGltZS50ZW1wbGF0ZShzcGVjLCBoYik7XG4gIH07XG5cbiAgcmV0dXJuIGhiO1xufVxuXG5sZXQgaW5zdCA9IGNyZWF0ZSgpO1xuaW5zdC5jcmVhdGUgPSBjcmVhdGU7XG5cbm5vQ29uZmxpY3QoaW5zdCk7XG5cbmluc3RbJ2RlZmF1bHQnXSA9IGluc3Q7XG5cbmV4cG9ydCBkZWZhdWx0IGluc3Q7XG4iLCJpbXBvcnQge2NyZWF0ZUZyYW1lLCBleHRlbmQsIHRvU3RyaW5nfSBmcm9tICcuL3V0aWxzJztcbmltcG9ydCBFeGNlcHRpb24gZnJvbSAnLi9leGNlcHRpb24nO1xuaW1wb3J0IHtyZWdpc3RlckRlZmF1bHRIZWxwZXJzfSBmcm9tICcuL2hlbHBlcnMnO1xuaW1wb3J0IHtyZWdpc3RlckRlZmF1bHREZWNvcmF0b3JzfSBmcm9tICcuL2RlY29yYXRvcnMnO1xuaW1wb3J0IGxvZ2dlciBmcm9tICcuL2xvZ2dlcic7XG5cbmV4cG9ydCBjb25zdCBWRVJTSU9OID0gJzQuMC41JztcbmV4cG9ydCBjb25zdCBDT01QSUxFUl9SRVZJU0lPTiA9IDc7XG5cbmV4cG9ydCBjb25zdCBSRVZJU0lPTl9DSEFOR0VTID0ge1xuICAxOiAnPD0gMS4wLnJjLjInLCAvLyAxLjAucmMuMiBpcyBhY3R1YWxseSByZXYyIGJ1dCBkb2Vzbid0IHJlcG9ydCBpdFxuICAyOiAnPT0gMS4wLjAtcmMuMycsXG4gIDM6ICc9PSAxLjAuMC1yYy40JyxcbiAgNDogJz09IDEueC54JyxcbiAgNTogJz09IDIuMC4wLWFscGhhLngnLFxuICA2OiAnPj0gMi4wLjAtYmV0YS4xJyxcbiAgNzogJz49IDQuMC4wJ1xufTtcblxuY29uc3Qgb2JqZWN0VHlwZSA9ICdbb2JqZWN0IE9iamVjdF0nO1xuXG5leHBvcnQgZnVuY3Rpb24gSGFuZGxlYmFyc0Vudmlyb25tZW50KGhlbHBlcnMsIHBhcnRpYWxzLCBkZWNvcmF0b3JzKSB7XG4gIHRoaXMuaGVscGVycyA9IGhlbHBlcnMgfHwge307XG4gIHRoaXMucGFydGlhbHMgPSBwYXJ0aWFscyB8fCB7fTtcbiAgdGhpcy5kZWNvcmF0b3JzID0gZGVjb3JhdG9ycyB8fCB7fTtcblxuICByZWdpc3RlckRlZmF1bHRIZWxwZXJzKHRoaXMpO1xuICByZWdpc3RlckRlZmF1bHREZWNvcmF0b3JzKHRoaXMpO1xufVxuXG5IYW5kbGViYXJzRW52aXJvbm1lbnQucHJvdG90eXBlID0ge1xuICBjb25zdHJ1Y3RvcjogSGFuZGxlYmFyc0Vudmlyb25tZW50LFxuXG4gIGxvZ2dlcjogbG9nZ2VyLFxuICBsb2c6IGxvZ2dlci5sb2csXG5cbiAgcmVnaXN0ZXJIZWxwZXI6IGZ1bmN0aW9uKG5hbWUsIGZuKSB7XG4gICAgaWYgKHRvU3RyaW5nLmNhbGwobmFtZSkgPT09IG9iamVjdFR5cGUpIHtcbiAgICAgIGlmIChmbikgeyB0aHJvdyBuZXcgRXhjZXB0aW9uKCdBcmcgbm90IHN1cHBvcnRlZCB3aXRoIG11bHRpcGxlIGhlbHBlcnMnKTsgfVxuICAgICAgZXh0ZW5kKHRoaXMuaGVscGVycywgbmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaGVscGVyc1tuYW1lXSA9IGZuO1xuICAgIH1cbiAgfSxcbiAgdW5yZWdpc3RlckhlbHBlcjogZnVuY3Rpb24obmFtZSkge1xuICAgIGRlbGV0ZSB0aGlzLmhlbHBlcnNbbmFtZV07XG4gIH0sXG5cbiAgcmVnaXN0ZXJQYXJ0aWFsOiBmdW5jdGlvbihuYW1lLCBwYXJ0aWFsKSB7XG4gICAgaWYgKHRvU3RyaW5nLmNhbGwobmFtZSkgPT09IG9iamVjdFR5cGUpIHtcbiAgICAgIGV4dGVuZCh0aGlzLnBhcnRpYWxzLCBuYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHR5cGVvZiBwYXJ0aWFsID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKGBBdHRlbXB0aW5nIHRvIHJlZ2lzdGVyIGEgcGFydGlhbCBjYWxsZWQgXCIke25hbWV9XCIgYXMgdW5kZWZpbmVkYCk7XG4gICAgICB9XG4gICAgICB0aGlzLnBhcnRpYWxzW25hbWVdID0gcGFydGlhbDtcbiAgICB9XG4gIH0sXG4gIHVucmVnaXN0ZXJQYXJ0aWFsOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgZGVsZXRlIHRoaXMucGFydGlhbHNbbmFtZV07XG4gIH0sXG5cbiAgcmVnaXN0ZXJEZWNvcmF0b3I6IGZ1bmN0aW9uKG5hbWUsIGZuKSB7XG4gICAgaWYgKHRvU3RyaW5nLmNhbGwobmFtZSkgPT09IG9iamVjdFR5cGUpIHtcbiAgICAgIGlmIChmbikgeyB0aHJvdyBuZXcgRXhjZXB0aW9uKCdBcmcgbm90IHN1cHBvcnRlZCB3aXRoIG11bHRpcGxlIGRlY29yYXRvcnMnKTsgfVxuICAgICAgZXh0ZW5kKHRoaXMuZGVjb3JhdG9ycywgbmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGVjb3JhdG9yc1tuYW1lXSA9IGZuO1xuICAgIH1cbiAgfSxcbiAgdW5yZWdpc3RlckRlY29yYXRvcjogZnVuY3Rpb24obmFtZSkge1xuICAgIGRlbGV0ZSB0aGlzLmRlY29yYXRvcnNbbmFtZV07XG4gIH1cbn07XG5cbmV4cG9ydCBsZXQgbG9nID0gbG9nZ2VyLmxvZztcblxuZXhwb3J0IHtjcmVhdGVGcmFtZSwgbG9nZ2VyfTtcbiIsImltcG9ydCByZWdpc3RlcklubGluZSBmcm9tICcuL2RlY29yYXRvcnMvaW5saW5lJztcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyRGVmYXVsdERlY29yYXRvcnMoaW5zdGFuY2UpIHtcbiAgcmVnaXN0ZXJJbmxpbmUoaW5zdGFuY2UpO1xufVxuXG4iLCJpbXBvcnQge2V4dGVuZH0gZnJvbSAnLi4vdXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihpbnN0YW5jZSkge1xuICBpbnN0YW5jZS5yZWdpc3RlckRlY29yYXRvcignaW5saW5lJywgZnVuY3Rpb24oZm4sIHByb3BzLCBjb250YWluZXIsIG9wdGlvbnMpIHtcbiAgICBsZXQgcmV0ID0gZm47XG4gICAgaWYgKCFwcm9wcy5wYXJ0aWFscykge1xuICAgICAgcHJvcHMucGFydGlhbHMgPSB7fTtcbiAgICAgIHJldCA9IGZ1bmN0aW9uKGNvbnRleHQsIG9wdGlvbnMpIHtcbiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IHBhcnRpYWxzIHN0YWNrIGZyYW1lIHByaW9yIHRvIGV4ZWMuXG4gICAgICAgIGxldCBvcmlnaW5hbCA9IGNvbnRhaW5lci5wYXJ0aWFscztcbiAgICAgICAgY29udGFpbmVyLnBhcnRpYWxzID0gZXh0ZW5kKHt9LCBvcmlnaW5hbCwgcHJvcHMucGFydGlhbHMpO1xuICAgICAgICBsZXQgcmV0ID0gZm4oY29udGV4dCwgb3B0aW9ucyk7XG4gICAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IG9yaWdpbmFsO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgfTtcbiAgICB9XG5cbiAgICBwcm9wcy5wYXJ0aWFsc1tvcHRpb25zLmFyZ3NbMF1dID0gb3B0aW9ucy5mbjtcblxuICAgIHJldHVybiByZXQ7XG4gIH0pO1xufVxuIiwiXG5jb25zdCBlcnJvclByb3BzID0gWydkZXNjcmlwdGlvbicsICdmaWxlTmFtZScsICdsaW5lTnVtYmVyJywgJ21lc3NhZ2UnLCAnbmFtZScsICdudW1iZXInLCAnc3RhY2snXTtcblxuZnVuY3Rpb24gRXhjZXB0aW9uKG1lc3NhZ2UsIG5vZGUpIHtcbiAgbGV0IGxvYyA9IG5vZGUgJiYgbm9kZS5sb2MsXG4gICAgICBsaW5lLFxuICAgICAgY29sdW1uO1xuICBpZiAobG9jKSB7XG4gICAgbGluZSA9IGxvYy5zdGFydC5saW5lO1xuICAgIGNvbHVtbiA9IGxvYy5zdGFydC5jb2x1bW47XG5cbiAgICBtZXNzYWdlICs9ICcgLSAnICsgbGluZSArICc6JyArIGNvbHVtbjtcbiAgfVxuXG4gIGxldCB0bXAgPSBFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IuY2FsbCh0aGlzLCBtZXNzYWdlKTtcblxuICAvLyBVbmZvcnR1bmF0ZWx5IGVycm9ycyBhcmUgbm90IGVudW1lcmFibGUgaW4gQ2hyb21lIChhdCBsZWFzdCksIHNvIGBmb3IgcHJvcCBpbiB0bXBgIGRvZXNuJ3Qgd29yay5cbiAgZm9yIChsZXQgaWR4ID0gMDsgaWR4IDwgZXJyb3JQcm9wcy5sZW5ndGg7IGlkeCsrKSB7XG4gICAgdGhpc1tlcnJvclByb3BzW2lkeF1dID0gdG1wW2Vycm9yUHJvcHNbaWR4XV07XG4gIH1cblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICBpZiAoRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UpIHtcbiAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBFeGNlcHRpb24pO1xuICB9XG5cbiAgaWYgKGxvYykge1xuICAgIHRoaXMubGluZU51bWJlciA9IGxpbmU7XG4gICAgdGhpcy5jb2x1bW4gPSBjb2x1bW47XG4gIH1cbn1cblxuRXhjZXB0aW9uLnByb3RvdHlwZSA9IG5ldyBFcnJvcigpO1xuXG5leHBvcnQgZGVmYXVsdCBFeGNlcHRpb247XG4iLCJpbXBvcnQgcmVnaXN0ZXJCbG9ja0hlbHBlck1pc3NpbmcgZnJvbSAnLi9oZWxwZXJzL2Jsb2NrLWhlbHBlci1taXNzaW5nJztcbmltcG9ydCByZWdpc3RlckVhY2ggZnJvbSAnLi9oZWxwZXJzL2VhY2gnO1xuaW1wb3J0IHJlZ2lzdGVySGVscGVyTWlzc2luZyBmcm9tICcuL2hlbHBlcnMvaGVscGVyLW1pc3NpbmcnO1xuaW1wb3J0IHJlZ2lzdGVySWYgZnJvbSAnLi9oZWxwZXJzL2lmJztcbmltcG9ydCByZWdpc3RlckxvZyBmcm9tICcuL2hlbHBlcnMvbG9nJztcbmltcG9ydCByZWdpc3Rlckxvb2t1cCBmcm9tICcuL2hlbHBlcnMvbG9va3VwJztcbmltcG9ydCByZWdpc3RlcldpdGggZnJvbSAnLi9oZWxwZXJzL3dpdGgnO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJEZWZhdWx0SGVscGVycyhpbnN0YW5jZSkge1xuICByZWdpc3RlckJsb2NrSGVscGVyTWlzc2luZyhpbnN0YW5jZSk7XG4gIHJlZ2lzdGVyRWFjaChpbnN0YW5jZSk7XG4gIHJlZ2lzdGVySGVscGVyTWlzc2luZyhpbnN0YW5jZSk7XG4gIHJlZ2lzdGVySWYoaW5zdGFuY2UpO1xuICByZWdpc3RlckxvZyhpbnN0YW5jZSk7XG4gIHJlZ2lzdGVyTG9va3VwKGluc3RhbmNlKTtcbiAgcmVnaXN0ZXJXaXRoKGluc3RhbmNlKTtcbn1cbiIsImltcG9ydCB7YXBwZW5kQ29udGV4dFBhdGgsIGNyZWF0ZUZyYW1lLCBpc0FycmF5fSBmcm9tICcuLi91dGlscyc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdibG9ja0hlbHBlck1pc3NpbmcnLCBmdW5jdGlvbihjb250ZXh0LCBvcHRpb25zKSB7XG4gICAgbGV0IGludmVyc2UgPSBvcHRpb25zLmludmVyc2UsXG4gICAgICAgIGZuID0gb3B0aW9ucy5mbjtcblxuICAgIGlmIChjb250ZXh0ID09PSB0cnVlKSB7XG4gICAgICByZXR1cm4gZm4odGhpcyk7XG4gICAgfSBlbHNlIGlmIChjb250ZXh0ID09PSBmYWxzZSB8fCBjb250ZXh0ID09IG51bGwpIHtcbiAgICAgIHJldHVybiBpbnZlcnNlKHRoaXMpO1xuICAgIH0gZWxzZSBpZiAoaXNBcnJheShjb250ZXh0KSkge1xuICAgICAgaWYgKGNvbnRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICBpZiAob3B0aW9ucy5pZHMpIHtcbiAgICAgICAgICBvcHRpb25zLmlkcyA9IFtvcHRpb25zLm5hbWVdO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGluc3RhbmNlLmhlbHBlcnMuZWFjaChjb250ZXh0LCBvcHRpb25zKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBpbnZlcnNlKHRoaXMpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAob3B0aW9ucy5kYXRhICYmIG9wdGlvbnMuaWRzKSB7XG4gICAgICAgIGxldCBkYXRhID0gY3JlYXRlRnJhbWUob3B0aW9ucy5kYXRhKTtcbiAgICAgICAgZGF0YS5jb250ZXh0UGF0aCA9IGFwcGVuZENvbnRleHRQYXRoKG9wdGlvbnMuZGF0YS5jb250ZXh0UGF0aCwgb3B0aW9ucy5uYW1lKTtcbiAgICAgICAgb3B0aW9ucyA9IHtkYXRhOiBkYXRhfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZuKGNvbnRleHQsIG9wdGlvbnMpO1xuICAgIH1cbiAgfSk7XG59XG4iLCJpbXBvcnQge2FwcGVuZENvbnRleHRQYXRoLCBibG9ja1BhcmFtcywgY3JlYXRlRnJhbWUsIGlzQXJyYXksIGlzRnVuY3Rpb259IGZyb20gJy4uL3V0aWxzJztcbmltcG9ydCBFeGNlcHRpb24gZnJvbSAnLi4vZXhjZXB0aW9uJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ2VhY2gnLCBmdW5jdGlvbihjb250ZXh0LCBvcHRpb25zKSB7XG4gICAgaWYgKCFvcHRpb25zKSB7XG4gICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdNdXN0IHBhc3MgaXRlcmF0b3IgdG8gI2VhY2gnKTtcbiAgICB9XG5cbiAgICBsZXQgZm4gPSBvcHRpb25zLmZuLFxuICAgICAgICBpbnZlcnNlID0gb3B0aW9ucy5pbnZlcnNlLFxuICAgICAgICBpID0gMCxcbiAgICAgICAgcmV0ID0gJycsXG4gICAgICAgIGRhdGEsXG4gICAgICAgIGNvbnRleHRQYXRoO1xuXG4gICAgaWYgKG9wdGlvbnMuZGF0YSAmJiBvcHRpb25zLmlkcykge1xuICAgICAgY29udGV4dFBhdGggPSBhcHBlbmRDb250ZXh0UGF0aChvcHRpb25zLmRhdGEuY29udGV4dFBhdGgsIG9wdGlvbnMuaWRzWzBdKSArICcuJztcbiAgICB9XG5cbiAgICBpZiAoaXNGdW5jdGlvbihjb250ZXh0KSkgeyBjb250ZXh0ID0gY29udGV4dC5jYWxsKHRoaXMpOyB9XG5cbiAgICBpZiAob3B0aW9ucy5kYXRhKSB7XG4gICAgICBkYXRhID0gY3JlYXRlRnJhbWUob3B0aW9ucy5kYXRhKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBleGVjSXRlcmF0aW9uKGZpZWxkLCBpbmRleCwgbGFzdCkge1xuICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgZGF0YS5rZXkgPSBmaWVsZDtcbiAgICAgICAgZGF0YS5pbmRleCA9IGluZGV4O1xuICAgICAgICBkYXRhLmZpcnN0ID0gaW5kZXggPT09IDA7XG4gICAgICAgIGRhdGEubGFzdCA9ICEhbGFzdDtcblxuICAgICAgICBpZiAoY29udGV4dFBhdGgpIHtcbiAgICAgICAgICBkYXRhLmNvbnRleHRQYXRoID0gY29udGV4dFBhdGggKyBmaWVsZDtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXQgPSByZXQgKyBmbihjb250ZXh0W2ZpZWxkXSwge1xuICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICBibG9ja1BhcmFtczogYmxvY2tQYXJhbXMoW2NvbnRleHRbZmllbGRdLCBmaWVsZF0sIFtjb250ZXh0UGF0aCArIGZpZWxkLCBudWxsXSlcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChjb250ZXh0ICYmIHR5cGVvZiBjb250ZXh0ID09PSAnb2JqZWN0Jykge1xuICAgICAgaWYgKGlzQXJyYXkoY29udGV4dCkpIHtcbiAgICAgICAgZm9yIChsZXQgaiA9IGNvbnRleHQubGVuZ3RoOyBpIDwgajsgaSsrKSB7XG4gICAgICAgICAgaWYgKGkgaW4gY29udGV4dCkge1xuICAgICAgICAgICAgZXhlY0l0ZXJhdGlvbihpLCBpLCBpID09PSBjb250ZXh0Lmxlbmd0aCAtIDEpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV0IHByaW9yS2V5O1xuXG4gICAgICAgIGZvciAobGV0IGtleSBpbiBjb250ZXh0KSB7XG4gICAgICAgICAgaWYgKGNvbnRleHQuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgLy8gV2UncmUgcnVubmluZyB0aGUgaXRlcmF0aW9ucyBvbmUgc3RlcCBvdXQgb2Ygc3luYyBzbyB3ZSBjYW4gZGV0ZWN0XG4gICAgICAgICAgICAvLyB0aGUgbGFzdCBpdGVyYXRpb24gd2l0aG91dCBoYXZlIHRvIHNjYW4gdGhlIG9iamVjdCB0d2ljZSBhbmQgY3JlYXRlXG4gICAgICAgICAgICAvLyBhbiBpdGVybWVkaWF0ZSBrZXlzIGFycmF5LlxuICAgICAgICAgICAgaWYgKHByaW9yS2V5ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgZXhlY0l0ZXJhdGlvbihwcmlvcktleSwgaSAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJpb3JLZXkgPSBrZXk7XG4gICAgICAgICAgICBpKys7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChwcmlvcktleSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgZXhlY0l0ZXJhdGlvbihwcmlvcktleSwgaSAtIDEsIHRydWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGkgPT09IDApIHtcbiAgICAgIHJldCA9IGludmVyc2UodGhpcyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJldDtcbiAgfSk7XG59XG4iLCJpbXBvcnQgRXhjZXB0aW9uIGZyb20gJy4uL2V4Y2VwdGlvbic7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdoZWxwZXJNaXNzaW5nJywgZnVuY3Rpb24oLyogW2FyZ3MsIF1vcHRpb25zICovKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcbiAgICAgIC8vIEEgbWlzc2luZyBmaWVsZCBpbiBhIHt7Zm9vfX0gY29uc3RydWN0LlxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU29tZW9uZSBpcyBhY3R1YWxseSB0cnlpbmcgdG8gY2FsbCBzb21ldGhpbmcsIGJsb3cgdXAuXG4gICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdNaXNzaW5nIGhlbHBlcjogXCInICsgYXJndW1lbnRzW2FyZ3VtZW50cy5sZW5ndGggLSAxXS5uYW1lICsgJ1wiJyk7XG4gICAgfVxuICB9KTtcbn1cbiIsImltcG9ydCB7aXNFbXB0eSwgaXNGdW5jdGlvbn0gZnJvbSAnLi4vdXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihpbnN0YW5jZSkge1xuICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignaWYnLCBmdW5jdGlvbihjb25kaXRpb25hbCwgb3B0aW9ucykge1xuICAgIGlmIChpc0Z1bmN0aW9uKGNvbmRpdGlvbmFsKSkgeyBjb25kaXRpb25hbCA9IGNvbmRpdGlvbmFsLmNhbGwodGhpcyk7IH1cblxuICAgIC8vIERlZmF1bHQgYmVoYXZpb3IgaXMgdG8gcmVuZGVyIHRoZSBwb3NpdGl2ZSBwYXRoIGlmIHRoZSB2YWx1ZSBpcyB0cnV0aHkgYW5kIG5vdCBlbXB0eS5cbiAgICAvLyBUaGUgYGluY2x1ZGVaZXJvYCBvcHRpb24gbWF5IGJlIHNldCB0byB0cmVhdCB0aGUgY29uZHRpb25hbCBhcyBwdXJlbHkgbm90IGVtcHR5IGJhc2VkIG9uIHRoZVxuICAgIC8vIGJlaGF2aW9yIG9mIGlzRW1wdHkuIEVmZmVjdGl2ZWx5IHRoaXMgZGV0ZXJtaW5lcyBpZiAwIGlzIGhhbmRsZWQgYnkgdGhlIHBvc2l0aXZlIHBhdGggb3IgbmVnYXRpdmUuXG4gICAgaWYgKCghb3B0aW9ucy5oYXNoLmluY2x1ZGVaZXJvICYmICFjb25kaXRpb25hbCkgfHwgaXNFbXB0eShjb25kaXRpb25hbCkpIHtcbiAgICAgIHJldHVybiBvcHRpb25zLmludmVyc2UodGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBvcHRpb25zLmZuKHRoaXMpO1xuICAgIH1cbiAgfSk7XG5cbiAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ3VubGVzcycsIGZ1bmN0aW9uKGNvbmRpdGlvbmFsLCBvcHRpb25zKSB7XG4gICAgcmV0dXJuIGluc3RhbmNlLmhlbHBlcnNbJ2lmJ10uY2FsbCh0aGlzLCBjb25kaXRpb25hbCwge2ZuOiBvcHRpb25zLmludmVyc2UsIGludmVyc2U6IG9wdGlvbnMuZm4sIGhhc2g6IG9wdGlvbnMuaGFzaH0pO1xuICB9KTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdsb2cnLCBmdW5jdGlvbigvKiBtZXNzYWdlLCBvcHRpb25zICovKSB7XG4gICAgbGV0IGFyZ3MgPSBbdW5kZWZpbmVkXSxcbiAgICAgICAgb3B0aW9ucyA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICBhcmdzLnB1c2goYXJndW1lbnRzW2ldKTtcbiAgICB9XG5cbiAgICBsZXQgbGV2ZWwgPSAxO1xuICAgIGlmIChvcHRpb25zLmhhc2gubGV2ZWwgIT0gbnVsbCkge1xuICAgICAgbGV2ZWwgPSBvcHRpb25zLmhhc2gubGV2ZWw7XG4gICAgfSBlbHNlIGlmIChvcHRpb25zLmRhdGEgJiYgb3B0aW9ucy5kYXRhLmxldmVsICE9IG51bGwpIHtcbiAgICAgIGxldmVsID0gb3B0aW9ucy5kYXRhLmxldmVsO1xuICAgIH1cbiAgICBhcmdzWzBdID0gbGV2ZWw7XG5cbiAgICBpbnN0YW5jZS5sb2coLi4uIGFyZ3MpO1xuICB9KTtcbn1cbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdsb29rdXAnLCBmdW5jdGlvbihvYmosIGZpZWxkKSB7XG4gICAgcmV0dXJuIG9iaiAmJiBvYmpbZmllbGRdO1xuICB9KTtcbn1cbiIsImltcG9ydCB7YXBwZW5kQ29udGV4dFBhdGgsIGJsb2NrUGFyYW1zLCBjcmVhdGVGcmFtZSwgaXNFbXB0eSwgaXNGdW5jdGlvbn0gZnJvbSAnLi4vdXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihpbnN0YW5jZSkge1xuICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignd2l0aCcsIGZ1bmN0aW9uKGNvbnRleHQsIG9wdGlvbnMpIHtcbiAgICBpZiAoaXNGdW5jdGlvbihjb250ZXh0KSkgeyBjb250ZXh0ID0gY29udGV4dC5jYWxsKHRoaXMpOyB9XG5cbiAgICBsZXQgZm4gPSBvcHRpb25zLmZuO1xuXG4gICAgaWYgKCFpc0VtcHR5KGNvbnRleHQpKSB7XG4gICAgICBsZXQgZGF0YSA9IG9wdGlvbnMuZGF0YTtcbiAgICAgIGlmIChvcHRpb25zLmRhdGEgJiYgb3B0aW9ucy5pZHMpIHtcbiAgICAgICAgZGF0YSA9IGNyZWF0ZUZyYW1lKG9wdGlvbnMuZGF0YSk7XG4gICAgICAgIGRhdGEuY29udGV4dFBhdGggPSBhcHBlbmRDb250ZXh0UGF0aChvcHRpb25zLmRhdGEuY29udGV4dFBhdGgsIG9wdGlvbnMuaWRzWzBdKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGZuKGNvbnRleHQsIHtcbiAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgYmxvY2tQYXJhbXM6IGJsb2NrUGFyYW1zKFtjb250ZXh0XSwgW2RhdGEgJiYgZGF0YS5jb250ZXh0UGF0aF0pXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG9wdGlvbnMuaW52ZXJzZSh0aGlzKTtcbiAgICB9XG4gIH0pO1xufVxuIiwiaW1wb3J0IHtpbmRleE9mfSBmcm9tICcuL3V0aWxzJztcblxubGV0IGxvZ2dlciA9IHtcbiAgbWV0aG9kTWFwOiBbJ2RlYnVnJywgJ2luZm8nLCAnd2FybicsICdlcnJvciddLFxuICBsZXZlbDogJ2luZm8nLFxuXG4gIC8vIE1hcHMgYSBnaXZlbiBsZXZlbCB2YWx1ZSB0byB0aGUgYG1ldGhvZE1hcGAgaW5kZXhlcyBhYm92ZS5cbiAgbG9va3VwTGV2ZWw6IGZ1bmN0aW9uKGxldmVsKSB7XG4gICAgaWYgKHR5cGVvZiBsZXZlbCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGxldCBsZXZlbE1hcCA9IGluZGV4T2YobG9nZ2VyLm1ldGhvZE1hcCwgbGV2ZWwudG9Mb3dlckNhc2UoKSk7XG4gICAgICBpZiAobGV2ZWxNYXAgPj0gMCkge1xuICAgICAgICBsZXZlbCA9IGxldmVsTWFwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbGV2ZWwgPSBwYXJzZUludChsZXZlbCwgMTApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBsZXZlbDtcbiAgfSxcblxuICAvLyBDYW4gYmUgb3ZlcnJpZGRlbiBpbiB0aGUgaG9zdCBlbnZpcm9ubWVudFxuICBsb2c6IGZ1bmN0aW9uKGxldmVsLCAuLi5tZXNzYWdlKSB7XG4gICAgbGV2ZWwgPSBsb2dnZXIubG9va3VwTGV2ZWwobGV2ZWwpO1xuXG4gICAgaWYgKHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJyAmJiBsb2dnZXIubG9va3VwTGV2ZWwobG9nZ2VyLmxldmVsKSA8PSBsZXZlbCkge1xuICAgICAgbGV0IG1ldGhvZCA9IGxvZ2dlci5tZXRob2RNYXBbbGV2ZWxdO1xuICAgICAgaWYgKCFjb25zb2xlW21ldGhvZF0pIHsgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgbWV0aG9kID0gJ2xvZyc7XG4gICAgICB9XG4gICAgICBjb25zb2xlW21ldGhvZF0oLi4ubWVzc2FnZSk7ICAgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29uc29sZVxuICAgIH1cbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgbG9nZ2VyO1xuIiwiLyogZ2xvYmFsIHdpbmRvdyAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oSGFuZGxlYmFycykge1xuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICBsZXQgcm9vdCA9IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogd2luZG93LFxuICAgICAgJEhhbmRsZWJhcnMgPSByb290LkhhbmRsZWJhcnM7XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gIEhhbmRsZWJhcnMubm9Db25mbGljdCA9IGZ1bmN0aW9uKCkge1xuICAgIGlmIChyb290LkhhbmRsZWJhcnMgPT09IEhhbmRsZWJhcnMpIHtcbiAgICAgIHJvb3QuSGFuZGxlYmFycyA9ICRIYW5kbGViYXJzO1xuICAgIH1cbiAgICByZXR1cm4gSGFuZGxlYmFycztcbiAgfTtcbn1cbiIsImltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vdXRpbHMnO1xuaW1wb3J0IEV4Y2VwdGlvbiBmcm9tICcuL2V4Y2VwdGlvbic7XG5pbXBvcnQgeyBDT01QSUxFUl9SRVZJU0lPTiwgUkVWSVNJT05fQ0hBTkdFUywgY3JlYXRlRnJhbWUgfSBmcm9tICcuL2Jhc2UnO1xuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tSZXZpc2lvbihjb21waWxlckluZm8pIHtcbiAgY29uc3QgY29tcGlsZXJSZXZpc2lvbiA9IGNvbXBpbGVySW5mbyAmJiBjb21waWxlckluZm9bMF0gfHwgMSxcbiAgICAgICAgY3VycmVudFJldmlzaW9uID0gQ09NUElMRVJfUkVWSVNJT047XG5cbiAgaWYgKGNvbXBpbGVyUmV2aXNpb24gIT09IGN1cnJlbnRSZXZpc2lvbikge1xuICAgIGlmIChjb21waWxlclJldmlzaW9uIDwgY3VycmVudFJldmlzaW9uKSB7XG4gICAgICBjb25zdCBydW50aW1lVmVyc2lvbnMgPSBSRVZJU0lPTl9DSEFOR0VTW2N1cnJlbnRSZXZpc2lvbl0sXG4gICAgICAgICAgICBjb21waWxlclZlcnNpb25zID0gUkVWSVNJT05fQ0hBTkdFU1tjb21waWxlclJldmlzaW9uXTtcbiAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ1RlbXBsYXRlIHdhcyBwcmVjb21waWxlZCB3aXRoIGFuIG9sZGVyIHZlcnNpb24gb2YgSGFuZGxlYmFycyB0aGFuIHRoZSBjdXJyZW50IHJ1bnRpbWUuICcgK1xuICAgICAgICAgICAgJ1BsZWFzZSB1cGRhdGUgeW91ciBwcmVjb21waWxlciB0byBhIG5ld2VyIHZlcnNpb24gKCcgKyBydW50aW1lVmVyc2lvbnMgKyAnKSBvciBkb3duZ3JhZGUgeW91ciBydW50aW1lIHRvIGFuIG9sZGVyIHZlcnNpb24gKCcgKyBjb21waWxlclZlcnNpb25zICsgJykuJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFVzZSB0aGUgZW1iZWRkZWQgdmVyc2lvbiBpbmZvIHNpbmNlIHRoZSBydW50aW1lIGRvZXNuJ3Qga25vdyBhYm91dCB0aGlzIHJldmlzaW9uIHlldFxuICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignVGVtcGxhdGUgd2FzIHByZWNvbXBpbGVkIHdpdGggYSBuZXdlciB2ZXJzaW9uIG9mIEhhbmRsZWJhcnMgdGhhbiB0aGUgY3VycmVudCBydW50aW1lLiAnICtcbiAgICAgICAgICAgICdQbGVhc2UgdXBkYXRlIHlvdXIgcnVudGltZSB0byBhIG5ld2VyIHZlcnNpb24gKCcgKyBjb21waWxlckluZm9bMV0gKyAnKS4nKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRlbXBsYXRlKHRlbXBsYXRlU3BlYywgZW52KSB7XG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gIGlmICghZW52KSB7XG4gICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignTm8gZW52aXJvbm1lbnQgcGFzc2VkIHRvIHRlbXBsYXRlJyk7XG4gIH1cbiAgaWYgKCF0ZW1wbGF0ZVNwZWMgfHwgIXRlbXBsYXRlU3BlYy5tYWluKSB7XG4gICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignVW5rbm93biB0ZW1wbGF0ZSBvYmplY3Q6ICcgKyB0eXBlb2YgdGVtcGxhdGVTcGVjKTtcbiAgfVxuXG4gIHRlbXBsYXRlU3BlYy5tYWluLmRlY29yYXRvciA9IHRlbXBsYXRlU3BlYy5tYWluX2Q7XG5cbiAgLy8gTm90ZTogVXNpbmcgZW52LlZNIHJlZmVyZW5jZXMgcmF0aGVyIHRoYW4gbG9jYWwgdmFyIHJlZmVyZW5jZXMgdGhyb3VnaG91dCB0aGlzIHNlY3Rpb24gdG8gYWxsb3dcbiAgLy8gZm9yIGV4dGVybmFsIHVzZXJzIHRvIG92ZXJyaWRlIHRoZXNlIGFzIHBzdWVkby1zdXBwb3J0ZWQgQVBJcy5cbiAgZW52LlZNLmNoZWNrUmV2aXNpb24odGVtcGxhdGVTcGVjLmNvbXBpbGVyKTtcblxuICBmdW5jdGlvbiBpbnZva2VQYXJ0aWFsV3JhcHBlcihwYXJ0aWFsLCBjb250ZXh0LCBvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMuaGFzaCkge1xuICAgICAgY29udGV4dCA9IFV0aWxzLmV4dGVuZCh7fSwgY29udGV4dCwgb3B0aW9ucy5oYXNoKTtcbiAgICAgIGlmIChvcHRpb25zLmlkcykge1xuICAgICAgICBvcHRpb25zLmlkc1swXSA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcGFydGlhbCA9IGVudi5WTS5yZXNvbHZlUGFydGlhbC5jYWxsKHRoaXMsIHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpO1xuICAgIGxldCByZXN1bHQgPSBlbnYuVk0uaW52b2tlUGFydGlhbC5jYWxsKHRoaXMsIHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpO1xuXG4gICAgaWYgKHJlc3VsdCA9PSBudWxsICYmIGVudi5jb21waWxlKSB7XG4gICAgICBvcHRpb25zLnBhcnRpYWxzW29wdGlvbnMubmFtZV0gPSBlbnYuY29tcGlsZShwYXJ0aWFsLCB0ZW1wbGF0ZVNwZWMuY29tcGlsZXJPcHRpb25zLCBlbnYpO1xuICAgICAgcmVzdWx0ID0gb3B0aW9ucy5wYXJ0aWFsc1tvcHRpb25zLm5hbWVdKGNvbnRleHQsIG9wdGlvbnMpO1xuICAgIH1cbiAgICBpZiAocmVzdWx0ICE9IG51bGwpIHtcbiAgICAgIGlmIChvcHRpb25zLmluZGVudCkge1xuICAgICAgICBsZXQgbGluZXMgPSByZXN1bHQuc3BsaXQoJ1xcbicpO1xuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGxpbmVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgIGlmICghbGluZXNbaV0gJiYgaSArIDEgPT09IGwpIHtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGxpbmVzW2ldID0gb3B0aW9ucy5pbmRlbnQgKyBsaW5lc1tpXTtcbiAgICAgICAgfVxuICAgICAgICByZXN1bHQgPSBsaW5lcy5qb2luKCdcXG4nKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ1RoZSBwYXJ0aWFsICcgKyBvcHRpb25zLm5hbWUgKyAnIGNvdWxkIG5vdCBiZSBjb21waWxlZCB3aGVuIHJ1bm5pbmcgaW4gcnVudGltZS1vbmx5IG1vZGUnKTtcbiAgICB9XG4gIH1cblxuICAvLyBKdXN0IGFkZCB3YXRlclxuICBsZXQgY29udGFpbmVyID0ge1xuICAgIHN0cmljdDogZnVuY3Rpb24ob2JqLCBuYW1lKSB7XG4gICAgICBpZiAoIShuYW1lIGluIG9iaikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignXCInICsgbmFtZSArICdcIiBub3QgZGVmaW5lZCBpbiAnICsgb2JqKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvYmpbbmFtZV07XG4gICAgfSxcbiAgICBsb29rdXA6IGZ1bmN0aW9uKGRlcHRocywgbmFtZSkge1xuICAgICAgY29uc3QgbGVuID0gZGVwdGhzLmxlbmd0aDtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgaWYgKGRlcHRoc1tpXSAmJiBkZXB0aHNbaV1bbmFtZV0gIT0gbnVsbCkge1xuICAgICAgICAgIHJldHVybiBkZXB0aHNbaV1bbmFtZV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIGxhbWJkYTogZnVuY3Rpb24oY3VycmVudCwgY29udGV4dCkge1xuICAgICAgcmV0dXJuIHR5cGVvZiBjdXJyZW50ID09PSAnZnVuY3Rpb24nID8gY3VycmVudC5jYWxsKGNvbnRleHQpIDogY3VycmVudDtcbiAgICB9LFxuXG4gICAgZXNjYXBlRXhwcmVzc2lvbjogVXRpbHMuZXNjYXBlRXhwcmVzc2lvbixcbiAgICBpbnZva2VQYXJ0aWFsOiBpbnZva2VQYXJ0aWFsV3JhcHBlcixcblxuICAgIGZuOiBmdW5jdGlvbihpKSB7XG4gICAgICBsZXQgcmV0ID0gdGVtcGxhdGVTcGVjW2ldO1xuICAgICAgcmV0LmRlY29yYXRvciA9IHRlbXBsYXRlU3BlY1tpICsgJ19kJ107XG4gICAgICByZXR1cm4gcmV0O1xuICAgIH0sXG5cbiAgICBwcm9ncmFtczogW10sXG4gICAgcHJvZ3JhbTogZnVuY3Rpb24oaSwgZGF0YSwgZGVjbGFyZWRCbG9ja1BhcmFtcywgYmxvY2tQYXJhbXMsIGRlcHRocykge1xuICAgICAgbGV0IHByb2dyYW1XcmFwcGVyID0gdGhpcy5wcm9ncmFtc1tpXSxcbiAgICAgICAgICBmbiA9IHRoaXMuZm4oaSk7XG4gICAgICBpZiAoZGF0YSB8fCBkZXB0aHMgfHwgYmxvY2tQYXJhbXMgfHwgZGVjbGFyZWRCbG9ja1BhcmFtcykge1xuICAgICAgICBwcm9ncmFtV3JhcHBlciA9IHdyYXBQcm9ncmFtKHRoaXMsIGksIGZuLCBkYXRhLCBkZWNsYXJlZEJsb2NrUGFyYW1zLCBibG9ja1BhcmFtcywgZGVwdGhzKTtcbiAgICAgIH0gZWxzZSBpZiAoIXByb2dyYW1XcmFwcGVyKSB7XG4gICAgICAgIHByb2dyYW1XcmFwcGVyID0gdGhpcy5wcm9ncmFtc1tpXSA9IHdyYXBQcm9ncmFtKHRoaXMsIGksIGZuKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwcm9ncmFtV3JhcHBlcjtcbiAgICB9LFxuXG4gICAgZGF0YTogZnVuY3Rpb24odmFsdWUsIGRlcHRoKSB7XG4gICAgICB3aGlsZSAodmFsdWUgJiYgZGVwdGgtLSkge1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLl9wYXJlbnQ7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfSxcbiAgICBtZXJnZTogZnVuY3Rpb24ocGFyYW0sIGNvbW1vbikge1xuICAgICAgbGV0IG9iaiA9IHBhcmFtIHx8IGNvbW1vbjtcblxuICAgICAgaWYgKHBhcmFtICYmIGNvbW1vbiAmJiAocGFyYW0gIT09IGNvbW1vbikpIHtcbiAgICAgICAgb2JqID0gVXRpbHMuZXh0ZW5kKHt9LCBjb21tb24sIHBhcmFtKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIG9iajtcbiAgICB9LFxuXG4gICAgbm9vcDogZW52LlZNLm5vb3AsXG4gICAgY29tcGlsZXJJbmZvOiB0ZW1wbGF0ZVNwZWMuY29tcGlsZXJcbiAgfTtcblxuICBmdW5jdGlvbiByZXQoY29udGV4dCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgbGV0IGRhdGEgPSBvcHRpb25zLmRhdGE7XG5cbiAgICByZXQuX3NldHVwKG9wdGlvbnMpO1xuICAgIGlmICghb3B0aW9ucy5wYXJ0aWFsICYmIHRlbXBsYXRlU3BlYy51c2VEYXRhKSB7XG4gICAgICBkYXRhID0gaW5pdERhdGEoY29udGV4dCwgZGF0YSk7XG4gICAgfVxuICAgIGxldCBkZXB0aHMsXG4gICAgICAgIGJsb2NrUGFyYW1zID0gdGVtcGxhdGVTcGVjLnVzZUJsb2NrUGFyYW1zID8gW10gOiB1bmRlZmluZWQ7XG4gICAgaWYgKHRlbXBsYXRlU3BlYy51c2VEZXB0aHMpIHtcbiAgICAgIGlmIChvcHRpb25zLmRlcHRocykge1xuICAgICAgICBkZXB0aHMgPSBjb250ZXh0ICE9PSBvcHRpb25zLmRlcHRoc1swXSA/IFtjb250ZXh0XS5jb25jYXQob3B0aW9ucy5kZXB0aHMpIDogb3B0aW9ucy5kZXB0aHM7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkZXB0aHMgPSBbY29udGV4dF07XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbWFpbihjb250ZXh0LyosIG9wdGlvbnMqLykge1xuICAgICAgcmV0dXJuICcnICsgdGVtcGxhdGVTcGVjLm1haW4oY29udGFpbmVyLCBjb250ZXh0LCBjb250YWluZXIuaGVscGVycywgY29udGFpbmVyLnBhcnRpYWxzLCBkYXRhLCBibG9ja1BhcmFtcywgZGVwdGhzKTtcbiAgICB9XG4gICAgbWFpbiA9IGV4ZWN1dGVEZWNvcmF0b3JzKHRlbXBsYXRlU3BlYy5tYWluLCBtYWluLCBjb250YWluZXIsIG9wdGlvbnMuZGVwdGhzIHx8IFtdLCBkYXRhLCBibG9ja1BhcmFtcyk7XG4gICAgcmV0dXJuIG1haW4oY29udGV4dCwgb3B0aW9ucyk7XG4gIH1cbiAgcmV0LmlzVG9wID0gdHJ1ZTtcblxuICByZXQuX3NldHVwID0gZnVuY3Rpb24ob3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucy5wYXJ0aWFsKSB7XG4gICAgICBjb250YWluZXIuaGVscGVycyA9IGNvbnRhaW5lci5tZXJnZShvcHRpb25zLmhlbHBlcnMsIGVudi5oZWxwZXJzKTtcblxuICAgICAgaWYgKHRlbXBsYXRlU3BlYy51c2VQYXJ0aWFsKSB7XG4gICAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IGNvbnRhaW5lci5tZXJnZShvcHRpb25zLnBhcnRpYWxzLCBlbnYucGFydGlhbHMpO1xuICAgICAgfVxuICAgICAgaWYgKHRlbXBsYXRlU3BlYy51c2VQYXJ0aWFsIHx8IHRlbXBsYXRlU3BlYy51c2VEZWNvcmF0b3JzKSB7XG4gICAgICAgIGNvbnRhaW5lci5kZWNvcmF0b3JzID0gY29udGFpbmVyLm1lcmdlKG9wdGlvbnMuZGVjb3JhdG9ycywgZW52LmRlY29yYXRvcnMpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb250YWluZXIuaGVscGVycyA9IG9wdGlvbnMuaGVscGVycztcbiAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IG9wdGlvbnMucGFydGlhbHM7XG4gICAgICBjb250YWluZXIuZGVjb3JhdG9ycyA9IG9wdGlvbnMuZGVjb3JhdG9ycztcbiAgICB9XG4gIH07XG5cbiAgcmV0Ll9jaGlsZCA9IGZ1bmN0aW9uKGksIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpIHtcbiAgICBpZiAodGVtcGxhdGVTcGVjLnVzZUJsb2NrUGFyYW1zICYmICFibG9ja1BhcmFtcykge1xuICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignbXVzdCBwYXNzIGJsb2NrIHBhcmFtcycpO1xuICAgIH1cbiAgICBpZiAodGVtcGxhdGVTcGVjLnVzZURlcHRocyAmJiAhZGVwdGhzKSB7XG4gICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdtdXN0IHBhc3MgcGFyZW50IGRlcHRocycpO1xuICAgIH1cblxuICAgIHJldHVybiB3cmFwUHJvZ3JhbShjb250YWluZXIsIGksIHRlbXBsYXRlU3BlY1tpXSwgZGF0YSwgMCwgYmxvY2tQYXJhbXMsIGRlcHRocyk7XG4gIH07XG4gIHJldHVybiByZXQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB3cmFwUHJvZ3JhbShjb250YWluZXIsIGksIGZuLCBkYXRhLCBkZWNsYXJlZEJsb2NrUGFyYW1zLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7XG4gIGZ1bmN0aW9uIHByb2coY29udGV4dCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgbGV0IGN1cnJlbnREZXB0aHMgPSBkZXB0aHM7XG4gICAgaWYgKGRlcHRocyAmJiBjb250ZXh0ICE9PSBkZXB0aHNbMF0pIHtcbiAgICAgIGN1cnJlbnREZXB0aHMgPSBbY29udGV4dF0uY29uY2F0KGRlcHRocyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZuKGNvbnRhaW5lcixcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgY29udGFpbmVyLmhlbHBlcnMsIGNvbnRhaW5lci5wYXJ0aWFscyxcbiAgICAgICAgb3B0aW9ucy5kYXRhIHx8IGRhdGEsXG4gICAgICAgIGJsb2NrUGFyYW1zICYmIFtvcHRpb25zLmJsb2NrUGFyYW1zXS5jb25jYXQoYmxvY2tQYXJhbXMpLFxuICAgICAgICBjdXJyZW50RGVwdGhzKTtcbiAgfVxuXG4gIHByb2cgPSBleGVjdXRlRGVjb3JhdG9ycyhmbiwgcHJvZywgY29udGFpbmVyLCBkZXB0aHMsIGRhdGEsIGJsb2NrUGFyYW1zKTtcblxuICBwcm9nLnByb2dyYW0gPSBpO1xuICBwcm9nLmRlcHRoID0gZGVwdGhzID8gZGVwdGhzLmxlbmd0aCA6IDA7XG4gIHByb2cuYmxvY2tQYXJhbXMgPSBkZWNsYXJlZEJsb2NrUGFyYW1zIHx8IDA7XG4gIHJldHVybiBwcm9nO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZVBhcnRpYWwocGFydGlhbCwgY29udGV4dCwgb3B0aW9ucykge1xuICBpZiAoIXBhcnRpYWwpIHtcbiAgICBpZiAob3B0aW9ucy5uYW1lID09PSAnQHBhcnRpYWwtYmxvY2snKSB7XG4gICAgICBwYXJ0aWFsID0gb3B0aW9ucy5kYXRhWydwYXJ0aWFsLWJsb2NrJ107XG4gICAgfSBlbHNlIHtcbiAgICAgIHBhcnRpYWwgPSBvcHRpb25zLnBhcnRpYWxzW29wdGlvbnMubmFtZV07XG4gICAgfVxuICB9IGVsc2UgaWYgKCFwYXJ0aWFsLmNhbGwgJiYgIW9wdGlvbnMubmFtZSkge1xuICAgIC8vIFRoaXMgaXMgYSBkeW5hbWljIHBhcnRpYWwgdGhhdCByZXR1cm5lZCBhIHN0cmluZ1xuICAgIG9wdGlvbnMubmFtZSA9IHBhcnRpYWw7XG4gICAgcGFydGlhbCA9IG9wdGlvbnMucGFydGlhbHNbcGFydGlhbF07XG4gIH1cbiAgcmV0dXJuIHBhcnRpYWw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnZva2VQYXJ0aWFsKHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpIHtcbiAgb3B0aW9ucy5wYXJ0aWFsID0gdHJ1ZTtcbiAgaWYgKG9wdGlvbnMuaWRzKSB7XG4gICAgb3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoID0gb3B0aW9ucy5pZHNbMF0gfHwgb3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoO1xuICB9XG5cbiAgbGV0IHBhcnRpYWxCbG9jaztcbiAgaWYgKG9wdGlvbnMuZm4gJiYgb3B0aW9ucy5mbiAhPT0gbm9vcCkge1xuICAgIG9wdGlvbnMuZGF0YSA9IGNyZWF0ZUZyYW1lKG9wdGlvbnMuZGF0YSk7XG4gICAgcGFydGlhbEJsb2NrID0gb3B0aW9ucy5kYXRhWydwYXJ0aWFsLWJsb2NrJ10gPSBvcHRpb25zLmZuO1xuXG4gICAgaWYgKHBhcnRpYWxCbG9jay5wYXJ0aWFscykge1xuICAgICAgb3B0aW9ucy5wYXJ0aWFscyA9IFV0aWxzLmV4dGVuZCh7fSwgb3B0aW9ucy5wYXJ0aWFscywgcGFydGlhbEJsb2NrLnBhcnRpYWxzKTtcbiAgICB9XG4gIH1cblxuICBpZiAocGFydGlhbCA9PT0gdW5kZWZpbmVkICYmIHBhcnRpYWxCbG9jaykge1xuICAgIHBhcnRpYWwgPSBwYXJ0aWFsQmxvY2s7XG4gIH1cblxuICBpZiAocGFydGlhbCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignVGhlIHBhcnRpYWwgJyArIG9wdGlvbnMubmFtZSArICcgY291bGQgbm90IGJlIGZvdW5kJyk7XG4gIH0gZWxzZSBpZiAocGFydGlhbCBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG4gICAgcmV0dXJuIHBhcnRpYWwoY29udGV4dCwgb3B0aW9ucyk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vb3AoKSB7IHJldHVybiAnJzsgfVxuXG5mdW5jdGlvbiBpbml0RGF0YShjb250ZXh0LCBkYXRhKSB7XG4gIGlmICghZGF0YSB8fCAhKCdyb290JyBpbiBkYXRhKSkge1xuICAgIGRhdGEgPSBkYXRhID8gY3JlYXRlRnJhbWUoZGF0YSkgOiB7fTtcbiAgICBkYXRhLnJvb3QgPSBjb250ZXh0O1xuICB9XG4gIHJldHVybiBkYXRhO1xufVxuXG5mdW5jdGlvbiBleGVjdXRlRGVjb3JhdG9ycyhmbiwgcHJvZywgY29udGFpbmVyLCBkZXB0aHMsIGRhdGEsIGJsb2NrUGFyYW1zKSB7XG4gIGlmIChmbi5kZWNvcmF0b3IpIHtcbiAgICBsZXQgcHJvcHMgPSB7fTtcbiAgICBwcm9nID0gZm4uZGVjb3JhdG9yKHByb2csIHByb3BzLCBjb250YWluZXIsIGRlcHRocyAmJiBkZXB0aHNbMF0sIGRhdGEsIGJsb2NrUGFyYW1zLCBkZXB0aHMpO1xuICAgIFV0aWxzLmV4dGVuZChwcm9nLCBwcm9wcyk7XG4gIH1cbiAgcmV0dXJuIHByb2c7XG59XG4iLCIvLyBCdWlsZCBvdXQgb3VyIGJhc2ljIFNhZmVTdHJpbmcgdHlwZVxuZnVuY3Rpb24gU2FmZVN0cmluZyhzdHJpbmcpIHtcbiAgdGhpcy5zdHJpbmcgPSBzdHJpbmc7XG59XG5cblNhZmVTdHJpbmcucHJvdG90eXBlLnRvU3RyaW5nID0gU2FmZVN0cmluZy5wcm90b3R5cGUudG9IVE1MID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiAnJyArIHRoaXMuc3RyaW5nO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgU2FmZVN0cmluZztcbiIsImNvbnN0IGVzY2FwZSA9IHtcbiAgJyYnOiAnJmFtcDsnLFxuICAnPCc6ICcmbHQ7JyxcbiAgJz4nOiAnJmd0OycsXG4gICdcIic6ICcmcXVvdDsnLFxuICBcIidcIjogJyYjeDI3OycsXG4gICdgJzogJyYjeDYwOycsXG4gICc9JzogJyYjeDNEOydcbn07XG5cbmNvbnN0IGJhZENoYXJzID0gL1smPD5cIidgPV0vZyxcbiAgICAgIHBvc3NpYmxlID0gL1smPD5cIidgPV0vO1xuXG5mdW5jdGlvbiBlc2NhcGVDaGFyKGNocikge1xuICByZXR1cm4gZXNjYXBlW2Nocl07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBleHRlbmQob2JqLyogLCAuLi5zb3VyY2UgKi8pIHtcbiAgZm9yIChsZXQgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICBmb3IgKGxldCBrZXkgaW4gYXJndW1lbnRzW2ldKSB7XG4gICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGFyZ3VtZW50c1tpXSwga2V5KSkge1xuICAgICAgICBvYmpba2V5XSA9IGFyZ3VtZW50c1tpXVtrZXldO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvYmo7XG59XG5cbmV4cG9ydCBsZXQgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG4vLyBTb3VyY2VkIGZyb20gbG9kYXNoXG4vLyBodHRwczovL2dpdGh1Yi5jb20vYmVzdGllanMvbG9kYXNoL2Jsb2IvbWFzdGVyL0xJQ0VOU0UudHh0XG4vKiBlc2xpbnQtZGlzYWJsZSBmdW5jLXN0eWxlICovXG5sZXQgaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbic7XG59O1xuLy8gZmFsbGJhY2sgZm9yIG9sZGVyIHZlcnNpb25zIG9mIENocm9tZSBhbmQgU2FmYXJpXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuaWYgKGlzRnVuY3Rpb24oL3gvKSkge1xuICBpc0Z1bmN0aW9uID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nICYmIHRvU3RyaW5nLmNhbGwodmFsdWUpID09PSAnW29iamVjdCBGdW5jdGlvbl0nO1xuICB9O1xufVxuZXhwb3J0IHtpc0Z1bmN0aW9ufTtcbi8qIGVzbGludC1lbmFibGUgZnVuYy1zdHlsZSAqL1xuXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuZXhwb3J0IGNvbnN0IGlzQXJyYXkgPSBBcnJheS5pc0FycmF5IHx8IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIHJldHVybiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JykgPyB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gJ1tvYmplY3QgQXJyYXldJyA6IGZhbHNlO1xufTtcblxuLy8gT2xkZXIgSUUgdmVyc2lvbnMgZG8gbm90IGRpcmVjdGx5IHN1cHBvcnQgaW5kZXhPZiBzbyB3ZSBtdXN0IGltcGxlbWVudCBvdXIgb3duLCBzYWRseS5cbmV4cG9ydCBmdW5jdGlvbiBpbmRleE9mKGFycmF5LCB2YWx1ZSkge1xuICBmb3IgKGxldCBpID0gMCwgbGVuID0gYXJyYXkubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICBpZiAoYXJyYXlbaV0gPT09IHZhbHVlKSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIC0xO1xufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVFeHByZXNzaW9uKHN0cmluZykge1xuICBpZiAodHlwZW9mIHN0cmluZyAhPT0gJ3N0cmluZycpIHtcbiAgICAvLyBkb24ndCBlc2NhcGUgU2FmZVN0cmluZ3MsIHNpbmNlIHRoZXkncmUgYWxyZWFkeSBzYWZlXG4gICAgaWYgKHN0cmluZyAmJiBzdHJpbmcudG9IVE1MKSB7XG4gICAgICByZXR1cm4gc3RyaW5nLnRvSFRNTCgpO1xuICAgIH0gZWxzZSBpZiAoc3RyaW5nID09IG51bGwpIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9IGVsc2UgaWYgKCFzdHJpbmcpIHtcbiAgICAgIHJldHVybiBzdHJpbmcgKyAnJztcbiAgICB9XG5cbiAgICAvLyBGb3JjZSBhIHN0cmluZyBjb252ZXJzaW9uIGFzIHRoaXMgd2lsbCBiZSBkb25lIGJ5IHRoZSBhcHBlbmQgcmVnYXJkbGVzcyBhbmRcbiAgICAvLyB0aGUgcmVnZXggdGVzdCB3aWxsIGRvIHRoaXMgdHJhbnNwYXJlbnRseSBiZWhpbmQgdGhlIHNjZW5lcywgY2F1c2luZyBpc3N1ZXMgaWZcbiAgICAvLyBhbiBvYmplY3QncyB0byBzdHJpbmcgaGFzIGVzY2FwZWQgY2hhcmFjdGVycyBpbiBpdC5cbiAgICBzdHJpbmcgPSAnJyArIHN0cmluZztcbiAgfVxuXG4gIGlmICghcG9zc2libGUudGVzdChzdHJpbmcpKSB7IHJldHVybiBzdHJpbmc7IH1cbiAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKGJhZENoYXJzLCBlc2NhcGVDaGFyKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzRW1wdHkodmFsdWUpIHtcbiAgaWYgKCF2YWx1ZSAmJiB2YWx1ZSAhPT0gMCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9IGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpICYmIHZhbHVlLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRnJhbWUob2JqZWN0KSB7XG4gIGxldCBmcmFtZSA9IGV4dGVuZCh7fSwgb2JqZWN0KTtcbiAgZnJhbWUuX3BhcmVudCA9IG9iamVjdDtcbiAgcmV0dXJuIGZyYW1lO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYmxvY2tQYXJhbXMocGFyYW1zLCBpZHMpIHtcbiAgcGFyYW1zLnBhdGggPSBpZHM7XG4gIHJldHVybiBwYXJhbXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhcHBlbmRDb250ZXh0UGF0aChjb250ZXh0UGF0aCwgaWQpIHtcbiAgcmV0dXJuIChjb250ZXh0UGF0aCA/IGNvbnRleHRQYXRoICsgJy4nIDogJycpICsgaWQ7XG59XG4iLCIvLyBDcmVhdGUgYSBzaW1wbGUgcGF0aCBhbGlhcyB0byBhbGxvdyBicm93c2VyaWZ5IHRvIHJlc29sdmVcbi8vIHRoZSBydW50aW1lIG9uIGEgc3VwcG9ydGVkIHBhdGguXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vZGlzdC9janMvaGFuZGxlYmFycy5ydW50aW1lJylbJ2RlZmF1bHQnXTtcbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImhhbmRsZWJhcnMvcnVudGltZVwiKVtcImRlZmF1bHRcIl07XG4iLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuIiwiKGZ1bmN0aW9uIChnbG9iYWwsIHVuZGVmaW5lZCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaWYgKGdsb2JhbC5zZXRJbW1lZGlhdGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBuZXh0SGFuZGxlID0gMTsgLy8gU3BlYyBzYXlzIGdyZWF0ZXIgdGhhbiB6ZXJvXG4gICAgdmFyIHRhc2tzQnlIYW5kbGUgPSB7fTtcbiAgICB2YXIgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7XG4gICAgdmFyIGRvYyA9IGdsb2JhbC5kb2N1bWVudDtcbiAgICB2YXIgcmVnaXN0ZXJJbW1lZGlhdGU7XG5cbiAgICBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoY2FsbGJhY2spIHtcbiAgICAgIC8vIENhbGxiYWNrIGNhbiBlaXRoZXIgYmUgYSBmdW5jdGlvbiBvciBhIHN0cmluZ1xuICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGNhbGxiYWNrID0gbmV3IEZ1bmN0aW9uKFwiXCIgKyBjYWxsYmFjayk7XG4gICAgICB9XG4gICAgICAvLyBDb3B5IGZ1bmN0aW9uIGFyZ3VtZW50c1xuICAgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpICsgMV07XG4gICAgICB9XG4gICAgICAvLyBTdG9yZSBhbmQgcmVnaXN0ZXIgdGhlIHRhc2tcbiAgICAgIHZhciB0YXNrID0geyBjYWxsYmFjazogY2FsbGJhY2ssIGFyZ3M6IGFyZ3MgfTtcbiAgICAgIHRhc2tzQnlIYW5kbGVbbmV4dEhhbmRsZV0gPSB0YXNrO1xuICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUobmV4dEhhbmRsZSk7XG4gICAgICByZXR1cm4gbmV4dEhhbmRsZSsrO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGhhbmRsZSkge1xuICAgICAgICBkZWxldGUgdGFza3NCeUhhbmRsZVtoYW5kbGVdO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJ1bih0YXNrKSB7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IHRhc2suY2FsbGJhY2s7XG4gICAgICAgIHZhciBhcmdzID0gdGFzay5hcmdzO1xuICAgICAgICBzd2l0Y2ggKGFyZ3MubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSwgYXJnc1sxXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHVuZGVmaW5lZCwgYXJncyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJ1bklmUHJlc2VudChoYW5kbGUpIHtcbiAgICAgICAgLy8gRnJvbSB0aGUgc3BlYzogXCJXYWl0IHVudGlsIGFueSBpbnZvY2F0aW9ucyBvZiB0aGlzIGFsZ29yaXRobSBzdGFydGVkIGJlZm9yZSB0aGlzIG9uZSBoYXZlIGNvbXBsZXRlZC5cIlxuICAgICAgICAvLyBTbyBpZiB3ZSdyZSBjdXJyZW50bHkgcnVubmluZyBhIHRhc2ssIHdlJ2xsIG5lZWQgdG8gZGVsYXkgdGhpcyBpbnZvY2F0aW9uLlxuICAgICAgICBpZiAoY3VycmVudGx5UnVubmluZ0FUYXNrKSB7XG4gICAgICAgICAgICAvLyBEZWxheSBieSBkb2luZyBhIHNldFRpbWVvdXQuIHNldEltbWVkaWF0ZSB3YXMgdHJpZWQgaW5zdGVhZCwgYnV0IGluIEZpcmVmb3ggNyBpdCBnZW5lcmF0ZWQgYVxuICAgICAgICAgICAgLy8gXCJ0b28gbXVjaCByZWN1cnNpb25cIiBlcnJvci5cbiAgICAgICAgICAgIHNldFRpbWVvdXQocnVuSWZQcmVzZW50LCAwLCBoYW5kbGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHRhc2sgPSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07XG4gICAgICAgICAgICBpZiAodGFzaykge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IHRydWU7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcnVuKHRhc2spO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW1tZWRpYXRlKGhhbmRsZSk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc3RhbGxOZXh0VGlja0ltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7IHJ1bklmUHJlc2VudChoYW5kbGUpOyB9KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYW5Vc2VQb3N0TWVzc2FnZSgpIHtcbiAgICAgICAgLy8gVGhlIHRlc3QgYWdhaW5zdCBgaW1wb3J0U2NyaXB0c2AgcHJldmVudHMgdGhpcyBpbXBsZW1lbnRhdGlvbiBmcm9tIGJlaW5nIGluc3RhbGxlZCBpbnNpZGUgYSB3ZWIgd29ya2VyLFxuICAgICAgICAvLyB3aGVyZSBgZ2xvYmFsLnBvc3RNZXNzYWdlYCBtZWFucyBzb21ldGhpbmcgY29tcGxldGVseSBkaWZmZXJlbnQgYW5kIGNhbid0IGJlIHVzZWQgZm9yIHRoaXMgcHVycG9zZS5cbiAgICAgICAgaWYgKGdsb2JhbC5wb3N0TWVzc2FnZSAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpIHtcbiAgICAgICAgICAgIHZhciBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBvbGRPbk1lc3NhZ2UgPSBnbG9iYWwub25tZXNzYWdlO1xuICAgICAgICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXMgPSBmYWxzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBnbG9iYWwucG9zdE1lc3NhZ2UoXCJcIiwgXCIqXCIpO1xuICAgICAgICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IG9sZE9uTWVzc2FnZTtcbiAgICAgICAgICAgIHJldHVybiBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5zdGFsbFBvc3RNZXNzYWdlSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIC8vIEluc3RhbGxzIGFuIGV2ZW50IGhhbmRsZXIgb24gYGdsb2JhbGAgZm9yIHRoZSBgbWVzc2FnZWAgZXZlbnQ6IHNlZVxuICAgICAgICAvLyAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0RPTS93aW5kb3cucG9zdE1lc3NhZ2VcbiAgICAgICAgLy8gKiBodHRwOi8vd3d3LndoYXR3Zy5vcmcvc3BlY3Mvd2ViLWFwcHMvY3VycmVudC13b3JrL211bHRpcGFnZS9jb21tcy5odG1sI2Nyb3NzRG9jdW1lbnRNZXNzYWdlc1xuXG4gICAgICAgIHZhciBtZXNzYWdlUHJlZml4ID0gXCJzZXRJbW1lZGlhdGUkXCIgKyBNYXRoLnJhbmRvbSgpICsgXCIkXCI7XG4gICAgICAgIHZhciBvbkdsb2JhbE1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gZ2xvYmFsICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIGV2ZW50LmRhdGEgPT09IFwic3RyaW5nXCIgJiZcbiAgICAgICAgICAgICAgICBldmVudC5kYXRhLmluZGV4T2YobWVzc2FnZVByZWZpeCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICBydW5JZlByZXNlbnQoK2V2ZW50LmRhdGEuc2xpY2UobWVzc2FnZVByZWZpeC5sZW5ndGgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBvbkdsb2JhbE1lc3NhZ2UsIGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdsb2JhbC5hdHRhY2hFdmVudChcIm9ubWVzc2FnZVwiLCBvbkdsb2JhbE1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShtZXNzYWdlUHJlZml4ICsgaGFuZGxlLCBcIipcIik7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5zdGFsbE1lc3NhZ2VDaGFubmVsSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHZhciBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XG4gICAgICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciBoYW5kbGUgPSBldmVudC5kYXRhO1xuICAgICAgICAgICAgcnVuSWZQcmVzZW50KGhhbmRsZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoaGFuZGxlKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsUmVhZHlTdGF0ZUNoYW5nZUltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICB2YXIgaHRtbCA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgYSA8c2NyaXB0PiBlbGVtZW50OyBpdHMgcmVhZHlzdGF0ZWNoYW5nZSBldmVudCB3aWxsIGJlIGZpcmVkIGFzeW5jaHJvbm91c2x5IG9uY2UgaXQgaXMgaW5zZXJ0ZWRcbiAgICAgICAgICAgIC8vIGludG8gdGhlIGRvY3VtZW50LiBEbyBzbywgdGh1cyBxdWV1aW5nIHVwIHRoZSB0YXNrLiBSZW1lbWJlciB0byBjbGVhbiB1cCBvbmNlIGl0J3MgYmVlbiBjYWxsZWQuXG4gICAgICAgICAgICB2YXIgc2NyaXB0ID0gZG9jLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG4gICAgICAgICAgICBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJ1bklmUHJlc2VudChoYW5kbGUpO1xuICAgICAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcbiAgICAgICAgICAgICAgICBzY3JpcHQgPSBudWxsO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsU2V0VGltZW91dEltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChydW5JZlByZXNlbnQsIDAsIGhhbmRsZSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gSWYgc3VwcG9ydGVkLCB3ZSBzaG91bGQgYXR0YWNoIHRvIHRoZSBwcm90b3R5cGUgb2YgZ2xvYmFsLCBzaW5jZSB0aGF0IGlzIHdoZXJlIHNldFRpbWVvdXQgZXQgYWwuIGxpdmUuXG4gICAgdmFyIGF0dGFjaFRvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mICYmIE9iamVjdC5nZXRQcm90b3R5cGVPZihnbG9iYWwpO1xuICAgIGF0dGFjaFRvID0gYXR0YWNoVG8gJiYgYXR0YWNoVG8uc2V0VGltZW91dCA/IGF0dGFjaFRvIDogZ2xvYmFsO1xuXG4gICAgLy8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBlLmcuIGJyb3dzZXJpZnkgZW52aXJvbm1lbnRzLlxuICAgIGlmICh7fS50b1N0cmluZy5jYWxsKGdsb2JhbC5wcm9jZXNzKSA9PT0gXCJbb2JqZWN0IHByb2Nlc3NdXCIpIHtcbiAgICAgICAgLy8gRm9yIE5vZGUuanMgYmVmb3JlIDAuOVxuICAgICAgICBpbnN0YWxsTmV4dFRpY2tJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgfSBlbHNlIGlmIChjYW5Vc2VQb3N0TWVzc2FnZSgpKSB7XG4gICAgICAgIC8vIEZvciBub24tSUUxMCBtb2Rlcm4gYnJvd3NlcnNcbiAgICAgICAgaW5zdGFsbFBvc3RNZXNzYWdlSW1wbGVtZW50YXRpb24oKTtcblxuICAgIH0gZWxzZSBpZiAoZ2xvYmFsLk1lc3NhZ2VDaGFubmVsKSB7XG4gICAgICAgIC8vIEZvciB3ZWIgd29ya2Vycywgd2hlcmUgc3VwcG9ydGVkXG4gICAgICAgIGluc3RhbGxNZXNzYWdlQ2hhbm5lbEltcGxlbWVudGF0aW9uKCk7XG5cbiAgICB9IGVsc2UgaWYgKGRvYyAmJiBcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiIGluIGRvYy5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpKSB7XG4gICAgICAgIC8vIEZvciBJRSA24oCTOFxuICAgICAgICBpbnN0YWxsUmVhZHlTdGF0ZUNoYW5nZUltcGxlbWVudGF0aW9uKCk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGb3Igb2xkZXIgYnJvd3NlcnNcbiAgICAgICAgaW5zdGFsbFNldFRpbWVvdXRJbXBsZW1lbnRhdGlvbigpO1xuICAgIH1cblxuICAgIGF0dGFjaFRvLnNldEltbWVkaWF0ZSA9IHNldEltbWVkaWF0ZTtcbiAgICBhdHRhY2hUby5jbGVhckltbWVkaWF0ZSA9IGNsZWFySW1tZWRpYXRlO1xufSh0eXBlb2Ygc2VsZiA9PT0gXCJ1bmRlZmluZWRcIiA/IHR5cGVvZiBnbG9iYWwgPT09IFwidW5kZWZpbmVkXCIgPyB0aGlzIDogZ2xvYmFsIDogc2VsZikpO1xuIiwidmFyIHRyaW0gPSByZXF1aXJlKCcuL3RyaW0nKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkYXNoZXJpemUoc3RyKSB7XG4gIHJldHVybiB0cmltKHN0cikucmVwbGFjZSgvKFtBLVpdKS9nLCAnLSQxJykucmVwbGFjZSgvWy1fXFxzXSsvZywgJy0nKS50b0xvd2VyQ2FzZSgpO1xufTtcbiIsInZhciBlc2NhcGVSZWdFeHAgPSByZXF1aXJlKCcuL2VzY2FwZVJlZ0V4cCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRlZmF1bHRUb1doaXRlU3BhY2UoY2hhcmFjdGVycykge1xuICBpZiAoY2hhcmFjdGVycyA9PSBudWxsKVxuICAgIHJldHVybiAnXFxcXHMnO1xuICBlbHNlIGlmIChjaGFyYWN0ZXJzLnNvdXJjZSlcbiAgICByZXR1cm4gY2hhcmFjdGVycy5zb3VyY2U7XG4gIGVsc2VcbiAgICByZXR1cm4gJ1snICsgZXNjYXBlUmVnRXhwKGNoYXJhY3RlcnMpICsgJ10nO1xufTtcbiIsInZhciBtYWtlU3RyaW5nID0gcmVxdWlyZSgnLi9tYWtlU3RyaW5nJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZXNjYXBlUmVnRXhwKHN0cikge1xuICByZXR1cm4gbWFrZVN0cmluZyhzdHIpLnJlcGxhY2UoLyhbLiorP149IToke30oKXxbXFxdXFwvXFxcXF0pL2csICdcXFxcJDEnKTtcbn07XG4iLCIvKipcbiAqIEVuc3VyZSBzb21lIG9iamVjdCBpcyBhIGNvZXJjZWQgdG8gYSBzdHJpbmdcbiAqKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbWFrZVN0cmluZyhvYmplY3QpIHtcbiAgaWYgKG9iamVjdCA9PSBudWxsKSByZXR1cm4gJyc7XG4gIHJldHVybiAnJyArIG9iamVjdDtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0clJlcGVhdChzdHIsIHF0eSl7XG4gIGlmIChxdHkgPCAxKSByZXR1cm4gJyc7XG4gIHZhciByZXN1bHQgPSAnJztcbiAgd2hpbGUgKHF0eSA+IDApIHtcbiAgICBpZiAocXR5ICYgMSkgcmVzdWx0ICs9IHN0cjtcbiAgICBxdHkgPj49IDEsIHN0ciArPSBzdHI7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG4iLCJ2YXIgcGFkID0gcmVxdWlyZSgnLi9wYWQnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBscGFkKHN0ciwgbGVuZ3RoLCBwYWRTdHIpIHtcbiAgcmV0dXJuIHBhZChzdHIsIGxlbmd0aCwgcGFkU3RyKTtcbn07XG4iLCJ2YXIgbWFrZVN0cmluZyA9IHJlcXVpcmUoJy4vaGVscGVyL21ha2VTdHJpbmcnKTtcbnZhciBzdHJSZXBlYXQgPSByZXF1aXJlKCcuL2hlbHBlci9zdHJSZXBlYXQnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBwYWQoc3RyLCBsZW5ndGgsIHBhZFN0ciwgdHlwZSkge1xuICBzdHIgPSBtYWtlU3RyaW5nKHN0cik7XG4gIGxlbmd0aCA9IH5+bGVuZ3RoO1xuXG4gIHZhciBwYWRsZW4gPSAwO1xuXG4gIGlmICghcGFkU3RyKVxuICAgIHBhZFN0ciA9ICcgJztcbiAgZWxzZSBpZiAocGFkU3RyLmxlbmd0aCA+IDEpXG4gICAgcGFkU3RyID0gcGFkU3RyLmNoYXJBdCgwKTtcblxuICBzd2l0Y2ggKHR5cGUpIHtcbiAgY2FzZSAncmlnaHQnOlxuICAgIHBhZGxlbiA9IGxlbmd0aCAtIHN0ci5sZW5ndGg7XG4gICAgcmV0dXJuIHN0ciArIHN0clJlcGVhdChwYWRTdHIsIHBhZGxlbik7XG4gIGNhc2UgJ2JvdGgnOlxuICAgIHBhZGxlbiA9IGxlbmd0aCAtIHN0ci5sZW5ndGg7XG4gICAgcmV0dXJuIHN0clJlcGVhdChwYWRTdHIsIE1hdGguY2VpbChwYWRsZW4gLyAyKSkgKyBzdHIgKyBzdHJSZXBlYXQocGFkU3RyLCBNYXRoLmZsb29yKHBhZGxlbiAvIDIpKTtcbiAgZGVmYXVsdDogLy8gJ2xlZnQnXG4gICAgcGFkbGVuID0gbGVuZ3RoIC0gc3RyLmxlbmd0aDtcbiAgICByZXR1cm4gc3RyUmVwZWF0KHBhZFN0ciwgcGFkbGVuKSArIHN0cjtcbiAgfVxufTtcbiIsInZhciBwYWQgPSByZXF1aXJlKCcuL3BhZCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHJwYWQoc3RyLCBsZW5ndGgsIHBhZFN0cikge1xuICByZXR1cm4gcGFkKHN0ciwgbGVuZ3RoLCBwYWRTdHIsICdyaWdodCcpO1xufTtcbiIsInZhciBtYWtlU3RyaW5nID0gcmVxdWlyZSgnLi9oZWxwZXIvbWFrZVN0cmluZycpO1xudmFyIGRlZmF1bHRUb1doaXRlU3BhY2UgPSByZXF1aXJlKCcuL2hlbHBlci9kZWZhdWx0VG9XaGl0ZVNwYWNlJyk7XG52YXIgbmF0aXZlVHJpbSA9IFN0cmluZy5wcm90b3R5cGUudHJpbTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB0cmltKHN0ciwgY2hhcmFjdGVycykge1xuICBzdHIgPSBtYWtlU3RyaW5nKHN0cik7XG4gIGlmICghY2hhcmFjdGVycyAmJiBuYXRpdmVUcmltKSByZXR1cm4gbmF0aXZlVHJpbS5jYWxsKHN0cik7XG4gIGNoYXJhY3RlcnMgPSBkZWZhdWx0VG9XaGl0ZVNwYWNlKGNoYXJhY3RlcnMpO1xuICByZXR1cm4gc3RyLnJlcGxhY2UobmV3IFJlZ0V4cCgnXicgKyBjaGFyYWN0ZXJzICsgJyt8JyArIGNoYXJhY3RlcnMgKyAnKyQnLCAnZycpLCAnJyk7XG59O1xuIiwiLyoqXG4vKiBAbW9kdWxlIGFwcC9BcHBcbi8qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnNvbGUuaW5mbyhcIlBvcnRmb2xpbyBBcHAgc3RhcnRlZFwiKTtcblxuaWYgKCFERUJVRykge1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIGZ1bmN0aW9uKGV2KSB7XG5cdFx0Y29uc29sZS5lcnJvcihcIlVuY2F1Z2h0IEVycm9yXCIsIGV2KTtcblx0fSk7XG59XG5cbnJlcXVpcmUoXCJNb2Rlcm5penJcIik7XG5yZXF1aXJlKFwiZXM2LXByb21pc2VcIikucG9seWZpbGwoKTtcbnJlcXVpcmUoXCJjbGFzc2xpc3QtcG9seWZpbGxcIik7XG5yZXF1aXJlKFwicmFmLXBvbHlmaWxsXCIpO1xucmVxdWlyZShcIm1hdGNoZXMtcG9seWZpbGxcIik7XG5yZXF1aXJlKFwiZnVsbHNjcmVlbi1wb2x5ZmlsbFwiKTtcbnJlcXVpcmUoXCJtYXRoLXNpZ24tcG9seWZpbGxcIik7XG5yZXF1aXJlKFwic2V0aW1tZWRpYXRlXCIpO1xuXG5yZXF1aXJlKFwiYmFja2JvbmVcIikuJCA9IHJlcXVpcmUoXCJiYWNrYm9uZS5uYXRpdmVcIik7XG5yZXF1aXJlKFwiYmFja2JvbmUuYmFieXNpdHRlclwiKTtcbnJlcXVpcmUoXCJCYWNrYm9uZS5NdXRhdG9yc1wiKTtcbnJlcXVpcmUoXCJoYW1tZXJqc1wiKTtcblxuLy8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2KSB7XG4vLyBcdGNvbnNvbGUubG9nKFwiJXM6W2V2ZW50ICVzXVwiLCBldi50YXJnZXQsIGV2LnR5cGUpO1xuLy8gfSk7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbihldikge1xuXHRjb25zb2xlLmxvZyhcIiVzOltldmVudCAlc11cIiwgZXYudGFyZ2V0LCBldi50eXBlKTtcblxuXHQvLyBwcm9jZXNzIGJvb3RzdHJhcCBkYXRhLCBsZXQgZXJyb3JzIGdvIHVwIHRoZSBzdGFja1xuXHR0cnkge1xuXHRcdHJlcXVpcmUoXCJhcHAvbW9kZWwvaGVscGVyL2Jvb3RzdHJhcFwiKSh3aW5kb3cuYm9vdHN0cmFwKTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0dmFyIGVsID0gZG9jdW1lbnQuc2VsZWN0UXVlcnkoXCIuYXBwXCIpO1xuXHRcdGVsLmNsYXNzTGlzdC5yZW1vdmUoXCJhcHAtaW5pdGlhbFwiKTtcblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwiYXBwLWVycm9yXCIpO1xuXHRcdHRocm93IG5ldyBFcnJvcihcImJvb3RzdHJhcCBkYXRhIGVycm9yIChcIiArIGVyci5tZXNzYWdlICsgXCIpXCIsIGVyci5maWxlTmFtZSwgZXJyLmxpbmVOdW1iZXIpO1xuXHR9IGZpbmFsbHkgeyAvLyBkZXRlbGUgZ2xvYmFsIHZhclxuXHRcdGRlbGV0ZSB3aW5kb3cuYm9vdHN0cmFwO1xuXHR9XG5cblx0cmVxdWlyZShcImFwcC92aWV3L3RlbXBsYXRlL19oZWxwZXJzXCIpO1xuXHQvLyByZXF1aXJlKFwiYXBwL3ZpZXcvdGVtcGxhdGUvX3BhcnRpYWxzXCIpO1xuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9oZWxwZXIvY3JlYXRlQ29sb3JTdHlsZVNoZWV0fSAqL1xuXHRyZXF1aXJlKFwiYXBwL3ZpZXcvaGVscGVyL2NyZWF0ZUNvbG9yU3R5bGVTaGVldFwiKS5jYWxsKCk7XG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvQXBwVmlld30gKi9cblx0dmFyIEFwcFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvQXBwVmlld1wiKTtcblxuXHQvKiogQHR5cGUge21vZHVsZTp3ZWJmb250bG9hZGVyfSAqL1xuXHR2YXIgV2ViRm9udCA9IHJlcXVpcmUoXCJ3ZWJmb250bG9hZGVyXCIpO1xuXHRXZWJGb250LmxvYWQoe1xuXHRcdGFzeW5jOiB0cnVlLFxuXHRcdGNsYXNzZXM6IGZhbHNlLFxuXHRcdGN1c3RvbToge1xuXHRcdFx0ZmFtaWxpZXM6IFtcblx0XHRcdFx0Ly8gXCJGcmFua2xpbiBHb3RoaWMgRlM6bjQsbjdcIixcblx0XHRcdFx0XCJGcmFua2xpbiBHb3RoaWMgRlM6bjQsaTQsbjcsaTdcIixcblx0XHRcdFx0XCJGb2xpb0ZpZ3VyZXM6bjRcIixcblx0XHRcdF0sXG5cdFx0XHR0ZXN0U3RyaW5nczoge1xuXHRcdFx0XHRcIkZvbGlvRmlndXJlc1wiOiBcImhtc1wiXG5cdFx0XHR9LFxuXHRcdH0sXG5cdFx0YWN0aXZlOiBmdW5jdGlvbigpIHtcblx0XHRcdGNvbnNvbGUuaW5mbyhcIldlYkZvbnQ6OmFjdGl2ZVwiKTtcblx0XHRcdC8vIEFwcFZpZXcuZ2V0SW5zdGFuY2UoKTtcblx0XHR9LFxuXHRcdGZvbnRhY3RpdmU6IGZ1bmN0aW9uKGZhbWlseU5hbWUsIHZhcmlhbnRGdmQpIHtcblx0XHRcdGNvbnNvbGUuaW5mbyhcIldlYkZvbnQ6OmZvbnRhY3RpdmUgJyVzJyAoJXMpXCIsIGZhbWlseU5hbWUsIHZhcmlhbnRGdmQpO1xuXHRcdH0sXG5cdFx0aW5hY3RpdmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiV2ViRm9udDo6aW5hY3RpdmVcIik7XG5cdFx0XHQvLyBBcHBWaWV3LmdldEluc3RhbmNlKCk7XG5cdFx0fSxcblx0XHRmb250aW5hY3RpdmU6IGZ1bmN0aW9uKGZhbWlseU5hbWUsIHZhcmlhbnRGdmQpIHtcblx0XHRcdGNvbnNvbGUud2FybihcIldlYkZvbnQ6OmZvbnRpbmFjdGl2ZSAnJXMnICglcylcIiwgZmFtaWx5TmFtZSwgdmFyaWFudEZ2ZCk7XG5cdFx0fSxcblx0XHQvLyBsb2FkaW5nOiBmdW5jdGlvbigpIHtcblx0XHQvLyBcdGNvbnNvbGUubG9nKFwiV2ViRm9udDo6bG9hZGluZ1wiKTtcblx0XHQvLyB9LFxuXHRcdC8vIGZvbnRsb2FkaW5nOiBmdW5jdGlvbihmYW1pbHlOYW1lLCB2YXJpYW50RGVzYykge1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCJXZWJGb250Ojpmb250bG9hZGluZ1wiLCBmYW1pbHlOYW1lLCBKU09OLnN0cmluZ2lmeSh2YXJpYW50RGVzYywgbnVsbCwgXCIgXCIpKTtcblx0XHQvLyB9LFxuXHR9KTtcblx0QXBwVmlldy5nZXRJbnN0YW5jZSgpO1xufSk7XG5cblxuaWYgKERFQlVHKSB7XG5cdC8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG5cdC8vIHZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG5cblx0Ly8gdmFyIGlzRkYgPSAvRmlyZWZveC8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XG5cdC8vIHZhciBpc0lPUyA9IC9pUGFkfGlQaG9uZS8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XG5cdC8qXG5cdGlmICgvRmlyZWZveC8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcblx0XHRjb25zb2xlLnByZWZpeCA9IFwiIyBcIjtcblx0XHR2YXIgc2hpZnQgPSBbXS5zaGlmdDtcblx0XHR2YXIgbG9nV3JhcEZuID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAodHlwZW9mIGFyZ3VtZW50c1sxXSA9PSBcInN0cmluZ1wiKSBhcmd1bWVudHNbMV0gPSBjb25zb2xlLnByZWZpeCArIGFyZ3VtZW50c1sxXTtcblx0XHRcdHJldHVybiBzaGlmdC5hcHBseShhcmd1bWVudHMpLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7XG5cdFx0fTtcblx0XHRjb25zb2xlLmdyb3VwID0gXy53cmFwKGNvbnNvbGUuZ3JvdXAsIGxvZ1dyYXBGbik7XG5cdFx0Y29uc29sZS5sb2cgPSBfLndyYXAoY29uc29sZS5sb2csIGxvZ1dyYXBGbik7XG5cdFx0Y29uc29sZS5pbmZvID0gXy53cmFwKGNvbnNvbGUuaW5mbywgbG9nV3JhcEZuKTtcblx0XHRjb25zb2xlLndhcm4gPSBfLndyYXAoY29uc29sZS53YXJuLCBsb2dXcmFwRm4pO1xuXHRcdGNvbnNvbGUuZXJyb3IgPSBfLndyYXAoY29uc29sZS5lcnJvciwgbG9nV3JhcEZuKTtcblx0fVxuXHQqL1xuXHQvKlxuXHR2YXIgc2F2ZUxvZ3MgPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgbG9nV3JhcEZuID0gZnVuY3Rpb24obmFtZSwgZm4sIG1zZykge1xuXHRcdFx0ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKFxuXHRcdFx0XHRkb2N1bWVudC5jcmVhdGVDb21tZW50KFwiW1wiICsgbmFtZSArIFwiXSBcIiArIG1zZykpO1xuXHRcdH07XG5cdFx0Y29uc29sZS5ncm91cCA9IF8ud3JhcChjb25zb2xlLmdyb3VwLCBfLnBhcnRpYWwobG9nV3JhcEZuLCBcImdyb3VwXCIpKTtcblx0XHRjb25zb2xlLmxvZyA9IF8ud3JhcChjb25zb2xlLmxvZywgXy5wYXJ0aWFsKGxvZ1dyYXBGbiwgXCJsb2dcIikpO1xuXHRcdGNvbnNvbGUuaW5mbyA9IF8ud3JhcChjb25zb2xlLmluZm8sIF8ucGFydGlhbChsb2dXcmFwRm4sIFwiaW5mb1wiKSk7XG5cdFx0Y29uc29sZS53YXJuID0gXy53cmFwKGNvbnNvbGUud2FybiwgXy5wYXJ0aWFsKGxvZ1dyYXBGbiwgXCJ3YXJuXCIpKTtcblx0XHRjb25zb2xlLmVycm9yID0gXy53cmFwKGNvbnNvbGUuZXJyb3IsIF8ucGFydGlhbChsb2dXcmFwRm4sIFwiZXJyb3JcIikpO1xuXHR9O1xuXHQqL1xuXG5cdC8vIGhhbmRsZSBlcnJvciBldmVudHMgb24gc29tZSBwbGF0Zm9ybXMgYW5kIHByb2R1Y3Rpb25cblx0Lypcblx0aWYgKGlzSU9TKSB7XG5cdFx0Ly8gc2F2ZUxvZ3MoKTtcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzKSxcblx0XHRcdFx0ZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxuXHRcdFx0XHRodG1sID0gXCJcIjtcblx0XHRcdF8uZXh0ZW5kKGVsLnN0eWxlLCB7XG5cdFx0XHRcdGZvbnRmYW1pbHk6IFwibW9ub3NwYWNlXCIsXG5cdFx0XHRcdGRpc3BsYXk6IFwiYmxvY2tcIixcblx0XHRcdFx0cG9zaXRpb246IFwiYWJzb2x1dGVcIixcblx0XHRcdFx0ekluZGV4OiBcIjk5OVwiLFxuXHRcdFx0XHRiYWNrZ3JvdW5kQ29sb3I6IFwid2hpdGVcIixcblx0XHRcdFx0Y29sb3I6IFwiYmxhY2tcIixcblx0XHRcdFx0d2lkdGg6IFwiY2FsYygxMDAlIC0gM2VtKVwiLFxuXHRcdFx0XHRib3R0b206IFwiMFwiLFxuXHRcdFx0XHRtYXJnaW46IFwiMWVtIDEuNWVtXCIsXG5cdFx0XHRcdHBhZGRpbmc6IFwiMWVtIDEuNWVtXCIsXG5cdFx0XHRcdG91dGxpbmU6IFwiMC41ZW0gc29saWQgcmVkXCIsXG5cdFx0XHRcdG91dGxpbmVPZmZzZXQ6IFwiMC41ZW1cIixcblx0XHRcdFx0Ym94U2l6aW5nOiBcImJvcmRlci1ib3hcIixcblx0XHRcdFx0b3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG5cdFx0XHR9KTtcblx0XHRcdGh0bWwgKz0gXCI8cHJlPjxiPmxvY2F0aW9uOjxiPiBcIiArIHdpbmRvdy5sb2NhdGlvbiArIFwiPC9wcmU+XCI7XG5cdFx0XHRodG1sICs9IFwiPHByZT48Yj5ldmVudDo8Yj4gXCIgKyBKU09OLnN0cmluZ2lmeShhcmdzLnNoaWZ0KCksIG51bGwsIFwiIFwiKSArIFwiPC9wcmU+XCI7XG5cdFx0XHRpZiAoYXJncy5sZW5ndGgpIGh0bWwgKz0gXCI8cHJlPjxiPnJlc3Q6PGI+IFwiICsgSlNPTi5zdHJpbmdpZnkoYXJncywgbnVsbCwgXCIgXCIpICsgXCI8L3ByZT5cIjtcblx0XHRcdGVsLmlubmVySFRNTCA9IGh0bWw7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsKTtcblx0XHR9KTtcblx0fSovXG59IiwiLyoqXG4vKiBAbW9kdWxlIGFwcC9jb250cm9sL0NvbnRyb2xsZXJcbi8qL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xudmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9UeXBlQ29sbGVjdGlvbn0gKi9cbi8vIHZhciB0eXBlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9UeXBlQ29sbGVjdGlvblwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9ufSAqL1xuLy8gdmFyIGtleXdvcmRzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9uXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb259ICovXG52YXIgYXJ0aWNsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb25cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9ufSAqL1xudmFyIGJ1bmRsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvblwiKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcbi8qIFN0YXRpYyBwcml2YXRlXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvQ29udHJvbGxlcn1cbi8qL1xudmFyIENvbnRyb2xsZXIgPSBCYWNrYm9uZS5Sb3V0ZXIuZXh0ZW5kKHtcblxuXHQvLyAvKiogQG92ZXJyaWRlICovXG5cdC8vIHJvdXRlczoge30sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cblx0XHRpZiAoREVCVUcpIHtcblx0XHRcdHRoaXMuX3JvdXRlTmFtZXMgPSBbXTtcblx0XHRcdHRoaXMucm91dGUgPSBmdW5jdGlvbihyb3V0ZSwgbmFtZSwgY2FsbGJhY2spIHtcblx0XHRcdFx0dGhpcy5fcm91dGVOYW1lcy5wdXNoKF8uaXNTdHJpbmcobmFtZSkgPyBuYW1lIDogJycpO1xuXHRcdFx0XHRyZXR1cm4gQmFja2JvbmUuUm91dGVyLnByb3RvdHlwZS5yb3V0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0fTtcblx0XHRcdHRoaXMub24oXCJyb3V0ZVwiLCBmdW5jdGlvbihyb3V0ZU5hbWUsIGFyZ3MpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCJjb250cm9sbGVyOltyb3V0ZV0gJXMgWyVzXVwiLCByb3V0ZU5hbWUsIGFyZ3Muam9pbigpKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8qXG5cdFx0ICogUHJlZml4ZWQgYXJ0aWNsZSByZWdleHA6IC9eYXJ0aWNsZSg/OlxcLyhbXlxcL10rKSlcXC8/JC9cblx0XHQgKiBTaW5nbGUgYnVuZGxlIHJlZ2V4cDogL15idW5kbGVzKD86XFwvKFteXFwvXSspKD86XFwvKFxcZCspKT8pP1xcLz8kL1xuXHRcdCAqL1xuXHRcdHRoaXMucm91dGUoLyguKikvLFxuXHRcdFx0XCJub3Rmb3VuZFwiLCB0aGlzLnRvTm90Rm91bmQpO1xuXHRcdHRoaXMucm91dGUoL14oW2Etel1bYS16MC05XFwtXSopXFwvPyQvLFxuXHRcdFx0XCJhcnRpY2xlLWl0ZW1cIiwgdGhpcy50b0FydGljbGVJdGVtKTtcblx0XHR0aGlzLnJvdXRlKC9eKD86YnVuZGxlcyk/XFwvPyQvLFxuXHRcdFx0XCJyb290XCIsIHRoaXMudG9Sb290KTtcblx0XHQvLyB0aGlzLnJvdXRlKC9eYnVuZGxlc1xcLz8kLyxcblx0XHQvLyBcdFwiYnVuZGxlLWxpc3RcIiwgdGhpcy50b0J1bmRsZUxpc3QpO1xuXHRcdHRoaXMucm91dGUoL15idW5kbGVzXFwvKFteXFwvXSspXFwvPyQvLFxuXHRcdFx0XCJidW5kbGUtaXRlbVwiLCB0aGlzLnRvQnVuZGxlSXRlbSk7XG5cdFx0dGhpcy5yb3V0ZSgvXmJ1bmRsZXNcXC8oW15cXC9dKylcXC8oXFxkKylcXC8/JC8sXG5cdFx0XHRcIm1lZGlhLWl0ZW1cIiwgdGhpcy50b01lZGlhSXRlbSk7XG5cblx0XHRpZiAoREVCVUcpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6OmluaXRpYWxpemUgcm91dGVzOiAlb1wiLCBcImNvbnRyb2xsZXJcIiwgdGhpcy5fcm91dGVOYW1lcyk7XG5cdFx0fVxuXHR9LFxuXG5cblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogSlMgdG8gVVJMOiBwdWJsaWMgY29tbWFuZCBtZXRob2RzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHNlbGVjdE1lZGlhOiBmdW5jdGlvbihtZWRpYSkge1xuXHRcdHRoaXMuX2dvVG9Mb2NhdGlvbihtZWRpYS5nZXQoXCJidW5kbGVcIiksIG1lZGlhKTtcblx0fSxcblxuXHRzZWxlY3RCdW5kbGU6IGZ1bmN0aW9uKGJ1bmRsZSkge1xuXHRcdHRoaXMuX2dvVG9Mb2NhdGlvbihidW5kbGUpO1xuXHR9LFxuXG5cdGRlc2VsZWN0TWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX2dvVG9Mb2NhdGlvbihidW5kbGVzLnNlbGVjdGVkKTtcblx0fSxcblxuXHRkZXNlbGVjdEJ1bmRsZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5fZ29Ub0xvY2F0aW9uKCk7XG5cdH0sXG5cblx0c2VsZWN0QXJ0aWNsZTogZnVuY3Rpb24oYXJ0aWNsZSkge1xuXHRcdHRoaXMubmF2aWdhdGUoYXJ0aWNsZS5nZXQoXCJoYW5kbGVcIiksIHsgdHJpZ2dlcjogdHJ1ZSB9KTtcblx0fSxcblxuXHRkZXNlbGVjdEFydGljbGU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMubmF2aWdhdGUoXCJcIiwgeyB0cmlnZ2VyOiB0cnVlIH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBKUyB0byBVUkw6IHByaXZhdGUgaGVscGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogVXBkYXRlIGxvY2F0aW9uIHdoZW4gbmF2aWdhdGlvbiBoYXBwZW5zIGludGVybmFsbHkgKi9cblx0LypfdXBkYXRlTG9jYXRpb246IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBidW5kbGUsIG1lZGlhO1xuXHRcdGJ1bmRsZSA9IGJ1bmRsZXMuc2VsZWN0ZWQ7XG5cdFx0aWYgKGJ1bmRsZSkge1xuXHRcdFx0bWVkaWEgPSBidW5kbGUuZ2V0KFwibWVkaWFcIikuc2VsZWN0ZWQ7XG5cdFx0fVxuXHRcdHRoaXMubmF2aWdhdGUodGhpcy5fZ2V0TG9jYXRpb24oYnVuZGxlLCBtZWRpYSksIHtcblx0XHRcdHRyaWdnZXI6IGZhbHNlXG5cdFx0fSk7XG5cdH0sKi9cblxuXHRfZ2V0TG9jYXRpb246IGZ1bmN0aW9uKGJ1bmRsZSwgbWVkaWEpIHtcblx0XHR2YXIgbWVkaWFJbmRleCwgbG9jYXRpb24gPSBbXTtcblx0XHRpZiAoYnVuZGxlKSB7XG5cdFx0XHRsb2NhdGlvbi5wdXNoKFwiYnVuZGxlc1wiKTtcblx0XHRcdGxvY2F0aW9uLnB1c2goYnVuZGxlLmdldChcImhhbmRsZVwiKSk7XG5cdFx0XHRpZiAobWVkaWEpIHtcblx0XHRcdFx0bWVkaWFJbmRleCA9IGJ1bmRsZS5nZXQoXCJtZWRpYVwiKS5pbmRleE9mKG1lZGlhKTtcblx0XHRcdFx0aWYgKG1lZGlhSW5kZXggPj0gMCkge1xuXHRcdFx0XHRcdGxvY2F0aW9uLnB1c2gobWVkaWFJbmRleCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0Ly8gbG9jYXRpb24ucHVzaChcIlwiKTtcblx0XHRyZXR1cm4gbG9jYXRpb24uam9pbihcIi9cIik7XG5cdH0sXG5cblx0X2dvVG9Mb2NhdGlvbjogZnVuY3Rpb24oYnVuZGxlLCBtZWRpYSkge1xuXHRcdHRoaXMubmF2aWdhdGUodGhpcy5fZ2V0TG9jYXRpb24oYnVuZGxlLCBtZWRpYSksIHtcblx0XHRcdHRyaWdnZXI6IHRydWVcblx0XHR9KTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBVUkwgdG8gSlM6IHJvdXRlciBoYW5kbGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHR0b1Jvb3Q6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMudHJpZ2dlcihcImNoYW5nZTpiZWZvcmVcIik7XG5cdFx0aWYgKGJ1bmRsZXMuc2VsZWN0ZWQpIHtcblx0XHRcdC8vIGJ1bmRsZXMuc2VsZWN0ZWQuZ2V0KFwibWVkaWFcIikuZGVzZWxlY3QoKTtcblx0XHRcdGJ1bmRsZXMuZGVzZWxlY3QoKTtcblx0XHR9XG5cdFx0Ly8ga2V5d29yZHMuZGVzZWxlY3QoKTtcblx0XHRhcnRpY2xlcy5kZXNlbGVjdCgpO1xuXHRcdHRoaXMudHJpZ2dlcihcImNoYW5nZTphZnRlclwiKTtcblx0fSxcblxuXHR0b05vdEZvdW5kOiBmdW5jdGlvbihzbHVnKSB7XG5cdFx0Y29uc29sZS5pbmZvKFwicm91dGU6Wyo6JXNdXCIsIHNsdWcpO1xuXHR9LFxuXG5cdC8vIHRvQnVuZGxlTGlzdDogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dGhpcy5uYXZpZ2F0ZShcIlwiLCB7XG5cdC8vIFx0XHR0cmlnZ2VyOiB0cnVlLFxuXHQvLyBcdFx0cmVwbGFjZTogdHJ1ZVxuXHQvLyBcdH0pO1xuXHQvLyB9LFxuXG5cdHRvQnVuZGxlSXRlbTogZnVuY3Rpb24oYnVuZGxlSGFuZGxlKSB7XG5cdFx0dmFyIGJ1bmRsZSA9IGJ1bmRsZXMuZmluZFdoZXJlKHtcblx0XHRcdGhhbmRsZTogYnVuZGxlSGFuZGxlXG5cdFx0fSk7XG5cdFx0aWYgKCFidW5kbGUpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIGJ1bmRsZSB3aXRoIGhhbmRsZSBcXFwiXCIgKyBidW5kbGVIYW5kbGUgKyBcIlxcXCJcIik7XG5cdFx0fVxuXHRcdHRoaXMuX2NoYW5nZVNlbGVjdGlvbihidW5kbGUpO1xuXHR9LFxuXG5cdHRvTWVkaWFJdGVtOiBmdW5jdGlvbihidW5kbGVIYW5kbGUsIG1lZGlhSW5kZXgpIHtcblx0XHR2YXIgYnVuZGxlLCBtZWRpYTtcblx0XHQvLyBpZiAoYnVuZGxlSGFuZGxlKSB7XG5cdFx0YnVuZGxlID0gYnVuZGxlcy5maW5kV2hlcmUoeyBoYW5kbGU6IGJ1bmRsZUhhbmRsZSB9KTtcblx0XHRpZiAoIWJ1bmRsZSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiTm8gYnVuZGxlIHdpdGggaGFuZGxlIFxcXCJcIiArIGJ1bmRsZUhhbmRsZSArIFwiXFxcIiBmb3VuZFwiKTtcblx0XHR9XG5cdFx0Ly8gaWYgKG1lZGlhSW5kZXgpIHtcblx0XHRtZWRpYSA9IGJ1bmRsZS5nZXQoXCJtZWRpYVwiKS5hdChtZWRpYUluZGV4KTtcblx0XHRpZiAoIW1lZGlhKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJObyBtZWRpYSBhdCBpbmRleCBcIiArIG1lZGlhSW5kZXggKyBcIiBpbiBidW5kbGUgd2l0aCBoYW5kbGUgXFxcIlwiICsgYnVuZGxlSGFuZGxlICsgXCJcXFwiIGZvdW5kXCIpO1xuXHRcdH1cblx0XHQvLyB9XG5cdFx0Ly8gfVxuXHRcdHRoaXMuX2NoYW5nZVNlbGVjdGlvbihidW5kbGUsIG1lZGlhKTtcblx0fSxcblxuXHR0b0FydGljbGVJdGVtOiBmdW5jdGlvbihhcnRpY2xlSGFuZGxlKSB7XG5cdFx0dmFyIGFydGljbGUgPSBhcnRpY2xlcy5maW5kV2hlcmUoeyBoYW5kbGU6IGFydGljbGVIYW5kbGUgfSk7XG5cdFx0aWYgKCFhcnRpY2xlKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBhcnRpY2xlIHdpdGggaGFuZGxlIFxcXCJcIiArIGFydGljbGVIYW5kbGUgKyBcIlxcXCJcIik7XG5cdFx0fVxuXHRcdHRoaXMudHJpZ2dlcihcImNoYW5nZTpiZWZvcmVcIiwgYXJ0aWNsZSk7XG5cdFx0YnVuZGxlcy5kZXNlbGVjdCgpO1xuXHRcdGFydGljbGVzLnNlbGVjdChhcnRpY2xlKTtcblx0XHR0aGlzLnRyaWdnZXIoXCJjaGFuZ2U6YWZ0ZXJcIiwgYXJ0aWNsZSk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBVUkwgdG8gSlM6IHByaXZhdGUgaGVscGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Lypcblx0LyogTk9URTogU2VsZWN0aW9uIG9yZGVyXG5cdC8qIC0gQXBwbHkgbWVkaWEgc2VsZWN0aW9uIHRvICppbmNvbWluZyBidW5kbGUqLCBhcyBub3QgdG8gdHJpZ2dlclxuXHQvKlx0dW5uZWNjZXNhcnkgZXZlbnRzIG9uIGFuIG91dGdvaW5nIGJ1bmRsZS4gT3V0Z29pbmcgYnVuZGxlIG1lZGlhIHNlbGVjdGlvblxuXHQvKlx0cmVtYWlucyB1bnRvdWNoZWQuXG5cdC8qIC0gQXBwbHkgbWVkaWEgc2VsZWN0aW9uICpiZWZvcmUqIHNlbGVjdGluZyB0aGUgaW5jb21pbmcgYnVuZGxlLiBWaWV3c1xuXHQvKlx0bm9ybWFsbHkgbGlzdGVuIHRvIHRoZSBzZWxlY3RlZCBidW5kbGUgb25seSwgc28gaWYgdGhlIGJ1bmRsZSBpcyBjaGFuZ2luZyxcblx0LypcdHRoZXkgd2lsbCBub3QgYmUgbGlzdGVuaW5nIHRvIG1lZGlhIHNlbGVjdGlvbiBjaGFuZ2VzIHlldC5cblx0LyovXG5cdF9jaGFuZ2VTZWxlY3Rpb246IGZ1bmN0aW9uKGJ1bmRsZSwgbWVkaWEpIHtcblx0XHR2YXIgbGFzdEJ1bmRsZSwgbGFzdE1lZGlhO1xuXHRcdGlmIChidW5kbGUgPT09IHZvaWQgMCkgYnVuZGxlID0gbnVsbDtcblx0XHRpZiAobWVkaWEgPT09IHZvaWQgMCkgbWVkaWEgPSBudWxsO1xuXG5cdFx0bGFzdEJ1bmRsZSA9IGJ1bmRsZXMuc2VsZWN0ZWQ7XG5cdFx0bGFzdE1lZGlhID0gbGFzdEJ1bmRsZSA/IGxhc3RCdW5kbGUuZ2V0KFwibWVkaWFcIikuc2VsZWN0ZWQgOiBudWxsO1xuXHRcdGNvbnNvbGUubG9nKFwiY29udHJvbGxlcjo6X2NoYW5nZVNlbGVjdGlvbiBidW5kbGU6WyVzIC0+ICVzXSBtZWRpYTpbJXMgLT4gJXNdXCIsXG5cdFx0XHQobGFzdEJ1bmRsZSA/IGxhc3RCdW5kbGUuY2lkIDogbGFzdEJ1bmRsZSksIChidW5kbGUgPyBidW5kbGUuY2lkIDogYnVuZGxlKSxcblx0XHRcdChsYXN0TWVkaWEgPyBsYXN0TWVkaWEuY2lkIDogbGFzdE1lZGlhKSwgKG1lZGlhID8gbWVkaWEuY2lkIDogbWVkaWEpXG5cdFx0KTtcblxuXHRcdGlmICghYXJ0aWNsZXMuc2VsZWN0ZWQgJiYgKGxhc3RCdW5kbGUgPT09IGJ1bmRsZSkgJiYgKGxhc3RNZWRpYSA9PT0gbWVkaWEpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy50cmlnZ2VyKFwiY2hhbmdlOmJlZm9yZVwiLCBidW5kbGUsIG1lZGlhKTtcblx0XHRidW5kbGUgJiYgYnVuZGxlLmdldChcIm1lZGlhXCIpLnNlbGVjdChtZWRpYSk7XG5cdFx0YnVuZGxlcy5zZWxlY3QoYnVuZGxlKTtcblx0XHRhcnRpY2xlcy5kZXNlbGVjdCgpO1xuXHRcdHRoaXMudHJpZ2dlcihcImNoYW5nZTphZnRlclwiLCBidW5kbGUsIG1lZGlhKTtcblx0fSxcbn0pO1xuXG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IENvbnRyb2xsZXIoKTsiLCIvKipcbi8qIEBtb2R1bGUgYXBwL2NvbnRyb2wvR2xvYmFsc1xuLyovXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG5cdC8vIHJldXNhYmxlIHZhcnNcblx0dmFyIG8sIHMsIHNvO1xuXHQvLyBnbG9iYWwgaGFzaFxuXHR2YXIgZyA9IHt9O1xuXHQvLyBTQVNTIDwtLT4gSlMgc2hhcmVkIGhhc2hcblx0dmFyIHNhc3MgPSByZXF1aXJlKFwiLi4vLi4vLi4vc2Fzcy92YXJpYWJsZXMuanNvblwiKTtcblxuXHQvLyBKVU5LIEZJUlNUOiBTb21lIGFwcC13aWRlIGRlZmF1bHRzXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRnLlZQQU5fRFJBRyA9IDAuOTU7IC8vIGFzIGZhY3RvciBvZiBwb2ludGVyIGRlbHRhXG5cdGcuSFBBTl9PVVRfRFJBRyA9IDAuNDsgLy8gZmFjdG9yXG5cdGcuVlBBTl9PVVRfRFJBRyA9IDAuMTsgLy8gZmFjdG9yXG5cdGcuUEFOX1RIUkVTSE9MRCA9IDE1OyAvLyBweFxuXHRnLkNPTExBUFNFX1RIUkVTSE9MRCA9IDc1OyAvLyBweFxuXHRnLkNPTExBUFNFX09GRlNFVCA9IHBhcnNlSW50KHNhc3MudGVtcFtcImNvbGxhcHNlX29mZnNldFwiXSk7XG5cdGcuQ0xJQ0tfRVZFTlQgPSB3aW5kb3cuaGFzT3duUHJvcGVydHkoXCJvbnBvaW50ZXJ1cFwiKSA/IFwicG9pbnRlcnVwXCIgOiBcIm1vdXNldXBcIjtcblxuXHQvLyBicmVha3BvaW50c1xuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0Zy5CUkVBS1BPSU5UUyA9IHt9O1xuXHRmb3IgKHMgaW4gc2Fzcy5icmVha3BvaW50cykge1xuXHRcdG8gPSBzYXNzLmJyZWFrcG9pbnRzW3NdO1xuXHRcdC8qaWYgKEFycmF5LmlzQXJyYXkobykpIHtcblx0XHRcdGcuQlJFQUtQT0lOVFNbc10gPSBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh7fSwge1xuXHRcdFx0XHRcIm1hdGNoZXNcIjoge1xuXHRcdFx0XHRcdGdldDogXy5wYXJ0aWFsKF8uc29tZSwgby5tYXAod2luZG93Lm1hdGNoTWVkaWEpLCBfLnByb3BlcnR5KFwibWF0Y2hlc1wiKSlcblx0XHRcdFx0fSxcblx0XHRcdFx0XCJtZWRpYVwiOiB7XG5cdFx0XHRcdFx0dmFsdWU6IG8uam9pbihcIiwgXCIpXG5cdFx0XHRcdH0sXG5cdFx0XHRcdFwicXVlcmllc1wiOiB7XG5cdFx0XHRcdFx0dmFsdWU6IG8ubWFwKHdpbmRvdy5tYXRjaE1lZGlhKVxuXHRcdFx0XHR9LFxuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGcuQlJFQUtQT0lOVFNbc10gPSB3aW5kb3cubWF0Y2hNZWRpYShvKTtcblx0XHR9Ki9cblx0XHRvID0gQXJyYXkuaXNBcnJheShvKSA/IG8uam9pbihcIiwgXCIpIDogbztcblx0XHRvID0gby5yZXBsYWNlKC9bXFwnXFxcIl0vZywgXCJcIik7XG5cdFx0byA9IHdpbmRvdy5tYXRjaE1lZGlhKG8pO1xuXHRcdG8uY2xhc3NOYW1lID0gcztcblx0XHRnLkJSRUFLUE9JTlRTW3NdID0gbztcblx0fVxuXHRpZiAoREVCVUcpIHtcblx0XHRjb25zb2xlLmdyb3VwQ29sbGFwc2VkKFwiQnJlYWtwb2ludHNcIik7XG5cdFx0Zm9yIChzIGluIGcuQlJFQUtQT0lOVFMpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6ICVvXCIsIHMsIGcuQlJFQUtQT0lOVFNbc10ubWVkaWEpO1xuXHRcdH1cblx0XHRjb25zb2xlLmdyb3VwRW5kKCk7XG5cdH1cblxuXHQvLyBiYXNlIGNvbG9ycywgZGltZW5zaW9uc1xuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0Zy5ERUZBVUxUX0NPTE9SUyA9IF8uY2xvbmUoc2Fzcy5kZWZhdWx0X2NvbG9ycyk7XG5cdC8vIGcuSE9SSVpPTlRBTF9TVEVQID0gcGFyc2VGbG9hdChzYXNzLnVuaXRzW1wiaHVfcHhcIl0pO1xuXHQvLyBnLlZFUlRJQ0FMX1NURVAgPSBwYXJzZUZsb2F0KHNhc3MudW5pdHNbXCJ2dV9weFwiXSk7XG5cblxuXHQvLyBwYXRocywgbmV0d29ya2luZ1xuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0Ly8gdmFyIHRvQWJzb2x1dGVVUkwgPSAoZnVuY3Rpb24oKSB7XG5cdC8vIFx0dmFyIGEgPSBudWxsO1xuXHQvLyBcdHJldHVybiBmdW5jdGlvbih1cmwpIHtcblx0Ly8gXHRcdGEgPSBhIHx8IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcblx0Ly8gXHRcdGEuaHJlZiA9IHVybDtcblx0Ly8gXHRcdHJldHVybiBhLmhyZWY7XG5cdC8vIFx0fTtcblx0Ly8gfSkoKTtcblx0Ly8gZy5BUFBfUk9PVCA9IHRvQWJzb2x1dGVVUkwod2luZG93LmFwcHJvb3QpO1xuXHQvLyBnLk1FRElBX0RJUiA9IHRvQWJzb2x1dGVVUkwod2luZG93Lm1lZGlhZGlyKTtcblxuXHRnLkFQUF9ST09UID0gd2luZG93LmFwcHJvb3Q7XG5cdGcuTUVESUFfRElSID0gd2luZG93Lm1lZGlhZGlyO1xuXG5cdGRlbGV0ZSB3aW5kb3cuYXBwcm9vdDtcblx0ZGVsZXRlIHdpbmRvdy5tZWRpYWRpcjtcblxuXHQvLyBoYXJkY29kZWQgZm9udCBkYXRhXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRnLkZPTlRfTUVUUklDUyA9IHtcblx0XHRcIkZyYW5rbGluIEdvdGhpYyBGU1wiOiB7XG5cdFx0XHRcInVuaXRzUGVyRW1cIjogMTAwMCxcblx0XHRcdFwiYXNjZW50XCI6IDgyNyxcblx0XHRcdFwiZGVzY2VudFwiOiAtMTczXG5cdFx0fSxcblx0XHRcIklUQ0ZyYW5rbGluR290aGljU3RkXCI6IHtcblx0XHRcdFwidW5pdHNQZXJFbVwiOiAxMDAwLFxuXHRcdFx0XCJhc2NlbnRcIjogNjg2LFxuXHRcdFx0XCJkZXNjZW50XCI6IC0zMTRcblx0XHR9LFxuXHRcdFwiRm9saW9GaWd1cmVzXCI6IHtcblx0XHRcdFwidW5pdHNQZXJFbVwiOiAxMDI0LFxuXHRcdFx0XCJhc2NlbnRcIjogOTM5LFxuXHRcdFx0XCJkZXNjZW50XCI6IC0yNTZcblx0XHR9LFxuXHR9O1xuXG5cdGcuUEFVU0VfQ0hBUiA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHgyM0Y4KTtcblx0Zy5QTEFZX0NIQVIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MjNGNSk7XG5cdGcuU1RPUF9DSEFSID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweDIzRjkpO1xuXG5cdC8vIHRyYW5zbGF0ZSBjb21tb24gdGVtcGxhdGVcblxuXHRnLlRSQU5TTEFURV9URU1QTEFURSA9IGZ1bmN0aW9uKHgsIHkpIHtcblx0XHRyZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyB4ICsgXCJweCwgXCIgKyB5ICsgXCJweClcIjtcblx0XHQvLyByZXR1cm4gXCJ0cmFuc2xhdGUzZChcIiArIHggKyBcInB4LCBcIiArIHkgKyBcInB4ICwwcHgpXCI7XG5cdH07XG5cdC8vIHRpbWluZywgZWFzaW5nXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHR2YXIgZWFzZSA9IGcuVFJBTlNJVElPTl9FQVNFID0gc2Fzcy50cmFuc2l0aW9uc1tcImVhc2VcIl07XG5cdHZhciBkdXJhdGlvbiA9IGcuVFJBTlNJVElPTl9EVVJBVElPTiA9IHBhcnNlRmxvYXQoc2Fzcy50cmFuc2l0aW9uc1tcImR1cmF0aW9uX21zXCJdKTtcblx0dmFyIGRlbGF5SW50ZXJ2YWwgPSBnLlRSQU5TSVRJT05fREVMQVlfSU5URVJWQUwgPSBwYXJzZUZsb2F0KHNhc3MudHJhbnNpdGlvbnNbXCJkZWxheV9pbnRlcnZhbF9tc1wiXSk7XG5cdHZhciBtaW5EZWxheSA9IGcuVFJBTlNJVElPTl9NSU5fREVMQVkgPSBwYXJzZUZsb2F0KHNhc3MudHJhbnNpdGlvbnNbXCJtaW5fZGVsYXlfbXNcIl0pO1xuXHR2YXIgZGVsYXkgPSBnLlRSQU5TSVRJT05fREVMQVkgPSBnLlRSQU5TSVRJT05fRFVSQVRJT04gKyBnLlRSQU5TSVRJT05fREVMQVlfSU5URVJWQUw7XG5cblx0Ly8gY3NzIHRyYW5zaXRpb25zXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRvID0ge307XG5cblx0Ly8gbWF0Y2ggdHgoKSBpbiBfdHJhbnNpdGlvbnMuc2Nzc1xuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0by50eCA9IGZ1bmN0aW9uIHR4KGR1cmF0aW9uQ291bnQsIGRlbGF5Q291bnQsIGVhc2VWYWwpIHtcblx0XHRfLmlzTnVtYmVyKGR1cmF0aW9uQ291bnQpIHx8IChkdXJhdGlvbkNvdW50ID0gMSk7XG5cdFx0Xy5pc051bWJlcihkZWxheUNvdW50KSB8fCAoZGVsYXlDb3VudCA9IC0xKTtcblx0XHRfLmlzU3RyaW5nKGVhc2VWYWwpIHx8IChlYXNlVmFsID0gZWFzZSk7XG5cblx0XHR2YXIgbyA9IHt9O1xuXHRcdGlmIChkZWxheUNvdW50IDwgMCkge1xuXHRcdFx0by5kdXJhdGlvbiA9IChkdXJhdGlvbiAqIGR1cmF0aW9uQ291bnQpICtcblx0XHRcdFx0KGRlbGF5SW50ZXJ2YWwgKiAoZHVyYXRpb25Db3VudCAtIDEpKTtcblx0XHRcdG8uZGVsYXkgPSAwO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRvLmR1cmF0aW9uID0gKGR1cmF0aW9uICogZHVyYXRpb25Db3VudCkgK1xuXHRcdFx0XHQoZGVsYXlJbnRlcnZhbCAqIChkdXJhdGlvbkNvdW50IC0gMSkpIC0gbWluRGVsYXk7XG5cdFx0XHRvLmRlbGF5ID0gKGRlbGF5ICogZGVsYXlDb3VudCkgLSBtaW5EZWxheTtcblx0XHR9XG5cdFx0by5lYXNlaW5nID0gZWFzZVZhbDtcblx0XHRyZXR1cm4gMDtcblx0fVxuXG5cdC8vIHRyYW5zaXRpb24gcHJlc2V0c1xuXHQvLyBUT0RPOiBnZXQgcmlkIG9mIHRoaXNcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cblx0by5OT05FID0ge1xuXHRcdGRlbGF5OiAwLFxuXHRcdGR1cmF0aW9uOiAwLFxuXHRcdGVhc2luZzogXCJzdGVwLXN0YXJ0XCJcblx0fTtcblx0by5OT1cgPSB7XG5cdFx0ZGVsYXk6IDAsXG5cdFx0ZHVyYXRpb246IGR1cmF0aW9uLFxuXHRcdGVhc2luZzogZWFzZVxuXHR9O1xuXHRvLlVOU0VUID0gXy5kZWZhdWx0cyh7XG5cdFx0Y3NzVGV4dDogXCJcIlxuXHR9LCBvLk5PTkUpO1xuXG5cdHZhciB0eEFsaWduZWQgPSBfLmRlZmF1bHRzKHtcblx0XHRkdXJhdGlvbjogZHVyYXRpb24gLSBtaW5EZWxheVxuXHR9LCBvLk5PVyk7XG5cdG8uRklSU1QgPSBfLmRlZmF1bHRzKHtcblx0XHRkZWxheTogZGVsYXkgKiAwLjAgKyBtaW5EZWxheVxuXHR9LCB0eEFsaWduZWQpO1xuXHRvLkJFVFdFRU4gPSBfLmRlZmF1bHRzKHtcblx0XHRkZWxheTogZGVsYXkgKiAxLjAgKyBtaW5EZWxheVxuXHR9LCB0eEFsaWduZWQpO1xuXHRvLkxBU1QgPSBfLmRlZmF1bHRzKHtcblx0XHRkZWxheTogZGVsYXkgKiAyLjAgKyBtaW5EZWxheVxuXHR9LCB0eEFsaWduZWQpO1xuXHRvLkFGVEVSID0gXy5kZWZhdWx0cyh7XG5cdFx0ZGVsYXk6IGRlbGF5ICogMi4wICsgbWluRGVsYXlcblx0fSwgdHhBbGlnbmVkKTtcblxuXHRvLkJFVFdFRU5fRUFSTFkgPSBfLmRlZmF1bHRzKHtcblx0XHRkZWxheTogZGVsYXkgKiAxLjAgKyBtaW5EZWxheSAtIDYwXG5cdH0sIHR4QWxpZ25lZCk7XG5cdG8uQkVUV0VFTl9MQVRFID0gXy5kZWZhdWx0cyh7XG5cdFx0ZGVsYXk6IGRlbGF5ICogMS4wICsgbWluRGVsYXkgKyA2MFxuXHR9LCB0eEFsaWduZWQpO1xuXG5cdG8uRklSU1RfTEFURSA9IF8uZGVmYXVsdHMoe1xuXHRcdGRlbGF5OiBkZWxheSAqIDAuNSArIG1pbkRlbGF5XG5cdH0sIHR4QWxpZ25lZCk7XG5cdG8uTEFTVF9FQVJMWSA9IF8uZGVmYXVsdHMoe1xuXHRcdGRlbGF5OiBkZWxheSAqIDEuNSArIG1pbkRlbGF5XG5cdH0sIHR4QWxpZ25lZCk7XG5cdC8vIG8uRklSU1RfTEFURSA9IFx0XHRfLmRlZmF1bHRzKHtkZWxheTogdHhEZWxheSowLjAgKyB0eE1pbkRlbGF5KjJ9LCB0eEFsaWduZWQpO1xuXHQvLyBvLkxBU1RfRUFSTFkgPSBcdFx0Xy5kZWZhdWx0cyh7ZGVsYXk6IHR4RGVsYXkqMi4wICsgdHhNaW5EZWxheSowfSwgdHhBbGlnbmVkKTtcblx0Ly8gby5BRlRFUiA9IFx0XHRcdF8uZGVmYXVsdHMoe2RlbGF5OiB0eERlbGF5KjIuMCArIHR4TWluRGVsYXl9LCB0eEFsaWduZWQpO1xuXG5cdGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQoXCJUcmFuc2l0aW9uc1wiKTtcblx0Zm9yIChzIGluIG8pIHtcblx0XHRpZiAoIV8uaXNGdW5jdGlvbihvW3NdKSkge1xuXHRcdFx0c28gPSBvW3NdO1xuXHRcdFx0c28ubmFtZSA9IHM7XG5cdFx0XHRzby5jbGFzc05hbWUgPSBcInR4LVwiICsgcy5yZXBsYWNlKFwiX1wiLCBcIi1cIikudG9Mb3dlckNhc2UoKTtcblx0XHRcdGlmICghc28uaGFzT3duUHJvcGVydHkoXCJjc3NUZXh0XCIpKSB7XG5cdFx0XHRcdHNvLmNzc1RleHQgPSBzby5kdXJhdGlvbiAvIDEwMDAgKyBcInMgXCIgKyBzby5lYXNpbmcgKyBcIiBcIiArIHNvLmRlbGF5IC8gMTAwMCArIFwic1wiO1xuXHRcdFx0fVxuXHRcdFx0Y29uc29sZS5sb2coXCIlczogJXNcIiwgc28ubmFtZSwgc28uY3NzVGV4dCk7XG5cdFx0fVxuXHR9XG5cdGNvbnNvbGUuZ3JvdXBFbmQoKTtcblx0Zy50cmFuc2l0aW9ucyA9IG87XG5cblx0cmV0dXJuIGc7XG59KCkpOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9EZWJ1Z1Rvb2xiYXJcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6Y29va2llcy1qc30gKi9cbnZhciBDb29raWVzID0gcmVxdWlyZShcImNvb2tpZXMtanNcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTptb2Rlcm5penJ9ICovXG4vLyB2YXIgTW9kZXJuaXpyID0gcmVxdWlyZShcIk1vZGVybml6clwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9Db250cm9sbGVyfSAqL1xuLy8gdmFyIGNvbnRyb2xsZXIgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvQ29udHJvbGxlclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuXG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIHZpZXdUZW1wbGF0ZSA9IHJlcXVpcmUoXCIuL3RlbXBsYXRlL0RlYnVnVG9vbGJhci5oYnNcIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgZ3JpZFRlbXBsYXRlID0gcmVxdWlyZShcIi4vdGVtcGxhdGUvRGVidWdUb29sYmFyLlNWR0dyaWQuaGJzXCIpO1xuXG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIHNpemVUZW1wbGF0ZSA9IF8udGVtcGxhdGUoXCI8JT0gdyAlPiBcXHUwMEQ3IDwlPSBoICU+XCIpO1xuXG4vLyB2YXIgYXBwU3RhdGVTeW1ib2xzID0geyB3aXRoQnVuZGxlOiBcImJcIiwgd2l0aE1lZGlhOiBcIm1cIiwgY29sbGFwc2VkOiBcImNcIn07XG4vLyB2YXIgYXBwU3RhdGVLZXlzID0gT2JqZWN0LmtleXMoYXBwU3RhdGVTeW1ib2xzKTtcblxubW9kdWxlLmV4cG9ydHMgPSBWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjaWRQcmVmaXg6IFwiZGVidWdUb29sYmFyXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJkaXZcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwidG9vbGJhclwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRlbXBsYXRlOiB2aWV3VGVtcGxhdGUsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0Z3JpZDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2dyaWQgfHwgKHRoaXMuX2dyaWQgPSB0aGlzLmNyZWF0ZUdyaWRFbGVtZW50KCkpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0Q29va2llcy5kZWZhdWx0cyA9IHtcblx0XHRcdGV4cGlyZXM6IG5ldyBEYXRlKDB4N2ZmZmZmZmYgKiAxZTMpLFxuXHRcdFx0ZG9tYWluOiBTdHJpbmcod2luZG93LmxvY2F0aW9uKVxuXHRcdFx0XHQubWF0Y2goL15odHRwcz9cXDpcXC9cXC8oW15cXC86PyNdKykoPzpbXFwvOj8jXXwkKS9pKVsxXVxuXHRcdH07XG5cblx0XHR0aGlzLmVsLmlubmVySFRNTCA9IHRoaXMudGVtcGxhdGUoe1xuXHRcdFx0dGVzdHM6IE1vZGVybml6cixcblx0XHRcdG5hdmlnYXRvcjogd2luZG93Lm5hdmlnYXRvclxuXHRcdH0pO1xuXG5cdFx0LyogdG9nZ2xlJ3MgdGFyZ2V0OiBjb250YWluZXJcblx0XHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cdFx0dmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29udGFpbmVyXCIpOyAvLy5xdWVyeVNlbGVjdG9yKFwiI2NvbnRhaW5lclwiKTtcblxuXHRcdC8qIGNyZWF0ZS9hdHRhY2ggc3ZnIGdyaWQgZWxlbWVudFxuXHRcdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblx0XHRjb250YWluZXIuaW5zZXJ0QmVmb3JlKHRoaXMuY3JlYXRlR3JpZEVsZW1lbnQoKSwgY29udGFpbmVyLmZpcnN0RWxlbWVudENoaWxkKTtcblxuXHRcdC8qIGluZm8gZWxlbWVudHNcblx0XHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cdFx0dGhpcy5iYWNrZW5kRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1iYWNrZW5kIGFcIik7XG5cdFx0dGhpcy5tZWRpYUluZm9FbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIiNtZWRpYS1pbmZvIHNwYW5cIik7XG5cdFx0dGhpcy5hcHBTdGF0ZUVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI2FwcC1zdGF0ZVwiKTtcblxuXHRcdC8qIHRvZ2dsZSB2aXNpYmlsaXR5XG5cdFx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNsYXNzVG9nZ2xlKFwic2hvdy1saW5rc1wiLCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIuZGVidWctbGlua3MgI2xpbmtzLXRvZ2dsZVwiKSwgdGhpcy5lbCxcblx0XHRcdGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwibm90LVwiICsga2V5LCAhdmFsdWUpO1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOmluaXRpYWxpemVDbGFzc1RvZ2dsZTpbY2FsbGJhY2tdICVvXCIsIHRoaXMuY2lkLCBhcmd1bWVudHMpO1xuXHRcdFx0fVxuXHRcdCk7XG5cdFx0dGhpcy5pbml0aWFsaXplQ2xhc3NUb2dnbGUoXCJzaG93LXRlc3RzXCIsIHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIiN0b2dnbGUtdGVzdHMgYVwiKSwgdGhpcy5lbCk7XG5cdFx0dGhpcy5pbml0aWFsaXplQ2xhc3NUb2dnbGUoXCJoaWRlLXBhc3NlZFwiLCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdG9nZ2xlLXBhc3NlZFwiKSwgdGhpcy5lbCk7XG5cblx0XHQvKiB0b2dnbGUgY29udGFpbmVyIGNsYXNzZXNcblx0XHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cdFx0dGhpcy5pbml0aWFsaXplQ2xhc3NUb2dnbGUoXCJkZWJ1Zy1ncmlkLWJnXCIsIHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIiN0b2dnbGUtZ3JpZC1iZyBhXCIpLCBkb2N1bWVudC5ib2R5KTtcblx0XHR0aGlzLmluaXRpYWxpemVDbGFzc1RvZ2dsZShcImRlYnVnLWJsb2Nrc1wiLCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdG9nZ2xlLWJsb2NrcyBhXCIpLCBjb250YWluZXIpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNsYXNzVG9nZ2xlKFwiZGVidWctZ3JhcGhcIiwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI3RvZ2dsZS1ncmFwaCBhXCIpLCBjb250YWluZXIpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNsYXNzVG9nZ2xlKFwiZGVidWctbWRvd25cIiwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI3RvZ2dsZS1tZG93biBhXCIpLCBjb250YWluZXIpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNsYXNzVG9nZ2xlKFwiZGVidWctbG9nc1wiLCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdG9nZ2xlLWxvZ3MgYVwiKSwgY29udGFpbmVyKTtcblx0XHR0aGlzLmluaXRpYWxpemVDbGFzc1RvZ2dsZShcImRlYnVnLXR4XCIsIHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIiN0b2dnbGUtdHggYVwiKSwgY29udGFpbmVyLFxuXHRcdFx0ZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xuXHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJzaG93LXR4XCIsIHZhbHVlKTtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwibm90LXNob3ctdHhcIiwgIXZhbHVlKTtcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0dGhpcy5pbml0aWFsaXplVmlld3BvcnRJbmZvKCk7XG5cblx0XHQvLyB0aGlzLmluaXRpYWxpemVMYXlvdXRTZWxlY3QoKTtcblxuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJjaGFuZ2VcIiwgdGhpcy5fb25Nb2RlbENoYW5nZSk7XG5cdFx0dGhpcy5fb25Nb2RlbENoYW5nZSgpO1xuXHR9LFxuXG5cdGluaXRpYWxpemVWaWV3cG9ydEluZm86IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB2aWV3cG9ydEluZm9FbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIiN2aWV3cG9ydC1pbmZvIHNwYW5cIik7XG5cdFx0dmFyIGNhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG5cdFx0XHR2aWV3cG9ydEluZm9FbC50ZXh0Q29udGVudCA9IHNpemVUZW1wbGF0ZSh7IHc6IHdpbmRvdy5pbm5lcldpZHRoLCBoOiB3aW5kb3cuaW5uZXJIZWlnaHQgfSk7XG5cdFx0fTtcblx0XHRjYWxsYmFjay5jYWxsKCk7XG5cdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgXy5kZWJvdW5jZShjYWxsYmFjaywgMTAwLCBmYWxzZSwgZmFsc2UpKTtcblx0fSxcblxuXHRpbml0aWFsaXplVG9nZ2xlOiBmdW5jdGlvbihrZXksIHRvZ2dsZUVsLCBjYWxsYmFjaykge1xuXHRcdHZhciBjdHggPSB0aGlzO1xuXHRcdHZhciB0b2dnbGVWYWx1ZSA9IENvb2tpZXMuZ2V0KGtleSkgPT09IFwidHJ1ZVwiO1xuXHRcdGNhbGxiYWNrLmNhbGwoY3R4LCBrZXksIHRvZ2dsZVZhbHVlKTtcblxuXHRcdHRvZ2dsZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihldikge1xuXHRcdFx0aWYgKGV2LmRlZmF1bHRQcmV2ZW50ZWQpIHJldHVybjtcblx0XHRcdGVsc2UgZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRvZ2dsZVZhbHVlID0gIXRvZ2dsZVZhbHVlO1xuXHRcdFx0Q29va2llcy5zZXQoa2V5LCB0b2dnbGVWYWx1ZSA/IFwidHJ1ZVwiIDogXCJcIik7XG5cdFx0XHRjYWxsYmFjay5jYWxsKGN0eCwga2V5LCB0b2dnbGVWYWx1ZSk7XG5cdFx0fSwgZmFsc2UpO1xuXHR9LFxuXG5cdGluaXRpYWxpemVDbGFzc1RvZ2dsZTogZnVuY3Rpb24oa2V5LCB0b2dnbGVFbCwgdGFyZ2V0RWwsIGNhbGxiYWNrKSB7XG5cdFx0dmFyIGhhc0NhbGxiYWNrID0gXy5pc0Z1bmN0aW9uKGNhbGxiYWNrKTtcblxuXHRcdHRoaXMuaW5pdGlhbGl6ZVRvZ2dsZShrZXksIHRvZ2dsZUVsLCBmdW5jdGlvbihrZXksIHRvZ2dsZVZhbHVlKSB7XG5cdFx0XHR0YXJnZXRFbC5jbGFzc0xpc3QudG9nZ2xlKGtleSwgdG9nZ2xlVmFsdWUpO1xuXHRcdFx0dG9nZ2xlRWwuY2xhc3NMaXN0LnRvZ2dsZShcInRvZ2dsZS1lbmFibGVkXCIsIHRvZ2dsZVZhbHVlKTtcblx0XHRcdHRvZ2dsZUVsLmNsYXNzTGlzdC50b2dnbGUoXCJjb2xvci1yZXZlcnNlXCIsIHRvZ2dsZVZhbHVlKTtcblx0XHRcdGhhc0NhbGxiYWNrICYmIGNhbGxiYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0fSk7XG5cdH0sXG5cblx0X29uTW9kZWxDaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol9vbk1vZGVsQ2hhbmdlIGNoYW5nZWRBdHRyaWJ1dGVzOiAlb1wiLCB0aGlzLmNpZCwgdGhpcy5tb2RlbC5jaGFuZ2VkQXR0cmlidXRlcygpKTtcblx0XHR2YXIgaSwgaWksIHByb3AsIGVsLCBlbHMgPSB0aGlzLmFwcFN0YXRlRWwuY2hpbGRyZW47XG5cdFx0Zm9yIChpID0gMCwgaWkgPSBlbHMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0ZWwgPSBlbHNbaV07XG5cdFx0XHRwcm9wID0gZWwuZ2V0QXR0cmlidXRlKFwiZGF0YS1wcm9wXCIpO1xuXHRcdFx0ZWwuY2xhc3NMaXN0LnRvZ2dsZShcImhhcy12YWx1ZVwiLCB0aGlzLm1vZGVsLmdldChwcm9wKSk7XG5cdFx0XHRlbC5jbGFzc0xpc3QudG9nZ2xlKFwiaGFzLWNoYW5nZWRcIiwgdGhpcy5tb2RlbC5oYXNDaGFuZ2VkKHByb3ApKTtcblx0XHRcdGVsLmNsYXNzTGlzdC50b2dnbGUoXCJjb2xvci1yZXZlcnNlXCIsIHRoaXMubW9kZWwuaGFzQ2hhbmdlZChwcm9wKSk7XG5cdFx0fVxuXG5cdFx0Ly8gTk9URTogQWx3YXlzIGJ1dCByZXdyaXRlIENNUyBocmVmLlxuXHRcdC8vIE9ubHkgY29sbGFwc2VkIG1heSBoYXZlIGNoYW5nZWQsIGJ1dCBub3Qgd29ydGggYWxsIHRoZSBsb2dpY1xuXHRcdHZhciBhdHRyVmFsID0gR2xvYmFscy5BUFBfUk9PVCArIFwic3ltcGhvbnkvXCI7XG5cdFx0c3dpdGNoICh0aGlzLm1vZGVsLmdldChcInJvdXRlTmFtZVwiKSkge1xuXHRcdFx0Y2FzZSBcImFydGljbGUtaXRlbVwiOlxuXHRcdFx0XHRhdHRyVmFsICs9IFwicHVibGlzaC9hcnRpY2xlcy9lZGl0L1wiICsgdGhpcy5tb2RlbC5nZXQoXCJhcnRpY2xlXCIpLmlkO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJidW5kbGUtaXRlbVwiOlxuXHRcdFx0XHRhdHRyVmFsICs9IFwicHVibGlzaC9idW5kbGVzL2VkaXQvXCIgKyB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKS5pZDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwibWVkaWEtaXRlbVwiOlxuXHRcdFx0XHRhdHRyVmFsICs9IFwicHVibGlzaC9tZWRpYS9lZGl0L1wiICsgdGhpcy5tb2RlbC5nZXQoXCJtZWRpYVwiKS5pZDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwicm9vdFwiOlxuXHRcdFx0XHRhdHRyVmFsICs9IFwicHVibGlzaC9idW5kbGVzXCI7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHR0aGlzLmJhY2tlbmRFbC5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsIGF0dHJWYWwpO1xuXG5cdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIm1lZGlhXCIpKSB7XG5cdFx0XHRpZiAodGhpcy5tb2RlbC5oYXMoXCJtZWRpYVwiKSkge1xuXHRcdFx0XHR0aGlzLm1lZGlhSW5mb0VsLnRleHRDb250ZW50ID0gc2l6ZVRlbXBsYXRlKHRoaXMubW9kZWwuZ2V0KFwibWVkaWFcIikuZ2V0KFwic291cmNlXCIpLnRvSlNPTigpKTtcblx0XHRcdFx0dGhpcy5tZWRpYUluZm9FbC5zdHlsZS5kaXNwbGF5ID0gXCJcIjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMubWVkaWFJbmZvRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuXHRcdFx0XHR0aGlzLm1lZGlhSW5mb0VsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0Y3JlYXRlR3JpZEVsZW1lbnQ6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0ZWwuaWQgPSBcImdyaWQtd3JhcHBlclwiO1xuXHRcdGVsLmlubmVySFRNTCA9IGdyaWRUZW1wbGF0ZSgpO1xuXHRcdHJldHVybiBlbDtcblx0fSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cy5wcm90b3R5cGUuX2xvZ0ZsYWdzID0gXCJcIjsiLCIvLyBoYnNmeSBjb21waWxlZCBIYW5kbGViYXJzIHRlbXBsYXRlXG52YXIgSGFuZGxlYmFyc0NvbXBpbGVyID0gcmVxdWlyZSgnaGJzZnkvcnVudGltZScpO1xubW9kdWxlLmV4cG9ydHMgPSBIYW5kbGViYXJzQ29tcGlsZXIudGVtcGxhdGUoe1wiY29tcGlsZXJcIjpbNyxcIj49IDQuMC4wXCJdLFwibWFpblwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgcmV0dXJuIFwiPHN2ZyBpZD1cXFwiZGVidWctZ3JpZFxcXCIgdmVyc2lvbj1cXFwiMS4xXFxcIiB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHhtbG5zOnhsaW5rPVxcXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXFxcIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPVxcXCJ4TWF4WU1pZCBzbGljZVxcXCIgdmlld3BvcnQtZmlsbD1cXFwiaHNsKDAsMCUsMTAwJSlcXFwiIHZpZXdwb3J0LWZpbGwtb3BhY2l0eT1cXFwiMVxcXCIgc3R5bGU9XFxcImZpbGw6bm9uZTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MXB4O2ZpbGw6bm9uZTtmaWxsLXJ1bGU6ZXZlbm9kZDtcXFwiPlxcbjxkZWZzPlxcblx0PHBhdHRlcm4gaWQ9XFxcInBhdC1iYXNlbGluZS0xMnB4XFxcIiBjbGFzcz1cXFwiYmFzZWxpbmUgYmFzZTEyXFxcIiB4PVxcXCIwXFxcIiB5PVxcXCIwXFxcIiB3aWR0aD1cXFwiMjBcXFwiIGhlaWdodD1cXFwiMTJcXFwiIHBhdHRlcm5Vbml0cz1cXFwidXNlclNwYWNlT25Vc2VcXFwiPlxcblx0XHQ8bGluZSB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMFxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjEuMFxcXCIvPlxcblx0XHQ8bGluZSB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIzXFxcIiB5Mj1cXFwiM1xcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuMTI1XFxcIi8+XFxuXHRcdDxsaW5lIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjZcXFwiIHkyPVxcXCI2XFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC4zNzVcXFwiLz5cXG5cdFx0PGxpbmUgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiOVxcXCIgeTI9XFxcIjlcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIwLjEyNVxcXCIvPlxcblx0PC9wYXR0ZXJuPlxcblxcblx0PHBhdHRlcm4gaWQ9XFxcInBhdC1iYXNlbGluZS0yNHB4XFxcIiBjbGFzcz1cXFwiYmFzZWxpbmUgYmFzZTEyXFxcIiB4PVxcXCIwXFxcIiB5PVxcXCIwXFxcIiB3aWR0aD1cXFwiMjBcXFwiIGhlaWdodD1cXFwiMjRcXFwiIHBhdHRlcm5Vbml0cz1cXFwidXNlclNwYWNlT25Vc2VcXFwiPlxcblx0XHQ8bGluZSB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMFxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjEuMFxcXCIvPlxcblx0PC9wYXR0ZXJuPlxcblxcblx0PHBhdHRlcm4gaWQ9XFxcInBhdC1iYXNlbGluZS0xMHB4XFxcIiBjbGFzcz1cXFwiYmFzZWxpbmUgYmFzZTEwXFxcIiB4PVxcXCIwXFxcIiB5PVxcXCIwXFxcIiB3aWR0aD1cXFwiMjBcXFwiIGhlaWdodD1cXFwiMTBcXFwiIHBhdHRlcm5Vbml0cz1cXFwidXNlclNwYWNlT25Vc2VcXFwiPlxcblx0XHQ8bGluZSB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMFxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjEuMDBcXFwiLz5cXG5cdFx0PGxpbmUgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiNVxcXCIgeTI9XFxcIjVcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIwLjc1XFxcIi8+XFxuXHQ8L3BhdHRlcm4+XFxuXHQ8cGF0dGVybiBpZD1cXFwicGF0LWJhc2VsaW5lLTIwcHhcXFwiIGNsYXNzPVxcXCJiYXNlbGluZSBiYXNlMTBcXFwiIHg9XFxcIjBcXFwiIHk9XFxcIjBcXFwiIHdpZHRoPVxcXCIyMFxcXCIgaGVpZ2h0PVxcXCIyMFxcXCIgcGF0dGVyblVuaXRzPVxcXCJ1c2VyU3BhY2VPblVzZVxcXCI+XFxuXHRcdDxsaW5lIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIwXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMS4wXFxcIi8+XFxuXHQ8L3BhdHRlcm4+XFxuXHQ8cGF0dGVybiBpZD1cXFwicGF0LWNvbHMtMjIwcHhcXFwiIHg9XFxcIjBcXFwiIHk9XFxcIjBcXFwiIHdpZHRoPVxcXCIyMjBcXFwiIGhlaWdodD1cXFwiMzZcXFwiIHBhdHRlcm5Vbml0cz1cXFwidXNlclNwYWNlT25Vc2VcXFwiPlxcblx0XHQ8cmVjdCB0cmFuc2Zvcm09XFxcInRyYW5zbGF0ZSgwLDApXFxcIiB4PVxcXCIwXFxcIiB5PVxcXCIwXFxcIiB3aWR0aD1cXFwiMjBcXFwiIGhlaWdodD1cXFwiMTAwJVxcXCIgZmlsbD1cXFwiaHNsKDMzNiw1MCUsNDAlKVxcXCIgZmlsbC1vcGFjaXR5PVxcXCIwLjFcXFwiLz5cXG5cdFx0PHJlY3QgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMjAwLDApXFxcIiB4PVxcXCIwXFxcIiB5PVxcXCIwXFxcIiB3aWR0aD1cXFwiMjBcXFwiIGhlaWdodD1cXFwiMTAwJVxcXCIgZmlsbD1cXFwiaHNsKDMzNiw1MCUsNDAlKVxcXCIgZmlsbC1vcGFjaXR5PVxcXCIwLjFcXFwiLz5cXG5cdFx0PGxpbmUgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMjAgMClcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMFxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIiBzdHJva2U9XFxcImhzbCgzMzYsNTAlLDYwJSlcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIwLjJcXFwiLz5cXG5cdFx0PGxpbmUgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMjAwIDApXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIgc3Ryb2tlPVxcXCJoc2woMzM2LDUwJSw0MCUpXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC4yXFxcIi8+XFxuXFxuXHRcdDxsaW5lIHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDE0MCAwKVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiIHN0cm9rZT1cXFwiaHNsKDMzNiw1MCUsNDAlKVxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuM1xcXCIvPlxcblx0XHQ8bGluZSB0cmFuc2Zvcm09XFxcInRyYW5zbGF0ZSg4MCAwKVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiIHN0cm9rZT1cXFwiaHNsKDMzNiw1MCUsNDAlKVxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuM1xcXCIvPlxcblxcblx0XHQ8bGluZSB0cmFuc2Zvcm09XFxcInRyYW5zbGF0ZSgwIDApXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIgc3Ryb2tlPVxcXCJoc2woMjM2LDUwJSw0MCUpXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC40XFxcIiBzdHJva2Utd2lkdGg9XFxcIjFcXFwiLz5cXG5cdFx0PGxpbmUgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMjIwIDApXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIgc3Ryb2tlPVxcXCJoc2woMjM2LDUwJSw0MCUpXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC40XFxcIiBzdHJva2Utd2lkdGg9XFxcIjFcXFwiLz5cXG5cdDwvcGF0dGVybj5cXG48L2RlZnM+XFxuPGcgaWQ9XFxcImRlYnVnLWdyaWQtYm9keVxcXCIgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMCAwLjUpXFxcIj5cXG5cdDxyZWN0IGlkPVxcXCJiYXNlbGluZVxcXCIgeD1cXFwiMFxcXCIgeT1cXFwiMFxcXCIgd2lkdGg9XFxcIjEwMCVcXFwiIGhlaWdodD1cXFwiMTAwJVxcXCIvPlxcblx0PGcgaWQ9XFxcImRlYnVnLWdyaWQtY29udGFpbmVyXFxcIj5cXG5cdFx0PGcgaWQ9XFxcImRlYnVnLWdyaWQtY29udGVudFxcXCI+XFxuXHRcdFx0PHJlY3QgaWQ9XFxcImJhc2VsaW5lLWNvbnRlbnRcXFwiIHg9XFxcIjBcXFwiIHk9XFxcIjBcXFwiIHdpZHRoPVxcXCIxMDAlXFxcIiBoZWlnaHQ9XFxcIjEwMCVcXFwiLz5cXG5cdFx0XHQ8bGluZSBpZD1cXFwiZ2N0MFxcXCIgY2xhc3M9XFxcImhndWlkZVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjBcXFwiLz5cXG5cdFx0XHQ8bGluZSBpZD1cXFwiZ2N0MVxcXCIgY2xhc3M9XFxcImhndWlkZVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjBcXFwiLz5cXG5cdFx0PC9nPlxcblx0XHQ8bGluZSBpZD1cXFwiZ252MFxcXCIgY2xhc3M9XFxcImhndWlkZVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjBcXFwiLz5cXG5cdFx0PGxpbmUgaWQ9XFxcImdudjFcXFwiIGNsYXNzPVxcXCJoZ3VpZGVcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIwXFxcIi8+XFxuXHQ8L2c+XFxuXFxuXHQ8ZyBpZD1cXFwiYWJzLWNvbHNcXFwiPlxcblx0XHQ8cmVjdCBpZD1cXFwiY29sdW1uc1xcXCIgeD1cXFwiMFxcXCIgeT1cXFwiMFxcXCIgd2lkdGg9XFxcIjEwMCVcXFwiIGhlaWdodD1cXFwiMTAwJVxcXCIvPlxcblx0PC9nPlxcblxcblx0PGcgaWQ9XFxcInJlbC1jb2xzXFxcIj5cXG5cdFx0PGxpbmUgaWQ9XFxcImxlXFxcIiBjbGFzcz1cXFwidmd1aWRlIGVkZ2VcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMFxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIi8+XFxuXHRcdDxsaW5lIGlkPVxcXCJyZVxcXCIgY2xhc3M9XFxcInZndWlkZSBlZGdlXFxcIiB4MT1cXFwiMTAwJVxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIvPlxcblxcblx0XHQ8bGluZSBpZD1cXFwiZ2wwXFxcIiBjbGFzcz1cXFwidmd1aWRlIG1hcmdpblxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiLz5cXG5cdFx0PGxpbmUgaWQ9XFxcImdsMVxcXCIgY2xhc3M9XFxcInZndWlkZSBndXR0ZXJcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMFxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIi8+XFxuXFxuXHRcdDxsaW5lIGlkPVxcXCJncjBcXFwiIGNsYXNzPVxcXCJ2Z3VpZGUgbWFyZ2luXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIvPlxcblx0XHQ8bGluZSBpZD1cXFwiZ3IxXFxcIiBjbGFzcz1cXFwidmd1aWRlIGd1dHRlclxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiLz5cXG5cXG5cdFx0PGxpbmUgaWQ9XFxcImdtXFxcIiBjbGFzcz1cXFwidmd1aWRlXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIvPlxcblx0PC9nPlxcbjwvZz5cXG48L3N2Zz5cXG5cIjtcbn0sXCJ1c2VEYXRhXCI6dHJ1ZX0pO1xuIiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcIjFcIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBzdGFjazE7XG5cbiAgcmV0dXJuIFwiXHQ8ZGQgaWQ9XFxcInNlbGVjdC1sYXlvdXRcXFwiPlxcblx0XHQ8c2VsZWN0IHNpemU9MT5cXG5cIlxuICAgICsgKChzdGFjazEgPSBoZWxwZXJzLmVhY2guY2FsbChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5sYXlvdXRzIDogZGVwdGgwKSx7XCJuYW1lXCI6XCJlYWNoXCIsXCJoYXNoXCI6e30sXCJmblwiOmNvbnRhaW5lci5wcm9ncmFtKDIsIGRhdGEsIDApLFwiaW52ZXJzZVwiOmNvbnRhaW5lci5ub29wLFwiZGF0YVwiOmRhdGF9KSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIlx0XHQ8L3NlbGVjdD5cXG5cdDwvZGQ+XFxuXCI7XG59LFwiMlwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIGFsaWFzMT1jb250YWluZXIubGFtYmRhLCBhbGlhczI9Y29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb247XG5cbiAgcmV0dXJuIFwiXHRcdFx0PG9wdGlvbiB2YWx1ZT1cXFwiXCJcbiAgICArIGFsaWFzMihhbGlhczEoZGVwdGgwLCBkZXB0aDApKVxuICAgICsgXCJcXFwiPlwiXG4gICAgKyBhbGlhczIoYWxpYXMxKGRlcHRoMCwgZGVwdGgwKSlcbiAgICArIFwiPC9vcHRpb24+XFxuXCI7XG59LFwiNFwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIHN0YWNrMSwgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fTtcblxuICByZXR1cm4gXCJcdFx0PGxpIGNsYXNzPVxcXCJcIlxuICAgICsgKChzdGFjazEgPSBoZWxwZXJzW1wiaWZcIl0uY2FsbChhbGlhczEsZGVwdGgwLHtcIm5hbWVcIjpcImlmXCIsXCJoYXNoXCI6e30sXCJmblwiOmNvbnRhaW5lci5wcm9ncmFtKDUsIGRhdGEsIDApLFwiaW52ZXJzZVwiOmNvbnRhaW5lci5wcm9ncmFtKDcsIGRhdGEsIDApLFwiZGF0YVwiOmRhdGF9KSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIlxcXCI+XCJcbiAgICArIGNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMua2V5IHx8IChkYXRhICYmIGRhdGEua2V5KSkgIT0gbnVsbCA/IGhlbHBlciA6IGhlbHBlcnMuaGVscGVyTWlzc2luZyksKHR5cGVvZiBoZWxwZXIgPT09IFwiZnVuY3Rpb25cIiA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJrZXlcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiPC9saT5cXG5cIjtcbn0sXCI1XCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICByZXR1cm4gXCJwYXNzZWRcIjtcbn0sXCI3XCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICByZXR1cm4gXCJmYWlsZWRcIjtcbn0sXCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uO1xuXG4gIHJldHVybiBcIjxkbCBjbGFzcz1cXFwiZGVidWctbGlua3MgY29sb3ItYmdcXFwiPlxcblx0PGR0IGlkPVxcXCJsaW5rcy10b2dnbGVcXFwiPlxcblx0XHQ8c3ZnIGNsYXNzPVxcXCJpY29uXFxcIiB2aWV3Qm94PVxcXCItMTAwIC0xMDAgMjAwIDIwMFxcXCIgdmVyc2lvbj1cXFwiMS4xXFxcIiB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHhtbG5zOnhsaW5rPVxcXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXFxcIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPVxcXCJ4TWlkWU1pZCBtZWV0XFxcIj5cXG5cdFx0XHQ8cGF0aCBpZD1cXFwiY29nXFxcIiBkPVxcXCJNMTEuNzU0LC05OS4zMDdjLTcuODA5LC0wLjkyNCAtMTUuNjk5LC0wLjkyNCAtMjMuNTA4LDBsLTMuNzMsMjAuODJjLTYuMjU0LDEuMjM0IC0xMi4zMzgsMy4yMSAtMTguMTIzLDUuODg4bC0xNS4yNTUsLTE0LjY1MWMtNi44NjEsMy44NDIgLTEzLjI0NCw4LjQ4IC0xOS4wMTgsMTMuODE4bDkuMjIsMTkuMDM2Yy00LjMzNSw0LjY3NCAtOC4wOTUsOS44NDkgLTExLjIwMSwxNS40MTZsLTIwLjk1MywtMi44ODZjLTMuMjkyLDcuMTQxIC01LjczMSwxNC42NDUgLTcuMjY1LDIyLjM1N2wxOC42NDgsOS45ODFjLTAuNzU5LDYuMzI5IC0wLjc1OSwxMi43MjcgMCwxOS4wNTZsLTE4LjY0OCw5Ljk4MWMxLjUzNCw3LjcxMiAzLjk3MywxNS4yMTYgNy4yNjUsMjIuMzU3bDIwLjk1MywtMi44ODZjMy4xMDYsNS41NjcgNi44NjYsMTAuNzQyIDExLjIwMSwxNS40MTZsLTkuMjIsMTkuMDM2YzUuNzc0LDUuMzM4IDEyLjE1Nyw5Ljk3NiAxOS4wMTgsMTMuODE4bDE1LjI1NSwtMTQuNjUxYzUuNzg1LDIuNjc4IDExLjg2OSw0LjY1NCAxOC4xMjMsNS44ODhsMy43MywyMC44MmM3LjgwOSwwLjkyNCAxNS42OTksMC45MjQgMjMuNTA4LDBsMy43MywtMjAuODJjNi4yNTQsLTEuMjM0IDEyLjMzOCwtMy4yMSAxOC4xMjMsLTUuODg4bDE1LjI1NSwxNC42NTFjNi44NjEsLTMuODQyIDEzLjI0NCwtOC40OCAxOS4wMTgsLTEzLjgxOGwtOS4yMiwtMTkuMDM2YzQuMzM1LC00LjY3NCA4LjA5NSwtOS44NDkgMTEuMjAxLC0xNS40MTZsMjAuOTUzLDIuODg2YzMuMjkyLC03LjE0MSA1LjczMSwtMTQuNjQ1IDcuMjY1LC0yMi4zNTdsLTE4LjY0OCwtOS45ODFjMC43NTksLTYuMzI5IDAuNzU5LC0xMi43MjcgMCwtMTkuMDU2bDE4LjY0OCwtOS45ODFjLTEuNTM0LC03LjcxMiAtMy45NzMsLTE1LjIxNiAtNy4yNjUsLTIyLjM1N2wtMjAuOTUzLDIuODg2Yy0zLjEwNiwtNS41NjcgLTYuODY2LC0xMC43NDIgLTExLjIwMSwtMTUuNDE2bDkuMjIsLTE5LjAzNmMtNS43NzQsLTUuMzM4IC0xMi4xNTcsLTkuOTc2IC0xOS4wMTgsLTEzLjgxOGwtMTUuMjU1LDE0LjY1MWMtNS43ODUsLTIuNjc4IC0xMS44NjksLTQuNjU0IC0xOC4xMjMsLTUuODg4bC0zLjczLC0yMC44MlpNMCwtMzNjMTguMjEzLDAgMzMsMTQuNzg3IDMzLDMzYzAsMTguMjEzIC0xNC43ODcsMzMgLTMzLDMzYy0xOC4yMTMsMCAtMzMsLTE0Ljc4NyAtMzMsLTMzYzAsLTE4LjIxMyAxNC43ODcsLTMzIDMzLC0zM1pcXFwiIHN0eWxlPVxcXCJmaWxsOmN1cnJlbnRDb2xvcjtmaWxsLXJ1bGU6ZXZlbm9kZDtcXFwiLz5cXG5cdFx0PC9zdmc+XFxuXHQ8L2R0Plxcblx0PGR0IGlkPVxcXCJhcHAtc3RhdGVcXFwiPlxcblx0XHQ8c3BhbiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiIGRhdGEtcHJvcD1cXFwiY29sbGFwc2VkXFxcIj5jPC9zcGFuPjxzcGFuIGNsYXNzPVxcXCJjb2xvci1mZyBjb2xvci1iZ1xcXCIgZGF0YS1wcm9wPVxcXCJ3aXRoQnVuZGxlXFxcIj5iPC9zcGFuPjxzcGFuIGNsYXNzPVxcXCJjb2xvci1mZyBjb2xvci1iZ1xcXCIgZGF0YS1wcm9wPVxcXCJ3aXRoTWVkaWFcXFwiPm08L3NwYW4+PHNwYW4gY2xhc3M9XFxcImNvbG9yLWZnIGNvbG9yLWJnXFxcIiBkYXRhLXByb3A9XFxcIndpdGhBcnRpY2xlXFxcIj5hPC9zcGFuPlxcblx0PC9kdD5cXG5cIlxuICAgICsgKChzdGFjazEgPSBoZWxwZXJzW1wiaWZcIl0uY2FsbChhbGlhczEsKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmxheW91dHMgOiBkZXB0aDApLHtcIm5hbWVcIjpcImlmXCIsXCJoYXNoXCI6e30sXCJmblwiOmNvbnRhaW5lci5wcm9ncmFtKDEsIGRhdGEsIDApLFwiaW52ZXJzZVwiOmNvbnRhaW5lci5ub29wLFwiZGF0YVwiOmRhdGF9KSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIlx0PGRkIGlkPVxcXCJlZGl0LWJhY2tlbmRcXFwiPlxcblx0XHQ8YSBocmVmPVxcXCJcIlxuICAgICsgYWxpYXMyKChoZWxwZXJzLmdsb2JhbCB8fCAoZGVwdGgwICYmIGRlcHRoMC5nbG9iYWwpIHx8IGhlbHBlcnMuaGVscGVyTWlzc2luZykuY2FsbChhbGlhczEsXCJBUFBfUk9PVFwiLHtcIm5hbWVcIjpcImdsb2JhbFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSlcbiAgICArIFwic3ltcGhvbnkvXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiIHRhcmdldD1cXFwiX2JsYW5rXFxcIj5DTVM8L2E+XFxuXHQ8L2RkPlxcblx0PGRkIGlkPVxcXCJ0b2dnbGUtdGVzdHNcXFwiPlxcblx0XHQ8YSBocmVmPVxcXCIjdG9nZ2xlLXRlc3RzXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiPlRlc3RzPC9hPlxcblx0PC9kZD5cXG5cdDxkZCBpZD1cXFwidG9nZ2xlLWJsb2Nrc1xcXCI+XFxuXHRcdDxhIGhyZWY9XFxcIiN0b2dnbGUtYmxvY2tzXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiPkJsb2NrczwvYT5cXG5cdDwvZGQ+XFxuXHQ8ZGQgaWQ9XFxcInRvZ2dsZS10eFxcXCI+XFxuXHRcdDxhIGhyZWY9XFxcIiN0b2dnbGUtYmxvY2tzXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiPlRYL0ZYPC9hPlxcblx0PC9kZD5cXG5cdDxkZCBpZD1cXFwidG9nZ2xlLWdyaWQtYmdcXFwiPlxcblx0XHQ8YSBocmVmPVxcXCIjdG9nZ2xlLWdyaWQtYmdcXFwiIGNsYXNzPVxcXCJjb2xvci1mZyBjb2xvci1iZ1xcXCI+R3JpZDwvYT5cXG5cdDwvZGQ+XFxuXHQ8ZGQgaWQ9XFxcInRvZ2dsZS1ncmFwaFxcXCI+XFxuXHRcdDxhIGhyZWY9XFxcIiN0b2dnbGUtZ3JhcGhcXFwiIGNsYXNzPVxcXCJjb2xvci1mZyBjb2xvci1iZ1xcXCI+R3JhcGg8L2E+XFxuXHQ8L2RkPlxcblx0PGRkIGlkPVxcXCJ0b2dnbGUtbWRvd25cXFwiPlxcblx0XHQ8YSBocmVmPVxcXCIjdG9nZ2xlLW1kb3duXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiPk1hcmtkb3duPC9hPlxcblx0PC9kZD5cXG5cdDxkZCBpZD1cXFwidG9nZ2xlLWxvZ3NcXFwiPlxcblx0XHQ8YSBocmVmPVxcXCIjdG9nZ2xlLWxvZ3NcXFwiIGNsYXNzPVxcXCJjb2xvci1mZyBjb2xvci1iZ1xcXCI+TG9nczwvYT5cXG5cdDwvZGQ+XFxuXHQ8ZGQgaWQ9XFxcIm1lZGlhLWluZm9cXFwiPlxcblx0XHQ8c3Bhbj48L3NwYW4+XFxuXHQ8L2RkPlxcblx0PGRkIGlkPVxcXCJ2aWV3cG9ydC1pbmZvXFxcIj5cXG5cdFx0PHNwYW4+PC9zcGFuPlxcblx0PC9kZD5cXG48L2RsPlxcbjxkaXYgaWQ9XFxcInRlc3QtcmVzdWx0c1xcXCI+XFxuXHQ8aDY+VGVzdHMgPGEgaWQ9XFxcInRvZ2dsZS1wYXNzZWRcXFwiIGhyZWY9XFxcIiN0b2dnbGUtcGFzc2VkXFxcIj5QYXNzZWQ8L2E+PC9oNj5cXG5cdDxwPlwiXG4gICAgKyBhbGlhczIoY29udGFpbmVyLmxhbWJkYSgoKHN0YWNrMSA9IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5uYXZpZ2F0b3IgOiBkZXB0aDApKSAhPSBudWxsID8gc3RhY2sxLnVzZXJBZ2VudCA6IHN0YWNrMSksIGRlcHRoMCkpXG4gICAgKyBcIjwvcD5cXG5cdDx1bD5cXG5cIlxuICAgICsgKChzdGFjazEgPSBoZWxwZXJzLmVhY2guY2FsbChhbGlhczEsKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLnRlc3RzIDogZGVwdGgwKSx7XCJuYW1lXCI6XCJlYWNoXCIsXCJoYXNoXCI6e30sXCJmblwiOmNvbnRhaW5lci5wcm9ncmFtKDQsIGRhdGEsIDApLFwiaW52ZXJzZVwiOmNvbnRhaW5lci5ub29wLFwiZGF0YVwiOmRhdGF9KSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIlx0PC91bD5cXG48L2Rpdj5cXG5cIjtcbn0sXCJ1c2VEYXRhXCI6dHJ1ZX0pO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9CYXNlSXRlbVxuICogQHJlcXVpcmVzIG1vZHVsZTpiYWNrYm9uZVxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xudmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEJhY2tib25lLk1vZGVsLmV4dGVuZCh7XG5cblx0ZGVmYXVsdHM6IHtcblx0XHRyb3V0ZU5hbWU6IFwiaW5pdGlhbFwiLFxuXHRcdGNvbGxhcHNlZDogZmFsc2UsXG5cdFx0YXJ0aWNsZTogbnVsbCxcblx0XHR3aXRoQXJ0aWNsZTogZmFsc2UsXG5cdFx0YnVuZGxlOiBudWxsLFxuXHRcdHdpdGhCdW5kbGU6IGZhbHNlLFxuXHRcdG1lZGlhOiBudWxsLFxuXHRcdHdpdGhNZWRpYTogZmFsc2UsXG5cdH0sXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0T2JqZWN0LmtleXModGhpcy5kZWZhdWx0cykuZm9yRWFjaChmdW5jdGlvbihnZXR0ZXJOYW1lKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgZ2V0dGVyTmFtZSwge1xuXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLmdldChnZXR0ZXJOYW1lKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cbn0pOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvQmFzZUl0ZW1cbiAqIEByZXF1aXJlcyBtb2R1bGU6YmFja2JvbmVcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBNb2RlbCA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKS5Nb2RlbDtcbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xuLy8gdmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC91dGlscy9zdHJpbmdzL3N0cmlwVGFnc30gKi9cbi8vIHZhciBzdHJpcFRhZ3MgPSByZXF1aXJlKFwidXRpbHMvc3RyaW5ncy9zdHJpcFRhZ3NcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvcGFyc2VTeW1BdHRyc30gKi9cbi8vdmFyIHBhcnNlU3ltQXR0cnMgPSByZXF1aXJlKFwiYXBwL21vZGVsL3BhcnNlU3ltQXR0cnNcIik7XG5cbnZhciBwYXJzZVN5bUF0dHJzID0gZnVuY3Rpb24ocykge1xuXHRyZXR1cm4gcy5yZXBsYWNlKC8oXFwsfFxcOykvZywgZnVuY3Rpb24obSkge1xuXHRcdHJldHVybiAobSA9PSBcIixcIikgPyBcIjtcIiA6IFwiLFwiO1xuXHR9KTtcbn07XG52YXIgdG9BdHRyc0hhc2ggPSBmdW5jdGlvbihvYmosIGF0dHIpIHtcblx0aWYgKF8uaXNTdHJpbmcoYXR0cikpIHtcblx0XHR2YXIgaWR4ID0gYXR0ci5pbmRleE9mKFwiOlwiKTtcblx0XHRpZiAoaWR4ID4gMCkge1xuXHRcdFx0b2JqW2F0dHIuc3Vic3RyaW5nKDAsIGlkeCldID0gcGFyc2VTeW1BdHRycyhhdHRyLnN1YnN0cmluZyhpZHggKyAxKSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG9ialthdHRyXSA9IGF0dHI7IC8vIHRvIG1hdGNoIEhUTUw1PD5YSFRNTCB2YWx1ZWxlc3MgYXR0cmlidXRlc1xuXHRcdH1cblx0fSAvLyBlbHNlIGlnbm9yZSBub24tc3RyaW5nIHZhbHVlc1xuXHRyZXR1cm4gb2JqO1xufTtcblxudmFyIEJhc2VJdGVtUHJvdG8gPSB7XG5cblx0X2RvbVByZWZpeDogXCJfXCIsXG5cblx0LyoqIEB0eXBlIHtPYmplY3R9ICovXG5cdGRlZmF1bHRzOiB7XG5cdFx0Ly8gYXR0cnM6IGZ1bmN0aW9uKCkgeyByZXR1cm4ge307IH0sXG5cdFx0Z2V0IGF0dHJzKCkge1xuXHRcdFx0cmV0dXJuIHt9O1xuXHRcdH0sXG5cdH0sXG5cblx0Z2V0dGVyczogW1wiZG9taWRcIl0sXG5cblx0bXV0YXRvcnM6IHtcblx0XHRkb21pZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIXRoaXMuaGFzT3duUHJvcGVydHkoXCJfZG9tSWRcIikpXG5cdFx0XHRcdHRoaXMuX2RvbUlkID0gdGhpcy5fZG9tUHJlZml4ICsgdGhpcy5pZDtcblx0XHRcdHJldHVybiB0aGlzLl9kb21JZDtcblx0XHR9LFxuXHRcdGF0dHJzOiB7XG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKGtleSwgdmFsdWUsIG9wdGlvbnMsIHNldCkge1xuXHRcdFx0XHRpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcblx0XHRcdFx0XHR2YWx1ZSA9IHZhbHVlLnJlZHVjZSh0b0F0dHJzSGFzaCwge30pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICghXy5pc09iamVjdCh2YWx1ZSkpIHtcblx0XHRcdFx0XHRjb25zb2xlLmVycm9yKFwiJXM6OmF0dHJzIHZhbHVlIG5vdCBhbiBvYmplY3Qgb3Igc3RyaW5nIGFycmF5XCIsIHRoaXMuY2lkLCB2YWx1ZSk7XG5cdFx0XHRcdFx0dmFsdWUgPSB7fTtcblx0XHRcdFx0fVxuXHRcdFx0XHRzZXQoa2V5LCB2YWx1ZSwgb3B0aW9ucyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0fSxcblxuXHRhdHRyOiBmdW5jdGlvbihhdHRyKSB7XG5cdFx0cmV0dXJuIHRoaXMuYXR0cnMoKVthdHRyXTtcblx0fSxcblxuXHRhdHRyczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0KFwiYXR0cnNcIik7XG5cdH0sXG5cblx0dG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmdldChcImRvbWlkXCIpO1xuXHR9XG59O1xuXG52YXIgQmFzZUl0ZW0gPSB7XG5cdGV4dGVuZDogZnVuY3Rpb24ocHJvdG8sIG9iaikge1xuXHRcdHZhciBjb25zdHIsIHByb3BOYW1lOyAvLywgcHJvcERlZjtcblx0XHRmb3IgKHByb3BOYW1lIGluIHByb3RvKSB7XG5cdFx0XHRpZiAocHJvdG8uaGFzT3duUHJvcGVydHkocHJvcE5hbWUpICYmIF8uaXNPYmplY3QocHJvdG9bcHJvcE5hbWVdKSkgeyAvLyhPYmplY3QuZ2V0UHJvdG90eXBlT2YocHJvdG9bcHJvcE5hbWVdKSA9PT0gT2JqZWN0LnByb3RvdHlwZSkpIHtcblx0XHRcdFx0Xy5kZWZhdWx0cyhwcm90b1twcm9wTmFtZV0sIEJhc2VJdGVtUHJvdG9bcHJvcE5hbWVdKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJCYXNlSXRlbTo6ZXh0ZW5kICclczolcycgaXMgT2JqZWN0XFxuJXNcIiwgcHJvdG8uX2RvbVByZWZpeCwgcCwgSlNPTi5zdHJpbmdpZnkocHJvdG9bcF0pKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Ly8gaWYgKHByb3RvLnByb3BlcnRpZXMgJiYgdGhpcy5wcm90b3R5cGUucHJvcGVydGllcykge1xuXHRcdC8vIFx0Xy5kZWZhdWx0cyhwcm90by5wcm9wZXJ0aWVzLCB0aGlzLnByb3RvdHlwZS5wcm9wZXJ0aWVzKTtcblx0XHQvLyB9XG5cdFx0Y29uc3RyID0gTW9kZWwuZXh0ZW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHRpZiAoQXJyYXkuaXNBcnJheShjb25zdHIucHJvdG90eXBlLmdldHRlcnMpKSB7XG5cdFx0XHRjb25zdHIucHJvdG90eXBlLmdldHRlcnMuZm9yRWFjaChmdW5jdGlvbihnZXR0ZXJOYW1lKSB7XG5cdFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb25zdHIucHJvdG90eXBlLCBnZXR0ZXJOYW1lLCB7XG5cdFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRoaXMuZ2V0KGdldHRlck5hbWUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0Ly8gaWYgKF8uaXNPYmplY3QocHJvdG8ucHJvcGVydGllcykpIHtcblx0XHQvLyBcdGZvciAocHJvcE5hbWUgaW4gcHJvdG8ucHJvcGVydGllcykge1xuXHRcdC8vIFx0XHRpZiAocHJvdG8ucHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShwcm9wTmFtZSkpIHtcblx0XHQvLyBcdFx0XHRwcm9wRGVmID0gcHJvdG8ucHJvcGVydGllc1twcm9wTmFtZV07XG5cdFx0Ly8gXHRcdFx0aWYgKF8uaXNGdW5jdGlvbihwcm9wRGVmKSkge1xuXHRcdC8vIFx0XHRcdFx0cHJvdG8ucHJvcGVydGllc1twcm9wTmFtZV0gPSB7XG5cdFx0Ly8gXHRcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsIGdldDogcHJvcERlZlxuXHRcdC8vIFx0XHRcdFx0fTtcblx0XHQvLyBcdFx0XHR9IGVsc2UgaWYgKF8uaXNPYmplY3QocHJvcERlZikpe1xuXHRcdC8vIFx0XHRcdFx0cHJvcERlZi5lbnVtZXJhYmxlID0gdHJ1ZTtcblx0XHQvLyBcdFx0XHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRcdFx0ZGVsZXRlIHByb3RvLnByb3BlcnRpZXNbcHJvcE5hbWVdO1xuXHRcdC8vIFx0XHRcdH1cblx0XHQvLyBcdFx0fVxuXHRcdC8vIFx0fVxuXHRcdC8vIFx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXMocHJvdG8sIHByb3RvLnByb3BlcnRpZXMpO1xuXHRcdC8vIFx0ZGVsZXRlIHByb3RvLnByb3BlcnRpZXM7XG5cdFx0Ly8gfVxuXHRcdHJldHVybiBjb25zdHI7XG5cdH1cbn07XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9CYXNlSXRlbX1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBCYXNlSXRlbS5leHRlbmQuY2FsbChNb2RlbCwgQmFzZUl0ZW1Qcm90bywgQmFzZUl0ZW0pO1xuLy8gbW9kdWxlLmV4cG9ydHMgPSBNb2RlbC5leHRlbmQoQmFzZUl0ZW1Qcm90bywgQmFzZUl0ZW0pO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvblxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG52YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvbn1cbiAqL1xudmFyIFNlbGVjdGFibGVDb2xsZWN0aW9uID0gQmFja2JvbmUuQ29sbGVjdGlvbi5leHRlbmQoe1xuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG1vZGVscywgb3B0aW9ucykge1xuXHRcdG9wdGlvbnMgPSBfLmRlZmF1bHRzKHt9LCBvcHRpb25zLCB7XG5cdFx0XHRpbml0aWFsU2VsZWN0aW9uOiBcIm5vbmVcIixcblx0XHRcdHNpbGVudEluaXRpYWw6IHRydWVcblx0XHR9KTtcblx0XHR0aGlzLmluaXRpYWxTZWxlY3Rpb24gPSBvcHRpb25zLmluaXRpYWxTZWxlY3Rpb247XG5cdFx0dGhpcy5pbml0aWFsT3B0aW9ucyA9IHtcblx0XHRcdHNpbGVudDogb3B0aW9ucy5zaWxlbnRJbml0aWFsXG5cdFx0fTtcblx0fSxcblxuXHRyZXNldDogZnVuY3Rpb24obW9kZWxzLCBvcHRpb25zKSB7XG5cdFx0dGhpcy5kZXNlbGVjdCh0aGlzLmluaXRpYWxPcHRpb25zKTtcblx0XHRCYWNrYm9uZS5Db2xsZWN0aW9uLnByb3RvdHlwZS5yZXNldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdGlmICh0aGlzLmluaXRpYWxTZWxlY3Rpb24gPT09IFwiZmlyc3RcIiAmJiB0aGlzLmxlbmd0aCkge1xuXHRcdFx0dGhpcy5zZWxlY3QodGhpcy5hdCgwKSwgdGhpcy5pbml0aWFsT3B0aW9ucyk7XG5cdFx0fVxuXHR9LFxuXG5cdHNlbGVjdDogZnVuY3Rpb24obmV3TW9kZWwsIG9wdGlvbnMpIHtcblx0XHRpZiAobmV3TW9kZWwgPT09IHZvaWQgMCkge1xuXHRcdFx0bmV3TW9kZWwgPSBudWxsO1xuXHRcdH1cblx0XHRpZiAodGhpcy5zZWxlY3RlZCA9PT0gbmV3TW9kZWwpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dmFyIHRyaWdnZXJFdmVudHMgPSAhKG9wdGlvbnMgJiYgb3B0aW9ucy5zaWxlbnQpO1xuXHRcdHZhciBvbGRNb2RlbCA9IHRoaXMuc2VsZWN0ZWQ7XG5cblx0XHR0aGlzLmxhc3RTZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWQ7XG5cdFx0dGhpcy5sYXN0U2VsZWN0ZWRJbmRleCA9IHRoaXMuc2VsZWN0ZWRJbmRleDtcblx0XHR0aGlzLnNlbGVjdGVkID0gbmV3TW9kZWw7XG5cdFx0dGhpcy5zZWxlY3RlZEluZGV4ID0gdGhpcy5pbmRleE9mKG5ld01vZGVsKTtcblxuXHRcdGlmIChvbGRNb2RlbCkge1xuXHRcdFx0aWYgKF8uaXNGdW5jdGlvbihvbGRNb2RlbC5kZXNlbGVjdCkpIHtcblx0XHRcdFx0b2xkTW9kZWwuZGVzZWxlY3Qob3B0aW9ucyk7XG5cdFx0XHR9IGVsc2UgaWYgKHRyaWdnZXJFdmVudHMpIHtcblx0XHRcdFx0b2xkTW9kZWwuc2VsZWN0ZWQgPSB2b2lkIDA7XG5cdFx0XHRcdG9sZE1vZGVsLnRyaWdnZXIoXCJkZXNlbGVjdGVkXCIsIG5ld01vZGVsLCBvbGRNb2RlbCk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodHJpZ2dlckV2ZW50cykgdGhpcy50cmlnZ2VyKFwiZGVzZWxlY3Q6b25lXCIsIG9sZE1vZGVsKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHRyaWdnZXJFdmVudHMpIHRoaXMudHJpZ2dlcihcImRlc2VsZWN0Om5vbmVcIiwgbnVsbCk7XG5cdFx0fVxuXG5cdFx0aWYgKG5ld01vZGVsKSB7XG5cdFx0XHRpZiAoXy5pc0Z1bmN0aW9uKG5ld01vZGVsLnNlbGVjdCkpIHtcblx0XHRcdFx0bmV3TW9kZWwuc2VsZWN0KG9wdGlvbnMpO1xuXHRcdFx0fSBlbHNlIGlmICh0cmlnZ2VyRXZlbnRzKSB7XG5cdFx0XHRcdG5ld01vZGVsLnNlbGVjdGVkID0gdHJ1ZTtcblx0XHRcdFx0bmV3TW9kZWwudHJpZ2dlcihcInNlbGVjdGVkXCIsIG5ld01vZGVsLCBvbGRNb2RlbCk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodHJpZ2dlckV2ZW50cykgdGhpcy50cmlnZ2VyKFwic2VsZWN0Om9uZVwiLCBuZXdNb2RlbCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICh0cmlnZ2VyRXZlbnRzKSB0aGlzLnRyaWdnZXIoXCJzZWxlY3Q6bm9uZVwiLCBudWxsKTtcblx0XHR9XG5cdH0sXG5cblx0ZGVzZWxlY3Q6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLnNlbGVjdChudWxsLCBvcHRpb25zKTtcblx0fSxcblxuXHRzZWxlY3RBdDogZnVuY3Rpb24oaW5kZXgsIG9wdGlvbnMpIHtcblx0XHRpZiAoMCA+IGluZGV4IHx8IGluZGV4ID49IHRoaXMubGVuZ3RoKSB7XG5cdFx0XHRuZXcgUmFuZ2VFcnJvcihcImluZGV4IGlzIG91dCBvZiBib3VuZHNcIik7XG5cdFx0fVxuXHRcdHRoaXMuc2VsZWN0KHRoaXMuYXQoaW5kZXgpLCBvcHRpb25zKTtcblx0fSxcblxuXHRkaXN0YW5jZTogZnVuY3Rpb24oYSwgYikge1xuXHRcdHZhciBhSWR4LCBiSWR4O1xuXG5cdFx0aWYgKCFhKSByZXR1cm4gTmFOO1xuXHRcdGFJZHggPSB0aGlzLmluZGV4T2YoYSk7XG5cdFx0aWYgKGFJZHggPT0gLTEpIHJldHVybiBOYU47XG5cblx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAxKSB7XG5cdFx0XHRiSWR4ID0gdGhpcy5zZWxlY3RlZEluZGV4O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoIWIpIHJldHVybiBOYU47XG5cdFx0XHRiSWR4ID0gdGhpcy5pbmRleE9mKGIpO1xuXHRcdFx0aWYgKGJJZHggPT0gLTEpIHJldHVybiBOYU47XG5cdFx0fVxuXHRcdHJldHVybiBNYXRoLmFicyhiSWR4IC0gYUlkeCk7XG5cdH0sXG5cblx0LyogVE9ETzogTU9WRSBJTlRPIE1JWElOICovXG5cblx0LyoqIEByZXR1cm4gYm9vbGVhblx0LyovXG5cdGhhc0ZvbGxvd2luZzogZnVuY3Rpb24obW9kZWwpIHtcblx0XHRtb2RlbCB8fCAobW9kZWwgPSB0aGlzLnNlbGVjdGVkKTtcblx0XHRyZXR1cm4gdGhpcy5pbmRleE9mKG1vZGVsKSA8ICh0aGlzLmxlbmd0aCAtIDEpO1xuXHR9LFxuXG5cdC8qKiBAcmV0dXJuIG5leHQgbW9kZWxcdCovXG5cdGZvbGxvd2luZzogZnVuY3Rpb24obW9kZWwpIHtcblx0XHRtb2RlbCB8fCAobW9kZWwgPSB0aGlzLnNlbGVjdGVkKTtcblx0XHRyZXR1cm4gdGhpcy5oYXNGb2xsb3dpbmcobW9kZWwpID8gdGhpcy5hdCh0aGlzLmluZGV4T2YobW9kZWwpICsgMSkgOiBudWxsO1xuXHR9LFxuXG5cdC8qKiBAcmV0dXJuIG5leHQgbW9kZWwgb3IgdGhlIGJlZ2lubmluZyBpZiBhdCB0aGUgZW5kICovXG5cdGZvbGxvd2luZ09yRmlyc3Q6IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0bW9kZWwgfHwgKG1vZGVsID0gdGhpcy5zZWxlY3RlZCk7XG5cdFx0cmV0dXJuIHRoaXMuYXQoKHRoaXMuaW5kZXhPZihtb2RlbCkgKyAxKSAlIHRoaXMubGVuZ3RoKTtcblx0fSxcblxuXHQvKiogQHJldHVybiBib29sZWFuXHQvKi9cblx0aGFzUHJlY2VkaW5nOiBmdW5jdGlvbihtb2RlbCkge1xuXHRcdG1vZGVsIHx8IChtb2RlbCA9IHRoaXMuc2VsZWN0ZWQpO1xuXHRcdHJldHVybiB0aGlzLmluZGV4T2YobW9kZWwpID4gMDtcblx0fSxcblxuXHQvKiogQHJldHVybiB0aGUgcHJldmlvdXMgbW9kZWwgKi9cblx0cHJlY2VkaW5nOiBmdW5jdGlvbihtb2RlbCkge1xuXHRcdG1vZGVsIHx8IChtb2RlbCA9IHRoaXMuc2VsZWN0ZWQpO1xuXHRcdHJldHVybiB0aGlzLmhhc1ByZWNlZGluZyhtb2RlbCkgPyB0aGlzLmF0KHRoaXMuaW5kZXhPZihtb2RlbCkgLSAxKSA6IG51bGw7XG5cdH0sXG5cblx0LyoqIEByZXR1cm4gdGhlIHByZXZpb3VzIG1vZGVsIG9yIHRoZSBlbmQgaWYgYXQgdGhlIGJlZ2lubmluZyAqL1xuXHRwcmVjZWRpbmdPckxhc3Q6IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0bW9kZWwgfHwgKG1vZGVsID0gdGhpcy5zZWxlY3RlZCk7XG5cdFx0dmFyIGluZGV4ID0gdGhpcy5pbmRleE9mKG1vZGVsKSAtIDE7XG5cdFx0cmV0dXJuIHRoaXMuYXQoaW5kZXggPiAtMSA/IGluZGV4IDogdGhpcy5sZW5ndGggLSAxKTtcblx0fSxcblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gU2VsZWN0YWJsZUNvbGxlY3Rpb247XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb25cbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb259ICovXG52YXIgU2VsZWN0YWJsZUNvbGxlY3Rpb24gPSByZXF1aXJlKFwiYXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9uXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9BcnRpY2xlSXRlbX0gKi9cbnZhciBBcnRpY2xlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9BcnRpY2xlSXRlbVwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb259XG4gKi9cbnZhciBBcnRpY2xlQ29sbGVjdGlvbiA9IFNlbGVjdGFibGVDb2xsZWN0aW9uLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtCYWNrYm9uZS5Nb2RlbH0gKi9cblx0bW9kZWw6IEFydGljbGVJdGVtXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBBcnRpY2xlQ29sbGVjdGlvbigpOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9ufSAqL1xudmFyIFNlbGVjdGFibGVDb2xsZWN0aW9uID0gcmVxdWlyZShcImFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvblwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vQnVuZGxlSXRlbX0gKi9cbnZhciBCdW5kbGVJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9pdGVtL0J1bmRsZUl0ZW1cIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb259XG4gKi9cbnZhciBCdW5kbGVDb2xsZWN0aW9uID0gU2VsZWN0YWJsZUNvbGxlY3Rpb24uZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge0JhY2tib25lLk1vZGVsfSAqL1xuXHRtb2RlbDogQnVuZGxlSXRlbSxcblxuXHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHRjb21wYXJhdG9yOiBmdW5jdGlvbihvYSwgb2IpIHtcblx0XHR2YXIgYSA9IG9hLmdldChcImNvbXBsZXRlZFwiKTtcblx0XHR2YXIgYiA9IG9iLmdldChcImNvbXBsZXRlZFwiKTtcblx0XHRpZiAoYSA+IGIpIHtcblx0XHRcdHJldHVybiAtMTtcblx0XHR9IGVsc2UgaWYgKGEgPCBiKSB7XG5cdFx0XHRyZXR1cm4gMTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIDA7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAdHlwZSB7U3RyaW5nfSAqL1xuXHR1cmw6IFwiL2pzb24vYnVuZGxlcy9cIixcblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEJ1bmRsZUNvbGxlY3Rpb24oKTtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvblxuICogQHJlcXVpcmVzIG1vZHVsZTpiYWNrYm9uZVxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvbn0gKi9cbnZhciBTZWxlY3RhYmxlQ29sbGVjdGlvbiA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb25cIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL0tleXdvcmRJdGVtfSAqL1xudmFyIEtleXdvcmRJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9pdGVtL0tleXdvcmRJdGVtXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvbn1cbiAqL1xudmFyIEtleXdvcmRDb2xsZWN0aW9uID0gU2VsZWN0YWJsZUNvbGxlY3Rpb24uZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge0JhY2tib25lLk1vZGVsfSAqL1xuXHRtb2RlbDogS2V5d29yZEl0ZW1cblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEtleXdvcmRDb2xsZWN0aW9uKCk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2NvbGxlY3Rpb24vVHlwZUNvbGxlY3Rpb25cbiAqIEByZXF1aXJlcyBtb2R1bGU6YmFja2JvbmVcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vVHlwZUl0ZW19ICovXG52YXIgVHlwZUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL2l0ZW0vVHlwZUl0ZW1cIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9ufVxuICovXG52YXIgVHlwZUNvbGxlY3Rpb24gPSBCYWNrYm9uZS5Db2xsZWN0aW9uLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtCYWNrYm9uZS5Nb2RlbH0gKi9cblx0bW9kZWw6IFR5cGVJdGVtXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBUeXBlQ29sbGVjdGlvbigpO1xuIiwiLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYm9vdHN0cmFwKSB7XG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cblx0dmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcblxuXHQvLyBHbG9iYWxzLkdBX1RBR1MgPSBib290c3RyYXBbXCJnYS10YWdzXCJdO1xuXHQvLyBHbG9iYWxzLlBBUkFNUyA9IGJvb3RzdHJhcFtcInBhcmFtc1wiXTtcblx0Ly8gR2xvYmFscy5BUFBfUk9PVCA9IGJvb3RzdHJhcFtcInBhcmFtc1wiXVtcInJvb3RcIl07XG5cdC8vIEdsb2JhbHMuTUVESUFfRElSID0gYm9vdHN0cmFwW1wicGFyYW1zXCJdW1widXBsb2Fkc1wiXTtcblx0R2xvYmFscy5BUFBfTkFNRSA9IGJvb3RzdHJhcFtcInBhcmFtc1wiXVtcIndlYnNpdGUtbmFtZVwiXTtcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9UeXBlQ29sbGVjdGlvbn0gKi9cblx0dmFyIHR5cGVMaXN0ID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9uXCIpO1xuXHQvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvbn0gKi9cblx0dmFyIGtleXdvcmRMaXN0ID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9uXCIpO1xuXHQvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9ufSAqL1xuXHR2YXIgYnVuZGxlTGlzdCA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uXCIpO1xuXHQvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvbn0gKi9cblx0dmFyIGFydGljbGVMaXN0ID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9uXCIpO1xuXG5cdC8vIEZpeC11cHMgdG8gYm9vdHN0cmFwIGRhdGEuXG5cdHZhciBhcnRpY2xlcyA9IGJvb3RzdHJhcFtcImFydGljbGVzLWFsbFwiXTtcblx0dmFyIHR5cGVzID0gYm9vdHN0cmFwW1widHlwZXMtYWxsXCJdO1xuXHR2YXIga2V5d29yZHMgPSBib290c3RyYXBbXCJrZXl3b3Jkcy1hbGxcIl07XG5cdHZhciBidW5kbGVzID0gYm9vdHN0cmFwW1wiYnVuZGxlcy1hbGxcIl07XG5cdHZhciBtZWRpYSA9IGJvb3RzdHJhcFtcIm1lZGlhLWFsbFwiXTtcblxuXHQvLyBBdHRhY2ggbWVkaWEgdG8gdGhlaXIgYnVuZGxlc1xuXHR2YXIgbWVkaWFCeUJ1bmRsZSA9IF8uZ3JvdXBCeShtZWRpYSwgXCJiSWRcIik7XG5cblx0Ly8gRmlsbC1pbiBiYWNrLXJlZmVyZW5jZXM6XG5cdC8vIENyZWF0ZSBLZXl3b3JkLmJ1bmRsZUlkcyBmcm9tIGV4aXN0aW5nIEJ1bmRsZS5rZXl3b3JkSWRzLFxuXHQvLyB0aGVuIEJ1bmRsZS50eXBlSWRzIGZyb20gdW5pcXVlIEtleXdvcmQudHlwZUlkXG5cblx0Ly8gXy5lYWNoKGJ1bmRsZXMsIGZ1bmN0aW9uIChibywgYmksIGJhKSB7XG5cdGJ1bmRsZXMuZm9yRWFjaChmdW5jdGlvbihibywgYmksIGJhKSB7XG5cdFx0Ym8udElkcyA9IFtdO1xuXHRcdGJvLm1lZGlhID0gbWVkaWFCeUJ1bmRsZVtiby5pZF07XG5cdFx0Ly8gXy5lYWNoKGtleXdvcmRzLCBmdW5jdGlvbiAoa28sIGtpLCBrYSkge1xuXHRcdGtleXdvcmRzLmZvckVhY2goZnVuY3Rpb24oa28sIGtpLCBrYSkge1xuXHRcdFx0aWYgKGJpID09PSAwKSB7XG5cdFx0XHRcdGtvLmJJZHMgPSBbXTtcblx0XHRcdH1cblx0XHRcdC8vIGlmIChfLmNvbnRhaW5zKGJvLmtJZHMsIGtvLmlkKSkge1xuXHRcdFx0aWYgKGJvLmtJZHMuaW5kZXhPZihrby5pZCkgIT0gLTEpIHtcblx0XHRcdFx0a28uYklkcy5wdXNoKGJvLmlkKTtcblx0XHRcdFx0Ly8gaWYgKCFfLmNvbnRhaW5zKGJvLnRJZHMsIGtvLnRJZCkpIHtcblx0XHRcdFx0aWYgKGJvLnRJZHMuaW5kZXhPZihrby50SWQpID09IC0xKSB7XG5cdFx0XHRcdFx0Ym8udElkcy5wdXNoKGtvLnRJZCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG5cblx0Ly8gRmlsbCBjb2xsZWN0aW9uIHNpbmdsZXRvbnNcblx0YXJ0aWNsZUxpc3QucmVzZXQoYXJ0aWNsZXMpO1xuXHR0eXBlTGlzdC5yZXNldCh0eXBlcyk7XG5cdGtleXdvcmRMaXN0LnJlc2V0KGtleXdvcmRzKTtcblx0YnVuZGxlTGlzdC5yZXNldChidW5kbGVzKTtcblxuXHQvLyBib290c3RyYXBbXCJwYXJhbXNcIl0gPSBib290c3RyYXBbXCJhcnRpY2xlcy1hbGxcIl0gPSBib290c3RyYXBbXCJ0eXBlcy1hbGxcIl0gPSBib290c3RyYXBbXCJrZXl3b3Jkcy1hbGxcIl0gPSBib290c3RyYXBbXCJidW5kbGVzLWFsbFwiXSA9IGJvb3RzdHJhcFtcIm1lZGlhLWFsbFwiXSA9IG51bGw7XG59OyIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvaXRlbS9BcnRpY2xlSXRlbVxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vU291cmNlSXRlbX0gKi9cbnZhciBCYXNlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvQmFzZUl0ZW1cIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL0FydGljbGVJdGVtfVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IEJhc2VJdGVtLmV4dGVuZCh7XG5cblx0X2RvbVByZWZpeDogXCJhXCIsXG5cblx0LyoqIEB0eXBlIHtPYmplY3R9ICovXG5cdGRlZmF1bHRzOiB7XG5cdFx0bmFtZTogXCJcIixcblx0XHRoYW5kbGU6IFwiXCIsXG5cdFx0dGV4dDogXCJcIlxuXHR9LFxuXG59KTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2l0ZW0vQnVuZGxlSXRlbVxuICogQHJlcXVpcmVzIG1vZHVsZTpiYWNrYm9uZVxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtfSAqL1xudmFyIEJhc2VJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9CYXNlSXRlbVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbX0gKi9cbnZhciBNZWRpYUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9ufSAqL1xudmFyIFNlbGVjdGFibGVDb2xsZWN0aW9uID0gcmVxdWlyZShcImFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvblwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdXRpbHMvc3RyaW5ncy9zdHJpcFRhZ3N9ICovXG52YXIgc3RyaXBUYWdzID0gcmVxdWlyZShcInV0aWxzL3N0cmluZ3Mvc3RyaXBUYWdzXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3V0aWxzL3N0cmluZ3MvcGFyc2VUYWdsaXN0fSAqL1xuLy8gdmFyIHBhcnNlU3ltQXR0cnMgPSByZXF1aXJlKFwiYXBwL21vZGVsL3BhcnNlU3ltQXR0cnNcIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9ufSAqL1xuLy8gdmFyIGtleXdvcmRzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9uXCIpO1xuXG4vLyBHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wiY29sb3JcIl07XG4vLyBHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wiYmFja2dyb3VuZC1jb2xvclwiXTtcbnZhciBhdHRyc0RlZmF1bHQgPSBfLmRlZmF1bHRzKHtcblx0XCJoYXMtY29sb3JzXCI6IFwiZGVmYXVsdHNcIlxufSwgR2xvYmFscy5ERUZBVUxUX0NPTE9SUyk7XG5cbi8qKiBAcHJpdmF0ZSAqL1xudmFyIE1lZGlhQ29sbGVjdGlvbiA9IFNlbGVjdGFibGVDb2xsZWN0aW9uLmV4dGVuZCh7XG5cdG1vZGVsOiBNZWRpYUl0ZW0sXG5cdGNvbXBhcmF0b3I6IFwib1wiXG59KTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vQnVuZGxlSXRlbX1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBCYXNlSXRlbS5leHRlbmQoe1xuXG5cdF9kb21QcmVmaXg6IFwiYlwiLFxuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fEZ1bmN0aW9ufSAqL1xuXHQvLyBkZWZhdWx0czogZnVuY3Rpb24oKSB7XG5cdC8vIFx0cmV0dXJuIHtcblx0Ly8gXHRcdG5hbWU6IFwiXCIsXG5cdC8vIFx0XHRoYW5kbGU6IFwiXCIsXG5cdC8vIFx0XHRkZXNjOiBcIlwiLFxuXHQvLyBcdFx0Y29tcGxldGVkOiAwLFxuXHQvLyBcdFx0a0lkczogW10sXG5cdC8vIFx0fTtcblx0Ly8gfSxcblx0ZGVmYXVsdHM6IHtcblx0XHRuYW1lOiBcIlwiLFxuXHRcdGhhbmRsZTogXCJcIixcblx0XHRkZXNjOiBcIlwiLFxuXHRcdGNvbXBsZXRlZDogMCxcblx0XHRnZXQga0lkcygpIHtcblx0XHRcdHJldHVybiBbXTtcblx0XHR9LFxuXHRcdC8vIGdldCBrZXl3b3JkcygpIHsgcmV0dXJuIFtdOyB9LFxuXHR9LFxuXG5cdGdldHRlcnM6IFtcIm5hbWVcIiwgXCJtZWRpYVwiXSxcblxuXHRtdXRhdG9yczoge1xuXHRcdHRleHQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHN0cmlwVGFncyh0aGlzLmdldChcImRlc2NcIikpO1xuXHRcdH0sXG5cdFx0Ly8ga0lkczoge1xuXHRcdC8vIFx0c2V0OiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgb3B0aW9ucywgc2V0KSB7XG5cdFx0Ly8gXHRcdGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuXHRcdC8vIFx0XHRcdHNldChcImtleXdvcmRzXCIsIHZhbHVlLm1hcChmdW5jdGlvbihpZCkge1xuXHRcdC8vIFx0XHRcdFx0dmFyIG9iaiA9IGtleXdvcmRzLmdldChpZCk7XG5cdFx0Ly8gXHRcdFx0XHRyZXR1cm4gb2JqO1xuXHRcdC8vIFx0XHRcdH0sIHRoaXMpLCBvcHRpb25zO1xuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHRcdHNldChrZXksIHZhbHVlLCBvcHRpb25zKTtcblx0XHQvLyBcdH0sXG5cdFx0Ly8gfSxcblx0XHRtZWRpYToge1xuXHRcdFx0dHJhbnNpZW50OiB0cnVlLFxuXHRcdFx0c2V0OiBmdW5jdGlvbihrZXksIHZhbHVlLCBvcHRpb25zLCBzZXQpIHtcblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG5cdFx0XHRcdFx0dmFsdWUuZm9yRWFjaChmdW5jdGlvbihvKSB7XG5cdFx0XHRcdFx0XHRvLmJ1bmRsZSA9IHRoaXM7XG5cdFx0XHRcdFx0fSwgdGhpcyk7XG5cdFx0XHRcdFx0dmFsdWUgPSBuZXcgTWVkaWFDb2xsZWN0aW9uKHZhbHVlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRzZXQoa2V5LCB2YWx1ZSwgb3B0aW9ucyk7XG5cdFx0XHR9LFxuXHRcdH0sXG5cdH0sXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cnMsIG9wdGlvbnMpIHtcblx0XHR0aGlzLmNvbG9ycyA9IHtcblx0XHRcdGZnQ29sb3I6IG5ldyBDb2xvcih0aGlzLmF0dHIoXCJjb2xvclwiKSksXG5cdFx0XHRiZ0NvbG9yOiBuZXcgQ29sb3IodGhpcy5hdHRyKFwiYmFja2dyb3VuZC1jb2xvclwiKSksXG5cdFx0XHRsbkNvbG9yOiBuZXcgQ29sb3IodGhpcy5hdHRyKFwibGluay1jb2xvclwiKSksXG5cdFx0fTtcblx0XHR0aGlzLmNvbG9ycy5oYXNEYXJrQmcgPSB0aGlzLmNvbG9ycy5mZ0NvbG9yLmx1bWlub3NpdHkoKSA+IHRoaXMuY29sb3JzLmJnQ29sb3IubHVtaW5vc2l0eSgpO1xuXHR9LFxuXG5cdGF0dHJzOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5fYXR0cnMgfHwgKHRoaXMuX2F0dHJzID0gXy5kZWZhdWx0cyh7fSwgdGhpcy5nZXQoXCJhdHRyc1wiKSwgYXR0cnNEZWZhdWx0KSk7XG5cdH0sXG59KTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2l0ZW0vS2V5d29yZEl0ZW1cbiAqIEByZXF1aXJlcyBtb2R1bGU6YXBwL21vZGVsL0Jhc2VJdGVtXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL0Jhc2VJdGVtfSAqL1xudmFyIEJhc2VJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9CYXNlSXRlbVwiKTtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vVHlwZUNvbGxlY3Rpb259ICovXG4vLyB2YXIgdHlwZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vVHlwZUNvbGxlY3Rpb25cIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL0tleXdvcmRJdGVtfVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IEJhc2VJdGVtLmV4dGVuZCh7XG5cblx0X2RvbVByZWZpeDogXCJrXCIsXG5cblx0LyoqIEB0eXBlIHtPYmplY3R9ICovXG5cdGRlZmF1bHRzOiB7XG5cdFx0bmFtZTogXCJcIixcblx0XHRoYW5kbGU6IFwiXCIsXG5cdFx0dElkOiAtMSxcblx0fSxcblxuXHQvLyBtdXRhdG9yczoge1xuXHQvLyBcdHRJZDoge1xuXHQvLyBcdFx0c2V0OiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgb3B0aW9ucywgc2V0KSB7XG5cdC8vIFx0XHRcdHZhciB0eXBlID0gdHlwZXMuZ2V0KHZhbHVlKTtcblx0Ly8gXHRcdFx0aWYgKHR5cGUpIHtcblx0Ly8gXHRcdFx0XHR0eXBlLmdldChcImtleXdvcmRzXCIpLnB1c2godGhpcyk7XG5cdC8vIFx0XHRcdFx0c2V0KFwidHlwZVwiLCB0eXBlLCBvcHRpb25zKTtcblx0Ly8gXHRcdFx0fVxuXHQvLyBcdFx0XHRzZXQoa2V5LCB2YWx1ZSwgb3B0aW9ucyk7XG5cdC8vIFx0XHR9XG5cdC8vIFx0fSxcblx0Ly8gfVxufSk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtXG4gKiBAcmVxdWlyZXMgbW9kdWxlOmJhY2tib25lXG4gKi9cblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL1NvdXJjZUl0ZW19ICovXG52YXIgQmFzZUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL0Jhc2VJdGVtXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vU291cmNlSXRlbX0gKi9cbnZhciBTb3VyY2VJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9pdGVtL1NvdXJjZUl0ZW1cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb259ICovXG52YXIgU2VsZWN0YWJsZUNvbGxlY3Rpb24gPSByZXF1aXJlKFwiYXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9uXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC91dGlscy9zdHJpbmdzL3N0cmlwVGFnc30gKi9cbnZhciBzdHJpcFRhZ3MgPSByZXF1aXJlKFwidXRpbHMvc3RyaW5ncy9zdHJpcFRhZ3NcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvcGFyc2VTeW1BdHRyc30gKi9cbi8vIHZhciBwYXJzZVN5bUF0dHJzID0gcmVxdWlyZShcImFwcC9tb2RlbC9wYXJzZVN5bUF0dHJzXCIpO1xuXG4vLyBjb25zb2xlLmxvZyhHbG9iYWxzLlBBUkFNUyk7XG5cbnZhciB1cmxUZW1wbGF0ZXMgPSB7XG5cdFwib3JpZ2luYWxcIjogXy50ZW1wbGF0ZShHbG9iYWxzLk1FRElBX0RJUiArIFwiLzwlPSBzcmMgJT5cIiksXG5cdFwiY29uc3RyYWluLXdpZHRoXCI6IF8udGVtcGxhdGUoR2xvYmFscy5BUFBfUk9PVCArIFwiaW1hZ2UvMS88JT0gd2lkdGggJT4vMC91cGxvYWRzLzwlPSBzcmMgJT5cIiksXG5cdFwiY29uc3RyYWluLWhlaWdodFwiOiBfLnRlbXBsYXRlKEdsb2JhbHMuQVBQX1JPT1QgKyBcImltYWdlLzEvMC88JT0gaGVpZ2h0ICU+L3VwbG9hZHMvPCU9IHNyYyAlPlwiKSxcblx0XCJkZWJ1Zy1iYW5kd2lkdGhcIjogXy50ZW1wbGF0ZShHbG9iYWxzLk1FRElBX0RJUi5yZXBsYWNlKC8oaHR0cHM/XFw6XFwvXFwvW15cXC9dKykvLCBcIiQxL3Nsb3cvPCU9IGticHMgJT5cIikgKyBcIi88JT0gc3JjICU+XCIpLFxufTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtLlNvdXJjZUNvbGxlY3Rpb259XG4gKi9cbnZhciBTb3VyY2VDb2xsZWN0aW9uID0gU2VsZWN0YWJsZUNvbGxlY3Rpb24uZXh0ZW5kKHtcblx0bW9kZWw6IFNvdXJjZUl0ZW1cbn0pO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9NZWRpYUl0ZW19XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gQmFzZUl0ZW0uZXh0ZW5kKHtcblxuXHRfZG9tUHJlZml4OiBcIm1cIixcblxuXHQvKiogQHR5cGUge09iamVjdH0gKi9cblx0ZGVmYXVsdHM6IHtcblx0XHRuYW1lOiBcIjxwPjxlbT5VbnRpdGxlZDwvZW0+PC9wPlwiLFxuXHRcdHN1YjogXCJcIixcblx0XHRvOiAwLFxuXHRcdGJJZDogLTEsXG5cdFx0c3JjSWR4OiAwLFxuXHRcdGdldCBzcmNzZXQoKSB7XG5cdFx0XHRyZXR1cm4gW107XG5cdFx0fSxcblx0XHRnZXQgc291cmNlcygpIHtcblx0XHRcdHJldHVybiBuZXcgU291cmNlQ29sbGVjdGlvbigpO1xuXHRcdH0sXG5cdH0sXG5cblx0Z2V0dGVyczogW1wibmFtZVwiLCBcImJ1bmRsZVwiLCBcInNvdXJjZVwiLCBcInNvdXJjZXNcIl0sXG5cblx0bXV0YXRvcnM6IHtcblx0XHQvLyBkZXNjOiBmdW5jdGlvbigpIHtcblx0XHQvLyBcdHJldHVybiB0aGlzLmdldChcIm5hbWVcIik7XG5cdFx0Ly8gfSxcblx0XHRoYW5kbGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZ2V0KFwic3JjXCIpO1xuXHRcdH0sXG5cdFx0dGV4dDogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIXRoaXMuaGFzT3duUHJvcGVydHkoXCJfdGV4dFwiKSlcblx0XHRcdFx0dGhpcy5fdGV4dCA9IF8udW5lc2NhcGUoc3RyaXBUYWdzKHRoaXMuZ2V0KFwibmFtZVwiKSkpO1xuXHRcdFx0cmV0dXJuIHRoaXMuX3RleHQ7XG5cdFx0fSxcblx0XHRhdHRyczoge1xuXHRcdFx0c2V0OiBmdW5jdGlvbihrZXksIHZhbHVlLCBvcHRzLCBzZXQpIHtcblx0XHRcdFx0dGhpcy5fYXR0cnMgPSBudWxsO1xuXHRcdFx0XHRCYXNlSXRlbS5wcm90b3R5cGUubXV0YXRvcnMuYXR0cnMuc2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdHRoaXMuX3VwZGF0ZVNvdXJjZXMoKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHNyY3NldDoge1xuXHRcdFx0c2V0OiBmdW5jdGlvbihrZXksIHZhbHVlLCBvcHRzLCBzZXQpIHtcblx0XHRcdFx0c2V0KGtleSwgdmFsdWUsIG9wdHMpO1xuXHRcdFx0XHR0aGlzLmdldChcInNvdXJjZXNcIikucmVzZXQodmFsdWUsIG9wdHMpO1xuXHRcdFx0XHR0aGlzLl91cGRhdGVTb3VyY2VzKCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzb3VyY2U6IHtcblx0XHRcdHRyYW5zaWVudDogdHJ1ZSxcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmdldChcInNvdXJjZXNcIikuYXQodGhpcy5nZXQoXCJzcmNJZHhcIikpO1xuXHRcdFx0fSxcblx0XHR9LFxuXHR9LFxuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX3VwZGF0ZUNvbG9ycygpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJjaGFuZ2U6YXR0cnMgY2hhbmdlOmJ1bmRsZVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuX2F0dHJzID0gbnVsbDtcblx0XHR9KTtcblx0fSxcblxuXHRhdHRyczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX2F0dHJzIHx8ICh0aGlzLl9hdHRycyA9IF8uZGVmYXVsdHMoe30sIHRoaXMuZ2V0KFwiYnVuZGxlXCIpLmF0dHJzKCksIHRoaXMuZ2V0KFwiYXR0cnNcIikpKTtcblx0fSxcblxuXHRfdXBkYXRlQ29sb3JzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmNvbG9ycyA9IHtcblx0XHRcdGZnQ29sb3I6IG5ldyBDb2xvcih0aGlzLmF0dHIoXCJjb2xvclwiKSksXG5cdFx0XHRiZ0NvbG9yOiBuZXcgQ29sb3IodGhpcy5hdHRyKFwiYmFja2dyb3VuZC1jb2xvclwiKSlcblx0XHR9O1xuXHRcdHRoaXMuY29sb3JzLmhhc0RhcmtCZyA9IHRoaXMuY29sb3JzLmZnQ29sb3IubHVtaW5vc2l0eSgpID4gdGhpcy5jb2xvcnMuYmdDb2xvci5sdW1pbm9zaXR5KCk7XG5cdH0sXG5cblx0X3VwZGF0ZVNvdXJjZXM6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBzcmNPYmogPSB7XG5cdFx0XHRrYnBzOiB0aGlzLmF0dHIoXCJAZGVidWctYmFuZHdpZHRoXCIpXG5cdFx0fTtcblx0XHR2YXIgc3JjVHBsID0gdXJsVGVtcGxhdGVzW3NyY09iai5rYnBzID8gXCJkZWJ1Zy1iYW5kd2lkdGhcIiA6IFwib3JpZ2luYWxcIl07XG5cdFx0dGhpcy5nZXQoXCJzb3VyY2VzXCIpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0c3JjT2JqLnNyYyA9IGl0ZW0uZ2V0KFwic3JjXCIpO1xuXHRcdFx0aXRlbS5zZXQoXCJvcmlnaW5hbFwiLCBzcmNUcGwoc3JjT2JqKSk7XG5cdFx0fSk7XG5cdH0sXG5cblx0Ly8gX3VwZGF0ZVNvdXJjZXNBcnI6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdHZhciBzcmNzZXQgPSB0aGlzLmdldChcInNyY3NldFwiKTtcblx0Ly8gXHRpZiAoQXJyYXkuaXNBcnJheShzcmNzZXQpKSB7XG5cdC8vIFx0XHR2YXIgc3JjT2JqID0geyBrYnBzOiB0aGlzLmF0dHIoXCJAZGVidWctYmFuZHdpZHRoXCIpIH07XG5cdC8vIFx0XHR2YXIgc3JjVHBsID0gR2xvYmFscy5NRURJQV9TUkNfVFBMW3NyY09iai5rYnBzPyBcImRlYnVnLWJhbmR3aWR0aFwiIDogXCJvcmlnaW5hbFwiXTtcblx0Ly8gXHRcdHNyY3NldC5mb3JFYWNoKGZ1bmN0aW9uKG8pIHtcblx0Ly8gXHRcdFx0c3JjT2JqLnNyYyA9IG8uc3JjO1xuXHQvLyBcdFx0XHRvLm9yaWdpbmFsID0gc3JjVHBsKHNyY09iaik7XG5cdC8vIFx0XHR9LCB0aGlzKTtcblx0Ly8gXHR9XG5cdC8vIFx0dGhpcy5nZXQoXCJzb3VyY2VzXCIpLnJlc2V0KHNyY3NldCk7XG5cdC8vIH0sXG5cbn0pOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtXG4gKiBAcmVxdWlyZXMgbW9kdWxlOmJhY2tib25lXG4gKi9cblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xuLy8gdmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL1NvdXJjZUl0ZW19ICovXG52YXIgQmFzZUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL0Jhc2VJdGVtXCIpO1xuXG4vKiogQHR5cGUge1N0cmluZ30gKi9cbnZhciBub0NhY2hlU3VmZml4ID0gXCI/XCIgKyBEYXRlLm5vdygpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtfVxuICovXG4vLyBtb2R1bGUuZXhwb3J0cyA9IEJhY2tib25lLk1vZGVsLmV4dGVuZCh7XG5tb2R1bGUuZXhwb3J0cyA9IEJhc2VJdGVtLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtPYmplY3R9ICovXG5cdGRlZmF1bHRzOiB7XG5cdFx0c3JjOiBudWxsLFxuXHRcdG1pbWU6IG51bGwsXG5cdFx0dzogbnVsbCxcblx0XHRoOiBudWxsLFxuXHR9LFxuXG5cdGdldHRlcnM6IFtcInNyY1wiLCBcIm9yaWdpbmFsXCJdLFxuXG5cdG11dGF0b3JzOiB7XG5cdFx0c3JjOiB7XG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKGtleSwgdmFsdWUsIG9wdGlvbnMsIHNldCkge1xuXHRcdFx0XHRpZiAoREVCVUcpIHtcblx0XHRcdFx0XHR2YWx1ZSArPSBub0NhY2hlU3VmZml4O1xuXHRcdFx0XHR9XG5cdFx0XHRcdHNldChrZXksIHZhbHVlLCBvcHRpb25zKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdC8vIG9yaWdpbmFsOiB7IFxuXHRcdC8vIFx0dHJhbnNpZW50OiB0cnVlLFxuXHRcdC8vIFx0Z2V0OiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgb3B0aW9ucywgc2V0KSB7XG5cdFx0Ly8gXHRcdHJldHVybiB0aGlzLmF0dHJpYnV0ZXMub3JpZ2luYWwgfHwgKHRoaXMuYXR0cmlidXRlcy5vcmlnaW5hbCA9IHRoaXMuX2NvbXBvc2VPcmlnaW5hbFNyYygpKTtcblx0XHQvLyBcdH0sXG5cdFx0Ly8gfSxcblx0XHQvLyBtZWRpYToge1xuXHRcdC8vIFx0dHJhbnNpZW50OiB0cnVlLFxuXHRcdC8vIFx0Z2V0OiBmdW5jdGlvbiAoKSB7XG5cdFx0Ly8gXHRcdHZhciByZXR2YWw7XG5cdFx0Ly8gXHRcdGlmICh0aGlzLl9ub1JlY3VzaW9uKSB7XG5cdFx0Ly8gXHRcdFx0Y29uc29sZS5sb2coXCIlczo6bWVkaWEgcmV0dXJuaW5nIG51bGxcIiwgdGhpcy5jaWQpO1xuXHRcdC8vIFx0XHRcdHJldHZhbCA9IG51bGw7Ly90aGlzLmlkO1xuXHRcdC8vIFx0XHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Om1lZGlhIHJldHVybmluZyBPYmplY3RcIiwgdGhpcy5jaWQpO1xuXHRcdC8vIFx0XHRcdHRoaXMuX25vUmVjdXNpb24gPSB0cnVlO1xuXHRcdC8vIFx0XHRcdHJldHZhbCA9IHRoaXMuYXR0cmlidXRlcy5tZWRpYTtcblx0XHQvLyBcdFx0XHR0aGlzLl9ub1JlY3VzaW9uID0gZmFsc2U7XG5cdFx0Ly8gXHRcdH1cblx0XHQvLyBcdFx0cmV0dXJuIHJldHZhbDtcblx0XHQvLyBcdH0sXG5cdFx0Ly8gXHRzZXQ6IGZ1bmN0aW9uIChrZXksIHZhbHVlLCBvcHRpb25zLCBzZXQpIHtcblx0XHQvLyBcdFx0aWYgKHZhbHVlIGluc3RhbmNlb2YgQmFzZUl0ZW0pIHtcblx0XHQvLyBcdFx0XHRzZXQoa2V5LCB2YWx1ZSwgb3B0aW9ucyk7XG5cdFx0Ly8gXHRcdH1cblx0XHQvLyBcdH0sXG5cdFx0Ly8gfSxcblx0fSxcblxuXHQvLyBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcblx0Ly8gXHRpZiAoREVCVUcpIHtcblx0Ly8gXHRcdHZhciBjYiA9IGZ1bmN0aW9uKCkge1xuXHQvLyBcdFx0XHQvLyBjb25zb2xlLmxvZyhcIkBkZWJ1Zy1iYW5kd2lkdGg6XCIsIEpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0KFwibWVkaWFcIikuYXR0cihcIkBkZWJ1Zy1iYW5kd2lkdGhcIikpKTtcblx0Ly8gXHRcdFx0Y29uc29sZS5sb2coXCJtZWRpYTpcIiwgSlNPTi5zdHJpbmdpZnkodGhpcy50b0pTT04oKSkpO1xuXHQvLyBcdFx0XHQvLyBpZiAoKHRoaXMuZ2V0KFwibWVkaWFcIikgaW5zdGFuY2VvZiBCYXNlSXRlbSkgJiYgdGhpcy5nZXQoXCJtZWRpYVwiKS5hdHRyKFwiQGRlYnVnLWJhbmR3aWR0aFwiKSkge1xuXHQvLyBcdFx0XHQvLyBcdGNvbnNvbGUubG9nKFwib3JpZ2luYWxcIiwgdGhpcy5nZXQoXCJvcmlnaW5hbFwiKSk7XG5cdC8vIFx0XHRcdC8vIFx0Y29uc29sZS5sb2coXCJtZWRpYTpcIiwgSlNPTi5zdHJpbmdpZnkodGhpcy5nZXQoXCJtZWRpYVwiKS50b0pTT04oKSkpO1xuXHQvLyBcdFx0XHQvLyB9XG5cdC8vIFx0XHR9LmJpbmQodGhpcyk7XG5cdC8vIFx0XHR3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGNiKTtcblx0Ly8gXHR9XG5cdC8vIH0sXG5cdC8vIFxuXHQvLyBfY29tcG9zZU9yaWdpbmFsU3JjOiBmdW5jdGlvbigpIHtcblx0Ly8gXHR2YXIgdmFsdWVzID0geyBzcmM6IHRoaXMuZ2V0KFwic3JjXCIpIH07XG5cdC8vIFx0aWYgKHRoaXMuaGFzKFwibWVkaWFcIikgJiYgKHZhbHVlcy5rYnBzID0gdGhpcy5nZXQoXCJtZWRpYVwiKS5hdHRyKFwiQGRlYnVnLWJhbmR3aWR0aFwiKSkpIHtcblx0Ly8gXHQvLyBpZiAodGhpcy5oYXMoXCJtZWRpYVwiKSAmJiB0aGlzLmdldChcIm1lZGlhXCIpLmF0dHJzKCkuaGFzT3duUHJvcGVydHkoXCJAZGVidWctYmFuZHdpZHRoXCIpKSB7XG5cdC8vIFx0Ly8gXHR2YWx1ZXMua2JwcyA9IHRoaXMuZ2V0KFwibWVkaWFcIikuYXR0cnMoKVtcIkBkZWJ1Zy1iYW5kd2lkdGhcIl07XG5cdC8vIFx0XHRyZXR1cm4gR2xvYmFscy5NRURJQV9TUkNfVFBMW1wiZGVidWctYmFuZHdpZHRoXCJdKHZhbHVlcyk7XG5cdC8vIFx0fVxuXHQvLyBcdHJldHVybiBHbG9iYWxzLk1FRElBX1NSQ19UUExbXCJvcmlnaW5hbFwiXSh2YWx1ZXMpO1xuXHQvLyB9LFxufSk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2l0ZW0vVHlwZUl0ZW1cbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL1NvdXJjZUl0ZW19ICovXG52YXIgQmFzZUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL0Jhc2VJdGVtXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9UeXBlSXRlbX1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBCYXNlSXRlbS5leHRlbmQoe1xuXG5cdF9kb21QcmVmaXg6IFwidFwiLFxuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdG5hbWU6IFwiXCIsXG5cdFx0aGFuZGxlOiBcIlwiLFxuXHRcdC8vIGdldCBrSWRzKCkgeyByZXR1cm4gW107IH0sXG5cdFx0Ly8gZ2V0IGtleXdvcmRzKCkgeyByZXR1cm4gW107IH0sXG5cdH0sXG5cbn0pO1xuIiwiLyoqXG4vKiBAbW9kdWxlIGFwcC92aWV3L0FwcFZpZXdcbi8qL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xudmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdXRpbHMvZGVidWcvdHJhY2VBcmdzfSAqL1xudmFyIHN0cmlwVGFncyA9IHJlcXVpcmUoXCJ1dGlscy9zdHJpbmdzL3N0cmlwVGFnc1wiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9Db250cm9sbGVyfSAqL1xudmFyIGNvbnRyb2xsZXIgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvQ29udHJvbGxlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9BcHBTdGF0ZX0gKi9cbnZhciBBcHBTdGF0ZSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvQXBwU3RhdGVcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9ufSAqL1xudmFyIGJ1bmRsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvblwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9ufSAqL1xudmFyIGFydGljbGVzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9uXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9OYXZpZ2F0aW9uVmlld30gKi9cbnZhciBOYXZpZ2F0aW9uVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9OYXZpZ2F0aW9uVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L0NvbnRlbnRWaWV3fSAqL1xudmFyIENvbnRlbnRWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L0NvbnRlbnRWaWV3XCIpO1xuXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVG91Y2hNYW5hZ2VyfSAqL1xudmFyIFRvdWNoTWFuYWdlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1RvdWNoTWFuYWdlclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzfSAqL1xuLy8gdmFyIEhhbW1lciA9IHJlcXVpcmUoXCJoYW1tZXJqc1wiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3RvdWNoL1Ntb290aFBhblJlY29nbml6ZXJ9ICovXG4vLyB2YXIgUGFuID0gcmVxdWlyZShcInV0aWxzL3RvdWNoL1Ntb290aFBhblJlY29nbml6ZXJcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpoYW1tZXJqcy5UYXB9ICovXG4vLyB2YXIgVGFwID0gSGFtbWVyLlRhcDtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvZGVidWcvdHJhY2VFbGVtZW50fSAqL1xuLy8gdmFyIHRyYWNlRWxlbWVudCA9IHJlcXVpcmUoXCJ1dGlscy9kZWJ1Zy90cmFjZUVsZW1lbnRcIik7XG4vL1xuLy8gdmFyIHZwYW5Mb2dGbiA9IF8uZGVib3VuY2UoY29uc29sZS5sb2cuYmluZChjb25zb2xlKSwgMTAwLCBmYWxzZSk7XG4vLyB2YXIgaHBhbkxvZ0ZuID0gXy5kZWJvdW5jZShjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpLCAxMDAsIGZhbHNlKTtcblxudmFyIEFwcFZpZXcgPSB7XG5cdGdldEluc3RhbmNlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoISh3aW5kb3cuYXBwIGluc3RhbmNlb2YgdGhpcykpIHtcblx0XHRcdHdpbmRvdy5hcHAgPSBuZXcodGhpcykoe1xuXHRcdFx0XHRtb2RlbDogbmV3IEFwcFN0YXRlKClcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRyZXR1cm4gd2luZG93LmFwcDtcblx0fVxufTtcblxudmFyIEFwcFZpZXdQcm90byA9IHtcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNpZFByZWZpeDogXCJhcHBcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRlbDogXCJodG1sXCIsXG5cdC8vIC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImFwcCB3aXRob3V0LWJ1bmRsZSB3aXRob3V0LW1lZGlhIHdpdGhvdXQtYXJ0aWNsZVwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdG1vZGVsOiBBcHBTdGF0ZSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGV2ZW50czoge1xuXHRcdFwidmlzaWJpbGl0eWNoYW5nZVwiOiBmdW5jdGlvbihldikge1xuXHRcdFx0Y29uc29sZS5sb2coZXYudHlwZSk7XG5cdFx0fSxcblx0XHRcImZ1bGxzY3JlZW5jaGFuZ2VcIjogZnVuY3Rpb24oZXYpIHtcblx0XHRcdGNvbnNvbGUubG9nKGV2LnR5cGUpO1xuXHRcdH0sXG5cdFx0XCJkcmFnc3RhcnRcIjogZnVuY3Rpb24oZXYpIHtcblx0XHRcdGlmIChldi50YXJnZXQubm9kZU5hbWUgPT0gXCJJTUdcIiB8fCBldi50YXJnZXQubm9kZU5hbWUgPT0gXCJBXCIpIHtcblx0XHRcdFx0ZXYuZGVmYXVsdFByZXZlbnRlZCB8fCBldi5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0Y29udGFpbmVyOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY29udGFpbmVyIHx8XG5cdFx0XHRcdFx0KHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY29udGFpbmVyXCIpKTtcblx0XHRcdFx0Ly8gKHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LmJvZHkpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0bmF2aWdhdGlvbjoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX25hdmlnYXRpb24gfHxcblx0XHRcdFx0XHQodGhpcy5fbmF2aWdhdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmF2aWdhdGlvblwiKSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRjb250ZW50OiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY29udGVudCB8fFxuXHRcdFx0XHRcdCh0aGlzLl9jb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250ZW50XCIpKTtcblx0XHRcdH1cblx0XHR9LFxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdC8qIGVsZW1lbnRzICovXG5cdFx0Ly8gdGhpcy5yb3V0ZUVsID0gdGhpcy5lbDtcblx0XHQvLyB0aGlzLnN0YXRlRWwgPSB0aGlzLmVsXG5cdFx0dGhpcy5icmVha3BvaW50RWwgPSB0aGlzLmVsO1xuXHRcdC8vIHRoaXMudG91Y2hFbCA9IGRvY3VtZW50LmJvZHk7XG5cdFx0Ly8gdGhpcy50b3VjaEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250YWludGVyXCIpO1xuXG5cdFx0LyogaW5pdCBIYW1tZXJKUyBoYW5kbGVycyAqL1xuXHRcdHZhciB2dG91Y2gsIGh0b3VjaDtcblx0XHQvLyB2YXIgdnBhbiwgaHBhbiwgdGFwO1xuXG5cdFx0Ly8gdGhpcy5fdnBhbkVuYWJsZUZuID0gZnVuY3Rpb24obWMsIGV2KSB7XG5cdFx0Ly8gXHR2YXIgcmV0dmFsID0gIXRoaXMuX2hhc092ZXJmbG93WSh0aGlzLmNvbnRhaW5lcik7XG5cdFx0Ly8gXHR2cGFuTG9nRm4oXCIlczo6X3ZwYW5FbmFibGVGbiAtPiAlb1xcbiVvXCIsIHRoaXMuY2lkLCByZXR2YWwsIGFyZ3VtZW50cyk7XG5cdFx0Ly8gXHRyZXR1cm4gcmV0dmFsO1xuXHRcdC8vIH0uYmluZCh0aGlzKTtcblx0XHQvL1xuXHRcdC8vIHRoaXMuX2hwYW5FbmFibGVGbiA9IGZ1bmN0aW9uKG1jLCBldikge1xuXHRcdC8vIFx0dmFyIHJldHZhbCA9IHRoaXMubW9kZWwuZ2V0KFwid2l0aEJ1bmRsZVwiKSAmJiB0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKTtcblx0XHQvLyBcdGhwYW5Mb2dGbihcIiVzOjpfaHBhbkVuYWJsZUZuIC0+ICVvXFxuJW9cIiwgdGhpcy5jaWQsIHJldHZhbCwgYXJndW1lbnRzKTtcblx0XHQvLyBcdHJldHVybiAhIXJldHZhbDtcblx0XHQvLyB9LmJpbmQodGhpcyk7XG5cblx0XHR2dG91Y2ggPSBodG91Y2ggPSBUb3VjaE1hbmFnZXIuaW5pdCh0aGlzLmNvbnRlbnQpO1xuXHRcdC8vIHZ0b3VjaC5nZXQoXCJ2cGFuXCIpLnNldCh7IGVuYWJsZTogdGhpcy5fdnBhbkVuYWJsZUZuIH0pO1xuXHRcdC8vIGh0b3VjaC5nZXQoXCJocGFuXCIpLnNldCh7IGVuYWJsZTogdGhpcy5faHBhbkVuYWJsZUZuIH0pO1xuXHRcdC8vIFx0XHR2dG91Y2guc2V0KHtcblx0XHQvLyBcdFx0XHRlbmFibGU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIFx0XHRcdFx0Y29uc29sZS5sb2coXCJhcHAxOjpoYW1tZXJqcyBlbmFibGVcIiwgYXJndW1lbnRzKTtcblx0XHQvLyBcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdC8vIFx0XHRcdH1cblx0XHQvLyBcdFx0fSk7XG5cdFx0Ly8gaHBhbiA9IHZwYW47XG5cblx0XHQvLyB0aGlzLmVsLnN0eWxlLnRvdWNoQWN0aW9uID0gXCJub25lXCI7IC8vXCJwYW4teCBwYW4teVwiO1xuXG5cdFx0Ly8gdGFwID0gbmV3IEhhbW1lci5UYXAoKTtcblx0XHQvLyBocGFuID0gbmV3IFBhbih7XG5cdFx0Ly8gXHRldmVudDogXCJocGFuXCIsXG5cdFx0Ly8gXHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fSE9SSVpPTlRBTFxuXHRcdC8vIH0pO1xuXHRcdC8vIGhwYW4uc2V0KHtcblx0XHQvLyBcdGVuYWJsZTogdGhpcy5faHBhbkVuYWJsZUZuXG5cdFx0Ly8gfSk7XG5cdFx0Ly8gdnBhbiA9IG5ldyBQYW4oe1xuXHRcdC8vIFx0ZXZlbnQ6IFwidnBhblwiLFxuXHRcdC8vIFx0ZGlyZWN0aW9uOiBIYW1tZXIuRElSRUNUSU9OX1ZFUlRJQ0FMXG5cdFx0Ly8gfSk7XG5cdFx0Ly8gdnBhbi5zZXQoe1xuXHRcdC8vIFx0ZW5hYmxlOiB0aGlzLl92cGFuRW5hYmxlRm5cblx0XHQvLyB9KTtcblx0XHQvLyBocGFuLnJlcXVpcmVGYWlsdXJlKHZwYW4pO1xuXHRcdC8vIHZwYW4ucmVxdWlyZUZhaWx1cmUoaHBhbik7XG5cblx0XHQvLyB2dG91Y2ggPSBuZXcgSGFtbWVyLk1hbmFnZXIodGhpcy5uYXZpZ2F0aW9uKTtcblx0XHQvLyB2dG91Y2guYWRkKFtdKTtcblxuXHRcdC8vIGh0b3VjaCA9IHZ0b3VjaCA9IG5ldyBIYW1tZXIuTWFuYWdlcih0aGlzLmNvbnRlbnQpO1xuXHRcdC8vIGh0b3VjaC5hZGQoW3RhcCwgaHBhbiwgdnBhbl0pO1xuXHRcdC8vIGh0b3VjaC5hZGQoW2hwYW4sIHZwYW5dKTtcblx0XHQvLyBodG91Y2guc2V0KHsgdG91Y2hBY3Rpb246IFwicGFuLXggcGFuLXlcIiB9KTtcblxuXHRcdC8vIHZwYW4gPSBuZXcgSGFtbWVyKHRoaXMubmF2aWdhdGlvbiwge1xuXHRcdC8vIFx0cmVjb2duaXplcnM6IFtcblx0XHQvLyBcdFx0W1Bhbiwge1xuXHRcdC8vIFx0XHRcdGV2ZW50OiAndnBhbicsXG5cdFx0Ly8gXHRcdFx0dG91Y2hBY3Rpb246IFwicGFuLXlcIixcblx0XHQvLyBcdFx0XHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwsXG5cdFx0Ly8gXHRcdFx0ZW5hYmxlOiB2cGFuRW5hYmxlRm5cblx0XHQvLyBcdFx0fV0sXG5cdFx0Ly8gXHRdXG5cdFx0Ly8gfSk7XG5cdFx0Ly8gaHBhbiA9IG5ldyBIYW1tZXIodGhpcy5jb250ZW50LCB7XG5cdFx0Ly8gXHRyZWNvZ25pemVyczogW1xuXHRcdC8vIFx0XHRbUGFuLCB7XG5cdFx0Ly8gXHRcdFx0ZXZlbnQ6ICdocGFuJyxcblx0XHQvLyBcdFx0XHR0b3VjaEFjdGlvbjogXCJwYW4teFwiLFxuXHRcdC8vIFx0XHRcdGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9IT1JJWk9OVEFMLFxuXHRcdC8vIFx0XHRcdGVuYWJsZTogaHBhbkVuYWJsZUZuXG5cdFx0Ly8gXHRcdH1dLFxuXHRcdC8vIFx0XHRbVGFwXVxuXHRcdC8vIFx0XVxuXHRcdC8vIH0pO1xuXHRcdC8vIGhwYW4uZ2V0KFwiaHBhblwiKS5yZXF1aXJlRmFpbHVyZSh2cGFuLmdldChcInZwYW5cIikpO1xuXG5cdFx0Ly8gdGhpcy5fYWZ0ZXJSZW5kZXIgPSB0aGlzLl9hZnRlclJlbmRlci5iaW5kKHRoaXMpO1xuXHRcdHRoaXMuX29uUmVzaXplID0gdGhpcy5fb25SZXNpemUuYmluZCh0aGlzKTtcblxuXHRcdC8qIHJlbmRlciBvbiByZXNpemUsIG9ub3JpZW50YXRpb25jaGFuZ2UsIHZpc2liaWxpdHljaGFuZ2UgKi9cblx0XHQvLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9yaWVudGF0aW9uY2hhbmdlXCIsIHRoaXMuX29uUmVzaXplLCBmYWxzZSk7XG5cdFx0Ly8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgXy5kZWJvdW5jZSh0aGlzLl9vblJlc2l6ZS5iaW5kKHRoaXMpLCAzMCwgZmFsc2UpLCBmYWxzZSk7XG5cdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdGhpcy5fb25SZXNpemUsIGZhbHNlKTtcblxuXHRcdC8vIHZhciBoID0gZnVuY3Rpb24oZXYpIHsgY29uc29sZS5sb2coZXYudHlwZSwgZXYpIH07XG5cdFx0Ly8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgaCwgZmFsc2UpO1xuXHRcdC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwid2hlZWxcIiwgaCwgZmFsc2UpO1xuXG5cdFx0LyogVE9ETzogcmVwbGFjZSByZXNpemUgdy8gbWVkaWFxdWVyeSBsaXN0ZW5lcnMuIENhdmVhdDogc29tZSBjb21wb25lbnRzXG5cdFx0KHZnLiBDYXJvdXNlbCkgcmVxdWlyZSB1cGRhdGUgb24gcmVzaXplICovXG5cdFx0Ly8gdGhpcy5fb25CcmVha3BvaW50Q2hhbmdlID0gdGhpcy5fb25CcmVha3BvaW50Q2hhbmdlLmJpbmQodGhpcyk7XG5cdFx0Ly8gT2JqZWN0LmtleXMoR2xvYmFscy5CUkVBS1BPSU5UUykuZm9yRWFjaChmdW5jdGlvbihzKSB7XG5cdFx0Ly8gXHRHbG9iYWxzLkJSRUFLUE9JTlRTW3NdLmFkZExpc3RlbmVyKHRoaXMuX29uQnJlYWtwb2ludENoYW5nZSk7XG5cdFx0Ly8gfSwgdGhpcyk7XG5cblx0XHQvKiBpbml0aWFsaXplIGNvbnRyb2xsZXIvbW9kZWwgbGlzdGVuZXJzIEJFRk9SRSB2aWV3cyByZWdpc3RlciB0aGVpciBvd24gKi9cblx0XHR0aGlzLmxpc3RlblRvKGNvbnRyb2xsZXIsIFwicm91dGVcIiwgdGhpcy5fb25Sb3V0ZSk7XG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyhjb250cm9sbGVyLCBcImNoYW5nZTphZnRlclwiLCB0aGlzLl9hZnRlckNvbnRyb2xsZXJDaGFuZ2VkKTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlXCIsIHRoaXMuX29uTW9kZWxDaGFuZ2UpOyAvKiBGSVhNRSAqL1xuXG5cdFx0LyogaW5pdGlhbGl6ZSB2aWV3cyAqL1xuXHRcdHRoaXMubmF2aWdhdGlvblZpZXcgPSBuZXcgTmF2aWdhdGlvblZpZXcoe1xuXHRcdFx0ZWw6IHRoaXMubmF2aWdhdGlvbixcblx0XHRcdG1vZGVsOiB0aGlzLm1vZGVsLFxuXHRcdFx0dnBhbjogdnRvdWNoLFxuXHRcdFx0aHBhbjogaHRvdWNoXG5cdFx0fSk7XG5cblx0XHR0aGlzLmNvbnRlbnRWaWV3ID0gbmV3IENvbnRlbnRWaWV3KHtcblx0XHRcdGVsOiB0aGlzLmNvbnRlbnQsXG5cdFx0XHRtb2RlbDogdGhpcy5tb2RlbCxcblx0XHRcdHZwYW46IHZ0b3VjaCxcblx0XHRcdGhwYW46IGh0b3VjaCxcblx0XHR9KTtcblxuXHRcdC8qIEdvb2dsZSBBbmFseXRpY3MgKi9cblx0XHRpZiAod2luZG93LmdhICYmIHdpbmRvdy5HQV9JRCkge1xuXHRcdFx0Y29udHJvbGxlclxuXHRcdFx0XHQub25jZShcInJvdXRlXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHdpbmRvdy5nYShcImNyZWF0ZVwiLCB3aW5kb3cuR0FfSUQsIFwiYXV0b1wiKTtcblx0XHRcdFx0XHQvLyBpZiBsb2NhbGhvc3Qgb3IgZHVtbXkgSUQsIGRpc2FibGUgYW5hbHl0aWNzXG5cdFx0XHRcdFx0aWYgKC8oPzoobG9jYWxob3N0fFxcLmxvY2FsKSkkLy50ZXN0KGxvY2F0aW9uLmhvc3RuYW1lKVxuXHRcdFx0XHRcdFx0fHwgd2luZG93LkdBX0lEID09IFwiVUEtMDAwMDAwMC0wXCIpIHtcblx0XHRcdFx0XHRcdHdpbmRvdy5nYShcInNldFwiLCBcInNlbmRIaXRUYXNrXCIsIG51bGwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSlcblx0XHRcdFx0Lm9uKFwicm91dGVcIiwgZnVuY3Rpb24obmFtZSkge1xuXHRcdFx0XHRcdHZhciBwYWdlID0gQmFja2JvbmUuaGlzdG9yeS5nZXRGcmFnbWVudCgpO1xuXHRcdFx0XHRcdC8vIEFkZCBhIHNsYXNoIGlmIG5lY2Nlc2FyeVxuXHRcdFx0XHRcdHBhZ2UucmVwbGFjZSgvXig/IVxcLykvLCBcIi9cIik7XG5cdFx0XHRcdFx0d2luZG93LmdhKFwic2V0XCIsIFwicGFnZVwiLCBwYWdlKTtcblx0XHRcdFx0XHR3aW5kb3cuZ2EoXCJzZW5kXCIsIFwicGFnZXZpZXdcIik7XG5cdFx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8qIFN0YXJ0dXAgbGlzdGVuZXIsIGFkZGVkIGxhc3QgKi9cblx0XHR0aGlzLmxpc3RlblRvT25jZShjb250cm9sbGVyLCBcInJvdXRlXCIsIHRoaXMuX2FwcFN0YXJ0KTtcblxuXHRcdC8qIHN0YXJ0IHJvdXRlciwgd2hpY2ggd2lsbCByZXF1ZXN0IGFwcHJvcGlhdGUgc3RhdGUgKi9cblx0XHRCYWNrYm9uZS5oaXN0b3J5LnN0YXJ0KHtcblx0XHRcdHB1c2hTdGF0ZTogZmFsc2UsXG5cdFx0XHRoYXNoQ2hhbmdlOiB0cnVlLFxuXHRcdH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogX2FwcFN0YXJ0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfYXBwU3RhcnQ6IGZ1bmN0aW9uKG5hbWUsIGFyZ3MpIHtcblx0XHRjb25zb2xlLmluZm8oXCIlczo6X2FwcFN0YXJ0KCVzLCAlcylcIiwgdGhpcy5jaWQsIG5hbWUsIGFyZ3Muam9pbigpKTtcblx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwic2tpcC10cmFuc2l0aW9uc1wiKTtcblxuXHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3Lk1PREVMX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRClcblx0XHRcdC5yZXF1ZXN0Q2hpbGRyZW5SZW5kZXIoVmlldy5NT0RFTF9JTlZBTElEIHwgVmlldy5TSVpFX0lOVkFMSUQpXG5cdFx0XHQubGlzdGVuVG9PbmNlKHRoaXMsIFwidmlldzpyZW5kZXI6YWZ0ZXJcIiwgZnVuY3Rpb24odmlldywgZmxhZ3MpIHtcblx0XHRcdFx0Ly8gdGhpcy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9hcHBTdGFydFt2aWV3OnJlbmRlcjphZnRlcl1bcmFmXVwiLCB0aGlzLmNpZCk7XG5cdFx0XHRcdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSBmYWxzZTtcblx0XHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJza2lwLXRyYW5zaXRpb25zXCIpO1xuXHRcdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImFwcC1pbml0aWFsXCIpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHJvdXRlIGNoYW5nZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uUm91dGU6IGZ1bmN0aW9uKG5hbWUsIGFyZ3MpIHtcblx0XHRjb25zb2xlLmluZm8oXCIlczo6X29uUm91dGUgJW8gLT4gJW9cIiwgdGhpcy5jaWQsIHRoaXMubW9kZWwuZ2V0KFwicm91dGVOYW1lXCIpLCBuYW1lKTtcblx0XHR2YXIgbyA9IF8uZGVmYXVsdHMoeyByb3V0ZU5hbWU6IG5hbWUgfSwgQXBwU3RhdGUucHJvdG90eXBlLmRlZmF1bHRzKTtcblx0XHRzd2l0Y2ggKG5hbWUpIHtcblx0XHRcdGNhc2UgXCJtZWRpYS1pdGVtXCI6XG5cdFx0XHRcdG8uYnVuZGxlID0gYnVuZGxlcy5zZWxlY3RlZDtcblx0XHRcdFx0by53aXRoQnVuZGxlID0gdHJ1ZTtcblx0XHRcdFx0by5tZWRpYSA9IG8uYnVuZGxlLm1lZGlhLnNlbGVjdGVkO1xuXHRcdFx0XHRvLndpdGhNZWRpYSA9IHRydWU7XG5cdFx0XHRcdG8uY29sbGFwc2VkID0gdHJ1ZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiYnVuZGxlLWl0ZW1cIjpcblx0XHRcdFx0by5idW5kbGUgPSBidW5kbGVzLnNlbGVjdGVkO1xuXHRcdFx0XHRvLndpdGhCdW5kbGUgPSB0cnVlO1xuXHRcdFx0XHRvLmNvbGxhcHNlZCA9IHRydWU7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcImFydGljbGUtaXRlbVwiOlxuXHRcdFx0XHRvLmFydGljbGUgPSBhcnRpY2xlcy5zZWxlY3RlZDtcblx0XHRcdFx0by53aXRoQXJ0aWNsZSA9IHRydWU7XG5cdFx0XHRcdG8uY29sbGFwc2VkID0gdHJ1ZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiYnVuZGxlLWxpc3RcIjpcblx0XHRcdGNhc2UgXCJub3Rmb3VuZFwiOlxuXHRcdFx0Y2FzZSBcInJvb3RcIjpcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdG8uY29sbGFwc2VkID0gZmFsc2U7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpfb25Sb3V0ZSBhcmdzOiAlb1wiLCB0aGlzLmNpZCwgbmFtZSwgYXJncyk7XG5cdFx0dGhpcy5tb2RlbC5zZXQobyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogbW9kZWwgY2hhbmdlZFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25Nb2RlbENoYW5nZTogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6X29uTW9kZWxDaGFuZ2UgW1NUQVJUXVwiLCB0aGlzLmNpZCk7XG5cdFx0Y29uc29sZS5ncm91cCh0aGlzLmNpZCArIFwiOjpfb25Nb2RlbENoYW5nZVwiKTtcblx0XHRPYmplY3Qua2V5cyh0aGlzLm1vZGVsLmNoYW5nZWRBdHRyaWJ1dGVzKCkpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG5cdFx0XHRjb25zb2xlLmluZm8oXCIlczo6X29uTW9kZWxDaGFuZ2UgJXM6ICVzIC0+ICVzXCIsIHRoaXMuY2lkLCBrZXksXG5cdFx0XHRcdHRoaXMubW9kZWwucHJldmlvdXMoa2V5KSxcblx0XHRcdFx0dGhpcy5tb2RlbC5nZXQoa2V5KSk7XG5cdFx0fSwgdGhpcyk7XG5cblx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5NT0RFTF9JTlZBTElEKVxuXHRcdFx0Ly8gLnJlcXVlc3RDaGlsZHJlblJlbmRlcihWaWV3Lk1PREVMX0lOVkFMSUQpXG5cdFx0XHQub25jZShcInZpZXc6cmVuZGVyOmFmdGVyXCIsIGZ1bmN0aW9uKHZpZXcsIGZsYWdzKSB7XG5cdFx0XHRcdGNvbnNvbGUuaW5mbyhcIiVzOjpfb25Nb2RlbENoYW5nZSBbcmVuZGVyIGNvbXBsZXRlXVwiLCB2aWV3LmNpZCk7XG5cdFx0XHRcdGNvbnNvbGUuZ3JvdXBFbmQoKTtcblx0XHRcdH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogcmVzaXplXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25SZXNpemU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0Y29uc29sZS5ncm91cCh0aGlzLmNpZCArIFwiOjpfb25SZXNpemUgW2V2ZW50XVwiKTtcblx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwic2tpcC10cmFuc2l0aW9uc1wiKTtcblxuXHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRClcblx0XHRcdC8vIC53aGVuUmVuZGVyZWQoKS50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdC5vbmNlKFwidmlldzpyZW5kZXI6YWZ0ZXJcIiwgZnVuY3Rpb24odmlldywgZmxhZ3MpIHtcblx0XHRcdFx0Ly8gdGhpcy5yZXF1ZXN0Q2hpbGRyZW5SZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQsIHRydWUpO1xuXHRcdFx0XHQvLyB0aGlzLnNldEltbWVkaWF0ZShmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5pbmZvKFwiJXM6Ol9vblJlc2l6ZSBbdmlldzpyZW5kZXI6YWZ0ZXJdW3JhZl1cIiwgdmlldy5jaWQpO1xuXHRcdFx0XHRcdHZpZXcuc2tpcFRyYW5zaXRpb25zID0gZmFsc2U7XG5cdFx0XHRcdFx0dmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwic2tpcC10cmFuc2l0aW9uc1wiKTtcblx0XHRcdFx0XHRjb25zb2xlLmdyb3VwRW5kKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHR9KS5yZW5kZXJOb3coKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cmVuZGVyRnJhbWU6IGZ1bmN0aW9uKHRzdGFtcCwgZmxhZ3MpIHtcblx0XHRjb25zb2xlLmxvZyhcIiVzOjpyZW5kZXJGcmFtZSBbJXNdXCIsIHRoaXMuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpKTtcblxuXHRcdC8qIG1vZGVsOiBzZXQgcm91dGUgJiBtb2RlbCBpZCBjbGFzc2VzICovXG5cdFx0aWYgKGZsYWdzICYgVmlldy5NT0RFTF9JTlZBTElEKSB7XG5cdFx0XHR0aGlzLnJlbmRlck1vZGVsQ2hhbmdlKGZsYWdzKTtcblx0XHR9XG5cblx0XHQvKiBzaXplOiBjaGVjayBicmVha3BvaW50cyBhbmQgc2V0IGNsYXNzZXMqL1xuXHRcdGlmIChmbGFncyAmIFZpZXcuU0laRV9JTlZBTElEKSB7XG5cdFx0XHRfLmVhY2goR2xvYmFscy5CUkVBS1BPSU5UUywgZnVuY3Rpb24obywgcykge1xuXHRcdFx0XHR0aGlzLnRvZ2dsZShzLCBvLm1hdGNoZXMpO1xuXHRcdFx0fSwgdGhpcy5icmVha3BvaW50RWwuY2xhc3NMaXN0KTtcblx0XHR9XG5cdFx0LyogcmVxdWVzdCBjaGlsZHJlbiByZW5kZXI6ICBhbHdheXMgcmVuZGVyIG5vdyAqL1xuXHRcdHRoaXMucmVxdWVzdENoaWxkcmVuUmVuZGVyKGZsYWdzLCB0cnVlKTtcblx0XHQvKiByZXF1ZXN0IGNoaWxkcmVuIHJlbmRlcjogIHNldCAnbm93JyBmbGFnIGlmIHNpemUgaXMgaW52YWxpZCAqL1xuXHRcdC8vIHRoaXMucmVxdWVzdENoaWxkcmVuUmVuZGVyKGZsYWdzLCBmbGFncyAmIFZpZXcuU0laRV9JTlZBTElEKTtcblxuXHRcdC8vIGlmIChmbGFncyAmIChWaWV3Lk1PREVMX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRCkpIHtcblx0XHQvLyBcdHRoaXMubmF2aWdhdGlvbi5zdHlsZS50b3VjaEFjdGlvbiA9ICF0aGlzLl9oYXNPdmVyZmxvd1kodGhpcy5jb250YWluZXIpID8gXCJwYW4teFwiIDogXCJcIjtcblx0XHQvLyBcdHRoaXMuY29udGVudC5zdHlsZS50b3VjaEFjdGlvbiA9IHRoaXMuX2hwYW5FbmFibGVGbigpID8gXCJwYW4teVwiIDogXCJcIjtcblx0XHQvLyBcdHRoaXMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuXHRcdC8vIFx0XHRpZiAodGhpcy5faHBhbkVuYWJsZUZuKCkgJiYgdGhpcy5fdnBhbkVuYWJsZUZuKCkpIHtcblx0XHQvLyBcdFx0XHR0aGlzLmNvbnRlbnQuc3R5bGUudG91Y2hBY3Rpb24gPSBcIm5vbmVcIjtcblx0XHQvLyBcdFx0fSBlbHNlIGlmICh0aGlzLl9ocGFuRW5hYmxlRm4oKSkge1xuXHRcdC8vIFx0XHRcdHRoaXMuY29udGVudC5zdHlsZS50b3VjaEFjdGlvbiA9IFwicGFuLXlcIjtcblx0XHQvLyBcdFx0fSBlbHNlIGlmICh0aGlzLl92cGFuRW5hYmxlRm4oKSkge1xuXHRcdC8vIFx0XHRcdHRoaXMuY29udGVudC5zdHlsZS50b3VjaEFjdGlvbiA9IFwicGFuLXhcIjtcblx0XHQvLyBcdFx0fSBlbHNlIHtcblx0XHQvLyBcdFx0XHR0aGlzLmNvbnRlbnQuc3R5bGUudG91Y2hBY3Rpb24gPSBcImF1dG9cIjtcblx0XHQvLyBcdFx0fVxuXHRcdC8vIFx0XHQvLyBcdGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gMDtcblx0XHQvLyBcdFx0Ly8gXHR3aW5kb3cuc2Nyb2xsKHsgdG9wOiAwLCBiZWhhdmlvcjogXCJzbW9vdGhcIiB9KTtcblx0XHQvLyBcdH0pO1xuXHRcdC8vIH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIGJvZHkgY2xhc3NlcyBldGNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlbmRlck1vZGVsQ2hhbmdlOiBmdW5jdGlvbigpIHtcblxuXHRcdHZhciBjbHMgPSB0aGlzLmVsLmNsYXNzTGlzdDtcblx0XHR2YXIgcHJldkF0dHIgPSBudWxsO1xuXHRcdHZhciBkb2NUaXRsZSA9IFtdO1xuXHRcdHZhciBoYXNEYXJrQmcgPSBmYWxzZTtcblxuXHRcdGRvY1RpdGxlLnB1c2goR2xvYmFscy5BUFBfTkFNRSk7XG5cdFx0aWYgKHRoaXMubW9kZWwuZ2V0KFwiYnVuZGxlXCIpKSB7XG5cdFx0XHRkb2NUaXRsZS5wdXNoKHN0cmlwVGFncyh0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKS5nZXQoXCJuYW1lXCIpKSk7XG5cdFx0XHRpZiAodGhpcy5tb2RlbC5nZXQoXCJtZWRpYVwiKSkge1xuXHRcdFx0XHRkb2NUaXRsZS5wdXNoKHN0cmlwVGFncyh0aGlzLm1vZGVsLmdldChcIm1lZGlhXCIpLmdldChcIm5hbWVcIikpKTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKHRoaXMubW9kZWwuZ2V0KFwiYXJ0aWNsZVwiKSkge1xuXHRcdFx0ZG9jVGl0bGUucHVzaChzdHJpcFRhZ3ModGhpcy5tb2RlbC5nZXQoXCJhcnRpY2xlXCIpLmdldChcIm5hbWVcIikpKTtcblx0XHR9XG5cdFx0ZG9jdW1lbnQudGl0bGUgPSBfLnVuZXNjYXBlKGRvY1RpdGxlLmpvaW4oXCIgLyBcIikpO1xuXG5cdFx0LyogU2V0IHJvdXRlIGNsYXNzICovXG5cdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcInJvdXRlTmFtZVwiKSkge1xuXHRcdFx0cHJldkF0dHIgPSB0aGlzLm1vZGVsLnByZXZpb3VzKFwicm91dGVOYW1lXCIpO1xuXHRcdFx0aWYgKHByZXZBdHRyKSB7XG5cdFx0XHRcdGNscy5yZW1vdmUoXCJyb3V0ZS1cIiArIHByZXZBdHRyKTtcblx0XHRcdH1cblx0XHRcdGNscy5hZGQoXCJyb3V0ZS1cIiArIHRoaXMubW9kZWwuZ2V0KFwicm91dGVOYW1lXCIpKTtcblx0XHR9XG5cblx0XHQvKiBTZXQgbW9kZWwgaWQgY2xhc3NlcyBmb3IgY29sb3Igc3R5bGVzICovXG5cdFx0W1wiYXJ0aWNsZVwiLCBcImJ1bmRsZVwiLCBcIm1lZGlhXCJdLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuXHRcdFx0dmFyIGl0ZW0gPSB0aGlzLm1vZGVsLmdldChwcm9wKTtcblx0XHRcdGlmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQocHJvcCkpIHtcblx0XHRcdFx0cHJldkF0dHIgPSB0aGlzLm1vZGVsLnByZXZpb3VzKHByb3ApO1xuXHRcdFx0XHRpZiAocHJldkF0dHIpIHtcblx0XHRcdFx0XHRjbHMucmVtb3ZlKHByZXZBdHRyLmdldChcImRvbWlkXCIpKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoaXRlbSkge1xuXHRcdFx0XHRcdGNscy5hZGQoaXRlbS5nZXQoXCJkb21pZFwiKSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGNscy50b2dnbGUoXCJ3aXRoLVwiICsgcHJvcCwgISFpdGVtKTtcblx0XHRcdGNscy50b2dnbGUoXCJ3aXRob3V0LVwiICsgcHJvcCwgIWl0ZW0pO1xuXHRcdFx0aGFzRGFya0JnIHw9IChpdGVtICYmIGl0ZW0uY29sb3JzICYmIGl0ZW0uY29sb3JzLmhhc0RhcmtCZyk7XG5cdFx0fS5iaW5kKHRoaXMpKTtcblxuXHRcdC8qIGZsYWcgZGFyayBiYWNrZ3JvdW5kICovXG5cdFx0Y2xzLnRvZ2dsZShcImNvbG9yLWRhcmtcIiwgaGFzRGFya0JnKTtcblx0fSxcbn07XG5cbmlmIChERUJVRykge1xuXHQvKiogQHR5cGUge21vZHVsZTphcHAvZGVidWcvRGVidWdUb29sYmFyfSAqL1xuXHR2YXIgRGVidWdUb29sYmFyID0gcmVxdWlyZShcImFwcC9kZWJ1Zy9EZWJ1Z1Rvb2xiYXJcIik7XG5cblx0QXBwVmlld1Byb3RvLmluaXRpYWxpemUgPSAoZnVuY3Rpb24oZm4pIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcmV0dmFsO1xuXHRcdFx0dmFyIHZpZXcgPSBuZXcgRGVidWdUb29sYmFyKHtcblx0XHRcdFx0aWQ6IFwiZGVidWctdG9vbGJhclwiLFxuXHRcdFx0XHRtb2RlbDogdGhpcy5tb2RlbFxuXHRcdFx0fSk7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHZpZXcucmVuZGVyKCkuZWwpO1xuXHRcdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZTpsYXlvdXROYW1lXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gXHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQpOyAvLy5yZW5kZXJOb3coKTtcblx0XHRcdC8vIH0pO1xuXHRcdFx0cmV0dmFsID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdHRoaXMuX2xvZ0ZsYWdzW1widmlldy50cmFjZVwiXSA9IHRydWU7XG5cdFx0XHR0aGlzLm5hdmlnYXRpb25WaWV3Ll9sb2dGbGFnc1tcInZpZXcudHJhY2VcIl0gPSB0cnVlO1xuXHRcdFx0Ly8gdGhpcy5uYXZpZ2F0aW9uVmlldy5ncmFwaC5fbG9nRmxhZ3NbXCJ2aWV3LnRyYWNlXCJdID0gdHJ1ZTtcblx0XHRcdC8vIHRoaXMubmF2aWdhdGlvblZpZXcuYnVuZGxlTGlzdC5fbG9nRmxhZ3NbXCJ2aWV3LnRyYWNlXCJdID0gdHJ1ZTtcblx0XHRcdC8vIHRoaXMubmF2aWdhdGlvblZpZXcua2V5d29yZExpc3QuX2xvZ0ZsYWdzW1widmlldy50cmFjZVwiXSA9IHRydWU7XG5cdFx0XHRyZXR1cm4gcmV0dmFsO1xuXHRcdH07XG5cdH0pKEFwcFZpZXdQcm90by5pbml0aWFsaXplKTtcbn1cblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvQXBwVmlld31cbi8qL1xubW9kdWxlLmV4cG9ydHMgPSBWaWV3LmV4dGVuZChBcHBWaWV3UHJvdG8sIEFwcFZpZXcpOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9OYXZpZ2F0aW9uVmlld1xuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL1RyYW5zZm9ybUhlbHBlcn0gKi9cbnZhciBUcmFuc2Zvcm1IZWxwZXIgPSByZXF1aXJlKFwidXRpbHMvVHJhbnNmb3JtSGVscGVyXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXJ9ICovXG4vLyB2YXIgVG91Y2hNYW5hZ2VyID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVG91Y2hNYW5hZ2VyXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9Db250cm9sbGVyfSAqL1xudmFyIGNvbnRyb2xsZXIgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvQ29udHJvbGxlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb259ICovXG52YXIgYnVuZGxlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb259ICovXG52YXIgYXJ0aWNsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb25cIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUl0ZW19ICovXG4vLyB2YXIgQnVuZGxlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9CdW5kbGVJdGVtXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZVZpZXd9ICovXG52YXIgQXJ0aWNsZVZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVWaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0NvbGxlY3Rpb25TdGFja30gKi9cbnZhciBDb2xsZWN0aW9uU3RhY2sgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0NvbGxlY3Rpb25TdGFja1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uU3RhY2t9ICovXG52YXIgU2VsZWN0YWJsZUxpc3RWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9TZWxlY3RhYmxlTGlzdFZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvRG90TmF2aWdhdGlvblJlbmRlcmVyfSAqL1xudmFyIERvdE5hdmlnYXRpb25SZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvRG90TmF2aWdhdGlvblJlbmRlcmVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0Nhcm91c2VsfSAqL1xudmFyIENhcm91c2VsID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9DYXJvdXNlbFwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0Nhcm91c2VsUmVuZGVyZXJ9ICovXG52YXIgQ2Fyb3VzZWxSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvQ2Fyb3VzZWxSZW5kZXJlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9JbWFnZVJlbmRlcmVyfSAqL1xudmFyIEltYWdlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0ltYWdlUmVuZGVyZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvVmlkZW9SZW5kZXJlcn0gKi9cbnZhciBWaWRlb1JlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9WaWRlb1JlbmRlcmVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1NlcXVlbmNlUmVuZGVyZXJ9ICovXG52YXIgU2VxdWVuY2VSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyfSAqL1xuLy8gdmFyIFByb2dyZXNzTWV0ZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJcIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgY2Fyb3VzZWxFbXB0eVRlbXBsYXRlID0gcmVxdWlyZShcIi4vdGVtcGxhdGUvQ2Fyb3VzZWwuRW1wdHlSZW5kZXJlci5CdW5kbGUuaGJzXCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBtZWRpYVN0YWNrVGVtcGxhdGUgPSByZXF1aXJlKFwiLi90ZW1wbGF0ZS9Db2xsZWN0aW9uU3RhY2suTWVkaWEuaGJzXCIpO1xuXG4vLyB2YXIgdHJhbnNpdGlvbkVuZCA9IFZpZXcucHJlZml4ZWRFdmVudChcInRyYW5zaXRpb25lbmRcIik7XG52YXIgdHJhbnNmb3JtUHJvcCA9IFZpZXcucHJlZml4ZWRQcm9wZXJ0eShcInRyYW5zZm9ybVwiKTtcbnZhciB0cmFuc2l0aW9uUHJvcCA9IFZpZXcucHJlZml4ZWRQcm9wZXJ0eShcInRyYW5zaXRpb25cIik7XG5cbnZhciB0eCA9IEdsb2JhbHMudHJhbnNpdGlvbnM7XG5cblxuLy8gdmFyIGNsaWNrRXZlbnQgPSB3aW5kb3cuaGFzT3duUHJvcGVydHkoXCJvbnBvaW50ZXJ1cFwiKSA/IFwicG9pbnRlcnVwXCIgOiBcIm1vdXNldXBcIixcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvQ29udGVudFZpZXd9XG4gKi9cbnZhciBDb250ZW50VmlldyA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNpZFByZWZpeDogXCJjb250ZW50Vmlld1wiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImNvbnRhaW5lci1leHBhbmRlZFwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0ZXZlbnRzOiB7XG5cdFx0XCJ0cmFuc2l0aW9uZW5kIC5hZGRpbmctY2hpbGRcIjogXCJfb25BZGRlZFRyYW5zaXRpb25FbmRcIixcblx0XHRcInRyYW5zaXRpb25lbmQgLnJlbW92aW5nLWNoaWxkXCI6IFwiX29uUmVtb3ZlZFRyYW5zaXRpb25FbmRcIixcblx0XHQvLyBcInRyYW5zaXRpb25lbmRcIjogXCJfb25UcmFuc2l0aW9uRW5kXCIsXG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0Xy5iaW5kQWxsKHRoaXMsIFwiX29uVlBhblN0YXJ0XCIsIFwiX29uVlBhbk1vdmVcIiwgXCJfb25WUGFuRmluYWxcIiwgXCJfb25Db2xsYXBzZWRFdmVudFwiKTtcblxuXHRcdHRoaXMudHJhbnNmb3JtcyA9IG5ldyBUcmFuc2Zvcm1IZWxwZXIoKTtcblx0XHQvLyB0aGlzLnRvdWNoID0gb3B0aW9ucy50b3VjaCB8fCBuZXcgRXJyb3IoXCJubyB0b3VjaFwiKTsgLy9Ub3VjaE1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcblx0XHR0aGlzLnZwYW4gPSBvcHRpb25zLnZwYW4gfHwgbmV3IEVycm9yKFwibm8gdnBhblwiKTtcblx0XHR0aGlzLmhwYW4gPSBvcHRpb25zLmhwYW4gfHwgbmV3IEVycm9yKFwibm8gaHBhblwiKTtcblxuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJjaGFuZ2VcIiwgdGhpcy5fb25Nb2RlbENoYW5nZSk7XG5cblx0XHQvLyBkaXNjb25uZWN0IGNoaWxkcmVuIGJlZm9yZSBsYXN0IGNoYW5nZVxuXHRcdC8vIHRoaXMubGlzdGVuVG8oYnVuZGxlcywgXCJkZXNlbGVjdDpvbmVcIiwgdGhpcy5fb25EZXNlbGVjdE9uZUJ1bmRsZSk7XG5cblx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdFx0dGhpcy5pdGVtVmlld3MgPSBbXTtcblxuXHRcdC8vIHRoaXMucHJvZ3Jlc3NXcmFwcGVyID0gdGhpcy5jcmVhdGVQcm9ncmVzc1dyYXBwZXIoKSxcblx0XHQvLyB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMucHJvZ3Jlc3NXcmFwcGVyLmVsKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBSZW5kZXJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cmVuZGVyRnJhbWU6IGZ1bmN0aW9uKHRzdGFtcCwgZmxhZ3MpIHtcblx0XHQvLyB2YWx1ZXNcblx0XHR2YXIgY29sbGFwc2VkID0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdFx0dmFyIGNvbGxhcHNlZENoYW5nZWQgPSAoZmxhZ3MgJiBWaWV3Lk1PREVMX0lOVkFMSUQpXG5cdFx0XHQmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJjb2xsYXBzZWRcIik7XG5cdFx0dmFyIGNoaWxkcmVuQ2hhbmdlZCA9IChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRClcblx0XHRcdCYmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJidW5kbGVcIikgfHwgdGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiYXJ0aWNsZVwiKSk7XG5cblx0XHQvLyBmbGFnc1xuXHRcdHZhciBzaXplQ2hhbmdlZCA9ICEhKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpO1xuXHRcdHZhciB0cmFuc2Zvcm1zQ2hhbmdlZCA9ICEhKGZsYWdzICYgKFZpZXcuTU9ERUxfSU5WQUxJRCB8IFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCkpO1xuXHRcdHRyYW5zZm9ybXNDaGFuZ2VkID0gdHJhbnNmb3Jtc0NoYW5nZWQgfHwgdGhpcy5fdHJhbnNmb3Jtc0NoYW5nZWQgfHwgdGhpcy5za2lwVHJhbnNpdGlvbnM7XG5cblx0XHQvLyBkZWJ1Z1xuXHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdC8vIGlmIChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkge1xuXHRcdC8vIFx0Y29uc29sZS5ncm91cCh0aGlzLmNpZCArIFwiOjpyZW5kZXJGcmFtZSBtb2RlbCBjaGFuZ2VkOlwiKTtcblx0XHQvLyBcdE9iamVjdC5rZXlzKHRoaXMubW9kZWwuY2hhbmdlZCkuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcblx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCJcXHQlczogJXMgLT4gJXNcIiwga2V5LCB0aGlzLm1vZGVsLl9wcmV2aW91c0F0dHJpYnV0ZXNba2V5XSwgdGhpcy5tb2RlbC5jaGFuZ2VkW2tleV0pO1xuXHRcdC8vIFx0fSwgdGhpcyk7XG5cdFx0Ly8gXHRjb25zb2xlLmdyb3VwRW5kKCk7XG5cdFx0Ly8gfVxuXG5cdFx0Ly8gbW9kZWw6Y2hpbGRyZW5cblx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHRpZiAoY2hpbGRyZW5DaGFuZ2VkKSB7XG5cdFx0XHR0aGlzLnJlbW92ZUNoaWxkcmVuKCk7XG5cdFx0XHRpZiAoYnVuZGxlcy5zZWxlY3RlZCkge1xuXHRcdFx0XHR0aGlzLmNyZWF0ZUNoaWxkcmVuKGJ1bmRsZXMuc2VsZWN0ZWQpO1xuXHRcdFx0fSBlbHNlXG5cdFx0XHRpZiAoYXJ0aWNsZXMuc2VsZWN0ZWQpIHtcblx0XHRcdFx0dGhpcy5jcmVhdGVDaGlsZHJlbihhcnRpY2xlcy5zZWxlY3RlZCk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gbW9kZWw6Y29sbGFwc2VkXG5cdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0aWYgKGNvbGxhcHNlZENoYW5nZWQpIHtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImNvbnRhaW5lci1jb2xsYXBzZWRcIiwgY29sbGFwc2VkKTtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImNvbnRhaW5lci1leHBhbmRlZFwiLCAhY29sbGFwc2VkKTtcblx0XHR9XG5cblx0XHQvLyBzaXplXG5cdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0aWYgKHNpemVDaGFuZ2VkKSB7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMuY2xlYXJBbGxDYXB0dXJlcygpO1xuXHRcdH1cblxuXHRcdC8vIHRyYW5zZm9ybXNcblx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHRpZiAodHJhbnNmb3Jtc0NoYW5nZWQpIHtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbnRhaW5lci1jaGFuZ2luZ1wiKTtcblx0XHRcdGlmICh0aGlzLnNraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMuc3RvcEFsbFRyYW5zaXRpb25zKCk7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbnRhaW5lci1jaGFuZ2VkXCIpO1xuXHRcdFx0XHRpZiAoIWNoaWxkcmVuQ2hhbmdlZCkge1xuXHRcdFx0XHRcdC8vIHRoaXMudHJhbnNmb3Jtcy5jbGVhckFsbE9mZnNldHMoKTtcblx0XHRcdFx0XHRpZiAoY29sbGFwc2VkQ2hhbmdlZCkge1xuXHRcdFx0XHRcdFx0dGhpcy5fc2V0Q2hpbGRyZW5FbmFibGVkKGNvbGxhcHNlZCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoIWNoaWxkcmVuQ2hhbmdlZCkge1xuXHRcdFx0XHRcdGlmIChjb2xsYXBzZWRDaGFuZ2VkKSB7XG5cdFx0XHRcdFx0XHR2YXIgYWZ0ZXJUcmFuc2l0aW9uc0ZuO1xuXHRcdFx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwiY29udGFpbmVyLWNoYW5nZWRcIik7XG5cdFx0XHRcdFx0XHQvLyB0aGlzLnRyYW5zZm9ybXMuY2xlYXJBbGxPZmZzZXRzKCk7XG5cdFx0XHRcdFx0XHRpZiAoY29sbGFwc2VkKSB7XG5cdFx0XHRcdFx0XHRcdC8vIGNvbnRhaW5lci1jb2xsYXBzZWQsIGVuYWJsZSBsYXN0XG5cdFx0XHRcdFx0XHRcdGFmdGVyVHJhbnNpdGlvbnNGbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMuX3NldENoaWxkcmVuRW5hYmxlZCh0cnVlKTtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb250YWluZXItY2hhbmdlZFwiKTtcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnJ1bkFsbFRyYW5zaXRpb25zKHR4LkxBU1QpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0Ly8gY29udGFpbmVyLWV4cGFuZGVkLCBkaXNhYmxlIGZpcnN0XG5cdFx0XHRcdFx0XHRcdGFmdGVyVHJhbnNpdGlvbnNGbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbnRhaW5lci1jaGFuZ2VkXCIpO1xuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHR0aGlzLl9zZXRDaGlsZHJlbkVuYWJsZWQoZmFsc2UpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMucnVuQWxsVHJhbnNpdGlvbnModHguRklSU1QpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YWZ0ZXJUcmFuc2l0aW9uc0ZuID0gYWZ0ZXJUcmFuc2l0aW9uc0ZuLmJpbmQodGhpcyk7XG5cdFx0XHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMud2hlbkFsbFRyYW5zaXRpb25zRW5kKCkudGhlbihhZnRlclRyYW5zaXRpb25zRm4sIGFmdGVyVHJhbnNpdGlvbnNGbik7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKG8pIHtcblx0XHRcdFx0XHRcdFx0aWYgKG8uaGFzT2Zmc2V0KSB7XG5cdFx0XHRcdFx0XHRcdFx0by5ydW5UcmFuc2l0aW9uKHR4Lk5PVyk7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gby5jbGVhck9mZnNldCgpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmICghY2hpbGRyZW5DaGFuZ2VkKSB7XG5cdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5jbGVhckFsbE9mZnNldHMoKTtcblx0XHRcdH1cblx0XHRcdHRoaXMudHJhbnNmb3Jtcy52YWxpZGF0ZSgpO1xuXHRcdH1cblx0XHRpZiAoc2l6ZUNoYW5nZWQpIHtcblx0XHRcdHRoaXMuaXRlbVZpZXdzLmZvckVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHR2aWV3LnNraXBUcmFuc2l0aW9ucyA9IHRoaXMuc2tpcFRyYW5zaXRpb25zO1xuXHRcdFx0XHR2aWV3LnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQpLnJlbmRlck5vdygpO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0XHQvKlByb21pc2UuYWxsKHRoaXMuaXRlbVZpZXdzLm1hcChmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdFx0dmlldy5za2lwVHJhbnNpdGlvbnMgPSB0aGlzLnNraXBUcmFuc2l0aW9ucztcblx0XHRcdFx0XHRyZXR1cm4gdmlldy5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEKS53aGVuUmVuZGVyZWQoKTtcblx0XHRcdFx0fSwgdGhpcykpXG5cdFx0XHRcdC50aGVuKFxuXHRcdFx0XHRcdGZ1bmN0aW9uKHZpZXdzKSB7XG5cdFx0XHRcdFx0XHR2YXIgbmggPSB0aGlzLmVsLm9mZnNldFBhcmVudC5vZmZzZXRIZWlnaHQgLSB0aGlzLmVsLm9mZnNldFRvcDtcblx0XHRcdFx0XHRcdC8vIHZhciBvaCA9IHZpZXdzLnJlZHVjZShmdW5jdGlvbihoLCB2aWV3KSB7XG5cdFx0XHRcdFx0XHQvLyBcdHJldHVybiBNYXRoLm1heChoLCB2aWV3LmVsLm9mZnNldEhlaWdodCk7XG5cdFx0XHRcdFx0XHQvLyB9LCBuaCk7XG5cdFx0XHRcdFx0XHQvLyBvaCsrO1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczpbd2hlblJlbmRlcmVkXSBbcmVzdWx0OiAlcyAlc10gJW9cIiwgdGhpcy5jaWQsXG5cdFx0XHRcdFx0XHQvLyBcdG5oLCBvaCwgdGhpcy5lbC5wYXJlbnQsIHZpZXdzKTtcblx0XHRcdFx0XHRcdHRoaXMuZWwuc3R5bGUubWluSGVpZ2h0ID0gbmggKyBcInB4XCI7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdmlld3M7XG5cdFx0XHRcdFx0fS5iaW5kKHRoaXMpLFxuXHRcdFx0XHRcdGZ1bmN0aW9uKHJlYXNvbikge1xuXHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiJXM6W3doZW5SZW5kZXJlZF0gW3JlamVjdGVkXSAlb1wiLCB0aGlzLmNpZCwgcmVhc29uKTtcblx0XHRcdFx0XHRcdHJldHVybiByZWFzb247XG5cdFx0XHRcdFx0fS5iaW5kKHRoaXMpXG5cdFx0XHRcdCk7Ki9cblx0XHR9XG5cdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0aGlzLl90cmFuc2Zvcm1zQ2hhbmdlZCA9IGZhbHNlO1xuXHR9LFxuXG5cdF9zZXRDaGlsZHJlbkVuYWJsZWQ6IGZ1bmN0aW9uKGVuYWJsZWQpIHtcblx0XHQvLyBpZiAoZW5hYmxlZCkge1xuXHRcdC8vIFx0dGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fb25Db2xsYXBzZWRDbGljaywgZmFsc2UpO1xuXHRcdC8vIH0gZWxzZSB7XG5cdFx0Ly8gXHR0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9vbkNvbGxhcHNlZENsaWNrLCBmYWxzZSk7XG5cdFx0Ly8gfVxuXHRcdHRoaXMuaXRlbVZpZXdzLmZvckVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0dmlldy5zZXRFbmFibGVkKGVuYWJsZWQpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogQ29sbGFwc2UgVUkgZ2VzdHVyZXMvZXZlbnRzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25Db2xsYXBzZWRFdmVudDogZnVuY3Rpb24oZXYpIHtcblx0XHRjb25zb2xlLmxvZyhcIiVzOlslcyAtPiBfb25Db2xsYXBzZWRFdmVudF0gdGFyZ2V0OiAlc1wiLCB0aGlzLmNpZCwgZXYudHlwZSwgZXYudGFyZ2V0KTtcblx0XHRpZiAoIWV2LmRlZmF1bHRQcmV2ZW50ZWQgJiZcblx0XHRcdHRoaXMubW9kZWwuaGFzKFwiYnVuZGxlXCIpICYmXG5cdFx0XHQhdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikgJiZcblx0XHRcdCF0aGlzLmVuYWJsZWQpIHtcblx0XHRcdC8vIHRoaXMuc2V0SW1tZWRpYXRlKGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gaWYgKGV2LnR5cGUgPT0gXCJjbGlja1wiKSBldi5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGV2LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0aGlzLnNldEltbWVkaWF0ZShmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gaWYgKGV2LnR5cGUgPT0gXCJjbGlja1wiKSBldi5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0dGhpcy5tb2RlbC5zZXQoXCJjb2xsYXBzZWRcIiwgdHJ1ZSk7XG5cdFx0XHR9KTtcblx0XHRcdC8vIH0pO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBtb2RlbCBjaGFuZ2VkXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vbk1vZGVsQ2hhbmdlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwid2l0aEJ1bmRsZVwiKSkge1xuXHRcdFx0aWYgKHRoaXMubW9kZWwuaGFzKFwiYnVuZGxlXCIpKSB7XG5cdFx0XHRcdHRoaXMudnBhbi5vbihcInZwYW5zdGFydFwiLCB0aGlzLl9vblZQYW5TdGFydCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnZwYW4ub2ZmKFwidnBhbnN0YXJ0XCIsIHRoaXMuX29uVlBhblN0YXJ0KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Lypcblx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwid2l0aEJ1bmRsZVwiKSB8fFxuXHRcdFx0dGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHRpZiAodGhpcy5tb2RlbC5nZXQoXCJ3aXRoQnVuZGxlXCIpICYmXG5cdFx0XHRcdCF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0XHR0aGlzLmhwYW4ub24oXCJocGFubGVmdCBocGFucmlnaHRcIiwgdGhpcy5fb25Db2xsYXBzZWRFdmVudCk7XG5cdFx0XHRcdHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcihHbG9iYWxzLkNMSUNLX0VWRU5ULCB0aGlzLl9vbkNvbGxhcHNlZEV2ZW50LCBmYWxzZSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmhwYW4ub2ZmKFwiaHBhbmxlZnQgaHBhbnJpZ2h0XCIsIHRoaXMuX29uQ29sbGFwc2VkRXZlbnQpO1xuXHRcdFx0XHR0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoR2xvYmFscy5DTElDS19FVkVOVCwgdGhpcy5fb25Db2xsYXBzZWRFdmVudCwgZmFsc2UpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHQqL1xuXHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3Lk1PREVMX0lOVkFMSUQpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogVmVydGljYWwgdG91Y2gvbW92ZSAoX29uVlBhbiopXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfY29sbGFwc2VkT2Zmc2V0WTogR2xvYmFscy5DT0xMQVBTRV9PRkZTRVQsXG5cblx0X29uVlBhblN0YXJ0OiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMudnBhbi5vbihcInZwYW5tb3ZlXCIsIHRoaXMuX29uVlBhbk1vdmUpO1xuXHRcdHRoaXMudnBhbi5vbihcInZwYW5lbmQgdnBhbmNhbmNlbFwiLCB0aGlzLl9vblZQYW5GaW5hbCk7XG5cblx0XHR0aGlzLnRyYW5zZm9ybXMuc3RvcEFsbFRyYW5zaXRpb25zKCk7XG5cdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLmNsZWFyQWxsT2Zmc2V0cygpO1xuXHRcdC8vIHRoaXMudHJhbnNmb3Jtcy52YWxpZGF0ZSgpO1xuXHRcdHRoaXMudHJhbnNmb3Jtcy5jbGVhckFsbENhcHR1cmVzKCk7XG5cblx0XHR0aGlzLmVsLmNsYXNzTGlzdC5hZGQoXCJjb250YWluZXItY2hhbmdpbmdcIik7XG5cdFx0dGhpcy5fb25WUGFuTW92ZShldik7XG5cdH0sXG5cblx0X29uVlBhbk1vdmU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dmFyIGNvbGxhcHNlZCA9IHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpO1xuXHRcdHZhciBkZWx0YSA9IGV2LmRlbHRhWTsgLy9ldi50aHJlc2hvbGREZWx0YVk7XG5cdFx0dmFyIG1heERlbHRhID0gdGhpcy5fY29sbGFwc2VkT2Zmc2V0WTsgLy8gKyBNYXRoLmFicyhldi50aHJlc2hvbGRPZmZzZXRZKTtcblxuXHRcdC8vIGNoZWNrIGlmIGRpcmVjdGlvbiBpcyBhbGlnbmVkIHdpdGggY29sbGFwc2VkL2V4cGFuZFxuXHRcdHZhciBpc1ZhbGlkRGlyID0gY29sbGFwc2VkID8gKGRlbHRhID4gMCkgOiAoZGVsdGEgPCAwKTtcblx0XHR2YXIgbW92ZUZhY3RvciA9IGNvbGxhcHNlZCA/IEdsb2JhbHMuVlBBTl9EUkFHIDogMSAtIEdsb2JhbHMuVlBBTl9EUkFHO1xuXG5cdFx0ZGVsdGEgPSBNYXRoLmFicyhkZWx0YSk7IC8vIHJlbW92ZSBzaWduXG5cdFx0ZGVsdGEgKj0gbW92ZUZhY3Rvcjtcblx0XHRtYXhEZWx0YSAqPSBtb3ZlRmFjdG9yO1xuXG5cdFx0aWYgKGlzVmFsaWREaXIpIHtcblx0XHRcdGlmIChkZWx0YSA+IG1heERlbHRhKSB7IC8vIG92ZXJzaG9vdGluZ1xuXHRcdFx0XHRkZWx0YSA9ICgoZGVsdGEgLSBtYXhEZWx0YSkgKiBHbG9iYWxzLlZQQU5fT1VUX0RSQUcpICsgbWF4RGVsdGE7XG5cdFx0XHR9IGVsc2UgeyAvLyBubyBvdmVyc2hvb3Rpbmdcblx0XHRcdFx0Ly8gZGVsdGEgPSBkZWx0YTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0ZGVsdGEgPSAoLWRlbHRhKSAqIEdsb2JhbHMuVlBBTl9PVVRfRFJBRzsgLy8gZGVsdGEgaXMgb3Bwb3NpdGVcblx0XHR9XG5cdFx0ZGVsdGEgKj0gY29sbGFwc2VkID8gMSA6IC0xOyAvLyByZWFwcGx5IHNpZ25cblxuXHRcdHRoaXMudHJhbnNmb3Jtcy5vZmZzZXRBbGwoMCwgZGVsdGEpO1xuXHRcdHRoaXMudHJhbnNmb3Jtcy52YWxpZGF0ZSgpO1xuXHR9LFxuXG5cdF9vblZQYW5GaW5hbDogZnVuY3Rpb24oZXYpIHtcblx0XHR0aGlzLnZwYW4ub2ZmKFwidnBhbm1vdmVcIiwgdGhpcy5fb25WUGFuTW92ZSk7XG5cdFx0dGhpcy52cGFuLm9mZihcInZwYW5lbmQgdnBhbmNhbmNlbFwiLCB0aGlzLl9vblZQYW5GaW5hbCk7XG5cblx0XHQvLyBGSVhNRTogbW9kZWwuY29sbGFwc2VkIG1heSBoYXZlIGFscmVhZHkgY2hhbmdlZCwgX29uVlBhbk1vdmUgd291bGQgcnVuIHdpdGggd3JvbmcgdmFsdWVzOlxuXHRcdC8vIG1vZGVsLmNvbGxhcHNlZCBpcyBjaGFuZ2VkIGluIGEgc2V0SW1tZWRpYXRlIGNhbGxiYWNrIGZyb20gTmF2aWdhdGlvblZpZXcuXG5cblx0XHR0aGlzLl9vblZQYW5Nb3ZlKGV2KTtcblx0XHR0aGlzLnNldEltbWVkaWF0ZShmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuX3RyYW5zZm9ybXNDaGFuZ2VkID0gdHJ1ZTtcblx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcigpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8vIHdpbGxDb2xsYXBzZWRDaGFuZ2U6IGZ1bmN0aW9uKGV2KSB7XG5cdC8vIFx0dmFyIGNvbGxhcHNlZCA9IHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpO1xuXHQvLyBcdHJldHVybiBldi50eXBlID09IFwidnBhbmVuZFwiPyBjb2xsYXBzZWQ/XG5cdC8vIFx0XHRldi50aHJlc2hvbGREZWx0YVkgPiBHbG9iYWxzLkNPTExBUFNFX1RIUkVTSE9MRCA6XG5cdC8vIFx0XHRldi50aHJlc2hvbGREZWx0YVkgPCAtR2xvYmFscy5DT0xMQVBTRV9USFJFU0hPTEQgOlxuXHQvLyBcdFx0ZmFsc2U7XG5cdC8vIH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBjcmVhdGUvcmVtb3ZlIGNoaWxkcmVuIG9uIGJ1bmRsZSBzZWxlY3Rpb25cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBDcmVhdGUgY2hpbGRyZW4gb24gYnVuZGxlIHNlbGVjdCAqL1xuXHRjcmVhdGVDaGlsZHJlbjogZnVuY3Rpb24obW9kZWwpIHtcblx0XHR2YXIgdmlldztcblx0XHRpZiAobW9kZWwuX19wcm90b19fLmNvbnN0cnVjdG9yID09PSBidW5kbGVzLm1vZGVsKSB7XG5cdFx0XHQvLyB3aWxsIGJlIGF0dGFjaGVkIHRvIGRvbSBpbiB0aGlzIG9yZGVyXG5cdFx0XHR2aWV3ID0gdGhpcy5jcmVhdGVNZWRpYUNhcHRpb25TdGFjayhtb2RlbCk7XG5cdFx0XHR0aGlzLml0ZW1WaWV3cy5wdXNoKHZpZXcpO1xuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLmFkZCh2aWV3LmVsKTtcblx0XHRcdHZpZXcgPSB0aGlzLmNyZWF0ZU1lZGlhQ2Fyb3VzZWwobW9kZWwpO1xuXHRcdFx0dGhpcy5pdGVtVmlld3MucHVzaCh2aWV3KTtcblx0XHRcdHRoaXMudHJhbnNmb3Jtcy5hZGQodmlldy5lbCk7XG5cdFx0XHR2aWV3ID0gdGhpcy5jcmVhdGVNZWRpYURvdE5hdmlnYXRpb24obW9kZWwpO1xuXHRcdFx0dGhpcy5pdGVtVmlld3MucHVzaCh2aWV3KTtcblx0XHR9IGVsc2Vcblx0XHRpZiAobW9kZWwuX19wcm90b19fLmNvbnN0cnVjdG9yID09PSBhcnRpY2xlcy5tb2RlbCkge1xuXHRcdFx0dmlldyA9IHRoaXMuY3JlYXRlQXJ0aWNsZVZpZXcobW9kZWwpO1xuXHRcdFx0dGhpcy5pdGVtVmlld3MucHVzaCh2aWV3KTtcblx0XHR9XG5cblx0XHR0aGlzLml0ZW1WaWV3cy5mb3JFYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdGlmICghdGhpcy5za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdFx0dmlldy5lbC5jbGFzc0xpc3QuYWRkKFwiYWRkaW5nLWNoaWxkXCIpO1xuXHRcdFx0XHR2aWV3LmVsLnN0eWxlLm9wYWNpdHkgPSAwO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5lbC5hcHBlbmRDaGlsZCh2aWV3LmVsKTtcblx0XHRcdHZpZXcucmVuZGVyKCk7XG5cdFx0fSwgdGhpcyk7XG5cblx0XHRpZiAoIXRoaXMuc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0XHR0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCIlczo6Y3JlYXRlQ2hpbGRyZW46OltjYWxsYmFjazpyZXF1ZXN0QW5pbWF0aW9uRnJhbWVdXCIsIHRoaXMuY2lkKTtcblx0XHRcdFx0dGhpcy5pdGVtVmlld3MuZm9yRWFjaChmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdFx0aWYgKCF0aGlzLnNraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0XHRcdFx0dmlldy5lbC5zdHlsZVt0cmFuc2l0aW9uUHJvcF0gPSBcIm9wYWNpdHkgXCIgKyB0eC5MQVNULmNzc1RleHQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHZpZXcuZWwuc3R5bGUucmVtb3ZlUHJvcGVydHkoXCJvcGFjaXR5XCIpO1xuXHRcdFx0XHR9LCB0aGlzKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHRyZW1vdmVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5pdGVtVmlld3MuZm9yRWFjaChmdW5jdGlvbih2aWV3LCBpLCBhcnIpIHtcblx0XHRcdHRoaXMudHJhbnNmb3Jtcy5yZW1vdmUodmlldy5lbCk7XG5cdFx0XHRpZiAodGhpcy5za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdFx0dmlldy5yZW1vdmUoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHZhciBzID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodmlldy5lbCk7XG5cdFx0XHRcdGlmIChzLm9wYWNpdHkgPT0gXCIwXCIgfHwgcy52aXNpYmlsaXR5ID09IFwiaGlkZGVuXCIpIHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpyZW1vdmVDaGlsZHJlbiBbdmlldzolc10gcmVtb3ZlZCBpbW1lZGlhdGVseSAoaW52aXNpYmxlKVwiLCB0aGlzLmNpZCwgdmlldy5jaWQpO1xuXHRcdFx0XHRcdHZpZXcucmVtb3ZlKCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dmlldy5lbC5jbGFzc0xpc3QuYWRkKFwicmVtb3ZpbmctY2hpbGRcIik7XG5cdFx0XHRcdFx0aWYgKHNbdHJhbnNmb3JtUHJvcF0pIHZpZXcuZWwuc3R5bGVbdHJhbnNmb3JtUHJvcF0gPSBzW3RyYW5zZm9ybVByb3BdO1xuXHRcdFx0XHRcdHZpZXcuZWwuc3R5bGVbdHJhbnNpdGlvblByb3BdID0gXCJvcGFjaXR5IFwiICsgdHguRklSU1QuY3NzVGV4dDtcblx0XHRcdFx0XHR2aWV3LmVsLnN0eWxlLm9wYWNpdHkgPSAwO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRhcnJbaV0gPSBudWxsO1xuXHRcdH0sIHRoaXMpO1xuXHRcdHRoaXMuaXRlbVZpZXdzLmxlbmd0aCA9IDA7XG5cdH0sXG5cblx0X29uQWRkZWRUcmFuc2l0aW9uRW5kOiBmdW5jdGlvbihldikge1xuXHRcdGlmIChldi50YXJnZXQuY2lkICYmIHRoaXMuY2hpbGRWaWV3cy5oYXNPd25Qcm9wZXJ0eShldi50YXJnZXQuY2lkKSkge1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczo6X29uQWRkZWRUcmFuc2l0aW9uRW5kIFt2aWV3OiVzXSBbcHJvcDolc10gW2V2OiVzXVwiLCB0aGlzLmNpZCwgZXYudGFyZ2V0LmNpZCwgZXYucHJvcGVydHlOYW1lLCBldi50eXBlKTtcblx0XHRcdHZhciB2aWV3ID0gdGhpcy5jaGlsZFZpZXdzW2V2LnRhcmdldC5jaWRdO1xuXHRcdFx0dmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiYWRkaW5nLWNoaWxkXCIpO1xuXHRcdFx0dmlldy5lbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSh0cmFuc2l0aW9uUHJvcCk7XG5cdFx0fVxuXHR9LFxuXG5cdF9vblJlbW92ZWRUcmFuc2l0aW9uRW5kOiBmdW5jdGlvbihldikge1xuXHRcdGlmIChldi50YXJnZXQuY2lkICYmIHRoaXMuY2hpbGRWaWV3cy5oYXNPd25Qcm9wZXJ0eShldi50YXJnZXQuY2lkKSkge1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczo6X29uUmVtb3ZlZFRyYW5zaXRpb25FbmQgW3ZpZXc6JXNdIFtwcm9wOiVzXSBbZXY6JXNdXCIsIHRoaXMuY2lkLCBldi50YXJnZXQuY2lkLCBldi5wcm9wZXJ0eU5hbWUsIGV2LnR5cGUpO1xuXHRcdFx0dmFyIHZpZXcgPSB0aGlzLmNoaWxkVmlld3NbZXYudGFyZ2V0LmNpZF07XG5cdFx0XHR2aWV3LmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJyZW1vdmluZy1jaGlsZFwiKTtcblx0XHRcdHZpZXcucmVtb3ZlKCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIHB1cmdlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHQvLyBcdHZhciBpLCBlbCwgZWxzID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLnJlbW92aW5nLWNoaWxkXCIpO1xuXHQvLyBcdGZvciAoaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspIHtcblx0Ly8gXHRcdGVsID0gZWxzLml0ZW0oaSk7XG5cdC8vIFx0XHRpZiAoZWwucGFyZW50RWxlbWVudCA9PT0gdGhpcy5lbCkge1xuXHQvLyBcdFx0XHR0cnkge1xuXHQvLyBcdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCIlczo6cHVyZ2VDaGlsZHJlblwiLCB0aGlzLmNpZCwgZWwuZ2V0QXR0cmlidXRlKFwiZGF0YS1jaWRcIikpO1xuXHQvLyBcdFx0XHRcdFZpZXcuZmluZEJ5RWxlbWVudChlbCkucmVtb3ZlKCk7XG5cdC8vIFx0XHRcdH0gY2F0Y2ggKGVycikge1xuXHQvLyBcdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCJzOjpwdXJnZUNoaWxkcmVuXCIsIHRoaXMuY2lkLCBcIm9ycGhhbmVkIGVsZW1lbnRcIiwgZXJyKTtcblx0Ly8gXHRcdFx0XHR0aGlzLmVsLnJlbW92ZUNoaWxkKGVsKTtcblx0Ly8gXHRcdFx0fVxuXHQvLyBcdFx0fVxuXHQvLyBcdH1cblx0Ly8gfSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIENvbXBvbmVudHNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cblx0LyoqXG5cdCAqIG1lZGlhLWNhcm91c2VsXG5cdCAqL1xuXHRjcmVhdGVNZWRpYUNhcm91c2VsOiBmdW5jdGlvbihidW5kbGUpIHtcblx0XHQvLyBDcmVhdGUgY2Fyb3VzZWxcblx0XHR2YXIgRW1wdHlSZW5kZXJlciA9IENhcm91c2VsUmVuZGVyZXIuZXh0ZW5kKHtcblx0XHRcdGNsYXNzTmFtZTogXCJjYXJvdXNlbC1pdGVtIGVtcHR5LWl0ZW1cIixcblx0XHRcdG1vZGVsOiBidW5kbGUsXG5cdFx0XHR0ZW1wbGF0ZTogY2Fyb3VzZWxFbXB0eVRlbXBsYXRlLFxuXHRcdH0pO1xuXHRcdHZhciByZW5kZXJlckZ1bmN0aW9uID0gZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycikge1xuXHRcdFx0aWYgKGluZGV4ID09PSAtMSkge1xuXHRcdFx0XHRyZXR1cm4gRW1wdHlSZW5kZXJlcjtcblx0XHRcdH1cblx0XHRcdHN3aXRjaCAoaXRlbS5hdHRyKFwiQHJlbmRlcmVyXCIpKSB7XG5cdFx0XHRcdGNhc2UgXCJ2aWRlb1wiOlxuXHRcdFx0XHRcdHJldHVybiBWaWRlb1JlbmRlcmVyO1xuXHRcdFx0XHRjYXNlIFwic2VxdWVuY2VcIjpcblx0XHRcdFx0XHRyZXR1cm4gU2VxdWVuY2VSZW5kZXJlcjtcblx0XHRcdFx0Y2FzZSBcImltYWdlXCI6XG5cdFx0XHRcdFx0cmV0dXJuIEltYWdlUmVuZGVyZXI7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0cmV0dXJuIEltYWdlUmVuZGVyZXI7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHR2YXIgdmlldyA9IG5ldyBDYXJvdXNlbCh7XG5cdFx0XHRjbGFzc05hbWU6IFwibWVkaWEtY2Fyb3VzZWwgXCIgKyBidW5kbGUuZ2V0KFwiZG9taWRcIiksXG5cdFx0XHRjb2xsZWN0aW9uOiBidW5kbGUuZ2V0KFwibWVkaWFcIiksXG5cdFx0XHRyZW5kZXJlckZ1bmN0aW9uOiByZW5kZXJlckZ1bmN0aW9uLFxuXHRcdFx0cmVxdWlyZVNlbGVjdGlvbjogZmFsc2UsXG5cdFx0XHRkaXJlY3Rpb246IENhcm91c2VsLkRJUkVDVElPTl9IT1JJWk9OVEFMLFxuXHRcdFx0dG91Y2g6IHRoaXMuaHBhbixcblx0XHR9KTtcblx0XHRjb250cm9sbGVyLmxpc3RlblRvKHZpZXcsIHtcblx0XHRcdFwidmlldzpzZWxlY3Q6b25lXCI6IGNvbnRyb2xsZXIuc2VsZWN0TWVkaWEsXG5cdFx0XHRcInZpZXc6c2VsZWN0Om5vbmVcIjogY29udHJvbGxlci5kZXNlbGVjdE1lZGlhLFxuXHRcdFx0Ly8gXCJ2aWV3OnJlbW92ZWRcIjogY29udHJvbGxlci5zdG9wTGlzdGVuaW5nXG5cdFx0fSk7XG5cdFx0dmlldy5saXN0ZW5UbyhidW5kbGUsIFwiZGVzZWxlY3RlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLmNvbGxlY3Rpb24pO1xuXHRcdFx0Y29udHJvbGxlci5zdG9wTGlzdGVuaW5nKHRoaXMpO1xuXHRcdH0pO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBtZWRpYS1jYXB0aW9uLXN0YWNrXG5cdCAqL1xuXHRjcmVhdGVNZWRpYUNhcHRpb25TdGFjazogZnVuY3Rpb24oYnVuZGxlKSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgQ29sbGVjdGlvblN0YWNrKHtcblx0XHRcdGNsYXNzTmFtZTogXCJtZWRpYS1jYXB0aW9uLXN0YWNrXCIsXG5cdFx0XHRjb2xsZWN0aW9uOiBidW5kbGUuZ2V0KFwibWVkaWFcIiksXG5cdFx0XHR0ZW1wbGF0ZTogbWVkaWFTdGFja1RlbXBsYXRlXG5cdFx0fSk7XG5cdFx0dmlldy5saXN0ZW5UbyhidW5kbGUsIFwiZGVzZWxlY3RlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLmNvbGxlY3Rpb24pO1xuXHRcdH0pO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBtZWRpYS1kb3RuYXZcblx0ICovXG5cdGNyZWF0ZU1lZGlhRG90TmF2aWdhdGlvbjogZnVuY3Rpb24oYnVuZGxlKSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgU2VsZWN0YWJsZUxpc3RWaWV3KHtcblx0XHRcdGNsYXNzTmFtZTogXCJtZWRpYS1kb3RuYXYgZG90cy1mb250ZmFjZSBjb2xvci1mZzA1XCIsXG5cdFx0XHRjb2xsZWN0aW9uOiBidW5kbGUuZ2V0KFwibWVkaWFcIiksXG5cdFx0XHRyZW5kZXJlcjogRG90TmF2aWdhdGlvblJlbmRlcmVyXG5cdFx0fSk7XG5cdFx0Y29udHJvbGxlci5saXN0ZW5Ubyh2aWV3LCB7XG5cdFx0XHRcInZpZXc6c2VsZWN0Om9uZVwiOiBjb250cm9sbGVyLnNlbGVjdE1lZGlhLFxuXHRcdFx0XCJ2aWV3OnNlbGVjdDpub25lXCI6IGNvbnRyb2xsZXIuZGVzZWxlY3RNZWRpYSxcblx0XHRcdC8vIFwidmlldzpyZW1vdmVkXCI6IGNvbnRyb2xsZXIuc3RvcExpc3RlbmluZ1xuXHRcdH0pO1xuXHRcdHZpZXcubGlzdGVuVG8oYnVuZGxlLCBcImRlc2VsZWN0ZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5jb2xsZWN0aW9uKTtcblx0XHRcdGNvbnRyb2xsZXIuc3RvcExpc3RlbmluZyh0aGlzKTtcblx0XHR9KTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvKipcblx0ICogQHBhcmFtIGVsIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vQXJ0aWNsZVZpZXd9XG5cdCAqIEByZXR1cm4ge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9XG5cdCAqL1xuXHRjcmVhdGVBcnRpY2xlVmlldzogZnVuY3Rpb24oYXJ0aWNsZSkge1xuXHRcdHZhciB2aWV3ID0gbmV3IEFydGljbGVWaWV3KHtcblx0XHRcdG1vZGVsOiBhcnRpY2xlLFxuXHRcdH0pO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8vIGNyZWF0ZVByb2dyZXNzV3JhcHBlcjogZnVuY3Rpb24oKSB7XG5cdC8vIFx0Ly8gdmFyIHZpZXcgPSBuZXcgUHJvZ3Jlc3NNZXRlcih7XG5cdC8vIFx0Ly8gXHRpZDogXCJtZWRpYS1wcm9ncmVzcy13cmFwcGVyXCIsXG5cdC8vIFx0Ly8gXHQvLyBjbGFzc05hbWU6IFwiY29sb3ItYmcgY29sb3ItZmcwNVwiLFxuXHQvLyBcdC8vIFx0dXNlT3BhcXVlOiBmYWxzZSxcblx0Ly8gXHQvLyBcdGxhYmVsRm46IGZ1bmN0aW9uKCkgeyByZXR1cm4gXCIwJVwiOyB9XG5cdC8vIFx0Ly8gfSk7XG5cdC8vIFx0Ly8gdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLnByb2dyZXNzV3JhcHBlci5lbCk7XG5cdC8vIFx0Ly8gcmV0dXJuIHZpZXc7XG5cdC8vIFx0cmV0dXJuIG51bGw7XG5cdC8vIH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBDb250ZW50VmlldzsiLCIvKiBnbG9iYWwgTXV0YXRpb25PYnNlcnZlciAqL1xuLyoqXG4vKiBAbW9kdWxlIGFwcC92aWV3L05hdmlnYXRpb25WaWV3XG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzfSAqL1xudmFyIEhhbW1lciA9IHJlcXVpcmUoXCJoYW1tZXJqc1wiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9UcmFuc2Zvcm1IZWxwZXJ9ICovXG52YXIgVHJhbnNmb3JtSGVscGVyID0gcmVxdWlyZShcInV0aWxzL1RyYW5zZm9ybUhlbHBlclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVG91Y2hNYW5hZ2VyfSAqL1xuLy8gdmFyIFRvdWNoTWFuYWdlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1RvdWNoTWFuYWdlclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvQ29udHJvbGxlcn0gKi9cbnZhciBjb250cm9sbGVyID0gcmVxdWlyZShcImFwcC9jb250cm9sL0NvbnRyb2xsZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9UeXBlQ29sbGVjdGlvbn0gKi9cbnZhciB0eXBlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9UeXBlQ29sbGVjdGlvblwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9ufSAqL1xudmFyIGtleXdvcmRzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9uXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvbn0gKi9cbnZhciBidW5kbGVzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb25cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvbn0gKi9cbnZhciBhcnRpY2xlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvblwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0ZpbHRlcmFibGVMaXN0Vmlld30gKi9cbnZhciBGaWx0ZXJhYmxlTGlzdFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0ZpbHRlcmFibGVMaXN0Vmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Hcm91cGluZ0xpc3RWaWV3fSAqL1xudmFyIEdyb3VwaW5nTGlzdFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0dyb3VwaW5nTGlzdFZpZXdcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQ29sbGVjdGlvblBhZ2VyfSAqL1xuLy8gdmFyIENvbGxlY3Rpb25QYWdlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvQ29sbGVjdGlvblBhZ2VyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0dyYXBoVmlld30gKi9cbnZhciBHcmFwaFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0dyYXBoVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9BcnRpY2xlQnV0dG9ufSAqL1xudmFyIEFydGljbGVCdXR0b24gPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVCdXR0b25cIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkUHJvcGVydHl9ICovXG4vLyB2YXIgcHJlZml4ZWRQcm9wZXJ0eSA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFByb3BlcnR5XCIpO1xuXG4vLyB2YXIgdHJhY2VFbGVtZW50ID0gcmVxdWlyZShcInV0aWxzL2RlYnVnL3RyYWNlRWxlbWVudFwiKTtcblxudmFyIHR4ID0gR2xvYmFscy50cmFuc2l0aW9ucztcblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvTmF2aWdhdGlvblZpZXd9XG4vKi9cbnZhciBOYXZpZ2F0aW9uVmlldyA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvLyAvKiogQG92ZXJyaWRlICovXG5cdC8vIHRhZ05hbWU6IFwiZGl2XCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2lkUHJlZml4OiBcIm5hdmlnYXRpb25WaWV3XCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcIm5hdmlnYXRpb24gY29udGFpbmVyLWV4cGFuZGVkXCIsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0Xy5iaW5kQWxsKHRoaXMsIFwiX29uVlBhblN0YXJ0XCIsIFwiX29uVlBhbk1vdmVcIiwgXCJfb25WUGFuRmluYWxcIik7XG5cdFx0Xy5iaW5kQWxsKHRoaXMsIFwiX29uSFBhblN0YXJ0XCIsIFwiX29uSFBhbk1vdmVcIiwgXCJfb25IUGFuRmluYWxcIik7XG5cdFx0Xy5iaW5kQWxsKHRoaXMsIFwiX29uTmF2aWdhdGlvbkNsaWNrXCIpO1xuXHRcdC8vIF8uYmluZEFsbCh0aGlzLCBcIl93aGVuVHJhbnNpdGlvbnNFbmRcIiwgXCJfd2hlblRyYW5zaXRpb25zQWJvcnRcIik7XG5cdFx0Ly8gXy5iaW5kQWxsKHRoaXMsIFwiX3doZW5MaXN0c1JlbmRlcmVkXCIpO1xuXG5cdFx0Ly8gdGhpcy5fbWV0cmljcyA9IHtcblx0XHQvLyBcdG1pbkhlaWdodDogMFxuXHRcdC8vIH07XG5cdFx0dGhpcy5pdGVtVmlld3MgPSBbXTtcblx0XHR0aGlzLnRyYW5zZm9ybXMgPSBuZXcgVHJhbnNmb3JtSGVscGVyKCk7XG5cdFx0Ly8gdGhpcy50b3VjaCA9IG9wdGlvbnMudG91Y2ggfHwgbmV3IEVycm9yKFwibm8gdG91Y2hcIik7IC8vVG91Y2hNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG5cdFx0dGhpcy52cGFuID0gb3B0aW9ucy52cGFuIHx8IG5ldyBFcnJvcihcIm5vIHZwYW5cIik7XG5cdFx0dGhpcy5ocGFuID0gb3B0aW9ucy5ocGFuIHx8IG5ldyBFcnJvcihcIm5vIGhwYW5cIik7XG5cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlXCIsIHRoaXMuX29uTW9kZWxDaGFuZ2UpO1xuXHRcdHRoaXMubGlzdGVuVG8oa2V5d29yZHMsIFwic2VsZWN0Om9uZSBzZWxlY3Q6bm9uZVwiLCB0aGlzLl9vbktleXdvcmRTZWxlY3QpO1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJ3aXRoQnVuZGxlOmNoYW5nZVwiLCB0aGlzLl9vbndpdGhCdW5kbGVDaGFuZ2UpO1xuXG5cdFx0dGhpcy52cGFuR3JvdXAgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdnBhbi1ncm91cFwiKTtcblx0XHR0aGlzLmtleXdvcmRMaXN0ID0gdGhpcy5jcmVhdGVLZXl3b3JkTGlzdCgpO1xuXHRcdHRoaXMuYnVuZGxlTGlzdCA9IHRoaXMuY3JlYXRlQnVuZGxlTGlzdCgpO1xuXHRcdHRoaXMuaXRlbVZpZXdzLnB1c2godGhpcy5rZXl3b3JkTGlzdCk7XG5cdFx0dGhpcy5pdGVtVmlld3MucHVzaCh0aGlzLmJ1bmRsZUxpc3QpO1xuXG5cdFx0dGhpcy5ncmFwaCA9IHRoaXMuY3JlYXRlR3JhcGhWaWV3KHRoaXMuYnVuZGxlTGlzdCxcblx0XHRcdHRoaXMua2V5d29yZExpc3QsIHRoaXMudnBhbkdyb3VwKTtcblxuXHRcdHRoaXMuc2l0ZW5hbWUgPSB0aGlzLmNyZWF0ZVNpdGVuYW1lQnV0dG9uKCk7XG5cdFx0dGhpcy5hYm91dCA9IHRoaXMuY3JlYXRlQWJvdXRCdXR0b24oKTtcblxuXHRcdC8qIE5PVEU6IC5saXN0LWdyb3VwIC5sYWJlbCBtb3ZlcyBob3Jpem9udGFsbHkgKGNmLiBzYXNzL2xheW91dHMvKi5zY3NzKSAqL1xuXHRcdHRoaXMuaEdyb3VwaW5ncyA9IHRoaXMua2V5d29yZExpc3QuZWwucXVlcnlTZWxlY3RvckFsbChcIi5saXN0LWdyb3VwIC5sYWJlbFwiKTtcblxuXHRcdHRoaXMudHJhbnNmb3Jtcy5hZGQoXG5cdFx0XHR0aGlzLnZwYW5Hcm91cCxcblx0XHRcdHRoaXMuYnVuZGxlTGlzdC53cmFwcGVyLFxuXHRcdFx0dGhpcy5rZXl3b3JkTGlzdC53cmFwcGVyLFxuXHRcdFx0dGhpcy5idW5kbGVMaXN0LmVsLFxuXHRcdFx0dGhpcy5rZXl3b3JkTGlzdC5lbCxcblx0XHRcdHRoaXMuaEdyb3VwaW5ncyxcblx0XHRcdHRoaXMuc2l0ZW5hbWUud3JhcHBlcixcblx0XHRcdHRoaXMuYWJvdXQud3JhcHBlcixcblx0XHRcdHRoaXMuc2l0ZW5hbWUuZWwsXG5cdFx0XHR0aGlzLmFib3V0LmVsLFxuXHRcdFx0dGhpcy5ncmFwaC5lbFxuXHRcdCk7XG5cdFx0Ly8gdGhpcy5pdGVtVmlld3MucHVzaCh0aGlzLmdyYXBoKTtcblx0XHQvLyB0aGlzLmxpc3RlblRvKHRoaXMuZ3JhcGgsIHtcblx0XHQvLyBcdFwiY2FudmFzOnVwZGF0ZVwiOiB0aGlzLl9vbkdyYXBoVXBkYXRlLFxuXHRcdC8vIFx0XCJjYW52YXM6cmVkcmF3XCI6IHRoaXMuX29uR3JhcGhSZWRyYXcsXG5cdFx0Ly8gfSk7XG5cblx0XHQvKnRoaXMubGlzdGVuVG8odGhpcy5ncmFwaCwgXCJ2aWV3OnJlbmRlcjpiZWZvcmVcIiwgZnVuY3Rpb24odmlldywgZmxhZ3MpIHtcblx0XHRcdHZhciB2bWF4O1xuXHRcdFx0aWYgKCF2aWV3LmVsLnN0eWxlLmhlaWdodCkge1xuXHRcdFx0XHQvLyBpZiAoZmxhZ3MgJiAoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3Lk1PREVMX0lOVkFMSUQpKSB7XG5cdFx0XHRcdC8vIGlmICgodGhpcy5idW5kbGVMaXN0LnJlbmRlckZsYWdzIHwgVmlldy5TSVpFX0lOVkFMSUQpIHx8XG5cdFx0XHRcdC8vIFx0KHRoaXMua2V5d29yZExpc3QucmVuZGVyRmxhZ3MgfCBWaWV3LlNJWkVfSU5WQUxJRCkpIHtcblx0XHRcdFx0Ly8gfVxuXHRcdFx0XHR2bWF4ID0gTWF0aC5tYXgoXG5cdFx0XHRcdFx0dGhpcy5idW5kbGVMaXN0Ll9tZXRyaWNzLmhlaWdodCxcblx0XHRcdFx0XHR0aGlzLmtleXdvcmRMaXN0Ll9tZXRyaWNzLmhlaWdodFxuXHRcdFx0XHQpO1xuXHRcdFx0XHRpZiAoXy5pc051bWJlcih2bWF4KSkge1xuXHRcdFx0XHRcdHZpZXcuZWwuc3R5bGUuaGVpZ2h0ID0gdm1heCArIFwicHhcIjtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOlt2aWV3OnJlbmRlcjpiZWZvcmVdW29uY2VdOiVzIFslc10gaGVpZ2h0czpbJWksICVpXSAobWF4ICVpKVwiLFxuXHRcdFx0XHRcdFx0dGhpcy5jaWQsIHZpZXcuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpLFxuXHRcdFx0XHRcdFx0dGhpcy5idW5kbGVMaXN0Ll9tZXRyaWNzLmhlaWdodCxcblx0XHRcdFx0XHRcdHRoaXMua2V5d29yZExpc3QuX21ldHJpY3MuaGVpZ2h0LFxuXHRcdFx0XHRcdFx0dm1heCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTsqL1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5idW5kbGVMaXN0LCBcInZpZXc6cmVuZGVyOmFmdGVyXCIsIGZ1bmN0aW9uKHZpZXcsIGZsYWdzKSB7XG5cdFx0Ly8gXHRjb25zb2xlLmluZm8oXCIlczpbdmlldzpyZW5kZXI6YWZ0ZXIgJXNdXCIsIHRoaXMuY2lkLCB2aWV3LmNpZCwgVmlldy5mbGFnc1RvU3RyaW5nKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpKTtcblx0XHQvLyBcdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHtcblx0XHQvLyBcdFx0XHQvLyBjb25zb2xlLmluZm8oXCIlczpbJXMgdmlldzpyZW5kZXI6YWZ0ZXJdIGJ1bmRsZUxpc3QgaGVpZ2h0XCIsIHRoaXMuY2lkLCB2aWV3LmNpZCwgdGhpcy5idW5kbGVMaXN0LmVsLnN0eWxlLmhlaWdodCk7XG5cdFx0Ly8gXHRcdFx0Ly8gdGhpcy5ncmFwaC5lbC5zdHlsZS5oZWlnaHQgPSB0aGlzLmJ1bmRsZUxpc3QuZWwuc3R5bGUuaGVpZ2h0O1xuXHRcdC8vIFx0XHRcdHRoaXMuZ3JhcGguZWwuc3R5bGUub3BhY2l0eSA9IHRoaXMuYnVuZGxlTGlzdC5jb2xsYXBzZWQ/IDAgOiAxO1xuXHRcdC8vIFx0XHRcdHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCkucmVuZGVyTm93KCk7XG5cdFx0Ly8gXHQvLyBcdH1cblx0XHQvLyB9KTtcblx0XHQvLyB0aGlzLmxpc3RlblRvKHRoaXMuYnVuZGxlTGlzdCwgXCJ2aWV3OnJlbmRlcjphZnRlclwiLCB0aGlzLl9vbkxpc3RSZXNpemUpO1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5rZXl3b3JkTGlzdCwgXCJ2aWV3OnJlbmRlcjphZnRlclwiLCB0aGlzLl9vbkxpc3RSZXNpemUpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZW5kZXJGcmFtZTogZnVuY3Rpb24odHN0YW1wLCBmbGFncykge1xuXHRcdGlmIChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkge1xuXHRcdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjb250YWluZXItY29sbGFwc2VkXCIsIHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKTtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY29udGFpbmVyLWV4cGFuZGVkXCIsICF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiY29sbGFwc2VkXCIpXG5cdFx0XHRcdHx8IHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwiY29udGFpbmVyLWNoYW5naW5nXCIpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcInJvdXRlTmFtZVwiKSkge1xuXHRcdFx0XHR0aGlzLmJ1bmRsZUxpc3QucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHRcdFx0XHR0aGlzLmtleXdvcmRMaXN0LnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3LkxBWU9VVF9JTlZBTElEKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyB0cmFuc2Zvcm1zXG5cdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0aWYgKHRoaXMuc2tpcFRyYW5zaXRpb25zIHx8XG5cdFx0XHQoZmxhZ3MgJiAoVmlldy5NT0RFTF9JTlZBTElEIHwgVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3LkxBWU9VVF9JTlZBTElEKSkpIHtcblx0XHRcdC8vIGlmICh0cmFuc2Zvcm1zQ2hhbmdlZCkge1xuXHRcdFx0aWYgKHRoaXMuc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5zdG9wQWxsVHJhbnNpdGlvbnMoKTtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5jbGVhckFsbE9mZnNldHMoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMucmVuZGVyVHJhbnNpdGlvbnMoZmxhZ3MpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdFx0XHQvLyBjb25zb2xlLmdyb3VwKHRoaXMuY2lkICsgXCI6OnJlbmRlckZyYW1lIChcIiArIHRoaXMudHJhbnNmb3Jtcy5pdGVtcy5sZW5ndGggKyBcIilcIik7XG5cdFx0XHQvLyB0aGlzLnRyYW5zZm9ybXMuaXRlbXMuZm9yRWFjaChmdW5jdGlvbihvKSB7XG5cdFx0XHQvLyBcdGNvbnNvbGUubG9nKHRyYWNlRWxlbWVudChvLmVsKSwgKG8uaGFzVHJhbnNpdGlvbiA/IG8udHJhbnNpdGlvbi5uYW1lIDogXCItXCIpKTtcblx0XHRcdC8vIH0pO1xuXHRcdFx0Ly8gY29uc29sZS5ncm91cEVuZCgpO1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6cmVuZGVyRnJhbWUgJW9cIiwgdGhpcy5jaWQsXG5cdFx0XHQvLyBcdHRoaXMudHJhbnNmb3Jtcy5pdGVtcy5tYXAoZnVuY3Rpb24obykge1xuXHRcdFx0Ly8gXHRcdHJldHVybiB0cmFjZUVsZW1lbnQoby5lbCkgKyBcIjpcIiArIChvLmhhc1RyYW5zaXRpb24gPyBvLnRyYW5zaXRpb24ubmFtZSA6IFwiLVwiKTtcblx0XHRcdC8vIFx0fSlcblx0XHRcdC8vICk7XG5cdFx0fVxuXG5cblx0XHQvLyBwcm9taXNlIGhhbmRsZXJzXG5cdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0dmFyIHdoZW5MaXN0c1JlbmRlcmVkRG9uZSA9IGZ1bmN0aW9uKHJlc3VsdCkge1xuXHRcdFx0Ly8gdmFyIGh2YWwgPSByZXN1bHQucmVkdWNlKGZ1bmN0aW9uKGEsIG8pIHtcblx0XHRcdC8vIFx0cmV0dXJuIE1hdGgubWF4KGEsIG8ubWV0cmljcy5oZWlnaHQpO1xuXHRcdFx0Ly8gfSwgMCk7XG5cdFx0XHR2YXIgaHZhbCA9IHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpID9cblx0XHRcdFx0XCJcIiA6IE1hdGgubWF4KFxuXHRcdFx0XHRcdHRoaXMuYnVuZGxlTGlzdC5tZXRyaWNzLmhlaWdodCxcblx0XHRcdFx0XHR0aGlzLmtleXdvcmRMaXN0Lm1ldHJpY3MuaGVpZ2h0KSArIFwicHhcIjtcblxuXHRcdFx0dGhpcy5lbC5zdHlsZS5oZWlnaHQgPSBodmFsOyAvL3RoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpID8gXCJcIiA6IFwiMTAwJVwiO1xuXHRcdFx0Ly8gdGhpcy52cGFuR3JvdXAuc3R5bGUuaGVpZ2h0ID0gaHZhbDtcblx0XHRcdHRoaXMuZ3JhcGguZWwuc3R5bGUuaGVpZ2h0ID0gaHZhbDtcblx0XHRcdHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczpbd2hlbkxpc3RzUmVuZGVyZWREb25lXSBoZWlnaHQgc2V0IHRvICVzXCIsIHRoaXMuY2lkLCBodmFsIHx8IFwiW25vdCBzZXRdXCIsIHJlc3VsdCk7XG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xuXHRcdH0uYmluZCh0aGlzKTtcblxuXHRcdHZhciB3aGVuQ29sbGFwc2VkQ2hhbmdlRG9uZSA9IGZ1bmN0aW9uKHJlc3VsdCkge1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczpbd2hlbkNvbGxhcHNlZENoYW5nZURvbmVdW2ZsYWdzOiAlc11cIiwgdGhpcy5jaWQsIFZpZXcuZmxhZ3NUb1N0cmluZyhmbGFncyksIHJlc3VsdCk7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb250YWluZXItY2hhbmdpbmdcIik7XG5cdFx0XHR0aGlzLmdyYXBoLmVuYWJsZWQgPSAhdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdFx0XHR0aGlzLmdyYXBoLnZhbHVlVG8oMCwgMCwgXCJhMmJcIik7XG5cdFx0XHRpZiAoIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHRcdHRoaXMuZ3JhcGgudmFsdWVUbygxLCBHbG9iYWxzLlRSQU5TSVRJT05fRFVSQVRJT04sIFwiYTJiXCIpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHJlc3VsdDtcblx0XHR9LmJpbmQodGhpcyk7XG5cblx0XHQvLyBwcm9taXNlc1xuXHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdFByb21pc2UuYWxsKFtcblx0XHRcdFx0dGhpcy5idW5kbGVMaXN0LndoZW5SZW5kZXJlZCgpLFxuXHRcdFx0XHR0aGlzLmtleXdvcmRMaXN0LndoZW5SZW5kZXJlZCgpLFxuXHRcdFx0XHR0aGlzLmJ1bmRsZUxpc3Qud2hlbkNvbGxhcHNlQ2hhbmdlRW5kcygpLFxuXHRcdFx0XHR0aGlzLmtleXdvcmRMaXN0LndoZW5Db2xsYXBzZUNoYW5nZUVuZHMoKSxcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLndoZW5BbGxUcmFuc2l0aW9uc0VuZCgpLFxuXHRcdFx0XSlcblx0XHRcdC50aGVuKHdoZW5MaXN0c1JlbmRlcmVkRG9uZSlcblx0XHRcdC50aGVuKHdoZW5Db2xsYXBzZWRDaGFuZ2VEb25lKVxuXHRcdFx0LmNhdGNoKGZ1bmN0aW9uKHIpIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiY29sbGFwc2UgcHJvbWlzZSByZWplY3RlZFwiLCByKTtcblx0XHRcdFx0cmV0dXJuIHI7XG5cdFx0XHR9KTtcblxuXHRcdC8qXG5cdFx0dmFyIHdoZW5MaXN0c1JlbmRlcmVkID0gUHJvbWlzZS5hbGwoW1xuXHRcdFx0dGhpcy5idW5kbGVMaXN0LndoZW5SZW5kZXJlZCgpLFxuXHRcdFx0dGhpcy5rZXl3b3JkTGlzdC53aGVuUmVuZGVyZWQoKVxuXHRcdF0pO1xuXG5cdFx0dmFyIHdoZW5UcmFuc2Zvcm1zRW5kID0gdGhpcy50cmFuc2Zvcm1zLnByb21pc2UoKTtcblxuXHRcdHdoZW5MaXN0c1JlbmRlcmVkLnRoZW4oXG5cdFx0XHR3aGVuTGlzdHNSZW5kZXJlZERvbmUsXG5cdFx0XHRmdW5jdGlvbihyZWFzb24pIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiJXM6W3doZW5MaXN0c1JlbmRlcmVkXSBmYWlsZWQ6ICVvXCIsIHRoaXMuY2lkLCByZWFzb24pO1xuXHRcdFx0XHRyZXR1cm4gcmVhc29uO1xuXHRcdFx0fS5iaW5kKHRoaXMpXG5cdFx0KTtcblxuXHRcdFByb21pc2UuYWxsKFtcblx0XHRcdHdoZW5MaXN0c1JlbmRlcmVkLFxuXHRcdFx0d2hlblRyYW5zZm9ybXNFbmRcblx0XHRdKVxuXHRcdFx0LnRoZW4oXG5cdFx0XHRcdGZ1bmN0aW9uKHJlc3VsdCkge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6W3doZW5MaXN0c1JlbmRlcmVkK3doZW5UcmFuc2Zvcm1zRW5kXSBbJXNdXCIsIHRoaXMuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpLCByZXN1bHQpO1xuXHRcdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbnRhaW5lci1jaGFuZ2luZ1wiKTtcblx0XHRcdFx0XHR0aGlzLmdyYXBoLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3LkxBWU9VVF9JTlZBTElEKTtcblx0XHRcdFx0fS5iaW5kKHRoaXMpLFxuXHRcdFx0XHRmdW5jdGlvbihyZWFzb24pIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCIlczpbd2hlbkxpc3RzUmVuZGVyZWQrd2hlblRyYW5zZm9ybXNFbmRdIFslc11cIiwgdGhpcy5jaWQsIFZpZXcuZmxhZ3NUb1N0cmluZyhmbGFncyksIHJlYXNvbik7XG5cdFx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY29udGFpbmVyLWNoYW5naW5nXCIpO1xuXHRcdFx0XHRcdHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHRcdFx0XHR9LmJpbmQodGhpcylcblx0XHRcdCk7Ki9cblxuXG5cdFx0Ly8gdHJhY2UgcmVzdWx0IGhhbmRsZXJzXG5cdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0LyppZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHR2YXIgbXNnQmFzZSA9IHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpID8gXCJjb2xsYXBzXCIgOiBcImV4cGFuZFwiO1xuXHRcdFx0UHJvbWlzZS5hbGwoW1xuXHRcdFx0XHRQcm9taXNlLmFsbChbXG5cdFx0XHRcdFx0XHR0aGlzLmJ1bmRsZUxpc3Qud2hlblJlbmRlcmVkKCksXG5cdFx0XHRcdFx0XHR0aGlzLmtleXdvcmRMaXN0LndoZW5SZW5kZXJlZCgpXG5cdFx0XHRcdFx0XSlcblx0XHRcdFx0XHQudGhlbihcblx0XHRcdFx0XHRcdGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIm5hdi10eDolc2luZ1wiLCBtc2dCYXNlLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRcdFx0fSksXG5cdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5wcm9taXNlKClcblx0XHRcdF0pXG5cdFx0XHRcdC5jYXRjaChcblx0XHRcdFx0XHRmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybihcIm5hdi10eDolc2VkIFtyZWplY3RlZF1cIiwgbXNnQmFzZSwgYXJndW1lbnRzKTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHQuZmluYWxseShcblx0XHRcdFx0XHRmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUubG9nKFwibmF2LXR4OiVzZWRcIiwgbXNnQmFzZSwgYXJndW1lbnRzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdCk7XG5cdFx0fSovXG5cblx0XHQvLyBncmFwaFxuXHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdC8vIGlmICgoZmxhZ3MgJiAoVmlldy5TSVpFX0lOVkFMSUQgfCB+Vmlldy5NT0RFTF9JTlZBTElEKSlcblx0XHQvLyBcdC8qIGNvbGxhcHNlZCBoYXMgbm90IGNoYW5nZWQsIG5vIGJ1bmRsZSBzZWxlY3RlZCAqL1xuXHRcdC8vIFx0JiYgIXRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImNvbGxhcHNlZFwiKVxuXHRcdC8vIFx0JiYgIXRoaXMubW9kZWwuZ2V0KFwid2l0aEJ1bmRsZVwiKSkge1xuXHRcdC8vIFx0dGhpcy5ncmFwaC5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCk7XG5cdFx0Ly8gXHRpZiAoIXRoaXMuc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0Ly8gXHRcdHRoaXMuZ3JhcGgucmVuZGVyTm93KCk7XG5cdFx0Ly8gXHR9XG5cdFx0Ly8gfVxuXHRcdC8vIGVsc2Vcblx0XHQvLyBpZiAoKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpICYmICF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdC8vIFx0LyogTmF2aWdhdGlvblZpZXcgaGFzIHJlc2l6ZWQgd2hpbGUgdW5jb2xsYXBzZWQsXG5cdFx0Ly8gXHRidXQgbW9kZWwgaXMgdW5jaGFuZ2VkICovXG5cdFx0Ly8gXHR0aGlzLmdyYXBoLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3LkxBWU9VVF9JTlZBTElEKTtcblx0XHQvLyB9XG5cblxuXHRcdC8vIGNoaWxkcmVuIGxvb3Bcblx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHR0aGlzLml0ZW1WaWV3cy5mb3JFYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdC8vIHZpZXcuc2tpcFRyYW5zaXRpb25zID0gdmlldy5za2lwVHJhbnNpdGlvbnMgfHwgdGhpcy5za2lwVHJhbnNpdGlvbnM7XG5cdFx0XHRpZiAodGhpcy5za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdFx0dmlldy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHtcblx0XHRcdFx0dmlldy5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEKTtcblx0XHRcdH1cblx0XHRcdC8vIGlmICghdmlldy5za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdHZpZXcucmVuZGVyTm93KCk7XG5cdFx0XHQvLyB9XG5cdFx0fSwgdGhpcyk7XG5cblx0XHR0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gZmFsc2U7XG5cdFx0fSk7XG5cdH0sXG5cblx0Lypfd2hlbkxpc3RzUmVuZGVyZWQ6IGZ1bmN0aW9uKHJlc3VsdCkge1xuXHRcdHZhciBodmFsO1xuXHRcdGlmICh0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0dGhpcy5lbC5zdHlsZS5oZWlnaHQgPSBcIlwiO1xuXHRcdFx0Ly8gdGhpcy5ncmFwaC5lbC5zdHlsZS5oZWlnaHQgPSBcIjEwMCVcIjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gaHZhbCA9IHJlc3VsdC5yZWR1Y2UoZnVuY3Rpb24oYSwgbykge1xuXHRcdFx0Ly8gXHRyZXR1cm4gTWF0aC5tYXgoYSwgby5tZXRyaWNzLmhlaWdodCk7XG5cdFx0XHQvLyB9LCAwKTtcblx0XHRcdGh2YWwgPSBNYXRoLm1heChcblx0XHRcdFx0dGhpcy5idW5kbGVMaXN0Lm1ldHJpY3MuaGVpZ2h0LFxuXHRcdFx0XHR0aGlzLmtleXdvcmRMaXN0Lm1ldHJpY3MuaGVpZ2h0KTtcblx0XHRcdHRoaXMuZWwuc3R5bGUuaGVpZ2h0ID0gaHZhbCArIFwicHhcIjtcblx0XHRcdC8vIHRoaXMuZ3JhcGguZWwuc3R5bGUuaGVpZ2h0ID0gaHZhbCArIFwicHhcIjtcblx0XHR9XG5cdFx0dGhpcy5ncmFwaC5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCkucmVuZGVyTm93KCk7XG5cdFx0Y29uc29sZS5sb2coXCIlczpbX3doZW5MaXN0c1JlbmRlcmVkXSBoZWlnaHQgc2V0IHRvICVvcHhcIiwgdGhpcy5jaWQsIGh2YWwgPyBodmFsIDogXCJbZW1wdHldXCIsIGFyZ3VtZW50cyk7XG5cdFx0cmV0dXJuIHJlc3VsdFxuXHR9LFxuXG5cdF93aGVuVHJhbnNpdGlvbnNFbmQ6IGZ1bmN0aW9uKHJlc3VsdCkge1xuXHRcdGNvbnNvbGUuaW5mbyhcIiVzOjpfd2hlblRyYW5zaXRpb25zRW5kXCIsIHRoaXMuY2lkKTtcblx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb250YWluZXItY2hhbmdpbmdcIik7XG5cdFx0Ly8gaWYgKCFHbG9iYWxzLkJSRUFLUE9JTlRTW1wiZGVza3RvcC1zbWFsbFwiXS5tYXRjaGVzKVxuXHRcdC8vIFx0cmV0dXJuO1xuXHRcdC8vIGlmICghdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHQvLyBcdHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpOyAvLy5yZW5kZXJOb3coKTtcblx0XHQvLyB9XG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSxcblxuXHRfd2hlblRyYW5zaXRpb25zQWJvcnQ6IGZ1bmN0aW9uKHJlYXNvbikge1xuXHRcdGNvbnNvbGUud2FybihcIiVzOjpfd2hlblRyYW5zaXRpb25zQWJvcnQgJW9cIiwgdGhpcy5jaWQsIHJlYXNvbik7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY29udGFpbmVyLWNoYW5naW5nXCIpO1xuXHRcdC8vIGlmICghR2xvYmFscy5CUkVBS1BPSU5UU1tcImRlc2t0b3Atc21hbGxcIl0ubWF0Y2hlcylcblx0XHQvLyBcdHJldHVybjtcblx0XHQvLyBpZiAoIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0Ly8gXHR0aGlzLmdyYXBoLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3LkxBWU9VVF9JTlZBTElEKTsgLy8ucmVuZGVyTm93KCk7XG5cdFx0Ly8gfVxuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sKi9cblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHJlbmRlclRyYW5zaXRpb25zXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZW5kZXJUcmFuc2l0aW9uczogZnVuY3Rpb24oZmxhZ3MpIHtcblx0XHR2YXIgZnJvbVJvdXRlID0gdGhpcy5tb2RlbC5wcmV2aW91cyhcInJvdXRlTmFtZVwiKTtcblx0XHR2YXIgdG9Sb3V0ZSA9IHRoaXMubW9kZWwuZ2V0KFwicm91dGVOYW1lXCIpO1xuXG5cdFx0dmFyIG1vZGVsQ2hhbmdlZCA9IChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCk7XG5cdFx0LyogYnVuZGxlICovXG5cdFx0dmFyIHdpdGhCdW5kbGUgPSB0aGlzLm1vZGVsLmhhcyhcImJ1bmRsZVwiKTtcblx0XHR2YXIgd2l0aEJ1bmRsZUNoYW5nZWQgPSBtb2RlbENoYW5nZWQgJiYgdGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwid2l0aEJ1bmRsZVwiKTtcblx0XHR2YXIgYnVuZGxlQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJidW5kbGVcIik7XG5cdFx0LyogbWVkaWEgKi9cblx0XHR2YXIgd2l0aE1lZGlhID0gdGhpcy5tb2RlbC5oYXMoXCJtZWRpYVwiKTtcblx0XHR2YXIgd2l0aE1lZGlhQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoTWVkaWFcIik7XG5cdFx0Ly92YXIgbWVkaWFDaGFuZ2VkID0gbW9kZWxDaGFuZ2VkICYmIHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIm1lZGlhXCIpO1xuXHRcdC8qIGFydGljbGUgKi9cblx0XHQvLyB2YXIgd2l0aEFydGljbGUgPSB0aGlzLm1vZGVsLmhhcyhcImFydGljbGVcIik7XG5cdFx0dmFyIHdpdGhBcnRpY2xlQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoQXJ0aWNsZVwiKTtcblx0XHQvL3ZhciBhcnRpY2xlQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJhcnRpY2xlXCIpO1xuXHRcdC8qIGNvbGxhcHNlZCAqL1xuXHRcdHZhciBjb2xsYXBzZWQgPSB0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKTtcblx0XHR2YXIgY29sbGFwc2VkQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJjb2xsYXBzZWRcIik7XG5cblx0XHR2YXIgdGY7XG5cdFx0LyogdGhpcy52cGFuR3JvdXAgKi9cblx0XHR0ZiA9IHRoaXMudHJhbnNmb3Jtcy5nZXQodGhpcy52cGFuR3JvdXApO1xuXHRcdGlmICh0ZiAmJiB0Zi5oYXNPZmZzZXQpIHtcblx0XHRcdHRmLnJ1blRyYW5zaXRpb24oY29sbGFwc2VkQ2hhbmdlZCA/IHR4LkJFVFdFRU4gOiB0eC5OT1cpO1xuXHRcdFx0dGYuY2xlYXJPZmZzZXQoKTtcblx0XHR9XG5cdFx0LyogdGhpcy5idW5kbGVMaXN0LmVsICovXG5cdFx0Ly8gdGYgPSB0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMuYnVuZGxlTGlzdC5lbCk7XG5cdFx0Ly8gaWYgKHRmLmhhc09mZnNldCkge1xuXHRcdC8vIFx0dGYucnVuVHJhbnNpdGlvbihjb2xsYXBzZWRDaGFuZ2VkID8gdHguQkVUV0VFTiA6IHR4Lk5PVyk7XG5cdFx0Ly8gXHR0Zi5jbGVhck9mZnNldCgpO1xuXHRcdC8vIH1cblx0XHQvKiB0aGlzLmtleXdvcmRMaXN0LmVsICovXG5cdFx0Ly8gdGYgPSB0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3QuZWwpO1xuXHRcdC8vIGlmICh0Zi5oYXNPZmZzZXQpIHtcblx0XHQvLyBcdHRmLnJ1blRyYW5zaXRpb24oY29sbGFwc2VkQ2hhbmdlZCA/IHR4LkJFVFdFRU4gOiB0eC5OT1cpO1xuXHRcdC8vIFx0dGYuY2xlYXJPZmZzZXQoKTtcblx0XHQvLyB9XG5cdFx0LyogdGhpcy5ncmFwaC5lbCAqL1xuXHRcdC8vIHRmID0gdGhpcy50cmFuc2Zvcm1zLmdldCh0aGlzLmdyYXBoLmVsKTtcblx0XHQvLyBpZiAodGYgJiYgdGYuaGFzT2Zmc2V0KSB7XG5cdFx0Ly8gXHR0Zi5ydW5UcmFuc2l0aW9uKGNvbGxhcHNlZENoYW5nZWQgPyB0eC5CRVRXRUVOIDogdHguTk9XKTtcblx0XHQvLyBcdHRmLmNsZWFyT2Zmc2V0KCk7XG5cdFx0Ly8gfVxuXG5cdFx0Lypcblx0XHQgKiBOT1RFOlxuXHRcdCAqIFZlcnRpY2FsOlxuXHRcdCAqXHRcdHNpdGUtbmFtZS13cmFwcGVyLFxuXHRcdCAqXHRcdGFydGljbGUtbGlzdC13cmFwcGVyXG5cdFx0ICogSG9yaXpvbnRhbDpcblx0XHQgKlx0XHRzaXRlLW5hbWUsXG5cdFx0ICpcdFx0YXJ0aWNsZS1idXR0b25zLFxuXHRcdCAqXHRcdGtleXdvcmRMaXN0LndyYXBwZXIsXG5cdFx0ICpcdFx0YnVuZGxlTGlzdC53cmFwcGVyLFxuXHRcdCAqXHRcdGhHcm91cGluZ3Ncblx0XHQgKi9cblx0XHRpZiAoR2xvYmFscy5CUkVBS1BPSU5UU1tcImRlc2t0b3Atc21hbGxcIl0ubWF0Y2hlcykge1xuXHRcdFx0LyogSE9SSVpPTlRBTDoga2V5d29yZExpc3Qud3JhcHBlciAqL1xuXHRcdFx0dGYgPSB0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcik7XG5cdFx0XHRpZiAoY29sbGFwc2VkQ2hhbmdlZCAmJiAhd2l0aEFydGljbGVDaGFuZ2VkKSB7XG5cdFx0XHRcdC8vIGlmIChjb2xsYXBzZWRDaGFuZ2VkKSB7XG5cdFx0XHRcdGlmICh3aXRoQnVuZGxlQ2hhbmdlZCkge1xuXHRcdFx0XHRcdGlmICh3aXRoTWVkaWFDaGFuZ2VkKVxuXHRcdFx0XHRcdFx0dGYucnVuVHJhbnNpdGlvbih3aXRoQnVuZGxlID8gdHguTEFTVCA6IHR4LkZJUlNUKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAod2l0aE1lZGlhKVxuXHRcdFx0XHRcdFx0dGYucnVuVHJhbnNpdGlvbihjb2xsYXBzZWQgPyB0eC5MQVNUIDogdHguRklSU1QpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoIXdpdGhCdW5kbGVDaGFuZ2VkICYmIHdpdGhNZWRpYUNoYW5nZWQpXG5cdFx0XHRcdFx0dGYucnVuVHJhbnNpdGlvbihidW5kbGVDaGFuZ2VkID8gdHguQkVUV0VFTiA6IHR4Lk5PVyk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGYuaGFzT2Zmc2V0KVxuXHRcdFx0XHR0Zi5jbGVhck9mZnNldCgpO1xuXG5cdFx0XHQvKiBIT1JJWk9OVEFMOiB0aGUgcmVzdCAqL1xuXHRcdFx0aWYgKGNvbGxhcHNlZENoYW5nZWQgXiB3aXRoQXJ0aWNsZUNoYW5nZWQpIHtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnJ1blRyYW5zaXRpb24oY29sbGFwc2VkID8gdHguTEFTVCA6IHR4LkZJUlNULFxuXHRcdFx0XHRcdHRoaXMuc2l0ZW5hbWUuZWwsIHRoaXMuYWJvdXQuZWwsXG5cdFx0XHRcdFx0dGhpcy5idW5kbGVMaXN0LndyYXBwZXIsXG5cdFx0XHRcdFx0dGhpcy5oR3JvdXBpbmdzKTtcblx0XHRcdH1cblx0XHRcdC8qIFZFUlRJQ0FMICovXG5cdFx0XHRpZiAoZnJvbVJvdXRlID09ICdyb290JyB8fCB0b1JvdXRlID09ICdyb290Jykge1xuXHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMucnVuVHJhbnNpdGlvbih0eC5CRVRXRUVOLFxuXHRcdFx0XHRcdHRoaXMuc2l0ZW5hbWUud3JhcHBlciwgdGhpcy5hYm91dC53cmFwcGVyKTtcblx0XHRcdH1cblx0XHRcdC8qIHRoaXMuaEdyb3VwaW5ncyAqL1xuXHRcdFx0Ly8gaWYgKGNvbGxhcHNlZENoYW5nZWQgXiB3aXRoQXJ0aWNsZUNoYW5nZWQpIHtcblx0XHRcdC8vIFx0Ly8gaWYgKGNvbGxhcHNlZENoYW5nZWQgJiYgIXdpdGhBcnRpY2xlQ2hhbmdlZCkge1xuXHRcdFx0Ly8gXHR0aGlzLnRyYW5zZm9ybXMucnVuVHJhbnNpdGlvbihjb2xsYXBzZWQgPyB0eC5MQVNUIDogdHguRklSU1QsIHRoaXMuaEdyb3VwaW5ncyk7XG5cdFx0XHQvLyB9XG5cdFx0XHQvLyBpZiAoY29sbGFwc2VkQ2hhbmdlZCkge1xuXHRcdFx0Ly8gXHRpZiAoIXdpdGhBcnRpY2xlQ2hhbmdlZCkge1xuXHRcdFx0Ly8gXHRcdC8vIGlmIChmcm9tUm91dGUgPT0gJ3Jvb3QnIHx8IHRvUm91dGUgPT0gJ3Jvb3QnKSB7XG5cdFx0XHQvLyBcdFx0dGhpcy50cmFuc2Zvcm1zLnJ1blRyYW5zaXRpb24oY29sbGFwc2VkID8gdHguTEFTVCA6IHR4LkZJUlNULCB0aGlzLmJ1bmRsZUxpc3Qud3JhcHBlcik7XG5cdFx0XHQvLyBcdH1cblx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHQvLyBcdGlmICh3aXRoQXJ0aWNsZUNoYW5nZWQgJiYgd2l0aEJ1bmRsZUNoYW5nZWQpIHtcblx0XHRcdC8vIFx0XHR0aGlzLnRyYW5zZm9ybXMucnVuVHJhbnNpdGlvbih3aXRoQXJ0aWNsZSA/IHR4LkJFVFdFRU4gOiB0eC5MQVNULCB0aGlzLmJ1bmRsZUxpc3Qud3JhcHBlcik7XG5cdFx0XHQvLyBcdH1cblx0XHRcdC8vIH1cblx0XHR9IGVsc2UgaWYgKEdsb2JhbHMuQlJFQUtQT0lOVFNbXCJmdWxsd2lkdGhcIl0ubWF0Y2hlcykge1xuXHRcdFx0Ly8gaWYgKGNvbGxhcHNlZENoYW5nZWQgKSB7XG5cdFx0XHRpZiAoY29sbGFwc2VkQ2hhbmdlZCBeIHdpdGhBcnRpY2xlQ2hhbmdlZCkge1xuXHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMucnVuVHJhbnNpdGlvbihjb2xsYXBzZWQgPyB0eC5GSVJTVCA6IHR4LkxBU1QsXG5cdFx0XHRcdFx0dGhpcy5zaXRlbmFtZS5lbCwgdGhpcy5hYm91dC5lbCk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICh3aXRoQnVuZGxlQ2hhbmdlZCkge1xuXHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMucnVuVHJhbnNpdGlvbih0eC5CRVRXRUVOLFxuXHRcdFx0XHRcdHRoaXMuc2l0ZW5hbWUuZWwsIHRoaXMuYWJvdXQuZWwpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHQvLyB0aGlzLnRyYW5zZm9ybXMuY2xlYXJPZmZzZXQoXG5cdFx0Ly8gXHQvLyB0aGlzLmJ1bmRsZUxpc3QuZWwsXG5cdFx0Ly8gXHQvLyB0aGlzLmtleXdvcmRMaXN0LmVsLFxuXHRcdC8vIFx0dGhpcy5idW5kbGVMaXN0LndyYXBwZXIpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIG93biBtb2RlbCBjaGFuZ2VkXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vbk1vZGVsQ2hhbmdlOiBmdW5jdGlvbigpIHtcblx0XHQvLyBcdHRoaXMuc2V0SW1tZWRpYXRlKHRoaXMuY29tbWl0TW9kZWwpO1xuXHRcdC8vIH0sXG5cdFx0Ly9cblx0XHQvLyBjb21taXRNb2RlbDogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gdGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuTU9ERUxfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3Lk1PREVMX0lOVkFMSUQpO1xuXHRcdC8vIGtleXdvcmRzLmRlc2VsZWN0KCk7XG5cdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0aWYgKHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHRcdC8vIGNsZWFyIGtleXdvcmQgc2VsZWN0aW9uXG5cdFx0XHRcdGtleXdvcmRzLmRlc2VsZWN0KCk7XG5cdFx0XHR9IC8vIGVsc2Uge31cblx0XHRcdHRoaXMua2V5d29yZExpc3QuY29sbGFwc2VkID0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdFx0XHR0aGlzLmJ1bmRsZUxpc3QuY29sbGFwc2VkID0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdFx0fVxuXHRcdGlmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJidW5kbGVcIikpIHtcblx0XHRcdHRoaXMuYnVuZGxlTGlzdC5zZWxlY3RlZEl0ZW0gPSB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKTtcblx0XHRcdHRoaXMua2V5d29yZExpc3QucmVmcmVzaEZpbHRlcigpO1xuXG5cdFx0XHQvLyBpZiAoIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpICYmIHRoaXMuZ3JhcGgpIHtcblx0XHRcdC8vIFx0dGhpcy5saXN0ZW5Ub09uY2UodGhpcy5rZXl3b3JkTGlzdCwgXCJ2aWV3OnJlbmRlcjphZnRlclwiLCBmdW5jdGlvbih2aWV3LCBmbGFncykge1xuXHRcdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vbkJ1bmRsZVNlbGVjdCAtPiAlczpbdmlldzpyZW5kZXI6YWZ0ZXJdIGZsYWdzOiVzXCIsIHRoaXMuY2lkLCB2aWV3LmNpZCwgVmlldy5mbGFnc1RvU3RyaW5nKGZsYWdzKSk7XG5cdFx0XHQvLyBcdFx0dGhpcy5ncmFwaC52YWx1ZVRvKDAsIDAsIFwiYTJiXCIpO1xuXHRcdFx0Ly8gXHRcdC8vIHRoaXMuZ3JhcGgucmVuZGVyTm93KCk7XG5cdFx0XHQvLyBcdFx0dGhpcy5ncmFwaC52YWx1ZVRvKDEsIEdsb2JhbHMuVFJBTlNJVElPTl9EVVJBVElPTiwgXCJhMmJcIik7XG5cdFx0XHQvLyBcdH0pO1xuXHRcdFx0Ly8gfVxuXHRcdFx0Ly8ga2V5d29yZHMuZGVzZWxlY3QoKTtcblx0XHRcdC8vIHRoaXMuZ3JhcGggJiYgdGhpcy5ncmFwaC5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdC8vIHRoaXMua2V5d29yZExpc3QucmVmcmVzaEZpbHRlcigpXG5cdFx0XHRpZiAodGhpcy5tb2RlbC5nZXQoXCJ3aXRoQnVuZGxlXCIpKSB7XG5cdFx0XHRcdHRoaXMuZ3JhcGguZWwuYWRkRXZlbnRMaXN0ZW5lcihHbG9iYWxzLkNMSUNLX0VWRU5ULCB0aGlzLl9vbk5hdmlnYXRpb25DbGljayk7XG5cdFx0XHRcdHRoaXMudnBhbi5vbihcInZwYW5zdGFydFwiLCB0aGlzLl9vblZQYW5TdGFydCk7XG5cdFx0XHRcdHRoaXMuaHBhbi5vbihcImhwYW5zdGFydFwiLCB0aGlzLl9vbkhQYW5TdGFydCk7XG5cdFx0XHRcdC8vIHRoaXMuaHBhbi5vbihcInRhcFwiLCB0aGlzLl9vblRhcCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmdyYXBoLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoR2xvYmFscy5DTElDS19FVkVOVCwgdGhpcy5fb25OYXZpZ2F0aW9uQ2xpY2spO1xuXHRcdFx0XHR0aGlzLnZwYW4ub2ZmKFwidnBhbnN0YXJ0XCIsIHRoaXMuX29uVlBhblN0YXJ0KTtcblx0XHRcdFx0dGhpcy5ocGFuLm9mZihcImhwYW5zdGFydFwiLCB0aGlzLl9vbkhQYW5TdGFydCk7XG5cdFx0XHRcdGtleXdvcmRzLmRlc2VsZWN0KCk7XG5cdFx0XHRcdC8vIHRoaXMuaHBhbi5vZmYoXCJ0YXBcIiwgdGhpcy5fb25UYXApO1xuXHRcdFx0fVxuXHRcdFx0Ly8gdGhpcy5ncmFwaC52YWx1ZVRvKClcblx0XHR9XG5cdH0sXG5cblx0Ly8gX29ud2l0aEJ1bmRsZUNoYW5nZTogZnVuY3Rpb24od2l0aEJ1bmRsZSkge1xuXHQvLyBcdGlmICh3aXRoQnVuZGxlKSB7XG5cdC8vIFx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY29sbGFwc2VkOmNoYW5nZVwiLCBmdW5jdGlvbihjb2xsYXBzZWQpe1xuXHQvL1xuXHQvLyBcdFx0fSk7XG5cdC8vIFx0fSBlbHNlIHtcblx0Ly8gXHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLm1vZGVsLCBcImNvbGxhcHNlZDpjaGFuZ2VcIiwgZnVuY3Rpb24oY29sbGFwc2VkKXtcblx0Ly9cblx0Ly8gXHRcdH0pO1xuXHQvLyBcdH1cblx0Ly8gfSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBrZXl3b3JkIGNvbGxlY3Rpb24gY2hhbmdlZFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25LZXl3b3JkU2VsZWN0OiBmdW5jdGlvbihrZXl3b3JkKSB7XG5cdFx0Ly8gdXNlIGNvbGxlY3Rpb24gbGlzdGVuZXIgdG8gYXZvaWQgcmVkdW5kYW50IHJlZnJlc2hGaWx0ZXIgY2FsbHNcblx0XHR0aGlzLmJ1bmRsZUxpc3QucmVmcmVzaEZpbHRlcigpO1xuXHRcdGlmICghdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikgJiYgdGhpcy5ncmFwaCkge1xuXHRcdFx0dGhpcy5saXN0ZW5Ub09uY2UodGhpcy5idW5kbGVMaXN0LCBcInZpZXc6cmVuZGVyOmFmdGVyXCIsIGZ1bmN0aW9uKHZpZXcsIGZsYWdzKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vbktleXdvcmRTZWxlY3QgLT4gJXM6W3ZpZXc6cmVuZGVyOmFmdGVyXSBmbGFnczolc1wiLCB0aGlzLmNpZCwgdmlldy5jaWQsIFZpZXcuZmxhZ3NUb1N0cmluZyhmbGFncykpO1xuXHRcdFx0XHR0aGlzLmdyYXBoLnZhbHVlVG8oMCwgMCwgXCJiMmFcIik7XG5cdFx0XHRcdC8vIHRoaXMuZ3JhcGgucmVuZGVyTm93KCk7XG5cdFx0XHRcdHRoaXMuZ3JhcGgudmFsdWVUbygxLCBHbG9iYWxzLlRSQU5TSVRJT05fRFVSQVRJT04sIFwiYjJhXCIpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFVJIEV2ZW50czogYnVuZGxlTGlzdCBrZXl3b3JkTGlzdCBidXR0b25zXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vbk5hdmlnYXRpb25DbGljazogZnVuY3Rpb24oZXYpIHtcblx0XHRpZiAoZXYuZGVmYXVsdFByZXZlbnRlZCB8fCBldi50YXJnZXQgIT09IHRoaXMuZ3JhcGguZWwpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0ZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRpZiAodGhpcy5tb2RlbC5oYXMoXCJidW5kbGVcIikpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vbk5hdmlnYXRpb25DbGljayBbJXNdXCIsIHRoaXMuY2lkLCBldi50eXBlLCBldik7IC8vLCBldi50YXJnZXQpO1xuXHRcdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLm9mZnNldCgwLCAxLCB0aGlzLmdyYXBoLmVsKTtcblx0XHRcdC8vIHRoaXMudHJhbnNmb3Jtcy52YWxpZGF0ZSgpO1xuXHRcdFx0Ly8gdGhpcy5fc2V0Q29sbGFwc2VkKCF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSk7XG5cdFx0XHR0aGlzLnNldEltbWVkaWF0ZShmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5tb2RlbC5zZXQoXCJjb2xsYXBzZWRcIiwgIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHRfc2V0Q29sbGFwc2VkOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdGlmICh2YWx1ZSAhPT0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHRcdC8vIHRoaXMudHJhbnNmb3Jtcy5vZmZzZXQoMCwgMSwgdGhpcy5ncmFwaC5lbCk7XG5cdFx0XHQvLyB0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0XHRcdHRoaXMuc2V0SW1tZWRpYXRlKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpfc2V0Q29sbGFwc2VkIC0+ICVzIChzZXRJbW1lZGlhdGUpXCIsIHRoaXMuY2lkLCB2YWx1ZSk7XG5cdFx0XHRcdHRoaXMubW9kZWwuc2V0KFwiY29sbGFwc2VkXCIsIHZhbHVlKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIEhvcml6b250YWwgdG91Y2gvbW92ZSAoSGFtbWVySlMpXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25IUGFuU3RhcnQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLmdldCh0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpXG5cdFx0XHQuc3RvcFRyYW5zaXRpb24oKVxuXHRcdFx0LmNsZWFyT2Zmc2V0KClcblx0XHRcdC52YWxpZGF0ZSgpO1xuXHRcdC8vIGlmICh0aGlzLm1vZGVsLmdldChcImxheW91dE5hbWVcIikgIT0gXCJsZWZ0LWxheW91dFwiXG5cdFx0Ly8gXHQmJiB0aGlzLm1vZGVsLmdldChcImxheW91dE5hbWVcIikgIT0gXCJkZWZhdWx0LWxheW91dFwiKSB7XG5cdFx0Ly8gXHRyZXR1cm47XG5cdFx0Ly8gfVxuXHRcdGlmIChHbG9iYWxzLkJSRUFLUE9JTlRTW1wiZGVza3RvcC1zbWFsbFwiXS5tYXRjaGVzXG5cdFx0XHQmJiB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKS5nZXQoXCJtZWRpYVwiKS5zZWxlY3RlZEluZGV4IDw9IDBcblx0XHRcdCYmIHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcikuY2xlYXJDYXB0dXJlKCk7XG5cdFx0XHR0aGlzLl9vbkhQYW5Nb3ZlKGV2KTtcblxuXHRcdFx0dGhpcy5ocGFuLm9uKFwiaHBhbm1vdmVcIiwgdGhpcy5fb25IUGFuTW92ZSk7XG5cdFx0XHR0aGlzLmhwYW4ub24oXCJocGFuZW5kIGhwYW5jYW5jZWxcIiwgdGhpcy5fb25IUGFuRmluYWwpO1xuXHRcdH1cblx0fSxcblxuXHRfb25IUGFuTW92ZTogZnVuY3Rpb24oZXYpIHtcblx0XHQvLyB2YXIgSFBBTl9EUkFHID0gMTtcblx0XHQvLyB2YXIgSFBBTl9EUkFHID0gMC43NTtcblx0XHR2YXIgSFBBTl9EUkFHID0gNzIwIC8gOTIwO1xuXHRcdHZhciBkZWx0YSA9IGV2LmRlbHRhWDsgLy9ldi50aHJlc2hvbGREZWx0YVg7XG5cdFx0Ly8gdmFyIG1lZGlhSXRlbXMgPSB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKS5nZXQoXCJtZWRpYVwiKTtcblxuXHRcdGlmICh0aGlzLm1vZGVsLmhhcyhcIm1lZGlhXCIpKSB7XG5cdFx0XHRkZWx0YSAqPSAoZXYub2Zmc2V0RGlyZWN0aW9uICYgSGFtbWVyLkRJUkVDVElPTl9MRUZUKSA/XG5cdFx0XHRcdDAuMCA6IEhQQU5fRFJBRztcblx0XHR9IGVsc2Uge1xuXHRcdFx0ZGVsdGEgKj0gKGV2Lm9mZnNldERpcmVjdGlvbiAmIEhhbW1lci5ESVJFQ1RJT05fTEVGVCkgP1xuXHRcdFx0XHRIUEFOX0RSQUcgOiBHbG9iYWxzLkhQQU5fT1VUX0RSQUc7XG5cdFx0fVxuXHRcdHRoaXMudHJhbnNmb3Jtcy5vZmZzZXQoZGVsdGEsIG51bGwsIHRoaXMua2V5d29yZExpc3Qud3JhcHBlcik7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdH0sXG5cblx0X29uSFBhbkZpbmFsOiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMuaHBhbi5vZmYoXCJocGFubW92ZVwiLCB0aGlzLl9vbkhQYW5Nb3ZlKTtcblx0XHR0aGlzLmhwYW4ub2ZmKFwiaHBhbmVuZCBocGFuY2FuY2VsXCIsIHRoaXMuX29uSFBhbkZpbmFsKTtcblxuXHRcdC8qIE5PVEU6IGlmIHRoZXJlIGlzIG5vIG1vZGVsIGNoYW5nZSwgc2V0IHR4IGhlcmUuIE90aGVyd2lzZSBqdXN0IHdhaXQgZm9yIHJlbmRlciAqL1xuXHRcdHZhciBrVGYgPSB0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcik7XG5cdFx0aWYgKCEodGhpcy5fcmVuZGVyRmxhZ3MgJiBWaWV3Lk1PREVMX0lOVkFMSUQpICYmIGtUZi5oYXNPZmZzZXQpIHtcblx0XHRcdGlmIChrVGYub2Zmc2V0WCAhPSAwKSB7XG5cdFx0XHRcdGtUZi5ydW5UcmFuc2l0aW9uKHR4Lk5PVyk7XG5cdFx0XHR9XG5cdFx0XHRrVGYuY2xlYXJPZmZzZXQoKS52YWxpZGF0ZSgpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIFZlcnRpY2FsIHRvdWNoL21vdmUgKF9vblZQYW4qKVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2NvbGxhcHNlZE9mZnNldFk6IEdsb2JhbHMuQ09MTEFQU0VfT0ZGU0VULFxuXG5cdF9vblZQYW5TdGFydDogZnVuY3Rpb24oZXYpIHtcblx0XHR0aGlzLnZwYW4ub24oXCJ2cGFubW92ZVwiLCB0aGlzLl9vblZQYW5Nb3ZlKTtcblx0XHR0aGlzLnZwYW4ub24oXCJ2cGFuZW5kIHZwYW5jYW5jZWxcIiwgdGhpcy5fb25WUGFuRmluYWwpO1xuXG5cblx0XHR0aGlzLnRyYW5zZm9ybXMuc3RvcFRyYW5zaXRpb24odGhpcy52cGFuR3JvdXApO1xuXHRcdHRoaXMudHJhbnNmb3Jtcy5jbGVhckNhcHR1cmUodGhpcy52cGFuR3JvdXApO1xuXHRcdC8vIHRoaXMudHJhbnNmb3Jtcy5zdG9wVHJhbnNpdGlvbih0aGlzLmJ1bmRsZUxpc3QuZWwsIHRoaXMua2V5d29yZExpc3QuZWwpOyAvLywgdGhpcy5ncmFwaC5lbCk7XG5cdFx0Ly8gLy8gdGhpcy50cmFuc2Zvcm1zLmNsZWFyT2Zmc2V0KHRoaXMuYnVuZGxlTGlzdC5lbCwgdGhpcy5rZXl3b3JkTGlzdC5lbCk7XG5cdFx0Ly8gLy8gdGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLmNsZWFyQ2FwdHVyZSh0aGlzLmJ1bmRsZUxpc3QuZWwsIHRoaXMua2V5d29yZExpc3QuZWwpOyAvLywgdGhpcy5ncmFwaC5lbCk7XG5cdFx0Ly9cblx0XHQvLyBpZiAoIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0Ly8gXHR0aGlzLnRyYW5zZm9ybXMuc3RvcFRyYW5zaXRpb24odGhpcy5ncmFwaC5lbCk7XG5cdFx0Ly8gXHR0aGlzLnRyYW5zZm9ybXMuY2xlYXJDYXB0dXJlKHRoaXMuZ3JhcGguZWwpO1xuXHRcdC8vIH1cblx0XHQvLyAvLyB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoXCJjb250YWluZXItY2hhbmdpbmdcIik7XG5cdFx0dGhpcy5fb25WUGFuTW92ZShldik7XG5cdH0sXG5cblx0X29uVlBhbk1vdmU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dmFyIGRlbHRhID0gdGhpcy5fY29tcHV0ZVZQYW5EZWx0YShldi5kZWx0YVkpOyAvL2V2LnRocmVzaG9sZERlbHRhWSk7XG5cblx0XHR0aGlzLnRyYW5zZm9ybXMub2Zmc2V0KDAsIGRlbHRhLCB0aGlzLnZwYW5Hcm91cCk7XG5cdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLm9mZnNldCgwLCBkZWx0YSxcblx0XHQvLyBcdHRoaXMuYnVuZGxlTGlzdC5lbCwgdGhpcy5rZXl3b3JkTGlzdC5lbCk7XG5cdFx0Ly8gaWYgKCF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdC8vIFx0dGhpcy50cmFuc2Zvcm1zLm9mZnNldCgwLCBkZWx0YSwgdGhpcy5ncmFwaC5lbCk7XG5cdFx0Ly8gfVxuXHRcdHRoaXMudHJhbnNmb3Jtcy52YWxpZGF0ZSgpO1xuXHR9LFxuXG5cdF9vblZQYW5GaW5hbDogZnVuY3Rpb24oZXYpIHtcblx0XHR0aGlzLnZwYW4ub2ZmKFwidnBhbm1vdmVcIiwgdGhpcy5fb25WUGFuTW92ZSk7XG5cdFx0dGhpcy52cGFuLm9mZihcInZwYW5lbmQgdnBhbmNhbmNlbFwiLCB0aGlzLl9vblZQYW5GaW5hbCk7XG5cblx0XHR0aGlzLl9vblZQYW5Nb3ZlKGV2KTtcblx0XHQvLyB0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblxuXHRcdHRoaXMuc2V0SW1tZWRpYXRlKGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLmNsZWFyT2Zmc2V0KHRoaXMuYnVuZGxlTGlzdC5lbCwgdGhpcy5rZXl3b3JkTGlzdC5lbCwgdGhpcy5ncmFwaC5lbCk7XG5cdFx0XHRpZiAodGhpcy53aWxsQ29sbGFwc2VkQ2hhbmdlKGV2KSkge1xuXHRcdFx0XHQvLyB0aGlzLl9zZXRDb2xsYXBzZWQoIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKTtcblx0XHRcdFx0dGhpcy5tb2RlbC5zZXQoXCJjb2xsYXBzZWRcIiwgIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKTtcblx0XHRcdH1cblx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LkxBWU9VVF9JTlZBTElEKS5yZW5kZXJOb3coKTtcblx0XHR9KTtcblx0fSxcblxuXHR3aWxsQ29sbGFwc2VkQ2hhbmdlOiBmdW5jdGlvbihldikge1xuXHRcdHJldHVybiBldi50eXBlID09IFwidnBhbmVuZFwiID8gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikgP1xuXHRcdFx0ZXYuZGVsdGFZID4gR2xvYmFscy5DT0xMQVBTRV9USFJFU0hPTEQgOlxuXHRcdFx0ZXYuZGVsdGFZIDwgLUdsb2JhbHMuQ09MTEFQU0VfVEhSRVNIT0xEIDpcblx0XHRcdGZhbHNlO1xuXHR9LFxuXG5cdF9jb21wdXRlVlBhbkRlbHRhOiBmdW5jdGlvbihkZWx0YSkge1xuXHRcdHZhciBjb2xsYXBzZWQgPSB0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKTtcblx0XHR2YXIgbWF4RGVsdGEgPSB0aGlzLl9jb2xsYXBzZWRPZmZzZXRZOyAvLyArIE1hdGguYWJzKGV2LnRocmVzaG9sZE9mZnNldFkpO1xuXHRcdC8vIGNoZWNrIGlmIGRpcmVjdGlvbiBpcyBhbGlnbmVkIHdpdGggY29sbGFwc2VkL2V4cGFuZFxuXHRcdHZhciBpc1ZhbGlkRGlyID0gY29sbGFwc2VkID8gKGRlbHRhID4gMCkgOiAoZGVsdGEgPCAwKTtcblx0XHR2YXIgbW92ZUZhY3RvciA9IGNvbGxhcHNlZCA/IDEgLSBHbG9iYWxzLlZQQU5fRFJBRyA6IEdsb2JhbHMuVlBBTl9EUkFHO1xuXG5cdFx0ZGVsdGEgPSBNYXRoLmFicyhkZWx0YSk7IC8vIHJlbW92ZSBzaWduXG5cdFx0ZGVsdGEgKj0gbW92ZUZhY3Rvcjtcblx0XHRtYXhEZWx0YSAqPSBtb3ZlRmFjdG9yO1xuXG5cdFx0aWYgKGlzVmFsaWREaXIpIHtcblx0XHRcdGlmIChkZWx0YSA+IG1heERlbHRhKSB7IC8vIG92ZXJzaG9vdGluZ1xuXHRcdFx0XHRkZWx0YSA9ICgoZGVsdGEgLSBtYXhEZWx0YSkgKiBHbG9iYWxzLlZQQU5fT1VUX0RSQUcpICsgbWF4RGVsdGE7XG5cdFx0XHR9IGVsc2UgeyAvLyBubyBvdmVyc2hvb3Rpbmdcblx0XHRcdFx0Ly8gZGVsdGEgPSBkZWx0YTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0ZGVsdGEgPSAoLWRlbHRhKSAqIEdsb2JhbHMuVlBBTl9PVVRfRFJBRzsgLy8gZGVsdGEgaXMgb3Bwb3NpdGVcblx0XHR9XG5cdFx0ZGVsdGEgKj0gY29sbGFwc2VkID8gMC41IDogLTE7IC8vIHJlYXBwbHkgc2lnblxuXHRcdHJldHVybiBkZWx0YTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIENyZWF0ZSBjaGlsZHJlbiBjb21wb25lbnRzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8vICNzaXRlLW5hbWVcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdGNyZWF0ZVNpdGVuYW1lQnV0dG9uOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBWaWV3KHtcblx0XHRcdGVsOiBcIiNzaXRlLW5hbWVcIixcblx0XHRcdGV2ZW50czoge1xuXHRcdFx0XHRcImNsaWNrIGFcIjogZnVuY3Rpb24oZG9tZXYpIHtcblx0XHRcdFx0XHRkb21ldi5kZWZhdWx0UHJldmVudGVkIHx8IGRvbWV2LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpjbGlja1wiKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHZpZXcud3JhcHBlciA9IHZpZXcuZWwucGFyZW50RWxlbWVudDtcblx0XHR0aGlzLmxpc3RlblRvKHZpZXcsIFwidmlldzpjbGlja1wiLCB0aGlzLl9vblNpdGVuYW1lQ2xpY2spO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdF9vblNpdGVuYW1lQ2xpY2s6IGZ1bmN0aW9uKCkge1xuXHRcdHN3aXRjaCAodGhpcy5tb2RlbC5nZXQoXCJyb3V0ZU5hbWVcIikpIHtcblx0XHRcdGNhc2UgXCJtZWRpYS1pdGVtXCI6XG5cdFx0XHRjYXNlIFwiYnVuZGxlLWl0ZW1cIjpcblx0XHRcdFx0Ly8gaWYgKHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHRcdC8vIFx0dGhpcy5fc2V0Q29sbGFwc2VkKGZhbHNlKTtcblx0XHRcdFx0Ly8gfSBlbHNlIHtcblx0XHRcdFx0Y29udHJvbGxlci5kZXNlbGVjdEJ1bmRsZSgpO1xuXHRcdFx0XHQvLyB9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcImFydGljbGUtaXRlbVwiOlxuXHRcdFx0XHRjb250cm9sbGVyLmRlc2VsZWN0QXJ0aWNsZSgpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH0sXG5cblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvLyAuYXJ0aWNsZS1idXR0b25cblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdGNyZWF0ZUFydGljbGVCdXR0b246IGZ1bmN0aW9uKGFydGljbGVJdGVtKSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgQXJ0aWNsZUJ1dHRvbih7XG5cdFx0XHRlbDogXCIuYXJ0aWNsZS1idXR0b25bZGF0YS1oYW5kbGU9J2Fib3V0J11cIixcblx0XHRcdG1vZGVsOiBhcnRpY2xlSXRlbVxuXHRcdH0pLnJlbmRlcigpO1xuXHRcdHZpZXcud3JhcHBlciA9IHZpZXcuZWwucGFyZW50RWxlbWVudDtcblx0XHR0aGlzLmxpc3RlblRvKHZpZXcsIFwidmlldzpjbGlja1wiLCB0aGlzLl9vbkFydGljbGVDbGljayk7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0X29uQXJ0aWNsZUNsaWNrOiBmdW5jdGlvbihpdGVtKSB7XG5cdFx0c3dpdGNoICh0aGlzLm1vZGVsLmdldChcInJvdXRlTmFtZVwiKSkge1xuXHRcdFx0Y2FzZSBcImFydGljbGUtaXRlbVwiOlxuXHRcdFx0XHRjb250cm9sbGVyLmRlc2VsZWN0QXJ0aWNsZSgpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJyb290XCI6XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRjb250cm9sbGVyLnNlbGVjdEFydGljbGUoaXRlbSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSxcblxuXHRjcmVhdGVBYm91dEJ1dHRvbjogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuY3JlYXRlQXJ0aWNsZUJ1dHRvbihhcnRpY2xlcy5maW5kV2hlcmUoeyBoYW5kbGU6IFwiYWJvdXRcIiB9KSk7XG5cdH0sXG5cblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvLyAjYnVuZGxlLWxpc3Rcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdC8qKlxuXHQgKiBAcGFyYW0gZWwge0hUTUxFbGVtZW50fVxuXHQgKiBAcmV0dXJuIHttb2R1bGU6YXBwL2Jhc2Uvdmlldy9jb21wb25lbnQvRmlsdGVyYWJsZUxpc3RWaWV3fVxuXHQgKi9cblx0Y3JlYXRlQnVuZGxlTGlzdDogZnVuY3Rpb24oZWwpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBGaWx0ZXJhYmxlTGlzdFZpZXcoe1xuXHRcdFx0ZWw6IChlbCB8fCBcIiNidW5kbGUtbGlzdFwiKSxcblx0XHRcdGNvbGxlY3Rpb246IGJ1bmRsZXMsXG5cdFx0XHRjb2xsYXBzZWQ6IGZhbHNlLFxuXHRcdFx0ZmlsdGVyRm46IGZ1bmN0aW9uKGJ1bmRsZSwgaW5kZXgsIGFycikge1xuXHRcdFx0XHRyZXR1cm4ga2V5d29yZHMuc2VsZWN0ZWQgP1xuXHRcdFx0XHRcdGJ1bmRsZS5nZXQoXCJrSWRzXCIpLmluZGV4T2Yoa2V5d29yZHMuc2VsZWN0ZWQuaWQpICE9PSAtMSA6IGZhbHNlO1xuXHRcdFx0fSxcblx0XHR9KTtcblx0XHR2aWV3LndyYXBwZXIgPSB2aWV3LmVsLnBhcmVudEVsZW1lbnQ7XG5cdFx0dGhpcy5saXN0ZW5Ubyh2aWV3LCBcInZpZXc6c2VsZWN0Om9uZSB2aWV3OnNlbGVjdDpub25lXCIsIGZ1bmN0aW9uKGJ1bmRsZSkge1xuXHRcdFx0dGhpcy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGNvbnRyb2xsZXIuc2VsZWN0QnVuZGxlKGJ1bmRsZSk7XG5cdFx0XHR9KTtcblx0XHR9KVxuXHRcdHRoaXMubGlzdGVuVG8odmlldywgXCJ2aWV3OnNlbGVjdDpzYW1lXCIsIHRoaXMuX29uQnVuZGxlTGlzdFNhbWUpO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdF9vbkJ1bmRsZUxpc3RTYW1lOiBmdW5jdGlvbihidW5kbGUpIHtcblx0XHR0aGlzLnRyYW5zZm9ybXMub2Zmc2V0KDAsIDEsIHRoaXMuZ3JhcGguZWwpO1xuXHRcdHRoaXMudHJhbnNmb3Jtcy52YWxpZGF0ZSgpO1xuXHRcdHRoaXMuc2V0SW1tZWRpYXRlKGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5tb2RlbC5zZXQoXCJjb2xsYXBzZWRcIiwgIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKTtcblx0XHR9KTtcblx0fSxcblxuXHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8vICNrZXl3b3JkLWxpc3Rcblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdC8qKlxuXHQgKiBAcGFyYW0gZWwge0hUTUxFbGVtZW50fVxuXHQgKiBAcmV0dXJuIHttb2R1bGU6YXBwL2Jhc2Uvdmlldy9jb21wb25lbnQvR3JvdXBpbmdMaXN0Vmlld31cblx0ICovXG5cdGNyZWF0ZUtleXdvcmRMaXN0OiBmdW5jdGlvbihlbCkge1xuXHRcdHZhciB2aWV3ID0gbmV3IEdyb3VwaW5nTGlzdFZpZXcoe1xuXHRcdFx0ZWw6IChlbCB8fCBcIiNrZXl3b3JkLWxpc3RcIiksXG5cdFx0XHRjb2xsZWN0aW9uOiBrZXl3b3Jkcyxcblx0XHRcdGNvbGxhcHNlZDogZmFsc2UsXG5cdFx0XHRmaWx0ZXJGbjogZnVuY3Rpb24oaXRlbSwgaWR4LCBhcnIpIHtcblx0XHRcdFx0Ly8gcmV0dXJuICEhKGl0ZW0uZ2V0KFwiYnVuZGxlXCIpLnNlbGVjdGVkKTtcblx0XHRcdFx0cmV0dXJuIGJ1bmRsZXMuc2VsZWN0ZWQgP1xuXHRcdFx0XHRcdChidW5kbGVzLnNlbGVjdGVkLmdldChcImtJZHNcIikuaW5kZXhPZihpdGVtLmlkKSAhPT0gLTEpIDogZmFsc2U7XG5cdFx0XHR9LFxuXHRcdFx0Z3JvdXBpbmdGbjogZnVuY3Rpb24oaXRlbSwgaWR4LCBhcnIpIHtcblx0XHRcdFx0Ly8gcmV0dXJuIGl0ZW0uZ2V0KFwidHlwZVwiKTtcblx0XHRcdFx0cmV0dXJuIHR5cGVzLmdldChpdGVtLmdldChcInRJZFwiKSk7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHRcdHZpZXcud3JhcHBlciA9IHZpZXcuZWwucGFyZW50RWxlbWVudDtcblx0XHR2aWV3Lmxpc3RlblRvKGtleXdvcmRzLCBcInNlbGVjdDpvbmUgc2VsZWN0Om5vbmVcIiwgZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0dmlldy5zZWxlY3RlZEl0ZW0gPSBpdGVtO1xuXHRcdH0pO1xuXHRcdHRoaXMubGlzdGVuVG8odmlldywgXCJ2aWV3OnNlbGVjdDpvbmUgdmlldzpzZWxlY3Q6bm9uZVwiLCB0aGlzLl9vbktleXdvcmRMaXN0Q2hhbmdlKTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHRfb25LZXl3b3JkTGlzdENoYW5nZTogZnVuY3Rpb24oa2V5d29yZCkge1xuXHRcdGlmICghdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHRcdGtleXdvcmRzLnNlbGVjdChrZXl3b3JkKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvLyAjbmF2LWdyYXBoXG5cdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHQvKipcblx0ICogQHBhcmFtIGxpc3RBIHttb2R1bGU6YXBwL2Jhc2Uvdmlldy9jb21wb25lbnQvRmlsdGVyYWJsZUxpc3RWaWV3fVxuXHQgKiBAcGFyYW0gbGlzdEIge21vZHVsZTphcHAvYmFzZS92aWV3L2NvbXBvbmVudC9GaWx0ZXJhYmxlTGlzdFZpZXd9XG5cdCAqIEBwYXJhbSBwYXJlbnRFbCB7SFRNTEVsZW1lbnR9XG5cdCAqIEByZXR1cm4ge21vZHVsZTphcHAvYmFzZS92aWV3L2NvbXBvbmVudC9HcmFwaFZpZXd9XG5cdCAqL1xuXHRjcmVhdGVHcmFwaFZpZXc6IGZ1bmN0aW9uKGxpc3RBLCBsaXN0QiwgcGFyZW50RWwpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBHcmFwaFZpZXcoe1xuXHRcdFx0aWQ6IFwibmF2LWdyYXBoXCIsXG5cdFx0XHRsaXN0QTogbGlzdEEsXG5cdFx0XHRsaXN0QjogbGlzdEIsXG5cdFx0XHRtb2RlbDogdGhpcy5tb2RlbCxcblx0XHRcdHVzZU9wYXF1ZTogZmFsc2Vcblx0XHR9KTtcblx0XHRwYXJlbnRFbCB8fCAocGFyZW50RWwgPSB0aGlzLmVsKTtcblx0XHRwYXJlbnRFbC5pbnNlcnRCZWZvcmUodmlldy5lbCwgcGFyZW50RWwuZmlyc3RFbGVtZW50Q2hpbGQpO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogSG9yaXpvbnRhbCB0b3VjaC9tb3ZlIChNdXRhdGlvbk9ic2VydmVyKVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Lypcblx0X2JlZ2luVHJhbnNmb3JtT2JzZXJ2ZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCEoR2xvYmFscy5CUkVBS1BPSU5UU1tcImRlc2t0b3Atc21hbGxcIl0ubWF0Y2hlcyAmJiB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKS5nZXQoXCJtZWRpYVwiKS5zZWxlY3RlZEluZGV4IDw9IDAgJiYgdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHZhciB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcm91c2VsID4gLmVtcHR5LWl0ZW1cIik7XG5cdFx0aWYgKHRhcmdldCA9PT0gbnVsbCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAoIXRoaXMuX3RyYW5zZm9ybU9ic2VydmVyKSB7XG5cdFx0XHR0aGlzLl90cmFuc2Zvcm1PYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKHRoaXMuX29uVHJhbnNmb3JtTXV0YXRpb24pO1xuXHRcdH1cblx0XHR0aGlzLl90cmFuc2Zvcm1PYnNlcnZlci5vYnNlcnZlKHRhcmdldCwgeyBhdHRyaWJ1dGVzOiB0cnVlLCBhdHRyaWJ1dGVGaWx0ZXI6IFtcInN0eWxlXCJdIH0pO1xuXHRcdHRoaXMuaHBhbi5vbihcImhwYW5lbmQgaHBhbmNhbmNlbFwiLCB0aGlzLl9lbmRUcmFuc2Zvcm1PYnNlcnZlKTtcblx0XHR0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcilcblx0XHRcdC5zdG9wVHJhbnNpdGlvbigpXG5cdFx0XHQuY2xlYXJPZmZzZXQoKVxuXHRcdFx0LmNsZWFyQ2FwdHVyZSgpXG5cdFx0XHQudmFsaWRhdGUoKTtcblx0fSxcblxuXHRfZW5kVHJhbnNmb3JtT2JzZXJ2ZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5fdHJhbnNmb3JtT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuXHRcdHRoaXMuaHBhbi5vZmYoXCJocGFuZW5kIGhwYW5jYW5jZWxcIiwgdGhpcy5fZW5kVHJhbnNmb3JtT2JzZXJ2ZSk7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLmdldCh0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpXG5cdFx0XHQuY2xlYXJPZmZzZXQoKVxuXHRcdFx0LnJ1blRyYW5zaXRpb24odHguTk9XKVxuXHRcdFx0LnZhbGlkYXRlKCk7XG5cdH0sXG5cblx0X29uVHJhbnNmb3JtTXV0YXRpb246IGZ1bmN0aW9uKG11dGF0aW9ucykge1xuXHRcdHZhciB0VmlldywgdE1ldHJpY3MsIHRDc3MsIGRUeE9iaiwgcG9zO1xuXG5cdFx0Ly8gdGhpcy5rZXl3b3JkTGlzdC53cmFwcGVyLnN0eWxlW3ByZWZpeGVkUHJvcGVydHkoXCJ0cmFuc2Zvcm1cIildO1xuXHRcdC8vIHRyYW5zZm9ybSA9IG11dGF0aW9uc1swXS50YXJnZXQuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShwcmVmaXhlZFByb3BlcnR5KFwidHJhbnNmb3JtXCIpKTtcblxuXHRcdHRWaWV3ID0gVmlldy5maW5kQnlFbGVtZW50KG11dGF0aW9uc1swXS50YXJnZXQpO1xuXHRcdGlmICh0Vmlldykge1xuXHRcdFx0dE1ldHJpY3MgPSB0Vmlldy5tZXRyaWNzO1xuXHRcdFx0ZFR4T2JqID0gdGhpcy50cmFuc2Zvcm1zLmdldCh0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpO1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczo6X29uVHJhbnNmb3JtTXV0YXRpb24gW3dpdGhNZWRpYTogJXNdIHRhcmdldDogKCVmXFwrJWYpICVmIHdyYXBwZXI6ICglZikgJWZcIiwgdGhpcy5jaWQsXG5cdFx0XHRcdHRoaXMubW9kZWwuaGFzKFwibWVkaWFcIiksXG5cdFx0XHRcdHRNZXRyaWNzLnRyYW5zbGF0ZVgsIHRNZXRyaWNzLndpZHRoLCB0TWV0cmljcy50cmFuc2xhdGVYICsgdE1ldHJpY3Mud2lkdGgsXG5cdFx0XHRcdGRUeE9iai5jYXB0dXJlZFgsIHRNZXRyaWNzLnRyYW5zbGF0ZVggLSBkVHhPYmouY2FwdHVyZWRYLFxuXHRcdFx0XHR0TWV0cmljc1xuXHRcdFx0KTtcblxuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLm9mZnNldCh0TWV0cmljcy50cmFuc2xhdGVYIC0gZFR4T2JqLmNhcHR1cmVkWCwgdm9pZCAwLCB0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpO1xuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdFx0fVxuXHR9LFxuXHQqL1xufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gTmF2aWdhdGlvblZpZXc7IiwidmFyIFByaW9yaXR5UXVldWUgPSBmdW5jdGlvbihvZmZzZXQpIHtcblx0dGhpcy5fb2Zmc2V0ID0gb2Zmc2V0IHwgMDtcblx0dGhpcy5faXRlbXMgPSBbXTtcblx0dGhpcy5fcHJpb3JpdGllcyA9IFtdO1xuXHR0aGlzLl9udW1JdGVtcyA9IDA7XG59O1xuXG5Qcmlvcml0eVF1ZXVlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoe1xuXHRlbnF1ZXVlOiBmdW5jdGlvbihpdGVtLCBwcmlvcml0eSkge1xuXHRcdHZhciBpID0gdGhpcy5faXRlbXMubGVuZ3RoO1xuXHRcdHRoaXMuX2l0ZW1zW2ldID0gaXRlbTtcblx0XHR0aGlzLl9wcmlvcml0aWVzW2ldID0ge1xuXHRcdFx0cHJpb3JpdHk6IChwcmlvcml0eSB8IDApLFxuXHRcdFx0aW5kZXg6IGlcblx0XHR9O1xuXHRcdHRoaXMuX251bUl0ZW1zKys7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJGcmFtZVF1ZXVlOjpSZXF1ZXN0UXVldWU6OmVucXVldWUoKSBbbnVtSXRlbXM6JWldIElEOiVpXCIsIHRoaXMuX251bUl0ZW1zLCB0aGlzLl9vZmZzZXQgKyBpKTtcblx0XHRyZXR1cm4gdGhpcy5fb2Zmc2V0ICsgaTtcblx0fSxcblxuXHRjb250YWluczogZnVuY3Rpb24oaW5kZXgpIHtcblx0XHRpbmRleCAtPSB0aGlzLm9mZnNldDtcblx0XHRyZXR1cm4gMCA8PSBpbmRleCAmJiBpbmRleCA8IHRoaXMuX2l0ZW1zLmxlbmd0aDtcblx0fSxcblxuXHRza2lwOiBmdW5jdGlvbihpbmRleCkge1xuXHRcdHZhciBpLCBpdGVtO1xuXHRcdGkgPSBpbmRleCAtIHRoaXMuX29mZnNldDtcblx0XHRpZiAoMCA+IGkgfHwgaSA+PSB0aGlzLl9pdGVtcy5sZW5ndGgpIHtcblx0XHRcdC8vIFx0Y29uc29sZS53YXJuKFwiRnJhbWVRdWV1ZTo6UmVxdWVzdFF1ZXVlOjpza2lwKGlkOiVpKSBvdXQgb2YgcmFuZ2UgKCVpLSVpKVwiLCBpbmRleCwgdGhpcy5fb2Zmc2V0LCB0aGlzLl9vZmZzZXQgKyAodGhpcy5fbnVtSXRlbXMgLSAxKSk7XG5cdFx0XHRyZXR1cm4gdm9pZCAwO1xuXHRcdH1cblx0XHRpdGVtID0gdGhpcy5faXRlbXNbaV07XG5cdFx0aWYgKGl0ZW0gIT09IG51bGwpIHtcblx0XHRcdC8vIGlmIChpdGVtID0gdGhpcy5faXRlbXNbaV0pIHtcblx0XHRcdHRoaXMuX2l0ZW1zW2ldID0gbnVsbDtcblx0XHRcdHRoaXMuX251bUl0ZW1zLS07XG5cdFx0fVxuXHRcdHJldHVybiBpdGVtO1xuXHR9LFxuXG5cdGluZGV4ZXM6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBpdGVtcyA9IHRoaXMuX3ByaW9yaXRpZXMuY29uY2F0KCk7XG5cdFx0aXRlbXMuc29ydChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHRpZiAoYS5wcmlvcml0eSA+IGIucHJpb3JpdHkpXG5cdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0aWYgKGEucHJpb3JpdHkgPCBiLnByaW9yaXR5KVxuXHRcdFx0XHRyZXR1cm4gLTE7XG5cdFx0XHRyZXR1cm4gMDtcblx0XHR9KTtcblx0XHRpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKG8sIGksIGEpIHtcblx0XHRcdGFbaV0gPSBvLmluZGV4O1xuXHRcdH0sIHRoaXMpO1xuXHRcdHJldHVybiBpdGVtcztcblx0fSxcblxuXHRpdGVtczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGl0ZW1zID0gdGhpcy5fcHJpb3JpdGllcy5jb25jYXQoKTtcblx0XHRpdGVtcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdGlmIChhLnByaW9yaXR5ID4gYi5wcmlvcml0eSlcblx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHRpZiAoYS5wcmlvcml0eSA8IGIucHJpb3JpdHkpXG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdHJldHVybiAwO1xuXHRcdH0pO1xuXHRcdGl0ZW1zLmZvckVhY2goZnVuY3Rpb24obywgaSwgYSkge1xuXHRcdFx0YVtpXSA9IHRoaXMuX2l0ZW1zW28uaW5kZXhdO1xuXHRcdH0sIHRoaXMpO1xuXHRcdHJldHVybiBpdGVtcztcblx0fSxcblxuXHRfZW1wdHk6IGZ1bmN0aW9uKG9mZnNldCkge1xuXHRcdHRoaXMuX29mZnNldCA9IG9mZnNldDtcblx0XHR0aGlzLl9pdGVtcy5sZW5ndGggPSAwO1xuXHRcdHRoaXMuX3ByaW9yaXRpZXMubGVuZ3RoID0gMDtcblx0XHR0aGlzLl9udW1JdGVtcyA9IDA7XG5cdH1cbn0sIHtcblxuXHRvZmZzZXQ6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX29mZnNldDtcblx0XHR9XG5cdH0sXG5cblx0bGVuZ3RoOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9pdGVtcy5sZW5ndGg7XG5cdFx0fVxuXHR9LFxuXG5cdG51bUl0ZW1zOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9udW1JdGVtcztcblx0XHR9XG5cdH0sXG59KTtcblxudmFyIENhbGxiYWNrUXVldWUgPSBmdW5jdGlvbihyZXF1ZXN0Rm4sIGNhbmNlbEZuKSB7XG5cdHRoaXMuX25leHRRdWV1ZSA9IG5ldyBQcmlvcml0eVF1ZXVlKDApO1xuXHR0aGlzLl9jdXJyUXVldWUgPSBudWxsO1xuXG5cdC8vIHRoaXMuX3BlbmRpbmcgPSBmYWxzZTtcblx0dGhpcy5fcnVubmluZyA9IGZhbHNlO1xuXHR0aGlzLl9ydW5JZCA9IC0xO1xuXG5cdHRoaXMuX3JlcXVlc3RGbiA9IHJlcXVlc3RGbjtcblx0dGhpcy5fY2FuY2VsRm4gPSBjYW5jZWxGbjtcblx0dGhpcy5fcnVuUXVldWUgPSB0aGlzLl9ydW5RdWV1ZS5iaW5kKHRoaXMpXG59O1xuXG5DYWxsYmFja1F1ZXVlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoe1xuXHQvKipcblx0ICogQHBhcmFtIHRzdGFtcCB7aW50fVxuXHQgKi9cblx0X3J1blF1ZXVlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fcnVubmluZykgdGhyb3cgbmV3IEVycm9yKFwid3RmISEhXCIpO1xuXG5cdFx0dGhpcy5fY3VyclF1ZXVlID0gdGhpcy5fbmV4dFF1ZXVlO1xuXHRcdHRoaXMuX25leHRRdWV1ZSA9IG5ldyBQcmlvcml0eVF1ZXVlKHRoaXMuX2N1cnJRdWV1ZS5vZmZzZXQgKyB0aGlzLl9jdXJyUXVldWUubGVuZ3RoKTtcblxuXHRcdHRoaXMuX3J1bklkID0gLTE7XG5cdFx0dGhpcy5fcnVubmluZyA9IHRydWU7XG5cblx0XHR2YXIgaSwgaXRlbTtcblx0XHR2YXIgaW5kZXhlcyA9IHRoaXMuX2N1cnJRdWV1ZS5pbmRleGVzKCk7XG5cdFx0dmFyIGl0ZW1zID0gdGhpcy5fY3VyclF1ZXVlLl9pdGVtcztcblx0XHRmb3IgKGkgPSAwOyBpIDwgaW5kZXhlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0aXRlbSA9IGl0ZW1zW2luZGV4ZXNbaV1dO1xuXHRcdFx0aWYgKGl0ZW0gIT09IG51bGwpIHtcblx0XHRcdFx0aXRlbS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIHZhciBzZWxmID0gdGhpcztcblx0XHQvLyB0aGlzLl9jdXJyUXVldWUuaW5kZXhlcygpLmZvckVhY2goZnVuY3Rpb24oaW5kZXgpIHtcblx0XHQvLyBcdHZhciBmbiA9IHNlbGYuX2N1cnJRdWV1ZS5faXRlbXNbaW5kZXhdO1xuXHRcdC8vIFx0aWYgKGZuICE9PSBudWxsKSB7XG5cdFx0Ly8gXHRcdGZuLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG5cdFx0Ly8gXHR9XG5cdFx0Ly8gfSk7XG5cdFx0dGhpcy5fcnVubmluZyA9IGZhbHNlO1xuXHRcdHRoaXMuX2N1cnJRdWV1ZSA9IG51bGw7XG5cblx0XHRpZiAodGhpcy5fbmV4dFF1ZXVlLm51bUl0ZW1zID4gMCkge1xuXHRcdFx0dGhpcy5fcnVuSWQgPSB0aGlzLl9yZXF1ZXN0Rm4uY2FsbChudWxsLCB0aGlzLl9ydW5RdWV1ZSk7XG5cdFx0XHQvLyB0aGlzLl9ydW5JZCA9IHRoaXMuX3JlcXVlc3RGbih0aGlzLl9ydW5RdWV1ZSk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKlxuXHQgKiBAcGFyYW0gZm4ge0Z1bmN0aW9ufVxuXHQgKiBAcGFyYW0gcHJpb3JpdHkge2ludH1cblx0ICogQHJldHVybiB7aW50fVxuXHQgKi9cblx0cmVxdWVzdDogZnVuY3Rpb24oZm4sIHByaW9yaXR5KSB7XG5cdFx0Ly8gaWYgKCF0aGlzLl9ydW5uaW5nICYmICF0aGlzLl9wZW5kaW5nKSB7XG5cdFx0Ly8gXHR0aGlzLl9wZW5kaW5nID0gdHJ1ZTtcblx0XHQvLyBcdGNvbnNvbGUud2FybihcIkZyYW1lUXVldWU6OnJlcXVlc3Qgc2V0SW1tZWRpYXRlOiBwZW5kaW5nXCIpO1xuXHRcdC8vIFx0c2V0SW1tZWRpYXRlKGZ1bmN0aW9uKCkge1xuXHRcdC8vIFx0XHR0aGlzLl9wZW5kaW5nID0gZmFsc2U7XG5cdFx0Ly8gXHRcdGlmICh0aGlzLl9uZXh0UXVldWUubnVtSXRlbXMgPiAwKSB7XG5cdFx0Ly8gXHRcdFx0dGhpcy5fcnVuSWQgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKF9ydW5RdWV1ZSk7XG5cdFx0Ly8gXHRcdFx0Y29uc29sZS53YXJuKFwiRnJhbWVRdWV1ZTo6cmVxdWVzdCBzZXRJbW1lZGlhdGU6IHJhZjolaSBmb3IgJWkgaXRlbXNcIiwgdGhpcy5fcnVuSWQsIHRoaXMuX25leHRRdWV1ZS5udW1JdGVtcyk7XG5cdFx0Ly8gXHRcdH0gZWxzZSB7XG5cdFx0Ly8gXHRcdFx0Y29uc29sZS53YXJuKFwiRnJhbWVRdWV1ZTo6cmVxdWVzdCBzZXRJbW1lZGlhdGU6IG5vIGl0ZW1zXCIpO1xuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHR9KTtcblx0XHQvLyB9XG5cdFx0aWYgKCF0aGlzLl9ydW5uaW5nICYmIHRoaXMuX3J1bklkID09PSAtMSkge1xuXHRcdFx0dGhpcy5fcnVuSWQgPSB0aGlzLl9yZXF1ZXN0Rm4uY2FsbChudWxsLCB0aGlzLl9ydW5RdWV1ZSk7XG5cdFx0XHQvLyB0aGlzLl9ydW5JZCA9IHRoaXMuX3JlcXVlc3RGbih0aGlzLl9ydW5RdWV1ZSk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLl9uZXh0UXVldWUuZW5xdWV1ZShmbiwgcHJpb3JpdHkpO1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBAcGFyYW0gaWQge2ludH1cblx0ICogQHJldHVybiB7RnVuY3Rpb24/fVxuXHQgKi9cblx0Y2FuY2VsOiBmdW5jdGlvbihpZCkge1xuXHRcdHZhciBmbjtcblx0XHRpZiAodGhpcy5fcnVubmluZykge1xuXHRcdFx0Zm4gPSB0aGlzLl9jdXJyUXVldWUuc2tpcChpZCkgfHwgdGhpcy5fbmV4dFF1ZXVlLnNraXAoaWQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRmbiA9IHRoaXMuX25leHRRdWV1ZS5za2lwKGlkKTtcblx0XHRcdGlmICgodGhpcy5fcnVuSWQgIT09IC0xKSAmJiAodGhpcy5fbmV4dFF1ZXVlLm51bUl0ZW1zID09PSAwKSkge1xuXHRcdFx0XHR0aGlzLl9jYW5jZWxGbi5jYWxsKG51bGwsIHRoaXMuX3J1bklkKTtcblx0XHRcdFx0Ly8gdGhpcy5fY2FuY2VsRm4odGhpcy5fcnVuSWQpO1xuXHRcdFx0XHR0aGlzLl9ydW5JZCA9IC0xO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZm47XG5cdH0sXG59LCB7XG5cdHJ1bm5pbmc6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX3J1bm5pbmc7XG5cdFx0fVxuXHR9XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYWxsYmFja1F1ZXVlOyIsIi8qIGdsb2JhbCBQYXRoMkQgKi9cbi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvQ2FudmFzVmlld1xuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6Y29sb3J9ICovXG4vLyB2YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG52YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9JbnRlcnBvbGF0b3J9ICovXG52YXIgSW50ZXJwb2xhdG9yID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvSW50ZXJwb2xhdG9yXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXN9ICovXG52YXIgZ2V0Qm94RWRnZVN0eWxlcyA9IHJlcXVpcmUoXCJ1dGlscy9jc3MvZ2V0Qm94RWRnZVN0eWxlc1wiKTtcblxudmFyIE1JTl9DQU5WQVNfUkFUSU8gPSAxOyAvLyAvRmlyZWZveC8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk/IDIgOiAxO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvQ2FudmFzVmlld31cbiAqL1xudmFyIENhbnZhc1ZpZXcgPSBWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJjYW52YXNWaWV3XCIsXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHR0YWdOYW1lOiBcImNhbnZhc1wiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2xhc3NOYW1lOiBcImNhbnZhcy12aWV3XCIsXG5cblx0cHJvcGVydGllczoge1xuXHRcdGNvbnRleHQ6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9jdHg7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRpbnRlcnBvbGF0b3I6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9pbnRlcnBvbGF0b3I7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRjYW52YXNSYXRpbzoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2NhbnZhc1JhdGlvO1xuXHRcdFx0fVxuXHRcdH0sXG5cdH0sXG5cblx0LyoqIEB0eXBlIHtPYmplY3R9ICovXG5cdGRlZmF1bHRzOiB7XG5cdFx0dmFsdWVzOiB7XG5cdFx0XHR2YWx1ZTogMFxuXHRcdH0sXG5cdFx0bWF4VmFsdWVzOiB7XG5cdFx0XHR2YWx1ZTogMVxuXHRcdH0sXG5cdFx0dXNlT3BhcXVlOiB0cnVlLFxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGNoaWxkcmVuL2xheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHQvLyBUT0RPOiBjbGVhbnVwIHRoaXMgb3B0aW9ucyBtZXNzXG5cdFx0b3B0aW9ucyA9IF8uZGVmYXVsdHMob3B0aW9ucywgdGhpcy5kZWZhdWx0cyk7XG5cdFx0b3B0aW9ucy52YWx1ZXMgPSBfLmRlZmF1bHRzKG9wdGlvbnMudmFsdWVzLCB0aGlzLmRlZmF1bHRzLnZhbHVlcyk7XG5cdFx0b3B0aW9ucy5tYXhWYWx1ZXMgPSBfLmRlZmF1bHRzKG9wdGlvbnMubWF4VmFsdWVzLCB0aGlzLmRlZmF1bHRzLm1heFZhbHVlcyk7XG5cblx0XHR0aGlzLl9pbnRlcnBvbGF0b3IgPSBuZXcgSW50ZXJwb2xhdG9yKG9wdGlvbnMudmFsdWVzLCBvcHRpb25zLm1heFZhbHVlcyk7XG5cdFx0dGhpcy5fdXNlT3BhcXVlID0gb3B0aW9ucy51c2VPcGFxdWU7XG5cdFx0dGhpcy5fb3B0aW9ucyA9IF8ucGljayhvcHRpb25zLCBcImNvbG9yXCIsIFwiYmFja2dyb3VuZENvbG9yXCIpO1xuXG5cdFx0Ly8gb3BhcXVlIGJhY2tncm91bmRcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHZhciBjdHhPcHRzID0ge307XG5cdFx0Ly8gaWYgKHRoaXMuX3VzZU9wYXF1ZSkge1xuXHRcdC8vIFx0dGhpcy5fb3BhcXVlUHJvcCA9IE1vZGVybml6ci5wcmVmaXhlZChcIm9wYXF1ZVwiLCB0aGlzLmVsLCBmYWxzZSk7XG5cdFx0Ly8gXHRpZiAodGhpcy5fb3BhcXVlUHJvcCkge1xuXHRcdC8vIFx0XHR0aGlzLmVsW3RoaXMuX29wYXF1ZVByb3BdID0gdHJ1ZTtcblx0XHQvLyBcdH0gZWxzZSB7XG5cdFx0Ly8gXHRcdGN0eE9wdHMuYWxwaGEgPSB0cnVlO1xuXHRcdC8vIFx0fVxuXHRcdC8vIFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwiY29sb3ItYmdcIik7XG5cdFx0Ly8gfVxuXG5cdFx0Ly8gY2FudmFzJyBjb250ZXh0IGluaXRcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuX2N0eCA9IHRoaXMuZWwuZ2V0Q29udGV4dChcIjJkXCIsIGN0eE9wdHMpO1xuXG5cdFx0Ly8gYWRqdXN0IGNhbnZhcyBzaXplIHRvIHBpeGVsIHJhdGlvXG5cdFx0Ly8gdXBzY2FsZSB0aGUgY2FudmFzIGlmIHRoZSB0d28gcmF0aW9zIGRvbid0IG1hdGNoXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR2YXIgcmF0aW8gPSBNSU5fQ0FOVkFTX1JBVElPO1xuXHRcdHZhciBjdHhSYXRpbyA9IHRoaXMuX2N0eC53ZWJraXRCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IDE7XG5cdFx0aWYgKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvICE9PSBjdHhSYXRpbykge1xuXHRcdFx0Ly8gcmF0aW8gPSBNYXRoLm1heCh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyAvIGN0eFJhdGlvLCBNSU5fQ0FOVkFTX1JBVElPKTtcblx0XHRcdHJhdGlvID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gLyBjdHhSYXRpbztcblx0XHRcdHJhdGlvID0gTWF0aC5tYXgocmF0aW8sIE1JTl9DQU5WQVNfUkFUSU8pO1xuXHRcdH1cblx0XHR0aGlzLl9jYW52YXNSYXRpbyA9IHJhdGlvO1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OmluaXQgY2FudmFzUmF0aW86ICVmXCIsIHRoaXMuY2lkLCB0aGlzLl9jYW52YXNSYXRpbyk7XG5cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwidmlldzphdHRhY2hlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdC8vIHRoaXMuaW52YWxpZGF0ZVNpemUoKTtcblx0XHRcdC8vIHRoaXMucmVuZGVyTm93KCk7XG5cdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3LkxBWU9VVF9JTlZBTElEKS5yZW5kZXJOb3coKTtcblx0XHR9KTtcblx0fSxcblxuXHQvLyBfY29tcHV0ZUNhbnZhc1JhdGlvOiBmdW5jdGlvbigpIHtcblx0Ly8gXHR2YXIgcmF0aW8gPSBNSU5fQ0FOVkFTX1JBVElPO1xuXHQvLyBcdHZhciBjdHhSYXRpbyA9IHRoaXMuX2N0eC53ZWJraXRCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IDE7XG5cdC8vIFx0aWYgKHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvICE9PSBjdHhSYXRpbykge1xuXHQvLyBcdFx0Ly8gcmF0aW8gPSBNYXRoLm1heCh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyAvIGN0eFJhdGlvLCBNSU5fQ0FOVkFTX1JBVElPKTtcblx0Ly8gXHRcdHJhdGlvID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gLyBjdHhSYXRpbztcblx0Ly8gXHRcdHJhdGlvID0gTWF0aC5tYXgocmF0aW8sIE1JTl9DQU5WQVNfUkFUSU8pO1xuXHQvLyBcdH1cblx0Ly8gXHR0aGlzLl9jYW52YXNSYXRpbyA9IHJhdGlvO1xuXHQvLyB9LFxuXG5cdF91cGRhdGVDYW52YXM6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGFkanVzdCBjYW52YXMgc2l6ZSB0byBwaXhlbCByYXRpb1xuXHRcdC8vIHVwc2NhbGUgdGhlIGNhbnZhcyBpZiB0aGUgdHdvIHJhdGlvcyBkb24ndCBtYXRjaFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0XHR2YXIgcyA9IGdldENvbXB1dGVkU3R5bGUodGhpcy5lbCk7XG5cblx0XHQvLyB0aGlzLl9jYW52YXNXaWR0aCA9IHRoaXMuZWwub2Zmc2V0V2lkdGg7XG5cdFx0Ly8gdGhpcy5fY2FudmFzSGVpZ2h0ID0gdGhpcy5lbC5vZmZzZXRIZWlnaHQ7XG5cdFx0dGhpcy5fY2FudmFzV2lkdGggPSB0aGlzLmVsLnNjcm9sbFdpZHRoO1xuXHRcdHRoaXMuX2NhbnZhc0hlaWdodCA9IHRoaXMuZWwuc2Nyb2xsSGVpZ2h0O1xuXG5cdFx0aWYgKHMuYm94U2l6aW5nID09PSBcImJvcmRlci1ib3hcIikge1xuXHRcdFx0dmFyIG0gPSBnZXRCb3hFZGdlU3R5bGVzKHMpO1xuXHRcdFx0dGhpcy5fY2FudmFzV2lkdGggLT0gbS5wYWRkaW5nTGVmdCArIG0ucGFkZGluZ1JpZ2h0ICsgbS5ib3JkZXJMZWZ0V2lkdGggKyBtLmJvcmRlclJpZ2h0V2lkdGg7XG5cdFx0XHR0aGlzLl9jYW52YXNIZWlnaHQgLT0gbS5wYWRkaW5nVG9wICsgbS5wYWRkaW5nQm90dG9tICsgbS5ib3JkZXJUb3BXaWR0aCArIG0uYm9yZGVyQm90dG9tV2lkdGg7XG5cdFx0fVxuXG5cdFx0dGhpcy5fY2FudmFzV2lkdGggKj0gdGhpcy5fY2FudmFzUmF0aW87XG5cdFx0dGhpcy5fY2FudmFzSGVpZ2h0ICo9IHRoaXMuX2NhbnZhc1JhdGlvO1xuXG5cdFx0dGhpcy5tZWFzdXJlQ2FudmFzKHRoaXMuX2NhbnZhc1dpZHRoLCB0aGlzLl9jYW52YXNIZWlnaHQsIHMpO1xuXHRcdHRoaXMuZWwud2lkdGggPSB0aGlzLl9jYW52YXNXaWR0aDtcblx0XHR0aGlzLmVsLmhlaWdodCA9IHRoaXMuX2NhbnZhc0hlaWdodDtcblx0XHQvLyB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IGggKyBcInB4XCI7XG5cdFx0Ly8gdGhpcy5lbC5zdHlsZS53aWR0aCA9IHcgKyBcInB4XCI7XG5cblx0XHQvLyBjb2xvcnNcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuX2NvbG9yID0gdGhpcy5fb3B0aW9ucy5jb2xvciB8fFxuXHRcdFx0cy5jb2xvciB8fCBHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wiY29sb3JcIl07XG5cdFx0dGhpcy5fYmFja2dyb3VuZENvbG9yID0gdGhpcy5fb3B0aW9ucy5iYWNrZ3JvdW5kQ29sb3IgfHxcblx0XHRcdHMuYmFja2dyb3VuZENvbG9yIHx8IEdsb2JhbHMuREVGQVVMVF9DT0xPUlNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdO1xuXG5cdFx0Ly8gbW96T3BhcXVlXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRpZiAodGhpcy5fdXNlT3BhcXVlICYmIHRoaXMuX29wYXF1ZVByb3ApIHtcblx0XHRcdC8vIHRoaXMuZWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5fYmFja2dyb3VuZENvbG9yO1xuXHRcdFx0dGhpcy5lbFt0aGlzLl9vcGFxdWVQcm9wXSA9IHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gZm9udFNpemVcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuX2ZvbnRTaXplID0gcGFyc2VGbG9hdChzLmZvbnRTaXplKSAqIHRoaXMuX2NhbnZhc1JhdGlvO1xuXHRcdHRoaXMuX2ZvbnRGYW1pbHkgPSBzLmZvbnRGYW1pbHk7XG5cblx0XHQvLyBwcmVwYXJlIGNhbnZhcyBjb250ZXh0XG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXG5cdFx0dGhpcy5fY3R4LmZvbnQgPSBbcy5mb250V2VpZ2h0LCBzLmZvbnRTdHlsZSwgdGhpcy5fZm9udFNpemUgKyBcInB4LzFcIiwgcy5mb250RmFtaWx5XS5qb2luKFwiIFwiKTtcblx0XHR0aGlzLl9jdHgudGV4dEFsaWduID0gXCJsZWZ0XCI7XG5cdFx0dGhpcy5fY3R4LmxpbmVDYXAgPSBcImJ1dHRcIjtcblx0XHR0aGlzLl9jdHgubGluZUpvaW4gPSBcIm1pdGVyXCI7XG5cdFx0dGhpcy5fY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5fY29sb3I7XG5cdFx0dGhpcy5fY3R4LmZpbGxTdHlsZSA9IHRoaXMuX2NvbG9yO1xuXG5cdFx0dGhpcy51cGRhdGVDYW52YXModGhpcy5fY3R4KTtcblx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXG5cdFx0Ly8gY29uc29sZS5ncm91cCh0aGlzLmNpZCtcIjo6X3VwZGF0ZUNhbnZhc1wiKTtcblx0XHQvLyBjb25zb2xlLmxvZyhcInJhdGlvOiAgICAlZiAobWluOiAlZiwgZGV2aWNlOiAlZiwgY29udGV4dDogJXMpXCIsIHRoaXMuX2NhbnZhc1JhdGlvLCBNSU5fQ0FOVkFTX1JBVElPLCB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbywgdGhpcy5fY3R4LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwgXCIod2Via2l0LW9ubHkpXCIpO1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiY29sb3JzOiAgIGZnOiAlcyBiZzogJXNcIiwgdGhpcy5fY29sb3IsIHRoaXMuX2JhY2tncm91bmRDb2xvcik7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJzdHlsZTogICAgJXMsICVzLCBwYWRkaW5nOiAlcyAoJXMpXCIsIHMud2lkdGgsIHMuaGVpZ2h0LCBzLnBhZGRpbmcsIHMuYm94U2l6aW5nKTtcblx0XHQvLyBjb25zb2xlLmxvZyhcImJveDogICAgICAlZiB4ICVmIHB4XCIsIG0ud2lkdGgsIG0uaGVpZ2h0KTtcblx0XHQvLyBjb25zb2xlLmxvZyhcIm1lYXN1cmVkOiAlZiB4ICVmIHB4XCIsIHcsIGgpO1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiY2FudmFzOiAgICVmIHggJWYgcHhcIiwgdGhpcy5fY2FudmFzV2lkdGgsIHRoaXMuX2NhbnZhc0hlaWdodCk7XG5cdFx0Ly8gY29uc29sZS5ncm91cEVuZCgpO1xuXHR9LFxuXG5cdHVwZGF0ZUNhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0LyogYWJzdHJhY3QgKi9cblx0fSxcblxuXHRtZWFzdXJlQ2FudmFzOiBmdW5jdGlvbigpIHtcblx0XHQvKiBhYnN0cmFjdCAqL1xuXHR9LFxuXG5cdF9nZXRGb250TWV0cmljczogZnVuY3Rpb24oc3RyKSB7XG5cdFx0dmFyIGtleSwgaWR4LCBtT2JqLCBtSWR4ID0gc3RyLmxlbmd0aDtcblx0XHRmb3IgKGtleSBpbiBHbG9iYWxzLkZPTlRfTUVUUklDUykge1xuXHRcdFx0aWR4ID0gc3RyLmluZGV4T2Yoa2V5KTtcblx0XHRcdGlmIChpZHggIT09IC0xICYmIGlkeCA8IG1JZHgpIHtcblx0XHRcdFx0bUlkeCA9IGlkeDtcblx0XHRcdFx0bU9iaiA9IEdsb2JhbHMuRk9OVF9NRVRSSUNTW2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBtT2JqO1xuXHR9LFxuXG5cdF9jbGVhckNhbnZhczogZnVuY3Rpb24oeCwgeSwgdywgaCkge1xuXHRcdHRoaXMuX2N0eC5jbGVhclJlY3QoeCwgeSwgdywgaCk7XG5cdFx0aWYgKHRoaXMuX3VzZU9wYXF1ZSkge1xuXHRcdFx0dGhpcy5fY3R4LnNhdmUoKTtcblx0XHRcdHRoaXMuX2N0eC5maWxsU3R5bGUgPSB0aGlzLl9iYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHR0aGlzLl9jdHguZmlsbFJlY3QoeCwgeSwgdywgaCk7XG5cdFx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHRcdH1cblx0fSxcblxuXHRfc2V0U3R5bGU6IGZ1bmN0aW9uKHMpIHtcblx0XHRDYW52YXNWaWV3LnNldFN0eWxlKHRoaXMuX2N0eCwgcyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcmVuZGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5hdHRhY2hlZCkge1xuXHRcdFx0cmV0dXJuIHRoaXMucmVuZGVyTm93KCk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyRnJhbWU6IGZ1bmN0aW9uKHRzdGFtcCwgZmxhZ3MpIHtcblx0XHRpZiAoIXRoaXMuYXR0YWNoZWQpIHtcblx0XHRcdHJldHVybiBmbGFncztcblx0XHR9XG5cdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHtcblx0XHRcdHRoaXMuX3VwZGF0ZUNhbnZhcygpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5faW50ZXJwb2xhdG9yLnZhbHVlc0NoYW5nZWQpIHtcblx0XHRcdGZsYWdzIHw9IFZpZXcuTEFZT1VUX0lOVkFMSUQ7XG5cdFx0XHR0aGlzLl9pbnRlcnBvbGF0b3IuaW50ZXJwb2xhdGUodHN0YW1wKTtcblx0XHR9XG5cdFx0aWYgKGZsYWdzICYgKFZpZXcuTEFZT1VUX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRCkpIHtcblx0XHRcdHRoaXMucmVkcmF3KHRoaXMuX2N0eCwgdGhpcy5faW50ZXJwb2xhdG9yLCBmbGFncyk7XG5cdFx0XHRpZiAodGhpcy5faW50ZXJwb2xhdG9yLnZhbHVlc0NoYW5nZWQpIHtcblx0XHRcdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHB1YmxpY1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRnZXRWYWx1ZTogZnVuY3Rpb24oa2V5KSB7XG5cdFx0cmV0dXJuIHRoaXMuX2ludGVycG9sYXRvci5nZXRWYWx1ZShrZXkpO1xuXHR9LFxuXG5cdGdldFJlbmRlcmVkVmFsdWU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdHJldHVybiB0aGlzLl9pbnRlcnBvbGF0b3IuZ2V0UmVuZGVyZWRWYWx1ZShrZXkpO1xuXHR9LFxuXG5cdHZhbHVlVG86IGZ1bmN0aW9uKHZhbHVlLCBkdXJhdGlvbiwga2V5KSB7XG5cdFx0dGhpcy5faW50ZXJwb2xhdG9yLnZhbHVlVG8odmFsdWUsIGR1cmF0aW9uLCBrZXkpO1xuXHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3Lk1PREVMX0lOVkFMSUQgfCBWaWV3LkxBWU9VVF9JTlZBTElEKTtcblx0fSxcblxuXHQvLyB1cGRhdGVWYWx1ZTogZnVuY3Rpb24oa2V5KSB7XG5cdC8vIFx0cmV0dXJuIHRoaXMuX2ludGVycG9sYXRvci51cGRhdGVWYWx1ZShrZXkgfHwgdGhpcy5kZWZhdWx0S2V5KTtcblx0Ly8gfSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiByZWRyYXdcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cmVkcmF3OiBmdW5jdGlvbihjb250ZXh0LCBjaGFuZ2VkKSB7fSxcblxufSwge1xuXHRzZXRTdHlsZTogZnVuY3Rpb24oY3R4LCBzKSB7XG5cdFx0aWYgKHR5cGVvZiBzICE9IFwib2JqZWN0XCIpIHJldHVybjtcblx0XHRmb3IgKHZhciBwIGluIHMpIHtcblx0XHRcdHN3aXRjaCAodHlwZW9mIGN0eFtwXSkge1xuXHRcdFx0XHRjYXNlIFwidW5kZWZpbmVkXCI6XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJmdW5jdGlvblwiOlxuXHRcdFx0XHRcdGlmIChBcnJheS5pc0FycmF5KHNbcF0pKSBjdHhbcF0uYXBwbHkoY3R4LCBzW3BdKTtcblx0XHRcdFx0XHRlbHNlIGN0eFtwXS5jYWxsKGN0eCwgc1twXSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0Y3R4W3BdID0gc1twXTtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn0pO1xuXG5pZiAoREVCVUcpIHtcblx0Q2FudmFzVmlldy5wcm90b3R5cGUuX2xvZ0ZsYWdzID0gXCJcIjtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBDYW52YXNWaWV3OyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9iYXNlL0ludGVycG9sYXRvclxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG4vLyB2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvZWFzZS9saW5lYXJ9ICovXG52YXIgbGluZWFyID0gcmVxdWlyZShcInV0aWxzL2Vhc2UvbGluZWFyXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL0ludGVycG9sYXRvcn1cbiAqL1xudmFyIEludGVycG9sYXRvciA9IGZ1bmN0aW9uKHZhbHVlcywgbWF4VmFsdWVzKSB7XG5cdHRoaXMuX3ZhbHVlRGF0YSA9IHt9O1xuXHR0aGlzLl9tYXhWYWx1ZXMgPSB7fTtcblx0dGhpcy5fcmVuZGVyYWJsZUtleXMgPSBbXTtcblxuXHR2YXIga2V5LCB2YWwsIG1heFZhbDtcblx0Zm9yIChrZXkgaW4gdmFsdWVzKSB7XG5cdFx0dmFsID0gdmFsdWVzW2tleV07XG5cdFx0bWF4VmFsID0gbWF4VmFsdWVzW2tleV0gfHwgbnVsbDtcblx0XHQvLyBjcmVhdGUgdmFsdWUgb2JqZWN0IGFuZCBzdG9yZSBpdFxuXHRcdHRoaXMuX3ZhbHVlRGF0YVtrZXldID0gdGhpcy5faW5pdFZhbHVlKHZhbCwgMCwgbWF4VmFsKTtcblx0XHQvLyBhZGQgbWF4VmFsdWUgdG8gc3RvcmVcblx0XHR0aGlzLl9tYXhWYWx1ZXNba2V5XSA9IG1heFZhbDtcblx0XHQvLyBhZGQgdG8gbmV4dCByZW5kZXIgbGlzdFxuXHRcdHRoaXMuX3JlbmRlcmFibGVLZXlzLnB1c2goa2V5KTtcblx0fVxuXHR0aGlzLl92YWx1ZXNDaGFuZ2VkID0gdGhpcy5fcmVuZGVyYWJsZUtleXMubGVuZ3RoID4gMDtcbn07XG5cbkludGVycG9sYXRvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHtcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBwdWJsaWMgaW50ZXJmYWNlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGlzQXRUYXJnZXQ6IGZ1bmN0aW9uKGtleSkge1xuXHRcdHJldHVybiB0aGlzLl9yZW5kZXJhYmxlS2V5cy5pbmRleE9mKGtleSkgPT09IC0xO1xuXHR9LFxuXG5cdGdldFZhbHVlOiBmdW5jdGlvbihrZXkpIHtcblx0XHRyZXR1cm4gdGhpcy5fdmFsdWVEYXRhW2tleV0uX3ZhbHVlO1xuXHR9LFxuXG5cdGdldFJlbmRlcmVkVmFsdWU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdHJldHVybiB0aGlzLl92YWx1ZURhdGFba2V5XS5fcmVuZGVyZWRWYWx1ZTtcblx0fSxcblxuXHR2YWx1ZVRvOiBmdW5jdGlvbih2YWx1ZSwgZHVyYXRpb24sIGtleSkge1xuXHRcdHZhciBjaGFuZ2VkLCBkYXRhT2JqID0gdGhpcy5fdmFsdWVEYXRhW2tleV07XG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6dmFsdWVUbyBbJXNdXCIsIFwiW2ludGVycG9sYXRvcl1cIiwga2V5LCB2YWx1ZSk7XG5cdFx0aWYgKEFycmF5LmlzQXJyYXkoZGF0YU9iaikpIHtcblx0XHRcdGNoYW5nZWQgPSB2YWx1ZS5yZWR1Y2UoZnVuY3Rpb24ocHJldkNoYW5nZWQsIGl0ZW1WYWx1ZSwgaSkge1xuXHRcdFx0XHRpZiAoZGF0YU9ialtpXSkge1xuXHRcdFx0XHRcdGRhdGFPYmpbaV0gPSB0aGlzLl9pbml0TnVtYmVyKGl0ZW1WYWx1ZSwgZHVyYXRpb24sIHRoaXMuX21heFZhbHVlc1trZXldKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fc2V0VmFsdWUoaXRlbVZhbHVlLCBkdXJhdGlvbiwgZGF0YU9ialtpXSkgfHwgcHJldkNoYW5nZWQ7XG5cdFx0XHRcdH1cblx0XHRcdH0uYmluZCh0aGlzKSwgY2hhbmdlZCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNoYW5nZWQgPSB0aGlzLl9zZXRWYWx1ZSh2YWx1ZSwgZHVyYXRpb24sIGRhdGFPYmopO1xuXHRcdH1cblx0XHRpZiAoY2hhbmdlZCkge1xuXHRcdFx0dGhpcy5fcmVuZGVyYWJsZUtleXMuaW5kZXhPZihrZXkpICE9PSAtMSB8fCB0aGlzLl9yZW5kZXJhYmxlS2V5cy5wdXNoKGtleSk7XG5cdFx0XHR0aGlzLl92YWx1ZXNDaGFuZ2VkID0gdHJ1ZTtcblx0XHRcdC8vIHRoaXMucmVuZGVyKCk7XG5cdFx0XHQvLyB0aGlzLnJlcXVlc3RSZW5kZXIoKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0dXBkYXRlVmFsdWU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdC8vIENhbGwgX2ludGVycG9sYXRlVmFsdWUgb25seSBpZiBuZWVkZWQuIF9pbnRlcnBvbGF0ZVZhbHVlKCkgcmV0dXJucyBmYWxzZVxuXHRcdC8vIG9uY2UgaW50ZXJwb2xhdGlvbiBpcyBkb25lLCBpbiB3aGljaCBjYXNlIHJlbW92ZSBrZXkgZnJvbSBfcmVuZGVyYWJsZUtleXMuXG5cdFx0dmFyIGtJbmRleCA9IHRoaXMuX3JlbmRlcmFibGVLZXlzLmluZGV4T2Yoa2V5KTtcblx0XHRpZiAoa0luZGV4ICE9PSAtMSAmJiAhdGhpcy5faW50ZXJwb2xhdGVWYWx1ZShrZXkpKSB7XG5cdFx0XHR0aGlzLl9yZW5kZXJhYmxlS2V5cy5zcGxpY2Uoa0luZGV4LCAxKTtcblx0XHRcdHRoaXMuX3ZhbHVlc0NoYW5nZWQgPSB0aGlzLl9yZW5kZXJhYmxlS2V5cy5sZW5ndGggPiAwO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBwcml2YXRlOiB2YWx1ZURhdGFcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2luaXRWYWx1ZTogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBtYXhWYWwpIHtcblx0XHRpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcblx0XHRcdHJldHVybiB2YWx1ZS5tYXAoZnVuY3Rpb24odmFsKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9pbml0TnVtYmVyKHZhbCwgMCwgbWF4VmFsKTtcblx0XHRcdH0sIHRoaXMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5faW5pdE51bWJlcih2YWx1ZSwgMCwgbWF4VmFsKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gX2luaXRBcnJheTogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBtYXhWYWwpIHtcblx0Ly8gXHRyZXR1cm4gdmFsLm1hcChmdW5jdGlvbih2YWwpIHtcblx0Ly8gXHRcdHJldHVybiB0aGlzLl9pbml0TnVtYmVyKHZhbCwgMCwgbWF4VmFsKTtcblx0Ly8gXHR9LCB0aGlzKTtcblx0Ly8gfSxcblxuXHRfaW5pdE51bWJlcjogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBtYXhWYWwpIHtcblx0XHR2YXIgbyA9IHt9O1xuXHRcdG8uX3ZhbHVlID0gdmFsdWU7XG5cdFx0by5fc3RhcnRWYWx1ZSA9IHZhbHVlO1xuXHRcdG8uX3ZhbHVlRGVsdGEgPSAwO1xuXG5cdFx0by5fZHVyYXRpb24gPSBkdXJhdGlvbiB8fCAwO1xuXHRcdG8uX3N0YXJ0VGltZSA9IC0xO1xuXHRcdG8uX2VsYXBzZWRUaW1lID0gMDtcblxuXHRcdG8uX2xhc3RSZW5kZXJlZFZhbHVlID0gby5fcmVuZGVyZWRWYWx1ZSA9IG51bGw7XG5cblx0XHRvLl9tYXhWYWwgPSBtYXhWYWw7XG5cdFx0Ly8gaWYgKG1heFZhbCAhPT0gdm9pZCAwKSBvLl9tYXhWYWwgPSBtYXhWYWw7XG5cdFx0Ly8gby5fbWF4VmFsID0gdGhpcy5fbWF4VmFsdWVzW2tleV07XG5cdFx0Ly8gby5fbWF4VmFsID0gdGhpcy5fbWF4VmFsOy8vIEZJWE1FXG5cdFx0cmV0dXJuIG87XG5cdH0sXG5cblx0X3NldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgZHVyYXRpb24sIG8pIHtcblx0XHRpZiAoby5fdmFsdWUgIT0gdmFsdWUpIHtcblx0XHRcdG8uX3N0YXJ0VmFsdWUgPSBvLl92YWx1ZTtcblx0XHRcdG8uX3ZhbHVlRGVsdGEgPSB2YWx1ZSAtIG8uX3ZhbHVlO1xuXHRcdFx0by5fdmFsdWUgPSB2YWx1ZTtcblxuXHRcdFx0by5fZHVyYXRpb24gPSBkdXJhdGlvbiB8fCAwO1xuXHRcdFx0by5fc3RhcnRUaW1lID0gLTE7XG5cdFx0XHRvLl9lbGFwc2VkVGltZSA9IDA7XG5cblx0XHRcdG8uX2xhc3RSZW5kZXJlZFZhbHVlID0gby5fcmVuZGVyZWRWYWx1ZTtcblxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBwcml2YXRlOiBpbnRlcnBvbGF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGludGVycG9sYXRlOiBmdW5jdGlvbih0c3RhbXApIHtcblx0XHRpZiAodGhpcy5fdmFsdWVzQ2hhbmdlZCkge1xuXHRcdFx0dGhpcy5fdmFsdWVzQ2hhbmdlZCA9IGZhbHNlO1xuXG5cdFx0XHR2YXIgY2hhbmdlZEtleXMgPSB0aGlzLl9yZW5kZXJhYmxlS2V5cztcblx0XHRcdHRoaXMuX3RzdGFtcCA9IHRzdGFtcDtcblx0XHRcdHRoaXMuX3JlbmRlcmFibGVLZXlzID0gY2hhbmdlZEtleXMuZmlsdGVyKHRoaXMuX2ludGVycG9sYXRlVmFsdWUsIHRoaXMpO1xuXHRcdFx0dGhpcy5fcmVuZGVyZWRLZXlzID0gY2hhbmdlZEtleXM7XG5cblx0XHRcdGlmICh0aGlzLl9yZW5kZXJhYmxlS2V5cy5sZW5ndGggIT09IDApIHtcblx0XHRcdFx0dGhpcy5fdmFsdWVzQ2hhbmdlZCA9IHRydWU7XG5cdFx0XHRcdC8vIFx0Ly8gdGhpcy5yZXF1ZXN0UmVuZGVyKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OmludGVycG9sYXRlIHZhbHVlc0NoYW5nZWQ6JXMgdHN0YW1wOiVmXCIsIFwiW2ludGVycG9sYXRvcl1cIiwgdGhpcy5fdmFsdWVzQ2hhbmdlZCwgdHN0YW1wKTtcblx0XHQvLyByZXR1cm4gdGhpcy5fdmFsdWVzQ2hhbmdlZDtcblx0XHQvLyByZXR1cm4gdGhpcy52YWx1ZXNDaGFuZ2VkO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X2ludGVycG9sYXRlVmFsdWU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdHZhciBkYXRhT2JqID0gdGhpcy5fdmFsdWVEYXRhW2tleV07XG5cdFx0aWYgKEFycmF5LmlzQXJyYXkoZGF0YU9iaikpIHtcblx0XHRcdHJldHVybiBkYXRhT2JqLnJlZHVjZShmdW5jdGlvbihjb250aW51ZU5leHQsIG8sIGluZGV4LCBhcnIpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2ludGVycG9sYXRlTnVtYmVyKHRoaXMuX3RzdGFtcCwgbykgfHwgY29udGludWVOZXh0O1xuXHRcdFx0fS5iaW5kKHRoaXMpLCBmYWxzZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB0aGlzLl9pbnRlcnBvbGF0ZU51bWJlcih0aGlzLl90c3RhbXAsIGRhdGFPYmopO1xuXHRcdH1cblx0fSxcblxuXHRfaW50ZXJwb2xhdGVOdW1iZXI6IGZ1bmN0aW9uKHRzdGFtcCwgbykge1xuXHRcdGlmIChvLl9zdGFydFRpbWUgPCAwKSB7XG5cdFx0XHRvLl9zdGFydFRpbWUgPSB0c3RhbXA7XG5cdFx0fVxuXHRcdHZhciBlbGFwc2VkID0gdHN0YW1wIC0gby5fc3RhcnRUaW1lO1xuXHRcdG8uX2VsYXBzZWRUaW1lID0gZWxhcHNlZDtcblx0XHRvLl9sYXN0UmVuZGVyZWRWYWx1ZSA9IG8uX3JlbmRlcmVkVmFsdWU7XG5cdFx0aWYgKGVsYXBzZWQgPCBvLl9kdXJhdGlvbikge1xuXHRcdFx0aWYgKG8uX21heFZhbCAmJiBvLl92YWx1ZURlbHRhIDwgMCkge1xuXHRcdFx0XHQvLyB1cHBlci1ib3VuZCB2YWx1ZXNcblx0XHRcdFx0by5fcmVuZGVyZWRWYWx1ZSA9IGxpbmVhcihlbGFwc2VkLCBvLl9zdGFydFZhbHVlLFxuXHRcdFx0XHRcdG8uX3ZhbHVlRGVsdGEgKyBvLl9tYXhWYWwsIG8uX2R1cmF0aW9uKSAtIG8uX21heFZhbDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIHVuYm91bmQgdmFsdWVzXG5cdFx0XHRcdG8uX3JlbmRlcmVkVmFsdWUgPSBsaW5lYXIoZWxhcHNlZCwgby5fc3RhcnRWYWx1ZSxcblx0XHRcdFx0XHRvLl92YWx1ZURlbHRhLCBvLl9kdXJhdGlvbik7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0by5fcmVuZGVyZWRWYWx1ZSA9IG8uX3ZhbHVlO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fSxcbn0sIHtcblx0dmFsdWVzQ2hhbmdlZDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fdmFsdWVzQ2hhbmdlZDtcblx0XHR9XG5cdH0sXG5cdHJlbmRlcmFibGVLZXlzOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9yZW5kZXJhYmxlS2V5cztcblx0XHR9XG5cdH0sXG5cdHJlbmRlcmVkS2V5czoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fcmVuZGVyZWRLZXlzO1xuXHRcdH1cblx0fSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEludGVycG9sYXRvcjsiLCIvKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZEV2ZW50fSAqL1xudmFyIHByZWZpeGVkRXZlbnQgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRFdmVudFwiKTtcblxudmFyIGV2ZW50TWFwID0ge1xuXHRcInRyYW5zaXRpb25lbmRcIjogcHJlZml4ZWRFdmVudChcInRyYW5zaXRpb25lbmRcIiksXG5cdFwiZnVsbHNjcmVlbmNoYW5nZVwiOiBwcmVmaXhlZEV2ZW50KFwiZnVsbHNjcmVlbmNoYW5nZVwiLCBkb2N1bWVudCksXG5cdFwiZnVsbHNjcmVlbmVycm9yXCI6IHByZWZpeGVkRXZlbnQoXCJmdWxsc2NyZWVuZXJyb3JcIiwgZG9jdW1lbnQpLFxuXHRcInZpc2liaWxpdHljaGFuZ2VcIjogcHJlZml4ZWRFdmVudChcInZpc2liaWxpdHljaGFuZ2VcIiwgZG9jdW1lbnQsIFwiaGlkZGVuXCIpXG59O1xuXG52YXIgZXZlbnROdW0gPSAwO1xuZm9yICh2YXIgZXZlbnROYW1lIGluIGV2ZW50TWFwKSB7XG5cdGlmIChldmVudE5hbWUgPT09IGV2ZW50TWFwW2V2ZW50TmFtZV0pIHtcblx0XHRkZWxldGUgZXZlbnRNYXBbZXZlbnROYW1lXTtcblx0fSBlbHNlIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnRNYXAsIGV2ZW50TmFtZSwge1xuXHRcdFx0dmFsdWU6IGV2ZW50TWFwW2V2ZW50TmFtZV0sXG5cdFx0XHRlbnVtZXJhYmxlOiB0cnVlXG5cdFx0fSk7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV2ZW50TWFwLCBldmVudE51bSwge1xuXHRcdFx0dmFsdWU6IGV2ZW50TmFtZSxcblx0XHRcdGVudW1lcmFibGU6IGZhbHNlXG5cdFx0fSk7XG5cdFx0ZXZlbnROdW0rKztcblx0fVxufVxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV2ZW50TWFwLCBcImxlbmd0aFwiLCB7XG5cdHZhbHVlOiBldmVudE51bVxufSk7XG5cbmlmIChERUJVRykge1xuXHRjb25zb2xlLmxvZyhcInByZWZpeGVzIGVuYWJsZWQgZm9yICVpIGV2ZW50c1wiLCBldmVudE1hcC5sZW5ndGgsIE9iamVjdC5rZXlzKGV2ZW50TWFwKSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZXZlbnRNYXA7XG5cbi8vIG1vZHVsZS5leHBvcnRzID0gZXZlbnROdW0gPiAwPyBldmVudE1hcCA6IG51bGw7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXJcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzfSAqL1xudmFyIEhhbW1lciA9IHJlcXVpcmUoXCJoYW1tZXJqc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG52YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTpoYW1tZXJqcy5UYXB9ICovXG52YXIgVGFwID0gSGFtbWVyLlRhcDtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3RvdWNoL1Ntb290aFBhblJlY29nbml6ZXJ9ICovXG52YXIgUGFuID0gcmVxdWlyZShcInV0aWxzL3RvdWNoL1Ntb290aFBhblJlY29nbml6ZXJcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpoYW1tZXJqcy5QYW59ICovXG4vLyB2YXIgUGFuID0gSGFtbWVyLlBhbjtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogU3RhdGljIHByaXZhdGVcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqXG4gKiBAcGFyYW0gZWwgSFRNTEVsZW1lbnRcbiAqIEByZXR1cm4ge0hhbW1lci5NYW5hZ2VyfVxuICovXG5mdW5jdGlvbiBjcmVhdGVJbnN0YW5jZShlbCkge1xuXHR2YXIgbWFuYWdlciwgaHBhbiwgdnBhbiwgdGFwO1xuXHRocGFuID0gbmV3IFBhbih7XG5cdFx0Ly8gdGhyZXNob2xkOiBHbG9iYWxzLlBBTl9USFJFU0hPTEQsXG5cdFx0Ly8gdG91Y2hBY3Rpb246IFwicGFuLXlcIixcblx0XHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fSE9SSVpPTlRBTCxcblx0XHRldmVudDogXCJocGFuXCIsXG5cdH0pO1xuXHR2cGFuID0gbmV3IFBhbih7XG5cdFx0Ly8gdGhyZXNob2xkOiBHbG9iYWxzLlBBTl9USFJFU0hPTEQsXG5cdFx0Ly8gdG91Y2hBY3Rpb246IFwicGFuLXhcIixcblx0XHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwsXG5cdFx0ZXZlbnQ6IFwidnBhblwiLFxuXHR9KTtcblx0dGFwID0gbmV3IFRhcCh7XG5cdFx0Ly8gdGhyZXNob2xkOiBHbG9iYWxzLlBBTl9USFJFU0hPTEQgLSAxXG5cdH0pO1xuXHRtYW5hZ2VyID0gbmV3IEhhbW1lci5NYW5hZ2VyKGVsKTtcblx0Ly8gbWFuYWdlci5zZXQoeyBkb21ldmVudHM6IHRydWUgfSk7XG5cdG1hbmFnZXIuYWRkKFt0YXAsIGhwYW4sIHZwYW5dKTtcblx0Ly8gbWFuYWdlci5hZGQoW2hwYW4sIHZwYW5dKTtcblx0dnBhbi5yZXF1aXJlRmFpbHVyZShocGFuKTtcblx0Ly8gbWFuYWdlci5hZGQoaHBhbik7XG5cdHJldHVybiBtYW5hZ2VyO1xufVxuXG4vLyBmdW5jdGlvbiBjcmVhdGVJbnN0YW5jZShlbCkge1xuLy8gXHRyZXR1cm4gbmV3IEhhbW1lcihlbCwge1xuLy8gXHRcdHJlY29nbml6ZXJzOiBbXG4vLyBcdFx0XHRbVGFwXSxcbi8vIFx0XHRcdFtQYW4sIHtcbi8vIFx0XHRcdFx0ZXZlbnQ6ICdocGFuJyxcbi8vIFx0XHRcdFx0ZGlyZWN0aW9uOiBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUwsXG4vLyBcdFx0XHRcdHRocmVzaG9sZDogR2xvYmFscy5USFJFU0hPTERcbi8vIFx0XHRcdH1dLFxuLy8gXHRcdFx0W1Bhbiwge1xuLy8gXHRcdFx0XHRldmVudDogJ3ZwYW4nLFxuLy8gXHRcdFx0XHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwsXG4vLyBcdFx0XHRcdHRocmVzaG9sZDogR2xvYmFscy5USFJFU0hPTERcbi8vIFx0XHRcdH0sIFsnaHBhbiddXVxuLy8gXHRcdF1cbi8vIFx0fSk7XG4vLyB9XG5cbi8vIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbmNlKGVsKSB7XG4vLyBcdHZhciByZWNvZ25pemVycyA9IFtdO1xuLy8gXHR2YXIgbWFuYWdlciA9IG5ldyBIYW1tZXIuTWFuYWdlcihlbCk7XG4vL1xuLy8gXHR2YXIgaHBhbiA9IG5ldyBQYW4oe1xuLy8gXHRcdGV2ZW50OiBcImhwYW5cIixcbi8vIFx0XHR0aHJlc2hvbGQ6IEdsb2JhbHMuVEhSRVNIT0xELFxuLy8gXHRcdGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9IT1JJWk9OVEFMXG4vLyBcdH0pO1xuLy9cbi8vIFx0dmFyIHZwYW4gPSBuZXcgUGFuKHtcbi8vIFx0XHRldmVudDogXCJ2cGFuXCIsXG4vLyBcdFx0dGhyZXNob2xkOiBHbG9iYWxzLlRIUkVTSE9MRCxcbi8vIFx0XHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUxcbi8vIFx0fSk7XG4vL1xuLy8gXHR2YXIgdGFwID0gbmV3IEhhbW1lci5UYXAoKTtcbi8vIFx0Ly8gdmFyIHRhcCA9IG5ldyBIYW1tZXIuVGFwKHtcbi8vIFx0Ly8gXHR0aHJlc2hvbGQ6IEdsb2JhbHMuVEhSRVNIT0xEIC0gMSxcbi8vIFx0Ly8gXHRpbnRlcnZhbDogNTAsXG4vLyBcdC8vIFx0dGltZTogMjAwXG4vLyBcdC8vIH0pO1xuLy8gXHRyZWNvZ25pemVycy5wdXNoKHZwYW4pO1xuLy8gXHRyZWNvZ25pemVycy5wdXNoKGhwYW4pO1xuLy8gXHRyZWNvZ25pemVycy5wdXNoKHRhcCk7XG4vLyBcdG1hbmFnZXIuYWRkKHJlY29nbml6ZXJzKTtcbi8vXG4vLyBcdGhwYW4ucmVjb2duaXplV2l0aChbdnBhbl0pO1xuLy8gXHRocGFuLnJlcXVpcmVGYWlsdXJlKFt2cGFuXSk7XG4vLyBcdHRhcC5yZWNvZ25pemVXaXRoKFt2cGFuLCBocGFuXSk7XG4vL1xuLy8gXHQvLyB0YXAucmVxdWlyZUZhaWx1cmUodnBhbik7XG4vL1xuLy8gXHQvLyBtYW5hZ2VyLnNldCh7IGRvbWV2ZW50czogdHJ1ZSB9KTtcbi8vIFx0cmV0dXJuIG1hbmFnZXI7XG4vLyB9XG5cbi8qaHR0cHM6Ly9naXN0LmdpdGh1YnVzZXJjb250ZW50LmNvbS9qdGFuZ2VsZGVyLzM2MTA1Mjk3NmYwNDQyMDBlYTE3L3Jhdy9mNTRjMmNlZjc4ZDU5ZGEzZjM4Mjg2ZmFkNjgzNDcxZTFjOTc2MDcyL1ByZXZlbnRHaG9zdENsaWNrLmpzKi9cblxuLy8gZnVuY3Rpb25cdGxvZ0V2ZW50KG1lc3NhZ2UpIHtcbi8vIFx0Y29uc29sZS5sb2cobWVzc2FnZSwgZG9tZXYudHlwZSxcbi8vIFx0XHRcInBhblNlc3Npb25PcGVuZWQ6IFwiICsgcGFuU2Vzc2lvbk9wZW5lZCxcbi8vIFx0XHRcImRlZmF1bHRQcmV2ZW50ZWQ6IFwiICsgZG9tZXYuZGVmYXVsdFByZXZlbnRlZFxuLy8gXHQpO1xuLy8gfVxuXG52YXIgbGFzdFRpbWVTdGFtcCA9IC0xO1xudmFyIHBhblNlc3Npb25PcGVuZWQgPSBmYWxzZTtcbnZhciB1cEV2ZW50TmFtZSA9IHdpbmRvdy5oYXNPd25Qcm9wZXJ0eShcIm9ucG9pbnRlcnVwXCIpID8gXCJwb2ludGVydXBcIiA6IFwibW91c2V1cFwiO1xuXG52YXIgdG91Y2hIYW5kbGVycyA9IHt9O1xudG91Y2hIYW5kbGVyc1tcInZwYW5zdGFydCB2cGFuZW5kIHZwYW5jYW5jZWwgaHBhbnN0YXJ0IGhwYW5lbmQgaHBhbmNhbmNlbFwiXSA9IGZ1bmN0aW9uKGhldikge1xuXHQvLyBjb25zb2xlLmxvZyhcIlRvdWNoTWFuYWdlcjpbJXNdXCIsIGhldi5zcmNFdmVudC50eXBlKTtcblx0cGFuU2Vzc2lvbk9wZW5lZCA9ICFoZXYuaXNGaW5hbDtcblx0aWYgKGhldi5pc0ZpbmFsKVxuXHRcdGxhc3RUaW1lU3RhbXAgPSBoZXYuc3JjRXZlbnQudGltZVN0YW1wO1xufTtcbi8vIHRvdWNoSGFuZGxlcnNbXCJoYW1tZXIuaW5wdXQgdGFwIHZwYW5tb3ZlIGhwYW5tb3ZlXCJdID0gZnVuY3Rpb24oaGV2KSB7XG4vLyBcdGNvbnNvbGUubG9nKFwiVG91Y2hNYW5hZ2VyOlslcyAtPiAlc11cIiwgaGV2LnNyY0V2ZW50LnR5cGUsIGhldi50eXBlKTtcbi8vIH07XG5cbnZhciBjYXB0dXJlSGFuZGxlcnMgPSB7fTtcbmNhcHR1cmVIYW5kbGVyc1tcImNsaWNrXCJdID0gZnVuY3Rpb24oZG9tZXYpIHtcblx0aWYgKGxhc3RUaW1lU3RhbXAgPT0gZG9tZXYudGltZVN0YW1wKSB7XG5cdFx0bGFzdFRpbWVTdGFtcCA9IC0xO1xuXHRcdGRvbWV2LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZG9tZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRkb21ldi5zdG9wUHJvcGFnYXRpb24oKTtcblx0fVxufTtcbmNhcHR1cmVIYW5kbGVyc1tcImRyYWdzdGFydFwiXSA9IGZ1bmN0aW9uKGRvbWV2KSB7XG5cdGlmIChkb21ldi50YXJnZXQubm9kZU5hbWUgPT0gXCJJTUdcIikge1xuXHRcdGRvbWV2LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZG9tZXYucHJldmVudERlZmF1bHQoKTtcblx0fVxufTtcbmNhcHR1cmVIYW5kbGVyc1t1cEV2ZW50TmFtZV0gPSBmdW5jdGlvbihkb21ldikge1xuXHRwYW5TZXNzaW9uT3BlbmVkICYmIGRvbWV2LnByZXZlbnREZWZhdWx0KCk7XG59O1xuXG52YXIgYnViYmxpbmdIYW5kbGVycyA9IHt9O1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vL1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5mdW5jdGlvbiBhZGRIYW5kbGVycygpIHtcblx0dmFyIGV2ZW50TmFtZSwgZWwgPSBpbnN0YW5jZS5lbGVtZW50O1xuXHRmb3IgKGV2ZW50TmFtZSBpbiB0b3VjaEhhbmRsZXJzKVxuXHRcdGlmICh0b3VjaEhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2ZW50TmFtZSkpXG5cdFx0XHRpbnN0YW5jZS5vbihldmVudE5hbWUsIHRvdWNoSGFuZGxlcnNbZXZlbnROYW1lXSk7XG5cdGZvciAoZXZlbnROYW1lIGluIGNhcHR1cmVIYW5kbGVycylcblx0XHRpZiAoY2FwdHVyZUhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2ZW50TmFtZSkpXG5cdFx0XHRlbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgY2FwdHVyZUhhbmRsZXJzW2V2ZW50TmFtZV0sIHRydWUpO1xuXHRmb3IgKGV2ZW50TmFtZSBpbiBidWJibGluZ0hhbmRsZXJzKVxuXHRcdGlmIChidWJibGluZ0hhbmRsZXJzLmhhc093blByb3BlcnR5KGV2ZW50TmFtZSkpXG5cdFx0XHRlbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgYnViYmxpbmdIYW5kbGVyc1tldmVudE5hbWVdLCBmYWxzZSk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUhhbmRsZXJzKCkge1xuXHR2YXIgZXZlbnROYW1lLCBlbCA9IGluc3RhbmNlLmVsZW1lbnQ7XG5cdGZvciAoZXZlbnROYW1lIGluIGNhcHR1cmVIYW5kbGVycylcblx0XHRpZiAoY2FwdHVyZUhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2ZW50TmFtZSkpXG5cdFx0XHRlbC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgY2FwdHVyZUhhbmRsZXJzW2V2ZW50TmFtZV0sIHRydWUpO1xuXHRmb3IgKGV2ZW50TmFtZSBpbiBidWJibGluZ0hhbmRsZXJzKVxuXHRcdGlmIChjYXB0dXJlSGFuZGxlcnMuaGFzT3duUHJvcGVydHkoZXZlbnROYW1lKSlcblx0XHRcdGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBidWJibGluZ0hhbmRsZXJzW2V2ZW50TmFtZV0sIHRydWUpO1xufVxuXG4vKiogQHR5cGUge0hhbW1lci5NYW5hZ2VyfSAqL1xudmFyIGluc3RhbmNlID0gbnVsbDtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogU3RhdGljIHB1YmxpY1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG52YXIgVG91Y2hNYW5hZ2VyID0ge1xuXHRpbml0OiBmdW5jdGlvbih0YXJnZXQpIHtcblx0XHRpZiAoaW5zdGFuY2UgPT09IG51bGwpIHtcblx0XHRcdGluc3RhbmNlID0gY3JlYXRlSW5zdGFuY2UodGFyZ2V0KTtcblx0XHRcdGFkZEhhbmRsZXJzKCk7XG5cdFx0fSBlbHNlIGlmIChpbnN0YW5jZS5lbGVtZW50ICE9PSB0YXJnZXQpIHtcblx0XHRcdGNvbnNvbGUud2FybihcIlRvdWNoTWFuYWdlciBhbHJlYWR5IGluaXRpYWxpemVkIHdpdGggYW5vdGhlciBlbGVtZW50XCIpO1xuXHRcdH1cblx0XHRyZXR1cm4gaW5zdGFuY2U7XG5cdH0sXG5cblx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKGluc3RhbmNlICE9PSBudWxsKSB7XG5cdFx0XHRyZW1vdmVIYW5kbGVycygpO1xuXHRcdFx0aW5zdGFuY2UuZGVzdHJveSgpO1xuXHRcdFx0aW5zdGFuY2UgPSBudWxsO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJubyBpbnN0YW5jZSB0byBkZXN0cm95XCIpO1xuXHRcdH1cblx0fSxcblxuXHRnZXRJbnN0YW5jZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKGluc3RhbmNlID09PSBudWxsKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiVG91Y2hNYW5hZ2VyIGhhcyBub3QgYmVlbiBpbml0aWFsaXplZFwiKTtcblx0XHR9XG5cdFx0cmV0dXJuIGluc3RhbmNlO1xuXHR9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRvdWNoTWFuYWdlcjsiLCIvKiBnbG9iYWwgSFRNTEVsZW1lbnQsIE11dGF0aW9uT2JzZXJ2ZXIgKi9cbi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9iYXNlL1ZpZXdcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBNdXRhdGlvbk9ic2VydmVyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbnZhciBfY2lkU2VlZCA9IDE7XG52YXIgX3ZpZXdzQnlDaWQgPSB7fTtcblxuZnVuY3Rpb24gYWRkQ2hpbGRWaWV3cyhlbCkge1xuXHR2YXIgdmlldywgZWxzID0gZWwucXVlcnlTZWxlY3RvckFsbChcIipbZGF0YS1jaWRdXCIpO1xuXHRmb3IgKHZhciBpID0gMCwgaWkgPSBlbHMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdHZpZXcgPSBWaWV3LmZpbmRCeUVsZW1lbnQoZWxzLml0ZW0oaSkpO1xuXHRcdGlmICh2aWV3KSB7XG5cdFx0XHRpZiAoIXZpZXcuYXR0YWNoZWQpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJWaWV3OjpbYXR0YWNoZWQgKHBhcmVudCldICVzXCIsIHZpZXcuY2lkKTtcblx0XHRcdFx0dmlldy5fZWxlbWVudEF0dGFjaGVkKCk7XG5cdFx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHRcdC8vIFx0Y29uc29sZS53YXJuKFwiVmlldzo6W2F0dGFjaGVkIChwYXJlbnQpXSAlcyAoaWdub3JlZClcIiwgdmlldy5jaWQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiByZW1vdmVDaGlsZFZpZXdzKGVsKSB7XG5cdHZhciB2aWV3LCBlbHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKFwiKltkYXRhLWNpZF1cIik7XG5cdGZvciAodmFyIGkgPSAwLCBpaSA9IGVscy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0dmlldyA9IFZpZXcuZmluZEJ5RWxlbWVudChlbHMuaXRlbShpKSk7XG5cdFx0aWYgKHZpZXcpIHtcblx0XHRcdGlmICh2aWV3LmF0dGFjaGVkKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiVmlldzo6W2RldGFjaGVkIChwYXJlbnQpXSAlc1wiLCB2aWV3LmNpZCk7XG5cdFx0XHRcdHZpZXcuX2VsZW1lbnREZXRhY2hlZCgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiVmlldzo6W2RldGFjaGVkIChwYXJlbnQpXSAlcyAoaWdub3JlZClcIiwgdmlldy5jaWQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG52YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihtbSkge1xuXHQvLyBjb25zb2xlLmxvZyhcIlZpZXc6Om11dGF0aW9ucyAlc1wiLCBKU09OLnN0cmluZ2lmeShtbSwgbnVsbCwgXCIgXCIpKTtcblx0dmFyIGksIGlpLCBtO1xuXHR2YXIgaiwgamosIGU7XG5cdHZhciB2aWV3O1xuXHRmb3IgKGkgPSAwLCBpaSA9IG1tLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRtID0gbW1baV07XG5cdFx0aWYgKG0udHlwZSA9PSBcImNoaWxkTGlzdFwiKSB7XG5cdFx0XHRmb3IgKGogPSAwLCBqaiA9IG0uYWRkZWROb2Rlcy5sZW5ndGg7IGogPCBqajsgaisrKSB7XG5cdFx0XHRcdGUgPSBtLmFkZGVkTm9kZXMuaXRlbShqKTtcblx0XHRcdFx0dmlldyA9IFZpZXcuZmluZEJ5RWxlbWVudChlKTtcblx0XHRcdFx0aWYgKHZpZXcpIHtcblx0XHRcdFx0XHRpZiAoIXZpZXcuYXR0YWNoZWQpIHtcblx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiVmlldzo6W2F0dGFjaGVkIChjaGlsZExpc3QpXSAlc1wiLCB2aWV3LmNpZCk7XG5cdFx0XHRcdFx0XHR2aWV3Ll9lbGVtZW50QXR0YWNoZWQoKTtcblx0XHRcdFx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBcdGNvbnNvbGUud2FybihcIlZpZXc6OlthdHRhY2hlZCAoY2hpbGRMaXN0KV0gJXMgKGlnbm9yZWQpXCIsIHZpZXcuY2lkKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgYWRkQ2hpbGRWaWV3cyhlKTtcblx0XHRcdH1cblx0XHRcdGZvciAoaiA9IDAsIGpqID0gbS5yZW1vdmVkTm9kZXMubGVuZ3RoOyBqIDwgamo7IGorKykge1xuXHRcdFx0XHRlID0gbS5yZW1vdmVkTm9kZXMuaXRlbShqKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJWaWV3OjpbZGV0YWNoZWQgKGNoaWxkTGlzdCldICVzXCIsIGUuY2lkKTtcblx0XHRcdFx0dmlldyA9IFZpZXcuZmluZEJ5RWxlbWVudChlKTtcblx0XHRcdFx0aWYgKHZpZXcpIHtcblx0XHRcdFx0XHRpZiAodmlldy5hdHRhY2hlZCkge1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coXCJWaWV3OjpbZGV0YWNoZWQgKGNoaWxkTGlzdCldICVzXCIsIHZpZXcuY2lkLCB2aWV3LmF0dGFjaGVkKTtcblx0XHRcdFx0XHRcdHZpZXcuX2VsZW1lbnREZXRhY2hlZCgpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJWaWV3OjpbZGV0YWNoZWQgKGNoaWxkTGlzdCldICVzIChpZ25vcmVkKVwiLCB2aWV3LmNpZCwgdmlldy5hdHRhY2hlZCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHJlbW92ZUNoaWxkVmlld3MoZSk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChtLnR5cGUgPT0gXCJhdHRyaWJ1dGVzXCIpIHtcblx0XHRcdHZpZXcgPSBWaWV3LmZpbmRCeUVsZW1lbnQobS50YXJnZXQpO1xuXHRcdFx0aWYgKHZpZXcpIHtcblx0XHRcdFx0aWYgKCF2aWV3LmF0dGFjaGVkKSB7XG5cdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJWaWV3OjpbYXR0YWNoZWQgKGF0dHJpYnV0ZSldICVzXCIsIHZpZXcuY2lkKTtcblx0XHRcdFx0XHR2aWV3Ll9lbGVtZW50QXR0YWNoZWQoKTtcblx0XHRcdFx0XHQvLyB9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIFx0Y29uc29sZS53YXJuKFwiVmlldzo6W2F0dGFjaGVkIChhdHRyaWJ1dGUpXSAlcyAoaWdub3JlZClcIiwgdmlldy5jaWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHQvLyBlbHNlIHtcblx0XHRcdC8vIFx0Y29uc29sZS53YXJuKFwiVmlldzo6W2F0dHJpYnV0ZXNdIHRhcmdldCBoYXMgbm8gY2lkICglcz0nJXMnKVwiLCBtLmF0dHJpYnV0ZU5hbWUsIG0udGFyZ2V0LmdldEF0dHJpYnV0ZShtLmF0dHJpYnV0ZU5hbWUpLCBtKTtcblx0XHRcdC8vIH1cblx0XHR9XG5cdH1cbn0pO1xuXG5vYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcblx0YXR0cmlidXRlczogdHJ1ZSxcblx0Y2hpbGRMaXN0OiB0cnVlLFxuXHRzdWJ0cmVlOiB0cnVlLFxuXHRhdHRyaWJ1dGVGaWx0ZXI6IFtcImRhdGEtY2lkXCJdXG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogc3RhdGljIHByaXZhdGVcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxudmFyIF9ub3cgPSB3aW5kb3cucGVyZm9ybWFuY2UgP1xuXHR3aW5kb3cucGVyZm9ybWFuY2Uubm93LmJpbmQod2luZG93LnBlcmZvcm1hbmNlKSA6XG5cdERhdGUubm93LmJpbmQoRGF0ZSk7XG4vLyB2YXIgX25vdyA9IHdpbmRvdy5wZXJmb3JtYW5jZT9cbi8vIFx0ZnVuY3Rpb24oKSB7IHJldHVybiB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCk7IH06XG4vLyBcdGZ1bmN0aW9uKCkgeyByZXR1cm4gRGF0ZS5ub3coKTsgfTtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9yZW5kZXJRdWV1ZX0gKi9cbi8vIHZhciByZW5kZXJRdWV1ZSA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL3JlbmRlclF1ZXVlXCIpO1xuLy9cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvQ2FsbGJhY2tRdWV1ZX0gKi9cbnZhciByZW5kZXJRdWV1ZSA9IChmdW5jdGlvbihDYWxsYmFja1F1ZXVlKSB7XG5cdHJldHVybiBuZXcgQ2FsbGJhY2tRdWV1ZShcblx0XHRmdW5jdGlvbihjYWxsYmFjaykge1xuXHRcdFx0cmV0dXJuIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoY2FsbGJhY2spO1xuXHRcdH0sXG5cdFx0ZnVuY3Rpb24oaWQpIHtcblx0XHRcdHJldHVybiB3aW5kb3cuY2FuY2VsQW5pbWF0aW9uRnJhbWUoaWQpO1xuXHRcdH1cblx0KTtcbn0pKHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL0NhbGxiYWNrUXVldWVcIikpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL0NhbGxiYWNrUXVldWV9ICovXG52YXIgbW9kZWxRdWV1ZSA9IChmdW5jdGlvbihDYWxsYmFja1F1ZXVlKSB7XG5cdHJldHVybiBuZXcgQ2FsbGJhY2tRdWV1ZShcblx0XHRmdW5jdGlvbihjYWxsYmFjaykge1xuXHRcdFx0cmV0dXJuIHdpbmRvdy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGNhbGxiYWNrLmNhbGwobnVsbCwgX25vdygpKTtcblx0XHRcdH0pO1xuXHRcdH0sXG5cdFx0ZnVuY3Rpb24oaWQpIHtcblx0XHRcdHJldHVybiB3aW5kb3cuY2xlYXJJbW1lZGlhdGUoaWQpO1xuXHRcdH1cblx0KTtcbn0pKHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL0NhbGxiYWNrUXVldWVcIikpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ByZWZpeGVkRXZlbnRzfSAqL1xudmFyIFByZWZpeGVkRXZlbnRzID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvUHJlZml4ZWRFdmVudHNcIik7XG5cbnZhciBhcHBseUV2ZW50UHJlZml4ZXMgPSBmdW5jdGlvbihldmVudHMpIHtcblx0dmFyIHNlbGVjdG9yLCB1bnByZWZpeGVkO1xuXHRmb3IgKHNlbGVjdG9yIGluIGV2ZW50cykge1xuXHRcdHVucHJlZml4ZWQgPSBzZWxlY3Rvci5tYXRjaCgvXlxcdysvaSlbMF07XG5cdFx0aWYgKFByZWZpeGVkRXZlbnRzLmhhc093blByb3BlcnR5KHVucHJlZml4ZWQpKSB7XG5cdFx0XHRldmVudHNbc2VsZWN0b3IucmVwbGFjZSh1bnByZWZpeGVkLCBQcmVmaXhlZEV2ZW50c1t1bnByZWZpeGVkXSldID0gZXZlbnRzW3NlbGVjdG9yXTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiYXBwbHlFdmVudFByZWZpeGVzXCIsIHVucHJlZml4ZWQsIHByZWZpeGVkRXZlbnRzW3VucHJlZml4ZWRdKTtcblx0XHRcdGRlbGV0ZSBldmVudHNbc2VsZWN0b3JdO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gZXZlbnRzO1xufTtcblxudmFyIGdldFZpZXdEZXB0aCA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0aWYgKCF2aWV3KSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblx0aWYgKCF2aWV3LmF0dGFjaGVkKSB7XG5cdFx0cmV0dXJuIE5hTjtcblx0fVxuXHRpZiAodmlldy5wYXJlbnRWaWV3ID09PSBudWxsKSB7XG5cdFx0cmV0dXJuIDA7XG5cdH1cblx0cmV0dXJuIHZpZXcucGFyZW50Vmlldy52aWV3RGVwdGggKyAxO1xufTtcblxuZnVuY3Rpb24gbG9nQXR0YWNoSW5mbyh2aWV3LCBuYW1lLCBsZXZlbCkge1xuXHRpZiAoW1wibG9nXCIsIFwiaW5mb1wiLCBcIndhcm5cIiwgXCJlcnJvclwiXS5pbmRleE9mKGxldmVsKSAhPSAtMSkge1xuXHRcdGxldmVsID0gXCJsb2dcIjtcblx0fVxuXHRjb25zb2xlW2xldmVsXS5jYWxsKGNvbnNvbGUsIFwiJXM6OiVzIFtwYXJlbnQ6JXMgJXMgJXMgZGVwdGg6JXNdXCIsIHZpZXcuY2lkLCBuYW1lLCB2aWV3LnBhcmVudFZpZXcgJiYgdmlldy5wYXJlbnRWaWV3LmNpZCwgdmlldy5hdHRhY2hlZCA/IFwiYXR0YWNoZWRcIiA6IFwiZGV0YWNoZWRcIiwgdmlldy5fdmlld1BoYXNlLCB2aWV3LnZpZXdEZXB0aCk7XG59XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIHN0YXRpYyBwdWJsaWNcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXG52YXIgVmlldyA9IHtcblxuXHQvKiogQGNvbnN0ICovXG5cdE5PTkVfSU5WQUxJRDogMCxcblx0LyoqIEBjb25zdCAqL1xuXHRDSElMRFJFTl9JTlZBTElEOiAxLFxuXG5cdC8qKiBAY29uc3QgKi9cblx0TU9ERUxfSU5WQUxJRDogMixcblx0LyoqIEBjb25zdCAqL1xuXHRTVFlMRVNfSU5WQUxJRDogNCxcblx0LyoqIEBjb25zdCAqL1xuXHRTSVpFX0lOVkFMSUQ6IDgsXG5cdC8qKiBAY29uc3QgKi9cblx0TEFZT1VUX0lOVkFMSUQ6IDE2LFxuXG5cdC8qKiBAY29uc3QgKi9cblx0Ly8gUkVOREVSX0lOVkFMSUQ6IDggfCAxNixcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXdFcnJvcn0gKi9cblx0Vmlld0Vycm9yOiByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3RXJyb3JcIiksXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRQcm9wZXJ0eX0gKi9cblx0cHJlZml4ZWRQcm9wZXJ0eTogcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkUHJvcGVydHlcIiksXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRTdHlsZU5hbWV9ICovXG5cdHByZWZpeGVkU3R5bGVOYW1lOiByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRTdHlsZU5hbWVcIiksXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRFdmVudH0gKi9cblx0cHJlZml4ZWRFdmVudDogcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkRXZlbnRcIiksXG5cblx0Ly8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvc2V0SW1tZWRpYXRlfSAqL1xuXHQvLyBzZXRJbW1lZGlhdGU6IHJlcXVpcmUoXCJ1dGlscy9zZXRJbW1lZGlhdGVcIiksXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS93aGVuVmlld0lzQXR0YWNoZWR9ICovXG5cdHdoZW5WaWV3SXNBdHRhY2hlZDogcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblZpZXdJc0F0dGFjaGVkXCIpLFxuXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS93aGVuVmlld0lzUmVuZGVyZWR9ICovXG5cdHdoZW5WaWV3SXNSZW5kZXJlZDogcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblZpZXdJc1JlbmRlcmVkXCIpLFxuXG5cdC8qKlxuXHQvKiBAcGFyYW0gZWwge0hUTUxFbGVtZW50fVxuXHQvKiBAcmV0dXJuIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fVxuXHQvKi9cblx0ZmluZEJ5RWxlbWVudDogZnVuY3Rpb24oZWwpIHtcblx0XHRpZiAoX3ZpZXdzQnlDaWRbZWwuY2lkXSkge1xuXHRcdFx0cmV0dXJuIF92aWV3c0J5Q2lkW2VsLmNpZF07XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXG5cdC8qKlxuXHQvKiBAcGFyYW0gZWwge0hUTUxFbGVtZW50fVxuXHQvKiBAcmV0dXJuIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fVxuXHQvKi9cblx0ZmluZEJ5RGVzY2VuZGFudDogZnVuY3Rpb24oZWwpIHtcblx0XHRkbyB7XG5cdFx0XHRpZiAoX3ZpZXdzQnlDaWRbZWwuY2lkXSkge1xuXHRcdFx0XHRyZXR1cm4gX3ZpZXdzQnlDaWRbZWwuY2lkXTtcblx0XHRcdH1cblx0XHR9IHdoaWxlICgoZWwgPSBlbC5wYXJlbnRFbGVtZW50IHx8IGVsLnBhcmVudE5vZGUpKTtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGV4dGVuZDogZnVuY3Rpb24ocHJvdG8sIG9iaikge1xuXHRcdGlmIChQcmVmaXhlZEV2ZW50cy5sZW5ndGggJiYgcHJvdG8uZXZlbnRzKSB7XG5cdFx0XHRpZiAoXy5pc0Z1bmN0aW9uKHByb3RvLmV2ZW50cykpIHtcblx0XHRcdFx0cHJvdG8uZXZlbnRzID0gXy53cmFwKHByb3RvLmV2ZW50cywgZnVuY3Rpb24oZm4pIHtcblx0XHRcdFx0XHRyZXR1cm4gYXBwbHlFdmVudFByZWZpeGVzKGZuLmFwcGx5KHRoaXMpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Vcblx0XHRcdGlmIChfLmlzT2JqZWN0KHByb3RvLmV2ZW50cykpIHtcblx0XHRcdFx0cHJvdG8uZXZlbnRzID0gYXBwbHlFdmVudFByZWZpeGVzKHByb3RvLmV2ZW50cyk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChwcm90by5wcm9wZXJ0aWVzICYmIHRoaXMucHJvdG90eXBlLnByb3BlcnRpZXMpIHtcblx0XHRcdF8uZGVmYXVsdHMocHJvdG8ucHJvcGVydGllcywgdGhpcy5wcm90b3R5cGUucHJvcGVydGllcyk7XG5cdFx0fVxuXHRcdHJldHVybiBCYWNrYm9uZS5WaWV3LmV4dGVuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdF9mbGFnc1RvU3RyaW5nczogW1wiLVwiXSxcblxuXHRmbGFnc1RvU3RyaW5nOiBmdW5jdGlvbihmbGFncykge1xuXHRcdHZhciBzID0gVmlldy5fZmxhZ3NUb1N0cmluZ3NbZmxhZ3MgfCAwXTtcblx0XHRpZiAoIXMpIHtcblx0XHRcdHMgPSBbXTtcblx0XHRcdGlmIChmbGFncyAmIFZpZXcuQ0hJTERSRU5fSU5WQUxJRCkgcy5wdXNoKFwiY2hpbGRyZW5cIik7XG5cdFx0XHRpZiAoZmxhZ3MgJiBWaWV3Lk1PREVMX0lOVkFMSUQpIHMucHVzaChcIm1vZGVsXCIpO1xuXHRcdFx0aWYgKGZsYWdzICYgVmlldy5TVFlMRVNfSU5WQUxJRCkgcy5wdXNoKFwic3R5bGVzXCIpO1xuXHRcdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHMucHVzaChcInNpemVcIik7XG5cdFx0XHRpZiAoZmxhZ3MgJiBWaWV3LkxBWU9VVF9JTlZBTElEKSBzLnB1c2goXCJsYXlvdXRcIik7XG5cdFx0XHRWaWV3Ll9mbGFnc1RvU3RyaW5nc1tmbGFnc10gPSBzID0gcy5qb2luKFwiIFwiKTtcblx0XHR9XG5cdFx0cmV0dXJuIHM7XG5cdFx0Ly8gcmV0dXJuIChmbGFncyB8IDApLnRvU3RyaW5nKDIpO1xuXHR9LFxufTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXcsIFwiaW5zdGFuY2VzXCIsIHtcblx0dmFsdWU6IF92aWV3c0J5Q2lkLFxuXHRlbnVtZXJhYmxlOiB0cnVlXG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogcHJvdG90eXBlXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIG1vZHVsZS5leHBvcnRzID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xudmFyIFZpZXdQcm90byA9IHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcInZpZXdcIixcblx0LyoqIEB0eXBlIHtCb29sZWFufSAqL1xuXHRfYXR0YWNoZWQ6IGZhbHNlLFxuXHQvKiogQHR5cGUge0hUTUxFbGVtZW50fG51bGx9ICovXG5cdF9wYXJlbnRWaWV3OiBudWxsLFxuXHQvKiogQHR5cGUge2ludHxudWxsfSAqL1xuXHRfdmlld0RlcHRoOiBudWxsLFxuXHQvKiogQHR5cGUge3N0cmluZ30gaW5pdGlhbGl6aW5nID4gaW5pdGlhbGl6ZWQgPiBkaXNwb3NpbmcgPiBkaXNwb3NlZCAqL1xuXHRfdmlld1BoYXNlOiBcImluaXRpYWxpemluZ1wiLFxuXHQvKiogQHR5cGUge2ludH0gKi9cblx0X3JlbmRlclF1ZXVlSWQ6IC0xLFxuXHQvKiogQHR5cGUge2ludH0gKi9cblx0X3JlbmRlckZsYWdzOiAwLFxuXHQvKiogQHR5cGUge0Jvb2xlYW59ICovXG5cdF9lbmFibGVkOiBudWxsLFxuXG5cdC8qKiBAdHlwZSB7b2JqZWN0fSAqL1xuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0Y2lkOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY2lkIHx8ICh0aGlzLl9jaWQgPSB0aGlzLmNpZFByZWZpeCArIF9jaWRTZWVkKyspO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0YXR0YWNoZWQ6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9hdHRhY2hlZDtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHBhcmVudFZpZXc6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9wYXJlbnRWaWV3O1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0dmlld0RlcHRoOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZ2V0Vmlld0RlcHRoKCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRpbnZhbGlkYXRlZDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3JlbmRlclF1ZXVlSWQgIT09IC0xO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0ZW5hYmxlZDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2VuYWJsZWQ7XG5cdFx0XHR9LFxuXHRcdFx0c2V0OiBmdW5jdGlvbihlbmFibGVkKSB7XG5cdFx0XHRcdHRoaXMuc2V0RW5hYmxlZChlbmFibGVkKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHJlbmRlckZsYWdzOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fcmVuZGVyRmxhZ3M7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qKlxuXHQgKiBAY29uc3RydWN0b3Jcblx0ICogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9XG5cdCAqL1xuXHRjb25zdHJ1Y3RvcjogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHRoaXMudHJhbnNmb3JtID0ge307XG5cdFx0dGhpcy5jaGlsZFZpZXdzID0ge307XG5cdFx0dGhpcy5fYXBwbHlSZW5kZXIgPSB0aGlzLl9hcHBseVJlbmRlci5iaW5kKHRoaXMpO1xuXG5cdFx0aWYgKHRoaXMucHJvcGVydGllcykge1xuXHRcdFx0Ly8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywgZ2V0UHJvdG90eXBlQ2hhaW5WYWx1ZSh0aGlzLCBcInByb3BlcnRpZXNcIiwgQmFja2JvbmUuVmlldykpO1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywgdGhpcy5wcm9wZXJ0aWVzKTtcblx0XHR9XG5cdFx0aWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5jbGFzc05hbWUgJiYgdGhpcy5jbGFzc05hbWUpIHtcblx0XHRcdG9wdGlvbnMuY2xhc3NOYW1lICs9IFwiIFwiICsgXy5yZXN1bHQodGhpcywgXCJjbGFzc05hbWVcIik7XG5cdFx0fVxuXHRcdGlmIChvcHRpb25zICYmIG9wdGlvbnMucGFyZW50Vmlldykge1xuXHRcdFx0dGhpcy5fc2V0UGFyZW50VmlldyhvcHRpb25zLnBhcmVudFZpZXcsIHRydWUpO1xuXHRcdH1cblx0XHRCYWNrYm9uZS5WaWV3LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjppbml0aWFsaXplIHZpZXdQaGFzZTpbJXMgPT4gaW5pdGlhbGl6ZWRdXCIsIHRoaXMuY2lkLCB0aGlzLl92aWV3UGhhc2UpO1xuXHRcdHRoaXMuX3ZpZXdQaGFzZSA9IFwiaW5pdGlhbGl6ZWRcIjtcblxuXHRcdGlmICh0aGlzLnBhcmVudFZpZXcgIT09IG51bGwpIHtcblx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6cGFyZW50Q2hhbmdlXCIsIHRoaXMucGFyZW50VmlldywgbnVsbCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLmF0dGFjaGVkKSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OmF0dGFjaGVkXCIsIHRoaXMpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHJlbW92ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl92aWV3UGhhc2UgPT0gXCJkaXNwb3NpbmdcIikge1xuXHRcdFx0bG9nQXR0YWNoSW5mbyh0aGlzLCBcInJlbW92ZVwiLCBcIndhcm5cIik7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIGxvZ0F0dGFjaEluZm8odGhpcywgXCJyZW1vdmVcIiwgXCJsb2dcIik7XG5cdFx0fVxuXG5cdFx0Ly8gYmVmb3JlIHJlbW92YWxcblx0XHR0aGlzLl92aWV3UGhhc2UgPSBcImRpc3Bvc2luZ1wiO1xuXHRcdHRoaXMuX2NhbmNlbFJlbmRlcigpO1xuXG5cdFx0Ly8gY2FsbCBCYWNrYm9uZSBpbXBsXG5cdFx0Ly8gQmFja2JvbmUuVmlldy5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHQvLyBOT1RFOiBmcm9tIEJhY2tib25lIGltcGxcblx0XHR0aGlzLiRlbC5yZW1vdmUoKTsgLy8gZnJvbSBCYWNrYm9uZSBpbXBsXG5cblx0XHR0aGlzLl9hdHRhY2hlZCA9IGZhbHNlO1xuXHRcdHRoaXMudHJpZ2dlcihcInZpZXc6cmVtb3ZlZFwiLCB0aGlzKTtcblxuXHRcdC8vIHJlbW92ZSBwYXJlbnQvY2hpbGQgcmVmZXJlbmNlc1xuXHRcdHRoaXMuX3NldFBhcmVudFZpZXcobnVsbCk7XG5cblx0XHQvLyBOT1RFOiBmcm9tIEJhY2tib25lIGltcGwuIE5vIG1vcmUgZXZlbnRzIGFmdGVyIHRoaXNcblx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcoKTtcblxuXHRcdC8vIGNoZWNrIGZvciBpbnZhbGlkYXRpb25zIHRoYXQgbWF5IGhhdmUgYmVlbiB0cmlnZ2VyZWQgYnkgXCJ2aWV3OnJlbW92ZWRcIlxuXHRcdGlmICh0aGlzLmludmFsaWRhdGVkKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCIlczo6cmVtb3ZlIGludmFsaWRhdGVkIGFmdGVyIHJlbW92ZSgpXCIsIHRoaXMuY2lkKTtcblx0XHRcdHRoaXMuX2NhbmNlbFJlbmRlcigpO1xuXHRcdH1cblx0XHQvLyAvLyBjaGVjayBmb3IgY2hpbGRyZW4gc3RpbGwgaGVyZVxuXHRcdC8vIHZhciBjY2lkcyA9IE9iamVjdC5rZXlzKHRoaXMuY2hpbGRWaWV3cyk7XG5cdFx0Ly8gaWYgKGNjaWRzLmxlbmd0aCkge1xuXHRcdC8vIFx0Y29uc29sZS53YXJuKFwiJXM6OnJlbW92ZSAlaSBjaGlsZHJlbiBub3QgcmVtb3ZlZCBbJXNdXCIsIHRoaXMuY2lkLCBjY2lkcy5sZW5ndGgsIGNjaWRzLmpvaW4oXCIsIFwiKSwgdGhpcy5jaGlsZFZpZXdzKTtcblx0XHQvLyB9XG5cdFx0Ly8gLy8gcmVtb3ZlIGNoaWxkVmlld3Ncblx0XHQvLyBmb3IgKHZhciBjaWQgaW4gdGhpcy5jaGlsZFZpZXdzKSB7XG5cdFx0Ly8gXHR0aGlzLmNoaWxkVmlld3NbY2lkXS5yZW1vdmUoKTtcblx0XHQvLyB9XG5cdFx0Ly8gY2xlYXIgcmVmZXJlbmNlIGluIHZpZXcgbWFwXG5cdFx0ZGVsZXRlIF92aWV3c0J5Q2lkW3RoaXMuY2lkXTtcblx0XHQvLyBkZWxldGUgdGhpcy5lbC5jaWQ7XG5cdFx0Ly8gdXBkYXRlIHBoYXNlXG5cdFx0dGhpcy5fdmlld1BoYXNlID0gXCJkaXNwb3NlZFwiO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogX2VsZW1lbnRBdHRhY2hlZCBfZWxlbWVudERldGFjaGVkXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfZWxlbWVudEF0dGFjaGVkOiBmdW5jdGlvbigpIHtcblx0XHQvLyB0aGlzLl9hZGRUb1BhcmVudFZpZXcoKTtcblx0XHR0aGlzLl9hdHRhY2hlZCA9IHRydWU7XG5cdFx0dGhpcy5fdmlld0RlcHRoID0gbnVsbDtcblx0XHR0aGlzLl9zZXRQYXJlbnRWaWV3KFZpZXcuZmluZEJ5RGVzY2VuZGFudCh0aGlzLmVsLnBhcmVudEVsZW1lbnQpKTtcblxuXHRcdC8vIGlmICh0aGlzLnBhcmVudFZpZXcpIHtcblx0XHQvLyBcdGNvbnNvbGUubG9nKFwiW2F0dGFjaF0gWyVpXSAlcyA+ICVzOjpfZWxlbWVudEF0dGFjaGVkXCIsIHRoaXMudmlld0RlcHRoLCB0aGlzLnBhcmVudFZpZXcuY2lkLCB0aGlzLmNpZCk7XG5cdFx0Ly8gfSBlbHNlIHtcblx0XHQvLyBcdGNvbnNvbGUubG9nKFwiW2F0dGFjaF0gWyVpXSAlczo6X2VsZW1lbnRBdHRhY2hlZFwiLCB0aGlzLnZpZXdEZXB0aCwgdGhpcy5jaWQpO1xuXHRcdC8vIH1cblxuXHRcdC8vIGlmICh0aGlzLl92aWV3UGhhc2UgPT0gXCJpbml0aWFsaXppbmdcIikge1xuXHRcdC8vIFx0Ly8gdGhpcy50cmlnZ2VyKFwidmlldzphdHRhY2hlZFwiLCB0aGlzKTtcblx0XHQvLyB9IGVsc2Vcblx0XHRpZiAodGhpcy5fdmlld1BoYXNlID09IFwiaW5pdGlhbGl6ZWRcIikge1xuXHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzphdHRhY2hlZFwiLCB0aGlzKTtcblx0XHR9IGVsc2Vcblx0XHRpZiAodGhpcy5fdmlld1BoYXNlID09IFwicmVwbGFjaW5nXCIpIHtcblx0XHRcdHRoaXMuX3ZpZXdQaGFzZSA9IFwiaW5pdGlhbGl6ZWRcIjtcblx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6cmVwbGFjZWRcIiwgdGhpcyk7XG5cdFx0fVxuXHR9LFxuXG5cdF9lbGVtZW50RGV0YWNoZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICghdGhpcy5hdHRhY2hlZCB8fCAodGhpcy5fdmlld1BoYXNlID09IFwiZGlzcG9zaW5nXCIpIHx8ICh0aGlzLl92aWV3UGhhc2UgPT0gXCJkaXNwb3NlZFwiKSkge1xuXHRcdFx0bG9nQXR0YWNoSW5mbyh0aGlzLCBcIl9lbGVtZW50RGV0YWNoZWRcIiwgXCJlcnJvclwiKTtcblx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHQvLyBcdGxvZ0F0dGFjaEluZm8odGhpcywgXCJfZWxlbWVudERldGFjaGVkXCIsIFwibG9nXCIpO1xuXHRcdH1cblx0XHR0aGlzLl9hdHRhY2hlZCA9IGZhbHNlO1xuXHRcdHRoaXMuX3ZpZXdEZXB0aCA9IG51bGw7XG5cblx0XHRpZiAodGhpcy5fdmlld1BoYXNlICE9IFwiZGlzcG9zaW5nXCIgfHwgdGhpcy5fdmlld1BoYXNlID09IFwiZGlzcG9zZWRcIikge1xuXHRcdFx0dGhpcy5yZW1vdmUoKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBwYXJlbnRWaWV3XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfc2V0UGFyZW50VmlldzogZnVuY3Rpb24obmV3UGFyZW50LCBzaWxlbnQpIHtcblx0XHRpZiAobmV3UGFyZW50ID09PSB2b2lkIDApIHtcblx0XHRcdGNvbnNvbGUud2FybihcIiRzOjpfc2V0UGFyZW50VmlldyBpbnZhbGlkIHZhbHVlICclcydcIiwgdGhpcy5jaWQsIG5ld1BhcmVudCk7XG5cdFx0XHRuZXdQYXJlbnQgPSBudWxsO1xuXHRcdH1cblx0XHR2YXIgb2xkUGFyZW50ID0gdGhpcy5fcGFyZW50Vmlldztcblx0XHR0aGlzLl9wYXJlbnRWaWV3ID0gbmV3UGFyZW50O1xuXG5cdFx0Ly8gZm9yY2UgdXBkYXRlIG9mIF92aWV3RGVwdGhcblx0XHR0aGlzLl92aWV3RGVwdGggPSBudWxsOyAvL2dldFZpZXdEZXB0aCh0aGlzKTtcblxuXHRcdC8vIHNraXAgdGhlIHJlc3QgaWYgYXJnIGlzIHRoZSBzYW1lXG5cdFx0aWYgKG5ld1BhcmVudCA9PT0gb2xkUGFyZW50KSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGlmIChvbGRQYXJlbnQgIT09IG51bGwpIHtcblx0XHRcdGlmICh0aGlzLmNpZCBpbiBvbGRQYXJlbnQuY2hpbGRWaWV3cykge1xuXHRcdFx0XHRkZWxldGUgb2xkUGFyZW50LmNoaWxkVmlld3NbdGhpcy5jaWRdO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAobmV3UGFyZW50ICE9PSBudWxsKSB7XG5cdFx0XHRuZXdQYXJlbnQuY2hpbGRWaWV3c1t0aGlzLmNpZF0gPSB0aGlzO1xuXHRcdH1cblx0XHRpZiAoIXNpbGVudClcblx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6cGFyZW50Q2hhbmdlXCIsIHRoaXMsIG5ld1BhcmVudCwgb2xkUGFyZW50KTtcblx0fSxcblxuXHR3aGVuQXR0YWNoZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBWaWV3LndoZW5WaWV3SXNBdHRhY2hlZCh0aGlzKTtcblx0fSxcblxuXHRfZ2V0Vmlld0RlcHRoOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fdmlld0RlcHRoID09PSBudWxsKSB7XG5cdFx0XHR0aGlzLl92aWV3RGVwdGggPSBnZXRWaWV3RGVwdGgodGhpcyk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLl92aWV3RGVwdGg7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBCYWNrYm9uZS5WaWV3IG92ZXJyaWRlc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRzZXRFbGVtZW50OiBmdW5jdGlvbihlbGVtZW50LCBkZWxlZ2F0ZSkge1xuXHRcdC8vIHNldEVsZW1lbnQgYWx3YXlzIGluaXRpYWxpemVzIHRoaXMuZWwsIHNvIGNoZWNrIGl0IHRvIGJlIG5vbi1udWxsIGJlZm9yZSBjYWxsaW5nIHN1cGVyXG5cdFx0aWYgKHRoaXMuZWwpIHtcblx0XHRcdGlmICh0aGlzLmVsICE9PSBlbGVtZW50ICYmIHRoaXMuZWwucGFyZW50RWxlbWVudCkge1xuXHRcdFx0XHQvLyBFbGVtZW50IGlzIGJlaW5nIHJlcGxhY2VkXG5cdFx0XHRcdGlmICh0aGlzLmF0dGFjaGVkKSB7XG5cdFx0XHRcdFx0Ly8gU2luY2Ugb2xkIGVsZW1lbnQgaXMgYXR0YWNoZWQgdG8gZG9jdW1lbnQgdHJlZSwgX2VsZW1lbnRBdHRhY2hlZCB3aWxsIGJlXG5cdFx0XHRcdFx0Ly8gdHJpZ2dlcmVkIGJ5IHJlcGxhY2VDaGlsZDogc2V0IF92aWV3UGhhc2UgPSBcInJlcGxhY2luZ1wiIHRvIGZsYWcgdGhpc1xuXHRcdFx0XHRcdC8vIGNoYW5nZSBhbmQgdHJpZ2dlciAndmlldzpyZXBsYWNlZCcgaW5zdGVhZCBvZiAndmlldzphZGRlZCcuXG5cdFx0XHRcdFx0dGhpcy5fdmlld1BoYXNlID0gXCJyZXBsYWNpbmdcIjtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLmVsLnBhcmVudEVsZW1lbnQucmVwbGFjZUNoaWxkKGVsZW1lbnQsIHRoaXMuZWwpO1xuXHRcdFx0fVxuXHRcdFx0QmFja2JvbmUuVmlldy5wcm90b3R5cGUuc2V0RWxlbWVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0Ly8gTWVyZ2UgY2xhc3NlcyBzcGVjaWZpZWQgYnkgdGhpcyB2aWV3IHdpdGggdGhlIG9uZXMgYWxyZWFkeSBpbiB0aGUgZWxlbWVudCxcblx0XHRcdC8vIGFzIGJhY2tib25lIHdpbGwgbm90OlxuXHRcdFx0aWYgKHRoaXMuY2xhc3NOYW1lKSB7XG5cdFx0XHRcdF8ucmVzdWx0KHRoaXMsIFwiY2xhc3NOYW1lXCIpLnNwbGl0KFwiIFwiKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5hZGQoaXRlbSk7XG5cdFx0XHRcdH0sIHRoaXMpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRCYWNrYm9uZS5WaWV3LnByb3RvdHlwZS5zZXRFbGVtZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuZWwgPT09IHZvaWQgMCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiQmFja2JvbmUgdmlldyBoYXMgbm8gZWxlbWVudFwiKTtcblx0XHR9XG5cdFx0X3ZpZXdzQnlDaWRbdGhpcy5jaWRdID0gdGhpcztcblx0XHR0aGlzLmVsLmNpZCA9IHRoaXMuY2lkO1xuXHRcdHRoaXMuZWwuc2V0QXR0cmlidXRlKFwiZGF0YS1jaWRcIiwgdGhpcy5jaWQpO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiByZXF1ZXN0QW5pbWF0aW9uRnJhbWVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlcXVlc3RBbmltYXRpb25GcmFtZTogZnVuY3Rpb24oY2FsbGJhY2ssIHByaW9yaXR5LCBjdHgpIHtcblx0XHRyZXR1cm4gcmVuZGVyUXVldWUucmVxdWVzdChjYWxsYmFjay5iaW5kKGN0eCB8fCB0aGlzKSwgcHJpb3JpdHkpO1xuXHR9LFxuXG5cdGNhbmNlbEFuaW1hdGlvbkZyYW1lOiBmdW5jdGlvbihpZCkge1xuXHRcdHJldHVybiByZW5kZXJRdWV1ZS5jYW5jZWwoaWQpO1xuXHR9LFxuXG5cdHNldEltbWVkaWF0ZTogZnVuY3Rpb24oY2FsbGJhY2ssIHByaW9yaXR5LCBjdHgpIHtcblx0XHRyZXR1cm4gbW9kZWxRdWV1ZS5yZXF1ZXN0KGNhbGxiYWNrLmJpbmQoY3R4IHx8IHRoaXMpLCBwcmlvcml0eSk7XG5cdFx0Ly8gcmV0dXJuIHdpbmRvdy5zZXRJbW1lZGlhdGUoY2FsbGJhY2suYmluZChjdHggfHwgdGhpcykpO1xuXHR9LFxuXG5cdGNsZWFySW1tZWRpYXRlOiBmdW5jdGlvbihpZCkge1xuXHRcdHJldHVybiBtb2RlbFF1ZXVlLmNhbmNlbChpZCk7XG5cdFx0Ly8gcmV0dXJuIHdpbmRvdy5jbGVhckltbWVkaWF0ZShpZCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBkZWZlcnJlZCByZW5kZXI6IHByaXZhdGUgbWV0aG9kc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X3RyYWNlUmVuZGVyU3RhdHVzOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gW1xuXHRcdFx0KHRoaXMuX3JlbmRlclF1ZXVlSWQgIT0gLTEgPyBcImFzeW5jIGlkOlwiICsgdGhpcy5fcmVuZGVyUXVldWVJZCA6IFwic3luY1wiKSxcblx0XHRcdFZpZXcuZmxhZ3NUb1N0cmluZyh0aGlzLl9yZW5kZXJGbGFncyksXG5cdFx0XHQodGhpcy5hdHRhY2hlZCA/IFwiYXR0YWNoZWRcIiA6IFwiZGV0YWNoZWRcIiksXG5cdFx0XHQodGhpcy5za2lwVHJhbnNpdGlvbnMgPyBcInNraXBcIiA6IFwicnVuXCIpICsgXCItdHhcIlxuXHRcdF0uam9pbihcIiwgXCIpO1xuXHR9LFxuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRfYXBwbHlSZW5kZXI6IGZ1bmN0aW9uKHRzdGFtcCkge1xuXHRcdGlmIChERUJVRykge1xuXHRcdFx0aWYgKHRoaXMuX2xvZ0ZsYWdzW1widmlldy5yZW5kZXJcIl0pIHtcblx0XHRcdFx0Y29uc29sZS5sb2coXCIlczo6X2FwcGx5UmVuZGVyICAgWyVzXVwiLFxuXHRcdFx0XHRcdHRoaXMuY2lkLCB0aGlzLl90cmFjZVJlbmRlclN0YXR1cygpLFxuXHRcdFx0XHRcdHRoaXMuX2xvZ0ZsYWdzW1widmlldy50cmFjZVwiXSA/XG5cdFx0XHRcdFx0dGhpcy5fbG9nUmVuZGVyQ2FsbGVycy5qb2luKFwiXFxuXCIpIDogXCJcIik7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl9sb2dSZW5kZXJDYWxsZXJzLmxlbmd0aCA9IDA7XG5cdFx0fVxuXG5cdFx0dmFyIGZsYWdzID0gdGhpcy5fcmVuZGVyRmxhZ3M7XG5cdFx0dGhpcy50cmlnZ2VyKFwidmlldzpyZW5kZXI6YmVmb3JlXCIsIHRoaXMsIGZsYWdzKTtcblx0XHR0aGlzLl9yZW5kZXJGbGFncyA9IDA7XG5cdFx0dGhpcy5fcmVuZGVyUXVldWVJZCA9IC0xO1xuXHRcdHRoaXMuX3JlbmRlckZsYWdzIHw9IHRoaXMucmVuZGVyRnJhbWUodHN0YW1wLCBmbGFncyk7XG5cdFx0dGhpcy50cmlnZ2VyKFwidmlldzpyZW5kZXI6YWZ0ZXJcIiwgdGhpcywgZmxhZ3MpO1xuXG5cdFx0aWYgKHRoaXMuX3JlbmRlckZsYWdzICE9IDApIHtcblx0XHRcdGNvbnNvbGUud2FybihcIiVzOjpfYXBwbHlSZW5kZXIgW3JldHVybmVkXSBmbGFnczogJXNcIiwgdGhpcy5jaWQsIFZpZXcuZmxhZ3NUb1N0cmluZyh0aGlzLl9yZW5kZXJGbGFncyksIHRoaXMuX3JlbmRlckZsYWdzKTtcblx0XHR9XG5cdH0sXG5cblx0X2NhbmNlbFJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX3JlbmRlclF1ZXVlSWQgIT0gLTEpIHtcblx0XHRcdHZhciBjYW5jZWxJZCwgY2FuY2VsRm47XG5cblx0XHRcdGNhbmNlbElkID0gdGhpcy5fcmVuZGVyUXVldWVJZDtcblx0XHRcdHRoaXMuX3JlbmRlclF1ZXVlSWQgPSAtMTtcblx0XHRcdGNhbmNlbEZuID0gcmVuZGVyUXVldWUuY2FuY2VsKGNhbmNlbElkKTtcblxuXHRcdFx0aWYgKGNhbmNlbEZuID09PSB2b2lkIDApIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiJXM6Ol9jYW5jZWxSZW5kZXIgW2lkOiVpXSBub3QgZm91bmRcIiwgdGhpcy5jaWQsIGNhbmNlbElkKTtcblx0XHRcdH0gZWxzZSBpZiAoY2FuY2VsRm4gPT09IG51bGwpIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiJXM6Ol9jYW5jZWxSZW5kZXIgW2lkOiVpXSBhbHJlYWR5IGNhbmNlbGxlZFwiLCB0aGlzLmNpZCwgY2FuY2VsSWQpO1xuXHRcdFx0XHQvLyB9IGVsc2Uge1xuXHRcdFx0XHQvLyBcdGlmICh0aGlzLl9sb2dGbGFnc1tcInZpZXcucmVuZGVyXCJdICYmICFyZW5kZXJRdWV1ZS5ydW5uaW5nKVxuXHRcdFx0XHQvLyBcdFx0Y29uc29sZS5sb2coXCIlczo6X2NhbmNlbFJlbmRlciBJRDolaSBjYW5jZWxsZWRcIiwgdGhpcy5jaWQsIGNhbmNlbElkKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0X3JlcXVlc3RSZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdGlmIChyZW5kZXJRdWV1ZS5ydW5uaW5nKSB7XG5cdFx0XHR0aGlzLl9jYW5jZWxSZW5kZXIoKTtcblx0XHRcdC8vIGlmIChERUJVRykge1xuXHRcdFx0Ly8gXHRpZiAodGhpcy5fbG9nRmxhZ3NbXCJ2aWV3LnJlbmRlclwiXSkge1xuXHRcdFx0Ly8gXHRcdGNvbnNvbGUuaW5mbyhcIiVzOjpfcmVxdWVzdFJlbmRlciByZXNjaGVkdWxlZCBbJXMgKCVzKV1cIiwgdGhpcy5jaWQsIFZpZXcuZmxhZ3NUb1N0cmluZyh0aGlzLl9yZW5kZXJGbGFncyksIHRoaXMuX3JlbmRlckZsYWdzKTtcblx0XHRcdC8vIFx0fVxuXHRcdFx0Ly8gfVxuXHRcdH1cblx0XHRpZiAodGhpcy5fcmVuZGVyUXVldWVJZCA9PSAtMSkge1xuXHRcdFx0dGhpcy5fcmVuZGVyUXVldWVJZCA9IHJlbmRlclF1ZXVlLnJlcXVlc3QodGhpcy5fYXBwbHlSZW5kZXIsIGlzTmFOKHRoaXMudmlld0RlcHRoKSA/IE51bWJlci5NQVhfVkFMVUUgOiB0aGlzLnZpZXdEZXB0aCk7XG5cdFx0fVxuXHRcdGlmIChERUJVRykge1xuXHRcdFx0aWYgKHRoaXMuX2xvZ0ZsYWdzW1widmlldy5yZW5kZXJcIl0pIHtcblx0XHRcdFx0Ly8gaWYgKHRoaXMuX2xvZ0ZsYWdzW1widmlldy50cmFjZVwiXSkge1xuXHRcdFx0XHQvLyBcdGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQodGhpcy5jaWQgKyBcIjo6X3JlcXVlc3RSZW5kZXIgW1wiICsgdGhpcy5fdHJhY2VSZW5kZXJTdGF0dXMoKSArIFwiXSB0cmFjZVwiKTtcblx0XHRcdFx0Ly8gXHRjb25zb2xlLnRyYWNlKCk7XG5cdFx0XHRcdC8vIFx0Y29uc29sZS5ncm91cEVuZCgpO1xuXHRcdFx0XHQvLyB9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfcmVxdWVzdFJlbmRlciAlcyBbJXNdXCIsIHRoaXMuY2lkLFxuXHRcdFx0XHRcdChyZW5kZXJRdWV1ZS5ydW5uaW5nID8gXCJyZXNjaGVkdWxlZCBcIiA6IFwiXCIpLFxuXHRcdFx0XHRcdHRoaXMuX3RyYWNlUmVuZGVyU3RhdHVzKClcblx0XHRcdFx0KTtcblx0XHRcdFx0Ly8gfVxuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHJlbmRlcjogcHVibGljIC8gYWJzdHJhY3QgbWV0aG9kc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0aW52YWxpZGF0ZTogZnVuY3Rpb24oZmxhZ3MpIHtcblx0XHRpZiAoZmxhZ3MgIT09IHZvaWQgMCkge1xuXHRcdFx0LyppZiAoREVCVUcpIHtcblx0XHRcdFx0aWYgKHRoaXMuX2xvZ0ZsYWdzW1widmlldy5yZW5kZXJcIl0pIHtcblx0XHRcdFx0XHRpZiAodGhpcy5fcmVuZGVyRmxhZ3MgPiAwKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjppbnZhbGlkYXRlIFslcyAoJXMpXSArIFslcyAoJXMpXVwiLCB0aGlzLmNpZCwgVmlldy5mbGFnc1RvU3RyaW5nKHRoaXMuX3JlbmRlckZsYWdzKSwgdGhpcy5fcmVuZGVyRmxhZ3MsIFZpZXcuZmxhZ3NUb1N0cmluZyhmbGFncyksIGZsYWdzKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coXCIlczo6aW52YWxpZGF0ZSBbJXMgKCVzKV1cIiwgdGhpcy5jaWQsIFZpZXcuZmxhZ3NUb1N0cmluZyhmbGFncyksIGZsYWdzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0qL1xuXHRcdFx0dGhpcy5fcmVuZGVyRmxhZ3MgfD0gZmxhZ3M7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHJlcXVlc3RSZW5kZXI6IGZ1bmN0aW9uKGZsYWdzKSB7XG5cdFx0Ly8gaWYgKERFQlVHKSB7XG5cdFx0Ly8gXHRpZiAodGhpcy5fbG9nRmxhZ3NbXCJ2aWV3LnRyYWNlXCJdKSB7XG5cdFx0Ly8gXHRcdHZhciBmblBhdGggPSBbXTtcblx0XHQvLyBcdFx0dmFyIGZuID0gYXJndW1lbnRzLmNhbGxlZS5jYWxsZXI7XG5cdFx0Ly8gXHRcdHdoaWxlIChmbikge1xuXHRcdC8vIFx0XHRcdGlmIChmblBhdGgubGVuZ3RoID4gNSkgYnJlYWs7XG5cdFx0Ly8gXHRcdFx0Zm5QYXRoLnB1c2goZm4ubmFtZSk7XG5cdFx0Ly8gXHRcdFx0Zm4gPSBmbi5jYWxsZXI7XG5cdFx0Ly8gXHRcdH1cblx0XHQvLyBcdFx0Ly8gdGhpcy5fbG9nUmVuZGVyQ2FsbGVycy5wdXNoKGZuUGF0aC5qb2luKFwiXFxuXFx0LT5cIikpO1xuXHRcdC8vIFx0XHR0aGlzLl9sb2dSZW5kZXJDYWxsZXJzLnB1c2goZm5QYXRoLmpvaW4oXCIgLT4gXCIpKTtcblx0XHQvLyBcdH1cblx0XHQvLyB9XG5cdFx0Ly8gaWYgKGZsYWdzICE9PSB2b2lkIDApIHtcblx0XHQvLyBcdHRoaXMuX3JlbmRlckZsYWdzIHw9IGZsYWdzO1xuXHRcdC8vIH1cblx0XHR0aGlzLmludmFsaWRhdGUoZmxhZ3MpO1xuXHRcdHRoaXMuX3JlcXVlc3RSZW5kZXIoKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvKiogQGFic3RyYWN0ICovXG5cdHJlbmRlckZyYW1lOiBmdW5jdGlvbih0c3RhbXAsIGZsYWdzKSB7XG5cdFx0Ly8gc3ViY2xhc3NlcyBzaG91bGQgb3ZlcnJpZGUgdGhpcyBtZXRob2Rcblx0XHRyZXR1cm4gVmlldy5OT05FX0lOVkFMSUQ7XG5cdH0sXG5cblx0cmVuZGVyTm93OiBmdW5jdGlvbihhbHdheXNSdW4pIHtcblx0XHRpZiAodGhpcy5fcmVuZGVyUXVldWVJZCAhPSAtMSkge1xuXHRcdFx0dGhpcy5fY2FuY2VsUmVuZGVyKCk7XG5cdFx0XHRhbHdheXNSdW4gPSB0cnVlO1xuXHRcdH1cblx0XHQvLyBpZiAoYWx3YXlzUnVuID09PSB0cnVlKSB7XG5cdFx0aWYgKGFsd2F5c1J1bikge1xuXHRcdFx0dGhpcy5fYXBwbHlSZW5kZXIoX25vdygpKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0d2hlblJlbmRlcmVkOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gVmlldy53aGVuVmlld0lzUmVuZGVyZWQodGhpcyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiByZW5kZXIgYml0d2lzZSBmbGFnc1xuXHQvKiAtIGNoZWNrOiB0aGlzLl9yZW5kZXJGbGFncyAmIGZsYWdzXG5cdC8qIC0gYWRkOiB0aGlzLl9yZW5kZXJGbGFncyB8PSBmbGFnc1xuXHQvKiAtIHJlbW92ZTogdGhpcy5fcmVuZGVyRmxhZ3MgJj0gfmZsYWdzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiBoZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlcXVlc3RDaGlsZHJlblJlbmRlcjogZnVuY3Rpb24oZmxhZ3MsIG5vdywgZm9yY2UpIHtcblx0XHR2YXIgY2NpZCwgdmlldztcblx0XHRmb3IgKGNjaWQgaW4gdGhpcy5jaGlsZFZpZXdzKSB7XG5cdFx0XHR2aWV3ID0gdGhpcy5jaGlsZFZpZXdzW2NjaWRdO1xuXHRcdFx0dmlldy5za2lwVHJhbnNpdGlvbnMgPSB2aWV3LnNraXBUcmFuc2l0aW9ucyB8fCB0aGlzLnNraXBUcmFuc2l0aW9ucztcblx0XHRcdHZpZXcucmVxdWVzdFJlbmRlcihmbGFncyk7XG5cdFx0XHRpZiAobm93KSB7XG5cdFx0XHRcdHZpZXcucmVuZGVyTm93KGZvcmNlKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5yZW5kZXJOb3codHJ1ZSk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBjb21tb24gYWJzdHJhY3Rcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKlxuXHQvKiBAcGFyYW0ge0Jvb2xlYW59XG5cdC8qL1xuXHRzZXRFbmFibGVkOiBmdW5jdGlvbihlbmFibGUpIHtcblx0XHR0aGlzLl9lbmFibGVkID0gZW5hYmxlO1xuXHR9LFxufTtcbi8vLCBWaWV3KTtcblxuaWYgKERFQlVHKSB7XG5cdFZpZXdQcm90by5fbG9nRmxhZ3MgPSBbXG5cdFx0XCJ2aWV3LnJlbmRlclwiLFxuXHRcdC8vIFwidmlldy50cmFjZVwiXG5cdF0uam9pbihcIiBcIik7XG5cblx0Vmlld1Byb3RvLmNvbnN0cnVjdG9yID0gKGZ1bmN0aW9uKGZuKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIHJldHZhbDtcblx0XHRcdHRoaXMuX2xvZ1JlbmRlckNhbGxlcnMgPSBbXTtcblx0XHRcdHRoaXMuX2xvZ0ZsYWdzID0gdGhpcy5fbG9nRmxhZ3Muc3BsaXQoXCIgXCIpLnJlZHVjZShmdW5jdGlvbihyLCBvKSB7XG5cdFx0XHRcdHJbb10gPSB0cnVlO1xuXHRcdFx0XHRyZXR1cm4gcjtcblx0XHRcdH0sIHt9KTtcblx0XHRcdHJldHZhbCA9IGZuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcIi0tLS0tLSAlcyAlb1wiLCB0aGlzLmNpZCwgdGhpcy5fbG9nRmxhZ3MpO1xuXHRcdFx0cmV0dXJuIHJldHZhbDtcblx0XHR9O1xuXHR9KShWaWV3UHJvdG8uY29uc3RydWN0b3IpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKFZpZXdQcm90bywgVmlldyk7IiwiZnVuY3Rpb24gVmlld0Vycm9yKHZpZXcsIGVycikge1xuXHR0aGlzLnZpZXcgPSB2aWV3O1xuXHR0aGlzLmVyciA9IGVycjtcblx0dGhpcy5tZXNzYWdlID0gZXJyLm1lc3NhZ2U7XG59XG5WaWV3RXJyb3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShFcnJvci5wcm90b3R5cGUpO1xuVmlld0Vycm9yLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFZpZXdFcnJvcjtcblZpZXdFcnJvci5wcm90b3R5cGUubmFtZSA9IFwiVmlld0Vycm9yXCI7XG5cbm1vZHVsZS5leHBvcnRzID0gVmlld0Vycm9yO1xuIiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcImNvbXBpbGVyXCI6WzcsXCI+PSA0LjAuMFwiXSxcIm1haW5cIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBzdGFjazEsIGhlbHBlciwgYWxpYXMxPWRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge30sIGFsaWFzMj1oZWxwZXJzLmhlbHBlck1pc3NpbmcsIGFsaWFzMz1jb250YWluZXIuZXNjYXBlRXhwcmVzc2lvbiwgYWxpYXM0PVwiZnVuY3Rpb25cIjtcblxuICByZXR1cm4gXCI8YSBocmVmPVxcXCJcIlxuICAgICsgYWxpYXMzKChoZWxwZXJzLmdsb2JhbCB8fCAoZGVwdGgwICYmIGRlcHRoMC5nbG9iYWwpIHx8IGFsaWFzMikuY2FsbChhbGlhczEsXCJBUFBfUk9PVFwiLHtcIm5hbWVcIjpcImdsb2JhbFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSlcbiAgICArIFwiI1wiXG4gICAgKyBhbGlhczMoKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5oYW5kbGUgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmhhbmRsZSA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczQgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwiaGFuZGxlXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIlxcXCI+XCJcbiAgICArICgoc3RhY2sxID0gKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5uYW1lIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5uYW1lIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzNCA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJuYW1lXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpICE9IG51bGwgPyBzdGFjazEgOiBcIlwiKVxuICAgICsgXCI8L2E+XFxuXCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8qKlxuLyogQG1vZHVsZSBhcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZVZpZXdcbi8qL1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIHZpZXdUZW1wbGF0ZSA9IHJlcXVpcmUoXCIuL0FydGljbGVCdXR0b24uaGJzXCIpO1xuXG4vKipcbi8qIEBjb25zdHJ1Y3RvclxuLyogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZUJ1dHRvbn1cbi8qL1xudmFyIEFydGljbGVCdXR0b24gPSBWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJhcnRpY2xlQnV0dG9uXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJoMlwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJhcnRpY2xlLWJ1dHRvblwiLFxuXHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHR0ZW1wbGF0ZTogdmlld1RlbXBsYXRlLFxuXG5cdGV2ZW50czoge1xuXHRcdFwiY2xpY2sgYVwiOiBmdW5jdGlvbihkb21ldikge1xuXHRcdFx0ZG9tZXYuZGVmYXVsdFByZXZlbnRlZCB8fCBkb21ldi5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpjbGlja1wiLCB0aGlzLm1vZGVsKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gLyoqIEBvdmVycmlkZSAqL1xuXHQvLyBpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBSZW5kZXJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cmVuZGVyRnJhbWU6IGZ1bmN0aW9uKHRzdGFtcCwgZmxhZ3MpIHtcblx0XHR0aGlzLmVsLmlubmVySFRNTCA9IHRoaXMudGVtcGxhdGUodGhpcy5tb2RlbC50b0pTT04oKSk7XG5cdH0sXG59KTtcbm1vZHVsZS5leHBvcnRzID0gQXJ0aWNsZUJ1dHRvbjsiLCIvKipcbi8qIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVWaWV3XG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9uZXQvdG9BYnNvbHV0ZVVSTH0gKi9cbi8vIHZhciB0b0Fic29sdXRlVVJMID0gcmVxdWlyZShcInV0aWxzL25ldC90b0Fic29sdXRlVVJMXCIpO1xuLy9cbi8vIC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuLy8gdmFyIEFCU19BUFBfUk9PVCA9IHRvQWJzb2x1dGVVUkwocmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIikuQVBQX1JPT1QpO1xuXG4vKipcbi8qIEBjb25zdHJ1Y3RvclxuLyogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZVZpZXd9XG4vKi9cbnZhciBBcnRpY2xlVmlldyA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcImFydGljbGVWaWV3XCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJhcnRpY2xlXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImFydGljbGUtdmlldyBtZG93blwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge30sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogUmVuZGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlbmRlckZyYW1lOiBmdW5jdGlvbih0c3RhbXAsIGZsYWdzKSB7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLm1vZGVsLmdldChcInRleHRcIik7XG5cdFx0Ly8gRklYTUU6IG5vdyBkb25lIGluIHhzbHRcblx0XHQvLyB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCJhW2hyZWZdXCIpLmZvckVhY2goZnVuY3Rpb24oZWwpIHtcblx0XHQvLyBcdHZhciB1cmwgPSB0b0Fic29sdXRlVVJMKGVsLmdldEF0dHJpYnV0ZShcImhyZWZcIikpO1xuXHRcdC8vIFx0aWYgKHVybC5pbmRleE9mKEFCU19BUFBfUk9PVCkgIT09IDApIHtcblx0XHQvLyBcdFx0ZWwuc2V0QXR0cmlidXRlKFwidGFyZ2V0XCIsIFwiX2JsYW5rXCIpO1xuXHRcdC8vIFx0fVxuXHRcdC8vIH0pO1xuXHR9LFxufSk7XG5tb2R1bGUuZXhwb3J0cyA9IEFydGljbGVWaWV3OyIsIi8qKlxuLyogQG1vZHVsZSBhcHAvdmlldy9jb21wb25lbnQvQ2Fyb3VzZWxcbi8qL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmUuYmFieXNpdHRlcn0gKi9cbnZhciBDb250YWluZXIgPSByZXF1aXJlKFwiYmFja2JvbmUuYmFieXNpdHRlclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6aGFtbWVyanN9ICovXG52YXIgSGFtbWVyID0gcmVxdWlyZShcImhhbW1lcmpzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvdG91Y2gvU21vb3RoUGFuUmVjb2duaXplcn0gKi9cbnZhciBQYW4gPSByZXF1aXJlKFwidXRpbHMvdG91Y2gvU21vb3RoUGFuUmVjb2duaXplclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzLlRhcH0gKi9cbnZhciBUYXAgPSBIYW1tZXIuVGFwO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvRGVmZXJyZWRWaWV3fSAqL1xuLy8gdmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9EZWZlcnJlZFZpZXdcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9DYXJvdXNlbFJlbmRlcmVyfSAqL1xudmFyIENhcm91c2VsUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0Nhcm91c2VsUmVuZGVyZXJcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkUHJvcGVydHl9ICovXG52YXIgcHJlZml4ZWRQcm9wZXJ0eSA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFByb3BlcnR5XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRTdHlsZU5hbWV9ICovXG52YXIgcHJlZml4ZWRTdHlsZU5hbWUgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRTdHlsZU5hbWVcIik7XG5cbnZhciB0cmFuc2Zvcm1TdHlsZU5hbWUgPSBwcmVmaXhlZFN0eWxlTmFtZShcInRyYW5zZm9ybVwiKTtcbnZhciB0cmFuc2Zvcm1Qcm9wZXJ0eSA9IHByZWZpeGVkUHJvcGVydHkoXCJ0cmFuc2Zvcm1cIik7XG52YXIgdHJhbnNsYXRlVGVtcGxhdGUgPSBHbG9iYWxzLlRSQU5TTEFURV9URU1QTEFURTtcblxuLy8gdmFyIGNzc1RvUHggPSBmdW5jdGlvbihjc3NWYWwsIGVsKSB7XG4vLyBcdHJldHVybiBwYXJzZUludChjc3NWYWwpO1xuLy8gfTtcblxuLy8gdmFyIGRlZmF1bHRSZW5kZXJlckZ1bmN0aW9uID0gKGZ1bmN0aW9uKCkge1xuLy8gXHR2YXIgZGVmYXVsdFJlbmRlcmVyID0gQ2Fyb3VzZWxSZW5kZXJlci5leHRlbmQoeyBjbGFzc05hbWU6IFwiY2Fyb3VzZWwtaXRlbSBkZWZhdWx0LXJlbmRlcmVyXCJ9KSxcbi8vIFx0XHRlbXB0eVJlbmRlcmVyID0gQ2Fyb3VzZWxSZW5kZXJlci5leHRlbmQoeyBjbGFzc05hbWU6IFwiY2Fyb3VzZWwtaXRlbSBlbXB0eS1yZW5kZXJlclwifSk7XG4vLyBcdHJldHVybiBmdW5jdGlvbihpdGVtLCBpbmRleCwgYXJyKSB7XG4vLyBcdFx0cmV0dXJuIChpbmRleCA9PT0gLTEpPyBlbXB0eVJlbmRlcmVyOiBkZWZhdWx0UmVuZGVyZXI7XG4vLyBcdH07XG4vLyB9KSgpO1xuXG4vKiogQGNvbnN0ICovXG52YXIgTUFYX1NFTEVDVF9USFJFU0hPTEQgPSAyMDtcblxuLy8gLyoqIEBjb25zdCAqL1xuLy8gdmFyIENISUxEUkVOX0lOVkFMSUQgPSBWaWV3LkNISUxEUkVOX0lOVkFMSUQsXG4vLyBcdFNUWUxFU19JTlZBTElEID0gVmlldy5TVFlMRVNfSU5WQUxJRCxcbi8vIFx0TU9ERUxfSU5WQUxJRCA9IFZpZXcuTU9ERUxfSU5WQUxJRCxcbi8vIFx0U0laRV9JTlZBTElEID0gVmlldy5TSVpFX0lOVkFMSUQsXG4vLyBcdExBWU9VVF9JTlZBTElEID0gVmlldy5MQVlPVVRfSU5WQUxJRDtcblxudmFyIFZFUlRJQ0FMID0gSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTCxcblx0SE9SSVpPTlRBTCA9IEhhbW1lci5ESVJFQ1RJT05fSE9SSVpPTlRBTDtcblxuLy8geDogW1wieFwiLCBcInlcIl0sXG4vLyB5OiBbXCJ5XCIsIFwieFwiXSxcbi8vIG9mZnNldExlZnQ6IFtcIm9mZnNldExlZnRcIiwgXCJvZmZzZXRUb3BcIl0sXG4vLyBvZmZzZXRUb3A6IFtcIm9mZnNldFRvcFwiLCBcIm9mZnNldExlZnRcIl0sXG4vLyBvZmZzZXRXaWR0aDogW1wib2Zmc2V0V2lkdGhcIiwgXCJvZmZzZXRIZWlnaHRcIl0sXG4vLyBvZmZzZXRIZWlnaHQ6IFtcIm9mZnNldEhlaWdodFwiLCBcIm9mZnNldFdpZHRoXCJdLFxuLy8gd2lkdGg6IFtcIndpZHRoXCIsXCJoZWlnaHRcIl0sXG4vLyBoZWlnaHQ6IFtcImhlaWdodFwiLFwid2lkdGhcIl0sXG4vLyBtYXJnaW5MZWZ0OiBbXCJtYXJnaW5MZWZ0XCIsXCJtYXJnaW5Ub3BcIl0sXG4vLyBtYXJnaW5SaWdodDogW1wibWFyZ2luUmlnaHRcIixcIm1hcmdpbkJvdHRvbVwiXSxcblxuLypcbnZhciBIT1JJWk9OVEFMX1BST1BTID0ge1xuXHRwb3M6IFwieFwiLFxuXHRzaXplOiBcIndpZHRoXCIsXG5cdG9mZnNldFBvczogXCJvZmZzZXRMZWZ0XCIsXG5cdG9mZnNldFNpemU6IFwib2Zmc2V0V2lkdGhcIixcblx0bWFyZ2luQmVmb3JlOiBcIm1hcmdpbkxlZnRcIixcblx0bWFyZ2luQWZ0ZXI6IFwibWFyZ2luUmlnaHRcIixcbn07XG52YXIgVkVSVElDQUxfUFJPUFMgPSB7XG5cdHBvczogXCJ5XCIsXG5cdHNpemU6IFwiaGVpZ2h0XCIsXG5cdG9mZnNldFBvczogXCJvZmZzZXRUb3BcIixcblx0b2Zmc2V0U2l6ZTogXCJvZmZzZXRIZWlnaHRcIixcblx0bWFyZ2luQmVmb3JlOiBcIm1hcmdpblRvcFwiLFxuXHRtYXJnaW5BZnRlcjogXCJtYXJnaW5Cb3R0b21cIixcbn07XG4qL1xuXG4vLyB2YXIgRElSRUNUSU9OX05PTkUgPSAxO1xuLy8gdmFyIERJUkVDVElPTl9MRUZUID0gMjtcbi8vIHZhciBESVJFQ1RJT05fUklHSFQgPSA0O1xuLy8gdmFyIERJUkVDVElPTl9VUCA9IDg7XG4vLyB2YXIgRElSRUNUSU9OX0RPV04gPSAxNjtcblxuLy8gZnVuY3Rpb24gZGlyVG9TdHIoZGlyKSB7XG4vLyBcdGlmIChkaXIgPT09IEhhbW1lci5ESVJFQ1RJT05fTk9ORSkgcmV0dXJuICdOT05FJztcbi8vIFx0aWYgKGRpciA9PT0gSGFtbWVyLkRJUkVDVElPTl9MRUZUKSByZXR1cm4gJ0xFRlQnO1xuLy8gXHRpZiAoZGlyID09PSBIYW1tZXIuRElSRUNUSU9OX1JJR0hUKSByZXR1cm4gJ1JJR0hUJztcbi8vIFx0aWYgKGRpciA9PT0gSGFtbWVyLkRJUkVDVElPTl9VUCkgcmV0dXJuICdVUCc7XG4vLyBcdGlmIChkaXIgPT09IEhhbW1lci5ESVJFQ1RJT05fRE9XTikgcmV0dXJuICdET1dOJztcbi8vIFx0aWYgKGRpciA9PT0gSGFtbWVyLkRJUkVDVElPTl9IT1JJWk9OVEFMKSByZXR1cm4gJ0hPUklaT05UQUwnO1xuLy8gXHRpZiAoZGlyID09PSBIYW1tZXIuRElSRUNUSU9OX1ZFUlRJQ0FMKSByZXR1cm4gJ1ZFUlRJQ0FMJztcbi8vIFx0aWYgKGRpciA9PT0gSGFtbWVyLkRJUkVDVElPTl9BTEwpIHJldHVybiAnQUxMJztcbi8vIFx0cmV0dXJuICdVTlJFQ09HTklaRUQnO1xuLy8gfVxuXG52YXIgaXNWYWxpZFRvdWNoTWFuYWdlciA9IGZ1bmN0aW9uKHRvdWNoLCBkaXJlY3Rpb24pIHtcblx0Ly8gdmFyIHJldHZhbDtcblx0dHJ5IHtcblx0XHRyZXR1cm4gdG91Y2guZ2V0KFwiaHBhblwiKS5vcHRpb25zLmRpcmVjdGlvbiA9PSBkaXJlY3Rpb247XG5cdH0gY2F0Y2ggKGVycikge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHQvLyByZXR1cm4gcmV0dmFsO1xufTtcblxuLy8gLyoqIEB0eXBlIHtpbnR9IEluIHBpeGVscyAqL1xuLy8gdmFyIHBhblRocmVzaG9sZDogMTU7XG5cbnZhciBjcmVhdGVUb3VjaE1hbmFnZXIgPSBmdW5jdGlvbihlbCwgZGlyLCB0aHJlcykge1xuXHR2YXIgdG91Y2ggPSBuZXcgSGFtbWVyLk1hbmFnZXIoZWwpO1xuXHR2YXIgcGFuID0gbmV3IFBhbih7XG5cdFx0ZXZlbnQ6IFwiaHBhblwiLFxuXHRcdHRocmVzaG9sZDogR2xvYmFscy5USFJFU0hPTEQsXG5cdFx0ZGlyZWN0aW9uOiBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUwsXG5cdH0pO1xuXHR2YXIgdGFwID0gbmV3IFRhcCh7XG5cdFx0dGhyZXNob2xkOiBHbG9iYWxzLlRIUkVTSE9MRCAtIDEsXG5cdFx0aW50ZXJ2YWw6IDUwLFxuXHRcdHRpbWU6IDIwMCxcblx0fSk7XG5cdHRhcC5yZWNvZ25pemVXaXRoKHBhbik7XG5cdHRvdWNoLmFkZChbcGFuLCB0YXBdKTtcblx0cmV0dXJuIHRvdWNoO1xufTtcblxuXG52YXIgQ2Fyb3VzZWwgPSB7XG5cdC8qKiBjb25zdCAqL1xuXHRBTklNQVRFRDogZmFsc2UsXG5cdC8qKiBjb25zdCAqL1xuXHRJTU1FRElBVEU6IHRydWUsXG5cblx0LyoqIGNvcHkgb2YgSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTCAqL1xuXHRESVJFQ1RJT05fVkVSVElDQUw6IFZFUlRJQ0FMLFxuXHQvKiogY29weSBvZiBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUwgKi9cblx0RElSRUNUSU9OX0hPUklaT05UQUw6IEhPUklaT05UQUwsXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cblx0XHRzZWxlY3RPblNjcm9sbEVuZDogZmFsc2UsXG5cdFx0LyoqIEB0eXBlIHtib29sZWFufSAqL1xuXHRcdHJlcXVpcmVTZWxlY3Rpb246IGZhbHNlLFxuXHRcdC8qKiBAdHlwZSB7aW50fSAqL1xuXHRcdGRpcmVjdGlvbjogSE9SSVpPTlRBTCxcblx0XHQvKiogQHR5cGUge2ludH0gSW4gcGl4ZWxzICovXG5cdFx0c2VsZWN0VGhyZXNob2xkOiAyMCxcblx0XHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHRcdHJlbmRlcmVyRnVuY3Rpb246IChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBkZWZhdWx0UmVuZGVyZXIgPSBDYXJvdXNlbFJlbmRlcmVyLmV4dGVuZCh7XG5cdFx0XHRcdFx0Y2xhc3NOYW1lOiBcImNhcm91c2VsLWl0ZW0gZGVmYXVsdC1yZW5kZXJlclwiXG5cdFx0XHRcdH0pLFxuXHRcdFx0XHRlbXB0eVJlbmRlcmVyID0gQ2Fyb3VzZWxSZW5kZXJlci5leHRlbmQoe1xuXHRcdFx0XHRcdGNsYXNzTmFtZTogXCJjYXJvdXNlbC1pdGVtIGVtcHR5LXJlbmRlcmVyXCJcblx0XHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycikge1xuXHRcdFx0XHRyZXR1cm4gKGluZGV4ID09PSAtMSkgPyBlbXB0eVJlbmRlcmVyIDogZGVmYXVsdFJlbmRlcmVyO1xuXHRcdFx0fTtcblx0XHR9KSgpLFxuXHR9LFxufTtcbkNhcm91c2VsLnZhbGlkT3B0aW9ucyA9IF8ua2V5cyhDYXJvdXNlbC5kZWZhdWx0cyk7XG5cbi8qKlxuLyogQGNvbnN0cnVjdG9yXG4vKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9DYXJvdXNlbH1cbi8qL1xudmFyIENhcm91c2VsUHJvdG8gPSB7XG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjaWRQcmVmaXg6IFwiY2Fyb3VzZWxcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0YWdOYW1lOiBcImRpdlwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJjYXJvdXNlbCBza2lwLXRyYW5zaXRpb25zXCIsXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcHJvcGVydGllc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0c2Nyb2xsaW5nOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fc2Nyb2xsaW5nO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0c2VsZWN0ZWRJdGVtOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fc2VsZWN0ZWRWaWV3Lm1vZGVsO1xuXHRcdFx0fSxcblx0XHRcdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0aWYgKHZhbHVlKVxuXHRcdFx0XHRcdHRoaXMuX29uU2VsZWN0T25lKHZhbHVlKVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0dGhpcy5fb25TZWxlY3ROb25lKCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0fSxcblxuXHRldmVudHM6IHtcblx0XHQvLyBcIm1vdXNlZG93blwiOiBcIl9vbk1vdXNlRG93blwiLCBcIm1vdXNldXBcIjogXCJfb25Nb3VzZVVwXCIsXG5cdFx0XCJ0cmFuc2l0aW9uZW5kIC5jYXJvdXNlbC1pdGVtLnNlbGVjdGVkXCI6IFwiX29uU2Nyb2xsVHJhbnNpdGlvbkVuZFwiLFxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdF8uYmluZEFsbCh0aGlzLCBcIl9vblRvdWNoRXZlbnRcIik7XG5cblx0XHR0aGlzLml0ZW1WaWV3cyA9IG5ldyBDb250YWluZXIoKTtcblx0XHR0aGlzLm1ldHJpY3MgPSB7fTtcblxuXHRcdF8uZXh0ZW5kKHRoaXMsIF8uZGVmYXVsdHMoXy5waWNrKG9wdGlvbnMsIENhcm91c2VsLnZhbGlkT3B0aW9ucyksIENhcm91c2VsLmRlZmF1bHRzKSk7XG5cblx0XHQvLyB0aGlzLmNoaWxkR2FwID0gMDsgLy90aGlzLmRpclByb3AoMjAsIDE4KTtcblx0XHR0aGlzLl9wcmVjZWRpbmdEaXIgPSAoSGFtbWVyLkRJUkVDVElPTl9MRUZUIHwgSGFtbWVyLkRJUkVDVElPTl9VUCkgJiB0aGlzLmRpcmVjdGlvbjtcblx0XHR0aGlzLl9mb2xsb3dpbmdEaXIgPSAoSGFtbWVyLkRJUkVDVElPTl9SSUdIVCB8IEhhbW1lci5ESVJFQ1RJT05fRE9XTikgJiB0aGlzLmRpcmVjdGlvbjtcblxuXHRcdC8vIHVzZSBzdXBwbGllZCB0b3VjaCBtZ3Igb3IgY3JlYXRlIHByaXZhdGVcblx0XHRpZiAoaXNWYWxpZFRvdWNoTWFuYWdlcihvcHRpb25zLnRvdWNoLCB0aGlzLmRpcmVjdGlvbikpIHtcblx0XHRcdHRoaXMudG91Y2ggPSBvcHRpb25zLnRvdWNoO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCIlczo6aW5pdGlhbGl6ZSBjcmVhdGluZyBIYW1tZXIgaW5zdGFuY2VcIiwgdGhpcy5jaWQpO1xuXHRcdFx0dGhpcy50b3VjaCA9IGNyZWF0ZVRvdWNoTWFuYWdlcih0aGlzLmVsLCB0aGlzLmRpcmVjdGlvbik7XG5cdFx0XHQvLyB0aGlzLm9uKFwidmlldzpyZW1vdmVkXCIsIHRoaXMudG91Y2guZGVzdHJveSwgdGhpcy50b3VjaCk7XG5cdFx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwidmlldzpyZW1vdmVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLnRvdWNoLmRlc3Ryb3koKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8qIGNyZWF0ZSBjaGlsZHJlbiBhbmQgcHJvcHMgKi9cblx0XHR0aGlzLnNldEVuYWJsZWQodHJ1ZSk7XG5cdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHRcdHRoaXMuX3JlbmRlckZsYWdzID0gVmlldy5DSElMRFJFTl9JTlZBTElEO1xuXHRcdC8vIHRoaXMuaW52YWxpZGF0ZUNoaWxkcmVuKCk7XG5cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwidmlldzphdHRhY2hlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gdHJ1ZTtcblx0XHRcdC8vIHRoaXMuaW52YWxpZGF0ZVNpemUoKTtcblx0XHRcdC8vIHRoaXMucmVuZGVyTm93KCk7XG5cdFx0XHQvLyB0aGlzLnJlcXVlc3RSZW5kZXIoKTtcblx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHRcdH0pO1xuXG5cdFx0LyogY29sbGVjdGlvbiBsaXN0ZW5lcnMgKi9cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwge1xuXHRcdFx0XCJyZXNldFwiOiB0aGlzLl9vblJlc2V0LFxuXHRcdFx0XCJzZWxlY3Q6b25lXCI6IHRoaXMuX29uU2VsZWN0T25lLFxuXHRcdFx0XCJzZWxlY3Q6bm9uZVwiOiB0aGlzLl9vblNlbGVjdE5vbmUsXG5cdFx0XHRcImRlc2VsZWN0Om9uZVwiOiB0aGlzLl9vbkRlc2VsZWN0QW55LFxuXHRcdFx0XCJkZXNlbGVjdDpub25lXCI6IHRoaXMuX29uRGVzZWxlY3RBbnksXG5cdFx0fSk7XG5cdH0sXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIEhhbW1lciBpbml0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIHZhbGlkYXRlVG91Y2hNYW5hZ2VyOiBmdW5jdGlvbih0b3VjaCwgZGlyZWN0aW9uKSB7XG5cdC8vIFx0dHJ5IHtcblx0Ly8gXHRcdHJldHVybiB0b3VjaC5nZXQoXCJwYW5cIikub3B0aW9ucy5kaXJlY3Rpb24gPT09IGRpcmVjdGlvbik7XG5cdC8vIFx0fSBjYXRjaCAoZXJyKSB7XG5cdC8vIFx0XHRyZXR1cm4gZmFsc2U7XG5cdC8vIFx0fVxuXHQvLyB9LFxuXG5cdC8vIGluaXRpYWxpemVIYW1tZXI6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0Ly8gXHQvLyBkaXJlY3Rpb24gZnJvbSBvcHRzL2RlZmF1bHRzXG5cdC8vIFx0aWYgKG9wdGlvbnMuZGlyZWN0aW9uID09PSBWRVJUSUNBTCkge1xuXHQvLyBcdFx0dGhpcy5kaXJlY3Rpb24gPSBWRVJUSUNBTDtcblx0Ly8gXHR9IC8vIGRvIG5vdGhpbmc6IHRoZSBkZWZhdWx0IGlzIGhvcml6b250YWxcblx0Ly9cblx0Ly8gXHQvLyB2YWxpZGF0ZSBoYW1tZXIgaW5zdGFuY2Ugb3IgY3JlYXRlIGxvY2FsXG5cdC8vIFx0aWYgKCh0b3VjaCA9IG9wdGlvbnMudG91Y2gpICYmIChwYW4gPSB0b3VjaC5nZXQoXCJwYW5cIikpKSB7XG5cdC8vIFx0XHQvLyBPdmVycmlkZSBkaXJlY3Rpb24gb25seSBpZiBzcGVjaWZpY1xuXHQvLyBcdFx0aWYgKHBhbi5vcHRpb25zLmRpcmVjdGlvbiAhPT0gSGFtbWVyLkRJUkVDVElPTl9BTEwpIHtcblx0Ly8gXHRcdFx0dGhpcy5kaXJlY3Rpb24gPSBwYW4ub3B0aW9ucy5kaXJlY3Rpb247XG5cdC8vIFx0XHR9XG5cdC8vIFx0XHR0aGlzLnBhblRocmVzaG9sZCA9IHBhbi5vcHRpb25zLnRocmVzaG9sZDtcblx0Ly8gXHR9IGVsc2Uge1xuXHQvLyBcdFx0Y29uc29sZS53YXJuKFwiJXM6OmluaXRpYWxpemVIYW1tZXIgdXNpbmcgcHJpdmF0ZSBIYW1tZXIgaW5zdGFuY2VcIiwgdGhpcy5jaWQpO1xuXHQvLyBcdFx0dG91Y2ggPSBjcmVhdGVIYW1tZXJJbnN0YW5jZSh0aGlzLmVsLCB0aGlzLnBhblRocmVzaG9sZCwgdGhpcy5kaXJlY3Rpb24pO1xuXHQvLyBcdFx0dGhpcy5vbihcInZpZXc6cmVtb3ZlZFwiLCB0b3VjaC5kZXN0cm95LCB0b3VjaCk7XG5cdC8vIFx0fVxuXHQvLyBcdHRoaXMudG91Y2ggPSB0b3VjaDtcblx0Ly8gfSxcblxuXHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHRoaXMuX3Njcm9sbFBlbmRpbmdBY3Rpb24gJiYgdGhpcy5fc2Nyb2xsUGVuZGluZ0FjdGlvbih0cnVlKTtcblx0XHQvLyBpZiAodGhpcy5fZW5hYmxlZCkge1xuXHRcdC8vIFx0dGhpcy50b3VjaC5vZmYoXCJ0YXBcIiwgdGhpcy5fb25UYXApO1xuXHRcdC8vIFx0dGhpcy50b3VjaC5vZmYoXCJocGFuc3RhcnQgaHBhbm1vdmUgaHBhbmVuZCBocGFuY2FuY2VsXCIsIHRoaXMuX29uUGFuKTtcblx0XHQvLyB9XG5cdFx0dGhpcy5fdG9nZ2xlVG91Y2hFdmVudHMoZmFsc2UpO1xuXHRcdHRoaXMucmVtb3ZlQ2hpbGRyZW4oKTtcblx0XHRWaWV3LnByb3RvdHlwZS5yZW1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGhlbHBlciBmdW5jdGlvbnNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0ZGlyUHJvcDogZnVuY3Rpb24oaFByb3AsIHZQcm9wKSB7XG5cdFx0cmV0dXJuICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpID8gaFByb3AgOiB2UHJvcDtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBSZW5kZXJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gcmVuZGVyOiBmdW5jdGlvbigpIHtcblx0Ly8gXHRpZiAodGhpcy5hdHRhY2hlZCkge1xuXHQvLyBcdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHQvLyBcdFx0Ly8gdGhpcy5pbnZhbGlkYXRlU2l6ZSgpO1xuXHQvLyBcdFx0dGhpcy5yZW5kZXJOb3codHJ1ZSk7XG5cdC8vIFx0fVxuXHQvLyB9LFxuXG5cdC8vIC8qKiBAb3ZlcnJpZGUgKi9cblx0Ly8gcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG5cdC8vIFx0aWYgKCF0aGlzLmF0dGFjaGVkKSB7XG5cdC8vIFx0XHRpZiAoIXRoaXMuX3JlbmRlclBlbmRpbmcpIHtcblx0Ly8gXHRcdFx0dGhpcy5fcmVuZGVyUGVuZGluZyA9IHRydWU7XG5cdC8vIFx0XHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OmF0dGFjaGVkXCIsIHRoaXMucmVuZGVyKTtcblx0Ly8gXHRcdH1cblx0Ly8gXHR9IGVsc2Uge1xuXHQvLyBcdFx0aWYgKHRoaXMuX3JlbmRlclBlbmRpbmcpIHtcblx0Ly8gXHRcdFx0dGhpcy5fcmVuZGVyUGVuZGluZyA9IGZhbHNlO1xuXHQvLyBcdFx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcywgXCJ2aWV3OmF0dGFjaGVkXCIsIHRoaXMucmVuZGVyKTtcblx0Ly8gXHRcdH1cblx0Ly8gXHRcdHRoaXMuX2RlbHRhID0gMDtcblx0Ly8gXHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gdHJ1ZTtcblx0Ly8gXHRcdHRoaXMuaW52YWxpZGF0ZVNpemUoKTtcblx0Ly8gXHRcdC8vIHRoaXMuaW52YWxpZGF0ZUxheW91dCgpO1xuXHQvLyBcdFx0dGhpcy5yZW5kZXJOb3coKTtcblx0Ly8gXHR9XG5cdC8vIFx0cmV0dXJuIHRoaXM7XG5cdC8vIH0sXG5cblx0Ly8gcmVuZGVyOiBmdW5jdGlvbiAoKSB7XG5cdC8vIFx0dGhpcy5tZWFzdXJlTGF0ZXIoKTtcblx0Ly8gXHR0aGlzLnNjcm9sbEJ5KDAsIENhcm91c2VsLklNTUVESUFURSk7XG5cdC8vXG5cdC8vIFx0aWYgKHRoaXMuZWwucGFyZW50RWxlbWVudCkge1xuXHQvLyBcdFx0dGhpcy5yZW5kZXJOb3coKTtcblx0Ly8gXHR9XG5cdC8vIFx0cmV0dXJuIHRoaXM7XG5cdC8vIH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW5kZXJGcmFtZTogZnVuY3Rpb24odHN0YW1wLCBmbGFncykge1xuXHRcdGlmIChmbGFncyAmIFZpZXcuQ0hJTERSRU5fSU5WQUxJRCkge1xuXHRcdFx0dGhpcy5fY3JlYXRlQ2hpbGRyZW4oKTtcblx0XHRcdC8vIGNsZWFyIHRoaXMgZmxhZyBub3c6IHJlbmRlciBtYXkgYmUgZGVmZXJyZWQgdW50aWwgYXR0YWNoZWRcblx0XHRcdGZsYWdzICY9IH5WaWV3LkNISUxEUkVOX0lOVkFMSUQ7XG5cdFx0fVxuXHRcdGlmICh0aGlzLmF0dGFjaGVkKSB7XG5cdFx0XHRpZiAoZmxhZ3MgJiBWaWV3LlNJWkVfSU5WQUxJRCkge1xuXHRcdFx0XHR0aGlzLl9tZWFzdXJlKCk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoZmxhZ3MgJiAoVmlldy5MQVlPVVRfSU5WQUxJRCB8IFZpZXcuU0laRV9JTlZBTElEKSkge1xuXHRcdFx0XHR0aGlzLl9zY3JvbGxCeSh0aGlzLl9kZWx0YSwgdGhpcy5za2lwVHJhbnNpdGlvbnMpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoZmxhZ3MpIHtcblx0XHRcdHRoaXMubGlzdGVuVG9PbmNlKHRoaXMsIFwidmlldzphdHRhY2hlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKGZsYWdzKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBlbmFibGVkXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIC8qKiBAb3ZlcnJpZGUgKi9cblx0Ly8gX2VuYWJsZWQ6IHVuZGVmaW5lZCxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHNldEVuYWJsZWQ6IGZ1bmN0aW9uKGVuYWJsZWQpIHtcblx0XHRpZiAodGhpcy5fZW5hYmxlZCAhPT0gZW5hYmxlZCkge1xuXHRcdFx0dGhpcy5fZW5hYmxlZCA9IGVuYWJsZWQ7XG5cdFx0XHQvLyB0b2dnbGUgZXZlbnRzIGltbWVkaWF0ZWx5XG5cdFx0XHR0aGlzLl90b2dnbGVUb3VjaEV2ZW50cyhlbmFibGVkKTtcblx0XHRcdC8vIGRvbSBtYW5pcHVsYXRpb24gb24gcmVuZGVyIChfcmVuZGVyRW5hYmxlZClcblx0XHRcdC8vIHRoaXMuX3JlbmRlckZsYWdzIHw9IFZpZXcuU1RZTEVTX0lOVkFMSUQ7XG5cdFx0XHQvLyB0aGlzLnJlcXVlc3RSZW5kZXIoKTtcblxuXHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZGlzYWJsZWRcIiwgIXRoaXMuZW5hYmxlZCk7XG5cdFx0XHR0aGlzLml0ZW1WaWV3cy5lYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0dmlldy5zZXRFbmFibGVkKHRoaXMuZW5hYmxlZCk7XG5cdFx0XHR9LCB0aGlzKTtcblx0XHR9XG5cdH0sXG5cblx0X3JlbmRlckVuYWJsZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImRpc2FibGVkXCIsICF0aGlzLmVuYWJsZWQpO1xuXHRcdHRoaXMuaXRlbVZpZXdzLmVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0dmlldy5zZXRFbmFibGVkKHRoaXMuZW5hYmxlZCk7XG5cdFx0fSwgdGhpcyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogQ3JlYXRlIGNoaWxkcmVuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9jcmVhdGVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gdmFyIHNJbmRleDtcblx0XHR2YXIgYnVmZmVyLCByZW5kZXJlciwgdmlldywgdmlld09wdHM7XG5cblx0XHR0aGlzLnJlbW92ZUNoaWxkcmVuKCk7XG5cblx0XHRpZiAodGhpcy5jb2xsZWN0aW9uLmxlbmd0aCkge1xuXHRcdFx0dmlld09wdHMgPSB7XG5cdFx0XHRcdC8vIHZpZXdEZXB0aDogdGhpcy52aWV3RGVwdGggKyAxLFxuXHRcdFx0XHQvLyBwYXJlbnRWaWV3OiB0aGlzLFxuXHRcdFx0XHRlbmFibGVkOiB0aGlzLmVuYWJsZWRcblx0XHRcdH07XG5cdFx0XHRidWZmZXIgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG5cdFx0XHQvLyBidWZmZXIgPSB0aGlzLmVsO1xuXG5cdFx0XHRpZiAoIXRoaXMucmVxdWlyZVNlbGVjdGlvbikge1xuXHRcdFx0XHRyZW5kZXJlciA9IHRoaXMucmVuZGVyZXJGdW5jdGlvbihudWxsLCAtMSwgdGhpcy5jb2xsZWN0aW9uKTtcblx0XHRcdFx0dmlldyA9IG5ldyByZW5kZXJlcih2aWV3T3B0cyk7XG5cdFx0XHRcdHRoaXMuaXRlbVZpZXdzLmFkZCh2aWV3KTtcblx0XHRcdFx0YnVmZmVyLmFwcGVuZENoaWxkKHZpZXcuZWwpO1xuXHRcdFx0XHR0aGlzLmVtcHR5VmlldyA9IHZpZXc7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMuY29sbGVjdGlvbi5lYWNoKGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBhcnIpIHtcblx0XHRcdFx0dmlld09wdHMubW9kZWwgPSBpdGVtO1xuXHRcdFx0XHRyZW5kZXJlciA9IHRoaXMucmVuZGVyZXJGdW5jdGlvbihpdGVtLCBpbmRleCwgYXJyKTtcblx0XHRcdFx0dmlldyA9IG5ldyByZW5kZXJlcih2aWV3T3B0cyk7XG5cdFx0XHRcdHRoaXMuaXRlbVZpZXdzLmFkZCh2aWV3KTtcblx0XHRcdFx0YnVmZmVyLmFwcGVuZENoaWxkKHZpZXcuZWwpO1xuXHRcdFx0fSwgdGhpcyk7XG5cblx0XHRcdC8vIGlmICghdGhpcy5yZXF1aXJlU2VsZWN0aW9uKSB7XG5cdFx0XHQvLyBcdGJ1ZmZlciA9IHRoaXMuYXBwZW5kSXRlbVZpZXcoYnVmZmVyLCB0aGlzLm1vZGVsLCAtMSwgdGhpcy5jb2xsZWN0aW9uKTtcblx0XHRcdC8vIFx0dGhpcy5lbXB0eVZpZXcgPSB0aGlzLml0ZW1WaWV3cy5maXJzdCgpO1xuXHRcdFx0Ly8gfVxuXHRcdFx0Ly8gYnVmZmVyID0gdGhpcy5jb2xsZWN0aW9uLnJlZHVjZSh0aGlzLmFwcGVuZEl0ZW1WaWV3LCBidWZmZXIsIHRoaXMpO1xuXG5cdFx0XHR0aGlzLmFkanVzdFRvU2VsZWN0aW9uKCk7XG5cdFx0XHR0aGlzLl9zZWxlY3RlZFZpZXcuZWwuY2xhc3NMaXN0LmFkZChcInNlbGVjdGVkXCIpO1xuXG5cdFx0XHR0aGlzLmVsLmFwcGVuZENoaWxkKGJ1ZmZlcik7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIGFwcGVuZEl0ZW1WaWV3OiBmdW5jdGlvbiAocGFyZW50RWwsIG1vZGVsLCBpbmRleCwgYXJyKSB7XG5cdC8vIFx0dmFyIHJlbmRlcmVyID0gdGhpcy5yZW5kZXJlckZ1bmN0aW9uKG1vZGVsLCBpbmRleCwgYXJyKTtcblx0Ly8gXHR2YXIgdmlldyA9IG5ldyByZW5kZXJlcih7XG5cdC8vIFx0XHRtb2RlbDogbW9kZWwsXG5cdC8vIFx0XHRwYXJlbnRWaWV3OiB0aGlzLFxuXHQvLyBcdFx0ZW5hYmxlZDogdGhpcy5lbmFibGVkXG5cdC8vIFx0fSk7XG5cdC8vIFx0dGhpcy5pdGVtVmlld3MuYWRkKHZpZXcpO1xuXHQvLyBcdHBhcmVudEVsLmFwcGVuZENoaWxkKHZpZXcuZWwpO1xuXHQvLyBcdHJldHVybiBwYXJlbnRFbDtcblx0Ly8gfSxcblxuXHQvLyBjcmVhdGVJdGVtVmlldzogZnVuY3Rpb24gKHJlbmRlcmVyLCBvcHRzKSB7XG5cdC8vIFx0dmFyIHZpZXcgPSBuZXcgcmVuZGVyZXIob3B0cyk7XG5cdC8vIFx0dGhpcy5pdGVtVmlld3MuYWRkKHZpZXcpO1xuXHQvLyBcdHJldHVybiB2aWV3O1xuXHQvLyB9LFxuXG5cdHJlbW92ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLml0ZW1WaWV3cy5lYWNoKHRoaXMucmVtb3ZlSXRlbVZpZXcsIHRoaXMpO1xuXHRcdHRoaXMuZW1wdHlWaWV3ID0gdm9pZCAwO1xuXHR9LFxuXG5cdHJlbW92ZUl0ZW1WaWV3OiBmdW5jdGlvbih2aWV3KSB7XG5cdFx0dGhpcy5pdGVtVmlld3MucmVtb3ZlKHZpZXcpO1xuXHRcdHZpZXcucmVtb3ZlKCk7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogbWVhc3VyZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfbWVhc3VyZTogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG0sIG1tO1xuXHRcdHZhciBwb3MgPSAwLFxuXHRcdFx0cG9zSW5uZXIgPSAwO1xuXHRcdHZhciBtYXhBY3Jvc3MgPSAwLFxuXHRcdFx0bWF4T3V0ZXIgPSAwO1xuXHRcdHZhciBtYXhPdXRlclZpZXcsIG1heEFjcm9zc1ZpZXc7XG5cblx0XHRtYXhPdXRlclZpZXcgPSBtYXhBY3Jvc3NWaWV3ID0gdGhpcy5lbXB0eVZpZXcgfHwgdGhpcy5pdGVtVmlld3MuZmlyc3QoKTtcblxuXHRcdC8vIGNoaWRyZW4gbWV0cmljc1xuXHRcdHRoaXMuaXRlbVZpZXdzLmVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0dmlldy5yZW5kZXIoKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuaXRlbVZpZXdzLmVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0bSA9IHRoaXMubWVhc3VyZUl0ZW1WaWV3KHZpZXcpO1xuXHRcdFx0bS5wb3MgPSBwb3M7XG5cdFx0XHRwb3MgKz0gbS5vdXRlcjsgLy8gKyB0aGlzLmNoaWxkR2FwO1xuXHRcdFx0bS5wb3NJbm5lciA9IHBvc0lubmVyO1xuXHRcdFx0cG9zSW5uZXIgKz0gbS5pbm5lcjsgLy8rIHRoaXMuY2hpbGRHYXA7XG5cdFx0XHRpZiAodmlldyAhPT0gdGhpcy5lbXB0eVZpZXcpIHtcblx0XHRcdFx0aWYgKG0uYWNyb3NzID4gbWF4QWNyb3NzKSB7XG5cdFx0XHRcdFx0bWF4QWNyb3NzID0gbS5hY3Jvc3M7XG5cdFx0XHRcdFx0bWF4QWNyb3NzVmlldyA9IHZpZXc7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKG0ub3V0ZXIgPiBtYXhPdXRlcikge1xuXHRcdFx0XHRcdG1heE91dGVyID0gbS5vdXRlcjtcblx0XHRcdFx0XHRtYXhPdXRlclZpZXcgPSB2aWV3O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSwgdGhpcyk7XG5cblx0XHQvLyBtZWFzdXJlIHNlbGYgKyBtYXggY2hpbGQgbWV0cmljc1xuXHRcdG1tID0gdGhpcy5tZXRyaWNzW3RoaXMuY2lkXSB8fCAodGhpcy5tZXRyaWNzW3RoaXMuY2lkXSA9IHt9KTtcblx0XHRtbS5vdXRlciA9IHRoaXMuZWxbdGhpcy5kaXJQcm9wKFwib2Zmc2V0V2lkdGhcIiwgXCJvZmZzZXRIZWlnaHRcIildO1xuXHRcdG1tLmJlZm9yZSA9IG1heE91dGVyVmlldy5lbFt0aGlzLmRpclByb3AoXCJvZmZzZXRMZWZ0XCIsIFwib2Zmc2V0VG9wXCIpXTtcblx0XHRtbS5pbm5lciA9IG1heE91dGVyVmlldy5lbFt0aGlzLmRpclByb3AoXCJvZmZzZXRXaWR0aFwiLCBcIm9mZnNldEhlaWdodFwiKV07XG5cdFx0bW0uYWZ0ZXIgPSBtbS5vdXRlciAtIChtbS5pbm5lciArIG1tLmJlZm9yZSk7XG5cdFx0bW0uYWNyb3NzID0gbWF4QWNyb3NzO1xuXG5cdFx0Ly8gbSA9IHRoaXMubWV0cmljc1ttYXhPdXRlclZpZXcuY2lkXTtcblx0XHQvLyBtbS5pbm5lciA9IG0uaW5uZXI7XG5cblx0XHQvLyB0YXAgYXJlYVxuXHRcdHRoaXMuX3RhcEFjcm9zc0JlZm9yZSA9IG1heEFjcm9zc1ZpZXcuZWxbdGhpcy5kaXJQcm9wKFwib2Zmc2V0VG9wXCIsIFwib2Zmc2V0TGVmdFwiKV07XG5cdFx0dGhpcy5fdGFwQWNyb3NzQWZ0ZXIgPSB0aGlzLl90YXBBY3Jvc3NCZWZvcmUgKyBtYXhBY3Jvc3M7XG5cdFx0dGhpcy5fdGFwQmVmb3JlID0gbW0uYmVmb3JlICsgdGhpcy5fdGFwR3Jvdztcblx0XHR0aGlzLl90YXBBZnRlciA9IG1tLmJlZm9yZSArIG1tLmlubmVyIC0gdGhpcy5fdGFwR3JvdztcblxuXHRcdHRoaXMuc2VsZWN0VGhyZXNob2xkID0gTWF0aC5taW4oTUFYX1NFTEVDVF9USFJFU0hPTEQsIG1tLm91dGVyICogMC4xKTtcblx0fSxcblxuXHRtZWFzdXJlSXRlbVZpZXc6IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHR2YXIgbSwgdmlld0VsO1xuXHRcdC8vIHZhciBzLCBzaXplRWw7XG5cblx0XHR2aWV3RWwgPSB2aWV3LmVsO1xuXHRcdG0gPSB0aGlzLm1ldHJpY3Nbdmlldy5jaWRdIHx8ICh0aGlzLm1ldHJpY3Nbdmlldy5jaWRdID0ge30pO1xuXG5cdFx0bS5vdXRlciA9IHZpZXdFbFt0aGlzLmRpclByb3AoXCJvZmZzZXRXaWR0aFwiLCBcIm9mZnNldEhlaWdodFwiKV07XG5cdFx0bS5hY3Jvc3MgPSB2aWV3RWxbdGhpcy5kaXJQcm9wKFwib2Zmc2V0SGVpZ2h0XCIsIFwib2Zmc2V0V2lkdGhcIildO1xuXG5cdFx0aWYgKHZpZXcubWV0cmljcykge1xuXHRcdFx0bS5iZWZvcmUgPSB2aWV3Lm1ldHJpY3NbdGhpcy5kaXJQcm9wKFwibWFyZ2luTGVmdFwiLCBcIm1hcmdpblRvcFwiKV07XG5cdFx0XHRtLm91dGVyICs9IG0uYmVmb3JlO1xuXHRcdFx0bS5vdXRlciArPSB2aWV3Lm1ldHJpY3NbdGhpcy5kaXJQcm9wKFwibWFyZ2luUmlnaHRcIiwgXCJtYXJnaW5Cb3R0b21cIildO1xuXHRcdFx0bS5pbm5lciA9IHZpZXcubWV0cmljcy5jb250ZW50W3RoaXMuZGlyUHJvcChcIndpZHRoXCIsIFwiaGVpZ2h0XCIpXTtcblx0XHRcdG0uYmVmb3JlICs9IHZpZXcubWV0cmljcy5jb250ZW50W3RoaXMuZGlyUHJvcChcInhcIiwgXCJ5XCIpXTtcblx0XHRcdG0uYWZ0ZXIgPSBtLm91dGVyIC0gKG0uaW5uZXIgKyBtLmJlZm9yZSk7XG5cblx0XHRcdC8vIHZhciBtYXJnaW5CZWZvcmUgPSB2aWV3Lm1ldHJpY3NbdGhpcy5kaXJQcm9wKFwibWFyZ2luTGVmdFwiLFwibWFyZ2luVG9wXCIpXTtcblx0XHRcdC8vIHZhciBtYXJnaW5BZnRlciA9IHZpZXcubWV0cmljc1t0aGlzLmRpclByb3AoXCJtYXJnaW5SaWdodFwiLFwibWFyZ2luQm90dG9tXCIpXTtcblx0XHRcdC8vIHZhciBwb3MgPSB2aWV3Lm1ldHJpY3MuY29udGVudFt0aGlzLmRpclByb3AoXCJ4XCIsXCJ5XCIpXTtcblx0XHRcdC8vXG5cdFx0XHQvLyBtLmlubmVyID0gdmlldy5tZXRyaWNzLmNvbnRlbnRbdGhpcy5kaXJQcm9wKFwid2lkdGhcIixcImhlaWdodFwiKV07XG5cdFx0XHQvLyBtLmJlZm9yZSA9IG1hcmdpbkJlZm9yZSArIHBvcztcblx0XHRcdC8vIG0ub3V0ZXIgKz0gbWFyZ2luQmVmb3JlICsgbWFyZ2luQWZ0ZXI7XG5cdFx0XHQvLyBtLmFmdGVyID0gbS5vdXRlciAtIChtLmlubmVyICsgbS5iZWZvcmUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyB0aHJvdyBuZXcgRXJyb3IoXCJyZW5kZXJlciBoYXMgbm8gbWV0cmljc1wiKTtcblx0XHRcdGNvbnNvbGUud2FybihcIiVzOjptZWFzdXJlSXRlbVZpZXcgdmlldyAnJXMnIGhhcyBubyBtZXRyaWNzXCIsIHRoaXMuY2lkLCB2aWV3LmNpZCk7XG5cdFx0XHRtLmlubmVyID0gbS5vdXRlcjtcblx0XHRcdG0uYWZ0ZXIgPSBtLmJlZm9yZSA9IDA7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG07XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0Lyogc2Nyb2xsaW5nIHByb3BlcnR5XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9kZWx0YTogMCxcblxuXHRfc2Nyb2xsaW5nOiBmYWxzZSxcblxuXHRfc2V0U2Nyb2xsaW5nOiBmdW5jdGlvbihzY3JvbGxpbmcpIHtcblx0XHQvLyBjb25zb2xlLndhcm4oXCJfc2V0U2Nyb2xsaW5nIGN1cnJlbnQvcmVxdWVzdGVkXCIsIHRoaXMuX3Njcm9sbGluZywgc2Nyb2xsaW5nKTtcblx0XHRpZiAodGhpcy5fc2Nyb2xsaW5nICE9IHNjcm9sbGluZykge1xuXHRcdFx0dGhpcy5fc2Nyb2xsaW5nID0gc2Nyb2xsaW5nO1xuXHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwic2Nyb2xsaW5nXCIsIHNjcm9sbGluZyk7XG5cdFx0XHR0aGlzLnRyaWdnZXIoc2Nyb2xsaW5nID8gXCJ2aWV3OnNjcm9sbHN0YXJ0XCIgOiBcInZpZXc6c2Nyb2xsZW5kXCIpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBTY3JvbGwvbGF5b3V0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHNjcm9sbEJ5OiBmdW5jdGlvbihkZWx0YSwgc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0dGhpcy5fZGVsdGEgPSBkZWx0YSB8fCAwO1xuXHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gISFza2lwVHJhbnNpdGlvbnM7XG5cdFx0Ly8gdGhpcy5pbnZhbGlkYXRlTGF5b3V0KCk7XG5cdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHR9LFxuXG5cdF9zY3JvbGxCeTogZnVuY3Rpb24oZGVsdGEsIHNraXBUcmFuc2l0aW9ucykge1xuXHRcdHZhciBzTWV0cmljcywgbWV0cmljcywgcG9zO1xuXG5cdFx0c01ldHJpY3MgPSB0aGlzLm1ldHJpY3NbKHRoaXMuX3Njcm9sbENhbmRpZGF0ZVZpZXcgfHwgdGhpcy5fc2VsZWN0ZWRWaWV3KS5jaWRdO1xuXHRcdHRoaXMuaXRlbVZpZXdzLmVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0bWV0cmljcyA9IHRoaXMubWV0cmljc1t2aWV3LmNpZF07XG5cdFx0XHRwb3MgPSBNYXRoLmZsb29yKHRoaXMuX2dldFNjcm9sbE9mZnNldChkZWx0YSwgbWV0cmljcywgc01ldHJpY3MpKTtcblx0XHRcdHZpZXcubWV0cmljcy50cmFuc2xhdGVYID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyBwb3MgOiAwO1xuXHRcdFx0dmlldy5tZXRyaWNzLnRyYW5zbGF0ZVkgPSAodGhpcy5kaXJlY3Rpb24gJiBIT1JJWk9OVEFMKSA/IDAgOiBwb3M7XG5cdFx0XHR2aWV3Lm1ldHJpY3MuX3RyYW5zZm9ybSA9IHRyYW5zbGF0ZVRlbXBsYXRlKHZpZXcubWV0cmljcy50cmFuc2xhdGVYLCB2aWV3Lm1ldHJpY3MudHJhbnNsYXRlWSk7XG5cdFx0XHR2aWV3LmVsLnN0eWxlW3RyYW5zZm9ybVByb3BlcnR5XSA9IHZpZXcubWV0cmljcy5fdHJhbnNmb3JtO1xuXHRcdFx0Ly8gdmlldy5lbC5zdHlsZVt0cmFuc2Zvcm1Qcm9wZXJ0eV0gPSAodGhpcy5kaXJlY3Rpb24gJiBIT1JJWk9OVEFMKT9cblx0XHRcdC8vIFx0XCJ0cmFuc2xhdGUzZChcIiArIHBvcyArIFwicHgsMCwwKVwiOlxuXHRcdFx0Ly8gXHRcInRyYW5zbGF0ZTNkKDAsXCIgKyBwb3MgKyBcInB4LDApXCI7XG5cdFx0fSwgdGhpcyk7XG5cblx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJza2lwLXRyYW5zaXRpb25zXCIsIHNraXBUcmFuc2l0aW9ucyk7XG5cdFx0dGhpcy5zZWxlY3RGcm9tVmlldygpO1xuXHR9LFxuXG5cdF9nZXRTY3JvbGxPZmZzZXQ6IGZ1bmN0aW9uKGRlbHRhLCBtQ3VyciwgbVNlbCkge1xuXHRcdHZhciBwb3MsIG9mZnNldCA9IDA7XG5cblx0XHRwb3MgPSBtQ3Vyci5wb3MgLSBtU2VsLnBvcyArIGRlbHRhO1xuXHRcdGlmIChwb3MgPCAwKSB7XG5cdFx0XHRpZiAoTWF0aC5hYnMocG9zKSA8IG1TZWwub3V0ZXIpIHtcblx0XHRcdFx0b2Zmc2V0ICs9ICgtbUN1cnIuYWZ0ZXIpIC8gbVNlbC5vdXRlciAqIHBvcztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG9mZnNldCArPSBtQ3Vyci5hZnRlcjtcblx0XHRcdH1cblx0XHR9IGVsc2Vcblx0XHRpZiAoMCA8PSBwb3MpIHtcblx0XHRcdGlmIChNYXRoLmFicyhwb3MpIDwgbVNlbC5vdXRlcikge1xuXHRcdFx0XHRvZmZzZXQgLT0gbUN1cnIuYmVmb3JlIC8gbVNlbC5vdXRlciAqIHBvcztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG9mZnNldCAtPSBtQ3Vyci5iZWZvcmU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBwb3MgKyBvZmZzZXQ7XG5cdH0sXG5cblx0X29uU2Nyb2xsVHJhbnNpdGlvbkVuZDogZnVuY3Rpb24oZXYpIHtcblx0XHRpZiAoZXYucHJvcGVydHlOYW1lID09PSB0cmFuc2Zvcm1TdHlsZU5hbWUgJiYgdGhpcy5zY3JvbGxpbmcpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vblNjcm9sbFRyYW5zaXRpb25FbmQgc2VsZWN0ZWQ6ICVzXCIsIHRoaXMuY2lkLCBldi50YXJnZXQuY2lkKTtcblx0XHRcdHRoaXMuX3NldFNjcm9sbGluZyhmYWxzZSk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHRvZ2dsZSB0b3VjaCBldmVudHNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X3RvZ2dsZVRvdWNoRXZlbnRzOiBmdW5jdGlvbihlbmFibGUpIHtcblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpfdG9nZ2xlVG91Y2hFdmVudHNcIiwgdGhpcy5jaWQsIGVuYWJsZSk7XG5cdFx0aWYgKHRoaXMuX3RvdWNoRXZlbnRzRW5hYmxlZCAhPT0gZW5hYmxlKSB7XG5cdFx0XHR0aGlzLl90b3VjaEV2ZW50c0VuYWJsZWQgPSBlbmFibGU7XG5cdFx0XHRpZiAoZW5hYmxlKSB7XG5cdFx0XHRcdHRoaXMudG91Y2gub24oXCJocGFuc3RhcnQgaHBhbm1vdmUgaHBhbmVuZCBocGFuY2FuY2VsIHRhcFwiLCB0aGlzLl9vblRvdWNoRXZlbnQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy50b3VjaC5vZmYoXCJocGFuc3RhcnQgaHBhbm1vdmUgaHBhbmVuZCBocGFuY2FuY2VsIHRhcFwiLCB0aGlzLl9vblRvdWNoRXZlbnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRfb25Ub3VjaEV2ZW50OiBmdW5jdGlvbihldikge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol9vblRvdWNoRXZlbnRcIiwgdGhpcy5jaWQsIGV2LnR5cGUpO1xuXHRcdHN3aXRjaCAoZXYudHlwZSkge1xuXHRcdFx0Y2FzZSBcInRhcFwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fb25UYXAoZXYpO1xuXHRcdFx0Y2FzZSBcImhwYW5zdGFydFwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fb25QYW5TdGFydChldik7XG5cdFx0XHRjYXNlIFwiaHBhbm1vdmVcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMuX29uUGFuTW92ZShldik7XG5cdFx0XHRjYXNlIFwiaHBhbmVuZFwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fb25QYW5GaW5hbChldik7XG5cdFx0XHRjYXNlIFwiaHBhbmNhbmNlbFwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fb25QYW5GaW5hbChldik7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHRvdWNoIGV2ZW50OiBwYW5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gX3BhbkNhcHR1cmVkT2Zmc2V0OiAwLFxuXG5cdC8qKiBAcGFyYW0ge09iamVjdH0gZXYgKi9cblx0X29uUGFuU3RhcnQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy5zZWxlY3RGcm9tVmlldygpO1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcInBhbm5pbmdcIik7XG5cdFx0dGhpcy5fc2V0U2Nyb2xsaW5nKHRydWUpO1xuXHR9LFxuXG5cdC8qKiBAcGFyYW0ge09iamVjdH0gZXYgKi9cblx0X29uUGFuTW92ZTogZnVuY3Rpb24oZXYpIHtcblx0XHR2YXIgdmlldyA9IHRoaXMuZ2V0Vmlld0F0UGFuRGlyKGV2Lm9mZnNldERpcmVjdGlvbik7XG5cdFx0dmFyIGRlbHRhID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyBldi50aHJlc2hvbGREZWx0YVggOiBldi50aHJlc2hvbGREZWx0YVk7XG5cdFx0Ly8gdmFyIGRlbHRhID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyBldi5kZWx0YVggOiBldi5kZWx0YVk7XG5cblx0XHRpZiAodGhpcy5fcGFuQ2FuZGlkYXRlVmlldyAhPT0gdmlldykge1xuXHRcdFx0dGhpcy5fcGFuQ2FuZGlkYXRlVmlldyAmJiB0aGlzLl9wYW5DYW5kaWRhdGVWaWV3LmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjYW5kaWRhdGVcIik7XG5cdFx0XHR0aGlzLl9wYW5DYW5kaWRhdGVWaWV3ID0gdmlldztcblx0XHRcdHRoaXMuX3BhbkNhbmRpZGF0ZVZpZXcgJiYgdGhpcy5fcGFuQ2FuZGlkYXRlVmlldy5lbC5jbGFzc0xpc3QuYWRkKFwiY2FuZGlkYXRlXCIpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fcGFuQ2FuZGlkYXRlVmlldyA9PT0gdm9pZCAwKSB7XG5cdFx0XHRkZWx0YSAqPSBHbG9iYWxzLkhQQU5fT1VUX0RSQUc7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX3JlbmRlclJhZklkICE9PSAtMSkge1xuXHRcdFx0dGhpcy5zY3JvbGxCeShkZWx0YSwgQ2Fyb3VzZWwuSU1NRURJQVRFKTtcblx0XHRcdHRoaXMucmVuZGVyTm93KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX3Njcm9sbEJ5KGRlbHRhLCBDYXJvdXNlbC5JTU1FRElBVEUpO1xuXHRcdH1cblx0fSxcblxuXHQvKiogQHBhcmFtIHtPYmplY3R9IGV2ICovXG5cdF9vblBhbkZpbmFsOiBmdW5jdGlvbihldikge1xuXHRcdHZhciBzY3JvbGxDYW5kaWRhdGU7XG5cdFx0Ly8gTk9URTogdGhpcyBkZWx0YSBpcyB1c2VkIGZvciBkZXRlcm1pbmluZyBzZWxlY3Rpb24sIE5PVCBmb3IgbGF5b3V0XG5cdFx0dmFyIGRlbHRhID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyBldi50aHJlc2hvbGREZWx0YVggOiBldi50aHJlc2hvbGREZWx0YVk7XG5cdFx0Ly8gdmFyIGRlbHRhID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyBldi5kZWx0YVggOiBldi5kZWx0YVk7XG5cblx0XHRpZiAoKGV2LnR5cGUgPT0gXCJocGFuZW5kXCIpXG5cdFx0XHQvKiBwYW4gZGlyZWN0aW9uIChjdXJyZW50IGV2ZW50KSBhbmQgb2Zmc2V0RGlyZWN0aW9uICh3aG9sZSBnZXN0dXJlKSBtdXN0IG1hdGNoICovXG5cdFx0XHQmJiAoZXYuZGlyZWN0aW9uIF4gZXYub2Zmc2V0RGlyZWN0aW9uIF4gdGhpcy5kaXJlY3Rpb24pXG5cdFx0XHQvLyAmJiAoZXYuZGlyZWN0aW9uICYgZXYub2Zmc2V0RGlyZWN0aW9uICYgdGhpcy5kaXJlY3Rpb24pXG5cdFx0XHQvKiBnZXN0dXJlIG11c3Qgb3ZlcnNob290IHNlbGVjdFRocmVzaG9sZCAqL1xuXHRcdFx0JiYgKE1hdGguYWJzKGRlbHRhKSA+IHRoaXMuc2VsZWN0VGhyZXNob2xkKSkge1xuXHRcdFx0LyogY2hvb3NlIG5leHQgc2Nyb2xsIHRhcmdldCAqL1xuXHRcdFx0c2Nyb2xsQ2FuZGlkYXRlID0gdGhpcy5nZXRWaWV3QXRQYW5EaXIoZXYub2Zmc2V0RGlyZWN0aW9uKTtcblx0XHR9XG5cdFx0dGhpcy5fc2Nyb2xsQ2FuZGlkYXRlVmlldyA9IHNjcm9sbENhbmRpZGF0ZSB8fCB2b2lkIDA7XG5cblx0XHRpZiAodGhpcy5fcGFuQ2FuZGlkYXRlVmlldyAmJiAodGhpcy5fcGFuQ2FuZGlkYXRlVmlldyAhPT0gc2Nyb2xsQ2FuZGlkYXRlKSkge1xuXHRcdFx0dGhpcy5fcGFuQ2FuZGlkYXRlVmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FuZGlkYXRlXCIpO1xuXHRcdH1cblx0XHR0aGlzLl9wYW5DYW5kaWRhdGVWaWV3ID0gdm9pZCAwO1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcInBhbm5pbmdcIik7XG5cblx0XHR0aGlzLnNjcm9sbEJ5KDAsIENhcm91c2VsLkFOSU1BVEVEKTtcblx0XHR0aGlzLnNlbGVjdEZyb21WaWV3KCk7XG5cblx0XHQvLyBpZiAodGhpcy5fcmVuZGVyUmFmSWQgIT09IC0xKSB7XG5cdFx0Ly8gXHR0aGlzLnNjcm9sbEJ5KDAsIENhcm91c2VsLkFOSU1BVEVEKTtcblx0XHQvLyBcdHRoaXMucmVuZGVyTm93KCk7XG5cdFx0Ly8gfSBlbHNlIHtcblx0XHQvLyBcdHRoaXMuX3Njcm9sbEJ5KDAsIENhcm91c2VsLkFOSU1BVEVEKTtcblx0XHQvLyB9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogdG91Y2ggZXZlbnQ6IHRhcFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRnZXRWaWV3QXRQYW5EaXI6IGZ1bmN0aW9uKGRpcikge1xuXHRcdC8vIHJldHVybiAoZGlyICYgdGhpcy5fcHJlY2VkaW5nRGlyKSA/IHRoaXMuX3ByZWNlZGluZ1ZpZXcgOiB0aGlzLl9mb2xsb3dpbmdWaWV3O1xuXHRcdHJldHVybiAoZGlyICYgdGhpcy5fZm9sbG93aW5nRGlyKSA/IHRoaXMuX3ByZWNlZGluZ1ZpZXcgOiB0aGlzLl9mb2xsb3dpbmdWaWV3O1xuXHR9LFxuXG5cdC8qKiBAdHlwZSB7aW50fSBJbiBwaXhlbHMgKi9cblx0X3RhcEdyb3c6IDEwLFxuXG5cdGdldFZpZXdBdFRhcFBvczogZnVuY3Rpb24ocG9zLCBwb3NBY3Jvc3MpIHtcblx0XHRpZiAodGhpcy5fdGFwQWNyb3NzQmVmb3JlIDwgcG9zQWNyb3NzICYmIHBvc0Fjcm9zcyA8IHRoaXMuX3RhcEFjcm9zc0FmdGVyKSB7XG5cdFx0XHRpZiAocG9zIDwgdGhpcy5fdGFwQmVmb3JlKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9wcmVjZWRpbmdWaWV3O1xuXHRcdFx0fSBlbHNlIGlmIChwb3MgPiB0aGlzLl90YXBBZnRlcikge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZm9sbG93aW5nVmlldztcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHZvaWQgMDtcblx0fSxcblxuXHRfb25UYXA6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dmFyIHRhcmdldFZpZXcgPSBWaWV3LmZpbmRCeURlc2NlbmRhbnQoZXYudGFyZ2V0KTtcblx0XHQvLyBpZiAoIXRoaXMuaXRlbVZpZXdzLmNvbnRhaW5zKHRhcmdldFZpZXcpKSB7XG5cdFx0Ly8gXHRyZXR1cm47XG5cdFx0Ly8gfVxuXHRcdGRvIHtcblx0XHRcdGlmICh0aGlzLl9zZWxlY3RlZFZpZXcgPT09IHRhcmdldFZpZXcpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlcyB0YXAgb2N1cnJlZCBvbiBzZWxlY3RlZDogJW9cIiwgdGhpcy5jaWQsIHRhcmdldFZpZXcpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMgPT09IHRhcmdldFZpZXcpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlcyB0YXAgb2N1cnJlZCBvbiBjYXJvdXNlbDogJW9cIiwgdGhpcy5jaWQsIHRhcmdldFZpZXcpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9IHdoaWxlICgodGFyZ2V0VmlldyA9IHRhcmdldFZpZXcucGFyZW50VmlldykpXG5cblx0XHQvLyB0aGlzLnNlbGVjdEZyb21WaWV3KCk7XG5cblx0XHR2YXIgYm91bmRzID0gdGhpcy5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHR2YXIgdGFwWCA9IGV2LmNlbnRlci54IC0gYm91bmRzLmxlZnQ7XG5cdFx0dmFyIHRhcFkgPSBldi5jZW50ZXIueSAtIGJvdW5kcy50b3A7XG5cdFx0dmFyIHRhcENhbmRpZGF0ZSA9IHRoaXMuZ2V0Vmlld0F0VGFwUG9zKFxuXHRcdFx0dGhpcy5kaXJQcm9wKHRhcFgsIHRhcFkpLFxuXHRcdFx0dGhpcy5kaXJQcm9wKHRhcFksIHRhcFgpXG5cdFx0KTtcblxuXHRcdGlmICh0YXBDYW5kaWRhdGUpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vblRhcCAlb1wiLCB0aGlzLmNpZCwgZXYpO1xuXHRcdFx0ZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdC8vIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0XHQvLyB0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3ID0gdGFwQ2FuZGlkYXRlO1xuXHRcdFx0Ly8gdGhpcy5fc2V0U2Nyb2xsaW5nKHRydWUpO1xuXHRcdFx0Ly8gdGhpcy5zY3JvbGxCeSgwLCBDYXJvdXNlbC5BTklNQVRFRCk7XG5cdFx0XHQvLyB0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3LmVsLmNsYXNzTGlzdC5hZGQoXCJjYW5kaWRhdGVcIik7XG5cdFx0XHQvLyB0aGlzLnNlbGVjdEZyb21WaWV3KCk7XG5cblx0XHRcdC8vLy8gTk9UIHVzaW5nIGludGVybmFsU2VsZWN0aW9uXG5cdFx0XHQvLyB0aGlzLnRyaWdnZXJTZWxlY3Rpb25FdmVudHModGFwQ2FuZGlkYXRlLCBmYWxzZSk7XG5cblx0XHRcdC8vIHVzaW5nIGludGVybmFsU2VsZWN0aW9uXG5cdFx0XHR0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3ID0gdGFwQ2FuZGlkYXRlO1xuXHRcdFx0dGhpcy5fc2V0U2Nyb2xsaW5nKHRydWUpO1xuXHRcdFx0dGhpcy5zY3JvbGxCeSgwLCBDYXJvdXNlbC5BTklNQVRFRCk7XG5cblx0XHRcdHRoaXMudHJpZ2dlclNlbGVjdGlvbkV2ZW50cyh0YXBDYW5kaWRhdGUsIHRydWUpO1xuXHRcdFx0Ly8gdGhpcy5yZW5kZXJOb3coKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogUHJpdmF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHR0cmlnZ2VyU2VsZWN0aW9uRXZlbnRzOiBmdW5jdGlvbih2aWV3LCBpbnRlcm5hbCkge1xuXHRcdGlmICh2aWV3ID09PSB2b2lkIDAgfHwgdGhpcy5faW50ZXJuYWxTZWxlY3Rpb24pIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLl9pbnRlcm5hbFNlbGVjdGlvbiA9ICEhaW50ZXJuYWw7XG5cdFx0aWYgKHZpZXcgPT09IHRoaXMuZW1wdHlWaWV3KSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpub25lXCIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpvbmVcIiwgdmlldy5tb2RlbCk7XG5cdFx0fVxuXHRcdHRoaXMuX2ludGVybmFsU2VsZWN0aW9uID0gZmFsc2U7XG5cdH0sXG5cblx0c2VsZWN0RnJvbVZpZXc6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3ID09PSB2b2lkIDApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dmFyIHZpZXcgPSB0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3O1xuXHRcdHRoaXMuX3Njcm9sbENhbmRpZGF0ZVZpZXcgPSB2b2lkIDA7XG5cdFx0dmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FuZGlkYXRlXCIpO1xuXG5cdFx0dGhpcy50cmlnZ2VyU2VsZWN0aW9uRXZlbnRzKHZpZXcsIHRydWUpO1xuXHR9LFxuXG5cdGFkanVzdFRvU2VsZWN0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgbSwgaSA9IHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZEluZGV4O1xuXHRcdC8vIGFzc3VtZSAtMSA8IGluZGV4IDwgdGhpcy5jb2xsZWN0aW9uLmxlbmd0aFxuXHRcdGlmICh0aGlzLnJlcXVpcmVTZWxlY3Rpb24pIHtcblx0XHRcdChpID09IC0xKSAmJiBpKys7IC8vIGlmIHNlbGVjdGlvbiBpcyBudWxsIChpbmRleCAtMSksIHNldCBfc2VsZWN0ZWRWaWV3IHRvIGZpcnN0IGl0ZW0gKGluZGV4IDApXG5cdFx0XHR0aGlzLl9zZWxlY3RlZFZpZXcgPSAobSA9IHRoaXMuY29sbGVjdGlvbi5hdChpKSkgJiYgdGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwobSk7XG5cdFx0XHR0aGlzLl9wcmVjZWRpbmdWaWV3ID0gKG0gPSB0aGlzLmNvbGxlY3Rpb24uYXQoaSAtIDEpKSAmJiB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChtKTtcblx0XHRcdHRoaXMuX2ZvbGxvd2luZ1ZpZXcgPSAobSA9IHRoaXMuY29sbGVjdGlvbi5hdChpICsgMSkpICYmIHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKG0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9zZWxlY3RlZFZpZXcgPSAobSA9IHRoaXMuY29sbGVjdGlvbi5hdChpKSkgPyB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChtKSA6IHRoaXMuZW1wdHlWaWV3O1xuXHRcdFx0dGhpcy5fcHJlY2VkaW5nVmlldyA9IG0gJiYgKChtID0gdGhpcy5jb2xsZWN0aW9uLmF0KGkgLSAxKSkgPyB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChtKSA6IHRoaXMuZW1wdHlWaWV3KTtcblx0XHRcdHRoaXMuX2ZvbGxvd2luZ1ZpZXcgPSAobSA9IHRoaXMuY29sbGVjdGlvbi5hdChpICsgMSkpICYmIHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKG0pO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBNb2RlbCBsaXN0ZW5lcnNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBwcml2YXRlICovXG5cdF9vblNlbGVjdE9uZTogZnVuY3Rpb24obW9kZWwpIHtcblx0XHRpZiAobW9kZWwgPT09IHRoaXMuX3NlbGVjdGVkVmlldy5tb2RlbCkge1xuXHRcdFx0Ly8gY29uc29sZS5pbmZvKFwiSU5URVJOQUxcIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHRoaXMuX29uU2VsZWN0QW55KG1vZGVsKTtcblx0fSxcblxuXHQvKiogQHByaXZhdGUgKi9cblx0X29uU2VsZWN0Tm9uZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCh0aGlzLnJlcXVpcmVTZWxlY3Rpb24gPyB0aGlzLml0ZW1WaWV3cy5maXJzdCgpIDogdGhpcy5lbXB0eVZpZXcpID09PSB0aGlzLl9zZWxlY3RlZFZpZXcpIHtcblx0XHRcdC8vIGNvbnNvbGUuaW5mbyhcIklOVEVSTkFMXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLl9vblNlbGVjdEFueSgpO1xuXHR9LFxuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRfb25TZWxlY3RBbnk6IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0dGhpcy5fc2VsZWN0ZWRWaWV3LmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJzZWxlY3RlZFwiKTtcblx0XHR0aGlzLmFkanVzdFRvU2VsZWN0aW9uKCk7XG5cdFx0dGhpcy5fc2VsZWN0ZWRWaWV3LmVsLmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZFwiKTtcblxuXHRcdGlmICghdGhpcy5faW50ZXJuYWxTZWxlY3Rpb24pIHtcblx0XHRcdHRoaXMuX3NldFNjcm9sbGluZyh0cnVlKTtcblx0XHRcdHRoaXMuc2Nyb2xsQnkoMCwgQ2Fyb3VzZWwuQU5JTUFURUQpO1xuXHRcdH1cblx0fSxcblxuXHQvLyBfb25EZXNlbGVjdEFueTogZnVuY3Rpb24gKG1vZGVsKSB7fSxcblxuXHQvKiogQHByaXZhdGUgKi9cblx0X29uUmVzZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHRoaXMuX2NyZWF0ZUNoaWxkcmVuKCk7XG5cdFx0Ly8gdGhpcy5pbnZhbGlkYXRlQ2hpbGRyZW4oKTtcblx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5DSElMRFJFTl9JTlZBTElEIHwgVmlldy5NT0RFTF9JTlZBTElEKTtcblx0fSxcblxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFRFTVBcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gX3Njcm9sbEJ5MjogZnVuY3Rpb24gKGRlbHRhLCBza2lwVHJhbnNpdGlvbnMpIHtcblx0Ly8gXHR2YXIgbWV0cmljcywgcG9zO1xuXHQvLyBcdHZhciBzTWV0cmljcyA9IHRoaXMubWV0cmljc1sodGhpcy5fc2Nyb2xsQ2FuZGlkYXRlVmlldyB8fCB0aGlzLl9zZWxlY3RlZFZpZXcpLmNpZF07XG5cdC8vIFx0dmFyIGNNZXRyaWNzID0gdGhpcy5tZXRyaWNzWyh0aGlzLl9wYW5DYW5kaWRhdGVWaWV3IHx8IHRoaXMuX3NlbGVjdGVkVmlldykuY2lkXTtcblx0Ly9cblx0Ly8gXHR0aGlzLml0ZW1WaWV3cy5lYWNoKGZ1bmN0aW9uICh2aWV3KSB7XG5cdC8vIFx0XHRtZXRyaWNzID0gdGhpcy5tZXRyaWNzW3ZpZXcuY2lkXTtcblx0Ly8gXHRcdHBvcyA9IE1hdGguZmxvb3IodGhpcy5fZ2V0U2Nyb2xsT2Zmc2V0KGRlbHRhLCBtZXRyaWNzLCBzTWV0cmljcywgY01ldHJpY3MpKTtcblx0Ly8gXHRcdHZpZXcuZWwuc3R5bGVbdHJhbnNmb3JtUHJvcGVydHldID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCk/XG5cdC8vIFx0XHRcdFx0XCJ0cmFuc2xhdGUzZChcIiArIHBvcyArIFwicHgsMCwwKVwiIDogXCJ0cmFuc2xhdGUzZCgwLFwiICsgcG9zICsgXCJweCwwKVwiO1xuXHQvLyBcdFx0XHRcdC8vIFwidHJhbnNsYXRlKFwiICsgcG9zICsgXCJweCwwKVwiIDogXCJ0cmFuc2xhdGUoMCxcIiArIHBvcyArIFwicHgpXCI7XG5cdC8vIFx0XHRcdFx0Ly8gXCJ0cmFuc2xhdGVYKFwiICsgcG9zICsgXCJweClcIiA6IFwidHJhbnNsYXRlWShcIiArIHBvcyArIFwicHgpXCI7XG5cdC8vIFx0fSwgdGhpcyk7XG5cdC8vIFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwic2tpcC10cmFuc2l0aW9uc1wiLCBza2lwVHJhbnNpdGlvbnMpO1xuXHQvLyBcdHRoaXMuc2VsZWN0RnJvbVZpZXcoKTtcblx0Ly8gfSxcblxuXHQvLyBfZ2V0U2Nyb2xsT2Zmc2V0MjogZnVuY3Rpb24gKGRlbHRhLCBtQ3VyciwgbVNlbCwgbUNhbikge1xuXHQvLyBcdHZhciBvZmZzZXQgPSAwO1xuXHQvLyBcdHZhciBwb3NJbm5lciA9IG1DdXJyLnBvc0lubmVyIC0gbVNlbC5wb3NJbm5lciArIGRlbHRhO1xuXHQvL1xuXHQvLyBcdGlmIChwb3NJbm5lciA8IC1tU2VsLmlubmVyKSB7XG5cdC8vIFx0XHRvZmZzZXQgPSAtKG1DdXJyLmJlZm9yZSk7XG5cdC8vIFx0fSBlbHNlIGlmIChwb3NJbm5lciA+IG1TZWwuaW5uZXIpIHtcblx0Ly8gXHRcdG9mZnNldCA9IChtU2VsLmFmdGVyKTtcblx0Ly8gXHR9IGVsc2Uge1xuXHQvLyBcdFx0aWYgKHBvc0lubmVyIDwgMCkge1xuXHQvLyBcdFx0XHRvZmZzZXQgPSAobUN1cnIuYmVmb3JlKSAvIChtQ3Vyci5pbm5lcikgKiBwb3NJbm5lcjtcblx0Ly8gXHRcdH0gZWxzZSB7XG5cdC8vIFx0XHRcdG9mZnNldCA9IChtU2VsLmFmdGVyKSAvIChtQ2FuLmlubmVyKSAqIHBvc0lubmVyO1xuXHQvLyBcdFx0fVxuXHQvLyBcdH1cblx0Ly8gXHRyZXR1cm4gcG9zSW5uZXIgKyBvZmZzZXQ7XG5cdC8vIH0sXG5cblx0Ly8gY2FwdHVyZVNlbGVjdGVkT2Zmc2V0OiBmdW5jdGlvbigpIHtcblx0Ly8gXHR2YXIgdmFsLCB2aWV3LCBjc3N2YWwsIG0sIG1tO1xuXHQvL1xuXHQvLyBcdHZhbCA9IDA7XG5cdC8vIFx0dmlldyA9IHRoaXMuX3Njcm9sbENhbmRpZGF0ZVZpZXcgfHwgdGhpcy5fc2VsZWN0ZWRWaWV3O1xuXHQvLyBcdGNzc3ZhbCA9IGdldENvbXB1dGVkU3R5bGUodmlldy5lbClbdHJhbnNmb3JtUHJvcGVydHldO1xuXHQvL1xuXHQvLyBcdG1tID0gY3NzdmFsLm1hdGNoKC8obWF0cml4fG1hdHJpeDNkKVxcKChbXlxcKV0rKVxcKS8pO1xuXHQvLyBcdGlmIChtbSkge1xuXHQvLyBcdFx0bSA9IG1tWzJdLnNwbGl0KFwiLFwiKTtcblx0Ly8gXHRcdGlmICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpIHtcblx0Ly8gXHRcdFx0dmFsID0gbVttbVsxXT09XCJtYXRyaXhcIj8gNCA6IDEyXTtcblx0Ly8gXHRcdH0gZWxzZSB7XG5cdC8vIFx0XHRcdHZhbCA9IG1bbW1bMV09PVwibWF0cml4XCI/IDUgOiAxM107XG5cdC8vIFx0XHR9XG5cdC8vIFx0XHR2YWwgPSBwYXJzZUZsb2F0KHZhbCk7XG5cdC8vIFx0fVxuXHQvL1xuXHQvLyBcdGNvbnNvbGUubG9nKFwiJXM6OmNhcHR1cmVTZWxlY3RlZE9mZnNldFwiLCB0aGlzLmNpZCwgY3NzdmFsLCB2YWwsIGNzc3ZhbC5tYXRjaCgvbWF0cml4XFwoKD86XFxkXFwsKXszfShcXGQpXFwsKFxcZCl8bWF0cml4M2RcXCgoPzpcXGRcXCwpezExfShcXGQpXFwsKFxcZCkvKSk7XG5cdC8vXG5cdC8vIFx0cmV0dXJuIHZhbDtcblx0Ly8gfSxcblxuXHQvLyBfb25TY3JvbGxFbmQ6IGZ1bmN0aW9uKGV4ZWMpIHtcblx0Ly8gXHR0aGlzLl9zY3JvbGxFbmRDYW5jZWxsYWJsZSA9IHZvaWQgMDtcblx0Ly8gXHQvLyB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJkaXNhYmxlZC1jaGFuZ2luZ1wiKTtcblx0Ly8gXHRpZiAoZXhlYykge1xuXHQvLyBcdFx0dGhpcy5fc2V0U2Nyb2xsaW5nKGZhbHNlKTtcblx0Ly8gXHRcdC8vIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcInNjcm9sbGluZ1wiKTtcblx0Ly8gXHRcdC8vIHRoaXMudHJpZ2dlcihcInZpZXc6c2Nyb2xsZW5kXCIpO1xuXHQvLyBcdFx0Y29uc29sZS5sb2coXCIlczo6X29uU2Nyb2xsRW5kXCIsIHRoaXMuY2lkKTtcblx0Ly8gXHR9XG5cdC8vIH0sXG5cdC8vIF9vbk1vdXNlRG93bjogZnVuY3Rpb24oZXYpIHtcblx0Ly8gXHRpZiAodGhpcy5fc2Nyb2xsaW5nKSB7XG5cdC8vIFx0XHR0aGlzLl9wYW5DYXB0dXJlZE9mZnNldCA9IHRoaXMuY2FwdHVyZVNlbGVjdGVkT2Zmc2V0KCk7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhcIiVzOjpldmVudHNbbW91c2Vkb3duXSBzY3JvbGxpbmcgaW50ZXJydXB0ZWQgKHBvcyAlZilcIiwgdGhpcy5jaWQsIHRoaXMuX3BhbkNhcHR1cmVkT2Zmc2V0KTtcblx0Ly8gXHR9XG5cdC8vIH0sXG5cdC8vIF9vbk1vdXNlVXA6ZnVuY3Rpb24oZXYpIHtcblx0Ly8gXHR0aGlzLl9wYW5DYXB0dXJlZE9mZnNldCA9IDA7XG5cdC8vIH0sXG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ2Fyb3VzZWwgPSBWaWV3LmV4dGVuZChDYXJvdXNlbFByb3RvLCBDYXJvdXNlbCk7IiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcImNvbXBpbGVyXCI6WzcsXCI+PSA0LjAuMFwiXSxcIm1haW5cIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBoZWxwZXI7XG5cbiAgcmV0dXJuIGNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuaWQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmlkIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGhlbHBlcnMuaGVscGVyTWlzc2luZyksKHR5cGVvZiBoZWxwZXIgPT09IFwiZnVuY3Rpb25cIiA/IGhlbHBlci5jYWxsKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge30se1wibmFtZVwiOlwiaWRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSk7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9jb21wb25lbnQvQ29sbGVjdGlvblN0YWNrXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuXG4vKiogQHR5cGUge3N0cmluZ30gKi9cbnZhciB2aWV3VGVtcGxhdGUgPSByZXF1aXJlKFwiLi9Db2xsZWN0aW9uU3RhY2suaGJzXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvY29tcG9uZW50L0NvbGxlY3Rpb25TdGFja31cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjaWRQcmVmaXg6IFwic3RhY2tcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0YWdOYW1lOiBcImRpdlwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJzdGFja1wiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRlbXBsYXRlOiB2aWV3VGVtcGxhdGUsXG5cblx0ZXZlbnRzOiB7XG5cdFx0XCJ0cmFuc2l0aW9uZW5kXCI6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp0cmFuc2l0aW9uZW5kIFtpbnZhbGlkOiAlc10gW3RyYW5zaXRpb246ICVzXVwiLCB0aGlzLmNpZCwgdGhpcy5fY29udGVudEludmFsaWQsICh0aGlzLl9za2lwVHJhbnNpdGlvbnM/IFwic2tpcFwiOiBcInJ1blwiKSwgZXYudGFyZ2V0LmlkLCBldi50YXJnZXQuY2xhc3NOYW1lKTtcblx0XHRcdHRoaXMuX3JlbmRlckNvbnRlbnQoKTtcblx0XHR9XG5cdH0sXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHRoaXMuX2VuYWJsZWQgPSB0cnVlO1xuXHRcdHRoaXMuX3NraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdFx0dGhpcy5fY29udGVudEludmFsaWQgPSB0cnVlO1xuXG5cdFx0b3B0aW9ucy50ZW1wbGF0ZSAmJiAodGhpcy50ZW1wbGF0ZSA9IG9wdGlvbnMudGVtcGxhdGUpO1xuXHRcdHRoaXMuY29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdFx0dGhpcy5jb250ZW50LmNsYXNzTmFtZSA9IFwic3RhY2staXRlbVwiO1xuXHRcdHRoaXMuZWwuYXBwZW5kQ2hpbGQodGhpcy5jb250ZW50KTtcblxuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCBcInNlbGVjdDpvbmUgc2VsZWN0Om5vbmVcIiwgdGhpcy5fb25TZWxlY3RDaGFuZ2UpO1xuXHR9LFxuXG5cdHNldEVuYWJsZWQ6IGZ1bmN0aW9uKGVuYWJsZWQpIHtcblx0XHRpZiAodGhpcy5fZW5hYmxlZCAhPT0gZW5hYmxlZCkge1xuXHRcdFx0dGhpcy5fZW5hYmxlZCA9IGVuYWJsZWQ7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJkaXNhYmxlZFwiLCAhdGhpcy5fZW5hYmxlZCk7XG5cdFx0fVxuXHR9LFxuXG5cdF9vblNlbGVjdENoYW5nZTogZnVuY3Rpb24oaXRlbSkge1xuXHRcdGlmICh0aGlzLl9yZW5kZXJlZEl0ZW0gPT09IHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZCkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiY2hhbmdlIGV2ZW50IHJlY2VpdmVkIGJ1dCBpdGVtIGlzIGlkZW50aWNhbFwiKTtcblx0XHR9XG5cdFx0dGhpcy5fcmVuZGVyZWRJdGVtID0gdGhpcy5jb2xsZWN0aW9uLnNlbGVjdGVkO1xuXG5cdFx0dGhpcy5fY29udGVudEludmFsaWQgPSB0cnVlO1xuXHRcdHRoaXMucmVuZGVyKCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcmVuZGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX3NraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0Ly8gZXhlY3V0ZSBldmVuIGlmIGNvbnRlbnQgaGFzIG5vdCBjaGFuZ2VkIHRvIGFwcGx5IHN0eWxlcyBpbW1lZGlhdGVseVxuXHRcdFx0dGhpcy5fc2tpcFRyYW5zaXRpb25zID0gZmFsc2U7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5hZGQoXCJza2lwLXRyYW5zaXRpb25zXCIpO1xuXHRcdFx0dGhpcy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcInNraXAtdHJhbnNpdGlvbnNcIik7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gcmVuZGVyIGNoYW5nZWQgY29udGVudCBpbW1lZGlhdGVseVxuXHRcdFx0aWYgKHRoaXMuX2NvbnRlbnRJbnZhbGlkKSB7XG5cdFx0XHRcdHRoaXMuX3JlbmRlckNvbnRlbnQoKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gZWxzZSByZW1vdmUgJ2N1cnJlbnQnIGNsYXNzIGFuZCByZW5kZXIgb24gdHJhbnNpdGlvbmVuZFxuXHRcdFx0aWYgKHRoaXMuX2NvbnRlbnRJbnZhbGlkKSB7XG5cdFx0XHRcdHRoaXMuY29udGVudC5jbGFzc0xpc3QucmVtb3ZlKFwiY3VycmVudFwiKTtcblx0XHRcdFx0Ly8gdGhpcy5jb250ZW50LmNsYXNzTmFtZSA9IFwic3RhY2staXRlbVwiO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfcmVuZGVyQ29udGVudDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX2NvbnRlbnRJbnZhbGlkKSB7XG5cdFx0XHR0aGlzLl9jb250ZW50SW52YWxpZCA9IGZhbHNlO1xuXHRcdFx0dmFyIGl0ZW0gPSB0aGlzLmNvbGxlY3Rpb24uc2VsZWN0ZWQ7XG5cdFx0XHR0aGlzLmNvbnRlbnQuaW5uZXJIVE1MID0gaXRlbSA/IHRoaXMudGVtcGxhdGUoaXRlbS50b0pTT04oKSkgOiBcIlwiO1xuXHRcdFx0dGhpcy5jb250ZW50LmNsYXNzTGlzdC5hZGQoXCJjdXJyZW50XCIpO1xuXHRcdFx0Ly8gdGhpcy5jb250ZW50LmNsYXNzTmFtZSA9IFwic3RhY2staXRlbSBjdXJyZW50XCI7XG5cdFx0fVxuXHR9LFxufSk7IiwiLyoqXG4vKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9GaWx0ZXJhYmxlTGlzdFZpZXdcbi8qL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmUuYmFieXNpdHRlcn0gKi9cbnZhciBDb250YWluZXIgPSByZXF1aXJlKFwiYmFja2JvbmUuYmFieXNpdHRlclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0NsaWNrYWJsZVJlbmRlcmVyfSAqL1xudmFyIENsaWNrYWJsZVJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9DbGlja2FibGVSZW5kZXJlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkUHJvcGVydHl9ICovXG52YXIgcHJlZml4ZWRQcm9wZXJ0eSA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFByb3BlcnR5XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXN9ICovXG52YXIgZ2V0Qm94RWRnZVN0eWxlcyA9IHJlcXVpcmUoXCJ1dGlscy9jc3MvZ2V0Qm94RWRnZVN0eWxlc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL2FycmF5L2RpZmZlcmVuY2V9ICovXG52YXIgZGlmZiA9IHJlcXVpcmUoXCJ1dGlscy9hcnJheS9kaWZmZXJlbmNlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJvbWlzZS9yZXNvbHZlQWxsfSAqL1xudmFyIHJlc29sdmVBbGwgPSByZXF1aXJlKFwidXRpbHMvcHJvbWlzZS9yZXNvbHZlQWxsXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJvbWlzZS9yZWplY3RBbGx9ICovXG52YXIgcmVqZWN0QWxsID0gcmVxdWlyZShcInV0aWxzL3Byb21pc2UvcmVqZWN0QWxsXCIpO1xuXG4vLyB2YXIgcmVzb2x2ZUFsbCA9IGZ1bmN0aW9uKHBwLCByZXN1bHQpIHtcbi8vIFx0aWYgKHBwLmxlbmd0aCAhPSAwKSB7XG4vLyBcdFx0cHAuZm9yRWFjaChmdW5jdGlvbihwLCBpLCBhKSB7XG4vLyBcdFx0XHRwLnJlc29sdmUocmVzdWx0KTtcbi8vIFx0XHRcdGFbaV0gPSBudWxsO1xuLy8gXHRcdH0pO1xuLy8gXHRcdHBwLmxlbmd0aCA9IDA7XG4vLyBcdH1cbi8vIFx0cmV0dXJuIHBwO1xuLy8gfTtcblxuLy8gdmFyIHJlamVjdEFsbCA9IGZ1bmN0aW9uKHBwLCByZWFzb24pIHtcbi8vIFx0aWYgKHBwLmxlbmd0aCAhPSAwKSB7XG4vLyBcdFx0cHAuZm9yRWFjaChmdW5jdGlvbihwLCBpLCBhKSB7XG4vLyBcdFx0XHRwLnJlamVjdChyZWFzb24pO1xuLy8gXHRcdFx0YVtpXSA9IG51bGw7XG4vLyBcdFx0fSk7XG4vLyBcdFx0cHAubGVuZ3RoID0gMDtcbi8vIFx0fVxuLy8gXHRyZXR1cm4gcHA7XG4vLyB9O1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzLlRSQU5TTEFURV9URU1QTEFURX0gKi9cbnZhciB0cmFuc2xhdGVDc3NWYWx1ZSA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpLlRSQU5TTEFURV9URU1QTEFURTtcblxuLyoqIEBjb25zdCAqL1xudmFyIHRyYW5zZm9ybVByb3AgPSBwcmVmaXhlZFByb3BlcnR5KFwidHJhbnNmb3JtXCIpO1xuXG4vKipcbi8qIEBjb25zdHJ1Y3RvclxuLyogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvRmlsdGVyYWJsZUxpc3RWaWV3fVxuLyovXG52YXIgRmlsdGVyYWJsZUxpc3RWaWV3ID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwiZmlsdGVyYWJsZUxpc3RcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0YWdOYW1lOiBcInVsXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImxpc3Qgc2VsZWN0YWJsZSBmaWx0ZXJhYmxlXCIsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdGNvbGxhcHNlZDogdHJ1ZSxcblx0XHRmaWx0ZXJGbjogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9LFxuXHRcdHJlbmRlcmVyOiBDbGlja2FibGVSZW5kZXJlci5leHRlbmQoe1xuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0Y2lkUHJlZml4OiBcImxpc3RJdGVtXCIsXG5cdFx0fSksXG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0Y29sbGFwc2VkOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY29sbGFwc2VkO1xuXHRcdFx0fSxcblx0XHRcdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0dGhpcy5fc2V0Q29sbGFwc2VkKHZhbHVlKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHNlbGVjdGVkSXRlbToge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3NlbGVjdGVkSXRlbTtcblx0XHRcdH0sXG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHRoaXMuX3NldFNlbGVjdGlvbih2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRmaWx0ZXJlZEl0ZW1zOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZmlsdGVyZWRJdGVtcztcblx0XHRcdH1cblx0XHR9LFxuXHRcdG1ldHJpY3M6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9tZXRyaWNzO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGV2ZW50czoge1xuXHRcdFwidHJhbnNpdGlvbmVuZCAubGlzdC1pdGVtXCI6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRpZiAodGhpcy5fY29sbGFwc2VkQ2hhbmdpbmcgJiYgZXYucHJvcGVydHlOYW1lID09PSBcInZpc2liaWxpdHlcIiAvKiYmIHRoaXMuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwiLmNvbGxhcHNlZC1jaGFuZ2luZ1wiKSovICkge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpldmVudHNbdHJhbnNpdGlvbmVuZCAubGlzdC1pdGVtXSBjb2xsYXBzZWQtY2hhbmdpbmcgZW5kIChyZXNvbHZpbmcgJXMgcHJvbWlzZXMpXCIsIHRoaXMuY2lkLCB0aGlzLl9jb2xsYXBzZVByb21pc2VzLmxlbmd0aCk7XG5cblx0XHRcdFx0dGhpcy5fY29sbGFwc2VkQ2hhbmdpbmcgPSBmYWxzZTtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY29sbGFwc2VkLWNoYW5naW5nXCIpO1xuXHRcdFx0XHRyZXNvbHZlQWxsKHRoaXMuX2NvbGxhcHNlUHJvbWlzZXMsIHRoaXMpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dGhpcy5fZmlsdGVyZWRJdGVtcyA9IFtdO1xuXHRcdHRoaXMuX2ZpbHRlcmVkSW5jb21pbmcgPSBbXTtcblx0XHR0aGlzLl9maWx0ZXJlZE91dGdvaW5nID0gW107XG5cblx0XHR0aGlzLl9tZXRyaWNzID0ge307XG5cdFx0dGhpcy5faXRlbU1ldHJpY3MgPSBbXTtcblx0XHR0aGlzLl9jb2xsYXBzZVByb21pc2VzID0gW107XG5cdFx0dGhpcy5pdGVtVmlld3MgPSBuZXcgQ29udGFpbmVyKCk7XG5cblx0XHRfLmRlZmF1bHRzKG9wdGlvbnMsIHRoaXMuZGVmYXVsdHMpO1xuXHRcdHRoaXMucmVuZGVyZXIgPSBvcHRpb25zLnJlbmRlcmVyO1xuXHRcdHRoaXMuX2ZpbHRlckZuID0gb3B0aW9ucy5maWx0ZXJGbjtcblxuXHRcdC8vIHRoaXMuY29tcHV0ZUZpbHRlcigpO1xuXHRcdC8vIHRoaXMuY29sbGVjdGlvbi5lYWNoKHRoaXMuY3JlYXRlSXRlbVZpZXcsIHRoaXMpO1xuXG5cdFx0dGhpcy5jb2xsZWN0aW9uLmVhY2godGhpcy5jcmVhdGVJdGVtVmlldywgdGhpcyk7XG5cdFx0dGhpcy5fc2V0U2VsZWN0aW9uKHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZCk7XG5cdFx0dGhpcy5fc2V0Q29sbGFwc2VkKG9wdGlvbnMuY29sbGFwc2VkKTtcblx0XHR0aGlzLnJlZnJlc2hGaWx0ZXIoKTtcblx0XHQvLyB0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdFx0Ly8gdGhpcy5yZW5kZXJOb3coKTtcblxuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCBcInNlbGVjdDpvbmUgc2VsZWN0Om5vbmVcIiwgdGhpcy5fc2V0U2VsZWN0aW9uKTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwgXCJyZXNldFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuX2FsbEl0ZW1zID0gbnVsbDtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIm5vdCBpbXBsZW1lbnRlZFwiKTtcblx0XHR9KTtcblxuXHRcdC8vIHdpbGwgdHJpZ2dlciBvbiByZXR1cm4gaWYgdGhpcy5lbCBpcyBhbHJlYWR5IGF0dGFjaGVkXG5cdFx0Ly8gdGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHRcdC8vIHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcInNraXAtdHJhbnNpdGlvbnNcIik7XG5cdFx0Ly8gdGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuQUxMX0lOVkFMSUQpO1xuXG5cdFx0Y29uc29sZS5sb2coXCIlczo6aW5pdGlhbGl6ZSBhdHRhY2hlZDogJW9cIiwgdGhpcy5jaWQsIHRoaXMuYXR0YWNoZWQpO1xuXG5cdFx0dGhpcy5vbmNlKFwidmlldzphdHRhY2hlZFwiLCBmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOjppbml0aWFsaXplIC0+IFt2aWV3OmF0dGFjaGVkXSBhdHRhY2hlZDogJW9cIiwgdmlldy5jaWQsIHZpZXcuYXR0YWNoZWQpO1xuXHRcdFx0Ly8gdmlldy5yZXF1ZXN0UmVuZGVyKFZpZXcuQUxMX0lOVkFMSUQpLnJlbmRlck5vdygpO1xuXHRcdFx0dmlldy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHRcdFx0dmlldy5lbC5jbGFzc0xpc3QuYWRkKFwic2tpcC10cmFuc2l0aW9uc1wiKTtcblx0XHRcdHZpZXcuc2V0SW1tZWRpYXRlKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyB0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdFx0XHRcdHZpZXcucmVuZGVyTm93KCk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fSxcblxuXHQvKipcblx0ICogR2V0IGFuIGFycmF5IHdpdGggYSBjb2xsZWN0aW9uIGNvbnRlbnNcblx0ICogQHByaXZhdGVcblx0ICovXG5cdF9nZXRBbGxJdGVtczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX2FsbEl0ZW1zIHx8ICh0aGlzLl9hbGxJdGVtcyA9IHRoaXMuY29sbGVjdGlvbi5zbGljZSgpKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBUcmFuc2l0aW9uIHByb21pc2VzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF93aGVuQ29sbGFwc2VDaGFuZ2VFbmRzOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fY29sbGFwc2VkQ2hhbmdlZCkge1xuXHRcdFx0dmFyIHZpZXcgPSB0aGlzO1xuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0XHR2aWV3Lm9uKFwidmlldzpyZW5kZXI6YWZ0ZXJcIiwgcmVzb2x2ZSk7XG5cdFx0XHR9KVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMpO1xuXHRcdH1cblx0fSxcblxuXHR3aGVuQ29sbGFwc2VDaGFuZ2VFbmRzOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZCwgcCwgcHA7XG5cdFx0aWYgKHRoaXMuX2NvbGxhcHNlZENoYW5naW5nIHx8IHRoaXMuX2NvbGxhcHNlZENoYW5nZWQpIHtcblx0XHRcdGQgPSB7fTtcblx0XHRcdHAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdFx0ZC5yZXNvbHZlID0gcmVzb2x2ZTtcblx0XHRcdFx0ZC5yZWplY3QgPSByZWplY3Q7XG5cdFx0XHR9KTtcblx0XHRcdHBwID0gdGhpcy5fY29sbGFwc2VQcm9taXNlcztcblx0XHRcdHBwLnB1c2goZCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHAgPSBQcm9taXNlLnJlc29sdmUodGhpcyk7XG5cdFx0fVxuXHRcdHJldHVybiBwO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlckZyYW1lOiBmdW5jdGlvbih0c3RhbXAsIGZsYWdzKSB7XG5cdFx0Ly8gaWYgKERFQlVHKSB7XG5cdFx0Ly8gXHR2YXIgY2hhbmdlZCA9IFtdO1xuXHRcdC8vIFx0dGhpcy5fY29sbGFwc2VkQ2hhbmdlZCAmJiBjaGFuZ2VkLnB1c2goXCJjb2xsYXBzZWRcIik7XG5cdFx0Ly8gXHR0aGlzLl9zZWxlY3Rpb25DaGFuZ2VkICYmIGNoYW5nZWQucHVzaChcInNlbGVjdGlvblwiKTtcblx0XHQvLyBcdHRoaXMuX2ZpbHRlckNoYW5nZWQgJiYgY2hhbmdlZC5wdXNoKFwiZmlsdGVyXCIpO1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCIlczo6cmVuZGVyRnJhbWUgWyVzXVwiLCB0aGlzLmNpZCwgY2hhbmdlZC5qb2luKFwiIFwiKSk7XG5cdFx0Ly8gfVxuXG5cdFx0Ly8gY29sbGFwc2VkIHRyYW5zaXRpb24gZmxhZ1xuXHRcdGlmICh0aGlzLl9jb2xsYXBzZWRDaGFuZ2luZykge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiJXM6OnJlbmRlckZyYW1lIGNvbGxhcHNlZCB0eCBpbnRlcnJ1cHRlZFwiLCB0aGlzLmNpZCk7XG5cdFx0XHR0aGlzLl9jb2xsYXBzZWRDaGFuZ2luZyA9IGZhbHNlO1xuXHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY29sbGFwc2VkLWNoYW5naW5nXCIpO1xuXHRcdFx0cmVqZWN0QWxsKHRoaXMuX2NvbGxhcHNlUHJvbWlzZXMsIHRoaXMpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcInNraXAtdHJhbnNpdGlvbnNcIik7XG5cdFx0XHQvLyB0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuc2V0SW1tZWRpYXRlKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJza2lwLXRyYW5zaXRpb25zXCIpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX2NvbGxhcHNlZENoYW5nZWQpIHtcblx0XHRcdHRoaXMuX2NvbGxhcHNlZENoYW5nZWQgPSBmYWxzZTtcblx0XHRcdGZsYWdzIHw9IFZpZXcuU0laRV9JTlZBTElEO1xuXHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY29sbGFwc2VkXCIsIHRoaXMuX2NvbGxhcHNlZCk7XG5cblx0XHRcdGlmICh0aGlzLnNraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0XHR0aGlzLl9jb2xsYXBzZWRDaGFuZ2luZyA9IGZhbHNlO1xuXHRcdFx0XHQvLyByZXNvbHZlQWxsKHRoaXMuX2NvbGxhcHNlUHJvbWlzZXMsIHRoaXMuZWwpO1xuXHRcdFx0XHR0aGlzLm9uY2UoXCJ2aWV3OnJlbmRlcjphZnRlclwiLCBmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdFx0cmVzb2x2ZUFsbCh2aWV3Ll9jb2xsYXBzZVByb21pc2VzLCB2aWV3KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLl9jb2xsYXBzZWRDaGFuZ2luZyA9IHRydWU7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcImNvbGxhcHNlZC1jaGFuZ2luZ1wiKTtcblx0XHRcdFx0Ly8gdGhpcyB3aWxsIGJlIHJlc29sdmVkIG9uIHRyYW5zaXRpb25lbmRcblx0XHRcdH1cblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6W2NvbGxhcHNlIGNoYW5nZWRdICVzIHByb21pc2VzXCIsIHRoaXMuY2lkLFxuXHRcdFx0XHR0aGlzLl9jb2xsYXBzZVByb21pc2VzLmxlbmd0aCxcblx0XHRcdFx0dGhpcy5fY29sbGFwc2VkQ2hhbmdpbmcgP1xuXHRcdFx0XHRcInJlc29sdmluZyBub3dcIiA6XG5cdFx0XHRcdFwicmVzb2x2aW5nIG9uIHRyYW5zaXRpdGlvbmVuZFwiXG5cdFx0XHQpO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLl9zZWxlY3Rpb25DaGFuZ2VkKSB7XG5cdFx0XHR0aGlzLl9zZWxlY3Rpb25DaGFuZ2VkID0gZmFsc2U7XG5cdFx0XHRmbGFncyB8PSBWaWV3LkxBWU9VVF9JTlZBTElEO1xuXHRcdFx0dGhpcy5yZW5kZXJTZWxlY3Rpb24odGhpcy5jb2xsZWN0aW9uLnNlbGVjdGVkLCB0aGlzLmNvbGxlY3Rpb24ubGFzdFNlbGVjdGVkKTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5fZmlsdGVyQ2hhbmdlZCkge1xuXHRcdFx0dGhpcy5fZmlsdGVyQ2hhbmdlZCA9IGZhbHNlO1xuXHRcdFx0ZmxhZ3MgfD0gVmlldy5MQVlPVVRfSU5WQUxJRDtcblx0XHRcdHZhciBsYXN0RmlsdGVyZWRJdGVtcyA9IHRoaXMuZmlsdGVyZWRJdGVtcztcblx0XHRcdC8vIHRoaXMuX3ByaW50U3RhdHMobGFzdEZpbHRlcmVkSXRlbXMpO1xuXHRcdFx0dGhpcy5jb21wdXRlRmlsdGVyKCk7XG5cdFx0XHR0aGlzLmFwcGx5RmlsdGVyKCk7XG5cdFx0XHR0aGlzLl9wcmludFN0YXRzKGxhc3RGaWx0ZXJlZEl0ZW1zKTtcblx0XHR9XG5cblx0XHRpZiAoZmxhZ3MgJiBWaWV3LlNJWkVfSU5WQUxJRCkge1xuXHRcdFx0dGhpcy5tZWFzdXJlKCk7IC8vIE5PVEU6IG1lYXN1cmVzIGNoaWxkcmVuXG5cdFx0fVxuXG5cdFx0aWYgKGZsYWdzICYgKFZpZXcuTEFZT1VUX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRCkpIHtcblx0XHRcdHRoaXMucmVuZGVyTGF5b3V0KCk7XG5cdFx0fVxuXHR9LFxuXG5cdG1lYXN1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHZhciBpLCBpaSwgZWwsIGVscywgbSwgbW07XG5cdFx0Ly8gZWxzID0gdGhpcy5lbC5jaGlsZHJlbjtcblx0XHQvLyBpaSA9IGVscy5sZW5ndGg7XG5cdFx0Ly8gbW0gPSB0aGlzLl9pdGVtTWV0cmljcztcblx0XHQvLyBmb3IgKGkgPSAwOyBpIDwgaWk7IGkrKykge1xuXHRcdC8vIFx0bW1baV0gPSBfLnBpY2soZWxzW2ldLCBcIm9mZnNldFRvcFwiLCBcIm9mZnNldEhlaWdodFwiKTtcblx0XHQvLyB9XG5cblx0XHR0aGlzLl9tZXRyaWNzID0gZ2V0Qm94RWRnZVN0eWxlcyh0aGlzLmVsLCB0aGlzLl9tZXRyaWNzKTtcblxuXHRcdC8vIHZhciBpdGVtRWwsIGl0ZW1WaWV3LCBiYXNlbGluZSA9IDA7XG5cdFx0Ly8gaWYgKGl0ZW1FbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5saXN0LWl0ZW06bm90KC5leGNsdWRlZCkgLmxhYmVsXCIpKSB7XG5cdFx0Ly8gXHQvLyBpdGVtVmlldyA9IHRoaXMuaXRlbVZpZXdzLmZpbmRCeUNpZChpdGVtRWwuY2lkKTtcblx0XHQvLyBcdHZhciBlbEEgPSBpdGVtRWwsIGVsQiA9IGl0ZW1FbC5wYXJlbnRFbGVtZW50O1xuXHRcdC8vIFx0dmFyIHlBID0gZWxBLm9mZnNldFRvcCxcblx0XHQvLyBcdFx0aEEgPSBlbEEub2Zmc2V0SGVpZ2h0LFxuXHRcdC8vIFx0XHR5QiA9IGVsQi5vZmZzZXRUb3AsXG5cdFx0Ly8gXHRcdGhCID0gZWxCLm9mZnNldEhlaWdodDtcblx0XHQvLyBcdGJhc2VsaW5lID0gKCh5QSArIGhBKSAtICh5QiArIGhCKSk7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhcIiVzOjptZWFzdXJlIGZvbnRTaXplOiAlc3B4ICglcyslcyktKCVzKyVzKT0lc1wiLCB0aGlzLmNpZCwgdGhpcy5fbWV0cmljcy5mb250U2l6ZSxcblx0XHQvLyBcdFx0eUEsIGhBLCB5QiwgaEIsIGJhc2VsaW5lXG5cdFx0Ly8gXHQpO1xuXHRcdC8vIH1cblxuXHRcdHRoaXMuaXRlbVZpZXdzLmZvckVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0aWYgKCF2aWV3Ll9tZXRyaWNzKSB2aWV3Ll9tZXRyaWNzID0ge307XG5cdFx0XHQvLyB2aWV3Ll9tZXRyaWNzLmJhc2VsaW5lID0gdGhpcy5fbWV0cmljcy5mb250U2l6ZSAtIGJhc2VsaW5lO1xuXHRcdFx0dmlldy5fbWV0cmljcy5vZmZzZXRUb3AgPSB2aWV3LmVsLm9mZnNldFRvcDtcblx0XHRcdHZpZXcuX21ldHJpY3Mub2Zmc2V0SGVpZ2h0ID0gdmlldy5lbC5vZmZzZXRIZWlnaHQ7XG5cdFx0XHR2aWV3Ll9tZXRyaWNzLm9mZnNldExlZnQgPSB2aWV3LmVsLm9mZnNldExlZnQ7XG5cdFx0XHR2aWV3Ll9tZXRyaWNzLm9mZnNldFdpZHRoID0gdmlldy5lbC5vZmZzZXRXaWR0aDtcblx0XHRcdGlmICghdGhpcy5fY29sbGFwc2VkICYmIHZpZXcubGFiZWwpIHtcblx0XHRcdFx0dmlldy5fbWV0cmljcy50ZXh0TGVmdCA9IHZpZXcubGFiZWwub2Zmc2V0TGVmdDtcblx0XHRcdFx0dmlldy5fbWV0cmljcy50ZXh0V2lkdGggPSB2aWV3LmxhYmVsLm9mZnNldFdpZHRoO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmlldy5fbWV0cmljcy50ZXh0TGVmdCA9IHZpZXcuX21ldHJpY3Mub2Zmc2V0TGVmdDtcblx0XHRcdFx0dmlldy5fbWV0cmljcy50ZXh0V2lkdGggPSB2aWV3Ll9tZXRyaWNzLm9mZnNldFdpZHRoO1xuXHRcdFx0fVxuXHRcdH0sIHRoaXMpO1xuXG5cdFx0Ly8gdGhpcy5fbWV0cmljcy5iYXNlbGluZSA9IHRoaXMuX21ldHJpY3MuZm9udFNpemUgLSBiYXNlbGluZTtcblx0fSxcblxuXHRyZW5kZXJMYXlvdXQ6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBwb3NYLCBwb3NZO1xuXHRcdHBvc1ggPSB0aGlzLl9tZXRyaWNzLnBhZGRpbmdMZWZ0O1xuXHRcdHBvc1kgPSB0aGlzLl9tZXRyaWNzLnBhZGRpbmdUb3A7XG5cblx0XHQvLyB1c2UgSFRNTEVsZW1lbnQuY2hpbGRyZW4gdG8ga2VlcCBsYXlvdXQgb3JkZXJcblx0XHRmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLmVsLmNoaWxkcmVuLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHZhciB2aWV3ID0gdGhpcy5pdGVtVmlld3MuZmluZEJ5Q2lkKHRoaXMuZWwuY2hpbGRyZW5baV0uY2lkKTtcblx0XHRcdGlmICgoKHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZCAmJiAhdmlldy5tb2RlbC5zZWxlY3RlZCkgfHxcblx0XHRcdFx0XHR2aWV3LmVsLmNsYXNzTGlzdC5jb250YWlucyhcImV4Y2x1ZGVkXCIpKSAmJiB0aGlzLl9jb2xsYXBzZWQpIHtcblx0XHRcdFx0dmlldy50cmFuc2Zvcm0udHggPSBwb3NYO1xuXHRcdFx0XHR2aWV3LnRyYW5zZm9ybS50eSA9IHBvc1k7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAodmlldy5fbWV0cmljcy5vZmZzZXRIZWlnaHQgPT0gMCkge1xuXHRcdFx0XHRcdHBvc1kgLT0gdmlldy5fbWV0cmljcy5vZmZzZXRUb3A7XG5cdFx0XHRcdH1cblx0XHRcdFx0dmlldy50cmFuc2Zvcm0udHggPSBwb3NYO1xuXHRcdFx0XHR2aWV3LnRyYW5zZm9ybS50eSA9IHBvc1k7XG5cdFx0XHRcdHBvc1kgKz0gdmlldy5fbWV0cmljcy5vZmZzZXRIZWlnaHQgKyB2aWV3Ll9tZXRyaWNzLm9mZnNldFRvcDtcblx0XHRcdH1cblx0XHRcdHZpZXcuZWwuc3R5bGVbdHJhbnNmb3JtUHJvcF0gPSB0cmFuc2xhdGVDc3NWYWx1ZSh2aWV3LnRyYW5zZm9ybS50eCwgdmlldy50cmFuc2Zvcm0udHkpO1xuXHRcdH1cblxuXHRcdC8vIHBvc1kgKz0gdGhpcy5fbWV0cmljcy5wYWRkaW5nQm90dG9tO1xuXHRcdHRoaXMuX21ldHJpY3MuaGVpZ2h0ID0gTWF0aC5tYXgoMCwgcG9zWSArIHRoaXMuX21ldHJpY3MucGFkZGluZ0JvdHRvbSk7XG5cdFx0dGhpcy5lbC5zdHlsZS5oZWlnaHQgPSB0aGlzLl9tZXRyaWNzLmhlaWdodCArIFwicHhcIjtcblx0XHQvLyB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IChwb3NZID4gMCkgPyBwb3NZICsgXCJweFwiIDogXCJcIjtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBDaGlsZCB2aWV3c1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQHByaXZhdGUgKi9cblx0Y3JlYXRlSXRlbVZpZXc6IGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgdGhpcy5yZW5kZXJlcih7XG5cdFx0XHRtb2RlbDogaXRlbSxcblx0XHRcdGVsOiB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIubGlzdC1pdGVtW2RhdGEtaWQ9XFxcIlwiICsgaXRlbS5pZCArIFwiXFxcIl1cIilcblx0XHR9KTtcblx0XHQvLyBpdGVtLnNldChcImV4Y2x1ZGVkXCIsIGZhbHNlLCB7IHNpbGVudDogdHJ1ZSB9KTtcblx0XHQvLyB2aWV3Lmxpc3RlblRvKGl0ZW0sIFwiY2hhbmdlOmV4Y2x1ZGVkXCIsIGZ1bmN0aW9uKGl0ZW0sIG5ld1ZhbCkge1xuXHRcdC8vIFx0Ly8gY29uc29sZS5sb2coYXJndW1lbnRzKTtcblx0XHQvLyBcdGlmICh0aGlzLmVsLmNsYXNzTGlzdC5jb250YWlucyhcImV4Y2x1ZGVkXCIpICE9PSBuZXdWYWwpIHtcblx0XHQvLyBcdFx0Y29uc29sZS53YXJuKFwiJXM6W2NoYW5nZTpleGNsdWRlZF0gbTolbyBjc3M6ICVvXCIsIHRoaXMuY2lkLCBuZXdWYWwsIHRoaXMuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZXhjbHVkZWRcIikpO1xuXHRcdC8vIFx0fVxuXHRcdC8vIFx0Ly8gdGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZXhjbHVkZWRcIiwgZXhjbHVkZWQpO1xuXHRcdC8vIH0pO1xuXHRcdHRoaXMubGlzdGVuVG8odmlldywgXCJyZW5kZXJlcjpjbGlja1wiLCB0aGlzLl9vblJlbmRlcmVyQ2xpY2spO1xuXHRcdHRoaXMuaXRlbVZpZXdzLmFkZCh2aWV3KTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvKiogQHByaXZhdGUgKi9cblx0X29uUmVuZGVyZXJDbGljazogZnVuY3Rpb24oaXRlbSwgZXYpIHtcblx0XHRpZiAodGhpcy5fY29sbGFwc2VkQ2hhbmdpbmdcblx0XHRcdHx8ICh0aGlzLl9jb2xsYXBzZWQgJiYgaXRlbS5nZXQoXCJleGNsdWRlZFwiKSkpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZCAhPT0gaXRlbSkge1xuXHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpzZWxlY3Q6b25lXCIsIGl0ZW0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoZXYuYWx0S2V5KSB7XG5cdFx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6c2VsZWN0Om5vbmVcIik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpzYW1lXCIsIGl0ZW0pO1xuXHRcdFx0fVxuXHRcdFx0Ly8gdGhpcy50cmlnZ2VyKFwidmlldzpzZWxlY3Q6bm9uZVwiKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogQ29sbGFwc2VkXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRfY29sbGFwc2VkOiB1bmRlZmluZWQsXG5cblx0LyoqXG5cdCAqIEBwYXJhbSB7Qm9vbGVhbn1cblx0ICovXG5cdF9zZXRDb2xsYXBzZWQ6IGZ1bmN0aW9uKGNvbGxhcHNlZCkge1xuXHRcdGlmIChjb2xsYXBzZWQgIT09IHRoaXMuX2NvbGxhcHNlZCkge1xuXHRcdFx0dGhpcy5fY29sbGFwc2VkID0gY29sbGFwc2VkO1xuXHRcdFx0dGhpcy5fY29sbGFwc2VkQ2hhbmdlZCA9IHRydWU7XG5cdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogU2VsZWN0aW9uXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRfc2VsZWN0ZWRJdGVtOiB1bmRlZmluZWQsXG5cblx0LyoqIEBwYXJhbSB7QmFja2JvbmUuTW9kZWx8bnVsbH0gKi9cblx0X3NldFNlbGVjdGlvbjogZnVuY3Rpb24oaXRlbSkge1xuXHRcdGlmIChpdGVtICE9PSB0aGlzLl9zZWxlY3RlZEl0ZW0pIHtcblx0XHRcdHRoaXMuX3NlbGVjdGVkSXRlbSA9IGl0ZW07XG5cdFx0XHR0aGlzLl9zZWxlY3Rpb25DaGFuZ2VkID0gdHJ1ZTtcblx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3Lk1PREVMX0lOVkFMSUQpO1xuXHRcdH1cblx0fSxcblxuXHQvKiogQHByaXZhdGUgKi9cblx0cmVuZGVyU2VsZWN0aW9uOiBmdW5jdGlvbihuZXdJdGVtLCBvbGRJdGVtKSB7XG5cdFx0dmFyIHZpZXc7XG5cdFx0aWYgKG9sZEl0ZW0pIHtcblx0XHRcdHZpZXcgPSB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChvbGRJdGVtKTtcblx0XHRcdHZpZXcuZWwuY2xhc3NMaXN0LnJlbW92ZShcInNlbGVjdGVkXCIpO1xuXHRcdFx0Ly8gdmlldy5sYWJlbC5jbGFzc0xpc3QucmVtb3ZlKFwiY29sb3ItZmdcIik7XG5cdFx0XHQvLyB2aWV3LmxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb2xvci1yZXZlcnNlXCIpO1xuXHRcdH1cblx0XHRpZiAobmV3SXRlbSkge1xuXHRcdFx0dmlldyA9IHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKG5ld0l0ZW0pO1xuXHRcdFx0dmlldy5lbC5jbGFzc0xpc3QuYWRkKFwic2VsZWN0ZWRcIik7XG5cdFx0XHQvLyB2aWV3LmxhYmVsLmNsYXNzTGlzdC5hZGQoXCJjb2xvci1mZ1wiKTtcblx0XHRcdC8vIHZpZXcubGFiZWwuY2xhc3NMaXN0LmFkZChcImNvbG9yLXJldmVyc2VcIik7XG5cdFx0fVxuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImhhcy1zZWxlY3RlZFwiLCB0aGlzLnNlbGVjdGVkSXRlbSAhPT0gbnVsbCk7XG5cdH0sXG5cblx0X3ByaW50U3RhdHM6IGZ1bmN0aW9uKGxhc3RGaWx0ZXJlZEl0ZW1zKSB7XG5cdFx0Y29uc29sZS5sb2coXCIlbzo6cmVuZGVyRnJhbWUgJXMgZmlsdGVyZWQ6JW8oPSVvKS8lbyAoY2hhbmdlZDolbywgaW46JW8sIG91dDolbylcIiwgdGhpcy5jaWQsXG5cdFx0XHR0aGlzLmZpbHRlcmVkSXRlbXMubGVuZ3RoID4gMCA/IFwiaGFzXCIgOiBcImhhcyBub3RcIixcblx0XHRcdHRoaXMuZmlsdGVyZWRJdGVtcy5sZW5ndGgsXG5cdFx0XHRsYXN0RmlsdGVyZWRJdGVtcyA/ICh0aGlzLmZpbHRlcmVkSXRlbXMubGVuZ3RoICsgdGhpcy5fZmlsdGVyZWRJbmNvbWluZy5sZW5ndGgpIC0gdGhpcy5fZmlsdGVyZWRPdXRnb2luZy5sZW5ndGggOiB0aGlzLmZpbHRlcmVkSXRlbXMubGVuZ3RoLFxuXHRcdFx0dGhpcy5jb2xsZWN0aW9uLmxlbmd0aCxcblx0XHRcdCh0aGlzLl9maWx0ZXJlZEluY29taW5nLmxlbmd0aCArIHRoaXMuX2ZpbHRlcmVkT3V0Z29pbmcubGVuZ3RoKSxcblx0XHRcdHRoaXMuX2ZpbHRlcmVkSW5jb21pbmcubGVuZ3RoLFxuXHRcdFx0dGhpcy5fZmlsdGVyZWRPdXRnb2luZy5sZW5ndGgpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIEZpbHRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZWZyZXNoRmlsdGVyOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fZmlsdGVyRm4pIHtcblx0XHRcdHRoaXMuX2ZpbHRlckNoYW5nZWQgPSB0cnVlO1xuXHRcdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuTU9ERUxfSU5WQUxJRCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIEZpbHRlciBpbXBsIDJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Y29tcHV0ZUZpbHRlcjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG5ld0l0ZW1zLCBvbGRJdGVtcztcblx0XHR2YXIgaGFzTmV3LCBoYXNPbGQ7XG5cdFx0dGhpcy5fZmlsdGVyZWRJbmNvbWluZy5sZW5ndGggPSAwO1xuXHRcdHRoaXMuX2ZpbHRlcmVkT3V0Z29pbmcubGVuZ3RoID0gMDtcblxuXHRcdG5ld0l0ZW1zID0gdGhpcy5fZmlsdGVyRm4gPyB0aGlzLmNvbGxlY3Rpb24uZmlsdGVyKHRoaXMuX2ZpbHRlckZuLCB0aGlzKSA6IHRoaXMuX2dldEFsbEl0ZW1zKCk7XG5cdFx0b2xkSXRlbXMgPSB0aGlzLl9maWx0ZXJlZEl0ZW1zO1xuXHRcdGhhc05ldyA9ICEhKG5ld0l0ZW1zICYmIG5ld0l0ZW1zLmxlbmd0aCk7XG5cdFx0aGFzT2xkID0gISEob2xkSXRlbXMgJiYgb2xkSXRlbXMubGVuZ3RoKTtcblx0XHQvLyBOT1RFOiBkaWZmIHRoaXJkIGFyZyBpcyBkZXN0aW5hdGlvbiBhcnJheVxuXHRcdGlmIChoYXNOZXcpIHtcblx0XHRcdC8vIGluY29taW5nIGV4Y2x1c2lvbnNcblx0XHRcdGRpZmYoKGhhc09sZCA/IG9sZEl0ZW1zIDogdGhpcy5fZ2V0QWxsSXRlbXMoKSksIG5ld0l0ZW1zLCB0aGlzLl9maWx0ZXJlZEluY29taW5nKTtcblx0XHRcdC8vIHRoaXMuX2ZpbHRlcmVkSW5jb21pbmcuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHQvLyBcdGl0ZW0uc2V0KFwiZXhjbHVkZWRcIiwgdHJ1ZSk7XG5cdFx0XHQvLyB9KTtcblx0XHR9XG5cdFx0aWYgKGhhc09sZCkge1xuXHRcdFx0Ly8gb3V0Z29pbmcgZXhjbHVzaW9uc1xuXHRcdFx0ZGlmZigoaGFzTmV3ID8gbmV3SXRlbXMgOiB0aGlzLl9nZXRBbGxJdGVtcygpKSwgb2xkSXRlbXMsIHRoaXMuX2ZpbHRlcmVkT3V0Z29pbmcpO1xuXHRcdFx0Ly8gdGhpcy5fZmlsdGVyZWRPdXRnb2luZy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdC8vIFx0aXRlbS5zZXQoXCJleGNsdWRlZFwiLCBmYWxzZSk7XG5cdFx0XHQvLyB9KTtcblx0XHR9XG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6cmVuZGVyRmlsdGVyRm5cIiwgdGhpcy5jaWQsIG5ld0l0ZW1zKTtcblx0XHR0aGlzLl9maWx0ZXJlZEl0ZW1zID0gbmV3SXRlbXM7XG5cdH0sXG5cblx0YXBwbHlGaWx0ZXI6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHRoaXMuaXRlbVZpZXdzLmZvckVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdC8vIFx0dmlldy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZXhjbHVkZWRcIiwgdmlldy5tb2RlbC5nZXQoXCJleGNsdWRlZFwiKSk7XG5cdFx0Ly8gfSk7XG5cdFx0dGhpcy5fZmlsdGVyZWRJbmNvbWluZy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKGl0ZW0pLmVsLmNsYXNzTGlzdC5hZGQoXCJleGNsdWRlZFwiKTtcblx0XHRcdGl0ZW0uc2V0KFwiZXhjbHVkZWRcIiwgdHJ1ZSk7XG5cdFx0fSwgdGhpcyk7XG5cdFx0dGhpcy5fZmlsdGVyZWRPdXRnb2luZy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKGl0ZW0pLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJleGNsdWRlZFwiKTtcblx0XHRcdGl0ZW0uc2V0KFwiZXhjbHVkZWRcIiwgZmFsc2UpO1xuXHRcdH0sIHRoaXMpO1xuXG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiaGFzLWV4Y2x1ZGVkXCIsIHRoaXMuZmlsdGVyZWRJdGVtcy5sZW5ndGggPiAwKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBGaWx0ZXIgaW1wbCAxXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qXG5cdGNvbXB1dGVGaWx0ZXJfMTogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGl0ZW1zID0gdGhpcy5fZmlsdGVyRm4gPyB0aGlzLmNvbGxlY3Rpb24uZmlsdGVyKHRoaXMuX2ZpbHRlckZuLCB0aGlzKSA6IHRoaXMuX2dldEFsbEl0ZW1zKCk7XG5cdFx0dGhpcy5yZW5kZXJGaWx0ZXJzKGl0ZW1zLCB0aGlzLl9maWx0ZXJlZEl0ZW1zKTtcblx0XHR0aGlzLl9maWx0ZXJlZEl0ZW1zID0gaXRlbXM7XG5cdH0sXG5cblx0cmVuZGVyRmlsdGVyczogZnVuY3Rpb24obmV3SXRlbXMsIG9sZEl0ZW1zKSB7XG5cdFx0dmFyIGhhc05ldyA9ICEhKG5ld0l0ZW1zICYmIG5ld0l0ZW1zLmxlbmd0aCk7XG5cdFx0dmFyIGhhc09sZCA9ICEhKG9sZEl0ZW1zICYmIG9sZEl0ZW1zLmxlbmd0aCk7XG5cdFx0dmFyIGluRXhjbCA9IFtdO1xuXHRcdHZhciBvdXRFeGNsID0gW107XG5cblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpyZW5kZXJGaWx0ZXJGblwiLCB0aGlzLmNpZCwgbmV3SXRlbXMpO1xuXHRcdC8vIE5PVEU6IGRpZmYgdGhpcmQgYXJnIGlzIGRlc3RpbmF0aW9uIGFycmF5XG5cdFx0aWYgKGhhc05ldykge1xuXHRcdFx0ZGlmZigoaGFzT2xkID8gb2xkSXRlbXMgOiB0aGlzLl9nZXRBbGxJdGVtcygpKSwgbmV3SXRlbXMsIGluRXhjbClcblx0XHRcdC8vIC5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdC8vIFx0dGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoaXRlbSkuZWwuY2xhc3NMaXN0LmFkZChcImV4Y2x1ZGVkXCIpO1xuXHRcdFx0Ly8gXHRpdGVtLnNldChcImV4Y2x1ZGVkXCIsIHRydWUpO1xuXHRcdFx0Ly8gfSwgdGhpcyk7XG5cdFx0fVxuXHRcdGlmIChoYXNPbGQpIHtcblx0XHRcdGRpZmYoKGhhc05ldyA/IG5ld0l0ZW1zIDogdGhpcy5fZ2V0QWxsSXRlbXMoKSksIG9sZEl0ZW1zLCBvdXRFeGNsKVxuXHRcdFx0Ly8gLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0Ly8gXHR0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChpdGVtKS5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiZXhjbHVkZWRcIik7XG5cdFx0XHQvLyBcdGl0ZW0uc2V0KFwiZXhjbHVkZWRcIiwgZmFsc2UpO1xuXHRcdFx0Ly8gfSwgdGhpcyk7XG5cdFx0fVxuXHRcdHRoaXMuX2ZpbHRlcmVkSW5jb21pbmcgPSBpbkV4Y2w7XG5cdFx0dGhpcy5fZmlsdGVyZWRPdXRnb2luZyA9IG91dEV4Y2w7XG5cdFx0Ly8gdGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiaGFzLWV4Y2x1ZGVkXCIsIGhhc05ldyk7XG5cdFx0Ly8gdGhpcy5hcHBseUZpbHRlcigpO1xuXHR9LFxuXHQqL1xuXG5cdC8vIGNvbXB1dGVGaWx0ZXJlZDogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dGhpcy5fZmlsdGVyUmVzdWx0ID0gdGhpcy5jb2xsZWN0aW9uLm1hcCh0aGlzLl9maWx0ZXJGbiwgdGhpcyk7XG5cdC8vIH0sXG5cdC8vXG5cdC8vIHJlbmRlckZpbHRlcmVkOiBmdW5jdGlvbigpIHtcblx0Ly8gXHR0aGlzLmNvbGxlY3Rpb24uZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuXHQvLyBcdFx0dGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoaXRlbSkuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImV4Y2x1ZGVkXCIsICF0aGlzLl9maWx0ZXJSZXN1bHRbaW5kZXhdKTtcblx0Ly8gXHR9LCB0aGlzKTtcblx0Ly8gfSxcblxufSk7XG5cbmlmIChERUJVRykge1xuXHRGaWx0ZXJhYmxlTGlzdFZpZXcucHJvdG90eXBlLl9sb2dGbGFncyA9IFtcblx0XHRcInZpZXcucmVuZGVyXCIsXG5cdFx0Ly8gXCJ2aWV3LnRyYWNlXCJcblx0XS5qb2luKFwiIFwiKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBGaWx0ZXJhYmxlTGlzdFZpZXc7IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9HcmFwaFZpZXdcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBDb2xvciA9IHJlcXVpcmUoXCJjb2xvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3fSAqL1xudmFyIENhbnZhc1ZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3XCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY2FudmFzL2NhbGNBcmNIQ29ubmVjdG9yfSAqL1xudmFyIGNhbGNBcmNIQ29ubmVjdG9yID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9jYWxjQXJjSENvbm5lY3RvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY2FudmFzL0NhbnZhc0hlbHBlcn0gKi9cbnZhciBDYW52YXNIZWxwZXIgPSByZXF1aXJlKFwidXRpbHMvY2FudmFzL0NhbnZhc0hlbHBlclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvZ2VvbS9pbmZsYXRlUmVjdH0gKi9cbnZhciBpbmZsYXRlUmVjdCA9IHJlcXVpcmUoXCJ1dGlscy9nZW9tL2luZmxhdGVSZWN0XCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9kb20vZ2V0QWJzb2x1dGVDbGllbnRSZWN0fSAqL1xuLy8gdmFyIGdldEFic29sdXRlQ2xpZW50UmVjdCA9IHJlcXVpcmUoXCJ1dGlscy9kb20vZ2V0QWJzb2x1dGVDbGllbnRSZWN0XCIpO1xuXG5cbi8vIHZhciBCRVpJRVJfQ0lSQ0xFID0gMC41NTE5MTUwMjQ0OTQ7XG4vLyB2YXIgTUlOX0NBTlZBU19SQVRJTyA9IDI7XG4vLyB2YXIgUEkyID0gTWF0aC5QSSAqIDI7XG5cbnZhciBzdHlsZUJhc2UgPSB7XG5cdGxpbmVDYXA6IFwiYnV0dFwiLCAvLyByb3VuZCwgYnV0dCwgc3F1YXJlXG5cdGxpbmVXaWR0aDogMC43NSxcblx0bGluZURhc2hPZmZzZXQ6IDAsXG5cdHNldExpbmVEYXNoOiBbW11dLFxuXHRyYWRpdXNCYXNlOiAwLjc1LFxuXHQvKiBmYWN0b3JlZCB0byByZW0gdW5pdCAqLyAvLzYsXG5cdHJhZGl1c0luY3JlbWVudDogMC4yMSwgLy8zLCAvLzAuMjUsXG5cdC8qIHVzZXMgbGluZVdpZHRoIG11bHRpcGxpZXIgKi9cblx0b3V0bGluZVdpZHRoOiAzLjUsXG5cdGFycm93U2l6ZTogMC4zLFxufTtcblxuLy8gdmFyIG92ZXJsYXlTdHlsZUJhc2UgPSB7XG4vLyBcdGdsb2JhbEFscGhhOiAwLjc1LFxuLy8gXHRnbG9iYWxDb21wb3NpdGVPcGVyYXRpb246IFwiZGVzdGluYXRpb24tb3V0XCIsXG4vLyBcdGxpbmVXaWR0aDogNCxcbi8vIFx0bGluZUpvaW46IFwicm91bmRcIixcbi8vIFx0dGV4dEJhc2VsaW5lOiBcInRvcFwiLFxuLy8gXHR0ZXh0QWxpZ246IFwibGVmdFwiLFxuLy8gfTtcblxuaWYgKERFQlVHKSB7XG5cdC8qIGVzbGludC1kaXNhYmxlIG5vLXVudXNlZC12YXJzICovXG5cdHZhciBfZFN0eWxlcyA9IHt9O1xuXHRfZFN0eWxlc1tcImRlZmF1bHRzXCJdID0ge1xuXHRcdGxpbmVXaWR0aDogMCxcblx0XHRmaWxsU3R5bGU6IFwidHJhbnNwYXJlbnRcIixcblx0XHRzdHJva2VTdHlsZTogXCJ0cmFuc3BhcmVudFwiLFxuXHRcdGxpbmVEYXNoT2Zmc2V0OiAwLFxuXHRcdHNldExpbmVEYXNoOiBbW11dXG5cdH07XG5cblx0LyogU3Ryb2tlICovXG5cdFtcblx0XHRcInJlZFwiLCBcInNhbG1vblwiLCBcInNpZW5uYVwiLFxuXHRcdFwiZ3JlZW5cIiwgXCJ5ZWxsb3dncmVlblwiLCBcIm9saXZlXCIsXG5cdFx0XCJibHVlXCIsIFwibGlnaHRza3libHVlXCIsIFwibWlkbmlnaHRibHVlXCIsXG5cdFx0XCJncmV5XCIsIFwic2lsdmVyXCJcblx0XVxuXHQuZm9yRWFjaChmdW5jdGlvbihjb2xvck5hbWUpIHtcblx0XHR2YXIgcmdiYVZhbHVlID0gQ29sb3IoY29sb3JOYW1lKS5hbHBoYSgwLjUpLnJnYmFTdHJpbmcoKTtcblxuXHRcdF9kU3R5bGVzW2NvbG9yTmFtZV0gPSBfLmRlZmF1bHRzKHtcblx0XHRcdGxpbmVXaWR0aDogMC43NSxcblx0XHRcdHN0cm9rZVN0eWxlOiByZ2JhVmFsdWUsXG5cdFx0fSwgX2RTdHlsZXNbXCJkZWZhdWx0c1wiXSk7XG5cblx0XHRfZFN0eWxlc1tjb2xvck5hbWUgKyBcIl90aGlja1wiXSA9IF8uZGVmYXVsdHMoe1xuXHRcdFx0bGluZVdpZHRoOiA1LFxuXHRcdFx0c3Ryb2tlU3R5bGU6IHJnYmFWYWx1ZSxcblx0XHR9LCBfZFN0eWxlc1tcImRlZmF1bHRzXCJdKTtcblxuXHRcdF9kU3R5bGVzW2NvbG9yTmFtZSArIFwiX2ZpbGxcIl0gPSBfLmRlZmF1bHRzKHtcblx0XHRcdGZpbGxTdHlsZTogcmdiYVZhbHVlXG5cdFx0fSwgX2RTdHlsZXNbXCJkZWZhdWx0c1wiXSk7XG5cdH0pXG5cdC8qIGVzbGludC1lbmFibGUgbm8tdW51c2VkLXZhcnMgKi9cbn1cblxudmFyIGdldFJlY3REaXJYID0gZnVuY3Rpb24ocjEsIHIyKSB7XG5cdGlmIChyMS5yaWdodCA8IHIyLmxlZnQpIHtcblx0XHRyZXR1cm4gMTtcblx0fVxuXHRpZiAocjIucmlnaHQgPCByMS5sZWZ0KSB7XG5cdFx0cmV0dXJuIC0xO1xuXHR9XG5cdHJldHVybiAwO1xufTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0dyYXBoVmlld31cbiAqL1xudmFyIEdyYXBoVmlldyA9IENhbnZhc1ZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcImdyYXBoXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJjYW52YXNcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwiZ3JhcGhcIixcblxuXHRkZWZhdWx0S2V5OiBcImEyYlwiLFxuXG5cdGRlZmF1bHRzOiB7XG5cdFx0dmFsdWVzOiB7XG5cdFx0XHRhMmI6IDAsXG5cdFx0XHRiMmE6IDAsXG5cdFx0fSxcblx0XHRtYXhWYWx1ZXM6IHtcblx0XHRcdGEyYjogMSxcblx0XHRcdGIyYTogMSxcblx0XHR9LFxuXHRcdC8vIHVzZU9wYXF1ZTogdHJ1ZSxcblx0XHQvLyBsYWJlbEZuOiBmdW5jdGlvbih2YWx1ZSwgbWF4KSB7XG5cdFx0Ly8gXHRyZXR1cm4gKCh2YWx1ZSAvIG1heCkgKiAxMDApIHwgMDtcblx0XHQvLyB9LFxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdENhbnZhc1ZpZXcucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdHRoaXMuX2xpc3RBID0gb3B0aW9ucy5saXN0QTtcblx0XHR0aGlzLl9saXN0QiA9IG9wdGlvbnMubGlzdEI7XG5cdFx0dGhpcy5fYTJiID0ge1xuXHRcdFx0c3JjVmlldzogb3B0aW9ucy5saXN0QSxcblx0XHRcdGRlc3RWaWV3OiBvcHRpb25zLmxpc3RCLFxuXHRcdFx0czogXy5kZWZhdWx0cyh7XG5cdFx0XHRcdGxpbmVXaWR0aDogMS4yNVxuXHRcdFx0XHQvLyByYWRpdXNJbmNyZW1lbnQ6IDAuMjUsXG5cdFx0XHR9LCBzdHlsZUJhc2UpLFxuXHRcdFx0c3Ryb2tlU3R5bGVGbjogZnVuY3Rpb24oZmcsIGJnLCBsbikge1xuXHRcdFx0XHRyZXR1cm4gQ29sb3IobG4pLm1peChiZywgMC45KS5oZXhTdHJpbmcoKTtcblx0XHRcdFx0Ly8gcmV0dXJuIENvbG9yKGZnKS5taXgoYmcsIDAuOSkuaGV4U3RyaW5nKCk7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHR0aGlzLl9iMmEgPSB7XG5cdFx0XHRzcmNWaWV3OiBvcHRpb25zLmxpc3RCLFxuXHRcdFx0ZGVzdFZpZXc6IG9wdGlvbnMubGlzdEEsXG5cdFx0XHRzOiBfLmRlZmF1bHRzKHtcblx0XHRcdFx0bGluZVdpZHRoOiAwLjcsXG5cdFx0XHRcdC8vIGFycm93U2l6ZTogMC4yNSxcblx0XHRcdFx0Ly8gcmFkaXVzSW5jcmVtZW50OiAwLFxuXHRcdFx0XHQvLyBvdXRsaW5lV2lkdGg6IDAsXG5cdFx0XHR9LCBzdHlsZUJhc2UpLFxuXHRcdFx0c3Ryb2tlU3R5bGVGbjogZnVuY3Rpb24oZmcsIGJnLCBsbikge1xuXHRcdFx0XHRyZXR1cm4gQ29sb3IoZmcpLm1peChiZywgMC42KS5oZXhTdHJpbmcoKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnJlbmRlcjpiZWZvcmVcIiwgdGhpcy5fYmVmb3JlVmlld1JlbmRlcik7XG5cblx0XHQvLyB0aGlzLl90cmFjZVNjcm9sbCA9IF8uZGVib3VuY2UodGhpcy5fX3JhY2VTY3JvbGwsIDEwMCwgZmFsc2UpO1xuXG5cdFx0Ly8gdmFyIHZpZXdwb3J0Q2hhbmdlZCA9IGZ1bmN0aW9uKGV2KSB7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhcIiVzOlslc11cIiwgdGhpcy5jaWQsIGV2LnR5cGUpO1xuXHRcdC8vXG5cdFx0Ly8gXHQvLyB0aGlzLl90cmFjZVNjcm9sbChldi50eXBlKTtcblx0XHQvLyBcdC8vIHRoaXMuX2xhYmVsT3ZlcmxheXMgPSBudWxsO1xuXHRcdC8vIFx0dGhpcy5pbnZhbGlkYXRlKENhbnZhc1ZpZXcuTEFZT1VUX0lOVkFMSUQgfCBDYW52YXNWaWV3LlNJWkVfSU5WQUxJRCk7XG5cdFx0Ly8gXHQvLyB0aGlzLnJlcXVlc3RSZW5kZXIoQ2FudmFzVmlldy5MQVlPVVRfSU5WQUxJRCB8IENhbnZhc1ZpZXcuU0laRV9JTlZBTElEKTtcblx0XHQvLyBcdC8vIHRoaXMucmVxdWVzdFJlbmRlcigpLnJlbmRlck5vdygpO1xuXHRcdC8vIH0uYmluZCh0aGlzKTtcblx0XHQvLyB2aWV3cG9ydENoYW5nZWQgPSBfLmRlYm91bmNlKHZpZXdwb3J0Q2hhbmdlZCwgNjAsIGZhbHNlKTtcblxuXHRcdC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsXG5cdFx0Ly8gXHRcdF8uZGVib3VuY2Uodmlld3BvcnRDaGFuZ2VkLCAxMDAsIGZhbHNlKSwgZmFsc2UpO1xuXHRcdC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwid2hlZWxcIixcblx0XHQvLyBcdF8uZGVib3VuY2Uodmlld3BvcnRDaGFuZ2VkLCAxMDAsIGZhbHNlKSwgZmFsc2UpO1xuXHRcdC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsIHZpZXdwb3J0Q2hhbmdlZCwgZmFsc2UpO1xuXHRcdC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwid2hlZWxcIiwgdmlld3BvcnRDaGFuZ2VkLCBmYWxzZSk7XG5cdFx0Ly8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgdmlld3BvcnRDaGFuZ2VkLCBmYWxzZSk7XG5cdFx0Ly8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJvcmllbnRhdGlvbmNoYW5nZVwiLCB2aWV3cG9ydENoYW5nZWQsIGZhbHNlKTtcblxuXHRcdC8vIHRoaXMuX2FkZExpc3RMaXN0ZW5lcnModGhpcy5fYTJiKTtcblx0XHQvLyB0aGlzLl9hZGRMaXN0TGlzdGVuZXJzKHRoaXMuX2IyYSk7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRtZWFzdXJlQ2FudmFzOiBmdW5jdGlvbih3LCBoLCBzKSB7XG5cdFx0Y29uc29sZS5sb2coXCIlczo6bWVhc3VyZUNhbnZhcyBzdHlsZTolbyBzY3JvbGw6JW8gb2Zmc2V0OiVvIGNsaWVudDolbyBhcmc6JW9cIiwgdGhpcy5jaWQsIHMuaGVpZ2h0LCB0aGlzLmVsLm9mZnNldEhlaWdodCwgdGhpcy5lbC5zY3JvbGxIZWlnaHQsIHRoaXMuZWwuY2xpZW50SGVpZ2h0LCBoKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHVwZGF0ZUNhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5fdXBkYXRlTWV0cmljcygpO1xuXHRcdHRoaXMuX3VwZGF0ZVN0eWxlcygpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHN0eWxlc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfdXBkYXRlU3R5bGVzOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgYiwgYmdDb2xvciwgbG5Db2xvcjtcblx0XHRpZiAodGhpcy5tb2RlbC5oYXMoXCJidW5kbGVcIikpIHtcblx0XHRcdGIgPSB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKTtcblx0XHRcdGxuQ29sb3IgPSBiLmNvbG9ycy5sbkNvbG9yLmNsb25lKCk7XG5cdFx0XHRiZ0NvbG9yID0gYi5jb2xvcnMuYmdDb2xvci5jbG9uZSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRiZ0NvbG9yID0gQ29sb3IoR2xvYmFscy5ERUZBVUxUX0NPTE9SU1tcImJhY2tncm91bmQtY29sb3JcIl0pO1xuXHRcdFx0bG5Db2xvciA9IENvbG9yKEdsb2JhbHMuREVGQVVMVF9DT0xPUlNbXCJsaW5rLWNvbG9yXCJdKTtcblx0XHR9XG5cblx0XHR0aGlzLl9hMmIucy5zdHJva2VTdHlsZSA9IHRoaXMuX2EyYi5zLmZpbGxTdHlsZSA9XG5cdFx0XHR0aGlzLl9hMmIuc3Ryb2tlU3R5bGVGbih0aGlzLl9jb2xvciwgYmdDb2xvciwgbG5Db2xvcik7XG5cdFx0dGhpcy5fYjJhLnMuc3Ryb2tlU3R5bGUgPSB0aGlzLl9iMmEucy5maWxsU3R5bGUgPVxuXHRcdFx0dGhpcy5fYjJhLnN0cm9rZVN0eWxlRm4odGhpcy5fY29sb3IsIGJnQ29sb3IsIGxuQ29sb3IpO1xuXG5cdFx0aWYgKERFQlVHKSB7XG5cdFx0XHR0aGlzLl9kZWJ1Z0Jsb2NrcyA9IHRoaXMuZWwubWF0Y2hlcyhcIi5kZWJ1Zy1ibG9ja3MgLlwiICsgdGhpcy5jbGFzc05hbWUpO1xuXHRcdFx0dGhpcy5fZGVidWdHcmFwaCA9IHRoaXMuZWwubWF0Y2hlcyhcIi5kZWJ1Zy1ncmFwaCAuXCIgKyB0aGlzLmNsYXNzTmFtZSk7XG5cdFx0fVxuXHR9LFxuXG5cdF9zZXRTdHlsZTogZnVuY3Rpb24ocykge1xuXHRcdGlmICh0eXBlb2YgcyA9PSBcInN0cmluZ1wiKSB7XG5cdFx0XHRzID0gdGhpcy5fc3R5bGVEYXRhW3NdO1xuXHRcdH1cblx0XHRDYW52YXNWaWV3LnNldFN0eWxlKHRoaXMuX2N0eCwgcyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogbWV0cmljc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfdXBkYXRlTWV0cmljczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGJvdW5kcztcblx0XHR2YXIgaSwgaWksIGVscztcblx0XHR2YXIgYVJlY3QsIGJSZWN0O1xuXHRcdHZhciBhTWluLCBiTWluO1xuXG5cdFx0dGhpcy5fcm9vdEZvbnRTaXplID0gcGFyc2VGbG9hdChcblx0XHRcdGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5mb250U2l6ZSk7XG5cblx0XHRib3VuZHMgPSB0aGlzLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdC8vIGJvdW5kcyA9IGdldEFic29sdXRlQ2xpZW50UmVjdCh0aGlzLmVsKTtcblx0XHR0aGlzLl9jdHguc2V0VHJhbnNmb3JtKHRoaXMuX2NhbnZhc1JhdGlvLCAwLCAwLCB0aGlzLl9jYW52YXNSYXRpbyxcblx0XHRcdCgtKGJvdW5kcy5sZWZ0ICsgd2luZG93LnNjcm9sbFgpICogdGhpcy5fY2FudmFzUmF0aW8pIC0gMC41LFxuXHRcdFx0KC0oYm91bmRzLnRvcCArIHdpbmRvdy5zY3JvbGxZKSAqIHRoaXMuX2NhbnZhc1JhdGlvKSAtIDAuNVxuXHRcdCk7XG5cblx0XHRhUmVjdCA9IHRoaXMuX2xpc3RBLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdGFNaW4gPSBhUmVjdC5sZWZ0ICsgd2luZG93LnNjcm9sbFg7XG5cdFx0ZWxzID0gdGhpcy5fbGlzdEEuZWwucXVlcnlTZWxlY3RvckFsbChcIi5sYWJlbFwiKTtcblx0XHRmb3IgKGkgPSAwLCBpaSA9IGVscy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHRhTWluID0gTWF0aC5tYXgoYU1pbixcblx0XHRcdFx0ZWxzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0ICsgd2luZG93LnNjcm9sbFgpO1xuXHRcdH1cblxuXHRcdGJSZWN0ID0gdGhpcy5fbGlzdEIuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0Yk1pbiA9IGJSZWN0LmxlZnQgKyB3aW5kb3cuc2Nyb2xsWDtcblx0XHRlbHMgPSB0aGlzLl9saXN0Qi5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLmxhYmVsXCIpO1xuXHRcdGZvciAoaSA9IDAsIGlpID0gZWxzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdGJNaW4gPSBNYXRoLm1pbihiTWluLFxuXHRcdFx0XHRlbHNbaV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdCArIHdpbmRvdy5zY3JvbGxYKTtcblx0XHR9XG5cdFx0Ly8gdGhpcy5fYjJhLmRlc3RSZWN0ID0gdGhpcy5fYTJiLnJlY3QgPSBhUmVjdDtcblx0XHR0aGlzLl9iMmEuZGVzdE1pblggPSB0aGlzLl9hMmIueE1pbiA9IGFNaW47XG5cdFx0dGhpcy5fYjJhLnF4ID0gZ2V0UmVjdERpclgoYlJlY3QsIGFSZWN0KTtcblxuXHRcdC8vIHRoaXMuX2EyYi5kZXN0UmVjdCA9IHRoaXMuX2IyYS5yZWN0ID0gYlJlY3Q7XG5cdFx0dGhpcy5fYTJiLmRlc3RNaW5YID0gdGhpcy5fYjJhLnhNaW4gPSBiTWluO1xuXHRcdHRoaXMuX2EyYi5xeCA9IGdldFJlY3REaXJYKGFSZWN0LCBiUmVjdCk7XG5cblx0XHQvLyB2YXIgcyA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KTtcblx0XHQvLyB0aGlzLl9yb290Rm9udFNpemUgPSBwYXJzZUZsb2F0KHMuZm9udFNpemUpOyAvLyAqIHRoaXMuX2NhbnZhc1JhdGlvO1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol91cGRhdGVNZXRyaWNzIF9yb290Rm9udFNpemU6ICVzICVvXCIsIHRoaXMuY2lkLCB0aGlzLl9yb290Rm9udFNpemUsIHMpO1xuXG5cdFx0Ly8gdmFyIGMgPSBNYXRoLmFicyhzRGF0YS54TWluIC0gZERhdGEueE1pbikgLyA2O1xuXHRcdC8vIHNNaW4gPSBzRGF0YS54TWluICsgYyAqIHF4O1xuXHRcdC8vIGRNaW4gPSBkRGF0YS54TWluIC0gYyAqIHF4O1xuXG5cdFx0Ly8gdGhpcy5fYTJiLnRhcmdldHMgPSB0aGlzLl9tZWFzdXJlTGlzdEl0ZW1zKGxpc3RWaWV3KTtcblx0XHQvLyB0aGlzLl9iMmEudGFyZ2V0cyA9IHRoaXMuX21lYXN1cmVMaXN0SXRlbXMobGlzdFZpZXcpO1xuXG5cdFx0Ly8gLy8gY29ubmVjdG9yIG1pbmltdW0gYnJhbmNoIHgyXG5cdFx0Ly8gbGlzdFZpZXcgPSB0aGlzLl9saXN0Qjtcblx0XHQvLyBmb3IgKGkgPSAwLCBpaSA9IGxpc3RWaWV3Lmdyb3Vwcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0Ly8gXHRpdGVtVmlldyA9IGxpc3RWaWV3Lml0ZW1WaWV3cy5maW5kQnlNb2RlbChsaXN0Vmlldy5ncm91cHNbaV0pO1xuXHRcdC8vIFx0aXRlbVJlY3QgPSAoaXRlbVZpZXcubGFiZWwgfHwgaXRlbVZpZXcuZWwpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdC8vIFx0dGhpcy5fYjJhLnhNaW4gPSBNYXRoLm1pbih0aGlzLl9iMmEueE1pbiwgaXRlbVJlY3QubGVmdCk7XG5cdFx0Ly8gXHQvLyBpZiAoaXRlbVZpZXcuX21ldHJpY3MpIHRoaXMuX2IyYS5yZWN0LmxlZnQgKyBpdGVtVmlldy50cmFuc2Zvcm0udHggKyBpdGVtVmlldy5fbWV0cmljcy50ZXh0TGVmdDtcblx0XHQvLyB9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcmVkcmF3XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9iZWZvcmVWaWV3UmVuZGVyOiBmdW5jdGlvbih2aWV3LCBmbGFncykge1xuXHRcdGlmIChmbGFncyAmIChDYW52YXNWaWV3LlNJWkVfSU5WQUxJRCB8IENhbnZhc1ZpZXcuTU9ERUxfSU5WQUxJRCkpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9iZWZvcmVWaWV3UmVuZGVyIFtmbGFnczogJXNdXCIsIHRoaXMuY2lkLCBDYW52YXNWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpKTtcblxuXHRcdFx0dGhpcy5fYTJiLnBvaW50c091dCA9IHRoaXMuX2EyYi5wb2ludHM7XG5cdFx0XHR0aGlzLl9hMmIucm9vdE91dCA9IHRoaXMuX2EyYi5yb290O1xuXHRcdFx0dGhpcy5fYjJhLnBvaW50c091dCA9IHRoaXMuX2IyYS5wb2ludHM7XG5cdFx0XHR0aGlzLl9iMmEucm9vdE91dCA9IHRoaXMuX2IyYS5yb290O1xuXG5cdFx0XHR0aGlzLl9hMmIucG9pbnRzID0gbnVsbDtcblx0XHRcdHRoaXMuX2EyYi5yb290ID0gbnVsbDtcblx0XHRcdHRoaXMuX2IyYS5wb2ludHMgPSBudWxsO1xuXHRcdFx0dGhpcy5fYjJhLnJvb3QgPSBudWxsO1xuXG5cdFx0XHR0aGlzLl9sYWJlbE92ZXJsYXlzID0gbnVsbDtcblx0XHR9XG5cdH0sXG5cblx0cmVkcmF3OiBmdW5jdGlvbihjdHgsIGludGVycG9sYXRvciwgZmxhZ3MpIHtcblxuXHRcdHRoaXMuX2NsZWFyQ2FudmFzKDAsIDAsIHRoaXMuX2NhbnZhc1dpZHRoLCB0aGlzLl9jYW52YXNIZWlnaHQpO1xuXHRcdGN0eC5zYXZlKCk7XG5cdFx0dGhpcy5fcmVkcmF3X2Zyb21FbGVtZW50cyhjdHgsIGludGVycG9sYXRvciwgZmxhZ3MpO1xuXHRcdC8vIHRoaXMuX3JlZHJhd19mcm9tVmlld3MoY3R4LCBpbnRlcnBvbGF0b3IpO1xuXHRcdGN0eC5yZXN0b3JlKCk7XG5cdH0sXG5cblx0X3JlZHJhd19mcm9tRWxlbWVudHM6IGZ1bmN0aW9uKGN0eCwgaW50ZXJwb2xhdG9yLCBmbGFncykge1xuXHRcdC8vIGIyYToga2V5d29yZCB0byBidW5kbGVzLCByaWdodCB0byBsZWZ0XG5cdFx0Ly8gYTJiOiBidW5kbGUgdG8ga2V5d29yZHMsIGxlZnQgdG8gcmlnaHRcblx0XHRpZiAoZmxhZ3MgJiAoQ2FudmFzVmlldy5TSVpFX0lOVkFMSUQgfCBDYW52YXNWaWV3Lk1PREVMX0lOVkFMSUQpKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpyZWRyYXcgW3ZhbHVlc0NoYW5nZWQ6ICVzXSBbZmxhZ3M6ICVzXVwiLCB0aGlzLmNpZCwgaW50ZXJwb2xhdG9yLnZhbHVlc0NoYW5nZWQsIENhbnZhc1ZpZXcuZmxhZ3NUb1N0cmluZyhmbGFncykpO1xuXG5cdFx0XHR0aGlzLl9hMmIucG9pbnRzT3V0ID0gdGhpcy5fYTJiLnBvaW50cztcblx0XHRcdHRoaXMuX2IyYS5wb2ludHNPdXQgPSB0aGlzLl9iMmEucG9pbnRzO1xuXHRcdFx0dGhpcy5fYjJhLnBvaW50cyA9IHRoaXMuX2NvbXB1dGVDb25uZWN0b3JzKHRoaXMuX2IyYSk7XG5cdFx0XHR0aGlzLl9hMmIucG9pbnRzID0gdGhpcy5fY29tcHV0ZUNvbm5lY3RvcnModGhpcy5fYTJiKTtcblx0XHRcdHRoaXMuX2xhYmVsT3ZlcmxheXMgPSB0aGlzLl9jb21wdXRlTGFiZWxPdmVybGF5cyh0aGlzLl9saXN0Qik7XG5cdFx0fVxuXG5cdFx0LyogbGluZSBkYXNoIHZhbHVlIGludGVycG9sYXRpb24gKi9cblx0XHR2YXIgYjJhVmFsID0gaW50ZXJwb2xhdG9yLl92YWx1ZURhdGFbXCJiMmFcIl0uX3JlbmRlcmVkVmFsdWUgLyBpbnRlcnBvbGF0b3IuX3ZhbHVlRGF0YVtcImIyYVwiXS5fbWF4VmFsO1xuXHRcdHZhciBhMmJWYWwgPSBpbnRlcnBvbGF0b3IuX3ZhbHVlRGF0YVtcImEyYlwiXS5fcmVuZGVyZWRWYWx1ZSAvIGludGVycG9sYXRvci5fdmFsdWVEYXRhW1wiYTJiXCJdLl9tYXhWYWw7XG5cblx0XHQvKiBkcmF3ICovXG5cdFx0dGhpcy5fZHJhd0Nvbm5lY3RvcnModGhpcy5fYjJhLnBvaW50cywgdGhpcy5fYjJhLnMsIGIyYVZhbCwgMSk7XG5cdFx0dGhpcy5fZHJhd0Nvbm5lY3RvcnModGhpcy5fYjJhLnBvaW50c091dCwgdGhpcy5fYjJhLnMsIDEgLSBiMmFWYWwsIDEpO1xuXHRcdHRoaXMuX2RyYXdDb25uZWN0b3JzKHRoaXMuX2EyYi5wb2ludHMsIHRoaXMuX2EyYi5zLCBhMmJWYWwsIDIpO1xuXHRcdC8vIHRoaXMuX2RyYXdDb25uZWN0b3JzKHRoaXMuX2EyYi5wb2ludHNPdXQsIHRoaXMuX2EyYi5zLCAxIC0gYTJiVmFsLCAyKTtcblx0XHR0aGlzLl9kcmF3TGFiZWxPdmVybGF5cyh0aGlzLl9sYWJlbE92ZXJsYXlzKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQgKiBsYWJlbCBvdmVybGF5c1xuXHQgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfY29tcHV0ZUxhYmVsT3ZlcmxheXM6IGZ1bmN0aW9uKGxpc3QpIHtcblx0XHR2YXIgZGF0YSA9IHsgcmVjdHM6IFtdIH07XG5cdFx0dmFyIGVscyA9IGxpc3QuZWwucXVlcnlTZWxlY3RvckFsbChcIi5saXN0LWdyb3VwIC5sYWJlbCBzcGFuXCIpO1xuXG5cdFx0dmFyIGksIGlpLCByO1xuXHRcdGZvciAoaSA9IDAsIGlpID0gZWxzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdC8vIHIgPSBpbmZsYXRlUmVjdChlbHNbaV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksIDAsIDApO1xuXHRcdFx0ciA9IF8uY2xvbmUoZWxzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKTtcblx0XHRcdHIudG9wICs9IHdpbmRvdy5zY3JvbGxZOyAvLyAtIDAuNTtcblx0XHRcdHIubGVmdCArPSB3aW5kb3cuc2Nyb2xsWDsgLy8gLSAwLjU7XG5cdFx0XHQvLyByLmlubmVyVGV4dCA9IGVsc1tpXS5pbm5lclRleHQ7XG5cdFx0XHRkYXRhLnJlY3RzW2ldID0gcjtcblx0XHR9XG5cdFx0Ly8gZGF0YS5jc3NTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxzWzBdKTtcblx0XHQvLyBkYXRhLmJveFN0eWxlID0gZ2V0Qm94RWRnZVN0eWxlcyhvdmVybGF5RGF0YS5jc3NTdHlsZSk7XG5cdFx0Ly8gZGF0YS5jdHhTdHlsZSA9IHtcblx0XHQvLyBcdGZvbnQ6IFtzLmZvbnRXZWlnaHQsIHMuZm9udFN0eWxlLCBzLmZvbnRTaXplICsgXCIvXCIgKyBzLmxpbmVIZWlnaHQsIHMuZm9udEZhbWlseV0uam9pbihcIiBcIilcblx0XHQvLyB9O1xuXHRcdHJldHVybiBkYXRhO1xuXHR9LFxuXG5cdF9kcmF3TGFiZWxPdmVybGF5czogZnVuY3Rpb24oZGF0YSkge1xuXHRcdHRoaXMuX2N0eC5zYXZlKCk7XG5cblx0XHQvLyBDYW52YXNWaWV3LnNldFN0eWxlKHRoaXMuX2N0eCwgcyk7XG5cdFx0dGhpcy5fY3R4Lmdsb2JhbEFscGhhID0gMC43NTtcblx0XHR0aGlzLl9jdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gXCJkZXN0aW5hdGlvbi1vdXRcIjtcblx0XHQvLyB0aGlzLl9jdHguY2FudmFzLnN0eWxlLmxldHRlclNwYWNpbmcgPSBvdmVybGF5RGF0YS5jc3NTdHlsZS5sZXR0ZXJTcGFjaW5nO1xuXG5cdFx0ZGF0YS5yZWN0cy5mb3JFYWNoKGZ1bmN0aW9uKHIpIHtcblx0XHRcdC8vIHRoaXMuX2N0eC5jbGVhclJlY3Qoci5sZWZ0LCByLnRvcCwgci53aWR0aCwgci5oZWlnaHQpO1xuXHRcdFx0dGhpcy5fY3R4LmZpbGxSZWN0KHIubGVmdCwgci50b3AsIHIud2lkdGgsIHIuaGVpZ2h0KTtcblx0XHRcdC8vIHRoaXMuX2N0eC5zdHJva2VUZXh0KHIuaW5uZXJUZXh0LCByLmxlZnQsIHIudG9wKTtcblx0XHR9LCB0aGlzKTtcblxuXHRcdHRoaXMuX2N0eC5yZXN0b3JlKCk7XG5cblx0XHRpZiAoREVCVUcpIHtcblx0XHRcdGlmICh0aGlzLl9kZWJ1Z0dyYXBoIHx8IHRoaXMuX2RlYnVnQmxvY2tzKSB7XG5cdFx0XHRcdGRhdGEucmVjdHMuZm9yRWFjaChmdW5jdGlvbihyKSB7XG5cdFx0XHRcdFx0ciA9IGluZmxhdGVSZWN0KHIsIDIsIDIpO1xuXHRcdFx0XHRcdENhbnZhc0hlbHBlci5kcmF3UmVjdCh0aGlzLl9jdHgsIF9kU3R5bGVzW1wic2FsbW9uXCJdLFxuXHRcdFx0XHRcdFx0ci5sZWZ0LCByLnRvcCwgci53aWR0aCwgci5oZWlnaHQpO1xuXHRcdFx0XHR9LCB0aGlzKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0ICogY29ubmVjdG9yc1xuXHQgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfY29tcHV0ZUNvbm5lY3RvcnM6IGZ1bmN0aW9uKGQpIHtcblx0XHR2YXIgc01pbiA9IGQueE1pbjtcblx0XHR2YXIgZE1pbiA9IGQuZGVzdE1pblg7XG5cdFx0dmFyIHF4ID0gZC5xeDtcblxuXHRcdC8vIHZhciByb290ID0ge307XG5cdFx0dmFyIHAsIHBvaW50cyA9IFtdO1xuXHRcdHZhciB4MSwgeTEsIHR4O1xuXHRcdHZhciByQmFzZSwgckluYztcblxuXHRcdHJCYXNlID0gdGhpcy5fcm91bmRUbyhkLnMucmFkaXVzQmFzZSAqIHRoaXMuX3Jvb3RGb250U2l6ZSwgMC41KTtcblx0XHRySW5jID0gdGhpcy5fcm91bmRUbyhkLnMucmFkaXVzSW5jcmVtZW50ICogdGhpcy5fcm9vdEZvbnRTaXplLCAwLjUpO1xuXG5cdFx0dmFyIHNWaWV3LCBkZFZpZXcsIGRkSXRlbXMsIGRkTnVtLCBpO1xuXHRcdGlmIChkLnNyY1ZpZXcuY29sbGVjdGlvbi5zZWxlY3RlZCAmJiBkLmRlc3RWaWV3LmZpbHRlcmVkSXRlbXMpIHtcblx0XHRcdHNWaWV3ID0gZC5zcmNWaWV3Lml0ZW1WaWV3cy5maW5kQnlNb2RlbChkLnNyY1ZpZXcuY29sbGVjdGlvbi5zZWxlY3RlZCk7XG5cblx0XHRcdHZhciByZWN0ID0gc1ZpZXcubGFiZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHR4MSA9IHJlY3QubGVmdDtcblx0XHRcdHkxID0gcmVjdC50b3AgKyByZWN0LmhlaWdodCAvIDI7XG5cdFx0XHRpZiAocXggPiAwKSB4MSArPSByZWN0LndpZHRoO1xuXHRcdFx0eDEgKz0gd2luZG93LnNjcm9sbFg7XG5cdFx0XHR5MSArPSB3aW5kb3cuc2Nyb2xsWTtcblxuXHRcdFx0Ly8gaWYgKCFzVmlldy5fbWV0cmljcykgcmV0dXJuO1xuXHRcdFx0Ly8geDEgPSBkLnJlY3QubGVmdCArIHNWaWV3LnRyYW5zZm9ybS50eFxuXHRcdFx0Ly8gXHQrIHNWaWV3Ll9tZXRyaWNzLnRleHRMZWZ0O1xuXHRcdFx0Ly8geTEgPSBkLnJlY3QudG9wICsgc1ZpZXcudHJhbnNmb3JtLnR5XG5cdFx0XHQvLyBcdCsgc1ZpZXcuX21ldHJpY3Mub2Zmc2V0SGVpZ2h0IC8gMjtcblx0XHRcdC8vIGlmIChxeCA+IDApIHgxICs9IHNWaWV3Ll9tZXRyaWNzLnRleHRXaWR0aDtcblxuXHRcdFx0ZGRJdGVtcyA9IGQuZGVzdFZpZXcuZmlsdGVyZWRJdGVtcztcblx0XHRcdGRkTnVtID0gZC5kZXN0Vmlldy5maWx0ZXJlZEl0ZW1zLmxlbmd0aDtcblxuXHRcdFx0Zm9yIChpID0gMDsgaSA8IGRkTnVtOyBpKyspIHtcblx0XHRcdFx0cCA9IHt9O1xuXHRcdFx0XHRkZFZpZXcgPSBkLmRlc3RWaWV3Lml0ZW1WaWV3cy5maW5kQnlNb2RlbChkZEl0ZW1zW2ldKTtcblxuXHRcdFx0XHRyZWN0ID0gZGRWaWV3LmxhYmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdFx0XHRwLngyID0gcmVjdC5sZWZ0O1xuXHRcdFx0XHRwLnkyID0gcmVjdC50b3AgKyByZWN0LmhlaWdodCAvIDI7XG5cdFx0XHRcdGlmIChxeCA8IDApIHAueDIgKz0gcmVjdC53aWR0aDtcblx0XHRcdFx0cC54MiArPSB3aW5kb3cuc2Nyb2xsWDtcblx0XHRcdFx0cC55MiArPSB3aW5kb3cuc2Nyb2xsWTtcblxuXHRcdFx0XHQvLyBwLngyID0gZC5kZXN0UmVjdC5sZWZ0ICsgZGRWaWV3LnRyYW5zZm9ybS50eFxuXHRcdFx0XHQvLyBcdCsgZGRWaWV3Ll9tZXRyaWNzLnRleHRMZWZ0O1xuXHRcdFx0XHQvLyBwLnkyID0gZC5kZXN0UmVjdC50b3AgKyBkZFZpZXcudHJhbnNmb3JtLnR5XG5cdFx0XHRcdC8vIFx0KyBkZFZpZXcuX21ldHJpY3Mub2Zmc2V0SGVpZ2h0IC8gMjtcblx0XHRcdFx0Ly8gaWYgKHF4IDwgMCkgcC54MiArPSBkZFZpZXcuX21ldHJpY3MudGV4dFdpZHRoO1xuXG5cdFx0XHRcdHAueDEgPSB4MTtcblx0XHRcdFx0cC55MSA9IHkxO1xuXHRcdFx0XHRwLnF4ID0gcXg7XG5cdFx0XHRcdHBvaW50c1tpXSA9IHA7XG5cdFx0XHR9XG5cdFx0XHRwb2ludHMuc29ydChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHRcdHJldHVybiBhLnkyIC0gYi55Mjtcblx0XHRcdH0pO1xuXHRcdFx0dmFyIHNpID0gMDsgLy8gc3NFbCdzIG51bWJlciBvZiBpdGVtcyBhYm92ZSBpbiB0aGUgWSBheGlzXG5cdFx0XHR2YXIgck1heDAgPSBkZE51bSAqIDAuNSAqIHJJbmM7IC8vIGZpcnN0IGFyYyAocjApIG1heCByYWRpdXMgKGN4MClcblx0XHRcdHZhciBhOyAvLyBjeTEgb2Zmc2V0IGZyb20geTFcblxuXHRcdFx0Zm9yIChpID0gMDsgaSA8IGRkTnVtOyBpKyspIHtcblx0XHRcdFx0cCA9IHBvaW50c1tpXTtcblxuXHRcdFx0XHRhID0gKGkgLSAoZGROdW0gLSAxKSAvIDIpICogckluYztcblx0XHRcdFx0cC5jeTEgPSBwLnkxICsgYTtcblx0XHRcdFx0cC5jeTIgPSBwLnkyO1xuXG5cdFx0XHRcdGEgPSBNYXRoLmFicyhhKTtcblx0XHRcdFx0cC5yMCA9IGE7XG5cdFx0XHRcdHAuY3gwID0gcC54MSArIChyTWF4MCAtIGEpICogcXg7XG5cblx0XHRcdFx0Ly8gcC5keCA9IHgxIC0gcC54Mjtcblx0XHRcdFx0Ly8gcC5keSA9IHkxIC0gcC55MjtcblxuXHRcdFx0XHRwLmRpID0gKChwLmN5MSAtIHAueTIpID4gMCkgPyBpIDogZGROdW0gLSAoaSArIDEpO1xuXHRcdFx0XHRzaSA9IE1hdGgubWF4KHNpLCBwLmRpKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gTk9URVxuXHRcdFx0Ly9zTWluID0gcC54MSArIChyTWF4MCAqIHF4KTtcblxuXHRcdFx0Zm9yIChpID0gMDsgaSA8IGRkTnVtOyBpKyspIHtcblx0XHRcdFx0cCA9IHBvaW50c1tpXTtcblx0XHRcdFx0cC5yMSA9IHAuZGkgKiBySW5jICsgckJhc2U7XG5cdFx0XHRcdHAucjIgPSByQmFzZTtcblx0XHRcdFx0Ly8gcC5yMiA9IHJCYXNlICsgKHNpIC0gcC5kaSkgKiBySW5jO1xuXG5cdFx0XHRcdHAuY3gxID0gc01pbiArIChyTWF4MCAqIHF4KTtcblx0XHRcdFx0cC5jeDIgPSBkTWluIC0gKChzaSAtIHAuZGkpICogckluYykgKiBxeDtcblx0XHRcdFx0Ly8gcC5jeDIgPSBkTWluO1xuXG5cdFx0XHRcdHR4ID0gY2FsY0FyY0hDb25uZWN0b3IocC5jeDEsIHAuY3kxLCBwLnIxLCBwLmN4MiwgcC5jeTIsIHAucjIsIDAuOSk7XG5cdFx0XHRcdGlmICh0eCkge1xuXHRcdFx0XHRcdHAudHgxID0gdHhbMF07XG5cdFx0XHRcdFx0cC50eDIgPSB0eFsxXTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRwLnR4MSA9IHAuY3gxO1xuXHRcdFx0XHRcdHAudHgyID0gcC5jeDI7XG5cdFx0XHRcdH1cblx0XHRcdFx0cC5sZW5ndGggPSBNYXRoLmFicyhwLngxIC0gcC54MikgKyBNYXRoLmFicyhwLmN5MSAtIHAuY3kyKTtcblxuXHRcdFx0XHQvLyBGaW5kIG91dCBsb25nZXN0IG5vZGUgY29ubmVjdGlvbiBmb3Igc2V0TGluZURhc2hcblx0XHRcdFx0Ly8gcm9vdC5tYXhMZW5ndGggPSBNYXRoLm1heChyb290Lm1heExlbmd0aCwgcC5sZW5ndGgpO1xuXHRcdFx0fVxuXHRcdFx0cG9pbnRzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuXHRcdFx0XHRyZXR1cm4gYS5kaSAtIGIuZGk7IC8vIFNvcnQgYnkgZGlzdGFuY2UgdG8gc2VsZWN0ZWQgdmlld1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vIHJvb3QueCA9IHgxO1xuXHRcdFx0Ly8gcm9vdC55ID0geTE7XG5cdFx0XHQvLyByb290LnF4ID0gcXg7XG5cdFx0XHQvLyByb290LnIwID0gc2kgKiBySW5jO1xuXHRcdH1cblx0XHQvLyBkLnBvaW50cyA9IHBvaW50cztcblx0XHQvLyBkLnJvb3QgPSByb290O1xuXHRcdC8vIHJldHVybiBkO1xuXHRcdHJldHVybiBwb2ludHM7XG5cdH0sXG5cblx0X2RyYXdDb25uZWN0b3JzOiBmdW5jdGlvbihwcCwgcywgbFZhbCwgZGlyKSB7XG5cdFx0dmFyIGksIGlpLCBwO1xuXHRcdHZhciBvdywgcmExLCByYTIsIHRhO1xuXG5cdFx0aWYgKCEocHAgJiYgcHAubGVuZ3RoICYmIGxWYWwpKSByZXR1cm47XG5cblx0XHRpaSA9IHBwLmxlbmd0aDtcblxuXHRcdC8qIG91dGxpbmUgd2lkdGggKi9cblx0XHRvdyA9IHMubGluZVdpZHRoICsgcy5vdXRsaW5lV2lkdGg7XG5cdFx0Ly8gb3cgPSBNYXRoLm1pbihcblx0XHQvLyBcdHRoaXMuX3JvdW5kVG8ocy5yYWRpdXNJbmNyZW1lbnQgKiB0aGlzLl9yb290Rm9udFNpemUsIDAuNSksXG5cdFx0Ly8gXHR0aGlzLl9yb3VuZFRvKHMubGluZVdpZHRoICogKDEgKyBzLm91dGxpbmVXaWR0aCksIDAuNSlcblx0XHQvLyApO1xuXG5cdFx0LyogYXJyb3cgcmFkaXVzZXMsIGRpcmVjdGlvbiAqL1xuXHRcdC8vIHJhMSA9IChzLnJhZGl1c0luY3JlbWVudCAqIHRoaXMuX3Jvb3RGb250U2l6ZSkgKyBzLmxpbmVXaWR0aDtcblx0XHRyYTEgPSBzLmFycm93U2l6ZSAqIHRoaXMuX3Jvb3RGb250U2l6ZTtcblx0XHRyYTIgPSByYTEgKyAob3cgLSBzLmxpbmVXaWR0aCk7XG5cdFx0dGEgPSBNYXRoLlBJICogZGlyO1xuXHRcdC8vIGRpciAtPSAyO1xuXG5cdFx0dGhpcy5fc2V0U3R5bGUocyk7XG5cblx0XHQvLyBpZiAobFZhbCA8IDEpIHtcblx0XHQvLyBcdHRoaXMuX2N0eC5saW5lRGFzaE9mZnNldCA9IGxNYXggKiAoMSArIGxWYWwpO1xuXHRcdC8vIFx0dGhpcy5fY3R4LnNldExpbmVEYXNoKFtsTWF4LCBsTWF4XSlcblx0XHQvLyBcdC8vIHRoaXMuX2N0eC5saW5lRGFzaE9mZnNldCA9IGxNYXggKiAoMSArIGxWYWwpOztcblx0XHQvLyBcdC8vIHRoaXMuX2N0eC5zZXRMaW5lRGFzaChbbE1heCAqICgxIC0gbFZhbCksIGxNYXhdKTtcblx0XHQvLyB9XG5cblx0XHQvLyBmb3IgKGkgPSAwOyBpIDwgaWk7IGkrKykge1xuXHRcdC8vIHAgPSBwcFtpXTtcblx0XHRpZiAocy5vdXRsaW5lV2lkdGgpIHtcblx0XHRcdHRoaXMuX2N0eC5zYXZlKCk7XG5cdFx0XHR0aGlzLl9jdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gXCJkZXN0aW5hdGlvbi1vdXRcIjtcblx0XHRcdHRoaXMuX2N0eC5saW5lV2lkdGggPSBvdztcblx0XHRcdGZvciAoaSA9IDA7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHRcdHAgPSBwcFtpXTtcblxuXHRcdFx0XHRpZiAobFZhbCA8IDEpIHtcblx0XHRcdFx0XHR0aGlzLl9jdHgubGluZURhc2hPZmZzZXQgPSBwLmxlbmd0aCAqICgxICsgbFZhbCk7XG5cdFx0XHRcdFx0dGhpcy5fY3R4LnNldExpbmVEYXNoKFtwLmxlbmd0aCwgcC5sZW5ndGhdKVxuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuX2RyYXdDb25uZWN0b3IocCwgaSwgcHApO1xuXHRcdFx0XHRpZiAobFZhbCA9PSAxKSB7XG5cdFx0XHRcdFx0Q2FudmFzSGVscGVyLmFycm93aGVhZCh0aGlzLl9jdHgsIHAueDIsIHAueTIsIHJhMiwgdGEpO1xuXHRcdFx0XHRcdHRoaXMuX2N0eC5maWxsKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHRoaXMuX2N0eC5yZXN0b3JlKCk7XG5cdFx0fVxuXG5cdFx0Zm9yIChpID0gMDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHAgPSBwcFtpXTtcblx0XHRcdGlmIChsVmFsIDwgMSkge1xuXHRcdFx0XHR0aGlzLl9jdHgubGluZURhc2hPZmZzZXQgPSBwLmxlbmd0aCAqICgxICsgbFZhbCk7XG5cdFx0XHRcdHRoaXMuX2N0eC5zZXRMaW5lRGFzaChbcC5sZW5ndGgsIHAubGVuZ3RoXSlcblx0XHRcdH1cblx0XHRcdHRoaXMuX2RyYXdDb25uZWN0b3IocCwgaSwgcHApO1xuXHRcdFx0aWYgKGxWYWwgPT0gMSkge1xuXHRcdFx0XHRDYW52YXNIZWxwZXIuYXJyb3doZWFkKHRoaXMuX2N0eCwgcC54MiwgcC55MiwgcmExLCBkaXIgKiB0YSk7XG5cdFx0XHRcdHRoaXMuX2N0eC5maWxsKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF9kcmF3Q29ubmVjdG9yOiBmdW5jdGlvbihwLCBpLCBwcCkge1xuXHRcdGlmIChERUJVRykge1xuXHRcdFx0aWYgKHRoaXMuX2RlYnVnR3JhcGgpIHtcblx0XHRcdFx0aWYgKGkgPT0gMCkge1xuXHRcdFx0XHRcdENhbnZhc0hlbHBlci5kcmF3Vkd1aWRlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJncmV5XCJdLCBwLngxKTtcblx0XHRcdFx0XHRDYW52YXNIZWxwZXIuZHJhd1ZHdWlkZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wiZ3JleVwiXSwgcC5jeDEpO1xuXHRcdFx0XHRcdENhbnZhc0hlbHBlci5kcmF3SEd1aWRlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJncmV5XCJdLCBwLnkxKTtcblx0XHRcdFx0XHRDYW52YXNIZWxwZXIuZHJhd0NpcmNsZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wibWlkbmlnaHRibHVlXCJdLCBwLngxLCBwLnkxLCAxMCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8gQ2FudmFzSGVscGVyLmRyYXdWR3VpZGUodGhpcy5fY3R4LCBfZFN0eWxlc1tcImdyZXlcIl0sIHAuY3gyKTtcblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdIR3VpZGUodGhpcy5fY3R4LCBfZFN0eWxlc1tcImdyZXlcIl0sIHAuY3kyKTtcblx0XHRcdFx0Ly8gX2RTdHlsZXNbcC5keSA+IDAgPyBcImxpZ2h0Z3JlZW5cIiA6IFwic2FsbW9uXCJdLCBwLmN5Mik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy5fY3R4LmJlZ2luUGF0aCgpO1xuXHRcdHRoaXMuX2N0eC5tb3ZlVG8ocC54MiwgcC5jeTIpO1xuXHRcdHRoaXMuX2N0eC5hcmNUbyhwLnR4MiwgcC5jeTIsIHAudHgxLCBwLmN5MSwgcC5yMik7XG5cdFx0dGhpcy5fY3R4LmFyY1RvKHAudHgxLCBwLmN5MSwgcC5jeDEsIHAuY3kxLCBwLnIxKTtcblx0XHR0aGlzLl9jdHguYXJjVG8ocC5jeDAsIHAuY3kxLCBwLmN4MCwgcC55MSwgcC5yMCk7XG5cblx0XHQvLyBwLmN4MDAgPSBwLngxICsgKChwLnIwICsgcC5kaSkgKiBwLnF4KTtcblx0XHQvLyBwLmN5MDAgPSAocC5jeTEgKyBwLnkxKSAvIDI7XG5cdFx0Ly8gdGhpcy5fY3R4LmFyY1RvKHAuY3gwMCwgcC5jeTEsIHAuY3gwMCwgcC5jeTAwLCBwLnIwIC8gMik7XG5cdFx0Ly8gdGhpcy5fY3R4LmFyY1RvKHAuY3gwMCwgcC55MSwgcC54MSwgcC55MSwgcC5yMCAvIDIpO1xuXHRcdC8vIHRoaXMuX2N0eC5saW5lVG8ocC54MSwgcC55MSk7XG5cblx0XHQvLyBwLmN4MDAgPSBwLngxICsgKHAucjAgKiBwLnF4ICogMik7XG5cdFx0Ly8gdGhpcy5fY3R4LmxpbmVUbyhwLmN4MDAsIHAuY3kxKTtcblx0XHQvLyB0aGlzLl9jdHgucXVhZHJhdGljQ3VydmVUbyhwLmN4MCwgcC5jeTEsIHAuY3gwLCBwLnkxKTtcblxuXHRcdC8vIHRoaXMuX2N0eC5saW5lVG8ocC5jeDAsIHAueTEpO1xuXHRcdHRoaXMuX2N0eC5zdHJva2UoKTtcblxuXHRcdGlmIChERUJVRykge1xuXHRcdFx0aWYgKHRoaXMuX2RlYnVnR3JhcGgpIHtcblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdDcm9zc2hhaXIodGhpcy5fY3R4LCBfZFN0eWxlc1tcImJsdWVcIl0sXG5cdFx0XHRcdFx0cC54MSArICgocC5yMCArIHAuZGkpICogcC5xeCksIHAuY3kxLCAzKTtcblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdTcXVhcmUodGhpcy5fY3R4LCBfZFN0eWxlc1tcIm1pZG5pZ2h0Ymx1ZVwiXSwgcC5jeDAsIHAuY3kxLCAyKTtcblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdDaXJjbGUodGhpcy5fY3R4LCBfZFN0eWxlc1tcImJsdWVcIl0sIHAuY3gxLCBwLmN5MSwgMSk7XG5cdFx0XHRcdENhbnZhc0hlbHBlci5kcmF3U3F1YXJlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJibHVlXCJdLCBwLnR4MSwgcC5jeTEsIDIpO1xuXHRcdFx0XHRDYW52YXNIZWxwZXIuZHJhd1NxdWFyZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wiZ3JlZW5cIl0sIHAudHgyLCBwLmN5MiwgMik7XG5cdFx0XHRcdENhbnZhc0hlbHBlci5kcmF3Q2lyY2xlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJncmVlblwiXSwgcC5jeDIsIHAuY3kyLCAxKTtcblxuXHRcdFx0XHRDYW52YXNIZWxwZXIuZHJhd0NpcmNsZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wib2xpdmVcIl0sIHAueDIsIHAuY3kyLCAzKTtcblx0XHRcdFx0Q2FudmFzSGVscGVyLmRyYXdDcm9zc2hhaXIodGhpcy5fY3R4LCBfZFN0eWxlc1tcIm9saXZlXCJdLCBwLngyLCBwLnkyLCA2KTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0X3JvdW5kVG86IGZ1bmN0aW9uKG4sIHApIHtcblx0XHRpZiAocCA+IDEpIHAgPSAxIC8gcDtcblx0XHRyZXR1cm4gTWF0aC5yb3VuZChuIC8gcCkgKiBwO1xuXHR9LFxuXG5cdC8qXG5cdF9jb21wdXRlQ29ubmVjdG9yczogZnVuY3Rpb24oZCkge1xuXHRcdHZhciByQmFzZSA9IGQucy5yYWRpdXNCYXNlO1xuXHRcdHZhciBySW5jID0gZC5zLnJhZGl1c0luY3JlbWVudDtcblx0XHR2YXIgc01pbiA9IGQueE1pbjtcblx0XHR2YXIgZE1pbiA9IGQuZGVzdE1pblg7XG5cblx0XHR2YXIgbE1heCA9IDA7XG5cdFx0dmFyIHAsIHBvaW50cyA9IFtdO1xuXHRcdHZhciBxeCwgeDEsIHkxLCB0eDtcblx0XHR2YXIgc2k7IC8vIHNzRWwncyBudW1iZXIgb2YgaXRlbXMgYWJvdmUgaW4gdGhlIFkgYXhpc1xuXG5cdFx0aWYgKGQucmVjdC5yaWdodCA8IGQuZGVzdFJlY3QubGVmdCkge1xuXHRcdFx0cXggPSAxO1xuXHRcdH0gZWxzZSBpZiAoZC5kZXN0UmVjdC5yaWdodCA8IGQucmVjdC5sZWZ0KSB7XG5cdFx0XHRxeCA9IC0xO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRxeCA9IDA7XG5cdFx0fVxuXG5cdFx0dmFyIHNzRWwsIGRkRWxzLCBkZE51bSwgc3NSZWN0LCBkZFJlY3QsIGk7XG5cdFx0c3NFbCA9IGQuc3JjVmlldy5lbC5xdWVyeVNlbGVjdG9yKFwiLmxpc3QtaXRlbS5zZWxlY3RlZCAubGFiZWxcIik7XG5cdFx0aWYgKHNzRWwpIHtcblx0XHRcdHNzUmVjdCA9IHNzRWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHR4MSA9IHNzUmVjdC5sZWZ0O1xuXHRcdFx0aWYgKHF4ID4gMCkgeDEgKz0gc3NSZWN0LndpZHRoO1xuXHRcdFx0eTEgPSBzc1JlY3QudG9wICsgc3NSZWN0LmhlaWdodCAvIDI7XG5cdFx0XHQvLyByMiA9IHJCYXNlO1xuXHRcdFx0Ly8gY3gxID0gZC54TWluO1xuXG5cdFx0XHRzaSA9IDA7XG5cdFx0XHRkZEVscyA9IGQuZGVzdFZpZXcuZWwucXVlcnlTZWxlY3RvckFsbChcIi5saXN0LWl0ZW06bm90KC5leGNsdWRlZCkgLmxhYmVsXCIpO1xuXHRcdFx0ZGROdW0gPSBkZEVscy5sZW5ndGg7XG5cdFx0XHQvLyBkeCA9IE1hdGguYWJzKGQueE1pbiAtIGREYXRhLnhNaW4pO1xuXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgZGROdW07IGkrKykge1xuXHRcdFx0XHRwID0ge307XG5cdFx0XHRcdGRkUmVjdCA9IGRkRWxzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdFx0XHRwLngyID0gZGRSZWN0LmxlZnQ7XG5cdFx0XHRcdGlmIChxeCA8IDApIHAueDIgKz0gZGRSZWN0LndpZHRoO1xuXHRcdFx0XHRwLnkyID0gZGRSZWN0LnRvcCArIGRkUmVjdC5oZWlnaHQgLyAyO1xuXHRcdFx0XHRwLngxID0geDE7XG5cdFx0XHRcdHAueTEgPSB5MTtcblx0XHRcdFx0cC5keCA9IHAueDEgLSBwLngyO1xuXHRcdFx0XHRwLmR5ID0gcC55MSAtIHAueTI7XG5cdFx0XHRcdHAucXggPSBxeDtcblx0XHRcdFx0cC5xeSA9IE1hdGguc2lnbihwLmR5KTtcblx0XHRcdFx0Ly8gcC5kTGVuZ3RoID0gTWF0aC5hYnMocC54KSArIE1hdGguYWJzKHAueSk7XG5cdFx0XHRcdHAuZGkgPSBwLmR5ID4gMCA/IGkgOiBkZE51bSAtIChpICsgMSk7XG5cdFx0XHRcdHNpID0gTWF0aC5tYXgoc2ksIHAuZGkpO1xuXHRcdFx0XHRwb2ludHNbaV0gPSBwO1xuXHRcdFx0fVxuXG5cdFx0XHR2YXIgYSwgck1heDAgPSBkZE51bSAqIDAuNSAqIHJJbmM7XG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgZGROdW07IGkrKykge1xuXHRcdFx0XHRwID0gcG9pbnRzW2ldO1xuXHRcdFx0XHRwLnIxID0gcC5kaSAqIHJJbmMgKyByQmFzZTtcblx0XHRcdFx0cC5yMiA9IHJCYXNlO1xuXHRcdFx0XHQvLyBwLnIyID0gKHNpIC0gcC5kaSkgKiBySW5jICsgckJhc2U7XG5cblx0XHRcdFx0cC5jeDEgPSBzTWluO1xuXHRcdFx0XHRwLmN4MiA9IGRNaW4gLSAoKHNpIC0gcC5kaSkgKiBySW5jKSAqIHF4O1xuXHRcdFx0XHQvLyBwLmN4MiA9IGRNaW47XG5cblx0XHRcdFx0YSA9IChpIC0gKGRkTnVtIC0gMSkgLyAyKSAqIHJJbmM7XG5cdFx0XHRcdHAuY3kxID0gcC55MSArIGE7XG5cdFx0XHRcdHAuY3kyID0gcC55MjtcblxuXHRcdFx0XHRhID0gTWF0aC5hYnMoYSk7XG5cdFx0XHRcdHAucjAgPSBhO1xuXHRcdFx0XHRwLmN4MCA9IHAueDEgKyAock1heDAgLSBhKSAqIHF4O1xuXG5cdFx0XHRcdHR4ID0gY2FsY0FyY0hDb25uZWN0b3IocC5jeDEsIHAuY3kxLCBwLnIxLCBwLmN4MiwgcC5jeTIsIHAucjIsIDAuOCk7XG5cdFx0XHRcdHAudHgxID0gdHhbMF07XG5cdFx0XHRcdHAudHgyID0gdHhbMV07XG5cblx0XHRcdFx0Ly8gRmluZCBvdXQgbG9uZ2VzdCBub2RlIGNvbm5lY3Rpb24gZm9yIHNldExpbmVEYXNoXG5cdFx0XHRcdGxNYXggPSBNYXRoLm1heChsTWF4LCBNYXRoLmFicyhwLngxIC0gcC54MikgKyBNYXRoLmFicyhwLmN5MSAtIHAuY3kyKSk7XG5cdFx0XHR9XG5cdFx0XHQvLyBTb3J0IGJ5IGRpc3RhbmNlIHkxIChvcmlnaW5hbCkgPiBjeTEgKHJJbmMgb2Zmc2V0KSBkaXN0YW5jZVxuXHRcdFx0cG9pbnRzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xuXHRcdFx0XHQvLyByZXR1cm4gTWF0aC5hYnMoYi55MSAtIGIuY3kxKSAtIE1hdGguYWJzKGEueTEgLSBhLmN5MSk7XG5cdFx0XHRcdC8vIHJldHVybiBhLnIwIC0gYi5yMDtcblx0XHRcdFx0cmV0dXJuIGIuZGkgLSBhLmRpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGQucG9pbnRzID0gcG9pbnRzO1xuXHRcdGQubWF4TGVuZ3RoID0gbE1heDtcblx0XHRkLm1heExlbmd0aCA9IHF4O1xuXHR9LCAqL1xuXG59KTtcblxuaWYgKERFQlVHKSB7XG5cdC8vIEdyYXBoVmlldy5wcm90b3R5cGUuX2xvZ0ZsYWdzID0gXCJcIjtcblxuXHRHcmFwaFZpZXcucHJvdG90eXBlLl90cmFjZVNjcm9sbCA9IGZ1bmN0aW9uKHR5cGUpIHtcblx0XHR2YXIgdHBsID0gXCIlczpbJXNdIERQUjolaSBcIiArXG5cdFx0XHRcIlt3aW5kb3c6ICVpICVpXSBcIiArXG5cdFx0XHRcIltodG1sOiAlaSAlaSAlaV0gXCIgK1xuXHRcdFx0XCJbYm9keTogJWkgJWkgJWldIFwiICtcblx0XHRcdFwiW2NvbnRhaW5lcjogJWkgJWkgJWldIFwiICtcblx0XHRcdFwiW2dyYXBoOiAlaSAlaSAlaV1cIjtcblx0XHRjb25zb2xlLmxvZyh0cGwsIHRoaXMuY2lkLCB0eXBlLCB0aGlzLl9jYW52YXNSYXRpbyxcblx0XHRcdHdpbmRvdy5zY3JvbGxZLFxuXHRcdFx0d2luZG93LnBhZ2VZT2Zmc2V0LFxuXHRcdFx0ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCxcblx0XHRcdGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AsXG5cdFx0XHRkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0ZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQsXG5cdFx0XHRkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCxcblx0XHRcdGRvY3VtZW50LmJvZHkuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0ZG9jdW1lbnQuYm9keS5maXJzdEVsZW1lbnRDaGlsZC5jbGllbnRIZWlnaHQsXG5cdFx0XHRkb2N1bWVudC5ib2R5LmZpcnN0RWxlbWVudENoaWxkLnNjcm9sbFRvcCxcblx0XHRcdGRvY3VtZW50LmJvZHkuZmlyc3RFbGVtZW50Q2hpbGQuc2Nyb2xsSGVpZ2h0LFxuXHRcdFx0dGhpcy5lbC5jbGllbnRIZWlnaHQsXG5cdFx0XHR0aGlzLmVsLnNjcm9sbFRvcCxcblx0XHRcdHRoaXMuZWwuc2Nyb2xsSGVpZ2h0XG5cdFx0KTtcblx0fTtcblxuXHR2YXIgZGVib3VuY2VkTG9nID0gXy5kZWJvdW5jZShfLmJpbmQoY29uc29sZS5sb2csIGNvbnNvbGUpLCA1MDAsIHRydWUpO1xuXHR2YXIgYXBwbHlNZXRob2QgPSBmdW5jdGlvbihjb250ZXh0LCBhcmdzKSB7XG5cdFx0cmV0dXJuIEFycmF5LnByb3RvdHlwZS5zaGlmdC5hcHBseShhcmdzKS5hcHBseShjb250ZXh0LCBhcmdzKTtcblx0fVxuXHRpZiAoR3JhcGhWaWV3LnByb3RvdHlwZS5fbG9nRmxhZ3Muc3BsaXQoXCIgXCIpW1widmlldy5yZW5kZXJcIl0pIHtcblx0XHQvLyBHcmFwaFZpZXcucHJvdG90eXBlLl9yZXF1ZXN0UmVuZGVyID0gXy53cmFwKENhbnZhc1ZpZXcucHJvdG90eXBlLl9yZXF1ZXN0UmVuZGVyLCBmdW5jdGlvbihmbikge1xuXHRcdC8vIFx0ZGVib3VuY2VkTG9nKFwiJXM6Ol9yZXF1ZXN0UmVuZGVyXCIsIHRoaXMuY2lkKTtcblx0XHQvLyBcdHJldHVybiBhcHBseU1ldGhvZCh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdC8vIH0pO1xuXHRcdEdyYXBoVmlldy5wcm90b3R5cGUuX2FwcGx5UmVuZGVyID0gXy53cmFwKENhbnZhc1ZpZXcucHJvdG90eXBlLl9hcHBseVJlbmRlciwgZnVuY3Rpb24oZm4pIHtcblx0XHRcdHZhciByZXR2YWw7XG5cdFx0XHR0aGlzLl9sb2dGbGFnc1tcInZpZXcucmVuZGVyXCJdID0gZmFsc2U7XG5cdFx0XHRkZWJvdW5jZWRMb2coXCIlczo6X2FwcGx5UmVuZGVyIFtkZWJvdW5jZWRdXCIsIHRoaXMuY2lkKTtcblx0XHRcdHJldHZhbCA9IGFwcGx5TWV0aG9kKHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR0aGlzLl9sb2dGbGFnc1tcInZpZXcucmVuZGVyXCJdID0gdHJ1ZTtcblx0XHRcdHJldHVybiByZXR2YWw7XG5cdFx0fSk7XG5cdH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBHcmFwaFZpZXc7IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9Hcm91cGluZ0xpc3RWaWV3XG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lLmJhYnlzaXR0ZXJ9ICovXG4vLyB2YXIgQ29udGFpbmVyID0gcmVxdWlyZShcImJhY2tib25lLmJhYnlzaXR0ZXJcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG4vLyB2YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvRmlsdGVyYWJsZUxpc3RWaWV3fSAqL1xudmFyIEZpbHRlcmFibGVMaXN0VmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvRmlsdGVyYWJsZUxpc3RWaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0NsaWNrYWJsZVJlbmRlcmVyfSAqL1xudmFyIENsaWNrYWJsZVJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9DbGlja2FibGVSZW5kZXJlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9MYWJlbFJlbmRlcmVyfSAqL1xudmFyIExhYmVsUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0xhYmVsUmVuZGVyZXJcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9hcnJheS9kaWZmZXJlbmNlfSAqL1xuLy8gdmFyIGRpZmYgPSByZXF1aXJlKFwidXRpbHMvYXJyYXkvZGlmZmVyZW5jZVwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0dyb3VwaW5nTGlzdFZpZXd9XG4gKi9cbnZhciBHcm91cGluZ0xpc3RWaWV3ID0gRmlsdGVyYWJsZUxpc3RWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJncm91cGluZ0xpc3RcIixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwiZGxcIixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJncm91cGVkXCIsXG5cblx0LyoqIEB0eXBlIHtGdW5jdGlvbnxudWxsfSBlbXB0eSBhcnJheSAqL1xuXHRfZ3JvdXBpbmdGbjogbnVsbCwgLy9mdW5jdGlvbigpIHsgcmV0dXJuIG51bGw7IH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRkZWZhdWx0czogXy5kZWZhdWx0cyh7XG5cdFx0Ly8gZGVmYXVsdHM6IHtcblx0XHRyZW5kZXJlcjogQ2xpY2thYmxlUmVuZGVyZXIuZXh0ZW5kKHtcblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGNpZFByZWZpeDogXCJncm91cGluZ0xpc3RJdGVtXCIsXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHR0YWdOYW1lOiBcImRsXCIsXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRjbGFzc05hbWU6IFwibGlzdC1pdGVtIGxpc3QtbGFiZWxcIixcblx0XHR9KSxcblx0XHRncm91cGluZ1JlbmRlcmVyOiBMYWJlbFJlbmRlcmVyLmV4dGVuZCh7XG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRjaWRQcmVmaXg6IFwiZ3JvdXBpbmdMaXN0R3JvdXBcIixcblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdHRhZ05hbWU6IFwiZHRcIixcblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGNsYXNzTmFtZTogXCJsaXN0LWdyb3VwIGxpc3QtbGFiZWxcIixcblx0XHR9KSxcblx0XHRncm91cGluZ0ZuOiBudWxsLFxuXHRcdC8vIH0sXG5cdH0sIEZpbHRlcmFibGVMaXN0Vmlldy5wcm90b3R5cGUuZGVmYXVsdHMpLFxuXG5cdHByb3BlcnRpZXM6IHtcblx0XHRncm91cHM6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9ncm91cHM7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRmaWx0ZXJlZEdyb3Vwczoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2ZpbHRlcmVkR3JvdXBzO1xuXHRcdFx0fVxuXHRcdH0sXG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0RmlsdGVyYWJsZUxpc3RWaWV3LnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR0aGlzLl9ncm91cHMgPSBbXTtcblx0XHR0aGlzLl9maWx0ZXJlZEdyb3VwcyA9IFtdO1xuXHRcdHRoaXMuX2NoYW5nZWRGaWx0ZXJlZEdyb3VwcyA9IFtdO1xuXHRcdHRoaXMuX2dyb3Vwc0J5SXRlbUNpZCA9IHt9O1xuXG5cdFx0dGhpcy5fZ3JvdXBpbmdGbiA9IG9wdGlvbnMuZ3JvdXBpbmdGbjtcblx0XHR0aGlzLmdyb3VwaW5nUmVuZGVyZXIgPSBvcHRpb25zLmdyb3VwaW5nUmVuZGVyZXI7XG5cdFx0dGhpcy5fY29tcHV0ZUdyb3VwcygpO1xuXHRcdGlmICh0aGlzLl9ncm91cGluZ0ZuKSB7XG5cdFx0XHR0aGlzLl9ncm91cHMuZm9yRWFjaCh0aGlzLmNyZWF0ZUdyb3VwaW5nVmlldywgdGhpcyk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKlxuXHQgKiBDYWxsZWQgb25jZSBvbiBjb2xsZWN0aW9uIGNoYW5nZVxuXHQgKiBAcHJpdmF0ZVxuXHQgKi9cblx0X2NvbXB1dGVHcm91cHM6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHRoaXMuX2dyb3VwcyA9IF8udW5pcSh0aGlzLmNvbGxlY3Rpb24ubWFwKHRoaXMuX2dyb3VwaW5nRm4sIHRoaXMpKTtcblx0XHR0aGlzLl9ncm91cHMubGVuZ3RoID0gMDtcblx0XHQvLyB0aGlzLl9ncm91cEl0ZW1zLmxlbmd0aCA9IDA7XG5cdFx0aWYgKHRoaXMuX2dyb3VwaW5nRm4pIHtcblx0XHRcdHRoaXMuY29sbGVjdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0dmFyIGdJZHgsIGdPYmo7XG5cdFx0XHRcdGdPYmogPSB0aGlzLl9ncm91cGluZ0ZuLmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdGlmIChnT2JqKSB7XG5cdFx0XHRcdFx0Z0lkeCA9IHRoaXMuX2dyb3Vwcy5pbmRleE9mKGdPYmopO1xuXHRcdFx0XHRcdGlmIChnSWR4ID09IC0xKSB7XG5cdFx0XHRcdFx0XHRnSWR4ID0gdGhpcy5fZ3JvdXBzLmxlbmd0aDtcblx0XHRcdFx0XHRcdHRoaXMuX2dyb3Vwc1tnSWR4XSA9IGdPYmo7XG5cdFx0XHRcdFx0XHQvLyB0aGlzLl9ncm91cEl0ZW1zW2dJZHhdID0gW107XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdC8vIHRoaXMuX2dyb3VwSXRlbXNbZ0lkeF0ucHVzaChpdGVtKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLl9ncm91cHNCeUl0ZW1DaWRbaXRlbS5jaWRdID0gZ09iajtcblx0XHRcdH0sIHRoaXMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNvbGxlY3Rpb24uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG5cdFx0XHRcdHRoaXMuX2dyb3Vwc0J5SXRlbUNpZFtpdGVtLmNpZF0gPSBudWxsO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAcHJpdmF0ZSBDcmVhdGUgY2hpbGRyZW4gdmlld3MgKi9cblx0Y3JlYXRlR3JvdXBpbmdWaWV3OiBmdW5jdGlvbihpdGVtKSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgdGhpcy5ncm91cGluZ1JlbmRlcmVyKHtcblx0XHRcdG1vZGVsOiBpdGVtLFxuXHRcdFx0ZWw6IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5saXN0LWdyb3VwW2RhdGEtaWQ9XFxcIlwiICsgaXRlbS5pZCArIFwiXFxcIl1cIilcblx0XHR9KTtcblx0XHR0aGlzLml0ZW1WaWV3cy5hZGQodmlldyk7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogRmlsdGVyIGltcGwgMVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdC8qXG5cdGNvbXB1dGVGaWx0ZXJfMTogZnVuY3Rpb24oKSB7XG5cdFx0RmlsdGVyYWJsZUxpc3RWaWV3LnByb3RvdHlwZS5jb21wdXRlRmlsdGVyXzEuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdGlmICh0aGlzLl9ncm91cGluZ0ZuKSB7XG5cdFx0XHRpZiAodGhpcy5fZmlsdGVyZWRJdGVtcy5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHR0aGlzLl9maWx0ZXJlZEdyb3VwcyA9IFtdO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5fZmlsdGVyZWRHcm91cHMgPSBfLnVuaXEodGhpcy5fZmlsdGVyZWRJdGVtcy5tYXAoZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLl9ncm91cHNCeUl0ZW1DaWRbaXRlbS5jaWRdO1xuXHRcdFx0XHR9LCB0aGlzKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIGlmICh0aGlzLl9ncm91cGluZ0ZuKSB7XG5cdFx0Ly8gXHRpZiAodGhpcy5fZmlsdGVyZWRJdGVtcy5sZW5ndGggPT0gMCkge1xuXHRcdC8vIFx0XHR0aGlzLl9maWx0ZXJlZEdyb3VwcyA9IFtdO1xuXHRcdC8vIFx0XHR0aGlzLl9ncm91cHMuZm9yRWFjaChmdW5jdGlvbihncm91cCkge1xuXHRcdC8vIFx0XHRcdHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKGdyb3VwKS5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiZXhjbHVkZWRcIik7XG5cdFx0Ly8gXHRcdH0sIHRoaXMpO1xuXHRcdC8vIFx0fSBlbHNlIHtcblx0XHQvLyBcdFx0dGhpcy5fZmlsdGVyZWRHcm91cHMgPSBfLnVuaXEodGhpcy5fZmlsdGVyZWRJdGVtcy5tYXAoZnVuY3Rpb24oaXRlbSkge1xuXHRcdC8vIFx0XHRcdHJldHVybiB0aGlzLl9ncm91cHNCeUl0ZW1DaWRbaXRlbS5jaWRdO1xuXHRcdC8vIFx0XHR9LCB0aGlzKSk7XG5cdFx0Ly8gXHRcdHRoaXMuX2dyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uKGdyb3VwKSB7XG5cdFx0Ly8gXHRcdFx0dGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoZ3JvdXApLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJleGNsdWRlZFwiLCB0aGlzLl9maWx0ZXJlZEdyb3Vwcy5pbmRleE9mKGdyb3VwKSA9PSAtMSk7XG5cdFx0Ly8gXHRcdH0sIHRoaXMpO1xuXHRcdC8vIFx0fVxuXHRcdC8vIH1cblx0fSxcblx0Ki9cblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBGaWx0ZXIgaW1wbCAyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIC8qKiBAb3ZlcnJpZGUgKi9cblx0Ly8gcmVuZGVyRmlsdGVyRm5fMjogZnVuY3Rpb24oKSB7XG5cdC8vIFx0RmlsdGVyYWJsZUxpc3RWaWV3LnByb3RvdHlwZS5yZW5kZXJGaWx0ZXJGbl8yLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdC8vIH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjb21wdXRlRmlsdGVyOiBmdW5jdGlvbigpIHtcblx0XHRGaWx0ZXJhYmxlTGlzdFZpZXcucHJvdG90eXBlLmNvbXB1dGVGaWx0ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdGlmICh0aGlzLl9ncm91cGluZ0ZuKSB7XG5cdFx0XHRpZiAodGhpcy5fZmlsdGVyZWRJdGVtcy5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHR0aGlzLl9maWx0ZXJlZEdyb3VwcyA9IHRoaXMuX2dyb3Vwcy5jb25jYXQoKTsgLy9bXTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuX2ZpbHRlcmVkR3JvdXBzID0gXy51bmlxKHRoaXMuX2ZpbHRlcmVkSXRlbXMubWFwKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fZ3JvdXBzQnlJdGVtQ2lkW2l0ZW0uY2lkXTtcblx0XHRcdFx0fSwgdGhpcykpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGFwcGx5RmlsdGVyOiBmdW5jdGlvbigpIHtcblx0XHRGaWx0ZXJhYmxlTGlzdFZpZXcucHJvdG90eXBlLmFwcGx5RmlsdGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR0aGlzLl9ncm91cHMuZm9yRWFjaChmdW5jdGlvbihncm91cCkge1xuXHRcdFx0dGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoZ3JvdXApLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJleGNsdWRlZFwiLCAodGhpcy5fZmlsdGVyZWRHcm91cHMuaW5kZXhPZihncm91cCkgPT0gLTEpKTtcblx0XHR9LCB0aGlzKTtcblx0fSxcblxuXHQvLyBjb21wdXRlRmlsdGVyZWQ6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdEZpbHRlcmFibGVMaXN0Vmlldy5wcm90b3R5cGUuY29tcHV0ZUZpbHRlcmVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdC8vIH0sXG5cdC8vXG5cdC8vIHJlbmRlckZpbHRlcmVkOiBmdW5jdGlvbigpIHtcblx0Ly8gXHRGaWx0ZXJhYmxlTGlzdFZpZXcucHJvdG90eXBlLnJlbmRlckZpbHRlcmVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdC8vIH0sXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdyb3VwaW5nTGlzdFZpZXc7IiwiLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL0NhbnZhc1Byb2dyZXNzTWV0ZXJ9ICovXG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvQ2FudmFzUHJvZ3Jlc3NNZXRlcjNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvU1ZHUGF0aFByb2dyZXNzTWV0ZXJ9ICovXG4vLyBtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvU1ZHUGF0aFByb2dyZXNzTWV0ZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvU1ZHQ2lyY2xlUHJvZ3Jlc3NNZXRlcn0gKi9cbi8vIG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9wcm9ncmVzcy9TVkdDaXJjbGVQcm9ncmVzc01ldGVyXCIpO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9TZWxlY3RhYmxlTGlzdFZpZXdcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmUuYmFieXNpdHRlcn0gKi9cbnZhciBDb250YWluZXIgPSByZXF1aXJlKFwiYmFja2JvbmUuYmFieXNpdHRlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9EZWZhdWx0U2VsZWN0YWJsZVJlbmRlcmVyfSAqL1xudmFyIERlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0RlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQ2xpY2thYmxlUmVuZGVyZXJ9ICovXG52YXIgQ2xpY2thYmxlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0NsaWNrYWJsZVJlbmRlcmVyXCIpO1xuXG52YXIgU2VsZWN0YWJsZUxpc3RWaWV3ID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwic2VsZWN0YWJsZUxpc3RcIixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwidWxcIixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJsaXN0IHNlbGVjdGFibGVcIixcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlcn0gKi9cblx0cmVuZGVyZXI6IERlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXIsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dGhpcy5fZW5hYmxlZCA9IHRydWU7XG5cdFx0dGhpcy5fY2hpbGRyZW5JbnZhbGlkID0gdHJ1ZTtcblxuXHRcdG9wdGlvbnMucmVuZGVyZXIgJiYgKHRoaXMucmVuZGVyZXIgPSBvcHRpb25zLnJlbmRlcmVyKTtcblx0XHR0aGlzLnNob3dFbXB0eSA9ICEhb3B0aW9ucy5zaG93RW1wdHk7XG5cdFx0dGhpcy5pdGVtVmlld3MgPSBuZXcgQ29udGFpbmVyKCk7XG5cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwgXCJhZGQgcmVtb3ZlIHJlc2V0XCIsIHRoaXMuX29uQ29sbGVjdGlvbkNoYW5nZSk7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMucmVtb3ZlQ2hpbGRyZW4oKTtcblx0XHRWaWV3LnByb3RvdHlwZS5yZW1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfb25Db2xsZWN0aW9uQ2hhbmdlOiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMuX2NoaWxkcmVuSW52YWxpZCA9IHRydWU7XG5cdFx0dGhpcy5yZW5kZXIoKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX2NoaWxkcmVuSW52YWxpZCkge1xuXHRcdFx0dGhpcy5fY2hpbGRyZW5JbnZhbGlkID0gZmFsc2U7XG5cdFx0XHR0aGlzLmNyZWF0ZUNoaWxkcmVuKCk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0c2V0RW5hYmxlZDogZnVuY3Rpb24oZW5hYmxlZCkge1xuXHRcdGlmICh0aGlzLl9lbmFibGVkICE9PSBlbmFibGVkKSB7XG5cdFx0XHR0aGlzLl9lbmFibGVkID0gZW5hYmxlZDtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImRpc2FibGVkXCIsICF0aGlzLl9lbmFibGVkKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogQ2hpbGQgdmlld3Ncblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Y3JlYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBlbHRCdWZmZXIsIHZpZXc7XG5cblx0XHR0aGlzLnJlbW92ZUNoaWxkcmVuKCk7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSBcIlwiO1xuXG5cdFx0aWYgKHRoaXMuY29sbGVjdGlvbi5sZW5ndGgpIHtcblx0XHRcdGVsdEJ1ZmZlciA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblx0XHRcdGlmICh0aGlzLnNob3dFbXB0eSkge1xuXHRcdFx0XHR2aWV3ID0gdGhpcy5jcmVhdGVFbXB0eVZpZXcoKTtcblx0XHRcdFx0ZWx0QnVmZmVyLmFwcGVuZENoaWxkKHZpZXcucmVuZGVyKCkuZWwpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5jb2xsZWN0aW9uLmVhY2goZnVuY3Rpb24obW9kZWwsIGluZGV4LCBhcnIpIHtcblx0XHRcdFx0dmlldyA9IHRoaXMuY3JlYXRlSXRlbVZpZXcobW9kZWwsIGluZGV4KTtcblx0XHRcdFx0ZWx0QnVmZmVyLmFwcGVuZENoaWxkKHZpZXcucmVuZGVyKCkuZWwpO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0XHR0aGlzLmVsLmFwcGVuZENoaWxkKGVsdEJ1ZmZlcik7XG5cdFx0fVxuXHR9LFxuXG5cdGNyZWF0ZUl0ZW1WaWV3OiBmdW5jdGlvbihtb2RlbCwgaW5kZXgpIHtcblx0XHR2YXIgdmlldyA9IG5ldyh0aGlzLnJlbmRlcmVyKSh7XG5cdFx0XHRtb2RlbDogbW9kZWxcblx0XHR9KTtcblx0XHR0aGlzLml0ZW1WaWV3cy5hZGQodmlldyk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh2aWV3LCBcInJlbmRlcmVyOmNsaWNrXCIsIHRoaXMub25JdGVtVmlld0NsaWNrKTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHRyZW1vdmVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5pdGVtVmlld3MuZWFjaCh0aGlzLnJlbW92ZUl0ZW1WaWV3LCB0aGlzKTtcblx0fSxcblxuXHRyZW1vdmVJdGVtVmlldzogZnVuY3Rpb24odmlldykge1xuXHRcdHRoaXMuc3RvcExpc3RlbmluZyh2aWV3KTtcblx0XHR0aGlzLml0ZW1WaWV3cy5yZW1vdmUodmlldyk7XG5cdFx0dmlldy5yZW1vdmUoKTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBDaGlsZCBldmVudCBoYW5kbGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQHByaXZhdGUgKi9cblx0b25JdGVtVmlld0NsaWNrOiBmdW5jdGlvbihpdGVtKSB7XG5cdFx0aWYgKHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZCAhPT0gaXRlbSAmJiB0aGlzLl9lbmFibGVkKSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpvbmVcIiwgaXRlbSk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIEVtcHR5IHZpZXdcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Y3JlYXRlRW1wdHlWaWV3OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBTZWxlY3RhYmxlTGlzdFZpZXcuRW1wdHlSZW5kZXJlcih7XG5cdFx0XHRtb2RlbDogdGhpcy5jb2xsZWN0aW9uXG5cdFx0fSk7XG5cdFx0dGhpcy5pdGVtVmlld3MuYWRkKHZpZXcpO1xuXHRcdHRoaXMubGlzdGVuVG8odmlldywgXCJyZW5kZXJlcjpjbGlja1wiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuX2VuYWJsZWQgJiYgdGhpcy50cmlnZ2VyKFwidmlldzpzZWxlY3Q6bm9uZVwiKTtcblx0XHR9KTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcbn0sIHtcblx0RW1wdHlSZW5kZXJlcjogQ2xpY2thYmxlUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHR0YWdOYW1lOiBcImxpXCIsXG5cdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdGNsYXNzTmFtZTogXCJsaXN0LWl0ZW0gZW1wdHktaXRlbVwiLFxuXG5cdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJzZWxlY3RlZCBkZXNlbGVjdGVkXCIsIHRoaXMucmVuZGVyQ2xhc3NMaXN0KTtcblx0XHRcdHRoaXMucmVuZGVyQ2xhc3NMaXN0KCk7XG5cdFx0fSxcblxuXHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5lbC5pbm5lckhUTUwgPSBcIjxhIGhyZWY9XFxcIiNjbGVhclxcXCI+PGI+IDwvYj48L2E+XCI7XG5cdFx0XHR0aGlzLnJlbmRlckNsYXNzTGlzdCgpO1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fSxcblxuXHRcdHJlbmRlckNsYXNzTGlzdDogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJzZWxlY3RlZFwiLCB0aGlzLm1vZGVsLnNlbGVjdGVkSW5kZXggPT09IC0xKTtcblx0XHR9LFxuXHR9KVxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gU2VsZWN0YWJsZUxpc3RWaWV3O1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9wcm9ncmVzcy9DYW52YXNQcm9ncmVzc01ldGVyXG4gKi9cblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbi8vIHZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG4vLyB2YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3fSAqL1xudmFyIENhbnZhc1ZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3XCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9JbnRlcnBvbGF0b3J9ICovXG4vLyB2YXIgSW50ZXJwb2xhdG9yID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvSW50ZXJwb2xhdG9yXCIpO1xuXG4vLyB2YXIgQVJDX0VSUiA9IDAuMDAwMDE7XG4vLyB2YXIgQVJDX0VSUiA9IDAuMDtcbi8vIHZhciBQSSA9IE1hdGguUEk7XG52YXIgUEkyID0gTWF0aC5QSSAqIDI7XG5cbnZhciBHQVBfQVJDID0gUEkyIC8gNDg7XG4vLyB2YXIgQ0FQX1NDQUxFID0gMjsgLy8gY2FwIGFyYyA9IEdBUF9BUkMgKiBDQVBfU0NBTEVcbi8vIHZhciBXQUlUX0NZQ0xFX1ZBTFVFID0gMTtcbi8vIHZhciBXQUlUX0NZQ0xFX01TID0gMzAwOyAvLyBtaWxsaXNlY29uZHMgcGVyIGludGVycG9sYXRpb24gbG9vcFxuXG52YXIgQVJDX0RFRkFVTFRTID0ge1xuXHRcImFtb3VudFwiOiB7XG5cdFx0bGluZVdpZHRoOiAwLjgsXG5cdFx0cmFkaXVzT2Zmc2V0OiAwXG5cdH0sXG5cdFwibm90LWF2YWlsYWJsZVwiOiB7XG5cdFx0bGluZVdpZHRoOiAxLjAsXG5cdFx0bGluZURhc2g6IFswLjMsIDAuN11cblx0fSxcblx0XCJhdmFpbGFibGVcIjoge1xuXHRcdGxpbmVXaWR0aDogMC44LFxuXHRcdGludmVyc2U6IFwibm90LWF2YWlsYWJsZVwiXG5cdH0sXG59O1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvQ2FudmFzUHJvZ3Jlc3NNZXRlcn1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBDYW52YXNWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJjYW52YXNQcm9ncmVzc01ldGVyXCIsXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjbGFzc05hbWU6IFwicHJvZ3Jlc3MtbWV0ZXIgY2FudmFzLXByb2dyZXNzLW1ldGVyXCIsXG5cblx0ZGVmYXVsdEtleTogXCJhbW91bnRcIixcblxuXHRkZWZhdWx0czoge1xuXHRcdHZhbHVlczoge1xuXHRcdFx0YW1vdW50OiAwLFxuXHRcdFx0YXZhaWxhYmxlOiAwLFxuXHRcdFx0X2xvb3A6IDAsXG5cdFx0fSxcblx0XHRtYXhWYWx1ZXM6IHtcblx0XHRcdGFtb3VudDogMSxcblx0XHRcdGF2YWlsYWJsZTogMSxcblx0XHR9LFxuXHRcdHVzZU9wYXF1ZTogdHJ1ZSxcblx0XHRsYWJlbEZuOiBmdW5jdGlvbih2YWx1ZSwgbWF4KSB7XG5cdFx0XHRyZXR1cm4gKCh2YWx1ZSAvIG1heCkgKiAxMDApIHwgMDtcblx0XHR9LFxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGNoaWxkcmVuL2xheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHQvLyBUT0RPOiBjbGVhbnVwIG9wdGlvbnMgbWVzcyBpbiBDYW52YXNWaWV3XG5cdFx0Q2FudmFzVmlldy5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdC8vIG9wdGlvbnMgPSBfLmRlZmF1bHRzKG9wdGlvbnMsIHRoaXMuZGVmYXVsdHMpO1xuXG5cdFx0dGhpcy5fbGFiZWxGbiA9IG9wdGlvbnMubGFiZWxGbjtcblx0XHR0aGlzLl92YWx1ZVN0eWxlcyA9IHt9O1xuXHRcdHRoaXMuX2NhbnZhc1NpemUgPSBudWxsO1xuXHRcdHRoaXMuX2NhbnZhc09yaWdpbiA9IG51bGw7XG5cdH0sXG5cblx0bWVhc3VyZUNhbnZhczogZnVuY3Rpb24odywgaCkge1xuXHRcdHRoaXMuX2NhbnZhc0hlaWdodCA9IHRoaXMuX2NhbnZhc1dpZHRoID0gTWF0aC5taW4odGhpcy5fY2FudmFzV2lkdGgsIHRoaXMuX2NhbnZhc0hlaWdodCk7XG5cdH0sXG5cblx0X3VwZGF0ZUNhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0Q2FudmFzVmlldy5wcm90b3R5cGUuX3VwZGF0ZUNhbnZhcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0Ly8gc2l6ZSwgbGluZXMsIGdhcHMsIGRhc2hlcyAodGhpcy5fdmFsdWVTdHlsZXMsIEdBUF9BUkMsIHRoaXMuX2FyY1JhZGl1cylcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHZhciBhcmNOYW1lLCBhcmNPYmosIGFyY0RlZmF1bHQ7XG5cdFx0dmFyIG1hcExpbmVEYXNoID0gZnVuY3Rpb24obikge1xuXHRcdFx0cmV0dXJuIG4gKiB0aGlzLnJhZGl1cyAqIEdBUF9BUkM7XG5cdFx0fTtcblx0XHR2YXIgc3VtRm4gPSBmdW5jdGlvbihzLCBuKSB7XG5cdFx0XHRyZXR1cm4gcyArIG47XG5cdFx0fTtcblxuXHRcdHRoaXMuX2NhbnZhc1NpemUgPSBNYXRoLm1pbih0aGlzLl9jYW52YXNXaWR0aCwgdGhpcy5fY2FudmFzSGVpZ2h0KTsgLy8gLyB0aGlzLl9jYW52YXNSYXRpbztcblx0XHR0aGlzLl9tYXhEYXNoQXJjID0gMDtcblxuXHRcdGZvciAoYXJjTmFtZSBpbiBBUkNfREVGQVVMVFMpIHtcblx0XHRcdGFyY0RlZmF1bHQgPSBBUkNfREVGQVVMVFNbYXJjTmFtZV07XG5cdFx0XHRhcmNPYmogPSB0aGlzLl92YWx1ZVN0eWxlc1thcmNOYW1lXSA9IHt9O1xuXHRcdFx0YXJjT2JqLmludmVyc2UgPSBhcmNEZWZhdWx0LmludmVyc2U7IC8vIGNvcHkgaW52ZXJzZSBrZXlcblx0XHRcdC8vIGFyY09iai5pbnZlcnNlMiA9IGFyY0RlZmF1bHQuaW52ZXJzZTI7XG5cdFx0XHRhcmNPYmoubGluZVdpZHRoID0gYXJjRGVmYXVsdC5saW5lV2lkdGggKiB0aGlzLl9jYW52YXNSYXRpbztcblx0XHRcdGFyY09iai5yYWRpdXMgPSAodGhpcy5fY2FudmFzU2l6ZSAtIGFyY09iai5saW5lV2lkdGgpIC8gMjtcblx0XHRcdGlmIChhcmNEZWZhdWx0LnJhZGl1c09mZnNldCkge1xuXHRcdFx0XHRhcmNPYmoucmFkaXVzICs9IGFyY0RlZmF1bHQucmFkaXVzT2Zmc2V0ICogdGhpcy5fY2FudmFzUmF0aW87XG5cdFx0XHR9XG5cdFx0XHRpZiAoYXJjRGVmYXVsdC5saW5lRGFzaCAmJiBhcmNEZWZhdWx0LmxpbmVEYXNoLmxlbmd0aCkge1xuXHRcdFx0XHRhcmNPYmoubGluZURhc2ggPSBhcmNEZWZhdWx0LmxpbmVEYXNoLm1hcChtYXBMaW5lRGFzaCwgYXJjT2JqKTtcblx0XHRcdFx0YXJjT2JqLmxpbmVEYXNoQXJjID0gYXJjRGVmYXVsdC5saW5lRGFzaFswXSAqIEdBUF9BUkM7XG5cdFx0XHRcdGFyY09iai5saW5lRGFzaExlbmd0aCA9IGFyY09iai5saW5lRGFzaC5yZWR1Y2Uoc3VtRm4pO1xuXHRcdFx0XHR0aGlzLl9tYXhEYXNoQXJjID0gTWF0aC5tYXgodGhpcy5fbWF4RGFzaEFyYywgYXJjT2JqLmxpbmVEYXNoQXJjKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGFyY09iai5saW5lRGFzaEFyYyA9IDA7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gYmFzZWxpbmVTaGlmdFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ly8gTk9URTogQ2VudGVyIGJhc2VsaW5lOiB1c2UgYXNjZW50IGRhdGEgdG8gY2VudGVyIHRvIHgtaGVpZ2h0LCBvciBzb3J0LW9mLlxuXHRcdC8vIHdpdGggYXNjZW50L2Rlc2NlbnQgdmFsdWVzICgwLjcsIC0wLjMpLCB4LWhlaWdodCBpcyAwLjRcblx0XHR2YXIgbU9iaiA9IHRoaXMuX2dldEZvbnRNZXRyaWNzKHRoaXMuX2ZvbnRGYW1pbHkpO1xuXHRcdHRoaXMuX2Jhc2VsaW5lU2hpZnQgPSBtT2JqID8gKG1PYmouYXNjZW50ICsgbU9iai5kZXNjZW50KSAvIG1PYmoudW5pdHNQZXJFbSA6IDAuNzsgLy8gZGVmYXVsdCB2YWx1ZVxuXHRcdHRoaXMuX2Jhc2VsaW5lU2hpZnQgKj0gdGhpcy5fZm9udFNpemUgKiAwLjU7IC8vIGFwcGx5IHRvIGZvbnQtc2l6ZSwgaGFsdmUgaXRcblx0XHR0aGlzLl9iYXNlbGluZVNoaWZ0ID0gTWF0aC5yb3VuZCh0aGlzLl9iYXNlbGluZVNoaWZ0KTtcblxuXHRcdC8vIHNhdmUgY2FudmFzIGNvbnRleHRcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vIHJlc2V0IG1hdHJpeCBhbmQgdHJhbnNsYXRlIDAsMCB0byBjZW50ZXJcblx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHRcdHRoaXMuX2N0eC5zZXRUcmFuc2Zvcm0oMSwgMCwgMCwgMSwgdGhpcy5fY2FudmFzV2lkdGggLyAyLCB0aGlzLl9jYW52YXNIZWlnaHQgLyAyKTtcblx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHByaXZhdGVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZWRyYXc6IGZ1bmN0aW9uKGNvbnRleHQsIGludGVycG9sYXRvcikge1xuXHRcdHRoaXMuX2NsZWFyQ2FudmFzKC10aGlzLl9jYW52YXNXaWR0aCAvIDIsIC10aGlzLl9jYW52YXNIZWlnaHQgLyAyLCB0aGlzLl9jYW52YXNXaWR0aCwgdGhpcy5fY2FudmFzSGVpZ2h0KTtcblxuXHRcdHZhciBsb29wVmFsdWUgPSBpbnRlcnBvbGF0b3IuX3ZhbHVlRGF0YVtcIl9sb29wXCJdLl9yZW5kZXJlZFZhbHVlIHx8IDA7XG5cdFx0dmFyIGFtb3VudERhdGEgPSBpbnRlcnBvbGF0b3IuX3ZhbHVlRGF0YVtcImFtb3VudFwiXTtcblx0XHR2YXIgYXZhaWxhYmxlRGF0YSA9IGludGVycG9sYXRvci5fdmFsdWVEYXRhW1wiYXZhaWxhYmxlXCJdO1xuXG5cdFx0dmFyIGFtb3VudFN0eWxlID0gdGhpcy5fdmFsdWVTdHlsZXNbXCJhbW91bnRcIl07XG5cdFx0dmFyIGF2YWlsYWJsZVN0eWxlID0gdGhpcy5fdmFsdWVTdHlsZXNbXCJhdmFpbGFibGVcIl07XG5cblx0XHQvLyBhbW91bnQgbGFiZWxcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuZHJhd0xhYmVsKHRoaXMuX2xhYmVsRm4oYW1vdW50RGF0YS5fcmVuZGVyZWRWYWx1ZSwgYW1vdW50RGF0YS5fbWF4VmFsKSk7XG5cblx0XHQvLyBzYXZlIGN0eCBiZWZvcmUgZHJhd2luZyBhcmNzXG5cdFx0dGhpcy5fY3R4LnNhdmUoKTtcblxuXHRcdC8vIGxvb3Agcm90YXRpb25cblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vIGlmIChpbnRlcnBvbGF0b3IucmVuZGVyZWRLZXlzICYmIChpbnRlcnBvbGF0b3IucmVuZGVyZWRLZXlzLmluZGV4T2YoXCJhbW91bnRcIikgIT09IC0xKSkge1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCIlczo6cmVkcmF3IChfbG9vcCkgbWF4OiAlcyBsYXN0OiAlcyBjdXJyOiAlc1wiLCB0aGlzLmNpZCxcblx0XHQvLyBcdFx0YW1vdW50RGF0YS5fbWF4VmFsLFxuXHRcdC8vIFx0XHRhbW91bnREYXRhLl9sYXN0UmVuZGVyZWRWYWx1ZSxcblx0XHQvLyBcdFx0YW1vdW50RGF0YS5fcmVuZGVyZWRWYWx1ZVxuXHRcdC8vIFx0KTtcblx0XHQvLyB9XG5cdFx0aWYgKGludGVycG9sYXRvci5yZW5kZXJlZEtleXMgJiYgKGludGVycG9sYXRvci5yZW5kZXJlZEtleXMuaW5kZXhPZihcImFtb3VudFwiKSAhPT0gLTEpICYmIChhbW91bnREYXRhLl9sYXN0UmVuZGVyZWRWYWx1ZSA+IGFtb3VudERhdGEuX3JlbmRlcmVkVmFsdWUpKSB7XG5cdFx0XHQvLyB0cmlnZ2VyIGxvb3Bcblx0XHRcdGludGVycG9sYXRvci52YWx1ZVRvKDEsIDAsIFwiX2xvb3BcIik7XG5cdFx0XHRpbnRlcnBvbGF0b3IudmFsdWVUbygwLCA3NTAsIFwiX2xvb3BcIik7XG5cdFx0XHRpbnRlcnBvbGF0b3IudXBkYXRlVmFsdWUoXCJfbG9vcFwiKTtcblx0XHR9XG5cdFx0dGhpcy5fY3R4LnJvdGF0ZShQSTIgKiAoKDEgLSBsb29wVmFsdWUpIC0gMC4yNSkpO1xuXG5cdFx0Ly8gYW1vdW50IGFyY1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIGFtb3VudEdhcEFyYyA9IEdBUF9BUkM7XG5cdFx0dmFyIGFtb3VudEVuZEFyYyA9IDA7XG5cdFx0dmFyIGFtb3VudFZhbHVlID0gbG9vcFZhbHVlICsgYW1vdW50RGF0YS5fcmVuZGVyZWRWYWx1ZSAvIGFtb3VudERhdGEuX21heFZhbDtcblxuXHRcdGlmIChhbW91bnRWYWx1ZSA+IDApIHtcblx0XHRcdGFtb3VudEVuZEFyYyA9IHRoaXMuZHJhd0FyYyhhbW91bnRTdHlsZSwgYW1vdW50VmFsdWUsIGFtb3VudEdhcEFyYywgUEkyIC0gYW1vdW50R2FwQXJjKTtcblx0XHRcdHRoaXMuZHJhd0VuZENhcChhbW91bnRTdHlsZSwgYW1vdW50RW5kQXJjKTtcblx0XHRcdGFtb3VudEVuZEFyYyA9IGFtb3VudEVuZEFyYyArIGFtb3VudEdhcEFyYyAqIDI7XG5cdFx0fVxuXG5cdFx0Ly8gYXZhaWxhYmxlIGFyY1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIHN0ZXBzTnVtID0gYXZhaWxhYmxlRGF0YS5sZW5ndGggfHwgMTtcblx0XHR2YXIgc3RlcEJhc2VBcmMgPSBQSTIgLyBzdGVwc051bTtcblx0XHR2YXIgc3RlcEFkanVzdEFyYyA9IHN0ZXBCYXNlQXJjICUgR0FQX0FSQztcblx0XHR2YXIgc3RlcEdhcEFyYyA9IEdBUF9BUkMgKyAoc3RlcEFkanVzdEFyYyAtIGF2YWlsYWJsZVN0eWxlLmxpbmVEYXNoQXJjKSAvIDI7XG5cblx0XHRpZiAoQXJyYXkuaXNBcnJheShhdmFpbGFibGVEYXRhKSkge1xuXHRcdFx0Zm9yICh2YXIgbywgaSA9IDA7IGkgPCBzdGVwc051bTsgaSsrKSB7XG5cdFx0XHRcdG8gPSBhdmFpbGFibGVEYXRhW2ldO1xuXHRcdFx0XHR0aGlzLmRyYXdBcmMoYXZhaWxhYmxlU3R5bGUsIG8uX3JlbmRlcmVkVmFsdWUgLyAoby5fbWF4VmFsIC8gc3RlcHNOdW0pLCAoaSAqIHN0ZXBCYXNlQXJjKSArIHN0ZXBHYXBBcmMsICgoaSArIDEpICogc3RlcEJhc2VBcmMpIC0gc3RlcEdhcEFyYywgYW1vdW50RW5kQXJjKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5kcmF3QXJjKGF2YWlsYWJsZVN0eWxlLCBhdmFpbGFibGVEYXRhLl9yZW5kZXJlZFZhbHVlIC8gYXZhaWxhYmxlRGF0YS5fbWF4VmFsLCBzdGVwR2FwQXJjLCBQSTIgLSBzdGVwR2FwQXJjLCBhbW91bnRFbmRBcmMpO1xuXHRcdH1cblx0XHQvLyByZXN0b3JlIGN0eCBhZnRlciBkcmF3aW5nIGFyY3Ncblx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHR9LFxuXG5cdGRyYXdBcmM6IGZ1bmN0aW9uKHZhbHVlU3R5bGUsIHZhbHVlLCBzdGFydEFyYywgZW5kQXJjLCBwcmV2QXJjKSB7XG5cdFx0dmFyIHZhbEFyYywgaW52U3R5bGUsXG5cdFx0XHR2YWxTdGFydEFyYywgdmFsRW5kQXJjLFxuXHRcdFx0aW52U3RhcnRBcmMsIGludkVuZEFyYztcblx0XHRwcmV2QXJjIHx8IChwcmV2QXJjID0gMCk7XG5cblx0XHR2YWxBcmMgPSBlbmRBcmMgLSBzdGFydEFyYztcblx0XHR2YWxFbmRBcmMgPSBzdGFydEFyYyArICh2YWxBcmMgKiB2YWx1ZSk7XG5cdFx0dmFsU3RhcnRBcmMgPSBNYXRoLm1heChzdGFydEFyYywgcHJldkFyYyk7XG5cdFx0aWYgKHZhbEVuZEFyYyA+IHZhbFN0YXJ0QXJjKSB7XG5cdFx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXHRcdFx0dGhpcy5hcHBseVZhbHVlU3R5bGUodmFsdWVTdHlsZSk7XG5cdFx0XHR0aGlzLl9jdHguYmVnaW5QYXRoKCk7XG5cdFx0XHR0aGlzLl9jdHguYXJjKDAsIDAsIHZhbHVlU3R5bGUucmFkaXVzLCB2YWxFbmRBcmMsIHZhbFN0YXJ0QXJjLCB0cnVlKTtcblx0XHRcdHRoaXMuX2N0eC5zdHJva2UoKTtcblx0XHRcdHRoaXMuX2N0eC5yZXN0b3JlKCk7XG5cdFx0fVxuXHRcdC8vIGlmIHRoZXJlJ3MgdmFsdWVTdHlsZSwgZHJhdyByZXN0IG9mIHNwYW4sIG1pbnVzIHByZXZBcmMgb3ZlcmxhcCB0b29cblx0XHRpZiAodmFsdWVTdHlsZS5pbnZlcnNlICE9PSB2b2lkIDApIHtcblx0XHRcdGludlN0eWxlID0gdGhpcy5fdmFsdWVTdHlsZXNbdmFsdWVTdHlsZS5pbnZlcnNlXTtcblx0XHRcdGludkVuZEFyYyA9IHZhbEVuZEFyYyArICh2YWxBcmMgKiAoMSAtIHZhbHVlKSk7XG5cdFx0XHRpbnZTdGFydEFyYyA9IE1hdGgubWF4KHZhbEVuZEFyYywgcHJldkFyYyk7XG5cdFx0XHRpZiAoaW52RW5kQXJjID4gaW52U3RhcnRBcmMpIHtcblx0XHRcdFx0dGhpcy5fY3R4LnNhdmUoKTtcblx0XHRcdFx0dGhpcy5hcHBseVZhbHVlU3R5bGUoaW52U3R5bGUpO1xuXHRcdFx0XHR0aGlzLl9jdHguYmVnaW5QYXRoKCk7XG5cdFx0XHRcdHRoaXMuX2N0eC5hcmMoMCwgMCwgaW52U3R5bGUucmFkaXVzLCBpbnZFbmRBcmMsIGludlN0YXJ0QXJjLCB0cnVlKTtcblx0XHRcdFx0dGhpcy5fY3R4LnN0cm9rZSgpO1xuXHRcdFx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gdmFsRW5kQXJjO1xuXHR9LFxuXG5cdGFwcGx5VmFsdWVTdHlsZTogZnVuY3Rpb24oc3R5bGVPYmopIHtcblx0XHR0aGlzLl9jdHgubGluZVdpZHRoID0gc3R5bGVPYmoubGluZVdpZHRoO1xuXHRcdGlmIChzdHlsZU9iai5saW5lRGFzaCkge1xuXHRcdFx0dGhpcy5fY3R4LnNldExpbmVEYXNoKHN0eWxlT2JqLmxpbmVEYXNoKTtcblx0XHR9XG5cdFx0aWYgKHN0eWxlT2JqLmxpbmVEYXNoT2Zmc2V0KSB7XG5cdFx0XHR0aGlzLl9jdHgubGluZURhc2hPZmZzZXQgPSBzdHlsZU9iai5saW5lRGFzaE9mZnNldDtcblx0XHR9XG5cdH0sXG5cblx0ZHJhd0xhYmVsOiBmdW5jdGlvbihsYWJlbFN0cmluZykge1xuXHRcdHZhciBsYWJlbFdpZHRoID0gdGhpcy5fY3R4Lm1lYXN1cmVUZXh0KGxhYmVsU3RyaW5nKS53aWR0aDtcblx0XHR0aGlzLl9jdHguZmlsbFRleHQobGFiZWxTdHJpbmcsXG5cdFx0XHRsYWJlbFdpZHRoICogLTAuNSxcblx0XHRcdHRoaXMuX2Jhc2VsaW5lU2hpZnQsIGxhYmVsV2lkdGgpO1xuXHR9LFxuXG5cdGRyYXdFbmRDYXA6IGZ1bmN0aW9uKHZhbHVlU3R5bGUsIGFyY1Bvcykge1xuXHRcdHZhciByYWRpdXMgPSB2YWx1ZVN0eWxlLnJhZGl1cztcblx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXHRcdHRoaXMuX2N0eC5saW5lV2lkdGggPSB2YWx1ZVN0eWxlLmxpbmVXaWR0aDtcblxuXHRcdHRoaXMuX2N0eC5yb3RhdGUoYXJjUG9zIC0gR0FQX0FSQyAqIDEuNSk7XG5cdFx0dGhpcy5fY3R4LmJlZ2luUGF0aCgpO1xuXHRcdHRoaXMuX2N0eC5hcmMoMCwgMCwgcmFkaXVzLCBHQVBfQVJDICogMC41LCBHQVBfQVJDICogMiwgZmFsc2UpO1xuXHRcdHRoaXMuX2N0eC5saW5lVG8ocmFkaXVzIC0gKEdBUF9BUkMgKiByYWRpdXMpLCAwKTtcblx0XHR0aGlzLl9jdHguY2xvc2VQYXRoKCk7XG5cblx0XHR0aGlzLl9jdHguZmlsbCgpO1xuXHRcdHRoaXMuX2N0eC5zdHJva2UoKTtcblx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHR9LFxufSk7XG5cbmlmIChERUJVRykge1xuXHRtb2R1bGUuZXhwb3J0cy5wcm90b3R5cGUuX2xvZ0ZsYWdzID0gXCJcIjtcbn0iLCIvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb259ICovXG52YXIgYnVuZGxlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uXCIpO1xuXG4vLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG4vLyAgdXRpbHNcbi8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblxuZnVuY3Rpb24gaW5zZXJ0Q1NTUnVsZShzaGVldCwgc2VsZWN0b3IsIHN0eWxlKSB7XG5cdHZhciBjc3NUZXh0ID0gXCJcIjtcblx0Zm9yICh2YXIgcHJvcCBpbiBzdHlsZSkge1xuXHRcdGNzc1RleHQgKz0gcHJvcCArIFwiOlwiICsgc3R5bGVbcHJvcF0gKyBcIjtcIjtcblx0fVxuXHRzaGVldC5pbnNlcnRSdWxlKHNlbGVjdG9yICsgXCJ7XCIgKyBjc3NUZXh0ICsgXCJ9XCIsIHNoZWV0LmNzc1J1bGVzLmxlbmd0aCk7XG59XG5cbmZ1bmN0aW9uIHNlbGZBbmREZXNjZW5kYW50KHNlbGZDbHMsIGNscykge1xuXHRyZXR1cm4gc2VsZkNscyArIFwiIFwiICsgY2xzICsgXCIsIFwiICsgc2VsZkNscyArIGNscztcbn1cblxuLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuLy8gIHJvb3QgcnVsZXNcbi8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblxudmFyIHJvb3RTdHlsZXMgPSBbXG5cdFwiY29sb3JcIixcblx0XCJiYWNrZ3JvdW5kXCIsXG5cdFwiYmFja2dyb3VuZC1jb2xvclwiLFxuXHQvLyBcIi0tbGluay1jb2xvclwiXG5dO1xuXG5mdW5jdGlvbiBpbml0Um9vdFN0eWxlcyhzaGVldCwgcm9vdFNlbGVjdG9yLCBhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnKSB7XG5cdHZhciBzLCByZXZTZWxlY3RvciwgZmdDb2xvclZhbCwgYmdDb2xvclZhbDtcblx0Ly8gdmFyIHJldkZnQ29sb3JWYWwsIHJldkJnQ29sb3JWYWw7XG5cblx0cyA9IF8ucGljayhhdHRycywgcm9vdFN0eWxlcyk7XG5cdHNbXCItd2Via2l0LWZvbnQtc21vb3RoaW5nXCJdID0gKGhhc0RhcmtCZyA/IFwiYW50aWFsaWFzZWRcIiA6IFwiYXV0b1wiKTtcblx0LyogTk9URTogSW4gRmlyZWZveCAnLW1vei1vc3gtZm9udC1zbW9vdGhpbmc6IGdyYXlzY2FsZTsnXG5cdC8qIHdvcmtzIGJvdGggaW4gbGlnaHQgb3ZlciBkYXJrIGFuZCBkYXJrIG92ZXIgbGlnaHQsIGhhcmRjb2RlZCBpbiBfYmFzZS5zY3NzICovXG5cdC8vc1tcIi1tb3otb3N4LWZvbnQtc21vb3RoaW5nXCJdID0gKGhhc0RhcmtCZz8gXCJncmF5c2NhbGVcIiA6IFwiYXV0b1wiKTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yLCBzKTtcblxuXHQvLyBBIGVsZW1lbnRcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRzID0ge31cblx0c1tcImNvbG9yXCJdID0gbG5Db2xvci5yZ2JTdHJpbmcoKTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yICsgXCIgYVwiLCBzKTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yICsgXCIgLmNvbG9yLWxuXCIsIHMpO1xuXG5cdC8vIC5jb2xvci1mZzA1XG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0cyA9IHt9O1xuXHRzW1wiY29sb3JcIl0gPSBmZ0NvbG9yLmNsb25lKCkubWl4KGJnQ29sb3IsIDAuNSkucmdiU3RyaW5nKCk7XG5cdHNbXCJib3JkZXItY29sb3JcIl0gPSBmZ0NvbG9yLmNsb25lKCkubWl4KGJnQ29sb3IsIDAuNykucmdiU3RyaW5nKCk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHJvb3RTZWxlY3RvciArIFwiIC5jb2xvci1mZzA1XCIsIHMpO1xuXG5cdGZnQ29sb3JWYWwgPSBmZ0NvbG9yLnJnYlN0cmluZygpO1xuXHRiZ0NvbG9yVmFsID0gYmdDb2xvci5yZ2JTdHJpbmcoKTtcblx0Ly8gcmV2RmdDb2xvclZhbCA9IGJnQ29sb3IuY2xvbmUoKS5taXgoZmdDb2xvciwgMC45KS5yZ2JTdHJpbmcoKTtcblx0Ly8gcmV2QmdDb2xvclZhbCA9IGZnQ29sb3IuY2xvbmUoKS5taXgoYmdDb2xvciwgMC42KS5yZ2JTdHJpbmcoKTtcblx0cmV2U2VsZWN0b3IgPSByb290U2VsZWN0b3IgKyBcIiAuY29sb3ItcmV2ZXJzZVwiO1xuXG5cdC8vIC5jb2xvci1mZyAuY29sb3ItYmdcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRzID0ge1xuXHRcdFwiY29sb3JcIjogZmdDb2xvclZhbFxuXHR9O1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCByb290U2VsZWN0b3IgKyBcIiAuY29sb3ItZmdcIiwgcyk7XG5cdHMgPSB7XG5cdFx0XCJiYWNrZ3JvdW5kLWNvbG9yXCI6IGJnQ29sb3JWYWxcblx0fTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yICsgXCIgLmNvbG9yLWJnXCIsIHMpO1xuXHQvLyBodG1sIGludmVydGVkIHRleHQvYmFja2dyb3VuZFxuXHRzID0ge1xuXHRcdFwiY29sb3JcIjogYmdDb2xvclZhbFxuXHR9OyAvLyBzID0geyBcImNvbG9yXCIgOiByZXZGZ0NvbG9yVmFsIH07XG5cdHNbXCItd2Via2l0LWZvbnQtc21vb3RoaW5nXCJdID0gKGhhc0RhcmtCZyA/IFwiYXV0b1wiIDogXCJhbnRpYWxpYXNlZFwiKTtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIiAuY29sb3ItZmdcIiwgcyk7XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJldlNlbGVjdG9yICsgXCIuY29sb3ItZmdcIiwgcyk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHNlbGZBbmREZXNjZW5kYW50KHJldlNlbGVjdG9yLCBcIi5jb2xvci1mZ1wiKSwgcyk7XG5cblx0cyA9IHtcblx0XHRcImJhY2tncm91bmQtY29sb3JcIjogZmdDb2xvclZhbFxuXHR9O1xuXHQvLyBzID0geyBcImJhY2tncm91bmQtY29sb3JcIiA6IHJldkJnQ29sb3JWYWwgfTtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIiAuY29sb3ItYmdcIiwgcyk7XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJldlNlbGVjdG9yICsgXCIuY29sb3ItYmdcIiwgcyk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHNlbGZBbmREZXNjZW5kYW50KHJldlNlbGVjdG9yLCBcIi5jb2xvci1iZ1wiKSwgcyk7XG5cblx0Ly8gLmNvbG9yLXN0cm9rZSAuY29sb3ItZmlsbCAoU1ZHKVxuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdHMgPSB7XG5cdFx0XCJzdHJva2VcIjogZmdDb2xvclZhbFxuXHR9O1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCByb290U2VsZWN0b3IgKyBcIiAuY29sb3Itc3Ryb2tlXCIsIHMpO1xuXHRzID0ge1xuXHRcdFwiZmlsbFwiOiBiZ0NvbG9yVmFsXG5cdH07XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHJvb3RTZWxlY3RvciArIFwiIC5jb2xvci1maWxsXCIsIHMpO1xuXHQvLyBzdmcgaW52ZXJ0ZWQgZmlsbC9zdHJva2Vcblx0cyA9IHtcblx0XHRcInN0cm9rZVwiOiBiZ0NvbG9yVmFsXG5cdH07XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJldlNlbGVjdG9yICsgXCIgLmNvbG9yLXN0cm9rZVwiLCBzKTtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIi5jb2xvci1zdHJva2VcIiwgcyk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHNlbGZBbmREZXNjZW5kYW50KHJldlNlbGVjdG9yLCBcIi5jb2xvci1zdHJva2VcIiksIHMpO1xuXHRzID0ge1xuXHRcdFwiZmlsbFwiOiBmZ0NvbG9yVmFsXG5cdH07XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJldlNlbGVjdG9yICsgXCIgLmNvbG9yLWZpbGxcIiwgcyk7XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJldlNlbGVjdG9yICsgXCIuY29sb3ItZmlsbFwiLCBzKTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgc2VsZkFuZERlc2NlbmRhbnQocmV2U2VsZWN0b3IsIFwiLmNvbG9yLWZpbGxcIiksIHMpO1xuXG5cdC8vIC50ZXh0LW91dGxpbmVcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHQvLyBzID0ge1xuXHQvLyBcdFwidGV4dC1zaGFkb3dcIjogXCItMXB4IC0xcHggMCBcIiArIGJnQ29sb3JWYWwgK1xuXHQvLyBcdFx0XCIsIDFweCAtMXB4IDAgXCIgKyBiZ0NvbG9yVmFsICtcblx0Ly8gXHRcdFwiLCAtMXB4IDFweCAwIFwiICsgYmdDb2xvclZhbCArXG5cdC8vIFx0XHRcIiwgMXB4IDFweCAwIFwiICsgYmdDb2xvclZhbFxuXHQvLyB9O1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByb290U2VsZWN0b3IgKyBcIiA6bm90KC4uY29sbGFwc2VkLWNoYW5naW5nKSAudGV4dC1vdXRsaW5lLWJnXCIsIHMpO1xuXG59XG5cbi8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cbi8vIGNhcm91c2VsIHN0eWxlc1xuLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXG52YXIgY2Fyb3VzZWxTdHlsZXMgPSBbXCJib3gtc2hhZG93XCIsIFwiYm9yZGVyXCIsIFwiYm9yZGVyLXJhZGl1c1wiXTtcblxuZnVuY3Rpb24gaW5pdENhcm91c2VsU3R5bGVzKHNoZWV0LCBjYXJvdXNlbFNlbGVjdG9yLCBhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnKSB7XG5cdHZhciBzID0gXy5waWNrKGF0dHJzLCBjYXJvdXNlbFN0eWxlcyk7IC8vLCBcImJhY2tncm91bmQtY29sb3JcIl0pO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCBjYXJvdXNlbFNlbGVjdG9yICsgXCIgLm1lZGlhLWl0ZW0gLmNvbnRlbnRcIiwgcyk7XG5cblx0Ly8gLm1lZGlhLWl0ZW0gLmNvbG9yLWJnMDlcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRzID0ge307XG5cdHNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdID0gYmdDb2xvci5jbG9uZSgpLm1peChmZ0NvbG9yLCAwLjk1KS5yZ2JTdHJpbmcoKTtcblx0Ly8gc1tcImJhY2tncm91bmQtY29sb3JcIl0gPSBiZ0NvbG9yLmNsb25lKClbaGFzRGFya0JnID8gXCJkYXJrZW5cIiA6IFwibGlnaHRlblwiXSgwLjA0NSkucmdiU3RyaW5nKCk7XG5cdC8vIHNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdID0gYmdDb2xvci5jbG9uZSgpW2hhc0RhcmtCZyA/IFwibGlnaHRlblwiIDogXCJkYXJrZW5cIl0oMC4wMykucmdiU3RyaW5nKCk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIGNhcm91c2VsU2VsZWN0b3IgKyBcIiAubWVkaWEtaXRlbSAuY29sb3ItYmcwOVwiLCBzKTtcblxuXHQvLyAubWVkaWEtaXRlbSAucGxhY2Vob2xkZXJcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRzID0ge307XG5cdHNbXCItd2Via2l0LWZvbnQtc21vb3RoaW5nXCJdID0gKGhhc0RhcmtCZyA/IFwiYXV0b1wiIDogXCJhbnRpYWxpYXNlZFwiKTtcblx0Ly8gdGV4dCBjb2xvciBsdW1pbm9zaXR5IGlzIGludmVyc2UgZnJvbSBib2R5LCBhcHBseSBvcG9zaXRlIHJlbmRlcmluZyBtb2RlXG5cdHNbXCJjb2xvclwiXSA9IGJnQ29sb3IucmdiU3RyaW5nKCk7XG5cdC8vIHNbXCJjb2xvclwiXSA9IGJnQ29sb3IuY2xvbmUoKVtoYXNEYXJrQmcgPyBcImRhcmtlblwiIDogXCJsaWdodGVuXCJdKDAuMDQ1KS5yZ2JTdHJpbmcoKTtcblx0c1tcImJhY2tncm91bmQtY29sb3JcIl0gPSBiZ0NvbG9yLmNsb25lKCkubWl4KGZnQ29sb3IsIDAuOTUpLnJnYlN0cmluZygpO1xuXHQvLyBzW1wiYmFja2dyb3VuZC1jb2xvclwiXSA9IGJnQ29sb3IuY2xvbmUoKS5taXgoZmdDb2xvciwgMC44KS5hbHBoYSgwLjMpLnJnYmFTdHJpbmcoKTtcblx0Ly8gc1tcImJhY2tncm91bmQtY29sb3JcIl0gPSBiZ0NvbG9yLmNsb25lKClbaGFzRGFya0JnID8gXCJsaWdodGVuXCIgOiBcImRhcmtlblwiXSgwLjAzKS5yZ2JTdHJpbmcoKTtcblx0KFwiYm9yZGVyLXJhZGl1c1wiIGluIGF0dHJzKSAmJiAoc1tcImJvcmRlci1yYWRpdXNcIl0gPSBhdHRyc1tcImJvcmRlci1yYWRpdXNcIl0pO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCBjYXJvdXNlbFNlbGVjdG9yICsgXCIgLm1lZGlhLWl0ZW0gLnBsYWNlaG9sZGVyXCIsIHMpO1xuXG5cdC8vIC5lbXB0eS1pdGVtIEFcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRzID0ge307XG5cdHNbXCJ0ZXh0LWRlY29yYXRpb24tY29sb3JcIl0gPSBmZ0NvbG9yLmNsb25lKCkubWl4KGJnQ29sb3IsIDAuMykucmdiU3RyaW5nKCk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIGNhcm91c2VsU2VsZWN0b3IgKyBcIiAuZW1wdHktaXRlbSBBXCIsIHMpO1xuXHQvLyAvLyAuY29sb3ItZ3JhZGllbnRcblx0Ly8gLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHQvLyBzID0ge307XG5cdC8vIHNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdID0gXCJ0cmFuc3BhcmVudFwiO1xuXHQvLyBzW1wiYmFja2dyb3VuZFwiXSA9IFwibGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgXCIgK1xuXHQvLyBcdFx0YmdDb2xvci5jbG9uZSgpLmFscGhhKDAuMDApLnJnYmFTdHJpbmcoKSArIFwiIDAlLCBcIiArXG5cdC8vIFx0XHRiZ0NvbG9yLmNsb25lKCkuYWxwaGEoMC4xMSkucmdiYVN0cmluZygpICsgXCIgMTAwJSlcIjtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yICsgXCIgLmNvbG9yLWdyYWRpZW50XCIsIHMpO1xuXHQvLyBzID0ge307XG5cdC8vIHNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdID0gXCJ0cmFuc3BhcmVudFwiO1xuXHQvLyBzW1wiYmFja2dyb3VuZFwiXSA9IFwibGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgXCIgK1xuXHQvLyBcdFx0ZmdDb2xvci5jbG9uZSgpLmFscGhhKDAuMDApLnJnYmFTdHJpbmcoKSArIFwiIDAlLCBcIiArXG5cdC8vIFx0XHRmZ0NvbG9yLmNsb25lKCkuYWxwaGEoMC4xMSkucmdiYVN0cmluZygpICsgXCIgMTAwJSlcIjtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIiAuY29sb3ItZ3JhZGllbnRcIiwgcyk7XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJldlNlbGVjdG9yICsgXCIuY29sb3ItZ3JhZGllbnRcIiwgcyk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oKSB7XG5cdHZhciBhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnO1xuXG5cdGF0dHJzID0gR2xvYmFscy5ERUZBVUxUX0NPTE9SUztcblx0ZmdDb2xvciA9IG5ldyBDb2xvcihHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wiY29sb3JcIl0pO1xuXHRiZ0NvbG9yID0gbmV3IENvbG9yKEdsb2JhbHMuREVGQVVMVF9DT0xPUlNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdKTtcblx0bG5Db2xvciA9IG5ldyBDb2xvcihHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wibGluay1jb2xvclwiXSlcblx0aGFzRGFya0JnID0gZmdDb2xvci5sdW1pbm9zaXR5KCkgPiBiZ0NvbG9yLmx1bWlub3NpdHkoKTtcblxuXHR2YXIgY29sb3JTdHlsZXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG5cdGNvbG9yU3R5bGVzLmlkID0gXCJjb2xvcnNcIjtcblx0Y29sb3JTdHlsZXMudHlwZSA9IFwidGV4dC9jc3NcIjtcblx0ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChjb2xvclN0eWxlcyk7XG5cdC8vIHZhciBjb2xvclN0eWxlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJsaW5rI2ZvbGlvXCIpO1xuXG5cdGluaXRSb290U3R5bGVzKGNvbG9yU3R5bGVzLnNoZWV0LCBcIi5hcHBcIixcblx0XHRhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnKTtcblx0aW5pdENhcm91c2VsU3R5bGVzKGNvbG9yU3R5bGVzLnNoZWV0LCBcIi5jYXJvdXNlbFwiLFxuXHRcdGF0dHJzLCBmZ0NvbG9yLCBiZ0NvbG9yLCBsbkNvbG9yLCBoYXNEYXJrQmcpO1xuXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0Ly8gcGVyLWJ1bmRsZSBydWxlc1xuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdGJ1bmRsZXMuZWFjaChmdW5jdGlvbihidW5kbGUpIHtcblx0XHRhdHRycyA9IGJ1bmRsZS5hdHRycygpOyAvL2dldChcImF0dHJzXCIpO1xuXHRcdGZnQ29sb3IgPSBidW5kbGUuY29sb3JzLmZnQ29sb3I7XG5cdFx0YmdDb2xvciA9IGJ1bmRsZS5jb2xvcnMuYmdDb2xvcjtcblx0XHRsbkNvbG9yID0gYnVuZGxlLmNvbG9ycy5sbkNvbG9yO1xuXHRcdGhhc0RhcmtCZyA9IGJ1bmRsZS5jb2xvcnMuaGFzRGFya0JnO1xuXG5cdFx0aW5pdFJvb3RTdHlsZXMoY29sb3JTdHlsZXMuc2hlZXQsXG5cdFx0XHRcIi5hcHAuXCIgKyBidW5kbGUuZ2V0KFwiZG9taWRcIiksXG5cdFx0XHRhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnKTtcblx0XHRpbml0Q2Fyb3VzZWxTdHlsZXMoY29sb3JTdHlsZXMuc2hlZXQsXG5cdFx0XHRcIi5jYXJvdXNlbC5cIiArIGJ1bmRsZS5nZXQoXCJkb21pZFwiKSxcblx0XHRcdGF0dHJzLCBmZ0NvbG9yLCBiZ0NvbG9yLCBsbkNvbG9yLCBoYXNEYXJrQmcpO1xuXHR9KTtcbn07IiwiLypnbG9iYWwgWE1MSHR0cFJlcXVlc3QgKi9cblxuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmUuc3RyaW5nL2xwYWR9ICovXG4vLyB2YXIgY2xhc3NpZnkgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvY2xhc3NpZnlcIik7XG5cbi8vIHZhciBzdGF0dXNNc2cgPSBfLnRlbXBsYXRlKFwiPCU9IHN0YXR1cyAlPiByZWNlaXZlZCBmcm9tIDwlPSB1cmwgJT4gKDwlPSBzdGF0dXNUZXh0ICU+KVwiKTtcbi8vIHZhciBlcnJNc2cgPSBfLnRlbXBsYXRlKFwiJzwlPSBlcnJOYW1lICU+JyBvY3VycmVkIGR1cmluZyByZXF1ZXN0IDwlPSB1cmwgJT5cIik7XG5cbmlmICh3aW5kb3cuWE1MSHR0cFJlcXVlc3QgJiYgd2luZG93LlVSTCAmJiB3aW5kb3cuQmxvYikge1xuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHVybCwgcHJvZ3Jlc3NGbikge1xuXHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cdFx0XHRyZXF1ZXN0Lm9wZW4oXCJHRVRcIiwgdXJsLCB0cnVlKTtcblx0XHRcdC8vIHJlcXVlc3QudGltZW91dCA9IDEwMDAwOyAvLyBpbiBtaWxsaXNlY29uZHNcblx0XHRcdHJlcXVlc3QucmVzcG9uc2VUeXBlID0gXCJibG9iXCI7XG5cblx0XHRcdC8vIGlmIHByb2dyZXNzRm4gaXMgc3VwcGxpZWRcblx0XHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0XHRpZiAocHJvZ3Jlc3NGbikge1xuXHRcdFx0XHRyZXF1ZXN0Lm9ucHJvZ3Jlc3MgPSBmdW5jdGlvbihldikge1xuXHRcdFx0XHRcdHByb2dyZXNzRm4oZXYubG9hZGVkIC8gZXYudG90YWwpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdFx0Ly8gcmVzb2x2ZWQvc3VjY2Vzc1xuXHRcdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHRcdHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0Ly8gV2hlbiB0aGUgcmVxdWVzdCBsb2FkcywgY2hlY2sgd2hldGhlciBpdCB3YXMgc3VjY2Vzc2Z1bFxuXHRcdFx0XHRpZiAocmVxdWVzdC5zdGF0dXMgPT0gMjAwKSB7XG5cdFx0XHRcdFx0Ly8gSWYgc3VjY2Vzc2Z1bCwgcmVzb2x2ZSB0aGUgcHJvbWlzZSBieSBwYXNzaW5nIGJhY2sgYSByZWZlcmVuY2UgdXJsXG5cdFx0XHRcdFx0cmVzb2x2ZShVUkwuY3JlYXRlT2JqZWN0VVJMKHJlcXVlc3QucmVzcG9uc2UpKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YXIgZXJyID0gbmV3IEVycm9yKChcImh0dHBfXCIgKyByZXF1ZXN0LnN0YXR1c1RleHQucmVwbGFjZSgvXFxzL2csIFwiX1wiKSkudG9VcHBlckNhc2UoKSk7XG5cdFx0XHRcdFx0ZXJyLmluZm9Db2RlID0gcmVxdWVzdC5zdGF0dXM7XG5cdFx0XHRcdFx0ZXJyLmluZm9TcmMgPSB1cmw7XG5cdFx0XHRcdFx0ZXJyLmxvZ0V2ZW50ID0gZXY7XG5cdFx0XHRcdFx0ZXJyLmxvZ01lc3NhZ2UgPSBcIl9sb2FkSW1hZ2VBc09iamVjdFVSTDo6XCIgKyBldi50eXBlICsgXCIgW3JlamVjdF1cIjtcblx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdC8vIHJlamVjdC9mYWlsdXJlXG5cdFx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdFx0cmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0dmFyIGVyciA9IG5ldyBFcnJvcigoZXYudHlwZSArIFwiX2V2ZW50XCIpLnRvVXBwZXJDYXNlKCkpO1xuXHRcdFx0XHRlcnIuaW5mb0NvZGUgPSAtMTtcblx0XHRcdFx0ZXJyLmluZm9TcmMgPSB1cmw7XG5cdFx0XHRcdGVyci5sb2dFdmVudCA9IGV2O1xuXHRcdFx0XHRlcnIubG9nTWVzc2FnZSA9IFwiX2xvYWRJbWFnZUFzT2JqZWN0VVJMOjpcIiArIGV2LnR5cGUgKyBcIiBbcmVqZWN0XVwiO1xuXHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdH07XG5cdFx0XHRyZXF1ZXN0Lm9uYWJvcnQgPSByZXF1ZXN0Lm9udGltZW91dCA9IHJlcXVlc3Qub25lcnJvcjtcblx0XHRcdC8vIGZpbmFsbHlcblx0XHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0XHRyZXF1ZXN0Lm9ubG9hZGVuZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXF1ZXN0Lm9uYWJvcnQgPSByZXF1ZXN0Lm9udGltZW91dCA9IHJlcXVlc3Qub25lcnJvciA9IHZvaWQgMDtcblx0XHRcdFx0cmVxdWVzdC5vbmxvYWQgPSByZXF1ZXN0Lm9ubG9hZGVuZCA9IHZvaWQgMDtcblx0XHRcdFx0aWYgKHByb2dyZXNzRm4pIHtcblx0XHRcdFx0XHRyZXF1ZXN0Lm9ucHJvZ3Jlc3MgPSB2b2lkIDA7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cblx0XHRcdHJlcXVlc3Quc2VuZCgpO1xuXHRcdH0pO1xuXHR9O1xufSBlbHNlIHtcblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih1cmwpIHtcblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHVybCk7XG5cdH07XG59IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihpbWFnZSwgcmVzb2x2ZUVtcHR5KSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRpZiAoIShpbWFnZSBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MSW1hZ2VFbGVtZW50KSkge1xuXHRcdFx0Ly9yZWplY3QobmV3IEVycm9yKFwibm90IGFuIEhUTUxJbWFnZUVsZW1lbnRcIikpO1xuXHRcdFx0cmVqZWN0KFwiRXJyb3I6IG5vdCBhbiBIVE1MSW1hZ2VFbGVtZW50XCIpO1xuXHRcdH0gZWxzZSBpZiAoaW1hZ2UuY29tcGxldGUgJiYgKGltYWdlLnNyYy5sZW5ndGggPiAwIHx8IHJlc29sdmVFbXB0eSkpIHtcblx0XHRcdC8vIGlmIChpbWFnZS5zcmMgPT09IFwiXCIpIGNvbnNvbGUud2FybihcIl93aGVuSW1hZ2VMb2FkcyByZXNvbHZlZCB3aXRoIGVtcHR5IHNyY1wiKTtcblx0XHRcdC8vIGVsc2UgY29uc29sZS5sb2coXCJfd2hlbkltYWdlTG9hZHMgcmVzb2x2ZS1zeW5jXCIsIGltYWdlLnNyYyk7XG5cdFx0XHRyZXNvbHZlKGltYWdlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dmFyIGhhbmRsZXJzID0ge1xuXHRcdFx0XHRsb2FkOiBmdW5jdGlvbihldikge1xuXHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiX3doZW5JbWFnZUxvYWRzX2RvbSByZXNvbHZlLWFzeW5jXCIsIGV2LnR5cGUsIGltYWdlLnNyYyk7XG5cdFx0XHRcdFx0cmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcdFx0XHRyZXNvbHZlKGltYWdlKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRcdFx0dmFyIGVyciA9IG5ldyBFcnJvcihcIkxvYWRpbmcgZmFpbGVkIChcIiArIGV2LnR5cGUgKyBcIiBldmVudClcIik7XG5cdFx0XHRcdFx0ZXJyLmluZm9Db2RlID0gLTE7XG5cdFx0XHRcdFx0ZXJyLmluZm9TcmMgPSBpbWFnZS5zcmM7XG5cdFx0XHRcdFx0ZXJyLmxvZ0V2ZW50ID0gZXY7XG5cdFx0XHRcdFx0ZXJyLmxvZ01lc3NhZ2UgPSBcIl93aGVuSW1hZ2VMb2Fkczo6XCIgKyBldi50eXBlICsgXCIgW3JlamVjdF1cIjtcblx0XHRcdFx0XHRyZW1vdmVFdmVudExpc3RlbmVycygpO1xuXHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXHRcdFx0aGFuZGxlcnMuYWJvcnQgPSBoYW5kbGVycy5lcnJvcjtcblx0XHRcdHZhciByZW1vdmVFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRmb3IgKHZhciBldmVudCBpbiBoYW5kbGVycykge1xuXHRcdFx0XHRcdGlmIChoYW5kbGVycy5oYXNPd25Qcm9wZXJ0eShldmVudCkpIHtcblx0XHRcdFx0XHRcdGltYWdlLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnQsIGhhbmRsZXJzW2V2ZW50XSwgZmFsc2UpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdGZvciAodmFyIGV2ZW50IGluIGhhbmRsZXJzKSB7XG5cdFx0XHRcdGlmIChoYW5kbGVycy5oYXNPd25Qcm9wZXJ0eShldmVudCkpIHtcblx0XHRcdFx0XHRpbWFnZS5hZGRFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyc1tldmVudF0sIGZhbHNlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG59O1xuIiwiLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL193aGVuSW1hZ2VMb2Fkc30gKi9cbnZhciBfd2hlbkltYWdlTG9hZHMgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS9fd2hlbkltYWdlTG9hZHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL19sb2FkSW1hZ2VBc09iamVjdFVSTH0gKi9cbnZhciBfbG9hZEltYWdlQXNPYmplY3RVUkwgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS9fbG9hZEltYWdlQXNPYmplY3RVUkxcIik7XG5cbi8vIHZhciBpc0Jsb2JSRSA9IC9eYmxvYlxcOi4qLztcblxuLy8gdmFyIGxvZ01lc3NhZ2UgPSBcIiVzOjp3aGVuRGVmYXVsdEltYWdlTG9hZHMgWyVzXTogJXNcIjtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih2aWV3KSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgc291cmNlID0gdmlldy5tb2RlbC5nZXQoXCJzb3VyY2VcIik7XG5cdFx0aWYgKHNvdXJjZS5oYXMoXCJwcmVmZXRjaGVkXCIpKSB7XG5cdFx0XHR2aWV3LmRlZmF1bHRJbWFnZS5zcmMgPSBzb3VyY2UuZ2V0KFwicHJlZmV0Y2hlZFwiKTtcblx0XHRcdF93aGVuSW1hZ2VMb2Fkcyh2aWV3LmRlZmF1bHRJbWFnZSlcblx0XHRcdFx0LnRoZW4oXG5cdFx0XHRcdFx0ZnVuY3Rpb24odGFyZ2V0RWwpIHtcblx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKGxvZ01lc3NhZ2UsIHZpZXcuY2lkLCBcInJlc29sdmVkXCIsIFwicHJlZmV0Y2hlZFwiKTtcblx0XHRcdFx0XHRcdHJlc29sdmUodmlldyk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZpZXcubWVkaWFTdGF0ZSA9IFwicGVuZGluZ1wiO1xuXG5cdFx0XHR2YXIgc1VybCA9IHNvdXJjZS5nZXQoXCJvcmlnaW5hbFwiKTtcblx0XHRcdHZhciBwcm9ncmVzc0ZuID0gZnVuY3Rpb24ocHJvZ3Jlc3MpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2cobG9nTWVzc2FnZSwgdmlldy5jaWQsIFwicHJvZ3Jlc3NcIiwgcHJvZ3Jlc3MpO1xuXHRcdFx0XHR2aWV3LnVwZGF0ZU1lZGlhUHJvZ3Jlc3MocHJvZ3Jlc3MsIHNVcmwpO1xuXHRcdFx0fTtcblx0XHRcdHByb2dyZXNzRm4gPSBfLnRocm90dGxlKHByb2dyZXNzRm4sIDEwMCwge1xuXHRcdFx0XHRsZWFkaW5nOiB0cnVlLFxuXHRcdFx0XHR0cmFpbGluZzogZmFsc2Vcblx0XHRcdH0pO1xuXHRcdFx0X2xvYWRJbWFnZUFzT2JqZWN0VVJMKHNVcmwsIHByb2dyZXNzRm4pXG5cdFx0XHRcdC50aGVuKFxuXHRcdFx0XHRcdGZ1bmN0aW9uKHVybCkge1xuXHRcdFx0XHRcdFx0aWYgKC9eYmxvYlxcOi4qLy50ZXN0KHVybCkpIHtcblx0XHRcdFx0XHRcdFx0c291cmNlLnNldChcInByZWZldGNoZWRcIiwgdXJsKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHZpZXcuZGVmYXVsdEltYWdlLnNyYyA9IHVybDtcblx0XHRcdFx0XHRcdC8vIFVSTC5yZXZva2VPYmplY3RVUkwodXJsKTtcblx0XHRcdFx0XHRcdHJldHVybiB2aWV3LmRlZmF1bHRJbWFnZTtcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHQudGhlbihfd2hlbkltYWdlTG9hZHMpXG5cdFx0XHRcdC50aGVuKFxuXHRcdFx0XHRcdGZ1bmN0aW9uKHRhcmdldEVsKSB7XG5cdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhsb2dNZXNzYWdlLCB2aWV3LmNpZCwgXCJyZXNvbHZlZFwiLCB0YXJnZXRFbC5zcmMpO1xuXHRcdFx0XHRcdFx0dmlldy5vbihcInZpZXc6cmVtb3ZlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0dmFyIHByZWZldGNoZWQgPSBzb3VyY2UuZ2V0KFwicHJlZmV0Y2hlZFwiKTtcblx0XHRcdFx0XHRcdFx0aWYgKHByZWZldGNoZWQgJiYgL15ibG9iXFw6Ly50ZXN0KHByZWZldGNoZWQpKSB7XG5cdFx0XHRcdFx0XHRcdFx0c291cmNlLnVuc2V0KFwicHJlZmV0Y2hlZFwiLCB7XG5cdFx0XHRcdFx0XHRcdFx0XHRzaWxlbnQ6IHRydWVcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHRVUkwucmV2b2tlT2JqZWN0VVJMKHByZWZldGNoZWQpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdC8vIHZpZXcucGxhY2Vob2xkZXIucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcm9ncmVzc1wiKTtcblx0XHRcdFx0XHRcdC8vIHZpZXcudXBkYXRlTWVkaWFQcm9ncmVzcyhpbWFnZVVybCwgXCJjb21wbGV0ZVwiKTtcblx0XHRcdFx0XHRcdHJlc29sdmUodmlldyk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHQvLyBcdH0pXG5cdFx0XHRcdFx0Ly8gLmNhdGNoKFxuXHRcdFx0XHRcdGZ1bmN0aW9uKGVycikge1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS53YXJuKGxvZ01lc3NhZ2UsIHZpZXcuY2lkLCBcInJlamVjdGVkXCIsIGVyci5tZXNzYWdlKTtcblx0XHRcdFx0XHRcdC8vIHZpZXcucGxhY2Vob2xkZXIucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcm9ncmVzc1wiKTtcblx0XHRcdFx0XHRcdC8vIHZpZXcudXBkYXRlTWVkaWFQcm9ncmVzcyhpbWFnZVVybCwgcHJvZ3Jlc3MpO1xuXHRcdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn07IiwiLyogZ2xvYmFsIFByb21pc2UgKi9cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld0Vycm9yfSAqL1xudmFyIFZpZXdFcnJvciA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdFcnJvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3RXJyb3J9ICovXG52YXIgd2hlblZpZXdJc0F0dGFjaGVkID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblZpZXdJc0F0dGFjaGVkXCIpO1xuXG5mdW5jdGlvbiB3aGVuU2Nyb2xsaW5nRW5kcyh2aWV3KSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHR2YXIgcGFyZW50ID0gdmlldy5wYXJlbnRWaWV3O1xuXHRcdGlmIChwYXJlbnQgPT09IG51bGwpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCIlczo6d2hlblNjcm9sbGluZ0VuZHMgWyVzXSAoc3luYylcIiwgdmlldy5jaWQsIFwicmVqZWN0ZWRcIiwgdmlldy5hdHRhY2hlZCk7XG5cdFx0XHRyZWplY3QobmV3IFZpZXdFcnJvcih2aWV3LCBuZXcgRXJyb3IoXCJ3aGVuU2Nyb2xsaW5nRW5kczogdmlldyBoYXMgbm8gcGFyZW50XCIpKSk7XG5cdFx0fSBlbHNlIGlmICghcGFyZW50LnNjcm9sbGluZykge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6d2hlblNjcm9sbGluZ0VuZHMgWyVzXSAoc3luYylcIiwgdmlldy5jaWQsIFwicmVzb2x2ZWRcIiwgdmlldy5hdHRhY2hlZCk7XG5cdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgY2xlYW51cCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRwYXJlbnQub2ZmKFwidmlldzpzY3JvbGxlbmRcIiwgb25TY3JvbGxlbmQpO1xuXHRcdFx0XHRwYXJlbnQub2ZmKFwidmlldzpyZW1vdmVcIiwgb25SZW1vdmUpO1xuXHRcdFx0fTtcblx0XHRcdHZhciBvblNjcm9sbGVuZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp3aGVuU2Nyb2xsaW5nRW5kcyBbJXNdXCIsIHZpZXcuY2lkLCBcInJlc29sdmVkXCIsIHZpZXcuYXR0YWNoZWQpO1xuXHRcdFx0XHRjbGVhbnVwKCk7XG5cdFx0XHRcdHJlc29sdmUodmlldyk7XG5cdFx0XHR9O1xuXHRcdFx0dmFyIG9uUmVtb3ZlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OndoZW5TY3JvbGxpbmdFbmRzIFslc11cIiwgdmlldy5jaWQsIFwicmVqZWN0ZWRcIiwgdmlldy5hdHRhY2hlZCk7XG5cdFx0XHRcdGNsZWFudXAoKTtcblx0XHRcdFx0cmVqZWN0KG5ldyBWaWV3RXJyb3IodmlldywgbmV3IEVycm9yKFwid2hlblNjcm9sbGluZ0VuZHM6IHZpZXcgd2FzIHJlbW92ZWRcIikpKTtcblx0XHRcdH07XG5cdFx0XHRwYXJlbnQub24oXCJ2aWV3OnNjcm9sbGVuZFwiLCBvblNjcm9sbGVuZCk7XG5cdFx0XHRwYXJlbnQub24oXCJ2aWV3OnJlbW92ZVwiLCBvblJlbW92ZSk7XG5cdFx0fVxuXHR9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih2aWV3KSB7XG5cdHJldHVybiBQcm9taXNlLnJlc29sdmUodmlldylcblx0XHQudGhlbih3aGVuVmlld0lzQXR0YWNoZWQpXG5cdFx0LnRoZW4od2hlblNjcm9sbGluZ0VuZHMpO1xufTtcblxuLypcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odmlldykge1xuXHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZpZXcpXG5cdFx0LnRoZW4oZnVuY3Rpb24odmlldykge1xuXHRcdFx0aWYgKHZpZXcuYXR0YWNoZWQpIHtcblx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRcdFx0dmlldy5vbmNlKFwidmlldzphdHRhY2hlZFwiLCBmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KVxuXHRcdC50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdGlmICghdmlldy5wYXJlbnRWaWV3LnNjcm9sbGluZykge1xuXHRcdFx0XHRyZXR1cm4gdmlldztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdFx0XHR2YXIgcmVzb2x2ZU9uU2Nyb2xsZW5kID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp3aGVuU2Nyb2xsaW5nRW5kcyBbJXNdXCIsIHZpZXcuY2lkLCBcInJlc29sdmVkXCIpO1xuXHRcdFx0XHRcdFx0dmlldy5vZmYoXCJ2aWV3OnJlbW92ZVwiLCByZWplY3RPblJlbW92ZSk7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0dmFyIHJlamVjdE9uUmVtb3ZlID0gZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6d2hlblNjcm9sbGluZ0VuZHMgWyVzXVwiLCB2aWV3LmNpZCwgXCJyZWplY3RlZFwiKTtcblx0XHRcdFx0XHRcdHZpZXcucGFyZW50Vmlldy5vZmYoXCJ2aWV3OnNjcm9sbGVuZFwiLCByZXNvbHZlT25TY3JvbGxlbmQpO1xuXHRcdFx0XHRcdFx0cmVqZWN0KG5ldyBWaWV3RXJyb3Iodmlldyxcblx0XHRcdFx0XHRcdFx0bmV3IEVycm9yKFwid2hlblNlbGVjdFNjcm9sbGluZ0VuZHM6IHZpZXcgd2FzIHJlbW92ZWQgKFwiKyB2aWV3LmNpZCArXCIpXCIpKSk7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR2aWV3LnBhcmVudFZpZXcub25jZShcInZpZXc6c2Nyb2xsZW5kXCIsIHJlc29sdmVPblNjcm9sbGVuZCk7XG5cdFx0XHRcdFx0dmlldy5vbmNlKFwidmlldzpyZW1vdmVcIiwgcmVqZWN0T25SZW1vdmUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9KTtcbn07XG4qL1xuIiwiLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3RXJyb3J9ICovXG52YXIgVmlld0Vycm9yID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld0Vycm9yXCIpO1xuXG4vLyB2YXIgbG9nTWVzc2FnZSA9IFwiJXM6OndoZW5TZWxlY3Rpb25EaXN0YW5jZUlzIFslc106ICVzXCI7XG5cbi8qKlxuICogQHBhcmFtIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fVxuICogQHBhcmFtIHtudW1iZXJ9IGRpc3RhbmNlXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odmlldywgZGlzdGFuY2UpIHtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdC8vIGlmICghKHZpZXcubW9kZWwgJiYgdmlldy5tb2RlbC5jb2xsZWN0aW9uKSkge1xuXHRcdC8vIFx0cmVqZWN0KG5ldyBWaWV3RXJyb3IodmlldywgbmV3IEVycm9yKFwid2hlblNlbGVjdGlvbklzQ29udGlndW91czogbW9kZWwuY29sbGVjdGlvbiBpcyBlbXB0eVwiKSkpO1xuXHRcdC8vIH1cblx0XHR2YXIgbW9kZWwgPSB2aWV3Lm1vZGVsO1xuXHRcdHZhciBjb2xsZWN0aW9uID0gbW9kZWwuY29sbGVjdGlvbjtcblxuXHRcdHZhciBjaGVjayA9IGZ1bmN0aW9uKG4pIHsgLy8gQ2hlY2sgaW5kaWNlcyBmb3IgY29udGlndWl0eVxuXHRcdFx0cmV0dXJuIE1hdGguYWJzKGNvbGxlY3Rpb24uaW5kZXhPZihtb2RlbCkgLSBjb2xsZWN0aW9uLnNlbGVjdGVkSW5kZXgpIDw9IGRpc3RhbmNlO1xuXHRcdH07XG5cblx0XHRpZiAoY2hlY2soKSkge1xuXHRcdFx0Ly8gY29uc29sZS5sb2cobG9nTWVzc2FnZSwgdmlldy5jaWQsIFwicmVzb2x2ZVwiLCBcInN5bmNcIik7XG5cdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgY2xlYW51cE9uU2V0dGxlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKGxvZ01lc3NhZ2UsIHZpZXcuY2lkLCBcImNsZWFudXBcIiwgXCJhc3luY1wiKTtcblx0XHRcdFx0Y29sbGVjdGlvbi5vZmYoXCJzZWxlY3Q6b25lIHNlbGVjdDpub25lXCIsIHJlc29sdmVPblNlbGVjdCk7XG5cdFx0XHRcdHZpZXcub2ZmKFwidmlldzpyZW1vdmVkXCIsIHJlamVjdE9uUmVtb3ZlKTtcblx0XHRcdH07XG5cdFx0XHR2YXIgcmVzb2x2ZU9uU2VsZWN0ID0gZnVuY3Rpb24obW9kZWwpIHtcblx0XHRcdFx0aWYgKGNoZWNrKCkpIHtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhsb2dNZXNzYWdlLCB2aWV3LmNpZCwgXCJyZXNvbHZlXCIsIFwiYXN5bmNcIik7XG5cdFx0XHRcdFx0Y2xlYW51cE9uU2V0dGxlKCk7XG5cdFx0XHRcdFx0cmVzb2x2ZSh2aWV3KTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdHZhciByZWplY3RPblJlbW92ZSA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0Y2xlYW51cE9uU2V0dGxlKCk7XG5cdFx0XHRcdHJlamVjdChuZXcgVmlld0Vycm9yKHZpZXcsIG5ldyBFcnJvcihcIndoZW5TZWxlY3Rpb25EaXN0YW5jZUlzOiB2aWV3IHdhcyByZW1vdmVkXCIpKSk7XG5cdFx0XHR9O1xuXHRcdFx0Y29sbGVjdGlvbi5vbihcInNlbGVjdDpvbmUgc2VsZWN0Om5vbmVcIiwgcmVzb2x2ZU9uU2VsZWN0KTtcblx0XHRcdHZpZXcub24oXCJ2aWV3OnJlbW92ZWRcIiwgcmVqZWN0T25SZW1vdmUpO1xuXHRcdH1cblx0fSk7XG59O1xuIiwiLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3RXJyb3J9ICovXG4vLyB2YXIgVmlld0Vycm9yID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld0Vycm9yXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3Rpb25EaXN0YW5jZUlzfSAqL1xudmFyIHdoZW5TZWxlY3Rpb25EaXN0YW5jZUlzID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblNlbGVjdGlvbkRpc3RhbmNlSXNcIik7XG5cbi8qKiBAcGFyYW0ge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0cmV0dXJuIHdoZW5TZWxlY3Rpb25EaXN0YW5jZUlzKHZpZXcsIDEpO1xufTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdGlmICh2aWV3LmF0dGFjaGVkKSB7XG5cdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2aWV3Lm9uKFwidmlldzphdHRhY2hlZFwiLCBmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdHJlc29sdmUodmlldyk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH0pO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odmlldykge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0aWYgKCF2aWV3LmludmFsaWRhdGVkKSB7XG5cdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2aWV3Lm9uY2UoXCJ2aWV3OnJlbmRlcjphZnRlclwiLCBmdW5jdGlvbih2aWV3LCBmbGFncykge1xuXHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn07IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L3JlbmRlci9DYXJvdXNlbFJlbmRlcmVyXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgZ2V0Qm94RWRnZVN0eWxlcyA9IHJlcXVpcmUoXCJ1dGlscy9jc3MvZ2V0Qm94RWRnZVN0eWxlc1wiKTtcblxuLy8gRklYTUU6IHRoaXMgZml4dXAgc2hvdWxkIG5vdCBiZSBkb25lIGhlcmVcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL25ldC90b0Fic29sdXRlVVJMfSAqL1xuLy8gdmFyIHRvQWJzb2x1dGVVUkwgPSByZXF1aXJlKFwidXRpbHMvbmV0L3RvQWJzb2x1dGVVUkxcIik7XG4vLyAvKiogQHR5cGUge3N0cmluZ30gKi9cbi8vIHZhciBBQlNfQVBQX1JPT1QgPSB0b0Fic29sdXRlVVJMKHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpLkFQUF9ST09UKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0Nhcm91c2VsUmVuZGVyZXJ9XG4gKi9cbnZhciBDYXJvdXNlbFJlbmRlcmVyID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwiY2Fyb3VzZWxSZW5kZXJlclwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwiZGl2XCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImNhcm91c2VsLWl0ZW1cIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0ZW1wbGF0ZTogXy50ZW1wbGF0ZShcIjxkaXYgY2xhc3M9XFxcImNvbnRlbnQgc2l6aW5nXFxcIj48JT0gbmFtZSAlPjwvZGl2PlwiKSxcblxuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0Y29udGVudDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2NvbnRlbnQgfHwgKHRoaXMuX2NvbnRlbnQgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudFwiKSk7XG5cdFx0XHR9LFxuXHRcdH0sXG5cdFx0c2l6aW5nOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fc2l6aW5nIHx8ICh0aGlzLl9zaXppbmcgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIuc2l6aW5nXCIpKTtcblx0XHRcdH0sXG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdGlmICh0aGlzLm1vZGVsLmF0dHIoXCJAY2xhc3NuYW1lXCIpICE9PSB2b2lkIDApIHtcblx0XHRcdHZhciBjbHNBdHRyID0gdGhpcy5tb2RlbC5hdHRyKFwiQGNsYXNzbmFtZVwiKS5zcGxpdChcIiBcIik7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGNsc0F0dHIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKGNsc0F0dHJbaV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRvcHRpb25zLnBhcmVudFZpZXcgJiYgKHRoaXMucGFyZW50VmlldyA9IG9wdGlvbnMucGFyZW50Vmlldyk7XG5cdFx0dGhpcy5tZXRyaWNzID0ge307XG5cdFx0dGhpcy5tZXRyaWNzLmNvbnRlbnQgPSB7fTtcblx0XHR0aGlzLmNyZWF0ZUNoaWxkcmVuKCk7XG5cdFx0Ly8gdGhpcy5lbmFibGVkID0gISFvcHRpb25zLmVuYWJsZWQ7IC8vIGZvcmNlIGJvb2xcblx0XHR0aGlzLnNldEVuYWJsZWQoISFvcHRpb25zLmVuYWJsZWQpO1xuXHR9LFxuXG5cdGNyZWF0ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsLmlubmVySFRNTCA9IHRoaXMudGVtcGxhdGUodGhpcy5tb2RlbC50b0pTT04oKSk7XG5cdFx0Ly8gRklYTUU6IHRoaXMgZml4dXAgc2hvdWxkIG5vdCBiZSBkb25lIGhlcmVcblx0XHQvLyBGSVhFRDogbm93IGRvbmUgaW4geHNsdFxuXHRcdC8qdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiYVtocmVmXVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHR2YXIgdXJsID0gdG9BYnNvbHV0ZVVSTChlbC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpKTtcblx0XHRcdGlmICh1cmwuaW5kZXhPZihBQlNfQVBQX1JPT1QpICE9PSAwKSB7XG5cdFx0XHRcdGVsLnNldEF0dHJpYnV0ZShcInRhcmdldFwiLCBcIl9ibGFua1wiKTtcblx0XHRcdH1cblx0XHR9KTsqL1xuXHR9LFxuXG5cdC8qKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gKi9cblx0Z2V0U2l6aW5nRWw6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLl9zaXppbmcgfHwgKHRoaXMuX3NpemluZyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5zaXppbmdcIikpO1xuXHR9LFxuXG5cdC8qKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gKi9cblx0Z2V0Q29udGVudEVsOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5fY29udGVudCB8fCAodGhpcy5fY29udGVudCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5jb250ZW50XCIpKTtcblx0fSxcblxuXHQvKiogQHJldHVybiB7dGhpc30gKi9cblx0bWVhc3VyZTogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHNpemluZyA9IHRoaXMuZ2V0U2l6aW5nRWwoKTtcblxuXHRcdHRoaXMubWV0cmljcyA9IGdldEJveEVkZ2VTdHlsZXModGhpcy5lbCwgdGhpcy5tZXRyaWNzKTtcblx0XHR0aGlzLm1ldHJpY3MuY29udGVudCA9IGdldEJveEVkZ2VTdHlsZXModGhpcy5nZXRDb250ZW50RWwoKSwgdGhpcy5tZXRyaWNzLmNvbnRlbnQpO1xuXG5cdFx0c2l6aW5nLnN0eWxlLm1heFdpZHRoID0gXCJcIjtcblx0XHRzaXppbmcuc3R5bGUubWF4SGVpZ2h0ID0gXCJcIjtcblxuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LnggPSBzaXppbmcub2Zmc2V0TGVmdCArIHNpemluZy5jbGllbnRMZWZ0O1xuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LnkgPSBzaXppbmcub2Zmc2V0VG9wICsgc2l6aW5nLmNsaWVudFRvcDtcblx0XHR0aGlzLm1ldHJpY3MuY29udGVudC53aWR0aCA9IHNpemluZy5jbGllbnRXaWR0aDtcblx0XHR0aGlzLm1ldHJpY3MuY29udGVudC5oZWlnaHQgPSBzaXppbmcuY2xpZW50SGVpZ2h0O1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMubWVhc3VyZSgpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGdldFNlbGVjdGlvbkRpc3RhbmNlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gTWF0aC5hYnModGhpcy5tb2RlbC5jb2xsZWN0aW9uLmluZGV4T2YodGhpcy5tb2RlbCkgLSB0aGlzLm1vZGVsLmNvbGxlY3Rpb24uc2VsZWN0ZWRJbmRleCk7XG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYXJvdXNlbFJlbmRlcmVyOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXJcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvTGFiZWxSZW5kZXJlcn0gKi9cbnZhciBMYWJlbFJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9MYWJlbFJlbmRlcmVyXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXJ9XG4gKi9cbnZhciBDbGlja2FibGVSZW5kZXJlciA9IExhYmVsUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcImNsaWNrYWJsZVJlbmRlcmVyXCIsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRldmVudHM6IHtcblx0XHRcImNsaWNrXCI6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJyZW5kZXJlcjpjbGlja1wiLCB0aGlzLm1vZGVsLCBldik7XG5cdFx0fSxcblx0XHRcImNsaWNrIGFcIjogZnVuY3Rpb24oZXYpIHtcblx0XHRcdGV2LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZXYucHJldmVudERlZmF1bHQoKTtcblx0XHR9XG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBDbGlja2FibGVSZW5kZXJlcjtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxLCBoZWxwZXIsIGFsaWFzMT1kZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LCBhbGlhczI9aGVscGVycy5oZWxwZXJNaXNzaW5nLCBhbGlhczM9XCJmdW5jdGlvblwiO1xuXG4gIHJldHVybiBcIjxhIGhyZWY9XFxcIiNcIlxuICAgICsgY29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24oKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5kb21pZCB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuZG9taWQgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcImRvbWlkXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIlxcXCI+PHNwYW4gY2xhc3M9XFxcImxhYmVsXFxcIj5cIlxuICAgICsgKChzdGFjazEgPSAoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLm5hbWUgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLm5hbWUgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcIm5hbWVcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIjwvc3Bhbj48L2E+XCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlclxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9DbGlja2FibGVSZW5kZXJlcn0gKi9cbnZhciBDbGlja2FibGVSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXJcIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9EZWZhdWx0U2VsZWN0YWJsZVJlbmRlcmVyfVxuICovXG52YXIgRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlciA9IENsaWNrYWJsZVJlbmRlcmVyLmV4dGVuZCh7XG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0YWdOYW1lOiBcImxpXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImxpc3QtaXRlbVwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRlbXBsYXRlOiByZXF1aXJlKFwiLi9EZWZhdWx0U2VsZWN0YWJsZVJlbmRlcmVyLmhic1wiKSxcblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkIGRlc2VsZWN0ZWRcIiwgdGhpcy5fcmVuZGVyQ2xhc3NMaXN0KTtcblx0XHR0aGlzLl9yZW5kZXJDbGFzc0xpc3QoKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwudG9KU09OKCkpO1xuXHRcdHRoaXMuX3JlbmRlckNsYXNzTGlzdCgpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdF9yZW5kZXJDbGFzc0xpc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcInNlbGVjdGVkXCIsIHRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHR9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlcjtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWhlbHBlcnMuaGVscGVyTWlzc2luZywgYWxpYXMzPVwiZnVuY3Rpb25cIiwgYWxpYXM0PWNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uO1xuXG4gIHJldHVybiBcIjxzcGFuIGNsYXNzPVxcXCJsYWJlbFxcXCI+XCJcbiAgICArIGFsaWFzNCgoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLm5hbWUgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLm5hbWUgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcIm5hbWVcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiPC9zcGFuPjxhIGhyZWY9XFxcIiNcIlxuICAgICsgYWxpYXM0KCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuZG9taWQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmRvbWlkIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJkb21pZFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiPjxiPiA8L2I+PC9hPlwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL0RvdE5hdmlnYXRpb25SZW5kZXJlclxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG4vLyB2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vKiogQHR5cGUge3N0cmluZ30gKi9cbnZhciB2aWV3VGVtcGxhdGUgPSByZXF1aXJlKFwiLi9Eb3ROYXZpZ2F0aW9uUmVuZGVyZXIuaGJzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0NsaWNrYWJsZVJlbmRlcmVyfSAqL1xudmFyIENsaWNrYWJsZVJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9DbGlja2FibGVSZW5kZXJlclwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0RvdE5hdmlnYXRpb25SZW5kZXJlcn1cbiAqL1xudmFyIERvdE5hdmlnYXRpb25SZW5kZXJlciA9IENsaWNrYWJsZVJlbmRlcmVyLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJkb3RSZW5kZXJlclwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwibGlcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwibGlzdC1pdGVtXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGVtcGxhdGU6IHZpZXdUZW1wbGF0ZSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwic2VsZWN0ZWQgZGVzZWxlY3RlZFwiLCB0aGlzLnJlbmRlckNsYXNzTGlzdCk7XG5cdFx0dGhpcy5yZW5kZXJDbGFzc0xpc3QoKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwudG9KU09OKCkpO1xuXHRcdHRoaXMucmVuZGVyQ2xhc3NMaXN0KCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0cmVuZGVyQ2xhc3NMaXN0OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJzZWxlY3RlZFwiLCB0aGlzLm1vZGVsLnNlbGVjdGVkKTtcblx0fSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IERvdE5hdmlnYXRpb25SZW5kZXJlcjtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWhlbHBlcnMuaGVscGVyTWlzc2luZywgYWxpYXMzPVwiZnVuY3Rpb25cIiwgYWxpYXM0PWNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uO1xuXG4gIHJldHVybiBcIjxkaXYgY2xhc3M9XFxcInBsYWNlaG9sZGVyIHNpemluZ1xcXCI+PC9kaXY+XFxuPGltZyBjbGFzcz1cXFwiY29udGVudCBtZWRpYS1ib3JkZXIgZGVmYXVsdFxcXCIgYWx0PVxcXCJcIlxuICAgICsgYWxpYXM0KCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMudGV4dCB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAudGV4dCA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwidGV4dFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiIGxvbmdkZXNjPVxcXCIjZGVzY19tXCJcbiAgICArIGFsaWFzNCgoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLmlkIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5pZCA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwiaWRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiXFxcIiAvPlxcblwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL0ltYWdlUmVuZGVyZXJcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xuLy8gdmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbX0gKi9cbi8vIHZhciBNZWRpYUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9NZWRpYVJlbmRlcmVyfSAqL1xudmFyIE1lZGlhUmVuZGVyZXIgPSByZXF1aXJlKFwiLi9NZWRpYVJlbmRlcmVyXCIpO1xuXG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIHZpZXdUZW1wbGF0ZSA9IHJlcXVpcmUoXCIuL0ltYWdlUmVuZGVyZXIuaGJzXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvSW1hZ2VSZW5kZXJlcn1cbiAqL1xudmFyIEltYWdlUmVuZGVyZXIgPSBNZWRpYVJlbmRlcmVyLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJpbWFnZVJlbmRlcmVyXCIsXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjbGFzc05hbWU6IE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmNsYXNzTmFtZSArIFwiIGltYWdlLXJlbmRlcmVyXCIsXG5cdC8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG5cdHRlbXBsYXRlOiB2aWV3VGVtcGxhdGUsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG5cdFx0TWVkaWFSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdC8vIHRoaXMuY3JlYXRlQ2hpbGRyZW4oKTtcblx0XHQvLyB0aGlzLmluaXRpYWxpemVBc3luYygpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGNoaWxkcmVuL2xheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNyZWF0ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHRNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5jcmVhdGVDaGlsZHJlbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdC8vIHRoaXMuZWwuaW5uZXJIVE1MID0gdGhpcy50ZW1wbGF0ZSh0aGlzLm1vZGVsLnRvSlNPTigpKTtcblx0XHR0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlaG9sZGVyXCIpO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdC8vIHRoaXMubWVhc3VyZSgpO1xuXG5cdFx0dmFyIGltZyA9IHRoaXMuZ2V0RGVmYXVsdEltYWdlKCk7XG5cdFx0aW1nLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIHRoaXMubWV0cmljcy5tZWRpYS53aWR0aCk7XG5cdFx0aW1nLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0KTtcblxuXHRcdHZhciBjb250ZW50ID0gdGhpcy5nZXRDb250ZW50RWwoKTtcblx0XHRjb250ZW50LnN0eWxlLmxlZnQgPSB0aGlzLm1ldHJpY3MuY29udGVudC54ICsgXCJweFwiO1xuXHRcdGNvbnRlbnQuc3R5bGUudG9wID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQueSArIFwicHhcIjtcblxuXHRcdC8vIHZhciBzaXppbmcgPSB0aGlzLmdldFNpemluZ0VsKCk7XG5cdFx0Ly8gc2l6aW5nLnN0eWxlLm1heFdpZHRoID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQud2lkdGggKyBcInB4XCI7XG5cdFx0Ly8gc2l6aW5nLnN0eWxlLm1heEhlaWdodCA9IHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCArIFwicHhcIjtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGluaXRpYWxpemVBc3luY1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRpbml0aWFsaXplQXN5bmM6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplQXN5bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKVxuXHRcdC8vIHJldHVybiBNZWRpYVJlbmRlcmVyLndoZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXModGhpcylcblx0XHQvLyAvLyByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMpXG5cdFx0Ly8gLy8gXHQudGhlbihNZWRpYVJlbmRlcmVyLndoZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXMpXG5cdFx0Ly8gXHQudGhlbihNZWRpYVJlbmRlcmVyLndoZW5TZWxlY3RUcmFuc2l0aW9uRW5kcylcblx0XHQvLyBcdC50aGVuKE1lZGlhUmVuZGVyZXIud2hlbkRlZmF1bHRJbWFnZUxvYWRzKVxuXHRcdC8vIC50aGVuKFxuXHRcdC8vIFx0ZnVuY3Rpb24odmlldykge1xuXHRcdC8vIFx0XHR2aWV3Lm1lZGlhU3RhdGUgPSBcInJlYWR5XCI7XG5cdFx0Ly8gXHR9KVxuXHRcdC8vIC5jYXRjaChcblx0XHQvLyBcdGZ1bmN0aW9uKGVycikge1xuXHRcdC8vIFx0XHRpZiAoZXJyIGluc3RhbmNlb2YgVmlld0Vycm9yKSB7XG5cdFx0Ly8gXHRcdFx0Ly8gTk9URTogaWdub3JlIFZpZXdFcnJvciB0eXBlXG5cdFx0Ly8gXHRcdFx0Ly8gY29uc29sZS5sb2coZXJyLnZpZXcuY2lkLCBlcnIudmlldy5tb2RlbC5jaWQsIFwiSW1hZ2VSZW5kZXJlcjogXCIgKyBlcnIubWVzc2FnZSk7XG5cdFx0Ly8gXHRcdH0gZWxzZSB7XG5cdFx0Ly8gXHRcdFx0Y29uc29sZS5lcnJvcih0aGlzLmNpZCwgZXJyLm5hbWUsIGVycik7XG5cdFx0Ly8gXHRcdFx0dGhpcy5wbGFjZWhvbGRlci5pbm5lckhUTUwgPSBcIjxwIGNsYXNzPVxcXCJjb2xvci1mZ1xcXCIgc3R5bGU9XFxcInBvc2l0aW9uOmFic29sdXRlO2JvdHRvbTowO3BhZGRpbmc6M3JlbTtcXFwiPjxzdHJvbmc+XCIgKyBlcnIubmFtZSArIFwiPC9zdHJvbmc+IFwiICsgZXJyLm1lc3NhZ2UgKyBcIjwvcD5cIjtcblx0XHQvLyBcdFx0XHR0aGlzLm1lZGlhU3RhdGUgPSBcImVycm9yXCI7XG5cdFx0Ly8gXHRcdH1cblx0XHQvLyBcdH0uYmluZCh0aGlzKSlcblx0XHQ7XG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBJbWFnZVJlbmRlcmVyO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L3JlbmRlci9MYWJlbFJlbmRlcmVyXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvTGFiZWxSZW5kZXJlcn1cbiAqL1xudmFyIExhYmVsUmVuZGVyZXIgPSBWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJsYWJlbFJlbmRlcmVyXCIsXG5cblx0cHJvcGVydGllczoge1xuXHRcdGxhYmVsOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fbGFiZWwgfHwgKHRoaXMuX2xhYmVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmxhYmVsXCIpKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Ly8gbWVhc3VyZWRXaWR0aDoge1xuXHRcdC8vIFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHQvLyBcdFx0cmV0dXJuIHRoaXMuX21lYXN1cmVkV2lkdGg7XG5cdFx0Ly8gXHR9XG5cdFx0Ly8gfSxcblx0XHQvLyBtZWFzdXJlZEhlaWdodDoge1xuXHRcdC8vIFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHQvLyBcdFx0cmV0dXJuIHRoaXMuX21lYXN1cmVkSGVpZ2h0O1xuXHRcdC8vIFx0fVxuXHRcdC8vIH0sXG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBtZWFzdXJlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyBfbWVhc3VyZWRXaWR0aDogbnVsbCxcblx0Ly8gX21lYXN1cmVkSGVpZ2h0OiBudWxsLFxuXHQvLyBtZWFzdXJlOiBmdW5jdGlvbigpIHt9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gTGFiZWxSZW5kZXJlcjtcbiIsIi8qZ2xvYmFsIFhNTEh0dHBSZXF1ZXN0LCBIVE1MTWVkaWFFbGVtZW50LCBNZWRpYUVycm9yKi9cbi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvTWVkaWFSZW5kZXJlclxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZS5zdHJpbmdzL2xwYWR9ICovXG52YXIgbHBhZCA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlLnN0cmluZy9scGFkXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXN9ICovXG4vLyB2YXIgZ2V0Qm94RWRnZVN0eWxlcyA9IHJlcXVpcmUoXCJ1dGlscy9jc3MvZ2V0Qm94RWRnZVN0eWxlc1wiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtfSAqL1xudmFyIE1lZGlhSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9NZWRpYUl0ZW1cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9DYXJvdXNlbFJlbmRlcmVyfSAqL1xudmFyIENhcm91c2VsUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0Nhcm91c2VsUmVuZGVyZXJcIik7XG5cbnZhciBlcnJvclRlbXBsYXRlID0gcmVxdWlyZShcIi4uL3RlbXBsYXRlL0Vycm9yQmxvY2suaGJzXCIpO1xuXG52YXIgTWVkaWFSZW5kZXJlciA9IENhcm91c2VsUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcIm1lZGlhUmVuZGVyZXJcIixcblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNsYXNzTmFtZTogQ2Fyb3VzZWxSZW5kZXJlci5wcm90b3R5cGUuY2xhc3NOYW1lICsgXCIgbWVkaWEtaXRlbVwiLFxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvTWVkaWFJdGVtfSAqL1xuXHRtb2RlbDogTWVkaWFJdGVtLFxuXG5cdHByb3BlcnRpZXM6IHtcblx0XHRkZWZhdWx0SW1hZ2U6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9kZWZhdWx0SW1hZ2UgfHwgKHRoaXMuX2RlZmF1bHRJbWFnZSA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcImltZy5kZWZhdWx0XCIpKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdG1lZGlhU3RhdGU6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9tZWRpYVN0YXRlO1xuXHRcdFx0fSxcblx0XHRcdHNldDogZnVuY3Rpb24oc3RhdGUpIHtcblx0XHRcdFx0dGhpcy5fc2V0TWVkaWFTdGF0ZShzdGF0ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuXHRcdC8vIGlmICh0aGlzLm1vZGVsLmF0dHJzKCkuaGFzT3duUHJvcGVydHkoXCJAY2xhc3NuYW1lXCIpKSB7XG5cdFx0Ly8gXHR0aGlzLmVsLmNsYXNzTmFtZSArPSBcIiBcIiArIHRoaXMubW9kZWwuYXR0cihcIkBjbGFzc25hbWVcIik7XG5cdFx0Ly8gfVxuXG5cdFx0Ly8gTk9URTogQGNsYXNzbmFtZSBhdHRyIGhhbmRsaW5nIG1vdmVkIHRvIENhcm91c2VsUmVuZGVyZXJcblx0XHQvLyBpZiAodGhpcy5tb2RlbC5hdHRyKFwiQGNsYXNzbmFtZVwiKSAhPT0gdm9pZCAwKSB7XG5cdFx0Ly8gXHR2YXIgY2xzQXR0ciA9IHRoaXMubW9kZWwuYXR0cihcIkBjbGFzc25hbWVcIikuc3BsaXQoXCIgXCIpO1xuXHRcdC8vIFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjbHNBdHRyLmxlbmd0aDsgaSsrKSB7XG5cdFx0Ly8gXHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChjbHNBdHRyW2ldKTtcblx0XHQvLyBcdH1cblx0XHQvLyB9XG5cdFx0Q2Fyb3VzZWxSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhID0ge307XG5cdFx0dGhpcy5tZWRpYVN0YXRlID0gXCJpZGxlXCI7XG5cblx0XHR0aGlzLmluaXRpYWxpemVBc3luYygpXG5cdFx0XHQudGhlbih0aGlzLndoZW5Jbml0aWFsaXplZClcblx0XHRcdC5jYXRjaCh0aGlzLndoZW5Jbml0aWFsaXplRXJyb3IuYmluZCh0aGlzKSk7XG5cdH0sXG5cblx0aW5pdGlhbGl6ZUFzeW5jOiBmdW5jdGlvbigpIHtcblx0XHQvLyB2YXIgTWVkaWFSZW5kZXJlciA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih0aGlzKS5jb25zdHJ1Y3Rvcjtcblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMpXG5cdFx0XHQudGhlbihNZWRpYVJlbmRlcmVyLndoZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXMpXG5cdFx0XHQudGhlbihNZWRpYVJlbmRlcmVyLndoZW5TY3JvbGxpbmdFbmRzKVxuXHRcdFx0LnRoZW4oTWVkaWFSZW5kZXJlci53aGVuRGVmYXVsdEltYWdlTG9hZHMpO1xuXHR9LFxuXG5cdHdoZW5Jbml0aWFsaXplZDogZnVuY3Rpb24odmlldykge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OndoZW5Jbml0aWFsaXplZCBbJXNdXCIsIHZpZXcuY2lkLCBcInJlc29sdmVkXCIpO1xuXHRcdHZpZXcubWVkaWFTdGF0ZSA9IFwicmVhZHlcIjtcblx0XHR2aWV3LnBsYWNlaG9sZGVyLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHJvZ3Jlc3NcIik7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0d2hlbkluaXRpYWxpemVFcnJvcjogZnVuY3Rpb24oZXJyKSB7XG5cdFx0aWYgKGVyciBpbnN0YW5jZW9mIENhcm91c2VsUmVuZGVyZXIuVmlld0Vycm9yKSB7XG5cdFx0XHQvLyBOT1RFOiBpZ25vcmUgVmlld0Vycm9yIHR5cGVcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OndoZW5Jbml0aWFsaXplRXJyb3JcIiwgZXJyLnZpZXcuY2lkLCBlcnIubWVzc2FnZSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fSBlbHNlIGlmIChlcnIgaW5zdGFuY2VvZiBFcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcihlcnIuc3RhY2spO1xuXHRcdH1cblx0XHR0aGlzLnJlbmRlck1lZGlhRXJyb3IoZXJyKTtcblx0XHR0aGlzLnBsYWNlaG9sZGVyLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHJvZ3Jlc3NcIik7XG5cdFx0dGhpcy5tZWRpYVN0YXRlID0gXCJlcnJvclwiO1xuXHRcdC8vIHRoaXMucGxhY2Vob2xkZXIuaW5uZXJIVE1MID0gZXJyb3JUZW1wbGF0ZShlcnIpO1xuXHRcdC8vIHRoaXMucGxhY2Vob2xkZXIucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcm9ncmVzc1wiKTtcblx0XHQvLyB0aGlzLm1lZGlhU3RhdGUgPSBcImVycm9yXCI7XG5cblx0XHRjb25zb2xlLmVycm9yKFwiJXM6OmluaXRpYWxpemVBc3luYyBbJXMgKGNhdWdodCldOiAlc1wiLCB0aGlzLmNpZCwgZXJyLm5hbWUsXG5cdFx0XHQoZXJyLmluZm8gJiYgZXJyLmluZm8ubG9nTWVzc2FnZSkgfHwgZXJyLm1lc3NhZ2UpO1xuXHRcdGVyci5sb2dFdmVudCAmJiBjb25zb2xlLmxvZyhlcnIubG9nRXZlbnQpO1xuXHR9LFxuXG5cdHJlbmRlck1lZGlhRXJyb3I6IGZ1bmN0aW9uKGVycikge1xuXHRcdHRoaXMucGxhY2Vob2xkZXIuaW5uZXJIVE1MID0gZXJyID8gZXJyb3JUZW1wbGF0ZShlcnIpIDogXCJcIjtcblx0fSxcblxuXHR1cGRhdGVNZWRpYVByb2dyZXNzOiBmdW5jdGlvbihwcm9ncmVzcywgaWQpIHtcblx0XHRpZiAoXy5pc051bWJlcihwcm9ncmVzcykpIHtcblx0XHRcdHRoaXMucGxhY2Vob2xkZXIuc2V0QXR0cmlidXRlKFwiZGF0YS1wcm9ncmVzc1wiLCBscGFkKE1hdGguZmxvb3IocHJvZ3Jlc3MgKiAxMDApLCAyLCAnMCcpKTtcblx0XHR9XG5cdFx0Ly8gZWxzZSBpZiAocHJvZ3Jlc3MgPT09IFwiY29tcGxldGVcIikge1xuXHRcdC8vIFx0dGhpcy5wbGFjZWhvbGRlci5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXByb2dyZXNzXCIpO1xuXHRcdC8vIH1cblx0fSxcblxuXHQvLyB3aGVuTWVkaWFJc1JlYWR5OiBmdW5jdGlvbih2aWV3KSB7XG5cdC8vIFx0cmV0dXJuIE1lZGlhUmVuZGVyZXIud2hlbkRlZmF1bHRJbWFnZUxvYWRzKHRoaXMsIHRoaXMudXBkYXRlTWVkaWFQcm9ncmVzcy5iaW5kKHRoaXMpKTtcblx0Ly8gfSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBjaGlsZCBnZXR0ZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gKi9cblx0Z2V0RGVmYXVsdEltYWdlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5kZWZhdWx0SW1hZ2U7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogY2hpbGRyZW4vbGF5b3V0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGNyZWF0ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsLmlubmVySFRNTCA9IHRoaXMudGVtcGxhdGUodGhpcy5tb2RlbC50b0pTT04oKSk7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRtZWFzdXJlOiBmdW5jdGlvbigpIHtcblx0XHRDYXJvdXNlbFJlbmRlcmVyLnByb3RvdHlwZS5tZWFzdXJlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR2YXIgc3csIHNoOyAvLyBzb3VyY2UgZGltZW5zaW9uc1xuXHRcdHZhciBwY3csIHBjaDsgLy8gbWVhc3VyZWQgdmFsdWVzXG5cdFx0dmFyIGN4LCBjeSwgY3csIGNoLCBjczsgLy8gY29tcHV0ZWQgdmFsdWVzXG5cdFx0dmFyIGV3LCBlaDsgLy8gY29udGVudCBlZGdlIHRvdGFsc1xuXHRcdHZhciBjbTsgLy8gY29udGVudCBtZXRyaWNzXG5cblx0XHRjbSA9IHRoaXMubWV0cmljcy5jb250ZW50O1xuXHRcdGN4ID0gY20ueDtcblx0XHRjeSA9IGNtLnk7XG5cdFx0cGN3ID0gY20ud2lkdGg7XG5cdFx0cGNoID0gY20uaGVpZ2h0O1xuXG5cdFx0ZXcgPSAoY20ucGFkZGluZ0xlZnQgKyBjbS5wYWRkaW5nUmlnaHQgKyBjbS5ib3JkZXJMZWZ0V2lkdGggKyBjbS5ib3JkZXJSaWdodFdpZHRoKTtcblx0XHRlaCA9IChjbS5wYWRkaW5nVG9wICsgY20ucGFkZGluZ0JvdHRvbSArIGNtLmJvcmRlclRvcFdpZHRoICsgY20uYm9yZGVyQm90dG9tV2lkdGgpO1xuXHRcdHBjdyAtPSBldztcblx0XHRwY2ggLT0gZWg7XG5cblx0XHRzdyA9IHRoaXMubW9kZWwuZ2V0KFwic291cmNlXCIpLmdldChcIndcIik7XG5cdFx0c2ggPSB0aGlzLm1vZGVsLmdldChcInNvdXJjZVwiKS5nZXQoXCJoXCIpO1xuXG5cdFx0Ly8gVW5sZXNzIGJvdGggY2xpZW50IGRpbWVuc2lvbnMgYXJlIGxhcmdlciB0aGFuIHRoZSBzb3VyY2Unc1xuXHRcdC8vIGNob29zZSBjb25zdHJhaW50IGRpcmVjdGlvbiBieSBhc3BlY3QgcmF0aW9cblx0XHRpZiAoc3cgPCBwY3cgJiYgc2ggPCBwY2gpIHtcblx0XHRcdGNzID0gMTtcblx0XHRcdGN3ID0gc3c7XG5cdFx0XHRjaCA9IHNoO1xuXHRcdFx0dGhpcy5tZXRyaWNzLmZpdERpcmVjdGlvbiA9IFwiYm90aFwiO1xuXHRcdH0gZWxzZSBpZiAoKHBjdyAvIHBjaCkgPCAoc3cgLyBzaCkpIHtcblx0XHRcdC8vIGZpdCB3aWR0aFxuXHRcdFx0Y3cgPSBwY3c7XG5cdFx0XHRjcyA9IGN3IC8gc3c7XG5cdFx0XHQvLyBjaCA9IGNzICogc2g7XG5cdFx0XHRjaCA9IE1hdGgucm91bmQoY3MgKiBzaCk7XG5cdFx0XHR0aGlzLm1ldHJpY3MuZml0RGlyZWN0aW9uID0gXCJ3aWR0aFwiO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBmaXQgaGVpZ2h0XG5cdFx0XHRjaCA9IHBjaDtcblx0XHRcdGNzID0gY2ggLyBzaDtcblx0XHRcdC8vIGN3ID0gY3MgKiBzdztcblx0XHRcdGN3ID0gTWF0aC5yb3VuZChjcyAqIHN3KTtcblx0XHRcdHRoaXMubWV0cmljcy5maXREaXJlY3Rpb24gPSBcImhlaWdodFwiO1xuXHRcdH1cblxuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LnggPSBjeDtcblx0XHR0aGlzLm1ldHJpY3MuY29udGVudC55ID0gY3k7XG5cdFx0dGhpcy5tZXRyaWNzLmNvbnRlbnQud2lkdGggPSBjdyArIGV3O1xuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCA9IGNoICsgZWg7XG5cblx0XHR0aGlzLm1ldHJpY3MubWVkaWEueCA9IGN4ICsgY20ucGFkZGluZ0xlZnQgKyBjbS5ib3JkZXJMZWZ0V2lkdGg7XG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhLnkgPSBjeSArIGNtLnBhZGRpbmdUb3AgKyBjbS5ib3JkZXJUb3BXaWR0aDtcblx0XHR0aGlzLm1ldHJpY3MubWVkaWEud2lkdGggPSBjdztcblx0XHR0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0ID0gY2g7XG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhLnNjYWxlID0gY3M7XG5cblx0XHRjb25zb2xlLmxvZyhcIiVzOjptZWFzdXJlIG13OiVzIG1oOiVzIGZpdDogJXMgbWV0cmljczogJW9cIiwgdGhpcy5jaWQsIHBjdywgcGNoLCB0aGlzLm1ldHJpY3MuZml0RGlyZWN0aW9uLCB0aGlzLm1ldHJpY3MpO1xuXHRcdC8vIHZhciBzaXppbmcgPSB0aGlzLmdldFNpemluZ0VsKCk7XG5cdFx0Ly8gc2l6aW5nLnN0eWxlLm1heFdpZHRoID0gKGN3ICsgZXcpICsgXCJweFwiO1xuXHRcdC8vIHNpemluZy5zdHlsZS5tYXhIZWlnaHQgPSAoY2ggKyBlaCkgKyBcInB4XCI7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIE5PVEU6IG5vdCBjYWxsaW5nIHN1cGVyLnJlbmRlciwgY2FsbGluZyBtZWFzdXJlIG91cnNlbHZlc1xuXHRcdHRoaXMubWVhc3VyZSgpO1xuXG5cdFx0dmFyIHNpemluZyA9IHRoaXMuZ2V0U2l6aW5nRWwoKTtcblx0XHRzaXppbmcuc3R5bGUubWF4V2lkdGggPSB0aGlzLm1ldHJpY3MuY29udGVudC53aWR0aCArIFwicHhcIjtcblx0XHRzaXppbmcuc3R5bGUubWF4SGVpZ2h0ID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQuaGVpZ2h0ICsgXCJweFwiO1xuXG5cdFx0dGhpcy5lbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWZpdC1kaXJcIiwgdGhpcy5tZXRyaWNzLmZpdERpcmVjdGlvbik7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBtZWRpYVN0YXRlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9tZWRpYVN0YXRlRW51bTogW1wiaWRsZVwiLCBcInBlbmRpbmdcIiwgXCJyZWFkeVwiLCBcImVycm9yXCJdLFxuXG5cdF9zZXRNZWRpYVN0YXRlOiBmdW5jdGlvbihrZXkpIHtcblx0XHRpZiAodGhpcy5fbWVkaWFTdGF0ZUVudW0uaW5kZXhPZihrZXkpID09PSAtMSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiQXJndW1lbnQgXCIgKyBrZXkgKyBcIiBpbnZhbGlkLiBNdXN0IGJlIG9uZSBvZjogXCIgKyB0aGlzLl9tZWRpYVN0YXRlRW51bS5qb2luKFwiLCBcIikpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fbWVkaWFTdGF0ZSAhPT0ga2V5KSB7XG5cdFx0XHRpZiAodGhpcy5fbWVkaWFTdGF0ZSkge1xuXHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fbWVkaWFTdGF0ZSk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5hZGQoa2V5KTtcblx0XHRcdHRoaXMuX21lZGlhU3RhdGUgPSBrZXk7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJtZWRpYTpcIiArIGtleSk7XG5cdFx0fVxuXHR9LFxufSwge1xuXHRMT0dfVE9fU0NSRUVOOiB0cnVlLFxuXG5cdC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3Byb21pc2Uvd2hlblNlbGVjdGlvbklzQ29udGlndW91c30gKi9cblx0d2hlblNlbGVjdGlvbklzQ29udGlndW91czogcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblNlbGVjdGlvbklzQ29udGlndW91c1wiKSxcblxuXHQvLyAvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3RUcmFuc2l0aW9uRW5kc30gKi9cblx0Ly8gd2hlblNlbGVjdFRyYW5zaXRpb25FbmRzOiByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuU2VsZWN0VHJhbnNpdGlvbkVuZHNcIiksXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS93aGVuU2Nyb2xsaW5nRW5kc30gKi9cblx0d2hlblNjcm9sbGluZ0VuZHM6IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL3doZW5TY3JvbGxpbmdFbmRzXCIpLFxuXG5cdC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3Byb21pc2Uvd2hlbkRlZmF1bHRJbWFnZUxvYWRzfSAqL1xuXHR3aGVuRGVmYXVsdEltYWdlTG9hZHM6IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL3doZW5EZWZhdWx0SW1hZ2VMb2Fkc1wiKSxcbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIGxvZyB0byBzY3JlZW5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuaWYgKERFQlVHKSB7XG5cblx0TWVkaWFSZW5kZXJlciA9IChmdW5jdGlvbihNZWRpYVJlbmRlcmVyKSB7XG5cdFx0aWYgKCFNZWRpYVJlbmRlcmVyLkxPR19UT19TQ1JFRU4pIHJldHVybiBNZWRpYVJlbmRlcmVyO1xuXG5cdFx0LyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cblx0XHR2YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG5cdFx0Ly8gLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZS5zdHJpbmcvbHBhZH0gKi9cblx0XHQvLyB2YXIgbHBhZCA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlLnN0cmluZy9scGFkXCIpO1xuXHRcdC8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmUuc3RyaW5nL3JwYWR9ICovXG5cdFx0Ly8gdmFyIHJwYWQgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvcnBhZFwiKTtcblxuXHRcdHJldHVybiBNZWRpYVJlbmRlcmVyLmV4dGVuZCh7XG5cblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHRcdFx0dmFyIGZnQ29sb3IgPSBuZXcgQ29sb3IodGhpcy5tb2RlbC5hdHRyKFwiY29sb3JcIikpO1xuXHRcdFx0XHR2YXIgYmdDb2xvciA9IG5ldyBDb2xvcih0aGlzLm1vZGVsLmF0dHIoXCJiYWNrZ3JvdW5kLWNvbG9yXCIpKTtcblx0XHRcdFx0dGhpcy5fX2xvZ0NvbG9ycyA9IHtcblx0XHRcdFx0XHRub3JtYWw6IGZnQ29sb3IuY2xvbmUoKS5taXgoYmdDb2xvciwgMC43NSkuaHNsU3RyaW5nKCksXG5cdFx0XHRcdFx0aWdub3JlZDogZmdDb2xvci5jbG9uZSgpLm1peChiZ0NvbG9yLCAwLjI1KS5oc2xTdHJpbmcoKSxcblx0XHRcdFx0XHRlcnJvcjogXCJicm93blwiLFxuXHRcdFx0XHRcdGFib3J0OiBcIm9yYW5nZVwiXG5cdFx0XHRcdH07XG5cdFx0XHRcdHRoaXMuX19sb2dGcmFtZVN0eWxlID0gXCIxcHggZGFzaGVkIFwiICsgZmdDb2xvci5jbG9uZSgpLm1peChiZ0NvbG9yLCAwLjUpLmhzbFN0cmluZygpO1xuXHRcdFx0XHR0aGlzLl9fbG9nU3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcblx0XHRcdFx0dGhpcy5fX3JhZklkID0gLTE7XG5cdFx0XHRcdHRoaXMuX19vbkZyYW1lID0gdGhpcy5fX29uRnJhbWUuYmluZCh0aGlzKTtcblx0XHRcdH0sXG5cblx0XHRcdGluaXRpYWxpemVBc3luYzogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplQXN5bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKS5jYXRjaChmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0XHRpZiAoIShlcnIgaW5zdGFuY2VvZiBNZWRpYVJlbmRlcmVyLlZpZXdFcnJvcikpIHtcblx0XHRcdFx0XHRcdHRoaXMuX19sb2dNZXNzYWdlKGVyci5tZXNzYWdlLCBlcnIubmFtZSwgdGhpcy5fX2xvZ0NvbG9yc1tcImVycm9yXCJdKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XG5cdFx0XHRcdH0uYmluZCh0aGlzKSk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRjcmVhdGVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciByZXQgPSBNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5jcmVhdGVDaGlsZHJlbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0XHRcdFx0dGhpcy5fX2xvZ0VsZW1lbnQuY2xhc3NOYW1lID0gXCJkZWJ1Zy1sb2dcIjtcblx0XHRcdFx0Ly8gdGhpcy5fX2xvZ0VsZW1lbnQuc3R5bGUudG91Y2hBY3Rpb24gPSBcInBhbi15XCI7XG5cdFx0XHRcdHRoaXMuX19sb2dIZWFkZXJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwcmVcIik7XG5cdFx0XHRcdHRoaXMuX19sb2dIZWFkZXJFbC5jbGFzc05hbWUgPSBcImxvZy1oZWFkZXIgY29sb3ItYmdcIjtcblx0XHRcdFx0Ly8gdGhpcy5tb2RlbC5jb2xvcnMuZmdDb2xvci5jbG9uZSgpLm1peChmZ0NvbG9yLCAwLjkpLnJnYlN0cmluZygpXG5cdFx0XHRcdC8vIHRoaXMubW9kZWwuY29sb3JzLmZnQ29sb3IuY2xvbmUoKS5hbHBoYVxuXHRcdFx0XHR0aGlzLl9fbG9nSGVhZGVyRWwudGV4dENvbnRlbnQgPSB0aGlzLl9fZ2V0SGVhZGVyVGV4dCgpO1xuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5hcHBlbmRDaGlsZCh0aGlzLl9fbG9nSGVhZGVyRWwpO1xuXHRcdFx0XHR0aGlzLmVsLmluc2VydEJlZm9yZSh0aGlzLl9fbG9nRWxlbWVudCwgdGhpcy5lbC5maXJzdEVsZW1lbnRDaGlsZCk7XG5cdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgcmV0ID0gTWVkaWFSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHRcdFx0dGhpcy5fX2xvZ0VsZW1lbnQuc3R5bGUudG9wID0gKHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCArIHRoaXMubWV0cmljcy5jb250ZW50LnkpICsgXCJweFwiO1xuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5zdHlsZS5sZWZ0ID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQueCArIFwicHhcIjtcblx0XHRcdFx0dGhpcy5fX2xvZ0VsZW1lbnQuc3R5bGUud2lkdGggPSB0aGlzLm1ldHJpY3MuY29udGVudC53aWR0aCArIFwicHhcIjtcblx0XHRcdFx0dGhpcy5fX2xvZ0VsZW1lbnQuc2Nyb2xsVG9wID0gdGhpcy5fX2xvZ0VsZW1lbnQuc2Nyb2xsSGVpZ2h0O1xuXG5cdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHR9LFxuXG5cdFx0XHRfX2xvZ01lc3NhZ2U6IGZ1bmN0aW9uKG1zZywgbG9ndHlwZSwgY29sb3IpIHtcblx0XHRcdFx0dmFyIGxvZ0VudHJ5RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicHJlXCIpO1xuXG5cdFx0XHRcdGxvZ0VudHJ5RWwudGV4dENvbnRlbnQgPSB0aGlzLl9fZ2V0VFN0YW1wKCkgKyBcIiBcIiArIG1zZztcblx0XHRcdFx0bG9nRW50cnlFbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWxvZ3R5cGVcIiwgbG9ndHlwZSB8fCBcIi1cIik7XG5cdFx0XHRcdGxvZ0VudHJ5RWwuc3R5bGUuY29sb3IgPSBjb2xvciB8fCB0aGlzLl9fbG9nQ29sb3JzW2xvZ3R5cGVdIHx8IHRoaXMuX19sb2dDb2xvcnMubm9ybWFsO1xuXG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50LmFwcGVuZENoaWxkKGxvZ0VudHJ5RWwpO1xuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5zY3JvbGxUb3AgPSB0aGlzLl9fbG9nRWxlbWVudC5zY3JvbGxIZWlnaHQ7XG5cblx0XHRcdFx0aWYgKHRoaXMuX19yYWZJZCA9PSAtMSkge1xuXHRcdFx0XHRcdHRoaXMuX19yYWZJZCA9IHRoaXMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMuX19vbkZyYW1lKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0X19vbkZyYW1lOiBmdW5jdGlvbih0c3RhbXApIHtcblx0XHRcdFx0dGhpcy5fX3JhZklkID0gLTE7XG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50Lmxhc3RFbGVtZW50Q2hpbGQuc3R5bGUuYm9yZGVyQm90dG9tID0gdGhpcy5fX2xvZ0ZyYW1lU3R5bGU7XG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50Lmxhc3RFbGVtZW50Q2hpbGQuc3R5bGUucGFkZGluZ0JvdHRvbSA9IFwiMnB4XCI7XG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50Lmxhc3RFbGVtZW50Q2hpbGQuc3R5bGUubWFyZ2luQm90dG9tID0gXCIycHhcIjtcblx0XHRcdH0sXG5cblx0XHRcdF9fZ2V0VFN0YW1wOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gcmV0dXJuIG5ldyBEYXRlKERhdGUubm93KCkgLSB0aGlzLl9fbG9nU3RhcnRUaW1lKS50b0lTT1N0cmluZygpLnN1YnN0cigxMSwgMTIpO1xuXHRcdFx0XHRyZXR1cm4gbHBhZCgoKERhdGUubm93KCkgLSB0aGlzLl9fbG9nU3RhcnRUaW1lKSAvIDEwMDApLnRvRml4ZWQoMyksIDgsIFwiMFwiKTtcblx0XHRcdH0sXG5cblx0XHRcdF9fZ2V0SGVhZGVyVGV4dDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiAnJztcblx0XHRcdH0sXG5cdFx0fSk7XG5cdH0pKE1lZGlhUmVuZGVyZXIpO1xuXG59IC8vIGVuZCBkZWJ1Z1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvTWVkaWFSZW5kZXJlcn1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBNZWRpYVJlbmRlcmVyOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvUGxheWFibGVSZW5kZXJlclxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbi8vIHZhciBDb2xvciA9IHJlcXVpcmUoXCJjb2xvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvTWVkaWFSZW5kZXJlcn0gKi9cbnZhciBNZWRpYVJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9NZWRpYVJlbmRlcmVyXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJ9ICovXG4vLyB2YXIgUHJvZ3Jlc3NNZXRlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvUHJvZ3Jlc3NNZXRlclwiKTtcblxuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBwcmVmaXhlZFByb3BlcnR5ID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkUHJvcGVydHlcIik7XG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIHByZWZpeGVkRXZlbnQgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRFdmVudFwiKTtcblxuLy8gdmFyIHZpc2liaWxpdHlIaWRkZW5Qcm9wID0gcHJlZml4ZWRQcm9wZXJ0eShcImhpZGRlblwiLCBkb2N1bWVudCk7XG4vKiogQHR5cGUge1N0cmluZ30gKi9cbnZhciB2aXNpYmlsaXR5U3RhdGVQcm9wID0gcHJlZml4ZWRQcm9wZXJ0eShcInZpc2liaWxpdHlTdGF0ZVwiLCBkb2N1bWVudCk7XG4vKiogQHR5cGUge1N0cmluZ30gKi9cbnZhciB2aXNpYmlsaXR5Q2hhbmdlRXZlbnQgPSBwcmVmaXhlZEV2ZW50KFwidmlzaWJpbGl0eWNoYW5nZVwiLCBkb2N1bWVudCwgXCJoaWRkZW5cIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG4vLyB2YXIgZHVvdG9uZSA9IHJlcXVpcmUoXCJ1dGlscy9jYW52YXMvYml0bWFwL2R1b3RvbmVcIik7XG4vLyB2YXIgc3RhY2tCbHVyUkdCID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9iaXRtYXAvc3RhY2tCbHVyUkdCXCIpO1xuLy8gdmFyIHN0YWNrQmx1ck1vbm8gPSByZXF1aXJlKFwidXRpbHMvY2FudmFzL2JpdG1hcC9zdGFja0JsdXJNb25vXCIpO1xuLy8gdmFyIGdldEF2ZXJhZ2VSR0JBID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9iaXRtYXAvZ2V0QXZlcmFnZVJHQkFcIik7XG4vLyB2YXIgZ2V0QXZlcmFnZVJHQiA9IHJlcXVpcmUoXCJ1dGlscy9jYW52YXMvYml0bWFwL2dldEF2ZXJhZ2VSR0JcIik7XG5cbi8vIC8qKiBAdHlwZSB7SFRNTENhbnZhc0VsZW1lbnR9ICovXG4vLyB2YXIgX3NoYXJlZENhbnZhcyA9IG51bGw7XG4vLyAvKiogQHJldHVybiB7SFRNTENhbnZhc0VsZW1lbnR9ICovXG4vLyB2YXIgZ2V0U2hhcmVkQ2FudmFzID0gZnVuY3Rpb24oKSB7XG4vLyBcdGlmIChfc2hhcmVkQ2FudmFzID09PSBudWxsKSB7XG4vLyBcdFx0X3NoYXJlZENhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG4vLyBcdH1cbi8vIFx0cmV0dXJuIF9zaGFyZWRDYW52YXM7XG4vLyB9O1xuXG4vLyBmdW5jdGlvbiBsb2dBdHRhY2hJbmZvKHZpZXcsIG5hbWUsIGxldmVsKSB7XG4vLyBcdGlmIChbXCJsb2dcIiwgXCJpbmZvXCIsIFwid2FyblwiLCBcImVycm9yXCJdLmluZGV4T2YobGV2ZWwpICE9IC0xKSB7XG4vLyBcdFx0bGV2ZWwgPSBcImxvZ1wiO1xuLy8gXHR9XG4vLyBcdGNvbnNvbGVbbGV2ZWxdLmNhbGwoY29uc29sZSwgXCIlczo6JXMgW3BhcmVudDolcyAlcyAlcyBkZXB0aDolc11cIiwgdmlldy5jaWQsIG5hbWUsIHZpZXcucGFyZW50VmlldyAmJiB2aWV3LnBhcmVudFZpZXcuY2lkLCB2aWV3LmF0dGFjaGVkID8gXCJhdHRhY2hlZFwiIDogXCJkZXRhY2hlZFwiLCB2aWV3Ll92aWV3UGhhc2UsIHZpZXcudmlld0RlcHRoKTtcbi8vIH1cblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1BsYXlhYmxlUmVuZGVyZXJ9XG4gKi9cbnZhciBQbGF5YWJsZVJlbmRlcmVyID0gTWVkaWFSZW5kZXJlci5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwicGxheWFibGVSZW5kZXJlclwiLFxuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfEZ1bmN0aW9ufSAqL1xuXHRjbGFzc05hbWU6IE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmNsYXNzTmFtZSArIFwiIHBsYXlhYmxlLXJlbmRlcmVyXCIsXG5cblx0cHJvcGVydGllczoge1xuXHRcdHBhdXNlZDoge1xuXHRcdFx0LyoqIEByZXR1cm4ge0Jvb2xlYW59ICovXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5faXNNZWRpYVBhdXNlZCgpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0cGxheWJhY2tSZXF1ZXN0ZWQ6IHtcblx0XHRcdC8qKiBAcmV0dXJuIHtCb29sZWFufSAqL1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3BsYXliYWNrUmVxdWVzdGVkO1xuXHRcdFx0fSxcblx0XHRcdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0dGhpcy5fc2V0UGxheWJhY2tSZXF1ZXN0ZWQodmFsdWUpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0cGxheVRvZ2dsZToge1xuXHRcdFx0LyoqIEByZXR1cm4ge0hUTUxFbGVtZW50fSAqL1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3BsYXlUb2dnbGUgfHwgKHRoaXMuX3BsYXlUb2dnbGUgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIucGxheS10b2dnbGVcIikpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0b3ZlcmxheToge1xuXHRcdFx0LyoqIEByZXR1cm4ge0hUTUxFbGVtZW50fSAqL1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX292ZXJsYXkgfHwgKHRoaXMuX292ZXJsYXkgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheVwiKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuXHRcdE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRfLmJpbmRBbGwodGhpcyxcblx0XHRcdFwiX29uUGxheWJhY2tUb2dnbGVcIixcblx0XHRcdFwiX29uVmlzaWJpbGl0eUNoYW5nZVwiXG5cdFx0KTtcblx0XHR0aGlzLl9zZXRQbGF5YmFja1JlcXVlc3RlZCh0aGlzLl9wbGF5YmFja1JlcXVlc3RlZCk7XG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLCBcInZpZXc6cGFyZW50Q2hhbmdlXCIsIGZ1bmN0aW9uKGNoaWxkVmlldywgbmV3UGFyZW50LCBvbGRQYXJlbnQpIHtcblx0XHQvLyBcdC8vIGxvZ0F0dGFjaEluZm8odGhpcywgXCJbdmlldzpwYXJlbnRDaGFuZ2VdXCIsIFwiaW5mb1wiKTtcblx0XHQvLyBcdGNvbnNvbGUuaW5mbyhcIiVzOjpbdmlldzpwYXJlbnRDaGFuZ2VdICclcycgdG8gJyVzJ1wiLCB0aGlzLmNpZCwgb2xkUGFyZW50ICYmIG9sZFBhcmVudC5jaWQsIG5ld1BhcmVudCAmJiBuZXdQYXJlbnQuY2lkKTtcblx0XHQvLyB9KTtcblx0fSxcblxuXHQvLyAvKiogQG92ZXJyaWRlICovXG5cdC8vIGluaXRpYWxpemVBc3luYzogZnVuY3Rpb24oKSB7XG5cdC8vIFx0cmV0dXJuIE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuaW5pdGlhbGl6ZUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdC8vIH0sXG5cblx0Ly8gLyoqIEBvdmVycmlkZSAqL1xuXHQvLyByZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQvLyBcdHJldHVybiB0aGlzO1xuXHQvLyB9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGNoaWxkcmVuL2xheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyBjcmVhdGVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwudG9KU09OKCkpO1xuXHQvLyBcdHRoaXMucGxhY2Vob2xkZXIgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2Vob2xkZXJcIik7XG5cdC8vIFx0dGhpcy5jb250ZW50ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRlbnRcIik7XG5cdC8vIFx0dGhpcy5pbWFnZSA9IHRoaXMuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiaW1nLmN1cnJlbnRcIik7XG5cdC8vIH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0Lyogc2V0RW5hYmxlZFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHNldEVuYWJsZWQ6IGZ1bmN0aW9uKGVuYWJsZWQpIHtcblx0XHRNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5zZXRFbmFibGVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0Ly8gdGhpcy5fdmFsaWRhdGVQbGF5YmFjayhlbmFibGVkKTtcblx0XHQvLyBpZiAoZW5hYmxlZCkge1xuXHRcdHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0Ly8gaWYgc2VsZWN0ZWQsIHBhdXNlIG1lZGlhXG5cdFx0Ly8gXHR0aGlzLm1vZGVsLnNlbGVjdGVkICYmIHRoaXMudG9nZ2xlUGxheWJhY2soZmFsc2UpO1xuXHRcdC8vIFx0Ly8gdGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdFx0Ly8gfVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBzZWxlY3Rpb24gaGFuZGxlcnNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0YWRkU2VsZWN0aW9uTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fdmlld1BoYXNlICE9IFwiaW5pdGlhbGl6ZWRcIilcblx0XHRcdHRocm93IG5ldyBFcnJvcih0aGlzLmNpZCArIFwiOjphZGRTZWxlY3Rpb25MaXN0ZW5lcnMgY2FsbGVkIHdoaWxlIFwiICsgdGhpcy5fdmlld1BoYXNlKTtcblxuXHRcdC8vIGxvZ0F0dGFjaEluZm8odGhpcywgXCJhZGRTZWxlY3Rpb25MaXN0ZW5lcnNcIiwgXCJsb2dcIik7XG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLCBcInZpZXc6cmVtb3ZlZFwiLCB0aGlzLnJlbW92ZVNlbGVjdGlvbkxpc3RlbmVycyk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkXCIsIHRoaXMuX29uTW9kZWxTZWxlY3RlZCk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImRlc2VsZWN0ZWRcIiwgdGhpcy5fb25Nb2RlbERlc2VsZWN0ZWQpO1xuXHRcdGlmICh0aGlzLm1vZGVsLnNlbGVjdGVkKSB7XG5cdFx0XHR0aGlzLl9vbk1vZGVsU2VsZWN0ZWQoKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gcmVtb3ZlU2VsZWN0aW9uTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcblx0Ly8gXHQvLyBsb2dBdHRhY2hJbmZvKHRoaXMsIFwicmVtb3ZlU2VsZWN0aW9uTGlzdGVuZXJzXCIsIFwibG9nXCIpO1xuXHQvLyBcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLCBcInZpZXc6cmVtb3ZlZFwiLCB0aGlzLnJlbW92ZVNlbGVjdGlvbkxpc3RlbmVycyk7XG5cdC8vIFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMubW9kZWwsIFwic2VsZWN0ZWRcIiwgdGhpcy5fb25Nb2RlbFNlbGVjdGVkKTtcblx0Ly8gXHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5tb2RlbCwgXCJkZXNlbGVjdGVkXCIsIHRoaXMuX29uTW9kZWxEZXNlbGVjdGVkKTtcblx0Ly8gXHRpZiAodGhpcy5tb2RlbC5zZWxlY3RlZCkge1xuXHQvLyBcdFx0dGhpcy5fb25Nb2RlbERlc2VsZWN0ZWQoKTtcblx0Ly8gXHR9XG5cdC8vIH0sXG5cblx0LyogbW9kZWwgc2VsZWN0ZWQgaGFuZGxlcnM6XG5cdC8qIG1vZGVsIHNlbGVjdGlvbiB0b2dnbGVzIHBsYXliYWNrXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vbk1vZGVsU2VsZWN0ZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vbk1vZGVsU2VsZWN0ZWQgX3BsYXliYWNrUmVxdWVzdGVkOiAlcywgZXZlbnQ6ICVzXCIsIHRoaXMuY2lkLCB0aGlzLl9wbGF5YmFja1JlcXVlc3RlZCwgdGhpcy5fdG9nZ2xlRXZlbnQpO1xuXHRcdC8vIGxvZ0F0dGFjaEluZm8odGhpcywgXCJfb25Nb2RlbFNlbGVjdGVkXCIsIFwibG9nXCIpO1xuXHRcdC8vIHRoaXMuX2FkZFBhcmVudExpc3RlbmVycygpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnBhcmVudENoYW5nZVwiLCB0aGlzLl9vblBhcmVudENoYW5nZSk7XG5cdFx0aWYgKHRoaXMucGFyZW50VmlldykgdGhpcy5fb25QYXJlbnRDaGFuZ2UodGhpcywgdGhpcy5wYXJlbnRWaWV3LCBudWxsKTtcblxuXHRcdHRoaXMuX2FkZERPTUxpc3RlbmVycygpO1xuXHRcdHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0fSxcblxuXHRfb25Nb2RlbERlc2VsZWN0ZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGxvZ0F0dGFjaEluZm8odGhpcywgXCJfb25Nb2RlbERlc2VsZWN0ZWRcIiwgXCJsb2dcIik7XG5cdFx0Ly8gdGhpcy5fcmVtb3ZlUGFyZW50TGlzdGVuZXJzKCk7XG5cdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMsIFwidmlldzpwYXJlbnRDaGFuZ2VcIiwgdGhpcy5fb25QYXJlbnRDaGFuZ2UpO1xuXHRcdGlmICh0aGlzLnBhcmVudFZpZXcpIHRoaXMuX29uUGFyZW50Q2hhbmdlKHRoaXMsIG51bGwsIHRoaXMucGFyZW50Vmlldyk7XG5cblx0XHR0aGlzLl9yZW1vdmVET01MaXN0ZW5lcnMoKTtcblx0XHR0aGlzLnRvZ2dsZVBsYXliYWNrKGZhbHNlKTtcblx0XHQvLyB0aGlzLl92YWxpZGF0ZVBsYXliYWNrKHRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHRcdC8vIHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0fSxcblxuXHQvKiB2aWV3OnBhcmVudENoYW5nZSBoYW5kbGVycyAzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vblBhcmVudENoYW5nZTogZnVuY3Rpb24oY2hpbGRWaWV3LCBuZXdQYXJlbnQsIG9sZFBhcmVudCkge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiW3Njcm9sbF0gJXM6Ol9vblBhcmVudENoYW5nZSAnJXMnIHRvICclcydcIiwgdGhpcy5jaWQsIG9sZFBhcmVudCAmJiBvbGRQYXJlbnQuY2lkLCBuZXdQYXJlbnQgJiYgbmV3UGFyZW50LmNpZCk7XG5cdFx0aWYgKG9sZFBhcmVudCkgdGhpcy5zdG9wTGlzdGVuaW5nKG9sZFBhcmVudCwgXCJ2aWV3OnNjcm9sbHN0YXJ0IHZpZXc6c2Nyb2xsZW5kXCIsIHRoaXMuX29uU2Nyb2xsQ2hhbmdlKTtcblx0XHRpZiAobmV3UGFyZW50KSB0aGlzLmxpc3RlblRvKG5ld1BhcmVudCwgXCJ2aWV3OnNjcm9sbHN0YXJ0IHZpZXc6c2Nyb2xsZW5kXCIsIHRoaXMuX29uU2Nyb2xsQ2hhbmdlKTtcblx0fSxcblxuXHRfb25TY3JvbGxDaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLnBhcmVudFZpZXcgPT09IG51bGwpIHtcblx0XHRcdHRoaXMudG9nZ2xlUGxheWJhY2soZmFsc2UpO1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKHRoaXMuY2lkICsgXCI6Ol9vblNjcm9sbENoYW5nZSBwYXJlbnRWaWV3IGlzIG51bGxcIik7XG5cdFx0fVxuXHRcdC8vIGNvbnNvbGUubG9nKFwiW3Njcm9sbF0gJXM6Ol9vblNjcm9sbENoYW5nZSAlcy5zY3JvbGxpbmc6ICVzXCIsIHRoaXMuY2lkLCB0aGlzLnBhcmVudFZpZXcuY2lkLCB0aGlzLnBhcmVudFZpZXcuc2Nyb2xsaW5nKTtcblxuXHRcdC8vIHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soIXRoaXMucGFyZW50Vmlldy5zY3JvbGxpbmcpO1xuXHRcdC8vIGlmICghdGhpcy5wYXJlbnRWaWV3LnNjcm9sbGluZykge1xuXHRcdHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0dGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdFx0Ly8gfVxuXHR9LFxuXG5cdC8qIHZpZXc6cGFyZW50Q2hhbmdlIGhhbmRsZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qX2FkZFBhcmVudExpc3RlbmVyczogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCF0aGlzLnBhcmVudFZpZXcpIHtcblx0XHRcdGxvZ0F0dGFjaEluZm8odGhpcywgXCJfYWRkUGFyZW50TGlzdGVuZXJzXCIsIFwiZXJyb3JcIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnJlbW92ZVwiLCB0aGlzLl9yZW1vdmVQYXJlbnRMaXN0ZW5lcnMpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5wYXJlbnRWaWV3LCBcInZpZXc6cmVtb3ZlXCIsIHRoaXMuX3JlbW92ZVBhcmVudExpc3RlbmVycyk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLnBhcmVudFZpZXcsIFwidmlldzpzY3JvbGxzdGFydFwiLCB0aGlzLl9vblNjcm9sbFN0YXJ0KTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMucGFyZW50VmlldywgXCJ2aWV3OnNjcm9sbGVuZFwiLCB0aGlzLl9vblNjcm9sbEVuZCk7XG5cdH0sXG5cblx0X3JlbW92ZVBhcmVudExpc3RlbmVyczogZnVuY3Rpb24odmlldykge1xuXHRcdGlmICghdGhpcy5wYXJlbnRWaWV3KSB7XG5cdFx0XHRsb2dBdHRhY2hJbmZvKHRoaXMsIFwiX3JlbW92ZVBhcmVudExpc3RlbmVyc1wiLCBcImVycm9yXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAodmlldyAhPT0gdm9pZCAwKSB7XG5cdFx0XHRsb2dBdHRhY2hJbmZvKHRoaXMsIFwiX3JlbW92ZVBhcmVudExpc3RlbmVycyBbZXZlbnQgc291cmNlIHZpZXddXCIsIFwiaW5mb1wiKTtcblx0XHRcdC8vIGNvbnNvbGUuaW5mbyhcIiVzW3BsYXlhYmxlXTo6X3JlbW92ZVBhcmVudExpc3RlbmVycyBldmVudCBzb3VyY2UgdmlldzogJXNcIiwgdGhpcy5jaWQsIHZpZXcgJiYgdmlldy5jaWQpO1xuXHRcdH1cblxuXHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLCBcInZpZXc6cmVtb3ZlXCIsIHRoaXMuX3JlbW92ZVBhcmVudExpc3RlbmVycyk7XG5cdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMucGFyZW50VmlldywgXCJ2aWV3OnJlbW92ZVwiLCB0aGlzLl9yZW1vdmVQYXJlbnRMaXN0ZW5lcnMpO1xuXHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLnBhcmVudFZpZXcsIFwidmlldzpzY3JvbGxzdGFydFwiLCB0aGlzLl9vblNjcm9sbFN0YXJ0KTtcblx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5wYXJlbnRWaWV3LCBcInZpZXc6c2Nyb2xsZW5kXCIsIHRoaXMuX29uU2Nyb2xsRW5kKTtcblx0fSwqL1xuXG5cdC8qIHZpZXc6c2Nyb2xsc3RhcnQgdmlldzpzY3JvbGxlbmRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Lypfb25TY3JvbGxTdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdH0sXG5cblx0X29uU2Nyb2xsRW5kOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl92YWxpZGF0ZVBsYXliYWNrKCk7XG5cdH0sKi9cblxuXHQvKiBsaXN0ZW4gdG8gRE9NIGV2ZW50c1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfYWRkRE9NTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwidmlldzpyZW1vdmVkXCIsIHRoaXMuX3JlbW92ZURPTUxpc3RlbmVycyk7XG5cdFx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcih2aXNpYmlsaXR5Q2hhbmdlRXZlbnQsIHRoaXMuX29uVmlzaWJpbGl0eUNoYW5nZSwgZmFsc2UpO1xuXHRcdHRoaXMucGxheVRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKHRoaXMuX3RvZ2dsZUV2ZW50LCB0aGlzLl9vblBsYXliYWNrVG9nZ2xlLCB0cnVlKTtcblx0fSxcblxuXHRfcmVtb3ZlRE9NTGlzdGVuZXJzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcywgXCJ2aWV3OnJlbW92ZWRcIiwgdGhpcy5fcmVtb3ZlRE9NTGlzdGVuZXJzKTtcblx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKHZpc2liaWxpdHlDaGFuZ2VFdmVudCwgdGhpcy5fb25WaXNpYmlsaXR5Q2hhbmdlLCBmYWxzZSk7XG5cdFx0dGhpcy5wbGF5VG9nZ2xlLnJlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5fdG9nZ2xlRXZlbnQsIHRoaXMuX29uUGxheWJhY2tUb2dnbGUsIHRydWUpO1xuXHR9LFxuXG5cdC8qIHZpc2liaWxpdHkgZG9tIGV2ZW50XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXHRfb25WaXNpYmlsaXR5Q2hhbmdlOiBmdW5jdGlvbihldikge1xuXHRcdC8vIHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soIWRvY3VtZW50W3Zpc2liaWxpdHlIaWRkZW5Qcm9wXSk7XG5cdFx0Ly8gdGhpcy5fdmFsaWRhdGVQbGF5YmFjayhkb2N1bWVudFt2aXNpYmlsaXR5U3RhdGVQcm9wXSAhPSBcImhpZGRlblwiKTtcblx0XHQvLyBpZiAoZG9jdW1lbnRbdmlzaWJpbGl0eVN0YXRlUHJvcF0gIT0gXCJoaWRkZW5cIikge1xuXHRcdHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0dGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdFx0Ly8gfVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHBsYXktdG9nZ2xlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAdHlwZSB7U3RyaW5nfSAqL1xuXHRfdG9nZ2xlRXZlbnQ6IHdpbmRvdy5oYXNPd25Qcm9wZXJ0eShcIm9ucG9pbnRlcnVwXCIpID8gXCJwb2ludGVydXBcIiA6IFwibW91c2V1cFwiLFxuXG5cdF9vblBsYXliYWNrVG9nZ2xlOiBmdW5jdGlvbihldikge1xuXHRcdGNvbnNvbGUubG9nKFwiJXNbJXNhYmxlZF06Ol9vblBsYXliYWNrVG9nZ2xlWyVzXSBkZWZhdWx0UHJldmVudGVkOiAlc1wiLCB0aGlzLmNpZCwgdGhpcy5lbmFibGVkID8gXCJlblwiIDogXCJkaXNcIiwgZXYudHlwZSwgZXYuZGVmYXVsdFByZXZlbnRlZCk7XG5cdFx0Ly8gTk9URTogUGVyZm9ybSBhY3Rpb24gaWYgTW91c2VFdmVudC5idXR0b24gaXMgMCBvciB1bmRlZmluZWQgKDA6IGxlZnQtYnV0dG9uKVxuXHRcdGlmICh0aGlzLmVuYWJsZWQgJiYgIWV2LmRlZmF1bHRQcmV2ZW50ZWQgJiYgIWV2LmJ1dHRvbikge1xuXHRcdFx0ZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQgPSAhdGhpcy5wbGF5YmFja1JlcXVlc3RlZDtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcGxheWJhY2tSZXF1ZXN0ZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEB0eXBlIHtCb29sZWFuP30gKi9cblx0X3BsYXliYWNrUmVxdWVzdGVkOiBudWxsLFxuXG5cdF9zZXRQbGF5YmFja1JlcXVlc3RlZDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHR0aGlzLl9wbGF5YmFja1JlcXVlc3RlZCA9IHZhbHVlO1xuXG5cdFx0dmFyIGNsYXNzTGlzdCA9IHRoaXMuY29udGVudC5jbGFzc0xpc3Q7XG5cdFx0Y2xhc3NMaXN0LnRvZ2dsZShcInBsYXlpbmdcIiwgdmFsdWUgPT09IHRydWUpO1xuXHRcdGNsYXNzTGlzdC50b2dnbGUoXCJwYXVzZWRcIiwgdmFsdWUgPT09IGZhbHNlKTtcblx0XHRjbGFzc0xpc3QudG9nZ2xlKFwicmVxdWVzdGVkXCIsIHZhbHVlID09PSB0cnVlIHx8IHZhbHVlID09PSBmYWxzZSk7XG5cblx0XHQvLyB0aGlzLl92YWxpZGF0ZVBsYXliYWNrKHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQpO1xuXHRcdC8vIGlmICh0aGlzLnBsYXliYWNrUmVxdWVzdGVkKSB7XG5cdFx0dGhpcy5fdmFsaWRhdGVQbGF5YmFjaygpO1xuXHRcdC8vIH0gZWxzZSB7XG5cdFx0Ly8gXHR0aGlzLnRvZ2dsZVBsYXliYWNrKGZhbHNlKTtcblx0XHQvLyB9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogdG9nZ2xlUGxheWJhY2tcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0b2dnbGVQbGF5YmFjazogZnVuY3Rpb24obmV3UGxheVN0YXRlKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJbc2Nyb2xsXSAlczo6dG9nZ2xlUGxheWJhY2sgWyVzIC0+ICVzXSAocmVxdWVzdGVkOiAlcylcIiwgdGhpcy5jaWQsXG5cdFx0Ly8gXHRcdCh0aGlzLl9pc01lZGlhUGF1c2VkKCk/IFwicGF1c2VcIiA6IFwicGxheVwiKSxcblx0XHQvLyBcdFx0KG5ld1BsYXlTdGF0ZT8gXCJwbGF5XCIgOiBcInBhdXNlXCIpLFxuXHRcdC8vIFx0XHR0aGlzLnBsYXliYWNrUmVxdWVzdGVkXG5cdFx0Ly8gXHQpO1xuXHRcdGlmIChfLmlzQm9vbGVhbihuZXdQbGF5U3RhdGUpICYmIG5ld1BsYXlTdGF0ZSAhPT0gdGhpcy5faXNNZWRpYVBhdXNlZCgpKSB7XG5cdFx0XHRyZXR1cm47IC8vIHJlcXVlc3RlZCBzdGF0ZSBpcyBjdXJyZW50LCBkbyBub3RoaW5nXG5cdFx0fSBlbHNlIHtcblx0XHRcdG5ld1BsYXlTdGF0ZSA9IHRoaXMuX2lzTWVkaWFQYXVzZWQoKTtcblx0XHR9XG5cdFx0aWYgKG5ld1BsYXlTdGF0ZSkgeyAvLyBjaGFuZ2luZyB0byB3aGF0P1xuXHRcdFx0dGhpcy5fcGxheU1lZGlhKCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX3BhdXNlTWVkaWEoKTtcblx0XHR9XG5cdH0sXG5cblx0X2NhblJlc3VtZVBsYXliYWNrOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gISEoXG5cdFx0XHR0aGlzLmVuYWJsZWQgJiZcblx0XHRcdHRoaXMubW9kZWwuc2VsZWN0ZWQgJiZcblx0XHRcdHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQgJiZcblx0XHRcdCh0aGlzLm1lZGlhU3RhdGUgPT09IFwicmVhZHlcIikgJiZcblx0XHRcdHRoaXMuYXR0YWNoZWQgJiZcblx0XHRcdCh0aGlzLnBhcmVudFZpZXcgIT09IG51bGwpICYmXG5cdFx0XHQoIXRoaXMucGFyZW50Vmlldy5zY3JvbGxpbmcpICYmXG5cdFx0XHQoZG9jdW1lbnRbdmlzaWJpbGl0eVN0YXRlUHJvcF0gIT0gXCJoaWRkZW5cIilcblx0XHQpO1xuXHR9LFxuXG5cdF92YWxpZGF0ZVBsYXliYWNrOiBmdW5jdGlvbihzaG9ydGNpcmN1aXQpIHtcblx0XHQvLyBhICdzaG9ydGNpcmN1aXQnIGJvb2xlYW4gYXJndW1lbnQgY2FuIGJlIHBhc3NlZCwgYW5kIGlmIGZhbHNlLFxuXHRcdC8vIHNraXAgX2NhblJlc3VtZVBsYXliYWNrIGFuZCBwYXVzZSBwbGF5YmFjayByaWdodCBhd2F5XG5cdFx0aWYgKGFyZ3VtZW50cy5sZW5ndGggIT0gMCAmJiAhc2hvcnRjaXJjdWl0KSB7XG5cdFx0XHR0aGlzLnRvZ2dsZVBsYXliYWNrKGZhbHNlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50b2dnbGVQbGF5YmFjayh0aGlzLl9jYW5SZXN1bWVQbGF5YmFjaygpKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogYWJzdHJhY3Rcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2lzTWVkaWFQYXVzZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUud2FybihcIiVzOjpfaXNNZWRpYVBhdXNlZCBOb3QgaW1wbGVtZW50ZWRcIiwgdGhpcy5jaWQpO1xuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXG5cdF9wbGF5TWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUud2FybihcIiVzOjpfcGxheU1lZGlhIE5vdCBpbXBsZW1lbnRlZFwiLCB0aGlzLmNpZCk7XG5cdH0sXG5cblx0X3BhdXNlTWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUud2FybihcIiVzOjpfcGF1c2VNZWRpYSBOb3QgaW1wbGVtZW50ZWRcIiwgdGhpcy5jaWQpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHV0aWxcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0dXBkYXRlT3ZlcmxheTogZnVuY3Rpb24obWVkaWFFbCwgdGFyZ2V0RWwsIHJlY3RFbCkge1xuXHRcdC8vIC8vIHRoaXMgbWV0aG9kIGlzIG5vdCBjcml0aWNhbCwganVzdCBjYXRjaCBhbmQgbG9nIGFsbCBlcnJvcnNcblx0XHQvLyB0cnkge1xuXHRcdC8vIFx0dGhpcy5fdXBkYXRlT3ZlcmxheShtZWRpYUVsLCB0YXJnZXRFbCwgcmVjdEVsKVxuXHRcdC8vIH0gY2F0Y2ggKGVycikge1xuXHRcdC8vIFx0Y29uc29sZS5lcnJvcihcIiVzOjp1cGRhdGVPdmVybGF5XCIsIHRoaXMuY2lkLCBlcnIpO1xuXHRcdC8vIH1cblx0fSxcblxuXHRfZHJhd01lZGlhRWxlbWVudDogZnVuY3Rpb24oY29udGV4dCwgbWVkaWFFbCwgZGVzdCkge1xuXHRcdC8vIGRlc3RpbmF0aW9uIHJlY3Rcblx0XHQvLyBOT1RFOiBtZWRpYUVsIGlzIGV4cGVjdGVkIHRvIGhhdmUgdGhlIHNhbWUgZGltZW5zaW9ucyBpbiB0aGlzLm1ldHJpY3MubWVkaWFcblx0XHRtZWRpYUVsIHx8IChtZWRpYUVsID0gdGhpcy5kZWZhdWx0SW1hZ2UpO1xuXHRcdGRlc3QgfHwgKGRlc3QgPSB7XG5cdFx0XHR4OiAwLFxuXHRcdFx0eTogMCxcblx0XHRcdHdpZHRoOiB0aGlzLm1ldHJpY3MubWVkaWEud2lkdGgsXG5cdFx0XHRoZWlnaHQ6IHRoaXMubWV0cmljcy5tZWRpYS5oZWlnaHRcblx0XHR9KTtcblxuXHRcdC8vIG5hdGl2ZS9kaXNwbGF5IHNjYWxlXG5cdFx0dmFyIHNXID0gdGhpcy5tb2RlbC5nZXQoXCJzb3VyY2VcIikuZ2V0KFwid1wiKSxcblx0XHRcdHNIID0gdGhpcy5tb2RlbC5nZXQoXCJzb3VyY2VcIikuZ2V0KFwiaFwiKSxcblx0XHRcdHJzWCA9IHNXIC8gdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoLFxuXHRcdFx0cnNZID0gc0ggLyB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0O1xuXG5cdFx0Ly8gZGVzdCwgc2NhbGVkIHRvIG5hdGl2ZVxuXHRcdHZhciBzcmMgPSB7XG5cdFx0XHR4OiBNYXRoLm1heCgwLCBkZXN0LnggKiByc1gpLFxuXHRcdFx0eTogTWF0aC5tYXgoMCwgZGVzdC55ICogcnNZKSxcblx0XHRcdHdpZHRoOiBNYXRoLm1pbihzVywgZGVzdC53aWR0aCAqIHJzWCksXG5cdFx0XHRoZWlnaHQ6IE1hdGgubWluKHNILCBkZXN0LmhlaWdodCAqIHJzWSlcblx0XHR9O1xuXG5cdFx0Ly8gcmVzaXplIGNhbnZhc1xuXHRcdC8vIHZhciBjYW52YXMgPSBjb250ZXh0LmNhbnZhcztcblx0XHQvLyBpZiAoY2FudmFzLndpZHRoICE9PSBkZXN0LndpZHRoIHx8IGNhbnZhcy5oZWlnaHQgIT09IGRlc3QuaGVpZ2h0KSB7XG5cdFx0Ly8gXHRjYW52YXMud2lkdGggPSBkZXN0LndpZHRoO1xuXHRcdC8vIFx0Y2FudmFzLmhlaWdodCA9IGRlc3QuaGVpZ2h0O1xuXHRcdC8vIH1cblx0XHRjb250ZXh0LmNhbnZhcy53aWR0aCA9IGRlc3Qud2lkdGg7XG5cdFx0Y29udGV4dC5jYW52YXMuaGVpZ2h0ID0gZGVzdC5oZWlnaHQ7XG5cblx0XHQvLyBjb3B5IGltYWdlIHRvIGNhbnZhc1xuXHRcdGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGRlc3Qud2lkdGgsIGRlc3QuaGVpZ2h0KTtcblx0XHRjb250ZXh0LmRyYXdJbWFnZShtZWRpYUVsLFxuXHRcdFx0c3JjLngsIHNyYy55LCBzcmMud2lkdGgsIHNyYy5oZWlnaHQsXG5cdFx0XHQwLCAwLCBkZXN0LndpZHRoLCBkZXN0LmhlaWdodCAvLyBkZXN0aW5hdGlvbiByZWN0XG5cdFx0KTtcblxuXHRcdHJldHVybiBjb250ZXh0O1xuXHR9LFxuXG5cdC8qXG5cdF91cGRhdGVPdmVybGF5OiBmdW5jdGlvbihtZWRpYUVsLCB0YXJnZXRFbCwgcmVjdEVsKSB7XG5cdFx0Ly8gc3JjL2Rlc3QgcmVjdHNcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRyZWN0RWwgfHwgKHJlY3RFbCA9IHRhcmdldEVsKTtcblxuXHRcdC8vIE5PVEU6IGRvZXMgbm90IHdvcmsgd2l0aCBzdmcgZWxlbWVudFxuXHRcdC8vIHZhciB0UmVjdCA9IHJlY3RFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHQvLyB2YXIgY1JlY3QgPSBtZWRpYUVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdC8vIHZhciB0WCA9IHRSZWN0LnggLSBjUmVjdC54LFxuXHRcdC8vIFx0dFkgPSB0UmVjdC55IC0gY1JlY3QueSxcblx0XHQvLyBcdHRXID0gdFJlY3Qud2lkdGgsXG5cdFx0Ly8gXHR0SCA9IHRSZWN0LmhlaWdodDtcblxuXHRcdC8vIHRhcmdldCBib3VuZHNcblx0XHR2YXIgdFggPSByZWN0RWwub2Zmc2V0TGVmdCxcblx0XHRcdHRZID0gcmVjdEVsLm9mZnNldFRvcCxcblx0XHRcdHRXID0gcmVjdEVsLm9mZnNldFdpZHRoLFxuXHRcdFx0dEggPSByZWN0RWwub2Zmc2V0SGVpZ2h0O1xuXG5cdFx0aWYgKHRYID09PSB2b2lkIDAgfHwgdFkgPT09IHZvaWQgMCB8fCB0VyA9PT0gdm9pZCAwIHx8IHRIID09PSB2b2lkIDApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBkZXN0aW5hdGlvbiByZWN0XG5cdFx0dmFyIFJFQ1RfR1JPVyA9IDIwO1xuXHRcdHZhciBkZXN0ID0ge1xuXHRcdFx0eDogdFggLSBSRUNUX0dST1csXG5cdFx0XHR5OiB0WSAtIFJFQ1RfR1JPVyxcblx0XHRcdHdpZHRoOiB0VyArIFJFQ1RfR1JPVyAqIDIsXG5cdFx0XHRoZWlnaHQ6IHRIICsgUkVDVF9HUk9XICogMlxuXHRcdH07XG5cblx0XHQvLyBuYXRpdmUvZGlzcGxheSBzY2FsZVxuXHRcdHZhciBzVyA9IHRoaXMubW9kZWwuZ2V0KFwid1wiKSxcblx0XHRcdHNIID0gdGhpcy5tb2RlbC5nZXQoXCJoXCIpLFxuXHRcdFx0cnNYID0gc1cvdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoLFxuXHRcdFx0cnNZID0gc0gvdGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodDtcblxuXHRcdC8vIGRlc3QsIHNjYWxlZCB0byBuYXRpdmVcblx0XHR2YXIgc3JjID0ge1xuXHRcdFx0eDogTWF0aC5tYXgoMCwgZGVzdC54ICogcnNYKSxcblx0XHRcdHk6IE1hdGgubWF4KDAsIGRlc3QueSAqIHJzWSksXG5cdFx0XHR3aWR0aDogTWF0aC5taW4oc1csIGRlc3Qud2lkdGggKiByc1gpLFxuXHRcdFx0aGVpZ2h0OiBNYXRoLm1pbihzSCwgZGVzdC5oZWlnaHQgKiByc1kpXG5cdFx0fTtcblxuXHRcdC8vIENvcHkgaW1hZ2UgdG8gY2FudmFzXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIGNhbnZhcywgY29udGV4dCwgaW1hZ2VEYXRhO1xuXG5cdFx0Ly8gY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcblx0XHQvLyBjYW52YXMuc3R5bGUud2lkdGggID0gZGVzdC53aWR0aCArIFwicHhcIjtcblx0XHQvLyBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gZGVzdC5oZWlnaHQgKyBcInB4XCI7XG5cblx0XHRjYW52YXMgPSBnZXRTaGFyZWRDYW52YXMoKTtcblx0XHRpZiAoY2FudmFzLndpZHRoICE9PSBkZXN0LndpZHRoIHx8IGNhbnZhcy5oZWlnaHQgIT09IGRlc3QuaGVpZ2h0KSB7XG5cdFx0XHRjYW52YXMud2lkdGggPSBkZXN0LndpZHRoO1xuXHRcdFx0Y2FudmFzLmhlaWdodCA9IGRlc3QuaGVpZ2h0O1xuXHRcdH1cblx0XHRjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblx0XHRjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBkZXN0LndpZHRoLCBkZXN0LmhlaWdodCk7XG5cdFx0Y29udGV4dC5kcmF3SW1hZ2UobWVkaWFFbCxcblx0XHRcdHNyYy54LCBzcmMueSwgc3JjLndpZHRoLCBzcmMuaGVpZ2h0LFxuXHRcdFx0MCwgMCwgZGVzdC53aWR0aCwgZGVzdC5oZWlnaHQgLy8gZGVzdGluYXRpb24gcmVjdFxuXHRcdCk7XG5cdFx0aW1hZ2VEYXRhID0gY29udGV4dC5nZXRJbWFnZURhdGEoMCwgMCwgZGVzdC53aWR0aCwgZGVzdC5oZWlnaHQpO1xuXG5cdFx0dmFyIGF2Z0NvbG9yID0gQ29sb3IoKS5yZ2IoZ2V0QXZlcmFnZVJHQihpbWFnZURhdGEpKTtcblx0XHQvLyB2YXIgYXZnSGV4ID0gYXZnQ29sb3IuaGV4U3RyaW5nKCksIGVscyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcImltZywgdmlkZW9cIik7XG5cdFx0Ly8gZm9yICh2YXIgaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspIHtcblx0XHQvLyBcdGVscy5pdGVtKGkpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGF2Z0hleDtcblx0XHQvLyB9XG5cblx0XHR0YXJnZXRFbC5jbGFzc0xpc3QudG9nZ2xlKFwib3Zlci1kYXJrXCIsIGF2Z0NvbG9yLmRhcmsoKSk7XG5cblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp1cGRhdGVPdmVybGF5KCkgYXZnQ29sb3I6JXMgKCVzKVwiLCB0aGlzLmNpZCwgYXZnQ29sb3IucmdiU3RyaW5nKCksIGF2Z0NvbG9yLmRhcmsoKT9cImRhcmtcIjpcImxpZ2h0XCIsIHRhcmdldEVsKTtcblxuXHRcdC8vIENvbG9yLCBmaWx0ZXIgb3B0c1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0Ly8gdGhpcy5mZ0NvbG9yIHx8ICh0aGlzLmZnQ29sb3IgPSBuZXcgQ29sb3IodGhpcy5tb2RlbC5hdHRyKFwiY29sb3JcIikpKTtcblx0XHQvLyB0aGlzLmJnQ29sb3IgfHwgKHRoaXMuYmdDb2xvciA9IG5ldyBDb2xvcih0aGlzLm1vZGVsLmF0dHIoXCJiYWNrZ3JvdW5kLWNvbG9yXCIpKSk7XG5cdFx0Ly9cblx0XHQvLyB2YXIgb3B0cyA9IHsgcmFkaXVzOiAyMCB9O1xuXHRcdC8vIHZhciBpc0ZnRGFyayA9IHRoaXMuZmdDb2xvci5sdW1pbm9zaXR5KCkgPCB0aGlzLmJnQ29sb3IubHVtaW5vc2l0eSgpO1xuXHRcdC8vIG9wdHMueDAwID0gaXNGZ0Rhcms/IHRoaXMuZmdDb2xvci5jbG9uZSgpLmxpZ2h0ZW4oMC41KSA6IHRoaXMuYmdDb2xvci5jbG9uZSgpLmRhcmtlbigwLjUpO1xuXHRcdC8vIG9wdHMueEZGID0gaXNGZ0Rhcms/IHRoaXMuYmdDb2xvci5jbG9uZSgpLmxpZ2h0ZW4oMC41KSA6IHRoaXMuZmdDb2xvci5jbG9uZSgpLmRhcmtlbigwLjUpO1xuXHRcdC8vXG5cdFx0Ly8gc3RhY2tCbHVyTW9ubyhpbWFnZURhdGEsIG9wdHMpO1xuXHRcdC8vIGR1b3RvbmUoaW1hZ2VEYXRhLCBvcHRzKTtcblx0XHQvLyBzdGFja0JsdXJSR0IoaW1hZ2VEYXRhLCB7IHJhZGl1czogMjAgfSk7XG5cdFx0Ly9cblx0XHQvLyBjb250ZXh0LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApO1xuXHRcdC8vIHRhcmdldEVsLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IFwidXJsKFwiICsgY2FudmFzLnRvRGF0YVVSTCgpICsgXCIpXCI7XG5cdH0qL1xufSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogR29vZ2xlIEFuYWx5dGljc1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5pZiAoR0EpIHtcblx0UGxheWFibGVSZW5kZXJlciA9IChmdW5jdGlvbihQbGF5YWJsZVJlbmRlcmVyKSB7XG5cblx0XHQvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZ3MvZGFzaGVyaXplfSAqL1xuXHRcdHZhciBkYXNoZXJpemUgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvZGFzaGVyaXplXCIpO1xuXG5cdFx0Ly8gdmFyIHJlYWR5RXZlbnRzID0gW1wicGxheWluZ1wiLCBcIndhaXRpbmdcIiwgXCJlbmRlZFwiXTtcblx0XHQvLyB2YXIgdXNlckV2ZW50cyA9IFtcInBsYXlcIiwgXCJwYXVzZVwiXTtcblxuXG5cdFx0cmV0dXJuIFBsYXlhYmxlUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHZhciByZXR2YWwgPSBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdHRoaXMuX3BsYXliYWNrUmVxdWVzdGVkRGVmYXVsdCA9IHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQ7XG5cdFx0XHRcdHJldHVybiByZXR2YWw7XG5cdFx0XHR9LFxuXG5cdFx0XHRfb25QbGF5YmFja1RvZ2dsZTogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0dmFyIHJldHZhbCA9IFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLl9vblBsYXliYWNrVG9nZ2xlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdHZhciBvID0ge1xuXHRcdFx0XHRcdGhpdFR5cGU6IFwiZXZlbnRcIixcblx0XHRcdFx0XHRldmVudENhdGVnb3J5OiBkYXNoZXJpemUodGhpcy5jaWRQcmVmaXgpLFxuXHRcdFx0XHRcdGV2ZW50QWN0aW9uOiB0aGlzLnBsYXliYWNrUmVxdWVzdGVkID8gXCJwbGF5XCIgOiBcInBhdXNlXCIsXG5cdFx0XHRcdFx0ZXZlbnRMYWJlbDogdGhpcy5tb2RlbC5nZXQoXCJ0ZXh0XCIpLFxuXHRcdFx0XHR9O1xuXHRcdFx0XHRpZiAodGhpcy5fcGxheWJhY2tSZXF1ZXN0ZWREZWZhdWx0KVxuXHRcdFx0XHRcdG8uZXZlbnRBY3Rpb24gKz0gXCItYXV0b3BsYXlcIjtcblx0XHRcdFx0d2luZG93LmdhKFwic2VuZFwiLCBvKTtcblx0XHRcdFx0cmV0dXJuIHJldHZhbDtcblx0XHRcdH0sXG5cblx0XHRcdC8vIC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdC8vIHRvZ2dsZVBsYXliYWNrOiBmdW5jdGlvbihuZXdQbGF5U3RhdGUpIHtcblx0XHRcdC8vIFx0dmFyIHJldHZhbCA9IFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLnRvZ2dsZVBsYXliYWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHQvLyBcdHdpbmRvdy5nYShcInNlbmRcIiwge1xuXHRcdFx0Ly8gXHRcdGhpdFR5cGU6IFwiZXZlbnRcIixcblx0XHRcdC8vIFx0XHRldmVudENhdGVnb3J5OiBcIlBsYXlhYmxlXCIsXG5cdFx0XHQvLyBcdFx0ZXZlbnRBY3Rpb246IHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQgPyBcInBsYXlcIiA6IFwicGF1c2VcIixcblx0XHRcdC8vIFx0XHRldmVudExhYmVsOiB0aGlzLm1vZGVsLmdldChcInRleHRcIiksXG5cdFx0XHQvLyBcdH0pO1xuXHRcdFx0Ly8gXHRyZXR1cm4gcmV0dmFsO1xuXHRcdFx0Ly8gfSxcblx0XHR9KTtcblx0fSkoUGxheWFibGVSZW5kZXJlcik7XG59XG5cbi8vIGlmIChERUJVRykge1xuLy9cbi8vIFBsYXlhYmxlUmVuZGVyZXIgPSAoZnVuY3Rpb24oUGxheWFibGVSZW5kZXJlcikge1xuLy8gXHRpZiAoIVBsYXlhYmxlUmVuZGVyZXIuTE9HX1RPX1NDUkVFTikgcmV0dXJuIFBsYXlhYmxlUmVuZGVyZXI7XG4vL1xuLy8gXHQvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZ3MvbHBhZH0gKi9cbi8vIFx0dmFyIGxwYWQgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvbHBhZFwiKTtcbi8vXG4vLyBcdHJldHVybiBQbGF5YWJsZVJlbmRlcmVyLmV4dGVuZCh7XG4vLyBcdFx0X2NhblJlc3VtZVBsYXliYWNrOiBmdW5jdGlvbigpIHtcbi8vIFx0XHRcdHZhciByZXR2YWwgPSBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5fY2FuUmVzdW1lUGxheWJhY2suYXBwbHkodGhpcy5hcmd1bWVudHMpO1xuLy8gXHRcdFx0Y29uc29sZS5sb2coXCJbc2Nyb2xsXSAlczo6X2NhblJlc3VtZVBsYXliYWNrKCk6JXNcIiwgdGhpcy5jaWQsIHJldHZhbCxcbi8vIFx0XHRcdHtcbi8vIFx0XHRcdFx0XCJlbmFibGVkXCI6IHRoaXMuZW5hYmxlZCxcbi8vIFx0XHRcdFx0XCJzZWxlY3RlZFwiOiAoISF0aGlzLm1vZGVsLnNlbGVjdGVkKSxcbi8vIFx0XHRcdFx0XCJwbGF5YmFja1JlcXVlc3RlZFwiOiB0aGlzLnBsYXliYWNrUmVxdWVzdGVkLFxuLy8gXHRcdFx0XHRcImF0dGFjaGVkXCI6IHRoaXMuYXR0YWNoZWQsXG4vLyBcdFx0XHRcdFwicGFyZW50Vmlld1wiOiAodGhpcy5wYXJlbnRWaWV3ICYmIHRoaXMucGFyZW50Vmlldy5jaWQpLFxuLy8gXHRcdFx0XHRcIiFzY3JvbGxpbmdcIjogKHRoaXMucGFyZW50VmlldyAmJiAhdGhpcy5wYXJlbnRWaWV3LnNjcm9sbGluZyksXG4vLyBcdFx0XHRcdFwibWVkaWFTdGF0ZVwiOiB0aGlzLm1lZGlhU3RhdGUsXG4vLyBcdFx0XHRcdC8vIFwiIWRvY3VtZW50LmhpZGRlblwiOiAhZG9jdW1lbnRbdmlzaWJpbGl0eUhpZGRlblByb3BdLFxuLy8gXHRcdFx0XHRcInZpc2liaWxpdHlTdGF0ZVwiOiBkb2N1bWVudFt2aXNpYmlsaXR5U3RhdGVQcm9wXVxuLy8gXHRcdFx0fSk7XG4vLyBcdFx0XHRyZXR1cm4gcmV0dmFsO1xuLy8gXHRcdH0sXG4vLyBcdH0pO1xuLy8gfSkoUGxheWFibGVSZW5kZXJlcik7XG4vL1xuLy8gfVxuXG5tb2R1bGUuZXhwb3J0cyA9IFBsYXlhYmxlUmVuZGVyZXI7IiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcImNvbXBpbGVyXCI6WzcsXCI+PSA0LjAuMFwiXSxcIm1haW5cIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBoZWxwZXIsIGFsaWFzMT1kZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LCBhbGlhczI9aGVscGVycy5oZWxwZXJNaXNzaW5nLCBhbGlhczM9XCJmdW5jdGlvblwiLCBhbGlhczQ9Y29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb247XG5cbiAgcmV0dXJuIFwiPGRpdiBjbGFzcz1cXFwicGxhY2Vob2xkZXIgc2l6aW5nXFxcIj48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJjb250ZW50XFxcIj5cXG5cdDxkaXYgY2xhc3M9XFxcIm1lZGlhLWJvcmRlciBjb250ZW50LXNpemVcXFwiPjwvZGl2Plxcblx0PGRpdiBjbGFzcz1cXFwiY29udHJvbHMgY29udGVudC1zaXplXFxcIj5cXG5cdFx0PGNhbnZhcyBjbGFzcz1cXFwicHJvZ3Jlc3MtbWV0ZXJcXFwiPjwvY2FudmFzPlxcblx0PC9kaXY+XFxuXHQ8ZGl2IGNsYXNzPVxcXCJzZXF1ZW5jZSBtZWRpYS1zaXplXFxcIj5cXG5cdFx0PGltZyBjbGFzcz1cXFwic2VxdWVuY2Utc3RlcCBjdXJyZW50IGRlZmF1bHRcXFwiIGFsdD1cXFwiXCJcbiAgICArIGFsaWFzNCgoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLnRleHQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLnRleHQgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcInRleHRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiXFxcIiBsb25nZGVzYz1cXFwiI2Rlc2NfbVwiXG4gICAgKyBhbGlhczQoKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5pZCB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuaWQgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcImlkXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIlxcXCIgLz5cXG5cdDwvZGl2Plxcblx0PGRpdiBjbGFzcz1cXFwib3ZlcmxheSBtZWRpYS1zaXplXFxcIj5cXG5cdFx0PGRpdiBjbGFzcz1cXFwicGxheS10b2dnbGUtaGl0YXJlYSBwbGF5LXRvZ2dsZVxcXCI+XFxuXHRcdDwvZGl2Plxcblx0PC9kaXY+XFxuPC9kaXY+XFxuXCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlclxuICovXG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG4vKiBJbXBvcnRzXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lLmJhYnlzaXR0ZXJ9ICovXG52YXIgQ29udGFpbmVyID0gcmVxdWlyZShcImJhY2tib25lLmJhYnlzaXR0ZXJcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9QbGF5YWJsZVJlbmRlcmVyfSAqL1xudmFyIFBsYXlhYmxlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL1BsYXlhYmxlUmVuZGVyZXJcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb259ICovXG4vLyB2YXIgU2VsZWN0YWJsZUNvbGxlY3Rpb24gPSByZXF1aXJlKFwiYXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9uXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyfSAqL1xudmFyIFByb2dyZXNzTWV0ZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL1RpbWVyfSAqL1xudmFyIFRpbWVyID0gcmVxdWlyZShcInV0aWxzL1RpbWVyXCIpO1xuLy8gLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbi8vIHZhciB0cmFuc2l0aW9uRW5kID0gcmVxdWlyZShcInV0aWxzL2V2ZW50L3RyYW5zaXRpb25FbmRcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFByb3BlcnR5fSAqL1xuLy8gdmFyIHByZWZpeGVkID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkUHJvcGVydHlcIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgX3doZW5JbWFnZUxvYWRzID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2UvX3doZW5JbWFnZUxvYWRzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS9fbG9hZEltYWdlQXNPYmplY3RVUkx9ICovXG52YXIgX2xvYWRJbWFnZUFzT2JqZWN0VVJMID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2UvX2xvYWRJbWFnZUFzT2JqZWN0VVJMXCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciB3aGVuU2VsZWN0aW9uRGlzdGFuY2VJcyA9IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3Rpb25EaXN0YW5jZUlzXCIpO1xuLy8gdmFyIHdoZW5TZWxlY3RUcmFuc2l0aW9uRW5kcyA9IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3RUcmFuc2l0aW9uRW5kc1wiKTtcbi8vIHZhciB3aGVuRGVmYXVsdEltYWdlTG9hZHMgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuRGVmYXVsdEltYWdlTG9hZHNcIik7XG5cbi8vIC8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG4vLyB2YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG4vLyB2YXIgZHVvdG9uZSA9IHJlcXVpcmUoXCJ1dGlscy9jYW52YXMvYml0bWFwL2R1b3RvbmVcIik7XG4vLyB2YXIgc3RhY2tCbHVyUkdCID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9iaXRtYXAvc3RhY2tCbHVyUkdCXCIpO1xuLy8gdmFyIHN0YWNrQmx1ck1vbm8gPSByZXF1aXJlKFwidXRpbHMvY2FudmFzL2JpdG1hcC9zdGFja0JsdXJNb25vXCIpO1xuLy8gdmFyIGdldEF2ZXJhZ2VSR0JBID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9iaXRtYXAvZ2V0QXZlcmFnZVJHQkFcIik7XG5cbnZhciBlcnJvclRlbXBsYXRlID0gcmVxdWlyZShcIi4uL3RlbXBsYXRlL0Vycm9yQmxvY2suaGJzXCIpO1xuXG52YXIgTUlOX1NURVBfSU5URVJWQUwgPSAyICogR2xvYmFscy5UUkFOU0lUSU9OX0RVUkFUSU9OICsgR2xvYmFscy5UUkFOU0lUSU9OX0RFTEFZX0lOVEVSVkFMO1xudmFyIERFRkFVTFRfU1RFUF9JTlRFUlZBTCA9IDYgKiBHbG9iYWxzLlRSQU5TSVRJT05fRFVSQVRJT04gKyBHbG9iYWxzLlRSQU5TSVRJT05fREVMQVlfSU5URVJWQUw7XG5cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcbi8qIFByaXZhdGUgY2xhc3Nlc1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIC8qKlxuLy8gKiBAY29uc3RydWN0b3Jcbi8vICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlci5Tb3VyY2VDb2xsZWN0aW9ufVxuLy8gKi9cbi8vIHZhciBTb3VyY2VDb2xsZWN0aW9uID0gU2VsZWN0YWJsZUNvbGxlY3Rpb24uZXh0ZW5kKHtcbi8vIFx0bW9kZWw6IEJhY2tib25lLk1vZGVsXG4vLyB9KTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1NlcXVlbmNlUmVuZGVyZXIuUHJlZmV0ZWNoZWRTb3VyY2VSZW5kZXJlcn1cbiAqL1xudmFyIFByZWZldGVjaGVkU291cmNlUmVuZGVyZXIgPSBWaWV3LmV4dGVuZCh7XG5cblx0Y2lkUHJlZml4OiBcInNlcXVlbmNlU3RlcFJlbmRlcmVyXCIsXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjbGFzc05hbWU6IFwic2VxdWVuY2Utc3RlcFwiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0dGFnTmFtZTogXCJpbWdcIixcblxuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0cmVhZHk6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9yZWFkeTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0IXRoaXMuZWwuaGFzQXR0cmlidXRlKFwiYWx0XCIpICYmIHRoaXMuZWwuc2V0QXR0cmlidXRlKFwiYWx0XCIsIHRoaXMubW9kZWwuZ2V0KFwic3JjXCIpKTtcblx0XHQvLyB0aGlzLmVsLnNldEF0dHJpYnV0ZShcImxvbmdkZXNjXCIsIHRoaXMubW9kZWwuZ2V0KFwib3JpZ2luYWxcIikpO1xuXG5cdFx0aWYgKHRoaXMubW9kZWwuaGFzKFwicHJlZmV0Y2hlZFwiKSkge1xuXHRcdFx0dGhpcy5fcmVuZGVyUHJlZmV0Y2hlZCgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlOnByZWZldGNoZWRcIiwgdGhpcy5fcmVuZGVyUHJlZmV0Y2hlZCk7XG5cdFx0fVxuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJzZWxlY3RlZCBkZXNlbGVjdGVkXCIsIHRoaXMuX3JlbmRlclNlbGVjdGlvbik7XG5cdFx0dGhpcy5fcmVuZGVyU2VsZWN0aW9uKCk7XG5cdH0sXG5cblx0X3JlbmRlclNlbGVjdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCAhIXRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHR9LFxuXG5cdF9yZW5kZXJQcmVmZXRjaGVkOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgcHJlZmV0Y2hlZCA9IHRoaXMubW9kZWwuZ2V0KFwicHJlZmV0Y2hlZFwiKTtcblx0XHRpZiAocHJlZmV0Y2hlZCAhPT0gdGhpcy5lbC5zcmMpIHtcblx0XHRcdHRoaXMuZWwuc3JjID0gcHJlZmV0Y2hlZDtcblx0XHR9XG5cdFx0X3doZW5JbWFnZUxvYWRzKHRoaXMuZWwpLnRoZW4oXG5cdFx0XHRmdW5jdGlvbihlbCkge1xuXHRcdFx0XHR0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbih0c3RhbXApIHtcblx0XHRcdFx0XHR0aGlzLl9zZXRSZWFkeSh0cnVlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9LmJpbmQodGhpcyksXG5cdFx0XHRmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0Ly8gdGhpcy5fc2V0UmVhZHkoZmFsc2UpO1xuXHRcdFx0XHQoZXJyIGluc3RhbmNlb2YgRXJyb3IpIHx8IChlcnIgPSBuZXcgRXJyb3IoXCJjYW5ub3QgbG9hZCBwcmVmZXRjaGVkIHVybFwiKSk7XG5cdFx0XHRcdHRocm93IGVycjtcblx0XHRcdH0uYmluZCh0aGlzKVxuXHRcdCk7XG5cdH0sXG5cblx0LyoqIEB0eXBlIHtib29sZWFufSAqL1xuXHRfcmVhZHk6IGZhbHNlLFxuXG5cdF9zZXRSZWFkeTogZnVuY3Rpb24ocmVhZHkpIHtcblx0XHRpZiAodGhpcy5fcmVhZHkgPT09IHJlYWR5KSByZXR1cm47XG5cdFx0dGhpcy5fcmVhZHkgPSAhIShyZWFkeSk7IC8vIG1ha2UgYm9vbFxuXHRcdHRoaXMudHJpZ2dlcihcInJlbmRlcmVyOnJlYWR5XCIsIHRoaXMpO1xuXHR9LFxuXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gaWYgKHRoaXMubW9kZWwuaGFzKFwicHJlZmV0Y2hlZFwiKSkge1xuXHRcdC8vIFx0dGhpcy5fcmVuZGVyUHJlZmV0Y2hlZCgpO1xuXHRcdC8vIH1cblx0XHQvLyB0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjdXJyZW50XCIsICEhdGhpcy5tb2RlbC5zZWxlY3RlZCk7XG5cdFx0Y29uc29sZS5sb2coXCIlczo6cmVuZGVyXCIsIHRoaXMuY2lkKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcbn0pO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlci5TaW1wbGVTb3VyY2VSZW5kZXJlcn1cbiAqL1xuLy8gdmFyIFNpbXBsZVNvdXJjZVJlbmRlcmVyID0gVmlldy5leHRlbmQoe1xuLy9cbi8vIFx0Y2lkUHJlZml4OiBcInNlcXVlbmNlU3RlcFJlbmRlcmVyXCIsXG4vLyBcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuLy8gXHRjbGFzc05hbWU6IFwic2VxdWVuY2Utc3RlcFwiLFxuLy8gXHQvKiogQHR5cGUge3N0cmluZ30gKi9cbi8vIFx0dGFnTmFtZTogXCJpbWdcIixcbi8vXG4vLyBcdC8qKiBAb3ZlcnJpZGUgKi9cbi8vIFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24gKG9wdGlvbnMpIHtcbi8vIFx0XHQvLyB0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjdXJyZW50XCIsIHRoaXMubW9kZWwuaGFzT3duUHJvcGVydHkoXCJzZWxlY3RlZFwiKSk7XG4vLyBcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCAhIXRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuLy8gXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwge1xuLy8gXHRcdFx0XCJzZWxlY3RlZFwiOiBmdW5jdGlvbiAoKSB7XG4vLyBcdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcImN1cnJlbnRcIik7XG4vLyBcdFx0XHR9LFxuLy8gXHRcdFx0XCJkZXNlbGVjdGVkXCI6IGZ1bmN0aW9uICgpIHtcbi8vIFx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY3VycmVudFwiKTtcbi8vIFx0XHRcdH1cbi8vIFx0XHR9KTtcbi8vIFx0XHRpZiAodGhpcy5lbC5zcmMgPT09IFwiXCIpIHtcbi8vIFx0XHRcdHRoaXMuZWwuc3JjID0gR2xvYmFscy5NRURJQV9ESVIgKyBcIi9cIiArIHRoaXMubW9kZWwuZ2V0KFwic3JjXCIpO1xuLy8gXHRcdH1cbi8vXG4vLyBcdFx0aWYgKHRoaXMubW9kZWwuaGFzKFwiZXJyb3JcIikpIHtcbi8vIFx0XHRcdHRoaXMuX29uTW9kZWxFcnJvcigpO1xuLy8gXHRcdH0gZWxzZSB7XG4vLyBcdFx0XHR0aGlzLmxpc3RlblRvT25jZSh0aGlzLm1vZGVsLCBcImNoYW5nZTplcnJvclwiLCB0aGlzLl9vbk1vZGVsRXJyb3IpO1xuLy8gXHRcdFx0Ly8gdGhpcy5saXN0ZW5Ub09uY2UodGhpcy5tb2RlbCwge1xuLy8gXHRcdFx0Ly8gXHRcImNoYW5nZTpzb3VyY2VcIjogdGhpcy5fb25Nb2RlbFNvdXJjZSxcbi8vIFx0XHRcdC8vIFx0XCJjaGFuZ2U6ZXJyb3JcIjogdGhpcy5fb25Nb2RlbEVycm9yLFxuLy8gXHRcdFx0Ly8gfSk7XG4vLyBcdFx0fVxuLy8gXHR9LFxuLy9cbi8vIFx0Ly8gX29uTW9kZWxTb3VyY2U6IGZ1bmN0aW9uKCkge1xuLy8gXHQvLyBcdHRoaXMuZWwuc3JjID0gR2xvYmFscy5NRURJQV9ESVIgKyBcIi9cIiArIHRoaXMubW9kZWwuZ2V0KFwic3JjXCIpO1xuLy8gXHQvLyBcdC8vIGNvbnNvbGUubG9nKFwiJXM6OmNoYW5nZTpzcmNcIiwgdGhpcy5jaWQsIHRoaXMubW9kZWwuZ2V0KFwic3JjXCIpKTtcbi8vIFx0Ly8gfSxcbi8vXG4vLyBcdF9vbk1vZGVsRXJyb3I6IGZ1bmN0aW9uKCkge1xuLy8gXHRcdHZhciBlcnIgPSB0aGlzLm1vZGVsLmdldChcImVycm9yXCIpO1xuLy8gXHRcdHZhciBlcnJFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4vLyBcdFx0ZXJyRWwuY2xhc3NOYW1lID0gXCJlcnJvciBjb2xvci1iZ1wiICsgKHRoaXMubW9kZWwuc2VsZWN0ZWQ/IFwiIGN1cnJlbnRcIiA6IFwiXCIpO1xuLy8gXHRcdGVyckVsLmlubmVySFRNTCA9IGVycm9yVGVtcGxhdGUoZXJyKTtcbi8vIFx0XHR0aGlzLnNldEVsZW1lbnQoZXJyRWwsIHRydWUpO1xuLy8gXHRcdGNvbnNvbGUubG9nKFwiJXM6OmNoYW5nZTplcnJvclwiLCB0aGlzLmNpZCwgZXJyLm1lc3NhZ2UsIGVyci5pbmZvU3JjKTtcbi8vIFx0fSxcbi8vIH0pO1xuXG52YXIgU291cmNlRXJyb3JSZW5kZXJlciA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2xhc3NOYW1lOiBcInNlcXVlbmNlLXN0ZXAgZXJyb3JcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjaWRQcmVmaXg6IFwic291cmNlRXJyb3JSZW5kZXJlclwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRlbXBsYXRlOiBlcnJvclRlbXBsYXRlLFxuXHQvKiogQHR5cGUge2Jvb2xlYW59ICovXG5cdHJlYWR5OiB0cnVlLFxuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHQvLyB2YXIgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlID0gZnVuY3Rpb24gb25TZWxlY3Rpb25DaGFuZ2UgKCkge1xuXHRcdC8vIFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCAhIXRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHRcdC8vIH07XG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkIGRlc2VsZWN0ZWRcIiwgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKTtcblx0XHQvLyAvLyB0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjdXJyZW50XCIsICEhdGhpcy5tb2RlbC5zZWxlY3RlZCk7XG5cdFx0Ly8gaGFuZGxlU2VsZWN0aW9uQ2hhbmdlLmNhbGwodGhpcyk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkIGRlc2VsZWN0ZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjdXJyZW50XCIsICEhdGhpcy5tb2RlbC5zZWxlY3RlZCk7XG5cdFx0fSk7XG5cdH0sXG5cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjdXJyZW50XCIsICEhdGhpcy5tb2RlbC5zZWxlY3RlZCk7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwuZ2V0KFwiZXJyb3JcIikpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxufSk7XG5cbnZhciBTZXF1ZW5jZVN0ZXBSZW5kZXJlciA9IFByZWZldGVjaGVkU291cmNlUmVuZGVyZXI7XG4vLyB2YXIgU2VxdWVuY2VTdGVwUmVuZGVyZXIgPSBTaW1wbGVTb3VyY2VSZW5kZXJlcjtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1NlcXVlbmNlUmVuZGVyZXJ9XG4gKi9cbnZhciBTZXF1ZW5jZVJlbmRlcmVyID0gUGxheWFibGVSZW5kZXJlci5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwic2VxdWVuY2VSZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2xhc3NOYW1lOiBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5jbGFzc05hbWUgKyBcIiBzZXF1ZW5jZS1yZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHR0ZW1wbGF0ZTogcmVxdWlyZShcIi4vU2VxdWVuY2VSZW5kZXJlci5oYnNcIiksXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogaW5pdGlhbGl6ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnNvdXJjZXMgPSB0aGlzLm1vZGVsLmdldChcInNvdXJjZXNcIik7XG5cdFx0UGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdGluaXRpYWxpemVBc3luYzogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemVBc3luYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpXG5cdFx0XHQudGhlbihcblx0XHRcdFx0ZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHRcdHJldHVybiB2aWV3LndoZW5BdHRhY2hlZCgpO1xuXHRcdFx0XHR9KVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHR2aWV3LmluaXRpYWxpemVQbGF5YWJsZSgpO1xuXHRcdFx0XHR2aWV3LnVwZGF0ZU92ZXJsYXkodmlldy5kZWZhdWx0SW1hZ2UsIHZpZXcub3ZlcmxheSk7XG5cdFx0XHRcdHZpZXcuYWRkU2VsZWN0aW9uTGlzdGVuZXJzKCk7XG5cdFx0XHRcdHJldHVybiB2aWV3O1xuXHRcdFx0fSk7XG5cdH0sXG5cblx0d2hlbkluaXRpYWxpemVkOiBmdW5jdGlvbih2aWV3KSB7XG5cdFx0dmFyIHJldHZhbCA9IFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLndoZW5Jbml0aWFsaXplZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdHZpZXcuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0XHRyZXR1cm4gcmV0dmFsO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGNoaWxkcmVuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y3JlYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLmNyZWF0ZUNoaWxkcmVuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlaG9sZGVyXCIpO1xuXHRcdHRoaXMuc2VxdWVuY2UgPSB0aGlzLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5zZXF1ZW5jZVwiKTtcblxuXHRcdHRoaXMuY29udGVudC5jbGFzc0xpc3QuYWRkKFwic3RhcnRlZFwiKTtcblxuXHRcdC8vIHN0eWxlc1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHZhciBzLCBhdHRycyA9IHRoaXMubW9kZWwuYXR0cnMoKTtcblx0XHQvLyB2YXIgcywgYXR0cnMgPSB0aGlzLm1vZGVsLmdldChcImF0dHJzXCIpO1xuXHRcdHMgPSBfLnBpY2soYXR0cnMsIFwiYm94LXNoYWRvd1wiLCBcImJvcmRlclwiLCBcImJvcmRlci1yYWRpdXNcIik7XG5cdFx0Xy5leHRlbmQodGhpcy5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIubWVkaWEtYm9yZGVyXCIpLnN0eWxlLCBzKTtcblx0XHRzID0gXy5waWNrKGF0dHJzLCBcImJvcmRlci1yYWRpdXNcIik7XG5cdFx0Xy5leHRlbmQodGhpcy5zZXF1ZW5jZS5zdHlsZSwgcyk7XG5cdFx0Xy5leHRlbmQodGhpcy5wbGFjZWhvbGRlci5zdHlsZSwgcyk7XG5cblx0XHQvLyBtb2RlbFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuc291cmNlcy5zZWxlY3QodGhpcy5tb2RlbC5nZXQoXCJzb3VyY2VcIikpO1xuXG5cdFx0Ly8gaXRlbVZpZXdzXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dGhpcy5pdGVtVmlld3MgPSBuZXcgQ29udGFpbmVyKCk7XG5cdFx0Ly8gYWRkIGRlZmF1bHQgaW1hZ2UgYXMgcmVuZGVyZXIgKGFscmVhZHkgaW4gRE9NKVxuXHRcdHRoaXMuaXRlbVZpZXdzLmFkZChuZXcgU2VxdWVuY2VTdGVwUmVuZGVyZXIoe1xuXHRcdFx0ZWw6IHRoaXMuZ2V0RGVmYXVsdEltYWdlKCksXG5cdFx0XHRtb2RlbDogdGhpcy5zb3VyY2VzLnNlbGVjdGVkXG5cdFx0fSkpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGxheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0UGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR2YXIgZWxzLCBlbCwgaSwgY3NzVywgY3NzSDtcblx0XHR2YXIgY29udGVudCA9IHRoaXMuY29udGVudDtcblxuXHRcdC8vIG1lZGlhLXNpemVcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRjc3NXID0gdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoICsgXCJweFwiO1xuXHRcdGNzc0ggPSB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0ICsgXCJweFwiO1xuXG5cdFx0ZWxzID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1lZGlhLXNpemVcIik7XG5cdFx0Zm9yIChpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykge1xuXHRcdFx0ZWwgPSBlbHMuaXRlbShpKTtcblx0XHRcdGVsLnN0eWxlLndpZHRoID0gY3NzVztcblx0XHRcdGVsLnN0eWxlLmhlaWdodCA9IGNzc0g7XG5cdFx0fVxuXHRcdGNvbnRlbnQuc3R5bGUud2lkdGggPSBjc3NXO1xuXHRcdGNvbnRlbnQuc3R5bGUuaGVpZ2h0ID0gY3NzSDtcblxuXHRcdC8vIGNvbnRlbnQtcG9zaXRpb25cblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR2YXIgY3NzWCwgY3NzWTtcblx0XHRjc3NYID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQueCArIFwicHhcIjtcblx0XHRjc3NZID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQueSArIFwicHhcIjtcblx0XHRjb250ZW50LnN0eWxlLmxlZnQgPSBjc3NYO1xuXHRcdGNvbnRlbnQuc3R5bGUudG9wID0gY3NzWTtcblxuXHRcdGVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRyb2xzXCIpO1xuXHRcdC8vIGVsLnN0eWxlLmxlZnQgPSBjc3NYO1xuXHRcdC8vIGVsLnN0eWxlLnRvcCA9IGNzc1k7XG5cdFx0ZWwuc3R5bGUud2lkdGggPSB0aGlzLm1ldHJpY3MuY29udGVudC53aWR0aCArIFwicHhcIjtcblx0XHRlbC5zdHlsZS5oZWlnaHQgPSB0aGlzLm1ldHJpY3MuY29udGVudC5oZWlnaHQgKyBcInB4XCI7XG5cblx0XHQvLyAvLyBjb250ZW50LXNpemVcblx0XHQvLyAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvLyBjc3NXID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQud2lkdGggKyBcInB4XCI7XG5cdFx0Ly8gY3NzSCA9IHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCArIFwicHhcIjtcblx0XHQvL1xuXHRcdC8vIGVscyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcIi5jb250ZW50LXNpemVcIik7XG5cdFx0Ly8gZm9yIChpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykge1xuXHRcdC8vIFx0ZWwgPSBlbHMuaXRlbShpKTtcblx0XHQvLyBcdGVsLnN0eWxlLndpZHRoID0gY3NzVztcblx0XHQvLyBcdGVsLnN0eWxlLmhlaWdodCA9IGNzc0g7XG5cdFx0Ly8gfVxuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0aW5pdGlhbGl6ZVBsYXlhYmxlOiBmdW5jdGlvbigpIHtcblx0XHQvLyBTZXF1ZW5jZSBtb2RlbFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vIHRoaXMuc291cmNlcyA9IHRoaXMuX2NyZWF0ZVNvdXJjZUNvbGxlY3Rpb24odGhpcy5tb2RlbCk7XG5cdFx0d2hlblNlbGVjdGlvbkRpc3RhbmNlSXModGhpcywgMCkudGhlbih0aGlzLl9wcmVsb2FkQWxsSXRlbXMsIGZ1bmN0aW9uKGVycikge1xuXHRcdFx0aWYgKGVyciBpbnN0YW5jZW9mIFZpZXcuVmlld0Vycm9yKSB7IC8vIElnbm9yZSBWaWV3RXJyb3Jcblx0XHRcdFx0Ly8gY29uc29sZS53YXJuKGVyci5uYW1lLCBlcnIubWVzc2FnZSk7Ly8sIGVyci52aWV3LmNpZCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdHJldHVybiBlcnI7XG5cdFx0fSk7XG5cblx0XHQvLyB0aW1lclxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuX3NlcXVlbmNlSW50ZXJ2YWwgPSBNYXRoLm1heChwYXJzZUludCh0aGlzLm1vZGVsLmF0dHIoXCJAc2VxdWVuY2UtaW50ZXJ2YWxcIikpLCBNSU5fU1RFUF9JTlRFUlZBTCkgfHwgREVGQVVMVF9TVEVQX0lOVEVSVkFMO1xuXG5cdFx0dGhpcy50aW1lciA9IG5ldyBUaW1lcigpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnJlbW92ZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLnRpbWVyLnN0b3AoKTtcblx0XHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLnRpbWVyKTtcblx0XHR9KTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMudGltZXIsIHtcblx0XHRcdFwic3RhcnRcIjogdGhpcy5fb25UaW1lclN0YXJ0LFxuXHRcdFx0XCJyZXN1bWVcIjogdGhpcy5fb25UaW1lclJlc3VtZSxcblx0XHRcdFwicGF1c2VcIjogdGhpcy5fb25UaW1lclBhdXNlLFxuXHRcdFx0XCJlbmRcIjogdGhpcy5fb25UaW1lckVuZCxcblx0XHRcdC8vIFwic3RvcFwiOiBmdW5jdGlvbiAoKSB7IC8vIHN0b3AgaXMgb25seSBjYWxsZWQgb24gdmlldyByZW1vdmV9LFxuXHRcdH0pO1xuXG5cdFx0Ly8gcHJvZ3Jlc3MtbWV0ZXIgbW9kZWxcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLl9zb3VyY2VQcm9ncmVzc0J5SWR4ID0gdGhpcy5zb3VyY2VzLm1hcChmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiAwO1xuXHRcdH0pO1xuXHRcdHRoaXMuX3NvdXJjZVByb2dyZXNzQnlJZHhbMF0gPSAxOyAvLyBmaXJzdCBpdGVtIGlzIGFscmVhZHkgbG9hZGVkXG5cblx0XHQvLyBwcm9ncmVzcy1tZXRlclxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMucHJvZ3Jlc3NNZXRlciA9IG5ldyBQcm9ncmVzc01ldGVyKHtcblx0XHRcdGVsOiB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZ3Jlc3MtbWV0ZXJcIiksXG5cdFx0XHR2YWx1ZXM6IHtcblx0XHRcdFx0YXZhaWxhYmxlOiB0aGlzLl9zb3VyY2VQcm9ncmVzc0J5SWR4LmNvbmNhdCgpLFxuXHRcdFx0fSxcblx0XHRcdG1heFZhbHVlczoge1xuXHRcdFx0XHRhbW91bnQ6IHRoaXMuc291cmNlcy5sZW5ndGgsXG5cdFx0XHRcdGF2YWlsYWJsZTogdGhpcy5zb3VyY2VzLmxlbmd0aCxcblx0XHRcdH0sXG5cdFx0XHRjb2xvcjogdGhpcy5tb2RlbC5hdHRyKFwiY29sb3JcIiksXG5cdFx0XHQvLyBiYWNrZ3JvdW5kQ29sb3I6IHRoaXMubW9kZWwuYXR0cihcImJhY2tncm91bmQtY29sb3JcIiksXG5cdFx0XHRsYWJlbEZuOiB0aGlzLl9wcm9ncmVzc0xhYmVsRm4uYmluZCh0aGlzKVxuXHRcdH0pO1xuXG5cdFx0Ly8gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnRvcC1iYXJcIilcblx0XHQvL1x0XHQuYXBwZW5kQ2hpbGQodGhpcy5wcm9ncmVzc01ldGVyLnJlbmRlcigpLmVsKTtcblx0fSxcblxuXHRfcHJvZ3Jlc3NMYWJlbEZuOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5wbGF5YmFja1JlcXVlc3RlZCA9PT0gZmFsc2UpIHJldHVybiBHbG9iYWxzLlBBVVNFX0NIQVI7XG5cdFx0cmV0dXJuICh0aGlzLnNvdXJjZXMuc2VsZWN0ZWRJbmRleCArIDEpICsgXCIvXCIgKyB0aGlzLnNvdXJjZXMubGVuZ3RoO1xuXHR9LFxuXG5cdF9wcmVsb2FkQWxsSXRlbXM6IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHR2aWV3Lm9uY2UoXCJ2aWV3OnJlbW92ZVwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBzaWxlbnQgPSB7XG5cdFx0XHRcdHNpbGVudDogdHJ1ZVxuXHRcdFx0fTtcblx0XHRcdHZpZXcuc291cmNlcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBzb3VyY2VzKSB7XG5cdFx0XHRcdHZhciBwcmVmZXRjaGVkID0gaXRlbS5nZXQoXCJwcmVmZXRjaGVkXCIpO1xuXHRcdFx0XHRpZiAocHJlZmV0Y2hlZCAmJiAvXmJsb2JcXDovLnRlc3QocHJlZmV0Y2hlZCkpIHtcblx0XHRcdFx0XHRpdGVtLnVuc2V0KFwicHJlZmV0Y2hlZFwiLCBzaWxlbnQpO1xuXHRcdFx0XHRcdGl0ZW0uc2V0KFwicHJvZ3Jlc3NcIiwgMCwgc2lsZW50KTtcblx0XHRcdFx0XHRVUkwucmV2b2tlT2JqZWN0VVJMKHByZWZldGNoZWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0XHRyZXR1cm4gdmlldy5zb3VyY2VzLnJlZHVjZShmdW5jdGlvbihsYXN0UHJvbWlzZSwgaXRlbSwgaW5kZXgsIHNvdXJjZXMpIHtcblx0XHRcdHJldHVybiBsYXN0UHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0aWYgKGl0ZW0uaGFzKFwicHJlZmV0Y2hlZFwiKSkge1xuXHRcdFx0XHRcdHZpZXcuX3VwZGF0ZUl0ZW1Qcm9ncmVzcygxLCBpbmRleCk7XG5cdFx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0cmV0dXJuIF9sb2FkSW1hZ2VBc09iamVjdFVSTChpdGVtLmdldChcIm9yaWdpbmFsXCIpLFxuXHRcdFx0XHRcdFx0XHRmdW5jdGlvbihwcm9ncmVzcykge1xuXHRcdFx0XHRcdFx0XHRcdHZpZXcuX3VwZGF0ZUl0ZW1Qcm9ncmVzcyhwcm9ncmVzcywgaW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdGl0ZW0uc2V0KFwicHJvZ3Jlc3NcIiwgcHJvZ3Jlc3MpO1xuXHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdFx0LnRoZW4oXG5cdFx0XHRcdFx0XHRcdGZ1bmN0aW9uKHBVcmwpIHtcblx0XHRcdFx0XHRcdFx0XHR2aWV3Ll91cGRhdGVJdGVtUHJvZ3Jlc3MoMSwgaW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdGl0ZW0uc2V0KHtcblx0XHRcdFx0XHRcdFx0XHRcdHByZWZldGNoZWQ6IHBVcmwsXG5cdFx0XHRcdFx0XHRcdFx0XHRwcm9ncmVzczogMVxuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRcdC8vIGl0ZW0uc2V0KFwicHJlZmV0Y2hlZFwiLCBwVXJsKTtcblx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdmlldztcblx0XHRcdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRcdFx0ZnVuY3Rpb24oZXJyKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmlldy5fdXBkYXRlSXRlbVByb2dyZXNzKDAsIGluZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRpdGVtLnNldCh7XG5cdFx0XHRcdFx0XHRcdFx0XHRlcnJvcjogZXJyLFxuXHRcdFx0XHRcdFx0XHRcdFx0cHJvZ3Jlc3M6IDBcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHQvLyBpdGVtLnNldChcImVycm9yXCIsIGVycik7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH0sIFByb21pc2UucmVzb2x2ZSh2aWV3KSk7XG5cdH0sXG5cblx0Ly8gX3ByZWxvYWRBbGxJdGVtczI6IGZ1bmN0aW9uKHZpZXcpIHtcblx0Ly8gXHRyZXR1cm4gdmlldy5zb3VyY2VzLnJlZHVjZShmdW5jdGlvbihsYXN0UHJvbWlzZSwgaXRlbSwgaW5kZXgsIHNvdXJjZXMpIHtcblx0Ly8gXHRcdHJldHVybiBsYXN0UHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0Ly8gXHRcdFx0dmFyIGl0ZW1WaWV3ID0gdmlldy5fZ2V0SXRlbVJlbmRlcmVyKGl0ZW0pO1xuXHQvLyBcdFx0XHRyZXR1cm4gX3doZW5JbWFnZUxvYWRzKGl0ZW1WaWV3LmVsKS50aGVuKGZ1bmN0aW9uKHVybCl7XG5cdC8vIFx0XHRcdFx0dmlldy5fdXBkYXRlSXRlbVByb2dyZXNzKDEsIGluZGV4KTtcblx0Ly8gXHRcdFx0XHRyZXR1cm4gdmlldztcblx0Ly8gXHRcdFx0fSwgZnVuY3Rpb24oZXJyKSB7XG5cdC8vIFx0XHRcdFx0dmlldy5fdXBkYXRlSXRlbVByb2dyZXNzKDAsIGluZGV4KTtcblx0Ly8gXHRcdFx0XHRpdGVtLnNldChcImVycm9yXCIsIGVycik7XG5cdC8vIFx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdC8vIFx0XHRcdH0pO1xuXHQvLyBcdFx0fSk7XG5cdC8vIFx0fSwgUHJvbWlzZS5yZXNvbHZlKHZpZXcpKTtcblx0Ly8gfSxcblxuXHQvLyBfZ2V0SXRlbVJlbmRlcmVyOiBmdW5jdGlvbihpdGVtKSB7fVxuXG5cdF91cGRhdGVJdGVtUHJvZ3Jlc3M6IGZ1bmN0aW9uKHByb2dyZXNzLCBpbmRleCkge1xuXHRcdHRoaXMuX3NvdXJjZVByb2dyZXNzQnlJZHhbaW5kZXhdID0gcHJvZ3Jlc3M7XG5cdFx0aWYgKHRoaXMucHJvZ3Jlc3NNZXRlcikge1xuXHRcdFx0dGhpcy5wcm9ncmVzc01ldGVyLnZhbHVlVG8odGhpcy5fc291cmNlUHJvZ3Jlc3NCeUlkeCwgMzAwLCBcImF2YWlsYWJsZVwiKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIFBsYXlhYmxlUmVuZGVyZXIgaW1wbGVtZW50YXRpb25cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSBpbml0aWFsIHZhbHVlICovXG5cdF9wbGF5YmFja1JlcXVlc3RlZDogdHJ1ZSxcblxuXHQvKiogQHR5cGUge0Jvb2xlYW59IGludGVybmFsIHN0b3JlICovXG5cdF9wYXVzZWQ6IHRydWUsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRfaXNNZWRpYVBhdXNlZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3BhdXNlZDtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdF9wbGF5TWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICghdGhpcy5fcGF1c2VkKSByZXR1cm47XG5cdFx0dGhpcy5fcGF1c2VkID0gZmFsc2U7XG5cdFx0aWYgKHRoaXMudGltZXIuc3RhdHVzID09IFRpbWVyLlBBVVNFRCkge1xuXHRcdFx0dGhpcy50aW1lci5zdGFydCgpOyAvLyByZXN1bWUsIGFjdHVhbGx5XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMudGltZXIuc3RhcnQodGhpcy5fc2VxdWVuY2VJbnRlcnZhbCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0X3BhdXNlTWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9wYXVzZWQpIHJldHVybjtcblx0XHR0aGlzLl9wYXVzZWQgPSB0cnVlO1xuXHRcdGlmICh0aGlzLnRpbWVyLnN0YXR1cyA9PSBUaW1lci5TVEFSVEVEKSB7XG5cdFx0XHR0aGlzLnRpbWVyLnBhdXNlKCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHNlcXVlbmNlIHByaXZhdGVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uVGltZXJTdGFydDogZnVuY3Rpb24oZHVyYXRpb24pIHtcblx0XHR0aGlzLnByb2dyZXNzTWV0ZXIudmFsdWVUbyh0aGlzLnNvdXJjZXMuc2VsZWN0ZWRJbmRleCArIDEsIGR1cmF0aW9uLCBcImFtb3VudFwiKTtcblx0XHQvLyBpbml0IG5leHQgcmVuZGVyZXIgbm93IHRvIGhhdmUgc21vb3RoIHRyYW5zaXRpb25zXG5cdFx0dGhpcy5fZ2V0SXRlbVJlbmRlcmVyKHRoaXMuc291cmNlcy5mb2xsb3dpbmdPckZpcnN0KCkpO1xuXHR9LFxuXG5cdF9vblRpbWVyUmVzdW1lOiBmdW5jdGlvbihkdXJhdGlvbikge1xuXHRcdHRoaXMucHJvZ3Jlc3NNZXRlci52YWx1ZVRvKHRoaXMuc291cmNlcy5zZWxlY3RlZEluZGV4ICsgMSwgZHVyYXRpb24sIFwiYW1vdW50XCIpO1xuXHR9LFxuXG5cdF9vblRpbWVyUGF1c2U6IGZ1bmN0aW9uKGR1cmF0aW9uKSB7XG5cdFx0Ly8gdmFyIG1ldGVyRHVyID0gdGhpcy5wcm9ncmVzc01ldGVyLl92YWx1ZURhdGFbXCJhbW91bnRcIl0uX2R1cmF0aW9uIC0gdGhpcy5wcm9ncmVzc01ldGVyLl92YWx1ZURhdGFbXCJhbW91bnRcIl0uX2VsYXBzZWRUaW1lO1xuXHRcdC8vIHZhciBtZXRlclZhbCA9IHRoaXMucHJvZ3Jlc3NNZXRlci5nZXRSZW5kZXJlZFZhbHVlKFwiYW1vdW50XCIpO1xuXHRcdC8vIHZhciB0aW1lclZhbCA9ICh0aGlzLl9zZXF1ZW5jZUludGVydmFsIC0gZHVyYXRpb24pIC8gdGhpcy5fc2VxdWVuY2VJbnRlcnZhbCArIHRoaXMuc291cmNlcy5zZWxlY3RlZEluZGV4O1xuXHRcdC8vXG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6X29uVGltZXJQYXVzZSBbaW50ZXJ2YWw6JXNtc11cXG5cXHRtZXRlcjolcyAoJXNtcylcXG5cXHR0aW1lcjolcyAoJXNtcylcXG5cXHRkaWZmczolcyAoJXNtcylcIixcblx0XHQvLyBcdFx0dGhpcy5jaWQsIHRoaXMuX3NlcXVlbmNlSW50ZXJ2YWwsXG5cdFx0Ly8gXHRcdG1ldGVyVmFsLCBtZXRlckR1cixcblx0XHQvLyBcdFx0dGltZXJWYWwsIGR1cmF0aW9uLFxuXHRcdC8vIFx0XHRNYXRoLmFicyhtZXRlclZhbC10aW1lclZhbCksIE1hdGguYWJzKG1ldGVyRHVyLWR1cmF0aW9uKSk7XG5cblx0XHQvLyB0aGlzLnByb2dyZXNzTWV0ZXIudmFsdWVUbyh0aW1lclZhbCk7XG5cdFx0Ly8gdGhpcy5wcm9ncmVzc01ldGVyLnZhbHVlVG8obWV0ZXJWYWwpO1xuXG5cdFx0dGhpcy5wcm9ncmVzc01ldGVyLnZhbHVlVG8odGhpcy5wcm9ncmVzc01ldGVyLmdldFJlbmRlcmVkVmFsdWUoXCJhbW91bnRcIiksIDAsIFwiYW1vdW50XCIpO1xuXHR9LFxuXG5cdF9vblRpbWVyRW5kOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgY29udGV4dCA9IHRoaXM7XG5cdFx0dmFyIG5leHRTb3VyY2UsIG5leHRWaWV3O1xuXG5cdFx0bmV4dFNvdXJjZSA9IHRoaXMuc291cmNlcy5mb2xsb3dpbmdPckZpcnN0KCk7XG5cdFx0Ly8gaW5pdCBuZXh0IHJlbmRlcmVyXG5cdFx0bmV4dFZpZXcgPSB0aGlzLl9nZXRJdGVtUmVuZGVyZXIobmV4dFNvdXJjZSk7XG5cdFx0Ly8gaW5pdCBzZWNvbmQgbmV4dCByZW5kZXJlclxuXHRcdC8vIHRoaXMuX2dldEl0ZW1SZW5kZXJlcih0aGlzLnNvdXJjZXMuZm9sbG93aW5nT3JGaXJzdChuZXh0U291cmNlKSk7XG5cblx0XHR2YXIgc2hvd05leHRWaWV3ID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRjb250ZXh0LnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcblx0XHRcdFx0Y29udGV4dC5jb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ3YWl0aW5nXCIpO1xuXHRcdFx0XHRpZiAoIWNvbnRleHQuX3BhdXNlZCkge1xuXHRcdFx0XHRcdC8vIGlmIChjb250ZXh0LnBsYXliYWNrUmVxdWVzdGVkKSB7XG5cdFx0XHRcdFx0Y29udGV4dC5jb250ZW50LmNsYXNzTGlzdC50b2dnbGUoXCJwbGF5YmFjay1lcnJvclwiLCBuZXh0U291cmNlLmhhcyhcImVycm9yXCIpKTtcblx0XHRcdFx0XHRjb250ZXh0LnNvdXJjZXMuc2VsZWN0KG5leHRTb3VyY2UpOyAvLyBOT1RFOiBzdGVwIGluY3JlYXNlIGRvbmUgaGVyZVxuXHRcdFx0XHRcdC8vIHZpZXcudXBkYXRlT3ZlcmxheShuZXh0Vmlldy5lbCwgdmlldy5vdmVybGF5KTtcblx0XHRcdFx0XHRjb250ZXh0LnRpbWVyLnN0YXJ0KGNvbnRleHQuX3NlcXVlbmNlSW50ZXJ2YWwpO1xuXHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OnNob3dOZXh0VmlldyAlc21zICVzXCIsIGNvbnRleHQuY2lkLCBjb250ZXh0Ll9zZXF1ZW5jZUludGVydmFsLCBuZXh0U291cmNlLmNpZClcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fTtcblxuXHRcdGlmIChuZXh0U291cmNlLmhhcyhcInByZWZldGNoZWRcIikpIHtcblx0XHRcdC8vIG5leHRWaWV3ID0gY29udGV4dC5fZ2V0SXRlbVJlbmRlcmVyKG5leHRTb3VyY2UpLmVsO1xuXHRcdFx0X3doZW5JbWFnZUxvYWRzKG5leHRWaWV3LmVsKS50aGVuKHNob3dOZXh0Vmlldywgc2hvd05leHRWaWV3KTtcblx0XHR9IGVsc2UgaWYgKG5leHRTb3VyY2UuaGFzKFwiZXJyb3JcIikpIHtcblx0XHRcdHNob3dOZXh0VmlldygpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNvbnRlbnQuY2xhc3NMaXN0LmFkZChcIndhaXRpbmdcIik7XG5cdFx0XHQvKiBUT0RPOiBhZGQgZ2EgZXZlbnQgJ21lZGlhLXdhaXRpbmcnICovXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOlt3YWl0aW5nXSAlc21zICVzXCIsIGNvbnRleHQuY2lkLCBuZXh0U291cmNlLmNpZCk7XG5cdFx0XHR3aW5kb3cuZ2EoXCJzZW5kXCIsIFwiZXZlbnRcIiwgXCJzZXF1ZW5jZS1yZW5kZXJlclwiLCBcIndhaXRpbmdcIiwgdGhpcy5tb2RlbC5nZXQoXCJ0ZXh0XCIpKTtcblx0XHRcdHRoaXMubGlzdGVuVG8obmV4dFNvdXJjZSwgXCJjaGFuZ2U6cHJlZmV0Y2hlZCBjaGFuZ2U6ZXJyb3JcIixcblx0XHRcdFx0ZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dGhpcy5zdG9wTGlzdGVuaW5nKG5leHRTb3VyY2UsIFwiY2hhbmdlOnByZWZldGNoZWQgY2hhbmdlOmVycm9yXCIpO1xuXHRcdFx0XHRcdC8qIFRPRE86IGFkZCBnYSBldmVudCAnbWVkaWEtcGxheWluZycgKi9cblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOltwbGF5aW5nXSAlc21zICVzXCIsIGNvbnRleHQuY2lkLCBuZXh0U291cmNlLmNpZCk7XG5cdFx0XHRcdFx0d2luZG93LmdhKFwic2VuZFwiLCBcImV2ZW50XCIsIFwic2VxdWVuY2UtcmVuZGVyZXJcIiwgXCJwbGF5aW5nXCIsIHRoaXMubW9kZWwuZ2V0KFwidGV4dFwiKSk7XG5cdFx0XHRcdFx0X3doZW5JbWFnZUxvYWRzKG5leHRWaWV3LmVsKS50aGVuKHNob3dOZXh0Vmlldywgc2hvd05leHRWaWV3KTtcblx0XHRcdFx0XHQvLyBjb250ZXh0LmNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZShcIndhaXRpbmdcIik7XG5cdFx0XHRcdFx0Ly8gbmV4dFZpZXcgPSBjb250ZXh0Ll9nZXRJdGVtUmVuZGVyZXIobmV4dFNvdXJjZSkuZWw7XG5cdFx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHRfZ2V0SXRlbVJlbmRlcmVyOiBmdW5jdGlvbihpdGVtKSB7XG5cdFx0dmFyIHZpZXcgPSB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChpdGVtKTtcblx0XHRpZiAoIXZpZXcpIHtcblx0XHRcdHZhciByZW5kZXJlciA9IGl0ZW0uaGFzKFwiZXJyb3JcIikgPyBTb3VyY2VFcnJvclJlbmRlcmVyIDogU2VxdWVuY2VTdGVwUmVuZGVyZXI7XG5cdFx0XHR2aWV3ID0gbmV3IHJlbmRlcmVyKHtcblx0XHRcdFx0bW9kZWw6IGl0ZW1cblx0XHRcdH0pO1xuXHRcdFx0Ly8gdmlldyA9IG5ldyBTZXF1ZW5jZVN0ZXBSZW5kZXJlcih7IG1vZGVsOiBpdGVtIH0pO1xuXHRcdFx0dGhpcy5pdGVtVmlld3MuYWRkKHZpZXcpO1xuXHRcdFx0dGhpcy5zZXF1ZW5jZS5hcHBlbmRDaGlsZCh2aWV3LnJlbmRlcigpLmVsKTtcblx0XHR9XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcHJvZ3Jlc3MgbWV0ZXJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gX2NyZWF0ZURlZmF1bHRJdGVtRGF0YTogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG5cdC8vIFx0dmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpO1xuXHQvLyBcdHZhciBpbWFnZURhdGEgPSB0aGlzLl9kcmF3TWVkaWFFbGVtZW50KGNvbnRleHQpLmdldEltYWdlRGF0YSgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xuXHQvL1xuXHQvLyBcdHZhciBvcHRzID0geyByYWRpdXM6IDIwIH07XG5cdC8vIFx0dmFyIGZnQ29sb3IgPSBuZXcgQ29sb3IodGhpcy5tb2RlbC5hdHRyKFwiY29sb3JcIikpO1xuXHQvLyBcdHZhciBiZ0NvbG9yID0gbmV3IENvbG9yKHRoaXMubW9kZWwuYXR0cihcImJhY2tncm91bmQtY29sb3JcIikpO1xuXHQvLyBcdHZhciBpc0ZnRGFyayA9IGZnQ29sb3IubHVtaW5vc2l0eSgpIDwgYmdDb2xvci5sdW1pbm9zaXR5KCk7XG5cdC8vIFx0b3B0cy54MDAgPSBpc0ZnRGFyaz8gZmdDb2xvci5jbG9uZSgpLmxpZ2h0ZW4oMC4zMykgOiBiZ0NvbG9yLmNsb25lKCkuZGFya2VuKDAuMzMpO1xuXHQvLyBcdG9wdHMueEZGID0gaXNGZ0Rhcms/IGJnQ29sb3IuY2xvbmUoKS5saWdodGVuKDAuMzMpIDogZmdDb2xvci5jbG9uZSgpLmRhcmtlbigwLjMzKTtcblx0Ly9cblx0Ly8gXHRzdGFja0JsdXJNb25vKGltYWdlRGF0YSwgb3B0cyk7XG5cdC8vIFx0ZHVvdG9uZShpbWFnZURhdGEsIG9wdHMpO1xuXHQvLyBcdC8vIHN0YWNrQmx1clJHQihpbWFnZURhdGEsIG9wdHMpO1xuXHQvL1xuXHQvLyBcdGNvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XG5cdC8vIFx0cmV0dXJuIGNhbnZhcy50b0RhdGFVUkwoKTtcblx0Ly8gfSxcbn0pO1xuXG5pZiAoREVCVUcpIHtcblxuXHRTZXF1ZW5jZVJlbmRlcmVyID0gKGZ1bmN0aW9uKFNlcXVlbmNlUmVuZGVyZXIpIHtcblx0XHRpZiAoIVNlcXVlbmNlUmVuZGVyZXIuTE9HX1RPX1NDUkVFTikgcmV0dXJuIFNlcXVlbmNlUmVuZGVyZXI7XG5cblx0XHQvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZ3MvbHBhZH0gKi9cblx0XHR2YXIgbHBhZCA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlLnN0cmluZy9scGFkXCIpO1xuXG5cdFx0cmV0dXJuIFNlcXVlbmNlUmVuZGVyZXIuZXh0ZW5kKHtcblx0XHRcdF9fbG9nVGltZXJFdmVudDogZnVuY3Rpb24oZXZuYW1lLCBtc2cpIHtcblx0XHRcdFx0dmFyIGxvZ01zZyA9IFtcblx0XHRcdFx0XCJzb3VyY2U6IFwiLCBscGFkKHRoaXMuc291cmNlcy5zZWxlY3RlZEluZGV4LCAyKSxcblx0XHRcdFx0XCJkdXJhdGlvbjpcIiwgbHBhZCh0aGlzLnRpbWVyLmdldER1cmF0aW9uKCksIDQpLFxuXHRcdFx0XHRcInBhdXNlZDpcIiwgdGhpcy5wYXVzZWQsXG5cdFx0XHRcdFwicmVxdWVzdGVkOlwiLCB0aGlzLnBsYXliYWNrUmVxdWVzdGVkLFxuXHRcdFx0XHRcInN0YXR1czpcIiwgdGhpcy50aW1lci5nZXRTdGF0dXMoKSxcblx0XHRcdF07XG5cdFx0XHRcdG1zZyAmJiBsb2dNc2cucHVzaChtc2cpO1xuXHRcdFx0XHRsb2dNc2cgPSBsb2dNc2cuam9pbihcIiBcIik7XG5cblx0XHRcdFx0dGhpcy5fX2xvZ01lc3NhZ2UobG9nTXNnLCBldm5hbWUpO1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpbJXNdICVzXCIsIHRoaXMuY2lkLCBldm5hbWUsIGxvZ01zZyk7XG5cdFx0XHR9LFxuXHRcdFx0X3BsYXlNZWRpYTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwicGxheWJhY2tcIik7XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl9wbGF5TWVkaWEuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6X3BsYXlNZWRpYSgpXCIsIHRoaXMuY2lkKTtcblx0XHRcdH0sXG5cdFx0XHRfcGF1c2VNZWRpYTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwicGxheWJhY2tcIik7XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl9wYXVzZU1lZGlhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol9wYXVzZU1lZGlhKClcIiwgdGhpcy5jaWQpO1xuXHRcdFx0fSxcblxuXHRcdFx0X29uVGltZXJTdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwidGltZXI6c3RhcnRcIik7XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl9vblRpbWVyU3RhcnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cdFx0XHRfb25UaW1lclJlc3VtZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwidGltZXI6cmVzdW1lXCIpO1xuXHRcdFx0XHRTZXF1ZW5jZVJlbmRlcmVyLnByb3RvdHlwZS5fb25UaW1lclN0YXJ0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LFxuXHRcdFx0X29uVGltZXJQYXVzZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwidGltZXI6cGF1c2VcIik7XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl9vblRpbWVyUGF1c2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cdFx0XHRfb25UaW1lckVuZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMuX19sb2dUaW1lckV2ZW50KFwidGltZXI6ZW5kXCIpO1xuXHRcdFx0XHRTZXF1ZW5jZVJlbmRlcmVyLnByb3RvdHlwZS5fb25UaW1lckVuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0fSxcblxuXHRcdFx0X3VwZGF0ZUl0ZW1Qcm9ncmVzczogZnVuY3Rpb24ocHJvZ3Jlc3MsIHNyY0lkeCkge1xuXHRcdFx0XHRpZiAocHJvZ3Jlc3MgPT0gMSkge1xuXHRcdFx0XHRcdHRoaXMuX19sb2dNZXNzYWdlKFwiaWR4OlwiICsgc3JjSWR4ICsgXCIgcHJvZ3Jlc3M6XCIgKyBwcm9ncmVzcywgXCJsb2FkOnByb2dyZXNzXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl91cGRhdGVJdGVtUHJvZ3Jlc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cblx0XHRcdF9wcmVsb2FkQWxsSXRlbXM6IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0dmlldy5fX2xvZ01lc3NhZ2Uodmlldy5jaWQgKyBcIjo6X3ByZWxvYWRBbGxJdGVtc1wiLCBcImxvYWQ6c3RhcnRcIik7XG5cdFx0XHRcdFNlcXVlbmNlUmVuZGVyZXIucHJvdG90eXBlLl9wcmVsb2FkQWxsSXRlbXMuYXBwbHkodmlldywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cdH0pKFNlcXVlbmNlUmVuZGVyZXIpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFNlcXVlbmNlUmVuZGVyZXI7IiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcImNvbXBpbGVyXCI6WzcsXCI+PSA0LjAuMFwiXSxcIm1haW5cIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBoZWxwZXI7XG5cbiAgcmV0dXJuIFwiPGRpdiBjbGFzcz1cXFwicGxhY2Vob2xkZXIgc2l6aW5nXFxcIj48L2Rpdj5cXG48ZGl2IGNsYXNzPVxcXCJjb250ZW50IG1lZGlhLWJvcmRlclxcXCI+XFxuXHQ8ZGl2IGNsYXNzPVxcXCJjb250cm9scyBjb250ZW50LXNpemVcXFwiPlxcblx0XHRcdDxjYW52YXMgY2xhc3M9XFxcInByb2dyZXNzLW1ldGVyXFxcIj48L2NhbnZhcz5cXG5cdFx0XHQ8YSBjbGFzcz1cXFwiZnVsbHNjcmVlbi10b2dnbGVcXFwiIGhyZWY9XFxcImphdmFzY3JpcHQ6KHZvaWQgMClcXFwiPlxcblx0XHRcdFx0PHN2ZyB2ZXJzaW9uPVxcXCIxLjFcXFwiIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgcHJlc2VydmVBc3BlY3RSYXRpbz1cXFwieE1pZFlNaWQgbWVldFxcXCIgdmlld0JveD1cXFwiLTIxIC0yMSA0MiA0MlxcXCIgc3R5bGU9XFxcIm1heC13aWR0aDoxNHB4O21heC1oZWlnaHQ6MTRweFxcXCI+XFxuXHRcdFx0XHRcdDxwYXRoIGQ9XFxcIk0tNSw1IEwtMjAsMjAgTS03LDIwIEwtMjAsMjAgTC0yMCw3IE01LC01IEwyMCwtMjAgTTcsLTIwIEwyMCwtMjAgTDIwLC03XFxcIiBjbGFzcz1cXFwiY29sb3Itc3Ryb2tlXFxcIiBzdHlsZT1cXFwic3Ryb2tlLXdpZHRoOjE7ZmlsbDpub25lO1xcXCIgdmVjdG9yLWVmZmVjdD1cXFwibm9uLXNjYWxpbmctc3Ryb2tlXFxcIiAvPlxcblx0XHRcdFx0PC9zdmc+XFxuXHRcdFx0PC9hPlxcblx0PC9kaXY+XFxuXHQ8ZGl2IGNsYXNzPVxcXCJjcm9wLWJveCBtZWRpYS1zaXplXFxcIj5cXG5cdFx0PHZpZGVvIHByZWxvYWQ9XFxcIm5vbmVcXFwiIHdpZHRoPVxcXCIyNDBcXFwiIGhlaWdodD1cXFwiMTgwXFxcIj48L3ZpZGVvPlxcblx0XHQ8aW1nIGNsYXNzPVxcXCJwb3N0ZXIgZGVmYXVsdFxcXCIgYWx0PVxcXCJcIlxuICAgICsgY29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24oKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy50ZXh0IHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC50ZXh0IDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGhlbHBlcnMuaGVscGVyTWlzc2luZyksKHR5cGVvZiBoZWxwZXIgPT09IFwiZnVuY3Rpb25cIiA/IGhlbHBlci5jYWxsKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge30se1wibmFtZVwiOlwidGV4dFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiIHdpZHRoPVxcXCIyNDBcXFwiIGhlaWdodD1cXFwiMTgwXFxcIiAvPlxcblx0PC9kaXY+XFxuXHQ8ZGl2IGNsYXNzPVxcXCJvdmVybGF5IG1lZGlhLXNpemVcXFwiPlxcblx0XHQ8ZGl2IGNsYXNzPVxcXCJwbGF5LXRvZ2dsZS1oaXRhcmVhIHBsYXktdG9nZ2xlXFxcIj5cXG5cdFx0PC9kaXY+XFxuXHQ8L2Rpdj5cXG48L2Rpdj5cXG5cIjtcbn0sXCJ1c2VEYXRhXCI6dHJ1ZX0pO1xuIiwiLypnbG9iYWwgSFRNTE1lZGlhRWxlbWVudCwgTWVkaWFFcnJvciovXG4vKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL1ZpZGVvUmVuZGVyZXJcbiAqXG4gKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUTUwvRWxlbWVudC92aWRlb1xuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSFRNTE1lZGlhRWxlbWVudFxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9HdWlkZS9FdmVudHMvTWVkaWFfZXZlbnRzXG4gKiBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0d1aWRlL0hUTUwvVXNpbmdfSFRNTDVfYXVkaW9fYW5kX3ZpZGVvXG4gKi9cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcbi8qIEltcG9ydHNcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvUGxheWFibGVSZW5kZXJlcn0gKi9cbnZhciBQbGF5YWJsZVJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9QbGF5YWJsZVJlbmRlcmVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJ9ICovXG52YXIgUHJvZ3Jlc3NNZXRlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9jb21wb25lbnQvUHJvZ3Jlc3NNZXRlclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkU3R5bGVOYW1lfSAqL1xuLy8gdmFyIHByZWZpeGVkU3R5bGVOYW1lID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkU3R5bGVOYW1lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRFdmVudH0gKi9cbnZhciBwcmVmaXhlZEV2ZW50ID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkRXZlbnRcIik7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG4vKiBwcml2YXRlIHN0YXRpY1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8vIHZhciB3aGVuVmlld0lzQXR0YWNoZWQgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuVmlld0lzQXR0YWNoZWRcIik7XG5cbnZhciBmdWxsc2NyZWVuQ2hhbmdlRXZlbnQgPSBwcmVmaXhlZEV2ZW50KFwiZnVsbHNjcmVlbmNoYW5nZVwiLCBkb2N1bWVudCk7XG4vLyB2YXIgZnVsbHNjcmVlbkVycm9yRXZlbnQgPSBwcmVmaXhlZEV2ZW50KFwiZnVsbHNjcmVlbmVycm9yXCIsIGRvY3VtZW50KTtcblxudmFyIGZvcm1hdFRpbWVjb2RlID0gZnVuY3Rpb24odmFsdWUpIHtcblx0aWYgKGlzTmFOKHZhbHVlKSkgcmV0dXJuIFwiXCI7IC8vdmFsdWUgPSAwO1xuXHRpZiAodmFsdWUgPj0gMzYwMCkgcmV0dXJuICgodmFsdWUgLyAzNjAwKSB8IDApICsgXCJIXCI7XG5cdGlmICh2YWx1ZSA+PSA2MCkgcmV0dXJuICgodmFsdWUgLyA2MCkgfCAwKSArIFwiTVwiO1xuXHQvLyBpZiAodmFsdWUgPj0gMTApIHJldHVybiBcIjBcIiArICh2YWx1ZSB8IDApICsgXCJTXCI7XG5cdHJldHVybiAodmFsdWUgfCAwKSArIFwiU1wiO1xufTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1ZpZGVvUmVuZGVyZXJ9XG4gKi9cbnZhciBWaWRlb1JlbmRlcmVyID0gUGxheWFibGVSZW5kZXJlci5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwidmlkZW9SZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2xhc3NOYW1lOiBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5jbGFzc05hbWUgKyBcIiB2aWRlby1yZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHR0ZW1wbGF0ZTogcmVxdWlyZShcIi4vVmlkZW9SZW5kZXJlci5oYnNcIiksXG5cblx0ZXZlbnRzOiAoZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHJldCA9IHt9O1xuXHRcdHJldFtHbG9iYWxzLkNMSUNLX0VWRU5UICsgXCIgZnVsbHNjcmVlbi10b2dnbGVcIl0gPSBcIl9vbkZ1bGxzY3JlZW5Ub2dnbGVcIjtcblx0XHRyZXR1cm4gcmV0O1xuXHR9KCkpLFxuXG5cdC8vIGV2ZW50czoge1xuXHQvLyBcdFwiY2xpY2sgLmZ1bGxzY3JlZW4tdG9nZ2xlXCI6IFwiX29uRnVsbHNjcmVlblRvZ2dsZVwiLFxuXHQvLyB9LFxuXG5cdC8vIHByb3BlcnRpZXM6IHtcblx0Ly8gXHRwYXVzZWQ6IHtcblx0Ly8gXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdC8vIFx0XHRcdHJldHVybiB0aGlzLnZpZGVvLnBhdXNlZDtcblx0Ly8gXHRcdH1cblx0Ly8gXHR9LFxuXHQvLyB9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdF8uYmluZEFsbCh0aGlzLFxuXHRcdFx0XCJfdXBkYXRlUGxheWJhY2tTdGF0ZVwiLFxuXHRcdFx0XCJfdXBkYXRlUGxheWVkVmFsdWVcIixcblx0XHRcdFwiX3VwZGF0ZUJ1ZmZlcmVkVmFsdWVcIixcblx0XHRcdFwiX29uTWVkaWFFcnJvclwiLFxuXHRcdFx0XCJfb25NZWRpYUVuZGVkXCIsXG5cdFx0XHRcIl9vbk1lZGlhUGxheWluZ09uY2VcIixcblx0XHRcdFwiX29uRnVsbHNjcmVlbkNoYW5nZVwiXG5cdFx0KTtcblx0XHQvLyB2YXIgb25QZWVyU2VsZWN0ID0gZnVuY3Rpb24oKSB7XG5cdFx0Ly8gXHR0aGlzLmNvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICh0aGlzLmdldFNlbGVjdGlvbkRpc3RhbmNlKCkgPiAxKT8gXCJub25lXCI6IFwiXCI7XG5cdFx0Ly8gfTtcblx0XHQvLyB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwuY29sbGVjdGlvbiwgXCJzZWxlY3Q6b25lIHNlbGVjdDpub25lXCIsIG9uUGVlclNlbGVjdCk7XG5cdFx0Ly8gb25QZWVyU2VsZWN0KCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogY2hpbGRyZW4vbGF5b3V0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y3JlYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLmNyZWF0ZUNoaWxkcmVuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHR0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlaG9sZGVyXCIpO1xuXHRcdC8vIHRoaXMub3ZlcmxheSA9IHRoaXMuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlcIik7XG5cdFx0dGhpcy52aWRlbyA9IHRoaXMuY29udGVudC5xdWVyeVNlbGVjdG9yKFwidmlkZW9cIik7XG5cdFx0Ly8gdGhpcy52aWRlby5sb29wID0gdGhpcy5tb2RlbC5hdHRycygpLmhhc093blByb3BlcnR5KFwiQHZpZGVvLWxvb3BcIik7XG5cdFx0dGhpcy52aWRlby5sb29wID0gdGhpcy5tb2RlbC5hdHRyKFwiQHZpZGVvLWxvb3BcIikgIT09IHZvaWQgMDtcblx0XHR0aGlzLnZpZGVvLnNyYyA9IHRoaXMuZmluZFBsYXlhYmxlU291cmNlKHRoaXMudmlkZW8pO1xuXHR9LFxuXG5cdG1lYXN1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLm1lYXN1cmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdC8vIE5PVEU6IFRvcC9ib3R0b20gMXB4IHZpZGVvIGNyb3Bcblx0XHQvLyAtIENyb3BwZWQgaW4gQ1NTOiB2aWRlbywgLnBvc3RlciB7IG1hcmdpbi10b3A6IC0xcHg7IG1hcmdpbi1ib3R0b206IC0xcHg7fVxuXHRcdC8vIC0gQ3JvcHBlZCBoZWlnaHQgaXMgYWRqdXN0ZWQgaW4gbWV0cmljcyBvYmpcblx0XHQvLyAtIENyb3AgYW1vdW50IGFkZGVkIGJhY2sgdG8gYWN0dWFsIHZpZGVvIG9uIHJlbmRlcigpXG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCAtPSAyO1xuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCAtPSAyO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdHZhciBlbHMsIGVsLCBpLCBjc3NXLCBjc3NIO1xuXHRcdHZhciBpbWcgPSB0aGlzLmRlZmF1bHRJbWFnZTtcblx0XHR2YXIgY29udGVudCA9IHRoaXMuY29udGVudDtcblxuXHRcdC8vIG1lZGlhLXNpemVcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRjc3NXID0gdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoICsgXCJweFwiO1xuXHRcdGNzc0ggPSB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0ICsgXCJweFwiO1xuXG5cdFx0ZWxzID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1lZGlhLXNpemVcIik7XG5cdFx0Zm9yIChpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykge1xuXHRcdFx0ZWwgPSBlbHMuaXRlbShpKTtcblx0XHRcdGVsLnN0eWxlLndpZHRoID0gY3NzVztcblx0XHRcdGVsLnN0eWxlLmhlaWdodCA9IGNzc0g7XG5cdFx0fVxuXG5cdFx0Y29udGVudC5zdHlsZS53aWR0aCA9IGNzc1c7XG5cdFx0Y29udGVudC5zdHlsZS5oZWlnaHQgPSAodGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCAtIDEpICsgXCJweFwiO1xuXG5cdFx0Ly8gY29udGVudC1wb3NpdGlvblxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHZhciBjc3NYLCBjc3NZO1xuXHRcdGNzc1ggPSB0aGlzLm1ldHJpY3MuY29udGVudC54ICsgXCJweFwiO1xuXHRcdGNzc1kgPSB0aGlzLm1ldHJpY3MuY29udGVudC55ICsgXCJweFwiO1xuXHRcdGNvbnRlbnQuc3R5bGUubGVmdCA9IGNzc1g7XG5cdFx0Y29udGVudC5zdHlsZS50b3AgPSBjc3NZO1xuXG5cdFx0ZWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIuY29udHJvbHNcIik7XG5cdFx0Ly8gZWwuc3R5bGUubGVmdCA9IGNzc1g7XG5cdFx0Ly8gY29udHJvbHMuc3R5bGUudG9wID0gY3NzWTtcblx0XHRlbC5zdHlsZS53aWR0aCA9IHRoaXMubWV0cmljcy5jb250ZW50LndpZHRoICsgXCJweFwiO1xuXHRcdGVsLnN0eWxlLmhlaWdodCA9IHRoaXMubWV0cmljcy5jb250ZW50LmhlaWdodCArIFwicHhcIjtcblxuXHRcdC8vIC8vIGNvbnRlbnQtc2l6ZVxuXHRcdC8vIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8vIGNzc1cgPSB0aGlzLm1ldHJpY3MuY29udGVudC53aWR0aCArIFwicHhcIjtcblx0XHQvLyBjc3NIID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQuaGVpZ2h0ICsgXCJweFwiO1xuXHRcdC8vXG5cdFx0Ly8gZWxzID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLmNvbnRlbnQtc2l6ZVwiKTtcblx0XHQvLyBmb3IgKGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Ly8gXHRlbCA9IGVscy5pdGVtKGkpO1xuXHRcdC8vIFx0ZWwuc3R5bGUud2lkdGggPSBjc3NXO1xuXHRcdC8vIFx0ZWwuc3R5bGUuaGVpZ2h0ID0gY3NzSDtcblx0XHQvLyB9XG5cblx0XHQvLyBOT1RFOiBlbGVtZW50cyBiZWxvdyBtdXN0IHVzZSB2aWRlbydzIFVOQ1JPUFBFRCBoZWlnaHQsIHNvICsycHhcblx0XHR0aGlzLnZpZGVvLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIHRoaXMubWV0cmljcy5tZWRpYS53aWR0aCk7XG5cdFx0dGhpcy52aWRlby5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgdGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCArIDIpO1xuXHRcdGltZy5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCB0aGlzLm1ldHJpY3MubWVkaWEud2lkdGgpO1xuXHRcdGltZy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgdGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCArIDIpO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogaW5pdGlhbGl6ZUFzeW5jXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGluaXRpYWxpemVBc3luYzogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzKVxuXHRcdFx0LnRoZW4oUGxheWFibGVSZW5kZXJlci53aGVuU2VsZWN0aW9uSXNDb250aWd1b3VzKVxuXHRcdFx0LnRoZW4oUGxheWFibGVSZW5kZXJlci53aGVuU2Nyb2xsaW5nRW5kcylcblx0XHRcdC50aGVuKFxuXHRcdFx0XHRmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdFx0cmV0dXJuIFByb21pc2UuYWxsKFtcblx0XHRcdFx0XHRcdHZpZXcud2hlblZpZGVvSGFzTWV0YWRhdGEodmlldyksXG5cdFx0XHRcdFx0XHRQbGF5YWJsZVJlbmRlcmVyLndoZW5EZWZhdWx0SW1hZ2VMb2Fkcyh2aWV3KSxcblx0XHRcdFx0XHRdKS50aGVuKFxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24oYXJyKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBQcm9taXNlLnJlc29sdmUodmlldyk7XG5cdFx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdFx0ZnVuY3Rpb24oZXJyKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBQcm9taXNlLnJlamVjdChlcnIpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH0pXG5cdFx0XHQudGhlbihcblx0XHRcdFx0ZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHRcdHJldHVybiB2aWV3LndoZW5BdHRhY2hlZCgpO1xuXHRcdFx0XHR9KVxuXHRcdFx0LnRoZW4oXG5cdFx0XHRcdGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0XHR2aWV3LmluaXRpYWxpemVQbGF5YWJsZSgpO1xuXHRcdFx0XHRcdHZpZXcudXBkYXRlT3ZlcmxheSh2aWV3LmRlZmF1bHRJbWFnZSwgdmlldy5vdmVybGF5KTtcblx0XHRcdFx0XHR2aWV3LmFkZFNlbGVjdGlvbkxpc3RlbmVycygpO1xuXHRcdFx0XHRcdHJldHVybiB2aWV3O1xuXHRcdFx0XHR9KTtcblx0fSxcblxuXHRpbml0aWFsaXplUGxheWFibGU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHZpZGVvXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dGhpcy5hZGRNZWRpYUxpc3RlbmVycygpO1xuXG5cdFx0Ly8gcHJvZ3Jlc3MtbWV0ZXJcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLnByb2dyZXNzTWV0ZXIgPSBuZXcgUHJvZ3Jlc3NNZXRlcih7XG5cdFx0XHRlbDogdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnByb2dyZXNzLW1ldGVyXCIpLFxuXHRcdFx0bWF4VmFsdWVzOiB7XG5cdFx0XHRcdGFtb3VudDogdGhpcy52aWRlby5kdXJhdGlvbixcblx0XHRcdFx0YXZhaWxhYmxlOiB0aGlzLnZpZGVvLmR1cmF0aW9uLFxuXHRcdFx0fSxcblx0XHRcdGNvbG9yOiB0aGlzLm1vZGVsLmF0dHIoXCJjb2xvclwiKSxcblx0XHRcdC8vIGJhY2tncm91bmRDb2xvcjogdGhpcy5tb2RlbC5hdHRyKFwiYmFja2dyb3VuZC1jb2xvclwiKSxcblx0XHRcdGxhYmVsRm46IHRoaXMuX3Byb2dyZXNzTGFiZWxGbi5iaW5kKHRoaXMpXG5cdFx0fSk7XG5cdFx0Ly8gdmFyIHBhcmVudEVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnRvcC1iYXJcIik7XG5cdFx0Ly8gcGFyZW50RWwuaW5zZXJ0QmVmb3JlKHRoaXMucHJvZ3Jlc3NNZXRlci5yZW5kZXIoKS5lbCwgcGFyZW50RWwuZmlyc3RDaGlsZCk7XG5cdH0sXG5cblx0X3Byb2dyZXNzTGFiZWxGbjogZnVuY3Rpb24odmFsdWUsIHRvdGFsKSB7XG5cdFx0aWYgKCF0aGlzLl9zdGFydGVkIHx8IHRoaXMudmlkZW8uZW5kZWQgfHwgaXNOYU4odmFsdWUpKSB7XG5cdFx0XHRyZXR1cm4gZm9ybWF0VGltZWNvZGUodG90YWwpO1xuXHRcdH0gZWxzZSBpZiAoIXRoaXMucGxheWJhY2tSZXF1ZXN0ZWQpIHtcblx0XHRcdHJldHVybiBHbG9iYWxzLlBBVVNFX0NIQVI7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiBmb3JtYXRUaW1lY29kZSh0b3RhbCAtIHZhbHVlKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHdoZW5WaWRlb0hhc01ldGFkYXRhIHByb21pc2Vcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0d2hlblZpZGVvSGFzTWV0YWRhdGE6IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHQvLyBOT1RFOiBub3QgcHJldHR5ICEhIVxuXHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRcdHZhciBtZWRpYUVsID0gdmlldy52aWRlbztcblx0XHRcdHZhciBldmVudEhhbmRsZXJzID0ge1xuXHRcdFx0XHRsb2FkZWRtZXRhZGF0YTogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0XHRpZiAoZXYpIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6d2hlblZpZGVvSGFzTWV0YWRhdGEgWyVzXSAlc1wiLCB2aWV3LmNpZCwgXCJyZXNvbHZlZFwiLCBldj8gZXYudHlwZSA6IFwic3luY1wiKTtcblx0XHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRhYm9ydDogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0XHRpZiAoZXYpIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0cmVqZWN0KG5ldyBQbGF5YWJsZVJlbmRlcmVyLlZpZXdFcnJvcih2aWV3LCBuZXcgRXJyb3IoXCJ3aGVuVmlkZW9IYXNNZXRhZGF0YTogdmlldyB3YXMgcmVtb3ZlZFwiKSkpO1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0XHRpZiAoZXYpIHJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0dmFyIGVycjtcblx0XHRcdFx0XHRpZiAobWVkaWFFbC5lcnJvcikge1xuXHRcdFx0XHRcdFx0ZXJyID0gbmV3IEVycm9yKF8uaW52ZXJ0KE1lZGlhRXJyb3IpW21lZGlhRWwuZXJyb3IuY29kZV0pO1xuXHRcdFx0XHRcdFx0ZXJyLmluZm9Db2RlID0gbWVkaWFFbC5lcnJvci5jb2RlO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRlcnIgPSBuZXcgRXJyb3IoXCJVbnNwZWNpZmllZCBlcnJvclwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZXJyLmluZm9TcmMgPSBtZWRpYUVsLnNyYztcblx0XHRcdFx0XHRlcnIubG9nTWVzc2FnZSA9IFwid2hlblZpZGVvSGFzTWV0YWRhdGE6IFwiICsgZXJyLm5hbWUgKyBcIiBcIiArIGVyci5pbmZvU3JjO1xuXHRcdFx0XHRcdGVyci5sb2dFdmVudCA9IGV2O1xuXHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHR9LFxuXHRcdFx0fTtcblx0XHRcdC8vICAobWVkaWFFbC5wcmVsb2FkID09IFwiYXV0b1wiICYmIG1lZGlhRWwucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfQ1VSUkVOVF9EQVRBKVxuXHRcdFx0Ly8gXHQobWVkaWFFbC5wcmVsb2FkID09IFwibWV0YWRhdGFcIiAmJiBtZWRpYUVsLnJlYWR5U3RhdGUgPj0gSFRNTE1lZGlhRWxlbWVudC5IQVZFX01FVEFEQVRBKVxuXHRcdFx0aWYgKG1lZGlhRWwuZXJyb3IpIHtcblx0XHRcdFx0ZXZlbnRIYW5kbGVycy5lcnJvcigpO1xuXHRcdFx0fSBlbHNlIGlmIChtZWRpYUVsLnJlYWR5U3RhdGUgPj0gSFRNTE1lZGlhRWxlbWVudC5IQVZFX01FVEFEQVRBKSB7XG5cdFx0XHRcdGV2ZW50SGFuZGxlcnMubG9hZGVkbWV0YWRhdGEoKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHZhciBzb3VyY2VzID0gbWVkaWFFbC5xdWVyeVNlbGVjdG9yQWxsKFwic291cmNlXCIpO1xuXHRcdFx0XHR2YXIgZXJyVGFyZ2V0ID0gc291cmNlcy5sZW5ndGggPiAwID8gc291cmNlcy5pdGVtKHNvdXJjZXMubGVuZ3RoIC0gMSkgOiBtZWRpYUVsO1xuXHRcdFx0XHR2YXIgZXJyQ2FwdHVyZSA9IGVyclRhcmdldCA9PT0gbWVkaWFFbDsgLy8gdXNlIGNhcHR1cmUgd2l0aCBIVE1MTWVkaWFFbGVtZW50XG5cblx0XHRcdFx0dmFyIHJlbW92ZUV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0ZXJyVGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCBldmVudEhhbmRsZXJzLmVycm9yLCBlcnJDYXB0dXJlKTtcblx0XHRcdFx0XHRmb3IgKHZhciBldiBpbiBldmVudEhhbmRsZXJzKSB7XG5cdFx0XHRcdFx0XHRpZiAoZXYgIT09IFwiZXJyb3JcIiAmJiBldmVudEhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2KSkge1xuXHRcdFx0XHRcdFx0XHRtZWRpYUVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXYsIGV2ZW50SGFuZGxlcnNbZXZdLCBmYWxzZSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXHRcdFx0XHRlcnJUYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIGV2ZW50SGFuZGxlcnMuZXJyb3IsIGVyckNhcHR1cmUpO1xuXHRcdFx0XHRmb3IgKHZhciBldiBpbiBldmVudEhhbmRsZXJzKSB7XG5cdFx0XHRcdFx0aWYgKGV2ICE9PSBcImVycm9yXCIgJiYgZXZlbnRIYW5kbGVycy5oYXNPd25Qcm9wZXJ0eShldikpIHtcblx0XHRcdFx0XHRcdG1lZGlhRWwuYWRkRXZlbnRMaXN0ZW5lcihldiwgZXZlbnRIYW5kbGVyc1tldl0sIGZhbHNlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0bWVkaWFFbC5wcmVsb2FkID0gXCJtZXRhZGF0YVwiO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9LFxuXG5cdGZpbmRQbGF5YWJsZVNvdXJjZTogZnVuY3Rpb24odmlkZW8pIHtcblx0XHR2YXIgcGxheWFibGUgPSB0aGlzLm1vZGVsLmdldChcInNvdXJjZXNcIikuZmluZChmdW5jdGlvbihzb3VyY2UpIHtcblx0XHRcdHJldHVybiAvXnZpZGVvXFwvLy50ZXN0KHNvdXJjZS5nZXQoXCJtaW1lXCIpKSAmJiB2aWRlby5jYW5QbGF5VHlwZShzb3VyY2UuZ2V0KFwibWltZVwiKSkgIT0gXCJcIjtcblx0XHR9KTtcblx0XHRyZXR1cm4gcGxheWFibGUgPyBwbGF5YWJsZS5nZXQoXCJvcmlnaW5hbFwiKSA6IFwiXCI7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIFBsYXlhYmxlUmVuZGVyZXIgaW1wbGVtZW50YXRpb25cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSBpbml0aWFsIHZhbHVlICovXG5cdF9wbGF5YmFja1JlcXVlc3RlZDogZmFsc2UsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRfaXNNZWRpYVBhdXNlZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMudmlkZW8ucGF1c2VkO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0X3BsYXlNZWRpYTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMudmlkZW8ucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfQ1VSUkVOVF9EQVRBICYmIHRoaXMudmlkZW8uc2Vla2FibGUubGVuZ3RoID09IDApIHtcblx0XHRcdGNvbnNvbGUud2Fybih0aGlzLmNpZCwgXCJXVEYhIGdvdCB2aWRlbyBkYXRhLCBidXQgY2Fubm90IHNlZWssIGNhbGxpbmcgbG9hZCgpXCIpO1xuXHRcdFx0Ly8gdGhpcy5fbG9nTWVzc2FnZShcImNhbGw6bG9hZFwiLCBcImdvdCB2aWRlbyBkYXRhLCBidXQgY2Fubm90IHNlZWssIGNhbGxpbmcgbG9hZCgpXCIsIFwib3JhbmdlXCIpO1xuXHRcdFx0dGhpcy52aWRlby5sb2FkKCk7XG5cdFx0XHQvLyB0aGlzLnZpZGVvLmN1cnJlbnRUaW1lID0gMDtcblx0XHR9IGVsc2UgaWYgKHRoaXMudmlkZW8uZW5kZWQpIHtcblx0XHRcdHRoaXMudmlkZW8uY3VycmVudFRpbWUgPSB0aGlzLnZpZGVvLnNlZWthYmxlLnN0YXJ0KDApO1xuXHRcdH1cblx0XHR0aGlzLnZpZGVvLnBsYXkoKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdF9wYXVzZU1lZGlhOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnZpZGVvLnBhdXNlKCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIG1lZGlhIGV2ZW50c1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyB1cGRhdGVQbGF5YmFja0V2ZW50czogXCJwbGF5IHBsYXlpbmcgd2FpdGluZyBwYXVzZSBzZWVraW5nIHNlZWtlZCBlbmRlZFwiLFxuXHQvLyB1cGRhdGVCdWZmZXJlZEV2ZW50czogXCJwcm9ncmVzcyBjYW5wbGF5IGNhbnBsYXl0aHJvdWdoIHBsYXlpbmcgdGltZXVwZGF0ZVwiLC8vbG9hZGVkZGF0YVxuXG5cdHBsYXlpbmdPbmNlRXZlbnQ6IFwicGxheWluZ1wiLFxuXHR1cGRhdGVQbGF5YmFja0V2ZW50czogXCJwbGF5aW5nIHdhaXRpbmcgcGF1c2VcIixcblx0dXBkYXRlQnVmZmVyZWRFdmVudHM6IFwicHJvZ3Jlc3MgY2FucGxheSBjYW5wbGF5dGhyb3VnaCBwbGF5IHBsYXlpbmdcIixcblx0dXBkYXRlUGxheWVkRXZlbnRzOiBcInRpbWV1cGRhdGUgc2Vla2VkXCIsXG5cblx0YWRkTWVkaWFMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICghdGhpcy5fc3RhcnRlZCkgdGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKHRoaXMucGxheWluZ09uY2VFdmVudCwgdGhpcy5fb25NZWRpYVBsYXlpbmdPbmNlLCBmYWxzZSk7XG5cdFx0dGhpcy5hZGRMaXN0ZW5lcih0aGlzLnZpZGVvLCB0aGlzLnVwZGF0ZVBsYXliYWNrRXZlbnRzLCB0aGlzLl91cGRhdGVQbGF5YmFja1N0YXRlKTtcblx0XHR0aGlzLmFkZExpc3RlbmVyKHRoaXMudmlkZW8sIHRoaXMudXBkYXRlQnVmZmVyZWRFdmVudHMsIHRoaXMuX3VwZGF0ZUJ1ZmZlcmVkVmFsdWUpO1xuXHRcdHRoaXMuYWRkTGlzdGVuZXIodGhpcy52aWRlbywgdGhpcy51cGRhdGVQbGF5ZWRFdmVudHMsIHRoaXMuX3VwZGF0ZVBsYXllZFZhbHVlKTtcblx0XHR0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJlbmRlZFwiLCB0aGlzLl9vbk1lZGlhRW5kZWQsIGZhbHNlKTtcblx0XHR0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCB0aGlzLl9vbk1lZGlhRXJyb3IsIHRydWUpO1xuXG5cdFx0dGhpcy5vbihcInZpZXc6cmVtb3ZlZFwiLCB0aGlzLnJlbW92ZU1lZGlhTGlzdGVuZXJzLCB0aGlzKTtcblx0fSxcblxuXHRyZW1vdmVNZWRpYUxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5vZmYoXCJ2aWV3OnJlbW92ZWRcIiwgdGhpcy5yZW1vdmVNZWRpYUxpc3RlbmVycywgdGhpcyk7XG5cblx0XHRpZiAoIXRoaXMuX3N0YXJ0ZWQpIHRoaXMudmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLnBsYXlpbmdPbmNlRXZlbnQsIHRoaXMuX29uTWVkaWFQbGF5aW5nT25jZSwgZmFsc2UpO1xuXHRcdHRoaXMucmVtb3ZlTGlzdGVuZXIodGhpcy52aWRlbywgdGhpcy51cGRhdGVQbGF5YmFja0V2ZW50cywgdGhpcy5fdXBkYXRlUGxheWJhY2tTdGF0ZSk7XG5cdFx0dGhpcy5yZW1vdmVMaXN0ZW5lcih0aGlzLnZpZGVvLCB0aGlzLnVwZGF0ZUJ1ZmZlcmVkRXZlbnRzLCB0aGlzLl91cGRhdGVCdWZmZXJlZFZhbHVlKTtcblx0XHR0aGlzLnJlbW92ZUxpc3RlbmVyKHRoaXMudmlkZW8sIHRoaXMudXBkYXRlUGxheWVkRXZlbnRzLCB0aGlzLl91cGRhdGVQbGF5ZWRWYWx1ZSk7XG5cdFx0dGhpcy52aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwiZW5kZWRcIiwgdGhpcy5fb25NZWRpYUVuZGVkLCBmYWxzZSk7XG5cdFx0dGhpcy52aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgdGhpcy5fb25NZWRpYUVycm9yLCB0cnVlKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogbWVkaWEgZXZlbnQgaGFuZGxlcnNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uTWVkaWFFcnJvcjogZnVuY3Rpb24oZXYpIHtcblx0XHR0aGlzLnJlbW92ZU1lZGlhTGlzdGVuZXJzKCk7XG5cdFx0dGhpcy5yZW1vdmVTZWxlY3Rpb25MaXN0ZW5lcnMoKTtcblxuXHRcdHRoaXMuX29uTWVkaWFFbmRlZChldik7XG5cdFx0dGhpcy5jb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJlbmRlZFwiKTtcblx0XHR0aGlzLmNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZShcIndhaXRpbmdcIik7XG5cdFx0dGhpcy5jb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJzdGFydGVkXCIpO1xuXHRcdHRoaXMuX3N0YXJ0ZWQgPSBmYWxzZTtcblxuXHRcdHRoaXMubWVkaWFTdGF0ZSA9IFwiZXJyb3JcIjtcblx0fSxcblxuXHRfb25NZWRpYVBsYXlpbmdPbmNlOiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMudmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLnBsYXlpbmdPbmNlRXZlbnQsIHRoaXMuX29uTWVkaWFQbGF5aW5nT25jZSwgZmFsc2UpO1xuXHRcdGlmICghdGhpcy5fc3RhcnRlZCkge1xuXHRcdFx0dGhpcy5fc3RhcnRlZCA9IHRydWU7XG5cdFx0XHR0aGlzLmNvbnRlbnQuY2xhc3NMaXN0LmFkZChcInN0YXJ0ZWRcIik7XG5cdFx0fVxuXHR9LFxuXG5cdF9vbk1lZGlhRW5kZWQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy5wbGF5YmFja1JlcXVlc3RlZCA9IGZhbHNlO1xuXHRcdGlmICh0aGlzLnZpZGVvLndlYmtpdERpc3BsYXlpbmdGdWxsc2NyZWVuKSB7XG5cdFx0XHR0aGlzLnZpZGVvLndlYmtpdEV4aXRGdWxsc2NyZWVuKCk7XG5cdFx0fVxuXHRcdGlmIChkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCA9PT0gdGhpcy52aWRlbykge1xuXHRcdFx0dGhpcy52aWRlby5leGl0RnVsbHNjcmVlbigpO1xuXHRcdH1cblx0fSxcblxuXHRfdXBkYXRlUGxheWJhY2tTdGF0ZTogZnVuY3Rpb24oZXYpIHtcblx0XHR2YXIgY2xhc3NMaXN0ID0gdGhpcy5jb250ZW50LmNsYXNzTGlzdDtcblx0XHRpZiAodGhpcy5wbGF5YmFja1JlcXVlc3RlZCkge1xuXHRcdFx0c3dpdGNoIChldi50eXBlKSB7XG5cdFx0XHRcdGNhc2UgXCJwYXVzZVwiOlxuXHRcdFx0XHRjYXNlIFwicGxheWluZ1wiOlxuXHRcdFx0XHRcdGNsYXNzTGlzdC5yZW1vdmUoXCJ3YWl0aW5nXCIpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwid2FpdGluZ1wiOlxuXHRcdFx0XHRcdGNsYXNzTGlzdC5hZGQoXCJ3YWl0aW5nXCIpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjbGFzc0xpc3QucmVtb3ZlKFwid2FpdGluZ1wiKTtcblx0XHR9XG5cdFx0Y2xhc3NMaXN0LnRvZ2dsZShcImVuZGVkXCIsIHRoaXMudmlkZW8uZW5kZWQpO1xuXG5cdFx0dGhpcy5fdXBkYXRlUGxheWVkVmFsdWUoZXYpO1xuXHR9LFxuXG5cdF91cGRhdGVQbGF5ZWRWYWx1ZTogZnVuY3Rpb24oZXYpIHtcblx0XHR0aGlzLl9jdXJyZW50VGltZVZhbHVlID0gdGhpcy52aWRlby5jdXJyZW50VGltZTtcblx0XHRpZiAodGhpcy5wcm9ncmVzc01ldGVyKSB7XG5cdFx0XHR0aGlzLnByb2dyZXNzTWV0ZXIudmFsdWVUbyh0aGlzLl9jdXJyZW50VGltZVZhbHVlLCAwLCBcImFtb3VudFwiKTtcblx0XHR9XG5cdH0sXG5cblx0X3VwZGF0ZUJ1ZmZlcmVkVmFsdWU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dmFyIGJSYW5nZXMgPSB0aGlzLnZpZGVvLmJ1ZmZlcmVkO1xuXHRcdGlmIChiUmFuZ2VzLmxlbmd0aCA+IDApIHtcblx0XHRcdHRoaXMuX2J1ZmZlcmVkVmFsdWUgPSBiUmFuZ2VzLmVuZChiUmFuZ2VzLmxlbmd0aCAtIDEpO1xuXHRcdFx0aWYgKHRoaXMucHJvZ3Jlc3NNZXRlciAmJiAoKHRoaXMudmlkZW8ucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfQ1VSUkVOVF9EQVRBKSAvKnx8ICh0aGlzLnZpZGVvLnJlYWR5U3RhdGUgPj0gSFRNTE1lZGlhRWxlbWVudC5IQVZFX0NVUlJFTlRfREFUQSAmJiB0aGlzLnZpZGVvLm5ldHdvcmtTdGF0ZSA9PSBIVE1MTWVkaWFFbGVtZW50Lk5FVFdPUktfTE9BRElORykqLyApKSB7XG5cdFx0XHRcdHRoaXMucHJvZ3Jlc3NNZXRlci52YWx1ZVRvKHRoaXMuX2J1ZmZlcmVkVmFsdWUsIDMwMCwgXCJhdmFpbGFibGVcIik7XG5cdFx0XHRcdC8vIHRoaXMucHJvZ3Jlc3NNZXRlci52YWx1ZVRvKHRoaXMuX2J1ZmZlcmVkVmFsdWUsIE1hdGgubWF4KDAsIDEwMDAgKiAodGhpcy5fYnVmZmVyZWRWYWx1ZSAtICh0aGlzLnByb2dyZXNzTWV0ZXIuZ2V0VmFsdWUoXCJhdmFpbGFibGVcIikgfCAwKSkpLCBcImF2YWlsYWJsZVwiKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIGZ1bGxzY3JlZW4gYXBpXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vbkZ1bGxzY3JlZW5Ub2dnbGU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0Ly8gTk9URTogSWdub3JlIGlmIE1vdXNlRXZlbnQuYnV0dG9uIGlzIDAgb3IgdW5kZWZpbmVkICgwOiBsZWZ0LWJ1dHRvbilcblx0XHRpZiAoIWV2LmRlZmF1bHRQcmV2ZW50ZWQgJiYgIWV2LmJ1dHRvbiAmJiB0aGlzLm1vZGVsLnNlbGVjdGVkKSB7XG5cdFx0XHQvLyBldi5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0aWYgKGRvY3VtZW50Lmhhc093blByb3BlcnR5KFwiZnVsbHNjcmVlbkVsZW1lbnRcIikgJiZcblx0XHRcdFx0XHRkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCAhPT0gdGhpcy52aWRlbykge1xuXHRcdFx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoZnVsbHNjcmVlbkNoYW5nZUV2ZW50LCB0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UsIGZhbHNlKTtcblx0XHRcdFx0XHR0aGlzLnZpZGVvLnJlcXVlc3RGdWxsc2NyZWVuKCk7XG5cdFx0XHRcdH0gZWxzZVxuXHRcdFx0XHRpZiAodGhpcy52aWRlby53ZWJraXRTdXBwb3J0c0Z1bGxzY3JlZW4gJiYgIXRoaXMudmlkZW8ud2Via2l0RGlzcGxheWluZ0Z1bGxzY3JlZW4pIHtcblx0XHRcdFx0XHR0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRiZWdpbmZ1bGxzY3JlZW5cIiwgdGhpcy5fb25GdWxsc2NyZWVuQ2hhbmdlLCBmYWxzZSk7XG5cdFx0XHRcdFx0dGhpcy52aWRlby53ZWJraXRFbnRlckZ1bGxTY3JlZW4oKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRcdHRoaXMudmlkZW8uY29udHJvbHMgPSBmYWxzZTtcblx0XHRcdFx0Y29uc29sZS5lcnJvcihlcnIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRfb25GdWxsc2NyZWVuQ2hhbmdlOiBmdW5jdGlvbihldikge1xuXHRcdHN3aXRjaCAoZXYudHlwZSkge1xuXHRcdFx0Y2FzZSBmdWxsc2NyZWVuQ2hhbmdlRXZlbnQ6XG5cdFx0XHRcdC8vIHZhciBpc093bkZ1bGxzY3JlZW4gPSBNb2Rlcm5penIucHJlZml4ZWQoXCJmdWxsc2NyZWVuRWxlbWVudFwiLCBkb2N1bWVudCkgPT09IHRoaXMudmlkZW87XG5cdFx0XHRcdHZhciBpc093bkZ1bGxzY3JlZW4gPSBkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCA9PT0gdGhpcy52aWRlbztcblx0XHRcdFx0dGhpcy52aWRlby5jb250cm9scyA9IGlzT3duRnVsbHNjcmVlbjtcblx0XHRcdFx0aWYgKCFpc093bkZ1bGxzY3JlZW4pIHtcblx0XHRcdFx0XHRkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKGZ1bGxzY3JlZW5DaGFuZ2VFdmVudCwgdGhpcy5fb25GdWxsc2NyZWVuQ2hhbmdlLCBmYWxzZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwid2Via2l0YmVnaW5mdWxsc2NyZWVuXCI6XG5cdFx0XHRcdHRoaXMudmlkZW8uY29udHJvbHMgPSB0cnVlO1xuXHRcdFx0XHR0aGlzLnZpZGVvLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRiZWdpbmZ1bGxzY3JlZW5cIiwgdGhpcy5fb25GdWxsc2NyZWVuQ2hhbmdlLCBmYWxzZSk7XG5cdFx0XHRcdHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcIndlYmtpdGVuZGZ1bGxzY3JlZW5cIiwgdGhpcy5fb25GdWxsc2NyZWVuQ2hhbmdlLCBmYWxzZSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcIndlYmtpdGVuZGZ1bGxzY3JlZW5cIjpcblx0XHRcdFx0dGhpcy52aWRlby5jb250cm9scyA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLnZpZGVvLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRlbmRmdWxsc2NyZWVuXCIsIHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSwgZmFsc2UpO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIGV2ZW50IGhlbHBlcnNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0YWRkTGlzdGVuZXI6IGZ1bmN0aW9uKHRhcmdldCwgZXZlbnRzLCBoYW5kbGVyLCB1c2VDYXB0dXJlKSB7XG5cdFx0KHR5cGVvZiBldmVudHMgPT09IFwic3RyaW5nXCIpICYmIChldmVudHMgPSBldmVudHMuc3BsaXQoXCIgXCIpKTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoZXZlbnRzW2ldLCBoYW5kbGVyLCAhIXVzZUNhcHR1cmUpO1xuXHRcdH1cblx0fSxcblxuXHRyZW1vdmVMaXN0ZW5lcjogZnVuY3Rpb24odGFyZ2V0LCBldmVudHMsIGhhbmRsZXIsIHVzZUNhcHR1cmUpIHtcblx0XHQodHlwZW9mIGV2ZW50cyA9PT0gXCJzdHJpbmdcIikgJiYgKGV2ZW50cyA9IGV2ZW50cy5zcGxpdChcIiBcIikpO1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZXZlbnRzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudHNbaV0sIGhhbmRsZXIsICEhdXNlQ2FwdHVyZSk7XG5cdFx0fVxuXHR9LFxufSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogbG9nIHRvIHNjcmVlblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5pZiAoREVCVUcpIHtcblxuXHRWaWRlb1JlbmRlcmVyID0gKGZ1bmN0aW9uKFZpZGVvUmVuZGVyZXIpIHtcblx0XHRpZiAoIVZpZGVvUmVuZGVyZXIuTE9HX1RPX1NDUkVFTikgcmV0dXJuIFZpZGVvUmVuZGVyZXI7XG5cblx0XHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHRcdHZhciBDb2xvciA9IHJlcXVpcmUoXCJjb2xvclwiKTtcblx0XHQvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZ3MvbHBhZH0gKi9cblx0XHR2YXIgbHBhZCA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlLnN0cmluZy9scGFkXCIpO1xuXHRcdC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmUuc3RyaW5ncy9ycGFkfSAqL1xuXHRcdHZhciBycGFkID0gcmVxdWlyZShcInVuZGVyc2NvcmUuc3RyaW5nL3JwYWRcIik7XG5cblx0XHQvLyB2YXIgZnVsbHNjcmVlbkV2ZW50cyA9IFtcblx0XHQvLyBcdGZ1bGxzY3JlZW5DaGFuZ2VFdmVudCwgZnVsbHNjcmVlbkVycm9yRXZlbnQsXG5cdFx0Ly8gXHRcIndlYmtpdGJlZ2luZnVsbHNjcmVlblwiLCBcIndlYmtpdGVuZGZ1bGxzY3JlZW5cIixcblx0XHQvLyBdO1xuXG5cdFx0dmFyIG1lZGlhRXZlbnRzID0gcmVxdWlyZShcInV0aWxzL2V2ZW50L21lZGlhRXZlbnRzRW51bVwiKTtcblx0XHR2YXIgdXBkYXRlUGxheWJhY2tTdGF0ZUV2ZW50cywgdXBkYXRlQnVmZmVyZWRFdmVudHMsIHVwZGF0ZVBsYXllZEV2ZW50cztcblxuXHRcdC8vIHVwZGF0ZVBsYXliYWNrU3RhdGVFdmVudHMgPSBbXCJwbGF5aW5nXCIsIFwid2FpdGluZ1wiLCBcImVuZGVkXCIsIFwicGF1c2VcIiwgXCJzZWVraW5nXCIsIFwic2Vla2VkXCJdO1xuXHRcdC8vIHVwZGF0ZUJ1ZmZlcmVkRXZlbnRzID0gW1wicHJvZ3Jlc3NcIiwgXCJkdXJhdGlvbmNoYW5nZVwiLCBcImNhbnBsYXlcIiwgXCJwbGF5XCJdO1xuXHRcdC8vIHVwZGF0ZVBsYXllZEV2ZW50cyA9IFtcInBsYXlpbmdcIiwgXCJ0aW1ldXBkYXRlXCJdO1xuXG5cdFx0dXBkYXRlUGxheWJhY2tTdGF0ZUV2ZW50cyA9IFtcblx0XHRcdFwibG9hZHN0YXJ0XCIsXG5cdFx0XHRcInByb2dyZXNzXCIsXG5cdFx0XHRcInN1c3BlbmRcIixcblx0XHRcdFwiYWJvcnRcIixcblx0XHRcdFwiZXJyb3JcIixcblx0XHRcdFwiZW1wdGllZFwiLFxuXHRcdFx0XCJzdGFsbGVkXCIsXG5cdFx0XTtcblx0XHR1cGRhdGVCdWZmZXJlZEV2ZW50cyA9IFtcblx0XHRcdFwibG9hZGVkbWV0YWRhdGFcIixcblx0XHRcdFwibG9hZGVkZGF0YVwiLFxuXHRcdFx0XCJjYW5wbGF5XCIsXG5cdFx0XHRcImNhbnBsYXl0aHJvdWdoXCIsXG5cdFx0XHRcInBsYXlpbmdcIixcblx0XHRcdFwid2FpdGluZ1wiLFxuXHRcdFx0XCJzZWVraW5nXCIsIC8vIHNlZWtpbmcgY2hhbmdlZCB0byB0cnVlXG5cdFx0XHRcInNlZWtlZFwiLCAvLyBzZWVraW5nIGNoYW5nZWQgdG8gZmFsc2Vcblx0XHRcdFwiZW5kZWRcIiwgLy8gZW5kZWQgaXMgdHJ1ZVxuXHRcdF07XG5cdFx0dXBkYXRlUGxheWVkRXZlbnRzID0gW1wicGxheVwiLCBcInBhdXNlXCJdO1xuXG5cdFx0Ly8gRXhjbHVkZSBzb21lIGV2ZW50cyBmcm9tIGxvZ1xuXHRcdG1lZGlhRXZlbnRzID0gXy53aXRob3V0KG1lZGlhRXZlbnRzLCBcInJlc2l6ZVwiLCBcImVycm9yXCIpO1xuXHRcdC8vIE1ha2Ugc3VyZSBldmVudCBzdWJzZXRzIGV4aXN0IGluIHRoZSBtYWluIHNldFxuXHRcdHVwZGF0ZVBsYXliYWNrU3RhdGVFdmVudHMgPSBfLmludGVyc2VjdGlvbihtZWRpYUV2ZW50cywgdXBkYXRlUGxheWJhY2tTdGF0ZUV2ZW50cyk7XG5cdFx0dXBkYXRlQnVmZmVyZWRFdmVudHMgPSBfLmludGVyc2VjdGlvbihtZWRpYUV2ZW50cywgdXBkYXRlQnVmZmVyZWRFdmVudHMpO1xuXHRcdHVwZGF0ZVBsYXllZEV2ZW50cyA9IF8uaW50ZXJzZWN0aW9uKG1lZGlhRXZlbnRzLCB1cGRhdGVQbGF5ZWRFdmVudHMpO1xuXG5cdFx0dmFyIHJlYWR5U3RhdGVTeW1ib2xzID0gXy5pbnZlcnQoXy5waWNrKEhUTUxNZWRpYUVsZW1lbnQsXG5cdFx0XHRmdW5jdGlvbih2YWwsIGtleSwgb2JqKSB7XG5cdFx0XHRcdHJldHVybiAvXkhBVkVfLy50ZXN0KGtleSk7XG5cdFx0XHR9KSk7XG5cdFx0dmFyIHJlYWR5U3RhdGVUb1N0cmluZyA9IGZ1bmN0aW9uKGVsKSB7XG5cdFx0XHRyZXR1cm4gcmVhZHlTdGF0ZVN5bWJvbHNbZWwucmVhZHlTdGF0ZV0gKyBcIihcIiArIGVsLnJlYWR5U3RhdGUgKyBcIilcIjtcblx0XHR9O1xuXG5cdFx0dmFyIG5ldHdvcmtTdGF0ZVN5bWJvbHMgPSBfLmludmVydChfLnBpY2soSFRNTE1lZGlhRWxlbWVudCxcblx0XHRcdGZ1bmN0aW9uKHZhbCwga2V5LCBvYmopIHtcblx0XHRcdFx0cmV0dXJuIC9eTkVUV09SS18vLnRlc3Qoa2V5KTtcblx0XHRcdH0pKTtcblx0XHR2YXIgbmV0d29ya1N0YXRlVG9TdHJpbmcgPSBmdW5jdGlvbihlbCkge1xuXHRcdFx0cmV0dXJuIG5ldHdvcmtTdGF0ZVN5bWJvbHNbZWwubmV0d29ya1N0YXRlXSArIFwiKFwiICsgZWwubmV0d29ya1N0YXRlICsgXCIpXCI7XG5cdFx0fTtcblxuXHRcdHZhciBtZWRpYUVycm9yU3ltYm9scyA9IF8uaW52ZXJ0KE1lZGlhRXJyb3IpO1xuXHRcdHZhciBtZWRpYUVycm9yVG9TdHJpbmcgPSBmdW5jdGlvbihlbCkge1xuXHRcdFx0cmV0dXJuIGVsLmVycm9yID8gbWVkaWFFcnJvclN5bWJvbHNbZWwuZXJyb3IuY29kZV0gKyBcIihcIiArIGVsLmVycm9yLmNvZGUgKyBcIilcIiA6IFwiW01lZGlhRXJyb3IgbnVsbF1cIjtcblx0XHR9O1xuXG5cdFx0dmFyIGZpbmRSYW5nZUluZGV4ID0gZnVuY3Rpb24ocmFuZ2UsIGN1cnJUaW1lKSB7XG5cdFx0XHRmb3IgKHZhciBpID0gMCwgaWkgPSByYW5nZS5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHRcdGlmIChyYW5nZS5zdGFydChpKSA8PSBjdXJyVGltZSAmJiBjdXJyVGltZSA8PSByYW5nZS5lbmQoaSkpIHtcblx0XHRcdFx0XHRyZXR1cm4gaTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIC0xO1xuXHRcdH07XG5cblx0XHR2YXIgZm9ybWF0VmlkZW9FcnJvciA9IGZ1bmN0aW9uKHZpZGVvKSB7XG5cdFx0XHRyZXR1cm4gW1xuXHRcdFx0XHRtZWRpYUVycm9yVG9TdHJpbmcodmlkZW8pLFxuXHRcdFx0XHRuZXR3b3JrU3RhdGVUb1N0cmluZyh2aWRlbyksXG5cdFx0XHRcdHJlYWR5U3RhdGVUb1N0cmluZyh2aWRlbyksXG5cdFx0XHRdLmpvaW4oXCIgXCIpO1xuXHRcdH07XG5cblx0XHR2YXIgZ2V0VmlkZW9TdGF0c0NvbHMgPSBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBcIjAwMDAuMDAwIFtDdXJyZW50L1RvdGFsXSBbU2Vla2FibGUgICBdIFtCdWZmZXJlZCAgIF0gbmV0d29ya1N0YXRlIHJlYWR5U3RhdGUgICAgICBQbGF5aW5nXCI7XG5cdFx0XHQvLyByZXR1cm4gXCIwMDAwLjYyMCBbdDogIDAuMCAgMjcuNF0gW3M6IDI3LjQgMC8xXSBbYjogIDAuNSAwLzFdIExPQURJTkcoMikgICBGVVRVUkVfREFUQSgzKSAgOjogKDo6KVwiO1xuXHRcdH1cblxuXHRcdHZhciBmb3JtYXRWaWRlb1N0YXRzID0gZnVuY3Rpb24odmlkZW8pIHtcblx0XHRcdHZhciBjdXJyVGltZSA9IHZpZGVvLmN1cnJlbnRUaW1lLFxuXHRcdFx0XHRkdXJUaW1lID0gdmlkZW8uZHVyYXRpb24sXG5cdFx0XHRcdGJSYW5nZXMgPSB2aWRlby5idWZmZXJlZCxcblx0XHRcdFx0YlJhbmdlSWR4LFxuXHRcdFx0XHRzUmFuZ2VzID0gdmlkZW8uc2Vla2FibGUsXG5cdFx0XHRcdHNSYW5nZUlkeDtcblxuXHRcdFx0YlJhbmdlSWR4ID0gZmluZFJhbmdlSW5kZXgoYlJhbmdlcywgY3VyclRpbWUpO1xuXHRcdFx0c1JhbmdlSWR4ID0gZmluZFJhbmdlSW5kZXgoc1JhbmdlcywgY3VyclRpbWUpO1xuXHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0XCJbdDpcIiArIGxwYWQoY3VyclRpbWUudG9GaXhlZCgxKSwgNSkgK1xuXHRcdFx0XHRcdFwiIFwiICsgbHBhZCgoIWlzTmFOKGR1clRpbWUpID8gZHVyVGltZS50b0ZpeGVkKDEpIDogXCItXCIpLCA1KSArIFwiXVwiLFxuXHRcdFx0XHRcIltzOlwiICsgbHBhZCgoc1JhbmdlSWR4ID49IDAgPyBzUmFuZ2VzLmVuZChzUmFuZ2VJZHgpLnRvRml4ZWQoMSkgOiBcIi1cIiksIDUpICtcblx0XHRcdFx0XHRcIiBcIiArIChzUmFuZ2VJZHggPj0gMCA/IHNSYW5nZUlkeCA6IFwiLVwiKSArIFwiL1wiICsgc1Jhbmdlcy5sZW5ndGggKyBcIl1cIixcblx0XHRcdFx0XCJbYjpcIiArIGxwYWQoKGJSYW5nZUlkeCA+PSAwID8gYlJhbmdlcy5lbmQoYlJhbmdlSWR4KS50b0ZpeGVkKDEpIDogXCItXCIpLCA1KSArXG5cdFx0XHRcdFx0XCIgXCIgKyAoYlJhbmdlSWR4ID49IDAgPyBiUmFuZ2VJZHggOiBcIi1cIikgKyBcIi9cIiArIGJSYW5nZXMubGVuZ3RoICsgXCJdXCIsXG5cdFx0XHRcdHJwYWQobmV0d29ya1N0YXRlVG9TdHJpbmcodmlkZW8pLnN1YnN0cig4KSwgMTIpLFxuXHRcdFx0XHRycGFkKHJlYWR5U3RhdGVUb1N0cmluZyh2aWRlbykuc3Vic3RyKDUpLCAxNSksXG5cdFx0XHRcdCh2aWRlby5lbmRlZCA/IFwiPjpcIiA6ICh2aWRlby5wYXVzZWQgPyBcIjo6XCIgOiBcIj4+XCIpKSxcblx0XHRcdF0uam9pbihcIiBcIik7XG5cdFx0fTtcblxuXHRcdHJldHVybiBWaWRlb1JlbmRlcmVyLmV4dGVuZCh7XG5cblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRWaWRlb1JlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHRcdFx0Xy5iaW5kQWxsKHRoaXMsIFwiX19oYW5kbGVNZWRpYUV2ZW50XCIpO1xuXG5cdFx0XHRcdHZhciBmZ0NvbG9yID0gdGhpcy5tb2RlbC5hdHRyKFwiY29sb3JcIiksXG5cdFx0XHRcdFx0cmVkID0gbmV3IENvbG9yKFwicmVkXCIpLFxuXHRcdFx0XHRcdGJsdWUgPSBuZXcgQ29sb3IoXCJibHVlXCIpLFxuXHRcdFx0XHRcdGdyZWVuID0gbmV3IENvbG9yKFwiZ3JlZW5cIik7XG5cblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBtZWRpYUV2ZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdHZhciBldiA9IG1lZGlhRXZlbnRzW2ldO1xuXHRcdFx0XHRcdHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihldiwgdGhpcy5fX2hhbmRsZU1lZGlhRXZlbnQsIGZhbHNlKTtcblxuXHRcdFx0XHRcdHZhciBjID0gbmV3IENvbG9yKGZnQ29sb3IpLFxuXHRcdFx0XHRcdFx0Y2MgPSAxO1xuXHRcdFx0XHRcdGlmICh1cGRhdGVCdWZmZXJlZEV2ZW50cy5pbmRleE9mKGV2KSAhPSAtMSkgYy5taXgoZ3JlZW4sIChjYyAvPSAyKSk7XG5cdFx0XHRcdFx0aWYgKHVwZGF0ZVBsYXllZEV2ZW50cy5pbmRleE9mKGV2KSAhPSAtMSkgYy5taXgocmVkLCAoY2MgLz0gMikpO1xuXHRcdFx0XHRcdGlmICh1cGRhdGVQbGF5YmFja1N0YXRlRXZlbnRzLmluZGV4T2YoZXYpICE9IC0xKSBjLm1peChibHVlLCAoY2MgLz0gMikpO1xuXHRcdFx0XHRcdHRoaXMuX19sb2dDb2xvcnNbZXZdID0gYy5yZ2JTdHJpbmcoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCB0aGlzLl9faGFuZGxlTWVkaWFFdmVudCwgdHJ1ZSk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRWaWRlb1JlbmRlcmVyLnByb3RvdHlwZS5yZW1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBtZWRpYUV2ZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRcdGlmIChtZWRpYUV2ZW50c1tpXSA9PSBcImVycm9yXCIpIGNvbnRpbnVlO1xuXHRcdFx0XHRcdHRoaXMudmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihtZWRpYUV2ZW50c1tpXSwgdGhpcy5fX2hhbmRsZU1lZGlhRXZlbnQsIGZhbHNlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLnZpZGVvLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCB0aGlzLl9faGFuZGxlTWVkaWFFdmVudCwgdHJ1ZSk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRfb25WaXNpYmlsaXR5Q2hhbmdlOiBmdW5jdGlvbihldikge1xuXHRcdFx0XHRWaWRlb1JlbmRlcmVyLnByb3RvdHlwZS5fb25WaXNpYmlsaXR5Q2hhbmdlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdHZhciBzdGF0ZVZhbCA9IE1vZGVybml6ci5wcmVmaXhlZChcInZpc2liaWxpdHlTdGF0ZVwiLCBkb2N1bWVudCk7XG5cdFx0XHRcdHRoaXMuX19sb2dFdmVudChcInZpc2liaWxpdHlTdGF0ZTpcIiArIHN0YXRlVmFsLCBldi50eXBlICsgXCI6XCIgKyBzdGF0ZVZhbCk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRfb25GdWxsc2NyZWVuQ2hhbmdlOiBmdW5jdGlvbihldikge1xuXHRcdFx0XHRWaWRlb1JlbmRlcmVyLnByb3RvdHlwZS5fb25GdWxsc2NyZWVuQ2hhbmdlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdHZhciBsb2d0eXBlID0gKGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50ID09PSB0aGlzLnZpZGVvID8gXCJlbnRlcjpcIiA6IFwiZXhpdDpcIikgKyBldi50eXBlO1xuXHRcdFx0XHR0aGlzLl9fbG9nRXZlbnQoXCJkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudDogXCIgKyB0aGlzLmNpZCwgbG9ndHlwZSk7XG5cdFx0XHR9LFxuXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRfb25GdWxsc2NyZWVuVG9nZ2xlOiBmdW5jdGlvbihldikge1xuXHRcdFx0XHRWaWRlb1JlbmRlcmVyLnByb3RvdHlwZS5fb25GdWxsc2NyZWVuVG9nZ2xlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdGlmICghZXYuZGVmYXVsdFByZXZlbnRlZCAmJiB0aGlzLm1vZGVsLnNlbGVjdGVkKSB7XG5cdFx0XHRcdFx0dGhpcy5fX2xvZ0V2ZW50KFwiZnVsbHNjcmVlbi10b2dnbGVcIiwgZXYudHlwZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdF9faGFuZGxlTWVkaWFFdmVudDogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0dmFyIGV2bXNnOyAvLywgZXJybXNnO1xuXHRcdFx0XHQvLyBldm1zZyA9IGZvcm1hdFZpZGVvU3RhdHModGhpcy52aWRlbykgKyBcIiBcIiArIHJwYWQodGhpcy5fbGFzdFBsYXliYWNrU3RhdGVzIHx8IFwiLVwiLCA5KTtcblx0XHRcdFx0ZXZtc2cgPSBmb3JtYXRWaWRlb1N0YXRzKHRoaXMudmlkZW8pO1xuXHRcdFx0XHRpZiAodGhpcy5wbGF5YmFja1JlcXVlc3RlZCA9PT0gdHJ1ZSkge1xuXHRcdFx0XHRcdGV2bXNnICs9IFwiICg+PilcIjtcblx0XHRcdFx0fSBlbHNlIGlmICh0aGlzLnBsYXliYWNrUmVxdWVzdGVkID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdGV2bXNnICs9IFwiICg6OilcIjtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRldm1zZyArPSBcIiAoLS0pXCI7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy5fX2xvZ0V2ZW50KGV2bXNnLCBldi50eXBlKTtcblx0XHRcdFx0aWYgKGV2LnR5cGUgPT09IFwiZXJyb3JcIiB8fCBldi50eXBlID09PSBcImFib3J0XCIpIHtcblx0XHRcdFx0XHR0aGlzLl9fbG9nTWVzc2FnZShmb3JtYXRWaWRlb0Vycm9yKHRoaXMudmlkZW8pLCBldi50eXBlKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0X19sb2dFdmVudDogZnVuY3Rpb24obXNnLCBsb2d0eXBlLCBjb2xvcikge1xuXHRcdFx0XHR2YXIgbG9nRW50cnlFbCA9IHRoaXMuX19sb2dFbGVtZW50Lmxhc3RFbGVtZW50Q2hpbGQ7XG5cdFx0XHRcdGlmICgobG9nRW50cnlFbCAmJiBsb2dFbnRyeUVsLmdldEF0dHJpYnV0ZShcImRhdGEtbG9ndHlwZVwiKSA9PSBsb2d0eXBlKSAmJlxuXHRcdFx0XHRcdCgobG9ndHlwZSA9PT0gXCJ0aW1ldXBkYXRlXCIpIHx8IChsb2d0eXBlID09PSBcInByb2dyZXNzXCIpKSkge1xuXHRcdFx0XHRcdHZhciBsb2dSZXBlYXRWYWwgPSBwYXJzZUludChsb2dFbnRyeUVsLmdldEF0dHJpYnV0ZShcImRhdGEtbG9ncmVwZWF0XCIpKTtcblx0XHRcdFx0XHRsb2dFbnRyeUVsLnRleHRDb250ZW50ID0gdGhpcy5fX2dldFRTdGFtcCgpICsgXCIgXCIgKyBtc2c7XG5cdFx0XHRcdFx0bG9nRW50cnlFbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWxvZ3JlcGVhdFwiLCBpc05hTihsb2dSZXBlYXRWYWwpID8gMiA6ICsrbG9nUmVwZWF0VmFsKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLl9fbG9nTWVzc2FnZShtc2csIGxvZ3R5cGUsIGNvbG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0fSxcblxuXHRcdFx0X19nZXRIZWFkZXJUZXh0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIGdldFZpZGVvU3RhdHNDb2xzKCk7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHR9KShWaWRlb1JlbmRlcmVyKTtcblxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFZpZGVvUmVuZGVyZXI7IiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcImNvbXBpbGVyXCI6WzcsXCI+PSA0LjAuMFwiXSxcIm1haW5cIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBzdGFjazEsIGhlbHBlciwgYWxpYXMxPWRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge30sIGFsaWFzMj1oZWxwZXJzLmhlbHBlck1pc3NpbmcsIGFsaWFzMz1cImZ1bmN0aW9uXCI7XG5cbiAgcmV0dXJuIFwiPGRpdiBpZD1cXFwiZGVzY19iXCJcbiAgICArIGNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuaWQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmlkIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJpZFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiIGNsYXNzPVxcXCJjb250ZW50IHNpemluZyBtZG93blxcXCI+XCJcbiAgICArICgoc3RhY2sxID0gKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5kZXNjIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5kZXNjIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJkZXNjXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpICE9IG51bGwgPyBzdGFjazEgOiBcIlwiKVxuICAgICsgXCI8L2Rpdj5cXG5cIjtcbn0sXCJ1c2VEYXRhXCI6dHJ1ZX0pO1xuIiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcImNvbXBpbGVyXCI6WzcsXCI+PSA0LjAuMFwiXSxcIm1haW5cIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBzdGFjazEsIGhlbHBlciwgYWxpYXMxPWRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge30sIGFsaWFzMj1oZWxwZXJzLmhlbHBlck1pc3NpbmcsIGFsaWFzMz1cImZ1bmN0aW9uXCI7XG5cbiAgcmV0dXJuIFwiPGRpdiBpZD1cXFwiZGVzY19tXCJcbiAgICArIGNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuaWQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmlkIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJpZFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiIGNsYXNzPVxcXCJjb250ZW50IHNpemluZ1xcXCI+PHA+XCJcbiAgICArICgoc3RhY2sxID0gKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5uYW1lIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5uYW1lIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJuYW1lXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpICE9IG51bGwgPyBzdGFjazEgOiBcIlwiKVxuICAgICsgXCI8L3A+XCJcbiAgICArICgoc3RhY2sxID0gKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5zdWIgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLnN1YiA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwic3ViXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpICE9IG51bGwgPyBzdGFjazEgOiBcIlwiKVxuICAgICsgXCI8L2Rpdj5cXG5cIjtcbn0sXCJ1c2VEYXRhXCI6dHJ1ZX0pO1xuIiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcIjFcIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBoZWxwZXI7XG5cbiAgcmV0dXJuIFwiXHRcdDxwPjxjb2RlPlwiXG4gICAgKyBjb250YWluZXIuZXNjYXBlRXhwcmVzc2lvbigoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLmluZm9TcmMgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmluZm9TcmMgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogaGVscGVycy5oZWxwZXJNaXNzaW5nKSwodHlwZW9mIGhlbHBlciA9PT0gXCJmdW5jdGlvblwiID8gaGVscGVyLmNhbGwoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSx7XCJuYW1lXCI6XCJpbmZvU3JjXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIjwvY29kZT48L3A+XFxuXCI7XG59LFwiY29tcGlsZXJcIjpbNyxcIj49IDQuMC4wXCJdLFwibWFpblwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIHN0YWNrMSwgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWhlbHBlcnMuaGVscGVyTWlzc2luZywgYWxpYXMzPVwiZnVuY3Rpb25cIiwgYWxpYXM0PWNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uO1xuXG4gIHJldHVybiBcIjxkaXYgY2xhc3M9XFxcImVycm9yLW1lc3NhZ2UgY29sb3ItZmdcXFwiPlxcblx0PHA+PHN0cm9uZz5cIlxuICAgICsgYWxpYXM0KCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMubmFtZSB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAubmFtZSA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwibmFtZVwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCI8L3N0cm9uZz4gPGNvZGU+XCJcbiAgICArIGFsaWFzNCgoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLm1lc3NhZ2UgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLm1lc3NhZ2UgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcIm1lc3NhZ2VcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiPC9jb2RlPjwvcD5cXG5cIlxuICAgICsgKChzdGFjazEgPSBoZWxwZXJzW1wiaWZcIl0uY2FsbChhbGlhczEsKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmluZm9TcmMgOiBkZXB0aDApLHtcIm5hbWVcIjpcImlmXCIsXCJoYXNoXCI6e30sXCJmblwiOmNvbnRhaW5lci5wcm9ncmFtKDEsIGRhdGEsIDApLFwiaW52ZXJzZVwiOmNvbnRhaW5lci5ub29wLFwiZGF0YVwiOmRhdGF9KSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIjwvZGl2PlwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvLyB2YXIgSGFuZGxlYmFycyA9IHJlcXVpcmUoXCJoYW5kbGViYXJzXCIpW1wiZGVmYXVsdFwiXTtcbnZhciBIYW5kbGViYXJzID0gcmVxdWlyZShcImhic2Z5L3J1bnRpbWVcIik7XG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG5cbi8vIChmdW5jdGlvbigpIHtcbnZhciBoZWxwZXJzID0ge1xuXHQvKlxuXHQvKiBBcml0aG1ldGljIGhlbHBlcnNcblx0LyovXG5cdGFkZDogZnVuY3Rpb24odmFsdWUsIGFkZGl0aW9uKSB7XG5cdFx0cmV0dXJuIHZhbHVlICsgYWRkaXRpb247XG5cdH0sXG5cdHN1YnRyYWN0OiBmdW5jdGlvbih2YWx1ZSwgc3Vic3RyYWN0aW9uKSB7XG5cdFx0cmV0dXJuIHZhbHVlIC0gc3Vic3RyYWN0aW9uO1xuXHR9LFxuXHRkaXZpZGU6IGZ1bmN0aW9uKHZhbHVlLCBkaXZpc29yKSB7XG5cdFx0cmV0dXJuIHZhbHVlIC8gZGl2aXNvcjtcblx0fSxcblx0bXVsdGlwbHk6IGZ1bmN0aW9uKHZhbHVlLCBtdWx0aXBsaWVyKSB7XG5cdFx0cmV0dXJuIHZhbHVlICogbXVsdGlwbGllcjtcblx0fSxcblx0Zmxvb3I6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0cmV0dXJuIE1hdGguZmxvb3IodmFsdWUpO1xuXHR9LFxuXHRjZWlsOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdHJldHVybiBNYXRoLmNlaWwodmFsdWUpO1xuXHR9LFxuXHRyb3VuZDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRyZXR1cm4gTWF0aC5yb3VuZCh2YWx1ZSk7XG5cdH0sXG5cdGdsb2JhbDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRyZXR1cm4gR2xvYmFsc1t2YWx1ZV07XG5cdH0sXG5cblx0Lypcblx0LyogRmxvdyBjb250cm9sIGhlbHBlcnNcblx0LyovXG5cdGlzOiBmdW5jdGlvbihhLCBiLCBvcHRzKSB7XG5cdFx0cmV0dXJuIChhID09PSBiKSA/IG9wdHMuZm4odGhpcykgOiBvcHRzLmludmVyc2UodGhpcyk7XG5cdH0sXG5cdGlzbm90OiBmdW5jdGlvbihhLCBiLCBvcHRzKSB7XG5cdFx0cmV0dXJuIChhICE9PSBiKSA/IG9wdHMuZm4odGhpcykgOiBvcHRzLmludmVyc2UodGhpcyk7XG5cdH0sXG5cdGlzYW55OiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdHZhciBpID0gMCxcblx0XHRcdGlpID0gYXJndW1lbnRzLmxlbmd0aCAtIDIsXG5cdFx0XHRvcHRzID0gYXJndW1lbnRzW2lpICsgMV07XG5cdFx0ZG9cblx0XHRcdGlmICh2YWx1ZSA9PT0gYXJndW1lbnRzWysraV0pIHtcblx0XHRcdFx0cmV0dXJuIG9wdHMuZm4odGhpcyk7XG5cdFx0XHR9XG5cdFx0d2hpbGUgKGkgPCBpaSk7XG5cdFx0cmV0dXJuIG9wdHMuaW52ZXJzZSh0aGlzKTtcblx0fSxcblx0Y29udGFpbnM6IGZ1bmN0aW9uKGEsIGIsIG9wdHMpIHtcblx0XHRyZXR1cm4gKGEuaW5kZXhPZihiKSAhPT0gLTEpID8gb3B0cy5mbih0aGlzKSA6IG9wdHMuaW52ZXJzZSh0aGlzKTtcblx0fSxcblx0aWdub3JlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gXCJcIjtcblx0fSxcblxuXHQvKlxuXHQvKiBDb2xvciBoZWxwZXJzXG5cdC8qL1xuXHRtaXg6IGZ1bmN0aW9uKGNvbG9yYSwgY29sb3JiLCBhbW91bnQpIHtcblx0XHRyZXR1cm4gbmV3IENvbG9yKGNvbG9yYSkubWl4KG5ldyBDb2xvcihjb2xvcmIpLCBhbW91bnQpLnJnYlN0cmluZygpO1xuXHR9LFxuXHRsaWdodGVuOiBmdW5jdGlvbihjb2xvciwgYW1vdW50KSB7XG5cdFx0cmV0dXJuIG5ldyBDb2xvcihjb2xvcikubGlnaHRlbihhbW91bnQpLnJnYlN0cmluZygpO1xuXHR9LFxuXHRkYXJrZW46IGZ1bmN0aW9uKGNvbG9yLCBhbW91bnQpIHtcblx0XHRyZXR1cm4gbmV3IENvbG9yKGNvbG9yKS5kYXJrZW4oYW1vdW50KS5yZ2JTdHJpbmcoKTtcblx0fSxcblx0Ly8gY29sb3JGb3JtYXQ6IGZ1bmN0aW9uKGNvbG9yLCBmbXQpIHtcblx0Ly8gXHRzd2l0Y2ggKGZtdCkge1xuXHQvLyBcdFx0Y2FzZSBcInJnYlwiOlxuXHQvLyBcdFx0XHRyZXR1cm4gbmV3IENvbG9yKGNvbG9yKS5yZ2JTdHJpbmcoKTtcblx0Ly8gXHRcdGNhc2UgXCJoc2xcIjpcblx0Ly8gXHRcdFx0cmV0dXJuIG5ldyBDb2xvcihjb2xvcikuaHNsU3RyaW5nKCk7XG5cdC8vIFx0XHRjYXNlIFwiaGV4XCI6IGRlZmF1bHQ6XG5cdC8vIFx0XHRcdHJldHVybiBuZXcgQ29sb3IoY29sb3IpLmhleFN0cmluZygpO1xuXHQvLyBcdH1cblx0Ly8gfSxcbn07XG5mb3IgKHZhciBoZWxwZXIgaW4gaGVscGVycykge1xuXHRpZiAoaGVscGVycy5oYXNPd25Qcm9wZXJ0eShoZWxwZXIpKSB7XG5cdFx0SGFuZGxlYmFycy5yZWdpc3RlckhlbHBlcihoZWxwZXIsIGhlbHBlcnNbaGVscGVyXSk7XG5cdH1cbn1cbi8vIH0pKCk7XG5cbi8vIG1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFycztcbiIsIi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG52YXIgRXZlbnRzID0gcmVxdWlyZShcImJhY2tib25lXCIpLkV2ZW50cztcblxuXG4vLyB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7XG4vLyBcdHRpY2s6IDEsXG4vLyBcdG9uc3RhcnQ6IG51bGwsXG4vLyBcdG9udGljazogbnVsbCxcbi8vIFx0b25wYXVzZTogbnVsbCxcbi8vIFx0b25zdG9wOiBudWxsLFxuLy8gXHRvbmVuZDogbnVsbFxuLy8gfVxudmFyIGlkU2VlZCA9IDA7XG5cbnZhciBUaW1lciA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0Ly8gaWYgKCEodGhpcyBpbnN0YW5jZW9mIFRpbWVyKSkge1xuXHQvLyBcdHJldHVybiBuZXcgVGltZXIob3B0aW9ucyk7XG5cdC8vIH1cblx0dGhpcy5faWQgPSBpZFNlZWQrKztcblx0Ly8gdGhpcy5fb3B0aW9ucyA9IHt9O1xuXHR0aGlzLl9kdXJhdGlvbiA9IDA7XG5cdHRoaXMuX3N0YXR1cyA9IFwiaW5pdGlhbGl6ZWRcIjtcblx0dGhpcy5fc3RhcnQgPSAwO1xuXHQvLyB0aGlzLl9tZWFzdXJlcyA9IFtdO1xuXG5cdC8vIGZvciAodmFyIHByb3AgaW4gZGVmYXVsdE9wdGlvbnMpIHtcblx0Ly8gXHR0aGlzLl9vcHRpb25zW3Byb3BdID0gZGVmYXVsdE9wdGlvbnNbcHJvcF07XG5cdC8vIH1cblx0Ly8gdGhpcy5vcHRpb25zKG9wdGlvbnMpO1xufTtcblxuXy5leHRlbmQoVGltZXIucHJvdG90eXBlLCBFdmVudHMsIHtcblxuXHRzdGFydDogZnVuY3Rpb24oZHVyYXRpb24pIHtcblx0XHRpZiAoIV8uaXNOdW1iZXIoZHVyYXRpb24pICYmICF0aGlzLl9kdXJhdGlvbikge1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHRcdC8vIGR1cmF0aW9uICYmIChkdXJhdGlvbiAqPSAxMDAwKVxuXHRcdGlmICh0aGlzLl90aW1lb3V0ICYmIHRoaXMuX3N0YXR1cyA9PT0gXCJzdGFydGVkXCIpIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblx0XHR2YXIgZXZOYW1lID0gKHRoaXMuX3N0YXR1cyA9PT0gXCJzdG9wcGVkXCIpID8gXCJzdGFydFwiIDogXCJyZXN1bWVcIjtcblx0XHR0aGlzLl9kdXJhdGlvbiA9IGR1cmF0aW9uIHx8IHRoaXMuX2R1cmF0aW9uO1xuXHRcdHRoaXMuX3RpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChlbmQuYmluZCh0aGlzKSwgdGhpcy5fZHVyYXRpb24pO1xuXHRcdC8vIGlmICh0eXBlb2YgdGhpcy5fb3B0aW9ucy5vbnRpY2sgPT09IFwiZnVuY3Rpb25cIikge1xuXHRcdC8vIFx0dGhpcy5faW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcblx0XHQvLyBcdFx0dGhpcy50cmlnZ2VyKFwidGlja1wiLCB0aGlzLmdldER1cmF0aW9uKCkpXG5cdFx0Ly8gXHR9LmJpbmQodGhpcyksICt0aGlzLl9vcHRpb25zLnRpY2sgKiAxMDAwKVxuXHRcdC8vIH1cblx0XHR0aGlzLl9zdGFydCA9IF9ub3coKTtcblx0XHR0aGlzLl9zdGF0dXMgPSBcInN0YXJ0ZWRcIjtcblx0XHR0aGlzLnRyaWdnZXIoZXZOYW1lLCB0aGlzLmdldER1cmF0aW9uKCkpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHBhdXNlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fc3RhdHVzICE9PSBcInN0YXJ0ZWRcIikge1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHRcdHRoaXMuX2R1cmF0aW9uIC09IChfbm93KCkgLSB0aGlzLl9zdGFydCk7XG5cdFx0Y2xlYXIuY2FsbCh0aGlzLCBmYWxzZSk7XG5cdFx0dGhpcy5fc3RhdHVzID0gXCJwYXVzZWRcIjtcblx0XHR0aGlzLnRyaWdnZXIoXCJwYXVzZVwiLCB0aGlzLmdldER1cmF0aW9uKCkpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHN0b3A6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICghL3N0YXJ0ZWR8cGF1c2VkLy50ZXN0KHRoaXMuX3N0YXR1cykpIHtcblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblx0XHRjbGVhci5jYWxsKHRoaXMsIHRydWUpO1xuXHRcdHRoaXMuX3N0YXR1cyA9IFwic3RvcHBlZFwiO1xuXHRcdHRoaXMudHJpZ2dlcihcInN0b3BcIik7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0Z2V0RHVyYXRpb246IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9zdGF0dXMgPT09IFwic3RhcnRlZFwiKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fZHVyYXRpb24gLSAoX25vdygpIC0gdGhpcy5fc3RhcnQpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fc3RhdHVzID09PSBcInBhdXNlZFwiKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fZHVyYXRpb247XG5cdFx0fVxuXHRcdHJldHVybiAwO1xuXHR9LFxuXG5cdGdldFN0YXR1czogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX3N0YXR1cztcblx0fSxcbn0pO1xuXG52YXIgX25vdyA9IHdpbmRvdy5wZXJmb3JtYW5jZSA/XG5cdHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cuYmluZCh3aW5kb3cucGVyZm9ybWFuY2UpIDpcblx0RGF0ZS5ub3cuYmluZChEYXRlKTtcblxuZnVuY3Rpb24gZW5kKCkge1xuXHRjbGVhci5jYWxsKHRoaXMpO1xuXHR0aGlzLl9zdGF0dXMgPSBcInN0b3BwZWRcIjtcblx0dGhpcy50cmlnZ2VyKFwiZW5kXCIpO1xufVxuXG5mdW5jdGlvbiBjbGVhcihjbGVhckR1cmF0aW9uKSB7XG5cdHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5fdGltZW91dCk7XG5cdC8vIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuX2ludGVydmFsKTtcblx0aWYgKGNsZWFyRHVyYXRpb24gPT09IHRydWUpIHtcblx0XHR0aGlzLl9kdXJhdGlvbiA9IDA7XG5cdH1cbn1cblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoVGltZXIucHJvdG90eXBlLCB7XG5cdGR1cmF0aW9uOiB7XG5cdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZ2V0RHVyYXRpb24oKTtcblx0XHR9XG5cdH0sXG5cdHN0YXR1czoge1xuXHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLmdldFN0YXR1cygpO1xuXHRcdH1cblx0fVxufSk7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKFRpbWVyLCB7XG5cdFNUT1BQRUQ6IHtcblx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdHZhbHVlOiBcInN0b3BwZWRcIlxuXHR9LFxuXHRTVEFSVEVEOiB7XG5cdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHR2YWx1ZTogXCJzdGFydGVkXCJcblx0fSxcblx0UEFVU0VEOiB7XG5cdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHR2YWx1ZTogXCJwYXVzZWRcIlxuXHR9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gVGltZXI7XG4iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBJbXBvcnRzXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL1RyYW5zZm9ybUl0ZW19ICovXG52YXIgVHJhbnNmb3JtSXRlbSA9IHJlcXVpcmUoXCIuL1RyYW5zZm9ybUl0ZW1cIik7XG5cbnZhciBpZFNlZWQgPSAwO1xudmFyIGNpZFNlZWQgPSAxMDA7XG52YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9oZWxwZXIvVHJhbnNmb3JtSGVscGVyfVxuICovXG5mdW5jdGlvbiBUcmFuc2Zvcm1IZWxwZXIoKSB7XG5cdHRoaXMuaWQgPSBpZFNlZWQrKztcblx0dGhpcy5faXRlbXMgPSBbXTtcblx0dGhpcy5faXRlbXNCeUlkID0ge307XG59XG5cblRyYW5zZm9ybUhlbHBlci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHtcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIFByaXZhdGVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9nZXQ6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0aWYgKHRoaXMuaGFzKGVsKSkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2l0ZW1zQnlJZFtlbC5laWRdO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fYWRkKGVsKTtcblx0XHR9XG5cdH0sXG5cblx0X2FkZDogZnVuY3Rpb24oZWwpIHtcblx0XHR2YXIgaXRlbSwgaWQ7XG5cdFx0Ly8gaWQgPSBlbC5laWQgfHwgZWwuY2lkIHx8IGVsLmlkO1xuXHRcdC8vIGlmICghaWQgfHwgKHRoaXMuX2l0ZW1zQnlJZFtpZF0gJiYgKHRoaXMuX2l0ZW1zQnlJZFtpZF0uZWwgIT09IGVsKSkpIHtcblx0XHQvLyBcdGlkID0gXCJlbHRcIiArIGNpZFNlZWQrKztcblx0XHQvLyB9XG5cdFx0Ly8gaWYgKCFlbC5laWQpIHtcblx0XHQvLyBcdGlkID0gZWwuZWlkIHx8IGVsLmNpZCB8fCAoXCJlbHRcIiArIGNpZFNlZWQrKyk7XG5cdFx0Ly8gfVxuXHRcdGlkID0gZWwuZWlkIHx8IGVsLmNpZCB8fCAoXCJlbHRcIiArIGNpZFNlZWQrKyk7XG5cdFx0aXRlbSA9IG5ldyBUcmFuc2Zvcm1JdGVtKGVsLCBpZCk7XG5cdFx0dGhpcy5faXRlbXNCeUlkW2lkXSA9IGl0ZW07XG5cdFx0dGhpcy5faXRlbXMucHVzaChpdGVtKTtcblx0XHRyZXR1cm4gaXRlbTtcblx0fSxcblxuXHRfcmVtb3ZlOiBmdW5jdGlvbihlbCkge1xuXHRcdGlmICh0aGlzLmhhcyhlbCkpIHtcblx0XHRcdHZhciBvID0gdGhpcy5faXRlbXNCeUlkW2VsLmVpZF07XG5cdFx0XHR0aGlzLl9pdGVtcy5zcGxpY2UodGhpcy5faXRlbXMuaW5kZXhPZihvKSwgMSk7XG5cdFx0XHRvLmRlc3Ryb3koKTtcblx0XHRcdGRlbGV0ZSB0aGlzLl9pdGVtc0J5SWRbZWwuZWlkXTtcblx0XHR9XG5cdH0sXG5cblx0X2ludm9rZTogZnVuY3Rpb24oZnVuY05hbWUsIGFyZ3MsIHN0YXJ0SW5kZXgpIHtcblx0XHR2YXIgaSwgaWksIGosIGpqLCBlbCwgbywgcnI7XG5cdFx0dmFyIGZ1bmNBcmdzID0gbnVsbDtcblx0XHRpZiAoc3RhcnRJbmRleCAhPT0gdm9pZCAwKSB7XG5cdFx0XHRmdW5jQXJncyA9IHNsaWNlLmNhbGwoYXJncywgMCwgc3RhcnRJbmRleCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHN0YXJ0SW5kZXggPSAwO1xuXHRcdH1cblx0XHRmb3IgKGkgPSBzdGFydEluZGV4LCBpaSA9IGFyZ3MubGVuZ3RoLCByciA9IFtdOyBpIDwgaWk7ICsraSkge1xuXHRcdFx0ZWwgPSBhcmdzW2ldO1xuXHRcdFx0Ly8gaXRlcmF0ZSBvbiBOb2RlTGlzdCwgQXJndW1lbnRzLCBBcnJheS4uLlxuXHRcdFx0aWYgKGVsLmxlbmd0aCkge1xuXHRcdFx0XHRmb3IgKGogPSAwLCBqaiA9IGVsLmxlbmd0aDsgaiA8IGpqOyArK2opIHtcblx0XHRcdFx0XHRvID0gdGhpcy5fZ2V0KGVsW2pdKTtcblx0XHRcdFx0XHRyci5wdXNoKG9bZnVuY05hbWVdLmFwcGx5KG8sIGZ1bmNBcmdzKSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG8gPSB0aGlzLl9nZXQoZWwpO1xuXHRcdFx0XHRyci5wdXNoKG9bZnVuY05hbWVdLmFwcGx5KG8sIGZ1bmNBcmdzKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBycjtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIFB1YmxpY1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0aGFzOiBmdW5jdGlvbihlbCkge1xuXHRcdHJldHVybiBlbC5laWQgJiYgdGhpcy5faXRlbXNCeUlkW2VsLmVpZF0gIT09IHZvaWQgMDtcblx0fSxcblxuXHRnZXRJdGVtczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGksIGosIGVsLCByZXQgPSBbXTtcblx0XHRmb3IgKGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgKytpKSB7XG5cdFx0XHRlbCA9IGFyZ3VtZW50c1tpXTtcblx0XHRcdGlmIChlbC5sZW5ndGgpIHtcblx0XHRcdFx0Zm9yIChqID0gMDsgaiA8IGVsLmxlbmd0aDsgKytqKSB7XG5cdFx0XHRcdFx0cmV0LnB1c2godGhpcy5fZ2V0KGVsW2pdKSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHJldC5wdXNoKHRoaXMuX2dldChlbCkpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gcmV0O1xuXHR9LFxuXG5cdGdldDogZnVuY3Rpb24oZWwpIHtcblx0XHRyZXR1cm4gdGhpcy5fZ2V0KGVsKTtcblx0fSxcblxuXHRhZGQ6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBpLCBqLCBlbDtcblx0XHRmb3IgKGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgKytpKSB7XG5cdFx0XHRlbCA9IGFyZ3VtZW50c1tpXTtcblx0XHRcdGlmIChlbC5sZW5ndGgpIHtcblx0XHRcdFx0Zm9yIChqID0gMDsgaiA8IGVsLmxlbmd0aDsgKytqKSB7XG5cdFx0XHRcdFx0dGhpcy5fZ2V0KGVsW2pdKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5fZ2V0KGVsKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0cmVtb3ZlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgaSwgaiwgZWw7XG5cdFx0Zm9yIChpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7ICsraSkge1xuXHRcdFx0ZWwgPSBhcmd1bWVudHNbaV07XG5cdFx0XHRpZiAoZWwubGVuZ3RoKSB7XG5cdFx0XHRcdGZvciAoaiA9IDA7IGogPCBlbC5sZW5ndGg7ICsraikge1xuXHRcdFx0XHRcdHRoaXMuX3JlbW92ZShlbFtqXSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuX3JlbW92ZShlbCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHB1YmxpY1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qIHB1YmxpYzogc2luZ2xlIGFyZ1xuXHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cblx0aGFzT2Zmc2V0OiBmdW5jdGlvbihlbCkge1xuXHRcdHJldHVybiB0aGlzLmhhcyhlbCkgPyB0aGlzLl9pdGVtc0J5SWRbZWwuZWlkXS5oYXNPZmZzZXQgOiAodm9pZCAwKTtcblx0fSxcblxuXHQvKiBwdWJsaWM6IGNhcHR1cmVcblx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXG5cdGNhcHR1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX2ludm9rZShcImNhcHR1cmVcIiwgYXJndW1lbnRzKTtcblx0fSxcblx0Y2FwdHVyZUFsbDogZnVuY3Rpb24oKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5faXRlbXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0dGhpcy5faXRlbXNbaV0uY2FwdHVyZSgpO1xuXHRcdH1cblx0fSxcblxuXHRjbGVhckNhcHR1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX2ludm9rZShcImNsZWFyQ2FwdHVyZVwiLCBhcmd1bWVudHMpO1xuXHR9LFxuXHRjbGVhckFsbENhcHR1cmVzOiBmdW5jdGlvbigpIHtcblx0XHRmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLl9pdGVtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHR0aGlzLl9pdGVtc1tpXS5jbGVhckNhcHR1cmUoKTtcblx0XHR9XG5cdH0sXG5cblx0LyogcHVibGljOiBvZmZzZXRcblx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRvZmZzZXQ6IGZ1bmN0aW9uKHgsIHkpIHtcblx0XHR0aGlzLl9pbnZva2UoXCJvZmZzZXRcIiwgYXJndW1lbnRzLCAyKTtcblx0fSxcblx0b2Zmc2V0QWxsOiBmdW5jdGlvbih4LCB5KSB7XG5cdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5faXRlbXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0dGhpcy5faXRlbXNbaV0ub2Zmc2V0KHgsIHkpO1xuXHRcdH1cblx0fSxcblxuXHRjbGVhck9mZnNldDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5faW52b2tlKFwiY2xlYXJPZmZzZXRcIiwgYXJndW1lbnRzKTtcblx0fSxcblx0Y2xlYXJBbGxPZmZzZXRzOiBmdW5jdGlvbigpIHtcblx0XHRmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLl9pdGVtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHR0aGlzLl9pdGVtc1tpXS5jbGVhck9mZnNldCgpO1xuXHRcdH1cblx0fSxcblxuXHQvKiBwdWJsaWM6IHRyYW5zaXRpb25zXG5cdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblxuXHRydW5UcmFuc2l0aW9uOiBmdW5jdGlvbih0cmFuc2l0aW9uKSB7XG5cdFx0dGhpcy5faW52b2tlKFwicnVuVHJhbnNpdGlvblwiLCBhcmd1bWVudHMsIDEpO1xuXHR9LFxuXHRydW5BbGxUcmFuc2l0aW9uczogZnVuY3Rpb24odHJhbnNpdGlvbikge1xuXHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMuX2l0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHRoaXMuX2l0ZW1zW2ldLnJ1blRyYW5zaXRpb24odHJhbnNpdGlvbik7XG5cdFx0fVxuXHR9LFxuXG5cdGNsZWFyVHJhbnNpdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5faW52b2tlKFwiY2xlYXJUcmFuc2l0aW9uXCIsIGFyZ3VtZW50cyk7XG5cdH0sXG5cdGNsZWFyQWxsVHJhbnNpdGlvbnM6IGZ1bmN0aW9uKCkge1xuXHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMuX2l0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHRoaXMuX2l0ZW1zW2ldLmNsZWFyVHJhbnNpdGlvbigpO1xuXHRcdH1cblx0fSxcblxuXHRzdG9wVHJhbnNpdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5faW52b2tlKFwic3RvcFRyYW5zaXRpb25cIiwgYXJndW1lbnRzKTtcblx0fSxcblx0c3RvcEFsbFRyYW5zaXRpb25zOiBmdW5jdGlvbigpIHtcblx0XHRmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLl9pdGVtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHR0aGlzLl9pdGVtc1tpXS5zdG9wVHJhbnNpdGlvbigpO1xuXHRcdH1cblx0fSxcblxuXHR3aGVuVHJhbnNpdGlvbkVuZHM6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciByZXMgPSB0aGlzLl9pbnZva2UoXCJ3aGVuVHJhbnNpdGlvbkVuZHNcIiwgYXJndW1lbnRzKTtcblx0XHRyZXR1cm4gcmVzLmxlbmd0aCAhPSAwID9cblx0XHRcdFByb21pc2UuYWxsKHJlcykgOlxuXHRcdFx0UHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuXHR9LFxuXHR3aGVuQWxsVHJhbnNpdGlvbnNFbmQ6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiAodGhpcy5faXRlbXMubGVuZ3RoICE9IDApID8gUHJvbWlzZS5hbGwodGhpcy5faXRlbXMubWFwKGZ1bmN0aW9uKG8pIHtcblx0XHRcdHJldHVybiBvLndoZW5UcmFuc2l0aW9uRW5kcygpO1xuXHRcdH0pKSA6IFByb21pc2UucmVzb2x2ZShudWxsKTtcblx0fSxcblxuXHRwcm9taXNlOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA9PSAwID9cblx0XHRcdHRoaXMud2hlbkFsbFRyYW5zaXRpb25zRW5kKCkgOlxuXHRcdFx0dGhpcy53aGVuVHJhbnNpdGlvbkVuZHMuY2FsbCh0aGlzLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogdmFsaWRhdGlvblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0dmFsaWRhdGU6IGZ1bmN0aW9uKCkge1xuXHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMuX2l0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHRoaXMuX2l0ZW1zW2ldLnZhbGlkYXRlKCk7XG5cdFx0fVxuXHR9LFxufSwge1xuXHRpdGVtczoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5faXRlbXM7XG5cdFx0fVxuXHR9XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBUcmFuc2Zvcm1IZWxwZXI7XG4iLCIvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBJbXBvcnRzXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFByb3BlcnR5fSAqL1xudmFyIHByZWZpeGVkUHJvcGVydHkgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRQcm9wZXJ0eVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkU3R5bGVOYW1lfSAqL1xudmFyIHByZWZpeGVkU3R5bGVOYW1lID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkU3R5bGVOYW1lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRFdmVudH0gKi9cbnZhciBwcmVmaXhlZEV2ZW50ID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkRXZlbnRcIik7XG5cbi8qKiBAdHlwZSB7U3RyaW5nfSAqL1xudmFyIHRyYW5zaXRpb25FbmQgPSBwcmVmaXhlZEV2ZW50KFwidHJhbnNpdGlvbmVuZFwiKTsgLy9yZXF1aXJlKFwidXRpbHMvZXZlbnQvdHJhbnNpdGlvbkVuZFwiKTtcbi8vIC8qKiBAdHlwZSB7RnVuY3Rpb259ICovLy8gdmFyIHNsaWNlID0gQXJyYXkucHJvdG90eXBlLnNsaWNlO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9kZWJ1Zy90cmFjZUVsZW1lbnR9ICovXG4vLyB2YXIgdHJhY2VFbHQgPSByZXF1aXJlKFwiLi9kZWJ1Zy90cmFjZUVsZW1lbnRcIik7XG4vLyB2YXIgdHJhY2VFbHRDYWNoZSA9IHt9O1xuLy8gdmFyIGxvZyA9IGZ1bmN0aW9uKCkge1xuLy8gXHR2YXIgbG9nRm4gPSBcImxvZ1wiO1xuLy8gXHR2YXIgYXJncyA9IHNsaWNlLmFwcGx5KGFyZ3VtZW50cyk7XG4vLyBcdHN3aXRjaChhcmdzWzBdKSB7XG4vLyBcdFx0Y2FzZSBcImVycm9yXCI6XG4vLyBcdFx0Y2FzZSBcIndhcm5cIjpcbi8vIFx0XHRjYXNlIFwiaW5mb1wiOlxuLy8gXHRcdFx0bG9nRm4gPSBhcmdzLnNoaWZ0KCk7XG4vLyBcdFx0XHRicmVhaztcbi8vIFx0XHRkZWZhdWx0OlxuLy8gXHRcdFx0Ly8gYnJlYWs7XG4vLyBcdFx0XHRyZXR1cm47XG4vLyBcdH1cbi8vIFx0dmFyIGVsLCB0eElkO1xuLy8gXHRpZiAoKGVsID0gYXJnc1swXSkgJiYgKHR4SWQgPSBlbC5laWQpKSB7XG4vLyBcdFx0YXJnc1swXSA9IHRyYWNlRWx0Q2FjaGVbdHhJZF0gfHwgKHRyYWNlRWx0Q2FjaGVbdHhJZF0gPSBlbCk7XG4vLyBcdH1cbi8vIFx0YXJnc1swXSA9IFwiXFx0XCIgKyBhcmdzWzBdO1xuLy8gXHRjb25zb2xlW2xvZ0ZuXS5hcHBseShjb25zb2xlLCBhcmdzKTtcbi8vIH07XG5cbi8qIGpzaGludCAtVzA3OSAqL1xuLy8gdmFyIGNvbnNvbGUgPSAoZnVuY3Rpb24odGFyZ2V0KSB7XG4vLyBcdHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyh0YXJnZXQpLnJlZHVjZShmdW5jdGlvbihwcm94eSwgcHJvcCkge1xuLy8gXHRcdGlmICgodHlwZW9mIHRhcmdldFtwcm9wXSkgPT0gXCJmdW5jdGlvblwiKSB7XG4vLyBcdFx0XHRzd2l0Y2ggKHByb3ApIHtcbi8vIFx0XHRcdFx0Y2FzZSBcImVycm9yXCI6XG4vLyBcdFx0XHRcdGNhc2UgXCJ3YXJuXCI6XG4vLyBcdFx0XHRcdGNhc2UgXCJpbmZvXCI6XG4vLyBcdFx0XHRcdFx0cHJveHlbcHJvcF0gPSBmdW5jdGlvbiAoKSB7XG4vLyBcdFx0XHRcdFx0XHR2YXIgYXJncyA9IHNsaWNlLmFwcGx5KGFyZ3VtZW50cyk7XG4vLyBcdFx0XHRcdFx0XHRpZiAodHlwZW9mIGFyZ3NbMF0gPT0gXCJzdHJpbmdcIikge1xuLy8gXHRcdFx0XHRcdFx0XHRhcmdzWzBdID0gcHJvcCArIFwiOjpcIiArIGFyZ3NbMF07XG4vLyBcdFx0XHRcdFx0XHR9XG4vLyBcdFx0XHRcdFx0XHRyZXR1cm4gdGFyZ2V0W3Byb3BdLmFwcGx5KHRhcmdldCwgYXJncyk7XG4vLyBcdFx0XHRcdFx0fTtcbi8vIFx0XHRcdFx0XHRicmVhaztcbi8vIFx0XHRcdFx0Y2FzZSBcImxvZ1wiOlxuLy8gXHRcdFx0XHRcdHByb3h5W3Byb3BdID0gZnVuY3Rpb24oKSB7fTtcbi8vIFx0XHRcdFx0XHRicmVhaztcbi8vIFx0XHRcdFx0ZGVmYXVsdDpcbi8vIFx0XHRcdFx0XHRwcm94eVtwcm9wXSA9IHRhcmdldFtwcm9wXS5iaW5kKHRhcmdldCk7XG4vLyBcdFx0XHRcdFx0YnJlYWs7XG4vLyBcdFx0XHR9XG4vLyBcdFx0fSBlbHNlIHtcbi8vIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShwcm94eSwgcHJvcCwge1xuLy8gXHRcdFx0XHRnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGFyZ2V0W3Byb3BdOyB9LFxuLy8gXHRcdFx0XHRzZXQ6IGZ1bmN0aW9uKHZhbCkgeyB0YXJnZXRbcHJvcF0gPSB2YWw7IH1cbi8vIFx0XHRcdH0pO1xuLy8gXHRcdH1cbi8vIFx0XHRyZXR1cm4gcHJveHk7XG4vLyBcdH0sIHt9KTtcbi8vIH0pKHdpbmRvdy5jb25zb2xlKTtcbi8qIGpzaGludCArVzA3OSAqL1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBQcml2YXRlIHN0YXRpY1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG52YXIgTk9fVFJBTlNJVElPTl9WQUxVRSA9IFwibm9uZSAwcyBzdGVwLXN0YXJ0IDBzXCI7XG4vLyB2YXIgTk9fVFJBTlNJVElPTl9WQUxVRSA9IFwiYWxsIDAuMDAxcyBzdGVwLXN0YXJ0IDAuMDAxc1wiO1xuXG52YXIgVU5TRVRfVFJBTlNJVElPTiA9IHtcblx0bmFtZTogXCJ1bnNldFwiLFxuXHRjbGFzc05hbWU6IFwidHgtdW5zZXRcIixcblx0cHJvcGVydHk6IFwibm9uZVwiLFxuXHRlYXNpbmc6IFwiZWFzZVwiLFxuXHRkZWxheTogMCxcblx0ZHVyYXRpb246IDAsXG5cdGNzc1RleHQ6IFwidW5zZXRcIixcbn07XG5cblxuLy8gdmFyIHRyYW5zbGF0ZVRlbXBsYXRlID0gZnVuY3Rpb24obykge1xuLy8gXHQvLyByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBvLl9yZW5kZXJlZFggKyBcInB4LCBcIiArIG8uX3JlbmRlcmVkWSArIFwicHgpXCI7XG4vLyBcdC8vIHJldHVybiBcInRyYW5zbGF0ZTNkKFwiICsgby5fcmVuZGVyZWRYICsgXCJweCwgXCIgKyBvLl9yZW5kZXJlZFkgKyBcInB4LCAwcHgpXCI7XG4vLyB9O1xudmFyIHRyYW5zbGF0ZVRlbXBsYXRlID0gKGZ1bmN0aW9uKCkge1xuXHR2YXIgZm4gPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKS5UUkFOU0xBVEVfVEVNUExBVEU7XG5cdHJldHVybiBmdW5jdGlvbihvKSB7XG5cdFx0cmV0dXJuIGZuKG8uX3JlbmRlcmVkWCwgby5fcmVuZGVyZWRZKTtcblx0fTtcbn0oKSk7XG5cbi8vIHZhciB0cmFuc2l0aW9uVGVtcGxhdGUgPSBfLnRlbXBsYXRlKFwiPCU9IHByb3BlcnR5ICU+IDwlIGR1cmF0aW9uLzEwMDAgJT5zIDwlPSBlYXNpbmcgJT4gPCUgZGVsYXkvMTAwMCAlPnNcIik7XG52YXIgdHJhbnNpdGlvblRlbXBsYXRlID0gZnVuY3Rpb24obykge1xuXHRyZXR1cm4gby5wcm9wZXJ0eSArIFwiIFwiICsgby5kdXJhdGlvbiAvIDEwMDAgKyBcInMgXCIgKyBvLmVhc2luZyArIFwiIFwiICsgby5kZWxheSAvIDEwMDAgKyBcInNcIjtcbn07XG5cbnZhciBwcm9wRGVmYXVsdHMgPSB7XG5cdFwib3BhY2l0eVwiOiBcIjFcIixcblx0XCJ2aXNpYmlsaXR5XCI6IFwidmlzaWJsZVwiLFxuXHRcInRyYW5zZm9ybVwiOiBcIm1hdHJpeCgxLCAwLCAwLCAxLCAwLCAwKVwiLFxuXHRcInRyYW5zZm9ybVN0eWxlXCI6IFwiXCIsXG5cdFwidHJhbnNpdGlvblwiOiBcIlwiLFxuXHQvLyBcIndpbGxDaGFuZ2VcIjogXCJcIixcblx0Ly8gXCJ0cmFuc2l0aW9uRHVyYXRpb25cIjogXCIwc1wiLFxuXHQvLyBcInRyYW5zaXRpb25EZWxheVwiOiBcIjBzXCIsXG5cdC8vIFwidHJhbnNpdGlvblByb3BlcnR5XCI6IFwibm9uZVwiLFxuXHQvLyBcInRyYW5zaXRpb25UaW1pbmdGdW5jdGlvblwiOiBcImVhc2VcIlxufTtcbnZhciBwcm9wS2V5cyA9IE9iamVjdC5rZXlzKHByb3BEZWZhdWx0cyk7XG52YXIgcHJvcE5hbWVzID0gcHJvcEtleXMucmVkdWNlKGZ1bmN0aW9uKG9iaiwgcHJvcE5hbWUpIHtcblx0b2JqW3Byb3BOYW1lXSA9IHByZWZpeGVkUHJvcGVydHkocHJvcE5hbWUpO1xuXHRyZXR1cm4gb2JqO1xufSwge30pO1xuXG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9zdHJpbmdzL2NhbWVsVG9EYXNoZWR9ICovXG52YXIgY2FtZWxUb0Rhc2hlZCA9IHJlcXVpcmUoXCJ1dGlscy9zdHJpbmdzL2NhbWVsVG9EYXNoZWRcIik7XG52YXIgc3R5bGVOYW1lcyA9IHByb3BLZXlzLm1hcChjYW1lbFRvRGFzaGVkKS5yZWR1Y2UoZnVuY3Rpb24ob2JqLCBwcm9wTmFtZSkge1xuXHRvYmpbcHJvcE5hbWVdID0gcHJlZml4ZWRTdHlsZU5hbWUocHJvcE5hbWUpO1xuXHRyZXR1cm4gb2JqO1xufSwge30pO1xuXG52YXIgcmVzb2x2ZUFsbCA9IGZ1bmN0aW9uKHBwLCByZXN1bHQpIHtcblx0aWYgKHBwLmxlbmd0aCAhPSAwKSB7XG5cdFx0cHAuZm9yRWFjaChmdW5jdGlvbihwLCBpLCBhKSB7XG5cdFx0XHRwLnJlc29sdmUocmVzdWx0KTtcblx0XHRcdGFbaV0gPSBudWxsO1xuXHRcdH0pO1xuXHRcdHBwLmxlbmd0aCA9IDA7XG5cdH1cblx0cmV0dXJuIHBwO1xufTtcblxudmFyIHJlamVjdEFsbCA9IGZ1bmN0aW9uKHBwLCByZWFzb24pIHtcblx0aWYgKHBwLmxlbmd0aCAhPSAwKSB7XG5cdFx0cHAuZm9yRWFjaChmdW5jdGlvbihwLCBpLCBhKSB7XG5cdFx0XHRwLnJlamVjdChyZWFzb24pO1xuXHRcdFx0YVtpXSA9IG51bGw7XG5cdFx0fSk7XG5cdFx0cHAubGVuZ3RoID0gMDtcblx0fVxuXHRyZXR1cm4gcHA7XG59O1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBUcmFuc2Zvcm1JdGVtXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbnZhciBUcmFuc2Zvcm1JdGVtID0gZnVuY3Rpb24oZWwsIGlkKSB7XG5cdF8uYmluZEFsbCh0aGlzLCBcIl9vblRyYW5zaXRpb25FbmRcIik7XG5cblx0dGhpcy5lbCA9IGVsO1xuXHR0aGlzLmlkID0gaWQ7XG5cdHRoaXMuZWwuZWlkID0gaWQ7XG5cdHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kLCB0aGlzLl9vblRyYW5zaXRpb25FbmQsIGZhbHNlKTtcblxuXHR0aGlzLl9jYXB0dXJlSW52YWxpZCA9IGZhbHNlO1xuXHR0aGlzLl9jYXB0dXJlZENoYW5nZWQgPSBmYWxzZTtcblx0dGhpcy5fY2FwdHVyZWRYID0gbnVsbDtcblx0dGhpcy5fY2FwdHVyZWRZID0gbnVsbDtcblx0dGhpcy5fY3VyckNhcHR1cmUgPSB7fTtcblx0dGhpcy5fbGFzdENhcHR1cmUgPSB7fTtcblxuXHR0aGlzLl9oYXNPZmZzZXQgPSBmYWxzZTtcblx0dGhpcy5fb2Zmc2V0SW52YWxpZCA9IGZhbHNlO1xuXHR0aGlzLl9vZmZzZXRYID0gbnVsbDtcblx0dGhpcy5fb2Zmc2V0WSA9IG51bGw7XG5cblx0dGhpcy5fcmVuZGVyZWRYID0gbnVsbDtcblx0dGhpcy5fcmVuZGVyZWRZID0gbnVsbDtcblxuXHR0aGlzLl9oYXNUcmFuc2l0aW9uID0gZmFsc2U7XG5cdHRoaXMuX3RyYW5zaXRpb25JbnZhbGlkID0gZmFsc2U7XG5cdHRoaXMuX3RyYW5zaXRpb25SdW5uaW5nID0gZmFsc2U7XG5cdHRoaXMuX3RyYW5zaXRpb24gPSBfLmV4dGVuZCh7fSwgVU5TRVRfVFJBTlNJVElPTik7IC8ve307XG5cblx0dGhpcy5fcHJvbWlzZXMgPSBbXTtcblx0dGhpcy5fcGVuZGluZ1Byb21pc2VzID0gW107XG59XG5cblRyYW5zZm9ybUl0ZW0ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSh7XG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBQdWJsaWNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qIGRlc3Ryb3lcblx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHQvLyBOT1RFOiBzdHlsZSBwcm9wZXJ0eSBtYXkgaGF2ZSBiZWVuIG1vZGlmaWVkOyBjbGVhck9mZnNldChlbGVtZW50KSBzaG91bGRcblx0XHQvLyBiZSBjYWxsZWQgZXhwbGljaXRseSBpZiBjbGVhbiB1cCBpcyByZXF1aXJlZC5cblx0XHR0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIodHJhbnNpdGlvbkVuZCwgdGhpcy5fb25UcmFuc2l0aW9uRW5kLCBmYWxzZSk7XG5cdFx0cmVqZWN0QWxsKHRoaXMuX3BlbmRpbmdQcm9taXNlcywgdGhpcyk7XG5cdFx0cmVqZWN0QWxsKHRoaXMuX3Byb21pc2VzLCB0aGlzKTtcblx0XHQvLyBkZWxldGUgdGhpcy5lbC5laWQ7XG5cdH0sXG5cblx0LyogY2FwdHVyZVxuXHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cdGNhcHR1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwidHhbJXNdOjpjYXB0dXJlXCIsIHRoaXMuaWQpO1xuXHRcdHRoaXMuX3ZhbGlkYXRlQ2FwdHVyZSgpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGNsZWFyQ2FwdHVyZTogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106OmNsZWFyQ2FwdHVyZVwiLCB0aGlzLmlkKTtcblx0XHQvLyB0aGlzLl9oYXNPZmZzZXQgPSBmYWxzZTtcblx0XHR0aGlzLl9jYXB0dXJlSW52YWxpZCA9IHRydWU7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0Lyogb2Zmc2V0L2NsZWFyXG5cdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblx0b2Zmc2V0OiBmdW5jdGlvbih4LCB5KSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106Om9mZnNldFwiLCB0aGlzLmlkKTtcblxuXHRcdHRoaXMuX2hhc09mZnNldCA9IHRydWU7XG5cdFx0dGhpcy5fb2Zmc2V0SW52YWxpZCA9IHRydWU7XG5cdFx0dGhpcy5fb2Zmc2V0WCA9IHggfHwgMDtcblx0XHR0aGlzLl9vZmZzZXRZID0geSB8fCAwO1xuXHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRjbGVhck9mZnNldDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX2hhc09mZnNldCkge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106OmNsZWFyT2Zmc2V0XCIsIHRoaXMuaWQpO1xuXG5cdFx0XHR0aGlzLl9oYXNPZmZzZXQgPSBmYWxzZTtcblx0XHRcdHRoaXMuX29mZnNldEludmFsaWQgPSB0cnVlO1xuXHRcdFx0dGhpcy5fb2Zmc2V0WCA9IG51bGw7XG5cdFx0XHR0aGlzLl9vZmZzZXRZID0gbnVsbDtcblx0XHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106OmNsZWFyT2Zmc2V0IG5vIG9mZnNldCB0byBjbGVhclwiLCB0aGlzLmlkKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyogdHJhbnNpdGlvbnNcblx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRydW5UcmFuc2l0aW9uOiBmdW5jdGlvbih0cmFuc2l0aW9uKSB7XG5cdFx0aWYgKCF0cmFuc2l0aW9uKSB7IC8vIHx8ICh0cmFuc2l0aW9uLmR1cmF0aW9uICsgdHJhbnNpdGlvbi5kZWxheSkgPT0gMCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2xlYXJUcmFuc2l0aW9uKCk7XG5cdFx0fVxuXHRcdHZhciBsYXN0VmFsdWUgPSB0aGlzLl90cmFuc2l0aW9uVmFsdWU7XG5cdFx0dmFyIGxhc3ROYW1lID0gdGhpcy5fdHJhbnNpdGlvbi5uYW1lO1xuXHRcdHRoaXMuX3RyYW5zaXRpb24ucHJvcGVydHkgPSBzdHlsZU5hbWVzW1widHJhbnNmb3JtXCJdO1xuXHRcdHRoaXMuX3RyYW5zaXRpb24gPSBfLmV4dGVuZCh0aGlzLl90cmFuc2l0aW9uLCB0cmFuc2l0aW9uKTtcblx0XHR0aGlzLl90cmFuc2l0aW9uVmFsdWUgPSB0cmFuc2l0aW9uVGVtcGxhdGUodGhpcy5fdHJhbnNpdGlvbik7XG5cblx0XHRpZiAodGhpcy5fdHJhbnNpdGlvbkludmFsaWQpIHtcblx0XHRcdGNvbnNvbGUud2FybihcInR4WyVzXTo6cnVuVHJhbnNpdGlvbiBzZXQgb3ZlciAoJXM6JyVzJyA9PiAlczonJXMnKVwiLCB0aGlzLmlkLFxuXHRcdFx0XHRsYXN0TmFtZSwgbGFzdFZhbHVlLCB0aGlzLl90cmFuc2l0aW9uLm5hbWUsIHRoaXMuX3RyYW5zaXRpb25WYWx1ZSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5faGFzVHJhbnNpdGlvbiA9IHRydWU7XG5cdFx0dGhpcy5fdHJhbnNpdGlvbkludmFsaWQgPSB0cnVlO1xuXHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVUcmFuc2l0aW9uKCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0Y2xlYXJUcmFuc2l0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl90cmFuc2l0aW9uID0gXy5leHRlbmQodGhpcy5fdHJhbnNpdGlvbiwgVU5TRVRfVFJBTlNJVElPTik7XG5cdFx0dGhpcy5fdHJhbnNpdGlvblZhbHVlID0gTk9fVFJBTlNJVElPTl9WQUxVRTtcblxuXHRcdHRoaXMuX2hhc1RyYW5zaXRpb24gPSBmYWxzZTtcblx0XHR0aGlzLl90cmFuc2l0aW9uSW52YWxpZCA9IHRydWU7XG5cdFx0Ly8gaWYgKHRoaXMuaW1tZWRpYXRlKSB0aGlzLl92YWxpZGF0ZVRyYW5zaXRpb24oKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRzdG9wVHJhbnNpdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gdGhpcy5fdHJhbnNpdGlvbi5uYW1lID0gXCJbbm9uZV1cIjtcblx0XHQvLyB0aGlzLl90cmFuc2l0aW9uLnByb3BlcnR5ID0gXCJub25lXCI7XG5cdFx0dGhpcy5fdHJhbnNpdGlvbiA9IF8uZXh0ZW5kKHRoaXMuX3RyYW5zaXRpb24sIFVOU0VUX1RSQU5TSVRJT04pO1xuXHRcdHRoaXMuX3RyYW5zaXRpb25WYWx1ZSA9IE5PX1RSQU5TSVRJT05fVkFMVUU7XG5cblx0XHR0aGlzLl9oYXNUcmFuc2l0aW9uID0gZmFsc2U7XG5cdFx0dGhpcy5fdHJhbnNpdGlvbkludmFsaWQgPSB0cnVlO1xuXHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVUcmFuc2l0aW9uKCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0d2hlblRyYW5zaXRpb25FbmRzOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZCwgcCwgcHA7XG5cdFx0aWYgKHRoaXMuX3RyYW5zaXRpb25JbnZhbGlkIHx8IHRoaXMuX3RyYW5zaXRpb25SdW5uaW5nKSB7XG5cdFx0XHRkID0ge307XG5cdFx0XHRwID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRcdGQucmVzb2x2ZSA9IHJlc29sdmU7XG5cdFx0XHRcdGQucmVqZWN0ID0gcmVqZWN0O1xuXHRcdFx0fSk7XG5cdFx0XHRwcCA9IHRoaXMuX3RyYW5zaXRpb25JbnZhbGlkID8gdGhpcy5fcGVuZGluZ1Byb21pc2VzIDogdGhpcy5fcHJvbWlzZXM7XG5cdFx0XHRwcC5wdXNoKGQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRwID0gUHJvbWlzZS5yZXNvbHZlKHRoaXMpO1xuXHRcdH1cblx0XHRyZXR1cm4gcDtcblx0fSxcblxuXHQvKiB2YWxpZGF0aW9uXG5cdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblx0dmFsaWRhdGU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kLCB0aGlzLl9vblRyYW5zaXRpb25FbmQsIGZhbHNlKTtcblx0XHR0aGlzLl9pZ25vcmVFdmVudCA9IHRydWU7XG5cblx0XHRpZiAodGhpcy5fY2FwdHVyZUludmFsaWQpIHtcblx0XHRcdHZhciBsYXN0WCA9ICh0aGlzLl9yZW5kZXJlZFggIT09IG51bGwgPyB0aGlzLl9yZW5kZXJlZFggOiB0aGlzLl9jYXB0dXJlZFgpLFxuXHRcdFx0XHRsYXN0WSA9ICh0aGlzLl9yZW5kZXJlZFkgIT09IG51bGwgPyB0aGlzLl9yZW5kZXJlZFkgOiB0aGlzLl9jYXB0dXJlZFkpO1xuXG5cdFx0XHQvLyB0aGlzLl92YWxpZGF0ZVRyYW5zaXRpb24oKTtcblx0XHRcdHRoaXMuX3ZhbGlkYXRlQ2FwdHVyZSgpO1xuXHRcdFx0dGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblxuXHRcdFx0dmFyIGN1cnJYID0gKHRoaXMuX3JlbmRlcmVkWCAhPT0gbnVsbCA/IHRoaXMuX3JlbmRlcmVkWCA6IHRoaXMuX2NhcHR1cmVkWCksXG5cdFx0XHRcdGN1cnJZID0gKHRoaXMuX3JlbmRlcmVkWSAhPT0gbnVsbCA/IHRoaXMuX3JlbmRlcmVkWSA6IHRoaXMuX2NhcHR1cmVkWSk7XG5cblx0XHRcdGlmIChsYXN0WCA9PT0gY3VyclggJiYgbGFzdFkgPT09IGN1cnJZKSB7XG5cdFx0XHRcdHRoaXMuX2hhc1RyYW5zaXRpb24gJiYgY29uc29sZS53YXJuKFwidHhbJXNdOjp2YWxpZGF0ZSB1bmNoYW5nZWQ6IGxhc3Q6WyVpLCVpXSBjdXJyOlslaSwlaV1cIiwgdGhpcy5lbC5pZCB8fCB0aGlzLmlkLCBsYXN0WCwgbGFzdFksIGN1cnJYLCBjdXJyWSk7XG5cdFx0XHRcdC8vIGNvbnNvbGUuaW5mbyhcInR4WyVzXTo6dmFsaWRhdGUgdW5jaGFuZ2VkOiBsYXN0OlslZiwlZl0gY3VycjpbJWYsJWZdIHJlbmRlcjpbJWYsJWZdIGNhcHR1cmVkWyVmLCVmXVwiLCB0aGlzLmVsLmlkIHx8IHRoaXMuaWQsIGxhc3RYLCBsYXN0WSwgY3VyclgsIGN1cnJZLCB0aGlzLl9yZW5kZXJlZFgsIHRoaXMuX3JlbmRlcmVkWSwgdGhpcy5fY2FwdHVyZWRYLCB0aGlzLl9jYXB0dXJlZFkpO1xuXHRcdFx0XHR0aGlzLmNsZWFyVHJhbnNpdGlvbigpO1xuXHRcdFx0XHQvLyB0aGlzLl92YWxpZGF0ZVRyYW5zaXRpb24oKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3ZhbGlkYXRlVHJhbnNpdGlvbigpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyB0aGlzLl92YWxpZGF0ZUNhcHR1cmUoKTtcblx0XHRcdHRoaXMuX3ZhbGlkYXRlVHJhbnNpdGlvbigpO1xuXHRcdFx0dGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblx0XHR9XG5cblx0XHQvLyB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIodHJhbnNpdGlvbkVuZCwgdGhpcy5fb25UcmFuc2l0aW9uRW5kLCBmYWxzZSk7XG5cdFx0dGhpcy5faWdub3JlRXZlbnQgPSBmYWxzZTtcblxuXHRcdC8vIGlmICh0aGlzLl9jYXB0dXJlZENoYW5nZWQpIHtcblx0XHQvLyBcdGNvbnNvbGUuZXJyb3IoXCJ0eFslc106OnZhbGlkYXRlIGNhcHR1cmUgY2hhbmdlZDogWyVmLCVmXVwiLCB0aGlzLmlkLCB0aGlzLl9jYXB0dXJlZFgsIHRoaXMuX2NhcHR1cmVkWSk7XG5cdFx0Ly8gfVxuXHRcdHRoaXMuX2NhcHR1cmVkQ2hhbmdlZCA9IGZhbHNlO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogUHJpdmF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X3ZhbGlkYXRlQ2FwdHVyZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCF0aGlzLl9jYXB0dXJlSW52YWxpZCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHQvLyB2YXIgY29tcHV0ZWQsIGNhcHR1cmVkVmFsdWVzO1xuXHRcdHZhciB0cmFuc2Zvcm1WYWx1ZSA9IG51bGw7XG5cblx0XHRpZiAodGhpcy5faGFzT2Zmc2V0ICYmICF0aGlzLl9vZmZzZXRJbnZhbGlkKSB7XG5cdFx0XHQvLyB0aGlzIGlzIGFuIGV4cGxpY2l0IGNhbGwgdG8gY2FwdHVyZSgpIGluc3RlYWQgb2YgYSBzdWJjYWxsIGZyb20gX3ZhbGlkYXRlT2Zmc2V0KClcblx0XHRcdHRyYW5zZm9ybVZhbHVlID0gdGhpcy5fZ2V0Q1NTUHJvcChcInRyYW5zZm9ybVwiKTtcblx0XHRcdGlmICh0cmFuc2Zvcm1WYWx1ZSA9PT0gXCJcIikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKFwidHhbJXNdOjpfY2FwdHVyZSB2YWxpZCBvZmZzZXQgKCVpLCRpKSBidXQgdHJhbnNmb3JtVmFsdWU9XFxcIlxcXCJcIiwgdGhpcy5pZCwgdGhpcy5fb2Zmc2V0WCwgdGhpcy5fb2Zmc2V0WSk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl9yZW1vdmVDU1NQcm9wKFwidHJhbnNmb3JtXCIpO1xuXHRcdH1cblxuXHRcdC8vIE5PVEU6IHJldXNpbmcgb2JqZWN0LCBhbGwgcHJvcHMgd2lsbCBiZSBvdmVyd3JpdHRlblxuXHRcdHRoaXMuX2xhc3RDYXB0dXJlID0gdGhpcy5fY3VyckNhcHR1cmU7XG5cdFx0dGhpcy5fY3VyckNhcHR1cmUgPSB0aGlzLl9nZXRDb21wdXRlZENTU1Byb3BzKCk7XG5cblx0XHRpZiAodGhpcy5fY3VyckNhcHR1cmUudHJhbnNmb3JtICE9PSB0aGlzLl9sYXN0Q2FwdHVyZS50cmFuc2Zvcm0pIHtcblx0XHRcdHZhciBtLCBtbTsgLy8sIHJldCA9IHt9O1xuXHRcdFx0bW0gPSB0aGlzLl9jdXJyQ2FwdHVyZS50cmFuc2Zvcm0ubWF0Y2goLyhtYXRyaXh8bWF0cml4M2QpXFwoKFteXFwpXSspXFwpLyk7XG5cdFx0XHRpZiAobW0pIHtcblx0XHRcdFx0bSA9IG1tWzJdLnNwbGl0KFwiLFwiKTtcblx0XHRcdFx0aWYgKG1tWzFdID09PSBcIm1hdHJpeFwiKSB7XG5cdFx0XHRcdFx0dGhpcy5fY2FwdHVyZWRYID0gcGFyc2VGbG9hdChtWzRdKTtcblx0XHRcdFx0XHR0aGlzLl9jYXB0dXJlZFkgPSBwYXJzZUZsb2F0KG1bNV0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuX2NhcHR1cmVkWCA9IHBhcnNlRmxvYXQobVsxMl0pO1xuXHRcdFx0XHRcdHRoaXMuX2NhcHR1cmVkWSA9IHBhcnNlRmxvYXQobVsxM10pO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLl9jYXB0dXJlZFggPSAwO1xuXHRcdFx0XHR0aGlzLl9jYXB0dXJlZFkgPSAwO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5fY2FwdHVyZWRDaGFuZ2VkID0gdHJ1ZTtcblx0XHR9XG5cdFx0aWYgKHRyYW5zZm9ybVZhbHVlICE9PSBudWxsKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcInR4WyVzXTo6X2NhcHR1cmUgcmVhcHBseWluZyAnJXMnXCIsIHRoaXMuaWQsIHRyYW5zZm9ybVZhbHVlKTtcblx0XHRcdHRoaXMuX3NldENTU1Byb3AoXCJ0cmFuc2Zvcm1cIiwgdHJhbnNmb3JtVmFsdWUpO1xuXHRcdH1cblx0XHR0aGlzLl9jYXB0dXJlSW52YWxpZCA9IGZhbHNlO1xuXHR9LFxuXG5cdF92YWxpZGF0ZU9mZnNldDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX29mZnNldEludmFsaWQpIHtcblx0XHRcdC8vIHRoaXMuX3ZhbGlkYXRlQ2FwdHVyZSgpO1xuXHRcdFx0dGhpcy5fb2Zmc2V0SW52YWxpZCA9IGZhbHNlO1xuXHRcdFx0aWYgKHRoaXMuX2hhc09mZnNldCkge1xuXHRcdFx0XHR2YXIgdHggPSB0aGlzLl9vZmZzZXRYICsgdGhpcy5fY2FwdHVyZWRYO1xuXHRcdFx0XHR2YXIgdHkgPSB0aGlzLl9vZmZzZXRZICsgdGhpcy5fY2FwdHVyZWRZO1xuXHRcdFx0XHRpZiAodHggIT09IHRoaXMuX3JlbmRlcmVkWCB8fCB0eSAhPT0gdGhpcy5fcmVuZGVyZWRZKSB7XG5cdFx0XHRcdFx0dGhpcy5fcmVuZGVyZWRYID0gdHg7XG5cdFx0XHRcdFx0dGhpcy5fcmVuZGVyZWRZID0gdHk7XG5cdFx0XHRcdFx0dGhpcy5fc2V0Q1NTUHJvcChcInRyYW5zZm9ybVwiLCB0cmFuc2xhdGVUZW1wbGF0ZSh0aGlzKSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuX3JlbmRlcmVkWCA9IG51bGw7XG5cdFx0XHRcdHRoaXMuX3JlbmRlcmVkWSA9IG51bGw7XG5cdFx0XHRcdHRoaXMuX3JlbW92ZUNTU1Byb3AoXCJ0cmFuc2Zvcm1cIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF92YWxpZGF0ZVRyYW5zaXRpb246IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl90cmFuc2l0aW9uSW52YWxpZCkge1xuXHRcdFx0Ly8gdGhpcy5fdmFsaWRhdGVDYXB0dXJlKCk7XG5cdFx0XHR0aGlzLl90cmFuc2l0aW9uSW52YWxpZCA9IGZhbHNlO1xuXG5cdFx0XHQvLyBzYXZlIHByb21pc2VzIG1hZGUgd2hpbGUgaW52YWxpZFxuXHRcdFx0dmFyIHJlamVjdCA9IHRoaXMuX3Byb21pc2VzO1xuXHRcdFx0Ly8gcHJlcGFyZSBfcHJvbWlzZXMgYW5kIHB1c2ggaW4gbmV3IG9uZXNcblx0XHRcdHRoaXMuX3Byb21pc2VzID0gdGhpcy5fcGVuZGluZ1Byb21pc2VzO1xuXHRcdFx0Ly8gd2hhdGV2ZXIgc3RpbGwgaGVyZSBpcyB0byBiZSByZWplY3RlZC4gcmV1c2UgYXJyYXlcblx0XHRcdHRoaXMuX3BlbmRpbmdQcm9taXNlcyA9IHJlamVjdEFsbChyZWplY3QsIHRoaXMpO1xuXG5cdFx0XHQvLyBTZXQgcnVubmluZyBmbGFnLCBpZiB0aGVyZSdzIGEgdHJhbnNpdGlvbiB0byBydW5cblx0XHRcdHRoaXMuX3RyYW5zaXRpb25SdW5uaW5nID0gdGhpcy5faGFzVHJhbnNpdGlvbjtcblx0XHRcdC8vIFNldCB0aGUgY3NzIHZhbHVlICh3aGljaCB3aWxsIGJlIGVtcHR5IHN0cmluZyBpZiB0aGVyZSdzIG5vIHRyYW5zaXRpb24pXG5cdFx0XHR0aGlzLl9zZXRDU1NQcm9wKFwidHJhbnNpdGlvblwiLCB0aGlzLl90cmFuc2l0aW9uVmFsdWUpO1xuXHRcdFx0aWYgKERFQlVHKSB7XG5cdFx0XHRcdGlmICh0aGlzLl9oYXNUcmFuc2l0aW9uKSB7XG5cdFx0XHRcdFx0dGhpcy5lbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR4XCIsIHRoaXMuX3RyYW5zaXRpb24ubmFtZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblxuXHRcdFx0aWYgKCF0aGlzLl9oYXNUcmFuc2l0aW9uKSB7XG5cdFx0XHRcdC8vIGlmIHRoZXJlIGlzIG5vIHRyYW5zaXRpb24sIHJlc29sdmUgcHJvbWlzZXMgbm93XG5cdFx0XHRcdHJlc29sdmVBbGwodGhpcy5fcHJvbWlzZXMsIHRoaXMpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRfb25UcmFuc2l0aW9uRW5kOiBmdW5jdGlvbihldikge1xuXHRcdGlmICh0aGlzLl9pZ25vcmVFdmVudCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fdHJhbnNpdGlvblJ1bm5pbmcgJiYgKHRoaXMuZWwgPT09IGV2LnRhcmdldCkgJiZcblx0XHRcdCh0aGlzLl90cmFuc2l0aW9uLnByb3BlcnR5ID09IGV2LnByb3BlcnR5TmFtZSkpIHtcblx0XHRcdHRoaXMuX2hhc1RyYW5zaXRpb24gPSBmYWxzZTtcblx0XHRcdHRoaXMuX3RyYW5zaXRpb25SdW5uaW5nID0gZmFsc2U7XG5cdFx0XHR0aGlzLl9yZW1vdmVDU1NQcm9wKFwidHJhbnNpdGlvblwiKTtcblx0XHRcdHJlc29sdmVBbGwodGhpcy5fcHJvbWlzZXMsIHRoaXMpO1xuXG5cdFx0XHRpZiAoREVCVUcpIHtcblx0XHRcdFx0aWYgKHRoaXMuZWwuaGFzQXR0cmlidXRlKFwiZGF0YS10eFwiKSkge1xuXHRcdFx0XHRcdC8vIHRoaXMuZWwuc2V0QXR0cmlidXRlKFwiZGF0YS10eC1sYXN0XCIsIHRoaXMuZWwuZ2V0QXR0cmlidXRlKFwiZGF0YS10eFwiKSk7XG5cdFx0XHRcdFx0dGhpcy5lbC5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXR4XCIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogQ1NTXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfZ2V0Q1NTUHJvcDogZnVuY3Rpb24ocHJvcCkge1xuXHRcdHJldHVybiB0aGlzLmVsLnN0eWxlW3Byb3BOYW1lc1twcm9wXV07XG5cdFx0Ly8gcmV0dXJuIHRoaXMuZWwuc3R5bGVbcHJlZml4ZWRQcm9wZXJ0eShwcm9wKV07XG5cdFx0Ly8gcmV0dXJuIHRoaXMuZWwuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShzdHlsZU5hbWVzW3Byb3BdKTtcblx0fSxcblxuXHRfc2V0Q1NTUHJvcDogZnVuY3Rpb24ocHJvcCwgdmFsdWUpIHtcblx0XHRpZiAocHJvcCA9PT0gXCJ0cmFuc2l0aW9uXCIgJiYgdmFsdWUgPT0gTk9fVFJBTlNJVElPTl9WQUxVRSkge1xuXHRcdFx0dmFsdWUgPSBcIlwiO1xuXHRcdH1cblx0XHRpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCB8fCB2YWx1ZSA9PT0gXCJcIikge1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ1NTUHJvcChwcm9wKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5lbC5zdHlsZVtwcm9wTmFtZXNbcHJvcF1dID0gdmFsdWU7XG5cdFx0XHQvLyB0aGlzLmVsLnN0eWxlLnNldFByb3BlcnR5KHN0eWxlTmFtZXNbcHJvcF0sIHZhbHVlKTtcblx0XHR9XG5cdH0sXG5cblx0X3JlbW92ZUNTU1Byb3A6IGZ1bmN0aW9uKHByb3ApIHtcblx0XHR0aGlzLmVsLnN0eWxlW3Byb3BOYW1lc1twcm9wXV0gPSBcIlwiO1xuXHRcdC8vIHRoaXMuZWwuc3R5bGUucmVtb3ZlUHJvcGVydHkoc3R5bGVOYW1lc1twcm9wXSk7XG5cdH0sXG5cblx0X2dldENvbXB1dGVkQ1NTUHJvcHM6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB2YWx1ZXMgPSB7fTtcblx0XHR2YXIgY29tcHV0ZWQgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsKTtcblx0XHRmb3IgKHZhciBwIGluIHByb3BOYW1lcykge1xuXHRcdFx0dmFsdWVzW3BdID0gY29tcHV0ZWRbcHJvcE5hbWVzW3BdXTtcblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlcztcblx0fSxcbn0sIHtcblx0dHJhbnNpdGlvbjoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fdHJhbnNpdGlvbjtcblx0XHR9XG5cdH0sXG5cdGhhc1RyYW5zaXRpb246IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2hhc1RyYW5zaXRpb247XG5cdFx0fVxuXHR9LFxuXHRjYXB0dXJlZENoYW5nZWQ6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2NhcHR1cmVkQ2hhbmdlZDtcblx0XHR9XG5cdH0sXG5cdGNhcHR1cmVkWDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fY2FwdHVyZWRYO1xuXHRcdH1cblx0fSxcblx0Y2FwdHVyZWRZOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9jYXB0dXJlZFk7XG5cdFx0fVxuXHR9LFxuXG5cdGhhc09mZnNldDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5faGFzT2Zmc2V0O1xuXHRcdH1cblx0fSxcblx0b2Zmc2V0WDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fb2Zmc2V0WDtcblx0XHR9XG5cdH0sXG5cdG9mZnNldFk6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX29mZnNldFk7XG5cdFx0fVxuXHR9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gVHJhbnNmb3JtSXRlbTsiLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGExLCBhMiwgZGVzdCkge1xuXHRyZXR1cm4gYTEucmVkdWNlKGZ1bmN0aW9uKHJlcywgbywgaSwgYSkge1xuXHRcdGlmIChhMi5pbmRleE9mKG8pID09IC0xKSByZXMucHVzaChvKTtcblx0XHRyZXR1cm4gcmVzO1xuXHR9LCAoZGVzdCAhPT0gdm9pZCAwKSA/IGRlc3QgOiBbXSk7XG59OyIsInZhciBQSTIgPSBNYXRoLlBJICogMjtcblxudmFyIHNwbGljZSA9IEFycmF5LnByb3RvdHlwZS5zcGxpY2U7XG4vLyB2YXIgY29uY2F0ID0gQXJyYXkucHJvdG90eXBlLmNvbmNhdDtcblxudmFyIF9tb2QgPSBmdW5jdGlvbihuLCBtKSB7XG5cdHJldHVybiAoKG4gJSBtKSArIG0pICUgbTtcbn07XG5cbnZhciBzZXRTdHlsZSA9IGZ1bmN0aW9uKGN0eCwgcykge1xuXHRpZiAodHlwZW9mIHMgIT0gXCJvYmplY3RcIikgcmV0dXJuO1xuXHRmb3IgKHZhciBwIGluIHMpIHtcblx0XHRzd2l0Y2ggKHR5cGVvZiBjdHhbcF0pIHtcblx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkoc1twXSkpIGN0eFtwXS5hcHBseShjdHgsIHNbcF0pO1xuXHRcdFx0XHRlbHNlIGN0eFtwXS5jYWxsKGN0eCwgc1twXSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0Y3R4W3BdID0gc1twXTtcblx0XHR9XG5cdH1cbn07XG5cbnZhciBfZHJhd1NoYXBlID0gZnVuY3Rpb24oZm4sIHMsIGN0eCkge1xuXHRjdHguc2F2ZSgpO1xuXHRpZiAocykgc2V0U3R5bGUoY3R4LCBzKTtcblx0Zm4uYXBwbHkobnVsbCwgc3BsaWNlLmNhbGwoYXJndW1lbnRzLCAyKSk7XG5cdGlmIChjdHgubGluZVdpZHRoICE9PSBcInRyYW5zcGFyZW50XCIpIGN0eC5zdHJva2UoKTtcblx0aWYgKGN0eC5maWxsU3R5bGUgIT09IFwidHJhbnNwYXJlbnRcIikgY3R4LmZpbGwoKTtcblx0Y3R4LnJlc3RvcmUoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXHRzZXRTdHlsZTogc2V0U3R5bGUsXG5cblx0dkd1aWRlOiBmdW5jdGlvbihjdHgsIHgpIHtcblx0XHRjdHguYmVnaW5QYXRoKCk7XG5cdFx0Y3R4Lm1vdmVUbyh4LCAwKTtcblx0XHRjdHgubGluZVRvKHgsIGN0eC5jYW52YXMuaGVpZ2h0KTtcblx0fSxcblx0ZHJhd1ZHdWlkZTogZnVuY3Rpb24oY3R4LCBzLCB4KSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLnZHdWlkZSwgcywgY3R4LCB4KTtcblx0fSxcblxuXHRoR3VpZGU6IGZ1bmN0aW9uKGN0eCwgeSkge1xuXHRcdGN0eC5iZWdpblBhdGgoKTtcblx0XHRjdHgubW92ZVRvKDAsIHkpO1xuXHRcdGN0eC5saW5lVG8oY3R4LmNhbnZhcy53aWR0aCwgeSk7XG5cdH0sXG5cdGRyYXdIR3VpZGU6IGZ1bmN0aW9uKGN0eCwgcywgeSkge1xuXHRcdF9kcmF3U2hhcGUodGhpcy5oR3VpZGUsIHMsIGN0eCwgeSk7XG5cdH0sXG5cblx0Y3Jvc3NoYWlyOiBmdW5jdGlvbihjdHgsIHgsIHksIHIpIHtcblx0XHRjdHguc2F2ZSgpO1xuXHRcdGN0eC50cmFuc2xhdGUoeCwgeSk7XG5cdFx0Y3R4LnJvdGF0ZShNYXRoLlBJIC8gNCk7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5tb3ZlVG8oMCwgLXIpO1xuXHRcdGN0eC5saW5lVG8oMCwgcik7XG5cdFx0Y3R4Lm1vdmVUbygtciwgMCk7XG5cdFx0Y3R4LmxpbmVUbyhyLCAwKTtcblx0XHRjdHgucmVzdG9yZSgpO1xuXHR9LFxuXHRkcmF3Q3Jvc3NoYWlyOiBmdW5jdGlvbihjdHgsIHMsIHgsIHksIHIpIHtcblx0XHRfZHJhd1NoYXBlKHRoaXMuY3Jvc3NoYWlyLCBzLCBjdHgsIHgsIHksIHIpO1xuXHR9LFxuXG5cdGNpcmNsZTogZnVuY3Rpb24oY3R4LCB4LCB5LCByKSB7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5hcmMoeCwgeSwgciwgMCwgUEkyKTtcblx0fSxcblx0ZHJhd0NpcmNsZTogZnVuY3Rpb24oY3R4LCBzLCB4LCB5LCByKSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLmNpcmNsZSwgcywgY3R4LCB4LCB5LCByKTtcblx0fSxcblxuXHRzcXVhcmU6IGZ1bmN0aW9uKGN0eCwgeCwgeSwgcikge1xuXHRcdHIgPSBNYXRoLmZsb29yKHIgLyAyKSAqIDI7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5yZWN0KHggLSByLCB5IC0gciwgciAqIDIsIHIgKiAyKTtcblx0fSxcblx0ZHJhd1NxdWFyZTogZnVuY3Rpb24oY3R4LCBzLCB4LCB5LCByKSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLnNxdWFyZSwgcywgY3R4LCB4LCB5LCByKTtcblx0fSxcblxuXHQvKiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yOTU4ODQwNC91c2luZy1qYXZhc2NyaXB0LXRvLWNvbnZlcnQtcmFkaWFucy10by1kZWdyZWVzLXdpdGgtcG9zaXRpdmUtYW5kLW5lZ2F0aXZlLXZhbHVlc1xuXHRcdCgoKHIgKiAoMTgwL01hdGguUEkpKSAlIDM2MCkgKyAzNjApICUgMzYwO1xuXHRcdGZ1bmN0aW9uIG1vZChuLCBtKSB7XG4gIHJldHVybiAoKG4gJSBtKSArIG0pICUgbTtcbn1cblx0Ki9cblxuXHRhcnJvd2hlYWQ6IGZ1bmN0aW9uKGN0eCwgeCwgeSwgciwgdCkge1xuXHRcdGN0eC5zYXZlKCk7XG5cdFx0Y3R4LnRyYW5zbGF0ZSh4LCB5KTtcblx0XHRjdHgucm90YXRlKF9tb2QodCwgUEkyKSk7XG5cdFx0Y3R4LnRyYW5zbGF0ZShyICogMC41LCAwKTtcblx0XHRjdHguYmVnaW5QYXRoKCk7XG5cdFx0Y3R4Lm1vdmVUbygwLCAwKTtcblx0XHQvLyBjdHgubGluZVRvKC1yLCByICogTWF0aC5TUVJUMV8yKTtcblx0XHQvLyBjdHgubGluZVRvKC1yLCAtciAqIE1hdGguU1FSVDFfMik7XG5cdFx0Y3R4LmxpbmVUbygtciAqIE1hdGguU1FSVDIsIHIgKiBNYXRoLlNRUlQxXzIpO1xuXHRcdGN0eC5hcmNUbygwLCAwLCAtciAqIE1hdGguU1FSVDIsIC1yICogTWF0aC5TUVJUMV8yLCByKTtcblx0XHQvLyBjdHgucXVhZHJhdGljQ3VydmVUbygwLCAwLCAtciAqIE1hdGguU1FSVDIsIC1yICogTWF0aC5TUVJUMV8yKTtcblx0XHRjdHgubGluZVRvKDAsIDApO1xuXHRcdGN0eC5jbG9zZVBhdGgoKTtcblx0XHRjdHgucmVzdG9yZSgpO1xuXHR9LFxuXHRkcmF3QXJyb3doZWFkOiBmdW5jdGlvbihjdHgsIHMsIHgsIHksIHIsIHQpIHtcblx0XHRfZHJhd1NoYXBlKHRoaXMuYXJyb3doZWFkLCBzLCBjdHgsIHgsIHksIHIsIHQpO1xuXHR9LFxuXG5cdHJlY3Q6IGZ1bmN0aW9uKGN0eCwgYTEsIGEyLCBhMywgYTQpIHtcblxuXHRcdGN0eC5iZWdpblBhdGgoKTtcblx0XHRpZiAoaXNOYU4oYTEpKSB7XG5cdFx0XHRjdHgucmVjdChhMS5sZWZ0LCBhMS50b3AsIGExLndpZHRoLCBhMS5oZWlnaHQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjdHgucmVjdChhMSwgYTIsIGEzLCBhNCk7XG5cdFx0fVxuXHR9LFxuXHRkcmF3UmVjdDogZnVuY3Rpb24oY3R4LCBzLCBhMSwgYTIsIGEzLCBhNCkge1xuXHRcdF9kcmF3U2hhcGUodGhpcy5yZWN0LCBzLCBjdHgsIGExLCBhMiwgYTMsIGE0KTtcblx0fSxcbn07IiwiLyoqXG4gKiBAbW9kdWxlIHV0aWxzL2NhbnZhcy9jYWxjQXJjSENvbm5lY3RvclxuICovXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oeDEsIHkxLCByMSwgeDIsIHkyLCByMiwgcm8pIHtcblx0dmFyIHF4ID0geDIgPiB4MSA/IDEgOiAtMTtcblx0dmFyIHF5ID0geTIgPiB5MSA/IDEgOiAtMTtcblx0dmFyIGR5ID0gTWF0aC5hYnMoeTIgLSB5MSk7XG5cdHZhciBkeCA9IE1hdGguYWJzKHgyIC0geDEpO1xuXHR2YXIgcnIgPSByMSArIHIyO1xuXHR2YXIgdHgxLCB0eDIsIGMsIHR4LCB0eTtcblxuXHRpZiAoZHkgPCAxKSB7XG5cdFx0Ly8gcG9pbnRzIGFyZSBhbGlnbmVkIGhvcml6b250YWxseSwgbm8gYXJjcyBuZWVkZWRcblx0XHR0eDEgPSAwO1xuXHRcdHR4MiA9IGR4XG5cdFx0Ly8gcmV0dXJuIFt4MSwgeDJdO1xuXHR9XG5cblx0aWYgKGR5ID49IHJyICYmIGR4ID49IHJyKSB7XG5cdFx0Ly8gYXJjcyBmaXQgaG9yaXpvbnRhbGx5OlxuXHRcdC8vIHNlY29uZCBjaXJjbGUgY2VudGVyIGlzIHIxK3IyLCB0YW5nZW50IGludGVyc2VjdCBhdCB4PXIxXG5cdFx0YyA9IHJyO1xuXHRcdHR4MSA9IHIxO1xuXHRcdHR4MiA9IHIxO1xuXHR9IGVsc2Uge1xuXHRcdC8vIGFyY3Mgb3ZlcmxhcCBob3Jpem9udGFsbHk6XG5cdFx0Ly8gZmluZCBzZWNvbmQgY2lyY2xlIGNlbnRlclxuXHRcdGMgPSBNYXRoLnNxcnQoZHkgKiByMiAqIDIgKyBkeSAqIHIxICogMiAtIGR5ICogZHkpO1xuXG5cdFx0Ly8gY2lyY2xlcyB0YW5nZW50IHBvaW50XG5cdFx0dHggPSAoYyAqIHIxKSAvIHJyO1xuXHRcdHR5ID0gKGR5ICogcjEpIC8gcnI7XG5cblx0XHRpZiAocjEgPCB0eSB8fCBjID4gZHgpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyB0YW5nZW50IHBlcnBlbmRpY3VsYXIgc2xvcGVcblx0XHR2YXIgc2xvcGUgPSAocnIgLSBkeSkgLyBjO1xuXHRcdC8vIHRhbmdlbnQgaW50ZXJzZWN0aW9uc1xuXHRcdHR4MSA9IHR4IC0gKHR5ICogc2xvcGUpO1xuXHRcdHR4MiA9IChkeSAqIHNsb3BlKSArIHR4MTtcblxuXHRcdC8qXG5cdFx0Ly8gY2lyY2xlIGNlbnRlcnNcblx0XHR2YXIgY2N4MSwgY2N5MSwgY2N4MiwgY2N5Mjtcblx0XHRjY3gxID0gMDtcblx0XHRjY3kxID0gcjE7XG5cdFx0Y2N4MiA9IGM7XG5cdFx0Y2N5MiA9IGR5IC0gcjI7XG5cdFx0Ly8gdGFuZ2VudCBwZXJwZW5kaWN1bGFyIHNsb3BlXG5cdFx0dmFyIHNsb3BlID0gKGNjeTEgLSBjY3kyKSAvIChjY3gyIC0gY2N4MSk7XG5cdFx0dmFyIHhTZWMgPSB0eCAtICh0eSAqIHNsb3BlKTtcblx0XHQvLyB0YW5nZW50IGludGVyc2VjdGlvbnNcblx0XHR0eDEgPSB4U2VjO1xuXHRcdHR4MiA9IChkeSAqIHNsb3BlKSArIHhTZWM7XG5cdFx0Ki9cblx0fVxuXG5cdC8vIG9mZnNldCBhcmNUbydzIGluIHgtYXhpc1xuXHRpZiAocm8gPiAwKSB7XG5cdFx0aWYgKHJvID4gMSkge1xuXHRcdFx0cm8gPSBNYXRoLm1pbihkeCAtIHJyLCBybyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJvICo9IGR4IC0gcnI7XG5cdFx0fVxuXHRcdHR4MSArPSBybztcblx0XHR0eDIgKz0gcm87XG5cdH1cblxuXHRyZXR1cm4gW3R4MSAqIHF4ICsgeDEsIHR4MiAqIHF4ICsgeDEsIHR4MSwgdHgyXTtcbn07XG5cbi8qXG52YXIgZHJhd0FyY0Nvbm5lY3RvciA9IGZ1bmN0aW9uKGN0eCwgeDEsIHkxLCB4MiwgeTIsIHIpIHtcblx0dmFyIGR4LCBkeSwgaHgsIGh5LCBneCwgZ3k7XG5cblx0aHggPSAwO1xuXHRoeSA9IDA7XG5cdGd4ID0gKHgxICsgeDIpIC8gMjtcblx0Z3kgPSAoeTEgKyB5MikgLyAyO1xuXHRkeCA9IE1hdGguYWJzKHgxIC0gZ3gpO1xuXHRkeSA9IE1hdGguYWJzKHkxIC0gZ3kpO1xuXG5cdGlmIChkeCA8IHIgJiYgZHkgPCByKSB7XG5cdFx0ciA9IE1hdGgubWluKGR4ICogTWF0aC5TUVJUMV8yLCBkeSAqIE1hdGguU1FSVDFfMik7XG5cdH0gZWxzZSB7XG5cdFx0aWYgKGR4IDwgcikge1xuXHRcdFx0aHkgPSBNYXRoLmFjb3MoZHggLyByKSAqIHIgKiAwLjU7XG5cdFx0XHRpZiAoeTEgPiB5MikgaHkgKj0gLTE7XG5cdFx0fVxuXHRcdGlmIChkeSA8IHIpIHtcblx0XHRcdGh4ID0gTWF0aC5hY29zKGR5IC8gcikgKiByICogMC41O1xuXHRcdFx0aWYgKHgxID4geDIpIGh4ICo9IC0xO1xuXHRcdH1cblx0fVxuXHRjdHguYXJjVG8oZ3ggLSBoeCwgeTEsIGd4ICsgaHgsIHkyLCByKTtcblx0Y3R4LmFyY1RvKGd4ICsgaHgsIHkyLCB4MiwgeTIsIHIpO1xufTtcblxudmFyIGRyYXdBcmNDb25uZWN0b3IyID0gZnVuY3Rpb24oY3R4LCB4MSwgeTEsIHgyLCB5Miwgcikge1xuXHR2YXIgZHgsIGR5LCBoeCwgaHksIGN4MSwgY3gyO1xuXG5cdGh4ID0gMDtcblx0aHkgPSAwO1xuXHRkeCA9IE1hdGguYWJzKHgyIC0geDEpIC8gMjtcblx0ZHkgPSBNYXRoLmFicyh5MSAtIHkyKSAvIDI7XG5cblx0aWYgKGR4IDwgciAmJiBkeSA8IHIpIHtcblx0XHRyID0gTWF0aC5taW4oZHggKiBNYXRoLlNRUlQxXzIsIGR5ICogTWF0aC5TUVJUMV8yKTtcblx0fSBlbHNlIHtcblx0XHRpZiAoZHggPCByKSB7XG5cdFx0XHRoeSA9IE1hdGguYWNvcyhkeCAvIHIpICogcjtcblx0XHR9XG5cdFx0aWYgKGR5IDwgcikge1xuXHRcdFx0aHggPSBNYXRoLmFjb3MoZHkgLyByKSAqIHI7XG5cdFx0fVxuXHR9XG5cdGN4MSA9IHgxICsgZHg7XG5cdGN4MiA9IHgyIC0gKGR4IC0gaHggLyAyKTtcblx0Y3R4LmFyY1RvKGN4MSwgeTEsIGN4MiwgeTIsIHIpO1xuXHRjdHguYXJjVG8oY3gyLCB5MiwgeDIsIHkyLCByKTtcbn07XG5cbnZhciBkcmF3QXJjQ29ubmVjdG9yMSA9IGZ1bmN0aW9uKGN0eCwgeDEsIHkxLCB4MiwgeTIsIHIpIHtcblx0dmFyIGR4LCBkeSwgY3g7XG5cblx0ZHggPSBNYXRoLmFicyh4MiAtIHgxKSAvIDI7XG5cdGR5ID0gTWF0aC5hYnMoeTEgLSB5MikgLyAyO1xuXHRyID0gTWF0aC5taW4ociwgZHkgKiBNYXRoLlNRUlQxXzIpO1xuXHRpZiAoeDEgPCB4Mikge1xuXHRcdGN4ID0geDEgKyBkeCArIHI7XG5cdH0gZWxzZSB7XG5cdFx0Y3ggPSB4MiAtIGR4IC0gcjtcblx0fVxuXHQvLyBjeCA9ICh4MiArIHgxKSAvIDI7XG5cdC8vIGN4ICs9IHgxIDwgeDIgPyByIDogLXI7XG5cblx0Y3R4LmFyY1RvKGN4LCB5MSwgY3gsIHkyLCByKTtcblx0Y3R4LmFyY1RvKGN4LCB5MiwgeDIsIHkyLCByKTtcbn07XG4qL1xuIiwiLyogZ2xvYmFsIEhUTUxFbGVtZW50LCBDU1NTdHlsZURlY2xhcmF0aW9uICovXG5cbi8vIHZhciBwYXJzZVNpemUgPSByZXF1aXJlKFwiLi9wYXJzZVNpemVcIik7XG5cbnZhciBDU1NfQk9YX1BST1BTID0gW1xuXHRcImJveFNpemluZ1wiLCBcInBvc2l0aW9uXCIsIFwib2JqZWN0Rml0XCJcbl07XG52YXIgQ1NTX0VER0VfUFJPUFMgPSBbXG5cdFwibWFyZ2luVG9wXCIsIFwibWFyZ2luQm90dG9tXCIsIFwibWFyZ2luTGVmdFwiLCBcIm1hcmdpblJpZ2h0XCIsXG5cdFwiYm9yZGVyVG9wV2lkdGhcIiwgXCJib3JkZXJCb3R0b21XaWR0aFwiLCBcImJvcmRlckxlZnRXaWR0aFwiLCBcImJvcmRlclJpZ2h0V2lkdGhcIixcblx0XCJwYWRkaW5nVG9wXCIsIFwicGFkZGluZ0JvdHRvbVwiLCBcInBhZGRpbmdMZWZ0XCIsIFwicGFkZGluZ1JpZ2h0XCIsXG5dO1xudmFyIENTU19QT1NfUFJPUFMgPSBbXCJ0b3BcIiwgXCJib3R0b21cIiwgXCJsZWZ0XCIsIFwicmlnaHRcIl07XG52YXIgQ1NTX1NJWkVfUFJPUFMgPSBbXCJ3aWR0aFwiLCBcImhlaWdodFwiLCBcIm1pbldpZHRoXCIsIFwibWluSGVpZ2h0XCIsIFwibWF4V2lkdGhcIiwgXCJtYXhIZWlnaHRcIl07XG52YXIgQ1NTX0FMTF9QUk9QUyA9IENTU19FREdFX1BST1BTLmNvbmNhdChDU1NfU0laRV9QUk9QUywgQ1NTX1BPU19QUk9QUyk7XG5cbi8vIHZhciBDT01QVVRFRF9QUk9QUyA9IFtcbi8vIFx0XCJjbGllbnRMZWZ0XCIsIFwiY2xpZW50VG9wXCIsIFwiY2xpZW50V2lkdGhcIiwgXCJjbGllbnRIZWlnaHRcIixcbi8vIFx0XCJvZmZzZXRMZWZ0XCIsIFwib2Zmc2V0VG9wXCIsIFwib2Zmc2V0V2lkdGhcIiwgXCJvZmZzZXRIZWlnaHRcIlxuLy8gXTtcbi8vIHZhciBvID0gXy5waWNrKGVsZW1lbnQsIGZ1bmN0aW9uKHZhbCkge1xuLy8gXHRyZXR1cm4gL14ob2Zmc2V0fGNsaWVudCkoTGVmdHxUb3B8V2lkdGh8SGVpZ2h0KS8udGVzdCh2YWwpO1xuLy8gfSk7XG5cbnZhciBjc3NEaW1lbnNpb25SRSA9IC9eKC0/W1xcZFxcLl0rKShweHxlbXxyZW0pJC87XG4vLyB2YXIgY3NzRGltUmUgPSAvXihbLVxcLjAtOV0rKShbcmVtXSspJC87XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocywgbSwgaW5jbHVkZVNpemVQb3MpIHtcblx0aWYgKHMgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuXHRcdHMgPSBnZXRDb21wdXRlZFN0eWxlKHMpO1xuXHR9XG5cdGlmIChERUJVRykge1xuXHRcdGlmICghKHMgaW5zdGFuY2VvZiBDU1NTdHlsZURlY2xhcmF0aW9uKSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGEgQ1NTU3R5bGVEZWNsYXJhdGlvbiBub3IgSFRNTEVsZW1lbnRcIik7XG5cdFx0fVxuXHR9XG5cdHZhciB2LCBwLCBpLCBpaSwgZW1QeCwgcmVtUHg7XG5cdG0gfHwgKG0gPSB7fSk7XG5cblx0ZW1QeCA9IG0uZm9udFNpemUgPSBwYXJzZUZsb2F0KHMuZm9udFNpemUpO1xuXG5cdGZvciAoaSA9IDAsIGlpID0gQ1NTX0JPWF9QUk9QUy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0cCA9IENTU19CT1hfUFJPUFNbaV07XG5cdFx0aWYgKHAgaW4gcykge1xuXHRcdFx0bVtwXSA9IHNbcF07XG5cdFx0fVxuXHR9XG5cdHZhciBjc3NQcm9wcyA9IGluY2x1ZGVTaXplUG9zID8gQ1NTX0VER0VfUFJPUFMgOiBDU1NfQUxMX1BST1BTO1xuXHRmb3IgKGkgPSAwLCBpaSA9IGNzc1Byb3BzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRwID0gY3NzUHJvcHNbaV07XG5cdFx0bVtcIl9cIiArIHBdID0gc1twXTtcblx0XHRpZiAoc1twXSAmJiAodiA9IGNzc0RpbWVuc2lvblJFLmV4ZWMoc1twXSkpKSB7XG5cdFx0XHRpZiAodlsyXSA9PT0gXCJweFwiKSB7XG5cdFx0XHRcdG1bcF0gPSBwYXJzZUZsb2F0KHZbMV0pO1xuXHRcdFx0fSBlbHNlIGlmICh2WzJdID09PSBcImVtXCIpIHtcblx0XHRcdFx0bVtwXSA9IHBhcnNlRmxvYXQodlsxXSkgKiBlbVB4O1xuXHRcdFx0fSBlbHNlIGlmICh2WzJdID09PSBcInJlbVwiKSB7XG5cdFx0XHRcdHJlbVB4IHx8IChyZW1QeCA9IHBhcnNlRmxvYXQoZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLmZvbnRTaXplKSk7XG5cdFx0XHRcdG1bcF0gPSBwYXJzZUZsb2F0KHZbMV0pICogcmVtUHg7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJJZ25vcmluZyB2YWx1ZVwiLCBwLCB2WzFdLCB2WzJdKTtcblx0XHRcdFx0bVtwXSA9IG51bGw7XG5cdFx0XHR9XG5cdFx0fSAvLyBlbHNlIHtcblx0XHQvL1x0Y29uc29sZS53YXJuKFwiSWdub3JpbmcgdW5pdGxlc3MgdmFsdWVcIiwgcCwgdik7XG5cdFx0Ly99XG5cdH1cblx0cmV0dXJuIG07XG59O1xuIiwiLyoqXG4gKiBAcGFyYW0ge251bWJlcn0gaSBjdXJyZW50IGl0ZXJhdGlvblxuICogQHBhcmFtIHtudW1iZXJ9IHMgc3RhcnQgdmFsdWVcbiAqIEBwYXJhbSB7bnVtYmVyfSBkIGNoYW5nZSBpbiB2YWx1ZVxuICogQHBhcmFtIHtudW1iZXJ9IHQgdG90YWwgaXRlcmF0aW9uc1xuICogQHJldHVybiB7bnVtYmVyfVxuICovXG52YXIgbGluZWFyID0gZnVuY3Rpb24oaSwgcywgZCwgdCkge1xuXHRyZXR1cm4gZCAqIGkgLyB0ICsgcztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbGluZWFyO1xuIiwiLyogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvbWVkaWEuaHRtbCNldmVudC1tZWRpYS1jYW5wbGF5XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gW1xuXHQvLyBuZXR3b3JrU3RhdGVcblx0XCJsb2Fkc3RhcnRcIixcblx0XCJwcm9ncmVzc1wiLFxuXHRcInN1c3BlbmRcIixcblx0XCJhYm9ydFwiLFxuXHRcImVycm9yXCIsXG5cdFwiZW1wdGllZFwiLFxuXHRcInN0YWxsZWRcIixcblx0Ly8gcmVhZHlTdGF0ZVxuXHRcImxvYWRlZG1ldGFkYXRhXCIsXG5cdFwibG9hZGVkZGF0YVwiLFxuXHRcImNhbnBsYXlcIixcblx0XCJjYW5wbGF5dGhyb3VnaFwiLFxuXHRcInBsYXlpbmdcIixcblx0XCJ3YWl0aW5nXCIsXG5cdC8vXG5cdFwic2Vla2luZ1wiLCAvLyBzZWVraW5nIGNoYW5nZWQgdG8gdHJ1ZVxuXHRcInNlZWtlZFwiLCAvLyBzZWVraW5nIGNoYW5nZWQgdG8gZmFsc2Vcblx0XCJlbmRlZFwiLCAvLyBlbmRlZCBpcyB0cnVlXG5cdC8vXG5cdFwiZHVyYXRpb25jaGFuZ2VcIiwgLy8gZHVyYXRpb24gdXBkYXRlZFxuXHRcInRpbWV1cGRhdGVcIiwgLy8gY3VycmVudFRpbWUgdXBkYXRlZFxuXHRcInBsYXlcIiwgLy8gcGF1c2VkIGlzIGZhbHNlXG5cdFwicGF1c2VcIiwgLy8gcGF1c2VkIGlzIGZhbHNlXG5cdFwicGF1c2VkXCIsIC8vID8/XG5cdFwicmF0ZWNoYW5nZVwiLFxuXHQvL1xuXHRcInJlc2l6ZVwiLFxuXHRcInZvbHVtZWNoYW5nZVwiLFxuXTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L0dyYXBoVmlld1xuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG4vLyB2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHJlY3QsIGR4LCBkeSkge1xuXHRpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAyKSB7XG5cdFx0ZHkgPSBkeDtcblx0fVxuXHR2YXIgciA9IHtcblx0XHR3aWR0aDogcmVjdC53aWR0aCArIGR4ICogMixcblx0XHRoZWlnaHQ6IHJlY3QuaGVpZ2h0ICsgZHkgKiAyXG5cdH07XG5cdGlmIChyLndpZHRoID49IDApIHtcblx0XHRyLmxlZnQgPSByZWN0LmxlZnQgLSBkeDtcblx0XHRyLnJpZ2h0ID0gci5sZWZ0ICsgci53aWR0aDtcblx0XHRyLnggPSByLmxlZnQ7XG5cdH0gZWxzZSB7XG5cdFx0ci5yaWdodCA9IHJlY3QucmlnaHQgKyBkeDtcblx0XHRyLmxlZnQgPSByZWN0LnJpZ2h0IC0gci53aWR0aDtcblx0XHRyLnkgPSByLnJpZ2h0O1xuXHR9XG5cdGlmIChyLmhlaWdodCA+PSAwKSB7XG5cdFx0ci50b3AgPSByZWN0LnRvcCAtIGR5O1xuXHRcdHIuYm90dG9tID0gci50b3AgKyByLmhlaWdodDtcblx0XHRyLnkgPSByLnRvcDtcblx0fSBlbHNlIHtcblx0XHRyLmJvdHRvbSA9IHJlY3QuYm90dG9tICsgZHk7XG5cdFx0ci50b3AgPSByZWN0LmJvdHRvbSAtIHIuaGVpZ2h0O1xuXHRcdHIueSA9IHIuYm90dG9tO1xuXHR9XG5cblx0cmV0dXJuIHI7XG59OyIsIi8qKiBAdHlwZSB7QXJyYXl9IGxvd2VyY2FzZSBwcmVmaXhlcyAqL1xudmFyIGxjUHJlZml4ZXMgPSBbXCJcIl0uY29uY2F0KHJlcXVpcmUoXCIuL3ByZWZpeGVzXCIpKTtcblxuLyoqIEB0eXBlIHtBcnJheX0gY2FwaXRhbGl6ZWQgcHJlZml4ZXMgKi9cbnZhciB1Y1ByZWZpeGVzID0gbGNQcmVmaXhlcy5tYXAoZnVuY3Rpb24ocykge1xuXHRyZXR1cm4gKHMgPT09IFwiXCIpID8gcyA6IHMuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzLnN1YnN0cigxKTtcbn0pO1xuXG4vKiogQHR5cGUge09iamVjdH0gc3BlY2lmaWMgZXZlbnQgc29sdmVycyAqL1xudmFyIF9zb2x2ZXJzID0ge307XG5cbi8qKiBAdHlwZSB7T2JqZWN0fSBjYWNoZWQgdmFsdWVzICovXG52YXIgX2NhY2hlID0ge307XG5cbi8qKlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgVW5wcmVmaXhlZCBldmVudCBuYW1lXG4gKiBAcGFyYW0gez9PYmplY3R9IG9iaiBQcmVmaXggdGVzdCB0YXJnZXRcbiAqIEBwYXJhbSB7P1N0cmluZ30gdGVzdFByb3AgUHJveHkgcHJvcGVydHkgdG8gdGVzdCBwcmVmaXhlc1xuICogQHJldHVybiB7U3RyaW5nfG51bGx9XG4gKi9cbnZhciBfcHJlZml4ZWRFdmVudCA9IGZ1bmN0aW9uKG5hbWUsIG9iaiwgdGVzdFByb3ApIHtcblx0dmFyIHByZWZpeGVzID0gL15bQS1aXS8udGVzdChuYW1lKSA/IHVjUHJlZml4ZXMgOiBsY1ByZWZpeGVzO1xuXHRvYmogfHwgKG9iaiA9IGRvY3VtZW50KTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBwcmVmaXhlcy5sZW5ndGg7IGkrKykge1xuXHRcdGlmICh0ZXN0UHJvcCkge1xuXHRcdFx0aWYgKChwcmVmaXhlc1tpXSArIHRlc3RQcm9wKSBpbiBvYmopIHtcblx0XHRcdFx0cmV0dXJuIHByZWZpeGVzW2ldICsgbmFtZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKChcIm9uXCIgKyBwcmVmaXhlc1tpXSArIG5hbWUpIGluIG9iaikge1xuXHRcdFx0cmV0dXJuIHByZWZpeGVzW2ldICsgbmFtZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIG51bGw7XG59O1xuXG4vLyB0cmFuc2l0aW9uZW5kXG5fc29sdmVyc1tcInRyYW5zaXRpb25lbmRcIl0gPSBmdW5jdGlvbigpIHtcblx0dmFyIHByb3AsIHN0eWxlID0gZG9jdW1lbnQuYm9keS5zdHlsZSxcblx0XHRtYXAgPSB7XG5cdFx0XHRcInRyYW5zaXRpb25cIjogXCJ0cmFuc2l0aW9uZW5kXCIsXG5cdFx0XHRcIldlYmtpdFRyYW5zaXRpb25cIjogXCJ3ZWJraXRUcmFuc2l0aW9uRW5kXCIsXG5cdFx0XHRcIk1velRyYW5zaXRpb25cIjogXCJ0cmFuc2l0aW9uZW5kXCIsXG5cdFx0XHQvLyBcIm1zVHJhbnNpdGlvblwiIDogXCJNU1RyYW5zaXRpb25FbmRcIixcblx0XHRcdFwiT1RyYW5zaXRpb25cIjogXCJvVHJhbnNpdGlvbkVuZFwiXG5cdFx0fTtcblx0Zm9yIChwcm9wIGluIG1hcCkge1xuXHRcdGlmIChwcm9wIGluIHN0eWxlKSB7XG5cdFx0XHRyZXR1cm4gbWFwW3Byb3BdO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gbnVsbDtcbn07XG5cbi8qKlxuICogZ2V0IHRoZSBwcmVmaXhlZCBwcm9wZXJ0eVxuICogQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5IG5hbWVcbiAqIEBwYXJhbSB7T2JqZWN0fSBsb29rLXVwIG9iamVjdFxuICogQHJldHVybnMge1N0cmluZ3xudWxsfSBwcmVmaXhlZFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKGV2TmFtZSkge1xuXHRpZiAoIV9jYWNoZS5oYXNPd25Qcm9wZXJ0eShldk5hbWUpKSB7XG5cdFx0X2NhY2hlW2V2TmFtZV0gPSBfc29sdmVycy5oYXNPd25Qcm9wZXJ0eShldk5hbWUpID8gX3NvbHZlcnNbZXZOYW1lXSgpIDogX3ByZWZpeGVkRXZlbnQuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcblx0XHRpZiAoX2NhY2hlW2V2TmFtZV0gPT09IG51bGwpIHtcblx0XHRcdGNvbnNvbGUud2FybihcIkV2ZW50ICclcycgbm90IGZvdW5kXCIsIGV2TmFtZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiRXZlbnQgJyVzJyBmb3VuZCBhcyAnJXMnXCIsIGV2TmFtZSwgX2NhY2hlW2V2TmFtZV0pO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gX2NhY2hlW2V2TmFtZV07XG5cdC8vIHJldHVybiBfY2FjaGVbZXZOYW1lXSB8fCAoX2NhY2hlW2V2TmFtZV0gPSBfc29sdmVyc1tldk5hbWVdPyBfc29sdmVyc1tldk5hbWVdLmNhbGwoKSA6IF9wcmVmaXhlZFByb3BlcnR5LmFwcGx5KG51bGwsIGFyZ3VtZW50cykpO1xufTtcblxuLypcbnZhciBkZWZhdWx0VGVzdCA9IGZ1bmN0aW9uKG5hbWUsIG9iaikge1xuXHR2YXIgcHJlZml4ZXMgPSAvXltBLVpdLy50ZXN0KG5hbWUpPyB1Y1ByZWZpeGVzIDogbGNQcmVmaXhlcztcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBwcmVmaXhlcy5sZW5ndGg7IGkrKykge1xuXHRcdGlmICgoXCJvblwiICsgcHJlZml4ZXNbaV0gKyBuYW1lKSBpbiBvYmopIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiRXZlbnQgJyVzJyBmb3VuZCBhcyAnJXMnXCIsIG5hbWUsIHByZWZpeGVzW2ldICsgbmFtZSk7XG5cdFx0XHRyZXR1cm4gcHJlZml4ZXNbaV0gKyBuYW1lO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gbnVsbDtcbn07XG5cbnZhciBwcm94eVRlc3QgPSBmdW5jdGlvbihuYW1lLCBvYmosIHRlc3RQcm9wKSB7XG5cdHZhciBwcmVmaXhlcyA9IC9eW0EtWl0vLnRlc3QobmFtZSk/IHVjUHJlZml4ZXMgOiBsY1ByZWZpeGVzO1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IHByZWZpeGVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0aWYgKChwcmVmaXhlc1tpXSArIHRlc3RQcm9wKSBpbiBvYmopIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiRXZlbnQgJXMgaW5mZXJyZWQgYXMgJyVzJyBmcm9tIHByb3BlcnR5ICclcydcIiwgbmFtZSwgcHJlZml4ZXNbaV0gKyBuYW1lLCB0ZXN0UHJvcCk7XG5cdFx0XHRyZXR1cm4gcHJlZml4ZXNbaV0gKyBuYW1lO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gbnVsbDtcbn07XG4qL1xuIiwiLyoqXG4vKiBAbW9kdWxlIHV0aWxzL3ByZWZpeGVkUHJvcGVydHlcbi8qL1xuXG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlc30gKi9cbnZhciBwcmVmaXhlcyA9IHJlcXVpcmUoXCIuL3ByZWZpeGVzXCIpO1xuLyoqIEB0eXBlIHtOdW1iZXJ9IHByZWZpeCBjb3VudCAqL1xudmFyIF9wcmVmaXhOdW0gPSBwcmVmaXhlcy5sZW5ndGg7XG4vKiogQHR5cGUge0FycmF5fSBjYWNoZWQgdmFsdWVzICovXG52YXIgX2NhY2hlID0ge307XG5cbnZhciBfcHJlZml4ZWRQcm9wZXJ0eSA9IGZ1bmN0aW9uKHByb3AsIG9iaikge1xuXHR2YXIgcHJlZml4ZWRQcm9wLCBjYW1lbFByb3A7XG5cblx0aWYgKHByb3AgaW4gb2JqKSB7XG5cdFx0Y29uc29sZS5sb2coXCJQcm9wZXJ0eSAnJXMnIGZvdW5kIHVucHJlZml4ZWRcIiwgcHJvcCk7XG5cdFx0cmV0dXJuIHByb3A7XG5cdH1cblx0Y2FtZWxQcm9wID0gcHJvcFswXS50b1VwcGVyQ2FzZSgpICsgcHJvcC5zbGljZSgxKTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBfcHJlZml4TnVtOyBpKyspIHtcblx0XHRwcmVmaXhlZFByb3AgPSBwcmVmaXhlc1tpXSArIGNhbWVsUHJvcDtcblx0XHRpZiAocHJlZml4ZWRQcm9wIGluIG9iaikge1xuXHRcdFx0Y29uc29sZS5sb2coXCJQcm9wZXJ0eSAnJXMnIGZvdW5kIGFzICclcydcIiwgcHJvcCwgcHJlZml4ZWRQcm9wKTtcblx0XHRcdHJldHVybiBwcmVmaXhlZFByb3A7XG5cdFx0fVxuXHR9XG5cdGNvbnNvbGUuZXJyb3IoXCJQcm9wZXJ0eSAnJXMnIG5vdCBmb3VuZFwiLCBwcm9wKTtcblx0cmV0dXJuIG51bGw7XG59O1xuXG4vKipcbiAqIGdldCB0aGUgcHJlZml4ZWQgcHJvcGVydHlcbiAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wZXJ0eSBuYW1lXG4gKiBAcGFyYW0ge09iamVjdH0gbG9vay11cCBvYmplY3RcbiAqIEByZXR1cm5zIHtTdHJpbmd8bnVsbH0gcHJlZml4ZWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwcm9wLCBvYmopIHtcblx0cmV0dXJuIF9jYWNoZVtwcm9wXSB8fCAoX2NhY2hlW3Byb3BdID0gX3ByZWZpeGVkUHJvcGVydHkocHJvcCwgb2JqIHx8IGRvY3VtZW50LmJvZHkuc3R5bGUpKTtcbn07XG4iLCIvKipcbi8qIEBtb2R1bGUgdXRpbHMvcHJlZml4ZWRTdHlsZU5hbWVcbi8qL1xuXG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlc30gKi9cbnZhciBwcmVmaXhlcyA9IHJlcXVpcmUoXCIuL3ByZWZpeGVzXCIpOyAvLy5tYXAoZnVuY3Rpb24ocHJlZml4KSB7IHJldHVybiBcIi1cIiArIHByZWZpeCArIFwiLVwiOyB9KTtcbi8qKiBAdHlwZSB7TnVtYmVyfSBwcmVmaXggY291bnQgKi9cbnZhciBfcHJlZml4TnVtID0gcHJlZml4ZXMubGVuZ3RoO1xuLyoqIEB0eXBlIHtBcnJheX0gY2FjaGVkIHZhbHVlcyAqL1xudmFyIF9jYWNoZSA9IHt9O1xuXG52YXIgX3ByZWZpeGVkU3R5bGVOYW1lID0gZnVuY3Rpb24oc3R5bGUsIHN0eWxlT2JqKSB7XG5cdHZhciBwcmVmaXhlZFN0eWxlO1xuXG5cdGlmIChzdHlsZSBpbiBzdHlsZU9iaikge1xuXHRcdGNvbnNvbGUubG9nKFwiQ1NTIHN0eWxlICclcycgZm91bmQgdW5wcmVmaXhlZFwiLCBzdHlsZSk7XG5cdFx0cmV0dXJuIHN0eWxlO1xuXHR9XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgX3ByZWZpeE51bTsgaSsrKSB7XG5cdFx0cHJlZml4ZWRTdHlsZSA9IFwiLVwiICsgcHJlZml4ZXNbaV0gKyBcIi1cIiArIHN0eWxlO1xuXHRcdC8vIHByZWZpeGVkU3R5bGUgPSBwcmVmaXhlc1tpXSArIHN0eWxlO1xuXHRcdGlmIChwcmVmaXhlZFN0eWxlIGluIHN0eWxlT2JqKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIkNTUyBzdHlsZSAnJXMnIGZvdW5kIGFzICclcydcIiwgc3R5bGUsIHByZWZpeGVkU3R5bGUpO1xuXHRcdFx0cmV0dXJuIHByZWZpeGVkU3R5bGU7XG5cdFx0fVxuXHR9XG5cdGNvbnNvbGUud2FybihcIkNTUyBzdHlsZSAnJXMnIG5vdCBmb3VuZFwiLCBzdHlsZSk7XG5cdHJldHVybiBudWxsO1xufTtcblxuLyoqXG4gKiBnZXQgdGhlIHByZWZpeGVkIHN0eWxlIG5hbWVcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHlsZSBuYW1lXG4gKiBAcGFyYW0ge09iamVjdH0gbG9vay11cCBzdHlsZSBvYmplY3RcbiAqIEByZXR1cm5zIHtTdHJpbmd8VW5kZWZpbmVkfSBwcmVmaXhlZFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHN0eWxlLCBzdHlsZU9iaikge1xuXHQvLyByZXR1cm4gX2NhY2hlW3N0eWxlXSB8fCAoX2NhY2hlW3N0eWxlXSA9IF9wcmVmaXhlZFN0eWxlTmFtZV9yZXZlcnNlKHN0eWxlLCBzdHlsZU9iaiB8fCBkb2N1bWVudC5ib2R5LnN0eWxlKSk7XG5cdHJldHVybiBfY2FjaGVbc3R5bGVdIHx8IChfY2FjaGVbc3R5bGVdID0gX3ByZWZpeGVkU3R5bGVOYW1lKHN0eWxlLCBzdHlsZU9iaiB8fCBkb2N1bWVudC5ib2R5LnN0eWxlKSk7XG59O1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9zdHJpbmdzL2NhbWVsVG9EYXNoZWR9ICovXG4vLyB2YXIgY2FtZWxUb0Rhc2hlZCA9IHJlcXVpcmUoXCIuL3N0cmluZ3MvY2FtZWxUb0Rhc2hlZFwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkUHJvcGVydHl9ICovXG4vLyB2YXIgcHJlZml4ZWRQcm9wZXJ0eSA9IHJlcXVpcmUoXCIuL3ByZWZpeGVkUHJvcGVydHlcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9zdHJpbmdzL2Rhc2hlZFRvQ2FtZWx9ICovXG4vLyB2YXIgZGFzaGVkVG9DYW1lbCA9IHJlcXVpcmUoXCIuL3N0cmluZ3MvZGFzaGVkVG9DYW1lbFwiKTtcbi8vXG4vLyB2YXIgX3ByZWZpeGVkU3R5bGVOYW1lX3JldmVyc2UgPSBmdW5jdGlvbiAoc3R5bGUsIHN0eWxlT2JqKSB7XG4vLyBcdHZhciBjYW1lbFByb3AsIHByZWZpeGVkUHJvcDtcbi8vIFx0Y2FtZWxQcm9wID0gZGFzaGVkVG9DYW1lbChzdHlsZSk7XG4vLyBcdHByZWZpeGVkUHJvcCA9IHByZWZpeGVkUHJvcGVydHkoY2FtZWxQcm9wLCBzdHlsZU9iaik7XG4vLyBcdHJldHVybiBwcmVmaXhlZFByb3A/IChjYW1lbFByb3AgPT09IHByZWZpeGVkUHJvcD8gXCJcIiA6IFwiLVwiKSArIGNhbWVsVG9EYXNoZWQocHJlZml4ZWRQcm9wKSA6IG51bGw7XG4vLyB9O1xuIiwibW9kdWxlLmV4cG9ydHMgPSBbXCJ3ZWJraXRcIiwgXCJtb3pcIiwgXCJtc1wiLCBcIm9cIl07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHBwLCByZWFzb24pIHtcblx0aWYgKHBwLmxlbmd0aCA+IDApIHtcblx0XHRwcC5mb3JFYWNoKGZ1bmN0aW9uKHAsIGksIGEpIHtcblx0XHRcdHAucmVqZWN0KHJlYXNvbik7XG5cdFx0XHRhW2ldID0gbnVsbDtcblx0XHR9KTtcblx0XHRwcC5sZW5ndGggPSAwO1xuXHR9XG5cdHJldHVybiBwcDtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihwcCwgcmVzdWx0KSB7XG5cdGlmIChwcC5sZW5ndGggIT0gMCkge1xuXHRcdHBwLmZvckVhY2goZnVuY3Rpb24ocCwgaSwgYSkge1xuXHRcdFx0cC5yZXNvbHZlKHJlc3VsdCk7XG5cdFx0XHRhW2ldID0gbnVsbDtcblx0XHR9KTtcblx0XHRwcC5sZW5ndGggPSAwO1xuXHR9XG5cdHJldHVybiBwcDtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihzdHIpIHtcblx0cmV0dXJuIHN0ci5yZXBsYWNlKC9bQS1aXS9nLCBmdW5jdGlvbigkMCkge1xuXHRcdHJldHVybiBcIi1cIiArICQwLnRvTG93ZXJDYXNlKCk7XG5cdH0pO1xufTtcbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocykge1xuXHRyZXR1cm4gcy5yZXBsYWNlKC88W14+XSs+L2csIFwiXCIpO1xufTtcbiIsIi8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzfSAqL1xudmFyIEhhbW1lciA9IHJlcXVpcmUoXCJoYW1tZXJqc1wiKTtcblxuLy8gLyoqXG4vLyAgKiBnZXQgYSB1c2FibGUgc3RyaW5nLCB1c2VkIGFzIGV2ZW50IHBvc3RmaXhcbi8vICAqIEBwYXJhbSB7Q29uc3R9IHN0YXRlXG4vLyAgKiBAcmV0dXJucyB7U3RyaW5nfSBzdGF0ZVxuLy8gICovXG4vLyBmdW5jdGlvbiBzdGF0ZVN0cihzdGF0ZSkge1xuLy8gXHRpZiAoc3RhdGUgJiBIYW1tZXIuU1RBVEVfQ0FOQ0VMTEVEKSB7XG4vLyBcdFx0cmV0dXJuIFwiY2FuY2VsXCI7XG4vLyBcdH0gZWxzZSBpZiAoc3RhdGUgJiBIYW1tZXIuU1RBVEVfRU5ERUQpIHtcbi8vIFx0XHRyZXR1cm4gXCJlbmRcIjtcbi8vIFx0fSBlbHNlIGlmIChzdGF0ZSAmIEhhbW1lci5TVEFURV9DSEFOR0VEKSB7XG4vLyBcdFx0cmV0dXJuIFwibW92ZVwiO1xuLy8gXHR9IGVsc2UgaWYgKHN0YXRlICYgSGFtbWVyLlNUQVRFX0JFR0FOKSB7XG4vLyBcdFx0cmV0dXJuIFwic3RhcnRcIjtcbi8vIFx0fVxuLy8gXHRyZXR1cm4gXCJcIjtcbi8vIH1cblxuLyoqXG4gKiBkaXJlY3Rpb24gY29ucyB0byBzdHJpbmdcbiAqIEBwYXJhbSB7Q29uc3R9IGRpcmVjdGlvblxuICogQHJldHVybnMge1N0cmluZ31cbiAqL1xuZnVuY3Rpb24gZGlyU3RyKGRpcmVjdGlvbikge1xuXHRpZiAoZGlyZWN0aW9uID09IEhhbW1lci5ESVJFQ1RJT05fRE9XTikge1xuXHRcdHJldHVybiBcImRvd25cIjtcblx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gSGFtbWVyLkRJUkVDVElPTl9VUCkge1xuXHRcdHJldHVybiBcInVwXCI7XG5cdH0gZWxzZSBpZiAoZGlyZWN0aW9uID09IEhhbW1lci5ESVJFQ1RJT05fTEVGVCkge1xuXHRcdHJldHVybiBcImxlZnRcIjtcblx0fSBlbHNlIGlmIChkaXJlY3Rpb24gPT0gSGFtbWVyLkRJUkVDVElPTl9SSUdIVCkge1xuXHRcdHJldHVybiBcInJpZ2h0XCI7XG5cdH1cblx0cmV0dXJuIFwiXCI7XG59XG5cbi8vLyoqXG4vLyAqIFBhblxuLy8gKiBSZWNvZ25pemVkIHdoZW4gdGhlIHBvaW50ZXIgaXMgZG93biBhbmQgbW92ZWQgaW4gdGhlIGFsbG93ZWQgZGlyZWN0aW9uLlxuLy8gKiBAY29uc3RydWN0b3Jcbi8vICogQGV4dGVuZHMgQXR0clJlY29nbml6ZXJcbi8vICovXG4vL2Z1bmN0aW9uIFBhblJlY29nbml6ZXIoKSB7XG4vL1x0SGFtbWVyLkF0dHJSZWNvZ25pemVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4vL1xuLy9cdHRoaXMucFggPSBudWxsO1xuLy9cdHRoaXMucFkgPSBudWxsO1xuLy99XG4vL1xuLy9pbmhlcml0KFBhblJlY29nbml6ZXIsIEhhbW1lci5BdHRyUmVjb2duaXplciwge1xuLy9cdC8qKlxuLy9cdC8qIEBuYW1lc3BhY2Vcbi8vXHQvKiBAbWVtYmVyb2YgUGFuUmVjb2duaXplclxuLy9cdC8qL1xuLy9cdGRlZmF1bHRzOiB7XG4vL1x0XHRldmVudDogXCJwYW5cIixcbi8vXHRcdHRocmVzaG9sZDogMTAsXG4vL1x0XHRwb2ludGVyczogMSxcbi8vXHRcdGRpcmVjdGlvbjogRElSRUNUSU9OX0FMTFxuLy9cdH0sXG4vL1xuLy9cdGdldFRvdWNoQWN0aW9uOiBmdW5jdGlvbigpIHtcbi8vXHRcdHZhciBkaXJlY3Rpb24gPSB0aGlzLm9wdGlvbnMuZGlyZWN0aW9uO1xuLy9cdFx0dmFyIGFjdGlvbnMgPSBbXTtcbi8vXHRcdGlmIChkaXJlY3Rpb24gJiBESVJFQ1RJT05fSE9SSVpPTlRBTCkge1xuLy9cdFx0XHRhY3Rpb25zLnB1c2goVE9VQ0hfQUNUSU9OX1BBTl9ZKTtcbi8vXHRcdH1cbi8vXHRcdGlmIChkaXJlY3Rpb24gJiBESVJFQ1RJT05fVkVSVElDQUwpIHtcbi8vXHRcdFx0YWN0aW9ucy5wdXNoKFRPVUNIX0FDVElPTl9QQU5fWCk7XG4vL1x0XHR9XG4vL1x0XHRyZXR1cm4gYWN0aW9ucztcbi8vXHR9LFxuLy9cbi8vXHRkaXJlY3Rpb25UZXN0OiBmdW5jdGlvbihpbnB1dCkge1xuLy9cdFx0dmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7XG4vL1x0XHR2YXIgaGFzTW92ZWQgPSB0cnVlO1xuLy9cdFx0dmFyIGRpc3RhbmNlID0gaW5wdXQuZGlzdGFuY2U7XG4vL1x0XHR2YXIgZGlyZWN0aW9uID0gaW5wdXQuZGlyZWN0aW9uO1xuLy9cdFx0dmFyIHggPSBpbnB1dC5kZWx0YVg7XG4vL1x0XHR2YXIgeSA9IGlucHV0LmRlbHRhWTtcbi8vXG4vL1x0XHQvLyBsb2NrIHRvIGF4aXM/XG4vL1x0XHRpZiAoIShkaXJlY3Rpb24gJiBvcHRpb25zLmRpcmVjdGlvbikpIHtcbi8vXHRcdFx0aWYgKG9wdGlvbnMuZGlyZWN0aW9uICYgRElSRUNUSU9OX0hPUklaT05UQUwpIHtcbi8vXHRcdFx0XHRkaXJlY3Rpb24gPSAoeCA9PT0gMCkgPyBESVJFQ1RJT05fTk9ORSA6ICh4IDwgMCkgPyBESVJFQ1RJT05fTEVGVCA6IERJUkVDVElPTl9SSUdIVDtcbi8vXHRcdFx0XHRoYXNNb3ZlZCA9IHggIT0gdGhpcy5wWDtcbi8vXHRcdFx0XHRkaXN0YW5jZSA9IE1hdGguYWJzKGlucHV0LmRlbHRhWCk7XG4vL1x0XHRcdH0gZWxzZSB7XG4vL1x0XHRcdFx0ZGlyZWN0aW9uID0gKHkgPT09IDApID8gRElSRUNUSU9OX05PTkUgOiAoeSA8IDApID8gRElSRUNUSU9OX1VQIDogRElSRUNUSU9OX0RPV047XG4vL1x0XHRcdFx0aGFzTW92ZWQgPSB5ICE9IHRoaXMucFk7XG4vL1x0XHRcdFx0ZGlzdGFuY2UgPSBNYXRoLmFicyhpbnB1dC5kZWx0YVkpO1xuLy9cdFx0XHR9XG4vL1x0XHR9XG4vL1x0XHRpbnB1dC5kaXJlY3Rpb24gPSBkaXJlY3Rpb247XG4vL1x0XHRyZXR1cm4gaGFzTW92ZWQgJiYgZGlzdGFuY2UgPiBvcHRpb25zLnRocmVzaG9sZCAmJiBkaXJlY3Rpb24gJiBvcHRpb25zLmRpcmVjdGlvbjtcbi8vXHR9LFxuLy9cbi8vXHRhdHRyVGVzdDogZnVuY3Rpb24oaW5wdXQpIHtcbi8vXHRcdHJldHVybiBBdHRyUmVjb2duaXplci5wcm90b3R5cGUuYXR0clRlc3QuY2FsbCh0aGlzLCBpbnB1dCkgJiZcbi8vXHRcdFx0KHRoaXMuc3RhdGUgJiBTVEFURV9CRUdBTiB8fCAoISh0aGlzLnN0YXRlICYgU1RBVEVfQkVHQU4pICYmIHRoaXMuZGlyZWN0aW9uVGVzdChpbnB1dCkpKTtcbi8vXHR9LFxuLy9cbi8vXHRlbWl0OiBmdW5jdGlvbihpbnB1dCkge1xuLy9cdFx0dGhpcy5wWCA9IGlucHV0LmRlbHRhWDtcbi8vXHRcdHRoaXMucFkgPSBpbnB1dC5kZWx0YVk7XG4vL1xuLy9cdFx0dmFyIGRpcmVjdGlvbiA9IGRpclN0cihpbnB1dC5kaXJlY3Rpb24pO1xuLy9cdFx0aWYgKGRpcmVjdGlvbikge1xuLy9cdFx0XHR0aGlzLm1hbmFnZXIuZW1pdCh0aGlzLm9wdGlvbnMuZXZlbnQgKyBkaXJlY3Rpb24sIGlucHV0KTtcbi8vXHRcdH1cbi8vXG4vL1x0XHR0aGlzLl9zdXBlci5lbWl0LmNhbGwodGhpcywgaW5wdXQpO1xuLy9cdH1cbi8vfSk7XG5cbi8qKlxuICogU21vb3RoUGFuXG4gKiBAY29uc3RydWN0b3JcbiAqIEBleHRlbmRzIEhhbW1lci5QYW5cbiAqL1xuZnVuY3Rpb24gU21vb3RoUGFuKCkge1xuXHR2YXIgcmV0ID0gSGFtbWVyLlBhbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR0aGlzLnRocmVzaG9sZE9mZnNldFggPSBudWxsO1xuXHR0aGlzLnRocmVzaG9sZE9mZnNldFkgPSBudWxsO1xuXHR0aGlzLnRocmVzaG9sZE9mZnNldCA9IG51bGw7XG5cdHJldHVybiByZXQ7XG59XG5cbkhhbW1lci5pbmhlcml0KFNtb290aFBhbiwgSGFtbWVyLlBhbiwge1xuXHRlbWl0OiBmdW5jdGlvbihpbnB1dCkge1xuXHRcdC8vIEluaGVyaXRhbmNlIGJyZWFrcywgc28gdGhpcyBjb2RlIGlzIHRha2VuIGZyb20gUGFuUmVjb2duaXplci5lbWl0XG5cdFx0Ly9cdHRoaXMuX3N1cGVyLmVtaXQuY2FsbCh0aGlzLCBpbnB1dCk7IC8vIFRyaWdnZXJzIGluZmluaXRlIHJlY3Vyc2lvblxuXHRcdC8vXHRIYW1tZXIuUGFuLnByb3RvdHlwZS5lbWl0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IC8vIFRoaXMgYnJlYWtzIHRvb1xuXG5cdFx0dmFyIHRocmVzaG9sZCA9IHRoaXMub3B0aW9ucy50aHJlc2hvbGQ7XG5cdFx0dmFyIGRpcmVjdGlvbiA9IGlucHV0LmRpcmVjdGlvbjtcblxuXHRcdGlmICh0aGlzLnN0YXRlID09IEhhbW1lci5TVEFURV9CRUdBTikge1xuXHRcdFx0dGhpcy50aHJlc2hvbGRPZmZzZXRYID0gKGRpcmVjdGlvbiAmIEhhbW1lci5ESVJFQ1RJT05fSE9SSVpPTlRBTCkgPyAoKGRpcmVjdGlvbiAmIEhhbW1lci5ESVJFQ1RJT05fTEVGVCkgPyB0aHJlc2hvbGQgOiAtdGhyZXNob2xkKSA6IDA7XG5cdFx0XHR0aGlzLnRocmVzaG9sZE9mZnNldFkgPSAoZGlyZWN0aW9uICYgSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTCkgPyAoKGRpcmVjdGlvbiAmIEhhbW1lci5ESVJFQ1RJT05fVVApID8gdGhyZXNob2xkIDogLXRocmVzaG9sZCkgOiAwO1xuXHRcdFx0Ly8gdGhpcy50aHJlc2hvbGRPZmZzZXQgPSAoZGlyZWN0aW9uICYgSGFtbWVyLkRJUkVDVElPTl9IT1JJWk9OVEFMKT8gaW5wdXQudGhyZXNob2xkT2Zmc2V0WCA6IGlucHV0LnRocmVzaG9sZE9mZnNldFk7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcIlJFQ09HTklaRVIgU1RBVEVcIiwgZGlyU3RyKGRpcmVjdGlvbiksIHN0YXRlU3RyKHRoaXMuc3RhdGUpLCB0aGlzLnRocmVzaG9sZE9mZnNldFgpO1xuXHRcdH1cblx0XHRpbnB1dC50aHJlc2hvbGRPZmZzZXRYID0gdGhpcy50aHJlc2hvbGRPZmZzZXRYO1xuXHRcdGlucHV0LnRocmVzaG9sZE9mZnNldFkgPSB0aGlzLnRocmVzaG9sZE9mZnNldFk7XG5cdFx0aW5wdXQudGhyZXNob2xkRGVsdGFYID0gaW5wdXQuZGVsdGFYICsgdGhpcy50aHJlc2hvbGRPZmZzZXRYO1xuXHRcdGlucHV0LnRocmVzaG9sZERlbHRhWSA9IGlucHV0LmRlbHRhWSArIHRoaXMudGhyZXNob2xkT2Zmc2V0WTtcblxuXHRcdHRoaXMucFggPSBpbnB1dC5kZWx0YVg7XG5cdFx0dGhpcy5wWSA9IGlucHV0LmRlbHRhWTtcblxuXHRcdGRpcmVjdGlvbiA9IGRpclN0cihkaXJlY3Rpb24pO1xuXHRcdGlmIChkaXJlY3Rpb24pIHtcblx0XHRcdHRoaXMubWFuYWdlci5lbWl0KHRoaXMub3B0aW9ucy5ldmVudCArIGRpcmVjdGlvbiwgaW5wdXQpO1xuXHRcdH1cblx0XHRyZXR1cm4gSGFtbWVyLlJlY29nbml6ZXIucHJvdG90eXBlLmVtaXQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fVxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gU21vb3RoUGFuO1xuIiwibW9kdWxlLmV4cG9ydHM9e1xuXHRcInRyYW5zaXRpb25zXCI6IHtcblx0XHRcImVhc2VcIjogXCJlYXNlXCIsXG5cdFx0XCJkdXJhdGlvbl9tc1wiOiBcIjQwMFwiLFxuXHRcdFwiZGVsYXlfaW50ZXJ2YWxfbXNcIjogXCIxMDBcIixcblx0XHRcIm1pbl9kZWxheV9tc1wiOiBcIjUwXCJcblx0fSxcblx0XCJicmVha3BvaW50c1wiOiB7XG5cdFx0XCJsYW5kc2NhcGVcIjogXCInKG9yaWVudGF0aW9uOiBsYW5kc2NhcGUpJ1wiLFxuXHRcdFwicG9ydHJhaXRcIjogXCInKG9yaWVudGF0aW9uOiBwb3J0cmFpdCknXCIsXG5cdFx0XCJmdWxsd2lkdGgtc21hbGxcIjogXCInbm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNDYwcHgpJ1wiLFxuXHRcdFwiZnVsbHdpZHRoXCI6IFwiJ25vdCBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDcwNHB4KSwgbm90IHNjcmVlbiBhbmQgKG1pbi1oZWlnaHQ6IDU0MHB4KSdcIixcblx0XHRcImRlZmF1bHRcIjpcIidvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpIGFuZCAobWluLWhlaWdodDogNTQwcHgpJ1wiLFxuXHRcdFwiZGVza3RvcC1zbWFsbFwiOiBcIidvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogMTAyNHB4KSBhbmQgKG1pbi1oZWlnaHQ6IDU0MHB4KSdcIixcblx0XHRcImRlc2t0b3AtbWVkaXVtXCI6IFwiJ29ubHkgc2NyZWVuIGFuZCAobWluLXdpZHRoOiAxMjI0cHgpIGFuZCAobWluLWhlaWdodDogNzA0cHgpJ1wiLFxuXHRcdFwiZGVza3RvcC1sYXJnZVwiOiBcIidvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogMTgyNHB4KSBhbmQgKG1pbi1oZWlnaHQ6IDEwMjRweCknXCJcblx0fSxcblx0XCJkZWZhdWx0X2NvbG9yc1wiOiB7XG5cdFx0XCJjb2xvclwiOiBcImhzbCg0NywgNSUsIDE1JSlcIixcblx0XHRcImJhY2tncm91bmQtY29sb3JcIjogXCJoc2woNDcsIDUlLCA5NSUpXCIsXG5cdFx0XCJsaW5rLWNvbG9yXCI6IFwiaHNsKDEwLCA4MCUsIDUwJSlcIlxuXHR9LFxuXHRcInRlbXBcIjoge1xuXHRcdFwiY29sbGFwc2Vfb2Zmc2V0XCI6IFwiMzYwXCJcblx0fSxcblx0XCJfaWdub3JlXCI6IHtcblx0XHRcInRyYW5zaXRpb25zXCI6IHtcblx0XHRcdFwiZWFzZVwiOiBcImVhc2VcIixcblx0XHRcdFwiZHVyYXRpb25fbXNcIjogXCI0MDBcIixcblx0XHRcdFwiZGVsYXlfaW50ZXJ2YWxfbXNcIjogXCIxMzRcIixcblx0XHRcdFwibWluX2RlbGF5X21zXCI6IFwiMzRcIlxuXHRcdH0sXG5cdFx0XCJkZWZhdWx0X2NvbG9yc1wiOiB7XG5cdFx0XHRcIi0tbGluay1jb2xvclwiOiBcImhzbCgxMCwgODAlLCA1MCUpXCIsXG5cdFx0XHRcIi0tYWx0LWJhY2tncm91bmQtY29sb3JcIjogXCJ1bnNldFwiXG5cdFx0fSxcblx0XHRcInVuaXRzXCI6IHtcblx0XHRcdFwiaHVfcHhcIjogXCIyMFwiLFxuXHRcdFx0XCJ2dV9weFwiOiBcIjEyXCJcblx0XHR9LFxuXHRcdFwiYnJlYWtwb2ludHNcIjoge1xuXHRcdFx0XCJtb2JpbGVcIjogXCInbm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpLCBub3Qgc2NyZWVuIGFuZCAobWluLWhlaWdodDogNTQwcHgpJ1wiLFxuXHRcdFx0XCJ1bnN1cHBvcnRlZFwiOiBcIidub3Qgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA3MDRweCknXCIsXG5cdFx0XHRcInVucXVvdGVkXCI6IFwib25seSBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDE4MjRweClcIixcblx0XHRcdFwidW5xdW90ZWRfbmVnXCI6IFwibm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpXCIsXG5cdFx0XHRcInF1b3RlZF9jb21iaW5lZFwiOiBcIidub3Qgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA3MDRweCksIG5vdCBzY3JlZW4gYW5kIChtaW4taGVpZ2h0OiA1NDBweCknXCIsXG5cdFx0XHRcImFycmF5XCI6IFtcblx0XHRcdFx0XCJvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpXCIsXG5cdFx0XHRcdFwibm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpXCIsXG5cdFx0XHRcdFwibm90IHNjcmVlbiBhbmQgKG1pbi1oZWlnaHQ6IDU0MHB4KVwiXG5cdFx0XHRdXG5cdFx0fVxuXHR9XG59XG4iXX0=
