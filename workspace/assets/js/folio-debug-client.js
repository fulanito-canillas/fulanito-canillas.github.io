(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// shim for using process in browser

var process = module.exports = {};
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = setTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    clearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        setTimeout(drainQueue, 0);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],2:[function(require,module,exports){
'use strict';

exports.__esModule = true;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

// istanbul ignore next

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }

var _handlebarsBase = require('./handlebars/base');

var base = _interopRequireWildcard(_handlebarsBase);

// Each of these augment the Handlebars object. No need to setup here.
// (This is done to easily share code between commonjs and browse envs)

var _handlebarsSafeString = require('./handlebars/safe-string');

var _handlebarsSafeString2 = _interopRequireDefault(_handlebarsSafeString);

var _handlebarsException = require('./handlebars/exception');

var _handlebarsException2 = _interopRequireDefault(_handlebarsException);

var _handlebarsUtils = require('./handlebars/utils');

var Utils = _interopRequireWildcard(_handlebarsUtils);

var _handlebarsRuntime = require('./handlebars/runtime');

var runtime = _interopRequireWildcard(_handlebarsRuntime);

var _handlebarsNoConflict = require('./handlebars/no-conflict');

var _handlebarsNoConflict2 = _interopRequireDefault(_handlebarsNoConflict);

// For compatibility and usage outside of module systems, make the Handlebars object a namespace
function create() {
  var hb = new base.HandlebarsEnvironment();

  Utils.extend(hb, base);
  hb.SafeString = _handlebarsSafeString2['default'];
  hb.Exception = _handlebarsException2['default'];
  hb.Utils = Utils;
  hb.escapeExpression = Utils.escapeExpression;

  hb.VM = runtime;
  hb.template = function (spec) {
    return runtime.template(spec, hb);
  };

  return hb;
}

var inst = create();
inst.create = create;

_handlebarsNoConflict2['default'](inst);

inst['default'] = inst;

exports['default'] = inst;
module.exports = exports['default'];


},{"./handlebars/base":3,"./handlebars/exception":6,"./handlebars/no-conflict":16,"./handlebars/runtime":17,"./handlebars/safe-string":18,"./handlebars/utils":19}],3:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.HandlebarsEnvironment = HandlebarsEnvironment;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _utils = require('./utils');

var _exception = require('./exception');

var _exception2 = _interopRequireDefault(_exception);

var _helpers = require('./helpers');

var _decorators = require('./decorators');

var _logger = require('./logger');

var _logger2 = _interopRequireDefault(_logger);

var VERSION = '4.0.5';
exports.VERSION = VERSION;
var COMPILER_REVISION = 7;

exports.COMPILER_REVISION = COMPILER_REVISION;
var REVISION_CHANGES = {
  1: '<= 1.0.rc.2', // 1.0.rc.2 is actually rev2 but doesn't report it
  2: '== 1.0.0-rc.3',
  3: '== 1.0.0-rc.4',
  4: '== 1.x.x',
  5: '== 2.0.0-alpha.x',
  6: '>= 2.0.0-beta.1',
  7: '>= 4.0.0'
};

exports.REVISION_CHANGES = REVISION_CHANGES;
var objectType = '[object Object]';

function HandlebarsEnvironment(helpers, partials, decorators) {
  this.helpers = helpers || {};
  this.partials = partials || {};
  this.decorators = decorators || {};

  _helpers.registerDefaultHelpers(this);
  _decorators.registerDefaultDecorators(this);
}

HandlebarsEnvironment.prototype = {
  constructor: HandlebarsEnvironment,

  logger: _logger2['default'],
  log: _logger2['default'].log,

  registerHelper: function registerHelper(name, fn) {
    if (_utils.toString.call(name) === objectType) {
      if (fn) {
        throw new _exception2['default']('Arg not supported with multiple helpers');
      }
      _utils.extend(this.helpers, name);
    } else {
      this.helpers[name] = fn;
    }
  },
  unregisterHelper: function unregisterHelper(name) {
    delete this.helpers[name];
  },

  registerPartial: function registerPartial(name, partial) {
    if (_utils.toString.call(name) === objectType) {
      _utils.extend(this.partials, name);
    } else {
      if (typeof partial === 'undefined') {
        throw new _exception2['default']('Attempting to register a partial called "' + name + '" as undefined');
      }
      this.partials[name] = partial;
    }
  },
  unregisterPartial: function unregisterPartial(name) {
    delete this.partials[name];
  },

  registerDecorator: function registerDecorator(name, fn) {
    if (_utils.toString.call(name) === objectType) {
      if (fn) {
        throw new _exception2['default']('Arg not supported with multiple decorators');
      }
      _utils.extend(this.decorators, name);
    } else {
      this.decorators[name] = fn;
    }
  },
  unregisterDecorator: function unregisterDecorator(name) {
    delete this.decorators[name];
  }
};

var log = _logger2['default'].log;

exports.log = log;
exports.createFrame = _utils.createFrame;
exports.logger = _logger2['default'];


},{"./decorators":4,"./exception":6,"./helpers":7,"./logger":15,"./utils":19}],4:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.registerDefaultDecorators = registerDefaultDecorators;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _decoratorsInline = require('./decorators/inline');

var _decoratorsInline2 = _interopRequireDefault(_decoratorsInline);

function registerDefaultDecorators(instance) {
  _decoratorsInline2['default'](instance);
}


},{"./decorators/inline":5}],5:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerDecorator('inline', function (fn, props, container, options) {
    var ret = fn;
    if (!props.partials) {
      props.partials = {};
      ret = function (context, options) {
        // Create a new partials stack frame prior to exec.
        var original = container.partials;
        container.partials = _utils.extend({}, original, props.partials);
        var ret = fn(context, options);
        container.partials = original;
        return ret;
      };
    }

    props.partials[options.args[0]] = options.fn;

    return ret;
  });
};

module.exports = exports['default'];


},{"../utils":19}],6:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var errorProps = ['description', 'fileName', 'lineNumber', 'message', 'name', 'number', 'stack'];

function Exception(message, node) {
  var loc = node && node.loc,
      line = undefined,
      column = undefined;
  if (loc) {
    line = loc.start.line;
    column = loc.start.column;

    message += ' - ' + line + ':' + column;
  }

  var tmp = Error.prototype.constructor.call(this, message);

  // Unfortunately errors are not enumerable in Chrome (at least), so `for prop in tmp` doesn't work.
  for (var idx = 0; idx < errorProps.length; idx++) {
    this[errorProps[idx]] = tmp[errorProps[idx]];
  }

  /* istanbul ignore else */
  if (Error.captureStackTrace) {
    Error.captureStackTrace(this, Exception);
  }

  if (loc) {
    this.lineNumber = line;
    this.column = column;
  }
}

Exception.prototype = new Error();

exports['default'] = Exception;
module.exports = exports['default'];


},{}],7:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.registerDefaultHelpers = registerDefaultHelpers;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _helpersBlockHelperMissing = require('./helpers/block-helper-missing');

var _helpersBlockHelperMissing2 = _interopRequireDefault(_helpersBlockHelperMissing);

var _helpersEach = require('./helpers/each');

var _helpersEach2 = _interopRequireDefault(_helpersEach);

var _helpersHelperMissing = require('./helpers/helper-missing');

var _helpersHelperMissing2 = _interopRequireDefault(_helpersHelperMissing);

var _helpersIf = require('./helpers/if');

var _helpersIf2 = _interopRequireDefault(_helpersIf);

var _helpersLog = require('./helpers/log');

var _helpersLog2 = _interopRequireDefault(_helpersLog);

var _helpersLookup = require('./helpers/lookup');

var _helpersLookup2 = _interopRequireDefault(_helpersLookup);

var _helpersWith = require('./helpers/with');

var _helpersWith2 = _interopRequireDefault(_helpersWith);

function registerDefaultHelpers(instance) {
  _helpersBlockHelperMissing2['default'](instance);
  _helpersEach2['default'](instance);
  _helpersHelperMissing2['default'](instance);
  _helpersIf2['default'](instance);
  _helpersLog2['default'](instance);
  _helpersLookup2['default'](instance);
  _helpersWith2['default'](instance);
}


},{"./helpers/block-helper-missing":8,"./helpers/each":9,"./helpers/helper-missing":10,"./helpers/if":11,"./helpers/log":12,"./helpers/lookup":13,"./helpers/with":14}],8:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerHelper('blockHelperMissing', function (context, options) {
    var inverse = options.inverse,
        fn = options.fn;

    if (context === true) {
      return fn(this);
    } else if (context === false || context == null) {
      return inverse(this);
    } else if (_utils.isArray(context)) {
      if (context.length > 0) {
        if (options.ids) {
          options.ids = [options.name];
        }

        return instance.helpers.each(context, options);
      } else {
        return inverse(this);
      }
    } else {
      if (options.data && options.ids) {
        var data = _utils.createFrame(options.data);
        data.contextPath = _utils.appendContextPath(options.data.contextPath, options.name);
        options = { data: data };
      }

      return fn(context, options);
    }
  });
};

module.exports = exports['default'];


},{"../utils":19}],9:[function(require,module,exports){
'use strict';

exports.__esModule = true;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _utils = require('../utils');

var _exception = require('../exception');

var _exception2 = _interopRequireDefault(_exception);

exports['default'] = function (instance) {
  instance.registerHelper('each', function (context, options) {
    if (!options) {
      throw new _exception2['default']('Must pass iterator to #each');
    }

    var fn = options.fn,
        inverse = options.inverse,
        i = 0,
        ret = '',
        data = undefined,
        contextPath = undefined;

    if (options.data && options.ids) {
      contextPath = _utils.appendContextPath(options.data.contextPath, options.ids[0]) + '.';
    }

    if (_utils.isFunction(context)) {
      context = context.call(this);
    }

    if (options.data) {
      data = _utils.createFrame(options.data);
    }

    function execIteration(field, index, last) {
      if (data) {
        data.key = field;
        data.index = index;
        data.first = index === 0;
        data.last = !!last;

        if (contextPath) {
          data.contextPath = contextPath + field;
        }
      }

      ret = ret + fn(context[field], {
        data: data,
        blockParams: _utils.blockParams([context[field], field], [contextPath + field, null])
      });
    }

    if (context && typeof context === 'object') {
      if (_utils.isArray(context)) {
        for (var j = context.length; i < j; i++) {
          if (i in context) {
            execIteration(i, i, i === context.length - 1);
          }
        }
      } else {
        var priorKey = undefined;

        for (var key in context) {
          if (context.hasOwnProperty(key)) {
            // We're running the iterations one step out of sync so we can detect
            // the last iteration without have to scan the object twice and create
            // an itermediate keys array.
            if (priorKey !== undefined) {
              execIteration(priorKey, i - 1);
            }
            priorKey = key;
            i++;
          }
        }
        if (priorKey !== undefined) {
          execIteration(priorKey, i - 1, true);
        }
      }
    }

    if (i === 0) {
      ret = inverse(this);
    }

    return ret;
  });
};

module.exports = exports['default'];


},{"../exception":6,"../utils":19}],10:[function(require,module,exports){
'use strict';

exports.__esModule = true;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

var _exception = require('../exception');

var _exception2 = _interopRequireDefault(_exception);

exports['default'] = function (instance) {
  instance.registerHelper('helperMissing', function () /* [args, ]options */{
    if (arguments.length === 1) {
      // A missing field in a {{foo}} construct.
      return undefined;
    } else {
      // Someone is actually trying to call something, blow up.
      throw new _exception2['default']('Missing helper: "' + arguments[arguments.length - 1].name + '"');
    }
  });
};

module.exports = exports['default'];


},{"../exception":6}],11:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerHelper('if', function (conditional, options) {
    if (_utils.isFunction(conditional)) {
      conditional = conditional.call(this);
    }

    // Default behavior is to render the positive path if the value is truthy and not empty.
    // The `includeZero` option may be set to treat the condtional as purely not empty based on the
    // behavior of isEmpty. Effectively this determines if 0 is handled by the positive path or negative.
    if (!options.hash.includeZero && !conditional || _utils.isEmpty(conditional)) {
      return options.inverse(this);
    } else {
      return options.fn(this);
    }
  });

  instance.registerHelper('unless', function (conditional, options) {
    return instance.helpers['if'].call(this, conditional, { fn: options.inverse, inverse: options.fn, hash: options.hash });
  });
};

module.exports = exports['default'];


},{"../utils":19}],12:[function(require,module,exports){
'use strict';

exports.__esModule = true;

exports['default'] = function (instance) {
  instance.registerHelper('log', function () /* message, options */{
    var args = [undefined],
        options = arguments[arguments.length - 1];
    for (var i = 0; i < arguments.length - 1; i++) {
      args.push(arguments[i]);
    }

    var level = 1;
    if (options.hash.level != null) {
      level = options.hash.level;
    } else if (options.data && options.data.level != null) {
      level = options.data.level;
    }
    args[0] = level;

    instance.log.apply(instance, args);
  });
};

module.exports = exports['default'];


},{}],13:[function(require,module,exports){
'use strict';

exports.__esModule = true;

exports['default'] = function (instance) {
  instance.registerHelper('lookup', function (obj, field) {
    return obj && obj[field];
  });
};

module.exports = exports['default'];


},{}],14:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('../utils');

exports['default'] = function (instance) {
  instance.registerHelper('with', function (context, options) {
    if (_utils.isFunction(context)) {
      context = context.call(this);
    }

    var fn = options.fn;

    if (!_utils.isEmpty(context)) {
      var data = options.data;
      if (options.data && options.ids) {
        data = _utils.createFrame(options.data);
        data.contextPath = _utils.appendContextPath(options.data.contextPath, options.ids[0]);
      }

      return fn(context, {
        data: data,
        blockParams: _utils.blockParams([context], [data && data.contextPath])
      });
    } else {
      return options.inverse(this);
    }
  });
};

module.exports = exports['default'];


},{"../utils":19}],15:[function(require,module,exports){
'use strict';

exports.__esModule = true;

var _utils = require('./utils');

var logger = {
  methodMap: ['debug', 'info', 'warn', 'error'],
  level: 'info',

  // Maps a given level value to the `methodMap` indexes above.
  lookupLevel: function lookupLevel(level) {
    if (typeof level === 'string') {
      var levelMap = _utils.indexOf(logger.methodMap, level.toLowerCase());
      if (levelMap >= 0) {
        level = levelMap;
      } else {
        level = parseInt(level, 10);
      }
    }

    return level;
  },

  // Can be overridden in the host environment
  log: function log(level) {
    level = logger.lookupLevel(level);

    if (typeof console !== 'undefined' && logger.lookupLevel(logger.level) <= level) {
      var method = logger.methodMap[level];
      if (!console[method]) {
        // eslint-disable-line no-console
        method = 'log';
      }

      for (var _len = arguments.length, message = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        message[_key - 1] = arguments[_key];
      }

      console[method].apply(console, message); // eslint-disable-line no-console
    }
  }
};

exports['default'] = logger;
module.exports = exports['default'];


},{"./utils":19}],16:[function(require,module,exports){
(function (global){
/* global window */
'use strict';

exports.__esModule = true;

exports['default'] = function (Handlebars) {
  /* istanbul ignore next */
  var root = typeof global !== 'undefined' ? global : window,
      $Handlebars = root.Handlebars;
  /* istanbul ignore next */
  Handlebars.noConflict = function () {
    if (root.Handlebars === Handlebars) {
      root.Handlebars = $Handlebars;
    }
    return Handlebars;
  };
};

module.exports = exports['default'];


}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],17:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.checkRevision = checkRevision;
exports.template = template;
exports.wrapProgram = wrapProgram;
exports.resolvePartial = resolvePartial;
exports.invokePartial = invokePartial;
exports.noop = noop;
// istanbul ignore next

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

// istanbul ignore next

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }

var _utils = require('./utils');

var Utils = _interopRequireWildcard(_utils);

var _exception = require('./exception');

var _exception2 = _interopRequireDefault(_exception);

var _base = require('./base');

function checkRevision(compilerInfo) {
  var compilerRevision = compilerInfo && compilerInfo[0] || 1,
      currentRevision = _base.COMPILER_REVISION;

  if (compilerRevision !== currentRevision) {
    if (compilerRevision < currentRevision) {
      var runtimeVersions = _base.REVISION_CHANGES[currentRevision],
          compilerVersions = _base.REVISION_CHANGES[compilerRevision];
      throw new _exception2['default']('Template was precompiled with an older version of Handlebars than the current runtime. ' + 'Please update your precompiler to a newer version (' + runtimeVersions + ') or downgrade your runtime to an older version (' + compilerVersions + ').');
    } else {
      // Use the embedded version info since the runtime doesn't know about this revision yet
      throw new _exception2['default']('Template was precompiled with a newer version of Handlebars than the current runtime. ' + 'Please update your runtime to a newer version (' + compilerInfo[1] + ').');
    }
  }
}

function template(templateSpec, env) {
  /* istanbul ignore next */
  if (!env) {
    throw new _exception2['default']('No environment passed to template');
  }
  if (!templateSpec || !templateSpec.main) {
    throw new _exception2['default']('Unknown template object: ' + typeof templateSpec);
  }

  templateSpec.main.decorator = templateSpec.main_d;

  // Note: Using env.VM references rather than local var references throughout this section to allow
  // for external users to override these as psuedo-supported APIs.
  env.VM.checkRevision(templateSpec.compiler);

  function invokePartialWrapper(partial, context, options) {
    if (options.hash) {
      context = Utils.extend({}, context, options.hash);
      if (options.ids) {
        options.ids[0] = true;
      }
    }

    partial = env.VM.resolvePartial.call(this, partial, context, options);
    var result = env.VM.invokePartial.call(this, partial, context, options);

    if (result == null && env.compile) {
      options.partials[options.name] = env.compile(partial, templateSpec.compilerOptions, env);
      result = options.partials[options.name](context, options);
    }
    if (result != null) {
      if (options.indent) {
        var lines = result.split('\n');
        for (var i = 0, l = lines.length; i < l; i++) {
          if (!lines[i] && i + 1 === l) {
            break;
          }

          lines[i] = options.indent + lines[i];
        }
        result = lines.join('\n');
      }
      return result;
    } else {
      throw new _exception2['default']('The partial ' + options.name + ' could not be compiled when running in runtime-only mode');
    }
  }

  // Just add water
  var container = {
    strict: function strict(obj, name) {
      if (!(name in obj)) {
        throw new _exception2['default']('"' + name + '" not defined in ' + obj);
      }
      return obj[name];
    },
    lookup: function lookup(depths, name) {
      var len = depths.length;
      for (var i = 0; i < len; i++) {
        if (depths[i] && depths[i][name] != null) {
          return depths[i][name];
        }
      }
    },
    lambda: function lambda(current, context) {
      return typeof current === 'function' ? current.call(context) : current;
    },

    escapeExpression: Utils.escapeExpression,
    invokePartial: invokePartialWrapper,

    fn: function fn(i) {
      var ret = templateSpec[i];
      ret.decorator = templateSpec[i + '_d'];
      return ret;
    },

    programs: [],
    program: function program(i, data, declaredBlockParams, blockParams, depths) {
      var programWrapper = this.programs[i],
          fn = this.fn(i);
      if (data || depths || blockParams || declaredBlockParams) {
        programWrapper = wrapProgram(this, i, fn, data, declaredBlockParams, blockParams, depths);
      } else if (!programWrapper) {
        programWrapper = this.programs[i] = wrapProgram(this, i, fn);
      }
      return programWrapper;
    },

    data: function data(value, depth) {
      while (value && depth--) {
        value = value._parent;
      }
      return value;
    },
    merge: function merge(param, common) {
      var obj = param || common;

      if (param && common && param !== common) {
        obj = Utils.extend({}, common, param);
      }

      return obj;
    },

    noop: env.VM.noop,
    compilerInfo: templateSpec.compiler
  };

  function ret(context) {
    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var data = options.data;

    ret._setup(options);
    if (!options.partial && templateSpec.useData) {
      data = initData(context, data);
    }
    var depths = undefined,
        blockParams = templateSpec.useBlockParams ? [] : undefined;
    if (templateSpec.useDepths) {
      if (options.depths) {
        depths = context !== options.depths[0] ? [context].concat(options.depths) : options.depths;
      } else {
        depths = [context];
      }
    }

    function main(context /*, options*/) {
      return '' + templateSpec.main(container, context, container.helpers, container.partials, data, blockParams, depths);
    }
    main = executeDecorators(templateSpec.main, main, container, options.depths || [], data, blockParams);
    return main(context, options);
  }
  ret.isTop = true;

  ret._setup = function (options) {
    if (!options.partial) {
      container.helpers = container.merge(options.helpers, env.helpers);

      if (templateSpec.usePartial) {
        container.partials = container.merge(options.partials, env.partials);
      }
      if (templateSpec.usePartial || templateSpec.useDecorators) {
        container.decorators = container.merge(options.decorators, env.decorators);
      }
    } else {
      container.helpers = options.helpers;
      container.partials = options.partials;
      container.decorators = options.decorators;
    }
  };

  ret._child = function (i, data, blockParams, depths) {
    if (templateSpec.useBlockParams && !blockParams) {
      throw new _exception2['default']('must pass block params');
    }
    if (templateSpec.useDepths && !depths) {
      throw new _exception2['default']('must pass parent depths');
    }

    return wrapProgram(container, i, templateSpec[i], data, 0, blockParams, depths);
  };
  return ret;
}

function wrapProgram(container, i, fn, data, declaredBlockParams, blockParams, depths) {
  function prog(context) {
    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    var currentDepths = depths;
    if (depths && context !== depths[0]) {
      currentDepths = [context].concat(depths);
    }

    return fn(container, context, container.helpers, container.partials, options.data || data, blockParams && [options.blockParams].concat(blockParams), currentDepths);
  }

  prog = executeDecorators(fn, prog, container, depths, data, blockParams);

  prog.program = i;
  prog.depth = depths ? depths.length : 0;
  prog.blockParams = declaredBlockParams || 0;
  return prog;
}

function resolvePartial(partial, context, options) {
  if (!partial) {
    if (options.name === '@partial-block') {
      partial = options.data['partial-block'];
    } else {
      partial = options.partials[options.name];
    }
  } else if (!partial.call && !options.name) {
    // This is a dynamic partial that returned a string
    options.name = partial;
    partial = options.partials[partial];
  }
  return partial;
}

function invokePartial(partial, context, options) {
  options.partial = true;
  if (options.ids) {
    options.data.contextPath = options.ids[0] || options.data.contextPath;
  }

  var partialBlock = undefined;
  if (options.fn && options.fn !== noop) {
    options.data = _base.createFrame(options.data);
    partialBlock = options.data['partial-block'] = options.fn;

    if (partialBlock.partials) {
      options.partials = Utils.extend({}, options.partials, partialBlock.partials);
    }
  }

  if (partial === undefined && partialBlock) {
    partial = partialBlock;
  }

  if (partial === undefined) {
    throw new _exception2['default']('The partial ' + options.name + ' could not be found');
  } else if (partial instanceof Function) {
    return partial(context, options);
  }
}

function noop() {
  return '';
}

function initData(context, data) {
  if (!data || !('root' in data)) {
    data = data ? _base.createFrame(data) : {};
    data.root = context;
  }
  return data;
}

function executeDecorators(fn, prog, container, depths, data, blockParams) {
  if (fn.decorator) {
    var props = {};
    prog = fn.decorator(prog, props, container, depths && depths[0], data, blockParams, depths);
    Utils.extend(prog, props);
  }
  return prog;
}


},{"./base":3,"./exception":6,"./utils":19}],18:[function(require,module,exports){
// Build out our basic SafeString type
'use strict';

exports.__esModule = true;
function SafeString(string) {
  this.string = string;
}

SafeString.prototype.toString = SafeString.prototype.toHTML = function () {
  return '' + this.string;
};

exports['default'] = SafeString;
module.exports = exports['default'];


},{}],19:[function(require,module,exports){
'use strict';

exports.__esModule = true;
exports.extend = extend;
exports.indexOf = indexOf;
exports.escapeExpression = escapeExpression;
exports.isEmpty = isEmpty;
exports.createFrame = createFrame;
exports.blockParams = blockParams;
exports.appendContextPath = appendContextPath;
var escape = {
  '&': '&amp;',
  '<': '&lt;',
  '>': '&gt;',
  '"': '&quot;',
  "'": '&#x27;',
  '`': '&#x60;',
  '=': '&#x3D;'
};

var badChars = /[&<>"'`=]/g,
    possible = /[&<>"'`=]/;

function escapeChar(chr) {
  return escape[chr];
}

function extend(obj /* , ...source */) {
  for (var i = 1; i < arguments.length; i++) {
    for (var key in arguments[i]) {
      if (Object.prototype.hasOwnProperty.call(arguments[i], key)) {
        obj[key] = arguments[i][key];
      }
    }
  }

  return obj;
}

var toString = Object.prototype.toString;

exports.toString = toString;
// Sourced from lodash
// https://github.com/bestiejs/lodash/blob/master/LICENSE.txt
/* eslint-disable func-style */
var isFunction = function isFunction(value) {
  return typeof value === 'function';
};
// fallback for older versions of Chrome and Safari
/* istanbul ignore next */
if (isFunction(/x/)) {
  exports.isFunction = isFunction = function (value) {
    return typeof value === 'function' && toString.call(value) === '[object Function]';
  };
}
exports.isFunction = isFunction;

/* eslint-enable func-style */

/* istanbul ignore next */
var isArray = Array.isArray || function (value) {
  return value && typeof value === 'object' ? toString.call(value) === '[object Array]' : false;
};

exports.isArray = isArray;
// Older IE versions do not directly support indexOf so we must implement our own, sadly.

function indexOf(array, value) {
  for (var i = 0, len = array.length; i < len; i++) {
    if (array[i] === value) {
      return i;
    }
  }
  return -1;
}

function escapeExpression(string) {
  if (typeof string !== 'string') {
    // don't escape SafeStrings, since they're already safe
    if (string && string.toHTML) {
      return string.toHTML();
    } else if (string == null) {
      return '';
    } else if (!string) {
      return string + '';
    }

    // Force a string conversion as this will be done by the append regardless and
    // the regex test will do this transparently behind the scenes, causing issues if
    // an object's to string has escaped characters in it.
    string = '' + string;
  }

  if (!possible.test(string)) {
    return string;
  }
  return string.replace(badChars, escapeChar);
}

function isEmpty(value) {
  if (!value && value !== 0) {
    return true;
  } else if (isArray(value) && value.length === 0) {
    return true;
  } else {
    return false;
  }
}

function createFrame(object) {
  var frame = extend({}, object);
  frame._parent = object;
  return frame;
}

function blockParams(params, ids) {
  params.path = ids;
  return params;
}

function appendContextPath(contextPath, id) {
  return (contextPath ? contextPath + '.' : '') + id;
}


},{}],20:[function(require,module,exports){
// Create a simple path alias to allow browserify to resolve
// the runtime on a supported path.
module.exports = require('./dist/cjs/handlebars.runtime')['default'];

},{"./dist/cjs/handlebars.runtime":2}],21:[function(require,module,exports){
module.exports = require("handlebars/runtime")["default"];

},{"handlebars/runtime":20}],22:[function(require,module,exports){
(function (process,global){
(function (global, undefined) {
    "use strict";

    if (global.setImmediate) {
        return;
    }

    var nextHandle = 1; // Spec says greater than zero
    var tasksByHandle = {};
    var currentlyRunningATask = false;
    var doc = global.document;
    var registerImmediate;

    function setImmediate(callback) {
      // Callback can either be a function or a string
      if (typeof callback !== "function") {
        callback = new Function("" + callback);
      }
      // Copy function arguments
      var args = new Array(arguments.length - 1);
      for (var i = 0; i < args.length; i++) {
          args[i] = arguments[i + 1];
      }
      // Store and register the task
      var task = { callback: callback, args: args };
      tasksByHandle[nextHandle] = task;
      registerImmediate(nextHandle);
      return nextHandle++;
    }

    function clearImmediate(handle) {
        delete tasksByHandle[handle];
    }

    function run(task) {
        var callback = task.callback;
        var args = task.args;
        switch (args.length) {
        case 0:
            callback();
            break;
        case 1:
            callback(args[0]);
            break;
        case 2:
            callback(args[0], args[1]);
            break;
        case 3:
            callback(args[0], args[1], args[2]);
            break;
        default:
            callback.apply(undefined, args);
            break;
        }
    }

    function runIfPresent(handle) {
        // From the spec: "Wait until any invocations of this algorithm started before this one have completed."
        // So if we're currently running a task, we'll need to delay this invocation.
        if (currentlyRunningATask) {
            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a
            // "too much recursion" error.
            setTimeout(runIfPresent, 0, handle);
        } else {
            var task = tasksByHandle[handle];
            if (task) {
                currentlyRunningATask = true;
                try {
                    run(task);
                } finally {
                    clearImmediate(handle);
                    currentlyRunningATask = false;
                }
            }
        }
    }

    function installNextTickImplementation() {
        registerImmediate = function(handle) {
            process.nextTick(function () { runIfPresent(handle); });
        };
    }

    function canUsePostMessage() {
        // The test against `importScripts` prevents this implementation from being installed inside a web worker,
        // where `global.postMessage` means something completely different and can't be used for this purpose.
        if (global.postMessage && !global.importScripts) {
            var postMessageIsAsynchronous = true;
            var oldOnMessage = global.onmessage;
            global.onmessage = function() {
                postMessageIsAsynchronous = false;
            };
            global.postMessage("", "*");
            global.onmessage = oldOnMessage;
            return postMessageIsAsynchronous;
        }
    }

    function installPostMessageImplementation() {
        // Installs an event handler on `global` for the `message` event: see
        // * https://developer.mozilla.org/en/DOM/window.postMessage
        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages

        var messagePrefix = "setImmediate$" + Math.random() + "$";
        var onGlobalMessage = function(event) {
            if (event.source === global &&
                typeof event.data === "string" &&
                event.data.indexOf(messagePrefix) === 0) {
                runIfPresent(+event.data.slice(messagePrefix.length));
            }
        };

        if (global.addEventListener) {
            global.addEventListener("message", onGlobalMessage, false);
        } else {
            global.attachEvent("onmessage", onGlobalMessage);
        }

        registerImmediate = function(handle) {
            global.postMessage(messagePrefix + handle, "*");
        };
    }

    function installMessageChannelImplementation() {
        var channel = new MessageChannel();
        channel.port1.onmessage = function(event) {
            var handle = event.data;
            runIfPresent(handle);
        };

        registerImmediate = function(handle) {
            channel.port2.postMessage(handle);
        };
    }

    function installReadyStateChangeImplementation() {
        var html = doc.documentElement;
        registerImmediate = function(handle) {
            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted
            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.
            var script = doc.createElement("script");
            script.onreadystatechange = function () {
                runIfPresent(handle);
                script.onreadystatechange = null;
                html.removeChild(script);
                script = null;
            };
            html.appendChild(script);
        };
    }

    function installSetTimeoutImplementation() {
        registerImmediate = function(handle) {
            setTimeout(runIfPresent, 0, handle);
        };
    }

    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.
    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);
    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;

    // Don't get fooled by e.g. browserify environments.
    if ({}.toString.call(global.process) === "[object process]") {
        // For Node.js before 0.9
        installNextTickImplementation();

    } else if (canUsePostMessage()) {
        // For non-IE10 modern browsers
        installPostMessageImplementation();

    } else if (global.MessageChannel) {
        // For web workers, where supported
        installMessageChannelImplementation();

    } else if (doc && "onreadystatechange" in doc.createElement("script")) {
        // For IE 6â€“8
        installReadyStateChangeImplementation();

    } else {
        // For older browsers
        installSetTimeoutImplementation();
    }

    attachTo.setImmediate = setImmediate;
    attachTo.clearImmediate = clearImmediate;
}(typeof self === "undefined" ? typeof global === "undefined" ? this : global : self));

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"_process":1}],23:[function(require,module,exports){
var trim = require('./trim');

module.exports = function dasherize(str) {
  return trim(str).replace(/([A-Z])/g, '-$1').replace(/[-_\s]+/g, '-').toLowerCase();
};

},{"./trim":31}],24:[function(require,module,exports){
var escapeRegExp = require('./escapeRegExp');

module.exports = function defaultToWhiteSpace(characters) {
  if (characters == null)
    return '\\s';
  else if (characters.source)
    return characters.source;
  else
    return '[' + escapeRegExp(characters) + ']';
};

},{"./escapeRegExp":25}],25:[function(require,module,exports){
var makeString = require('./makeString');

module.exports = function escapeRegExp(str) {
  return makeString(str).replace(/([.*+?^=!:${}()|[\]\/\\])/g, '\\$1');
};

},{"./makeString":26}],26:[function(require,module,exports){
/**
 * Ensure some object is a coerced to a string
 **/
module.exports = function makeString(object) {
  if (object == null) return '';
  return '' + object;
};

},{}],27:[function(require,module,exports){
module.exports = function strRepeat(str, qty){
  if (qty < 1) return '';
  var result = '';
  while (qty > 0) {
    if (qty & 1) result += str;
    qty >>= 1, str += str;
  }
  return result;
};

},{}],28:[function(require,module,exports){
var pad = require('./pad');

module.exports = function lpad(str, length, padStr) {
  return pad(str, length, padStr);
};

},{"./pad":29}],29:[function(require,module,exports){
var makeString = require('./helper/makeString');
var strRepeat = require('./helper/strRepeat');

module.exports = function pad(str, length, padStr, type) {
  str = makeString(str);
  length = ~~length;

  var padlen = 0;

  if (!padStr)
    padStr = ' ';
  else if (padStr.length > 1)
    padStr = padStr.charAt(0);

  switch (type) {
  case 'right':
    padlen = length - str.length;
    return str + strRepeat(padStr, padlen);
  case 'both':
    padlen = length - str.length;
    return strRepeat(padStr, Math.ceil(padlen / 2)) + str + strRepeat(padStr, Math.floor(padlen / 2));
  default: // 'left'
    padlen = length - str.length;
    return strRepeat(padStr, padlen) + str;
  }
};

},{"./helper/makeString":26,"./helper/strRepeat":27}],30:[function(require,module,exports){
var pad = require('./pad');

module.exports = function rpad(str, length, padStr) {
  return pad(str, length, padStr, 'right');
};

},{"./pad":29}],31:[function(require,module,exports){
var makeString = require('./helper/makeString');
var defaultToWhiteSpace = require('./helper/defaultToWhiteSpace');
var nativeTrim = String.prototype.trim;

module.exports = function trim(str, characters) {
  str = makeString(str);
  if (!characters && nativeTrim) return nativeTrim.call(str);
  characters = defaultToWhiteSpace(characters);
  return str.replace(new RegExp('^' + characters + '+|' + characters + '+$', 'g'), '');
};

},{"./helper/defaultToWhiteSpace":24,"./helper/makeString":26}],32:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/App
/*/
"use strict";

console.info("Portfolio App started");

if (!DEBUG) {
	window.addEventListener("error", function(ev) {
		console.error("Uncaught Error", ev);
	});
}

require("Modernizr");
require("es6-promise").polyfill();
require("classlist-polyfill");
require("raf-polyfill");
require("matches-polyfill");
require("fullscreen-polyfill");
require("math-sign-polyfill");
require("setimmediate");

require("backbone").$ = require("backbone.native");
require("backbone.babysitter");
require("Backbone.Mutators");
require("hammerjs");

// document.addEventListener('DOMContentLoaded', function(ev) {
// 	console.log("%s:[event %s]", ev.target, ev.type);
// });

window.addEventListener("load", function(ev) {
	console.log("%s:[event %s]", ev.target, ev.type);

	// process bootstrap data, let errors go up the stack
	try {
		require("app/model/helper/bootstrap")(window.bootstrap);
	} catch (err) {
		var el = document.selectQuery(".app");
		el.classList.remove("app-initial");
		el.classList.add("app-error");
		throw new Error("bootstrap data error (" + err.message + ")", err.fileName, err.lineNumber);
	} finally { // detele global var
		delete window.bootstrap;
	}

	require("app/view/template/_helpers");
	// require("app/view/template/_partials");
	/** @type {module:app/view/helper/createColorStyleSheet} */
	require("app/view/helper/createColorStyleSheet").call();

	/** @type {module:app/view/AppView} */
	var AppView = require("app/view/AppView");

	/** @type {module:webfontloader} */
	var WebFont = require("webfontloader");
	WebFont.load({
		async: true,
		classes: false,
		custom: {
			families: [
				// "Franklin Gothic FS:n4,n7",
				"Franklin Gothic FS:n4,i4,n7,i7",
				"FolioFigures:n4",
			],
			testStrings: {
				"FolioFigures": "hms"
			},
		},
		active: function() {
			console.info("WebFont::active");
			// AppView.getInstance();
		},
		fontactive: function(familyName, variantFvd) {
			console.info("WebFont::fontactive '%s' (%s)", familyName, variantFvd);
		},
		inactive: function() {
			console.warn("WebFont::inactive");
			// AppView.getInstance();
		},
		fontinactive: function(familyName, variantFvd) {
			console.warn("WebFont::fontinactive '%s' (%s)", familyName, variantFvd);
		},
		// loading: function() {
		// 	console.log("WebFont::loading");
		// },
		// fontloading: function(familyName, variantDesc) {
		// 	console.log("WebFont::fontloading", familyName, JSON.stringify(variantDesc, null, " "));
		// },
	});
	AppView.getInstance();
});


if (DEBUG) {
	// /** @type {module:underscore} */
	// var _ = require("underscore");

	// var isFF = /Firefox/.test(window.navigator.userAgent);
	// var isIOS = /iPad|iPhone/.test(window.navigator.userAgent);
	/*
	if (/Firefox/.test(window.navigator.userAgent)) {
		console.prefix = "# ";
		var shift = [].shift;
		var logWrapFn = function() {
			if (typeof arguments[1] == "string") arguments[1] = console.prefix + arguments[1];
			return shift.apply(arguments).apply(console, arguments);
		};
		console.group = _.wrap(console.group, logWrapFn);
		console.log = _.wrap(console.log, logWrapFn);
		console.info = _.wrap(console.info, logWrapFn);
		console.warn = _.wrap(console.warn, logWrapFn);
		console.error = _.wrap(console.error, logWrapFn);
	}
	*/
	/*
	var saveLogs = function() {
		var logWrapFn = function(name, fn, msg) {
			document.documentElement.appendChild(
				document.createComment("[" + name + "] " + msg));
		};
		console.group = _.wrap(console.group, _.partial(logWrapFn, "group"));
		console.log = _.wrap(console.log, _.partial(logWrapFn, "log"));
		console.info = _.wrap(console.info, _.partial(logWrapFn, "info"));
		console.warn = _.wrap(console.warn, _.partial(logWrapFn, "warn"));
		console.error = _.wrap(console.error, _.partial(logWrapFn, "error"));
	};
	*/

	// handle error events on some platforms and production
	/*
	if (isIOS) {
		// saveLogs();
		window.addEventListener("error", function() {
			var args = Array.prototype.slice.apply(arguments),
				el = document.createElement("div"),
				html = "";
			_.extend(el.style, {
				fontfamily: "monospace",
				display: "block",
				position: "absolute",
				zIndex: "999",
				backgroundColor: "white",
				color: "black",
				width: "calc(100% - 3em)",
				bottom: "0",
				margin: "1em 1.5em",
				padding: "1em 1.5em",
				outline: "0.5em solid red",
				outlineOffset: "0.5em",
				boxSizing: "border-box",
				overflow: "hidden",
			});
			html += "<pre><b>location:<b> " + window.location + "</pre>";
			html += "<pre><b>event:<b> " + JSON.stringify(args.shift(), null, " ") + "</pre>";
			if (args.length) html += "<pre><b>rest:<b> " + JSON.stringify(args, null, " ") + "</pre>";
			el.innerHTML = html;
			document.body.appendChild(el);
		});
	}*/
}
}).call(this,true)

},{"Backbone.Mutators":"Backbone.Mutators","Modernizr":"Modernizr","app/model/helper/bootstrap":42,"app/view/AppView":49,"app/view/helper/createColorStyleSheet":72,"app/view/template/_helpers":101,"backbone":"backbone","backbone.babysitter":"backbone.babysitter","backbone.native":"backbone.native","classlist-polyfill":"classlist-polyfill","es6-promise":"es6-promise","fullscreen-polyfill":"fullscreen-polyfill","hammerjs":"hammerjs","matches-polyfill":"matches-polyfill","math-sign-polyfill":"math-sign-polyfill","raf-polyfill":"raf-polyfill","setimmediate":22,"webfontloader":"webfontloader"}],33:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/control/Controller
/*/

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Backbone = require("backbone");

// /** @type {module:app/model/collection/TypeCollection} */
// var types = require("app/model/collection/TypeCollection");
// /** @type {module:app/model/collection/KeywordCollection} */
// var keywords = require("app/model/collection/KeywordCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");

/* --------------------------- *
/* Static private
/* --------------------------- */

/**
/* @constructor
/* @type {module:app/control/Controller}
/*/
var Controller = Backbone.Router.extend({

	// /** @override */
	// routes: {},

	/** @override */
	initialize: function(options) {
		this._routeNames = [];

		if (DEBUG) {
			this.on("route", function(routeName, args) {
				console.log("controller:[route] %s [%s]", routeName, args.join());
			});
		}

		/*
		 * Prefixed article regexp: /^article(?:\/([^\/]+))\/?$/
		 * Single bundle regexp: /^bundles(?:\/([^\/]+)(?:\/(\d+))?)?\/?$/
		 */
		this.route(/(.*)/,
			"notfound", this.toNotFound);
		this.route(/^([a-z][a-z0-9\-]*)\/?$/,
			"article-item", this.toArticleItem);
		this.route(/^(?:bundles)?\/?$/,
			"root", this.toRoot);
		// this.route(/^bundles\/?$/,
		// 	"bundle-list", this.toBundleList);
		this.route(/^bundles\/([^\/]+)\/?$/,
			"bundle-item", this.toBundleItem);
		this.route(/^bundles\/([^\/]+)\/(\d+)\/?$/,
			"media-item", this.toMediaItem);

		console.log("%s::initialize routes: %o", "controller", this._routeNames);
	},

	route: function(route, name, callback) {
		this._routeNames.push(_.isString(name) ? name : '');
		return Backbone.Router.prototype.route.apply(this, arguments);
	},

	/* ---------------------------
	/* JS to URL: public command methods
	/* --------------------------- */

	selectMedia: function(media) {
		this._goToLocation(media.get("bundle"), media);
	},

	selectBundle: function(bundle) {
		this._goToLocation(bundle);
	},

	deselectMedia: function() {
		this._goToLocation(bundles.selected);
	},

	deselectBundle: function() {
		this._goToLocation();
	},

	selectArticle: function(article) {
		this.navigate(article.get("handle"), { trigger: true });
	},

	deselectArticle: function() {
		this.navigate("", { trigger: true });
	},

	/* ---------------------------
	/* JS to URL: private helpers
	/* --------------------------- */

	/** Update location when navigation happens internally */
	_updateLocation: function() {
		var bundle, media;
		bundle = bundles.selected;
		if (bundle) {
			media = bundle.get("media").selected;
		}
		this.navigate(this._getLocation(bundle, media), {
			trigger: false
		});
	},

	_getLocation: function(bundle, media) {
		var mediaIndex, location = [];
		if (bundle) {
			location.push("bundles");
			location.push(bundle.get("handle"));
			if (media) {
				mediaIndex = bundle.get("media").indexOf(media);
				if (mediaIndex >= 0) {
					location.push(mediaIndex);
				}
			}
		}
		// location.push("");
		return location.join("/");
	},

	_goToLocation: function(bundle, media) {
		this.navigate(this._getLocation(bundle, media), {
			trigger: true
		});
	},

	/* --------------------------- *
	/* URL to JS: router handlers
	/* --------------------------- */

	toRoot: function() {
		this.trigger("change:before");
		if (bundles.selected) {
			bundles.selected.get("media").deselect();
			bundles.deselect();
		}
		// keywords.deselect();
		articles.deselect();
		this.trigger("change:after");
	},

	toNotFound: function(slug) {
		console.info("route:[*:%s]", slug);
	},

	// toBundleList: function() {
	// 	this.navigate("", {
	// 		trigger: true,
	// 		replace: true
	// 	});
	// },

	toBundleItem: function(bundleHandle) {
		var bundle = bundles.findWhere({
			handle: bundleHandle
		});
		if (!bundle) {
			throw new Error("Cannot find bundle with handle \"" + bundleHandle + "\"");
		}
		this._changeSelection(bundle);
	},

	toMediaItem: function(bundleHandle, mediaIndex) {
		var bundle, media;
		// if (bundleHandle) {
		bundle = bundles.findWhere({ handle: bundleHandle });
		if (!bundle) {
			throw new Error("No bundle with handle \"" + bundleHandle + "\" found");
		}
		// if (mediaIndex) {
		media = bundle.get("media").at(mediaIndex);
		if (!media) {
			throw new Error("No media at index " + mediaIndex + " in bundle with handle \"" + bundleHandle + "\" found");
		}
		// }
		// }
		this._changeSelection(bundle, media);
	},

	toArticleItem: function(articleHandle) {
		var article = articles.findWhere({ handle: articleHandle });
		if (!article) {
			throw new Error("Cannot find article with handle \"" + articleHandle + "\"");
		}
		this.trigger("change:before", article);
		bundles.deselect();
		articles.select(article);
		this.trigger("change:after", article);
	},

	/* -------------------------------
	/* URL to JS: private helpers
	/* ------------------------------- */

	/*
	/* NOTE: Selection order
	/* - Apply media selection to *incoming bundle*, as not to trigger
	/*	unneccesary events on an outgoing bundle. Outgoing bundle media selection
	/*	remains untouched.
	/* - Apply media selection *before* selecting the incoming bundle. Views
	/*	normally listen to the selected bundle only, so if the bundle is changing,
	/*	they will not be listening to media selection changes yet.
	/*/
	_changeSelection: function(bundle, media) {
		var lastBundle, lastMedia;
		if (bundle === void 0) bundle = null;
		if (media === void 0) media = null;

		lastBundle = bundles.selected;
		lastMedia = lastBundle ? lastBundle.get("media").selected : null;
		console.log("controller::_changeSelection bundle:[%s -> %s] media:[%s -> %s]",
			(lastBundle ? lastBundle.cid : lastBundle), (bundle ? bundle.cid : bundle),
			(lastMedia ? lastMedia.cid : lastMedia), (media ? media.cid : media)
		);

		if (!articles.selected && (lastBundle === bundle) && (lastMedia === media)) {
			return;
		}

		this.trigger("change:before", bundle, media);
		bundle && bundle.get("media").select(media);
		bundles.select(bundle);
		articles.deselect();
		this.trigger("change:after", bundle, media);
	},
});


module.exports = new Controller();
}).call(this,true)

},{"app/model/collection/ArticleCollection":38,"app/model/collection/BundleCollection":39,"backbone":"backbone","underscore":"underscore"}],34:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/control/Globals
/*/
/** @type {module:underscore} */
var _ = require("underscore");

module.exports = (function() {
	// reusable vars
	var o, s, so;
	// global hash
	var g = {};
	// SASS <--> JS shared hash
	var sass = require("../../../sass/variables.json");

	// JUNK FIRST: Some app-wide defaults
	// - - - - - - - - - - - - - - - - -
	g.VPAN_DRAG = 0.95; // as factor of pointer delta
	g.HPAN_OUT_DRAG = 0.4; // factor
	g.VPAN_OUT_DRAG = 0.1; // factor
	g.PAN_THRESHOLD = 15; // px
	g.COLLAPSE_THRESHOLD = 75; // px
	g.COLLAPSE_OFFSET = parseInt(sass.temp["collapse_offset"]);

	// breakpoints
	// - - - - - - - - - - - - - - - - -
	g.BREAKPOINTS = {};
	for (s in sass.breakpoints) {
		o = sass.breakpoints[s];
		/*if (Array.isArray(o)) {
			g.BREAKPOINTS[s] = Object.defineProperties({}, {
				"matches": {
					get: _.partial(_.some, o.map(window.matchMedia), _.property("matches"))
				},
				"media": {
					value: o.join(", ")
				},
				"queries": {
					value: o.map(window.matchMedia)
				},
			});
		} else {
			g.BREAKPOINTS[s] = window.matchMedia(o);
		}*/
		o = Array.isArray(o) ? o.join(", ") : o;
		o = o.replace(/[\'\"]/g, "");
		o = window.matchMedia(o);
		o.className = s;
		g.BREAKPOINTS[s] = o;
	}
	if (DEBUG) {
		console.group("Breakpoints");
		for (s in g.BREAKPOINTS) {
			// console.log("%s: %o %o", s, g.BREAKPOINTS[s], sass.breakpoints[s] + '');
			console.log("%s: %o", s, g.BREAKPOINTS[s].media);
		}
		console.groupEnd();
	}

	// base colors, dimensions
	// - - - - - - - - - - - - - - - - -
	g.DEFAULT_COLORS = _.clone(sass.default_colors);
	g.HORIZONTAL_STEP = parseFloat(sass.units["hu_px"]);
	g.VERTICAL_STEP = parseFloat(sass.units["vu_px"]);


	// paths, networking
	// - - - - - - - - - - - - - - - - -
	// var toAbsoluteURL = (function() {
	// 	var a = null;
	// 	return function(url) {
	// 		a = a || document.createElement('a');
	// 		a.href = url;
	// 		return a.href;
	// 	};
	// })();
	// g.APP_ROOT = toAbsoluteURL(window.approot);
	// g.MEDIA_DIR = toAbsoluteURL(window.mediadir);

	g.APP_ROOT = window.approot;
	g.MEDIA_DIR = window.mediadir;

	delete window.approot;
	delete window.mediadir;

	// hardcoded font data
	// - - - - - - - - - - - - - - - - -
	g.FONT_METRICS = {
		"Franklin Gothic FS": {
			"unitsPerEm": 1000,
			"ascent": 827,
			"descent": -173
		},
		"ITCFranklinGothicStd": {
			"unitsPerEm": 1000,
			"ascent": 686,
			"descent": -314
		},
		"FolioFigures": {
			"unitsPerEm": 1024,
			"ascent": 939,
			"descent": -256
		},
	};

	g.PAUSE_CHAR = String.fromCharCode(0x23F8);
	g.PLAY_CHAR = String.fromCharCode(0x23F5);
	g.STOP_CHAR = String.fromCharCode(0x23F9);

	// translate common template

	g.TRANSLATE_TEMPLATE = function(x, y) {
		return "translate(" + x + "px, " + y + "px)";
		// return "translate3d(" + x + "px, " + y + "px ,0px)";
	};
	// timing, easing
	// - - - - - - - - - - - - - - - - -
	var ease = g.TRANSITION_EASE = sass.transitions["ease"];
	var duration = g.TRANSITION_DURATION = parseFloat(sass.transitions["duration_ms"]);
	var delayInterval = g.TRANSITION_DELAY_INTERVAL = parseFloat(sass.transitions["delay_interval_ms"]);
	var minDelay = g.TRANSITION_MIN_DELAY = parseFloat(sass.transitions["min_delay_ms"]);
	var delay = g.TRANSITION_DELAY = g.TRANSITION_DURATION + g.TRANSITION_DELAY_INTERVAL;

	// css transition presets
	// TODO: get rid of this
	// - - - - - - - - - - - - - - - - -

	// var tx = function(txo, durationCount, delayCount) {
	// 	txo.duration = (duration * durationCount)
	// 		+ (delayInterval * (durationCount - 1));
	// 	txo.delay = (delay * delayCount) + minDelay;
	// };

	o = {};

	o.NONE = {
		delay: 0,
		duration: 0,
		easing: "step-start"
	};
	o.NOW = {
		delay: 0,
		duration: duration,
		easing: ease
	};
	o.UNSET = _.defaults({
		cssText: ""
	}, o.NONE);

	var txAligned = _.defaults({
		duration: duration - minDelay
	}, o.NOW);
	o.FIRST = _.defaults({
		delay: delay * 0.0 + minDelay
	}, txAligned);
	o.BETWEEN = _.defaults({
		delay: delay * 1.0 + minDelay
	}, txAligned);
	o.LAST = _.defaults({
		delay: delay * 2.0 + minDelay
	}, txAligned);
	o.AFTER = _.defaults({
		delay: delay * 2.0 + minDelay
	}, txAligned);

	o.BETWEEN_EARLY = _.defaults({
		delay: delay * 1.0 + minDelay - 60
	}, txAligned);
	o.BETWEEN_LATE = _.defaults({
		delay: delay * 1.0 + minDelay + 60
	}, txAligned);

	o.FIRST_LATE = _.defaults({
		delay: delay * 0.5 + minDelay
	}, txAligned);
	o.LAST_EARLY = _.defaults({
		delay: delay * 1.5 + minDelay
	}, txAligned);
	// o.FIRST_LATE = 		_.defaults({delay: txDelay*0.0 + txMinDelay*2}, txAligned);
	// o.LAST_EARLY = 		_.defaults({delay: txDelay*2.0 + txMinDelay*0}, txAligned);
	// o.AFTER = 			_.defaults({delay: txDelay*2.0 + txMinDelay}, txAligned);

	console.groupCollapsed("Transitions");
	for (s in o) {
		so = o[s];
		so.name = s;
		so.className = "tx-" + s.replace("_", "-").toLowerCase();
		if (!so.hasOwnProperty("cssText")) {
			so.cssText = so.duration / 1000 + "s " + so.easing + " " + so.delay / 1000 + "s";
		}
		console.log("%s: %s", so.name, so.cssText);
	}
	console.groupEnd();
	g.transitions = o;

	return g;
}());
}).call(this,true)

},{"../../../sass/variables.json":120,"underscore":"underscore"}],35:[function(require,module,exports){
/**
 * @module app/model/BaseItem
 * @requires module:backbone
 */

/** @type {module:backbone} */
var Backbone = require("backbone");

var defaults = {
	routeName: "initial",
	collapsed: false,
	article: null,
	withArticle: false,
	bundle: null,
	withBundle: false,
	media: null,
	withMedia: false,
};

var AppState = Backbone.Model.extend({
	defaults: defaults,
	// getters: Object.keys(defaults),
});

module.exports = AppState;
},{"backbone":"backbone"}],36:[function(require,module,exports){
/**
 * @module app/model/BaseItem
 * @requires module:backbone
 */

/** @type {module:backbone} */
var Model = require("backbone").Model;
/** @type {module:underscore} */
var _ = require("underscore");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
// /** @type {module:app/utils/strings/stripTags} */
// var stripTags = require("utils/strings/stripTags");
// /** @type {module:app/model/parseSymAttrs} */
//var parseSymAttrs = require("app/model/parseSymAttrs");

var parseSymAttrs = function(s) {
	return s.replace(/(\,|\;)/g, function(m) {
		return (m == ",") ? ";" : ",";
	});
};
var toAttrsHash = function(obj, attr) {
	if (_.isString(attr)) {
		var idx = attr.indexOf(":");
		if (idx > 0) {
			obj[attr.substring(0, idx)] = parseSymAttrs(attr.substring(idx + 1));
		} else {
			obj[attr] = attr; // to match HTML5<>XHTML valueless attributes
		}
	} // else ignore non-string values
	return obj;
};

var BaseItemProto = {

	_domPrefix: "_",

	/** @type {Object} */
	defaults: {
		// attrs: function() { return {}; },
		get attrs() {
			return {};
		},
	},

	getters: ["domid"],

	mutators: {
		domid: function() {
			if (!this.hasOwnProperty("_domId"))
				this._domId = this._domPrefix + this.id;
			return this._domId;
		},
		attrs: {
			set: function(key, value, options, set) {
				if (Array.isArray(value)) {
					value = value.reduce(toAttrsHash, {});
				}
				if (!_.isObject(value)) {
					console.error("%s::attrs value not an object or string array", this.cid, value);
					value = {};
				}
				set(key, value, options);
			}
		},
	},

	attr: function(attr) {
		return this.attrs()[attr];
	},

	attrs: function() {
		return this.get("attrs");
	},

	toString: function() {
		return this.get("domid");
	}
};

var BaseItem = {
	extend: function(proto, obj) {
		var constr, propName; //, propDef;
		for (propName in proto) {
			if (proto.hasOwnProperty(propName) && _.isObject(proto[propName])) { //(Object.getPrototypeOf(proto[propName]) === Object.prototype)) {
				_.defaults(proto[propName], BaseItemProto[propName]);
				// console.log("BaseItem::extend '%s:%s' is Object\n%s", proto._domPrefix, p, JSON.stringify(proto[p]));
			}
		}
		// if (proto.properties && this.prototype.properties) {
		// 	_.defaults(proto.properties, this.prototype.properties);
		// }
		constr = Model.extend.apply(this, arguments);

		if (Array.isArray(constr.prototype.getters)) {
			constr.prototype.getters.forEach(function(getterName) {
				Object.defineProperty(constr.prototype, getterName, {
					enumerable: true,
					get: function() {
						return this.get(getterName);
					}
				});
			});
		}
		// if (_.isObject(proto.properties)) {
		// 	for (propName in proto.properties) {
		// 		if (proto.properties.hasOwnProperty(propName)) {
		// 			propDef = proto.properties[propName];
		// 			if (_.isFunction(propDef)) {
		// 				proto.properties[propName] = {
		// 					enumerable: true, get: propDef
		// 				};
		// 			} else if (_.isObject(propDef)){
		// 				propDef.enumerable = true;
		// 			} else {
		// 				delete proto.properties[propName];
		// 			}
		// 		}
		// 	}
		// 	Object.defineProperties(proto, proto.properties);
		// 	delete proto.properties;
		// }
		return constr;
	}
};

/**
 * @constructor
 * @type {module:app/model/BaseItem}
 */
module.exports = BaseItem.extend.call(Model, BaseItemProto, BaseItem);
// module.exports = Model.extend(BaseItemProto, BaseItem);

},{"backbone":"backbone","underscore":"underscore"}],37:[function(require,module,exports){
/**
 * @module app/model/SelectableCollection
 */

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Backbone = require("backbone");

/**
 * @constructor
 * @type {module:app/model/SelectableCollection}
 */
var SelectableCollection = Backbone.Collection.extend({

	initialize: function(models, options) {
		options = _.defaults({}, options, {
			initialSelection: "none",
			silentInitial: true
		});
		this.initialSelection = options.initialSelection;
		this.initialOptions = {
			silent: options.silentInitial
		};
	},

	reset: function(models, options) {
		this.deselect(this.initialOptions);
		Backbone.Collection.prototype.reset.apply(this, arguments);
		if (this.initialSelection === "first" && this.length) {
			this.select(this.at(0), this.initialOptions);
		}
	},

	select: function(newModel, options) {
		if (newModel === void 0) {
			newModel = null;
		}
		if (this.selected === newModel) {
			return;
		}
		var triggerEvents = !(options && options.silent);
		var oldModel = this.selected;

		this.lastSelected = this.selected;
		this.lastSelectedIndex = this.selectedIndex;
		this.selected = newModel;
		this.selectedIndex = this.indexOf(newModel);

		if (oldModel) {
			if (_.isFunction(oldModel.deselect)) {
				oldModel.deselect(options);
			} else if (triggerEvents) {
				oldModel.selected = void 0;
				oldModel.trigger("deselected", newModel, oldModel);
			}
			if (triggerEvents) this.trigger("deselect:one", oldModel);
		} else {
			if (triggerEvents) this.trigger("deselect:none", null);
		}

		if (newModel) {
			if (_.isFunction(newModel.select)) {
				newModel.select(options);
			} else if (triggerEvents) {
				newModel.selected = true;
				newModel.trigger("selected", newModel, oldModel);
			}
			if (triggerEvents) this.trigger("select:one", newModel);
		} else {
			if (triggerEvents) this.trigger("select:none", null);
		}
	},

	deselect: function(options) {
		this.select(null, options);
	},

	selectAt: function(index, options) {
		if (0 > index || index >= this.length) {
			new RangeError("index is out of bounds");
		}
		this.select(this.at(index), options);
	},

	distance: function(a, b) {
		var aIdx, bIdx;

		if (!a) return NaN;
		aIdx = this.indexOf(a);
		if (aIdx == -1) return NaN;

		if (arguments.length == 1) {
			bIdx = this.selectedIndex;
		} else {
			if (!b) return NaN;
			bIdx = this.indexOf(b);
			if (bIdx == -1) return NaN;
		}
		return Math.abs(bIdx - aIdx);
	},

	/* TODO: MOVE INTO MIXIN */

	/** @return boolean	/*/
	hasFollowing: function(model) {
		model || (model = this.selected);
		return this.indexOf(model) < (this.length - 1);
	},

	/** @return next model	*/
	following: function(model) {
		model || (model = this.selected);
		return this.hasFollowing(model) ? this.at(this.indexOf(model) + 1) : null;
	},

	/** @return next model or the beginning if at the end */
	followingOrFirst: function(model) {
		model || (model = this.selected);
		return this.at((this.indexOf(model) + 1) % this.length);
	},

	/** @return boolean	/*/
	hasPreceding: function(model) {
		model || (model = this.selected);
		return this.indexOf(model) > 0;
	},

	/** @return the previous model */
	preceding: function(model) {
		model || (model = this.selected);
		return this.hasPreceding(model) ? this.at(this.indexOf(model) - 1) : null;
	},

	/** @return the previous model or the end if at the beginning */
	precedingOrLast: function(model) {
		model || (model = this.selected);
		var index = this.indexOf(model) - 1;
		return this.at(index > -1 ? index : this.length - 1);
	},

});

module.exports = SelectableCollection;

},{"backbone":"backbone","underscore":"underscore"}],38:[function(require,module,exports){
/**
 * @module app/model/collection/ArticleCollection
 */

/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/model/item/ArticleItem} */
var ArticleItem = require("app/model/item/ArticleItem");

/**
 * @constructor
 * @type {module:app/model/collection/ArticleCollection}
 */
var ArticleCollection = SelectableCollection.extend({

	/** @type {Backbone.Model} */
	model: ArticleItem

});

module.exports = new ArticleCollection();
},{"app/model/SelectableCollection":37,"app/model/item/ArticleItem":43}],39:[function(require,module,exports){
/**
 * @module app/model/collection/BundleCollection
 */

/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/model/item/BundleItem} */
var BundleItem = require("app/model/item/BundleItem");

/**
 * @constructor
 * @type {module:app/model/collection/BundleCollection}
 */
var BundleCollection = SelectableCollection.extend({

	/** @type {Backbone.Model} */
	model: BundleItem,

	/** @type {Function} */
	comparator: function(oa, ob) {
		var a = oa.get("completed");
		var b = ob.get("completed");
		if (a > b) {
			return -1;
		} else if (a < b) {
			return 1;
		} else {
			return 0;
		}
	},

	/** @type {String} */
	url: "/json/bundles/",

});

module.exports = new BundleCollection();

},{"app/model/SelectableCollection":37,"app/model/item/BundleItem":44}],40:[function(require,module,exports){
/**
 * @module app/model/collection/KeywordCollection
 * @requires module:backbone
 */

/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/model/item/KeywordItem} */
var KeywordItem = require("app/model/item/KeywordItem");

/**
 * @constructor
 * @type {module:app/model/collection/KeywordCollection}
 */
var KeywordCollection = SelectableCollection.extend({

	/** @type {Backbone.Model} */
	model: KeywordItem

});

module.exports = new KeywordCollection();

},{"app/model/SelectableCollection":37,"app/model/item/KeywordItem":45}],41:[function(require,module,exports){
/**
 * @module app/model/collection/TypeCollection
 * @requires module:backbone
 */

/** @type {module:backbone} */
var Backbone = require("backbone");

/** @type {module:app/model/item/TypeItem} */
var TypeItem = require("app/model/item/TypeItem");

/**
 * @constructor
 * @type {module:app/model/collection/TypeCollection}
 */
var TypeCollection = Backbone.Collection.extend({

	/** @type {Backbone.Model} */
	model: TypeItem

});

module.exports = new TypeCollection();

},{"app/model/item/TypeItem":48,"backbone":"backbone"}],42:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");

module.exports = function(bootstrap) {

	/** @type {module:app/control/Globals} */
	var Globals = require("app/control/Globals");

	// Globals.GA_TAGS = bootstrap["ga-tags"];
	// Globals.PARAMS = bootstrap["params"];
	// Globals.APP_ROOT = bootstrap["params"]["root"];
	// Globals.MEDIA_DIR = bootstrap["params"]["uploads"];
	Globals.APP_NAME = bootstrap["params"]["website-name"];

	/** @type {module:app/model/collection/TypeCollection} */
	var typeList = require("app/model/collection/TypeCollection");
	/** @type {module:app/model/collection/KeywordCollection} */
	var keywordList = require("app/model/collection/KeywordCollection");
	/** @type {module:app/model/collection/BundleCollection} */
	var bundleList = require("app/model/collection/BundleCollection");
	/** @type {module:app/model/collection/ArticleCollection} */
	var articleList = require("app/model/collection/ArticleCollection");

	// Fix-ups to bootstrap data.
	var articles = bootstrap["articles-all"];
	var types = bootstrap["types-all"];
	var keywords = bootstrap["keywords-all"];
	var bundles = bootstrap["bundles-all"];
	var media = bootstrap["media-all"];

	// Attach media to their bundles
	var mediaByBundle = _.groupBy(media, "bId");

	// Fill-in back-references:
	// Create Keyword.bundleIds from existing Bundle.keywordIds,
	// then Bundle.typeIds from unique Keyword.typeId

	// _.each(bundles, function (bo, bi, ba) {
	bundles.forEach(function(bo, bi, ba) {
		bo.tIds = [];
		bo.media = mediaByBundle[bo.id];
		// _.each(keywords, function (ko, ki, ka) {
		keywords.forEach(function(ko, ki, ka) {
			if (bi === 0) {
				ko.bIds = [];
			}
			// if (_.contains(bo.kIds, ko.id)) {
			if (bo.kIds.indexOf(ko.id) != -1) {
				ko.bIds.push(bo.id);
				// if (!_.contains(bo.tIds, ko.tId)) {
				if (bo.tIds.indexOf(ko.tId) == -1) {
					bo.tIds.push(ko.tId);
				}
			}
		});
	});

	// Fill collection singletons
	articleList.reset(articles);
	typeList.reset(types);
	keywordList.reset(keywords);
	bundleList.reset(bundles);

	// bootstrap["params"] = bootstrap["articles-all"] = bootstrap["types-all"] = bootstrap["keywords-all"] = bootstrap["bundles-all"] = bootstrap["media-all"] = null;
};
},{"app/control/Globals":34,"app/model/collection/ArticleCollection":38,"app/model/collection/BundleCollection":39,"app/model/collection/KeywordCollection":40,"app/model/collection/TypeCollection":41,"underscore":"underscore"}],43:[function(require,module,exports){
/**
 * @module app/model/item/ArticleItem
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");

/**
 * @constructor
 * @type {module:app/model/item/ArticleItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "a",

	/** @type {Object} */
	defaults: {
		name: "",
		handle: "",
		text: ""
	},

});
},{"app/model/BaseItem":36}],44:[function(require,module,exports){
/**
 * @module app/model/item/BundleItem
 * @requires module:backbone
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
var Color = require("color");

/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");
/** @type {module:app/model/item/MediaItem} */
var MediaItem = require("app/model/item/MediaItem");
/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/utils/strings/stripTags} */
var stripTags = require("utils/strings/stripTags");
// /** @type {module:app/utils/strings/parseTaglist} */
// var parseSymAttrs = require("app/model/parseSymAttrs");

// /** @type {module:app/model/collection/KeywordCollection} */
// var keywords = require("app/model/collection/KeywordCollection");

// Globals.DEFAULT_COLORS["color"];
// Globals.DEFAULT_COLORS["background-color"];
var attrsDefault = _.defaults({
	"has-colors": "defaults"
}, Globals.DEFAULT_COLORS);

/** @private */
var MediaCollection = SelectableCollection.extend({
	model: MediaItem,
	comparator: "o"
});

/**
 * @constructor
 * @type {module:app/model/item/BundleItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "b",

	/** @type {Object|Function} */
	// defaults: function() {
	// 	return {
	// 		name: "",
	// 		handle: "",
	// 		desc: "",
	// 		completed: 0,
	// 		kIds: [],
	// 	};
	// },
	defaults: {
		name: "",
		handle: "",
		desc: "",
		completed: 0,
		get kIds() {
			return [];
		},
		// get keywords() { return []; },
	},

	getters: ["name", "media"],

	mutators: {
		text: function() {
			return stripTags(this.get("desc"));
		},
		// kIds: {
		// 	set: function (key, value, options, set) {
		// 		if (Array.isArray(value)) {
		// 			set("keywords", value.map(function(id) {
		// 				var obj = keywords.get(id);
		// 				return obj;
		// 			}, this), options;
		// 		}
		// 		set(key, value, options);
		// 	},
		// },
		media: {
			transient: true,
			set: function(key, value, options, set) {
				if (Array.isArray(value)) {
					value.forEach(function(o) {
						o.bundle = this;
					}, this);
					value = new MediaCollection(value);
				}
				set(key, value, options);
			},
		},
	},

	initialize: function(attrs, options) {
		this.colors = {
			fgColor: new Color(this.attr("color")),
			bgColor: new Color(this.attr("background-color")),
			lnColor: new Color(this.attr("--link-color")),
		};
		this.colors.hasDarkBg = this.colors.fgColor.luminosity() > this.colors.bgColor.luminosity();
	},

	attrs: function() {
		return this._attrs || (this._attrs = _.defaults({}, this.get("attrs"), attrsDefault));
	},
});

},{"app/control/Globals":34,"app/model/BaseItem":36,"app/model/SelectableCollection":37,"app/model/item/MediaItem":46,"color":"color","underscore":"underscore","utils/strings/stripTags":118}],45:[function(require,module,exports){
/**
 * @module app/model/item/KeywordItem
 * @requires module:app/model/BaseItem
 */

/** @type {module:app/model/BaseItem} */
var BaseItem = require("app/model/BaseItem");

// /** @type {module:app/model/collection/TypeCollection} */
// var types = require("app/model/collection/TypeCollection");

/**
 * @constructor
 * @type {module:app/model/item/KeywordItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "k",

	/** @type {Object} */
	defaults: {
		name: "",
		handle: "",
		tId: -1,
	},

	// mutators: {
	// 	tId: {
	// 		set: function (key, value, options, set) {
	// 			var type = types.get(value);
	// 			if (type) {
	// 				type.get("keywords").push(this);
	// 				set("type", type, options);
	// 			}
	// 			set(key, value, options);
	// 		}
	// 	},
	// }
});

},{"app/model/BaseItem":36}],46:[function(require,module,exports){
/**
 * @module app/model/item/MediaItem
 * @requires module:backbone
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
var Color = require("color");

/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");
/** @type {module:app/model/item/SourceItem} */
var SourceItem = require("app/model/item/SourceItem");
/** @type {module:app/model/SelectableCollection} */
var SelectableCollection = require("app/model/SelectableCollection");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/utils/strings/stripTags} */
var stripTags = require("utils/strings/stripTags");
// /** @type {module:app/model/parseSymAttrs} */
// var parseSymAttrs = require("app/model/parseSymAttrs");

// console.log(Globals.PARAMS);

var urlTemplates = {
	"original": _.template(Globals.MEDIA_DIR + "/<%= src %>"),
	"constrain-width": _.template(Globals.APP_ROOT + "image/1/<%= width %>/0/uploads/<%= src %>"),
	"constrain-height": _.template(Globals.APP_ROOT + "image/1/0/<%= height %>/uploads/<%= src %>"),
	"debug-bandwidth": _.template(Globals.MEDIA_DIR.replace(/(https?\:\/\/[^\/]+)/, "$1/slow/<%= kbps %>") + "/<%= src %>"),
};

/**
 * @constructor
 * @type {module:app/model/item/MediaItem.SourceCollection}
 */
var SourceCollection = SelectableCollection.extend({
	model: SourceItem
});

/**
 * @constructor
 * @type {module:app/model/item/MediaItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "m",

	/** @type {Object} */
	defaults: {
		name: "<p><em>Untitled</em></p>",
		sub: "",
		o: 0,
		bId: -1,
		srcIdx: 0,
		get srcset() {
			return [];
		},
		get sources() {
			return new SourceCollection();
		},
	},

	getters: ["name", "bundle", "source", "sources"],

	mutators: {
		// desc: function() {
		// 	return this.get("name");
		// },
		handle: function() {
			return this.get("src");
		},
		text: function() {
			if (!this.hasOwnProperty("_text"))
				this._text = _.unescape(stripTags(this.get("name")));
			return this._text;
		},
		attrs: {
			set: function(key, value, opts, set) {
				this._attrs = null;
				BaseItem.prototype.mutators.attrs.set.apply(this, arguments);
				this._updateSources();
			}
		},
		srcset: {
			set: function(key, value, opts, set) {
				set(key, value, opts);
				this.get("sources").reset(value, opts);
				this._updateSources();
			}
		},
		source: {
			transient: true,
			get: function() {
				return this.get("sources").at(this.get("srcIdx"));
			},
		},
	},

	initialize: function() {
		this._updateColors();
		this.listenTo(this, "change:attrs change:bundle", function() {
			this._attrs = null;
		});
	},

	attrs: function() {
		return this._attrs || (this._attrs = _.defaults({}, this.get("bundle").attrs(), this.get("attrs")));
	},

	_updateColors: function() {
		this.colors = {
			fgColor: new Color(this.attr("color")),
			bgColor: new Color(this.attr("background-color"))
		};
		this.colors.hasDarkBg = this.colors.fgColor.luminosity() > this.colors.bgColor.luminosity();
	},

	_updateSources: function() {
		var srcObj = {
			kbps: this.attr("@debug-bandwidth")
		};
		var srcTpl = urlTemplates[srcObj.kbps ? "debug-bandwidth" : "original"];
		this.get("sources").forEach(function(item) {
			srcObj.src = item.get("src");
			item.set("original", srcTpl(srcObj));
		});
	},

	// _updateSourcesArr: function() {
	// 	var srcset = this.get("srcset");
	// 	if (Array.isArray(srcset)) {
	// 		var srcObj = { kbps: this.attr("@debug-bandwidth") };
	// 		var srcTpl = Globals.MEDIA_SRC_TPL[srcObj.kbps? "debug-bandwidth" : "original"];
	// 		srcset.forEach(function(o) {
	// 			srcObj.src = o.src;
	// 			o.original = srcTpl(srcObj);
	// 		}, this);
	// 	}
	// 	this.get("sources").reset(srcset);
	// },

});
},{"app/control/Globals":34,"app/model/BaseItem":36,"app/model/SelectableCollection":37,"app/model/item/SourceItem":47,"color":"color","underscore":"underscore","utils/strings/stripTags":118}],47:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/model/item/SourceItem
 * @requires module:backbone
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");

/** @type {String} */
var noCacheSuffix = "?" + Date.now();

/**
 * @constructor
 * @type {module:app/model/item/SourceItem}
 */
// module.exports = Backbone.Model.extend({
module.exports = BaseItem.extend({

	/** @type {Object} */
	defaults: {
		src: null,
		mime: null,
		w: null,
		h: null,
	},

	getters: ["src", "original"],

	mutators: {
		src: {
			set: function(key, value, options, set) {
				if (DEBUG) {
					value += noCacheSuffix;
				}
				set(key, value, options);
			}
		},
		// original: { 
		// 	transient: true,
		// 	get: function (key, value, options, set) {
		// 		return this.attributes.original || (this.attributes.original = this._composeOriginalSrc());
		// 	},
		// },
		// media: {
		// 	transient: true,
		// 	get: function () {
		// 		var retval;
		// 		if (this._noRecusion) {
		// 			console.log("%s::media returning null", this.cid);
		// 			retval = null;//this.id;
		// 		} else {
		// 			console.log("%s::media returning Object", this.cid);
		// 			this._noRecusion = true;
		// 			retval = this.attributes.media;
		// 			this._noRecusion = false;
		// 		}
		// 		return retval;
		// 	},
		// 	set: function (key, value, options, set) {
		// 		if (value instanceof BaseItem) {
		// 			set(key, value, options);
		// 		}
		// 	},
		// },
	},

	// initialize: function() {
	// 	if (DEBUG) {
	// 		var cb = function() {
	// 			// console.log("@debug-bandwidth:", JSON.stringify(this.get("media").attr("@debug-bandwidth")));
	// 			console.log("media:", JSON.stringify(this.toJSON()));
	// 			// if ((this.get("media") instanceof BaseItem) && this.get("media").attr("@debug-bandwidth")) {
	// 			// 	console.log("original", this.get("original"));
	// 			// 	console.log("media:", JSON.stringify(this.get("media").toJSON()));
	// 			// }
	// 		}.bind(this);
	// 		window.requestAnimationFrame(cb);
	// 	}
	// },
	// 
	// _composeOriginalSrc: function() {
	// 	var values = { src: this.get("src") };
	// 	if (this.has("media") && (values.kbps = this.get("media").attr("@debug-bandwidth"))) {
	// 	// if (this.has("media") && this.get("media").attrs().hasOwnProperty("@debug-bandwidth")) {
	// 	// 	values.kbps = this.get("media").attrs()["@debug-bandwidth"];
	// 		return Globals.MEDIA_SRC_TPL["debug-bandwidth"](values);
	// 	}
	// 	return Globals.MEDIA_SRC_TPL["original"](values);
	// },
});

}).call(this,true)

},{"app/model/BaseItem":36}],48:[function(require,module,exports){
/**
 * @module app/model/item/TypeItem
 */

// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/model/item/SourceItem} */
var BaseItem = require("app/model/BaseItem");

/**
 * @constructor
 * @type {module:app/model/item/TypeItem}
 */
module.exports = BaseItem.extend({

	_domPrefix: "t",

	/** @type {Object} */
	defaults: {
		name: "",
		handle: "",
		// get kIds() { return []; },
		// get keywords() { return []; },
	},

});

},{"app/model/BaseItem":36}],49:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/view/AppView
/*/

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Backbone = require("backbone");
// /** @type {Function} */
// var Color = require("color");

/** @type {module:app/utils/debug/traceArgs} */
var stripTags = require("utils/strings/stripTags");
// /** @type {Function} */
// var prefixedProperty = require("utils/prefixedProperty");
// /** @type {Function} */
// var prefixedEvent = require("utils/prefixedEvent");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/view/base/TouchManager} */
var TouchManager = require("app/view/base/TouchManager");
/** @type {module:app/control/Controller} */
var controller = require("app/control/Controller");
/** @type {module:app/model/AppState} */
var AppState = require("app/model/AppState");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/NavigationView} */
var NavigationView = require("app/view/NavigationView");
/** @type {module:app/view/ContentView} */
var ContentView = require("app/view/ContentView");

var AppView = {
	getInstance: function() {
		if (!(window.app instanceof this)) {
			window.app = new(this)({
				model: new AppState()
			});
		}
		return window.app;
	}
};

var AppViewProto = {

	/** @override */
	cidPrefix: "app",
	/** @override */
	el: "html",
	// /** @override */
	className: "app without-bundle without-media without-article",
	/** @override */
	model: AppState,

	/** @override */
	events: {
		"visibilitychange": function(ev) {
			console.log(ev.type);
		},
		"fullscreenchange": function(ev) {
			console.log(ev.type);
		},
		// "scroll #container": function(ev) {
		// 	console.log(ev.type, ev);
		// }
	},

	properties: {
		container: {
			get: function() {
				return this._container || (this._container =
					// document.getElementById("container")
					document.body
				);
			}
		}
	},

	/** @override */
	initialize: function(options) {
		/* create single hammerjs manager */
		this.touch = TouchManager.init(this.container);
		this.touch.set({
			enable: (function() {
				return this.el.scrollHeight == this.el.clientHeight;
				// return this.el.scrollTop === 0;
				// return this.container.scrollTop === 0;
				// return this.model.get("collapsed") && this.model.get("withBundle");
			}).bind(this)
		});

		// this._afterRender = this._afterRender.bind(this);
		this._onResize = this._onResize.bind(this);

		/* render on resize, onorientationchange, visibilitychange */
		window.addEventListener("orientationchange", this._onResize, false);
		window.addEventListener("resize", _.debounce(this._onResize, 100, false /* immediate? */ ), false);

		// var h = function(ev) { console.log(ev.type, ev) };
		// window.addEventListener("scroll", h, false);
		// window.addEventListener("wheel", h, false);

		/* TODO: replace resize w/ mediaquery listeners. Caveat: some components
		(vg. Carousel) require update on resize */
		// this._onBreakpointChange = this._onBreakpointChange.bind(this);
		// Object.keys(Globals.BREAKPOINTS).forEach(function(s) {
		// 	Globals.BREAKPOINTS[s].addListener(this._onBreakpointChange);
		// }, this);

		/* initialize controller/model listeners BEFORE views register their own */
		this.listenTo(controller, "route", this._onRoute);
		// this.listenTo(controller, "change:after", this._afterControllerChanged);
		this.listenTo(this.model, "change", this._onModelChange); /* FIXME */

		/* initialize views */
		this.navigationView = new NavigationView({
			el: "#navigation",
			model: this.model
		});
		this.contentView = new ContentView({
			el: "#content",
			model: this.model
		});

		/* Google Analytics */
		if (window.ga && window.GA_ID) {
			controller
				.once("route", function() {
					window.ga("create", window.GA_ID, "auto");
					// if localhost or dummy ID, disable analytics
					if (/(?:(localhost|\.local))$/.test(location.hostname)
						|| window.GA_ID == "UA-9123564-8") {
						window.ga("set", "sendHitTask", null);
					}
				})
				.on("route", function(name) {
					var page = Backbone.history.getFragment();
					// Add a slash if neccesary
					page.replace(/^(?!\/)/, "/");
					window.ga("set", "page", page);
					window.ga("send", "pageview");
				});
		}

		/* Startup listener, added last */
		this.listenToOnce(controller, "route", this._appStart);

		/* start router, which will request appropiate state */
		Backbone.history.start({
			pushState: false,
			hashChange: true,
		});
	},

	/* -------------------------------
	/* _appStart
	/* ------------------------------- */

	_appStart: function() {
		console.info("%s::_appStart", this.cid, arguments[0]);
		this._appStartChanged = true;
		this.requestRender(View.MODEL_INVALID | View.SIZE_INVALID);
	},

	/* --------------------------- *
	/* model changed
	/* --------------------------- */

	_onRoute: function(name, args) {
		var o = _.defaults({ routeName: name }, AppState.prototype.defaults);
		switch (name) {
			case "media-item":
				o.bundle = bundles.selected;
				o.withBundle = true;
				o.media = o.bundle.media.selected;
				o.withMedia = true;
				o.collapsed = true;
				break;
			case "bundle-item":
				o.bundle = bundles.selected;
				o.withBundle = true;
				o.collapsed = true;
				break;
			case "article-item":
				o.article = articles.selected;
				o.withArticle = true;
				o.collapsed = true;
				break;
			case "bundle-list":
			case "notfound":
			case "root":
			default:
				o.collapsed = false;
				break;
		}
		console.info("%s::_onRoute %o -> %o", this.cid, this.model.get("routeName"), name);
		// console.log("%s::_onRoute args: %o", this.cid, name, args);
		this.model.set(o);
	},

	/* --------------------------- *
	/* model changed
	/* --------------------------- */

	_onModelChange: function() {
		// console.log("%s::_onModelChange [START]", this.cid);
		console.group(this.cid + "::_onModelChange [render request]");
		this.requestRender(View.MODEL_INVALID)
			.once("view:render:after", function(view, flags) {
				console.info("%s::_onModelChange [render complete]", view.cid);
				console.groupEnd();
				// .whenRendered().then(function(view) {
				// this.requestAnimationFrame(function() {
				// 	console.log("%s::_onModelChange [next frame]", view.cid);
				// });
			});
	},

	/* -------------------------------
	/* resize
	/* ------------------------------- */

	_onResize: function() {
		// console.log("%s::_onResize [START]", this.cid);
		console.group(this.cid + "::_onResize [render request]");
		this.el.classList.add("skip-transitions");
		this.skipTransitions = true;

		// this.requestRender(View.SIZE_INVALID).renderNow();
		// this.requestAnimationFrame(function() {
		// 	this.el.classList.remove("skip-transitions");
		// }.bind(this));

		this.requestRender(View.SIZE_INVALID)
			.once("view:render:after", function(view, flags) {
				console.info("%s::_onResize [render complete]", view.cid);
				// .whenRendered().then(function(view) {
				this.requestAnimationFrame(function() {
					view.el.classList.remove("skip-transitions");
					this.skipTransitions = false;
					console.info("%s::_onResize [removed skip-tx]", view.cid);
					console.groupEnd();
				})
			});
	},

	// _onBreakpointChange: function(ev) {
	// 	console.log("%s::_onBreakpointChange", this.cid, ev.matches, ev.media, ev.target.className);
	// 	this.requestRender(View.SIZE_INVALID).renderNow();
	// },

	/* -------------------------------
	/* render
	/* ------------------------------- */

	renderFrame: function(tstamp, flags) {
		console.log("%s::renderFrame [%s]", this.cid, View.flagsToString(flags));
		if (flags & View.MODEL_INVALID) {
			this.renderModelChange(flags);
		}
		if (flags & View.SIZE_INVALID) {
			this.renderResize(flags);
			// this.requestChildrenRender(flags, true);
		}
		if (flags & (View.MODEL_INVALID | View.SIZE_INVALID)) {
			// this.requestAnimationFrame(function() {
			// document.body.scrollTop = 0;
			window.scroll({ top: 0, behavior: "smooth" });
			// });
		}
		// request children render
		// set 'now' flag if size is invalid
		this.requestChildrenRender(flags, true);
		// this.requestChildrenRender(flags, flags & View.SIZE_INVALID);

		if (this._appStartChanged) {
			this._appStartChanged = false;
			this.requestAnimationFrame(this.renderAppStart);
		}
	},

	// _afterRender: function() {
	// 	document.body.scrollTop = 0;
	// },

	renderAppStart: function() {
		console.log("%s::renderAppStart", this.cid);
		this.el.classList.remove("app-initial");
		if (this.el.classList.contains("route-initial")) {
			this.el.classList.remove("route-initial");
			console.warn("'route-initial' was still present");
		}
	},

	renderResize: function(flags) {
		// document.body.scrollTop = 0;
		// window.scroll({ top: 0, behavior: "smooth" });

		_.each(Globals.BREAKPOINTS, function(o, s) {
			this.toggle(s, o.matches);
		}, document.documentElement.classList);

		// var bb = _.filter(_.keys(Globals.BREAKPOINTS), function(s) {
		// 	return this.contains(s);
		// }, document.body.classList).join();
		// console.log("%s::renderResize matches: %s", this.cid, bb);

		// this.requestChildrenRender(View.SIZE_INVALID, true);
		// this.requestChildrenRender(flags, true);
	},

	/* -------------------------------
	/* body classes etc
	/* ------------------------------- */

	// _controllerChanged: true,

	renderModelChange: function() {
		console.log("%s::renderModelChange", this.cid);

		var article = this.model.get("article");
		var bundle = this.model.get("bundle");
		var media = this.model.get("media");

		var docTitle = []
		docTitle.push(Globals.APP_NAME);
		if (bundle) {
			docTitle.push(stripTags(bundle.get("name")));
			if (media) {
				docTitle.push(stripTags(media.get("name")));
			}
		} else if (article) {
			docTitle.push(stripTags(article.get("name")));
		}
		document.title = _.unescape(docTitle.join(" / "));

		var cls = this.el.classList;
		var prevAttr = null;

		// Set article class
		if (this.model.hasChanged("article")) {
			prevAttr = this.model.previous("article");
			if (prevAttr) {
				cls.remove(prevAttr.get("domid"));
			}
			if (article) {
				cls.add(article.get("domid"));
			}
		}
		cls.toggle("with-article", !!article);
		cls.toggle("without-article", !article);

		// Set bundle class
		if (this.model.hasChanged("bundle")) {
			prevAttr = this.model.previous("bundle");
			if (prevAttr) {
				cls.remove(prevAttr.get("domid"));
			}
			if (bundle) {
				cls.add(bundle.get("domid"));
			}
		}
		cls.toggle("with-bundle", !!bundle);
		cls.toggle("without-bundle", !bundle);

		// Set media class
		if (this.model.hasChanged("media")) {
			prevAttr = this.model.previous("media");
			if (prevAttr) {
				cls.remove(prevAttr.get("domid"));
			}
			if (media) {
				cls.add(media.get("domid"));
			}
		}
		cls.toggle("with-media", !!media);
		cls.toggle("without-media", !media);

		// Set state classes
		if (this.model.hasChanged("routeName")) {
			prevAttr = this.model.previous("routeName");
			if (prevAttr) {
				cls.remove("route-" + prevAttr);
			}
			cls.add("route-" + this.model.get("routeName"));
		}

		// Set color-dark class
		// cls.toggle("color-dark", hasDarkBg);
		cls.toggle("color-dark",
			(media && media.colors.hasDarkBg) ||
			(bundle && bundle.colors.hasDarkBg));
	},
};

if (DEBUG) {
	/** @type {module:app/view/DebugToolbar} */
	var DebugToolbar = require("app/view/DebugToolbar");

	AppViewProto._onModelChange = (function(fn) {
		return function() {
			var retval;
			console.group(this.cid + "::_onModelChange");
			Object.keys(this.model.changedAttributes()).forEach(function(key) {
				var prev = this.model.previous(key),
					curr = this.model.get(key);
				console.info("%s::_onModelChange %s: %s -> %s", this.cid, key,
					prev && prev.toString(),
					curr && curr.toString());
			}, this);
			console.groupEnd();

			retval = fn.apply(this, arguments);
			return retval;
		};
	})(AppViewProto._onModelChange);

	AppViewProto.initialize = (function(fn) {
		return function() {
			// var ret = fn.apply(this, arguments);
			var view = new DebugToolbar({
				id: "debug-toolbar",
				model: this.model
			});
			document.body.appendChild(view.render().el);
			// this.listenTo(this.model, "change:layoutName", function() {
			// 	this.requestRender(View.SIZE_INVALID); //.renderNow();
			// });
			// return ret;
			return fn.apply(this, arguments);
		};
	})(AppViewProto.initialize);
}

/**
/* @constructor
/* @type {module:app/view/AppView}
/*/
module.exports = View.extend(AppViewProto, AppView);
}).call(this,true)

},{"app/control/Controller":33,"app/control/Globals":34,"app/model/AppState":35,"app/model/collection/ArticleCollection":38,"app/model/collection/BundleCollection":39,"app/view/ContentView":50,"app/view/DebugToolbar":51,"app/view/NavigationView":52,"app/view/base/TouchManager":57,"app/view/base/View":58,"backbone":"backbone","underscore":"underscore","utils/strings/stripTags":118}],50:[function(require,module,exports){
/**
 * @module app/view/NavigationView
 */

/** @type {module:underscore} */
var _ = require("underscore");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:utils/TransformHelper} */
var TransformHelper = require("utils/TransformHelper");
/** @type {module:app/view/base/TouchManager} */
var TouchManager = require("app/view/base/TouchManager");

/** @type {module:app/control/Controller} */
var controller = require("app/control/Controller");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");

// /** @type {module:app/model/collection/BundleItem} */
// var BundleItem = require("app/model/item/BundleItem");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/ArticleView} */
var ArticleView = require("app/view/component/ArticleView");
/** @type {module:app/view/component/CollectionStack} */
var CollectionStack = require("app/view/component/CollectionStack");
/** @type {module:app/view/component/CollectionStack} */
var SelectableListView = require("app/view/component/SelectableListView");
/** @type {module:app/view/render/DotNavigationRenderer} */
var DotNavigationRenderer = require("app/view/render/DotNavigationRenderer");
/** @type {module:app/view/component/Carousel} */
var Carousel = require("app/view/component/Carousel");

/** @type {module:app/view/render/CarouselRenderer} */
var CarouselRenderer = require("app/view/render/CarouselRenderer");
/** @type {module:app/view/render/ImageRenderer} */
var ImageRenderer = require("app/view/render/ImageRenderer");
/** @type {module:app/view/render/VideoRenderer} */
var VideoRenderer = require("app/view/render/VideoRenderer");
/** @type {module:app/view/render/SequenceRenderer} */
var SequenceRenderer = require("app/view/render/SequenceRenderer");
// /** @type {module:app/view/component/ProgressMeter} */
// var ProgressMeter = require("app/view/component/ProgressMeter");

/** @type {Function} */
var carouselEmptyTemplate = require("./template/Carousel.EmptyRenderer.Bundle.hbs");
/** @type {Function} */
var mediaStackTemplate = require("./template/CollectionStack.Media.hbs");

// var transitionEnd = View.prefixedEvent("transitionend");
var transformProp = View.prefixedProperty("transform");
var transitionProp = View.prefixedProperty("transition");

var tx = Globals.transitions;


// var clickEvent = window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup",

/**
 * @constructor
 * @type {module:app/view/ContentView}
 */
var ContentView = View.extend({

	/** @override */
	cidPrefix: "contentView",

	/** @override */
	className: "container-expanded",

	/** @override */
	events: {
		"transitionend .adding-child": "_onAddedTransitionEnd",
		"transitionend .removing-child": "_onRemovedTransitionEnd",
		// "transitionend": "_onTransitionEnd",
	},

	/** @override */
	initialize: function(options) {
		_.bindAll(this, "_onVPanStart", "_onVPanMove", "_onVPanFinal", "_onCollapsedEvent");

		this.transforms = new TransformHelper();
		this.touch = TouchManager.getInstance();

		this.listenTo(this.model, "change", this._onModelChange);

		// disconnect children before last change
		// this.listenTo(bundles, "deselect:one", this._onDeselectOneBundle);

		this.skipTransitions = true;
		this.itemViews = [];

		// this.progressWrapper = this.createProgressWrapper(),
		// this.el.appendChild(this.progressWrapper.el);
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		// values
		var collapsed = this.model.get("collapsed");
		var collapsedChanged = (flags & View.MODEL_INVALID)
			&& this.model.hasChanged("collapsed");
		var childrenChanged = (flags & View.MODEL_INVALID)
			&& (this.model.hasChanged("bundle") || this.model.hasChanged("article"));

		// flags
		var sizeChanged = !!(flags & View.SIZE_INVALID);
		var transformsChanged = !!(flags & (View.MODEL_INVALID | View.SIZE_INVALID | View.LAYOUT_INVALID));
		transformsChanged = transformsChanged || this._transformsChanged || this.skipTransitions;

		// debug
		// - - - - - - - - - - - - - - - - -
		// if (flags & View.MODEL_INVALID) {
		// 	console.group(this.cid + "::renderFrame model changed:");
		// 	Object.keys(this.model.changed).forEach(function(key) {
		// 		console.log("\t%s: %s -> %s", key, this.model._previousAttributes[key], this.model.changed[key]);
		// 	}, this);
		// 	console.groupEnd();
		// }

		// model:children
		// - - - - - - - - - - - - - - - - -
		if (childrenChanged) {
			this.removeChildren();
			if (bundles.selected) {
				this.createChildren(bundles.selected);
			} else
			if (articles.selected) {
				this.createChildren(articles.selected);
			}
		}

		// model:collapsed
		// - - - - - - - - - - - - - - - - -
		if (collapsedChanged) {
			this.el.classList.toggle("container-collapsed", collapsed);
			this.el.classList.toggle("container-expanded", !collapsed);
		}

		// size
		// - - - - - - - - - - - - - - - - -
		if (sizeChanged) {
			this.transforms.clearAllCaptures();
		}

		// transforms
		// - - - - - - - - - - - - - - - - -
		if (transformsChanged) {
			this.el.classList.remove("container-changing");
			if (this.skipTransitions) {
				this.transforms.stopAllTransitions();
				this.el.classList.remove("container-changed");
				if (!childrenChanged) {
					// this.transforms.clearAllOffsets();
					if (collapsedChanged) {
						this._setChildrenEnabled(collapsed);
					}
				}
			} else {
				if (!childrenChanged) {
					if (collapsedChanged) {
						var afterTransitionsFn;
						this.el.classList.add("container-changed");
						// this.transforms.clearAllOffsets();
						if (collapsed) {
							// container-collapsed, enable last
							afterTransitionsFn = function() {
								this._setChildrenEnabled(true);
								this.el.classList.remove("container-changed");
							};
							this.transforms.runAllTransitions(tx.LAST);
						} else {
							// container-expanded, disable first
							afterTransitionsFn = function() {
								this.el.classList.remove("container-changed");
							};
							this._setChildrenEnabled(false);
							this.transforms.runAllTransitions(tx.FIRST);
						}
						afterTransitionsFn = afterTransitionsFn.bind(this);
						this.transforms.whenAllTransitionsEnd().then(afterTransitionsFn, afterTransitionsFn);
					} else {
						this.transforms.items.forEach(function(o) {
							if (o.hasOffset) {
								o.runTransition(tx.NOW);
								// o.clearOffset();
							}
						});
					}
				}
			}
			if (!childrenChanged) {
				this.transforms.clearAllOffsets();
			}
			this.transforms.validate();
		}
		if (sizeChanged) {
			this.itemViews.forEach(function(view) {
				view.skipTransitions = this.skipTransitions;
				// view.invalidateSize();
				// view.renderNow();
				view.requestRender(View.SIZE_INVALID).renderNow();
			}, this);
		}
		this.skipTransitions = this._transformsChanged = false;
	},

	_setChildrenEnabled: function(enabled) {
		// if (enabled) {
		// 	this.el.removeEventListener("click", this._onCollapsedClick, false);
		// } else {
		// 	this.el.addEventListener("click", this._onCollapsedClick, false);
		// }
		this.itemViews.forEach(function(view) {
			view.setEnabled(enabled);
		});
	},

	_onCollapsedEvent: function(ev) {
		console.log("%s:[%s -> _onCollapsedEvent] target: %s", this.cid, ev.type, ev.target);
		if (!ev.defaultPrevented && this.model.get("withBundle") && !this.model.get("collapsed") && !this.enabled) {
			// this.setImmediate(function() {
			// if (ev.type == "click") ev.stopPropagation();
			ev.preventDefault();
			this.setImmediate(function() {
				// if (ev.type == "click") ev.stopPropagation();
				this.model.set("collapsed", true);
			});
			// });
		}
	},
	/* --------------------------- *
	/* model changed
	/* --------------------------- */

	_onModelChange: function() {
		if (this.model.hasChanged("withBundle")) {
			if (this.model.get("withBundle")) {
				this.touch.on("vpanstart", this._onVPanStart);
			} else {
				this.touch.off("vpanstart", this._onVPanStart);
			}
		}
		if (this.model.hasChanged("collapsed") || this.model.hasChanged("withBundle")) {
			if (this.model.get("withBundle") && !this.model.get("collapsed")) {
				this.touch.on("hpanleft hpanright", this._onCollapsedEvent);
				this.el.addEventListener("click", this._onCollapsedEvent, false);
			} else {
				this.touch.off("hpanleft hpanright", this._onCollapsedEvent);
				this.el.removeEventListener("click", this._onCollapsedEvent, false);
			}
		}
		this.requestRender(View.MODEL_INVALID);
	},

	/* -------------------------------
	/* Vertical touch/move (_onVPan*)
	/* ------------------------------- */

	_collapsedOffsetY: Globals.COLLAPSE_OFFSET,

	_onVPanStart: function(ev) {
		this.touch.on("vpanmove", this._onVPanMove);
		this.touch.on("vpanend vpancancel", this._onVPanFinal);

		this.transforms.stopAllTransitions();
		// this.transforms.clearAllOffsets();
		// this.transforms.validate();
		this.transforms.clearAllCaptures();

		this.el.classList.add("container-changing");
		this._onVPanMove(ev);
	},

	_onVPanMove: function(ev) {
		var collapsed = this.model.get("collapsed");
		var delta = ev.deltaY; //ev.thresholdDeltaY;
		var maxDelta = this._collapsedOffsetY; // + Math.abs(ev.thresholdOffsetY);

		// check if direction is aligned with collapsed/expand
		var isValidDir = collapsed ? (delta > 0) : (delta < 0);
		var moveFactor = collapsed ? Globals.VPAN_DRAG : 1 - Globals.VPAN_DRAG;

		delta = Math.abs(delta); // remove sign
		delta *= moveFactor;
		maxDelta *= moveFactor;

		if (isValidDir) {
			if (delta > maxDelta) { // overshooting
				delta = ((delta - maxDelta) * Globals.VPAN_OUT_DRAG) + maxDelta;
			} else { // no overshooting
				// delta = delta;
			}
		} else {
			delta = (-delta) * Globals.VPAN_OUT_DRAG; // delta is opposite
		}
		delta *= collapsed ? 1 : -1; // reapply sign

		this.transforms.offsetAll(0, delta);
		this.transforms.validate();
	},

	_onVPanFinal: function(ev) {
		this.touch.off("vpanmove", this._onVPanMove);
		this.touch.off("vpanend vpancancel", this._onVPanFinal);

		// FIXME: model.collapsed may have already changed, _onVPanMove would run with wrong values:
		// model.collapsed is changed in a setImmediate callback from NavigationView.

		this._onVPanMove(ev);
		this.setImmediate(function() {
			this._transformsChanged = true;
			this.requestRender();
		});
	},

	// willCollapsedChange: function(ev) {
	// 	var collapsed = this.model.get("collapsed");
	// 	return ev.type == "vpanend"? collapsed?
	// 		ev.thresholdDeltaY > Globals.COLLAPSE_THRESHOLD :
	// 		ev.thresholdDeltaY < -Globals.COLLAPSE_THRESHOLD :
	// 		false;
	// },

	/* -------------------------------
	/* create/remove children on bundle selection
	/* ------------------------------- */

	/** Create children on bundle select */
	createChildren: function(model) {
		var view;
		if (model.__proto__.constructor === bundles.model) {
			// will be attached to dom in this order
			view = this.createMediaCaptionStack(model);
			this.itemViews.push(view);
			this.transforms.add(view.el);
			view = this.createMediaCarousel(model);
			this.itemViews.push(view);
			this.transforms.add(view.el);
			view = this.createMediaDotNavigation(model);
			this.itemViews.push(view);
		} else
		if (model.__proto__.constructor === articles.model) {
			view = this.createArticleView(model);
			this.itemViews.push(view);
		}

		this.itemViews.forEach(function(view) {
			if (!this.skipTransitions) {
				view.el.classList.add("adding-child");
				view.el.style.opacity = 0;
			}
			this.el.appendChild(view.el);
			view.render();
		}, this);

		if (!this.skipTransitions) {
			this.requestAnimationFrame(function() {
				console.log("%s::createChildren::[callback:requestAnimationFrame]", this.cid);
				this.itemViews.forEach(function(view) {
					if (!this.skipTransitions) {
						view.el.style[transitionProp] = "opacity " + tx.LAST.cssText;
					}
					view.el.style.removeProperty("opacity");
				}, this);
			});
		}
	},

	removeChildren: function() {
		this.itemViews.forEach(function(view, i, arr) {
			this.transforms.remove(view.el);
			if (this.skipTransitions) {
				view.remove();
			} else {
				var s = window.getComputedStyle(view.el);
				if (s.opacity == "0" || s.visibility == "hidden") {
					console.log("%s::removeChildren [view:%s] removed immediately (invisible)", this.cid, view.cid);
					view.remove();
				} else {
					view.el.classList.add("removing-child");
					if (s[transformProp]) view.el.style[transformProp] = s[transformProp];
					view.el.style[transitionProp] = "opacity " + tx.FIRST.cssText;
					view.el.style.opacity = 0;
				}
			}
			arr[i] = null;
		}, this);
		this.itemViews.length = 0;
	},

	_onAddedTransitionEnd: function(ev) {
		if (ev.target.cid && this.childViews.hasOwnProperty(ev.target.cid)) {
			console.log("%s::_onAddedTransitionEnd [view:%s] [prop:%s] [ev:%s]", this.cid, ev.target.cid, ev.propertyName, ev.type);
			var view = this.childViews[ev.target.cid];
			view.el.classList.remove("adding-child");
			view.el.style.removeProperty(transitionProp);
		}
	},

	_onRemovedTransitionEnd: function(ev) {
		if (ev.target.cid && this.childViews.hasOwnProperty(ev.target.cid)) {
			console.log("%s::_onRemovedTransitionEnd [view:%s] [prop:%s] [ev:%s]", this.cid, ev.target.cid, ev.propertyName, ev.type);
			var view = this.childViews[ev.target.cid];
			view.el.classList.remove("removing-child");
			view.remove();
		}
	},

	// purgeChildren: function() {
	// 	var i, el, els = this.el.querySelectorAll(".removing-child");
	// 	for (i = 0; i < els.length; i++) {
	// 		el = els.item(i);
	// 		if (el.parentElement === this.el) {
	// 			try {
	// 				console.error("%s::purgeChildren", this.cid, el.getAttribute("data-cid"));
	// 				View.findByElement(el).remove();
	// 			} catch (err) {
	// 				console.error("s::purgeChildren", this.cid, "orphaned element", err);
	// 				this.el.removeChild(el);
	// 			}
	// 		}
	// 	}
	// },

	/* -------------------------------
	/* Components
	/* ------------------------------- */


	/**
	 * media-carousel
	 */
	createMediaCarousel: function(bundle) {
		// Create carousel
		var EmptyRenderer = CarouselRenderer.extend({
			className: "carousel-item empty-item",
			model: bundle,
			template: carouselEmptyTemplate,
		});
		var rendererFunction = function(item, index, arr) {
			if (index === -1) {
				return EmptyRenderer;
			}
			switch (item.attr("@renderer")) {
				case "video":
					return VideoRenderer;
				case "sequence":
					return SequenceRenderer;
				case "image":
					return ImageRenderer;
				default:
					return ImageRenderer;
			}
		};
		var view = new Carousel({
			className: "media-carousel " + bundle.get("domid"),
			collection: bundle.get("media"),
			rendererFunction: rendererFunction,
			requireSelection: false,
			direction: Carousel.DIRECTION_HORIZONTAL,
			touch: this.touch,
		});
		controller.listenTo(view, {
			"view:select:one": controller.selectMedia,
			"view:select:none": controller.deselectMedia,
			// "view:removed": controller.stopListening
		});
		view.listenTo(bundle, "deselected", function() {
			this.stopListening(this.collection);
			controller.stopListening(this);
		});
		return view;
	},

	/**
	 * media-caption-stack
	 */
	createMediaCaptionStack: function(bundle) {
		var view = new CollectionStack({
			className: "media-caption-stack",
			collection: bundle.get("media"),
			template: mediaStackTemplate
		});
		view.listenTo(bundle, "deselected", function() {
			this.stopListening(this.collection);
		});
		return view;
	},

	/**
	 * media-dotnav
	 */
	createMediaDotNavigation: function(bundle) {
		var view = new SelectableListView({
			className: "media-dotnav dots-fontface color-fg05",
			collection: bundle.get("media"),
			renderer: DotNavigationRenderer
		});
		controller.listenTo(view, {
			"view:select:one": controller.selectMedia,
			"view:select:none": controller.deselectMedia,
			// "view:removed": controller.stopListening
		});
		view.listenTo(bundle, "deselected", function() {
			this.stopListening(this.collection);
			controller.stopListening(this);
		});
		return view;
	},

	/**
	 * @param el {module:app/model/item/ArticleView}
	 * @return {module:app/view/base/View}
	 */
	createArticleView: function(article) {
		var view = new ArticleView({
			model: article,
		});
		return view;
	},

	// createProgressWrapper: function() {
	// 	// var view = new ProgressMeter({
	// 	// 	id: "media-progress-wrapper",
	// 	// 	// className: "color-bg color-fg05",
	// 	// 	useOpaque: false,
	// 	// 	labelFn: function() { return "0%"; }
	// 	// });
	// 	// this.el.appendChild(this.progressWrapper.el);
	// 	// return view;
	// 	return null;
	// },
});

module.exports = ContentView;
},{"./template/Carousel.EmptyRenderer.Bundle.hbs":96,"./template/CollectionStack.Media.hbs":97,"app/control/Controller":33,"app/control/Globals":34,"app/model/collection/ArticleCollection":38,"app/model/collection/BundleCollection":39,"app/view/base/TouchManager":57,"app/view/base/View":58,"app/view/component/ArticleView":62,"app/view/component/Carousel":63,"app/view/component/CollectionStack":65,"app/view/component/SelectableListView":70,"app/view/render/CarouselRenderer":81,"app/view/render/DotNavigationRenderer":86,"app/view/render/ImageRenderer":88,"app/view/render/SequenceRenderer":93,"app/view/render/VideoRenderer":95,"underscore":"underscore","utils/TransformHelper":103}],51:[function(require,module,exports){
/**
 * @module app/view/DebugToolbar
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:cookies-js} */
var Cookies = require("cookies-js");
// /** @type {module:modernizr} */
// var Modernizr = require("Modernizr");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
// /** @type {module:app/control/Controller} */
// var controller = require("app/control/Controller");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");

/** @type {Function} */
var viewTemplate = require("./template/DebugToolbar.hbs");

/** @type {Function} */
var gridTemplate = require("./template/DebugToolbar.SVGGrid.hbs");

/** @type {Function} */
var sizeTemplate = _.template("<%= w %> \u00D7 <%= h %>");

// var appStateSymbols = { withBundle: "b", withMedia: "m", collapsed: "c"};
// var appStateKeys = Object.keys(appStateSymbols);

var DebugToolbar = View.extend({

	/** @override */
	cidPrefix: "debugToolbar",
	/** @override */
	tagName: "div",
	/** @override */
	className: "toolbar",
	/** @override */
	template: viewTemplate,

	/** @override */
	properties: {
		grid: {
			get: function() {
				return this._grid || (this._grid = this.createGridElement());
			}
		}
	},

	initialize: function(options) {
		Cookies.defaults = {
			expires: new Date(0x7fffffff * 1e3),
			domain: String(window.location)
				.match(/^https?\:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i)[1]
		};

		this.el.innerHTML = this.template({
			tests: Modernizr,
			navigator: window.navigator
		});

		/* toggle's target: container
		/* - - - - - - - - - - - - - - - - */
		var container = document.body; //.querySelector("#container");

		/* create/attach svg grid element
		/* - - - - - - - - - - - - - - - - */
		container.insertBefore(this.createGridElement(), container.firstElementChild);

		/* info elements
		/* - - - - - - - - - - - - - - - - */
		this.backendEl = this.el.querySelector("#edit-backend a");
		this.mediaInfoEl = this.el.querySelector("#media-info span");
		this.appStateEl = this.el.querySelector("#app-state");

		/* toggle visibility
		/* - - - - - - - - - - - - - - - - */
		this.initializeClassToggle("show-links", this.el.querySelector(".debug-links #links-toggle"), this.el,
			function(key, value) {
				this.el.classList.toggle("not-" + key, !value);
				// console.log("%s:initializeClassToggle:[callback] %o", this.cid, arguments);
			}
		);
		this.initializeClassToggle("show-tests", this.el.querySelector("#toggle-tests a"), this.el);
		this.initializeClassToggle("hide-passed", this.el.querySelector("#toggle-passed"), this.el);

		/* toggle container classes
		/* - - - - - - - - - - - - - - - - */
		this.initializeClassToggle("debug-grid-bg", this.el.querySelector("#toggle-grid-bg a"), document.body);
		this.initializeClassToggle("debug-blocks", this.el.querySelector("#toggle-blocks a"), container);
		this.initializeClassToggle("debug-mdown", this.el.querySelector("#toggle-mdown a"), container);
		this.initializeClassToggle("debug-logs", this.el.querySelector("#toggle-logs a"), container);
		this.initializeClassToggle("debug-tx", this.el.querySelector("#toggle-tx a"), container,
			function(key, value) {
				this.el.classList.toggle("show-tx", value);
				this.el.classList.toggle("not-show-tx", !value);
			}
		);

		this.initializeViewportInfo();

		// this.initializeLayoutSelect();

		this.listenTo(this.model, "change", this._onModelChange);
		this._onModelChange();
	},

	initializeViewportInfo: function() {
		var viewportInfoEl = this.el.querySelector("#viewport-info span");
		var callback = function() {
			viewportInfoEl.textContent = sizeTemplate({ w: window.innerWidth, h: window.innerHeight });
		};
		callback.call();
		window.addEventListener("resize", _.debounce(callback, 100, false, false));
	},

	initializeToggle: function(key, toggleEl, callback) {
		var ctx = this;
		var toggleValue = Cookies.get(key) === "true";
		callback.call(ctx, key, toggleValue);

		toggleEl.addEventListener("click", function(ev) {
			if (ev.defaultPrevented) return;
			else ev.preventDefault();
			toggleValue = !toggleValue;
			Cookies.set(key, toggleValue ? "true" : "");
			callback.call(ctx, key, toggleValue);
		}, false);
	},

	initializeClassToggle: function(key, toggleEl, targetEl, callback) {
		var hasCallback = _.isFunction(callback);

		this.initializeToggle(key, toggleEl, function(key, toggleValue) {
			targetEl.classList.toggle(key, toggleValue);
			toggleEl.classList.toggle("toggle-enabled", toggleValue);
			toggleEl.classList.toggle("color-reverse", toggleValue);
			hasCallback && callback.apply(this, arguments);
		});
	},

	_onModelChange: function() {
		console.log("%s::_onModelChange changedAttributes: %o", this.cid, this.model.changedAttributes());
		var i, ii, prop, el, els = this.appStateEl.children;
		for (i = 0, ii = els.length; i < ii; i++) {
			el = els[i];
			prop = el.getAttribute("data-prop");
			el.classList.toggle("has-value", this.model.get(prop));
			el.classList.toggle("has-changed", this.model.hasChanged(prop));
			el.classList.toggle("color-reverse", this.model.hasChanged(prop));
		}

		// NOTE: Always but rewrite CMS href.
		// Only collapsed may have changed, but not worth all the logic
		var attrVal = Globals.APP_ROOT + "symphony/";
		switch (this.model.get("routeName")) {
			case "article-item":
				attrVal += "publish/articles/edit/" + this.model.get("article").id;
				break;
			case "bundle-item":
				attrVal += "publish/bundles/edit/" + this.model.get("bundle").id;
				break;
			case "media-item":
				attrVal += "publish/media/edit/" + this.model.get("media").id;
				break;
			case "root":
				attrVal += "publish/bundles";
				break;
		}
		this.backendEl.setAttribute("href", attrVal);

		if (this.model.hasChanged("media")) {
			if (this.model.has("media")) {
				this.mediaInfoEl.textContent = sizeTemplate(this.model.get("media").get("source").toJSON());
				this.mediaInfoEl.style.display = "";
			} else {
				this.mediaInfoEl.textContent = "";
				this.mediaInfoEl.style.display = "none";
			}
		}
	},

	createGridElement: function() {
		var el = document.createElement("div");
		el.id = "grid-wrapper";
		el.innerHTML = gridTemplate();
		return el;
	},
});

module.exports = DebugToolbar;
},{"./template/DebugToolbar.SVGGrid.hbs":98,"./template/DebugToolbar.hbs":99,"app/control/Globals":34,"app/view/base/View":58,"cookies-js":"cookies-js","underscore":"underscore"}],52:[function(require,module,exports){
/* global MutationObserver */
/**
/* @module app/view/NavigationView
/*/

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:hammerjs} */
var Hammer = require("hammerjs");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:utils/TransformHelper} */
var TransformHelper = require("utils/TransformHelper");
/** @type {module:app/view/base/TouchManager} */
var TouchManager = require("app/view/base/TouchManager");

/** @type {module:app/control/Controller} */
var controller = require("app/control/Controller");
/** @type {module:app/model/collection/TypeCollection} */
var types = require("app/model/collection/TypeCollection");
/** @type {module:app/model/collection/KeywordCollection} */
var keywords = require("app/model/collection/KeywordCollection");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");
/** @type {module:app/model/collection/ArticleCollection} */
var articles = require("app/model/collection/ArticleCollection");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/FilterableListView} */
var FilterableListView = require("app/view/component/FilterableListView");
/** @type {module:app/view/component/GroupingListView} */
var GroupingListView = require("app/view/component/GroupingListView");
// /** @type {module:app/view/component/CollectionPager} */
// var CollectionPager = require("app/view/component/CollectionPager");
/** @type {module:app/view/component/GraphView} */
var GraphView = require("app/view/component/GraphView");
/** @type {module:app/view/component/ArticleButton} */
var ArticleButton = require("app/view/component/ArticleButton");

// /** @type {module:utils/prefixedProperty} */
// var prefixedProperty = require("utils/prefixedProperty");

var tx = Globals.transitions;

/**
/* @constructor
/* @type {module:app/view/NavigationView}
/*/
var NavigationView = View.extend({

	/** @override */
	cidPrefix: "navigationView",

	/** @override */
	className: "container-expanded",

	/** @override */
	initialize: function(options) {
		_.bindAll(this, "_onVPanStart", "_onVPanMove", "_onVPanFinal");
		_.bindAll(this, "_onHPanStart", "_onHPanMove", "_onHPanFinal");
		_.bindAll(this, "_whenTransitionsEnd", "_whenTransitionsAbort");
		_.bindAll(this, "_onNavigationClick");

		// this._metrics = {
		// 	minHeight: 0
		// };
		this.itemViews = [];
		this.transforms = new TransformHelper();
		this.touch = TouchManager.getInstance();

		this.listenTo(this.model, "change", this._onModelChange);

		this.keywordList = this.createKeywordList();
		/* NOTE: .list-group .label moves horizontally (cf. sass/layouts/*.scss) */
		this.hGroupings = this.keywordList.el.querySelectorAll(".list-group .label");
		this.transforms.add(this.hGroupings, this.keywordList.el, this.keywordList.wrapper);
		this.itemViews.push(this.keywordList);

		this.bundleList = this.createBundleList();
		this.transforms.add(this.bundleList.el, this.bundleList.wrapper);
		this.itemViews.push(this.bundleList);

		this.sitename = this.createSitenameButton();
		this.transforms.add(this.sitename.wrapper, this.sitename.el);
		// this.transforms.add(this.sitename.el.firstElementChild, this.sitename.el);

		this.about = this.createArticleButton(articles.findWhere({ handle: "about" }));
		this.transforms.add(this.about.wrapper, this.about.el);

		this.graph = this.createGraphView(this.bundleList, this.keywordList);
		// this.transforms.add(this.graph.el);
		// this.itemViews.push(this.graph);
		// this.listenTo(this.graph, {
		// 	"canvas:update": this._onGraphUpdate,
		// 	"canvas:redraw": this._onGraphRedraw,
		// });

		this.listenTo(this.graph, "view:render:before", function(view, flags) {
			var vmax;
			if (flags & (View.SIZE_INVALID | View.MODEL_INVALID)) {
				// if ((this.bundleList.renderFlags | View.SIZE_INVALID) ||
				// 	(this.keywordList.renderFlags | View.SIZE_INVALID)) {
				// 	view.el.style.height = "";
				// } else {
				vmax = Math.max(
					this.bundleList._metrics.height,
					this.keywordList._metrics.height
				);
				if (vmax) {
					view.el.style.height = vmax + "px";
				}
				// }
				console.log("%s:%s[view:render:before] [%s] h: %s, %s maxh: %o",
					this.cid, view.cid, View.flagsToString(flags),
					this.bundleList._metrics.height,
					this.keywordList._metrics.height,
					vmax || 'invalid');
			}
		});
		// this.listenTo(this.bundleList, "view:render:after", function(view, flags) {
		// 	console.info("%s:[view:render:after %s]", this.cid, view.cid, View.flagsToString(flags & View.SIZE_INVALID));
		// 		if (flags & View.SIZE_INVALID) {
		// 			// console.info("%s:[%s view:render:after] bundleList height", this.cid, view.cid, this.bundleList.el.style.height);
		// 			// this.graph.el.style.height = this.bundleList.el.style.height;
		// 			this.graph.el.style.opacity = this.bundleList.collapsed? 0 : 1;
		// 			this.graph.requestRender(View.SIZE_INVALID).renderNow();
		// 	// 	}
		// });
		// this.listenTo(this.bundleList, "view:render:after", this._onListResize);
		// this.listenTo(this.keywordList, "view:render:after", this._onListResize);
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		if (flags & View.MODEL_INVALID) {
			if (this.model.hasChanged("collapsed")) {
				this.el.classList.toggle("container-collapsed", this.model.get("collapsed"));
				this.el.classList.toggle("container-expanded", !this.model.get("collapsed"));
			}
			if (this.model.hasChanged("collapsed")
				|| this.model.hasChanged("withBundle")) {
				this.el.classList.add("container-changing");
			}
			// if (this.bundleList.invalidated) {
			// 	this.bundleList.invalidate(View.SIZE_INVALID);
			// }
			// if (this.model.hasChanged("bundle")) {
			if (this.model.hasChanged("routeName")) {
				this.bundleList.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
				this.keywordList.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
			}
		}

		// transforms
		// - - - - - - - - - - - - - - - - -
		if (this.skipTransitions ||
			(flags & (View.MODEL_INVALID | View.SIZE_INVALID | View.LAYOUT_INVALID))) {
			// if (transformsChanged) {
			if (this.skipTransitions) {
				this.transforms.stopAllTransitions();
				this.transforms.validate();
				this.transforms.clearAllOffsets();
			} else {
				this.renderTransitions(flags);
			}
			this.transforms.validate();
			// console.log("%s::renderFrame %o", this.cid,
			// 	this.transforms.items.map(function(o) {
			// 		return [o.hasTransition, o.el.localName, o.el.id || o.el.className].join(" : ");
			// 	})
			// );
		}

		if (flags & View.MODEL_INVALID) {
			// if (this.model.hasChanged("collapsed")) {
			//if ((this.model.hasChanged("collapsed") && !this.model.get("collapsed")) || (this.model.hasChanged("withBundle") && !this.model.get("withBundle"))) {
			if (this.model.hasChanged("collapsed")
				|| this.model.hasChanged("withBundle")
				|| this.model.hasChanged("withArticle")) {
				this.transforms.promise().then(this._whenTransitionsEnd, this._whenTransitionsAbort);
			}
		}

		// children loop
		// - - - - - - - - - - - - - - - - -
		this.itemViews.forEach(function(view) {
			view.skipTransitions = view.skipTransitions || this.skipTransitions;
			if (flags & View.SIZE_INVALID) {
				view.requestRender(View.SIZE_INVALID);
			}
			if (!view.skipTransitions) {
				view.renderNow();
			}
		}, this);

		// if ((flags & View.SIZE_INVALID) || (this.model.hasChanged("collapsed") && (flags | View.MODEL_INVALID))) {
		// 	// if (this.model.get("collapsed")) {
		// 	// 	this.el.style.minHeight = "";
		// 	// } else {
		Promise.all([
			this.bundleList.whenRendered(),
			this.keywordList.whenRendered()
		]).then((function(arr) {
			var vmax = arr.reduce(function(a, o) {
				return Math.max(a, o._metrics.height);
			}, 0);
			console.log("%s:[whenRendered flags: %s] height: %o",
				this.cid, View.flagsToString(flags), vmax);
			// if (vmax !== this._metrics.minHeight) {
			// 	this._metrics.minHeight = vmax;
			// this.el.style.minHeight = vmax + "px";
			// }
			this.graph.el.style.height = vmax + "px";
			this.el.style.minHeight = vmax + "px";
			// document.body.scrollTop = 0;
			// window.scrollTo(0, 1)
			// this.requestAnimationFrame(function() {
			// 	window.scrollTo(0, 0);
			// });
		}).bind(this));
		// 	// }
		// }

		// graph
		// - - - - - - - - - - - - - - - - -
		/* collapsed has not changed, no bundle selected */
		if ((flags & (View.SIZE_INVALID | ~View.MODEL_INVALID))
			&& !this.model.hasChanged("collapsed")
			&& !this.model.get("withBundle")) {
			this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
			if (!this.skipTransitions) {
				this.graph.renderNow();
			}
		}
		/* NavigationView has resized while uncollapsed,
		   but model is unchanged */
		else if ((flags & View.SIZE_INVALID) && !this.model.get("collapsed")) {
			// console.info("%s::renderFrame", this.cid, "NavigationView has resized");
			this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
		}
		this.skipTransitions = false;
	},

	_whenTransitionsEnd: function(result) {
		console.info("%s::_whenTransitionsEnd", this.cid);
		this.el.classList.remove("container-changing");
		if (Globals.BREAKPOINTS["desktop-small"].matches
			|| !this.model.get("collapsed")) {
			this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();
		}
	},

	_whenTransitionsAbort: function(reason) {
		console.warn("%s::_whenTransitionsAbort %o", this.cid, reason);
		this.el.classList.remove("container-changing");
		if (Globals.BREAKPOINTS["desktop-small"].matches
			|| !this.model.get("collapsed")) {
			this.graph.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();
		}
	},

	/* -------------------------------
	/* renderTransitions
	/* ------------------------------- */

	renderTransitions: function(flags) {
		var fromRoute = this.model.previous("routeName");
		var toRoute = this.model.get("routeName");

		var modelChanged = (flags & View.MODEL_INVALID);
		/* bundle */
		var withBundle = this.model.get("withBundle");
		var withBundleChanged = modelChanged && this.model.hasChanged("withBundle");
		var bundleChanged = modelChanged && this.model.hasChanged("bundle");
		/* media */
		var withMedia = this.model.get("withMedia");
		var withMediaChanged = modelChanged && this.model.hasChanged("withMedia");
		//var mediaChanged = modelChanged && this.model.hasChanged("media");
		/* collapsed */
		var collapsed = this.model.get("collapsed");
		var collapsedChanged = modelChanged && this.model.hasChanged("collapsed");
		/* article */
		// var withArticle = this.model.get("withArticle");
		var withArticleChanged = modelChanged && this.model.hasChanged("withArticle");

		var tf;
		/* this.bundleList.el */
		tf = this.transforms.get(this.bundleList.el);
		if (tf.hasOffset) {
			tf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);
		}
		/* this.keywordList.el */
		tf = this.transforms.get(this.keywordList.el);
		if (tf.hasOffset) {
			tf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);
		}
		/* this.graph.el */
		tf = this.transforms.get(this.graph.el);
		if (tf && tf.hasOffset) {
			tf.runTransition(collapsedChanged ? tx.BETWEEN : tx.NOW);
			tf.clearOffset();
		}

		/*
		 * NOTE:
		 * Vertical:
		 *		site-name-wrapper,
		 *		article-list-wrapper
		 * Horizontal:
		 *		site-name,
		 *		article-buttons,
		 *		keywordList.wrapper,
		 *		bundleList.wrapper,
		 *		hGroupings
		 */
		if (Globals.BREAKPOINTS["desktop-small"].matches) {
			/* HORIZONTAL */
			tf = this.transforms.get(this.keywordList.wrapper);
			if (collapsedChanged && !withArticleChanged) {
				// if (collapsedChanged) {
				if (withBundleChanged) {
					if (withMediaChanged)
						tf.runTransition(withBundle ? tx.LAST : tx.FIRST);
				} else {
					if (withMedia)
						tf.runTransition(collapsed ? tx.LAST : tx.FIRST);
				}
			} else {
				if (!withBundleChanged && withMediaChanged)
					tf.runTransition(bundleChanged ? tx.BETWEEN : tx.NOW);
			}
			if (collapsedChanged ^ withArticleChanged) {
				this.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST,
					this.sitename.el, this.about.el, this.bundleList.wrapper, this.hGroupings);
			}
			/* VERTICAL */
			if (fromRoute == 'root' || toRoute == 'root') {
				this.transforms.runTransition(tx.BETWEEN,
					this.sitename.wrapper, this.about.wrapper);
			}
			/* this.hGroupings */
			// if (collapsedChanged ^ withArticleChanged) {
			// 	// if (collapsedChanged && !withArticleChanged) {
			// 	this.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.hGroupings);
			// }
			// if (collapsedChanged) {
			// 	if (!withArticleChanged) {
			// 		// if (fromRoute == 'root' || toRoute == 'root') {
			// 		this.transforms.runTransition(collapsed ? tx.LAST : tx.FIRST, this.bundleList.wrapper);
			// 	}
			// } else {
			// 	if (withArticleChanged && withBundleChanged) {
			// 		this.transforms.runTransition(withArticle ? tx.BETWEEN : tx.LAST, this.bundleList.wrapper);
			// 	}
			// }
		} else if (Globals.BREAKPOINTS["fullwidth"].matches) {
			// if (collapsedChanged ) {
			if (collapsedChanged ^ withArticleChanged) {
				this.transforms.runTransition(tx.BETWEEN,
					this.sitename.el, this.about.el);
			}
		} else {
			if (withBundleChanged) {
				this.transforms.runTransition(tx.BETWEEN,
					this.sitename.el, this.about.el);
			}
		}
		this.transforms.clearOffset(this.bundleList.el, this.keywordList.el,
			this.keywordList.wrapper);
	},

	/* --------------------------- *
	/* own model changed
	/* --------------------------- */

	_onModelChange: function() {
		this.requestRender(View.MODEL_INVALID);
		// keywords.deselect();
		if (this.model.hasChanged("collapsed")) {
			if (this.model.get("collapsed")) {
				// clear keyword selection
				keywords.deselect();
				// this.touch.on("tap", this._onNavigationClick);
			} else {
				// this.touch.off("tap", this._onNavigationClick);
			}
			this.keywordList.collapsed = this.model.get("collapsed");
			this.bundleList.collapsed = this.model.get("collapsed");
		}
		if (this.model.hasChanged("bundle")) {
			this.bundleList.selectedItem = this.model.get("bundle");
			this.keywordList.refresh();
			// keywords.deselect();
			// this.graph && this.graph.requestRender(View.SIZE_INVALID);
		}
		if (this.model.hasChanged("withBundle")) {
			// this.keywordList.refresh()
			if (this.model.get("withBundle")) {
				this.touch.on("vpanstart", this._onVPanStart);
				this.touch.on("hpanstart", this._onHPanStart);
				// this.touch.on("tap", this._onTap);
			} else {
				this.touch.off("vpanstart", this._onVPanStart);
				this.touch.off("hpanstart", this._onHPanStart);
				keywords.deselect();
				// this.touch.off("tap", this._onTap);
			}
			// this.graph.valueTo()
		}
	},

	/* --------------------------- *
	/* keyword collection changed
	/* --------------------------- */

	_onKeywordSelect: function(keyword) {
		// use collection listener to avoid redundant refresh calls
		this.bundleList.refresh();
		if (!this.model.get("collapsed") && this.graph) {
			this.listenToOnce(this.bundleList, "view:render:after", function(view, flags) {
				console.log("%s::_onKeywordSelect -> %s:[view:render:after] flags:%s", this.cid, view.cid, View.flagsToString(flags));
				this.graph.valueTo(0, 0, "amount");
				// this.graph.renderNow();
				this.graph.valueTo(1, Globals.TRANSITION_DURATION, "amount");
			});
		}
	},

	/* --------------------------- *
	/* UI Events: bundleList keywordList buttons
	/* --------------------------- */

	_onNavigationClick: function(ev) {
		this._changeCollapsed(false);
	},

	_onArticleClick: function(item) {
		switch (this.model.get("routeName")) {
			case "article-item":
				controller.deselectArticle();
				break;
			case "root":
			default:
				controller.selectArticle(item);
				break;
		}
	},

	_onSitenameClick: function() {
		switch (this.model.get("routeName")) {
			case "media-item":
			case "bundle-item":
				if (this.model.get("collapsed")) {
					this._changeCollapsed(false);
				} else {
					controller.deselectBundle();
				}
				break;
			case "article-item":
				controller.deselectArticle();
				break;
		}
	},

	_onBundleListSame: function(bundle) {
		this._changeCollapsed(!this.model.get("collapsed"));
	},

	_onKeywordListChange: function(keyword) {
		if (!this.model.get("collapsed")) {
			keywords.select(keyword);
		}
	},

	_changeCollapsed: function(value) {
		if (value !== this.model.get("collapsed")) {
			this.transforms.offset(0, 1, this.graph.el);
			this.transforms.validate();
			this.setImmediate(function() {
				console.log("%s::_changeCollapsed", this.cid);
				this.model.set("collapsed", !this.model.get("collapsed"));
			});
		}
	},

	/* -------------------------------
	/* Horizontal touch/move (HammerJS)
	/* ------------------------------- */

	_onHPanStart: function(ev) {
		this.transforms.get(this.keywordList.wrapper)
			.stopTransition()
			.clearOffset()
			.validate();
		// if (this.model.get("layoutName") != "left-layout"
		// 	&& this.model.get("layoutName") != "default-layout") {
		// 	return;
		// }
		if (Globals.BREAKPOINTS["desktop-small"].matches
			&& this.model.get("bundle").get("media").selectedIndex <= 0
			&& this.model.get("collapsed")) {
			this.transforms.get(this.keywordList.wrapper).clearCapture();
			this._onHPanMove(ev);

			this.touch.on("hpanmove", this._onHPanMove);
			this.touch.on("hpanend hpancancel", this._onHPanFinal);
		}
	},

	_onHPanMove: function(ev) {
		// var HPAN_DRAG = 1;
		// var HPAN_DRAG = 0.75;
		var HPAN_DRAG = 720 / 920;
		var delta = ev.deltaX; //ev.thresholdDeltaX;
		// var mediaItems = this.model.get("bundle").get("media");

		if (this.model.get("withMedia")) {
			// if (this.model.get("withMedia") ^ (this._renderFlags & View.MODEL_INVALID)) {
			// if (mediaItems.selected !== null) {
			delta *= (ev.offsetDirection & Hammer.DIRECTION_LEFT) ?
				0.0 : HPAN_DRAG;
			// if (bundles.selected.get("media").selectedIndex == -1) {
		} else { //if (media.selectedIndex == 0) {
			delta *= (ev.offsetDirection & Hammer.DIRECTION_LEFT) ?
				HPAN_DRAG : Globals.HPAN_OUT_DRAG;
		}
		this.transforms.offset(delta, void 0, this.keywordList.wrapper);
		this.transforms.validate();
	},

	_onHPanFinal: function(ev) {
		this.touch.off("hpanmove", this._onHPanMove);
		this.touch.off("hpanend hpancancel", this._onHPanFinal);

		/* NOTE: if there is no model change, set tx here. Otherwise just wait for render */
		var kTf = this.transforms.get(this.keywordList.wrapper);
		if (!(this._renderFlags & View.MODEL_INVALID) && kTf.hasOffset) {
			if (kTf.offsetX != 0) {
				kTf.runTransition(tx.NOW);
			}
			kTf.clearOffset().validate();
			// kTf.clearOffset().runTransition(tx.NOW).validate();
			// this.transforms.clearOffset(this.keywordList.wrapper);
			// this.transforms.runTransition(tx.NOW, this.keywordList.wrapper);
			// this.transforms.validate();
		}
	},

	/* -------------------------------
	/* Vertical touch/move (_onVPan*)
	/* ------------------------------- */

	_collapsedOffsetY: Globals.COLLAPSE_OFFSET,

	_onVPanStart: function(ev) {
		this.touch.on("vpanmove", this._onVPanMove);
		this.touch.on("vpanend vpancancel", this._onVPanFinal);

		this.transforms.stopTransition(this.bundleList.el, this.keywordList.el); //, this.graph.el);
		// this.transforms.clearOffset(this.bundleList.el, this.keywordList.el);
		// this.transforms.validate();
		this.transforms.clearCapture(this.bundleList.el, this.keywordList.el); //, this.graph.el);

		if (!this.model.get("collapsed")) {
			this.transforms.stopTransition(this.graph.el);
			this.transforms.clearCapture(this.graph.el);
		}
		// this.el.classList.add("container-changing");
		this._onVPanMove(ev);
	},

	_onVPanMove: function(ev) {
		var collapsed = this.model.get("collapsed");
		var delta = ev.deltaY; //ev.thresholdDeltaY;
		var maxDelta = this._collapsedOffsetY; // + Math.abs(ev.thresholdOffsetY);

		// check if direction is aligned with collapsed/expand
		var isValidDir = collapsed ? (delta > 0) : (delta < 0);
		var moveFactor = collapsed ? 1 - Globals.VPAN_DRAG : Globals.VPAN_DRAG;

		delta = Math.abs(delta); // remove sign
		delta *= moveFactor;
		maxDelta *= moveFactor;

		if (isValidDir) {
			if (delta > maxDelta) { // overshooting
				delta = ((delta - maxDelta) * Globals.VPAN_OUT_DRAG) + maxDelta;
			} else { // no overshooting
				// delta = delta;
			}
		} else {
			delta = (-delta) * Globals.VPAN_OUT_DRAG; // delta is opposite
		}
		delta *= collapsed ? 0.5 : -1; // reapply sign

		this.transforms.offset(0, delta, this.bundleList.el, this.keywordList.el); //, this.graph.el);
		if (!collapsed)
			this.transforms.offset(0, delta, this.graph.el)
		this.transforms.validate();
	},

	_onVPanFinal: function(ev) {
		this.touch.off("vpanmove", this._onVPanMove);
		this.touch.off("vpanend vpancancel", this._onVPanFinal);

		this._onVPanMove(ev);
		this.setImmediate(function() {
			if (this.willCollapsedChange(ev)) {
				this.model.set("collapsed", !this.model.get("collapsed"));
			} else {
				this.requestRender(View.LAYOUT_INVALID);
			}
		});
	},

	willCollapsedChange: function(ev) {
		return ev.type == "vpanend" ? this.model.get("collapsed") ?
			ev.deltaY > Globals.COLLAPSE_THRESHOLD :
			ev.deltaY < -Globals.COLLAPSE_THRESHOLD :
			false;
	},

	/* -------------------------------
	/* Components
	/* ------------------------------- */

	createSitenameButton: function() {
		var view = new View({
			el: "#site-name",
			events: {
				"click a": function(domev) {
					domev.defaultPrevented || domev.preventDefault();
					this.trigger("view:click");
				}
			}
		});
		this.listenTo(view, "view:click", this._onSitenameClick);
		view.wrapper = view.el.parentElement;
		return view;
	},

	createArticleButton: function(articleItem) {
		var view = new ArticleButton({
			el: ".article-button[data-handle='about']",
			model: articleItem
		}).render();
		this.listenTo(view, "view:click", this._onArticleClick);
		view.wrapper = view.el.parentElement;
		return view;
	},

	// createArticleButton2: function(articleItem) {
	// 	var view = new View({
	// 		el: "#about",
	// 		className: "article-button",
	// 		// tag: "h2",
	// 		model: articleItem,
	// 	});
	// 	// this.listenTo(view, "view:click", this._onAboutClick);
	// 	view.label = view.el.querySelector("a");
	// 	view.label.innerHTML = articleItem.get("name");
	// 	view.wrapper = view.el.parentElement;
	// 	return view;
	// },

	/**
	 * bundle-list
	 */
	createBundleList: function() {
		var view = new FilterableListView({
			el: "#bundle-list",
			collection: bundles,
			collapsed: false,
			filterFn: function(bundle, index, arr) {
				return keywords.selected ?
					bundle.get("kIds").indexOf(keywords.selected.id) !== -1 : false;
			},
		});
		controller.listenTo(view, {
			"view:select:one": controller.selectBundle,
			"view:select:none": controller.deselectBundle
		});
		// view.listenTo(bundles, "select:one select:none", function(item) {
		// 	view.selectedItem = item;
		// });
		this.listenTo(view, "view:select:same", this._onBundleListSame);
		this.listenTo(keywords, "select:one select:none", this._onKeywordSelect);
		view.wrapper = view.el.parentElement;
		return view;
	},

	/**
	 * keyword-list
	 */
	createKeywordList: function() {
		var view = new GroupingListView({
			el: "#keyword-list",
			collection: keywords,
			collapsed: false,
			filterFn: function(item, idx, arr) {
				// return !!(item.get("bundle").selected);
				return bundles.selected ?
					(bundles.selected.get("kIds").indexOf(item.id) !== -1) : false;
			},
			groupingFn: function(item, idx, arr) {
				// return item.get("type");
				return types.get(item.get("tId"));
			},
		});
		view.listenTo(keywords, "select:one select:none", function(item) {
			view.selectedItem = item;
		});
		this.listenTo(view, "view:select:one view:select:none", this._onKeywordListChange);
		view.wrapper = view.el.parentElement;
		return view;
	},

	/**
	 * nav-graph
	 */
	createGraphView: function(listA, listB) {
		var view = new GraphView({
			id: "nav-graph",
			listA: listA,
			listB: listB,
			model: this.model,
			useOpaque: false
		});
		// this.el.appendChild(view.el);
		this.el.insertBefore(view.el, this.el.firstElementChild);
		return view;
	},

	/* -------------------------------
	/* Horizontal touch/move (MutationObserver)
	/* ------------------------------- */

	/*
	_beginTransformObserve: function() {
		if (!(Globals.BREAKPOINTS["desktop-small"].matches && this.model.get("bundle").get("media").selectedIndex <= 0 && this.model.get("collapsed"))) {
			return;
		}
		var target = document.querySelector(".carousel > .empty-item");
		if (target === null) {
			return;
		}
		if (!this._transformObserver) {
			this._transformObserver = new MutationObserver(this._onTransformMutation);
		}
		this._transformObserver.observe(target, { attributes: true, attributeFilter: ["style"] });
		this.touch.on("hpanend hpancancel", this._endTransformObserve);
		this.transforms.get(this.keywordList.wrapper)
			.stopTransition()
			.clearOffset()
			.clearCapture()
			.validate();
	},

	_endTransformObserve: function() {
		this._transformObserver.disconnect();
		this.touch.off("hpanend hpancancel", this._endTransformObserve);
		this.transforms.get(this.keywordList.wrapper)
			.clearOffset()
			.runTransition(tx.NOW)
			.validate();
	},

	_onTransformMutation: function(mutations) {
		var tView, tMetrics, tCss, dTxObj, pos;

		// this.keywordList.wrapper.style[prefixedProperty("transform")];
		// transform = mutations[0].target.style.getPropertyValue(prefixedProperty("transform"));

		tView = View.findByElement(mutations[0].target);
		if (tView) {
			tMetrics = tView.metrics;
			dTxObj = this.transforms.get(this.keywordList.wrapper);
			console.log("%s::_onTransformMutation [withMedia: %s] target: (%f\+%f) %f wrapper: (%f) %f", this.cid,
				this.model.has("media"),
				tMetrics.translateX, tMetrics.width, tMetrics.translateX + tMetrics.width,
				dTxObj.capturedX, tMetrics.translateX - dTxObj.capturedX,
				tMetrics
			);

			this.transforms.offset(tMetrics.translateX - dTxObj.capturedX, void 0, this.keywordList.wrapper);
			this.transforms.validate();
		}
	},
	*/
});

module.exports = NavigationView;
},{"app/control/Controller":33,"app/control/Globals":34,"app/model/collection/ArticleCollection":38,"app/model/collection/BundleCollection":39,"app/model/collection/KeywordCollection":40,"app/model/collection/TypeCollection":41,"app/view/base/TouchManager":57,"app/view/base/View":58,"app/view/component/ArticleButton":61,"app/view/component/FilterableListView":66,"app/view/component/GraphView":67,"app/view/component/GroupingListView":68,"hammerjs":"hammerjs","underscore":"underscore","utils/TransformHelper":103}],53:[function(require,module,exports){
(function (DEBUG){
/* global Path2D */
/**
 * @module app/view/component/progress/CanvasView
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:color} */
// var Color = require("color");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/view/base/Interpolator} */
var Interpolator = require("app/view/base/Interpolator");
/** @type {module:utils/css/getBoxEdgeStyles} */
var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

var MIN_CANVAS_RATIO = 2; // /Firefox/.test(window.navigator.userAgent)? 2 : 1;

/**
 * @constructor
 * @type {module:app/view/component/progress/CanvasView}
 */
var CanvasView = View.extend({

	/** @type {string} */
	cidPrefix: "canvasView",
	/** @type {string} */
	tagName: "canvas",
	/** @type {string} */
	className: "canvas-view",

	properties: {
		context: {
			get: function() {
				return this._ctx;
			}
		},
		interpolator: {
			get: function() {
				return this._interpolator;
			}
		},
		canvasRatio: {
			get: function() {
				return this._canvasRatio;
			}
		},
	},

	/** @type {Object} */
	defaults: {
		values: {
			value: 0
		},
		maxValues: {
			value: 1
		},
		useOpaque: true,
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	initialize: function(options) {
		// TODO: cleanup this options mess
		options = _.defaults(options, this.defaults);
		options.values = _.defaults(options.values, this.defaults.values);
		options.maxValues = _.defaults(options.maxValues, this.defaults.maxValues);

		this._interpolator = new Interpolator(options.values, options.maxValues);
		this._useOpaque = options.useOpaque;
		this._options = _.pick(options, "color", "backgroundColor");

		// opaque background
		// --------------------------------
		var ctxOpts = {};
		// if (this._useOpaque) {
		// 	this._opaqueProp = Modernizr.prefixed("opaque", this.el, false);
		// 	if (this._opaqueProp) {
		// 		this.el[this._opaqueProp] = true;
		// 	} else {
		// 		ctxOpts.alpha = true;
		// 	}
		// 	this.el.classList.add("color-bg");
		// }

		// canvas' context init
		// --------------------------------
		this._ctx = this.el.getContext("2d", ctxOpts);

		// adjust canvas size to pixel ratio
		// upscale the canvas if the two ratios don't match
		// --------------------------------
		var ratio = MIN_CANVAS_RATIO;
		var ctxRatio = this._ctx.webkitBackingStorePixelRatio || 1;
		if (window.devicePixelRatio !== ctxRatio) {
			// ratio = Math.max(window.devicePixelRatio / ctxRatio, MIN_CANVAS_RATIO);
			ratio = window.devicePixelRatio / ctxRatio;
			ratio = Math.max(ratio, MIN_CANVAS_RATIO);
		}
		this._canvasRatio = ratio;
		// console.log("%s::init canvasRatio: %f", this.cid, this._canvasRatio);

		this.listenTo(this, "view:attached", function() {
			// this.invalidateSize();
			// this.renderNow();
			this.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID).renderNow();
		});
	},

	// _computeCanvasRatio: function() {
	// 	var ratio = MIN_CANVAS_RATIO;
	// 	var ctxRatio = this._ctx.webkitBackingStorePixelRatio || 1;
	// 	if (window.devicePixelRatio !== ctxRatio) {
	// 		// ratio = Math.max(window.devicePixelRatio / ctxRatio, MIN_CANVAS_RATIO);
	// 		ratio = window.devicePixelRatio / ctxRatio;
	// 		ratio = Math.max(ratio, MIN_CANVAS_RATIO);
	// 	}
	// 	this._canvasRatio = ratio;
	// },

	_updateCanvas: function() {
		// adjust canvas size to pixel ratio
		// upscale the canvas if the two ratios don't match
		// --------------------------------

		var s = getComputedStyle(this.el);

		this._canvasWidth = this.el.offsetWidth;
		this._canvasHeight = this.el.offsetHeight;

		if (s.boxSizing === "border-box") {
			var m = getBoxEdgeStyles(s);
			this._canvasWidth -= m.paddingLeft + m.paddingRight + m.borderLeftWidth + m.borderRightWidth;
			this._canvasHeight -= m.paddingTop + m.paddingBottom + m.borderTopWidth + m.borderBottomWidth;
		}

		this._canvasWidth *= this._canvasRatio;
		this._canvasHeight *= this._canvasRatio;

		this.measureCanvas(this._canvasWidth, this._canvasHeight);
		this.el.width = this._canvasWidth;
		this.el.height = this._canvasHeight;
		// this.el.style.height = h + "px";
		// this.el.style.width = w + "px";

		// colors
		// --------------------------------
		this._color = this._options.color ||
			s.color || Globals.DEFAULT_COLORS["color"];
		this._backgroundColor = this._options.backgroundColor ||
			s.backgroundColor || Globals.DEFAULT_COLORS["background-color"];

		// mozOpaque
		// --------------------------------
		if (this._useOpaque && this._opaqueProp) {
			// this.el.style.backgroundColor = this._backgroundColor;
			this.el[this._opaqueProp] = true;
		}

		// fontSize
		// --------------------------------
		this._fontSize = parseFloat(s.fontSize) * this._canvasRatio;
		this._fontFamily = s.fontFamily;

		// prepare canvas context
		// --------------------------------
		this._ctx.restore();

		this._ctx.font = [s.fontWeight, s.fontStyle, this._fontSize + "px/1", s.fontFamily].join(" ");
		this._ctx.textAlign = "left";
		this._ctx.lineCap = "butt";
		this._ctx.lineJoin = "miter";
		this._ctx.strokeStyle = this._color;
		this._ctx.fillStyle = this._color;

		this.updateCanvas(this._ctx);
		this._ctx.save();

		// console.group(this.cid+"::_updateCanvas");
		// console.log("ratio:    %f (min: %f, device: %f, context: %s)", this._canvasRatio, MIN_CANVAS_RATIO, window.devicePixelRatio, this._ctx.webkitBackingStorePixelRatio || "(webkit-only)");
		// console.log("colors:   fg: %s bg: %s", this._color, this._backgroundColor);
		// console.log("style:    %s, %s, padding: %s (%s)", s.width, s.height, s.padding, s.boxSizing);
		// console.log("box:      %f x %f px", m.width, m.height);
		// console.log("measured: %f x %f px", w, h);
		// console.log("canvas:   %f x %f px", this._canvasWidth, this._canvasHeight);
		// console.groupEnd();
	},

	updateCanvas: function() {
		/* abstract */
	},

	measureCanvas: function() {
		/* abstract */
	},

	_getFontMetrics: function(str) {
		var key, idx, mObj, mIdx = str.length;
		for (key in Globals.FONT_METRICS) {
			idx = str.indexOf(key);
			if (idx !== -1 && idx < mIdx) {
				mIdx = idx;
				mObj = Globals.FONT_METRICS[key];
			}
		}
		return mObj;
	},

	_clearCanvas: function(x, y, w, h) {
		this._ctx.clearRect(x, y, w, h);
		if (this._useOpaque) {
			this._ctx.save();
			this._ctx.fillStyle = this._backgroundColor;
			this._ctx.fillRect(x, y, w, h);
			this._ctx.restore();
		}
	},

	_setStyle: function(s) {
		CanvasView.setStyle(this._ctx, s);
	},

	/* --------------------------- *
	/* render
	/* --------------------------- */

	/** @override */
	render: function() {
		if (this.attached) {
			return this.renderNow();
		}
		return this;
	},

	/** @override */
	renderFrame: function(tstamp, flags) {
		if (!this.attached) {
			return flags;
		}
		if (flags & View.SIZE_INVALID) {
			this._updateCanvas();
		}
		if (this._interpolator.valuesChanged) {
			flags |= View.LAYOUT_INVALID;
			this._interpolator.interpolate(tstamp);
		}
		if (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {
			this.redraw(this._ctx, this._interpolator);
			if (this._interpolator.valuesChanged) {
				this.requestRender();
			}
		}
	},

	/* --------------------------- *
	/* public
	/* --------------------------- */

	getValue: function(key) {
		return this._interpolator.getValue(key);
	},

	getRenderedValue: function(key) {
		return this._interpolator.getRenderedValue(key);
	},

	valueTo: function(value, duration, key) {
		this._interpolator.valueTo(value, duration, key);
		this.requestRender(View.MODEL_INVALID | View.LAYOUT_INVALID);
	},

	// updateValue: function(key) {
	// 	return this._interpolator.updateValue(key || this.defaultKey);
	// },

	/* --------------------------- *
	/* redraw
	/* --------------------------- */

	redraw: function(context, changed) {},

}, {
	setStyle: function(ctx, s) {
		if (typeof s != "object") return;
		for (var p in s) {
			switch (typeof ctx[p]) {
				case "undefined":
					break;
				case "function":
					if (Array.isArray(s[p])) ctx[p].apply(ctx, s[p]);
					else ctx[p].call(ctx, s[p]);
					break;
				default:
					ctx[p] = s[p];
			}
		}
	}
});

if (DEBUG) {
	CanvasView.prototype._skipLog = true;
}

module.exports = CanvasView;
}).call(this,true)

},{"app/control/Globals":34,"app/view/base/Interpolator":55,"app/view/base/View":58,"underscore":"underscore","utils/css/getBoxEdgeStyles":107}],54:[function(require,module,exports){
(function (DEBUG){
// /** @type {module:utils/setImmediate} */
// var setImmediate = require("utils/setImmediate");

// function sortByPriority(a, b) {
// 	if (a.priority > b.priority)
// 		return 1;
// 	if (a.priority < b.priority)
// 		return -1;
// 	return 0;
// }

function RequestQueue(offset) {
	this._offset = offset | 0;
	this._items = [];
	this._priorities = [];
	this._numItems = 0;
}

RequestQueue.prototype = Object.create({
	enqueue: function(item, priority) {
		var i = this._items.length;
		this._items[i] = item;
		this._priorities[i] = {
			priority: (priority | 0),
			index: i
		};
		this._numItems++;
		// console.log("FrameQueue::RequestQueue::enqueue() [numItems:%i] ID:%i", this._numItems, this._offset + i);
		return this._offset + i;
	},

	contains: function(index) {
		index -= this.offset;
		return 0 <= index && index < this._items.length;
	},

	skip: function(index) {
		var i, item;
		i = index - this._offset;
		if (0 > i || i >= this._items.length) {
			// 	console.warn("FrameQueue::RequestQueue::skip(id:%i) out of range (%i-%i)", index, this._offset, this._offset + (this._numItems - 1));
			return void 0;
		}
		item = this._items[i];
		if (item !== null) {
			// if (item = this._items[i]) {
			this._items[i] = null;
			this._numItems--;

			// if (this._numItems == 0) {
			// 	this._empty(this._offset + this._items.length);
			// }
			// console.log("FrameQueue::RequestQueue::skip(id:%i) [numItems:%i] skipping", index, this._numItems);
		}
		// else {
		// 	console.warn("FrameQueue::RequestQueue::skip(id:%i) [numItems:%i] item is null", index, this._numItems);
		// }
		return item;
	},

	// forEach: function(fn, context) {
	// 	return this.items.forEach(fn, context);
	// },

	indexes: function() {
		// .map(function(o, i, a) {
		// 	return this[o.index];
		// }, this._items);
		var items = this._priorities.concat();
		items.sort(function(a, b) {
			if (a.priority > b.priority)
				return 1;
			if (a.priority < b.priority)
				return -1;
			return 0;
		});
		items.forEach(function(o, i, a) {
			a[i] = o.index;
		}, this);
		return items;
	},

	items: function() {
		// .map(function(o, i, a) {
		// 	return this[o.index];
		// }, this._items);
		var items = this._priorities.concat();
		items.sort(function(a, b) {
			if (a.priority > b.priority)
				return 1;
			if (a.priority < b.priority)
				return -1;
			return 0;
		});
		items.forEach(function(o, i, a) {
			a[i] = this._items[o.index];
		}, this);
		return items;
	},

	_empty: function(offset) {
		this._offset = offset;
		this._items.length = 0;
		this._priorities.length = 0;
		this._numItems = 0;
	}
}, {

	offset: {
		get: function() {
			return this._offset;
		}
	},

	length: {
		get: function() {
			return this._items.length;
		}
	},

	numItems: {
		get: function() {
			return this._numItems;
		}
	},
});

var _nextQueue = new RequestQueue(0);
var _currQueue = null;

var _pending = false;
var _running = false;
var _rafId = -1;

/**
/* @param tstamp {int}
/*/
var _runQueue = function(tstamp) {
	if (_running) throw new Error("wtf!!!");

	_rafId = -1;
	_running = true;
	_currQueue = _nextQueue;
	_nextQueue = new RequestQueue(_currQueue.offset + _currQueue.length);

	// _currQueue.items().forEach(function(fn, i, a) {
	// 	if (fn !== null) {
	// 		fn(tstamp);
	// 	}
	// });
	_currQueue.indexes().forEach(function(index, i, a) {
		var fn = _currQueue._items[index];
		if (fn !== null) {
			fn(tstamp);
		}
	});
	_running = false;
	_currQueue = null;

	if (_nextQueue.numItems > 0) {
		_rafId = window.requestAnimationFrame(_runQueue);
	}
};

var FrameQueue = Object.create({
	/**
	/* @param fn {Function}
	/* @param priority {int}
	/* @return {int}
	/*/
	request: function(fn, priority) {
		// if (!_running && !_pending) {
		// 	_pending = true;
		// 	console.warn("FrameQueue::request setImmediate: pending");
		// 	setImmediate(function() {
		// 		_pending = false;
		// 		if (_nextQueue.numItems > 0) {
		// 			_rafId = window.requestAnimationFrame(_runQueue);
		// 			console.warn("FrameQueue::request setImmediate: raf:%i for %i items", _rafId, _nextQueue.numItems);
		// 		} else {
		// 			console.warn("FrameQueue::request setImmediate: no items");
		// 		}
		// 	});
		// }
		if (!_running && _rafId === -1) {
			_rafId = window.requestAnimationFrame(_runQueue);
		}
		return _nextQueue.enqueue(fn, priority);
	},

	/**
	/* @param id {int}
	/* @return {Function?}
	/*/
	cancel: function(id) {
		var fn;
		if (_running) {
			fn = _currQueue.skip(id) || _nextQueue.skip(id);
		} else {
			fn = _nextQueue.skip(id);
			if ((_rafId !== -1) && (_nextQueue.numItems === 0)) {
				window.cancelAnimationFrame(_rafId);
				_rafId = -1;
			}
		}
		return fn;
	},
}, {
	running: {
		get: function() {
			return _running;
		}
	}
});

if (DEBUG) {
	/** @type {module:underscore} */
	var _ = require("underscore");

	// console.info("Using app/view/base/FrameQueue");

	// 	// // log frame exec time
	// 	// var _now = window.performance?
	// 	// 	window.performance.now.bind(window.performance) :
	// 	// 	Date.now.bind(Date);
	// 	// _runQueue = _.wrap(_runQueue, function(fn, tstamp) {
	// 	// 	var retval, tframe;
	// 	// 	console.log("[FRAME BEGIN] [%ims] %i items [ids:%i-%i]", tstamp, _nextQueue.numItems, _nextQueue.offset, _nextQueue.offset + _nextQueue.length);
	// 	// 	tframe = _now();
	// 	// 	retval = fn(tstamp);
	// 	// 	tframe = _now() - tframe;
	// 	// 	console.log("[FRAME ENDED] [%ims] took %ims\n---\n", tstamp + tframe, tframe);
	// 	// 	if (_nextQueue.numItems != 0) console.info("[FRAME ENDED] %i items scheduled for [raf:%i]", _nextQueue.numItems, _rafId);
	// 	// 	return retval;
	// 	// });

	// log frame end
	_runQueue = _.wrap(_runQueue, function(fn, tstamp) {
		var retval;
		console.group("FrameQueue " + _rafId);
		// console.log("FrameQueue::_runQueue %i items (ID range:%i-%i)", _nextQueue.numItems, _nextQueue.offset, _nextQueue.offset + _nextQueue.length - 1);
		retval = fn(tstamp);
		// console.log("[Frame exit]\n---\n");
		console.groupEnd();
		return retval;
	});

	// // use log prefix
	// if (console.prefix) {
	// 	_runQueue = _.wrap(_runQueue, function(fn, tstamp) {
	// 		var retval, logprefix;
	// 		logprefix = console.prefix;
	// 		console.prefix += "[raf:" + _rafId + "] ";
	// 		retval = fn(tstamp);
	// 		console.prefix = logprefix;
	// 		return retval;
	// 	});
	// }

	// FrameQueue.cancel = _.wrap(FrameQueue.cancel, function(fn, id) {
	// 	if ((_currQueue !== null) && (_currQueue.offset >= id) && (id < _nextQueue.offset)) {
	// 		console.info("FrameQueue::cancel ID:%i in running range (%i-%i)", id, _currQueue.offset, _nextQueue.offset - 1);
	// 	}
	// 	var rafId = _rafId;
	// 	var retval = fn(id);
	// 	if (retval === void 0) {
	// 		console.warn("FrameQueue::cancel ID:%i not found", id);
	// 	} else if (retval === null) {
	// 		console.warn("FrameQueue::cancel ID:%i already cancelled", id);
	// 	} else {
	// 		if (!_running && _nextQueue.numItems == 0) {
	// 			console.info("FrameQueue::cancel raf:%i cancelled (ID:%i cancelled, empty queue)", rafId, id);
	// 		}
	// 	}
	// 	return retval;
	// });
}


module.exports = FrameQueue;
}).call(this,true)

},{"underscore":"underscore"}],55:[function(require,module,exports){
/**
 * @module app/view/base/Interpolator
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
/** @type {module:utils/ease/linear} */
var linear = require("utils/ease/linear");

/**
 * @constructor
 * @type {module:app/view/base/Interpolator}
 */
function Interpolator(values, maxValues) {
	this._valueData = {};
	this._maxValues = {};
	this._renderableKeys = [];

	var key, val, maxVal;
	for (key in values) {
		val = values[key];
		maxVal = maxValues[key] || null;
		// create value object and store it
		this._valueData[key] = this._initValue(val, 0, maxVal);
		// add maxValue to store
		this._maxValues[key] = maxVal;
		// add to next render list
		this._renderableKeys.push(key);
	}
	this._valuesChanged = this._renderableKeys.length > 0;
}

Interpolator.prototype = Object.create({

	/* --------------------------- *
	/* public interface
	/* --------------------------- */

	isAtTarget: function(key) {
		return this._renderableKeys.indexOf(key) === -1;
	},

	getValue: function(key) {
		return this._valueData[key]._value;
	},

	getRenderedValue: function(key) {
		return this._valueData[key]._renderedValue;
	},

	valueTo: function(value, duration, key) {
		var changed, dataObj = this._valueData[key];
		// console.log("%s::valueTo [%s]", "[interpolator]", key, value);
		if (Array.isArray(dataObj)) {
			changed = value.reduce(function(prevChanged, itemValue, i) {
				if (dataObj[i]) {
					dataObj[i] = this._initNumber(itemValue, duration, this._maxValues[key]);
					return true;
				} else {
					return this._setValue(itemValue, duration, dataObj[i]) || prevChanged;
				}
			}.bind(this), changed);
		} else {
			changed = this._setValue(value, duration, dataObj);
		}
		if (changed) {
			this._renderableKeys.indexOf(key) !== -1 || this._renderableKeys.push(key);
			this._valuesChanged = true;
			// this.render();
			// this.requestRender();
		}
		return this;
	},

	updateValue: function(key) {
		// Call _interpolateValue only if needed. _interpolateValue() returns false
		// once interpolation is done, in which case remove key from _renderableKeys.
		var kIndex = this._renderableKeys.indexOf(key);
		if (kIndex !== -1 && !this._interpolateValue(key)) {
			this._renderableKeys.splice(kIndex, 1);
			this._valuesChanged = this._renderableKeys.length > 0;
		}
		return this;
	},

	/* --------------------------- *
	/* private: valueData
	/* --------------------------- */

	_initValue: function(value, duration, maxVal) {
		if (Array.isArray(value)) {
			return value.map(function(val) {
				return this._initNumber(val, 0, maxVal);
			}, this);
		} else {
			return this._initNumber(value, 0, maxVal);
		}
	},

	// _initArray: function(value, duration, maxVal) {
	// 	return val.map(function(val) {
	// 		return this._initNumber(val, 0, maxVal);
	// 	}, this);
	// },

	_initNumber: function(value, duration, maxVal) {
		var o = {};
		o._value = value;
		o._startValue = value;
		o._valueDelta = 0;

		o._duration = duration || 0;
		o._startTime = -1;
		o._elapsedTime = 0;

		o._lastRenderedValue = o._renderedValue = null;

		o._maxVal = maxVal;
		// if (maxVal !== void 0) o._maxVal = maxVal;
		// o._maxVal = this._maxValues[key];
		// o._maxVal = this._maxVal;// FIXME
		return o;
	},

	_setValue: function(value, duration, o) {
		if (o._value != value) {
			o._startValue = o._value;
			o._valueDelta = value - o._value;
			o._value = value;

			o._duration = duration || 0;
			o._startTime = -1;
			o._elapsedTime = 0;

			o._lastRenderedValue = o._renderedValue;

			return true;
		}
		return false;
	},

	/* --------------------------- *
	/* private: interpolate
	/* --------------------------- */

	/** @override */
	interpolate: function(tstamp) {
		if (this._valuesChanged) {
			this._valuesChanged = false;

			var changedKeys = this._renderableKeys;
			this._tstamp = tstamp;
			this._renderableKeys = changedKeys.filter(this._interpolateValue, this);
			this._renderedKeys = changedKeys;

			if (this._renderableKeys.length !== 0) {
				this._valuesChanged = true;
				// 	// this.requestRender();
			}
		}
		// console.log("%s::interpolate valuesChanged:%s tstamp:%f", "[interpolator]", this._valuesChanged, tstamp);
		// return this._valuesChanged;
		// return this.valuesChanged;

		return this;
	},

	_interpolateValue: function(key) {
		var dataObj = this._valueData[key];
		if (Array.isArray(dataObj)) {
			return dataObj.reduce(function(continueNext, o, index, arr) {
				return this._interpolateNumber(this._tstamp, o) || continueNext;
			}.bind(this), false);
		} else {
			return this._interpolateNumber(this._tstamp, dataObj);
		}
	},

	_interpolateNumber: function(tstamp, o) {
		if (o._startTime < 0) {
			o._startTime = tstamp;
		}
		var elapsed = tstamp - o._startTime;
		o._elapsedTime = elapsed;
		o._lastRenderedValue = o._renderedValue;
		if (elapsed < o._duration) {
			if (o._maxVal && o._valueDelta < 0) {
				// upper-bound values
				o._renderedValue = linear(elapsed, o._startValue,
					o._valueDelta + o._maxVal, o._duration) - o._maxVal;
			} else {
				// unbound values
				o._renderedValue = linear(elapsed, o._startValue,
					o._valueDelta, o._duration);
			}
			return true;
		} else {
			o._renderedValue = o._value;
			return false;
		}
	},
}, {
	valuesChanged: {
		get: function() {
			return this._valuesChanged;
		}
	},
	renderableKeys: {
		get: function() {
			return this._renderableKeys;
		}
	},
	renderedKeys: {
		get: function() {
			return this._renderedKeys;
		}
	},
});

module.exports = Interpolator;

},{"utils/ease/linear":109}],56:[function(require,module,exports){
(function (DEBUG){
/** @type {module:utils/prefixedEvent} */
var prefixedEvent = require("utils/prefixedEvent");

var eventMap = {
	"transitionend": prefixedEvent("transitionend"),
	"fullscreenchange": prefixedEvent("fullscreenchange", document),
	"fullscreenerror": prefixedEvent("fullscreenerror", document),
	"visibilitychange": prefixedEvent("visibilitychange", document, "hidden")
};

var eventNum = 0;
for (var eventName in eventMap) {
	if (eventName === eventMap[eventName]) {
		delete eventMap[eventName];
	} else {
		Object.defineProperty(eventMap, eventName, {
			value: eventMap[eventName],
			enumerable: true
		});
		Object.defineProperty(eventMap, eventNum, {
			value: eventName,
			enumerable: false
		});
		eventNum++;
	}
}
Object.defineProperty(eventMap, "length", {
	value: eventNum
});

if (DEBUG) {
	console.log("prefixes enabled for %i events", eventMap.length, Object.keys(eventMap));
}

module.exports = eventMap;

// module.exports = eventNum > 0? eventMap : null;

}).call(this,true)

},{"utils/prefixedEvent":112}],57:[function(require,module,exports){
/**
 * @module app/view/base/TouchManager
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
/** @type {module:hammerjs} */
var Hammer = require("hammerjs");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

/** @type {module:hammerjs.Tap} */
var Tap = Hammer.Tap;
/** @type {module:utils/touch/SmoothPanRecognizer} */
var Pan = require("utils/touch/SmoothPanRecognizer");
// /** @type {module:hammerjs.Pan} */
// var Pan = Hammer.Pan;

/* -------------------------------
/* Static private
/* ------------------------------- */

/**
 * @param el HTMLElement
 * @return {Hammer.Manager}
 */
function createInstance(el) {
	var manager, hpan, vpan, tap;
	hpan = new Pan({
		// threshold: Globals.PAN_THRESHOLD,
		direction: Hammer.DIRECTION_HORIZONTAL,
		event: "hpan",
	});
	vpan = new Pan({
		// threshold: Globals.PAN_THRESHOLD,
		direction: Hammer.DIRECTION_VERTICAL,
		event: "vpan",
	});
	tap = new Tap({
		// threshold: Globals.PAN_THRESHOLD - 1
	});
	manager = new Hammer.Manager(el);
	manager.add([tap, hpan, vpan]);
	vpan.requireFailure(hpan);
	// manager.set({ domevents: true });
	return manager;
}

// function createInstance(el) {
// 	return new Hammer(el, {
// 		recognizers: [
// 			[Tap],
// 			[Pan, {
// 				event: 'hpan',
// 				direction: Hammer.DIRECTION_HORIZONTAL,
// 				threshold: Globals.THRESHOLD
// 			}],
// 			[Pan, {
// 				event: 'vpan',
// 				direction: Hammer.DIRECTION_VERTICAL,
// 				threshold: Globals.THRESHOLD
// 			}, ['hpan']]
// 		]
// 	});
// }

// function createInstance(el) {
// 	var recognizers = [];
// 	var manager = new Hammer.Manager(el);
//
// 	var hpan = new Pan({
// 		event: "hpan",
// 		threshold: Globals.THRESHOLD,
// 		direction: Hammer.DIRECTION_HORIZONTAL
// 	});
//
// 	var vpan = new Pan({
// 		event: "vpan",
// 		threshold: Globals.THRESHOLD,
// 		direction: Hammer.DIRECTION_VERTICAL
// 	});
//
// 	var tap = new Hammer.Tap();
// 	// var tap = new Hammer.Tap({
// 	// 	threshold: Globals.THRESHOLD - 1,
// 	// 	interval: 50,
// 	// 	time: 200
// 	// });
// 	recognizers.push(vpan);
// 	recognizers.push(hpan);
// 	recognizers.push(tap);
// 	manager.add(recognizers);
//
// 	hpan.recognizeWith([vpan]);
// 	hpan.requireFailure([vpan]);
// 	tap.recognizeWith([vpan, hpan]);
//
// 	// tap.requireFailure(vpan);
//
// 	// manager.set({ domevents: true });
// 	return manager;
// }

/*https://gist.githubusercontent.com/jtangelder/361052976f044200ea17/raw/f54c2cef78d59da3f38286fad683471e1c976072/PreventGhostClick.js*/

// function	logEvent(message) {
// 	console.log(message, domev.type,
// 		"panSessionOpened: " + panSessionOpened,
// 		"defaultPrevented: " + domev.defaultPrevented
// 	);
// }

var lastTimeStamp = -1;
var panSessionOpened = false;
var upEventName = window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup";

var touchHandlers = {};
touchHandlers["vpanstart vpanend vpancancel hpanstart hpanend hpancancel"] = function(hev) {
	// console.log("TouchManager:[%s]", hev.srcEvent.type);
	panSessionOpened = !hev.isFinal;
	if (hev.isFinal)
		lastTimeStamp = hev.srcEvent.timeStamp;
};
// touchHandlers["hammer.input tap vpanmove hpanmove"] = function(hev) {
// 	console.log("TouchManager:[%s -> %s]", hev.srcEvent.type, hev.type);
// };

var captureHandlers = {};
captureHandlers["click"] = function(domev) {
	if (lastTimeStamp == domev.timeStamp) {
		lastTimeStamp = -1;
		domev.defaultPrevented || domev.preventDefault();
		domev.stopPropagation();
	}
};
captureHandlers["dragstart"] = function(domev) {
	if (domev.target.nodeName == "IMG") {
		domev.defaultPrevented || domev.preventDefault();
	}
};
captureHandlers[upEventName] = function(domev) {
	panSessionOpened && domev.preventDefault();
};

var bubblingHandlers = {};

// -------------------------------
//
// -------------------------------

function addHandlers() {
	var eventName, el = instance.element;
	for (eventName in touchHandlers)
		if (touchHandlers.hasOwnProperty(eventName))
			instance.on(eventName, touchHandlers[eventName]);
	for (eventName in captureHandlers)
		if (captureHandlers.hasOwnProperty(eventName))
			el.addEventListener(eventName, captureHandlers[eventName], true);
	for (eventName in bubblingHandlers)
		if (bubblingHandlers.hasOwnProperty(eventName))
			el.addEventListener(eventName, bubblingHandlers[eventName], false);
}

function removeHandlers() {
	var eventName, el = instance.element;
	for (eventName in captureHandlers)
		if (captureHandlers.hasOwnProperty(eventName))
			el.removeEventListener(eventName, captureHandlers[eventName], true);
	for (eventName in bubblingHandlers)
		if (captureHandlers.hasOwnProperty(eventName))
			el.removeEventListener(eventName, bubblingHandlers[eventName], true);
}

/** @type {Hammer.Manager} */
var instance = null;

/* -------------------------------
/* Static public
/* ------------------------------- */

var TouchManager = {
	init: function(target) {
		if (instance === null) {
			instance = createInstance(target);
			addHandlers();
		} else if (instance.element !== target) {
			console.warn("TouchManager already initialized with another element");
		}
		return instance;
	},

	destroy: function() {
		if (instance !== null) {
			removeHandlers();
			instance.destroy();
			instance = null;
		} else {
			console.warn("no instance to destroy");
		}
	},

	getInstance: function() {
		if (instance === null) {
			console.error("TouchManager has not been initialized");
		}
		return instance;
	}
};

module.exports = TouchManager;
},{"app/control/Globals":34,"hammerjs":"hammerjs","utils/touch/SmoothPanRecognizer":119}],58:[function(require,module,exports){
(function (DEBUG){
/* global HTMLElement, MutationObserver */
/**
 * @module app/view/base/View
 */

/** @type {module:backbone} */
var Backbone = require("backbone");
/** @type {module:underscore} */
var _ = require("underscore");

/* -------------------------------
/* MutationObserver
/* ------------------------------- */

var _cidSeed = 1;
var _viewsByCid = {};

function addChildViews(el) {
	var view, els = el.querySelectorAll("*[data-cid]");
	for (var i = 0, ii = els.length; i < ii; i++) {
		view = View.findByElement(els.item(i));
		if (view) {
			if (!view.attached) {
				// console.log("View::[attached (parent)] %s", view.cid);
				view._elementAttached();
				// } else {
				// 	console.warn("View::[attached (parent)] %s (ignored)", view.cid);
			}
		}
	}
}

function removeChildViews(el) {
	var view, els = el.querySelectorAll("*[data-cid]");
	for (var i = 0, ii = els.length; i < ii; i++) {
		view = View.findByElement(els.item(i));
		if (view) {
			if (view.attached) {
				console.log("View::[detached (parent)] %s", view.cid);
				view._elementDetached();
			} else {
				console.warn("View::[detached (parent)] %s (ignored)", view.cid);
			}
		}
	}
}

var observer = new MutationObserver(function(mm) {
	// console.log("View::mutations %s", JSON.stringify(mm, null, " "));
	var i, ii, m;
	var j, jj, e;
	var view;
	for (i = 0, ii = mm.length; i < ii; i++) {
		m = mm[i];
		if (m.type == "childList") {
			for (j = 0, jj = m.addedNodes.length; j < jj; j++) {
				e = m.addedNodes.item(j);
				view = View.findByElement(e);
				if (view) {
					if (!view.attached) {
						// console.log("View::[attached (childList)] %s", view.cid);
						view._elementAttached();
						// } else {
						// 	console.warn("View::[attached (childList)] %s (ignored)", view.cid);
					}
				}
				if (e instanceof HTMLElement) addChildViews(e);
			}
			for (j = 0, jj = m.removedNodes.length; j < jj; j++) {
				e = m.removedNodes.item(j);
				// console.log("View::[detached (childList)] %s", e.cid);
				view = View.findByElement(e);
				if (view) {
					if (view.attached) {
						console.log("View::[detached (childList)] %s", view.cid, view.attached);
						view._elementDetached();
					} else {
						console.warn("View::[detached (childList)] %s (ignored)", view.cid, view.attached);
					}
				}
				if (e instanceof HTMLElement) removeChildViews(e);
			}
		} else if (m.type == "attributes") {
			view = View.findByElement(m.target);
			if (view) {
				if (!view.attached) {
					// console.log("View::[attached (attribute)] %s", view.cid);
					view._elementAttached();
					// } else {
					// 	console.warn("View::[attached (attribute)] %s (ignored)", view.cid);
				}
			}
			// else {
			// 	console.warn("View::[attributes] target has no cid (%s='%s')", m.attributeName, m.target.getAttribute(m.attributeName), m);
			// }
		}
	}
});

observer.observe(document.body, {
	attributes: true,
	childList: true,
	subtree: true,
	attributeFilter: ["data-cid"]
});

/* -------------------------------
/* static private
/* ------------------------------- */

/** @type {module:app/view/base/FrameQueue} */
var FrameQueue = require("app/view/base/FrameQueue");

/** @type {module:app/view/base/PrefixedEvents} */
var PrefixedEvents = require("app/view/base/PrefixedEvents");

var _now = window.performance ?
	window.performance.now.bind(window.performance) :
	Date.now.bind(Date);
// var _now = window.performance?
// 	function() { return window.performance.now(); }:
// 	function() { return Date.now(); };

var applyEventPrefixes = function(events) {
	var selector, unprefixed;
	for (selector in events) {
		unprefixed = selector.match(/^\w+/i)[0];
		if (PrefixedEvents.hasOwnProperty(unprefixed)) {
			events[selector.replace(unprefixed, PrefixedEvents[unprefixed])] = events[selector];
			// console.log("applyEventPrefixes", unprefixed, prefixedEvents[unprefixed]);
			delete events[selector];
		}
	}
	return events;
};

var getViewDepth = function(view) {
	if (!view) {
		return null;
	}
	if (!view.attached) {
		return NaN;
	}
	if (view.parentView === null) {
		return 0;
	}
	return view.parentView.viewDepth + 1;
};

function logAttachInfo(view, name, level) {
	if (["log", "info", "warn", "error"].indexOf(level) != -1) {
		level = "log";
	}
	console[level].call(console, "%s::%s [parent:%s %s %s depth:%s]", view.cid, name, view.parentView && view.parentView.cid, view.attached ? "attached" : "detached", view._viewPhase, view.viewDepth);
}

/* -------------------------------
/* static public
/* ------------------------------- */


var View = {

	/** @const */
	NONE_INVALID: 0,
	/** @const */
	CHILDREN_INVALID: 1,

	/** @const */
	MODEL_INVALID: 2,
	/** @const */
	STYLES_INVALID: 4,
	/** @const */
	SIZE_INVALID: 8,
	/** @const */
	LAYOUT_INVALID: 16,

	/** @const */
	// RENDER_INVALID: 8 | 16,

	/** @type {module:app/view/base/ViewError} */
	ViewError: require("app/view/base/ViewError"),

	/** @type {module:utils/prefixedProperty} */
	prefixedProperty: require("utils/prefixedProperty"),

	/** @type {module:utils/prefixedStyleName} */
	prefixedStyleName: require("utils/prefixedStyleName"),

	/** @type {module:utils/prefixedEvent} */
	prefixedEvent: require("utils/prefixedEvent"),

	// /** @type {module:utils/setImmediate} */
	// setImmediate: require("utils/setImmediate"),

	/** @type {module:app/view/promise/whenViewIsAttached} */
	whenViewIsAttached: require("app/view/promise/whenViewIsAttached"),


	/** @type {module:app/view/promise/whenViewIsRendered} */
	whenViewIsRendered: require("app/view/promise/whenViewIsRendered"),

	/**
	/* @param el {HTMLElement}
	/* @return {module:app/view/base/View}
	/*/
	findByElement: function(el) {
		if (_viewsByCid[el.cid]) {
			return _viewsByCid[el.cid];
		}
		return null;
	},

	/**
	/* @param el {HTMLElement}
	/* @return {module:app/view/base/View}
	/*/
	findByDescendant: function(el) {
		do {
			if (_viewsByCid[el.cid]) {
				return _viewsByCid[el.cid];
			}
		} while ((el = el.parentElement || el.parentNode));
		return null;
	},

	/** @override */
	extend: function(proto, obj) {
		if (PrefixedEvents.length && proto.events) {
			if (_.isFunction(proto.events)) {
				proto.events = _.wrap(proto.events, function(fn) {
					return applyEventPrefixes(fn.apply(this));
				});
			} else
			if (_.isObject(proto.events)) {
				proto.events = applyEventPrefixes(proto.events);
			}
		}
		if (proto.properties && this.prototype.properties) {
			_.defaults(proto.properties, this.prototype.properties);
		}
		return Backbone.View.extend.apply(this, arguments);
	},

	_flagsToStrings: ["-"],

	flagsToString: function(flags) {
		var s = View._flagsToStrings[flags | 0];
		if (!s) {
			s = [];
			if (flags & View.CHILDREN_INVALID) s.push("children");
			if (flags & View.MODEL_INVALID) s.push("model");
			if (flags & View.STYLES_INVALID) s.push("styles");
			if (flags & View.SIZE_INVALID) s.push("size");
			if (flags & View.LAYOUT_INVALID) s.push("layout");
			View._flagsToStrings[flags] = s = s.join(" ");
		}
		return s;
		// return (flags | 0).toString(2);
	},
};

Object.defineProperty(View, "instances", {
	value: _viewsByCid,
	enumerable: true
});

/* -------------------------------
/* prototype
/* ------------------------------- */

var ViewProto = {

	/** @type {string} */
	cidPrefix: "view",
	/** @type {Boolean} */
	_attached: false,
	/** @type {HTMLElement|null} */
	_parentView: null,
	/** @type {int|null} */
	_viewDepth: null,
	/** @type {string} initializing > initialized > disposing > disposed */
	_viewPhase: "initializing",
	/** @type {int} */
	_frameQueueId: -1,
	/** @type {int} */
	_renderFlags: 0,

	/** @type {object} */
	properties: {
		cid: {
			get: function() {
				return this._cid || (this._cid = this.cidPrefix + _cidSeed++);
			}
		},
		attached: {
			get: function() {
				return this._attached;
			}
		},
		parentView: {
			get: function() {
				return this._parentView;
			}
		},
		viewDepth: {
			get: function() {
				return this._getViewDepth();
			}
		},
		invalidated: {
			get: function() {
				return this._frameQueueId !== -1;
			}
		},
		enabled: {
			get: function() {
				return this._enabled;
			},
			set: function(enabled) {
				this.setEnabled(enabled);
			}
		},
		renderFlags: {
			get: function() {
				return this._renderFlags;
			}
		}
	},

	/**
	 * @constructor
	 * @type {module:app/view/base/View}
	 */
	constructor: function(options) {
		this.transform = {};
		this.childViews = {};
		this._applyRender = this._applyRender.bind(this);

		if (this.properties) {
			// Object.defineProperties(this, getPrototypeChainValue(this, "properties", Backbone.View));
			Object.defineProperties(this, this.properties);
		}
		if (options && options.className && this.className) {
			options.className += " " + _.result(this, "className");
		}
		if (options && options.parentView) {
			this._setParentView(options.parentView, true);
		}
		Backbone.View.apply(this, arguments);

		// console.log("%s::initialize viewPhase:[%s => initialized]", this.cid, this._viewPhase);
		this._viewPhase = "initialized";

		if (this.parentView !== null) {
			this.trigger("view:parentChange", this.parentView, null);
		}
		if (this.attached) {
			this.trigger("view:attached", this);
		}
	},

	/* -------------------------------
	/* remove
	/* ------------------------------- */

	/** @override */
	remove: function() {
		if (this._viewPhase == "disposing") {
			logAttachInfo(this, "remove", "warn");
		} else {
			// logAttachInfo(this, "remove", "log");
		}

		// before removal
		this._viewPhase = "disposing";
		this._cancelRender();

		// call Backbone impl
		// Backbone.View.prototype.remove.apply(this, arguments);

		// NOTE: from Backbone impl
		this.$el.remove(); // from Backbone impl

		this._attached = false;
		this.trigger("view:removed", this);

		// remove parent/child references
		this._setParentView(null);

		// NOTE: from Backbone impl. No more events after this
		this.stopListening();

		// check for invalidations that may have been triggered by "view:removed"
		if (this.invalidated) {
			console.warn("%s::remove invalidated after remove()", this.cid);
			this._cancelRender();
		}
		// // check for children still here
		// var ccids = Object.keys(this.childViews);
		// if (ccids.length) {
		// 	console.warn("%s::remove %i children not removed [%s]", this.cid, ccids.length, ccids.join(", "), this.childViews);
		// }
		// // remove childViews
		// for (var cid in this.childViews) {
		// 	this.childViews[cid].remove();
		// }
		// clear reference in view map
		delete _viewsByCid[this.cid];
		// delete this.el.cid;
		// update phase
		this._viewPhase = "disposed";
		return this;
	},

	/* -------------------------------
	/* _elementAttached _elementDetached
	/* ------------------------------- */

	_elementAttached: function() {
		// this._addToParentView();
		this._attached = true;
		this._viewDepth = null;
		this._setParentView(View.findByDescendant(this.el.parentElement));

		// if (this.parentView) {
		// 	console.log("[attach] [%i] %s > %s::_elementAttached", this.viewDepth, this.parentView.cid, this.cid);
		// } else {
		// 	console.log("[attach] [%i] %s::_elementAttached", this.viewDepth, this.cid);
		// }

		// if (this._viewPhase == "initializing") {
		// 	// this.trigger("view:attached", this);
		// } else
		if (this._viewPhase == "initialized") {
			this.trigger("view:attached", this);
		} else
		if (this._viewPhase == "replacing") {
			this._viewPhase = "initialized";
			this.trigger("view:replaced", this);
		}
	},

	_elementDetached: function() {
		if (!this.attached || (this._viewPhase == "disposing") || (this._viewPhase == "disposed")) {
			logAttachInfo(this, "_elementDetached", "error");
			// } else {
			// 	logAttachInfo(this, "_elementDetached", "log");
		}
		this._attached = false;
		this._viewDepth = null;

		if (this._viewPhase != "disposing" || this._viewPhase == "disposed") {
			this.remove();
		}
	},

	/* -------------------------------
	/* parentView
	/* ------------------------------- */

	_setParentView: function(newParent, silent) {
		if (newParent === void 0) {
			console.warn("$s::_setParentView invalid value '%s'", this.cid, newParent);
			newParent = null;
		}
		var oldParent = this._parentView;
		this._parentView = newParent;

		// force update of _viewDepth
		this._viewDepth = null; //getViewDepth(this);

		// skip the rest if arg is the same
		if (newParent === oldParent) {
			return;
		}
		if (oldParent !== null) {
			if (this.cid in oldParent.childViews) {
				delete oldParent.childViews[this.cid];
			}
		}
		if (newParent !== null) {
			newParent.childViews[this.cid] = this;
		}
		if (!silent)
			this.trigger("view:parentChange", this, newParent, oldParent);
	},

	whenAttached: function() {
		return View.whenViewIsAttached(this);
	},

	_getViewDepth: function() {
		if (this._viewDepth === null) {
			this._viewDepth = getViewDepth(this);
		}
		return this._viewDepth;
	},

	/* -------------------------------
	/* Backbone.View overrides
	/* ------------------------------- */

	/** @override */
	setElement: function(element, delegate) {
		// setElement always initializes this.el, so check it to be non-null before calling super
		if (this.el) {
			if (this.el !== element && this.el.parentElement) {
				// Element is being replaced
				if (this.attached) {
					// Since old element is attached to document tree, _elementAttached will be
					// triggered by replaceChild: set _viewPhase = "replacing" to flag this
					// change and trigger 'view:replaced' instead of 'view:added'.
					this._viewPhase = "replacing";
				}
				this.el.parentElement.replaceChild(element, this.el);
			}
			Backbone.View.prototype.setElement.apply(this, arguments);
			// Merge classes specified by this view with the ones already in the element,
			// as backbone will not:
			if (this.className) {
				_.result(this, "className").split(" ").forEach(function(item) {
					this.el.classList.add(item);
				}, this);
			}
		} else {
			Backbone.View.prototype.setElement.apply(this, arguments);
		}

		if (this.el === void 0) {
			throw new Error("Backbone view has no element");
		}
		_viewsByCid[this.cid] = this;
		this.el.cid = this.cid;
		this.el.setAttribute("data-cid", this.cid);

		return this;
	},

	/* -------------------------------
	/* requestAnimationFrame
	/* ------------------------------- */

	requestAnimationFrame: function(callback, priority, ctx) {
		return FrameQueue.request(callback.bind(ctx || this), priority);
	},

	cancelAnimationFrame: function(id) {
		return FrameQueue.cancel(id);
	},

	setImmediate: function(callback, ctx) {
		window.setImmediate(callback.bind(ctx || this));
	},

	/* -------------------------------
	/* deferred render: private methods
	/* ------------------------------- */

	/** @private */
	_applyRender: function(tstamp) {
		if (DEBUG) {
			if (!this._skipLog) {
				console.log("%s::_applyRender [%s] [%s, %s, %s]", this.cid,
					View.flagsToString(this._renderFlags),
					(this._frameQueueId != -1 ? "async #" + this._frameQueueId : "sync"),
					(this.attached ? "attached" : "detached"),
					(this.skipTransitions ? "skip" : "run") + " tx"
				);
			}
		}

		var flags = this._renderFlags;
		this.trigger("view:render:before", this, flags);
		this._renderFlags = 0;
		this._frameQueueId = -1;
		this._renderFlags |= this.renderFrame(tstamp, flags);
		this.trigger("view:render:after", this, flags);

		if (this._renderFlags != 0) {
			console.warn("%s::_applyRender [returned] flags: %s", this.cid, View.flagsToString(this._renderFlags), this._renderFlags);
		}
	},

	_cancelRender: function() {
		if (this._frameQueueId != -1) {
			var cancelId, cancelFn;

			cancelId = this._frameQueueId;
			this._frameQueueId = -1;
			cancelFn = FrameQueue.cancel(cancelId);

			if (cancelFn === void 0) {
				console.warn("%s::_cancelRender ID:%i not found", this.cid, cancelId);
			} else if (cancelFn === null) {
				console.warn("%s::_cancelRender ID:%i already cancelled", this.cid, cancelId);
				// } else {
				// 	if (!this._skipLog && !FrameQueue.running)
				// 		console.log("%s::_cancelRender ID:%i cancelled", this.cid, cancelId);
			}
		}
	},

	_requestRender: function() {
		if (FrameQueue.running) {
			this._cancelRender();
			if (DEBUG) {
				if (!this._skipLog) {
					console.info("%s::_requestRender rescheduled [%s (%s)]", this.cid, View.flagsToString(this._renderFlags), this._renderFlags);
				}
			}
		}
		if (this._frameQueueId == -1) {
			this._frameQueueId = FrameQueue.request(this._applyRender, isNaN(this.viewDepth) ? Number.MAX_VALUE : this.viewDepth);
		}
	},

	/* -------------------------------
	/* render: public / abstract methods
	/* ------------------------------- */

	invalidate: function(flags) {
		if (flags !== void 0) {
			if (DEBUG) {
				if (!this._skipLog) {
					if (this._renderFlags > 0) {
						console.log("%s::invalidate [%s (%s)] + [%s (%s)]", this.cid, View.flagsToString(this._renderFlags), this._renderFlags, View.flagsToString(flags), flags);
					} else {
						console.log("%s::invalidate [%s (%s)]", this.cid, View.flagsToString(flags), flags);
					}
				}
			}
			this._renderFlags |= flags;
		}
		return this;
	},

	requestRender: function(flags) {
		// if (flags !== void 0) {
		// 	this._renderFlags |= flags;
		// }
		this.invalidate(flags);
		this._requestRender();
		return this;
	},

	/** @abstract */
	renderFrame: function(tstamp, flags) {
		// subclasses should override this method
		return View.NONE_INVALID;
	},

	renderNow: function(alwaysRun) {
		if (this._frameQueueId != -1) {
			this._cancelRender();
			alwaysRun = true;
		}
		// if (alwaysRun === true) {
		if (alwaysRun) {
			this._applyRender(_now());
		}
		return this;
	},

	whenRendered: function() {
		return View.whenViewIsRendered(this);
	},

	/* -------------------------------
	/* render bitwise flags
	/* - check: this._renderFlags & flags
	/* - add: this._renderFlags |= flags
	/* - remove: this._renderFlags &= ~flags
	/* ------------------------------- */

	/* helpers ------------------ */

	requestChildrenRender: function(flags, now, force) {
		var ccid, view;
		for (ccid in this.childViews) {
			view = this.childViews[ccid];
			view.skipTransitions = !!(flags & View.SIZE_INVALID);
			view.requestRender(flags);
			if (now) {
				view.renderNow(force);
			}
		}
	},

	render: function() {
		return this.renderNow(true);
	},

	/* -------------------------------
	/* common abstract
	/* ------------------------------- */

	/** @private */
	_enabled: undefined,

	/**
	/* @param {Boolean}
	/*/
	setEnabled: function(enable) {
		this._enabled = enable;
	},
};

module.exports = Backbone.View.extend(ViewProto, View);
}).call(this,true)

},{"app/view/base/FrameQueue":54,"app/view/base/PrefixedEvents":56,"app/view/base/ViewError":59,"app/view/promise/whenViewIsAttached":79,"app/view/promise/whenViewIsRendered":80,"backbone":"backbone","underscore":"underscore","utils/prefixedEvent":112,"utils/prefixedProperty":113,"utils/prefixedStyleName":114}],59:[function(require,module,exports){
function ViewError(view, err) {
	this.view = view;
	this.err = err;
	this.message = err.message;
}
ViewError.prototype = Object.create(Error.prototype);
ViewError.prototype.constructor = ViewError;
ViewError.prototype.name = "ViewError";

module.exports = ViewError;

},{}],60:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3=container.escapeExpression, alias4="function";

  return "<a href=\""
    + alias3((helpers.global || (depth0 && depth0.global) || alias2).call(alias1,"APP_ROOT",{"name":"global","hash":{},"data":data}))
    + "#"
    + alias3(((helper = (helper = helpers.handle || (depth0 != null ? depth0.handle : depth0)) != null ? helper : alias2),(typeof helper === alias4 ? helper.call(alias1,{"name":"handle","hash":{},"data":data}) : helper)))
    + "\">"
    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias4 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</a>\n";
},"useData":true});

},{"hbsfy/runtime":21}],61:[function(require,module,exports){
/**
/* @module app/view/component/ArticleView
/*/

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {Function} */
var viewTemplate = require("./ArticleButton.hbs");

/**
/* @constructor
/* @type {module:app/view/component/ArticleButton}
/*/
var ArticleButton = View.extend({

	/** @type {string} */
	cidPrefix: "articleButton",
	/** @override */
	tagName: "h2",
	/** @override */
	className: "article-button",
	/** @type {Function} */
	template: viewTemplate,

	events: {
		"click a": function(domev) {
			domev.defaultPrevented || domev.preventDefault();
			this.trigger("view:click", this.model);
		}
	},

	// /** @override */
	// initialize: function(options) {},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		this.el.innerHTML = this.template(this.model.toJSON());
	},
});
module.exports = ArticleButton;
},{"./ArticleButton.hbs":60,"app/view/base/View":58}],62:[function(require,module,exports){
/**
/* @module app/view/component/ArticleView
/*/

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");

// /** @type {module:utils/net/toAbsoluteURL} */
// var toAbsoluteURL = require("utils/net/toAbsoluteURL");
//
// /** @type {string} */
// var ABS_APP_ROOT = toAbsoluteURL(require("app/control/Globals").APP_ROOT);

/**
/* @constructor
/* @type {module:app/view/component/ArticleView}
/*/
var ArticleView = View.extend({

	/** @type {string} */
	cidPrefix: "articleView",
	/** @override */
	tagName: "article",
	/** @override */
	className: "article-view mdown",

	/** @override */
	initialize: function(options) {},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	renderFrame: function(tstamp, flags) {
		this.el.innerHTML = this.model.get("text");
		// FIXME: now done in xslt
		// this.el.querySelectorAll("a[href]").forEach(function(el) {
		// 	var url = toAbsoluteURL(el.getAttribute("href"));
		// 	if (url.indexOf(ABS_APP_ROOT) !== 0) {
		// 		el.setAttribute("target", "_blank");
		// 	}
		// });
	},
});
module.exports = ArticleView;
},{"app/view/base/View":58}],63:[function(require,module,exports){
/**
/* @module app/view/component/Carousel
/*/

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:hammerjs} */
var Hammer = require("hammerjs");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
// /** @type {module:app/view/base/DeferredView} */
// var View = require("app/view/base/DeferredView");

/** @type {module:app/view/render/CarouselRenderer} */
var CarouselRenderer = require("app/view/render/CarouselRenderer");

/** @type {module:utils/prefixedProperty} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {module:utils/prefixedStyleName} */
var prefixedStyleName = require("utils/prefixedStyleName");

var transformStyleName = prefixedStyleName("transform");
var transformProperty = prefixedProperty("transform");
var translateTemplate = Globals.TRANSLATE_TEMPLATE;

// var cssToPx = function(cssVal, el) {
// 	return parseInt(cssVal);
// };

// var defaultRendererFunction = (function() {
// 	var defaultRenderer = CarouselRenderer.extend({ className: "carousel-item default-renderer"}),
// 		emptyRenderer = CarouselRenderer.extend({ className: "carousel-item empty-renderer"});
// 	return function(item, index, arr) {
// 		return (index === -1)? emptyRenderer: defaultRenderer;
// 	};
// })();

/** @const */
var MAX_SELECT_THRESHOLD = 20;

// /** @const */
// var CHILDREN_INVALID = View.CHILDREN_INVALID,
// 	STYLES_INVALID = View.STYLES_INVALID,
// 	MODEL_INVALID = View.MODEL_INVALID,
// 	SIZE_INVALID = View.SIZE_INVALID,
// 	LAYOUT_INVALID = View.LAYOUT_INVALID;

var VERTICAL = Hammer.DIRECTION_VERTICAL,
	HORIZONTAL = Hammer.DIRECTION_HORIZONTAL;

// x: ["x", "y"],
// y: ["y", "x"],
// offsetLeft: ["offsetLeft", "offsetTop"],
// offsetTop: ["offsetTop", "offsetLeft"],
// offsetWidth: ["offsetWidth", "offsetHeight"],
// offsetHeight: ["offsetHeight", "offsetWidth"],
// width: ["width","height"],
// height: ["height","width"],
// marginLeft: ["marginLeft","marginTop"],
// marginRight: ["marginRight","marginBottom"],

/*
var HORIZONTAL_PROPS = {
	pos: "x",
	size: "width",
	offsetPos: "offsetLeft",
	offsetSize: "offsetWidth",
	marginBefore: "marginLeft",
	marginAfter: "marginRight",
};
var VERTICAL_PROPS = {
	pos: "y",
	size: "height",
	offsetPos: "offsetTop",
	offsetSize: "offsetHeight",
	marginBefore: "marginTop",
	marginAfter: "marginBottom",
};
*/

// var DIRECTION_NONE = 1;
// var DIRECTION_LEFT = 2;
// var DIRECTION_RIGHT = 4;
// var DIRECTION_UP = 8;
// var DIRECTION_DOWN = 16;

// function dirToStr(dir) {
// 	if (dir === Hammer.DIRECTION_NONE) return 'NONE';
// 	if (dir === Hammer.DIRECTION_LEFT) return 'LEFT';
// 	if (dir === Hammer.DIRECTION_RIGHT) return 'RIGHT';
// 	if (dir === Hammer.DIRECTION_UP) return 'UP';
// 	if (dir === Hammer.DIRECTION_DOWN) return 'DOWN';
// 	if (dir === Hammer.DIRECTION_HORIZONTAL) return 'HORIZONTAL';
// 	if (dir === Hammer.DIRECTION_VERTICAL) return 'VERTICAL';
// 	if (dir === Hammer.DIRECTION_ALL) return 'ALL';
// 	return 'UNRECOGNIZED';
// }

var isValidTouchManager = function(touch, direction) {
	// var retval;
	try {
		return touch.get("hpan").options.direction == direction;
	} catch (err) {
		return false;
	}
	// return retval;
};

// /** @type {int} In pixels */
// var panThreshold: 15;

var createTouchManager = function(el, dir, thres) {
	var touch = new Hammer.Manager(el);
	var pan = new Hammer.Pan({
		threshold: 15,
		direction: dir,
	});
	var tap = new Hammer.Tap({
		threshold: thres - 1,
		interval: 50,
		time: 200,
	});
	tap.recognizeWith(pan);
	touch.add([pan, tap]);
	return touch;
};


var Carousel = {
	/** const */
	ANIMATED: false,
	/** const */
	IMMEDIATE: true,

	/** copy of Hammer.DIRECTION_VERTICAL */
	DIRECTION_VERTICAL: VERTICAL,
	/** copy of Hammer.DIRECTION_HORIZONTAL */
	DIRECTION_HORIZONTAL: HORIZONTAL,
	/** @type {Object} */
	defaults: {
		/** @type {boolean} */
		selectOnScrollEnd: false,
		/** @type {boolean} */
		requireSelection: false,
		/** @type {int} */
		direction: HORIZONTAL,
		/** @type {int} In pixels */
		selectThreshold: 20,
		/** @type {Function} */
		rendererFunction: (function() {
			var defaultRenderer = CarouselRenderer.extend({
					className: "carousel-item default-renderer"
				}),
				emptyRenderer = CarouselRenderer.extend({
					className: "carousel-item empty-renderer"
				});
			return function(item, index, arr) {
				return (index === -1) ? emptyRenderer : defaultRenderer;
			};
		})(),
	},
};
Carousel.validOptions = _.keys(Carousel.defaults);

/**
/* @constructor
/* @type {module:app/view/component/Carousel}
/*/
var CarouselProto = {

	/** @override */
	cidPrefix: "carousel",
	/** @override */
	tagName: "div",
	/** @override */
	className: "carousel skip-transitions",

	/* --------------------------- *
	/* properties
	/* --------------------------- */

	properties: {
		scrolling: {
			get: function() {
				return this._scrolling;
			}
		},
		selectedItem: {
			get: function() {
				return this._selectedView.model;
			},
			set: function(value) {
				if (value)
					this._onSelectOne(value)
				else
					this._onSelectNone();
			}
		},
	},

	events: {
		// "mousedown": "_onMouseDown", "mouseup": "_onMouseUp",
		"transitionend .carousel-item.selected": "_onScrollTransitionEnd",
	},

	/** @override */
	initialize: function(options) {
		_.bindAll(this, "_onTouchEvent");

		this.itemViews = new Container();
		this.metrics = {};

		_.extend(this, _.defaults(_.pick(options, Carousel.validOptions), Carousel.defaults));

		// this.childGap = 0; //this.dirProp(20, 18);
		this._precedingDir = (Hammer.DIRECTION_LEFT | Hammer.DIRECTION_UP) & this.direction;
		this._followingDir = (Hammer.DIRECTION_RIGHT | Hammer.DIRECTION_DOWN) & this.direction;

		// use supplied touch mgr or create private
		if (isValidTouchManager(options.touch, this.direction)) {
			this.touch = options.touch;
		} else {
			console.warn("%s::initializeHammer using private Hammer instance", this.cid);
			this.touch = createTouchManager(this.el, this.direction);
			// this.on("view:removed", this.touch.destroy, this.touch);
			this.listenTo(this, "view:removed", function() {
				this.touch.destroy();
			});
		}

		/* create children and props */
		this.setEnabled(true);
		this.skipTransitions = true;
		this._renderFlags = View.CHILDREN_INVALID;
		// this.invalidateChildren();

		this.listenTo(this, "view:attached", function() {
			this.skipTransitions = true;
			// this.invalidateSize();
			// this.renderNow();
			// this.requestRender();
			this.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID);
		});

		/* collection listeners */
		this.listenTo(this.collection, {
			"reset": this._onReset,
			"select:one": this._onSelectOne,
			"select:none": this._onSelectNone,
			"deselect:one": this._onDeselectAny,
			"deselect:none": this._onDeselectAny,
		});
	},
	/* --------------------------- *
	/* Hammer init
	/* --------------------------- */

	// validateTouchManager: function(touch, direction) {
	// 	try {
	// 		return touch.get("pan").options.direction === direction);
	// 	} catch (err) {
	// 		return false;
	// 	}
	// },

	// initializeHammer: function(options) {
	// 	// direction from opts/defaults
	// 	if (options.direction === VERTICAL) {
	// 		this.direction = VERTICAL;
	// 	} // do nothing: the default is horizontal
	//
	// 	// validate hammer instance or create local
	// 	if ((touch = options.touch) && (pan = touch.get("pan"))) {
	// 		// Override direction only if specific
	// 		if (pan.options.direction !== Hammer.DIRECTION_ALL) {
	// 			this.direction = pan.options.direction;
	// 		}
	// 		this.panThreshold = pan.options.threshold;
	// 	} else {
	// 		console.warn("%s::initializeHammer using private Hammer instance", this.cid);
	// 		touch = createHammerInstance(this.el, this.panThreshold, this.direction);
	// 		this.on("view:removed", touch.destroy, touch);
	// 	}
	// 	this.touch = touch;
	// },

	remove: function() {
		// this._scrollPendingAction && this._scrollPendingAction(true);
		// if (this._enabled) {
		// 	this.touch.off("tap", this._onTap);
		// 	this.touch.off("hpanstart hpanmove hpanend hpancancel", this._onPan);
		// }
		this._toggleTouchEvents(false);
		this.removeChildren();
		View.prototype.remove.apply(this, arguments);
		return this;
	},


	/* --------------------------- *
	/* helper functions
	/* --------------------------- */

	dirProp: function(hProp, vProp) {
		return (this.direction & HORIZONTAL) ? hProp : vProp;
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	// render: function() {
	// 	if (this.attached) {
	// 		this.skipTransitions = true;
	// 		// this.invalidateSize();
	// 		this.renderNow(true);
	// 	}
	// },

	// /** @override */
	// render: function () {
	// 	if (!this.attached) {
	// 		if (!this._renderPending) {
	// 			this._renderPending = true;
	// 			this.listenTo(this, "view:attached", this.render);
	// 		}
	// 	} else {
	// 		if (this._renderPending) {
	// 			this._renderPending = false;
	// 			this.stopListening(this, "view:attached", this.render);
	// 		}
	// 		this._delta = 0;
	// 		this.skipTransitions = true;
	// 		this.invalidateSize();
	// 		// this.invalidateLayout();
	// 		this.renderNow();
	// 	}
	// 	return this;
	// },

	// render: function () {
	// 	this.measureLater();
	// 	this.scrollBy(0, Carousel.IMMEDIATE);
	//
	// 	if (this.el.parentElement) {
	// 		this.renderNow();
	// 	}
	// 	return this;
	// },

	/** @override */
	renderFrame: function(tstamp, flags) {
		if (flags & View.CHILDREN_INVALID) {
			this._createChildren();
			// clear this flag now: render may be deferred until attached
			flags &= ~View.CHILDREN_INVALID;
		}
		if (this.attached) {
			if (flags & View.SIZE_INVALID) {
				this._measure();
			}
			if (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {
				this._scrollBy(this._delta, this.skipTransitions);
			}
		} else if (flags) {
			this.listenToOnce(this, "view:attached", function() {
				this.requestRender(flags);
			});
		}
	},

	/* --------------------------- *
	/* enabled
	/* --------------------------- */

	/** @override */
	_enabled: undefined,

	/** @override */
	setEnabled: function(enabled) {
		if (this._enabled !== enabled) {
			this._enabled = enabled;
			// toggle events immediately
			this._toggleTouchEvents(enabled);
			// dom manipulation on render (_renderEnabled)
			// this._renderFlags |= View.STYLES_INVALID;
			// this.requestRender();

			this.el.classList.toggle("disabled", !this.enabled);
			this.itemViews.each(function(view) {
				view.setEnabled(this.enabled);
			}, this);
		}
	},

	_renderEnabled: function() {
		this.el.classList.toggle("disabled", !this.enabled);
		this.itemViews.each(function(view) {
			view.setEnabled(this.enabled);
		}, this);
	},

	/* --------------------------- *
	/* Create children
	/* --------------------------- */

	_createChildren: function() {
		// var sIndex;
		var buffer, renderer, view, viewOpts;

		this.removeChildren();

		if (this.collection.length) {
			viewOpts = {
				// viewDepth: this.viewDepth + 1,
				// parentView: this,
				enabled: this.enabled
			};
			buffer = document.createDocumentFragment();
			// buffer = this.el;

			if (!this.requireSelection) {
				renderer = this.rendererFunction(null, -1, this.collection);
				view = new renderer(viewOpts);
				this.itemViews.add(view);
				buffer.appendChild(view.el);
				this.emptyView = view;
			}

			this.collection.each(function(item, index, arr) {
				viewOpts.model = item;
				renderer = this.rendererFunction(item, index, arr);
				view = new renderer(viewOpts);
				this.itemViews.add(view);
				buffer.appendChild(view.el);
			}, this);

			// if (!this.requireSelection) {
			// 	buffer = this.appendItemView(buffer, this.model, -1, this.collection);
			// 	this.emptyView = this.itemViews.first();
			// }
			// buffer = this.collection.reduce(this.appendItemView, buffer, this);

			this.adjustToSelection();
			this._selectedView.el.classList.add("selected");

			this.el.appendChild(buffer);
		}
	},

	// appendItemView: function (parentEl, model, index, arr) {
	// 	var renderer = this.rendererFunction(model, index, arr);
	// 	var view = new renderer({
	// 		model: model,
	// 		parentView: this,
	// 		enabled: this.enabled
	// 	});
	// 	this.itemViews.add(view);
	// 	parentEl.appendChild(view.el);
	// 	return parentEl;
	// },

	// createItemView: function (renderer, opts) {
	// 	var view = new renderer(opts);
	// 	this.itemViews.add(view);
	// 	return view;
	// },

	removeChildren: function() {
		this.itemViews.each(this.removeItemView, this);
		this.emptyView = void 0;
	},

	removeItemView: function(view) {
		this.itemViews.remove(view);
		view.remove();
		return view;
	},

	/* --------------------------- *
	/* measure
	/* --------------------------- */

	_measure: function() {
		var m, mm;
		var pos = 0,
			posInner = 0;
		var maxAcross = 0,
			maxOuter = 0;
		var maxOuterView, maxAcrossView;

		maxOuterView = maxAcrossView = this.emptyView || this.itemViews.first();

		// chidren metrics
		this.itemViews.each(function(view) {
			view.render();
		});

		this.itemViews.each(function(view) {
			m = this.measureItemView(view);
			m.pos = pos;
			pos += m.outer; // + this.childGap;
			m.posInner = posInner;
			posInner += m.inner; //+ this.childGap;
			if (view !== this.emptyView) {
				if (m.across > maxAcross) {
					maxAcross = m.across;
					maxAcrossView = view;
				}
				if (m.outer > maxOuter) {
					maxOuter = m.outer;
					maxOuterView = view;
				}
			}
		}, this);

		// measure self + max child metrics
		mm = this.metrics[this.cid] || (this.metrics[this.cid] = {});
		mm.outer = this.el[this.dirProp("offsetWidth", "offsetHeight")];
		mm.before = maxOuterView.el[this.dirProp("offsetLeft", "offsetTop")];
		mm.inner = maxOuterView.el[this.dirProp("offsetWidth", "offsetHeight")];
		mm.after = mm.outer - (mm.inner + mm.before);
		mm.across = maxAcross;

		// m = this.metrics[maxOuterView.cid];
		// mm.inner = m.inner;

		// tap area
		this._tapAcrossBefore = maxAcrossView.el[this.dirProp("offsetTop", "offsetLeft")];
		this._tapAcrossAfter = this._tapAcrossBefore + maxAcross;
		this._tapBefore = mm.before + this._tapGrow;
		this._tapAfter = mm.before + mm.inner - this._tapGrow;

		this.selectThreshold = Math.min(MAX_SELECT_THRESHOLD, mm.outer * 0.1);
	},

	measureItemView: function(view) {
		var m, viewEl;
		// var s, sizeEl;

		viewEl = view.el;
		m = this.metrics[view.cid] || (this.metrics[view.cid] = {});

		m.outer = viewEl[this.dirProp("offsetWidth", "offsetHeight")];
		m.across = viewEl[this.dirProp("offsetHeight", "offsetWidth")];

		if (view.metrics) {
			m.before = view.metrics[this.dirProp("marginLeft", "marginTop")];
			m.outer += m.before;
			m.outer += view.metrics[this.dirProp("marginRight", "marginBottom")];
			m.inner = view.metrics.content[this.dirProp("width", "height")];
			m.before += view.metrics.content[this.dirProp("x", "y")];
			m.after = m.outer - (m.inner + m.before);

			// var marginBefore = view.metrics[this.dirProp("marginLeft","marginTop")];
			// var marginAfter = view.metrics[this.dirProp("marginRight","marginBottom")];
			// var pos = view.metrics.content[this.dirProp("x","y")];
			//
			// m.inner = view.metrics.content[this.dirProp("width","height")];
			// m.before = marginBefore + pos;
			// m.outer += marginBefore + marginAfter;
			// m.after = m.outer - (m.inner + m.before);
		} else {
			// throw new Error("renderer has no metrics");
			console.warn("%s::measureItemView view '%s' has no metrics", this.cid, view.cid);
			m.inner = m.outer;
			m.after = m.before = 0;
		}

		return m;
	},

	/* --------------------------- *
	/* scrolling property
	/* --------------------------- */

	_delta: 0,

	_scrolling: false,

	_setScrolling: function(scrolling) {
		// console.warn("_setScrolling current/requested", this._scrolling, scrolling);
		if (this._scrolling != scrolling) {
			this._scrolling = scrolling;
			this.el.classList.toggle("scrolling", scrolling);
			this.trigger(scrolling ? "view:scrollstart" : "view:scrollend");
		}
	},

	/* --------------------------- *
	/* Scroll/layout
	/* --------------------------- */

	scrollBy: function(delta, skipTransitions) {
		this._delta = delta || 0;
		this.skipTransitions = !!skipTransitions;
		// this.invalidateLayout();
		this.requestRender(View.LAYOUT_INVALID);
	},

	_scrollBy: function(delta, skipTransitions) {
		var sMetrics, metrics, pos;

		sMetrics = this.metrics[(this._scrollCandidateView || this._selectedView).cid];
		this.itemViews.each(function(view) {
			metrics = this.metrics[view.cid];
			pos = Math.floor(this._getScrollOffset(delta, metrics, sMetrics));
			view.metrics.translateX = (this.direction & HORIZONTAL) ? pos : 0;
			view.metrics.translateY = (this.direction & HORIZONTAL) ? 0 : pos;
			view.metrics._transform = translateTemplate(view.metrics.translateX, view.metrics.translateY);
			view.el.style[transformProperty] = view.metrics._transform;
			// view.el.style[transformProperty] = (this.direction & HORIZONTAL)?
			// 	"translate3d(" + pos + "px,0,0)":
			// 	"translate3d(0," + pos + "px,0)";
		}, this);

		this.el.classList.toggle("skip-transitions", skipTransitions);
		this.selectFromView();
	},

	_getScrollOffset: function(delta, mCurr, mSel) {
		var pos, offset = 0;

		pos = mCurr.pos - mSel.pos + delta;
		if (pos < 0) {
			if (Math.abs(pos) < mCurr.outer) {
				offset += (-mCurr.after) / mCurr.outer * pos;
			} else {
				offset += mCurr.after;
			}
		} else
		if (0 <= pos) {
			if (Math.abs(pos) < mCurr.outer) {
				offset -= mCurr.before / mCurr.outer * pos;
			} else {
				offset -= mCurr.before;
			}
		}
		return pos + offset;
	},

	_onScrollTransitionEnd: function(ev) {
		if (ev.propertyName === transformStyleName && this.scrolling) {
			console.log("%s::_onScrollTransitionEnd selected: %s", this.cid, ev.target.cid);
			this._setScrolling(false);
		}
	},

	/* --------------------------- *
	/* toggle touch events
	/* --------------------------- */

	_toggleTouchEvents: function(enable) {
		// console.log("%s::_toggleTouchEvents", this.cid, enable);
		if (this._touchEventsEnabled !== enable) {
			this._touchEventsEnabled = enable;
			if (enable) {
				this.touch.on("hpanstart hpanmove hpanend hpancancel tap", this._onTouchEvent);
			} else {
				this.touch.off("hpanstart hpanmove hpanend hpancancel tap", this._onTouchEvent);
			}
		}
	},

	_onTouchEvent: function(ev) {
		// console.log("%s::_onTouchEvent", this.cid, ev.type);
		switch (ev.type) {
			case "tap":
				return this._onTap(ev);
			case "hpanstart":
				return this._onPanStart(ev);
			case "hpanmove":
				return this._onPanMove(ev);
			case "hpanend":
				return this._onPanFinal(ev);
			case "hpancancel":
				return this._onPanFinal(ev);
		}
	},

	/* --------------------------- *
	/* touch event: pan
	/* --------------------------- */

	// _panCapturedOffset: 0,

	/** @param {Object} ev */
	_onPanStart: function(ev) {
		this.selectFromView();
		this.el.classList.add("panning");
		this._setScrolling(true);
	},

	/** @param {Object} ev */
	_onPanMove: function(ev) {
		var view = this.getViewAtPanDir(ev.offsetDirection);
		var delta = (this.direction & HORIZONTAL) ? ev.thresholdDeltaX : ev.thresholdDeltaY;
		// var delta = (this.direction & HORIZONTAL) ? ev.deltaX : ev.deltaY;

		if (this._panCandidateView !== view) {
			this._panCandidateView && this._panCandidateView.el.classList.remove("candidate");
			this._panCandidateView = view;
			this._panCandidateView && this._panCandidateView.el.classList.add("candidate");
		}
		if (this._panCandidateView === void 0) {
			delta *= Globals.HPAN_OUT_DRAG;
		}

		if (this._renderRafId !== -1) {
			this.scrollBy(delta, Carousel.IMMEDIATE);
			this.renderNow();
		} else {
			this._scrollBy(delta, Carousel.IMMEDIATE);
		}
	},

	/** @param {Object} ev */
	_onPanFinal: function(ev) {
		var scrollCandidate;
		// NOTE: this delta is used for determining selection, NOT for layout
		var delta = (this.direction & HORIZONTAL) ? ev.thresholdDeltaX : ev.thresholdDeltaY;
		// var delta = (this.direction & HORIZONTAL) ? ev.deltaX : ev.deltaY;

		if ((ev.type == "hpanend")
			/* pan direction (current event) and offsetDirection (whole gesture) must match */
			&& (ev.direction ^ ev.offsetDirection ^ this.direction)
			// && (ev.direction & ev.offsetDirection & this.direction)
			/* gesture must overshoot selectThreshold */
			&& (Math.abs(delta) > this.selectThreshold)) {
			/* choose next scroll target */
			scrollCandidate = this.getViewAtPanDir(ev.offsetDirection);
		}
		this._scrollCandidateView = scrollCandidate || void 0;

		if (this._panCandidateView && (this._panCandidateView !== scrollCandidate)) {
			this._panCandidateView.el.classList.remove("candidate");
		}
		this._panCandidateView = void 0;
		this.el.classList.remove("panning");

		this.scrollBy(0, Carousel.ANIMATED);
		this.selectFromView();

		// if (this._renderRafId !== -1) {
		// 	this.scrollBy(0, Carousel.ANIMATED);
		// 	this.renderNow();
		// } else {
		// 	this._scrollBy(0, Carousel.ANIMATED);
		// }
	},

	/* --------------------------- *
	/* touch event: tap
	/* --------------------------- */

	getViewAtPanDir: function(dir) {
		// return (dir & this._precedingDir) ? this._precedingView : this._followingView;
		return (dir & this._followingDir) ? this._precedingView : this._followingView;
	},

	/** @type {int} In pixels */
	_tapGrow: 10,

	getViewAtTapPos: function(pos, posAcross) {
		if (this._tapAcrossBefore < posAcross && posAcross < this._tapAcrossAfter) {
			if (pos < this._tapBefore) {
				return this._precedingView;
			} else if (pos > this._tapAfter) {
				return this._followingView;
			}
		}
		return void 0;
	},

	_onTap: function(ev) {
		var targetView = View.findByDescendant(ev.target);
		// if (!this.itemViews.contains(targetView)) {
		// 	return;
		// }
		do {
			if (this._selectedView === targetView) {
				// console.log("%s tap ocurred on selected: %o", this.cid, targetView);
				return;
			} else if (this === targetView) {
				// console.log("%s tap ocurred on carousel: %o", this.cid, targetView);
				break;
			}
		} while ((targetView = targetView.parentView))

		// this.selectFromView();

		var bounds = this.el.getBoundingClientRect();
		var tapX = ev.center.x - bounds.left;
		var tapY = ev.center.y - bounds.top;
		var tapCandidate = this.getViewAtTapPos(
			this.dirProp(tapX, tapY),
			this.dirProp(tapY, tapX)
		);

		if (tapCandidate) {
			console.log("%s::_onTap %o", this.cid, ev);
			ev.preventDefault();
			// ev.stopPropagation();

			// this._scrollCandidateView = tapCandidate;
			// this._setScrolling(true);
			// this.scrollBy(0, Carousel.ANIMATED);
			// this._scrollCandidateView.el.classList.add("candidate");
			// this.selectFromView();

			//// NOT using internalSelection
			// this.triggerSelectionEvents(tapCandidate, false);

			// using internalSelection
			this._scrollCandidateView = tapCandidate;
			this._setScrolling(true);
			this.scrollBy(0, Carousel.ANIMATED);

			this.triggerSelectionEvents(tapCandidate, true);
			// this.renderNow();
		}
	},

	/* --------------------------- *
	/* Private
	/* --------------------------- */

	triggerSelectionEvents: function(view, internal) {
		if (view === void 0 || this._internalSelection) {
			return;
		}

		this._internalSelection = !!internal;
		if (view === this.emptyView) {
			this.trigger("view:select:none");
		} else {
			this.trigger("view:select:one", view.model);
		}
		this._internalSelection = false;
	},

	selectFromView: function() {
		if (this._scrollCandidateView === void 0) {
			return;
		}
		var view = this._scrollCandidateView;
		this._scrollCandidateView = void 0;
		view.el.classList.remove("candidate");

		this.triggerSelectionEvents(view, true);
	},

	adjustToSelection: function() {
		var m, i = this.collection.selectedIndex;
		// assume -1 < index < this.collection.length
		if (this.requireSelection) {
			(i == -1) && i++; // if selection is null (index -1), set _selectedView to first item (index 0)
			this._selectedView = (m = this.collection.at(i)) && this.itemViews.findByModel(m);
			this._precedingView = (m = this.collection.at(i - 1)) && this.itemViews.findByModel(m);
			this._followingView = (m = this.collection.at(i + 1)) && this.itemViews.findByModel(m);
		} else {
			this._selectedView = (m = this.collection.at(i)) ? this.itemViews.findByModel(m) : this.emptyView;
			this._precedingView = m && ((m = this.collection.at(i - 1)) ? this.itemViews.findByModel(m) : this.emptyView);
			this._followingView = (m = this.collection.at(i + 1)) && this.itemViews.findByModel(m);
		}
	},

	/* --------------------------- *
	/* Model listeners
	/* --------------------------- */

	/** @private */
	_onSelectOne: function(model) {
		if (model === this._selectedView.model) {
			// console.info("INTERNAL");
			return;
		}
		this._onSelectAny(model);
	},

	/** @private */
	_onSelectNone: function() {
		if ((this.requireSelection ? this.itemViews.first() : this.emptyView) === this._selectedView) {
			// console.info("INTERNAL");
			return;
		}
		this._onSelectAny();
	},

	/** @private */
	_onSelectAny: function(model) {
		this._selectedView.el.classList.remove("selected");
		this.adjustToSelection();
		this._selectedView.el.classList.add("selected");

		if (!this._internalSelection) {
			this._setScrolling(true);
			this.scrollBy(0, Carousel.ANIMATED);
		}
	},

	// _onDeselectAny: function (model) {},

	/** @private */
	_onReset: function() {
		// this._createChildren();
		// this.invalidateChildren();
		this.requestRender(View.CHILDREN_INVALID | View.MODEL_INVALID);
	},


	/* --------------------------- *
	/* TEMP
	/* --------------------------- */

	// _scrollBy2: function (delta, skipTransitions) {
	// 	var metrics, pos;
	// 	var sMetrics = this.metrics[(this._scrollCandidateView || this._selectedView).cid];
	// 	var cMetrics = this.metrics[(this._panCandidateView || this._selectedView).cid];
	//
	// 	this.itemViews.each(function (view) {
	// 		metrics = this.metrics[view.cid];
	// 		pos = Math.floor(this._getScrollOffset(delta, metrics, sMetrics, cMetrics));
	// 		view.el.style[transformProperty] = (this.direction & HORIZONTAL)?
	// 				"translate3d(" + pos + "px,0,0)" : "translate3d(0," + pos + "px,0)";
	// 				// "translate(" + pos + "px,0)" : "translate(0," + pos + "px)";
	// 				// "translateX(" + pos + "px)" : "translateY(" + pos + "px)";
	// 	}, this);
	// 	this.el.classList.toggle("skip-transitions", skipTransitions);
	// 	this.selectFromView();
	// },

	// _getScrollOffset2: function (delta, mCurr, mSel, mCan) {
	// 	var offset = 0;
	// 	var posInner = mCurr.posInner - mSel.posInner + delta;
	//
	// 	if (posInner < -mSel.inner) {
	// 		offset = -(mCurr.before);
	// 	} else if (posInner > mSel.inner) {
	// 		offset = (mSel.after);
	// 	} else {
	// 		if (posInner < 0) {
	// 			offset = (mCurr.before) / (mCurr.inner) * posInner;
	// 		} else {
	// 			offset = (mSel.after) / (mCan.inner) * posInner;
	// 		}
	// 	}
	// 	return posInner + offset;
	// },

	// captureSelectedOffset: function() {
	// 	var val, view, cssval, m, mm;
	//
	// 	val = 0;
	// 	view = this._scrollCandidateView || this._selectedView;
	// 	cssval = getComputedStyle(view.el)[transformProperty];
	//
	// 	mm = cssval.match(/(matrix|matrix3d)\(([^\)]+)\)/);
	// 	if (mm) {
	// 		m = mm[2].split(",");
	// 		if (this.direction & HORIZONTAL) {
	// 			val = m[mm[1]=="matrix"? 4 : 12];
	// 		} else {
	// 			val = m[mm[1]=="matrix"? 5 : 13];
	// 		}
	// 		val = parseFloat(val);
	// 	}
	//
	// 	console.log("%s::captureSelectedOffset", this.cid, cssval, val, cssval.match(/matrix\((?:\d\,){3}(\d)\,(\d)|matrix3d\((?:\d\,){11}(\d)\,(\d)/));
	//
	// 	return val;
	// },

	// _onScrollEnd: function(exec) {
	// 	this._scrollEndCancellable = void 0;
	// 	// this.el.classList.remove("disabled-changing");
	// 	if (exec) {
	// 		this._setScrolling(false);
	// 		// this.el.classList.remove("scrolling");
	// 		// this.trigger("view:scrollend");
	// 		console.log("%s::_onScrollEnd", this.cid);
	// 	}
	// },
	// _onMouseDown: function(ev) {
	// 	if (this._scrolling) {
	// 		this._panCapturedOffset = this.captureSelectedOffset();
	// 		console.log("%s::events[mousedown] scrolling interrupted (pos %f)", this.cid, this._panCapturedOffset);
	// 	}
	// },
	// _onMouseUp:function(ev) {
	// 	this._panCapturedOffset = 0;
	// },

};

module.exports = Carousel = View.extend(CarouselProto, Carousel);
},{"app/control/Globals":34,"app/view/base/View":58,"app/view/render/CarouselRenderer":81,"backbone.babysitter":"backbone.babysitter","hammerjs":"hammerjs","underscore":"underscore","utils/prefixedProperty":113,"utils/prefixedStyleName":114}],64:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper;

  return container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(depth0 != null ? depth0 : {},{"name":"id","hash":{},"data":data}) : helper)));
},"useData":true});

},{"hbsfy/runtime":21}],65:[function(require,module,exports){
/**
 * @module app/view/component/CollectionStack
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
// /** @type {Function} */
// var transitionEnd = require("utils/event/transitionEnd");
/** @type {Function} */
var setImmediate = require("utils/setImmediate");

/** @type {string} */
var viewTemplate = require("./CollectionStack.hbs");

/**
 * @constructor
 * @type {module:app/component/CollectionStack}
 */
module.exports = View.extend({

	/** @override */
	cidPrefix: "stack",
	/** @override */
	tagName: "div",
	/** @override */
	className: "stack",
	/** @override */
	template: viewTemplate,

	events: {
		"transitionend": function(ev) {
			// console.log("%s::transitionend [invalid: %s] [transition: %s]", this.cid, this._contentInvalid, (this._skipTransitions? "skip": "run"), ev.target.id, ev.target.className);
			this._renderContent();
		}
	},

	initialize: function(options) {
		this._enabled = true;
		this._skipTransitions = true;
		this._contentInvalid = true;

		options.template && (this.template = options.template);
		this.content = document.createElement("div");
		this.content.className = "stack-item";
		this.el.appendChild(this.content);

		this.listenTo(this.collection, "select:one select:none", this._onSelectChange);
	},

	setEnabled: function(enabled) {
		if (this._enabled !== enabled) {
			this._enabled = enabled;
			this.el.classList.toggle("disabled", !this._enabled);
		}
	},

	_onSelectChange: function(item) {
		if (this._renderedItem === this.collection.selected) {
			throw new Error("change event received but item is identical");
		}
		this._renderedItem = this.collection.selected;

		this._contentInvalid = true;
		this.render();
	},

	/* --------------------------- *
	/* render
	/* --------------------------- */

	render: function() {
		if (this._skipTransitions) {
			// execute even if content has not changed to apply styles immediately
			this._skipTransitions = false;
			this.el.classList.add("skip-transitions");
			setImmediate(function() {
				this.el.classList.remove("skip-transitions");
			}.bind(this));

			// render changed content immediately
			if (this._contentInvalid) {
				this._renderContent();
			}
		} else {
			// else remove 'current' class and render on transitionend
			if (this._contentInvalid) {
				this.content.classList.remove("current");
				// this.content.className = "stack-item";
			}
		}
		return this;
	},

	_renderContent: function() {
		if (this._contentInvalid) {
			this._contentInvalid = false;
			var item = this.collection.selected;
			this.content.innerHTML = item ? this.template(item.toJSON()) : "";
			this.content.classList.add("current");
			// this.content.className = "stack-item current";
		}
	},
});

},{"./CollectionStack.hbs":64,"app/view/base/View":58,"utils/setImmediate":116}],66:[function(require,module,exports){
(function (DEBUG){
/**
/* @module app/view/component/FilterableListView
/*/

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");
/** @type {module:utils/prefixedProperty} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {module:utils/css/getBoxEdgeStyles} */
var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

var diff = function(a1, a2, dest) {
	return a1.reduce(function(res, o, i, a) {
		if (a2.indexOf(o) == -1) res.push(o);
		return res;
	}, dest || []);
};

/** @type {module:app/control/Globals.TRANSLATE_TEMPLATE} */
var translateCssValue = require("app/control/Globals").TRANSLATE_TEMPLATE;

/** @const */
var transformProp = prefixedProperty("transform");

/**
/* @constructor
/* @type {module:app/view/component/FilterableListView}
/*/
var FilterableListView = View.extend({

	/** @type {string} */
	cidPrefix: "filterableList",
	/** @override */
	tagName: "ul",
	/** @override */
	className: "list selectable filterable",

	/** @override */
	defaults: {
		collapsed: true,
		filterFn: function() {
			return true;
		},
		renderer: ClickableRenderer.extend({
			/** @override */
			cidPrefix: "listItem",
		}),
	},

	/** @override */
	properties: {
		collapsed: {
			get: function() {
				return this._collapsed;
			},
			set: function(value) {
				this._setCollapsed(value);
			}
		},
		selectedItem: {
			get: function() {
				return this._selectedItem;
			},
			set: function(value) {
				this._setSelection(value);
			}
		},
		filteredItems: {
			get: function() {
				return this._filteredItems;
			}
		}
	},

	/** @override */
	events: {
		"transitionend .list-item": function(ev) {
			if (this._collapsedTransitioning && ev.propertyName === "visibility" /*&& this.el.classList.contains("collapsed-changed")*/ ) {
				this._collapsedTransitioning = false;
				this.el.classList.remove("collapsed-changed");
				console.log("%s::events[transitionend .list-item] collapsed-changed end", this.cid);
			}
		},
	},

	/** @override */
	initialize: function(options) {
		this._metrics = {};
		this._itemMetrics = [];
		this.itemViews = new Container();

		_.defaults(options, this.defaults);
		this.renderer = options.renderer;
		this._filterFn = options.filterFn;
		this._filteredItems = [];

		this.collection.each(this.createItemView, this);
		this.refresh();
		this._setSelection(this.collection.selected);
		this._setCollapsed(options.collapsed);

		// will trigger on return if this.el is already attached
		// this.skipTransitions = true;
		this.listenTo(this, "view:attached", function() {
			this.skipTransitions = true;
			this.requestRender(View.SIZE_INVALID | View.LAYOUT_INVALID); //.renderNow();
		});

		// this.listenTo(this.collection, "select:one select:none", this._setSelection);
		this.listenTo(this.collection, "reset", function() {
			this._allItems = null;
			throw new Error("not implemented");
		});
	},

	/* --------------------------- *
	/* Render
	/* --------------------------- */

	/** @override */
	renderFrame: function(tstamp, flags) {
		if (DEBUG) {
			var changed = [];
			this._collapsedChanged && changed.push("collapsed");
			this._selectionChanged && changed.push("selection");
			this._filterChanged && changed.push("filter");
			console.log("%s::renderFrame [%s]", this.cid, changed.join(" "));
		}

		// collapsed transition flag
		if (this._collapsedTransitioning) {
			console.warn("%s::renderFrame collapsed tx interrupted", this.cid);
		}

		this._collapsedTransitioning = !this.skipTransitions && this._collapsedChanged;

		// this.el.classList.toggle("animate", !this.skipTransitions);
		this.el.classList.toggle("collapsed-changed", this._collapsedTransitioning);
		this.el.classList.toggle("skip-transitions", this.skipTransitions);
		if (this.skipTransitions) {
			this.skipTransitions = false;
			// Invalidate again after frame render loop to reapply transforms:
			// that should kill any running transitions.
			this.setImmediate(function() {
				this.requestRender(View.LAYOUT_INVALID);
			});
		}
		if (this._collapsedChanged) {
			flags |= (View.SIZE_INVALID);
			this.el.classList.toggle("collapsed", this._collapsed);
		}
		if (this._selectionChanged) {
			flags |= View.LAYOUT_INVALID;
			this.renderSelection(this.collection.selected, this.collection.lastSelected);
		}
		if (this._filterChanged) {
			flags |= View.LAYOUT_INVALID;
			this.renderFilterFn();
		}
		if (flags & View.SIZE_INVALID) {
			this.measure();
		}
		if (flags & (View.LAYOUT_INVALID | View.SIZE_INVALID)) {
			this.renderLayout();
		}
		this._collapsedChanged = this._selectionChanged = this._filterChanged = false;
	},

	measure: function() {
		// var i, ii, el, els, m, mm;
		// els = this.el.children;
		// ii = els.length;
		// mm = this._itemMetrics;
		// for (i = 0; i < ii; i++) {
		// 	mm[i] = _.pick(els[i], "offsetTop", "offsetHeight");
		// }

		this._metrics = getBoxEdgeStyles(this.el, this._metrics);

		// var itemEl, itemView, baseline = 0;
		// if (itemEl = this.el.querySelector(".list-item:not(.excluded) .label")) {
		// 	// itemView = this.itemViews.findByCid(itemEl.cid);
		// 	var elA = itemEl, elB = itemEl.parentElement;
		// 	var yA = elA.offsetTop,
		// 		hA = elA.offsetHeight,
		// 		yB = elB.offsetTop,
		// 		hB = elB.offsetHeight;
		// 	baseline = ((yA + hA) - (yB + hB));
		// 	console.log("%s::measure fontSize: %spx (%s+%s)-(%s+%s)=%s", this.cid, this._metrics.fontSize,
		// 		yA, hA, yB, hB, baseline
		// 	);
		// }

		this.itemViews.forEach(function(view) {
			if (!view._metrics) view._metrics = {};
			// view._metrics.baseline = this._metrics.fontSize - baseline;
			view._metrics.offsetTop = view.el.offsetTop;
			view._metrics.offsetHeight = view.el.offsetHeight;
			view._metrics.offsetLeft = view.el.offsetLeft;
			view._metrics.offsetWidth = view.el.offsetWidth;
			if (!this._collapsed && view.label) {
				view._metrics.textLeft = view.label.offsetLeft;
				view._metrics.textWidth = view.label.offsetWidth;
			} else {
				view._metrics.textLeft = view._metrics.offsetLeft;
				view._metrics.textWidth = view._metrics.offsetWidth;
			}
		}, this);

		// this._metrics.baseline = this._metrics.fontSize - baseline;
	},

	renderLayout: function() {
		var posX, posY;
		posX = this._metrics.paddingLeft;
		posY = this._metrics.paddingTop;

		for (var i = 0, ii = this.el.children.length; i < ii; i++) {
			var view = this.itemViews.findByCid(this.el.children[i].cid);
			if (((this.collection.selected && !view.model.selected) ||
					view.el.classList.contains("excluded")) && this._collapsed) {
				view.transform.tx = posX;
				view.transform.ty = posY;
			} else {
				if (view._metrics.offsetHeight == 0)
					posY -= view._metrics.offsetTop;
				view.transform.tx = posX;
				view.transform.ty = posY;
				posY += view._metrics.offsetHeight + view._metrics.offsetTop;
			}
			view.el.style[transformProp] = translateCssValue(view.transform.tx, view.transform.ty);
		}

		// posY += this._metrics.paddingBottom;
		this._metrics.height = Math.max(0, posY + this._metrics.paddingBottom);
		this.el.style.height = this._metrics.height + "px";
		// this.el.style.height = (posY > 0) ? posY + "px" : "";
	},

	/* --------------------------- *
	/* Child views
	/* --------------------------- */

	/** @private */
	createItemView: function(item, index) {
		var view = new this.renderer({
			model: item,
			el: this.el.querySelector(".list-item[data-id=\"" + item.id + "\"]")
		});
		item.set("excluded", false, { silent: true });
		this.listenTo(view, "renderer:click", this._onRendererClick);
		view.listenTo(item, "change:excluded", function(item, newVal) {
			// console.log(arguments);
			if (this.el.classList.contains("excluded") !== newVal) {
				console.warn("%s:[change:excluded] m:%o css: %o", this.cid, newVal, this.el.classList.contains("excluded"));
			}
			// this.el.classList.toggle("excluded", excluded);
		});
		this.itemViews.add(view);
		return view;
	},

	/** @private */
	_onRendererClick: function(item, ev) {
		if (this._collapsedTransitioning
			|| (this._collapsed && item.get("excluded"))) {
			return;
		}
		if (this.collection.selected !== item) {
			this.trigger("view:select:one", item);
		} else {
			if (ev.altKey) {
				this.trigger("view:select:none");
			} else {
				this.trigger("view:select:same", item);
			}
			// this.trigger("view:select:none");
		}
	},

	/* --------------------------- *
	/* Collapsed
	/* --------------------------- */

	/** @private */
	_collapsed: undefined,

	/**
	/* @param {Boolean}
	/*/
	_setCollapsed: function(collapsed) {
		if (collapsed !== this._collapsed) {
			this._collapsed = collapsed;
			this._collapsedChanged = true;
			this.requestRender();
		}
	},

	/* --------------------------- *
	/* Selection
	/* --------------------------- */

	/** @private */
	_selectedItem: undefined,

	/** @param {Backbone.Model|null} */
	_setSelection: function(item) {
		if (item !== this._selectedItem) {
			this._selectedItem = item;
			this._selectionChanged = true;
			this.requestRender(View.MODEL_INVALID);
		}
	},

	/** @private */
	renderSelection: function(newItem, oldItem) {
		var view;
		if (oldItem) {
			view = this.itemViews.findByModel(oldItem);
			view.el.classList.remove("selected");
			// view.label.classList.remove("color-fg");
			// view.label.classList.remove("color-reverse");
		}
		if (newItem) {
			view = this.itemViews.findByModel(newItem);
			view.el.classList.add("selected");
			// view.label.classList.add("color-fg");
			// view.label.classList.add("color-reverse");
		}
	},

	/* --------------------------- *
	/* Filter
	/* --------------------------- */

	refresh: function() {
		if (this._filterFn) {
			this._filterChanged = true;
			this.requestRender(View.MODEL_INVALID);
		}
	},

	renderFilterFn: function() {
		var items = this._filterFn ? this.collection.filter(this._filterFn, this) : this._getAllItems();
		this.renderFilters(items, this._filteredItems);
		this._filteredItems = items;
	},

	renderFilters: function(newItems, oldItems) {
		var hasNew = !!(newItems && newItems.length);
		var hasOld = !!(oldItems && oldItems.length);

		// console.log("%s::renderFilterFn", this.cid, newItems);

		if (hasNew) {
			diff((hasOld ? oldItems : this._getAllItems()), newItems).forEach(function(item) {
				this.itemViews.findByModel(item).el.classList.add("excluded");
				item.set("excluded", true);
			}, this);
		}
		if (hasOld) {
			diff((hasNew ? newItems : this._getAllItems()), oldItems).forEach(function(item) {
				this.itemViews.findByModel(item).el.classList.remove("excluded");
				item.set("excluded", false);
			}, this);
		}
		this.el.classList.toggle("has-excluded", hasNew);
	},

	_getAllItems: function() {
		return this._allItems || (this._allItems = this.collection.slice());
	},

	/* --------------------------- *
	/* Filter 2
	/* --------------------------- */

	// computeFiltered: function() {
	// 	this._filterResult = this.collection.map(this._filterFn, this);
	// },
	//
	// renderFiltered: function() {
	// 	this.collection.forEach(function(item, index) {
	// 		this.itemViews.findByModel(item).el.classList.toggle("excluded", !this._filterResult[index]);
	// 	}, this);
	// },

});

module.exports = FilterableListView;
}).call(this,true)

},{"app/control/Globals":34,"app/view/base/View":58,"app/view/render/ClickableRenderer":82,"backbone.babysitter":"backbone.babysitter","underscore":"underscore","utils/css/getBoxEdgeStyles":107,"utils/prefixedProperty":113}],67:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/view/component/GraphView
 */

/** @type {module:underscore} */
var _ = require("underscore");

/** @type {Function} */
var Color = require("color");

/** @type {module:app/view/base/CanvasView} */
var CanvasView = require("app/view/base/CanvasView");

/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

/** @type {module:utils/canvas/calcArcHConnector} */
var calcArcHConnector = require("utils/canvas/calcArcHConnector");

/** @type {module:utils/canvas/CanvasHelper} */
var CanvasHelper = require("utils/canvas/CanvasHelper");

/** @type {module:utils/geom/inflateRect} */
var inflateRect = require("utils/geom/inflateRect");

/** @type {module:utils/dom/getAbsoluteClientRect} */
var getAbsoluteClientRect = require("utils/dom/getAbsoluteClientRect");


// var BEZIER_CIRCLE = 0.551915024494;
// var MIN_CANVAS_RATIO = 2;
// var PI2 = Math.PI * 2;

var styleBase = {
	lineCap: "butt", // round, butt, square
	lineWidth: 0.75,
	lineDashOffset: 0,
	setLineDash: [[]],
	radiusBase: 0.75,
	/* factored to rem unit */ //6,
	radiusIncrement: 0.21, //3, //0.25,
	/* uses lineWidth multiplier */
	outlineWidth: 1.5,
	arrowSize: 0.3
};

if (DEBUG) {
	/* eslint-disable no-unused-vars */
	var _dStyles = {};
	_dStyles["defaults"] = {
		lineWidth: 0,
		fillStyle: "transparent",
		strokeStyle: "transparent",
		lineDashOffset: 0,
		setLineDash: [[]]
	};

	/* Stroke */
	[
		"red", "salmon", "sienna",
		"green", "yellowgreen", "olive",
		"blue", "lightskyblue", "midnightblue",
		"grey", "silver"
	]
	.forEach(function(colorName) {
		var rgbaValue = Color(colorName).alpha(0.75).rgbaString();

		_dStyles[colorName] = _.defaults({
			lineWidth: 0.75,
			strokeStyle: rgbaValue
		}, _dStyles["defaults"]);

		_dStyles[colorName + "_fill"] = _.defaults({
			fillStyle: rgbaValue
		}, _dStyles["defaults"]);
	})
	/* eslint-enable no-unused-vars */
}

/**
 * @constructor
 * @type {module:app/view/component/GraphView}
 */
var GraphView = CanvasView.extend({

	/** @type {string} */
	cidPrefix: "graph",
	/** @override */
	tagName: "canvas",
	/** @override */
	className: "graph",
	// /** @override */
	// model: Backbone.Model,

	defaultKey: "amount",

	defaults: {
		values: {
			amount: 0,
			// available: 0,
			// _loop: 0,
		},
		maxValues: {
			amount: 1,
			// available: 1,
		},
		// useOpaque: true,
		// labelFn: function(value, max) {
		// 	return ((value / max) * 100) | 0;
		// },
	},

	/** @override */
	initialize: function(options) {
		CanvasView.prototype.initialize.apply(this, arguments);

		this._listA = options.listA;
		this._listB = options.listB;
		this._a2b = {
			srcView: options.listA,
			destView: options.listB,
			s: _.defaults({
				lineWidth: 1.25
				// radiusIncrement: 0.25,
			}, styleBase),
			strokeStyleFn: function(fg, bg, ln) {
				return Color(ln).mix(bg, 0.9).hexString();
				// return Color(fg).mix(bg, 0.9).hexString();
			}
		};
		this._b2a = {
			srcView: options.listB,
			destView: options.listA,
			s: _.defaults({
				lineWidth: 0.7,
				// arrowSize: 0.25,
				// radiusIncrement: 0,
				// outlineWidth: 0,
			}, styleBase),
			strokeStyleFn: function(fg, bg, ln) {
				return Color(fg).mix(bg, 0.6).hexString();
			}
		};
		this.listenTo(this, "view:render:before", this._beforeViewRender);

		var viewportChanged = function(ev) {
			// this.requestRender(CanvasView.SIZE_INVALID);
			// this.requestRender(CanvasView.LAYOUT_INVALID);
			console.log("%s:[%s]: window.scrollY:%s body.scrollTop:%s html.scrollTop:%s",
				this.cid, ev.type,
				window.scrollY,
				document.body.scrollTop,
				document.documentElement.scrollTop);
			console.log("%s:[%s]: body.scrollHeight:%s body.clientHeight:%s html.scrollHeight:%s html.clientHeight:%s",
				this.cid, ev.type,
				document.body.scrollHeight, document.body.clientHeight,
				document.documentElement.scrollHeight, document.documentElement.clientHeight);
			this._groupRects = null;
		}.bind(this);

		// viewportChanged = _.debounce(viewportChanged, 100, false);
		window.addEventListener("scroll", _.debounce(viewportChanged, 100, false), false);
		window.addEventListener("wheel", _.debounce(viewportChanged, 100, false), false);

		// this._addListListeners(this._a2b);
		// this._addListListeners(this._b2a);
	},

	// _addListListeners: function(d) {
	// 	this.listenTo(d.srcView, {
	// 		"select:one": function(model) {
	// 			this.listenToOnce(d.destView, "view:render:after",
	// 				function(view) {
	// 					d.srcItem = d.srcView.collection.selected;
	// 					d.destItems = d.destView.filteredItems;
	// 				});
	// 		},
	// 		"select:none": function() {
	// 			d.srcItem = d.destItems = null;
	// 		}
	// 	});
	// },

	/** @override */
	measureCanvas: function(w, h) {
		console.log("%s::measureCanvas style:%o offset:%o arg:%o", this.cid,
			parseInt(this.el.style.height), this.el.offsetHeight, h);
	},

	/** @override */
	updateCanvas: function() {
		this._updateMetrics();
		this._updateStyles();
	},

	/* --------------------------- *
	/* styles
	/* --------------------------- */

	_updateStyles: function() {
		var b, bgColor, lnColor;
		if (this.model.get("withBundle")) {
			b = this.model.get("bundle");
			lnColor = b.colors.lnColor.clone();
			bgColor = b.colors.bgColor.clone();
		} else {
			bgColor = Color(Globals.DEFAULT_COLORS["background-color"]);
			lnColor = Color(Globals.DEFAULT_COLORS["--link-color"]);
		}

		this._a2b.s.strokeStyle = this._a2b.s.fillStyle =
			this._a2b.strokeStyleFn(this._color, bgColor, lnColor);
		this._b2a.s.strokeStyle = this._b2a.s.fillStyle =
			this._b2a.strokeStyleFn(this._color, bgColor, lnColor)
	},

	_setStyle: function(s) {
		if (typeof s == "string") {
			s = this._styleData[s];
		}
		CanvasView.setStyle(this._ctx, s);
	},

	/* --------------------------- *
	/* metrics
	/* --------------------------- */

	_updateMetrics: function() {
		var bounds;
		var i, ii, els;
		var aRect, bRect;
		var aMin, bMin;

		this._rootFontSize = parseFloat(
			getComputedStyle(document.documentElement).fontSize);

		bounds = this.el.getBoundingClientRect();
		// bounds = getAbsoluteClientRect(this.el);
		this._ctx.setTransform(this._canvasRatio, 0, 0, this._canvasRatio,
			(-bounds.left * this._canvasRatio) - 0.5,
			(-bounds.top * this._canvasRatio) - 0.5
		);

		aRect = this._listA.el.getBoundingClientRect();
		aMin = aRect.left;
		els = this._listA.el.querySelectorAll(".label");
		for (i = 0, ii = els.length; i < ii; i++) {
			aMin = Math.max(aMin,
				els[i].getBoundingClientRect().right);
		}

		bRect = this._listB.el.getBoundingClientRect();
		bMin = bRect.left;
		els = this._listB.el.querySelectorAll(".label");
		for (i = 0, ii = els.length; i < ii; i++) {
			bMin = Math.min(bMin,
				els[i].getBoundingClientRect().left);
		}
		this._b2a.destRect = this._a2b.rect = aRect;
		this._b2a.destMinX = this._a2b.xMin = aMin;
		this._a2b.destRect = this._b2a.rect = bRect;
		this._a2b.destMinX = this._b2a.xMin = bMin;

		// var s = getComputedStyle(document.documentElement);
		// this._rootFontSize = parseFloat(s.fontSize); // * this._canvasRatio;
		// console.log("%s::_updateMetrics _rootFontSize: %s %o", this.cid, this._rootFontSize, s);

		// var c = Math.abs(sData.xMin - dData.xMin) / 6;
		// sMin = sData.xMin + c * qx;
		// dMin = dData.xMin - c * qx;

		// this._a2b.targets = this._measureListItems(listView);
		// this._b2a.targets = this._measureListItems(listView);

		// // connector minimum branch x2
		// listView = this._listB;
		// for (i = 0, ii = listView.groups.length; i < ii; i++) {
		// 	itemView = listView.itemViews.findByModel(listView.groups[i]);
		// 	itemRect = (itemView.label || itemView.el).getBoundingClientRect();
		// 	this._b2a.xMin = Math.min(this._b2a.xMin, itemRect.left);
		// 	// if (itemView._metrics) this._b2a.rect.left + itemView.transform.tx + itemView._metrics.textLeft;
		// }
	},

	/* --------------------------- *
	/* redraw
	/* --------------------------- */

	_beforeViewRender: function(view, flags) {
		if (flags & (CanvasView.SIZE_INVALID | CanvasView.MODEL_INVALID)) {
			console.log("%s::_beforeViewRender [flags: %s]", this.cid, CanvasView.flagsToString(flags));

			this._a2b.pointsOut = this._a2b.points;
			this._a2b.rootOut = this._a2b.root;
			this._a2b.points = null;
			this._a2b.root = null;

			this._b2a.pointsOut = this._b2a.points;
			this._b2a.rootOut = this._b2a.root;
			this._b2a.points = null;
			this._b2a.root = null;

			this._groupRects = null;
		}
	},

	redraw: function(ctx, interpolator) {
		// console.log("%s::redraw [valuesChanged: %s]", this.cid, interpolator.valuesChanged);
		this._clearCanvas(0, 0, this._canvasWidth, this._canvasHeight);
		ctx.save();
		this._redraw_fromElements(ctx, interpolator);
		// this._redraw_fromViews(ctx, interpolator);
		ctx.restore();
	},

	_redraw_fromElements: function(ctx, interpolator) {
		// b2a: keyword to bundles, right to left
		// a2b: bundle to keywords, left to right
		if (this._b2a.points === null) {
			this._computeConnectors(this._b2a); //, this._listB, this._listA);
		}
		if (this._a2b.points === null) {
			this._computeConnectors(this._a2b); //, this._listA, this._listB);
		}

		/* line dash value interpolation */
		var lVal = interpolator._valueData["amount"]._renderedValue / interpolator._valueData["amount"]._maxVal;

		/* draw */
		this._drawConnectors(this._b2a.root, this._b2a.points, this._b2a.s, lVal, 1);
		this._drawConnectors(this._b2a.rootOut, this._b2a.pointsOut, this._b2a.s, 1 - lVal, 1);
		this._drawConnectors(this._a2b.root, this._a2b.points, this._a2b.s, 1, 2);

		// this._drawOverlays(this._a2b.destView, this._a2b.destRect);

		// clear some label backgrounds
		if (this._groupRects === null) {
			this._groupRects = [];
			var els = this._listB.el.querySelectorAll(".list-group .label span");
			for (var i = 0, ii = els.length; i < ii; i++) {
				this._groupRects[i] = els[i].getBoundingClientRect(els[i]);
			}
		}
		if (lVal === 1) {
			console.log("%s::_redraw " +
				"window.scrollY: %s " +
				"window.pageYOffset: %s " +
				"body.scrollTop: %s " +
				"html.scrollTop: %s " +
				"#container.scrollTop: %s",
				this.cid,
				window.scrollY,
				window.pageYOffset,
				document.documentElement.scrollTop,
				document.body.scrollTop,
				document.documentElement.firstElementChild.scrollTop
			);
		}

		this._groupRects.forEach(function(r) {
			// TODO: implement DOMRect.inflate()
			// CanvasHelper.drawRect(this._ctx, _dStyles["red_fill"],
			// 	r.left + document.body.scrollLeft,
			// 	r.top + document.body.scrollTop,
			// 	r.width, r.height);
			// r = inflateRect(r, -8.5, -4.5);
			this._ctx.clearRect(
				r.left + document.body.scrollLeft,
				r.top + document.body.scrollTop,
				r.width, r.height);

		}, this);
	},

	_drawOverlays: function(list, rect) {
		var items = list.groups;
		for (var i = 0, num = items.length, item; i < num; i++) {
			item = list.itemViews.findByModel(items[i]);
			if (item._metrics && item.transform) {
				console.log("list.filteredGroups.length[%o] %o", i,
					item._metrics, item.transform);
				this._ctx.clearRect(
					rect.left + item.transform.tx + item._metrics.offsetLeft,
					rect.top + item.transform.ty + item._metrics.offsetTop - 5,
					item._metrics.offsetWidth,
					10 // item._metrics.offsetHeight
				);
				// CanvasHelper.drawRect(this._ctx, _dStyles["red_fill"],
				// 	rect.left + item.transform.tx + item._metrics.offsetLeft,
				// 	rect.top + item.transform.ty + item._metrics.offsetTop - 5,
				// 	item._metrics.offsetWidth, 10
				// );
			}
		}
	},

	_computeConnectors: function(d) {
		var sMin = d.xMin;
		var dMin = d.destMinX;

		var root = {};
		var p, points = [];
		var qx, x1, y1, tx;
		var rBase, rInc;

		rBase = this._roundTo(d.s.radiusBase * this._rootFontSize, 0.5);
		rInc = this._roundTo(d.s.radiusIncrement * this._rootFontSize, 0.5);

		if (d.rect.right < d.destRect.left) {
			qx = 1;
		} else if (d.destRect.right < d.rect.left) {
			qx = -1;
		} else {
			qx = 0;
		}

		var sView, ddView, ddItems, ddNum, i;
		if (d.srcView.collection.selected && d.destView.filteredItems) {
			sView = d.srcView.itemViews.findByModel(d.srcView.collection.selected);

			// var rect = sView.label.getBoundingClientRect();
			// x1 = rect.left;
			// y1 = rect.top + rect.height / 2;
			// if (qx > 0) x1 += rect.width;
			// x1 += document.body.scrollLeft;
			// y1 += document.body.scrollTop;
			if (!sView._metrics) return;

			x1 = d.rect.left + sView.transform.tx
				+ sView._metrics.textLeft;
			y1 = d.rect.top + sView.transform.ty
				+ sView._metrics.offsetHeight / 2;
			if (qx > 0) x1 += sView._metrics.textWidth;

			ddItems = d.destView.filteredItems;
			ddNum = d.destView.filteredItems.length;

			for (i = 0; i < ddNum; i++) {
				p = {};
				ddView = d.destView.itemViews.findByModel(ddItems[i]);

				// rect = ddView.label.getBoundingClientRect();
				// p.x2 = rect.left;
				// p.y2 = rect.top + rect.height / 2;
				// if (qx < 0) p.x2 += rect.width;
				// p.x2 += document.body.scrollLeft;
				// p.y2 += document.body.scrollTop;

				p.x2 = d.destRect.left + ddView.transform.tx
					+ ddView._metrics.textLeft;
				p.y2 = d.destRect.top + ddView.transform.ty
					+ ddView._metrics.offsetHeight / 2;
				if (qx < 0) p.x2 += ddView._metrics.textWidth;

				p.x1 = x1;
				p.y1 = y1;
				p.qx = qx;
				points[i] = p;
			}
			points.sort(function(a, b) {
				return a.y2 - b.y2;
			});
			var si = 0; // ssEl's number of items above in the Y axis
			var rMax0 = ddNum * 0.5 * rInc; // first arc (r0) max radius (cx0)
			var a; // cy1 offset from y1

			for (i = 0; i < ddNum; i++) {
				p = points[i];

				a = (i - (ddNum - 1) / 2) * rInc;
				p.cy1 = p.y1 + a;
				p.cy2 = p.y2;

				a = Math.abs(a);
				p.r0 = a;
				p.cx0 = p.x1 + (rMax0 - a) * qx;

				// p.dx = x1 - p.x2;
				// p.dy = y1 - p.y2;

				p.di = ((p.cy1 - p.y2) > 0) ? i : ddNum - (i + 1);
				si = Math.max(si, p.di);
			}

			// NOTE
			//sMin = p.x1 + (rMax0 * qx);

			for (i = 0; i < ddNum; i++) {
				p = points[i];
				p.r1 = p.di * rInc + rBase;
				p.r2 = rBase;
				// p.r2 = rBase + (si - p.di) * rInc;

				p.cx1 = sMin + (rMax0 * qx);
				p.cx2 = dMin - ((si - p.di) * rInc) * qx;
				// p.cx2 = dMin;

				tx = calcArcHConnector(p.cx1, p.cy1, p.r1, p.cx2, p.cy2, p.r2, 0.9);
				if (tx) {
					p.tx1 = tx[0];
					p.tx2 = tx[1];
				} else {
					p.tx1 = p.cx1;
					p.tx2 = p.cx2;
				}
				p.length = Math.abs(p.x1 - p.x2) + Math.abs(p.cy1 - p.cy2);

				// Find out longest node connection for setLineDash
				root.maxLength = Math.max(root.maxLength, p.length);
			}
			points.sort(function(a, b) {
				return a.di - b.di; // Sort by distance to selected view
			});

			root.x = x1;
			root.y = y1;
			root.qx = qx;
			root.r0 = si * rInc;
		}
		d.points = points;
		d.root = root;
	},

	_drawConnectors: function(root, pp, s, lVal, dir) {
		var i, ii, p;
		var ow, ra1, ra2, ta;

		if (!(pp && pp.length && lVal)) return;

		ii = pp.length;

		/* outline width */
		// ow = s.lineWidth + s.outlineWidth;
		ow = Math.min(
			this._roundTo(s.radiusIncrement * this._rootFontSize, 0.5),
			this._roundTo(s.lineWidth * (1 + s.outlineWidth), 0.5)
		);

		/* arrow radiuses, direction */
		// ra1 = (s.radiusIncrement * this._rootFontSize) + s.lineWidth;
		ra1 = s.arrowSize * this._rootFontSize;
		ra2 = ra1 + (ow - s.lineWidth);
		ta = Math.PI * dir;

		this._setStyle(s);

		// if (lVal < 1) {
		// 	this._ctx.lineDashOffset = lMax * (1 + lVal);
		// 	this._ctx.setLineDash([lMax, lMax])
		// 	// this._ctx.lineDashOffset = lMax * (1 + lVal);;
		// 	// this._ctx.setLineDash([lMax * (1 - lVal), lMax]);
		// }

		// for (i = 0; i < ii; i++) {
		// p = pp[i];
		if (s.outlineWidth) {
			this._ctx.save();
			this._ctx.globalCompositeOperation = "destination-out";
			this._ctx.lineWidth = ow;
			for (i = 0; i < ii; i++) {
				p = pp[i];

				if (lVal < 1) {
					this._ctx.lineDashOffset = p.length * (1 + lVal);
					this._ctx.setLineDash([p.length, p.length])
				}
				this._drawConnector(p, i, pp);
				if (lVal == 1) {
					CanvasHelper.arrowhead(this._ctx, p.x2, p.y2, ra2, ta);
					this._ctx.fill();
				}
			}
			this._ctx.restore();
		}

		for (i = 0; i < ii; i++) {
			p = pp[i];
			if (lVal < 1) {
				this._ctx.lineDashOffset = p.length * (1 + lVal);
				this._ctx.setLineDash([p.length, p.length])
			}
			this._drawConnector(p, i, pp);
			if (lVal == 1) {
				CanvasHelper.arrowhead(this._ctx, p.x2, p.y2, ra1, ta);
				this._ctx.fill();
			}
		}
	},

	_drawConnector: function(p, i, pp) {

		this._ctx.beginPath();
		this._ctx.moveTo(p.x2, p.cy2);
		this._ctx.arcTo(p.tx2, p.cy2, p.tx1, p.cy1, p.r2);
		this._ctx.arcTo(p.tx1, p.cy1, p.cx1, p.cy1, p.r1);
		this._ctx.arcTo(p.cx0, p.cy1, p.cx0, p.y1, p.r0);

		// p.cx00 = p.x1 + ((p.r0 + p.di) * p.qx);
		// p.cy00 = (p.cy1 + p.y1) / 2;
		// this._ctx.arcTo(p.cx00, p.cy1, p.cx00, p.cy00, p.r0 / 2);
		// this._ctx.arcTo(p.cx00, p.y1, p.x1, p.y1, p.r0 / 2);
		// this._ctx.lineTo(p.x1, p.y1);

		// p.cx00 = p.x1 + (p.r0 * p.qx * 2);
		// this._ctx.lineTo(p.cx00, p.cy1);
		// this._ctx.quadraticCurveTo(p.cx0, p.cy1, p.cx0, p.y1);

		// this._ctx.lineTo(p.cx0, p.y1);

		this._ctx.stroke();

		// if (DEBUG) {
		// 	CanvasHelper.drawCrosshair(this._ctx, _dStyles["blue"],
		// 		p.x1 + ((p.r0 + p.di) * p.qx), p.cy1, 3);
		// 	if (i === 0) {
		// 		CanvasHelper.drawVGuide(this._ctx, _dStyles["blue"], p.x1);
		// 		CanvasHelper.drawCircle(this._ctx, _dStyles["midnightblue"], p.x1, p.y1, 10);
		// 		CanvasHelper.drawVGuide(this._ctx, _dStyles["lightskyblue"], p.cx1);
		// 		CanvasHelper.drawHGuide(this._ctx, _dStyles["grey"], p.y1);
		// 	}
		// 	CanvasHelper.drawHGuide(this._ctx, _dStyles["silver"], p.cy2);
		// 	// _dStyles[p.dy > 0 ? "lightgreen" : "salmon"], p.cy2);
		// 	CanvasHelper.drawSquare(this._ctx, _dStyles["midnightblue"], p.cx0, p.cy1, 2);
		// 	CanvasHelper.drawCircle(this._ctx, _dStyles["blue"], p.cx1, p.cy1, 1);
		// 	CanvasHelper.drawSquare(this._ctx, _dStyles["blue"], p.tx1, p.cy1, 2);
		// 	CanvasHelper.drawSquare(this._ctx, _dStyles["green"], p.tx2, p.cy2, 2);
		// 	CanvasHelper.drawCircle(this._ctx, _dStyles["green"], p.cx2, p.cy2, 1);
		//
		// 	CanvasHelper.drawVGuide(this._ctx, _dStyles["yellowgreen"], p.cx2);
		// 	CanvasHelper.drawCircle(this._ctx, _dStyles["olive"], p.x2, p.cy2, 3);
		// 	CanvasHelper.drawCrosshair(this._ctx, _dStyles["olive"], p.x2, p.y2, 6);
		// }
	},

	_roundTo: function(n, p) {
		if (p > 1) p = 1 / p;
		return Math.round(n / p) * p;
	},

	/* _computeConnectors: function(d) {
		var rBase = d.s.radiusBase;
		var rInc = d.s.radiusIncrement;
		var sMin = d.xMin;
		var dMin = d.destMinX;

		var lMax = 0;
		var p, points = [];
		var qx, x1, y1, tx;
		var si; // ssEl's number of items above in the Y axis

		if (d.rect.right < d.destRect.left) {
			qx = 1;
		} else if (d.destRect.right < d.rect.left) {
			qx = -1;
		} else {
			qx = 0;
		}

		var ssEl, ddEls, ddNum, ssRect, ddRect, i;
		ssEl = d.srcView.el.querySelector(".list-item.selected .label");
		if (ssEl) {
			ssRect = ssEl.getBoundingClientRect();
			x1 = ssRect.left;
			if (qx > 0) x1 += ssRect.width;
			y1 = ssRect.top + ssRect.height / 2;
			// r2 = rBase;
			// cx1 = d.xMin;

			si = 0;
			ddEls = d.destView.el.querySelectorAll(".list-item:not(.excluded) .label");
			ddNum = ddEls.length;
			// dx = Math.abs(d.xMin - dData.xMin);

			for (i = 0; i < ddNum; i++) {
				p = {};
				ddRect = ddEls[i].getBoundingClientRect();
				p.x2 = ddRect.left;
				if (qx < 0) p.x2 += ddRect.width;
				p.y2 = ddRect.top + ddRect.height / 2;
				p.x1 = x1;
				p.y1 = y1;
				p.dx = p.x1 - p.x2;
				p.dy = p.y1 - p.y2;
				p.qx = qx;
				p.qy = Math.sign(p.dy);
				// p.dLength = Math.abs(p.x) + Math.abs(p.y);
				p.di = p.dy > 0 ? i : ddNum - (i + 1);
				si = Math.max(si, p.di);
				points[i] = p;
			}

			var a, rMax0 = ddNum * 0.5 * rInc;
			for (i = 0; i < ddNum; i++) {
				p = points[i];
				p.r1 = p.di * rInc + rBase;
				p.r2 = rBase;
				// p.r2 = (si - p.di) * rInc + rBase;

				p.cx1 = sMin;
				p.cx2 = dMin - ((si - p.di) * rInc) * qx;
				// p.cx2 = dMin;

				a = (i - (ddNum - 1) / 2) * rInc;
				p.cy1 = p.y1 + a;
				p.cy2 = p.y2;

				a = Math.abs(a);
				p.r0 = a;
				p.cx0 = p.x1 + (rMax0 - a) * qx;

				tx = calcArcHConnector(p.cx1, p.cy1, p.r1, p.cx2, p.cy2, p.r2, 0.8);
				p.tx1 = tx[0];
				p.tx2 = tx[1];

				// Find out longest node connection for setLineDash
				lMax = Math.max(lMax, Math.abs(p.x1 - p.x2) + Math.abs(p.cy1 - p.cy2));
			}
			// Sort by distance y1 (original) > cy1 (rInc offset) distance
			points.sort(function(a, b) {
				// return Math.abs(b.y1 - b.cy1) - Math.abs(a.y1 - a.cy1);
				// return a.r0 - b.r0;
				return b.di - a.di;
			});
		}
		d.points = points;
		d.maxLength = lMax;
		d.maxLength = qx;
	}, */

});

if (DEBUG) {
	GraphView.prototype._skipLog = false;

	var debouncedLog = _.debounce(_.bind(console.log, console), 500, true);
	var applyMethod = function(context, args) {
		return Array.prototype.shift.apply(args).apply(context, args);
	}
	if (!GraphView.prototype._skipLog) {
		// GraphView.prototype._requestRender = _.wrap(CanvasView.prototype._requestRender, function(fn) {
		// 	debouncedLog("%s::_requestRender", this.cid);
		// 	return applyMethod(this, arguments);
		// });
		GraphView.prototype._applyRender = _.wrap(CanvasView.prototype._applyRender, function(fn) {
			this._skipLog = true;
			debouncedLog("%s::_applyRender [debounced]", this.cid);
			var retval = applyMethod(this, arguments);
			this._skipLog = false;
			return retval;

		});
	}
}

module.exports = GraphView;
}).call(this,true)

},{"app/control/Globals":34,"app/view/base/CanvasView":53,"color":"color","underscore":"underscore","utils/canvas/CanvasHelper":105,"utils/canvas/calcArcHConnector":106,"utils/dom/getAbsoluteClientRect":108,"utils/geom/inflateRect":111}],68:[function(require,module,exports){
/**
 * @module app/view/component/GroupingListView
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
// /** @type {module:backbone.babysitter} */
// var Container = require("backbone.babysitter");
// /** @type {module:app/view/base/View} */
// var View = require("app/view/base/View");
/** @type {module:app/view/component/FilterableListView} */
var FilterableListView = require("app/view/component/FilterableListView");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");
/** @type {module:app/view/render/LabelRenderer} */
var LabelRenderer = require("app/view/render/LabelRenderer");

/**
 * @constructor
 * @type {module:app/view/component/GroupingListView}
 */
var GroupingListView = FilterableListView.extend({

	/** @type {string} */
	cidPrefix: "groupingList",

	/** @override */
	tagName: "dl",

	/** @override */
	className: "grouped",

	/** @type {Function|null} empty array */
	_groupingFn: null, //function() { return null; },

	/** @override */
	defaults: _.defaults({
		// defaults: {
		renderer: ClickableRenderer.extend({
			/** @override */
			cidPrefix: "groupingListItem",
			/** @override */
			tagName: "dl",
			/** @override */
			className: "list-item list-label",
		}),
		groupingRenderer: LabelRenderer.extend({
			/** @override */
			cidPrefix: "groupingListGroup",
			/** @override */
			tagName: "dt",
			/** @override */
			className: "list-group list-label",
		}),
		groupingFn: null,
		// },
	}, FilterableListView.prototype.defaults),

	properties: {
		groups: {
			get: function() {
				return this._groups;
			}
		},
		filteredGroups: {
			get: function() {
				return this._filteredGroups;
			}
		},
	},

	/** @override */
	initialize: function(options) {
		FilterableListView.prototype.initialize.apply(this, arguments);

		this._groups = [];
		this._filteredGroups = [];

		this._groupsByItemCid = {};
		this._groupingFn = options.groupingFn;
		this.groupingRenderer = options.groupingRenderer;

		this._refreshGroups();
		if (this._groupingFn) {
			this._groups.forEach(this.createGroupingView, this);
		}
	},

	_refreshGroups: function() {
		// this._groups = _.uniq(this.collection.map(this._groupingFn, this));
		this._groups.length = 0;
		// this._groupItems.length = 0;
		if (this._groupingFn) {
			this.collection.forEach(function(item) {
				var gIdx, gObj = this._groupingFn.apply(null, arguments);
				if (gObj) {
					gIdx = this._groups.indexOf(gObj);
					if (gIdx == -1) {
						gIdx = this._groups.length;
						this._groups[gIdx] = gObj;
						// this._groupItems[gIdx] = [];
					}
					// this._groupItems[gIdx].push(item);
				}
				this._groupsByItemCid[item.cid] = gObj;
			}, this);
		} else {
			this.collection.forEach(function(item) {
				this._groupsByItemCid[item.cid] = null;
			}, this);
		}
	},

	renderFilterFn: function() {
		FilterableListView.prototype.renderFilterFn.apply(this, arguments);

		if (this._groupingFn) {
			if (this._filteredItems.length == 0) {
				this._filteredGroups = [];
				this._groups.forEach(function(group) {
					this.itemViews.findByModel(group).el.classList.remove("excluded");
				}, this);
			} else {
				this._filteredGroups = _.uniq(this._filteredItems.map(function(item) {
					return this._groupsByItemCid[item.cid];
				}, this));
				this._groups.forEach(function(group) {
					this.itemViews.findByModel(group).el.classList.toggle("excluded", this._filteredGroups.indexOf(group) == -1);
				}, this);
			}
			// this._groupsExclusionIndex = this._groups.map(function (group) {
			// 	return groups.indexOf(group) == -1);
			// }, this);
		}
	},

	/** @private Create children views */
	createGroupingView: function(item) {
		var view = new this.groupingRenderer({
			model: item,
			el: this.el.querySelector(".list-group[data-id=\"" + item.id + "\"]")
		});
		this.itemViews.add(view);
		return view;
	},

	/* --------------------------- *
	/* Filter 2
	/* --------------------------- */

	// computeFiltered: function() {
	// 	FilterableListView.prototype.computeFiltered.apply(this, arguments);
	// },
	//
	// renderFiltered: function() {
	// 	FilterableListView.prototype.renderFiltered.apply(this, arguments);
	// },

});

module.exports = GroupingListView;
},{"app/view/component/FilterableListView":66,"app/view/render/ClickableRenderer":82,"app/view/render/LabelRenderer":89,"underscore":"underscore"}],69:[function(require,module,exports){
/** @type {module:app/view/component/progress/CanvasProgressMeter} */
module.exports = require("app/view/component/progress/CanvasProgressMeter3");
/** @type {module:app/view/component/progress/SVGPathProgressMeter} */
// module.exports = require("app/view/component/progress/SVGPathProgressMeter");
/** @type {module:app/view/component/progress/SVGCircleProgressMeter} */
// module.exports = require("app/view/component/progress/SVGCircleProgressMeter");

},{"app/view/component/progress/CanvasProgressMeter3":71}],70:[function(require,module,exports){
/**
 * @module app/view/component/SelectableListView
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/component/DefaultSelectableRenderer} */
var DefaultSelectableRenderer = require("app/view/render/DefaultSelectableRenderer");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");

var SelectableListView = View.extend({

	/** @type {string} */
	cidPrefix: "selectableList",

	/** @override */
	tagName: "ul",

	/** @override */
	className: "list selectable",

	/** @type {module:app/view/component/DefaultSelectableRenderer} */
	renderer: DefaultSelectableRenderer,

	/** @override */
	initialize: function(options) {
		this._enabled = true;
		this._childrenInvalid = true;

		options.renderer && (this.renderer = options.renderer);
		this.showEmpty = !!options.showEmpty;
		this.itemViews = new Container();

		this.listenTo(this.collection, "add remove reset", this._onCollectionChange);
	},

	/** @override */
	remove: function() {
		this.removeChildren();
		View.prototype.remove.apply(this, arguments);
		return this;
	},

	_onCollectionChange: function(ev) {
		this._childrenInvalid = true;
		this.render();
	},

	/** @override */
	render: function() {
		if (this._childrenInvalid) {
			this._childrenInvalid = false;
			this.createChildren();
		}
		return this;
	},

	/** @override */
	setEnabled: function(enabled) {
		if (this._enabled !== enabled) {
			this._enabled = enabled;
			this.el.classList.toggle("disabled", !this._enabled);
		}
	},

	/* --------------------------- *
	/* Child views
	/* --------------------------- */

	createChildren: function() {
		var eltBuffer, view;

		this.removeChildren();
		this.el.innerHTML = "";

		if (this.collection.length) {
			eltBuffer = document.createDocumentFragment();
			if (this.showEmpty) {
				view = this.createEmptyView();
				eltBuffer.appendChild(view.render().el);
			}
			this.collection.each(function(model, index, arr) {
				view = this.createItemView(model, index);
				eltBuffer.appendChild(view.render().el);
			}, this);
			this.el.appendChild(eltBuffer);
		}
	},

	createItemView: function(model, index) {
		var view = new(this.renderer)({
			model: model
		});
		this.itemViews.add(view);
		this.listenTo(view, "renderer:click", this.onItemViewClick);
		return view;
	},

	removeChildren: function() {
		this.itemViews.each(this.removeItemView, this);
	},

	removeItemView: function(view) {
		this.stopListening(view);
		this.itemViews.remove(view);
		view.remove();
		return view;
	},

	/* --------------------------- *
	/* Child event handlers
	/* --------------------------- */

	/** @private */
	onItemViewClick: function(item) {
		if (this.collection.selected !== item && this._enabled) {
			this.trigger("view:select:one", item);
		}
	},

	/* --------------------------- *
	/* Empty view
	/* --------------------------- */

	createEmptyView: function() {
		var view = new SelectableListView.EmptyRenderer({
			model: this.collection
		});
		this.itemViews.add(view);
		this.listenTo(view, "renderer:click", function() {
			this._enabled && this.trigger("view:select:none");
		});
		return view;
	},
}, {
	EmptyRenderer: ClickableRenderer.extend({

		/** @override */
		tagName: "li",
		/** @override */
		className: "list-item empty-item",

		/** @override */
		initialize: function(options) {
			this.listenTo(this.model, "selected deselected", this.renderClassList);
			this.renderClassList();
		},

		/** @override */
		render: function() {
			this.el.innerHTML = "<a href=\"#clear\"><b> </b></a>";
			this.renderClassList();
			return this;
		},

		renderClassList: function() {
			this.el.classList.toggle("selected", this.model.selectedIndex === -1);
		},
	})
});

module.exports = SelectableListView;

},{"app/view/base/View":58,"app/view/render/ClickableRenderer":82,"app/view/render/DefaultSelectableRenderer":84,"backbone.babysitter":"backbone.babysitter"}],71:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/view/component/progress/CanvasProgressMeter
 */

// /** @type {module:underscore} */
// var _ = require("underscore");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
/** @type {module:app/view/base/CanvasView} */
var CanvasView = require("app/view/base/CanvasView");
// /** @type {module:app/view/base/Interpolator} */
// var Interpolator = require("app/view/base/Interpolator");

// var ARC_ERR = 0.00001;
// var ARC_ERR = 0.0;
// var PI = Math.PI;
var PI2 = Math.PI * 2;

var GAP_ARC = PI2 / 48;
// var CAP_SCALE = 2; // cap arc = GAP_ARC * CAP_SCALE
// var WAIT_CYCLE_VALUE = 1;
// var WAIT_CYCLE_MS = 300; // milliseconds per interpolation loop

var ARC_DEFAULTS = {
	"amount": {
		lineWidth: 0.8,
		radiusOffset: 0
	},
	"not-available": {
		lineWidth: 1.0,
		lineDash: [0.3, 0.7]
	},
	"available": {
		lineWidth: 0.8,
		inverse: "not-available"
	},
};

/**
 * @constructor
 * @type {module:app/view/component/progress/CanvasProgressMeter}
 */
var CanvasProgressMeter = CanvasView.extend({

	/** @type {string} */
	cidPrefix: "canvasProgressMeter",
	/** @type {string} */
	className: "progress-meter canvas-progress-meter",

	defaultKey: "amount",

	defaults: {
		values: {
			amount: 0,
			available: 0,
			_loop: 0,
		},
		maxValues: {
			amount: 1,
			available: 1,
		},
		useOpaque: true,
		labelFn: function(value, max) {
			return ((value / max) * 100) | 0;
		},
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	initialize: function(options) {
		// TODO: cleanup options mess in CanvasView
		CanvasView.prototype.initialize.apply(this, arguments);
		// options = _.defaults(options, this.defaults);

		this._labelFn = options.labelFn;
		this._valueStyles = {};
		this._canvasSize = null;
		this._canvasOrigin = null;
	},

	measureCanvas: function(w, h) {
		this._canvasHeight = this._canvasWidth = Math.min(this._canvasWidth, this._canvasHeight);
	},

	_updateCanvas: function() {
		CanvasView.prototype._updateCanvas.apply(this, arguments);

		// size, lines, gaps, dashes (this._valueStyles, GAP_ARC, this._arcRadius)
		// --------------------------------
		var arcName, arcObj, arcDefault;
		var mapLineDash = function(n) {
			return n * this.radius * GAP_ARC;
		};
		var sumFn = function(s, n) {
			return s + n;
		};

		this._canvasSize = Math.min(this._canvasWidth, this._canvasHeight); // / this._canvasRatio;
		this._maxDashArc = 0;

		for (arcName in ARC_DEFAULTS) {
			arcDefault = ARC_DEFAULTS[arcName];
			arcObj = this._valueStyles[arcName] = {};
			arcObj.inverse = arcDefault.inverse; // copy inverse key
			// arcObj.inverse2 = arcDefault.inverse2;
			arcObj.lineWidth = arcDefault.lineWidth * this._canvasRatio;
			arcObj.radius = (this._canvasSize - arcObj.lineWidth) / 2;
			if (arcDefault.radiusOffset) {
				arcObj.radius += arcDefault.radiusOffset * this._canvasRatio;
			}
			if (arcDefault.lineDash && arcDefault.lineDash.length) {
				arcObj.lineDash = arcDefault.lineDash.map(mapLineDash, arcObj);
				arcObj.lineDashArc = arcDefault.lineDash[0] * GAP_ARC;
				arcObj.lineDashLength = arcObj.lineDash.reduce(sumFn);
				this._maxDashArc = Math.max(this._maxDashArc, arcObj.lineDashArc);
			} else {
				arcObj.lineDashArc = 0;
			}
		}

		// baselineShift
		// --------------------------------
		// NOTE: Center baseline: use ascent data to center to x-height, or sort-of.
		// with ascent/descent values (0.7, -0.3), x-height is 0.4
		var mObj = this._getFontMetrics(this._fontFamily);
		this._baselineShift = mObj ? (mObj.ascent + mObj.descent) / mObj.unitsPerEm : 0.7; // default value
		this._baselineShift *= this._fontSize * 0.5; // apply to font-size, halve it
		this._baselineShift = Math.round(this._baselineShift);

		// save canvas context
		// --------------------------------
		// reset matrix and translate 0,0 to center
		this._ctx.restore();
		this._ctx.setTransform(1, 0, 0, 1, this._canvasWidth / 2, this._canvasHeight / 2);
		this._ctx.save();
	},

	/* --------------------------- *
	/* private
	/* --------------------------- */

	/** @override */
	redraw: function(context, interpolator) {
		this._clearCanvas(-this._canvasWidth / 2, -this._canvasHeight / 2, this._canvasWidth, this._canvasHeight);

		var loopValue = interpolator._valueData["_loop"]._renderedValue || 0;
		var amountData = interpolator._valueData["amount"];
		var availableData = interpolator._valueData["available"];

		var amountStyle = this._valueStyles["amount"];
		var availableStyle = this._valueStyles["available"];

		// amount label
		// --------------------------------
		this.drawLabel(this._labelFn(amountData._renderedValue, amountData._maxVal));

		// save ctx before drawing arcs
		this._ctx.save();

		// loop rotation
		// --------------------------------
		// if (interpolator.renderedKeys && (interpolator.renderedKeys.indexOf("amount") !== -1)) {
		// 	console.log("%s::redraw (_loop) max: %s last: %s curr: %s", this.cid,
		// 		amountData._maxVal,
		// 		amountData._lastRenderedValue,
		// 		amountData._renderedValue
		// 	);
		// }
		if (interpolator.renderedKeys && (interpolator.renderedKeys.indexOf("amount") !== -1) && (amountData._lastRenderedValue > amountData._renderedValue)) {
			// trigger loop
			interpolator.valueTo(1, 0, "_loop");
			interpolator.valueTo(0, 750, "_loop");
			interpolator.updateValue("_loop");
		}
		this._ctx.rotate(PI2 * ((1 - loopValue) - 0.25));

		// amount arc
		// --------------------------------
		var amountGapArc = GAP_ARC;
		var amountEndArc = 0;
		var amountValue = loopValue + amountData._renderedValue / amountData._maxVal;

		if (amountValue > 0) {
			amountEndArc = this.drawArc(amountStyle, amountValue, amountGapArc, PI2 - amountGapArc);
			this.drawEndCap(amountStyle, amountEndArc);
			amountEndArc = amountEndArc + amountGapArc * 2;
		}

		// available arc
		// --------------------------------
		var stepsNum = availableData.length || 1;
		var stepBaseArc = PI2 / stepsNum;
		var stepAdjustArc = stepBaseArc % GAP_ARC;
		var stepGapArc = GAP_ARC + (stepAdjustArc - availableStyle.lineDashArc) / 2;

		if (Array.isArray(availableData)) {
			for (var o, i = 0; i < stepsNum; i++) {
				o = availableData[i];
				this.drawArc(availableStyle, o._renderedValue / (o._maxVal / stepsNum), (i * stepBaseArc) + stepGapArc, ((i + 1) * stepBaseArc) - stepGapArc, amountEndArc);
			}
		} else {
			this.drawArc(availableStyle, availableData._renderedValue / availableData._maxVal, stepGapArc, PI2 - stepGapArc, amountEndArc);
		}
		// restore ctx after drawing arcs
		this._ctx.restore();
	},

	drawArc: function(valueStyle, value, startArc, endArc, prevArc) {
		var valArc, invStyle,
			valStartArc, valEndArc,
			invStartArc, invEndArc;
		prevArc || (prevArc = 0);

		valArc = endArc - startArc;
		valEndArc = startArc + (valArc * value);
		valStartArc = Math.max(startArc, prevArc);
		if (valEndArc > valStartArc) {
			this._ctx.save();
			this.applyValueStyle(valueStyle);
			this._ctx.beginPath();
			this._ctx.arc(0, 0, valueStyle.radius, valEndArc, valStartArc, true);
			this._ctx.stroke();
			this._ctx.restore();
		}
		// if there's valueStyle, draw rest of span, minus prevArc overlap too
		if (valueStyle.inverse !== void 0) {
			invStyle = this._valueStyles[valueStyle.inverse];
			invEndArc = valEndArc + (valArc * (1 - value));
			invStartArc = Math.max(valEndArc, prevArc);
			if (invEndArc > invStartArc) {
				this._ctx.save();
				this.applyValueStyle(invStyle);
				this._ctx.beginPath();
				this._ctx.arc(0, 0, invStyle.radius, invEndArc, invStartArc, true);
				this._ctx.stroke();
				this._ctx.restore();
			}
		}
		return valEndArc;
	},

	applyValueStyle: function(styleObj) {
		this._ctx.lineWidth = styleObj.lineWidth;
		if (styleObj.lineDash) {
			this._ctx.setLineDash(styleObj.lineDash);
		}
		if (styleObj.lineDashOffset) {
			this._ctx.lineDashOffset = styleObj.lineDashOffset;
		}
	},

	drawLabel: function(labelString) {
		var labelWidth = this._ctx.measureText(labelString).width;
		this._ctx.fillText(labelString,
			labelWidth * -0.5,
			this._baselineShift, labelWidth);
	},

	drawEndCap: function(valueStyle, arcPos) {
		var radius = valueStyle.radius;
		this._ctx.save();
		this._ctx.lineWidth = valueStyle.lineWidth;

		this._ctx.rotate(arcPos - GAP_ARC * 1.5);
		this._ctx.beginPath();
		this._ctx.arc(0, 0, radius, GAP_ARC * 0.5, GAP_ARC * 2, false);
		this._ctx.lineTo(radius - (GAP_ARC * radius), 0);
		this._ctx.closePath();

		this._ctx.fill();
		this._ctx.stroke();
		this._ctx.restore();
	},
});

if (DEBUG) {
	CanvasProgressMeter.prototype._skipLog = true;
}

module.exports = CanvasProgressMeter;

}).call(this,true)

},{"app/view/base/CanvasView":53}],72:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
var Color = require("color");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/model/collection/BundleCollection} */
var bundles = require("app/model/collection/BundleCollection");

// - - - - - - - - - - - - - - - -
//  utils
// - - - - - - - - - - - - - - - -

function insertCSSRule(sheet, selector, style) {
	var cssText = "";
	for (var prop in style) {
		cssText += prop + ":" + style[prop] + ";";
	}
	sheet.insertRule(selector + "{" + cssText + "}", sheet.cssRules.length);
}

function selfAndDescendant(selfCls, cls) {
	return selfCls + " " + cls + ", " + selfCls + cls;
}

// - - - - - - - - - - - - - - - -
//  root rules
// - - - - - - - - - - - - - - - -

var rootStyles = ["background", "background-color", "color", "--link-color"];

function initRootStyles(sheet, rootSelector, attrs, fgColor, bgColor, lnColor, hasDarkBg) {
	var s, revSelector, fgColorVal, bgColorVal;
	// var revFgColorVal, revBgColorVal;

	s = _.pick(attrs, rootStyles);
	s["-webkit-font-smoothing"] = (hasDarkBg ? "antialiased" : "auto");
	/* NOTE: In Firefox '-moz-osx-font-smoothing: grayscale;'
	/* works both in light over dark and dark over light, hardcoded in _base.scss */
	//s["-moz-osx-font-smoothing"] = (hasDarkBg? "grayscale" : "auto");
	insertCSSRule(sheet, rootSelector, s);

	// A element
	// - - - - - - - - - - - - - - - -
	s = {}
	s["color"] = lnColor.rgbString();
	insertCSSRule(sheet, rootSelector + " a", s);
	insertCSSRule(sheet, rootSelector + " .color-ln", s);

	// .color-fg05
	// - - - - - - - - - - - - - - - -
	s = {};
	s["color"] = fgColor.clone().mix(bgColor, 0.5).rgbString();
	s["border-color"] = fgColor.clone().mix(bgColor, 0.7).rgbString();
	insertCSSRule(sheet, rootSelector + " .color-fg05", s);

	fgColorVal = fgColor.rgbString();
	bgColorVal = bgColor.rgbString();
	// revFgColorVal = bgColor.clone().mix(fgColor, 0.9).rgbString();
	// revBgColorVal = fgColor.clone().mix(bgColor, 0.6).rgbString();
	revSelector = rootSelector + " .color-reverse";

	// .color-fg .color-bg
	// - - - - - - - - - - - - - - - -
	s = {
		"color": fgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-fg", s);
	s = {
		"background-color": bgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-bg", s);
	// html inverted text/background
	s = {
		"color": bgColorVal
	}; // s = { "color" : revFgColorVal };
	s["-webkit-font-smoothing"] = (hasDarkBg ? "auto" : "antialiased");
	// insertCSSRule(sheet, revSelector + " .color-fg", s);
	// insertCSSRule(sheet, revSelector + ".color-fg", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-fg"), s);

	s = {
		"background-color": fgColorVal
	};
	// s = { "background-color" : revBgColorVal };
	// insertCSSRule(sheet, revSelector + " .color-bg", s);
	// insertCSSRule(sheet, revSelector + ".color-bg", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-bg"), s);

	// .color-stroke .color-fill (SVG)
	// - - - - - - - - - - - - - - - -
	s = {
		"stroke": fgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-stroke", s);
	s = {
		"fill": bgColorVal
	};
	insertCSSRule(sheet, rootSelector + " .color-fill", s);
	// svg inverted fill/stroke
	s = {
		"stroke": bgColorVal
	};
	// insertCSSRule(sheet, revSelector + " .color-stroke", s);
	// insertCSSRule(sheet, revSelector + ".color-stroke", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-stroke"), s);
	s = {
		"fill": fgColorVal
	};
	// insertCSSRule(sheet, revSelector + " .color-fill", s);
	// insertCSSRule(sheet, revSelector + ".color-fill", s);
	insertCSSRule(sheet, selfAndDescendant(revSelector, ".color-fill"), s);

	// .text-outline
	// - - - - - - - - - - - - - - - -
	// s = {
	// 	"text-shadow": "-1px -1px 0 " + bgColorVal +
	// 		", 1px -1px 0 " + bgColorVal +
	// 		", -1px 1px 0 " + bgColorVal +
	// 		", 1px 1px 0 " + bgColorVal
	// };
	// insertCSSRule(sheet, rootSelector + " :not(.collapsed-changed) .text-outline-bg", s);

}

// - - - - - - - - - - - - - - - -
// carousel styles
// - - - - - - - - - - - - - - - -

var carouselStyles = ["box-shadow", "border", "border-radius"];

function initCarouselStyles(sheet, carouselSelector, attrs, fgColor, bgColor, lnColor, hasDarkBg) {
	var s = _.pick(attrs, carouselStyles); //, "background-color"]);
	insertCSSRule(sheet, carouselSelector + " .media-item .content", s);

	// .media-item .color-bg09
	// - - - - - - - - - - - - - - - -
	s = {};
	s["background-color"] = bgColor.clone().mix(fgColor, 0.95).rgbString();
	// s["background-color"] = bgColor.clone()[hasDarkBg ? "darken" : "lighten"](0.045).rgbString();
	// s["background-color"] = bgColor.clone()[hasDarkBg ? "lighten" : "darken"](0.03).rgbString();
	insertCSSRule(sheet, carouselSelector + " .media-item .color-bg09", s);

	// .media-item .placeholder
	// - - - - - - - - - - - - - - - -
	s = {};
	s["-webkit-font-smoothing"] = (hasDarkBg ? "auto" : "antialiased");
	// text color luminosity is inverse from body, apply oposite rendering mode
	s["color"] = bgColor.rgbString();
	// s["color"] = bgColor.clone()[hasDarkBg ? "darken" : "lighten"](0.045).rgbString();
	s["background-color"] = bgColor.clone().mix(fgColor, 0.95).rgbString();
	// s["background-color"] = bgColor.clone().mix(fgColor, 0.8).alpha(0.3).rgbaString();
	// s["background-color"] = bgColor.clone()[hasDarkBg ? "lighten" : "darken"](0.03).rgbString();
	("border-radius" in attrs) && (s["border-radius"] = attrs["border-radius"]);
	insertCSSRule(sheet, carouselSelector + " .media-item .placeholder", s);

	// .empty-item A
	// - - - - - - - - - - - - - - - -
	s = {};
	s["text-decoration-color"] = fgColor.clone().mix(bgColor, 0.3).rgbString();
	insertCSSRule(sheet, carouselSelector + " .empty-item A", s);
	// // .color-gradient
	// // - - - - - - - - - - - - - - - -
	// s = {};
	// s["background-color"] = "transparent";
	// s["background"] = "linear-gradient(to bottom, " +
	// 		bgColor.clone().alpha(0.00).rgbaString() + " 0%, " +
	// 		bgColor.clone().alpha(0.11).rgbaString() + " 100%)";
	// insertCSSRule(sheet, rootSelector + " .color-gradient", s);
	// s = {};
	// s["background-color"] = "transparent";
	// s["background"] = "linear-gradient(to bottom, " +
	// 		fgColor.clone().alpha(0.00).rgbaString() + " 0%, " +
	// 		fgColor.clone().alpha(0.11).rgbaString() + " 100%)";
	// insertCSSRule(sheet, revSelector + " .color-gradient", s);
	// insertCSSRule(sheet, revSelector + ".color-gradient", s);
}

module.exports = function() {
	var attrs, fgColor, bgColor, lnColor, hasDarkBg;

	attrs = Globals.DEFAULT_COLORS;
	fgColor = new Color(Globals.DEFAULT_COLORS["color"]);
	bgColor = new Color(Globals.DEFAULT_COLORS["background-color"]);
	lnColor = new Color(Globals.DEFAULT_COLORS["--link-color"])
	hasDarkBg = fgColor.luminosity() > bgColor.luminosity();

	var colorStyles = document.createElement("style");
	colorStyles.id = "colors";
	colorStyles.type = "text/css";
	document.head.appendChild(colorStyles);
	// var colorStyles = document.querySelector("link#folio");

	initRootStyles(colorStyles.sheet, ".app",
		attrs, fgColor, bgColor, lnColor, hasDarkBg);
	initCarouselStyles(colorStyles.sheet, ".carousel",
		attrs, fgColor, bgColor, lnColor, hasDarkBg);

	// - - - - - - - - - - - - - - - -
	// per-bundle rules
	// - - - - - - - - - - - - - - - -
	bundles.each(function(bundle) {
		attrs = bundle.attrs(); //get("attrs");
		fgColor = bundle.colors.fgColor;
		bgColor = bundle.colors.bgColor;
		lnColor = bundle.colors.lnColor;
		hasDarkBg = bundle.colors.hasDarkBg;

		initRootStyles(colorStyles.sheet,
			".app." + bundle.get("domid"),
			attrs, fgColor, bgColor, lnColor, hasDarkBg);
		initCarouselStyles(colorStyles.sheet,
			".carousel." + bundle.get("domid"),
			attrs, fgColor, bgColor, lnColor, hasDarkBg);
	});
};
},{"app/control/Globals":34,"app/model/collection/BundleCollection":39,"color":"color","underscore":"underscore"}],73:[function(require,module,exports){
/*global XMLHttpRequest */

// var _ = require("underscore");
// /** @type {module:underscore.string/lpad} */
// var classify = require("underscore.string/classify");

// var statusMsg = _.template("<%= status %> received from <%= url %> (<%= statusText %>)");
// var errMsg = _.template("'<%= errName %>' ocurred during request <%= url %>");

if (window.XMLHttpRequest && window.URL && window.Blob) {
	module.exports = function(url, progressFn) {
		return new Promise(function(resolve, reject) {
			var request = new XMLHttpRequest();
			request.open("GET", url, true);
			// request.timeout = 10000; // in milliseconds
			request.responseType = "blob";

			// if progressFn is supplied
			// - - - - - - - - - - - - - - - - - -
			if (progressFn) {
				request.onprogress = function(ev) {
					progressFn(ev.loaded / ev.total);
				};
			}
			// resolved/success
			// - - - - - - - - - - - - - - - - - -
			request.onload = function(ev) {
				// When the request loads, check whether it was successful
				if (request.status == 200) {
					// If successful, resolve the promise by passing back a reference url
					resolve(URL.createObjectURL(request.response));
				} else {
					var err = new Error(("http_" + request.statusText.replace(/\s/g, "_")).toUpperCase());
					err.infoCode = request.status;
					err.infoSrc = url;
					err.logEvent = ev;
					err.logMessage = "_loadImageAsObjectURL::" + ev.type + " [reject]";
					reject(err);
				}
			};
			// reject/failure
			// - - - - - - - - - - - - - - - - - -
			request.onerror = function(ev) {
				var err = new Error((ev.type + "_event").toUpperCase());
				err.infoCode = -1;
				err.infoSrc = url;
				err.logEvent = ev;
				err.logMessage = "_loadImageAsObjectURL::" + ev.type + " [reject]";
				reject(err);
			};
			request.onabort = request.ontimeout = request.onerror;
			// finally
			// - - - - - - - - - - - - - - - - - -
			request.onloadend = function() {
				request.onabort = request.ontimeout = request.onerror = void 0;
				request.onload = request.onloadend = void 0;
				if (progressFn) {
					request.onprogress = void 0;
				}
			};

			request.send();
		});
	};
} else {
	module.exports = function(url) {
		return Promise.resolve(url);
	};
}
},{}],74:[function(require,module,exports){
module.exports = function(image, resolveEmpty) {
	return new Promise(function(resolve, reject) {
		if (!(image instanceof window.HTMLImageElement)) {
			//reject(new Error("not an HTMLImageElement"));
			reject("Error: not an HTMLImageElement");
		} else if (image.complete && (image.src.length > 0 || resolveEmpty)) {
			// if (image.src === "") console.warn("_whenImageLoads resolved with empty src");
			// else console.log("_whenImageLoads resolve-sync", image.src);
			resolve(image);
		} else {
			var handlers = {
				load: function(ev) {
					// console.log("_whenImageLoads_dom resolve-async", ev.type, image.src);
					removeEventListeners();
					resolve(image);
				},
				error: function(ev) {
					var err = new Error("Loading failed (" + ev.type + " event)");
					err.infoCode = -1;
					err.infoSrc = image.src;
					err.logEvent = ev;
					err.logMessage = "_whenImageLoads::" + ev.type + " [reject]";
					removeEventListeners();
					reject(err);
				}
			};
			handlers.abort = handlers.error;
			var removeEventListeners = function() {
				for (var event in handlers) {
					if (handlers.hasOwnProperty(event)) {
						image.removeEventListener(event, handlers[event], false);
					}
				}
			};
			for (var event in handlers) {
				if (handlers.hasOwnProperty(event)) {
					image.addEventListener(event, handlers[event], false);
				}
			}
		}
	});
};

},{}],75:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:app/view/promise/_whenImageLoads} */
var _whenImageLoads = require("app/view/promise/_whenImageLoads");
/** @type {module:app/view/promise/_loadImageAsObjectURL} */
var _loadImageAsObjectURL = require("app/view/promise/_loadImageAsObjectURL");

// var isBlobRE = /^blob\:.*/;

// var logMessage = "%s::whenDefaultImageLoads [%s]: %s";

module.exports = function(view) {
	return new Promise(function(resolve, reject) {
		var source = view.model.get("source");
		if (source.has("prefetched")) {
			view.defaultImage.src = source.get("prefetched");
			_whenImageLoads(view.defaultImage)
				.then(
					function(targetEl) {
						// console.log(logMessage, view.cid, "resolved", "prefetched");
						resolve(view);
					});
		} else {
			view.mediaState = "pending";

			var sUrl = source.get("original");
			var progressFn = function(progress) {
				// console.log(logMessage, view.cid, "progress", progress);
				view.updateMediaProgress(progress, sUrl);
			};
			progressFn = _.throttle(progressFn, 100, {
				leading: true,
				trailing: false
			});
			_loadImageAsObjectURL(sUrl, progressFn)
				.then(
					function(url) {
						if (/^blob\:.*/.test(url)) {
							source.set("prefetched", url);
						}
						view.defaultImage.src = url;
						// URL.revokeObjectURL(url);
						return view.defaultImage;
					})
				.then(_whenImageLoads)
				.then(
					function(targetEl) {
						// console.log(logMessage, view.cid, "resolved", targetEl.src);
						view.on("view:removed", function() {
							var prefetched = source.get("prefetched");
							if (prefetched && /^blob\:/.test(prefetched)) {
								source.unset("prefetched", {
									silent: true
								});
								URL.revokeObjectURL(prefetched);
							}
						});
						// view.placeholder.removeAttribute("data-progress");
						// view.updateMediaProgress(imageUrl, "complete");
						resolve(view);
					},
					// 	})
					// .catch(
					function(err) {
						// console.warn(logMessage, view.cid, "rejected", err.message);
						// view.placeholder.removeAttribute("data-progress");
						// view.updateMediaProgress(imageUrl, progress);
						reject(err);
					});
		}
	});
};
},{"app/view/promise/_loadImageAsObjectURL":73,"app/view/promise/_whenImageLoads":74,"underscore":"underscore"}],76:[function(require,module,exports){
/* global Promise */
/** @type {module:app/view/base/ViewError} */
var ViewError = require("app/view/base/ViewError");

/** @type {module:app/view/base/ViewError} */
var whenViewIsAttached = require("app/view/promise/whenViewIsAttached");

function whenScrollingEnds(view) {
	return new Promise(function(resolve, reject) {
		var parent = view.parentView;
		if (parent === null) {
			console.error("%s::whenScrollingEnds [%s] (sync)", view.cid, "rejected", view.attached);
			reject(new ViewError(view, new Error("whenScrollingEnds: view has no parent")));
		} else if (!parent.scrolling) {
			// console.log("%s::whenScrollingEnds [%s] (sync)", view.cid, "resolved", view.attached);
			resolve(view);
		} else {
			var cleanup = function() {
				parent.off("view:scrollend", onScrollend);
				parent.off("view:remove", onRemove);
			};
			var onScrollend = function() {
				// console.log("%s::whenScrollingEnds [%s]", view.cid, "resolved", view.attached);
				cleanup();
				resolve(view);
			};
			var onRemove = function() {
				// console.log("%s::whenScrollingEnds [%s]", view.cid, "rejected", view.attached);
				cleanup();
				reject(new ViewError(view, new Error("whenScrollingEnds: view was removed")));
			};
			parent.on("view:scrollend", onScrollend);
			parent.on("view:remove", onRemove);
		}
	});
}

module.exports = function(view) {
	return Promise.resolve(view)
		.then(whenViewIsAttached)
		.then(whenScrollingEnds);
};

/*
module.exports = function(view) {
	return Promise.resolve(view)
		.then(function(view) {
			if (view.attached) {
				return view;
			} else {
				return new Promise(function(resolve, reject) {
					view.once("view:attached", function(view) {
						resolve(view);
					});
				});
			}
		})
		.then(function(view) {
			if (!view.parentView.scrolling) {
				return view;
			} else {
				return new Promise(function(resolve, reject) {
					var resolveOnScrollend = function() {
						// console.log("%s::whenScrollingEnds [%s]", view.cid, "resolved");
						view.off("view:remove", rejectOnRemove);
						resolve(view);
					};
					var rejectOnRemove = function(view) {
						// console.log("%s::whenScrollingEnds [%s]", view.cid, "rejected");
						view.parentView.off("view:scrollend", resolveOnScrollend);
						reject(new ViewError(view,
							new Error("whenSelectScrollingEnds: view was removed ("+ view.cid +")")));
					};
					view.parentView.once("view:scrollend", resolveOnScrollend);
					view.once("view:remove", rejectOnRemove);
				});
			}
		});
};
*/

},{"app/view/base/ViewError":59,"app/view/promise/whenViewIsAttached":79}],77:[function(require,module,exports){
/** @type {module:app/view/base/ViewError} */
var ViewError = require("app/view/base/ViewError");

// var logMessage = "%s::whenSelectionDistanceIs [%s]: %s";

/**
 * @param {module:app/view/base/View}
 * @param {number} distance
 */
module.exports = function(view, distance) {
	return new Promise(function(resolve, reject) {
		// if (!(view.model && view.model.collection)) {
		// 	reject(new ViewError(view, new Error("whenSelectionIsContiguous: model.collection is empty")));
		// }
		var model = view.model;
		var collection = model.collection;

		var check = function(n) { // Check indices for contiguity
			return Math.abs(collection.indexOf(model) - collection.selectedIndex) <= distance;
		};

		if (check()) {
			// console.log(logMessage, view.cid, "resolve", "sync");
			resolve(view);
		} else {
			var cleanupOnSettle = function() {
				// console.log(logMessage, view.cid, "cleanup", "async");
				collection.off("select:one select:none", resolveOnSelect);
				view.off("view:removed", rejectOnRemove);
			};
			var resolveOnSelect = function(model) {
				if (check()) {
					// console.log(logMessage, view.cid, "resolve", "async");
					cleanupOnSettle();
					resolve(view);
				}
			};
			var rejectOnRemove = function(view) {
				cleanupOnSettle();
				reject(new ViewError(view, new Error("whenSelectionDistanceIs: view was removed")));
			};
			collection.on("select:one select:none", resolveOnSelect);
			view.on("view:removed", rejectOnRemove);
		}
	});
};

},{"app/view/base/ViewError":59}],78:[function(require,module,exports){
// /** @type {module:app/view/base/ViewError} */
// var ViewError = require("app/view/base/ViewError");

/** @type {module:app/view/promise/whenSelectionDistanceIs} */
var whenSelectionDistanceIs = require("app/view/promise/whenSelectionDistanceIs");

/** @param {module:app/view/base/View} */
module.exports = function(view) {
	return whenSelectionDistanceIs(view, 1);
};
},{"app/view/promise/whenSelectionDistanceIs":77}],79:[function(require,module,exports){
module.exports = function(view) {
	return new Promise(function(resolve, reject) {
		if (view.attached) {
			resolve(view);
		} else {
			view.on("view:attached", function(view) {
				resolve(view);
			});
		}
	});
};

},{}],80:[function(require,module,exports){
module.exports = function(view) {
	return new Promise(function(resolve, reject) {
		if (!view.invalidated) {
			resolve(view);
		} else {
			view.once("view:render:after", function(view, flags) {
				resolve(view);
			});
		}
	});
};
},{}],81:[function(require,module,exports){
/**
 * @module app/view/render/CarouselRenderer
 */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:underscore} */
var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

// FIXME: this fixup should not be done here
// /** @type {module:utils/net/toAbsoluteURL} */
// var toAbsoluteURL = require("utils/net/toAbsoluteURL");
// /** @type {string} */
// var ABS_APP_ROOT = toAbsoluteURL(require("app/control/Globals").APP_ROOT);

/**
 * @constructor
 * @type {module:app/view/render/CarouselRenderer}
 */
var CarouselRenderer = View.extend({

	/** @type {string} */
	cidPrefix: "carouselRenderer",
	/** @override */
	tagName: "div",
	/** @override */
	className: "carousel-item",
	/** @override */
	template: _.template("<div class=\"content sizing\"><%= name %></div>"),

	properties: {
		content: {
			get: function() {
				return this._content || (this._content = this.el.querySelector(".content"));
			},
		},
		sizing: {
			get: function() {
				return this._sizing || (this._sizing = this.el.querySelector(".sizing"));
			},
		}
	},

	/** @override */
	initialize: function(options) {
		if (this.model.attr("@classname") !== void 0) {
			var clsAttr = this.model.attr("@classname").split(" ");
			for (var i = 0; i < clsAttr.length; i++) {
				this.el.classList.add(clsAttr[i]);
			}
		}
		options.parentView && (this.parentView = options.parentView);
		this.metrics = {};
		this.metrics.content = {};
		this.createChildren();
		// this.enabled = !!options.enabled; // force bool
		this.setEnabled(!!options.enabled);
	},

	createChildren: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
		// FIXME: this fixup should not be done here
		// FIXED: now done in xslt
		/*this.el.querySelectorAll("a[href]").forEach(function(el) {
			var url = toAbsoluteURL(el.getAttribute("href"));
			if (url.indexOf(ABS_APP_ROOT) !== 0) {
				el.setAttribute("target", "_blank");
			}
		});*/
	},

	/** @return {HTMLElement} */
	getSizingEl: function() {
		return this._sizing || (this._sizing = this.el.querySelector(".sizing"));
	},

	/** @return {HTMLElement} */
	getContentEl: function() {
		return this._content || (this._content = this.el.querySelector(".content"));
	},

	/** @return {this} */
	measure: function() {
		var sizing = this.getSizingEl();

		this.metrics = getBoxEdgeStyles(this.el, this.metrics);
		this.metrics.content = getBoxEdgeStyles(this.getContentEl(), this.metrics.content);

		sizing.style.maxWidth = "";
		sizing.style.maxHeight = "";

		this.metrics.content.x = sizing.offsetLeft + sizing.clientLeft;
		this.metrics.content.y = sizing.offsetTop + sizing.clientTop;
		this.metrics.content.width = sizing.clientWidth;
		this.metrics.content.height = sizing.clientHeight;

		return this;
	},

	/** @override */
	render: function() {
		this.measure();
		return this;
	},

	getSelectionDistance: function() {
		return Math.abs(this.model.collection.indexOf(this.model) - this.model.collection.selectedIndex);
	},
});

module.exports = CarouselRenderer;
},{"app/view/base/View":58,"underscore":"underscore","utils/css/getBoxEdgeStyles":107}],82:[function(require,module,exports){
/**
 * @module app/view/render/ClickableRenderer
 */

/** @type {module:app/view/render/LabelRenderer} */
var LabelRenderer = require("app/view/render/LabelRenderer");

/**
 * @constructor
 * @type {module:app/view/render/ClickableRenderer}
 */
var ClickableRenderer = LabelRenderer.extend({

	/** @type {string} */
	cidPrefix: "clickableRenderer",

	/** @override */
	events: {
		"click": function(ev) {
			this.trigger("renderer:click", this.model, ev);
		},
		"click a": function(ev) {
			ev.defaultPrevented || ev.preventDefault();
		}
	},
});

module.exports = ClickableRenderer;

},{"app/view/render/LabelRenderer":89}],83:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function";

  return "<a href=\"#"
    + container.escapeExpression(((helper = (helper = helpers.domid || (depth0 != null ? depth0.domid : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"domid","hash":{},"data":data}) : helper)))
    + "\"><span class=\"label\">"
    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</span></a>";
},"useData":true});

},{"hbsfy/runtime":21}],84:[function(require,module,exports){
/**
 * @module app/view/render/DefaultSelectableRenderer
 */

/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");

/**
 * @constructor
 * @type {module:app/view/render/DefaultSelectableRenderer}
 */
var DefaultSelectableRenderer = ClickableRenderer.extend({

	/** @override */
	tagName: "li",
	/** @override */
	className: "list-item",
	/** @override */
	template: require("./DefaultSelectableRenderer.hbs"),

	initialize: function(options) {
		this.listenTo(this.model, "selected deselected", this._renderClassList);
		this._renderClassList();
	},

	/** @override */
	render: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
		this._renderClassList();
		return this;
	},

	_renderClassList: function() {
		this.el.classList.toggle("selected", this.model.selected);
	},
});

module.exports = DefaultSelectableRenderer;

},{"./DefaultSelectableRenderer.hbs":83,"app/view/render/ClickableRenderer":82}],85:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<span class=\"label\">"
    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper)))
    + "</span><a href=\"#"
    + alias4(((helper = (helper = helpers.domid || (depth0 != null ? depth0.domid : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"domid","hash":{},"data":data}) : helper)))
    + "\"><b> </b></a>";
},"useData":true});

},{"hbsfy/runtime":21}],86:[function(require,module,exports){
/**
 * @module app/view/render/DotNavigationRenderer
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {string} */
var viewTemplate = require("./DotNavigationRenderer.hbs");
/** @type {module:app/view/component/ClickableRenderer} */
var ClickableRenderer = require("app/view/render/ClickableRenderer");

/**
 * @constructor
 * @type {module:app/view/render/DotNavigationRenderer}
 */
var DotNavigationRenderer = ClickableRenderer.extend({

	/** @type {string} */
	cidPrefix: "dotRenderer",
	/** @override */
	tagName: "li",
	/** @override */
	className: "list-item",
	/** @override */
	template: viewTemplate,

	/** @override */
	initialize: function(options) {
		this.listenTo(this.model, "selected deselected", this.renderClassList);
		this.renderClassList();
	},

	/** @override */
	render: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
		this.renderClassList();
		return this;
	},

	renderClassList: function() {
		this.el.classList.toggle("selected", this.model.selected);
	},
});

module.exports = DotNavigationRenderer;

},{"./DotNavigationRenderer.hbs":85,"app/view/render/ClickableRenderer":82}],87:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<div class=\"placeholder sizing\"></div>\n<img class=\"content media-border default\" alt=\""
    + alias4(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"text","hash":{},"data":data}) : helper)))
    + "\" longdesc=\"#desc_m"
    + alias4(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" />\n";
},"useData":true});

},{"hbsfy/runtime":21}],88:[function(require,module,exports){
/**
 * @module app/view/render/ImageRenderer
 */

// /** @type {module:underscore} */
// var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");

// /** @type {module:app/control/Globals} */
// var Globals = require("app/control/Globals");
// /** @type {module:app/model/item/MediaItem} */
// var MediaItem = require("app/model/item/MediaItem");

/** @type {module:app/view/MediaRenderer} */
var MediaRenderer = require("./MediaRenderer");

/** @type {Function} */
var viewTemplate = require("./ImageRenderer.hbs");

/**
 * @constructor
 * @type {module:app/view/render/ImageRenderer}
 */
var ImageRenderer = MediaRenderer.extend({

	/** @type {string} */
	cidPrefix: "imageRenderer",
	/** @type {string} */
	className: MediaRenderer.prototype.className + " image-renderer",
	/** @type {Function} */
	template: viewTemplate,

	/** @override */
	initialize: function(opts) {
		MediaRenderer.prototype.initialize.apply(this, arguments);
		// this.createChildren();
		// this.initializeAsync();
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	createChildren: function() {
		MediaRenderer.prototype.createChildren.apply(this, arguments);
		// this.el.innerHTML = this.template(this.model.toJSON());
		this.placeholder = this.el.querySelector(".placeholder");
	},

	/** @override */
	render: function() {
		MediaRenderer.prototype.render.apply(this, arguments);

		// this.measure();

		var img = this.getDefaultImage();
		img.setAttribute("width", this.metrics.media.width);
		img.setAttribute("height", this.metrics.media.height);

		var content = this.getContentEl();
		content.style.left = this.metrics.content.x + "px";
		content.style.top = this.metrics.content.y + "px";

		// var sizing = this.getSizingEl();
		// sizing.style.maxWidth = this.metrics.content.width + "px";
		// sizing.style.maxHeight = this.metrics.content.height + "px";

		return this;
	},

	/* --------------------------- *
	/* initializeAsync
	/* --------------------------- */

	initializeAsync: function() {
		return MediaRenderer.prototype.initializeAsync.apply(this, arguments)
		// return MediaRenderer.whenSelectionIsContiguous(this)
		// // return Promise.resolve(this)
		// // 	.then(MediaRenderer.whenSelectionIsContiguous)
		// 	.then(MediaRenderer.whenSelectTransitionEnds)
		// 	.then(MediaRenderer.whenDefaultImageLoads)
		// .then(
		// 	function(view) {
		// 		view.mediaState = "ready";
		// 	})
		// .catch(
		// 	function(err) {
		// 		if (err instanceof ViewError) {
		// 			// NOTE: ignore ViewError type
		// 			// console.log(err.view.cid, err.view.model.cid, "ImageRenderer: " + err.message);
		// 		} else {
		// 			console.error(this.cid, err.name, err);
		// 			this.placeholder.innerHTML = "<p class=\"color-fg\" style=\"position:absolute;bottom:0;padding:3rem;\"><strong>" + err.name + "</strong> " + err.message + "</p>";
		// 			this.mediaState = "error";
		// 		}
		// 	}.bind(this))
		;
	},
});

module.exports = ImageRenderer;

},{"./ImageRenderer.hbs":87,"./MediaRenderer":90}],89:[function(require,module,exports){
/**
 * @module app/view/render/LabelRenderer
 */

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");

/**
 * @constructor
 * @type {module:app/view/render/LabelRenderer}
 */
var LabelRenderer = View.extend({

	/** @type {string} */
	cidPrefix: "labelRenderer",

	properties: {
		label: {
			get: function() {
				return this._label || (this._label = this.el.querySelector(".label"));
			}
		}
		// measuredWidth: {
		// 	get: function() {
		// 		return this._measuredWidth;
		// 	}
		// },
		// measuredHeight: {
		// 	get: function() {
		// 		return this._measuredHeight;
		// 	}
		// },
	},

	/* -------------------------------
	/* measure
	/* ------------------------------- */

	// _measuredWidth: null,
	// _measuredHeight: null,
	// measure: function() {},
});

module.exports = LabelRenderer;

},{"app/view/base/View":58}],90:[function(require,module,exports){
(function (DEBUG){
/*global XMLHttpRequest, HTMLMediaElement, MediaError*/
/**
 * @module app/view/render/MediaRenderer
 */

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:underscore.strings/lpad} */
var lpad = require("underscore.string/lpad");
// /** @type {module:utils/css/getBoxEdgeStyles} */
// var getBoxEdgeStyles = require("utils/css/getBoxEdgeStyles");

/** @type {module:app/model/item/MediaItem} */
var MediaItem = require("app/model/item/MediaItem");
/** @type {module:app/view/CarouselRenderer} */
var CarouselRenderer = require("app/view/render/CarouselRenderer");

var errorTemplate = require("../template/ErrorBlock.hbs");

var MediaRenderer = CarouselRenderer.extend({

	/** @type {string} */
	cidPrefix: "mediaRenderer",
	/** @type {string} */
	className: CarouselRenderer.prototype.className + " media-item",
	/** @type {module:app/model/MediaItem} */
	model: MediaItem,

	properties: {
		defaultImage: {
			get: function() {
				return this._defaultImage || (this._defaultImage = this.el.querySelector("img.default"));
			}
		},
		mediaState: {
			get: function() {
				return this._mediaState;
			},
			set: function(state) {
				this._setMediaState(state);
			}
		}
	},

	/** @override */
	initialize: function(opts) {
		// if (this.model.attrs().hasOwnProperty("@classname")) {
		// 	this.el.className += " " + this.model.attr("@classname");
		// }

		// NOTE: @classname attr handling moved to CarouselRenderer
		// if (this.model.attr("@classname") !== void 0) {
		// 	var clsAttr = this.model.attr("@classname").split(" ");
		// 	for (var i = 0; i < clsAttr.length; i++) {
		// 		this.el.classList.add(clsAttr[i]);
		// 	}
		// }
		CarouselRenderer.prototype.initialize.apply(this, arguments);

		this.metrics.media = {};
		this.mediaState = "idle";

		this.initializeAsync()
			.then(this.whenInitialized)
			.catch(this.whenInitializeError.bind(this));
	},

	initializeAsync: function() {
		// var MediaRenderer = Object.getPrototypeOf(this).constructor;
		return Promise.resolve(this)
			.then(MediaRenderer.whenSelectionIsContiguous)
			.then(MediaRenderer.whenScrollingEnds)
			.then(MediaRenderer.whenDefaultImageLoads);
	},

	whenInitialized: function(view) {
		// console.log("%s::whenInitialized [%s]", view.cid, "resolved");
		view.mediaState = "ready";
		view.placeholder.removeAttribute("data-progress");
		return view;
	},

	whenInitializeError: function(err) {
		if (err instanceof CarouselRenderer.ViewError) {
			// NOTE: ignore ViewError type
			// console.log("%s::whenInitializeError", err.view.cid, err.message);
			return;
		} else if (err instanceof Error) {
			console.error(err.stack);
		}
		this.renderMediaError(err);
		this.placeholder.removeAttribute("data-progress");
		this.mediaState = "error";
		// this.placeholder.innerHTML = errorTemplate(err);
		// this.placeholder.removeAttribute("data-progress");
		// this.mediaState = "error";

		console.error("%s::initializeAsync [%s (caught)]: %s", this.cid, err.name,
			(err.info && err.info.logMessage) || err.message);
		err.logEvent && console.log(err.logEvent);
	},

	renderMediaError: function(err) {
		this.placeholder.innerHTML = err ? errorTemplate(err) : "";
	},

	updateMediaProgress: function(progress, id) {
		if (_.isNumber(progress)) {
			this.placeholder.setAttribute("data-progress", lpad(Math.floor(progress * 100), 2, '0'));
		}
		// else if (progress === "complete") {
		// 	this.placeholder.removeAttribute("data-progress");
		// }
	},

	// whenMediaIsReady: function(view) {
	// 	return MediaRenderer.whenDefaultImageLoads(this, this.updateMediaProgress.bind(this));
	// },

	/* --------------------------- *
	/* child getters
	/* --------------------------- */

	/** @return {HTMLElement} */
	getDefaultImage: function() {
		return this.defaultImage;
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	createChildren: function() {
		this.el.innerHTML = this.template(this.model.toJSON());
	},

	/** @override */
	measure: function() {
		CarouselRenderer.prototype.measure.apply(this, arguments);

		var sw, sh; // source dimensions
		var pcw, pch; // measured values
		var cx, cy, cw, ch, cs; // computed values
		var ew, eh; // content edge totals
		var cm; // content metrics

		cm = this.metrics.content;
		cx = cm.x;
		cy = cm.y;
		pcw = cm.width;
		pch = cm.height;

		ew = (cm.paddingLeft + cm.paddingRight + cm.borderLeftWidth + cm.borderRightWidth);
		eh = (cm.paddingTop + cm.paddingBottom + cm.borderTopWidth + cm.borderBottomWidth);
		pcw -= ew;
		pch -= eh;

		sw = this.model.get("source").get("w");
		sh = this.model.get("source").get("h");

		// Unless both client dimensions are larger than the source's
		// choose constraint direction by aspect ratio
		if (sw < pcw && sh < pch) {
			cs = 1;
			cw = sw;
			ch = sh;
			this.metrics.fitDirection = "both";
		} else if ((pcw / pch) < (sw / sh)) {
			// fit width
			cw = pcw;
			cs = cw / sw;
			// ch = cs * sh;
			ch = Math.round(cs * sh);
			this.metrics.fitDirection = "width";
		} else {
			// fit height
			ch = pch;
			cs = ch / sh;
			// cw = cs * sw;
			cw = Math.round(cs * sw);
			this.metrics.fitDirection = "height";
		}

		this.metrics.content.x = cx;
		this.metrics.content.y = cy;
		this.metrics.content.width = cw + ew;
		this.metrics.content.height = ch + eh;

		this.metrics.media.x = cx + cm.paddingLeft + cm.borderLeftWidth;
		this.metrics.media.y = cy + cm.paddingTop + cm.borderTopWidth;
		this.metrics.media.width = cw;
		this.metrics.media.height = ch;
		this.metrics.media.scale = cs;

		// console.log("%s::measure constraint: %s metrics: %o", this.cid, this.metrics.constraint, this.metrics);
		// var sizing = this.getSizingEl();
		// sizing.style.maxWidth = (cw + ew) + "px";
		// sizing.style.maxHeight = (ch + eh) + "px";

		return this;
	},

	render: function() {
		// NOTE: not calling super.render, calling measure ourselves
		this.measure();

		var sizing = this.getSizingEl();
		sizing.style.maxWidth = this.metrics.content.width + "px";
		sizing.style.maxHeight = this.metrics.content.height + "px";

		this.el.setAttribute("data-fit-dir", this.metrics.fitDirection);

		return this;
	},

	/* --------------------------- *
	/* mediaState
	/* --------------------------- */

	_mediaStateEnum: ["idle", "pending", "ready", "error"],

	_setMediaState: function(key) {
		if (this._mediaStateEnum.indexOf(key) === -1) {
			throw new Error("Argument " + key + " invalid. Must be one of: " + this._mediaStateEnum.join(", "));
		}
		if (this._mediaState !== key) {
			if (this._mediaState) {
				this.el.classList.remove(this._mediaState);
			}
			this.el.classList.add(key);
			this._mediaState = key;
			this.trigger("media:" + key);
		}
	},
}, {
	LOG_TO_SCREEN: true,

	/** @type {module:app/view/promise/whenSelectionIsContiguous} */
	whenSelectionIsContiguous: require("app/view/promise/whenSelectionIsContiguous"),

	// /** @type {module:app/view/promise/whenSelectTransitionEnds} */
	// whenSelectTransitionEnds: require("app/view/promise/whenSelectTransitionEnds"),

	/** @type {module:app/view/promise/whenScrollingEnds} */
	whenScrollingEnds: require("app/view/promise/whenScrollingEnds"),

	/** @type {module:app/view/promise/whenDefaultImageLoads} */
	whenDefaultImageLoads: require("app/view/promise/whenDefaultImageLoads"),
});

/* ---------------------------
/* log to screen
/* --------------------------- */
if (DEBUG) {

	MediaRenderer = (function(MediaRenderer) {
		if (!MediaRenderer.LOG_TO_SCREEN) return MediaRenderer;

		/** @type {Function} */
		var Color = require("color");
		// /** @type {module:underscore.string/lpad} */
		// var lpad = require("underscore.string/lpad");
		// /** @type {module:underscore.string/rpad} */
		// var rpad = require("underscore.string/rpad");

		return MediaRenderer.extend({

			/** @override */
			initialize: function() {
				MediaRenderer.prototype.initialize.apply(this, arguments);

				var fgColor = new Color(this.model.attr("color"));
				var bgColor = new Color(this.model.attr("background-color"));
				this.__logColors = {
					normal: fgColor.clone().mix(bgColor, 0.75).hslString(),
					ignored: fgColor.clone().mix(bgColor, 0.25).hslString(),
					error: "brown",
					abort: "orange"
				};
				this.__logFrameStyle = "1px dashed " + fgColor.clone().mix(bgColor, 0.5).hslString();
				this.__logStartTime = Date.now();
				this.__rafId = -1;
				this.__onFrame = this.__onFrame.bind(this);
			},

			initializeAsync: function() {
				return MediaRenderer.prototype.initializeAsync.apply(this, arguments).catch(function(err) {
					if (!(err instanceof MediaRenderer.ViewError)) {
						this.__logMessage(err.message, err.name, this.__logColors["error"]);
					}
					return Promise.reject(err);
				}.bind(this));
			},

			/** @override */
			createChildren: function() {
				var ret = MediaRenderer.prototype.createChildren.apply(this, arguments);

				this.__logElement = document.createElement("div");
				this.__logElement.className = "debug-log";
				this.__logHeaderEl = document.createElement("pre");
				this.__logHeaderEl.className = "log-header color-bg";
				// this.model.colors.fgColor.clone().mix(fgColor, 0.9).rgbString()
				// this.model.colors.fgColor.clone().alpha
				this.__logHeaderEl.textContent = this.__getHeaderText();
				this.__logElement.appendChild(this.__logHeaderEl);
				this.el.insertBefore(this.__logElement, this.el.firstElementChild);
				return ret;
			},

			/** @override */
			render: function() {
				MediaRenderer.prototype.render.apply(this, arguments);

				this.__logElement.style.marginTop = "3rem";
				this.__logElement.style.maxHeight = "calc(100% - " + (this.metrics.media.height) + "px - 3rem)";
				//this.__logElement.style.width = this.metrics.media.width + "px";
				this.__logElement.scrollTop = this.__logElement.scrollHeight;

				return this;
			},

			__logMessage: function(msg, logtype, color) {
				var logEntryEl = document.createElement("pre");

				logEntryEl.textContent = this.__getTStamp() + " " + msg;
				logEntryEl.setAttribute("data-logtype", logtype || "-");
				logEntryEl.style.color = color || this.__logColors[logtype] || this.__logColors.normal;

				this.__logElement.appendChild(logEntryEl);
				this.__logElement.scrollTop = this.__logElement.scrollHeight;

				if (this.__rafId == -1) {
					this.__rafId = this.requestAnimationFrame(this.__onFrame);
				}
			},

			__onFrame: function(tstamp) {
				this.__rafId = -1;
				this.__logElement.lastElementChild.style.borderBottom = this.__logFrameStyle;
				this.__logElement.lastElementChild.style.paddingBottom = "2px";
				this.__logElement.lastElementChild.style.marginBottom = "2px";
			},

			__getTStamp: function() {
				// return new Date(Date.now() - this.__logStartTime).toISOString().substr(11, 12);
				return lpad(((Date.now() - this.__logStartTime) / 1000).toFixed(3), 8, "0");
			},

			__getHeaderText: function() {
				return '';
			},
		});
	})(MediaRenderer);

} // end debug

/**
 * @constructor
 * @type {module:app/view/render/MediaRenderer}
 */
module.exports = MediaRenderer;
}).call(this,true)

},{"../template/ErrorBlock.hbs":100,"app/model/item/MediaItem":46,"app/view/promise/whenDefaultImageLoads":75,"app/view/promise/whenScrollingEnds":76,"app/view/promise/whenSelectionIsContiguous":78,"app/view/render/CarouselRenderer":81,"color":"color","underscore":"underscore","underscore.string/lpad":28}],91:[function(require,module,exports){
(function (GA){
/**
 * @module app/view/render/PlayableRenderer
 */

/** @type {module:underscore} */
var _ = require("underscore");
/** @type {Function} */
// var Color = require("color");

/** @type {module:app/view/MediaRenderer} */
var MediaRenderer = require("app/view/render/MediaRenderer");
// /** @type {module:app/view/component/ProgressMeter} */
// var ProgressMeter = require("app/view/component/ProgressMeter");

/** @type {Function} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {Function} */
var prefixedEvent = require("utils/prefixedEvent");

// var visibilityHiddenProp = prefixedProperty("hidden", document);
/** @type {String} */
var visibilityStateProp = prefixedProperty("visibilityState", document);
/** @type {String} */
var visibilityChangeEvent = prefixedEvent("visibilitychange", document, "hidden");

/** @type {Function} */
// var duotone = require("utils/canvas/bitmap/duotone");
// var stackBlurRGB = require("utils/canvas/bitmap/stackBlurRGB");
// var stackBlurMono = require("utils/canvas/bitmap/stackBlurMono");
// var getAverageRGBA = require("utils/canvas/bitmap/getAverageRGBA");
// var getAverageRGB = require("utils/canvas/bitmap/getAverageRGB");

// /** @type {HTMLCanvasElement} */
// var _sharedCanvas = null;
// /** @return {HTMLCanvasElement} */
// var getSharedCanvas = function() {
// 	if (_sharedCanvas === null) {
// 		_sharedCanvas = document.createElement("canvas");
// 	}
// 	return _sharedCanvas;
// };

// function logAttachInfo(view, name, level) {
// 	if (["log", "info", "warn", "error"].indexOf(level) != -1) {
// 		level = "log";
// 	}
// 	console[level].call(console, "%s::%s [parent:%s %s %s depth:%s]", view.cid, name, view.parentView && view.parentView.cid, view.attached ? "attached" : "detached", view._viewPhase, view.viewDepth);
// }

/**
 * @constructor
 * @type {module:app/view/render/PlayableRenderer}
 */
var PlayableRenderer = MediaRenderer.extend({

	/** @type {string} */
	cidPrefix: "playableRenderer",

	/** @type {string|Function} */
	className: MediaRenderer.prototype.className + " playable-renderer",

	properties: {
		paused: {
			/** @return {Boolean} */
			get: function() {
				return this._isMediaPaused();
			}
		},
		playbackRequested: {
			/** @return {Boolean} */
			get: function() {
				return this._playbackRequested;
			},
			set: function(value) {
				this._setPlaybackRequested(value);
			}
		},
		playToggle: {
			/** @return {HTMLElement} */
			get: function() {
				return this._playToggle || (this._playToggle = this.el.querySelector(".play-toggle"));
			}
		},
		overlay: {
			/** @return {HTMLElement} */
			get: function() {
				return this._overlay || (this._overlay = this.el.querySelector(".overlay"));
			}
		}
	},

	/** @override */
	initialize: function(opts) {
		MediaRenderer.prototype.initialize.apply(this, arguments);
		_.bindAll(this,
			"_onPlaybackToggle",
			"_onVisibilityChange"
		);
		this._setPlaybackRequested(this._playbackRequested);
		// this.listenTo(this, "view:parentChange", function(childView, newParent, oldParent) {
		// 	// logAttachInfo(this, "[view:parentChange]", "info");
		// 	console.info("%s::[view:parentChange] '%s' to '%s'", this.cid, oldParent && oldParent.cid, newParent && newParent.cid);
		// });
	},

	// /** @override */
	// initializeAsync: function() {
	// 	return MediaRenderer.prototype.initialize.initializeAsync.apply(this, arguments);
	// },

	// /** @override */
	// remove: function() {
	// 	MediaRenderer.prototype.remove.apply(this, arguments);
	// 	return this;
	// },

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	// createChildren: function() {
	// 	this.el.innerHTML = this.template(this.model.toJSON());
	// 	this.placeholder = this.el.querySelector(".placeholder");
	// 	this.content = this.el.querySelector(".content");
	// 	this.image = this.content.querySelector("img.current");
	// },

	/* --------------------------- *
	/* setEnabled
	/* --------------------------- */

	/** @override */
	setEnabled: function(enabled) {
		MediaRenderer.prototype.setEnabled.apply(this, arguments);
		// this._validatePlayback(enabled);
		// if (enabled) {
		this._validatePlayback();
		// } else {
		// 	// if selected, pause media
		// 	this.model.selected && this.togglePlayback(false);
		// 	// this.togglePlayback(false);
		// }
	},

	/* ---------------------------
	/* selection handlers
	/* --------------------------- */

	addSelectionListeners: function() {
		if (this._viewPhase != "initialized")
			throw new Error(this.cid + "::addSelectionListeners called while " + this._viewPhase);

		// logAttachInfo(this, "addSelectionListeners", "log");
		// this.listenTo(this, "view:removed", this.removeSelectionListeners);
		this.listenTo(this.model, "selected", this._onModelSelected);
		this.listenTo(this.model, "deselected", this._onModelDeselected);
		if (this.model.selected) {
			this._onModelSelected();
		}
	},

	// removeSelectionListeners: function() {
	// 	// logAttachInfo(this, "removeSelectionListeners", "log");
	// 	this.stopListening(this, "view:removed", this.removeSelectionListeners);
	// 	this.stopListening(this.model, "selected", this._onModelSelected);
	// 	this.stopListening(this.model, "deselected", this._onModelDeselected);
	// 	if (this.model.selected) {
	// 		this._onModelDeselected();
	// 	}
	// },

	/* model selected handlers:
	/* model selection toggles playback
	/* --------------------------- */

	_onModelSelected: function() {
		console.log("%s::_onModelSelected _playbackRequested: %s, event: %s", this.cid, this._playbackRequested, this._toggleEvent);
		// logAttachInfo(this, "_onModelSelected", "log");
		// this._addParentListeners();
		this.listenTo(this, "view:parentChange", this._onParentChange);
		if (this.parentView) this._onParentChange(this, this.parentView, null);

		this._addDOMListeners();
		this._validatePlayback();
	},

	_onModelDeselected: function() {
		// logAttachInfo(this, "_onModelDeselected", "log");
		// this._removeParentListeners();
		this.stopListening(this, "view:parentChange", this._onParentChange);
		if (this.parentView) this._onParentChange(this, null, this.parentView);

		this._removeDOMListeners();
		this.togglePlayback(false);
		// this._validatePlayback(this.model.selected);
		// this._validatePlayback();
	},

	/* view:parentChange handlers 3
	/* --------------------------- */

	_onParentChange: function(childView, newParent, oldParent) {
		// console.log("[scroll] %s::_onParentChange '%s' to '%s'", this.cid, oldParent && oldParent.cid, newParent && newParent.cid);
		if (oldParent) this.stopListening(oldParent, "view:scrollstart view:scrollend", this._onScrollChange);
		if (newParent) this.listenTo(newParent, "view:scrollstart view:scrollend", this._onScrollChange);
	},

	_onScrollChange: function() {
		if (this.parentView === null) {
			this.togglePlayback(false);
			throw new Error(this.cid + "::_onScrollChange parentView is null");
		}
		// console.log("[scroll] %s::_onScrollChange %s.scrolling: %s", this.cid, this.parentView.cid, this.parentView.scrolling);

		// this._validatePlayback(!this.parentView.scrolling);
		// if (!this.parentView.scrolling) {
		this._validatePlayback();
		// } else {
		// 	this.togglePlayback(false);
		// }
	},

	/* view:parentChange handlers
	/* --------------------------- */

	/*_addParentListeners: function() {
		if (!this.parentView) {
			logAttachInfo(this, "_addParentListeners", "error");
			return;
		}
		this.listenTo(this, "view:remove", this._removeParentListeners);
		this.listenTo(this.parentView, "view:remove", this._removeParentListeners);
		this.listenTo(this.parentView, "view:scrollstart", this._onScrollStart);
		this.listenTo(this.parentView, "view:scrollend", this._onScrollEnd);
	},

	_removeParentListeners: function(view) {
		if (!this.parentView) {
			logAttachInfo(this, "_removeParentListeners", "error");
			return;
		}
		if (view !== void 0) {
			logAttachInfo(this, "_removeParentListeners [event source view]", "info");
			// console.info("%s[playable]::_removeParentListeners event source view: %s", this.cid, view && view.cid);
		}

		this.stopListening(this, "view:remove", this._removeParentListeners);
		this.stopListening(this.parentView, "view:remove", this._removeParentListeners);
		this.stopListening(this.parentView, "view:scrollstart", this._onScrollStart);
		this.stopListening(this.parentView, "view:scrollend", this._onScrollEnd);
	},*/

	/* view:scrollstart view:scrollend
	/* --------------------------- */

	/*_onScrollStart: function() {
		this.togglePlayback(false);
	},

	_onScrollEnd: function() {
		this._validatePlayback();
	},*/

	/* listen to DOM events
	/* --------------------------- */

	_addDOMListeners: function() {
		this.listenTo(this, "view:removed", this._removeDOMListeners);
		document.addEventListener(visibilityChangeEvent, this._onVisibilityChange, false);
		this.playToggle.addEventListener(this._toggleEvent, this._onPlaybackToggle, true);
	},

	_removeDOMListeners: function() {
		this.stopListening(this, "view:removed", this._removeDOMListeners);
		document.removeEventListener(visibilityChangeEvent, this._onVisibilityChange, false);
		this.playToggle.removeEventListener(this._toggleEvent, this._onPlaybackToggle, true);
	},

	/* visibility dom event
	/* --------------------------- */
	_onVisibilityChange: function(ev) {
		// this._validatePlayback(!document[visibilityHiddenProp]);
		// this._validatePlayback(document[visibilityStateProp] != "hidden");
		// if (document[visibilityStateProp] != "hidden") {
		this._validatePlayback();
		// } else {
		// 	this.togglePlayback(false);
		// }
	},

	/* --------------------------- *
	/* play-toggle
	/* --------------------------- */

	/** @type {String} */
	_toggleEvent: window.hasOwnProperty("onpointerup") ? "pointerup" : "mouseup",

	_onPlaybackToggle: function(ev) {
		console.log("%s[%sabled]::_onPlaybackToggle[%s] defaultPrevented: %s", this.cid, this.enabled ? "en" : "dis", ev.type, ev.defaultPrevented);
		// NOTE: Perform action if MouseEvent.button is 0 or undefined (0: left-button)
		if (this.enabled && !ev.defaultPrevented && !ev.button) {
			ev.preventDefault();
			this.playbackRequested = !this.playbackRequested;
		}
	},

	/* --------------------------- *
	/* playbackRequested
	/* --------------------------- */

	/** @type {Boolean?} */
	_playbackRequested: null,

	_setPlaybackRequested: function(value) {
		this._playbackRequested = value;

		var classList = this.content.classList;
		classList.toggle("playing", value === true);
		classList.toggle("paused", value === false);
		classList.toggle("requested", value === true || value === false);

		// this._validatePlayback(this.playbackRequested);
		// if (this.playbackRequested) {
		this._validatePlayback();
		// } else {
		// 	this.togglePlayback(false);
		// }
	},

	/* --------------------------- *
	/* togglePlayback
	/* --------------------------- */

	/** @override */
	togglePlayback: function(newPlayState) {
		// console.log("[scroll] %s::togglePlayback [%s -> %s] (requested: %s)", this.cid,
		// 		(this._isMediaPaused()? "pause" : "play"),
		// 		(newPlayState? "play" : "pause"),
		// 		this.playbackRequested
		// 	);
		if (_.isBoolean(newPlayState) && newPlayState !== this._isMediaPaused()) {
			return; // requested state is current, do nothing
		} else {
			newPlayState = this._isMediaPaused();
		}
		if (newPlayState) { // changing to what?
			this._playMedia();
		} else {
			this._pauseMedia();
		}
	},

	_canResumePlayback: function() {
		return !!(
			this.enabled &&
			this.model.selected &&
			this.playbackRequested &&
			(this.mediaState === "ready") &&
			this.attached &&
			(this.parentView !== null) &&
			(!this.parentView.scrolling) &&
			(document[visibilityStateProp] != "hidden")
		);
	},

	_validatePlayback: function(shortcircuit) {
		// a 'shortcircuit' boolean argument can be passed, and if false,
		// skip _canResumePlayback and pause playback right away
		if (arguments.length != 0 && !shortcircuit) {
			this.togglePlayback(false);
		} else {
			this.togglePlayback(this._canResumePlayback());
		}
	},

	/* --------------------------- *
	/* abstract
	/* --------------------------- */

	_isMediaPaused: function() {
		console.warn("%s::_isMediaPaused Not implemented", this.cid);
		return true;
	},

	_playMedia: function() {
		console.warn("%s::_playMedia Not implemented", this.cid);
	},

	_pauseMedia: function() {
		console.warn("%s::_pauseMedia Not implemented", this.cid);
	},

	/* --------------------------- *
	/* util
	/* --------------------------- */

	updateOverlay: function(mediaEl, targetEl, rectEl) {
		// // this method is not critical, just catch and log all errors
		// try {
		// 	this._updateOverlay(mediaEl, targetEl, rectEl)
		// } catch (err) {
		// 	console.error("%s::updateOverlay", this.cid, err);
		// }
	},

	_drawMediaElement: function(context, mediaEl, dest) {
		// destination rect
		// NOTE: mediaEl is expected to have the same dimensions in this.metrics.media
		mediaEl || (mediaEl = this.defaultImage);
		dest || (dest = {
			x: 0,
			y: 0,
			width: this.metrics.media.width,
			height: this.metrics.media.height
		});

		// native/display scale
		var sW = this.model.get("source").get("w"),
			sH = this.model.get("source").get("h"),
			rsX = sW / this.metrics.media.width,
			rsY = sH / this.metrics.media.height;

		// dest, scaled to native
		var src = {
			x: Math.max(0, dest.x * rsX),
			y: Math.max(0, dest.y * rsY),
			width: Math.min(sW, dest.width * rsX),
			height: Math.min(sH, dest.height * rsY)
		};

		// resize canvas
		// var canvas = context.canvas;
		// if (canvas.width !== dest.width || canvas.height !== dest.height) {
		// 	canvas.width = dest.width;
		// 	canvas.height = dest.height;
		// }
		context.canvas.width = dest.width;
		context.canvas.height = dest.height;

		// copy image to canvas
		context.clearRect(0, 0, dest.width, dest.height);
		context.drawImage(mediaEl,
			src.x, src.y, src.width, src.height,
			0, 0, dest.width, dest.height // destination rect
		);

		return context;
	},

	/*
	_updateOverlay: function(mediaEl, targetEl, rectEl) {
		// src/dest rects
		// ------------------------------
		rectEl || (rectEl = targetEl);

		// NOTE: does not work with svg element
		// var tRect = rectEl.getBoundingClientRect();
		// var cRect = mediaEl.getBoundingClientRect();
		// var tX = tRect.x - cRect.x,
		// 	tY = tRect.y - cRect.y,
		// 	tW = tRect.width,
		// 	tH = tRect.height;

		// target bounds
		var tX = rectEl.offsetLeft,
			tY = rectEl.offsetTop,
			tW = rectEl.offsetWidth,
			tH = rectEl.offsetHeight;

		if (tX === void 0 || tY === void 0 || tW === void 0 || tH === void 0) {
			return;
		}

		// destination rect
		var RECT_GROW = 20;
		var dest = {
			x: tX - RECT_GROW,
			y: tY - RECT_GROW,
			width: tW + RECT_GROW * 2,
			height: tH + RECT_GROW * 2
		};

		// native/display scale
		var sW = this.model.get("w"),
			sH = this.model.get("h"),
			rsX = sW/this.metrics.media.width,
			rsY = sH/this.metrics.media.height;

		// dest, scaled to native
		var src = {
			x: Math.max(0, dest.x * rsX),
			y: Math.max(0, dest.y * rsY),
			width: Math.min(sW, dest.width * rsX),
			height: Math.min(sH, dest.height * rsY)
		};

		// Copy image to canvas
		// ------------------------------
		var canvas, context, imageData;

		// canvas = document.createElement("canvas");
		// canvas.style.width  = dest.width + "px";
		// canvas.style.height = dest.height + "px";

		canvas = getSharedCanvas();
		if (canvas.width !== dest.width || canvas.height !== dest.height) {
			canvas.width = dest.width;
			canvas.height = dest.height;
		}
		context = canvas.getContext("2d");
		context.clearRect(0, 0, dest.width, dest.height);
		context.drawImage(mediaEl,
			src.x, src.y, src.width, src.height,
			0, 0, dest.width, dest.height // destination rect
		);
		imageData = context.getImageData(0, 0, dest.width, dest.height);

		var avgColor = Color().rgb(getAverageRGB(imageData));
		// var avgHex = avgColor.hexString(), els = this.el.querySelectorAll("img, video");
		// for (var i = 0; i < els.length; i++) {
		// 	els.item(i).style.backgroundColor = avgHex;
		// }

		targetEl.classList.toggle("over-dark", avgColor.dark());

		// console.log("%s::updateOverlay() avgColor:%s (%s)", this.cid, avgColor.rgbString(), avgColor.dark()?"dark":"light", targetEl);

		// Color, filter opts
		// ------------------------------

		// this.fgColor || (this.fgColor = new Color(this.model.attr("color")));
		// this.bgColor || (this.bgColor = new Color(this.model.attr("background-color")));
		//
		// var opts = { radius: 20 };
		// var isFgDark = this.fgColor.luminosity() < this.bgColor.luminosity();
		// opts.x00 = isFgDark? this.fgColor.clone().lighten(0.5) : this.bgColor.clone().darken(0.5);
		// opts.xFF = isFgDark? this.bgColor.clone().lighten(0.5) : this.fgColor.clone().darken(0.5);
		//
		// stackBlurMono(imageData, opts);
		// duotone(imageData, opts);
		// stackBlurRGB(imageData, { radius: 20 });
		//
		// context.putImageData(imageData, 0, 0);
		// targetEl.style.backgroundImage = "url(" + canvas.toDataURL() + ")";
	}*/
});

/* ---------------------------
/* Google Analytics
/* --------------------------- */
if (GA) {
	PlayableRenderer = (function(PlayableRenderer) {

		/** @type {module:underscore.strings/dasherize} */
		var dasherize = require("underscore.string/dasherize");

		// var readyEvents = ["playing", "waiting", "ended"];
		// var userEvents = ["play", "pause"];


		return PlayableRenderer.extend({

			/** @override */
			initialize: function() {
				var retval = PlayableRenderer.prototype.initialize.apply(this, arguments);
				this._playbackRequestedDefault = this.playbackRequested;
				return retval;
			},

			_onPlaybackToggle: function(ev) {
				var retval = PlayableRenderer.prototype._onPlaybackToggle.apply(this, arguments);
				var o = {
					hitType: "event",
					eventCategory: dasherize(this.cidPrefix),
					eventAction: this.playbackRequested ? "play" : "pause",
					eventLabel: this.model.get("text"),
				};
				if (this._playbackRequestedDefault)
					o.eventAction += "-autoplay";
				window.ga("send", o);
				return retval;
			},

			// /** @override */
			// togglePlayback: function(newPlayState) {
			// 	var retval = PlayableRenderer.prototype.togglePlayback.apply(this, arguments);
			// 	window.ga("send", {
			// 		hitType: "event",
			// 		eventCategory: "Playable",
			// 		eventAction: this.playbackRequested ? "play" : "pause",
			// 		eventLabel: this.model.get("text"),
			// 	});
			// 	return retval;
			// },
		});
	})(PlayableRenderer);
}

// if (DEBUG) {
//
// PlayableRenderer = (function(PlayableRenderer) {
// 	if (!PlayableRenderer.LOG_TO_SCREEN) return PlayableRenderer;
//
// 	/** @type {module:underscore.strings/lpad} */
// 	var lpad = require("underscore.string/lpad");
//
// 	return PlayableRenderer.extend({
// 		_canResumePlayback: function() {
// 			var retval = PlayableRenderer.prototype._canResumePlayback.apply(this.arguments);
// 			console.log("[scroll] %s::_canResumePlayback():%s", this.cid, retval,
// 			{
// 				"enabled": this.enabled,
// 				"selected": (!!this.model.selected),
// 				"playbackRequested": this.playbackRequested,
// 				"attached": this.attached,
// 				"parentView": (this.parentView && this.parentView.cid),
// 				"!scrolling": (this.parentView && !this.parentView.scrolling),
// 				"mediaState": this.mediaState,
// 				// "!document.hidden": !document[visibilityHiddenProp],
// 				"visibilityState": document[visibilityStateProp]
// 			});
// 			return retval;
// 		},
// 	});
// })(PlayableRenderer);
//
// }

module.exports = PlayableRenderer;
}).call(this,true)

},{"app/view/render/MediaRenderer":90,"underscore":"underscore","underscore.string/dasherize":23,"utils/prefixedEvent":112,"utils/prefixedProperty":113}],92:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<div class=\"placeholder sizing\"></div>\n<div class=\"content\">\n	<div class=\"media-border content-size\"></div>\n	<div class=\"controls content-size\">\n		<canvas class=\"progress-meter\"></canvas>\n	</div>\n	<div class=\"sequence media-size\">\n		<img class=\"sequence-step current default\" alt=\""
    + alias4(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"text","hash":{},"data":data}) : helper)))
    + "\" longdesc=\"#desc_m"
    + alias4(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" />\n	</div>\n	<div class=\"overlay media-size\">\n		<div class=\"play-toggle-hitarea play-toggle\">\n		</div>\n	</div>\n</div>\n";
},"useData":true});

},{"hbsfy/runtime":21}],93:[function(require,module,exports){
(function (DEBUG){
/**
 * @module app/view/render/SequenceRenderer
 */

/* --------------------------- *
/* Imports
/* --------------------------- */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:backbone.babysitter} */
var Container = require("backbone.babysitter");

/** @type {module:app/view/base/View} */
var View = require("app/view/base/View");
/** @type {module:app/view/render/PlayableRenderer} */
var PlayableRenderer = require("app/view/render/PlayableRenderer");
// /** @type {module:app/model/SelectableCollection} */
// var SelectableCollection = require("app/model/SelectableCollection");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

/** @type {module:app/view/component/ProgressMeter} */
var ProgressMeter = require("app/view/component/ProgressMeter");

/** @type {module:utils/Timer} */
var Timer = require("utils/Timer");
// /** @type {Function} */
// var transitionEnd = require("utils/event/transitionEnd");
// /** @type {module:utils/prefixedProperty} */
// var prefixed = require("utils/prefixedProperty");

/** @type {Function} */
var _whenImageLoads = require("app/view/promise/_whenImageLoads");
/** @type {module:app/view/promise/_loadImageAsObjectURL} */
var _loadImageAsObjectURL = require("app/view/promise/_loadImageAsObjectURL");
/** @type {Function} */
var whenSelectionDistanceIs = require("app/view/promise/whenSelectionDistanceIs");
// var whenSelectTransitionEnds = require("app/view/promise/whenSelectTransitionEnds");
// var whenDefaultImageLoads = require("app/view/promise/whenDefaultImageLoads");

// /** @type {Function} */
// var Color = require("color");
// var duotone = require("utils/canvas/bitmap/duotone");
// var stackBlurRGB = require("utils/canvas/bitmap/stackBlurRGB");
// var stackBlurMono = require("utils/canvas/bitmap/stackBlurMono");
// var getAverageRGBA = require("utils/canvas/bitmap/getAverageRGBA");

var errorTemplate = require("../template/ErrorBlock.hbs");

var MIN_STEP_INTERVAL = 2 * Globals.TRANSITION_DURATION + Globals.TRANSITION_DELAY_INTERVAL;
var DEFAULT_STEP_INTERVAL = 6 * Globals.TRANSITION_DURATION + Globals.TRANSITION_DELAY_INTERVAL;


/* --------------------------- *
/* Private classes
/* --------------------------- */

// /**
// * @constructor
// * @type {module:app/view/render/SequenceRenderer.SourceCollection}
// */
// var SourceCollection = SelectableCollection.extend({
// 	model: Backbone.Model
// });

/**
 * @constructor
 * @type {module:app/view/render/SequenceRenderer.PrefetechedSourceRenderer}
 */
var PrefetechedSourceRenderer = View.extend({

	cidPrefix: "sequenceStepRenderer",
	/** @type {string} */
	className: "sequence-step",
	/** @type {string} */
	tagName: "img",

	properties: {
		ready: {
			get: function() {
				return this._ready;
			}
		}
	},

	/** @override */
	initialize: function(options) {
		!this.el.hasAttribute("alt") && this.el.setAttribute("alt", this.model.get("src"));
		// this.el.setAttribute("longdesc", this.model.get("original"));

		if (this.model.has("prefetched")) {
			this._renderPrefetched();
		} else {
			this.listenTo(this.model, "change:prefetched", this._renderPrefetched);
		}
		this.listenTo(this.model, "selected deselected", this._renderSelection);
		this._renderSelection();
	},

	_renderSelection: function() {
		this.el.classList.toggle("current", !!this.model.selected);
	},

	_renderPrefetched: function() {
		var prefetched = this.model.get("prefetched");
		if (prefetched !== this.el.src) {
			this.el.src = prefetched;
		}
		_whenImageLoads(this.el).then(
			function(el) {
				this.requestAnimationFrame(function(tstamp) {
					this._setReady(true);
				});
			}.bind(this),
			function(err) {
				// this._setReady(false);
				(err instanceof Error) || (err = new Error("cannot load prefetched url"));
				throw err;
			}.bind(this)
		);
	},

	/** @type {boolean} */
	_ready: false,

	_setReady: function(ready) {
		if (this._ready === ready) return;
		this._ready = !!(ready); // make bool
		this.trigger("renderer:ready", this);
	},

	render: function() {
		// if (this.model.has("prefetched")) {
		// 	this._renderPrefetched();
		// }
		// this.el.classList.toggle("current", !!this.model.selected);
		console.log("%s::render", this.cid);
		return this;
	},
});

/**
 * @constructor
 * @type {module:app/view/render/SequenceRenderer.SimpleSourceRenderer}
 */
// var SimpleSourceRenderer = View.extend({
//
// 	cidPrefix: "sequenceStepRenderer",
// 	/** @type {string} */
// 	className: "sequence-step",
// 	/** @type {string} */
// 	tagName: "img",
//
// 	/** @override */
// 	initialize: function (options) {
// 		// this.el.classList.toggle("current", this.model.hasOwnProperty("selected"));
// 		this.el.classList.toggle("current", !!this.model.selected);
// 		this.listenTo(this.model, {
// 			"selected": function () {
// 				this.el.classList.add("current");
// 			},
// 			"deselected": function () {
// 				this.el.classList.remove("current");
// 			}
// 		});
// 		if (this.el.src === "") {
// 			this.el.src = Globals.MEDIA_DIR + "/" + this.model.get("src");
// 		}
//
// 		if (this.model.has("error")) {
// 			this._onModelError();
// 		} else {
// 			this.listenToOnce(this.model, "change:error", this._onModelError);
// 			// this.listenToOnce(this.model, {
// 			// 	"change:source": this._onModelSource,
// 			// 	"change:error": this._onModelError,
// 			// });
// 		}
// 	},
//
// 	// _onModelSource: function() {
// 	// 	this.el.src = Globals.MEDIA_DIR + "/" + this.model.get("src");
// 	// 	// console.log("%s::change:src", this.cid, this.model.get("src"));
// 	// },
//
// 	_onModelError: function() {
// 		var err = this.model.get("error");
// 		var errEl = document.createElement("div");
// 		errEl.className = "error color-bg" + (this.model.selected? " current" : "");
// 		errEl.innerHTML = errorTemplate(err);
// 		this.setElement(errEl, true);
// 		console.log("%s::change:error", this.cid, err.message, err.infoSrc);
// 	},
// });

var SourceErrorRenderer = View.extend({

	/** @type {string} */
	className: "sequence-step error",
	/** @override */
	cidPrefix: "sourceErrorRenderer",
	/** @override */
	template: errorTemplate,
	/** @type {boolean} */
	ready: true,

	initialize: function(options) {
		// var handleSelectionChange = function onSelectionChange () {
		// 	this.el.classList.toggle("current", !!this.model.selected);
		// };
		// this.listenTo(this.model, "selected deselected", handleSelectionChange);
		// // this.el.classList.toggle("current", !!this.model.selected);
		// handleSelectionChange.call(this);
		this.listenTo(this.model, "selected deselected", function() {
			this.el.classList.toggle("current", !!this.model.selected);
		});
	},

	render: function() {
		this.el.classList.toggle("current", !!this.model.selected);
		this.el.innerHTML = this.template(this.model.get("error"));
		return this;
	},
});

var SequenceStepRenderer = PrefetechedSourceRenderer;
// var SequenceStepRenderer = SimpleSourceRenderer;

/**
 * @constructor
 * @type {module:app/view/render/SequenceRenderer}
 */
var SequenceRenderer = PlayableRenderer.extend({

	/** @type {string} */
	cidPrefix: "sequenceRenderer",
	/** @type {string} */
	className: PlayableRenderer.prototype.className + " sequence-renderer",
	/** @type {Function} */
	template: require("./SequenceRenderer.hbs"),

	/* --------------------------- *
	/* initialize
	/* --------------------------- */

	initialize: function() {
		this.sources = this.model.get("sources");
		PlayableRenderer.prototype.initialize.apply(this, arguments);
	},

	initializeAsync: function() {
		return PlayableRenderer.prototype.initializeAsync.apply(this, arguments)
			.then(
				function(view) {
					return view.whenAttached();
				})
			.then(function(view) {
				view.initializePlayable();
				view.updateOverlay(view.defaultImage, view.overlay);
				view.addSelectionListeners();
				return view;
			});
	},

	whenInitialized: function(view) {
		var retval = PlayableRenderer.prototype.whenInitialized.apply(this, arguments);
		view._validatePlayback();
		return retval;
	},

	/* --------------------------- *
	/* children
	/* --------------------------- */

	/** @override */
	createChildren: function() {
		PlayableRenderer.prototype.createChildren.apply(this, arguments);

		this.placeholder = this.el.querySelector(".placeholder");
		this.sequence = this.content.querySelector(".sequence");

		this.content.classList.add("started");

		// styles
		// ---------------------------------
		var s, attrs = this.model.attrs();
		// var s, attrs = this.model.get("attrs");
		s = _.pick(attrs, "box-shadow", "border", "border-radius");
		_.extend(this.content.querySelector(".media-border").style, s);
		s = _.pick(attrs, "border-radius");
		_.extend(this.sequence.style, s);
		_.extend(this.placeholder.style, s);

		// model
		// ---------------------------------
		this.sources.select(this.model.get("source"));

		// itemViews
		// ---------------------------------
		this.itemViews = new Container();
		// add default image as renderer (already in DOM)
		this.itemViews.add(new SequenceStepRenderer({
			el: this.getDefaultImage(),
			model: this.sources.selected
		}));
	},

	/* --------------------------- *
	/* layout
	/* --------------------------- */

	/** @override */
	render: function() {
		PlayableRenderer.prototype.render.apply(this, arguments);

		var els, el, i, cssW, cssH;
		var content = this.content;

		// media-size
		// ---------------------------------
		cssW = this.metrics.media.width + "px";
		cssH = this.metrics.media.height + "px";

		els = this.el.querySelectorAll(".media-size");
		for (i = 0; i < els.length; i++) {
			el = els.item(i);
			el.style.width = cssW;
			el.style.height = cssH;
		}
		content.style.width = cssW;
		content.style.height = cssH;

		// content-position
		// ---------------------------------
		var cssX, cssY;
		cssX = this.metrics.content.x + "px";
		cssY = this.metrics.content.y + "px";
		content.style.left = cssX;
		content.style.top = cssY;

		el = this.el.querySelector(".controls");
		// el.style.left = cssX;
		// el.style.top = cssY;
		el.style.width = this.metrics.content.width + "px";
		el.style.height = this.metrics.content.height + "px";

		// // content-size
		// // ---------------------------------
		// cssW = this.metrics.content.width + "px";
		// cssH = this.metrics.content.height + "px";
		//
		// els = this.el.querySelectorAll(".content-size");
		// for (i = 0; i < els.length; i++) {
		// 	el = els.item(i);
		// 	el.style.width = cssW;
		// 	el.style.height = cssH;
		// }

		return this;
	},

	initializePlayable: function() {
		// Sequence model
		// ---------------------------------
		// this.sources = this._createSourceCollection(this.model);
		whenSelectionDistanceIs(this, 0).then(this._preloadAllItems, function(err) {
			if (err instanceof View.ViewError) { // Ignore ViewError
				// console.warn(err.name, err.message);//, err.view.cid);
				return;
			}
			return err;
		});

		// timer
		// ---------------------------------
		this._sequenceInterval = Math.max(parseInt(this.model.attr("@sequence-interval")), MIN_STEP_INTERVAL) || DEFAULT_STEP_INTERVAL;

		this.timer = new Timer();
		this.listenTo(this, "view:removed", function() {
			this.timer.stop();
			this.stopListening(this.timer);
		});
		this.listenTo(this.timer, {
			"start": this._onTimerStart,
			"resume": this._onTimerResume,
			"pause": this._onTimerPause,
			"end": this._onTimerEnd,
			// "stop": function () { // stop is only called on view remove},
		});

		// progress-meter model
		// ---------------------------------
		this._sourceProgressByIdx = this.sources.map(function() {
			return 0;
		});
		this._sourceProgressByIdx[0] = 1; // first item is already loaded

		// progress-meter
		// ---------------------------------
		this.progressMeter = new ProgressMeter({
			el: this.el.querySelector(".progress-meter"),
			values: {
				available: this._sourceProgressByIdx.concat(),
			},
			maxValues: {
				amount: this.sources.length,
				available: this.sources.length,
			},
			color: this.model.attr("color"),
			backgroundColor: this.model.attr("background-color"),
			labelFn: this._progressLabelFn.bind(this)
		});

		// this.el.querySelector(".top-bar")
		//		.appendChild(this.progressMeter.render().el);
	},

	_progressLabelFn: function() {
		if (this.playbackRequested === false) return Globals.PAUSE_CHAR;
		return (this.sources.selectedIndex + 1) + "/" + this.sources.length;
	},

	_preloadAllItems: function(view) {
		view.once("view:remove", function() {
			var silent = {
				silent: true
			};
			view.sources.forEach(function(item, index, sources) {
				var prefetched = item.get("prefetched");
				if (prefetched && /^blob\:/.test(prefetched)) {
					item.unset("prefetched", silent);
					item.set("progress", 0, silent);
					URL.revokeObjectURL(prefetched);
				}
			});
		});
		return view.sources.reduce(function(lastPromise, item, index, sources) {
			return lastPromise.then(function(view) {
				if (item.has("prefetched")) {
					view._updateItemProgress(1, index);
					return view;
				} else {
					return _loadImageAsObjectURL(item.get("original"),
							function(progress) {
								view._updateItemProgress(progress, index);
								item.set("progress", progress);
							})
						.then(
							function(pUrl) {
								view._updateItemProgress(1, index);
								item.set({
									prefetched: pUrl,
									progress: 1
								});
								// item.set("prefetched", pUrl);
								return view;
							},
							function(err) {
								view._updateItemProgress(0, index);
								item.set({
									error: err,
									progress: 0
								});
								// item.set("error", err);
								return view;
							}
						);
				}
			});
		}, Promise.resolve(view));
	},

	// _preloadAllItems2: function(view) {
	// 	return view.sources.reduce(function(lastPromise, item, index, sources) {
	// 		return lastPromise.then(function(view) {
	// 			var itemView = view._getItemRenderer(item);
	// 			return _whenImageLoads(itemView.el).then(function(url){
	// 				view._updateItemProgress(1, index);
	// 				return view;
	// 			}, function(err) {
	// 				view._updateItemProgress(0, index);
	// 				item.set("error", err);
	// 				return view;
	// 			});
	// 		});
	// 	}, Promise.resolve(view));
	// },

	// _getItemRenderer: function(item) {}

	_updateItemProgress: function(progress, index) {
		this._sourceProgressByIdx[index] = progress;
		if (this.progressMeter) {
			this.progressMeter.valueTo(this._sourceProgressByIdx, 300, "available");
		}
	},

	/* ---------------------------
	/* PlayableRenderer implementation
	/* --------------------------- */

	/** @override initial value */
	_playbackRequested: true,

	/** @type {Boolean} internal store */
	_paused: true,

	/** @override */
	_isMediaPaused: function() {
		return this._paused;
	},

	/** @override */
	_playMedia: function() {
		if (!this._paused) return;
		this._paused = false;
		if (this.timer.status == Timer.PAUSED) {
			this.timer.start(); // resume, actually
		} else {
			this.timer.start(this._sequenceInterval);
		}
	},

	/** @override */
	_pauseMedia: function() {
		if (this._paused) return;
		this._paused = true;
		if (this.timer.status == Timer.STARTED) {
			this.timer.pause();
		}
	},

	/* --------------------------- *
	/* sequence private
	/* --------------------------- */

	_onTimerStart: function(duration) {
		this.progressMeter.valueTo(this.sources.selectedIndex + 1, duration, "amount");
		// init next renderer now to have smooth transitions
		this._getItemRenderer(this.sources.followingOrFirst());
	},

	_onTimerResume: function(duration) {
		this.progressMeter.valueTo(this.sources.selectedIndex + 1, duration, "amount");
	},

	_onTimerPause: function(duration) {
		// var meterDur = this.progressMeter._valueData["amount"]._duration - this.progressMeter._valueData["amount"]._elapsedTime;
		// var meterVal = this.progressMeter.getRenderedValue("amount");
		// var timerVal = (this._sequenceInterval - duration) / this._sequenceInterval + this.sources.selectedIndex;
		//
		// console.log("%s::_onTimerPause [interval:%sms]\n\tmeter:%s (%sms)\n\ttimer:%s (%sms)\n\tdiffs:%s (%sms)",
		// 		this.cid, this._sequenceInterval,
		// 		meterVal, meterDur,
		// 		timerVal, duration,
		// 		Math.abs(meterVal-timerVal), Math.abs(meterDur-duration));

		// this.progressMeter.valueTo(timerVal);
		// this.progressMeter.valueTo(meterVal);

		this.progressMeter.valueTo(this.progressMeter.getRenderedValue("amount"), 0, "amount");
	},

	_onTimerEnd: function() {
		var context = this;
		var nextSource, nextView;

		nextSource = this.sources.followingOrFirst();
		// init next renderer
		nextView = this._getItemRenderer(nextSource);
		// init second next renderer
		// this._getItemRenderer(this.sources.followingOrFirst(nextSource));

		var showNextView = function() {
			context.requestAnimationFrame(function() {
				context.content.classList.remove("waiting");
				if (!context._paused) {
					// if (context.playbackRequested) {
					context.content.classList.toggle("playback-error", nextSource.has("error"));
					context.sources.select(nextSource); // NOTE: step increase done here
					// view.updateOverlay(nextView.el, view.overlay);
					context.timer.start(context._sequenceInterval);
					// console.log("%s::showNextView %sms %s", context.cid, context._sequenceInterval, nextSource.cid)
				}
			});
		};

		if (nextSource.has("prefetched")) {
			// nextView = context._getItemRenderer(nextSource).el;
			_whenImageLoads(nextView.el).then(showNextView, showNextView);
		} else if (nextSource.has("error")) {
			showNextView();
		} else {
			this.content.classList.add("waiting");
			/* TODO: add ga event 'media-waiting' */
			// console.log("%s:[waiting] %sms %s", context.cid, nextSource.cid);
			window.ga("send", "event", "sequence-renderer", "waiting", this.model.get("text"));
			this.listenTo(nextSource, "change:prefetched change:error",
				function() {
					this.stopListening(nextSource, "change:prefetched change:error");
					/* TODO: add ga event 'media-playing' */
					// console.log("%s:[playing] %sms %s", context.cid, nextSource.cid);
					window.ga("send", "event", "sequence-renderer", "playing", this.model.get("text"));
					_whenImageLoads(nextView.el).then(showNextView, showNextView);
					// context.content.classList.remove("waiting");
					// nextView = context._getItemRenderer(nextSource).el;
				});
		}
	},

	_getItemRenderer: function(item) {
		var view = this.itemViews.findByModel(item);
		if (!view) {
			var renderer = item.has("error") ? SourceErrorRenderer : SequenceStepRenderer;
			view = new renderer({
				model: item
			});
			// view = new SequenceStepRenderer({ model: item });
			this.itemViews.add(view);
			this.sequence.appendChild(view.render().el);
		}
		return view;
	},

	/* --------------------------- *
	/* progress meter
	/* --------------------------- */

	// _createDefaultItemData: function() {
	// 	var canvas = document.createElement("canvas");
	// 	var context = canvas.getContext("2d");
	// 	var imageData = this._drawMediaElement(context).getImageData(0, 0, canvas.width, canvas.height);
	//
	// 	var opts = { radius: 20 };
	// 	var fgColor = new Color(this.model.attr("color"));
	// 	var bgColor = new Color(this.model.attr("background-color"));
	// 	var isFgDark = fgColor.luminosity() < bgColor.luminosity();
	// 	opts.x00 = isFgDark? fgColor.clone().lighten(0.33) : bgColor.clone().darken(0.33);
	// 	opts.xFF = isFgDark? bgColor.clone().lighten(0.33) : fgColor.clone().darken(0.33);
	//
	// 	stackBlurMono(imageData, opts);
	// 	duotone(imageData, opts);
	// 	// stackBlurRGB(imageData, opts);
	//
	// 	context.putImageData(imageData, 0, 0);
	// 	return canvas.toDataURL();
	// },
});

if (DEBUG) {

	SequenceRenderer = (function(SequenceRenderer) {
		if (!SequenceRenderer.LOG_TO_SCREEN) return SequenceRenderer;

		/** @type {module:underscore.strings/lpad} */
		var lpad = require("underscore.string/lpad");

		return SequenceRenderer.extend({
			__logTimerEvent: function(evname, msg) {
				var logMsg = [
				"source: ", lpad(this.sources.selectedIndex, 2),
				"duration:", lpad(this.timer.getDuration(), 4),
				"paused:", this.paused,
				"requested:", this.playbackRequested,
				"status:", this.timer.getStatus(),
			];
				msg && logMsg.push(msg);
				logMsg = logMsg.join(" ");

				this.__logMessage(logMsg, evname);
				// console.log("%s::[%s] %s", this.cid, evname, logMsg);
			},
			_playMedia: function() {
				this.__logTimerEvent("playback");
				SequenceRenderer.prototype._playMedia.apply(this, arguments);
				// console.log("%s::_playMedia()", this.cid);
			},
			_pauseMedia: function() {
				this.__logTimerEvent("playback");
				SequenceRenderer.prototype._pauseMedia.apply(this, arguments);
				// console.log("%s::_pauseMedia()", this.cid);
			},

			_onTimerStart: function() {
				this.__logTimerEvent("timer:start");
				SequenceRenderer.prototype._onTimerStart.apply(this, arguments);
			},
			_onTimerResume: function() {
				this.__logTimerEvent("timer:resume");
				SequenceRenderer.prototype._onTimerStart.apply(this, arguments);
			},
			_onTimerPause: function() {
				this.__logTimerEvent("timer:pause");
				SequenceRenderer.prototype._onTimerPause.apply(this, arguments);
			},
			_onTimerEnd: function() {
				this.__logTimerEvent("timer:end");
				SequenceRenderer.prototype._onTimerEnd.apply(this, arguments);
			},

			_updateItemProgress: function(progress, srcIdx) {
				if (progress == 1) {
					this.__logMessage("idx:" + srcIdx + " progress:" + progress, "load:progress");
				}
				SequenceRenderer.prototype._updateItemProgress.apply(this, arguments);
			},

			_preloadAllItems: function(view) {
				view.__logMessage(view.cid + "::_preloadAllItems", "load:start");
				SequenceRenderer.prototype._preloadAllItems.apply(view, arguments);
			},
		});
	})(SequenceRenderer);
}

module.exports = SequenceRenderer;
}).call(this,true)

},{"../template/ErrorBlock.hbs":100,"./SequenceRenderer.hbs":92,"app/control/Globals":34,"app/view/base/View":58,"app/view/component/ProgressMeter":69,"app/view/promise/_loadImageAsObjectURL":73,"app/view/promise/_whenImageLoads":74,"app/view/promise/whenSelectionDistanceIs":77,"app/view/render/PlayableRenderer":91,"backbone.babysitter":"backbone.babysitter","underscore":"underscore","underscore.string/lpad":28,"utils/Timer":102}],94:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var helper;

  return "<div class=\"placeholder sizing\"></div>\n<div class=\"content media-border\">\n	<div class=\"controls content-size\">\n			<canvas class=\"progress-meter\"></canvas>\n			<a class=\"fullscreen-toggle\" href=\"javascript:(void 0)\">\n				<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" preserveAspectRatio=\"xMidYMid meet\" viewBox=\"-21 -21 42 42\" style=\"max-width:14px;max-height:14px\">\n					<path d=\"M-5,5 L-20,20 M-7,20 L-20,20 L-20,7 M5,-5 L20,-20 M7,-20 L20,-20 L20,-7\" class=\"color-stroke\" style=\"stroke-width:1;fill:none;\" vector-effect=\"non-scaling-stroke\" />\n				</svg>\n			</a>\n	</div>\n	<div class=\"crop-box media-size\">\n		<video preload=\"none\" width=\"240\" height=\"180\"></video>\n		<img class=\"poster default\" alt=\""
    + container.escapeExpression(((helper = (helper = helpers.text || (depth0 != null ? depth0.text : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(depth0 != null ? depth0 : {},{"name":"text","hash":{},"data":data}) : helper)))
    + "\" width=\"240\" height=\"180\" />\n	</div>\n	<div class=\"overlay media-size\">\n		<div class=\"play-toggle-hitarea play-toggle\">\n		</div>\n	</div>\n</div>\n";
},"useData":true});

},{"hbsfy/runtime":21}],95:[function(require,module,exports){
(function (DEBUG){
/*global HTMLMediaElement, MediaError*/
/**
 * @module app/view/render/VideoRenderer
 *
 * @see https://developer.mozilla.org/en-US/docs/Web/HTML/Element/video
 * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement
 * @see https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Media_events
 * @see https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Using_HTML5_audio_and_video
 */

/* --------------------------- *
/* Imports
/* --------------------------- */

/** @type {module:underscore} */
var _ = require("underscore");
// /** @type {module:backbone} */
// var Backbone = require("backbone");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");
/** @type {module:app/view/render/PlayableRenderer} */
var PlayableRenderer = require("app/view/render/PlayableRenderer");
/** @type {module:app/view/component/ProgressMeter} */
var ProgressMeter = require("app/view/component/ProgressMeter");
// /** @type {module:utils/prefixedStyleName} */
// var prefixedStyleName = require("utils/prefixedStyleName");
/** @type {module:utils/prefixedEvent} */
var prefixedEvent = require("utils/prefixedEvent");

/* --------------------------- *
/* private static
/* --------------------------- */

// var whenViewIsAttached = require("app/view/promise/whenViewIsAttached");

var fullscreenChangeEvent = prefixedEvent("fullscreenchange", document);
// var fullscreenErrorEvent = prefixedEvent("fullscreenerror", document);

var formatTimecode = function(value) {
	if (isNaN(value)) return ""; //value = 0;
	if (value >= 3600) return ((value / 3600) | 0) + "H";
	if (value >= 60) return ((value / 60) | 0) + "M";
	// if (value >= 10) return "0" + (value | 0) + "S";
	return (value | 0) + "S";
};

/**
 * @constructor
 * @type {module:app/view/render/VideoRenderer}
 */
var VideoRenderer = PlayableRenderer.extend({

	/** @type {string} */
	cidPrefix: "videoRenderer",
	/** @type {string} */
	className: PlayableRenderer.prototype.className + " video-renderer",
	/** @type {Function} */
	template: require("./VideoRenderer.hbs"),

	events: (function() {
		return window.hasOwnProperty("onpointerup")
			? { "pointerup .fullscreen-toggle": "_onFullscreenToggle" }
			: { "mouseup .fullscreen-toggle": "_onFullscreenToggle" }
	}()),

	// events: {
	// 	"click .fullscreen-toggle": "_onFullscreenToggle",
	// },

	// properties: {
	// 	paused: {
	// 		get: function() {
	// 			return this.video.paused;
	// 		}
	// 	},
	// },

	/** @override */
	initialize: function(opts) {
		PlayableRenderer.prototype.initialize.apply(this, arguments);

		_.bindAll(this,
			"_updatePlaybackState",
			"_updatePlayedValue",
			"_updateBufferedValue",
			"_onMediaError",
			"_onMediaEnded",
			"_onMediaPlayingOnce",
			"_onFullscreenChange"
		);
		// var onPeerSelect = function() {
		// 	this.content.style.display = (this.getSelectionDistance() > 1)? "none": "";
		// };
		// this.listenTo(this.model.collection, "select:one select:none", onPeerSelect);
		// onPeerSelect();
	},

	/* --------------------------- *
	/* children/layout
	/* --------------------------- */

	/** @override */
	createChildren: function() {
		PlayableRenderer.prototype.createChildren.apply(this, arguments);

		this.placeholder = this.el.querySelector(".placeholder");
		// this.overlay = this.content.querySelector(".overlay");
		this.video = this.content.querySelector("video");
		// this.video.loop = this.model.attrs().hasOwnProperty("@video-loop");
		this.video.loop = this.model.attr("@video-loop") !== void 0;
		this.video.src = this.findPlayableSource(this.video);
	},

	measure: function() {
		PlayableRenderer.prototype.measure.apply(this, arguments);

		// NOTE: Top/bottom 1px video crop
		// - Cropped in CSS: video, .poster { margin-top: -1px; margin-bottom: -1px;}
		// - Cropped height is adjusted in metrics obj
		// - Crop amount added back to actual video on render()
		this.metrics.media.height -= 2;
		this.metrics.content.height -= 2;
	},

	/** @override */
	render: function() {
		PlayableRenderer.prototype.render.apply(this, arguments);

		var els, el, i, cssW, cssH;
		var img = this.defaultImage;
		var content = this.content;

		// media-size
		// ---------------------------------
		cssW = this.metrics.media.width + "px";
		cssH = this.metrics.media.height + "px";

		els = this.el.querySelectorAll(".media-size");
		for (i = 0; i < els.length; i++) {
			el = els.item(i);
			el.style.width = cssW;
			el.style.height = cssH;
		}

		content.style.width = cssW;
		content.style.height = (this.metrics.media.height - 1) + "px";

		// content-position
		// ---------------------------------
		var cssX, cssY;
		cssX = this.metrics.content.x + "px";
		cssY = this.metrics.content.y + "px";
		content.style.left = cssX;
		content.style.top = cssY;

		el = this.el.querySelector(".controls");
		// el.style.left = cssX;
		// controls.style.top = cssY;
		el.style.width = this.metrics.content.width + "px";
		el.style.height = this.metrics.content.height + "px";

		// // content-size
		// // ---------------------------------
		// cssW = this.metrics.content.width + "px";
		// cssH = this.metrics.content.height + "px";
		//
		// els = this.el.querySelectorAll(".content-size");
		// for (i = 0; i < els.length; i++) {
		// 	el = els.item(i);
		// 	el.style.width = cssW;
		// 	el.style.height = cssH;
		// }

		// NOTE: elements below must use video's UNCROPPED height, so +2px
		this.video.setAttribute("width", this.metrics.media.width);
		this.video.setAttribute("height", this.metrics.media.height + 2);
		img.setAttribute("width", this.metrics.media.width);
		img.setAttribute("height", this.metrics.media.height + 2);

		return this;
	},

	/* --------------------------- *
	/* initializeAsync
	/* --------------------------- */

	initializeAsync: function() {
		return Promise.resolve(this)
			.then(PlayableRenderer.whenSelectionIsContiguous)
			.then(PlayableRenderer.whenScrollingEnds)
			.then(
				function(view) {
					return Promise.all([
						view.whenVideoHasMetadata(view),
						PlayableRenderer.whenDefaultImageLoads(view),
					]).then(
						function(arr) {
							return Promise.resolve(view);
						},
						function(err) {
							return Promise.reject(err);
						}
					);
				})
			.then(
				function(view) {
					return view.whenAttached();
				})
			.then(
				function(view) {
					view.initializePlayable();
					view.updateOverlay(view.defaultImage, view.overlay);
					view.addSelectionListeners();
					return view;
				});
	},

	initializePlayable: function() {
		// video
		// ---------------------------------
		this.addMediaListeners();

		// progress-meter
		// ---------------------------------
		this.progressMeter = new ProgressMeter({
			el: this.el.querySelector(".progress-meter"),
			maxValues: {
				amount: this.video.duration,
				available: this.video.duration,
			},
			color: this.model.attr("color"),
			backgroundColor: this.model.attr("background-color"),
			labelFn: this._progressLabelFn.bind(this)
		});
		// var parentEl = this.el.querySelector(".top-bar");
		// parentEl.insertBefore(this.progressMeter.render().el, parentEl.firstChild);
	},

	_progressLabelFn: function(value, total) {
		if (!this._started || this.video.ended || isNaN(value)) {
			return formatTimecode(total);
		} else if (!this.playbackRequested) {
			return Globals.PAUSE_CHAR;
		} else {
			return formatTimecode(total - value);
		}
	},

	/* ---------------------------
	/* whenVideoHasMetadata promise
	/* --------------------------- */

	whenVideoHasMetadata: function(view) {
		// NOTE: not pretty !!!
		return new Promise(function(resolve, reject) {
			var mediaEl = view.video;
			var eventHandlers = {
				loadedmetadata: function(ev) {
					if (ev) removeEventListeners();
					// console.log("%s::whenVideoHasMetadata [%s] %s", view.cid, "resolved", ev? ev.type : "sync");
					resolve(view);
				},
				abort: function(ev) {
					if (ev) removeEventListeners();
					reject(new PlayableRenderer.ViewError(view, new Error("whenVideoHasMetadata: view was removed")));
				},
				error: function(ev) {
					if (ev) removeEventListeners();
					var err;
					if (mediaEl.error) {
						err = new Error(_.invert(MediaError)[mediaEl.error.code]);
						err.infoCode = mediaEl.error.code;
					} else {
						err = new Error("Unspecified error");
					}
					err.infoSrc = mediaEl.src;
					err.logMessage = "whenVideoHasMetadata: " + err.name + " " + err.infoSrc;
					err.logEvent = ev;
					reject(err);
				},
			};
			//  (mediaEl.preload == "auto" && mediaEl.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA)
			// 	(mediaEl.preload == "metadata" && mediaEl.readyState >= HTMLMediaElement.HAVE_METADATA)
			if (mediaEl.error) {
				eventHandlers.error();
			} else if (mediaEl.readyState >= HTMLMediaElement.HAVE_METADATA) {
				eventHandlers.loadedmetadata();
			} else {
				var sources = mediaEl.querySelectorAll("source");
				var errTarget = sources.length > 0 ? sources.item(sources.length - 1) : mediaEl;
				var errCapture = errTarget === mediaEl; // use capture with HTMLMediaElement

				var removeEventListeners = function() {
					errTarget.removeEventListener("error", eventHandlers.error, errCapture);
					for (var ev in eventHandlers) {
						if (ev !== "error" && eventHandlers.hasOwnProperty(ev)) {
							mediaEl.removeEventListener(ev, eventHandlers[ev], false);
						}
					}
				};
				errTarget.addEventListener("error", eventHandlers.error, errCapture);
				for (var ev in eventHandlers) {
					if (ev !== "error" && eventHandlers.hasOwnProperty(ev)) {
						mediaEl.addEventListener(ev, eventHandlers[ev], false);
					}
				}
				mediaEl.preload = "metadata";
			}
		});
	},

	findPlayableSource: function(video) {
		var playable = this.model.get("sources").find(function(source) {
			return /^video\//.test(source.get("mime")) && video.canPlayType(source.get("mime")) != "";
		});
		return playable ? playable.get("original") : "";
	},

	/* ---------------------------
	/* PlayableRenderer implementation
	/* --------------------------- */

	/** @override initial value */
	_playbackRequested: false,

	/** @override */
	_isMediaPaused: function() {
		return this.video.paused;
	},

	/** @override */
	_playMedia: function() {
		if (this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA && this.video.seekable.length == 0) {
			console.warn(this.cid, "WTF! got video data, but cannot seek, calling load()");
			// this._logMessage("call:load", "got video data, but cannot seek, calling load()", "orange");
			this.video.load();
			// this.video.currentTime = 0;
		} else if (this.video.ended) {
			this.video.currentTime = this.video.seekable.start(0);
		}
		this.video.play();
	},

	/** @override */
	_pauseMedia: function() {
		this.video.pause();
	},

	/* ---------------------------
	/* media events
	/* --------------------------- */

	// updatePlaybackEvents: "play playing waiting pause seeking seeked ended",
	// updateBufferedEvents: "progress canplay canplaythrough playing timeupdate",//loadeddata
	updatePlaybackEvents: "playing waiting pause",
	updateBufferedEvents: "progress canplay canplaythrough play playing",
	updatePlayedEvents: "timeupdate seeked",

	addMediaListeners: function() {
		if (!this._started) this.video.addEventListener("playing", this._onMediaPlayingOnce, false);
		this.addListener(this.video, this.updatePlaybackEvents, this._updatePlaybackState);
		this.addListener(this.video, this.updateBufferedEvents, this._updateBufferedValue);
		this.addListener(this.video, this.updatePlayedEvents, this._updatePlayedValue);
		this.video.addEventListener("ended", this._onMediaEnded, false);
		this.video.addEventListener("error", this._onMediaError, true);

		this.on("view:removed", this.removeMediaListeners, this);
	},

	removeMediaListeners: function() {
		this.off("view:removed", this.removeMediaListeners, this);

		if (!this._started) this.video.removeEventListener("playing", this._onMediaPlayingOnce, false);
		this.removeListener(this.video, this.updatePlaybackEvents, this._updatePlaybackState);
		this.removeListener(this.video, this.updateBufferedEvents, this._updateBufferedValue);
		this.removeListener(this.video, this.updatePlayedEvents, this._updatePlayedValue);
		this.video.removeEventListener("ended", this._onMediaEnded, false);
		this.video.removeEventListener("error", this._onMediaError, true);
	},

	/* ---------------------------
	/* media event handlers
	/* --------------------------- */

	_onMediaError: function(ev) {
		this.removeMediaListeners();
		this.removeSelectionListeners();

		this._onMediaEnded(ev);
		this.content.classList.remove("ended");
		this.content.classList.remove("waiting");
		this.content.classList.remove("started");
		this._started = false;

		this.mediaState = "error";
	},

	_onMediaPlayingOnce: function(ev) {
		this.video.removeEventListener("playing", this._onMediaPlayingOnce, false);
		if (!this._started) {
			this._started = true;
			this.content.classList.add("started");
		}
	},

	_onMediaEnded: function(ev) {
		this.playbackRequested = false;
		if (this.video.webkitDisplayingFullscreen) {
			this.video.webkitExitFullscreen();
		}
		if (document.fullscreenElement === this.video) {
			this.video.exitFullscreen();
		}
	},

	_updatePlaybackState: function(ev) {
		var classList = this.content.classList;
		if (this.playbackRequested) {
			switch (ev.type) {
				case "pause":
				case "playing":
					classList.remove("waiting");
					break;
				case "waiting":
					classList.add("waiting");
					break;
			}
		} else {
			classList.remove("waiting");
		}
		classList.toggle("ended", this.video.ended);

		this._updatePlayedValue(ev);
	},

	_updatePlayedValue: function(ev) {
		this._currentTimeValue = this.video.currentTime;
		if (this.progressMeter) {
			this.progressMeter.valueTo(this._currentTimeValue, 0, "amount");
		}
	},

	_updateBufferedValue: function(ev) {
		var bRanges = this.video.buffered;
		if (bRanges.length > 0) {
			this._bufferedValue = bRanges.end(bRanges.length - 1);
			if (this.progressMeter && ((this.video.readyState == HTMLMediaElement.HAVE_ENOUGH_DATA) /*|| (this.video.readyState >= HTMLMediaElement.HAVE_CURRENT_DATA && this.video.networkState == HTMLMediaElement.NETWORK_LOADING)*/ )) {
				this.progressMeter.valueTo(this._bufferedValue, 300, "available");
				// this.progressMeter.valueTo(this._bufferedValue, Math.max(0, 1000 * (this._bufferedValue - (this.progressMeter.getValue("available") | 0))), "available");
			}
		}
	},

	/* ---------------------------
	/* fullscreen api
	/* --------------------------- */

	_onFullscreenToggle: function(ev) {
		// NOTE: Ignore if MouseEvent.button is 0 or undefined (0: left-button)
		if (!ev.defaultPrevented && !ev.button && this.model.selected) {
			// ev.preventDefault();
			try {
				if (document.hasOwnProperty("fullscreenElement") &&
					document.fullscreenElement !== this.video) {
					document.addEventListener(fullscreenChangeEvent, this._onFullscreenChange, false);
					this.video.requestFullscreen();
				} else
				if (this.video.webkitSupportsFullscreen && !this.video.webkitDisplayingFullscreen) {
					this.video.addEventListener("webkitbeginfullscreen", this._onFullscreenChange, false);
					this.video.webkitEnterFullScreen();
				}
			} catch (err) {
				this.video.controls = false;
				console.error(err);
			}
		}
	},

	_onFullscreenChange: function(ev) {
		switch (ev.type) {
			case fullscreenChangeEvent:
				// var isOwnFullscreen = Modernizr.prefixed("fullscreenElement", document) === this.video;
				var isOwnFullscreen = document.fullscreenElement === this.video;
				this.video.controls = isOwnFullscreen;
				if (!isOwnFullscreen) {
					document.removeEventListener(fullscreenChangeEvent, this._onFullscreenChange, false);
				}
				break;
			case "webkitbeginfullscreen":
				this.video.controls = true;
				this.video.removeEventListener("webkitbeginfullscreen", this._onFullscreenChange, false);
				this.video.addEventListener("webkitendfullscreen", this._onFullscreenChange, false);
				break;
			case "webkitendfullscreen":
				this.video.controls = false;
				this.video.removeEventListener("webkitendfullscreen", this._onFullscreenChange, false);
				break;
		}
	},

	/* ---------------------------
	/* event helpers
	/* --------------------------- */

	addListener: function(target, events, handler, useCapture) {
		(typeof events === "string") && (events = events.split(" "));
		for (var i = 0; i < events.length; i++) {
			target.addEventListener(events[i], handler, !!useCapture);
		}
	},

	removeListener: function(target, events, handler, useCapture) {
		(typeof events === "string") && (events = events.split(" "));
		for (var i = 0; i < events.length; i++) {
			target.removeEventListener(events[i], handler, !!useCapture);
		}
	},
});

/* ---------------------------
/* log to screen
/* --------------------------- */
if (DEBUG) {

	VideoRenderer = (function(VideoRenderer) {
		if (!VideoRenderer.LOG_TO_SCREEN) return VideoRenderer;

		/** @type {Function} */
		var Color = require("color");
		/** @type {module:underscore.strings/lpad} */
		var lpad = require("underscore.string/lpad");
		/** @type {module:underscore.strings/rpad} */
		var rpad = require("underscore.string/rpad");

		// var fullscreenEvents = [
		// 	fullscreenChangeEvent, fullscreenErrorEvent,
		// 	"webkitbeginfullscreen", "webkitendfullscreen",
		// ];

		var mediaEvents = require("utils/event/mediaEventsEnum");
		var updatePlaybackStateEvents, updateBufferedEvents, updatePlayedEvents;

		// updatePlaybackStateEvents = ["playing", "waiting", "ended", "pause", "seeking", "seeked"];
		// updateBufferedEvents = ["progress", "durationchange", "canplay", "play"];
		// updatePlayedEvents = ["playing", "timeupdate"];

		updatePlaybackStateEvents = [
			"loadstart",
			"progress",
			"suspend",
			"abort",
			"error",
			"emptied",
			"stalled",
		];
		updateBufferedEvents = [
			"loadedmetadata",
			"loadeddata",
			"canplay",
			"canplaythrough",
			"playing",
			"waiting",
			"seeking", // seeking changed to true
			"seeked", // seeking changed to false
			"ended", // ended is true
		];
		updatePlayedEvents = ["play", "pause"];

		// Exclude some events from log
		mediaEvents = _.without(mediaEvents, "resize", "error");
		// Make sure event subsets exist in the main set
		updatePlaybackStateEvents = _.intersection(mediaEvents, updatePlaybackStateEvents);
		updateBufferedEvents = _.intersection(mediaEvents, updateBufferedEvents);
		updatePlayedEvents = _.intersection(mediaEvents, updatePlayedEvents);

		var readyStateSymbols = _.invert(_.pick(HTMLMediaElement,
			function(val, key, obj) {
				return /^HAVE_/.test(key);
			}));
		var readyStateToString = function(el) {
			return readyStateSymbols[el.readyState] + "(" + el.readyState + ")";
		};

		var networkStateSymbols = _.invert(_.pick(HTMLMediaElement,
			function(val, key, obj) {
				return /^NETWORK_/.test(key);
			}));
		var networkStateToString = function(el) {
			return networkStateSymbols[el.networkState] + "(" + el.networkState + ")";
		};

		var mediaErrorSymbols = _.invert(MediaError);
		var mediaErrorToString = function(el) {
			return el.error ? mediaErrorSymbols[el.error.code] + "(" + el.error.code + ")" : "[MediaError null]";
		};

		var findRangeIndex = function(range, currTime) {
			for (var i = 0, ii = range.length; i < ii; i++) {
				if (range.start(i) <= currTime && currTime <= range.end(i)) {
					return i;
				}
			}
			return -1;
		};

		var formatVideoError = function(video) {
			return [
				mediaErrorToString(video),
				networkStateToString(video),
				readyStateToString(video),
			].join(" ");
		};

		var getVideoStatsCols = function() {
			return "0000.000 [Current/Total] [Seekable   ] [Buffered   ] networkState readyState      Playing";
			// return "0000.620 [t:  0.0  27.4] [s: 27.4 0/1] [b:  0.5 0/1] LOADING(2)   FUTURE_DATA(3)  :: (::)";
		}

		var formatVideoStats = function(video) {
			var currTime = video.currentTime,
				durTime = video.duration,
				bRanges = video.buffered,
				bRangeIdx,
				sRanges = video.seekable,
				sRangeIdx;

			bRangeIdx = findRangeIndex(bRanges, currTime);
			sRangeIdx = findRangeIndex(sRanges, currTime);
			return [
				"[t:" + lpad(currTime.toFixed(1), 5) +
					" " + lpad((!isNaN(durTime) ? durTime.toFixed(1) : "-"), 5) + "]",
				"[s:" + lpad((sRangeIdx >= 0 ? sRanges.end(sRangeIdx).toFixed(1) : "-"), 5) +
					" " + (sRangeIdx >= 0 ? sRangeIdx : "-") + "/" + sRanges.length + "]",
				"[b:" + lpad((bRangeIdx >= 0 ? bRanges.end(bRangeIdx).toFixed(1) : "-"), 5) +
					" " + (bRangeIdx >= 0 ? bRangeIdx : "-") + "/" + bRanges.length + "]",
				rpad(networkStateToString(video).substr(8), 12),
				rpad(readyStateToString(video).substr(5), 15),
				(video.ended ? ">:" : (video.paused ? "::" : ">>")),
			].join(" ");
		};

		return VideoRenderer.extend({

			/** @override */
			initialize: function() {
				VideoRenderer.prototype.initialize.apply(this, arguments);

				_.bindAll(this, "__handleMediaEvent");

				var fgColor = this.model.attr("color"),
					red = new Color("red"),
					blue = new Color("blue"),
					green = new Color("green");

				for (var i = 0; i < mediaEvents.length; i++) {
					var ev = mediaEvents[i];
					this.video.addEventListener(ev, this.__handleMediaEvent, false);

					var c = new Color(fgColor),
						cc = 1;
					if (updateBufferedEvents.indexOf(ev) != -1) c.mix(green, (cc /= 2));
					if (updatePlayedEvents.indexOf(ev) != -1) c.mix(red, (cc /= 2));
					if (updatePlaybackStateEvents.indexOf(ev) != -1) c.mix(blue, (cc /= 2));
					this.__logColors[ev] = c.rgbString();
				}
				this.video.addEventListener("error", this.__handleMediaEvent, true);
			},

			/** @override */
			remove: function() {
				VideoRenderer.prototype.remove.apply(this, arguments);
				for (var i = 0; i < mediaEvents.length; i++) {
					if (mediaEvents[i] == "error") continue;
					this.video.removeEventListener(mediaEvents[i], this.__handleMediaEvent, false);
				}
				this.video.removeEventListener("error", this.__handleMediaEvent, true);
			},

			/** @override */
			_onVisibilityChange: function(ev) {
				VideoRenderer.prototype._onVisibilityChange.apply(this, arguments);
				var stateVal = Modernizr.prefixed("visibilityState", document);
				this.__logEvent("visibilityState:" + stateVal, ev.type + ":" + stateVal);
			},

			/** @override */
			_onFullscreenChange: function(ev) {
				VideoRenderer.prototype._onFullscreenChange.apply(this, arguments);
				var logtype = (document.fullscreenElement === this.video ? "enter:" : "exit:") + ev.type;
				this.__logEvent("document.fullscreenElement: " + this.cid, logtype);
			},

			/** @override */
			_onFullscreenToggle: function(ev) {
				VideoRenderer.prototype._onFullscreenToggle.apply(this, arguments);
				if (!ev.defaultPrevented && this.model.selected) {
					this.__logEvent("fullscreen-toggle", ev.type);
				}
			},

			__handleMediaEvent: function(ev) {
				var evmsg; //, errmsg;
				// evmsg = formatVideoStats(this.video) + " " + rpad(this._lastPlaybackStates || "-", 9);
				evmsg = formatVideoStats(this.video);
				if (this.playbackRequested === true) {
					evmsg += " (>>)";
				} else if (this.playbackRequested === false) {
					evmsg += " (::)";
				} else {
					evmsg += " (--)";
				}
				this.__logEvent(evmsg, ev.type);
				if (ev.type === "error" || ev.type === "abort") {
					this.__logMessage(formatVideoError(this.video), ev.type);
				}
			},

			__logEvent: function(msg, logtype, color) {
				var logEntryEl = this.__logElement.lastElementChild;
				if ((logEntryEl && logEntryEl.getAttribute("data-logtype") == logtype) &&
					((logtype === "timeupdate") || (logtype === "progress"))) {
					var logRepeatVal = parseInt(logEntryEl.getAttribute("data-logrepeat"));
					logEntryEl.textContent = this.__getTStamp() + " " + msg;
					logEntryEl.setAttribute("data-logrepeat", isNaN(logRepeatVal) ? 2 : ++logRepeatVal);
				} else {
					this.__logMessage(msg, logtype, color);
				}
			},

			__getHeaderText: function() {
				return getVideoStatsCols();
			},
		});
	})(VideoRenderer);

}

module.exports = VideoRenderer;
}).call(this,true)

},{"./VideoRenderer.hbs":94,"app/control/Globals":34,"app/view/component/ProgressMeter":69,"app/view/render/PlayableRenderer":91,"color":"color","underscore":"underscore","underscore.string/lpad":28,"underscore.string/rpad":30,"utils/event/mediaEventsEnum":110,"utils/prefixedEvent":112}],96:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function";

  return "<div id=\"desc_b"
    + container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" class=\"content sizing mdown\">"
    + ((stack1 = ((helper = (helper = helpers.desc || (depth0 != null ? depth0.desc : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"desc","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</div>\n";
},"useData":true});

},{"hbsfy/runtime":21}],97:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function";

  return "<div id=\"desc_m"
    + container.escapeExpression(((helper = (helper = helpers.id || (depth0 != null ? depth0.id : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"id","hash":{},"data":data}) : helper)))
    + "\" class=\"content sizing\"><p>"
    + ((stack1 = ((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</p>"
    + ((stack1 = ((helper = (helper = helpers.sub || (depth0 != null ? depth0.sub : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"sub","hash":{},"data":data}) : helper))) != null ? stack1 : "")
    + "</div>\n";
},"useData":true});

},{"hbsfy/runtime":21}],98:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    return "<svg id=\"debug-grid\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" preserveAspectRatio=\"xMaxYMid slice\" viewport-fill=\"hsl(0,0%,100%)\" viewport-fill-opacity=\"1\" style=\"fill:none;stroke:none;stroke-width:1px;fill:none;fill-rule:evenodd;\">\n<defs>\n	<pattern id=\"pat-baseline-12px\" class=\"baseline base12\" x=\"0\" y=\"0\" width=\"20\" height=\"12\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.0\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"3\" y2=\"3\" stroke-opacity=\"0.125\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"6\" y2=\"6\" stroke-opacity=\"0.375\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"9\" y2=\"9\" stroke-opacity=\"0.125\"/>\n	</pattern>\n\n	<pattern id=\"pat-baseline-24px\" class=\"baseline base12\" x=\"0\" y=\"0\" width=\"20\" height=\"24\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.0\"/>\n	</pattern>\n\n	<pattern id=\"pat-baseline-10px\" class=\"baseline base10\" x=\"0\" y=\"0\" width=\"20\" height=\"10\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.00\"/>\n		<line x1=\"0\" x2=\"100%\" y1=\"5\" y2=\"5\" stroke-opacity=\"0.75\"/>\n	</pattern>\n	<pattern id=\"pat-baseline-20px\" class=\"baseline base10\" x=\"0\" y=\"0\" width=\"20\" height=\"20\" patternUnits=\"userSpaceOnUse\">\n		<line x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\" stroke-opacity=\"1.0\"/>\n	</pattern>\n	<pattern id=\"pat-cols-220px\" x=\"0\" y=\"0\" width=\"220\" height=\"36\" patternUnits=\"userSpaceOnUse\">\n		<rect transform=\"translate(0,0)\" x=\"0\" y=\"0\" width=\"20\" height=\"100%\" fill=\"hsl(336,50%,40%)\" fill-opacity=\"0.1\"/>\n		<rect transform=\"translate(200,0)\" x=\"0\" y=\"0\" width=\"20\" height=\"100%\" fill=\"hsl(336,50%,40%)\" fill-opacity=\"0.1\"/>\n		<line transform=\"translate(20 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,60%)\" stroke-opacity=\"0.2\"/>\n		<line transform=\"translate(200 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,40%)\" stroke-opacity=\"0.2\"/>\n\n		<line transform=\"translate(140 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,40%)\" stroke-opacity=\"0.3\"/>\n		<line transform=\"translate(80 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(336,50%,40%)\" stroke-opacity=\"0.3\"/>\n\n		<line transform=\"translate(0 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(236,50%,40%)\" stroke-opacity=\"0.4\" stroke-width=\"1\"/>\n		<line transform=\"translate(220 0)\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\" stroke=\"hsl(236,50%,40%)\" stroke-opacity=\"0.4\" stroke-width=\"1\"/>\n	</pattern>\n</defs>\n<g id=\"debug-grid-body\" transform=\"translate(0 0.5)\">\n	<rect id=\"baseline\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\"/>\n	<g id=\"debug-grid-container\">\n		<g id=\"debug-grid-content\">\n			<rect id=\"baseline-content\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\"/>\n			<line id=\"gct0\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n			<line id=\"gct1\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n		</g>\n		<line id=\"gnv0\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n		<line id=\"gnv1\" class=\"hguide\" x1=\"0\" x2=\"100%\" y1=\"0\" y2=\"0\"/>\n	</g>\n	<rect id=\"columns\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\"/>\n	<line id=\"gl0\" class=\"vguide\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n	<line id=\"gl1\" class=\"vguide gutter lgap\" x1=\"0\" x2=\"0\" y1=\"0\" y2=\"100%\"/>\n	<line id=\"gr0\" class=\"vguide\" x1=\"100%\" x2=\"100%\" y1=\"0\" y2=\"100%\"/>\n	<line id=\"gr1\" class=\"vguide gutter rgap\" x1=\"100%\" x2=\"100%\" y1=\"0\" y2=\"100%\"/>\n</g>\n</svg>\n";
},"useData":true});

},{"hbsfy/runtime":21}],99:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"1":function(container,depth0,helpers,partials,data) {
    var stack1;

  return "	<dd id=\"select-layout\">\n		<select size=1>\n"
    + ((stack1 = helpers.each.call(depth0 != null ? depth0 : {},(depth0 != null ? depth0.layouts : depth0),{"name":"each","hash":{},"fn":container.program(2, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "		</select>\n	</dd>\n";
},"2":function(container,depth0,helpers,partials,data) {
    var alias1=container.lambda, alias2=container.escapeExpression;

  return "			<option value=\""
    + alias2(alias1(depth0, depth0))
    + "\">"
    + alias2(alias1(depth0, depth0))
    + "</option>\n";
},"4":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {};

  return "		<li class=\""
    + ((stack1 = helpers["if"].call(alias1,depth0,{"name":"if","hash":{},"fn":container.program(5, data, 0),"inverse":container.program(7, data, 0),"data":data})) != null ? stack1 : "")
    + "\">"
    + container.escapeExpression(((helper = (helper = helpers.key || (data && data.key)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(alias1,{"name":"key","hash":{},"data":data}) : helper)))
    + "</li>\n";
},"5":function(container,depth0,helpers,partials,data) {
    return "passed";
},"7":function(container,depth0,helpers,partials,data) {
    return "failed";
},"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, alias1=depth0 != null ? depth0 : {}, alias2=container.escapeExpression;

  return "<dl class=\"debug-links color-bg\">\n	<dt id=\"links-toggle\">\n		<svg class=\"icon\" viewBox=\"-100 -100 200 200\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" preserveAspectRatio=\"xMidYMid meet\">\n			<path id=\"cog\" d=\"M11.754,-99.307c-7.809,-0.924 -15.699,-0.924 -23.508,0l-3.73,20.82c-6.254,1.234 -12.338,3.21 -18.123,5.888l-15.255,-14.651c-6.861,3.842 -13.244,8.48 -19.018,13.818l9.22,19.036c-4.335,4.674 -8.095,9.849 -11.201,15.416l-20.953,-2.886c-3.292,7.141 -5.731,14.645 -7.265,22.357l18.648,9.981c-0.759,6.329 -0.759,12.727 0,19.056l-18.648,9.981c1.534,7.712 3.973,15.216 7.265,22.357l20.953,-2.886c3.106,5.567 6.866,10.742 11.201,15.416l-9.22,19.036c5.774,5.338 12.157,9.976 19.018,13.818l15.255,-14.651c5.785,2.678 11.869,4.654 18.123,5.888l3.73,20.82c7.809,0.924 15.699,0.924 23.508,0l3.73,-20.82c6.254,-1.234 12.338,-3.21 18.123,-5.888l15.255,14.651c6.861,-3.842 13.244,-8.48 19.018,-13.818l-9.22,-19.036c4.335,-4.674 8.095,-9.849 11.201,-15.416l20.953,2.886c3.292,-7.141 5.731,-14.645 7.265,-22.357l-18.648,-9.981c0.759,-6.329 0.759,-12.727 0,-19.056l18.648,-9.981c-1.534,-7.712 -3.973,-15.216 -7.265,-22.357l-20.953,2.886c-3.106,-5.567 -6.866,-10.742 -11.201,-15.416l9.22,-19.036c-5.774,-5.338 -12.157,-9.976 -19.018,-13.818l-15.255,14.651c-5.785,-2.678 -11.869,-4.654 -18.123,-5.888l-3.73,-20.82ZM0,-33c18.213,0 33,14.787 33,33c0,18.213 -14.787,33 -33,33c-18.213,0 -33,-14.787 -33,-33c0,-18.213 14.787,-33 33,-33Z\" style=\"fill:currentColor;fill-rule:evenodd;\"/>\n		</svg>\n	</dt>\n	<dt id=\"app-state\">\n		<span class=\"color-fg color-bg\" data-prop=\"collapsed\">c</span><span class=\"color-fg color-bg\" data-prop=\"withBundle\">b</span><span class=\"color-fg color-bg\" data-prop=\"withMedia\">m</span><span class=\"color-fg color-bg\" data-prop=\"withArticle\">a</span>\n	</dt>\n"
    + ((stack1 = helpers["if"].call(alias1,(depth0 != null ? depth0.layouts : depth0),{"name":"if","hash":{},"fn":container.program(1, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "	<dd id=\"edit-backend\">\n		<a href=\""
    + alias2((helpers.global || (depth0 && depth0.global) || helpers.helperMissing).call(alias1,"APP_ROOT",{"name":"global","hash":{},"data":data}))
    + "symphony/\" class=\"color-fg color-bg\" target=\"_blank\">CMS</a>\n	</dd>\n	<dd id=\"toggle-tests\">\n		<a href=\"#toggle-tests\" class=\"color-fg color-bg\">Tests</a>\n	</dd>\n	<dd id=\"toggle-blocks\">\n		<a href=\"#toggle-blocks\" class=\"color-fg color-bg\">Blocks</a>\n	</dd>\n	<dd id=\"toggle-tx\">\n		<a href=\"#toggle-blocks\" class=\"color-fg color-bg\">TX/FX</a>\n	</dd>\n	<dd id=\"toggle-grid-bg\">\n		<a href=\"#toggle-grid-bg\" class=\"color-fg color-bg\">Grid</a>\n	</dd>\n	<dd id=\"toggle-mdown\">\n		<a href=\"#toggle-mdown\" class=\"color-fg color-bg\">Markdown</a>\n	</dd>\n	<dd id=\"toggle-logs\">\n		<a href=\"#toggle-logs\" class=\"color-fg color-bg\">Logs</a>\n	</dd>\n	<dd id=\"media-info\">\n		<span></span>\n	</dd>\n	<dd id=\"viewport-info\">\n		<span></span>\n	</dd>\n</dl>\n<div id=\"test-results\">\n	<h6>Tests <a id=\"toggle-passed\" href=\"#toggle-passed\">Passed</a></h6>\n	<p>"
    + alias2(container.lambda(((stack1 = (depth0 != null ? depth0.navigator : depth0)) != null ? stack1.userAgent : stack1), depth0))
    + "</p>\n	<ul>\n"
    + ((stack1 = helpers.each.call(alias1,(depth0 != null ? depth0.tests : depth0),{"name":"each","hash":{},"fn":container.program(4, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "	</ul>\n</div>\n";
},"useData":true});

},{"hbsfy/runtime":21}],100:[function(require,module,exports){
// hbsfy compiled Handlebars template
var HandlebarsCompiler = require('hbsfy/runtime');
module.exports = HandlebarsCompiler.template({"1":function(container,depth0,helpers,partials,data) {
    var helper;

  return "		<p><code>"
    + container.escapeExpression(((helper = (helper = helpers.infoSrc || (depth0 != null ? depth0.infoSrc : depth0)) != null ? helper : helpers.helperMissing),(typeof helper === "function" ? helper.call(depth0 != null ? depth0 : {},{"name":"infoSrc","hash":{},"data":data}) : helper)))
    + "</code></p>\n";
},"compiler":[7,">= 4.0.0"],"main":function(container,depth0,helpers,partials,data) {
    var stack1, helper, alias1=depth0 != null ? depth0 : {}, alias2=helpers.helperMissing, alias3="function", alias4=container.escapeExpression;

  return "<div class=\"error-message color-fg\">\n	<p><strong>"
    + alias4(((helper = (helper = helpers.name || (depth0 != null ? depth0.name : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"name","hash":{},"data":data}) : helper)))
    + "</strong> <code>"
    + alias4(((helper = (helper = helpers.message || (depth0 != null ? depth0.message : depth0)) != null ? helper : alias2),(typeof helper === alias3 ? helper.call(alias1,{"name":"message","hash":{},"data":data}) : helper)))
    + "</code></p>\n"
    + ((stack1 = helpers["if"].call(alias1,(depth0 != null ? depth0.infoSrc : depth0),{"name":"if","hash":{},"fn":container.program(1, data, 0),"inverse":container.noop,"data":data})) != null ? stack1 : "")
    + "</div>";
},"useData":true});

},{"hbsfy/runtime":21}],101:[function(require,module,exports){
// var Handlebars = require("handlebars")["default"];
var Handlebars = require("hbsfy/runtime");
/** @type {Function} */
var Color = require("color");
/** @type {module:app/control/Globals} */
var Globals = require("app/control/Globals");

// (function() {
var helpers = {
	/*
	/* Arithmetic helpers
	/*/
	add: function(value, addition) {
		return value + addition;
	},
	subtract: function(value, substraction) {
		return value - substraction;
	},
	divide: function(value, divisor) {
		return value / divisor;
	},
	multiply: function(value, multiplier) {
		return value * multiplier;
	},
	floor: function(value) {
		return Math.floor(value);
	},
	ceil: function(value) {
		return Math.ceil(value);
	},
	round: function(value) {
		return Math.round(value);
	},
	global: function(value) {
		return Globals[value];
	},

	/*
	/* Flow control helpers
	/*/
	is: function(a, b, opts) {
		return (a === b) ? opts.fn(this) : opts.inverse(this);
	},
	isnot: function(a, b, opts) {
		return (a !== b) ? opts.fn(this) : opts.inverse(this);
	},
	isany: function(value) {
		var i = 0,
			ii = arguments.length - 2,
			opts = arguments[ii + 1];
		do
			if (value === arguments[++i]) {
				return opts.fn(this);
			}
		while (i < ii);
		return opts.inverse(this);
	},
	contains: function(a, b, opts) {
		return (a.indexOf(b) !== -1) ? opts.fn(this) : opts.inverse(this);
	},
	ignore: function() {
		return "";
	},

	/*
	/* Color helpers
	/*/
	mix: function(colora, colorb, amount) {
		return new Color(colora).mix(new Color(colorb), amount).rgbString();
	},
	lighten: function(color, amount) {
		return new Color(color).lighten(amount).rgbString();
	},
	darken: function(color, amount) {
		return new Color(color).darken(amount).rgbString();
	},
	// colorFormat: function(color, fmt) {
	// 	switch (fmt) {
	// 		case "rgb":
	// 			return new Color(color).rgbString();
	// 		case "hsl":
	// 			return new Color(color).hslString();
	// 		case "hex": default:
	// 			return new Color(color).hexString();
	// 	}
	// },
};
for (var helper in helpers) {
	if (helpers.hasOwnProperty(helper)) {
		Handlebars.registerHelper(helper, helpers[helper]);
	}
}
// })();

// module.exports = Handlebars;

},{"app/control/Globals":34,"color":"color","hbsfy/runtime":21}],102:[function(require,module,exports){
/** @type {module:underscore} */
var _ = require("underscore");
/** @type {module:backbone} */
var Events = require("backbone").Events;


// var defaultOptions = {
// 	tick: 1,
// 	onstart: null,
// 	ontick: null,
// 	onpause: null,
// 	onstop: null,
// 	onend: null
// }
var idSeed = 0;

var Timer = function(options) {
	// if (!(this instanceof Timer)) {
	// 	return new Timer(options);
	// }
	this._id = idSeed++;
	// this._options = {};
	this._duration = 0;
	this._status = "initialized";
	this._start = 0;
	// this._measures = [];

	// for (var prop in defaultOptions) {
	// 	this._options[prop] = defaultOptions[prop];
	// }
	// this.options(options);
};

_.extend(Timer.prototype, Events, {

	start: function(duration) {
		if (!_.isNumber(duration) && !this._duration) {
			return this;
		}
		// duration && (duration *= 1000)
		if (this._timeout && this._status === "started") {
			return this;
		}
		var evName = (this._status === "stopped") ? "start" : "resume";
		this._duration = duration || this._duration;
		this._timeout = window.setTimeout(end.bind(this), this._duration);
		// if (typeof this._options.ontick === "function") {
		// 	this._interval = setInterval(function() {
		// 		this.trigger("tick", this.getDuration())
		// 	}.bind(this), +this._options.tick * 1000)
		// }
		this._start = _now();
		this._status = "started";
		this.trigger(evName, this.getDuration());
		return this;
	},

	pause: function() {
		if (this._status !== "started") {
			return this;
		}
		this._duration -= (_now() - this._start);
		clear.call(this, false);
		this._status = "paused";
		this.trigger("pause", this.getDuration());
		return this;
	},

	stop: function() {
		if (!/started|paused/.test(this._status)) {
			return this;
		}
		clear.call(this, true);
		this._status = "stopped";
		this.trigger("stop");
		return this;
	},

	getDuration: function() {
		if (this._status === "started") {
			return this._duration - (_now() - this._start);
		}
		if (this._status === "paused") {
			return this._duration;
		}
		return 0;
	},

	getStatus: function() {
		return this._status;
	},
});

var _now = window.performance ?
	window.performance.now.bind(window.performance) :
	Date.now.bind(Date);

function end() {
	clear.call(this);
	this._status = "stopped";
	this.trigger("end");
}

function clear(clearDuration) {
	window.clearTimeout(this._timeout);
	// window.clearInterval(this._interval);
	if (clearDuration === true) {
		this._duration = 0;
	}
}

Object.defineProperties(Timer.prototype, {
	duration: {
		enumerable: true,
		get: function() {
			return this.getDuration();
		}
	},
	status: {
		enumerable: true,
		get: function() {
			return this.getStatus();
		}
	}
});

Object.defineProperties(Timer, {
	STOPPED: {
		enumerable: true,
		value: "stopped"
	},
	STARTED: {
		enumerable: true,
		value: "started"
	},
	PAUSED: {
		enumerable: true,
		value: "paused"
	},
});

module.exports = Timer;

},{"backbone":"backbone","underscore":"underscore"}],103:[function(require,module,exports){
/* -------------------------------
/* Imports
/* ------------------------------- */


/** @type {module:underscore} */
var _ = require("underscore");

/** @type {module:utils/TransformItem} */
var TransformItem = require("./TransformItem");

var idSeed = 0;
var cidSeed = 100;
var slice = Array.prototype.slice;

/**
 * @constructor
 * @type {module:app/helper/TransformHelper}
 */
function TransformHelper() {
	this.id = idSeed++;
	this._items = [];
	this._itemsById = {};
}

TransformHelper.prototype = Object.create({

	/* -------------------------------
	/* Private
	/* ------------------------------- */

	_get: function(el) {
		if (this.has(el)) {
			return this._itemsById[el.eid];
		} else {
			return this._add(el);
		}
	},

	_add: function(el) {
		var item, id;
		// id = el.eid || el.cid || el.id;
		// if (!id || (this._itemsById[id] && (this._itemsById[id].el !== el))) {
		// 	id = "elt" + cidSeed++;
		// }
		// if (!el.eid) {
		// 	id = el.eid || el.cid || ("elt" + cidSeed++);
		// }
		id = el.eid || el.cid || ("elt" + cidSeed++);
		item = new TransformItem(el, id);
		this._itemsById[id] = item;
		this._items.push(item);
		return item;
	},

	_remove: function(el) {
		if (this.has(el)) {
			var o = this._itemsById[el.eid];
			this._items.splice(this._items.indexOf(o), 1);
			o.destroy();
			delete this._itemsById[el.eid];
		}
	},

	_invoke: function(funcName, args, startIndex) {
		var i, ii, j, jj, el, o, rr;
		var funcArgs = null;
		if (startIndex !== void 0) {
			funcArgs = slice.call(args, 0, startIndex);
		} else {
			startIndex = 0;
		}
		for (i = startIndex, ii = args.length, rr = []; i < ii; ++i) {
			el = args[i];
			// iterate on NodeList, Arguments, Array...
			if (el.length) {
				for (j = 0, jj = el.length; j < jj; ++j) {
					o = this._get(el[j]);
					rr.push(o[funcName].apply(o, funcArgs));
				}
			} else {
				o = this._get(el);
				rr.push(o[funcName].apply(o, funcArgs));
			}
		}
		return rr;
	},

	/* -------------------------------
	/* Public
	/* ------------------------------- */

	has: function(el) {
		return el.eid && this._itemsById[el.eid] !== void 0;
	},

	getItems: function() {
		var i, j, el, ret = [];
		for (i = 0; i < arguments.length; ++i) {
			el = arguments[i];
			if (el.length) {
				for (j = 0; j < el.length; ++j) {
					ret.push(this._get(el[j]));
				}
			} else {
				ret.push(this._get(el));
			}
		}
		return ret;
	},

	get: function(el) {
		return this._get(el);
	},

	add: function() {
		var i, j, el;
		for (i = 0; i < arguments.length; ++i) {
			el = arguments[i];
			if (el.length) {
				for (j = 0; j < el.length; ++j) {
					this._get(el[j]);
				}
			} else {
				this._get(el);
			}
		}
	},

	remove: function() {
		var i, j, el;
		for (i = 0; i < arguments.length; ++i) {
			el = arguments[i];
			if (el.length) {
				for (j = 0; j < el.length; ++j) {
					this._remove(el[j]);
				}
			} else {
				this._remove(el);
			}
		}
	},

	/* --------------------------------
	/* public
	/* -------------------------------- */

	/* public: single arg
	/* - - - - - - - - - - - - - - - - */

	hasOffset: function(el) {
		return this.has(el) ? this._itemsById[el.eid].hasOffset : (void 0);
	},

	/* public: capture
	/* - - - - - - - - - - - - - - - - */

	capture: function() {
		this._invoke("capture", arguments);
	},
	captureAll: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].capture();
		}
	},

	clearCapture: function() {
		this._invoke("clearCapture", arguments);
	},
	clearAllCaptures: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].clearCapture();
		}
	},

	/* public: offset
	/* - - - - - - - - - - - - - - - - */
	offset: function(x, y) {
		this._invoke("offset", arguments, 2);
	},
	offsetAll: function(x, y) {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].offset(x, y);
		}
	},

	clearOffset: function() {
		this._invoke("clearOffset", arguments);
	},
	clearAllOffsets: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].clearOffset();
		}
	},

	/* public: transitions
	/* - - - - - - - - - - - - - - - - */

	runTransition: function(transition) {
		this._invoke("runTransition", arguments, 1);
	},
	runAllTransitions: function(transition) {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].runTransition(transition);
		}
	},

	clearTransition: function() {
		this._invoke("clearTransition", arguments);
	},
	clearAllTransitions: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].clearTransition();
		}
	},

	stopTransition: function() {
		this._invoke("stopTransition", arguments);
	},
	stopAllTransitions: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].stopTransition();
		}
	},

	whenTransitionEnds: function() {
		var res = this._invoke("whenTransitionEnds", arguments);
		return res.length != 0 ?
			Promise.all(res) :
			Promise.resolve(null);
	},
	whenAllTransitionsEnd: function() {
		return (this._items.length != 0) ? Promise.all(this._items.map(function(o) {
			return o.whenTransitionEnds();
		})) : Promise.resolve(null);
	},

	promise: function() {
		return arguments.length == 0 ?
			this.whenAllTransitionsEnd() :
			this.whenTransitionEnds.call(this, arguments);
	},

	/* -------------------------------
	/* validation
	/* ------------------------------- */

	validate: function() {
		for (var i = 0, ii = this._items.length; i < ii; i++) {
			this._items[i].validate();
		}
	},
}, {
	items: {
		get: function() {
			return this._items;
		}
	}
});

module.exports = TransformHelper;

},{"./TransformItem":104,"underscore":"underscore"}],104:[function(require,module,exports){
/* -------------------------------
 * Imports
 * ------------------------------- */

/** @type {module:underscore} */
var _ = require("underscore");

/** @type {module:utils/prefixedProperty} */
var prefixedProperty = require("utils/prefixedProperty");
/** @type {module:utils/prefixedStyleName} */
var prefixedStyleName = require("utils/prefixedStyleName");
/** @type {module:utils/prefixedEvent} */
var prefixedEvent = require("utils/prefixedEvent");

/** @type {String} */
var transitionEnd = prefixedEvent("transitionend"); //require("utils/event/transitionEnd");
// /** @type {Function} */// var slice = Array.prototype.slice;

// /** @type {module:utils/debug/traceElement} */
// var traceElt = require("./debug/traceElement");
// var traceEltCache = {};
// var log = function() {
// 	var logFn = "log";
// 	var args = slice.apply(arguments);
// 	switch(args[0]) {
// 		case "error":
// 		case "warn":
// 		case "info":
// 			logFn = args.shift();
// 			break;
// 		default:
// 			// break;
// 			return;
// 	}
// 	var el, txId;
// 	if ((el = args[0]) && (txId = el.eid)) {
// 		args[0] = traceEltCache[txId] || (traceEltCache[txId] = el);
// 	}
// 	args[0] = "\t" + args[0];
// 	console[logFn].apply(console, args);
// };

/* jshint -W079 */
// var console = (function(target) {
// 	return Object.getOwnPropertyNames(target).reduce(function(proxy, prop) {
// 		if ((typeof target[prop]) == "function") {
// 			switch (prop) {
// 				case "error":
// 				case "warn":
// 				case "info":
// 					proxy[prop] = function () {
// 						var args = slice.apply(arguments);
// 						if (typeof args[0] == "string") {
// 							args[0] = prop + "::" + args[0];
// 						}
// 						return target[prop].apply(target, args);
// 					};
// 					break;
// 				case "log":
// 					proxy[prop] = function() {};
// 					break;
// 				default:
// 					proxy[prop] = target[prop].bind(target);
// 					break;
// 			}
// 		} else {
// 			Object.defineProperty(proxy, prop, {
// 				get: function() { return target[prop]; },
// 				set: function(val) { target[prop] = val; }
// 			});
// 		}
// 		return proxy;
// 	}, {});
// })(window.console);
/* jshint +W079 */

/* -------------------------------
/* Private static
/* ------------------------------- */

var NO_TRANSITION = "none 0s step-start 0s";


// var translateTemplate = function(o) {
// 	// return "translate(" + o._renderedX + "px, " + o._renderedY + "px)";
// 	// return "translate3d(" + o._renderedX + "px, " + o._renderedY + "px, 0px)";
// };

var translateTemplate = (function() {
	var fn = require("app/control/Globals").TRANSLATE_TEMPLATE;
	return function(o) {
		return fn(o._renderedX, o._renderedY);
	};
}());

var transitionTemplate = function(o) {
	return o.property + " " + o.duration / 1000 + "s " + o.easing + " " + o.delay / 1000 + "s";
};

var UNSET_TRANSITION = {
	name: "unset",
	className: "tx-unset",
	property: "none",
	easing: "ease",
	delay: 0,
	duration: 0,
	cssText: "unset",
};

// var transitionTemplate = _.template("<%= property %> <% duration/1000 %>s <%= easing %> <% delay/1000 %>s");
// var NO_TRANSITION = "all 0.001s step-start 0.001s";

var propDefaults = {
	"opacity": "1",
	"visibility": "visible",
	"transform": "matrix(1, 0, 0, 1, 0, 0)",
	"transformStyle": "",
	"transition": "",
	// "willChange": "",
	// "transitionDuration": "0s",
	// "transitionDelay": "0s",
	// "transitionProperty": "none",
	// "transitionTimingFunction": "ease"
};
var propKeys = Object.keys(propDefaults);
var propNames = propKeys.reduce(function(obj, propName) {
	obj[propName] = prefixedProperty(propName);
	return obj;
}, {});

/** @type {module:utils/strings/camelToDashed} */
var camelToDashed = require("utils/strings/camelToDashed");
var styleNames = propKeys.map(camelToDashed).reduce(function(obj, propName) {
	obj[propName] = prefixedStyleName(propName);
	return obj;
}, {});

var resolveAll = function(pp, result) {
	if (pp.length != 0) {
		pp.forEach(function(p, i, a) {
			p.resolve(result);
			a[i] = null;
		});
		pp.length = 0;
	}
	return pp;
};

var rejectAll = function(pp, reason) {
	if (pp.length != 0) {
		pp.forEach(function(p, i, a) {
			p.reject(reason);
			a[i] = null;
		});
		pp.length = 0;
	}
	return pp;
};

/* -------------------------------
 * TransformItem
 * ------------------------------- */

/**
 * @constructor
 */
function TransformItem(el, id) {
	_.bindAll(this, "_onTransitionEnd");

	this.el = el;
	this.id = id;
	this.el.eid = id;
	this.el.addEventListener(transitionEnd, this._onTransitionEnd, false);

	this._captureInvalid = false;
	this._capturedChanged = false;
	this._capturedX = null;
	this._capturedY = null;
	this._currCapture = {};
	this._lastCapture = {};

	this._hasOffset = false;
	this._offsetInvalid = false;
	this._offsetX = null;
	this._offsetY = null;

	this._renderedX = null;
	this._renderedY = null;

	this._hasTransition = false;
	this._transitionInvalid = false;
	this._transitionRunning = false;
	this._transition = _.extend({}, UNSET_TRANSITION); //{};

	this._promises = [];
	this._pendingPromises = [];
}

TransformItem.prototype = Object.create({

	/* -------------------------------
	/* Public
	/* ------------------------------- */

	/* destroy
	/* - - - - - - - - - - - - - - - - */
	destroy: function() {
		// NOTE: style property may have been modified; clearOffset(element) should
		// be called explicitly if clean up is required.
		this.el.removeEventListener(transitionEnd, this._onTransitionEnd, false);
		rejectAll(this._pendingPromises, this.el);
		rejectAll(this._promises, this.el);
		// delete this.el.eid;
	},

	/* capture
	/* - - - - - - - - - - - - - - - - */
	capture: function() {
		// console.log("tx[%s]::capture", this.id);
		this._validateCapture();
		return this;
	},

	clearCapture: function() {
		// console.log("tx[%s]::clearCapture", this.id);
		// this._hasOffset = false;
		this._captureInvalid = true;
		return this;
	},

	/* offset/clear
	/* - - - - - - - - - - - - - - - - */
	offset: function(x, y) {
		// console.log("tx[%s]::offset", this.id);

		this._hasOffset = true;
		this._offsetInvalid = true;
		this._offsetX = x || 0;
		this._offsetY = y || 0;
		// if (this.immediate) this._validateOffset();
		return this;
	},

	clearOffset: function() {
		if (this._hasOffset) {
			// console.log("tx[%s]::clearOffset", this.id);

			this._hasOffset = false;
			this._offsetInvalid = true;
			this._offsetX = null;
			this._offsetY = null;
			// if (this.immediate) this._validateOffset();
		} else {
			// console.log("tx[%s]::clearOffset no offset to clear", this.id);
		}
		return this;
	},

	/* transitions
	/* - - - - - - - - - - - - - - - - */
	runTransition: function(transition) {
		if (!transition) { // || (transition.duration + transition.delay) == 0) {
			return this.clearTransition();
		}
		var lastValue = this._transitionValue;
		var lastName = this._transition.name;
		this._transition.property = styleNames["transform"];
		this._transition = _.extend(this._transition, transition);
		this._transitionValue = transitionTemplate(this._transition);

		if (this._transitionInvalid) {
			console.warn("tx[%s]::runTransition set over (%s:'%s' => %s:'%s')", this.id,
				lastName, lastValue, this._transition.name, this._transitionValue);
		}

		this._hasTransition = true;
		this._transitionInvalid = true;
		// if (this.immediate) this._validateTransition();
		return this;
	},

	clearTransition: function() {
		this._transition = _.extend(this._transition, UNSET_TRANSITION);
		this._transitionValue = NO_TRANSITION;

		this._hasTransition = false;
		this._transitionInvalid = true;
		// if (this.immediate) this._validateTransition();
		return this;
	},

	stopTransition: function() {
		// this._transition.name = "[none]";
		// this._transition.property = "none";
		this._transition = _.extend(this._transition, UNSET_TRANSITION);
		this._transitionValue = NO_TRANSITION;

		this._hasTransition = false;
		this._transitionInvalid = true;
		// if (this.immediate) this._validateTransition();
		return this;
	},

	whenTransitionEnds: function() {
		var d, p, pp;
		if (this._transitionInvalid || this._transitionRunning) {
			d = {};
			p = new Promise(function(resolve, reject) {
				d.resolve = resolve;
				d.reject = reject;
			});
			pp = this._transitionInvalid ? this._pendingPromises : this._promises;
			pp.push(d);
		} else {
			p = Promise.resolve(this.el);
		}
		return p;
	},

	/* validation
	/* - - - - - - - - - - - - - - - - */
	validate: function() {
		// this.el.removeEventListener(transitionEnd, this._onTransitionEnd, false);
		this._ignoreEvent = true;

		if (this._captureInvalid) {
			var lastX = (this._renderedX !== null ? this._renderedX : this._capturedX),
				lastY = (this._renderedY !== null ? this._renderedY : this._capturedY);

			// this._validateTransition();
			this._validateCapture();
			this._validateOffset();

			var currX = (this._renderedX !== null ? this._renderedX : this._capturedX),
				currY = (this._renderedY !== null ? this._renderedY : this._capturedY);

			if (lastX === currX && lastY === currY) {
				this._hasTransition && console.warn("tx[%s]::validate unchanged: last:[%i,%i] curr:[%i,%i]", this.el.id || this.id, lastX, lastY, currX, currY);
				// console.info("tx[%s]::validate unchanged: last:[%f,%f] curr:[%f,%f] render:[%f,%f] captured[%f,%f]", this.el.id || this.id, lastX, lastY, currX, currY, this._renderedX, this._renderedY, this._capturedX, this._capturedY);
				this.clearTransition();
				// this._validateTransition();
			}
			this._validateTransition();
		} else {
			// this._validateCapture();
			this._validateTransition();
			this._validateOffset();
		}

		// this.el.addEventListener(transitionEnd, this._onTransitionEnd, false);
		this._ignoreEvent = false;

		// if (this._capturedChanged) {
		// 	console.error("tx[%s]::validate capture changed: [%f,%f]", this.id, this._capturedX, this._capturedY);
		// }
		this._capturedChanged = false;
		return this;
	},

	/* -------------------------------
	/* Private
	/* ------------------------------- */

	_validateCapture: function() {
		if (!this._captureInvalid) {
			return;
		}
		// var computed, capturedValues;
		var transformValue = null;

		if (this._hasOffset && !this._offsetInvalid) {
			// this is an explicit call to capture() instead of a subcall from _validateOffset()
			transformValue = this._getCSSProp("transform");
			if (transformValue === "") {
				console.error("tx[%s]::_capture valid offset (%i,$i) but transformValue=\"\"", this.id, this._offsetX, this._offsetY);
			}
			this._removeCSSProp("transform");
		}

		// NOTE: reusing object, all props will be overwritten
		this._lastCapture = this._currCapture;
		this._currCapture = this._getComputedCSSProps();

		if (this._currCapture.transform !== this._lastCapture.transform) {
			var m, mm; //, ret = {};
			mm = this._currCapture.transform.match(/(matrix|matrix3d)\(([^\)]+)\)/);
			if (mm) {
				m = mm[2].split(",");
				if (mm[1] === "matrix") {
					this._capturedX = parseFloat(m[4]);
					this._capturedY = parseFloat(m[5]);
				} else {
					this._capturedX = parseFloat(m[12]);
					this._capturedY = parseFloat(m[13]);
				}
			} else {
				this._capturedX = 0;
				this._capturedY = 0;
			}
			this._capturedChanged = true;
		}
		if (transformValue !== null) {
			console.log("tx[%s]::_capture reapplying '%s'", this.id, transformValue);
			this._setCSSProp("transform", transformValue);
		}
		this._captureInvalid = false;
	},

	_validateOffset: function() {
		if (this._offsetInvalid) {
			// this._validateCapture();
			this._offsetInvalid = false;
			if (this._hasOffset) {
				var tx = this._offsetX + this._capturedX;
				var ty = this._offsetY + this._capturedY;
				if (tx !== this._renderedX || ty !== this._renderedY) {
					this._renderedX = tx;
					this._renderedY = ty;
					this._setCSSProp("transform", translateTemplate(this));
				}
			} else {
				this._renderedX = null;
				this._renderedY = null;
				this._removeCSSProp("transform");
			}
		}
	},

	_validateTransition: function() {
		if (this._transitionInvalid) {
			// this._validateCapture();
			this._transitionInvalid = false;

			// save promises made while invalid
			var reject = this._promises;
			// prepare _promises and push in new ones
			this._promises = this._pendingPromises;
			// whatever still here is to be rejected. reuse array
			this._pendingPromises = rejectAll(reject, this.el);

			this._transitionRunning = this._hasTransition;
			this._setCSSProp("transition", this._transitionValue);

			if (!this._hasTransition) {
				// no transition, resolve now
				resolveAll(this._promises, this.el);
			}
		}
	},

	_onTransitionEnd: function(ev) {
		if (this._ignoreEvent) {
			return;
		}
		if (this._transitionRunning && (this.el === ev.target) &&
			(this._transition.property == ev.propertyName)) {
			this._hasTransition = false;
			this._transitionRunning = false;
			this._removeCSSProp("transition");
			resolveAll(this._promises, this.el);
		}
	},

	/* -------------------------------
	/* CSS
	/* ------------------------------- */

	_getCSSProp: function(prop) {
		return this.el.style[propNames[prop]];
		// return this.el.style[prefixedProperty(prop)];
		// return this.el.style.getPropertyValue(styleNames[prop]);
	},

	_setCSSProp: function(prop, value) {
		if (prop === "transition" && value == NO_TRANSITION) {
			value = "";
		}
		if (value === null || value === void 0 || value === "") {
			this._removeCSSProp(prop);
		} else {
			this.el.style[propNames[prop]] = value;
			// this.el.style.setProperty(styleNames[prop], value);
		}
	},

	_removeCSSProp: function(prop) {
		this.el.style[propNames[prop]] = "";
		// this.el.style.removeProperty(styleNames[prop]);
	},

	_getComputedCSSProps: function() {
		var values = {};
		var computed = window.getComputedStyle(this.el);
		for (var p in propNames) {
			values[p] = computed[propNames[p]];
		}
		return values;
	},
}, {
	transition: {
		get: function() {
			return this._transition;
		}
	},
	hasTransition: {
		get: function() {
			return this._hasTransition;
		}
	},
	capturedChanged: {
		get: function() {
			return this._capturedChanged;
		}
	},
	capturedX: {
		get: function() {
			return this._capturedX;
		}
	},
	capturedY: {
		get: function() {
			return this._capturedY;
		}
	},

	hasOffset: {
		get: function() {
			return this._hasOffset;
		}
	},
	offsetX: {
		get: function() {
			return this._offsetX;
		}
	},
	offsetY: {
		get: function() {
			return this._offsetY;
		}
	},
});

module.exports = TransformItem;
},{"app/control/Globals":34,"underscore":"underscore","utils/prefixedEvent":112,"utils/prefixedProperty":113,"utils/prefixedStyleName":114,"utils/strings/camelToDashed":117}],105:[function(require,module,exports){
var PI2 = Math.PI * 2;

var splice = Array.prototype.splice;
// var concat = Array.prototype.concat;

var setStyle = function(ctx, s) {
	if (typeof s != "object") return;
	for (var p in s) {
		switch (typeof ctx[p]) {
			case "undefined":
				break;
			case "function":
				if (Array.isArray(s[p])) ctx[p].apply(ctx, s[p]);
				else ctx[p].call(ctx, s[p]);
				break;
			default:
				ctx[p] = s[p];
		}
	}
};

var _drawShape = function(fn, s, ctx) {
	ctx.save();
	if (s) setStyle(ctx, s);
	fn.apply(null, splice.call(arguments, 2));
	if (ctx.lineWidth !== "transparent") ctx.stroke();
	if (ctx.fillStyle !== "transparent") ctx.fill();
	ctx.restore();
};

module.exports = {
	setStyle: setStyle,

	vGuide: function(ctx, x) {
		ctx.beginPath();
		ctx.moveTo(x, 0);
		ctx.lineTo(x, ctx.canvas.height);
	},
	drawVGuide: function(ctx, s, x) {
		_drawShape(this.vGuide, s, ctx, x);
	},

	hGuide: function(ctx, y) {
		ctx.beginPath();
		ctx.moveTo(0, y);
		ctx.lineTo(ctx.canvas.width, y);
	},
	drawHGuide: function(ctx, s, y) {
		_drawShape(this.hGuide, s, ctx, y);
	},

	crosshair: function(ctx, x, y, r) {
		ctx.save();
		ctx.translate(x, y);
		ctx.rotate(Math.PI / 4);
		ctx.beginPath();
		ctx.moveTo(0, -r);
		ctx.lineTo(0, r);
		ctx.moveTo(-r, 0);
		ctx.lineTo(r, 0);
		ctx.restore();
	},
	drawCrosshair: function(ctx, s, x, y, r) {
		_drawShape(this.crosshair, s, ctx, x, y, r);
	},

	circle: function(ctx, x, y, r) {
		ctx.beginPath();
		ctx.arc(x, y, r, 0, PI2);
	},
	drawCircle: function(ctx, s, x, y, r) {
		_drawShape(this.circle, s, ctx, x, y, r);
	},

	square: function(ctx, x, y, r) {
		r = Math.floor(r / 2) * 2;
		ctx.beginPath();
		ctx.rect(x - r, y - r, r * 2, r * 2);
	},
	drawSquare: function(ctx, s, x, y, r) {
		_drawShape(this.square, s, ctx, x, y, r);
	},

	arrowhead: function(ctx, x, y, r, t) {
		ctx.save();
		ctx.translate(x, y);
		ctx.rotate(t); // - Math.PI * 0.5);
		ctx.translate(r * 0.5, 0);
		ctx.beginPath();
		ctx.moveTo(0, 0);
		// ctx.lineTo(-r, r * Math.SQRT1_2);
		// ctx.lineTo(-r, -r * Math.SQRT1_2);
		ctx.lineTo(-r * Math.SQRT2, r * Math.SQRT1_2);
		ctx.arcTo(0, 0, -r * Math.SQRT2, -r * Math.SQRT1_2, r);
		// ctx.quadraticCurveTo(0, 0, -r * Math.SQRT2, -r * Math.SQRT1_2);
		ctx.lineTo(0, 0);
		ctx.closePath();
		ctx.restore();
	},
	drawArrowhead: function(ctx, s, x, y, r, t) {
		_drawShape(this.arrowhead, s, ctx, x, y, r, t);
	},

	rect: function(ctx, a1, a2, a3, a4) {

		ctx.beginPath();
		if (isNaN(a1)) {
			ctx.rect(a1.left, a1.top, a1.width, a1.height);
		} else {
			ctx.rect(a1, a2, a3, a4);
		}
	},
	drawRect: function(ctx, s, a1, a2, a3, a4) {
		_drawShape(this.rect, s, ctx, a1, a2, a3, a4);
	},
};
},{}],106:[function(require,module,exports){
/**
 * @module utils/canvas/calcArcHConnector
 */

module.exports = function(x1, y1, r1, x2, y2, r2, ro) {
	var qx = x2 > x1 ? 1 : -1;
	var qy = y2 > y1 ? 1 : -1;
	var dy = Math.abs(y2 - y1);
	var dx = Math.abs(x2 - x1);
	var rr = r1 + r2;
	var tx1, tx2, c, tx, ty;

	if (dy < 1) {
		// points are aligned horizontally, no arcs needed
		tx1 = 0;
		tx2 = dx
		// return [x1, x2];
	}

	if (dy >= rr && dx >= rr) {
		// arcs fit horizontally:
		// second circle center is r1+r2, tangent intersect at x=r1
		c = rr;
		tx1 = r1;
		tx2 = r1;
	} else {
		// arcs overlap horizontally:
		// find second circle center
		c = Math.sqrt(dy * r2 * 2 + dy * r1 * 2 - dy * dy);

		// circles tangent point
		tx = (c * r1) / rr;
		ty = (dy * r1) / rr;

		if (r1 < ty || c > dx) {
			return;
		}

		// tangent perpendicular slope
		var slope = (rr - dy) / c;
		// tangent intersections
		tx1 = tx - (ty * slope);
		tx2 = (dy * slope) + tx1;

		/*
		// circle centers
		var ccx1, ccy1, ccx2, ccy2;
		ccx1 = 0;
		ccy1 = r1;
		ccx2 = c;
		ccy2 = dy - r2;
		// tangent perpendicular slope
		var slope = (ccy1 - ccy2) / (ccx2 - ccx1);
		var xSec = tx - (ty * slope);
		// tangent intersections
		tx1 = xSec;
		tx2 = (dy * slope) + xSec;
		*/
	}

	// offset arcTo's in x-axis
	if (ro > 0) {
		if (ro > 1) {
			ro = Math.min(dx - rr, ro);
		} else {
			ro *= dx - rr;
		}
		tx1 += ro;
		tx2 += ro;
	}

	return [tx1 * qx + x1, tx2 * qx + x1, tx1, tx2];
};

/*
var drawArcConnector = function(ctx, x1, y1, x2, y2, r) {
	var dx, dy, hx, hy, gx, gy;

	hx = 0;
	hy = 0;
	gx = (x1 + x2) / 2;
	gy = (y1 + y2) / 2;
	dx = Math.abs(x1 - gx);
	dy = Math.abs(y1 - gy);

	if (dx < r && dy < r) {
		r = Math.min(dx * Math.SQRT1_2, dy * Math.SQRT1_2);
	} else {
		if (dx < r) {
			hy = Math.acos(dx / r) * r * 0.5;
			if (y1 > y2) hy *= -1;
		}
		if (dy < r) {
			hx = Math.acos(dy / r) * r * 0.5;
			if (x1 > x2) hx *= -1;
		}
	}
	ctx.arcTo(gx - hx, y1, gx + hx, y2, r);
	ctx.arcTo(gx + hx, y2, x2, y2, r);
};

var drawArcConnector2 = function(ctx, x1, y1, x2, y2, r) {
	var dx, dy, hx, hy, cx1, cx2;

	hx = 0;
	hy = 0;
	dx = Math.abs(x2 - x1) / 2;
	dy = Math.abs(y1 - y2) / 2;

	if (dx < r && dy < r) {
		r = Math.min(dx * Math.SQRT1_2, dy * Math.SQRT1_2);
	} else {
		if (dx < r) {
			hy = Math.acos(dx / r) * r;
		}
		if (dy < r) {
			hx = Math.acos(dy / r) * r;
		}
	}
	cx1 = x1 + dx;
	cx2 = x2 - (dx - hx / 2);
	ctx.arcTo(cx1, y1, cx2, y2, r);
	ctx.arcTo(cx2, y2, x2, y2, r);
};

var drawArcConnector1 = function(ctx, x1, y1, x2, y2, r) {
	var dx, dy, cx;

	dx = Math.abs(x2 - x1) / 2;
	dy = Math.abs(y1 - y2) / 2;
	r = Math.min(r, dy * Math.SQRT1_2);
	if (x1 < x2) {
		cx = x1 + dx + r;
	} else {
		cx = x2 - dx - r;
	}
	// cx = (x2 + x1) / 2;
	// cx += x1 < x2 ? r : -r;

	ctx.arcTo(cx, y1, cx, y2, r);
	ctx.arcTo(cx, y2, x2, y2, r);
};
*/

},{}],107:[function(require,module,exports){
(function (DEBUG){
/* global HTMLElement, CSSStyleDeclaration */

// var parseSize = require("./parseSize");

var CSS_BOX_PROPS = [
	"boxSizing", "position", "objectFit"
];
var CSS_EDGE_PROPS = [
	"marginTop", "marginBottom", "marginLeft", "marginRight",
	"borderTopWidth", "borderBottomWidth", "borderLeftWidth", "borderRightWidth",
	"paddingTop", "paddingBottom", "paddingLeft", "paddingRight",
];
var CSS_POS_PROPS = ["top", "bottom", "left", "right"];
var CSS_SIZE_PROPS = ["width", "height", "minWidth", "minHeight", "maxWidth", "maxHeight"];
var CSS_ALL_PROPS = CSS_EDGE_PROPS.concat(CSS_SIZE_PROPS, CSS_POS_PROPS);

// var COMPUTED_PROPS = [
// 	"clientLeft", "clientTop", "clientWidth", "clientHeight",
// 	"offsetLeft", "offsetTop", "offsetWidth", "offsetHeight"
// ];
// var o = _.pick(element, function(val) {
// 	return /^(offset|client)(Left|Top|Width|Height)/.test(val);
// });

var cssDimensionRE = /^(-?[\d\.]+)(px|em|rem)$/;
// var cssDimRe = /^([-\.0-9]+)([rem]+)$/;

module.exports = function(s, m, includeSizePos) {
	if (s instanceof HTMLElement) {
		s = getComputedStyle(s);
	}
	if (DEBUG) {
		if (!(s instanceof CSSStyleDeclaration)) {
			throw new Error("Not a CSSStyleDeclaration nor HTMLElement");
		}
	}
	var v, p, i, ii, emPx, remPx;
	m || (m = {});

	emPx = m.fontSize = parseFloat(s.fontSize);

	for (i = 0, ii = CSS_BOX_PROPS.length; i < ii; i++) {
		p = CSS_BOX_PROPS[i];
		if (p in s) {
			m[p] = s[p];
		}
	}
	var cssProps = includeSizePos ? CSS_EDGE_PROPS : CSS_ALL_PROPS;
	for (i = 0, ii = cssProps.length; i < ii; i++) {
		p = cssProps[i];
		m["_" + p] = s[p];
		if (s[p] && (v = cssDimensionRE.exec(s[p]))) {
			if (v[2] === "px") {
				m[p] = parseFloat(v[1]);
			} else if (v[2] === "em") {
				m[p] = parseFloat(v[1]) * emPx;
			} else if (v[2] === "rem") {
				remPx || (remPx = parseFloat(getComputedStyle(document.documentElement).fontSize));
				m[p] = parseFloat(v[1]) * remPx;
			} else {
				console.warn("Ignoring value", p, v[1], v[2]);
				m[p] = null;
			}
		} // else {
		//	console.warn("Ignoring unitless value", p, v);
		//}
	}
	return m;
};

}).call(this,true)

},{}],108:[function(require,module,exports){
/**
Returns a bounding rect for _el_ with absolute coordinates corrected for
scroll positions.

The native `getBoundingClientRect()` returns coordinates for an element's
visual position relative to the top left of the viewport, so if the element
is part of a scrollable region that has been scrolled, its coordinates will
be different than if the region hadn't been scrolled.

This method corrects for scroll offsets all the way up the node tree, so the
returned bounding rect will represent an absolute position on a virtual
canvas, regardless of scrolling.

@method getAbsoluteClientRect
@param {HTMLElement} el HTML element.
@return {Object} Absolute bounding rect for _el_.
**/

module.exports = function(el) {
	var doc = document,
		win = window,
		body = doc.body,

		// pageXOffset and pageYOffset work everywhere except IE <9.
		offsetX = win.pageXOffset !== undefined ? win.pageXOffset :
		(doc.documentElement || body.parentNode || body).scrollLeft,
		offsetY = win.pageYOffset !== undefined ? win.pageYOffset :
		(doc.documentElement || body.parentNode || body).scrollTop,

		rect = el.getBoundingClientRect();

	if (el !== body) {
		var parent = el.parentNode;

		// The element's rect will be affected by the scroll positions of
		// *all* of its scrollable parents, not just the window, so we have
		// to walk up the tree and collect every scroll offset. Good times.
		while (parent !== null && parent !== body) {
			offsetX += parent.scrollLeft;
			offsetY += parent.scrollTop;
			parent = parent.parentNode;
		}
	}

	return {
		_src: rect,
		bottom: rect.bottom + offsetY,
		height: rect.height,
		left: rect.left + offsetX,
		right: rect.right + offsetX,
		top: rect.top + offsetY,
		width: rect.width
	};
};
},{}],109:[function(require,module,exports){
/**
 * @param {number} i current iteration
 * @param {number} s start value
 * @param {number} d change in value
 * @param {number} t total iterations
 * @return {number}
 */
var linear = function(i, s, d, t) {
	return d * i / t + s;
};

module.exports = linear;

},{}],110:[function(require,module,exports){
/* https://html.spec.whatwg.org/multipage/media.html#event-media-canplay
 */
module.exports = [
	// networkState
	"loadstart",
	"progress",
	"suspend",
	"abort",
	"error",
	"emptied",
	"stalled",
	// readyState
	"loadedmetadata",
	"loadeddata",
	"canplay",
	"canplaythrough",
	"playing",
	"waiting",
	//
	"seeking", // seeking changed to true
	"seeked", // seeking changed to false
	"ended", // ended is true
	//
	"durationchange", // duration updated
	"timeupdate", // currentTime updated
	"play", // paused is false
	"pause", // paused is false
	"paused", // ??
	"ratechange",
	//
	"resize",
	"volumechange",
];
},{}],111:[function(require,module,exports){
/**
 * @module app/view/component/GraphView
 */

// /** @type {module:underscore} */
// var _ = require("underscore");

module.exports = function(rect, dx, dy) {
	dy || (dy = dx);
	var r = {
		width: rect.width + dx * 2,
		height: rect.height + dy * 2
	};
	if (r.width >= 0) {
		r.left = rect.left - dx;
		r.right = r.left + r.width;
		r.x = r.left;
	} else {
		r.right = rect.right + dx;
		r.left = rect.right - r.width;
		r.y = r.right;
	}
	if (r.height >= 0) {
		r.top = rect.top - dy;
		r.bottom = r.top + r.height;
		r.y = r.top;
	} else {
		r.bottom = rect.bottom + dy;
		r.top = rect.bottom - r.height;
		r.y = r.bottom;
	}

	return r;
};

},{}],112:[function(require,module,exports){
/** @type {Array} lowercase prefixes */
var lcPrefixes = [""].concat(require("./prefixes"));

/** @type {Array} capitalized prefixes */
var ucPrefixes = lcPrefixes.map(function(s) {
	return (s === "") ? s : s.charAt(0).toUpperCase() + s.substr(1);
});

/** @type {Object} specific event solvers */
var _solvers = {};

/** @type {Object} cached values */
var _cache = {};

/**
 * @param {String} name Unprefixed event name
 * @param {?Object} obj Prefix test target
 * @param {?String} testProp Proxy property to test prefixes
 * @return {String|null}
 */
var _prefixedEvent = function(name, obj, testProp) {
	var prefixes = /^[A-Z]/.test(name) ? ucPrefixes : lcPrefixes;
	obj || (obj = document);
	for (var i = 0; i < prefixes.length; i++) {
		if (testProp) {
			if ((prefixes[i] + testProp) in obj) {
				return prefixes[i] + name;
			}
		}
		if (("on" + prefixes[i] + name) in obj) {
			return prefixes[i] + name;
		}
	}
	return null;
};

// transitionend
_solvers["transitionend"] = function() {
	var prop, style = document.body.style,
		map = {
			"transition": "transitionend",
			"WebkitTransition": "webkitTransitionEnd",
			"MozTransition": "transitionend",
			// "msTransition" : "MSTransitionEnd",
			"OTransition": "oTransitionEnd"
		};
	for (prop in map) {
		if (prop in style) {
			return map[prop];
		}
	}
	return null;
};

/**
 * get the prefixed property
 * @param {String} property name
 * @param {Object} look-up object
 * @returns {String|null} prefixed
 */
module.exports = function(evName) {
	if (!_cache.hasOwnProperty(evName)) {
		_cache[evName] = _solvers.hasOwnProperty(evName) ? _solvers[evName]() : _prefixedEvent.apply(null, arguments);
		if (_cache[evName] === null) {
			console.warn("Event '%s' not found", evName);
		} else {
			console.log("Event '%s' found as '%s'", evName, _cache[evName]);
		}
	}
	return _cache[evName];
	// return _cache[evName] || (_cache[evName] = _solvers[evName]? _solvers[evName].call() : _prefixedProperty.apply(null, arguments));
};

/*
var defaultTest = function(name, obj) {
	var prefixes = /^[A-Z]/.test(name)? ucPrefixes : lcPrefixes;
	for (var i = 0; i < prefixes.length; i++) {
		if (("on" + prefixes[i] + name) in obj) {
			console.log("Event '%s' found as '%s'", name, prefixes[i] + name);
			return prefixes[i] + name;
		}
	}
	return null;
};

var proxyTest = function(name, obj, testProp) {
	var prefixes = /^[A-Z]/.test(name)? ucPrefixes : lcPrefixes;
	for (var i = 0; i < prefixes.length; i++) {
		if ((prefixes[i] + testProp) in obj) {
			console.log("Event %s inferred as '%s' from property '%s'", name, prefixes[i] + name, testProp);
			return prefixes[i] + name;
		}
	}
	return null;
};
*/

},{"./prefixes":115}],113:[function(require,module,exports){
/**
/* @module utils/prefixedProperty
/*/

/** @type {module:utils/prefixes} */
var prefixes = require("./prefixes");
/** @type {Number} prefix count */
var _prefixNum = prefixes.length;
/** @type {Array} cached values */
var _cache = {};

var _prefixedProperty = function(prop, obj) {
	var prefixedProp, camelProp;

	if (prop in obj) {
		console.log("Property '%s' found unprefixed", prop);
		return prop;
	}
	camelProp = prop[0].toUpperCase() + prop.slice(1);
	for (var i = 0; i < _prefixNum; i++) {
		prefixedProp = prefixes[i] + camelProp;
		if (prefixedProp in obj) {
			console.log("Property '%s' found as '%s'", prop, prefixedProp);
			return prefixedProp;
		}
	}
	console.error("Property '%s' not found", prop);
	return null;
};

/**
 * get the prefixed property
 * @param {String} property name
 * @param {Object} look-up object
 * @returns {String|null} prefixed
 */
module.exports = function(prop, obj) {
	return _cache[prop] || (_cache[prop] = _prefixedProperty(prop, obj || document.body.style));
};

},{"./prefixes":115}],114:[function(require,module,exports){
/**
/* @module utils/prefixedStyleName
/*/

/** @type {module:utils/prefixes} */
var prefixes = require("./prefixes"); //.map(function(prefix) { return "-" + prefix + "-"; });
/** @type {Number} prefix count */
var _prefixNum = prefixes.length;
/** @type {Array} cached values */
var _cache = {};

var _prefixedStyleName = function(style, styleObj) {
	var prefixedStyle;

	if (style in styleObj) {
		console.log("CSS style '%s' found unprefixed", style);
		return style;
	}
	for (var i = 0; i < _prefixNum; i++) {
		prefixedStyle = "-" + prefixes[i] + "-" + style;
		// prefixedStyle = prefixes[i] + style;
		if (prefixedStyle in styleObj) {
			console.log("CSS style '%s' found as '%s'", style, prefixedStyle);
			return prefixedStyle;
		}
	}
	console.warn("CSS style '%s' not found", style);
	return null;
};

/**
 * get the prefixed style name
 * @param {String} style name
 * @param {Object} look-up style object
 * @returns {String|Undefined} prefixed
 */
module.exports = function(style, styleObj) {
	// return _cache[style] || (_cache[style] = _prefixedStyleName_reverse(style, styleObj || document.body.style));
	return _cache[style] || (_cache[style] = _prefixedStyleName(style, styleObj || document.body.style));
};

// /** @type {module:utils/strings/camelToDashed} */
// var camelToDashed = require("./strings/camelToDashed");
// /** @type {module:utils/prefixedProperty} */
// var prefixedProperty = require("./prefixedProperty");
// /** @type {module:utils/strings/dashedToCamel} */
// var dashedToCamel = require("./strings/dashedToCamel");
//
// var _prefixedStyleName_reverse = function (style, styleObj) {
// 	var camelProp, prefixedProp;
// 	camelProp = dashedToCamel(style);
// 	prefixedProp = prefixedProperty(camelProp, styleObj);
// 	return prefixedProp? (camelProp === prefixedProp? "" : "-") + camelToDashed(prefixedProp) : null;
// };

},{"./prefixes":115}],115:[function(require,module,exports){
module.exports = ["webkit", "moz", "ms", "o"];

},{}],116:[function(require,module,exports){
/* jshint ignore:start */
/*
Taken from:
https://github.com/webcomponents/webcomponentsjs/blob/master/src/MutationObserver/MutationObserver.js
*/
/*
 * @license
 * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */

var setImmediate;

// As much as we would like to use the native implementation, IE
// (all versions) suffers a rather annoying bug where it will drop or defer
// callbacks when heavy DOM operations are being performed concurrently.
//
// For a thorough discussion on this, see:
// http://codeforhire.com/2013/09/21/setimmediate-and-messagechannel-broken-on-internet-explorer-10/
if (/Trident|Edge/.test(navigator.userAgent)) {
	// Sadly, this bug also affects postMessage and MessageQueues.
	//
	// We would like to use the onreadystatechange hack for IE <= 10, but it is
	// dangerous in the polyfilled environment due to requiring that the
	// observed script element be in the document.
	setImmediate = setTimeout;

	// If some other browser ever implements it, let's prefer their native
	// implementation:
} else if (window.setImmediate) {
	setImmediate = window.setImmediate;

	// Otherwise, we fall back to postMessage as a means of emulating the next
	// task semantics of setImmediate.
} else {
	var setImmediateQueue = [];
	var sentinel = String(Math.random());
	window.addEventListener("message", function(e) {
		if (e.data === sentinel) {
			var queue = setImmediateQueue;
			setImmediateQueue = [];
			queue.forEach(function(func) {
				func();
			});
		}
	});
	setImmediate = function(func) {
		setImmediateQueue.push(func);
		window.postMessage(sentinel, "*");
	};
}

module.exports = setImmediate;
/* jshint ignore:end */

},{}],117:[function(require,module,exports){
module.exports = function(str) {
	return str.replace(/[A-Z]/g, function($0) {
		return "-" + $0.toLowerCase();
	});
};

},{}],118:[function(require,module,exports){
module.exports = function(s) {
	return s.replace(/<[^>]+>/g, "");
};

},{}],119:[function(require,module,exports){
/** @type {module:hammerjs} */
var Hammer = require("hammerjs");

// /**
//  * get a usable string, used as event postfix
//  * @param {Const} state
//  * @returns {String} state
//  */
// function stateStr(state) {
// 	if (state & Hammer.STATE_CANCELLED) {
// 		return "cancel";
// 	} else if (state & Hammer.STATE_ENDED) {
// 		return "end";
// 	} else if (state & Hammer.STATE_CHANGED) {
// 		return "move";
// 	} else if (state & Hammer.STATE_BEGAN) {
// 		return "start";
// 	}
// 	return "";
// }

/**
 * direction cons to string
 * @param {Const} direction
 * @returns {String}
 */
function dirStr(direction) {
	if (direction == Hammer.DIRECTION_DOWN) {
		return "down";
	} else if (direction == Hammer.DIRECTION_UP) {
		return "up";
	} else if (direction == Hammer.DIRECTION_LEFT) {
		return "left";
	} else if (direction == Hammer.DIRECTION_RIGHT) {
		return "right";
	}
	return "";
}

///**
// * Pan
// * Recognized when the pointer is down and moved in the allowed direction.
// * @constructor
// * @extends AttrRecognizer
// */
//function PanRecognizer() {
//	Hammer.AttrRecognizer.apply(this, arguments);
//
//	this.pX = null;
//	this.pY = null;
//}
//
//inherit(PanRecognizer, Hammer.AttrRecognizer, {
//	/**
//	/* @namespace
//	/* @memberof PanRecognizer
//	/*/
//	defaults: {
//		event: "pan",
//		threshold: 10,
//		pointers: 1,
//		direction: DIRECTION_ALL
//	},
//
//	getTouchAction: function() {
//		var direction = this.options.direction;
//		var actions = [];
//		if (direction & DIRECTION_HORIZONTAL) {
//			actions.push(TOUCH_ACTION_PAN_Y);
//		}
//		if (direction & DIRECTION_VERTICAL) {
//			actions.push(TOUCH_ACTION_PAN_X);
//		}
//		return actions;
//	},
//
//	directionTest: function(input) {
//		var options = this.options;
//		var hasMoved = true;
//		var distance = input.distance;
//		var direction = input.direction;
//		var x = input.deltaX;
//		var y = input.deltaY;
//
//		// lock to axis?
//		if (!(direction & options.direction)) {
//			if (options.direction & DIRECTION_HORIZONTAL) {
//				direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;
//				hasMoved = x != this.pX;
//				distance = Math.abs(input.deltaX);
//			} else {
//				direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;
//				hasMoved = y != this.pY;
//				distance = Math.abs(input.deltaY);
//			}
//		}
//		input.direction = direction;
//		return hasMoved && distance > options.threshold && direction & options.direction;
//	},
//
//	attrTest: function(input) {
//		return AttrRecognizer.prototype.attrTest.call(this, input) &&
//			(this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));
//	},
//
//	emit: function(input) {
//		this.pX = input.deltaX;
//		this.pY = input.deltaY;
//
//		var direction = dirStr(input.direction);
//		if (direction) {
//			this.manager.emit(this.options.event + direction, input);
//		}
//
//		this._super.emit.call(this, input);
//	}
//});

/**
 * SmoothPan
 * @constructor
 * @extends Hammer.Pan
 */
function SmoothPan() {
	var ret = Hammer.Pan.apply(this, arguments);
	this.thresholdOffsetX = null;
	this.thresholdOffsetY = null;
	this.thresholdOffset = null;
	return ret;
}

Hammer.inherit(SmoothPan, Hammer.Pan, {
	emit: function(input) {
		// Inheritance breaks, so this code is taken from PanRecognizer.emit
		//	this._super.emit.call(this, input); // Triggers infinite recursion
		//	Hammer.Pan.prototype.emit.apply(this, arguments); // This breaks too

		var threshold = this.options.threshold;
		var direction = input.direction;

		if (this.state == Hammer.STATE_BEGAN) {
			this.thresholdOffsetX = (direction & Hammer.DIRECTION_HORIZONTAL) ? ((direction & Hammer.DIRECTION_LEFT) ? threshold : -threshold) : 0;
			this.thresholdOffsetY = (direction & Hammer.DIRECTION_VERTICAL) ? ((direction & Hammer.DIRECTION_UP) ? threshold : -threshold) : 0;
			// this.thresholdOffset = (direction & Hammer.DIRECTION_HORIZONTAL)? input.thresholdOffsetX : input.thresholdOffsetY;
			// console.log("RECOGNIZER STATE", dirStr(direction), stateStr(this.state), this.thresholdOffsetX);
		}
		input.thresholdOffsetX = this.thresholdOffsetX;
		input.thresholdOffsetY = this.thresholdOffsetY;
		input.thresholdDeltaX = input.deltaX + this.thresholdOffsetX;
		input.thresholdDeltaY = input.deltaY + this.thresholdOffsetY;

		this.pX = input.deltaX;
		this.pY = input.deltaY;

		direction = dirStr(direction);
		if (direction) {
			this.manager.emit(this.options.event + direction, input);
		}
		return Hammer.Recognizer.prototype.emit.apply(this, arguments);
	}
});

module.exports = SmoothPan;

},{"hammerjs":"hammerjs"}],120:[function(require,module,exports){
module.exports={
	"units": {
		"hu_px": "20",
		"vu_px": "12"
	},
	"transitions": {
		"min_delay_ms": "34",
		"delay_interval_ms": "134",
		"duration_ms": "400",
		"ease": "ease"
	},
	"breakpoints": {
		"fullwidth-small": "'not screen and (min-width: 460px)'",
		"fullwidth": "'not screen and (min-width: 704px), not screen and (min-height: 540px)'",
		"desktop-small": "'only screen and (min-width: 1024px) and (min-height: 540px)'",
		"desktop-medium": "'only screen and (min-width: 1224px) and (min-height: 704px)'",
		"desktop-large": "'only screen and (min-width: 1824px) and (min-height: 1024px)'"
	},
	"default_colors": {
		"color": "hsl(47, 5%, 15%)",
		"background-color": "hsl(47, 5%, 95%)",
		"--link-color": "hsl(10, 80%, 50%)"
	},
	"temp": {
		"collapse_offset": "360"
	},
	"_ignore": {

		"breakpoints": {
			"mobile": "'not screen and (min-width: 704px), not screen and (min-height: 540px)'",
			"unsupported": "'not screen and (min-width: 704px)'",
			"unquoted": "only screen and (min-width: 1824px)",
			"unquoted_neg": "not screen and (min-width: 704px)",
			"quoted_combined": "'not screen and (min-width: 704px), not screen and (min-height: 540px)'",
			"array": [
				"only screen and (min-width: 704px)",
				"not screen and (min-width: 704px)",
				"not screen and (min-height: 540px)"
			]
		},
		"default_colors": {
			"--alt-background-color": "unset"
		}
	}
}

},{}]},{},[32])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMucnVudGltZS5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2Jhc2UuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9kZWNvcmF0b3JzLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvZGVjb3JhdG9ycy9pbmxpbmUuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9leGNlcHRpb24uanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9oZWxwZXJzLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvaGVscGVycy9ibG9jay1oZWxwZXItbWlzc2luZy5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2hlbHBlcnMvZWFjaC5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2hlbHBlcnMvaGVscGVyLW1pc3NpbmcuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9oZWxwZXJzL2lmLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvaGVscGVycy9sb2cuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9oZWxwZXJzL2xvb2t1cC5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2hlbHBlcnMvd2l0aC5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2xpYi9oYW5kbGViYXJzL2xvZ2dlci5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL2Rpc3QvY2pzL2hhbmRsZWJhcnMvbm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvbm8tY29uZmxpY3QuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy9ydW50aW1lLmpzIiwibm9kZV9tb2R1bGVzL2hhbmRsZWJhcnMvbGliL2hhbmRsZWJhcnMvc2FmZS1zdHJpbmcuanMiLCJub2RlX21vZHVsZXMvaGFuZGxlYmFycy9saWIvaGFuZGxlYmFycy91dGlscy5qcyIsIm5vZGVfbW9kdWxlcy9oYW5kbGViYXJzL3J1bnRpbWUuanMiLCJub2RlX21vZHVsZXMvaGJzZnkvcnVudGltZS5qcyIsIm5vZGVfbW9kdWxlcy9zZXRpbW1lZGlhdGUvc2V0SW1tZWRpYXRlLmpzIiwibm9kZV9tb2R1bGVzL3VuZGVyc2NvcmUuc3RyaW5nL2Rhc2hlcml6ZS5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy9oZWxwZXIvZGVmYXVsdFRvV2hpdGVTcGFjZS5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy9oZWxwZXIvZXNjYXBlUmVnRXhwLmpzIiwibm9kZV9tb2R1bGVzL3VuZGVyc2NvcmUuc3RyaW5nL2hlbHBlci9tYWtlU3RyaW5nLmpzIiwibm9kZV9tb2R1bGVzL3VuZGVyc2NvcmUuc3RyaW5nL2hlbHBlci9zdHJSZXBlYXQuanMiLCJub2RlX21vZHVsZXMvdW5kZXJzY29yZS5zdHJpbmcvbHBhZC5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy9wYWQuanMiLCJub2RlX21vZHVsZXMvdW5kZXJzY29yZS5zdHJpbmcvcnBhZC5qcyIsIm5vZGVfbW9kdWxlcy91bmRlcnNjb3JlLnN0cmluZy90cmltLmpzIiwic3JjL2pzL2FwcC9BcHAuanMiLCJzcmMvanMvYXBwL2NvbnRyb2wvQ29udHJvbGxlci5qcyIsInNyYy9qcy9hcHAvY29udHJvbC9HbG9iYWxzLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9BcHBTdGF0ZS5qcyIsInNyYy9qcy9hcHAvbW9kZWwvQmFzZUl0ZW0uanMiLCJzcmMvanMvYXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9uLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9uLmpzIiwic3JjL2pzL2FwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb24uanMiLCJzcmMvanMvYXBwL21vZGVsL2NvbGxlY3Rpb24vS2V5d29yZENvbGxlY3Rpb24uanMiLCJzcmMvanMvYXBwL21vZGVsL2NvbGxlY3Rpb24vVHlwZUNvbGxlY3Rpb24uanMiLCJzcmMvanMvYXBwL21vZGVsL2hlbHBlci9ib290c3RyYXAuanMiLCJzcmMvanMvYXBwL21vZGVsL2l0ZW0vQXJ0aWNsZUl0ZW0uanMiLCJzcmMvanMvYXBwL21vZGVsL2l0ZW0vQnVuZGxlSXRlbS5qcyIsInNyYy9qcy9hcHAvbW9kZWwvaXRlbS9LZXl3b3JkSXRlbS5qcyIsInNyYy9qcy9hcHAvbW9kZWwvaXRlbS9NZWRpYUl0ZW0uanMiLCJzcmMvanMvYXBwL21vZGVsL2l0ZW0vU291cmNlSXRlbS5qcyIsInNyYy9qcy9hcHAvbW9kZWwvaXRlbS9UeXBlSXRlbS5qcyIsInNyYy9qcy9hcHAvdmlldy9BcHBWaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L0NvbnRlbnRWaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L0RlYnVnVG9vbGJhci5qcyIsInNyYy9qcy9hcHAvdmlldy9OYXZpZ2F0aW9uVmlldy5qcyIsInNyYy9qcy9hcHAvdmlldy9iYXNlL0NhbnZhc1ZpZXcuanMiLCJzcmMvanMvYXBwL3ZpZXcvYmFzZS9GcmFtZVF1ZXVlLmpzIiwic3JjL2pzL2FwcC92aWV3L2Jhc2UvSW50ZXJwb2xhdG9yLmpzIiwic3JjL2pzL2FwcC92aWV3L2Jhc2UvUHJlZml4ZWRFdmVudHMuanMiLCJzcmMvanMvYXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvYmFzZS9WaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L2Jhc2UvVmlld0Vycm9yLmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9BcnRpY2xlQnV0dG9uLmhicyIsInNyYy9qcy9hcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZUJ1dHRvbi5qcyIsInNyYy9qcy9hcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZVZpZXcuanMiLCJzcmMvanMvYXBwL3ZpZXcvY29tcG9uZW50L0Nhcm91c2VsLmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uU3RhY2suaGJzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uU3RhY2suanMiLCJzcmMvanMvYXBwL3ZpZXcvY29tcG9uZW50L0ZpbHRlcmFibGVMaXN0Vmlldy5qcyIsInNyYy9qcy9hcHAvdmlldy9jb21wb25lbnQvR3JhcGhWaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Hcm91cGluZ0xpc3RWaWV3LmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyLmpzIiwic3JjL2pzL2FwcC92aWV3L2NvbXBvbmVudC9TZWxlY3RhYmxlTGlzdFZpZXcuanMiLCJzcmMvanMvYXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL0NhbnZhc1Byb2dyZXNzTWV0ZXIzLmpzIiwic3JjL2pzL2FwcC92aWV3L2hlbHBlci9jcmVhdGVDb2xvclN0eWxlU2hlZXQuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS9fbG9hZEltYWdlQXNPYmplY3RVUkwuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS9fd2hlbkltYWdlTG9hZHMuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS93aGVuRGVmYXVsdEltYWdlTG9hZHMuanMiLCJzcmMvanMvYXBwL3ZpZXcvcHJvbWlzZS93aGVuU2Nyb2xsaW5nRW5kcy5qcyIsInNyYy9qcy9hcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3Rpb25EaXN0YW5jZUlzLmpzIiwic3JjL2pzL2FwcC92aWV3L3Byb21pc2Uvd2hlblNlbGVjdGlvbklzQ29udGlndW91cy5qcyIsInNyYy9qcy9hcHAvdmlldy9wcm9taXNlL3doZW5WaWV3SXNBdHRhY2hlZC5qcyIsInNyYy9qcy9hcHAvdmlldy9wcm9taXNlL3doZW5WaWV3SXNSZW5kZXJlZC5qcyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvQ2Fyb3VzZWxSZW5kZXJlci5qcyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvcmVuZGVyL0RlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXIuaGJzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9EZWZhdWx0U2VsZWN0YWJsZVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9Eb3ROYXZpZ2F0aW9uUmVuZGVyZXIuaGJzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9Eb3ROYXZpZ2F0aW9uUmVuZGVyZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvcmVuZGVyL0ltYWdlUmVuZGVyZXIuaGJzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9JbWFnZVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9MYWJlbFJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9NZWRpYVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9QbGF5YWJsZVJlbmRlcmVyLmpzIiwic3JjL2pzL2FwcC92aWV3L3JlbmRlci9TZXF1ZW5jZVJlbmRlcmVyLmhicyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlci5qcyIsInNyYy9qcy9hcHAvdmlldy9yZW5kZXIvVmlkZW9SZW5kZXJlci5oYnMiLCJzcmMvanMvYXBwL3ZpZXcvcmVuZGVyL1ZpZGVvUmVuZGVyZXIuanMiLCJzcmMvanMvYXBwL3ZpZXcvdGVtcGxhdGUvQ2Fyb3VzZWwuRW1wdHlSZW5kZXJlci5CdW5kbGUuaGJzIiwic3JjL2pzL2FwcC92aWV3L3RlbXBsYXRlL0NvbGxlY3Rpb25TdGFjay5NZWRpYS5oYnMiLCJzcmMvanMvYXBwL3ZpZXcvdGVtcGxhdGUvRGVidWdUb29sYmFyLlNWR0dyaWQuaGJzIiwic3JjL2pzL2FwcC92aWV3L3RlbXBsYXRlL0RlYnVnVG9vbGJhci5oYnMiLCJzcmMvanMvYXBwL3ZpZXcvdGVtcGxhdGUvRXJyb3JCbG9jay5oYnMiLCJzcmMvanMvYXBwL3ZpZXcvdGVtcGxhdGUvX2hlbHBlcnMuanMiLCJzcmMvanMvdXRpbHMvVGltZXIuanMiLCJzcmMvanMvdXRpbHMvVHJhbnNmb3JtSGVscGVyLmpzIiwic3JjL2pzL3V0aWxzL1RyYW5zZm9ybUl0ZW0uanMiLCJzcmMvanMvdXRpbHMvY2FudmFzL0NhbnZhc0hlbHBlci5qcyIsInNyYy9qcy91dGlscy9jYW52YXMvY2FsY0FyY0hDb25uZWN0b3IuanMiLCJzcmMvanMvdXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXMuanMiLCJzcmMvanMvdXRpbHMvZG9tL2dldEFic29sdXRlQ2xpZW50UmVjdC5qcyIsInNyYy9qcy91dGlscy9lYXNlL2xpbmVhci5qcyIsInNyYy9qcy91dGlscy9ldmVudC9tZWRpYUV2ZW50c0VudW0uanMiLCJzcmMvanMvdXRpbHMvZ2VvbS9pbmZsYXRlUmVjdC5qcyIsInNyYy9qcy91dGlscy9wcmVmaXhlZEV2ZW50LmpzIiwic3JjL2pzL3V0aWxzL3ByZWZpeGVkUHJvcGVydHkuanMiLCJzcmMvanMvdXRpbHMvcHJlZml4ZWRTdHlsZU5hbWUuanMiLCJzcmMvanMvdXRpbHMvcHJlZml4ZXMuanMiLCJzcmMvanMvdXRpbHMvc2V0SW1tZWRpYXRlLmpzIiwic3JjL2pzL3V0aWxzL3N0cmluZ3MvY2FtZWxUb0Rhc2hlZC5qcyIsInNyYy9qcy91dGlscy9zdHJpbmdzL3N0cmlwVGFncy5qcyIsInNyYy9qcy91dGlscy90b3VjaC9TbW9vdGhQYW5SZWNvZ25pemVyLmpzIiwic3JjL3Nhc3MvdmFyaWFibGVzLmpzb24iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7OzhCQzNGc0IsbUJBQW1COztJQUE3QixJQUFJOzs7OztvQ0FJTywwQkFBMEI7Ozs7bUNBQzNCLHdCQUF3Qjs7OzsrQkFDdkIsb0JBQW9COztJQUEvQixLQUFLOztpQ0FDUSxzQkFBc0I7O0lBQW5DLE9BQU87O29DQUVJLDBCQUEwQjs7Ozs7QUFHakQsU0FBUyxNQUFNLEdBQUc7QUFDaEIsTUFBSSxFQUFFLEdBQUcsSUFBSSxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQzs7QUFFMUMsT0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDdkIsSUFBRSxDQUFDLFVBQVUsb0NBQWEsQ0FBQztBQUMzQixJQUFFLENBQUMsU0FBUyxtQ0FBWSxDQUFDO0FBQ3pCLElBQUUsQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO0FBQ2pCLElBQUUsQ0FBQyxnQkFBZ0IsR0FBRyxLQUFLLENBQUMsZ0JBQWdCLENBQUM7O0FBRTdDLElBQUUsQ0FBQyxFQUFFLEdBQUcsT0FBTyxDQUFDO0FBQ2hCLElBQUUsQ0FBQyxRQUFRLEdBQUcsVUFBUyxJQUFJLEVBQUU7QUFDM0IsV0FBTyxPQUFPLENBQUMsUUFBUSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQztHQUNuQyxDQUFDOztBQUVGLFNBQU8sRUFBRSxDQUFDO0NBQ1g7O0FBRUQsSUFBSSxJQUFJLEdBQUcsTUFBTSxFQUFFLENBQUM7QUFDcEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7O0FBRXJCLGtDQUFXLElBQUksQ0FBQyxDQUFDOztBQUVqQixJQUFJLENBQUMsU0FBUyxDQUFDLEdBQUcsSUFBSSxDQUFDOztxQkFFUixJQUFJOzs7Ozs7Ozs7Ozs7O3FCQ3BDeUIsU0FBUzs7eUJBQy9CLGFBQWE7Ozs7dUJBQ0UsV0FBVzs7MEJBQ1IsY0FBYzs7c0JBQ25DLFVBQVU7Ozs7QUFFdEIsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDOztBQUN4QixJQUFNLGlCQUFpQixHQUFHLENBQUMsQ0FBQzs7O0FBRTVCLElBQU0sZ0JBQWdCLEdBQUc7QUFDOUIsR0FBQyxFQUFFLGFBQWE7QUFDaEIsR0FBQyxFQUFFLGVBQWU7QUFDbEIsR0FBQyxFQUFFLGVBQWU7QUFDbEIsR0FBQyxFQUFFLFVBQVU7QUFDYixHQUFDLEVBQUUsa0JBQWtCO0FBQ3JCLEdBQUMsRUFBRSxpQkFBaUI7QUFDcEIsR0FBQyxFQUFFLFVBQVU7Q0FDZCxDQUFDOzs7QUFFRixJQUFNLFVBQVUsR0FBRyxpQkFBaUIsQ0FBQzs7QUFFOUIsU0FBUyxxQkFBcUIsQ0FBQyxPQUFPLEVBQUUsUUFBUSxFQUFFLFVBQVUsRUFBRTtBQUNuRSxNQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sSUFBSSxFQUFFLENBQUM7QUFDN0IsTUFBSSxDQUFDLFFBQVEsR0FBRyxRQUFRLElBQUksRUFBRSxDQUFDO0FBQy9CLE1BQUksQ0FBQyxVQUFVLEdBQUcsVUFBVSxJQUFJLEVBQUUsQ0FBQzs7QUFFbkMsa0NBQXVCLElBQUksQ0FBQyxDQUFDO0FBQzdCLHdDQUEwQixJQUFJLENBQUMsQ0FBQztDQUNqQzs7QUFFRCxxQkFBcUIsQ0FBQyxTQUFTLEdBQUc7QUFDaEMsYUFBVyxFQUFFLHFCQUFxQjs7QUFFbEMsUUFBTSxxQkFBUTtBQUNkLEtBQUcsRUFBRSxvQkFBTyxHQUFHOztBQUVmLGdCQUFjLEVBQUUsd0JBQVMsSUFBSSxFQUFFLEVBQUUsRUFBRTtBQUNqQyxRQUFJLGdCQUFTLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxVQUFVLEVBQUU7QUFDdEMsVUFBSSxFQUFFLEVBQUU7QUFBRSxjQUFNLDJCQUFjLHlDQUF5QyxDQUFDLENBQUM7T0FBRTtBQUMzRSxvQkFBTyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQzVCLE1BQU07QUFDTCxVQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztLQUN6QjtHQUNGO0FBQ0Qsa0JBQWdCLEVBQUUsMEJBQVMsSUFBSSxFQUFFO0FBQy9CLFdBQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztHQUMzQjs7QUFFRCxpQkFBZSxFQUFFLHlCQUFTLElBQUksRUFBRSxPQUFPLEVBQUU7QUFDdkMsUUFBSSxnQkFBUyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssVUFBVSxFQUFFO0FBQ3RDLG9CQUFPLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7S0FDN0IsTUFBTTtBQUNMLFVBQUksT0FBTyxPQUFPLEtBQUssV0FBVyxFQUFFO0FBQ2xDLGNBQU0seUVBQTBELElBQUksb0JBQWlCLENBQUM7T0FDdkY7QUFDRCxVQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxHQUFHLE9BQU8sQ0FBQztLQUMvQjtHQUNGO0FBQ0QsbUJBQWlCLEVBQUUsMkJBQVMsSUFBSSxFQUFFO0FBQ2hDLFdBQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztHQUM1Qjs7QUFFRCxtQkFBaUIsRUFBRSwyQkFBUyxJQUFJLEVBQUUsRUFBRSxFQUFFO0FBQ3BDLFFBQUksZ0JBQVMsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLFVBQVUsRUFBRTtBQUN0QyxVQUFJLEVBQUUsRUFBRTtBQUFFLGNBQU0sMkJBQWMsNENBQTRDLENBQUMsQ0FBQztPQUFFO0FBQzlFLG9CQUFPLElBQUksQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLENBQUM7S0FDL0IsTUFBTTtBQUNMLFVBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO0tBQzVCO0dBQ0Y7QUFDRCxxQkFBbUIsRUFBRSw2QkFBUyxJQUFJLEVBQUU7QUFDbEMsV0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxDQUFDO0dBQzlCO0NBQ0YsQ0FBQzs7QUFFSyxJQUFJLEdBQUcsR0FBRyxvQkFBTyxHQUFHLENBQUM7OztRQUVwQixXQUFXO1FBQUUsTUFBTTs7Ozs7Ozs7Ozs7O2dDQzdFQSxxQkFBcUI7Ozs7QUFFekMsU0FBUyx5QkFBeUIsQ0FBQyxRQUFRLEVBQUU7QUFDbEQsZ0NBQWUsUUFBUSxDQUFDLENBQUM7Q0FDMUI7Ozs7Ozs7O3FCQ0pvQixVQUFVOztxQkFFaEIsVUFBUyxRQUFRLEVBQUU7QUFDaEMsVUFBUSxDQUFDLGlCQUFpQixDQUFDLFFBQVEsRUFBRSxVQUFTLEVBQUUsRUFBRSxLQUFLLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRTtBQUMzRSxRQUFJLEdBQUcsR0FBRyxFQUFFLENBQUM7QUFDYixRQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsRUFBRTtBQUNuQixXQUFLLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQztBQUNwQixTQUFHLEdBQUcsVUFBUyxPQUFPLEVBQUUsT0FBTyxFQUFFOztBQUUvQixZQUFJLFFBQVEsR0FBRyxTQUFTLENBQUMsUUFBUSxDQUFDO0FBQ2xDLGlCQUFTLENBQUMsUUFBUSxHQUFHLGNBQU8sRUFBRSxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDMUQsWUFBSSxHQUFHLEdBQUcsRUFBRSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztBQUMvQixpQkFBUyxDQUFDLFFBQVEsR0FBRyxRQUFRLENBQUM7QUFDOUIsZUFBTyxHQUFHLENBQUM7T0FDWixDQUFDO0tBQ0g7O0FBRUQsU0FBSyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQzs7QUFFN0MsV0FBTyxHQUFHLENBQUM7R0FDWixDQUFDLENBQUM7Q0FDSjs7Ozs7Ozs7OztBQ3BCRCxJQUFNLFVBQVUsR0FBRyxDQUFDLGFBQWEsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLE9BQU8sQ0FBQyxDQUFDOztBQUVuRyxTQUFTLFNBQVMsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFO0FBQ2hDLE1BQUksR0FBRyxHQUFHLElBQUksSUFBSSxJQUFJLENBQUMsR0FBRztNQUN0QixJQUFJLFlBQUE7TUFDSixNQUFNLFlBQUEsQ0FBQztBQUNYLE1BQUksR0FBRyxFQUFFO0FBQ1AsUUFBSSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO0FBQ3RCLFVBQU0sR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQzs7QUFFMUIsV0FBTyxJQUFJLEtBQUssR0FBRyxJQUFJLEdBQUcsR0FBRyxHQUFHLE1BQU0sQ0FBQztHQUN4Qzs7QUFFRCxNQUFJLEdBQUcsR0FBRyxLQUFLLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLE9BQU8sQ0FBQyxDQUFDOzs7QUFHMUQsT0FBSyxJQUFJLEdBQUcsR0FBRyxDQUFDLEVBQUUsR0FBRyxHQUFHLFVBQVUsQ0FBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLEVBQUU7QUFDaEQsUUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztHQUM5Qzs7O0FBR0QsTUFBSSxLQUFLLENBQUMsaUJBQWlCLEVBQUU7QUFDM0IsU0FBSyxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxTQUFTLENBQUMsQ0FBQztHQUMxQzs7QUFFRCxNQUFJLEdBQUcsRUFBRTtBQUNQLFFBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO0FBQ3ZCLFFBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0dBQ3RCO0NBQ0Y7O0FBRUQsU0FBUyxDQUFDLFNBQVMsR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFDOztxQkFFbkIsU0FBUzs7Ozs7Ozs7Ozs7Ozt5Q0NsQ2UsZ0NBQWdDOzs7OzJCQUM5QyxnQkFBZ0I7Ozs7b0NBQ1AsMEJBQTBCOzs7O3lCQUNyQyxjQUFjOzs7OzBCQUNiLGVBQWU7Ozs7NkJBQ1osa0JBQWtCOzs7OzJCQUNwQixnQkFBZ0I7Ozs7QUFFbEMsU0FBUyxzQkFBc0IsQ0FBQyxRQUFRLEVBQUU7QUFDL0MseUNBQTJCLFFBQVEsQ0FBQyxDQUFDO0FBQ3JDLDJCQUFhLFFBQVEsQ0FBQyxDQUFDO0FBQ3ZCLG9DQUFzQixRQUFRLENBQUMsQ0FBQztBQUNoQyx5QkFBVyxRQUFRLENBQUMsQ0FBQztBQUNyQiwwQkFBWSxRQUFRLENBQUMsQ0FBQztBQUN0Qiw2QkFBZSxRQUFRLENBQUMsQ0FBQztBQUN6QiwyQkFBYSxRQUFRLENBQUMsQ0FBQztDQUN4Qjs7Ozs7Ozs7cUJDaEJxRCxVQUFVOztxQkFFakQsVUFBUyxRQUFRLEVBQUU7QUFDaEMsVUFBUSxDQUFDLGNBQWMsQ0FBQyxvQkFBb0IsRUFBRSxVQUFTLE9BQU8sRUFBRSxPQUFPLEVBQUU7QUFDdkUsUUFBSSxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU87UUFDekIsRUFBRSxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUM7O0FBRXBCLFFBQUksT0FBTyxLQUFLLElBQUksRUFBRTtBQUNwQixhQUFPLEVBQUUsQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUNqQixNQUFNLElBQUksT0FBTyxLQUFLLEtBQUssSUFBSSxPQUFPLElBQUksSUFBSSxFQUFFO0FBQy9DLGFBQU8sT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ3RCLE1BQU0sSUFBSSxlQUFRLE9BQU8sQ0FBQyxFQUFFO0FBQzNCLFVBQUksT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7QUFDdEIsWUFBSSxPQUFPLENBQUMsR0FBRyxFQUFFO0FBQ2YsaUJBQU8sQ0FBQyxHQUFHLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7U0FDOUI7O0FBRUQsZUFBTyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUM7T0FDaEQsTUFBTTtBQUNMLGVBQU8sT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO09BQ3RCO0tBQ0YsTUFBTTtBQUNMLFVBQUksT0FBTyxDQUFDLElBQUksSUFBSSxPQUFPLENBQUMsR0FBRyxFQUFFO0FBQy9CLFlBQUksSUFBSSxHQUFHLG1CQUFZLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNyQyxZQUFJLENBQUMsV0FBVyxHQUFHLHlCQUFrQixPQUFPLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDN0UsZUFBTyxHQUFHLEVBQUMsSUFBSSxFQUFFLElBQUksRUFBQyxDQUFDO09BQ3hCOztBQUVELGFBQU8sRUFBRSxDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztLQUM3QjtHQUNGLENBQUMsQ0FBQztDQUNKOzs7Ozs7Ozs7Ozs7O3FCQy9COEUsVUFBVTs7eUJBQ25FLGNBQWM7Ozs7cUJBRXJCLFVBQVMsUUFBUSxFQUFFO0FBQ2hDLFVBQVEsQ0FBQyxjQUFjLENBQUMsTUFBTSxFQUFFLFVBQVMsT0FBTyxFQUFFLE9BQU8sRUFBRTtBQUN6RCxRQUFJLENBQUMsT0FBTyxFQUFFO0FBQ1osWUFBTSwyQkFBYyw2QkFBNkIsQ0FBQyxDQUFDO0tBQ3BEOztBQUVELFFBQUksRUFBRSxHQUFHLE9BQU8sQ0FBQyxFQUFFO1FBQ2YsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPO1FBQ3pCLENBQUMsR0FBRyxDQUFDO1FBQ0wsR0FBRyxHQUFHLEVBQUU7UUFDUixJQUFJLFlBQUE7UUFDSixXQUFXLFlBQUEsQ0FBQzs7QUFFaEIsUUFBSSxPQUFPLENBQUMsSUFBSSxJQUFJLE9BQU8sQ0FBQyxHQUFHLEVBQUU7QUFDL0IsaUJBQVcsR0FBRyx5QkFBa0IsT0FBTyxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztLQUNqRjs7QUFFRCxRQUFJLGtCQUFXLE9BQU8sQ0FBQyxFQUFFO0FBQUUsYUFBTyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7S0FBRTs7QUFFMUQsUUFBSSxPQUFPLENBQUMsSUFBSSxFQUFFO0FBQ2hCLFVBQUksR0FBRyxtQkFBWSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDbEM7O0FBRUQsYUFBUyxhQUFhLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUU7QUFDekMsVUFBSSxJQUFJLEVBQUU7QUFDUixZQUFJLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQztBQUNqQixZQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztBQUNuQixZQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssS0FBSyxDQUFDLENBQUM7QUFDekIsWUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDOztBQUVuQixZQUFJLFdBQVcsRUFBRTtBQUNmLGNBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxHQUFHLEtBQUssQ0FBQztTQUN4QztPQUNGOztBQUVELFNBQUcsR0FBRyxHQUFHLEdBQUcsRUFBRSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRTtBQUM3QixZQUFJLEVBQUUsSUFBSTtBQUNWLG1CQUFXLEVBQUUsbUJBQVksQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQyxXQUFXLEdBQUcsS0FBSyxFQUFFLElBQUksQ0FBQyxDQUFDO09BQy9FLENBQUMsQ0FBQztLQUNKOztBQUVELFFBQUksT0FBTyxJQUFJLE9BQU8sT0FBTyxLQUFLLFFBQVEsRUFBRTtBQUMxQyxVQUFJLGVBQVEsT0FBTyxDQUFDLEVBQUU7QUFDcEIsYUFBSyxJQUFJLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDdkMsY0FBSSxDQUFDLElBQUksT0FBTyxFQUFFO0FBQ2hCLHlCQUFhLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEtBQUssT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztXQUMvQztTQUNGO09BQ0YsTUFBTTtBQUNMLFlBQUksUUFBUSxZQUFBLENBQUM7O0FBRWIsYUFBSyxJQUFJLEdBQUcsSUFBSSxPQUFPLEVBQUU7QUFDdkIsY0FBSSxPQUFPLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxFQUFFOzs7O0FBSS9CLGdCQUFJLFFBQVEsS0FBSyxTQUFTLEVBQUU7QUFDMUIsMkJBQWEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO2FBQ2hDO0FBQ0Qsb0JBQVEsR0FBRyxHQUFHLENBQUM7QUFDZixhQUFDLEVBQUUsQ0FBQztXQUNMO1NBQ0Y7QUFDRCxZQUFJLFFBQVEsS0FBSyxTQUFTLEVBQUU7QUFDMUIsdUJBQWEsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxHQUFHLENBQUMsRUFBRSxJQUFJLENBQUMsQ0FBQztTQUN0QztPQUNGO0tBQ0Y7O0FBRUQsUUFBSSxDQUFDLEtBQUssQ0FBQyxFQUFFO0FBQ1gsU0FBRyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUNyQjs7QUFFRCxXQUFPLEdBQUcsQ0FBQztHQUNaLENBQUMsQ0FBQztDQUNKOzs7Ozs7Ozs7Ozs7O3lCQzlFcUIsY0FBYzs7OztxQkFFckIsVUFBUyxRQUFRLEVBQUU7QUFDaEMsVUFBUSxDQUFDLGNBQWMsQ0FBQyxlQUFlLEVBQUUsaUNBQWdDO0FBQ3ZFLFFBQUksU0FBUyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7O0FBRTFCLGFBQU8sU0FBUyxDQUFDO0tBQ2xCLE1BQU07O0FBRUwsWUFBTSwyQkFBYyxtQkFBbUIsR0FBRyxTQUFTLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDLENBQUM7S0FDdkY7R0FDRixDQUFDLENBQUM7Q0FDSjs7Ozs7Ozs7OztxQkNaaUMsVUFBVTs7cUJBRTdCLFVBQVMsUUFBUSxFQUFFO0FBQ2hDLFVBQVEsQ0FBQyxjQUFjLENBQUMsSUFBSSxFQUFFLFVBQVMsV0FBVyxFQUFFLE9BQU8sRUFBRTtBQUMzRCxRQUFJLGtCQUFXLFdBQVcsQ0FBQyxFQUFFO0FBQUUsaUJBQVcsR0FBRyxXQUFXLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQUU7Ozs7O0FBS3RFLFFBQUksQUFBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFJLENBQUMsV0FBVyxJQUFLLGVBQVEsV0FBVyxDQUFDLEVBQUU7QUFDdkUsYUFBTyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQzlCLE1BQU07QUFDTCxhQUFPLE9BQU8sQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLENBQUM7S0FDekI7R0FDRixDQUFDLENBQUM7O0FBRUgsVUFBUSxDQUFDLGNBQWMsQ0FBQyxRQUFRLEVBQUUsVUFBUyxXQUFXLEVBQUUsT0FBTyxFQUFFO0FBQy9ELFdBQU8sUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRSxFQUFDLEVBQUUsRUFBRSxPQUFPLENBQUMsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsRUFBRSxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsSUFBSSxFQUFDLENBQUMsQ0FBQztHQUN2SCxDQUFDLENBQUM7Q0FDSjs7Ozs7Ozs7OztxQkNuQmMsVUFBUyxRQUFRLEVBQUU7QUFDaEMsVUFBUSxDQUFDLGNBQWMsQ0FBQyxLQUFLLEVBQUUsa0NBQWlDO0FBQzlELFFBQUksSUFBSSxHQUFHLENBQUMsU0FBUyxDQUFDO1FBQ2xCLE9BQU8sR0FBRyxTQUFTLENBQUMsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQztBQUM5QyxTQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsU0FBUyxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDN0MsVUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztLQUN6Qjs7QUFFRCxRQUFJLEtBQUssR0FBRyxDQUFDLENBQUM7QUFDZCxRQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLElBQUksRUFBRTtBQUM5QixXQUFLLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7S0FDNUIsTUFBTSxJQUFJLE9BQU8sQ0FBQyxJQUFJLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxLQUFLLElBQUksSUFBSSxFQUFFO0FBQ3JELFdBQUssR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQztLQUM1QjtBQUNELFFBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUM7O0FBRWhCLFlBQVEsQ0FBQyxHQUFHLE1BQUEsQ0FBWixRQUFRLEVBQVMsSUFBSSxDQUFDLENBQUM7R0FDeEIsQ0FBQyxDQUFDO0NBQ0o7Ozs7Ozs7Ozs7cUJDbEJjLFVBQVMsUUFBUSxFQUFFO0FBQ2hDLFVBQVEsQ0FBQyxjQUFjLENBQUMsUUFBUSxFQUFFLFVBQVMsR0FBRyxFQUFFLEtBQUssRUFBRTtBQUNyRCxXQUFPLEdBQUcsSUFBSSxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7R0FDMUIsQ0FBQyxDQUFDO0NBQ0o7Ozs7Ozs7Ozs7cUJDSjhFLFVBQVU7O3FCQUUxRSxVQUFTLFFBQVEsRUFBRTtBQUNoQyxVQUFRLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRSxVQUFTLE9BQU8sRUFBRSxPQUFPLEVBQUU7QUFDekQsUUFBSSxrQkFBVyxPQUFPLENBQUMsRUFBRTtBQUFFLGFBQU8sR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQUU7O0FBRTFELFFBQUksRUFBRSxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUM7O0FBRXBCLFFBQUksQ0FBQyxlQUFRLE9BQU8sQ0FBQyxFQUFFO0FBQ3JCLFVBQUksSUFBSSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7QUFDeEIsVUFBSSxPQUFPLENBQUMsSUFBSSxJQUFJLE9BQU8sQ0FBQyxHQUFHLEVBQUU7QUFDL0IsWUFBSSxHQUFHLG1CQUFZLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNqQyxZQUFJLENBQUMsV0FBVyxHQUFHLHlCQUFrQixPQUFPLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7T0FDaEY7O0FBRUQsYUFBTyxFQUFFLENBQUMsT0FBTyxFQUFFO0FBQ2pCLFlBQUksRUFBRSxJQUFJO0FBQ1YsbUJBQVcsRUFBRSxtQkFBWSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQztPQUNoRSxDQUFDLENBQUM7S0FDSixNQUFNO0FBQ0wsYUFBTyxPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQzlCO0dBQ0YsQ0FBQyxDQUFDO0NBQ0o7Ozs7Ozs7Ozs7cUJDdkJxQixTQUFTOztBQUUvQixJQUFJLE1BQU0sR0FBRztBQUNYLFdBQVMsRUFBRSxDQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLE9BQU8sQ0FBQztBQUM3QyxPQUFLLEVBQUUsTUFBTTs7O0FBR2IsYUFBVyxFQUFFLHFCQUFTLEtBQUssRUFBRTtBQUMzQixRQUFJLE9BQU8sS0FBSyxLQUFLLFFBQVEsRUFBRTtBQUM3QixVQUFJLFFBQVEsR0FBRyxlQUFRLE1BQU0sQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7QUFDOUQsVUFBSSxRQUFRLElBQUksQ0FBQyxFQUFFO0FBQ2pCLGFBQUssR0FBRyxRQUFRLENBQUM7T0FDbEIsTUFBTTtBQUNMLGFBQUssR0FBRyxRQUFRLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO09BQzdCO0tBQ0Y7O0FBRUQsV0FBTyxLQUFLLENBQUM7R0FDZDs7O0FBR0QsS0FBRyxFQUFFLGFBQVMsS0FBSyxFQUFjO0FBQy9CLFNBQUssR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDOztBQUVsQyxRQUFJLE9BQU8sT0FBTyxLQUFLLFdBQVcsSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLEVBQUU7QUFDL0UsVUFBSSxNQUFNLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUNyQyxVQUFJLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFOztBQUNwQixjQUFNLEdBQUcsS0FBSyxDQUFDO09BQ2hCOzt3Q0FQbUIsT0FBTztBQUFQLGVBQU87OztBQVEzQixhQUFPLENBQUMsTUFBTSxPQUFDLENBQWYsT0FBTyxFQUFZLE9BQU8sQ0FBQyxDQUFDO0tBQzdCO0dBQ0Y7Q0FDRixDQUFDOztxQkFFYSxNQUFNOzs7Ozs7Ozs7OztxQkNqQ04sVUFBUyxVQUFVLEVBQUU7O0FBRWxDLE1BQUksSUFBSSxHQUFHLE9BQU8sTUFBTSxLQUFLLFdBQVcsR0FBRyxNQUFNLEdBQUcsTUFBTTtNQUN0RCxXQUFXLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQzs7QUFFbEMsWUFBVSxDQUFDLFVBQVUsR0FBRyxZQUFXO0FBQ2pDLFFBQUksSUFBSSxDQUFDLFVBQVUsS0FBSyxVQUFVLEVBQUU7QUFDbEMsVUFBSSxDQUFDLFVBQVUsR0FBRyxXQUFXLENBQUM7S0FDL0I7QUFDRCxXQUFPLFVBQVUsQ0FBQztHQUNuQixDQUFDO0NBQ0g7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7cUJDWnNCLFNBQVM7O0lBQXBCLEtBQUs7O3lCQUNLLGFBQWE7Ozs7b0JBQzhCLFFBQVE7O0FBRWxFLFNBQVMsYUFBYSxDQUFDLFlBQVksRUFBRTtBQUMxQyxNQUFNLGdCQUFnQixHQUFHLFlBQVksSUFBSSxZQUFZLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztNQUN2RCxlQUFlLDBCQUFvQixDQUFDOztBQUUxQyxNQUFJLGdCQUFnQixLQUFLLGVBQWUsRUFBRTtBQUN4QyxRQUFJLGdCQUFnQixHQUFHLGVBQWUsRUFBRTtBQUN0QyxVQUFNLGVBQWUsR0FBRyx1QkFBaUIsZUFBZSxDQUFDO1VBQ25ELGdCQUFnQixHQUFHLHVCQUFpQixnQkFBZ0IsQ0FBQyxDQUFDO0FBQzVELFlBQU0sMkJBQWMseUZBQXlGLEdBQ3ZHLHFEQUFxRCxHQUFHLGVBQWUsR0FBRyxtREFBbUQsR0FBRyxnQkFBZ0IsR0FBRyxJQUFJLENBQUMsQ0FBQztLQUNoSyxNQUFNOztBQUVMLFlBQU0sMkJBQWMsd0ZBQXdGLEdBQ3RHLGlEQUFpRCxHQUFHLFlBQVksQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztLQUNuRjtHQUNGO0NBQ0Y7O0FBRU0sU0FBUyxRQUFRLENBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRTs7QUFFMUMsTUFBSSxDQUFDLEdBQUcsRUFBRTtBQUNSLFVBQU0sMkJBQWMsbUNBQW1DLENBQUMsQ0FBQztHQUMxRDtBQUNELE1BQUksQ0FBQyxZQUFZLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFO0FBQ3ZDLFVBQU0sMkJBQWMsMkJBQTJCLEdBQUcsT0FBTyxZQUFZLENBQUMsQ0FBQztHQUN4RTs7QUFFRCxjQUFZLENBQUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxZQUFZLENBQUMsTUFBTSxDQUFDOzs7O0FBSWxELEtBQUcsQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQzs7QUFFNUMsV0FBUyxvQkFBb0IsQ0FBQyxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRTtBQUN2RCxRQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUU7QUFDaEIsYUFBTyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDbEQsVUFBSSxPQUFPLENBQUMsR0FBRyxFQUFFO0FBQ2YsZUFBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUM7T0FDdkI7S0FDRjs7QUFFRCxXQUFPLEdBQUcsR0FBRyxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLElBQUksRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQ3RFLFFBQUksTUFBTSxHQUFHLEdBQUcsQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQzs7QUFFeEUsUUFBSSxNQUFNLElBQUksSUFBSSxJQUFJLEdBQUcsQ0FBQyxPQUFPLEVBQUU7QUFDakMsYUFBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsWUFBWSxDQUFDLGVBQWUsRUFBRSxHQUFHLENBQUMsQ0FBQztBQUN6RixZQUFNLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0tBQzNEO0FBQ0QsUUFBSSxNQUFNLElBQUksSUFBSSxFQUFFO0FBQ2xCLFVBQUksT0FBTyxDQUFDLE1BQU0sRUFBRTtBQUNsQixZQUFJLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0FBQy9CLGFBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDNUMsY0FBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsRUFBRTtBQUM1QixrQkFBTTtXQUNQOztBQUVELGVBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUN0QztBQUNELGNBQU0sR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO09BQzNCO0FBQ0QsYUFBTyxNQUFNLENBQUM7S0FDZixNQUFNO0FBQ0wsWUFBTSwyQkFBYyxjQUFjLEdBQUcsT0FBTyxDQUFDLElBQUksR0FBRywwREFBMEQsQ0FBQyxDQUFDO0tBQ2pIO0dBQ0Y7OztBQUdELE1BQUksU0FBUyxHQUFHO0FBQ2QsVUFBTSxFQUFFLGdCQUFTLEdBQUcsRUFBRSxJQUFJLEVBQUU7QUFDMUIsVUFBSSxFQUFFLElBQUksSUFBSSxHQUFHLENBQUEsQUFBQyxFQUFFO0FBQ2xCLGNBQU0sMkJBQWMsR0FBRyxHQUFHLElBQUksR0FBRyxtQkFBbUIsR0FBRyxHQUFHLENBQUMsQ0FBQztPQUM3RDtBQUNELGFBQU8sR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ2xCO0FBQ0QsVUFBTSxFQUFFLGdCQUFTLE1BQU0sRUFBRSxJQUFJLEVBQUU7QUFDN0IsVUFBTSxHQUFHLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQztBQUMxQixXQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQzVCLFlBQUksTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxJQUFJLEVBQUU7QUFDeEMsaUJBQU8sTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3hCO09BQ0Y7S0FDRjtBQUNELFVBQU0sRUFBRSxnQkFBUyxPQUFPLEVBQUUsT0FBTyxFQUFFO0FBQ2pDLGFBQU8sT0FBTyxPQUFPLEtBQUssVUFBVSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsT0FBTyxDQUFDO0tBQ3hFOztBQUVELG9CQUFnQixFQUFFLEtBQUssQ0FBQyxnQkFBZ0I7QUFDeEMsaUJBQWEsRUFBRSxvQkFBb0I7O0FBRW5DLE1BQUUsRUFBRSxZQUFTLENBQUMsRUFBRTtBQUNkLFVBQUksR0FBRyxHQUFHLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUMxQixTQUFHLENBQUMsU0FBUyxHQUFHLFlBQVksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7QUFDdkMsYUFBTyxHQUFHLENBQUM7S0FDWjs7QUFFRCxZQUFRLEVBQUUsRUFBRTtBQUNaLFdBQU8sRUFBRSxpQkFBUyxDQUFDLEVBQUUsSUFBSSxFQUFFLG1CQUFtQixFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUU7QUFDbkUsVUFBSSxjQUFjLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7VUFDakMsRUFBRSxHQUFHLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDcEIsVUFBSSxJQUFJLElBQUksTUFBTSxJQUFJLFdBQVcsSUFBSSxtQkFBbUIsRUFBRTtBQUN4RCxzQkFBYyxHQUFHLFdBQVcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsbUJBQW1CLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO09BQzNGLE1BQU0sSUFBSSxDQUFDLGNBQWMsRUFBRTtBQUMxQixzQkFBYyxHQUFHLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEdBQUcsV0FBVyxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUM7T0FDOUQ7QUFDRCxhQUFPLGNBQWMsQ0FBQztLQUN2Qjs7QUFFRCxRQUFJLEVBQUUsY0FBUyxLQUFLLEVBQUUsS0FBSyxFQUFFO0FBQzNCLGFBQU8sS0FBSyxJQUFJLEtBQUssRUFBRSxFQUFFO0FBQ3ZCLGFBQUssR0FBRyxLQUFLLENBQUMsT0FBTyxDQUFDO09BQ3ZCO0FBQ0QsYUFBTyxLQUFLLENBQUM7S0FDZDtBQUNELFNBQUssRUFBRSxlQUFTLEtBQUssRUFBRSxNQUFNLEVBQUU7QUFDN0IsVUFBSSxHQUFHLEdBQUcsS0FBSyxJQUFJLE1BQU0sQ0FBQzs7QUFFMUIsVUFBSSxLQUFLLElBQUksTUFBTSxJQUFLLEtBQUssS0FBSyxNQUFNLEFBQUMsRUFBRTtBQUN6QyxXQUFHLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUssQ0FBQyxDQUFDO09BQ3ZDOztBQUVELGFBQU8sR0FBRyxDQUFDO0tBQ1o7O0FBRUQsUUFBSSxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSTtBQUNqQixnQkFBWSxFQUFFLFlBQVksQ0FBQyxRQUFRO0dBQ3BDLENBQUM7O0FBRUYsV0FBUyxHQUFHLENBQUMsT0FBTyxFQUFnQjtRQUFkLE9BQU8seURBQUcsRUFBRTs7QUFDaEMsUUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLElBQUksQ0FBQzs7QUFFeEIsT0FBRyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNwQixRQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sSUFBSSxZQUFZLENBQUMsT0FBTyxFQUFFO0FBQzVDLFVBQUksR0FBRyxRQUFRLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQ2hDO0FBQ0QsUUFBSSxNQUFNLFlBQUE7UUFDTixXQUFXLEdBQUcsWUFBWSxDQUFDLGNBQWMsR0FBRyxFQUFFLEdBQUcsU0FBUyxDQUFDO0FBQy9ELFFBQUksWUFBWSxDQUFDLFNBQVMsRUFBRTtBQUMxQixVQUFJLE9BQU8sQ0FBQyxNQUFNLEVBQUU7QUFDbEIsY0FBTSxHQUFHLE9BQU8sS0FBSyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDO09BQzVGLE1BQU07QUFDTCxjQUFNLEdBQUcsQ0FBQyxPQUFPLENBQUMsQ0FBQztPQUNwQjtLQUNGOztBQUVELGFBQVMsSUFBSSxDQUFDLE9BQU8sZ0JBQWU7QUFDbEMsYUFBTyxFQUFFLEdBQUcsWUFBWSxDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsT0FBTyxFQUFFLFNBQVMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0tBQ3JIO0FBQ0QsUUFBSSxHQUFHLGlCQUFpQixDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxPQUFPLENBQUMsTUFBTSxJQUFJLEVBQUUsRUFBRSxJQUFJLEVBQUUsV0FBVyxDQUFDLENBQUM7QUFDdEcsV0FBTyxJQUFJLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0dBQy9CO0FBQ0QsS0FBRyxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7O0FBRWpCLEtBQUcsQ0FBQyxNQUFNLEdBQUcsVUFBUyxPQUFPLEVBQUU7QUFDN0IsUUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUU7QUFDcEIsZUFBUyxDQUFDLE9BQU8sR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDOztBQUVsRSxVQUFJLFlBQVksQ0FBQyxVQUFVLEVBQUU7QUFDM0IsaUJBQVMsQ0FBQyxRQUFRLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztPQUN0RTtBQUNELFVBQUksWUFBWSxDQUFDLFVBQVUsSUFBSSxZQUFZLENBQUMsYUFBYSxFQUFFO0FBQ3pELGlCQUFTLENBQUMsVUFBVSxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFVBQVUsRUFBRSxHQUFHLENBQUMsVUFBVSxDQUFDLENBQUM7T0FDNUU7S0FDRixNQUFNO0FBQ0wsZUFBUyxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDO0FBQ3BDLGVBQVMsQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUN0QyxlQUFTLENBQUMsVUFBVSxHQUFHLE9BQU8sQ0FBQyxVQUFVLENBQUM7S0FDM0M7R0FDRixDQUFDOztBQUVGLEtBQUcsQ0FBQyxNQUFNLEdBQUcsVUFBUyxDQUFDLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUU7QUFDbEQsUUFBSSxZQUFZLENBQUMsY0FBYyxJQUFJLENBQUMsV0FBVyxFQUFFO0FBQy9DLFlBQU0sMkJBQWMsd0JBQXdCLENBQUMsQ0FBQztLQUMvQztBQUNELFFBQUksWUFBWSxDQUFDLFNBQVMsSUFBSSxDQUFDLE1BQU0sRUFBRTtBQUNyQyxZQUFNLDJCQUFjLHlCQUF5QixDQUFDLENBQUM7S0FDaEQ7O0FBRUQsV0FBTyxXQUFXLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxXQUFXLEVBQUUsTUFBTSxDQUFDLENBQUM7R0FDakYsQ0FBQztBQUNGLFNBQU8sR0FBRyxDQUFDO0NBQ1o7O0FBRU0sU0FBUyxXQUFXLENBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLG1CQUFtQixFQUFFLFdBQVcsRUFBRSxNQUFNLEVBQUU7QUFDNUYsV0FBUyxJQUFJLENBQUMsT0FBTyxFQUFnQjtRQUFkLE9BQU8seURBQUcsRUFBRTs7QUFDakMsUUFBSSxhQUFhLEdBQUcsTUFBTSxDQUFDO0FBQzNCLFFBQUksTUFBTSxJQUFJLE9BQU8sS0FBSyxNQUFNLENBQUMsQ0FBQyxDQUFDLEVBQUU7QUFDbkMsbUJBQWEsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztLQUMxQzs7QUFFRCxXQUFPLEVBQUUsQ0FBQyxTQUFTLEVBQ2YsT0FBTyxFQUNQLFNBQVMsQ0FBQyxPQUFPLEVBQUUsU0FBUyxDQUFDLFFBQVEsRUFDckMsT0FBTyxDQUFDLElBQUksSUFBSSxJQUFJLEVBQ3BCLFdBQVcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLEVBQ3hELGFBQWEsQ0FBQyxDQUFDO0dBQ3BCOztBQUVELE1BQUksR0FBRyxpQkFBaUIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLFdBQVcsQ0FBQyxDQUFDOztBQUV6RSxNQUFJLENBQUMsT0FBTyxHQUFHLENBQUMsQ0FBQztBQUNqQixNQUFJLENBQUMsS0FBSyxHQUFHLE1BQU0sR0FBRyxNQUFNLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQztBQUN4QyxNQUFJLENBQUMsV0FBVyxHQUFHLG1CQUFtQixJQUFJLENBQUMsQ0FBQztBQUM1QyxTQUFPLElBQUksQ0FBQztDQUNiOztBQUVNLFNBQVMsY0FBYyxDQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFO0FBQ3hELE1BQUksQ0FBQyxPQUFPLEVBQUU7QUFDWixRQUFJLE9BQU8sQ0FBQyxJQUFJLEtBQUssZ0JBQWdCLEVBQUU7QUFDckMsYUFBTyxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7S0FDekMsTUFBTTtBQUNMLGFBQU8sR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUMxQztHQUNGLE1BQU0sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxFQUFFOztBQUV6QyxXQUFPLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQztBQUN2QixXQUFPLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQztHQUNyQztBQUNELFNBQU8sT0FBTyxDQUFDO0NBQ2hCOztBQUVNLFNBQVMsYUFBYSxDQUFDLE9BQU8sRUFBRSxPQUFPLEVBQUUsT0FBTyxFQUFFO0FBQ3ZELFNBQU8sQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO0FBQ3ZCLE1BQUksT0FBTyxDQUFDLEdBQUcsRUFBRTtBQUNmLFdBQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUM7R0FDdkU7O0FBRUQsTUFBSSxZQUFZLFlBQUEsQ0FBQztBQUNqQixNQUFJLE9BQU8sQ0FBQyxFQUFFLElBQUksT0FBTyxDQUFDLEVBQUUsS0FBSyxJQUFJLEVBQUU7QUFDckMsV0FBTyxDQUFDLElBQUksR0FBRyxrQkFBWSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDekMsZ0JBQVksR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUM7O0FBRTFELFFBQUksWUFBWSxDQUFDLFFBQVEsRUFBRTtBQUN6QixhQUFPLENBQUMsUUFBUSxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBRSxFQUFFLE9BQU8sQ0FBQyxRQUFRLEVBQUUsWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0tBQzlFO0dBQ0Y7O0FBRUQsTUFBSSxPQUFPLEtBQUssU0FBUyxJQUFJLFlBQVksRUFBRTtBQUN6QyxXQUFPLEdBQUcsWUFBWSxDQUFDO0dBQ3hCOztBQUVELE1BQUksT0FBTyxLQUFLLFNBQVMsRUFBRTtBQUN6QixVQUFNLDJCQUFjLGNBQWMsR0FBRyxPQUFPLENBQUMsSUFBSSxHQUFHLHFCQUFxQixDQUFDLENBQUM7R0FDNUUsTUFBTSxJQUFJLE9BQU8sWUFBWSxRQUFRLEVBQUU7QUFDdEMsV0FBTyxPQUFPLENBQUMsT0FBTyxFQUFFLE9BQU8sQ0FBQyxDQUFDO0dBQ2xDO0NBQ0Y7O0FBRU0sU0FBUyxJQUFJLEdBQUc7QUFBRSxTQUFPLEVBQUUsQ0FBQztDQUFFOztBQUVyQyxTQUFTLFFBQVEsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFO0FBQy9CLE1BQUksQ0FBQyxJQUFJLElBQUksRUFBRSxNQUFNLElBQUksSUFBSSxDQUFBLEFBQUMsRUFBRTtBQUM5QixRQUFJLEdBQUcsSUFBSSxHQUFHLGtCQUFZLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztBQUNyQyxRQUFJLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQztHQUNyQjtBQUNELFNBQU8sSUFBSSxDQUFDO0NBQ2I7O0FBRUQsU0FBUyxpQkFBaUIsQ0FBQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRTtBQUN6RSxNQUFJLEVBQUUsQ0FBQyxTQUFTLEVBQUU7QUFDaEIsUUFBSSxLQUFLLEdBQUcsRUFBRSxDQUFDO0FBQ2YsUUFBSSxHQUFHLEVBQUUsQ0FBQyxTQUFTLENBQUMsSUFBSSxFQUFFLEtBQUssRUFBRSxTQUFTLEVBQUUsTUFBTSxJQUFJLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQzVGLFNBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO0dBQzNCO0FBQ0QsU0FBTyxJQUFJLENBQUM7Q0FDYjs7Ozs7Ozs7QUMzUUQsU0FBUyxVQUFVLENBQUMsTUFBTSxFQUFFO0FBQzFCLE1BQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0NBQ3RCOztBQUVELFVBQVUsQ0FBQyxTQUFTLENBQUMsUUFBUSxHQUFHLFVBQVUsQ0FBQyxTQUFTLENBQUMsTUFBTSxHQUFHLFlBQVc7QUFDdkUsU0FBTyxFQUFFLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQztDQUN6QixDQUFDOztxQkFFYSxVQUFVOzs7Ozs7Ozs7Ozs7Ozs7QUNUekIsSUFBTSxNQUFNLEdBQUc7QUFDYixLQUFHLEVBQUUsT0FBTztBQUNaLEtBQUcsRUFBRSxNQUFNO0FBQ1gsS0FBRyxFQUFFLE1BQU07QUFDWCxLQUFHLEVBQUUsUUFBUTtBQUNiLEtBQUcsRUFBRSxRQUFRO0FBQ2IsS0FBRyxFQUFFLFFBQVE7QUFDYixLQUFHLEVBQUUsUUFBUTtDQUNkLENBQUM7O0FBRUYsSUFBTSxRQUFRLEdBQUcsWUFBWTtJQUN2QixRQUFRLEdBQUcsV0FBVyxDQUFDOztBQUU3QixTQUFTLFVBQVUsQ0FBQyxHQUFHLEVBQUU7QUFDdkIsU0FBTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7Q0FDcEI7O0FBRU0sU0FBUyxNQUFNLENBQUMsR0FBRyxvQkFBbUI7QUFDM0MsT0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLFNBQVMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDekMsU0FBSyxJQUFJLEdBQUcsSUFBSSxTQUFTLENBQUMsQ0FBQyxDQUFDLEVBQUU7QUFDNUIsVUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFO0FBQzNELFdBQUcsQ0FBQyxHQUFHLENBQUMsR0FBRyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUM7T0FDOUI7S0FDRjtHQUNGOztBQUVELFNBQU8sR0FBRyxDQUFDO0NBQ1o7O0FBRU0sSUFBSSxRQUFRLEdBQUcsTUFBTSxDQUFDLFNBQVMsQ0FBQyxRQUFRLENBQUM7Ozs7OztBQUtoRCxJQUFJLFVBQVUsR0FBRyxvQkFBUyxLQUFLLEVBQUU7QUFDL0IsU0FBTyxPQUFPLEtBQUssS0FBSyxVQUFVLENBQUM7Q0FDcEMsQ0FBQzs7O0FBR0YsSUFBSSxVQUFVLENBQUMsR0FBRyxDQUFDLEVBQUU7QUFDbkIsVUFJTSxVQUFVLEdBSmhCLFVBQVUsR0FBRyxVQUFTLEtBQUssRUFBRTtBQUMzQixXQUFPLE9BQU8sS0FBSyxLQUFLLFVBQVUsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLG1CQUFtQixDQUFDO0dBQ3BGLENBQUM7Q0FDSDtRQUNPLFVBQVUsR0FBVixVQUFVOzs7OztBQUlYLElBQU0sT0FBTyxHQUFHLEtBQUssQ0FBQyxPQUFPLElBQUksVUFBUyxLQUFLLEVBQUU7QUFDdEQsU0FBTyxBQUFDLEtBQUssSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLEdBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxnQkFBZ0IsR0FBRyxLQUFLLENBQUM7Q0FDakcsQ0FBQzs7Ozs7QUFHSyxTQUFTLE9BQU8sQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFO0FBQ3BDLE9BQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsR0FBRyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEVBQUU7QUFDaEQsUUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEtBQUssS0FBSyxFQUFFO0FBQ3RCLGFBQU8sQ0FBQyxDQUFDO0tBQ1Y7R0FDRjtBQUNELFNBQU8sQ0FBQyxDQUFDLENBQUM7Q0FDWDs7QUFHTSxTQUFTLGdCQUFnQixDQUFDLE1BQU0sRUFBRTtBQUN2QyxNQUFJLE9BQU8sTUFBTSxLQUFLLFFBQVEsRUFBRTs7QUFFOUIsUUFBSSxNQUFNLElBQUksTUFBTSxDQUFDLE1BQU0sRUFBRTtBQUMzQixhQUFPLE1BQU0sQ0FBQyxNQUFNLEVBQUUsQ0FBQztLQUN4QixNQUFNLElBQUksTUFBTSxJQUFJLElBQUksRUFBRTtBQUN6QixhQUFPLEVBQUUsQ0FBQztLQUNYLE1BQU0sSUFBSSxDQUFDLE1BQU0sRUFBRTtBQUNsQixhQUFPLE1BQU0sR0FBRyxFQUFFLENBQUM7S0FDcEI7Ozs7O0FBS0QsVUFBTSxHQUFHLEVBQUUsR0FBRyxNQUFNLENBQUM7R0FDdEI7O0FBRUQsTUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLEVBQUU7QUFBRSxXQUFPLE1BQU0sQ0FBQztHQUFFO0FBQzlDLFNBQU8sTUFBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLEVBQUUsVUFBVSxDQUFDLENBQUM7Q0FDN0M7O0FBRU0sU0FBUyxPQUFPLENBQUMsS0FBSyxFQUFFO0FBQzdCLE1BQUksQ0FBQyxLQUFLLElBQUksS0FBSyxLQUFLLENBQUMsRUFBRTtBQUN6QixXQUFPLElBQUksQ0FBQztHQUNiLE1BQU0sSUFBSSxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7QUFDL0MsV0FBTyxJQUFJLENBQUM7R0FDYixNQUFNO0FBQ0wsV0FBTyxLQUFLLENBQUM7R0FDZDtDQUNGOztBQUVNLFNBQVMsV0FBVyxDQUFDLE1BQU0sRUFBRTtBQUNsQyxNQUFJLEtBQUssR0FBRyxNQUFNLENBQUMsRUFBRSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0FBQy9CLE9BQUssQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO0FBQ3ZCLFNBQU8sS0FBSyxDQUFDO0NBQ2Q7O0FBRU0sU0FBUyxXQUFXLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRTtBQUN2QyxRQUFNLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQztBQUNsQixTQUFPLE1BQU0sQ0FBQztDQUNmOztBQUVNLFNBQVMsaUJBQWlCLENBQUMsV0FBVyxFQUFFLEVBQUUsRUFBRTtBQUNqRCxTQUFPLENBQUMsV0FBVyxHQUFHLFdBQVcsR0FBRyxHQUFHLEdBQUcsRUFBRSxDQUFBLEdBQUksRUFBRSxDQUFDO0NBQ3BEOzs7O0FDM0dEO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7OztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDMUxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1BBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ2hLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUMxT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNuTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDakpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUM5RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUM1YkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzloQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDOXhCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUNyVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUN2UkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDNU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNyQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNqTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNwc0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNiQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxK0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM5R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQzlZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDbHZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDektBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzVSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdk5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7O0FDeldBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNwbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQzlzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ1RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ2p1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzloQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUMvSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdERBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0xBO0FBQ0E7QUFDQTtBQUNBOztBQ0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbktBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxuXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBjbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBzZXRUaW1lb3V0KGRyYWluUXVldWUsIDApO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuIiwiaW1wb3J0ICogYXMgYmFzZSBmcm9tICcuL2hhbmRsZWJhcnMvYmFzZSc7XG5cbi8vIEVhY2ggb2YgdGhlc2UgYXVnbWVudCB0aGUgSGFuZGxlYmFycyBvYmplY3QuIE5vIG5lZWQgdG8gc2V0dXAgaGVyZS5cbi8vIChUaGlzIGlzIGRvbmUgdG8gZWFzaWx5IHNoYXJlIGNvZGUgYmV0d2VlbiBjb21tb25qcyBhbmQgYnJvd3NlIGVudnMpXG5pbXBvcnQgU2FmZVN0cmluZyBmcm9tICcuL2hhbmRsZWJhcnMvc2FmZS1zdHJpbmcnO1xuaW1wb3J0IEV4Y2VwdGlvbiBmcm9tICcuL2hhbmRsZWJhcnMvZXhjZXB0aW9uJztcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vaGFuZGxlYmFycy91dGlscyc7XG5pbXBvcnQgKiBhcyBydW50aW1lIGZyb20gJy4vaGFuZGxlYmFycy9ydW50aW1lJztcblxuaW1wb3J0IG5vQ29uZmxpY3QgZnJvbSAnLi9oYW5kbGViYXJzL25vLWNvbmZsaWN0JztcblxuLy8gRm9yIGNvbXBhdGliaWxpdHkgYW5kIHVzYWdlIG91dHNpZGUgb2YgbW9kdWxlIHN5c3RlbXMsIG1ha2UgdGhlIEhhbmRsZWJhcnMgb2JqZWN0IGEgbmFtZXNwYWNlXG5mdW5jdGlvbiBjcmVhdGUoKSB7XG4gIGxldCBoYiA9IG5ldyBiYXNlLkhhbmRsZWJhcnNFbnZpcm9ubWVudCgpO1xuXG4gIFV0aWxzLmV4dGVuZChoYiwgYmFzZSk7XG4gIGhiLlNhZmVTdHJpbmcgPSBTYWZlU3RyaW5nO1xuICBoYi5FeGNlcHRpb24gPSBFeGNlcHRpb247XG4gIGhiLlV0aWxzID0gVXRpbHM7XG4gIGhiLmVzY2FwZUV4cHJlc3Npb24gPSBVdGlscy5lc2NhcGVFeHByZXNzaW9uO1xuXG4gIGhiLlZNID0gcnVudGltZTtcbiAgaGIudGVtcGxhdGUgPSBmdW5jdGlvbihzcGVjKSB7XG4gICAgcmV0dXJuIHJ1bnRpbWUudGVtcGxhdGUoc3BlYywgaGIpO1xuICB9O1xuXG4gIHJldHVybiBoYjtcbn1cblxubGV0IGluc3QgPSBjcmVhdGUoKTtcbmluc3QuY3JlYXRlID0gY3JlYXRlO1xuXG5ub0NvbmZsaWN0KGluc3QpO1xuXG5pbnN0WydkZWZhdWx0J10gPSBpbnN0O1xuXG5leHBvcnQgZGVmYXVsdCBpbnN0O1xuIiwiaW1wb3J0IHtjcmVhdGVGcmFtZSwgZXh0ZW5kLCB0b1N0cmluZ30gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgRXhjZXB0aW9uIGZyb20gJy4vZXhjZXB0aW9uJztcbmltcG9ydCB7cmVnaXN0ZXJEZWZhdWx0SGVscGVyc30gZnJvbSAnLi9oZWxwZXJzJztcbmltcG9ydCB7cmVnaXN0ZXJEZWZhdWx0RGVjb3JhdG9yc30gZnJvbSAnLi9kZWNvcmF0b3JzJztcbmltcG9ydCBsb2dnZXIgZnJvbSAnLi9sb2dnZXInO1xuXG5leHBvcnQgY29uc3QgVkVSU0lPTiA9ICc0LjAuNSc7XG5leHBvcnQgY29uc3QgQ09NUElMRVJfUkVWSVNJT04gPSA3O1xuXG5leHBvcnQgY29uc3QgUkVWSVNJT05fQ0hBTkdFUyA9IHtcbiAgMTogJzw9IDEuMC5yYy4yJywgLy8gMS4wLnJjLjIgaXMgYWN0dWFsbHkgcmV2MiBidXQgZG9lc24ndCByZXBvcnQgaXRcbiAgMjogJz09IDEuMC4wLXJjLjMnLFxuICAzOiAnPT0gMS4wLjAtcmMuNCcsXG4gIDQ6ICc9PSAxLngueCcsXG4gIDU6ICc9PSAyLjAuMC1hbHBoYS54JyxcbiAgNjogJz49IDIuMC4wLWJldGEuMScsXG4gIDc6ICc+PSA0LjAuMCdcbn07XG5cbmNvbnN0IG9iamVjdFR5cGUgPSAnW29iamVjdCBPYmplY3RdJztcblxuZXhwb3J0IGZ1bmN0aW9uIEhhbmRsZWJhcnNFbnZpcm9ubWVudChoZWxwZXJzLCBwYXJ0aWFscywgZGVjb3JhdG9ycykge1xuICB0aGlzLmhlbHBlcnMgPSBoZWxwZXJzIHx8IHt9O1xuICB0aGlzLnBhcnRpYWxzID0gcGFydGlhbHMgfHwge307XG4gIHRoaXMuZGVjb3JhdG9ycyA9IGRlY29yYXRvcnMgfHwge307XG5cbiAgcmVnaXN0ZXJEZWZhdWx0SGVscGVycyh0aGlzKTtcbiAgcmVnaXN0ZXJEZWZhdWx0RGVjb3JhdG9ycyh0aGlzKTtcbn1cblxuSGFuZGxlYmFyc0Vudmlyb25tZW50LnByb3RvdHlwZSA9IHtcbiAgY29uc3RydWN0b3I6IEhhbmRsZWJhcnNFbnZpcm9ubWVudCxcblxuICBsb2dnZXI6IGxvZ2dlcixcbiAgbG9nOiBsb2dnZXIubG9nLFxuXG4gIHJlZ2lzdGVySGVscGVyOiBmdW5jdGlvbihuYW1lLCBmbikge1xuICAgIGlmICh0b1N0cmluZy5jYWxsKG5hbWUpID09PSBvYmplY3RUeXBlKSB7XG4gICAgICBpZiAoZm4pIHsgdGhyb3cgbmV3IEV4Y2VwdGlvbignQXJnIG5vdCBzdXBwb3J0ZWQgd2l0aCBtdWx0aXBsZSBoZWxwZXJzJyk7IH1cbiAgICAgIGV4dGVuZCh0aGlzLmhlbHBlcnMsIG5hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmhlbHBlcnNbbmFtZV0gPSBmbjtcbiAgICB9XG4gIH0sXG4gIHVucmVnaXN0ZXJIZWxwZXI6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBkZWxldGUgdGhpcy5oZWxwZXJzW25hbWVdO1xuICB9LFxuXG4gIHJlZ2lzdGVyUGFydGlhbDogZnVuY3Rpb24obmFtZSwgcGFydGlhbCkge1xuICAgIGlmICh0b1N0cmluZy5jYWxsKG5hbWUpID09PSBvYmplY3RUeXBlKSB7XG4gICAgICBleHRlbmQodGhpcy5wYXJ0aWFscywgbmFtZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0eXBlb2YgcGFydGlhbCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbihgQXR0ZW1wdGluZyB0byByZWdpc3RlciBhIHBhcnRpYWwgY2FsbGVkIFwiJHtuYW1lfVwiIGFzIHVuZGVmaW5lZGApO1xuICAgICAgfVxuICAgICAgdGhpcy5wYXJ0aWFsc1tuYW1lXSA9IHBhcnRpYWw7XG4gICAgfVxuICB9LFxuICB1bnJlZ2lzdGVyUGFydGlhbDogZnVuY3Rpb24obmFtZSkge1xuICAgIGRlbGV0ZSB0aGlzLnBhcnRpYWxzW25hbWVdO1xuICB9LFxuXG4gIHJlZ2lzdGVyRGVjb3JhdG9yOiBmdW5jdGlvbihuYW1lLCBmbikge1xuICAgIGlmICh0b1N0cmluZy5jYWxsKG5hbWUpID09PSBvYmplY3RUeXBlKSB7XG4gICAgICBpZiAoZm4pIHsgdGhyb3cgbmV3IEV4Y2VwdGlvbignQXJnIG5vdCBzdXBwb3J0ZWQgd2l0aCBtdWx0aXBsZSBkZWNvcmF0b3JzJyk7IH1cbiAgICAgIGV4dGVuZCh0aGlzLmRlY29yYXRvcnMsIG5hbWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRlY29yYXRvcnNbbmFtZV0gPSBmbjtcbiAgICB9XG4gIH0sXG4gIHVucmVnaXN0ZXJEZWNvcmF0b3I6IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICBkZWxldGUgdGhpcy5kZWNvcmF0b3JzW25hbWVdO1xuICB9XG59O1xuXG5leHBvcnQgbGV0IGxvZyA9IGxvZ2dlci5sb2c7XG5cbmV4cG9ydCB7Y3JlYXRlRnJhbWUsIGxvZ2dlcn07XG4iLCJpbXBvcnQgcmVnaXN0ZXJJbmxpbmUgZnJvbSAnLi9kZWNvcmF0b3JzL2lubGluZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlckRlZmF1bHREZWNvcmF0b3JzKGluc3RhbmNlKSB7XG4gIHJlZ2lzdGVySW5saW5lKGluc3RhbmNlKTtcbn1cblxuIiwiaW1wb3J0IHtleHRlbmR9IGZyb20gJy4uL3V0aWxzJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAgaW5zdGFuY2UucmVnaXN0ZXJEZWNvcmF0b3IoJ2lubGluZScsIGZ1bmN0aW9uKGZuLCBwcm9wcywgY29udGFpbmVyLCBvcHRpb25zKSB7XG4gICAgbGV0IHJldCA9IGZuO1xuICAgIGlmICghcHJvcHMucGFydGlhbHMpIHtcbiAgICAgIHByb3BzLnBhcnRpYWxzID0ge307XG4gICAgICByZXQgPSBmdW5jdGlvbihjb250ZXh0LCBvcHRpb25zKSB7XG4gICAgICAgIC8vIENyZWF0ZSBhIG5ldyBwYXJ0aWFscyBzdGFjayBmcmFtZSBwcmlvciB0byBleGVjLlxuICAgICAgICBsZXQgb3JpZ2luYWwgPSBjb250YWluZXIucGFydGlhbHM7XG4gICAgICAgIGNvbnRhaW5lci5wYXJ0aWFscyA9IGV4dGVuZCh7fSwgb3JpZ2luYWwsIHByb3BzLnBhcnRpYWxzKTtcbiAgICAgICAgbGV0IHJldCA9IGZuKGNvbnRleHQsIG9wdGlvbnMpO1xuICAgICAgICBjb250YWluZXIucGFydGlhbHMgPSBvcmlnaW5hbDtcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcHJvcHMucGFydGlhbHNbb3B0aW9ucy5hcmdzWzBdXSA9IG9wdGlvbnMuZm47XG5cbiAgICByZXR1cm4gcmV0O1xuICB9KTtcbn1cbiIsIlxuY29uc3QgZXJyb3JQcm9wcyA9IFsnZGVzY3JpcHRpb24nLCAnZmlsZU5hbWUnLCAnbGluZU51bWJlcicsICdtZXNzYWdlJywgJ25hbWUnLCAnbnVtYmVyJywgJ3N0YWNrJ107XG5cbmZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlLCBub2RlKSB7XG4gIGxldCBsb2MgPSBub2RlICYmIG5vZGUubG9jLFxuICAgICAgbGluZSxcbiAgICAgIGNvbHVtbjtcbiAgaWYgKGxvYykge1xuICAgIGxpbmUgPSBsb2Muc3RhcnQubGluZTtcbiAgICBjb2x1bW4gPSBsb2Muc3RhcnQuY29sdW1uO1xuXG4gICAgbWVzc2FnZSArPSAnIC0gJyArIGxpbmUgKyAnOicgKyBjb2x1bW47XG4gIH1cblxuICBsZXQgdG1wID0gRXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgbWVzc2FnZSk7XG5cbiAgLy8gVW5mb3J0dW5hdGVseSBlcnJvcnMgYXJlIG5vdCBlbnVtZXJhYmxlIGluIENocm9tZSAoYXQgbGVhc3QpLCBzbyBgZm9yIHByb3AgaW4gdG1wYCBkb2Vzbid0IHdvcmsuXG4gIGZvciAobGV0IGlkeCA9IDA7IGlkeCA8IGVycm9yUHJvcHMubGVuZ3RoOyBpZHgrKykge1xuICAgIHRoaXNbZXJyb3JQcm9wc1tpZHhdXSA9IHRtcFtlcnJvclByb3BzW2lkeF1dO1xuICB9XG5cbiAgLyogaXN0YW5idWwgaWdub3JlIGVsc2UgKi9cbiAgaWYgKEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKSB7XG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgRXhjZXB0aW9uKTtcbiAgfVxuXG4gIGlmIChsb2MpIHtcbiAgICB0aGlzLmxpbmVOdW1iZXIgPSBsaW5lO1xuICAgIHRoaXMuY29sdW1uID0gY29sdW1uO1xuICB9XG59XG5cbkV4Y2VwdGlvbi5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTtcblxuZXhwb3J0IGRlZmF1bHQgRXhjZXB0aW9uO1xuIiwiaW1wb3J0IHJlZ2lzdGVyQmxvY2tIZWxwZXJNaXNzaW5nIGZyb20gJy4vaGVscGVycy9ibG9jay1oZWxwZXItbWlzc2luZyc7XG5pbXBvcnQgcmVnaXN0ZXJFYWNoIGZyb20gJy4vaGVscGVycy9lYWNoJztcbmltcG9ydCByZWdpc3RlckhlbHBlck1pc3NpbmcgZnJvbSAnLi9oZWxwZXJzL2hlbHBlci1taXNzaW5nJztcbmltcG9ydCByZWdpc3RlcklmIGZyb20gJy4vaGVscGVycy9pZic7XG5pbXBvcnQgcmVnaXN0ZXJMb2cgZnJvbSAnLi9oZWxwZXJzL2xvZyc7XG5pbXBvcnQgcmVnaXN0ZXJMb29rdXAgZnJvbSAnLi9oZWxwZXJzL2xvb2t1cCc7XG5pbXBvcnQgcmVnaXN0ZXJXaXRoIGZyb20gJy4vaGVscGVycy93aXRoJztcblxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyRGVmYXVsdEhlbHBlcnMoaW5zdGFuY2UpIHtcbiAgcmVnaXN0ZXJCbG9ja0hlbHBlck1pc3NpbmcoaW5zdGFuY2UpO1xuICByZWdpc3RlckVhY2goaW5zdGFuY2UpO1xuICByZWdpc3RlckhlbHBlck1pc3NpbmcoaW5zdGFuY2UpO1xuICByZWdpc3RlcklmKGluc3RhbmNlKTtcbiAgcmVnaXN0ZXJMb2coaW5zdGFuY2UpO1xuICByZWdpc3Rlckxvb2t1cChpbnN0YW5jZSk7XG4gIHJlZ2lzdGVyV2l0aChpbnN0YW5jZSk7XG59XG4iLCJpbXBvcnQge2FwcGVuZENvbnRleHRQYXRoLCBjcmVhdGVGcmFtZSwgaXNBcnJheX0gZnJvbSAnLi4vdXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihpbnN0YW5jZSkge1xuICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignYmxvY2tIZWxwZXJNaXNzaW5nJywgZnVuY3Rpb24oY29udGV4dCwgb3B0aW9ucykge1xuICAgIGxldCBpbnZlcnNlID0gb3B0aW9ucy5pbnZlcnNlLFxuICAgICAgICBmbiA9IG9wdGlvbnMuZm47XG5cbiAgICBpZiAoY29udGV4dCA9PT0gdHJ1ZSkge1xuICAgICAgcmV0dXJuIGZuKHRoaXMpO1xuICAgIH0gZWxzZSBpZiAoY29udGV4dCA9PT0gZmFsc2UgfHwgY29udGV4dCA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gaW52ZXJzZSh0aGlzKTtcbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkoY29udGV4dCkpIHtcbiAgICAgIGlmIChjb250ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgaWYgKG9wdGlvbnMuaWRzKSB7XG4gICAgICAgICAgb3B0aW9ucy5pZHMgPSBbb3B0aW9ucy5uYW1lXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBpbnN0YW5jZS5oZWxwZXJzLmVhY2goY29udGV4dCwgb3B0aW9ucyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gaW52ZXJzZSh0aGlzKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKG9wdGlvbnMuZGF0YSAmJiBvcHRpb25zLmlkcykge1xuICAgICAgICBsZXQgZGF0YSA9IGNyZWF0ZUZyYW1lKG9wdGlvbnMuZGF0YSk7XG4gICAgICAgIGRhdGEuY29udGV4dFBhdGggPSBhcHBlbmRDb250ZXh0UGF0aChvcHRpb25zLmRhdGEuY29udGV4dFBhdGgsIG9wdGlvbnMubmFtZSk7XG4gICAgICAgIG9wdGlvbnMgPSB7ZGF0YTogZGF0YX07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmbihjb250ZXh0LCBvcHRpb25zKTtcbiAgICB9XG4gIH0pO1xufVxuIiwiaW1wb3J0IHthcHBlbmRDb250ZXh0UGF0aCwgYmxvY2tQYXJhbXMsIGNyZWF0ZUZyYW1lLCBpc0FycmF5LCBpc0Z1bmN0aW9ufSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgRXhjZXB0aW9uIGZyb20gJy4uL2V4Y2VwdGlvbic7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKGluc3RhbmNlKSB7XG4gIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCdlYWNoJywgZnVuY3Rpb24oY29udGV4dCwgb3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignTXVzdCBwYXNzIGl0ZXJhdG9yIHRvICNlYWNoJyk7XG4gICAgfVxuXG4gICAgbGV0IGZuID0gb3B0aW9ucy5mbixcbiAgICAgICAgaW52ZXJzZSA9IG9wdGlvbnMuaW52ZXJzZSxcbiAgICAgICAgaSA9IDAsXG4gICAgICAgIHJldCA9ICcnLFxuICAgICAgICBkYXRhLFxuICAgICAgICBjb250ZXh0UGF0aDtcblxuICAgIGlmIChvcHRpb25zLmRhdGEgJiYgb3B0aW9ucy5pZHMpIHtcbiAgICAgIGNvbnRleHRQYXRoID0gYXBwZW5kQ29udGV4dFBhdGgob3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoLCBvcHRpb25zLmlkc1swXSkgKyAnLic7XG4gICAgfVxuXG4gICAgaWYgKGlzRnVuY3Rpb24oY29udGV4dCkpIHsgY29udGV4dCA9IGNvbnRleHQuY2FsbCh0aGlzKTsgfVxuXG4gICAgaWYgKG9wdGlvbnMuZGF0YSkge1xuICAgICAgZGF0YSA9IGNyZWF0ZUZyYW1lKG9wdGlvbnMuZGF0YSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZXhlY0l0ZXJhdGlvbihmaWVsZCwgaW5kZXgsIGxhc3QpIHtcbiAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgIGRhdGEua2V5ID0gZmllbGQ7XG4gICAgICAgIGRhdGEuaW5kZXggPSBpbmRleDtcbiAgICAgICAgZGF0YS5maXJzdCA9IGluZGV4ID09PSAwO1xuICAgICAgICBkYXRhLmxhc3QgPSAhIWxhc3Q7XG5cbiAgICAgICAgaWYgKGNvbnRleHRQYXRoKSB7XG4gICAgICAgICAgZGF0YS5jb250ZXh0UGF0aCA9IGNvbnRleHRQYXRoICsgZmllbGQ7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0ID0gcmV0ICsgZm4oY29udGV4dFtmaWVsZF0sIHtcbiAgICAgICAgZGF0YTogZGF0YSxcbiAgICAgICAgYmxvY2tQYXJhbXM6IGJsb2NrUGFyYW1zKFtjb250ZXh0W2ZpZWxkXSwgZmllbGRdLCBbY29udGV4dFBhdGggKyBmaWVsZCwgbnVsbF0pXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY29udGV4dCAmJiB0eXBlb2YgY29udGV4dCA9PT0gJ29iamVjdCcpIHtcbiAgICAgIGlmIChpc0FycmF5KGNvbnRleHQpKSB7XG4gICAgICAgIGZvciAobGV0IGogPSBjb250ZXh0Lmxlbmd0aDsgaSA8IGo7IGkrKykge1xuICAgICAgICAgIGlmIChpIGluIGNvbnRleHQpIHtcbiAgICAgICAgICAgIGV4ZWNJdGVyYXRpb24oaSwgaSwgaSA9PT0gY29udGV4dC5sZW5ndGggLSAxKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldCBwcmlvcktleTtcblxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gY29udGV4dCkge1xuICAgICAgICAgIGlmIChjb250ZXh0Lmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIC8vIFdlJ3JlIHJ1bm5pbmcgdGhlIGl0ZXJhdGlvbnMgb25lIHN0ZXAgb3V0IG9mIHN5bmMgc28gd2UgY2FuIGRldGVjdFxuICAgICAgICAgICAgLy8gdGhlIGxhc3QgaXRlcmF0aW9uIHdpdGhvdXQgaGF2ZSB0byBzY2FuIHRoZSBvYmplY3QgdHdpY2UgYW5kIGNyZWF0ZVxuICAgICAgICAgICAgLy8gYW4gaXRlcm1lZGlhdGUga2V5cyBhcnJheS5cbiAgICAgICAgICAgIGlmIChwcmlvcktleSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgIGV4ZWNJdGVyYXRpb24ocHJpb3JLZXksIGkgLSAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHByaW9yS2V5ID0ga2V5O1xuICAgICAgICAgICAgaSsrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocHJpb3JLZXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGV4ZWNJdGVyYXRpb24ocHJpb3JLZXksIGkgLSAxLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpID09PSAwKSB7XG4gICAgICByZXQgPSBpbnZlcnNlKHRoaXMpO1xuICAgIH1cblxuICAgIHJldHVybiByZXQ7XG4gIH0pO1xufVxuIiwiaW1wb3J0IEV4Y2VwdGlvbiBmcm9tICcuLi9leGNlcHRpb24nO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihpbnN0YW5jZSkge1xuICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignaGVscGVyTWlzc2luZycsIGZ1bmN0aW9uKC8qIFthcmdzLCBdb3B0aW9ucyAqLykge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7XG4gICAgICAvLyBBIG1pc3NpbmcgZmllbGQgaW4gYSB7e2Zvb319IGNvbnN0cnVjdC5cbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFNvbWVvbmUgaXMgYWN0dWFsbHkgdHJ5aW5nIHRvIGNhbGwgc29tZXRoaW5nLCBibG93IHVwLlxuICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignTWlzc2luZyBoZWxwZXI6IFwiJyArIGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV0ubmFtZSArICdcIicpO1xuICAgIH1cbiAgfSk7XG59XG4iLCJpbXBvcnQge2lzRW1wdHksIGlzRnVuY3Rpb259IGZyb20gJy4uL3V0aWxzJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ2lmJywgZnVuY3Rpb24oY29uZGl0aW9uYWwsIG9wdGlvbnMpIHtcbiAgICBpZiAoaXNGdW5jdGlvbihjb25kaXRpb25hbCkpIHsgY29uZGl0aW9uYWwgPSBjb25kaXRpb25hbC5jYWxsKHRoaXMpOyB9XG5cbiAgICAvLyBEZWZhdWx0IGJlaGF2aW9yIGlzIHRvIHJlbmRlciB0aGUgcG9zaXRpdmUgcGF0aCBpZiB0aGUgdmFsdWUgaXMgdHJ1dGh5IGFuZCBub3QgZW1wdHkuXG4gICAgLy8gVGhlIGBpbmNsdWRlWmVyb2Agb3B0aW9uIG1heSBiZSBzZXQgdG8gdHJlYXQgdGhlIGNvbmR0aW9uYWwgYXMgcHVyZWx5IG5vdCBlbXB0eSBiYXNlZCBvbiB0aGVcbiAgICAvLyBiZWhhdmlvciBvZiBpc0VtcHR5LiBFZmZlY3RpdmVseSB0aGlzIGRldGVybWluZXMgaWYgMCBpcyBoYW5kbGVkIGJ5IHRoZSBwb3NpdGl2ZSBwYXRoIG9yIG5lZ2F0aXZlLlxuICAgIGlmICgoIW9wdGlvbnMuaGFzaC5pbmNsdWRlWmVybyAmJiAhY29uZGl0aW9uYWwpIHx8IGlzRW1wdHkoY29uZGl0aW9uYWwpKSB7XG4gICAgICByZXR1cm4gb3B0aW9ucy5pbnZlcnNlKHRoaXMpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gb3B0aW9ucy5mbih0aGlzKTtcbiAgICB9XG4gIH0pO1xuXG4gIGluc3RhbmNlLnJlZ2lzdGVySGVscGVyKCd1bmxlc3MnLCBmdW5jdGlvbihjb25kaXRpb25hbCwgb3B0aW9ucykge1xuICAgIHJldHVybiBpbnN0YW5jZS5oZWxwZXJzWydpZiddLmNhbGwodGhpcywgY29uZGl0aW9uYWwsIHtmbjogb3B0aW9ucy5pbnZlcnNlLCBpbnZlcnNlOiBvcHRpb25zLmZuLCBoYXNoOiBvcHRpb25zLmhhc2h9KTtcbiAgfSk7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbihpbnN0YW5jZSkge1xuICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignbG9nJywgZnVuY3Rpb24oLyogbWVzc2FnZSwgb3B0aW9ucyAqLykge1xuICAgIGxldCBhcmdzID0gW3VuZGVmaW5lZF0sXG4gICAgICAgIG9wdGlvbnMgPSBhcmd1bWVudHNbYXJndW1lbnRzLmxlbmd0aCAtIDFdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgYXJncy5wdXNoKGFyZ3VtZW50c1tpXSk7XG4gICAgfVxuXG4gICAgbGV0IGxldmVsID0gMTtcbiAgICBpZiAob3B0aW9ucy5oYXNoLmxldmVsICE9IG51bGwpIHtcbiAgICAgIGxldmVsID0gb3B0aW9ucy5oYXNoLmxldmVsO1xuICAgIH0gZWxzZSBpZiAob3B0aW9ucy5kYXRhICYmIG9wdGlvbnMuZGF0YS5sZXZlbCAhPSBudWxsKSB7XG4gICAgICBsZXZlbCA9IG9wdGlvbnMuZGF0YS5sZXZlbDtcbiAgICB9XG4gICAgYXJnc1swXSA9IGxldmVsO1xuXG4gICAgaW5zdGFuY2UubG9nKC4uLiBhcmdzKTtcbiAgfSk7XG59XG4iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbihpbnN0YW5jZSkge1xuICBpbnN0YW5jZS5yZWdpc3RlckhlbHBlcignbG9va3VwJywgZnVuY3Rpb24ob2JqLCBmaWVsZCkge1xuICAgIHJldHVybiBvYmogJiYgb2JqW2ZpZWxkXTtcbiAgfSk7XG59XG4iLCJpbXBvcnQge2FwcGVuZENvbnRleHRQYXRoLCBibG9ja1BhcmFtcywgY3JlYXRlRnJhbWUsIGlzRW1wdHksIGlzRnVuY3Rpb259IGZyb20gJy4uL3V0aWxzJztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oaW5zdGFuY2UpIHtcbiAgaW5zdGFuY2UucmVnaXN0ZXJIZWxwZXIoJ3dpdGgnLCBmdW5jdGlvbihjb250ZXh0LCBvcHRpb25zKSB7XG4gICAgaWYgKGlzRnVuY3Rpb24oY29udGV4dCkpIHsgY29udGV4dCA9IGNvbnRleHQuY2FsbCh0aGlzKTsgfVxuXG4gICAgbGV0IGZuID0gb3B0aW9ucy5mbjtcblxuICAgIGlmICghaXNFbXB0eShjb250ZXh0KSkge1xuICAgICAgbGV0IGRhdGEgPSBvcHRpb25zLmRhdGE7XG4gICAgICBpZiAob3B0aW9ucy5kYXRhICYmIG9wdGlvbnMuaWRzKSB7XG4gICAgICAgIGRhdGEgPSBjcmVhdGVGcmFtZShvcHRpb25zLmRhdGEpO1xuICAgICAgICBkYXRhLmNvbnRleHRQYXRoID0gYXBwZW5kQ29udGV4dFBhdGgob3B0aW9ucy5kYXRhLmNvbnRleHRQYXRoLCBvcHRpb25zLmlkc1swXSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBmbihjb250ZXh0LCB7XG4gICAgICAgIGRhdGE6IGRhdGEsXG4gICAgICAgIGJsb2NrUGFyYW1zOiBibG9ja1BhcmFtcyhbY29udGV4dF0sIFtkYXRhICYmIGRhdGEuY29udGV4dFBhdGhdKVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBvcHRpb25zLmludmVyc2UodGhpcyk7XG4gICAgfVxuICB9KTtcbn1cbiIsImltcG9ydCB7aW5kZXhPZn0gZnJvbSAnLi91dGlscyc7XG5cbmxldCBsb2dnZXIgPSB7XG4gIG1ldGhvZE1hcDogWydkZWJ1ZycsICdpbmZvJywgJ3dhcm4nLCAnZXJyb3InXSxcbiAgbGV2ZWw6ICdpbmZvJyxcblxuICAvLyBNYXBzIGEgZ2l2ZW4gbGV2ZWwgdmFsdWUgdG8gdGhlIGBtZXRob2RNYXBgIGluZGV4ZXMgYWJvdmUuXG4gIGxvb2t1cExldmVsOiBmdW5jdGlvbihsZXZlbCkge1xuICAgIGlmICh0eXBlb2YgbGV2ZWwgPT09ICdzdHJpbmcnKSB7XG4gICAgICBsZXQgbGV2ZWxNYXAgPSBpbmRleE9mKGxvZ2dlci5tZXRob2RNYXAsIGxldmVsLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgaWYgKGxldmVsTWFwID49IDApIHtcbiAgICAgICAgbGV2ZWwgPSBsZXZlbE1hcDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxldmVsID0gcGFyc2VJbnQobGV2ZWwsIDEwKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbGV2ZWw7XG4gIH0sXG5cbiAgLy8gQ2FuIGJlIG92ZXJyaWRkZW4gaW4gdGhlIGhvc3QgZW52aXJvbm1lbnRcbiAgbG9nOiBmdW5jdGlvbihsZXZlbCwgLi4ubWVzc2FnZSkge1xuICAgIGxldmVsID0gbG9nZ2VyLmxvb2t1cExldmVsKGxldmVsKTtcblxuICAgIGlmICh0eXBlb2YgY29uc29sZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbG9nZ2VyLmxvb2t1cExldmVsKGxvZ2dlci5sZXZlbCkgPD0gbGV2ZWwpIHtcbiAgICAgIGxldCBtZXRob2QgPSBsb2dnZXIubWV0aG9kTWFwW2xldmVsXTtcbiAgICAgIGlmICghY29uc29sZVttZXRob2RdKSB7ICAgLy8gZXNsaW50LWRpc2FibGUtbGluZSBuby1jb25zb2xlXG4gICAgICAgIG1ldGhvZCA9ICdsb2cnO1xuICAgICAgfVxuICAgICAgY29uc29sZVttZXRob2RdKC4uLm1lc3NhZ2UpOyAgICAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWNvbnNvbGVcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGxvZ2dlcjtcbiIsIi8qIGdsb2JhbCB3aW5kb3cgKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKEhhbmRsZWJhcnMpIHtcbiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbiAgbGV0IHJvb3QgPSB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHdpbmRvdyxcbiAgICAgICRIYW5kbGViYXJzID0gcm9vdC5IYW5kbGViYXJzO1xuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICBIYW5kbGViYXJzLm5vQ29uZmxpY3QgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAocm9vdC5IYW5kbGViYXJzID09PSBIYW5kbGViYXJzKSB7XG4gICAgICByb290LkhhbmRsZWJhcnMgPSAkSGFuZGxlYmFycztcbiAgICB9XG4gICAgcmV0dXJuIEhhbmRsZWJhcnM7XG4gIH07XG59XG4iLCJpbXBvcnQgKiBhcyBVdGlscyBmcm9tICcuL3V0aWxzJztcbmltcG9ydCBFeGNlcHRpb24gZnJvbSAnLi9leGNlcHRpb24nO1xuaW1wb3J0IHsgQ09NUElMRVJfUkVWSVNJT04sIFJFVklTSU9OX0NIQU5HRVMsIGNyZWF0ZUZyYW1lIH0gZnJvbSAnLi9iYXNlJztcblxuZXhwb3J0IGZ1bmN0aW9uIGNoZWNrUmV2aXNpb24oY29tcGlsZXJJbmZvKSB7XG4gIGNvbnN0IGNvbXBpbGVyUmV2aXNpb24gPSBjb21waWxlckluZm8gJiYgY29tcGlsZXJJbmZvWzBdIHx8IDEsXG4gICAgICAgIGN1cnJlbnRSZXZpc2lvbiA9IENPTVBJTEVSX1JFVklTSU9OO1xuXG4gIGlmIChjb21waWxlclJldmlzaW9uICE9PSBjdXJyZW50UmV2aXNpb24pIHtcbiAgICBpZiAoY29tcGlsZXJSZXZpc2lvbiA8IGN1cnJlbnRSZXZpc2lvbikge1xuICAgICAgY29uc3QgcnVudGltZVZlcnNpb25zID0gUkVWSVNJT05fQ0hBTkdFU1tjdXJyZW50UmV2aXNpb25dLFxuICAgICAgICAgICAgY29tcGlsZXJWZXJzaW9ucyA9IFJFVklTSU9OX0NIQU5HRVNbY29tcGlsZXJSZXZpc2lvbl07XG4gICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdUZW1wbGF0ZSB3YXMgcHJlY29tcGlsZWQgd2l0aCBhbiBvbGRlciB2ZXJzaW9uIG9mIEhhbmRsZWJhcnMgdGhhbiB0aGUgY3VycmVudCBydW50aW1lLiAnICtcbiAgICAgICAgICAgICdQbGVhc2UgdXBkYXRlIHlvdXIgcHJlY29tcGlsZXIgdG8gYSBuZXdlciB2ZXJzaW9uICgnICsgcnVudGltZVZlcnNpb25zICsgJykgb3IgZG93bmdyYWRlIHlvdXIgcnVudGltZSB0byBhbiBvbGRlciB2ZXJzaW9uICgnICsgY29tcGlsZXJWZXJzaW9ucyArICcpLicpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBVc2UgdGhlIGVtYmVkZGVkIHZlcnNpb24gaW5mbyBzaW5jZSB0aGUgcnVudGltZSBkb2Vzbid0IGtub3cgYWJvdXQgdGhpcyByZXZpc2lvbiB5ZXRcbiAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ1RlbXBsYXRlIHdhcyBwcmVjb21waWxlZCB3aXRoIGEgbmV3ZXIgdmVyc2lvbiBvZiBIYW5kbGViYXJzIHRoYW4gdGhlIGN1cnJlbnQgcnVudGltZS4gJyArXG4gICAgICAgICAgICAnUGxlYXNlIHVwZGF0ZSB5b3VyIHJ1bnRpbWUgdG8gYSBuZXdlciB2ZXJzaW9uICgnICsgY29tcGlsZXJJbmZvWzFdICsgJykuJyk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0ZW1wbGF0ZSh0ZW1wbGF0ZVNwZWMsIGVudikge1xuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICBpZiAoIWVudikge1xuICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ05vIGVudmlyb25tZW50IHBhc3NlZCB0byB0ZW1wbGF0ZScpO1xuICB9XG4gIGlmICghdGVtcGxhdGVTcGVjIHx8ICF0ZW1wbGF0ZVNwZWMubWFpbikge1xuICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ1Vua25vd24gdGVtcGxhdGUgb2JqZWN0OiAnICsgdHlwZW9mIHRlbXBsYXRlU3BlYyk7XG4gIH1cblxuICB0ZW1wbGF0ZVNwZWMubWFpbi5kZWNvcmF0b3IgPSB0ZW1wbGF0ZVNwZWMubWFpbl9kO1xuXG4gIC8vIE5vdGU6IFVzaW5nIGVudi5WTSByZWZlcmVuY2VzIHJhdGhlciB0aGFuIGxvY2FsIHZhciByZWZlcmVuY2VzIHRocm91Z2hvdXQgdGhpcyBzZWN0aW9uIHRvIGFsbG93XG4gIC8vIGZvciBleHRlcm5hbCB1c2VycyB0byBvdmVycmlkZSB0aGVzZSBhcyBwc3VlZG8tc3VwcG9ydGVkIEFQSXMuXG4gIGVudi5WTS5jaGVja1JldmlzaW9uKHRlbXBsYXRlU3BlYy5jb21waWxlcik7XG5cbiAgZnVuY3Rpb24gaW52b2tlUGFydGlhbFdyYXBwZXIocGFydGlhbCwgY29udGV4dCwgb3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zLmhhc2gpIHtcbiAgICAgIGNvbnRleHQgPSBVdGlscy5leHRlbmQoe30sIGNvbnRleHQsIG9wdGlvbnMuaGFzaCk7XG4gICAgICBpZiAob3B0aW9ucy5pZHMpIHtcbiAgICAgICAgb3B0aW9ucy5pZHNbMF0gPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHBhcnRpYWwgPSBlbnYuVk0ucmVzb2x2ZVBhcnRpYWwuY2FsbCh0aGlzLCBwYXJ0aWFsLCBjb250ZXh0LCBvcHRpb25zKTtcbiAgICBsZXQgcmVzdWx0ID0gZW52LlZNLmludm9rZVBhcnRpYWwuY2FsbCh0aGlzLCBwYXJ0aWFsLCBjb250ZXh0LCBvcHRpb25zKTtcblxuICAgIGlmIChyZXN1bHQgPT0gbnVsbCAmJiBlbnYuY29tcGlsZSkge1xuICAgICAgb3B0aW9ucy5wYXJ0aWFsc1tvcHRpb25zLm5hbWVdID0gZW52LmNvbXBpbGUocGFydGlhbCwgdGVtcGxhdGVTcGVjLmNvbXBpbGVyT3B0aW9ucywgZW52KTtcbiAgICAgIHJlc3VsdCA9IG9wdGlvbnMucGFydGlhbHNbb3B0aW9ucy5uYW1lXShjb250ZXh0LCBvcHRpb25zKTtcbiAgICB9XG4gICAgaWYgKHJlc3VsdCAhPSBudWxsKSB7XG4gICAgICBpZiAob3B0aW9ucy5pbmRlbnQpIHtcbiAgICAgICAgbGV0IGxpbmVzID0gcmVzdWx0LnNwbGl0KCdcXG4nKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGwgPSBsaW5lcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICBpZiAoIWxpbmVzW2ldICYmIGkgKyAxID09PSBsKSB7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBsaW5lc1tpXSA9IG9wdGlvbnMuaW5kZW50ICsgbGluZXNbaV07XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ID0gbGluZXMuam9pbignXFxuJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXhjZXB0aW9uKCdUaGUgcGFydGlhbCAnICsgb3B0aW9ucy5uYW1lICsgJyBjb3VsZCBub3QgYmUgY29tcGlsZWQgd2hlbiBydW5uaW5nIGluIHJ1bnRpbWUtb25seSBtb2RlJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gSnVzdCBhZGQgd2F0ZXJcbiAgbGV0IGNvbnRhaW5lciA9IHtcbiAgICBzdHJpY3Q6IGZ1bmN0aW9uKG9iaiwgbmFtZSkge1xuICAgICAgaWYgKCEobmFtZSBpbiBvYmopKSB7XG4gICAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ1wiJyArIG5hbWUgKyAnXCIgbm90IGRlZmluZWQgaW4gJyArIG9iaik7XG4gICAgICB9XG4gICAgICByZXR1cm4gb2JqW25hbWVdO1xuICAgIH0sXG4gICAgbG9va3VwOiBmdW5jdGlvbihkZXB0aHMsIG5hbWUpIHtcbiAgICAgIGNvbnN0IGxlbiA9IGRlcHRocy5sZW5ndGg7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmIChkZXB0aHNbaV0gJiYgZGVwdGhzW2ldW25hbWVdICE9IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gZGVwdGhzW2ldW25hbWVdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBsYW1iZGE6IGZ1bmN0aW9uKGN1cnJlbnQsIGNvbnRleHQpIHtcbiAgICAgIHJldHVybiB0eXBlb2YgY3VycmVudCA9PT0gJ2Z1bmN0aW9uJyA/IGN1cnJlbnQuY2FsbChjb250ZXh0KSA6IGN1cnJlbnQ7XG4gICAgfSxcblxuICAgIGVzY2FwZUV4cHJlc3Npb246IFV0aWxzLmVzY2FwZUV4cHJlc3Npb24sXG4gICAgaW52b2tlUGFydGlhbDogaW52b2tlUGFydGlhbFdyYXBwZXIsXG5cbiAgICBmbjogZnVuY3Rpb24oaSkge1xuICAgICAgbGV0IHJldCA9IHRlbXBsYXRlU3BlY1tpXTtcbiAgICAgIHJldC5kZWNvcmF0b3IgPSB0ZW1wbGF0ZVNwZWNbaSArICdfZCddO1xuICAgICAgcmV0dXJuIHJldDtcbiAgICB9LFxuXG4gICAgcHJvZ3JhbXM6IFtdLFxuICAgIHByb2dyYW06IGZ1bmN0aW9uKGksIGRhdGEsIGRlY2xhcmVkQmxvY2tQYXJhbXMsIGJsb2NrUGFyYW1zLCBkZXB0aHMpIHtcbiAgICAgIGxldCBwcm9ncmFtV3JhcHBlciA9IHRoaXMucHJvZ3JhbXNbaV0sXG4gICAgICAgICAgZm4gPSB0aGlzLmZuKGkpO1xuICAgICAgaWYgKGRhdGEgfHwgZGVwdGhzIHx8IGJsb2NrUGFyYW1zIHx8IGRlY2xhcmVkQmxvY2tQYXJhbXMpIHtcbiAgICAgICAgcHJvZ3JhbVdyYXBwZXIgPSB3cmFwUHJvZ3JhbSh0aGlzLCBpLCBmbiwgZGF0YSwgZGVjbGFyZWRCbG9ja1BhcmFtcywgYmxvY2tQYXJhbXMsIGRlcHRocyk7XG4gICAgICB9IGVsc2UgaWYgKCFwcm9ncmFtV3JhcHBlcikge1xuICAgICAgICBwcm9ncmFtV3JhcHBlciA9IHRoaXMucHJvZ3JhbXNbaV0gPSB3cmFwUHJvZ3JhbSh0aGlzLCBpLCBmbik7XG4gICAgICB9XG4gICAgICByZXR1cm4gcHJvZ3JhbVdyYXBwZXI7XG4gICAgfSxcblxuICAgIGRhdGE6IGZ1bmN0aW9uKHZhbHVlLCBkZXB0aCkge1xuICAgICAgd2hpbGUgKHZhbHVlICYmIGRlcHRoLS0pIHtcbiAgICAgICAgdmFsdWUgPSB2YWx1ZS5fcGFyZW50O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH0sXG4gICAgbWVyZ2U6IGZ1bmN0aW9uKHBhcmFtLCBjb21tb24pIHtcbiAgICAgIGxldCBvYmogPSBwYXJhbSB8fCBjb21tb247XG5cbiAgICAgIGlmIChwYXJhbSAmJiBjb21tb24gJiYgKHBhcmFtICE9PSBjb21tb24pKSB7XG4gICAgICAgIG9iaiA9IFV0aWxzLmV4dGVuZCh7fSwgY29tbW9uLCBwYXJhbSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBvYmo7XG4gICAgfSxcblxuICAgIG5vb3A6IGVudi5WTS5ub29wLFxuICAgIGNvbXBpbGVySW5mbzogdGVtcGxhdGVTcGVjLmNvbXBpbGVyXG4gIH07XG5cbiAgZnVuY3Rpb24gcmV0KGNvbnRleHQsIG9wdGlvbnMgPSB7fSkge1xuICAgIGxldCBkYXRhID0gb3B0aW9ucy5kYXRhO1xuXG4gICAgcmV0Ll9zZXR1cChvcHRpb25zKTtcbiAgICBpZiAoIW9wdGlvbnMucGFydGlhbCAmJiB0ZW1wbGF0ZVNwZWMudXNlRGF0YSkge1xuICAgICAgZGF0YSA9IGluaXREYXRhKGNvbnRleHQsIGRhdGEpO1xuICAgIH1cbiAgICBsZXQgZGVwdGhzLFxuICAgICAgICBibG9ja1BhcmFtcyA9IHRlbXBsYXRlU3BlYy51c2VCbG9ja1BhcmFtcyA/IFtdIDogdW5kZWZpbmVkO1xuICAgIGlmICh0ZW1wbGF0ZVNwZWMudXNlRGVwdGhzKSB7XG4gICAgICBpZiAob3B0aW9ucy5kZXB0aHMpIHtcbiAgICAgICAgZGVwdGhzID0gY29udGV4dCAhPT0gb3B0aW9ucy5kZXB0aHNbMF0gPyBbY29udGV4dF0uY29uY2F0KG9wdGlvbnMuZGVwdGhzKSA6IG9wdGlvbnMuZGVwdGhzO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGVwdGhzID0gW2NvbnRleHRdO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG1haW4oY29udGV4dC8qLCBvcHRpb25zKi8pIHtcbiAgICAgIHJldHVybiAnJyArIHRlbXBsYXRlU3BlYy5tYWluKGNvbnRhaW5lciwgY29udGV4dCwgY29udGFpbmVyLmhlbHBlcnMsIGNvbnRhaW5lci5wYXJ0aWFscywgZGF0YSwgYmxvY2tQYXJhbXMsIGRlcHRocyk7XG4gICAgfVxuICAgIG1haW4gPSBleGVjdXRlRGVjb3JhdG9ycyh0ZW1wbGF0ZVNwZWMubWFpbiwgbWFpbiwgY29udGFpbmVyLCBvcHRpb25zLmRlcHRocyB8fCBbXSwgZGF0YSwgYmxvY2tQYXJhbXMpO1xuICAgIHJldHVybiBtYWluKGNvbnRleHQsIG9wdGlvbnMpO1xuICB9XG4gIHJldC5pc1RvcCA9IHRydWU7XG5cbiAgcmV0Ll9zZXR1cCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcbiAgICBpZiAoIW9wdGlvbnMucGFydGlhbCkge1xuICAgICAgY29udGFpbmVyLmhlbHBlcnMgPSBjb250YWluZXIubWVyZ2Uob3B0aW9ucy5oZWxwZXJzLCBlbnYuaGVscGVycyk7XG5cbiAgICAgIGlmICh0ZW1wbGF0ZVNwZWMudXNlUGFydGlhbCkge1xuICAgICAgICBjb250YWluZXIucGFydGlhbHMgPSBjb250YWluZXIubWVyZ2Uob3B0aW9ucy5wYXJ0aWFscywgZW52LnBhcnRpYWxzKTtcbiAgICAgIH1cbiAgICAgIGlmICh0ZW1wbGF0ZVNwZWMudXNlUGFydGlhbCB8fCB0ZW1wbGF0ZVNwZWMudXNlRGVjb3JhdG9ycykge1xuICAgICAgICBjb250YWluZXIuZGVjb3JhdG9ycyA9IGNvbnRhaW5lci5tZXJnZShvcHRpb25zLmRlY29yYXRvcnMsIGVudi5kZWNvcmF0b3JzKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29udGFpbmVyLmhlbHBlcnMgPSBvcHRpb25zLmhlbHBlcnM7XG4gICAgICBjb250YWluZXIucGFydGlhbHMgPSBvcHRpb25zLnBhcnRpYWxzO1xuICAgICAgY29udGFpbmVyLmRlY29yYXRvcnMgPSBvcHRpb25zLmRlY29yYXRvcnM7XG4gICAgfVxuICB9O1xuXG4gIHJldC5fY2hpbGQgPSBmdW5jdGlvbihpLCBkYXRhLCBibG9ja1BhcmFtcywgZGVwdGhzKSB7XG4gICAgaWYgKHRlbXBsYXRlU3BlYy51c2VCbG9ja1BhcmFtcyAmJiAhYmxvY2tQYXJhbXMpIHtcbiAgICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ211c3QgcGFzcyBibG9jayBwYXJhbXMnKTtcbiAgICB9XG4gICAgaWYgKHRlbXBsYXRlU3BlYy51c2VEZXB0aHMgJiYgIWRlcHRocykge1xuICAgICAgdGhyb3cgbmV3IEV4Y2VwdGlvbignbXVzdCBwYXNzIHBhcmVudCBkZXB0aHMnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gd3JhcFByb2dyYW0oY29udGFpbmVyLCBpLCB0ZW1wbGF0ZVNwZWNbaV0sIGRhdGEsIDAsIGJsb2NrUGFyYW1zLCBkZXB0aHMpO1xuICB9O1xuICByZXR1cm4gcmV0O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gd3JhcFByb2dyYW0oY29udGFpbmVyLCBpLCBmbiwgZGF0YSwgZGVjbGFyZWRCbG9ja1BhcmFtcywgYmxvY2tQYXJhbXMsIGRlcHRocykge1xuICBmdW5jdGlvbiBwcm9nKGNvbnRleHQsIG9wdGlvbnMgPSB7fSkge1xuICAgIGxldCBjdXJyZW50RGVwdGhzID0gZGVwdGhzO1xuICAgIGlmIChkZXB0aHMgJiYgY29udGV4dCAhPT0gZGVwdGhzWzBdKSB7XG4gICAgICBjdXJyZW50RGVwdGhzID0gW2NvbnRleHRdLmNvbmNhdChkZXB0aHMpO1xuICAgIH1cblxuICAgIHJldHVybiBmbihjb250YWluZXIsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIGNvbnRhaW5lci5oZWxwZXJzLCBjb250YWluZXIucGFydGlhbHMsXG4gICAgICAgIG9wdGlvbnMuZGF0YSB8fCBkYXRhLFxuICAgICAgICBibG9ja1BhcmFtcyAmJiBbb3B0aW9ucy5ibG9ja1BhcmFtc10uY29uY2F0KGJsb2NrUGFyYW1zKSxcbiAgICAgICAgY3VycmVudERlcHRocyk7XG4gIH1cblxuICBwcm9nID0gZXhlY3V0ZURlY29yYXRvcnMoZm4sIHByb2csIGNvbnRhaW5lciwgZGVwdGhzLCBkYXRhLCBibG9ja1BhcmFtcyk7XG5cbiAgcHJvZy5wcm9ncmFtID0gaTtcbiAgcHJvZy5kZXB0aCA9IGRlcHRocyA/IGRlcHRocy5sZW5ndGggOiAwO1xuICBwcm9nLmJsb2NrUGFyYW1zID0gZGVjbGFyZWRCbG9ja1BhcmFtcyB8fCAwO1xuICByZXR1cm4gcHJvZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVQYXJ0aWFsKHBhcnRpYWwsIGNvbnRleHQsIG9wdGlvbnMpIHtcbiAgaWYgKCFwYXJ0aWFsKSB7XG4gICAgaWYgKG9wdGlvbnMubmFtZSA9PT0gJ0BwYXJ0aWFsLWJsb2NrJykge1xuICAgICAgcGFydGlhbCA9IG9wdGlvbnMuZGF0YVsncGFydGlhbC1ibG9jayddO1xuICAgIH0gZWxzZSB7XG4gICAgICBwYXJ0aWFsID0gb3B0aW9ucy5wYXJ0aWFsc1tvcHRpb25zLm5hbWVdO1xuICAgIH1cbiAgfSBlbHNlIGlmICghcGFydGlhbC5jYWxsICYmICFvcHRpb25zLm5hbWUpIHtcbiAgICAvLyBUaGlzIGlzIGEgZHluYW1pYyBwYXJ0aWFsIHRoYXQgcmV0dXJuZWQgYSBzdHJpbmdcbiAgICBvcHRpb25zLm5hbWUgPSBwYXJ0aWFsO1xuICAgIHBhcnRpYWwgPSBvcHRpb25zLnBhcnRpYWxzW3BhcnRpYWxdO1xuICB9XG4gIHJldHVybiBwYXJ0aWFsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW52b2tlUGFydGlhbChwYXJ0aWFsLCBjb250ZXh0LCBvcHRpb25zKSB7XG4gIG9wdGlvbnMucGFydGlhbCA9IHRydWU7XG4gIGlmIChvcHRpb25zLmlkcykge1xuICAgIG9wdGlvbnMuZGF0YS5jb250ZXh0UGF0aCA9IG9wdGlvbnMuaWRzWzBdIHx8IG9wdGlvbnMuZGF0YS5jb250ZXh0UGF0aDtcbiAgfVxuXG4gIGxldCBwYXJ0aWFsQmxvY2s7XG4gIGlmIChvcHRpb25zLmZuICYmIG9wdGlvbnMuZm4gIT09IG5vb3ApIHtcbiAgICBvcHRpb25zLmRhdGEgPSBjcmVhdGVGcmFtZShvcHRpb25zLmRhdGEpO1xuICAgIHBhcnRpYWxCbG9jayA9IG9wdGlvbnMuZGF0YVsncGFydGlhbC1ibG9jayddID0gb3B0aW9ucy5mbjtcblxuICAgIGlmIChwYXJ0aWFsQmxvY2sucGFydGlhbHMpIHtcbiAgICAgIG9wdGlvbnMucGFydGlhbHMgPSBVdGlscy5leHRlbmQoe30sIG9wdGlvbnMucGFydGlhbHMsIHBhcnRpYWxCbG9jay5wYXJ0aWFscyk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHBhcnRpYWwgPT09IHVuZGVmaW5lZCAmJiBwYXJ0aWFsQmxvY2spIHtcbiAgICBwYXJ0aWFsID0gcGFydGlhbEJsb2NrO1xuICB9XG5cbiAgaWYgKHBhcnRpYWwgPT09IHVuZGVmaW5lZCkge1xuICAgIHRocm93IG5ldyBFeGNlcHRpb24oJ1RoZSBwYXJ0aWFsICcgKyBvcHRpb25zLm5hbWUgKyAnIGNvdWxkIG5vdCBiZSBmb3VuZCcpO1xuICB9IGVsc2UgaWYgKHBhcnRpYWwgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgIHJldHVybiBwYXJ0aWFsKGNvbnRleHQsIG9wdGlvbnMpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub29wKCkgeyByZXR1cm4gJyc7IH1cblxuZnVuY3Rpb24gaW5pdERhdGEoY29udGV4dCwgZGF0YSkge1xuICBpZiAoIWRhdGEgfHwgISgncm9vdCcgaW4gZGF0YSkpIHtcbiAgICBkYXRhID0gZGF0YSA/IGNyZWF0ZUZyYW1lKGRhdGEpIDoge307XG4gICAgZGF0YS5yb290ID0gY29udGV4dDtcbiAgfVxuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gZXhlY3V0ZURlY29yYXRvcnMoZm4sIHByb2csIGNvbnRhaW5lciwgZGVwdGhzLCBkYXRhLCBibG9ja1BhcmFtcykge1xuICBpZiAoZm4uZGVjb3JhdG9yKSB7XG4gICAgbGV0IHByb3BzID0ge307XG4gICAgcHJvZyA9IGZuLmRlY29yYXRvcihwcm9nLCBwcm9wcywgY29udGFpbmVyLCBkZXB0aHMgJiYgZGVwdGhzWzBdLCBkYXRhLCBibG9ja1BhcmFtcywgZGVwdGhzKTtcbiAgICBVdGlscy5leHRlbmQocHJvZywgcHJvcHMpO1xuICB9XG4gIHJldHVybiBwcm9nO1xufVxuIiwiLy8gQnVpbGQgb3V0IG91ciBiYXNpYyBTYWZlU3RyaW5nIHR5cGVcbmZ1bmN0aW9uIFNhZmVTdHJpbmcoc3RyaW5nKSB7XG4gIHRoaXMuc3RyaW5nID0gc3RyaW5nO1xufVxuXG5TYWZlU3RyaW5nLnByb3RvdHlwZS50b1N0cmluZyA9IFNhZmVTdHJpbmcucHJvdG90eXBlLnRvSFRNTCA9IGZ1bmN0aW9uKCkge1xuICByZXR1cm4gJycgKyB0aGlzLnN0cmluZztcbn07XG5cbmV4cG9ydCBkZWZhdWx0IFNhZmVTdHJpbmc7XG4iLCJjb25zdCBlc2NhcGUgPSB7XG4gICcmJzogJyZhbXA7JyxcbiAgJzwnOiAnJmx0OycsXG4gICc+JzogJyZndDsnLFxuICAnXCInOiAnJnF1b3Q7JyxcbiAgXCInXCI6ICcmI3gyNzsnLFxuICAnYCc6ICcmI3g2MDsnLFxuICAnPSc6ICcmI3gzRDsnXG59O1xuXG5jb25zdCBiYWRDaGFycyA9IC9bJjw+XCInYD1dL2csXG4gICAgICBwb3NzaWJsZSA9IC9bJjw+XCInYD1dLztcblxuZnVuY3Rpb24gZXNjYXBlQ2hhcihjaHIpIHtcbiAgcmV0dXJuIGVzY2FwZVtjaHJdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5kKG9iai8qICwgLi4uc291cmNlICovKSB7XG4gIGZvciAobGV0IGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgZm9yIChsZXQga2V5IGluIGFyZ3VtZW50c1tpXSkge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhcmd1bWVudHNbaV0sIGtleSkpIHtcbiAgICAgICAgb2JqW2tleV0gPSBhcmd1bWVudHNbaV1ba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gb2JqO1xufVxuXG5leHBvcnQgbGV0IHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuLy8gU291cmNlZCBmcm9tIGxvZGFzaFxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2Jlc3RpZWpzL2xvZGFzaC9ibG9iL21hc3Rlci9MSUNFTlNFLnR4dFxuLyogZXNsaW50LWRpc2FibGUgZnVuYy1zdHlsZSAqL1xubGV0IGlzRnVuY3Rpb24gPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nO1xufTtcbi8vIGZhbGxiYWNrIGZvciBvbGRlciB2ZXJzaW9ucyBvZiBDaHJvbWUgYW5kIFNhZmFyaVxuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbmlmIChpc0Z1bmN0aW9uKC94LykpIHtcbiAgaXNGdW5jdGlvbiA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJyAmJiB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcbiAgfTtcbn1cbmV4cG9ydCB7aXNGdW5jdGlvbn07XG4vKiBlc2xpbnQtZW5hYmxlIGZ1bmMtc3R5bGUgKi9cblxuLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi9cbmV4cG9ydCBjb25zdCBpc0FycmF5ID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpID8gdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT09ICdbb2JqZWN0IEFycmF5XScgOiBmYWxzZTtcbn07XG5cbi8vIE9sZGVyIElFIHZlcnNpb25zIGRvIG5vdCBkaXJlY3RseSBzdXBwb3J0IGluZGV4T2Ygc28gd2UgbXVzdCBpbXBsZW1lbnQgb3VyIG93biwgc2FkbHkuXG5leHBvcnQgZnVuY3Rpb24gaW5kZXhPZihhcnJheSwgdmFsdWUpIHtcbiAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IGFycmF5Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgaWYgKGFycmF5W2ldID09PSB2YWx1ZSkge1xuICAgICAgcmV0dXJuIGk7XG4gICAgfVxuICB9XG4gIHJldHVybiAtMTtcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gZXNjYXBlRXhwcmVzc2lvbihzdHJpbmcpIHtcbiAgaWYgKHR5cGVvZiBzdHJpbmcgIT09ICdzdHJpbmcnKSB7XG4gICAgLy8gZG9uJ3QgZXNjYXBlIFNhZmVTdHJpbmdzLCBzaW5jZSB0aGV5J3JlIGFscmVhZHkgc2FmZVxuICAgIGlmIChzdHJpbmcgJiYgc3RyaW5nLnRvSFRNTCkge1xuICAgICAgcmV0dXJuIHN0cmluZy50b0hUTUwoKTtcbiAgICB9IGVsc2UgaWYgKHN0cmluZyA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gJyc7XG4gICAgfSBlbHNlIGlmICghc3RyaW5nKSB7XG4gICAgICByZXR1cm4gc3RyaW5nICsgJyc7XG4gICAgfVxuXG4gICAgLy8gRm9yY2UgYSBzdHJpbmcgY29udmVyc2lvbiBhcyB0aGlzIHdpbGwgYmUgZG9uZSBieSB0aGUgYXBwZW5kIHJlZ2FyZGxlc3MgYW5kXG4gICAgLy8gdGhlIHJlZ2V4IHRlc3Qgd2lsbCBkbyB0aGlzIHRyYW5zcGFyZW50bHkgYmVoaW5kIHRoZSBzY2VuZXMsIGNhdXNpbmcgaXNzdWVzIGlmXG4gICAgLy8gYW4gb2JqZWN0J3MgdG8gc3RyaW5nIGhhcyBlc2NhcGVkIGNoYXJhY3RlcnMgaW4gaXQuXG4gICAgc3RyaW5nID0gJycgKyBzdHJpbmc7XG4gIH1cblxuICBpZiAoIXBvc3NpYmxlLnRlc3Qoc3RyaW5nKSkgeyByZXR1cm4gc3RyaW5nOyB9XG4gIHJldHVybiBzdHJpbmcucmVwbGFjZShiYWRDaGFycywgZXNjYXBlQ2hhcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0VtcHR5KHZhbHVlKSB7XG4gIGlmICghdmFsdWUgJiYgdmFsdWUgIT09IDApIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBlbHNlIGlmIChpc0FycmF5KHZhbHVlKSAmJiB2YWx1ZS5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUZyYW1lKG9iamVjdCkge1xuICBsZXQgZnJhbWUgPSBleHRlbmQoe30sIG9iamVjdCk7XG4gIGZyYW1lLl9wYXJlbnQgPSBvYmplY3Q7XG4gIHJldHVybiBmcmFtZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJsb2NrUGFyYW1zKHBhcmFtcywgaWRzKSB7XG4gIHBhcmFtcy5wYXRoID0gaWRzO1xuICByZXR1cm4gcGFyYW1zO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXBwZW5kQ29udGV4dFBhdGgoY29udGV4dFBhdGgsIGlkKSB7XG4gIHJldHVybiAoY29udGV4dFBhdGggPyBjb250ZXh0UGF0aCArICcuJyA6ICcnKSArIGlkO1xufVxuIiwiLy8gQ3JlYXRlIGEgc2ltcGxlIHBhdGggYWxpYXMgdG8gYWxsb3cgYnJvd3NlcmlmeSB0byByZXNvbHZlXG4vLyB0aGUgcnVudGltZSBvbiBhIHN1cHBvcnRlZCBwYXRoLlxubW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKCcuL2Rpc3QvY2pzL2hhbmRsZWJhcnMucnVudGltZScpWydkZWZhdWx0J107XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJoYW5kbGViYXJzL3J1bnRpbWVcIilbXCJkZWZhdWx0XCJdO1xuIiwiKGZ1bmN0aW9uIChnbG9iYWwsIHVuZGVmaW5lZCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgaWYgKGdsb2JhbC5zZXRJbW1lZGlhdGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBuZXh0SGFuZGxlID0gMTsgLy8gU3BlYyBzYXlzIGdyZWF0ZXIgdGhhbiB6ZXJvXG4gICAgdmFyIHRhc2tzQnlIYW5kbGUgPSB7fTtcbiAgICB2YXIgY3VycmVudGx5UnVubmluZ0FUYXNrID0gZmFsc2U7XG4gICAgdmFyIGRvYyA9IGdsb2JhbC5kb2N1bWVudDtcbiAgICB2YXIgcmVnaXN0ZXJJbW1lZGlhdGU7XG5cbiAgICBmdW5jdGlvbiBzZXRJbW1lZGlhdGUoY2FsbGJhY2spIHtcbiAgICAgIC8vIENhbGxiYWNrIGNhbiBlaXRoZXIgYmUgYSBmdW5jdGlvbiBvciBhIHN0cmluZ1xuICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGNhbGxiYWNrID0gbmV3IEZ1bmN0aW9uKFwiXCIgKyBjYWxsYmFjayk7XG4gICAgICB9XG4gICAgICAvLyBDb3B5IGZ1bmN0aW9uIGFyZ3VtZW50c1xuICAgICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpICsgMV07XG4gICAgICB9XG4gICAgICAvLyBTdG9yZSBhbmQgcmVnaXN0ZXIgdGhlIHRhc2tcbiAgICAgIHZhciB0YXNrID0geyBjYWxsYmFjazogY2FsbGJhY2ssIGFyZ3M6IGFyZ3MgfTtcbiAgICAgIHRhc2tzQnlIYW5kbGVbbmV4dEhhbmRsZV0gPSB0YXNrO1xuICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUobmV4dEhhbmRsZSk7XG4gICAgICByZXR1cm4gbmV4dEhhbmRsZSsrO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFySW1tZWRpYXRlKGhhbmRsZSkge1xuICAgICAgICBkZWxldGUgdGFza3NCeUhhbmRsZVtoYW5kbGVdO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJ1bih0YXNrKSB7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IHRhc2suY2FsbGJhY2s7XG4gICAgICAgIHZhciBhcmdzID0gdGFzay5hcmdzO1xuICAgICAgICBzd2l0Y2ggKGFyZ3MubGVuZ3RoKSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSwgYXJnc1sxXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgY2FsbGJhY2soYXJnc1swXSwgYXJnc1sxXSwgYXJnc1syXSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHVuZGVmaW5lZCwgYXJncyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJ1bklmUHJlc2VudChoYW5kbGUpIHtcbiAgICAgICAgLy8gRnJvbSB0aGUgc3BlYzogXCJXYWl0IHVudGlsIGFueSBpbnZvY2F0aW9ucyBvZiB0aGlzIGFsZ29yaXRobSBzdGFydGVkIGJlZm9yZSB0aGlzIG9uZSBoYXZlIGNvbXBsZXRlZC5cIlxuICAgICAgICAvLyBTbyBpZiB3ZSdyZSBjdXJyZW50bHkgcnVubmluZyBhIHRhc2ssIHdlJ2xsIG5lZWQgdG8gZGVsYXkgdGhpcyBpbnZvY2F0aW9uLlxuICAgICAgICBpZiAoY3VycmVudGx5UnVubmluZ0FUYXNrKSB7XG4gICAgICAgICAgICAvLyBEZWxheSBieSBkb2luZyBhIHNldFRpbWVvdXQuIHNldEltbWVkaWF0ZSB3YXMgdHJpZWQgaW5zdGVhZCwgYnV0IGluIEZpcmVmb3ggNyBpdCBnZW5lcmF0ZWQgYVxuICAgICAgICAgICAgLy8gXCJ0b28gbXVjaCByZWN1cnNpb25cIiBlcnJvci5cbiAgICAgICAgICAgIHNldFRpbWVvdXQocnVuSWZQcmVzZW50LCAwLCBoYW5kbGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHRhc2sgPSB0YXNrc0J5SGFuZGxlW2hhbmRsZV07XG4gICAgICAgICAgICBpZiAodGFzaykge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IHRydWU7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcnVuKHRhc2spO1xuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW1tZWRpYXRlKGhhbmRsZSk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRseVJ1bm5pbmdBVGFzayA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluc3RhbGxOZXh0VGlja0ltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgcHJvY2Vzcy5uZXh0VGljayhmdW5jdGlvbiAoKSB7IHJ1bklmUHJlc2VudChoYW5kbGUpOyB9KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYW5Vc2VQb3N0TWVzc2FnZSgpIHtcbiAgICAgICAgLy8gVGhlIHRlc3QgYWdhaW5zdCBgaW1wb3J0U2NyaXB0c2AgcHJldmVudHMgdGhpcyBpbXBsZW1lbnRhdGlvbiBmcm9tIGJlaW5nIGluc3RhbGxlZCBpbnNpZGUgYSB3ZWIgd29ya2VyLFxuICAgICAgICAvLyB3aGVyZSBgZ2xvYmFsLnBvc3RNZXNzYWdlYCBtZWFucyBzb21ldGhpbmcgY29tcGxldGVseSBkaWZmZXJlbnQgYW5kIGNhbid0IGJlIHVzZWQgZm9yIHRoaXMgcHVycG9zZS5cbiAgICAgICAgaWYgKGdsb2JhbC5wb3N0TWVzc2FnZSAmJiAhZ2xvYmFsLmltcG9ydFNjcmlwdHMpIHtcbiAgICAgICAgICAgIHZhciBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBvbGRPbk1lc3NhZ2UgPSBnbG9iYWwub25tZXNzYWdlO1xuICAgICAgICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHBvc3RNZXNzYWdlSXNBc3luY2hyb25vdXMgPSBmYWxzZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBnbG9iYWwucG9zdE1lc3NhZ2UoXCJcIiwgXCIqXCIpO1xuICAgICAgICAgICAgZ2xvYmFsLm9ubWVzc2FnZSA9IG9sZE9uTWVzc2FnZTtcbiAgICAgICAgICAgIHJldHVybiBwb3N0TWVzc2FnZUlzQXN5bmNocm9ub3VzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5zdGFsbFBvc3RNZXNzYWdlSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIC8vIEluc3RhbGxzIGFuIGV2ZW50IGhhbmRsZXIgb24gYGdsb2JhbGAgZm9yIHRoZSBgbWVzc2FnZWAgZXZlbnQ6IHNlZVxuICAgICAgICAvLyAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0RPTS93aW5kb3cucG9zdE1lc3NhZ2VcbiAgICAgICAgLy8gKiBodHRwOi8vd3d3LndoYXR3Zy5vcmcvc3BlY3Mvd2ViLWFwcHMvY3VycmVudC13b3JrL211bHRpcGFnZS9jb21tcy5odG1sI2Nyb3NzRG9jdW1lbnRNZXNzYWdlc1xuXG4gICAgICAgIHZhciBtZXNzYWdlUHJlZml4ID0gXCJzZXRJbW1lZGlhdGUkXCIgKyBNYXRoLnJhbmRvbSgpICsgXCIkXCI7XG4gICAgICAgIHZhciBvbkdsb2JhbE1lc3NhZ2UgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnNvdXJjZSA9PT0gZ2xvYmFsICYmXG4gICAgICAgICAgICAgICAgdHlwZW9mIGV2ZW50LmRhdGEgPT09IFwic3RyaW5nXCIgJiZcbiAgICAgICAgICAgICAgICBldmVudC5kYXRhLmluZGV4T2YobWVzc2FnZVByZWZpeCkgPT09IDApIHtcbiAgICAgICAgICAgICAgICBydW5JZlByZXNlbnQoK2V2ZW50LmRhdGEuc2xpY2UobWVzc2FnZVByZWZpeC5sZW5ndGgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoZ2xvYmFsLmFkZEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgICAgICAgIGdsb2JhbC5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBvbkdsb2JhbE1lc3NhZ2UsIGZhbHNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdsb2JhbC5hdHRhY2hFdmVudChcIm9ubWVzc2FnZVwiLCBvbkdsb2JhbE1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIGdsb2JhbC5wb3N0TWVzc2FnZShtZXNzYWdlUHJlZml4ICsgaGFuZGxlLCBcIipcIik7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5zdGFsbE1lc3NhZ2VDaGFubmVsSW1wbGVtZW50YXRpb24oKSB7XG4gICAgICAgIHZhciBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XG4gICAgICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciBoYW5kbGUgPSBldmVudC5kYXRhO1xuICAgICAgICAgICAgcnVuSWZQcmVzZW50KGhhbmRsZSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmVnaXN0ZXJJbW1lZGlhdGUgPSBmdW5jdGlvbihoYW5kbGUpIHtcbiAgICAgICAgICAgIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoaGFuZGxlKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsUmVhZHlTdGF0ZUNoYW5nZUltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICB2YXIgaHRtbCA9IGRvYy5kb2N1bWVudEVsZW1lbnQ7XG4gICAgICAgIHJlZ2lzdGVySW1tZWRpYXRlID0gZnVuY3Rpb24oaGFuZGxlKSB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgYSA8c2NyaXB0PiBlbGVtZW50OyBpdHMgcmVhZHlzdGF0ZWNoYW5nZSBldmVudCB3aWxsIGJlIGZpcmVkIGFzeW5jaHJvbm91c2x5IG9uY2UgaXQgaXMgaW5zZXJ0ZWRcbiAgICAgICAgICAgIC8vIGludG8gdGhlIGRvY3VtZW50LiBEbyBzbywgdGh1cyBxdWV1aW5nIHVwIHRoZSB0YXNrLiBSZW1lbWJlciB0byBjbGVhbiB1cCBvbmNlIGl0J3MgYmVlbiBjYWxsZWQuXG4gICAgICAgICAgICB2YXIgc2NyaXB0ID0gZG9jLmNyZWF0ZUVsZW1lbnQoXCJzY3JpcHRcIik7XG4gICAgICAgICAgICBzY3JpcHQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJ1bklmUHJlc2VudChoYW5kbGUpO1xuICAgICAgICAgICAgICAgIHNjcmlwdC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgICAgIGh0bWwucmVtb3ZlQ2hpbGQoc2NyaXB0KTtcbiAgICAgICAgICAgICAgICBzY3JpcHQgPSBudWxsO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGh0bWwuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbnN0YWxsU2V0VGltZW91dEltcGxlbWVudGF0aW9uKCkge1xuICAgICAgICByZWdpc3RlckltbWVkaWF0ZSA9IGZ1bmN0aW9uKGhhbmRsZSkge1xuICAgICAgICAgICAgc2V0VGltZW91dChydW5JZlByZXNlbnQsIDAsIGhhbmRsZSk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gSWYgc3VwcG9ydGVkLCB3ZSBzaG91bGQgYXR0YWNoIHRvIHRoZSBwcm90b3R5cGUgb2YgZ2xvYmFsLCBzaW5jZSB0aGF0IGlzIHdoZXJlIHNldFRpbWVvdXQgZXQgYWwuIGxpdmUuXG4gICAgdmFyIGF0dGFjaFRvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mICYmIE9iamVjdC5nZXRQcm90b3R5cGVPZihnbG9iYWwpO1xuICAgIGF0dGFjaFRvID0gYXR0YWNoVG8gJiYgYXR0YWNoVG8uc2V0VGltZW91dCA/IGF0dGFjaFRvIDogZ2xvYmFsO1xuXG4gICAgLy8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBlLmcuIGJyb3dzZXJpZnkgZW52aXJvbm1lbnRzLlxuICAgIGlmICh7fS50b1N0cmluZy5jYWxsKGdsb2JhbC5wcm9jZXNzKSA9PT0gXCJbb2JqZWN0IHByb2Nlc3NdXCIpIHtcbiAgICAgICAgLy8gRm9yIE5vZGUuanMgYmVmb3JlIDAuOVxuICAgICAgICBpbnN0YWxsTmV4dFRpY2tJbXBsZW1lbnRhdGlvbigpO1xuXG4gICAgfSBlbHNlIGlmIChjYW5Vc2VQb3N0TWVzc2FnZSgpKSB7XG4gICAgICAgIC8vIEZvciBub24tSUUxMCBtb2Rlcm4gYnJvd3NlcnNcbiAgICAgICAgaW5zdGFsbFBvc3RNZXNzYWdlSW1wbGVtZW50YXRpb24oKTtcblxuICAgIH0gZWxzZSBpZiAoZ2xvYmFsLk1lc3NhZ2VDaGFubmVsKSB7XG4gICAgICAgIC8vIEZvciB3ZWIgd29ya2Vycywgd2hlcmUgc3VwcG9ydGVkXG4gICAgICAgIGluc3RhbGxNZXNzYWdlQ2hhbm5lbEltcGxlbWVudGF0aW9uKCk7XG5cbiAgICB9IGVsc2UgaWYgKGRvYyAmJiBcIm9ucmVhZHlzdGF0ZWNoYW5nZVwiIGluIGRvYy5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpKSB7XG4gICAgICAgIC8vIEZvciBJRSA24oCTOFxuICAgICAgICBpbnN0YWxsUmVhZHlTdGF0ZUNoYW5nZUltcGxlbWVudGF0aW9uKCk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGb3Igb2xkZXIgYnJvd3NlcnNcbiAgICAgICAgaW5zdGFsbFNldFRpbWVvdXRJbXBsZW1lbnRhdGlvbigpO1xuICAgIH1cblxuICAgIGF0dGFjaFRvLnNldEltbWVkaWF0ZSA9IHNldEltbWVkaWF0ZTtcbiAgICBhdHRhY2hUby5jbGVhckltbWVkaWF0ZSA9IGNsZWFySW1tZWRpYXRlO1xufSh0eXBlb2Ygc2VsZiA9PT0gXCJ1bmRlZmluZWRcIiA/IHR5cGVvZiBnbG9iYWwgPT09IFwidW5kZWZpbmVkXCIgPyB0aGlzIDogZ2xvYmFsIDogc2VsZikpO1xuIiwidmFyIHRyaW0gPSByZXF1aXJlKCcuL3RyaW0nKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkYXNoZXJpemUoc3RyKSB7XG4gIHJldHVybiB0cmltKHN0cikucmVwbGFjZSgvKFtBLVpdKS9nLCAnLSQxJykucmVwbGFjZSgvWy1fXFxzXSsvZywgJy0nKS50b0xvd2VyQ2FzZSgpO1xufTtcbiIsInZhciBlc2NhcGVSZWdFeHAgPSByZXF1aXJlKCcuL2VzY2FwZVJlZ0V4cCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGRlZmF1bHRUb1doaXRlU3BhY2UoY2hhcmFjdGVycykge1xuICBpZiAoY2hhcmFjdGVycyA9PSBudWxsKVxuICAgIHJldHVybiAnXFxcXHMnO1xuICBlbHNlIGlmIChjaGFyYWN0ZXJzLnNvdXJjZSlcbiAgICByZXR1cm4gY2hhcmFjdGVycy5zb3VyY2U7XG4gIGVsc2VcbiAgICByZXR1cm4gJ1snICsgZXNjYXBlUmVnRXhwKGNoYXJhY3RlcnMpICsgJ10nO1xufTtcbiIsInZhciBtYWtlU3RyaW5nID0gcmVxdWlyZSgnLi9tYWtlU3RyaW5nJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZXNjYXBlUmVnRXhwKHN0cikge1xuICByZXR1cm4gbWFrZVN0cmluZyhzdHIpLnJlcGxhY2UoLyhbLiorP149IToke30oKXxbXFxdXFwvXFxcXF0pL2csICdcXFxcJDEnKTtcbn07XG4iLCIvKipcbiAqIEVuc3VyZSBzb21lIG9iamVjdCBpcyBhIGNvZXJjZWQgdG8gYSBzdHJpbmdcbiAqKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbWFrZVN0cmluZyhvYmplY3QpIHtcbiAgaWYgKG9iamVjdCA9PSBudWxsKSByZXR1cm4gJyc7XG4gIHJldHVybiAnJyArIG9iamVjdDtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHN0clJlcGVhdChzdHIsIHF0eSl7XG4gIGlmIChxdHkgPCAxKSByZXR1cm4gJyc7XG4gIHZhciByZXN1bHQgPSAnJztcbiAgd2hpbGUgKHF0eSA+IDApIHtcbiAgICBpZiAocXR5ICYgMSkgcmVzdWx0ICs9IHN0cjtcbiAgICBxdHkgPj49IDEsIHN0ciArPSBzdHI7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn07XG4iLCJ2YXIgcGFkID0gcmVxdWlyZSgnLi9wYWQnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBscGFkKHN0ciwgbGVuZ3RoLCBwYWRTdHIpIHtcbiAgcmV0dXJuIHBhZChzdHIsIGxlbmd0aCwgcGFkU3RyKTtcbn07XG4iLCJ2YXIgbWFrZVN0cmluZyA9IHJlcXVpcmUoJy4vaGVscGVyL21ha2VTdHJpbmcnKTtcbnZhciBzdHJSZXBlYXQgPSByZXF1aXJlKCcuL2hlbHBlci9zdHJSZXBlYXQnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBwYWQoc3RyLCBsZW5ndGgsIHBhZFN0ciwgdHlwZSkge1xuICBzdHIgPSBtYWtlU3RyaW5nKHN0cik7XG4gIGxlbmd0aCA9IH5+bGVuZ3RoO1xuXG4gIHZhciBwYWRsZW4gPSAwO1xuXG4gIGlmICghcGFkU3RyKVxuICAgIHBhZFN0ciA9ICcgJztcbiAgZWxzZSBpZiAocGFkU3RyLmxlbmd0aCA+IDEpXG4gICAgcGFkU3RyID0gcGFkU3RyLmNoYXJBdCgwKTtcblxuICBzd2l0Y2ggKHR5cGUpIHtcbiAgY2FzZSAncmlnaHQnOlxuICAgIHBhZGxlbiA9IGxlbmd0aCAtIHN0ci5sZW5ndGg7XG4gICAgcmV0dXJuIHN0ciArIHN0clJlcGVhdChwYWRTdHIsIHBhZGxlbik7XG4gIGNhc2UgJ2JvdGgnOlxuICAgIHBhZGxlbiA9IGxlbmd0aCAtIHN0ci5sZW5ndGg7XG4gICAgcmV0dXJuIHN0clJlcGVhdChwYWRTdHIsIE1hdGguY2VpbChwYWRsZW4gLyAyKSkgKyBzdHIgKyBzdHJSZXBlYXQocGFkU3RyLCBNYXRoLmZsb29yKHBhZGxlbiAvIDIpKTtcbiAgZGVmYXVsdDogLy8gJ2xlZnQnXG4gICAgcGFkbGVuID0gbGVuZ3RoIC0gc3RyLmxlbmd0aDtcbiAgICByZXR1cm4gc3RyUmVwZWF0KHBhZFN0ciwgcGFkbGVuKSArIHN0cjtcbiAgfVxufTtcbiIsInZhciBwYWQgPSByZXF1aXJlKCcuL3BhZCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHJwYWQoc3RyLCBsZW5ndGgsIHBhZFN0cikge1xuICByZXR1cm4gcGFkKHN0ciwgbGVuZ3RoLCBwYWRTdHIsICdyaWdodCcpO1xufTtcbiIsInZhciBtYWtlU3RyaW5nID0gcmVxdWlyZSgnLi9oZWxwZXIvbWFrZVN0cmluZycpO1xudmFyIGRlZmF1bHRUb1doaXRlU3BhY2UgPSByZXF1aXJlKCcuL2hlbHBlci9kZWZhdWx0VG9XaGl0ZVNwYWNlJyk7XG52YXIgbmF0aXZlVHJpbSA9IFN0cmluZy5wcm90b3R5cGUudHJpbTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB0cmltKHN0ciwgY2hhcmFjdGVycykge1xuICBzdHIgPSBtYWtlU3RyaW5nKHN0cik7XG4gIGlmICghY2hhcmFjdGVycyAmJiBuYXRpdmVUcmltKSByZXR1cm4gbmF0aXZlVHJpbS5jYWxsKHN0cik7XG4gIGNoYXJhY3RlcnMgPSBkZWZhdWx0VG9XaGl0ZVNwYWNlKGNoYXJhY3RlcnMpO1xuICByZXR1cm4gc3RyLnJlcGxhY2UobmV3IFJlZ0V4cCgnXicgKyBjaGFyYWN0ZXJzICsgJyt8JyArIGNoYXJhY3RlcnMgKyAnKyQnLCAnZycpLCAnJyk7XG59O1xuIiwiLyoqXG4vKiBAbW9kdWxlIGFwcC9BcHBcbi8qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnNvbGUuaW5mbyhcIlBvcnRmb2xpbyBBcHAgc3RhcnRlZFwiKTtcblxuaWYgKCFERUJVRykge1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIGZ1bmN0aW9uKGV2KSB7XG5cdFx0Y29uc29sZS5lcnJvcihcIlVuY2F1Z2h0IEVycm9yXCIsIGV2KTtcblx0fSk7XG59XG5cbnJlcXVpcmUoXCJNb2Rlcm5penJcIik7XG5yZXF1aXJlKFwiZXM2LXByb21pc2VcIikucG9seWZpbGwoKTtcbnJlcXVpcmUoXCJjbGFzc2xpc3QtcG9seWZpbGxcIik7XG5yZXF1aXJlKFwicmFmLXBvbHlmaWxsXCIpO1xucmVxdWlyZShcIm1hdGNoZXMtcG9seWZpbGxcIik7XG5yZXF1aXJlKFwiZnVsbHNjcmVlbi1wb2x5ZmlsbFwiKTtcbnJlcXVpcmUoXCJtYXRoLXNpZ24tcG9seWZpbGxcIik7XG5yZXF1aXJlKFwic2V0aW1tZWRpYXRlXCIpO1xuXG5yZXF1aXJlKFwiYmFja2JvbmVcIikuJCA9IHJlcXVpcmUoXCJiYWNrYm9uZS5uYXRpdmVcIik7XG5yZXF1aXJlKFwiYmFja2JvbmUuYmFieXNpdHRlclwiKTtcbnJlcXVpcmUoXCJCYWNrYm9uZS5NdXRhdG9yc1wiKTtcbnJlcXVpcmUoXCJoYW1tZXJqc1wiKTtcblxuLy8gZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGV2KSB7XG4vLyBcdGNvbnNvbGUubG9nKFwiJXM6W2V2ZW50ICVzXVwiLCBldi50YXJnZXQsIGV2LnR5cGUpO1xuLy8gfSk7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLCBmdW5jdGlvbihldikge1xuXHRjb25zb2xlLmxvZyhcIiVzOltldmVudCAlc11cIiwgZXYudGFyZ2V0LCBldi50eXBlKTtcblxuXHQvLyBwcm9jZXNzIGJvb3RzdHJhcCBkYXRhLCBsZXQgZXJyb3JzIGdvIHVwIHRoZSBzdGFja1xuXHR0cnkge1xuXHRcdHJlcXVpcmUoXCJhcHAvbW9kZWwvaGVscGVyL2Jvb3RzdHJhcFwiKSh3aW5kb3cuYm9vdHN0cmFwKTtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0dmFyIGVsID0gZG9jdW1lbnQuc2VsZWN0UXVlcnkoXCIuYXBwXCIpO1xuXHRcdGVsLmNsYXNzTGlzdC5yZW1vdmUoXCJhcHAtaW5pdGlhbFwiKTtcblx0XHRlbC5jbGFzc0xpc3QuYWRkKFwiYXBwLWVycm9yXCIpO1xuXHRcdHRocm93IG5ldyBFcnJvcihcImJvb3RzdHJhcCBkYXRhIGVycm9yIChcIiArIGVyci5tZXNzYWdlICsgXCIpXCIsIGVyci5maWxlTmFtZSwgZXJyLmxpbmVOdW1iZXIpO1xuXHR9IGZpbmFsbHkgeyAvLyBkZXRlbGUgZ2xvYmFsIHZhclxuXHRcdGRlbGV0ZSB3aW5kb3cuYm9vdHN0cmFwO1xuXHR9XG5cblx0cmVxdWlyZShcImFwcC92aWV3L3RlbXBsYXRlL19oZWxwZXJzXCIpO1xuXHQvLyByZXF1aXJlKFwiYXBwL3ZpZXcvdGVtcGxhdGUvX3BhcnRpYWxzXCIpO1xuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9oZWxwZXIvY3JlYXRlQ29sb3JTdHlsZVNoZWV0fSAqL1xuXHRyZXF1aXJlKFwiYXBwL3ZpZXcvaGVscGVyL2NyZWF0ZUNvbG9yU3R5bGVTaGVldFwiKS5jYWxsKCk7XG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvQXBwVmlld30gKi9cblx0dmFyIEFwcFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvQXBwVmlld1wiKTtcblxuXHQvKiogQHR5cGUge21vZHVsZTp3ZWJmb250bG9hZGVyfSAqL1xuXHR2YXIgV2ViRm9udCA9IHJlcXVpcmUoXCJ3ZWJmb250bG9hZGVyXCIpO1xuXHRXZWJGb250LmxvYWQoe1xuXHRcdGFzeW5jOiB0cnVlLFxuXHRcdGNsYXNzZXM6IGZhbHNlLFxuXHRcdGN1c3RvbToge1xuXHRcdFx0ZmFtaWxpZXM6IFtcblx0XHRcdFx0Ly8gXCJGcmFua2xpbiBHb3RoaWMgRlM6bjQsbjdcIixcblx0XHRcdFx0XCJGcmFua2xpbiBHb3RoaWMgRlM6bjQsaTQsbjcsaTdcIixcblx0XHRcdFx0XCJGb2xpb0ZpZ3VyZXM6bjRcIixcblx0XHRcdF0sXG5cdFx0XHR0ZXN0U3RyaW5nczoge1xuXHRcdFx0XHRcIkZvbGlvRmlndXJlc1wiOiBcImhtc1wiXG5cdFx0XHR9LFxuXHRcdH0sXG5cdFx0YWN0aXZlOiBmdW5jdGlvbigpIHtcblx0XHRcdGNvbnNvbGUuaW5mbyhcIldlYkZvbnQ6OmFjdGl2ZVwiKTtcblx0XHRcdC8vIEFwcFZpZXcuZ2V0SW5zdGFuY2UoKTtcblx0XHR9LFxuXHRcdGZvbnRhY3RpdmU6IGZ1bmN0aW9uKGZhbWlseU5hbWUsIHZhcmlhbnRGdmQpIHtcblx0XHRcdGNvbnNvbGUuaW5mbyhcIldlYkZvbnQ6OmZvbnRhY3RpdmUgJyVzJyAoJXMpXCIsIGZhbWlseU5hbWUsIHZhcmlhbnRGdmQpO1xuXHRcdH0sXG5cdFx0aW5hY3RpdmU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiV2ViRm9udDo6aW5hY3RpdmVcIik7XG5cdFx0XHQvLyBBcHBWaWV3LmdldEluc3RhbmNlKCk7XG5cdFx0fSxcblx0XHRmb250aW5hY3RpdmU6IGZ1bmN0aW9uKGZhbWlseU5hbWUsIHZhcmlhbnRGdmQpIHtcblx0XHRcdGNvbnNvbGUud2FybihcIldlYkZvbnQ6OmZvbnRpbmFjdGl2ZSAnJXMnICglcylcIiwgZmFtaWx5TmFtZSwgdmFyaWFudEZ2ZCk7XG5cdFx0fSxcblx0XHQvLyBsb2FkaW5nOiBmdW5jdGlvbigpIHtcblx0XHQvLyBcdGNvbnNvbGUubG9nKFwiV2ViRm9udDo6bG9hZGluZ1wiKTtcblx0XHQvLyB9LFxuXHRcdC8vIGZvbnRsb2FkaW5nOiBmdW5jdGlvbihmYW1pbHlOYW1lLCB2YXJpYW50RGVzYykge1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCJXZWJGb250Ojpmb250bG9hZGluZ1wiLCBmYW1pbHlOYW1lLCBKU09OLnN0cmluZ2lmeSh2YXJpYW50RGVzYywgbnVsbCwgXCIgXCIpKTtcblx0XHQvLyB9LFxuXHR9KTtcblx0QXBwVmlldy5nZXRJbnN0YW5jZSgpO1xufSk7XG5cblxuaWYgKERFQlVHKSB7XG5cdC8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG5cdC8vIHZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG5cblx0Ly8gdmFyIGlzRkYgPSAvRmlyZWZveC8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XG5cdC8vIHZhciBpc0lPUyA9IC9pUGFkfGlQaG9uZS8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XG5cdC8qXG5cdGlmICgvRmlyZWZveC8udGVzdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcblx0XHRjb25zb2xlLnByZWZpeCA9IFwiIyBcIjtcblx0XHR2YXIgc2hpZnQgPSBbXS5zaGlmdDtcblx0XHR2YXIgbG9nV3JhcEZuID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAodHlwZW9mIGFyZ3VtZW50c1sxXSA9PSBcInN0cmluZ1wiKSBhcmd1bWVudHNbMV0gPSBjb25zb2xlLnByZWZpeCArIGFyZ3VtZW50c1sxXTtcblx0XHRcdHJldHVybiBzaGlmdC5hcHBseShhcmd1bWVudHMpLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7XG5cdFx0fTtcblx0XHRjb25zb2xlLmdyb3VwID0gXy53cmFwKGNvbnNvbGUuZ3JvdXAsIGxvZ1dyYXBGbik7XG5cdFx0Y29uc29sZS5sb2cgPSBfLndyYXAoY29uc29sZS5sb2csIGxvZ1dyYXBGbik7XG5cdFx0Y29uc29sZS5pbmZvID0gXy53cmFwKGNvbnNvbGUuaW5mbywgbG9nV3JhcEZuKTtcblx0XHRjb25zb2xlLndhcm4gPSBfLndyYXAoY29uc29sZS53YXJuLCBsb2dXcmFwRm4pO1xuXHRcdGNvbnNvbGUuZXJyb3IgPSBfLndyYXAoY29uc29sZS5lcnJvciwgbG9nV3JhcEZuKTtcblx0fVxuXHQqL1xuXHQvKlxuXHR2YXIgc2F2ZUxvZ3MgPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgbG9nV3JhcEZuID0gZnVuY3Rpb24obmFtZSwgZm4sIG1zZykge1xuXHRcdFx0ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmFwcGVuZENoaWxkKFxuXHRcdFx0XHRkb2N1bWVudC5jcmVhdGVDb21tZW50KFwiW1wiICsgbmFtZSArIFwiXSBcIiArIG1zZykpO1xuXHRcdH07XG5cdFx0Y29uc29sZS5ncm91cCA9IF8ud3JhcChjb25zb2xlLmdyb3VwLCBfLnBhcnRpYWwobG9nV3JhcEZuLCBcImdyb3VwXCIpKTtcblx0XHRjb25zb2xlLmxvZyA9IF8ud3JhcChjb25zb2xlLmxvZywgXy5wYXJ0aWFsKGxvZ1dyYXBGbiwgXCJsb2dcIikpO1xuXHRcdGNvbnNvbGUuaW5mbyA9IF8ud3JhcChjb25zb2xlLmluZm8sIF8ucGFydGlhbChsb2dXcmFwRm4sIFwiaW5mb1wiKSk7XG5cdFx0Y29uc29sZS53YXJuID0gXy53cmFwKGNvbnNvbGUud2FybiwgXy5wYXJ0aWFsKGxvZ1dyYXBGbiwgXCJ3YXJuXCIpKTtcblx0XHRjb25zb2xlLmVycm9yID0gXy53cmFwKGNvbnNvbGUuZXJyb3IsIF8ucGFydGlhbChsb2dXcmFwRm4sIFwiZXJyb3JcIikpO1xuXHR9O1xuXHQqL1xuXG5cdC8vIGhhbmRsZSBlcnJvciBldmVudHMgb24gc29tZSBwbGF0Zm9ybXMgYW5kIHByb2R1Y3Rpb25cblx0Lypcblx0aWYgKGlzSU9TKSB7XG5cdFx0Ly8gc2F2ZUxvZ3MoKTtcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzKSxcblx0XHRcdFx0ZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxuXHRcdFx0XHRodG1sID0gXCJcIjtcblx0XHRcdF8uZXh0ZW5kKGVsLnN0eWxlLCB7XG5cdFx0XHRcdGZvbnRmYW1pbHk6IFwibW9ub3NwYWNlXCIsXG5cdFx0XHRcdGRpc3BsYXk6IFwiYmxvY2tcIixcblx0XHRcdFx0cG9zaXRpb246IFwiYWJzb2x1dGVcIixcblx0XHRcdFx0ekluZGV4OiBcIjk5OVwiLFxuXHRcdFx0XHRiYWNrZ3JvdW5kQ29sb3I6IFwid2hpdGVcIixcblx0XHRcdFx0Y29sb3I6IFwiYmxhY2tcIixcblx0XHRcdFx0d2lkdGg6IFwiY2FsYygxMDAlIC0gM2VtKVwiLFxuXHRcdFx0XHRib3R0b206IFwiMFwiLFxuXHRcdFx0XHRtYXJnaW46IFwiMWVtIDEuNWVtXCIsXG5cdFx0XHRcdHBhZGRpbmc6IFwiMWVtIDEuNWVtXCIsXG5cdFx0XHRcdG91dGxpbmU6IFwiMC41ZW0gc29saWQgcmVkXCIsXG5cdFx0XHRcdG91dGxpbmVPZmZzZXQ6IFwiMC41ZW1cIixcblx0XHRcdFx0Ym94U2l6aW5nOiBcImJvcmRlci1ib3hcIixcblx0XHRcdFx0b3ZlcmZsb3c6IFwiaGlkZGVuXCIsXG5cdFx0XHR9KTtcblx0XHRcdGh0bWwgKz0gXCI8cHJlPjxiPmxvY2F0aW9uOjxiPiBcIiArIHdpbmRvdy5sb2NhdGlvbiArIFwiPC9wcmU+XCI7XG5cdFx0XHRodG1sICs9IFwiPHByZT48Yj5ldmVudDo8Yj4gXCIgKyBKU09OLnN0cmluZ2lmeShhcmdzLnNoaWZ0KCksIG51bGwsIFwiIFwiKSArIFwiPC9wcmU+XCI7XG5cdFx0XHRpZiAoYXJncy5sZW5ndGgpIGh0bWwgKz0gXCI8cHJlPjxiPnJlc3Q6PGI+IFwiICsgSlNPTi5zdHJpbmdpZnkoYXJncywgbnVsbCwgXCIgXCIpICsgXCI8L3ByZT5cIjtcblx0XHRcdGVsLmlubmVySFRNTCA9IGh0bWw7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsKTtcblx0XHR9KTtcblx0fSovXG59IiwiLyoqXG4vKiBAbW9kdWxlIGFwcC9jb250cm9sL0NvbnRyb2xsZXJcbi8qL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xudmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9UeXBlQ29sbGVjdGlvbn0gKi9cbi8vIHZhciB0eXBlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9UeXBlQ29sbGVjdGlvblwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9ufSAqL1xuLy8gdmFyIGtleXdvcmRzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9uXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb259ICovXG52YXIgYXJ0aWNsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb25cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9ufSAqL1xudmFyIGJ1bmRsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvblwiKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcbi8qIFN0YXRpYyBwcml2YXRlXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvQ29udHJvbGxlcn1cbi8qL1xudmFyIENvbnRyb2xsZXIgPSBCYWNrYm9uZS5Sb3V0ZXIuZXh0ZW5kKHtcblxuXHQvLyAvKiogQG92ZXJyaWRlICovXG5cdC8vIHJvdXRlczoge30sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dGhpcy5fcm91dGVOYW1lcyA9IFtdO1xuXG5cdFx0aWYgKERFQlVHKSB7XG5cdFx0XHR0aGlzLm9uKFwicm91dGVcIiwgZnVuY3Rpb24ocm91dGVOYW1lLCBhcmdzKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiY29udHJvbGxlcjpbcm91dGVdICVzIFslc11cIiwgcm91dGVOYW1lLCBhcmdzLmpvaW4oKSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHQvKlxuXHRcdCAqIFByZWZpeGVkIGFydGljbGUgcmVnZXhwOiAvXmFydGljbGUoPzpcXC8oW15cXC9dKykpXFwvPyQvXG5cdFx0ICogU2luZ2xlIGJ1bmRsZSByZWdleHA6IC9eYnVuZGxlcyg/OlxcLyhbXlxcL10rKSg/OlxcLyhcXGQrKSk/KT9cXC8/JC9cblx0XHQgKi9cblx0XHR0aGlzLnJvdXRlKC8oLiopLyxcblx0XHRcdFwibm90Zm91bmRcIiwgdGhpcy50b05vdEZvdW5kKTtcblx0XHR0aGlzLnJvdXRlKC9eKFthLXpdW2EtejAtOVxcLV0qKVxcLz8kLyxcblx0XHRcdFwiYXJ0aWNsZS1pdGVtXCIsIHRoaXMudG9BcnRpY2xlSXRlbSk7XG5cdFx0dGhpcy5yb3V0ZSgvXig/OmJ1bmRsZXMpP1xcLz8kLyxcblx0XHRcdFwicm9vdFwiLCB0aGlzLnRvUm9vdCk7XG5cdFx0Ly8gdGhpcy5yb3V0ZSgvXmJ1bmRsZXNcXC8/JC8sXG5cdFx0Ly8gXHRcImJ1bmRsZS1saXN0XCIsIHRoaXMudG9CdW5kbGVMaXN0KTtcblx0XHR0aGlzLnJvdXRlKC9eYnVuZGxlc1xcLyhbXlxcL10rKVxcLz8kLyxcblx0XHRcdFwiYnVuZGxlLWl0ZW1cIiwgdGhpcy50b0J1bmRsZUl0ZW0pO1xuXHRcdHRoaXMucm91dGUoL15idW5kbGVzXFwvKFteXFwvXSspXFwvKFxcZCspXFwvPyQvLFxuXHRcdFx0XCJtZWRpYS1pdGVtXCIsIHRoaXMudG9NZWRpYUl0ZW0pO1xuXG5cdFx0Y29uc29sZS5sb2coXCIlczo6aW5pdGlhbGl6ZSByb3V0ZXM6ICVvXCIsIFwiY29udHJvbGxlclwiLCB0aGlzLl9yb3V0ZU5hbWVzKTtcblx0fSxcblxuXHRyb3V0ZTogZnVuY3Rpb24ocm91dGUsIG5hbWUsIGNhbGxiYWNrKSB7XG5cdFx0dGhpcy5fcm91dGVOYW1lcy5wdXNoKF8uaXNTdHJpbmcobmFtZSkgPyBuYW1lIDogJycpO1xuXHRcdHJldHVybiBCYWNrYm9uZS5Sb3V0ZXIucHJvdG90eXBlLnJvdXRlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIEpTIHRvIFVSTDogcHVibGljIGNvbW1hbmQgbWV0aG9kc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRzZWxlY3RNZWRpYTogZnVuY3Rpb24obWVkaWEpIHtcblx0XHR0aGlzLl9nb1RvTG9jYXRpb24obWVkaWEuZ2V0KFwiYnVuZGxlXCIpLCBtZWRpYSk7XG5cdH0sXG5cblx0c2VsZWN0QnVuZGxlOiBmdW5jdGlvbihidW5kbGUpIHtcblx0XHR0aGlzLl9nb1RvTG9jYXRpb24oYnVuZGxlKTtcblx0fSxcblxuXHRkZXNlbGVjdE1lZGlhOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9nb1RvTG9jYXRpb24oYnVuZGxlcy5zZWxlY3RlZCk7XG5cdH0sXG5cblx0ZGVzZWxlY3RCdW5kbGU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX2dvVG9Mb2NhdGlvbigpO1xuXHR9LFxuXG5cdHNlbGVjdEFydGljbGU6IGZ1bmN0aW9uKGFydGljbGUpIHtcblx0XHR0aGlzLm5hdmlnYXRlKGFydGljbGUuZ2V0KFwiaGFuZGxlXCIpLCB7IHRyaWdnZXI6IHRydWUgfSk7XG5cdH0sXG5cblx0ZGVzZWxlY3RBcnRpY2xlOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLm5hdmlnYXRlKFwiXCIsIHsgdHJpZ2dlcjogdHJ1ZSB9KTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogSlMgdG8gVVJMOiBwcml2YXRlIGhlbHBlcnNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIFVwZGF0ZSBsb2NhdGlvbiB3aGVuIG5hdmlnYXRpb24gaGFwcGVucyBpbnRlcm5hbGx5ICovXG5cdF91cGRhdGVMb2NhdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGJ1bmRsZSwgbWVkaWE7XG5cdFx0YnVuZGxlID0gYnVuZGxlcy5zZWxlY3RlZDtcblx0XHRpZiAoYnVuZGxlKSB7XG5cdFx0XHRtZWRpYSA9IGJ1bmRsZS5nZXQoXCJtZWRpYVwiKS5zZWxlY3RlZDtcblx0XHR9XG5cdFx0dGhpcy5uYXZpZ2F0ZSh0aGlzLl9nZXRMb2NhdGlvbihidW5kbGUsIG1lZGlhKSwge1xuXHRcdFx0dHJpZ2dlcjogZmFsc2Vcblx0XHR9KTtcblx0fSxcblxuXHRfZ2V0TG9jYXRpb246IGZ1bmN0aW9uKGJ1bmRsZSwgbWVkaWEpIHtcblx0XHR2YXIgbWVkaWFJbmRleCwgbG9jYXRpb24gPSBbXTtcblx0XHRpZiAoYnVuZGxlKSB7XG5cdFx0XHRsb2NhdGlvbi5wdXNoKFwiYnVuZGxlc1wiKTtcblx0XHRcdGxvY2F0aW9uLnB1c2goYnVuZGxlLmdldChcImhhbmRsZVwiKSk7XG5cdFx0XHRpZiAobWVkaWEpIHtcblx0XHRcdFx0bWVkaWFJbmRleCA9IGJ1bmRsZS5nZXQoXCJtZWRpYVwiKS5pbmRleE9mKG1lZGlhKTtcblx0XHRcdFx0aWYgKG1lZGlhSW5kZXggPj0gMCkge1xuXHRcdFx0XHRcdGxvY2F0aW9uLnB1c2gobWVkaWFJbmRleCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0Ly8gbG9jYXRpb24ucHVzaChcIlwiKTtcblx0XHRyZXR1cm4gbG9jYXRpb24uam9pbihcIi9cIik7XG5cdH0sXG5cblx0X2dvVG9Mb2NhdGlvbjogZnVuY3Rpb24oYnVuZGxlLCBtZWRpYSkge1xuXHRcdHRoaXMubmF2aWdhdGUodGhpcy5fZ2V0TG9jYXRpb24oYnVuZGxlLCBtZWRpYSksIHtcblx0XHRcdHRyaWdnZXI6IHRydWVcblx0XHR9KTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBVUkwgdG8gSlM6IHJvdXRlciBoYW5kbGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHR0b1Jvb3Q6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMudHJpZ2dlcihcImNoYW5nZTpiZWZvcmVcIik7XG5cdFx0aWYgKGJ1bmRsZXMuc2VsZWN0ZWQpIHtcblx0XHRcdGJ1bmRsZXMuc2VsZWN0ZWQuZ2V0KFwibWVkaWFcIikuZGVzZWxlY3QoKTtcblx0XHRcdGJ1bmRsZXMuZGVzZWxlY3QoKTtcblx0XHR9XG5cdFx0Ly8ga2V5d29yZHMuZGVzZWxlY3QoKTtcblx0XHRhcnRpY2xlcy5kZXNlbGVjdCgpO1xuXHRcdHRoaXMudHJpZ2dlcihcImNoYW5nZTphZnRlclwiKTtcblx0fSxcblxuXHR0b05vdEZvdW5kOiBmdW5jdGlvbihzbHVnKSB7XG5cdFx0Y29uc29sZS5pbmZvKFwicm91dGU6Wyo6JXNdXCIsIHNsdWcpO1xuXHR9LFxuXG5cdC8vIHRvQnVuZGxlTGlzdDogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dGhpcy5uYXZpZ2F0ZShcIlwiLCB7XG5cdC8vIFx0XHR0cmlnZ2VyOiB0cnVlLFxuXHQvLyBcdFx0cmVwbGFjZTogdHJ1ZVxuXHQvLyBcdH0pO1xuXHQvLyB9LFxuXG5cdHRvQnVuZGxlSXRlbTogZnVuY3Rpb24oYnVuZGxlSGFuZGxlKSB7XG5cdFx0dmFyIGJ1bmRsZSA9IGJ1bmRsZXMuZmluZFdoZXJlKHtcblx0XHRcdGhhbmRsZTogYnVuZGxlSGFuZGxlXG5cdFx0fSk7XG5cdFx0aWYgKCFidW5kbGUpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIGJ1bmRsZSB3aXRoIGhhbmRsZSBcXFwiXCIgKyBidW5kbGVIYW5kbGUgKyBcIlxcXCJcIik7XG5cdFx0fVxuXHRcdHRoaXMuX2NoYW5nZVNlbGVjdGlvbihidW5kbGUpO1xuXHR9LFxuXG5cdHRvTWVkaWFJdGVtOiBmdW5jdGlvbihidW5kbGVIYW5kbGUsIG1lZGlhSW5kZXgpIHtcblx0XHR2YXIgYnVuZGxlLCBtZWRpYTtcblx0XHQvLyBpZiAoYnVuZGxlSGFuZGxlKSB7XG5cdFx0YnVuZGxlID0gYnVuZGxlcy5maW5kV2hlcmUoeyBoYW5kbGU6IGJ1bmRsZUhhbmRsZSB9KTtcblx0XHRpZiAoIWJ1bmRsZSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiTm8gYnVuZGxlIHdpdGggaGFuZGxlIFxcXCJcIiArIGJ1bmRsZUhhbmRsZSArIFwiXFxcIiBmb3VuZFwiKTtcblx0XHR9XG5cdFx0Ly8gaWYgKG1lZGlhSW5kZXgpIHtcblx0XHRtZWRpYSA9IGJ1bmRsZS5nZXQoXCJtZWRpYVwiKS5hdChtZWRpYUluZGV4KTtcblx0XHRpZiAoIW1lZGlhKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJObyBtZWRpYSBhdCBpbmRleCBcIiArIG1lZGlhSW5kZXggKyBcIiBpbiBidW5kbGUgd2l0aCBoYW5kbGUgXFxcIlwiICsgYnVuZGxlSGFuZGxlICsgXCJcXFwiIGZvdW5kXCIpO1xuXHRcdH1cblx0XHQvLyB9XG5cdFx0Ly8gfVxuXHRcdHRoaXMuX2NoYW5nZVNlbGVjdGlvbihidW5kbGUsIG1lZGlhKTtcblx0fSxcblxuXHR0b0FydGljbGVJdGVtOiBmdW5jdGlvbihhcnRpY2xlSGFuZGxlKSB7XG5cdFx0dmFyIGFydGljbGUgPSBhcnRpY2xlcy5maW5kV2hlcmUoeyBoYW5kbGU6IGFydGljbGVIYW5kbGUgfSk7XG5cdFx0aWYgKCFhcnRpY2xlKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBhcnRpY2xlIHdpdGggaGFuZGxlIFxcXCJcIiArIGFydGljbGVIYW5kbGUgKyBcIlxcXCJcIik7XG5cdFx0fVxuXHRcdHRoaXMudHJpZ2dlcihcImNoYW5nZTpiZWZvcmVcIiwgYXJ0aWNsZSk7XG5cdFx0YnVuZGxlcy5kZXNlbGVjdCgpO1xuXHRcdGFydGljbGVzLnNlbGVjdChhcnRpY2xlKTtcblx0XHR0aGlzLnRyaWdnZXIoXCJjaGFuZ2U6YWZ0ZXJcIiwgYXJ0aWNsZSk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBVUkwgdG8gSlM6IHByaXZhdGUgaGVscGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Lypcblx0LyogTk9URTogU2VsZWN0aW9uIG9yZGVyXG5cdC8qIC0gQXBwbHkgbWVkaWEgc2VsZWN0aW9uIHRvICppbmNvbWluZyBidW5kbGUqLCBhcyBub3QgdG8gdHJpZ2dlclxuXHQvKlx0dW5uZWNjZXNhcnkgZXZlbnRzIG9uIGFuIG91dGdvaW5nIGJ1bmRsZS4gT3V0Z29pbmcgYnVuZGxlIG1lZGlhIHNlbGVjdGlvblxuXHQvKlx0cmVtYWlucyB1bnRvdWNoZWQuXG5cdC8qIC0gQXBwbHkgbWVkaWEgc2VsZWN0aW9uICpiZWZvcmUqIHNlbGVjdGluZyB0aGUgaW5jb21pbmcgYnVuZGxlLiBWaWV3c1xuXHQvKlx0bm9ybWFsbHkgbGlzdGVuIHRvIHRoZSBzZWxlY3RlZCBidW5kbGUgb25seSwgc28gaWYgdGhlIGJ1bmRsZSBpcyBjaGFuZ2luZyxcblx0LypcdHRoZXkgd2lsbCBub3QgYmUgbGlzdGVuaW5nIHRvIG1lZGlhIHNlbGVjdGlvbiBjaGFuZ2VzIHlldC5cblx0LyovXG5cdF9jaGFuZ2VTZWxlY3Rpb246IGZ1bmN0aW9uKGJ1bmRsZSwgbWVkaWEpIHtcblx0XHR2YXIgbGFzdEJ1bmRsZSwgbGFzdE1lZGlhO1xuXHRcdGlmIChidW5kbGUgPT09IHZvaWQgMCkgYnVuZGxlID0gbnVsbDtcblx0XHRpZiAobWVkaWEgPT09IHZvaWQgMCkgbWVkaWEgPSBudWxsO1xuXG5cdFx0bGFzdEJ1bmRsZSA9IGJ1bmRsZXMuc2VsZWN0ZWQ7XG5cdFx0bGFzdE1lZGlhID0gbGFzdEJ1bmRsZSA/IGxhc3RCdW5kbGUuZ2V0KFwibWVkaWFcIikuc2VsZWN0ZWQgOiBudWxsO1xuXHRcdGNvbnNvbGUubG9nKFwiY29udHJvbGxlcjo6X2NoYW5nZVNlbGVjdGlvbiBidW5kbGU6WyVzIC0+ICVzXSBtZWRpYTpbJXMgLT4gJXNdXCIsXG5cdFx0XHQobGFzdEJ1bmRsZSA/IGxhc3RCdW5kbGUuY2lkIDogbGFzdEJ1bmRsZSksIChidW5kbGUgPyBidW5kbGUuY2lkIDogYnVuZGxlKSxcblx0XHRcdChsYXN0TWVkaWEgPyBsYXN0TWVkaWEuY2lkIDogbGFzdE1lZGlhKSwgKG1lZGlhID8gbWVkaWEuY2lkIDogbWVkaWEpXG5cdFx0KTtcblxuXHRcdGlmICghYXJ0aWNsZXMuc2VsZWN0ZWQgJiYgKGxhc3RCdW5kbGUgPT09IGJ1bmRsZSkgJiYgKGxhc3RNZWRpYSA9PT0gbWVkaWEpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0dGhpcy50cmlnZ2VyKFwiY2hhbmdlOmJlZm9yZVwiLCBidW5kbGUsIG1lZGlhKTtcblx0XHRidW5kbGUgJiYgYnVuZGxlLmdldChcIm1lZGlhXCIpLnNlbGVjdChtZWRpYSk7XG5cdFx0YnVuZGxlcy5zZWxlY3QoYnVuZGxlKTtcblx0XHRhcnRpY2xlcy5kZXNlbGVjdCgpO1xuXHRcdHRoaXMudHJpZ2dlcihcImNoYW5nZTphZnRlclwiLCBidW5kbGUsIG1lZGlhKTtcblx0fSxcbn0pO1xuXG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IENvbnRyb2xsZXIoKTsiLCIvKipcbi8qIEBtb2R1bGUgYXBwL2NvbnRyb2wvR2xvYmFsc1xuLyovXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG5cdC8vIHJldXNhYmxlIHZhcnNcblx0dmFyIG8sIHMsIHNvO1xuXHQvLyBnbG9iYWwgaGFzaFxuXHR2YXIgZyA9IHt9O1xuXHQvLyBTQVNTIDwtLT4gSlMgc2hhcmVkIGhhc2hcblx0dmFyIHNhc3MgPSByZXF1aXJlKFwiLi4vLi4vLi4vc2Fzcy92YXJpYWJsZXMuanNvblwiKTtcblxuXHQvLyBKVU5LIEZJUlNUOiBTb21lIGFwcC13aWRlIGRlZmF1bHRzXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRnLlZQQU5fRFJBRyA9IDAuOTU7IC8vIGFzIGZhY3RvciBvZiBwb2ludGVyIGRlbHRhXG5cdGcuSFBBTl9PVVRfRFJBRyA9IDAuNDsgLy8gZmFjdG9yXG5cdGcuVlBBTl9PVVRfRFJBRyA9IDAuMTsgLy8gZmFjdG9yXG5cdGcuUEFOX1RIUkVTSE9MRCA9IDE1OyAvLyBweFxuXHRnLkNPTExBUFNFX1RIUkVTSE9MRCA9IDc1OyAvLyBweFxuXHRnLkNPTExBUFNFX09GRlNFVCA9IHBhcnNlSW50KHNhc3MudGVtcFtcImNvbGxhcHNlX29mZnNldFwiXSk7XG5cblx0Ly8gYnJlYWtwb2ludHNcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdGcuQlJFQUtQT0lOVFMgPSB7fTtcblx0Zm9yIChzIGluIHNhc3MuYnJlYWtwb2ludHMpIHtcblx0XHRvID0gc2Fzcy5icmVha3BvaW50c1tzXTtcblx0XHQvKmlmIChBcnJheS5pc0FycmF5KG8pKSB7XG5cdFx0XHRnLkJSRUFLUE9JTlRTW3NdID0gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoe30sIHtcblx0XHRcdFx0XCJtYXRjaGVzXCI6IHtcblx0XHRcdFx0XHRnZXQ6IF8ucGFydGlhbChfLnNvbWUsIG8ubWFwKHdpbmRvdy5tYXRjaE1lZGlhKSwgXy5wcm9wZXJ0eShcIm1hdGNoZXNcIikpXG5cdFx0XHRcdH0sXG5cdFx0XHRcdFwibWVkaWFcIjoge1xuXHRcdFx0XHRcdHZhbHVlOiBvLmpvaW4oXCIsIFwiKVxuXHRcdFx0XHR9LFxuXHRcdFx0XHRcInF1ZXJpZXNcIjoge1xuXHRcdFx0XHRcdHZhbHVlOiBvLm1hcCh3aW5kb3cubWF0Y2hNZWRpYSlcblx0XHRcdFx0fSxcblx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRnLkJSRUFLUE9JTlRTW3NdID0gd2luZG93Lm1hdGNoTWVkaWEobyk7XG5cdFx0fSovXG5cdFx0byA9IEFycmF5LmlzQXJyYXkobykgPyBvLmpvaW4oXCIsIFwiKSA6IG87XG5cdFx0byA9IG8ucmVwbGFjZSgvW1xcJ1xcXCJdL2csIFwiXCIpO1xuXHRcdG8gPSB3aW5kb3cubWF0Y2hNZWRpYShvKTtcblx0XHRvLmNsYXNzTmFtZSA9IHM7XG5cdFx0Zy5CUkVBS1BPSU5UU1tzXSA9IG87XG5cdH1cblx0aWYgKERFQlVHKSB7XG5cdFx0Y29uc29sZS5ncm91cChcIkJyZWFrcG9pbnRzXCIpO1xuXHRcdGZvciAocyBpbiBnLkJSRUFLUE9JTlRTKSB7XG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOiAlbyAlb1wiLCBzLCBnLkJSRUFLUE9JTlRTW3NdLCBzYXNzLmJyZWFrcG9pbnRzW3NdICsgJycpO1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczogJW9cIiwgcywgZy5CUkVBS1BPSU5UU1tzXS5tZWRpYSk7XG5cdFx0fVxuXHRcdGNvbnNvbGUuZ3JvdXBFbmQoKTtcblx0fVxuXG5cdC8vIGJhc2UgY29sb3JzLCBkaW1lbnNpb25zXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRnLkRFRkFVTFRfQ09MT1JTID0gXy5jbG9uZShzYXNzLmRlZmF1bHRfY29sb3JzKTtcblx0Zy5IT1JJWk9OVEFMX1NURVAgPSBwYXJzZUZsb2F0KHNhc3MudW5pdHNbXCJodV9weFwiXSk7XG5cdGcuVkVSVElDQUxfU1RFUCA9IHBhcnNlRmxvYXQoc2Fzcy51bml0c1tcInZ1X3B4XCJdKTtcblxuXG5cdC8vIHBhdGhzLCBuZXR3b3JraW5nXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHQvLyB2YXIgdG9BYnNvbHV0ZVVSTCA9IChmdW5jdGlvbigpIHtcblx0Ly8gXHR2YXIgYSA9IG51bGw7XG5cdC8vIFx0cmV0dXJuIGZ1bmN0aW9uKHVybCkge1xuXHQvLyBcdFx0YSA9IGEgfHwgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuXHQvLyBcdFx0YS5ocmVmID0gdXJsO1xuXHQvLyBcdFx0cmV0dXJuIGEuaHJlZjtcblx0Ly8gXHR9O1xuXHQvLyB9KSgpO1xuXHQvLyBnLkFQUF9ST09UID0gdG9BYnNvbHV0ZVVSTCh3aW5kb3cuYXBwcm9vdCk7XG5cdC8vIGcuTUVESUFfRElSID0gdG9BYnNvbHV0ZVVSTCh3aW5kb3cubWVkaWFkaXIpO1xuXG5cdGcuQVBQX1JPT1QgPSB3aW5kb3cuYXBwcm9vdDtcblx0Zy5NRURJQV9ESVIgPSB3aW5kb3cubWVkaWFkaXI7XG5cblx0ZGVsZXRlIHdpbmRvdy5hcHByb290O1xuXHRkZWxldGUgd2luZG93Lm1lZGlhZGlyO1xuXG5cdC8vIGhhcmRjb2RlZCBmb250IGRhdGFcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdGcuRk9OVF9NRVRSSUNTID0ge1xuXHRcdFwiRnJhbmtsaW4gR290aGljIEZTXCI6IHtcblx0XHRcdFwidW5pdHNQZXJFbVwiOiAxMDAwLFxuXHRcdFx0XCJhc2NlbnRcIjogODI3LFxuXHRcdFx0XCJkZXNjZW50XCI6IC0xNzNcblx0XHR9LFxuXHRcdFwiSVRDRnJhbmtsaW5Hb3RoaWNTdGRcIjoge1xuXHRcdFx0XCJ1bml0c1BlckVtXCI6IDEwMDAsXG5cdFx0XHRcImFzY2VudFwiOiA2ODYsXG5cdFx0XHRcImRlc2NlbnRcIjogLTMxNFxuXHRcdH0sXG5cdFx0XCJGb2xpb0ZpZ3VyZXNcIjoge1xuXHRcdFx0XCJ1bml0c1BlckVtXCI6IDEwMjQsXG5cdFx0XHRcImFzY2VudFwiOiA5MzksXG5cdFx0XHRcImRlc2NlbnRcIjogLTI1NlxuXHRcdH0sXG5cdH07XG5cblx0Zy5QQVVTRV9DSEFSID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweDIzRjgpO1xuXHRnLlBMQVlfQ0hBUiA9IFN0cmluZy5mcm9tQ2hhckNvZGUoMHgyM0Y1KTtcblx0Zy5TVE9QX0NIQVIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MjNGOSk7XG5cblx0Ly8gdHJhbnNsYXRlIGNvbW1vbiB0ZW1wbGF0ZVxuXG5cdGcuVFJBTlNMQVRFX1RFTVBMQVRFID0gZnVuY3Rpb24oeCwgeSkge1xuXHRcdHJldHVybiBcInRyYW5zbGF0ZShcIiArIHggKyBcInB4LCBcIiArIHkgKyBcInB4KVwiO1xuXHRcdC8vIHJldHVybiBcInRyYW5zbGF0ZTNkKFwiICsgeCArIFwicHgsIFwiICsgeSArIFwicHggLDBweClcIjtcblx0fTtcblx0Ly8gdGltaW5nLCBlYXNpbmdcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdHZhciBlYXNlID0gZy5UUkFOU0lUSU9OX0VBU0UgPSBzYXNzLnRyYW5zaXRpb25zW1wiZWFzZVwiXTtcblx0dmFyIGR1cmF0aW9uID0gZy5UUkFOU0lUSU9OX0RVUkFUSU9OID0gcGFyc2VGbG9hdChzYXNzLnRyYW5zaXRpb25zW1wiZHVyYXRpb25fbXNcIl0pO1xuXHR2YXIgZGVsYXlJbnRlcnZhbCA9IGcuVFJBTlNJVElPTl9ERUxBWV9JTlRFUlZBTCA9IHBhcnNlRmxvYXQoc2Fzcy50cmFuc2l0aW9uc1tcImRlbGF5X2ludGVydmFsX21zXCJdKTtcblx0dmFyIG1pbkRlbGF5ID0gZy5UUkFOU0lUSU9OX01JTl9ERUxBWSA9IHBhcnNlRmxvYXQoc2Fzcy50cmFuc2l0aW9uc1tcIm1pbl9kZWxheV9tc1wiXSk7XG5cdHZhciBkZWxheSA9IGcuVFJBTlNJVElPTl9ERUxBWSA9IGcuVFJBTlNJVElPTl9EVVJBVElPTiArIGcuVFJBTlNJVElPTl9ERUxBWV9JTlRFUlZBTDtcblxuXHQvLyBjc3MgdHJhbnNpdGlvbiBwcmVzZXRzXG5cdC8vIFRPRE86IGdldCByaWQgb2YgdGhpc1xuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblxuXHQvLyB2YXIgdHggPSBmdW5jdGlvbih0eG8sIGR1cmF0aW9uQ291bnQsIGRlbGF5Q291bnQpIHtcblx0Ly8gXHR0eG8uZHVyYXRpb24gPSAoZHVyYXRpb24gKiBkdXJhdGlvbkNvdW50KVxuXHQvLyBcdFx0KyAoZGVsYXlJbnRlcnZhbCAqIChkdXJhdGlvbkNvdW50IC0gMSkpO1xuXHQvLyBcdHR4by5kZWxheSA9IChkZWxheSAqIGRlbGF5Q291bnQpICsgbWluRGVsYXk7XG5cdC8vIH07XG5cblx0byA9IHt9O1xuXG5cdG8uTk9ORSA9IHtcblx0XHRkZWxheTogMCxcblx0XHRkdXJhdGlvbjogMCxcblx0XHRlYXNpbmc6IFwic3RlcC1zdGFydFwiXG5cdH07XG5cdG8uTk9XID0ge1xuXHRcdGRlbGF5OiAwLFxuXHRcdGR1cmF0aW9uOiBkdXJhdGlvbixcblx0XHRlYXNpbmc6IGVhc2Vcblx0fTtcblx0by5VTlNFVCA9IF8uZGVmYXVsdHMoe1xuXHRcdGNzc1RleHQ6IFwiXCJcblx0fSwgby5OT05FKTtcblxuXHR2YXIgdHhBbGlnbmVkID0gXy5kZWZhdWx0cyh7XG5cdFx0ZHVyYXRpb246IGR1cmF0aW9uIC0gbWluRGVsYXlcblx0fSwgby5OT1cpO1xuXHRvLkZJUlNUID0gXy5kZWZhdWx0cyh7XG5cdFx0ZGVsYXk6IGRlbGF5ICogMC4wICsgbWluRGVsYXlcblx0fSwgdHhBbGlnbmVkKTtcblx0by5CRVRXRUVOID0gXy5kZWZhdWx0cyh7XG5cdFx0ZGVsYXk6IGRlbGF5ICogMS4wICsgbWluRGVsYXlcblx0fSwgdHhBbGlnbmVkKTtcblx0by5MQVNUID0gXy5kZWZhdWx0cyh7XG5cdFx0ZGVsYXk6IGRlbGF5ICogMi4wICsgbWluRGVsYXlcblx0fSwgdHhBbGlnbmVkKTtcblx0by5BRlRFUiA9IF8uZGVmYXVsdHMoe1xuXHRcdGRlbGF5OiBkZWxheSAqIDIuMCArIG1pbkRlbGF5XG5cdH0sIHR4QWxpZ25lZCk7XG5cblx0by5CRVRXRUVOX0VBUkxZID0gXy5kZWZhdWx0cyh7XG5cdFx0ZGVsYXk6IGRlbGF5ICogMS4wICsgbWluRGVsYXkgLSA2MFxuXHR9LCB0eEFsaWduZWQpO1xuXHRvLkJFVFdFRU5fTEFURSA9IF8uZGVmYXVsdHMoe1xuXHRcdGRlbGF5OiBkZWxheSAqIDEuMCArIG1pbkRlbGF5ICsgNjBcblx0fSwgdHhBbGlnbmVkKTtcblxuXHRvLkZJUlNUX0xBVEUgPSBfLmRlZmF1bHRzKHtcblx0XHRkZWxheTogZGVsYXkgKiAwLjUgKyBtaW5EZWxheVxuXHR9LCB0eEFsaWduZWQpO1xuXHRvLkxBU1RfRUFSTFkgPSBfLmRlZmF1bHRzKHtcblx0XHRkZWxheTogZGVsYXkgKiAxLjUgKyBtaW5EZWxheVxuXHR9LCB0eEFsaWduZWQpO1xuXHQvLyBvLkZJUlNUX0xBVEUgPSBcdFx0Xy5kZWZhdWx0cyh7ZGVsYXk6IHR4RGVsYXkqMC4wICsgdHhNaW5EZWxheSoyfSwgdHhBbGlnbmVkKTtcblx0Ly8gby5MQVNUX0VBUkxZID0gXHRcdF8uZGVmYXVsdHMoe2RlbGF5OiB0eERlbGF5KjIuMCArIHR4TWluRGVsYXkqMH0sIHR4QWxpZ25lZCk7XG5cdC8vIG8uQUZURVIgPSBcdFx0XHRfLmRlZmF1bHRzKHtkZWxheTogdHhEZWxheSoyLjAgKyB0eE1pbkRlbGF5fSwgdHhBbGlnbmVkKTtcblxuXHRjb25zb2xlLmdyb3VwQ29sbGFwc2VkKFwiVHJhbnNpdGlvbnNcIik7XG5cdGZvciAocyBpbiBvKSB7XG5cdFx0c28gPSBvW3NdO1xuXHRcdHNvLm5hbWUgPSBzO1xuXHRcdHNvLmNsYXNzTmFtZSA9IFwidHgtXCIgKyBzLnJlcGxhY2UoXCJfXCIsIFwiLVwiKS50b0xvd2VyQ2FzZSgpO1xuXHRcdGlmICghc28uaGFzT3duUHJvcGVydHkoXCJjc3NUZXh0XCIpKSB7XG5cdFx0XHRzby5jc3NUZXh0ID0gc28uZHVyYXRpb24gLyAxMDAwICsgXCJzIFwiICsgc28uZWFzaW5nICsgXCIgXCIgKyBzby5kZWxheSAvIDEwMDAgKyBcInNcIjtcblx0XHR9XG5cdFx0Y29uc29sZS5sb2coXCIlczogJXNcIiwgc28ubmFtZSwgc28uY3NzVGV4dCk7XG5cdH1cblx0Y29uc29sZS5ncm91cEVuZCgpO1xuXHRnLnRyYW5zaXRpb25zID0gbztcblxuXHRyZXR1cm4gZztcbn0oKSk7IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9CYXNlSXRlbVxuICogQHJlcXVpcmVzIG1vZHVsZTpiYWNrYm9uZVxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xudmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuXG52YXIgZGVmYXVsdHMgPSB7XG5cdHJvdXRlTmFtZTogXCJpbml0aWFsXCIsXG5cdGNvbGxhcHNlZDogZmFsc2UsXG5cdGFydGljbGU6IG51bGwsXG5cdHdpdGhBcnRpY2xlOiBmYWxzZSxcblx0YnVuZGxlOiBudWxsLFxuXHR3aXRoQnVuZGxlOiBmYWxzZSxcblx0bWVkaWE6IG51bGwsXG5cdHdpdGhNZWRpYTogZmFsc2UsXG59O1xuXG52YXIgQXBwU3RhdGUgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xuXHRkZWZhdWx0czogZGVmYXVsdHMsXG5cdC8vIGdldHRlcnM6IE9iamVjdC5rZXlzKGRlZmF1bHRzKSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFwcFN0YXRlOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvQmFzZUl0ZW1cbiAqIEByZXF1aXJlcyBtb2R1bGU6YmFja2JvbmVcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBNb2RlbCA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKS5Nb2RlbDtcbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xuLy8gdmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC91dGlscy9zdHJpbmdzL3N0cmlwVGFnc30gKi9cbi8vIHZhciBzdHJpcFRhZ3MgPSByZXF1aXJlKFwidXRpbHMvc3RyaW5ncy9zdHJpcFRhZ3NcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvcGFyc2VTeW1BdHRyc30gKi9cbi8vdmFyIHBhcnNlU3ltQXR0cnMgPSByZXF1aXJlKFwiYXBwL21vZGVsL3BhcnNlU3ltQXR0cnNcIik7XG5cbnZhciBwYXJzZVN5bUF0dHJzID0gZnVuY3Rpb24ocykge1xuXHRyZXR1cm4gcy5yZXBsYWNlKC8oXFwsfFxcOykvZywgZnVuY3Rpb24obSkge1xuXHRcdHJldHVybiAobSA9PSBcIixcIikgPyBcIjtcIiA6IFwiLFwiO1xuXHR9KTtcbn07XG52YXIgdG9BdHRyc0hhc2ggPSBmdW5jdGlvbihvYmosIGF0dHIpIHtcblx0aWYgKF8uaXNTdHJpbmcoYXR0cikpIHtcblx0XHR2YXIgaWR4ID0gYXR0ci5pbmRleE9mKFwiOlwiKTtcblx0XHRpZiAoaWR4ID4gMCkge1xuXHRcdFx0b2JqW2F0dHIuc3Vic3RyaW5nKDAsIGlkeCldID0gcGFyc2VTeW1BdHRycyhhdHRyLnN1YnN0cmluZyhpZHggKyAxKSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG9ialthdHRyXSA9IGF0dHI7IC8vIHRvIG1hdGNoIEhUTUw1PD5YSFRNTCB2YWx1ZWxlc3MgYXR0cmlidXRlc1xuXHRcdH1cblx0fSAvLyBlbHNlIGlnbm9yZSBub24tc3RyaW5nIHZhbHVlc1xuXHRyZXR1cm4gb2JqO1xufTtcblxudmFyIEJhc2VJdGVtUHJvdG8gPSB7XG5cblx0X2RvbVByZWZpeDogXCJfXCIsXG5cblx0LyoqIEB0eXBlIHtPYmplY3R9ICovXG5cdGRlZmF1bHRzOiB7XG5cdFx0Ly8gYXR0cnM6IGZ1bmN0aW9uKCkgeyByZXR1cm4ge307IH0sXG5cdFx0Z2V0IGF0dHJzKCkge1xuXHRcdFx0cmV0dXJuIHt9O1xuXHRcdH0sXG5cdH0sXG5cblx0Z2V0dGVyczogW1wiZG9taWRcIl0sXG5cblx0bXV0YXRvcnM6IHtcblx0XHRkb21pZDogZnVuY3Rpb24oKSB7XG5cdFx0XHRpZiAoIXRoaXMuaGFzT3duUHJvcGVydHkoXCJfZG9tSWRcIikpXG5cdFx0XHRcdHRoaXMuX2RvbUlkID0gdGhpcy5fZG9tUHJlZml4ICsgdGhpcy5pZDtcblx0XHRcdHJldHVybiB0aGlzLl9kb21JZDtcblx0XHR9LFxuXHRcdGF0dHJzOiB7XG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKGtleSwgdmFsdWUsIG9wdGlvbnMsIHNldCkge1xuXHRcdFx0XHRpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcblx0XHRcdFx0XHR2YWx1ZSA9IHZhbHVlLnJlZHVjZSh0b0F0dHJzSGFzaCwge30pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICghXy5pc09iamVjdCh2YWx1ZSkpIHtcblx0XHRcdFx0XHRjb25zb2xlLmVycm9yKFwiJXM6OmF0dHJzIHZhbHVlIG5vdCBhbiBvYmplY3Qgb3Igc3RyaW5nIGFycmF5XCIsIHRoaXMuY2lkLCB2YWx1ZSk7XG5cdFx0XHRcdFx0dmFsdWUgPSB7fTtcblx0XHRcdFx0fVxuXHRcdFx0XHRzZXQoa2V5LCB2YWx1ZSwgb3B0aW9ucyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0fSxcblxuXHRhdHRyOiBmdW5jdGlvbihhdHRyKSB7XG5cdFx0cmV0dXJuIHRoaXMuYXR0cnMoKVthdHRyXTtcblx0fSxcblxuXHRhdHRyczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0KFwiYXR0cnNcIik7XG5cdH0sXG5cblx0dG9TdHJpbmc6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLmdldChcImRvbWlkXCIpO1xuXHR9XG59O1xuXG52YXIgQmFzZUl0ZW0gPSB7XG5cdGV4dGVuZDogZnVuY3Rpb24ocHJvdG8sIG9iaikge1xuXHRcdHZhciBjb25zdHIsIHByb3BOYW1lOyAvLywgcHJvcERlZjtcblx0XHRmb3IgKHByb3BOYW1lIGluIHByb3RvKSB7XG5cdFx0XHRpZiAocHJvdG8uaGFzT3duUHJvcGVydHkocHJvcE5hbWUpICYmIF8uaXNPYmplY3QocHJvdG9bcHJvcE5hbWVdKSkgeyAvLyhPYmplY3QuZ2V0UHJvdG90eXBlT2YocHJvdG9bcHJvcE5hbWVdKSA9PT0gT2JqZWN0LnByb3RvdHlwZSkpIHtcblx0XHRcdFx0Xy5kZWZhdWx0cyhwcm90b1twcm9wTmFtZV0sIEJhc2VJdGVtUHJvdG9bcHJvcE5hbWVdKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJCYXNlSXRlbTo6ZXh0ZW5kICclczolcycgaXMgT2JqZWN0XFxuJXNcIiwgcHJvdG8uX2RvbVByZWZpeCwgcCwgSlNPTi5zdHJpbmdpZnkocHJvdG9bcF0pKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Ly8gaWYgKHByb3RvLnByb3BlcnRpZXMgJiYgdGhpcy5wcm90b3R5cGUucHJvcGVydGllcykge1xuXHRcdC8vIFx0Xy5kZWZhdWx0cyhwcm90by5wcm9wZXJ0aWVzLCB0aGlzLnByb3RvdHlwZS5wcm9wZXJ0aWVzKTtcblx0XHQvLyB9XG5cdFx0Y29uc3RyID0gTW9kZWwuZXh0ZW5kLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHRpZiAoQXJyYXkuaXNBcnJheShjb25zdHIucHJvdG90eXBlLmdldHRlcnMpKSB7XG5cdFx0XHRjb25zdHIucHJvdG90eXBlLmdldHRlcnMuZm9yRWFjaChmdW5jdGlvbihnZXR0ZXJOYW1lKSB7XG5cdFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb25zdHIucHJvdG90eXBlLCBnZXR0ZXJOYW1lLCB7XG5cdFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRcdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRoaXMuZ2V0KGdldHRlck5hbWUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0Ly8gaWYgKF8uaXNPYmplY3QocHJvdG8ucHJvcGVydGllcykpIHtcblx0XHQvLyBcdGZvciAocHJvcE5hbWUgaW4gcHJvdG8ucHJvcGVydGllcykge1xuXHRcdC8vIFx0XHRpZiAocHJvdG8ucHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShwcm9wTmFtZSkpIHtcblx0XHQvLyBcdFx0XHRwcm9wRGVmID0gcHJvdG8ucHJvcGVydGllc1twcm9wTmFtZV07XG5cdFx0Ly8gXHRcdFx0aWYgKF8uaXNGdW5jdGlvbihwcm9wRGVmKSkge1xuXHRcdC8vIFx0XHRcdFx0cHJvdG8ucHJvcGVydGllc1twcm9wTmFtZV0gPSB7XG5cdFx0Ly8gXHRcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsIGdldDogcHJvcERlZlxuXHRcdC8vIFx0XHRcdFx0fTtcblx0XHQvLyBcdFx0XHR9IGVsc2UgaWYgKF8uaXNPYmplY3QocHJvcERlZikpe1xuXHRcdC8vIFx0XHRcdFx0cHJvcERlZi5lbnVtZXJhYmxlID0gdHJ1ZTtcblx0XHQvLyBcdFx0XHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRcdFx0ZGVsZXRlIHByb3RvLnByb3BlcnRpZXNbcHJvcE5hbWVdO1xuXHRcdC8vIFx0XHRcdH1cblx0XHQvLyBcdFx0fVxuXHRcdC8vIFx0fVxuXHRcdC8vIFx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXMocHJvdG8sIHByb3RvLnByb3BlcnRpZXMpO1xuXHRcdC8vIFx0ZGVsZXRlIHByb3RvLnByb3BlcnRpZXM7XG5cdFx0Ly8gfVxuXHRcdHJldHVybiBjb25zdHI7XG5cdH1cbn07XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9CYXNlSXRlbX1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBCYXNlSXRlbS5leHRlbmQuY2FsbChNb2RlbCwgQmFzZUl0ZW1Qcm90bywgQmFzZUl0ZW0pO1xuLy8gbW9kdWxlLmV4cG9ydHMgPSBNb2RlbC5leHRlbmQoQmFzZUl0ZW1Qcm90bywgQmFzZUl0ZW0pO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvblxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG52YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvbn1cbiAqL1xudmFyIFNlbGVjdGFibGVDb2xsZWN0aW9uID0gQmFja2JvbmUuQ29sbGVjdGlvbi5leHRlbmQoe1xuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG1vZGVscywgb3B0aW9ucykge1xuXHRcdG9wdGlvbnMgPSBfLmRlZmF1bHRzKHt9LCBvcHRpb25zLCB7XG5cdFx0XHRpbml0aWFsU2VsZWN0aW9uOiBcIm5vbmVcIixcblx0XHRcdHNpbGVudEluaXRpYWw6IHRydWVcblx0XHR9KTtcblx0XHR0aGlzLmluaXRpYWxTZWxlY3Rpb24gPSBvcHRpb25zLmluaXRpYWxTZWxlY3Rpb247XG5cdFx0dGhpcy5pbml0aWFsT3B0aW9ucyA9IHtcblx0XHRcdHNpbGVudDogb3B0aW9ucy5zaWxlbnRJbml0aWFsXG5cdFx0fTtcblx0fSxcblxuXHRyZXNldDogZnVuY3Rpb24obW9kZWxzLCBvcHRpb25zKSB7XG5cdFx0dGhpcy5kZXNlbGVjdCh0aGlzLmluaXRpYWxPcHRpb25zKTtcblx0XHRCYWNrYm9uZS5Db2xsZWN0aW9uLnByb3RvdHlwZS5yZXNldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdGlmICh0aGlzLmluaXRpYWxTZWxlY3Rpb24gPT09IFwiZmlyc3RcIiAmJiB0aGlzLmxlbmd0aCkge1xuXHRcdFx0dGhpcy5zZWxlY3QodGhpcy5hdCgwKSwgdGhpcy5pbml0aWFsT3B0aW9ucyk7XG5cdFx0fVxuXHR9LFxuXG5cdHNlbGVjdDogZnVuY3Rpb24obmV3TW9kZWwsIG9wdGlvbnMpIHtcblx0XHRpZiAobmV3TW9kZWwgPT09IHZvaWQgMCkge1xuXHRcdFx0bmV3TW9kZWwgPSBudWxsO1xuXHRcdH1cblx0XHRpZiAodGhpcy5zZWxlY3RlZCA9PT0gbmV3TW9kZWwpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dmFyIHRyaWdnZXJFdmVudHMgPSAhKG9wdGlvbnMgJiYgb3B0aW9ucy5zaWxlbnQpO1xuXHRcdHZhciBvbGRNb2RlbCA9IHRoaXMuc2VsZWN0ZWQ7XG5cblx0XHR0aGlzLmxhc3RTZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWQ7XG5cdFx0dGhpcy5sYXN0U2VsZWN0ZWRJbmRleCA9IHRoaXMuc2VsZWN0ZWRJbmRleDtcblx0XHR0aGlzLnNlbGVjdGVkID0gbmV3TW9kZWw7XG5cdFx0dGhpcy5zZWxlY3RlZEluZGV4ID0gdGhpcy5pbmRleE9mKG5ld01vZGVsKTtcblxuXHRcdGlmIChvbGRNb2RlbCkge1xuXHRcdFx0aWYgKF8uaXNGdW5jdGlvbihvbGRNb2RlbC5kZXNlbGVjdCkpIHtcblx0XHRcdFx0b2xkTW9kZWwuZGVzZWxlY3Qob3B0aW9ucyk7XG5cdFx0XHR9IGVsc2UgaWYgKHRyaWdnZXJFdmVudHMpIHtcblx0XHRcdFx0b2xkTW9kZWwuc2VsZWN0ZWQgPSB2b2lkIDA7XG5cdFx0XHRcdG9sZE1vZGVsLnRyaWdnZXIoXCJkZXNlbGVjdGVkXCIsIG5ld01vZGVsLCBvbGRNb2RlbCk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodHJpZ2dlckV2ZW50cykgdGhpcy50cmlnZ2VyKFwiZGVzZWxlY3Q6b25lXCIsIG9sZE1vZGVsKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHRyaWdnZXJFdmVudHMpIHRoaXMudHJpZ2dlcihcImRlc2VsZWN0Om5vbmVcIiwgbnVsbCk7XG5cdFx0fVxuXG5cdFx0aWYgKG5ld01vZGVsKSB7XG5cdFx0XHRpZiAoXy5pc0Z1bmN0aW9uKG5ld01vZGVsLnNlbGVjdCkpIHtcblx0XHRcdFx0bmV3TW9kZWwuc2VsZWN0KG9wdGlvbnMpO1xuXHRcdFx0fSBlbHNlIGlmICh0cmlnZ2VyRXZlbnRzKSB7XG5cdFx0XHRcdG5ld01vZGVsLnNlbGVjdGVkID0gdHJ1ZTtcblx0XHRcdFx0bmV3TW9kZWwudHJpZ2dlcihcInNlbGVjdGVkXCIsIG5ld01vZGVsLCBvbGRNb2RlbCk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodHJpZ2dlckV2ZW50cykgdGhpcy50cmlnZ2VyKFwic2VsZWN0Om9uZVwiLCBuZXdNb2RlbCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmICh0cmlnZ2VyRXZlbnRzKSB0aGlzLnRyaWdnZXIoXCJzZWxlY3Q6bm9uZVwiLCBudWxsKTtcblx0XHR9XG5cdH0sXG5cblx0ZGVzZWxlY3Q6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLnNlbGVjdChudWxsLCBvcHRpb25zKTtcblx0fSxcblxuXHRzZWxlY3RBdDogZnVuY3Rpb24oaW5kZXgsIG9wdGlvbnMpIHtcblx0XHRpZiAoMCA+IGluZGV4IHx8IGluZGV4ID49IHRoaXMubGVuZ3RoKSB7XG5cdFx0XHRuZXcgUmFuZ2VFcnJvcihcImluZGV4IGlzIG91dCBvZiBib3VuZHNcIik7XG5cdFx0fVxuXHRcdHRoaXMuc2VsZWN0KHRoaXMuYXQoaW5kZXgpLCBvcHRpb25zKTtcblx0fSxcblxuXHRkaXN0YW5jZTogZnVuY3Rpb24oYSwgYikge1xuXHRcdHZhciBhSWR4LCBiSWR4O1xuXG5cdFx0aWYgKCFhKSByZXR1cm4gTmFOO1xuXHRcdGFJZHggPSB0aGlzLmluZGV4T2YoYSk7XG5cdFx0aWYgKGFJZHggPT0gLTEpIHJldHVybiBOYU47XG5cblx0XHRpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAxKSB7XG5cdFx0XHRiSWR4ID0gdGhpcy5zZWxlY3RlZEluZGV4O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoIWIpIHJldHVybiBOYU47XG5cdFx0XHRiSWR4ID0gdGhpcy5pbmRleE9mKGIpO1xuXHRcdFx0aWYgKGJJZHggPT0gLTEpIHJldHVybiBOYU47XG5cdFx0fVxuXHRcdHJldHVybiBNYXRoLmFicyhiSWR4IC0gYUlkeCk7XG5cdH0sXG5cblx0LyogVE9ETzogTU9WRSBJTlRPIE1JWElOICovXG5cblx0LyoqIEByZXR1cm4gYm9vbGVhblx0LyovXG5cdGhhc0ZvbGxvd2luZzogZnVuY3Rpb24obW9kZWwpIHtcblx0XHRtb2RlbCB8fCAobW9kZWwgPSB0aGlzLnNlbGVjdGVkKTtcblx0XHRyZXR1cm4gdGhpcy5pbmRleE9mKG1vZGVsKSA8ICh0aGlzLmxlbmd0aCAtIDEpO1xuXHR9LFxuXG5cdC8qKiBAcmV0dXJuIG5leHQgbW9kZWxcdCovXG5cdGZvbGxvd2luZzogZnVuY3Rpb24obW9kZWwpIHtcblx0XHRtb2RlbCB8fCAobW9kZWwgPSB0aGlzLnNlbGVjdGVkKTtcblx0XHRyZXR1cm4gdGhpcy5oYXNGb2xsb3dpbmcobW9kZWwpID8gdGhpcy5hdCh0aGlzLmluZGV4T2YobW9kZWwpICsgMSkgOiBudWxsO1xuXHR9LFxuXG5cdC8qKiBAcmV0dXJuIG5leHQgbW9kZWwgb3IgdGhlIGJlZ2lubmluZyBpZiBhdCB0aGUgZW5kICovXG5cdGZvbGxvd2luZ09yRmlyc3Q6IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0bW9kZWwgfHwgKG1vZGVsID0gdGhpcy5zZWxlY3RlZCk7XG5cdFx0cmV0dXJuIHRoaXMuYXQoKHRoaXMuaW5kZXhPZihtb2RlbCkgKyAxKSAlIHRoaXMubGVuZ3RoKTtcblx0fSxcblxuXHQvKiogQHJldHVybiBib29sZWFuXHQvKi9cblx0aGFzUHJlY2VkaW5nOiBmdW5jdGlvbihtb2RlbCkge1xuXHRcdG1vZGVsIHx8IChtb2RlbCA9IHRoaXMuc2VsZWN0ZWQpO1xuXHRcdHJldHVybiB0aGlzLmluZGV4T2YobW9kZWwpID4gMDtcblx0fSxcblxuXHQvKiogQHJldHVybiB0aGUgcHJldmlvdXMgbW9kZWwgKi9cblx0cHJlY2VkaW5nOiBmdW5jdGlvbihtb2RlbCkge1xuXHRcdG1vZGVsIHx8IChtb2RlbCA9IHRoaXMuc2VsZWN0ZWQpO1xuXHRcdHJldHVybiB0aGlzLmhhc1ByZWNlZGluZyhtb2RlbCkgPyB0aGlzLmF0KHRoaXMuaW5kZXhPZihtb2RlbCkgLSAxKSA6IG51bGw7XG5cdH0sXG5cblx0LyoqIEByZXR1cm4gdGhlIHByZXZpb3VzIG1vZGVsIG9yIHRoZSBlbmQgaWYgYXQgdGhlIGJlZ2lubmluZyAqL1xuXHRwcmVjZWRpbmdPckxhc3Q6IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0bW9kZWwgfHwgKG1vZGVsID0gdGhpcy5zZWxlY3RlZCk7XG5cdFx0dmFyIGluZGV4ID0gdGhpcy5pbmRleE9mKG1vZGVsKSAtIDE7XG5cdFx0cmV0dXJuIHRoaXMuYXQoaW5kZXggPiAtMSA/IGluZGV4IDogdGhpcy5sZW5ndGggLSAxKTtcblx0fSxcblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gU2VsZWN0YWJsZUNvbGxlY3Rpb247XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb25cbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb259ICovXG52YXIgU2VsZWN0YWJsZUNvbGxlY3Rpb24gPSByZXF1aXJlKFwiYXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9uXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9BcnRpY2xlSXRlbX0gKi9cbnZhciBBcnRpY2xlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9BcnRpY2xlSXRlbVwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb259XG4gKi9cbnZhciBBcnRpY2xlQ29sbGVjdGlvbiA9IFNlbGVjdGFibGVDb2xsZWN0aW9uLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtCYWNrYm9uZS5Nb2RlbH0gKi9cblx0bW9kZWw6IEFydGljbGVJdGVtXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBBcnRpY2xlQ29sbGVjdGlvbigpOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9ufSAqL1xudmFyIFNlbGVjdGFibGVDb2xsZWN0aW9uID0gcmVxdWlyZShcImFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvblwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vQnVuZGxlSXRlbX0gKi9cbnZhciBCdW5kbGVJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9pdGVtL0J1bmRsZUl0ZW1cIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb259XG4gKi9cbnZhciBCdW5kbGVDb2xsZWN0aW9uID0gU2VsZWN0YWJsZUNvbGxlY3Rpb24uZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge0JhY2tib25lLk1vZGVsfSAqL1xuXHRtb2RlbDogQnVuZGxlSXRlbSxcblxuXHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHRjb21wYXJhdG9yOiBmdW5jdGlvbihvYSwgb2IpIHtcblx0XHR2YXIgYSA9IG9hLmdldChcImNvbXBsZXRlZFwiKTtcblx0XHR2YXIgYiA9IG9iLmdldChcImNvbXBsZXRlZFwiKTtcblx0XHRpZiAoYSA+IGIpIHtcblx0XHRcdHJldHVybiAtMTtcblx0XHR9IGVsc2UgaWYgKGEgPCBiKSB7XG5cdFx0XHRyZXR1cm4gMTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIDA7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAdHlwZSB7U3RyaW5nfSAqL1xuXHR1cmw6IFwiL2pzb24vYnVuZGxlcy9cIixcblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEJ1bmRsZUNvbGxlY3Rpb24oKTtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvblxuICogQHJlcXVpcmVzIG1vZHVsZTpiYWNrYm9uZVxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvbn0gKi9cbnZhciBTZWxlY3RhYmxlQ29sbGVjdGlvbiA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvU2VsZWN0YWJsZUNvbGxlY3Rpb25cIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL0tleXdvcmRJdGVtfSAqL1xudmFyIEtleXdvcmRJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9pdGVtL0tleXdvcmRJdGVtXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvbn1cbiAqL1xudmFyIEtleXdvcmRDb2xsZWN0aW9uID0gU2VsZWN0YWJsZUNvbGxlY3Rpb24uZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge0JhY2tib25lLk1vZGVsfSAqL1xuXHRtb2RlbDogS2V5d29yZEl0ZW1cblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gbmV3IEtleXdvcmRDb2xsZWN0aW9uKCk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2NvbGxlY3Rpb24vVHlwZUNvbGxlY3Rpb25cbiAqIEByZXF1aXJlcyBtb2R1bGU6YmFja2JvbmVcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vVHlwZUl0ZW19ICovXG52YXIgVHlwZUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL2l0ZW0vVHlwZUl0ZW1cIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9ufVxuICovXG52YXIgVHlwZUNvbGxlY3Rpb24gPSBCYWNrYm9uZS5Db2xsZWN0aW9uLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtCYWNrYm9uZS5Nb2RlbH0gKi9cblx0bW9kZWw6IFR5cGVJdGVtXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IG5ldyBUeXBlQ29sbGVjdGlvbigpO1xuIiwiLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oYm9vdHN0cmFwKSB7XG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cblx0dmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcblxuXHQvLyBHbG9iYWxzLkdBX1RBR1MgPSBib290c3RyYXBbXCJnYS10YWdzXCJdO1xuXHQvLyBHbG9iYWxzLlBBUkFNUyA9IGJvb3RzdHJhcFtcInBhcmFtc1wiXTtcblx0Ly8gR2xvYmFscy5BUFBfUk9PVCA9IGJvb3RzdHJhcFtcInBhcmFtc1wiXVtcInJvb3RcIl07XG5cdC8vIEdsb2JhbHMuTUVESUFfRElSID0gYm9vdHN0cmFwW1wicGFyYW1zXCJdW1widXBsb2Fkc1wiXTtcblx0R2xvYmFscy5BUFBfTkFNRSA9IGJvb3RzdHJhcFtcInBhcmFtc1wiXVtcIndlYnNpdGUtbmFtZVwiXTtcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9UeXBlQ29sbGVjdGlvbn0gKi9cblx0dmFyIHR5cGVMaXN0ID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9uXCIpO1xuXHQvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvbn0gKi9cblx0dmFyIGtleXdvcmRMaXN0ID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9uXCIpO1xuXHQvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9ufSAqL1xuXHR2YXIgYnVuZGxlTGlzdCA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uXCIpO1xuXHQvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9BcnRpY2xlQ29sbGVjdGlvbn0gKi9cblx0dmFyIGFydGljbGVMaXN0ID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9uXCIpO1xuXG5cdC8vIEZpeC11cHMgdG8gYm9vdHN0cmFwIGRhdGEuXG5cdHZhciBhcnRpY2xlcyA9IGJvb3RzdHJhcFtcImFydGljbGVzLWFsbFwiXTtcblx0dmFyIHR5cGVzID0gYm9vdHN0cmFwW1widHlwZXMtYWxsXCJdO1xuXHR2YXIga2V5d29yZHMgPSBib290c3RyYXBbXCJrZXl3b3Jkcy1hbGxcIl07XG5cdHZhciBidW5kbGVzID0gYm9vdHN0cmFwW1wiYnVuZGxlcy1hbGxcIl07XG5cdHZhciBtZWRpYSA9IGJvb3RzdHJhcFtcIm1lZGlhLWFsbFwiXTtcblxuXHQvLyBBdHRhY2ggbWVkaWEgdG8gdGhlaXIgYnVuZGxlc1xuXHR2YXIgbWVkaWFCeUJ1bmRsZSA9IF8uZ3JvdXBCeShtZWRpYSwgXCJiSWRcIik7XG5cblx0Ly8gRmlsbC1pbiBiYWNrLXJlZmVyZW5jZXM6XG5cdC8vIENyZWF0ZSBLZXl3b3JkLmJ1bmRsZUlkcyBmcm9tIGV4aXN0aW5nIEJ1bmRsZS5rZXl3b3JkSWRzLFxuXHQvLyB0aGVuIEJ1bmRsZS50eXBlSWRzIGZyb20gdW5pcXVlIEtleXdvcmQudHlwZUlkXG5cblx0Ly8gXy5lYWNoKGJ1bmRsZXMsIGZ1bmN0aW9uIChibywgYmksIGJhKSB7XG5cdGJ1bmRsZXMuZm9yRWFjaChmdW5jdGlvbihibywgYmksIGJhKSB7XG5cdFx0Ym8udElkcyA9IFtdO1xuXHRcdGJvLm1lZGlhID0gbWVkaWFCeUJ1bmRsZVtiby5pZF07XG5cdFx0Ly8gXy5lYWNoKGtleXdvcmRzLCBmdW5jdGlvbiAoa28sIGtpLCBrYSkge1xuXHRcdGtleXdvcmRzLmZvckVhY2goZnVuY3Rpb24oa28sIGtpLCBrYSkge1xuXHRcdFx0aWYgKGJpID09PSAwKSB7XG5cdFx0XHRcdGtvLmJJZHMgPSBbXTtcblx0XHRcdH1cblx0XHRcdC8vIGlmIChfLmNvbnRhaW5zKGJvLmtJZHMsIGtvLmlkKSkge1xuXHRcdFx0aWYgKGJvLmtJZHMuaW5kZXhPZihrby5pZCkgIT0gLTEpIHtcblx0XHRcdFx0a28uYklkcy5wdXNoKGJvLmlkKTtcblx0XHRcdFx0Ly8gaWYgKCFfLmNvbnRhaW5zKGJvLnRJZHMsIGtvLnRJZCkpIHtcblx0XHRcdFx0aWYgKGJvLnRJZHMuaW5kZXhPZihrby50SWQpID09IC0xKSB7XG5cdFx0XHRcdFx0Ym8udElkcy5wdXNoKGtvLnRJZCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG5cblx0Ly8gRmlsbCBjb2xsZWN0aW9uIHNpbmdsZXRvbnNcblx0YXJ0aWNsZUxpc3QucmVzZXQoYXJ0aWNsZXMpO1xuXHR0eXBlTGlzdC5yZXNldCh0eXBlcyk7XG5cdGtleXdvcmRMaXN0LnJlc2V0KGtleXdvcmRzKTtcblx0YnVuZGxlTGlzdC5yZXNldChidW5kbGVzKTtcblxuXHQvLyBib290c3RyYXBbXCJwYXJhbXNcIl0gPSBib290c3RyYXBbXCJhcnRpY2xlcy1hbGxcIl0gPSBib290c3RyYXBbXCJ0eXBlcy1hbGxcIl0gPSBib290c3RyYXBbXCJrZXl3b3Jkcy1hbGxcIl0gPSBib290c3RyYXBbXCJidW5kbGVzLWFsbFwiXSA9IGJvb3RzdHJhcFtcIm1lZGlhLWFsbFwiXSA9IG51bGw7XG59OyIsIi8qKlxuICogQG1vZHVsZSBhcHAvbW9kZWwvaXRlbS9BcnRpY2xlSXRlbVxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vU291cmNlSXRlbX0gKi9cbnZhciBCYXNlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvQmFzZUl0ZW1cIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL0FydGljbGVJdGVtfVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IEJhc2VJdGVtLmV4dGVuZCh7XG5cblx0X2RvbVByZWZpeDogXCJhXCIsXG5cblx0LyoqIEB0eXBlIHtPYmplY3R9ICovXG5cdGRlZmF1bHRzOiB7XG5cdFx0bmFtZTogXCJcIixcblx0XHRoYW5kbGU6IFwiXCIsXG5cdFx0dGV4dDogXCJcIlxuXHR9LFxuXG59KTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2l0ZW0vQnVuZGxlSXRlbVxuICogQHJlcXVpcmVzIG1vZHVsZTpiYWNrYm9uZVxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtfSAqL1xudmFyIEJhc2VJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9CYXNlSXRlbVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbX0gKi9cbnZhciBNZWRpYUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9ufSAqL1xudmFyIFNlbGVjdGFibGVDb2xsZWN0aW9uID0gcmVxdWlyZShcImFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvblwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdXRpbHMvc3RyaW5ncy9zdHJpcFRhZ3N9ICovXG52YXIgc3RyaXBUYWdzID0gcmVxdWlyZShcInV0aWxzL3N0cmluZ3Mvc3RyaXBUYWdzXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3V0aWxzL3N0cmluZ3MvcGFyc2VUYWdsaXN0fSAqL1xuLy8gdmFyIHBhcnNlU3ltQXR0cnMgPSByZXF1aXJlKFwiYXBwL21vZGVsL3BhcnNlU3ltQXR0cnNcIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9ufSAqL1xuLy8gdmFyIGtleXdvcmRzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0tleXdvcmRDb2xsZWN0aW9uXCIpO1xuXG4vLyBHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wiY29sb3JcIl07XG4vLyBHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wiYmFja2dyb3VuZC1jb2xvclwiXTtcbnZhciBhdHRyc0RlZmF1bHQgPSBfLmRlZmF1bHRzKHtcblx0XCJoYXMtY29sb3JzXCI6IFwiZGVmYXVsdHNcIlxufSwgR2xvYmFscy5ERUZBVUxUX0NPTE9SUyk7XG5cbi8qKiBAcHJpdmF0ZSAqL1xudmFyIE1lZGlhQ29sbGVjdGlvbiA9IFNlbGVjdGFibGVDb2xsZWN0aW9uLmV4dGVuZCh7XG5cdG1vZGVsOiBNZWRpYUl0ZW0sXG5cdGNvbXBhcmF0b3I6IFwib1wiXG59KTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vQnVuZGxlSXRlbX1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBCYXNlSXRlbS5leHRlbmQoe1xuXG5cdF9kb21QcmVmaXg6IFwiYlwiLFxuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fEZ1bmN0aW9ufSAqL1xuXHQvLyBkZWZhdWx0czogZnVuY3Rpb24oKSB7XG5cdC8vIFx0cmV0dXJuIHtcblx0Ly8gXHRcdG5hbWU6IFwiXCIsXG5cdC8vIFx0XHRoYW5kbGU6IFwiXCIsXG5cdC8vIFx0XHRkZXNjOiBcIlwiLFxuXHQvLyBcdFx0Y29tcGxldGVkOiAwLFxuXHQvLyBcdFx0a0lkczogW10sXG5cdC8vIFx0fTtcblx0Ly8gfSxcblx0ZGVmYXVsdHM6IHtcblx0XHRuYW1lOiBcIlwiLFxuXHRcdGhhbmRsZTogXCJcIixcblx0XHRkZXNjOiBcIlwiLFxuXHRcdGNvbXBsZXRlZDogMCxcblx0XHRnZXQga0lkcygpIHtcblx0XHRcdHJldHVybiBbXTtcblx0XHR9LFxuXHRcdC8vIGdldCBrZXl3b3JkcygpIHsgcmV0dXJuIFtdOyB9LFxuXHR9LFxuXG5cdGdldHRlcnM6IFtcIm5hbWVcIiwgXCJtZWRpYVwiXSxcblxuXHRtdXRhdG9yczoge1xuXHRcdHRleHQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHN0cmlwVGFncyh0aGlzLmdldChcImRlc2NcIikpO1xuXHRcdH0sXG5cdFx0Ly8ga0lkczoge1xuXHRcdC8vIFx0c2V0OiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgb3B0aW9ucywgc2V0KSB7XG5cdFx0Ly8gXHRcdGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuXHRcdC8vIFx0XHRcdHNldChcImtleXdvcmRzXCIsIHZhbHVlLm1hcChmdW5jdGlvbihpZCkge1xuXHRcdC8vIFx0XHRcdFx0dmFyIG9iaiA9IGtleXdvcmRzLmdldChpZCk7XG5cdFx0Ly8gXHRcdFx0XHRyZXR1cm4gb2JqO1xuXHRcdC8vIFx0XHRcdH0sIHRoaXMpLCBvcHRpb25zO1xuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHRcdHNldChrZXksIHZhbHVlLCBvcHRpb25zKTtcblx0XHQvLyBcdH0sXG5cdFx0Ly8gfSxcblx0XHRtZWRpYToge1xuXHRcdFx0dHJhbnNpZW50OiB0cnVlLFxuXHRcdFx0c2V0OiBmdW5jdGlvbihrZXksIHZhbHVlLCBvcHRpb25zLCBzZXQpIHtcblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG5cdFx0XHRcdFx0dmFsdWUuZm9yRWFjaChmdW5jdGlvbihvKSB7XG5cdFx0XHRcdFx0XHRvLmJ1bmRsZSA9IHRoaXM7XG5cdFx0XHRcdFx0fSwgdGhpcyk7XG5cdFx0XHRcdFx0dmFsdWUgPSBuZXcgTWVkaWFDb2xsZWN0aW9uKHZhbHVlKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRzZXQoa2V5LCB2YWx1ZSwgb3B0aW9ucyk7XG5cdFx0XHR9LFxuXHRcdH0sXG5cdH0sXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cnMsIG9wdGlvbnMpIHtcblx0XHR0aGlzLmNvbG9ycyA9IHtcblx0XHRcdGZnQ29sb3I6IG5ldyBDb2xvcih0aGlzLmF0dHIoXCJjb2xvclwiKSksXG5cdFx0XHRiZ0NvbG9yOiBuZXcgQ29sb3IodGhpcy5hdHRyKFwiYmFja2dyb3VuZC1jb2xvclwiKSksXG5cdFx0XHRsbkNvbG9yOiBuZXcgQ29sb3IodGhpcy5hdHRyKFwiLS1saW5rLWNvbG9yXCIpKSxcblx0XHR9O1xuXHRcdHRoaXMuY29sb3JzLmhhc0RhcmtCZyA9IHRoaXMuY29sb3JzLmZnQ29sb3IubHVtaW5vc2l0eSgpID4gdGhpcy5jb2xvcnMuYmdDb2xvci5sdW1pbm9zaXR5KCk7XG5cdH0sXG5cblx0YXR0cnM6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLl9hdHRycyB8fCAodGhpcy5fYXR0cnMgPSBfLmRlZmF1bHRzKHt9LCB0aGlzLmdldChcImF0dHJzXCIpLCBhdHRyc0RlZmF1bHQpKTtcblx0fSxcbn0pO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9pdGVtL0tleXdvcmRJdGVtXG4gKiBAcmVxdWlyZXMgbW9kdWxlOmFwcC9tb2RlbC9CYXNlSXRlbVxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9CYXNlSXRlbX0gKi9cbnZhciBCYXNlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvQmFzZUl0ZW1cIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9ufSAqL1xuLy8gdmFyIHR5cGVzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL1R5cGVDb2xsZWN0aW9uXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9LZXl3b3JkSXRlbX1cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBCYXNlSXRlbS5leHRlbmQoe1xuXG5cdF9kb21QcmVmaXg6IFwia1wiLFxuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdG5hbWU6IFwiXCIsXG5cdFx0aGFuZGxlOiBcIlwiLFxuXHRcdHRJZDogLTEsXG5cdH0sXG5cblx0Ly8gbXV0YXRvcnM6IHtcblx0Ly8gXHR0SWQ6IHtcblx0Ly8gXHRcdHNldDogZnVuY3Rpb24gKGtleSwgdmFsdWUsIG9wdGlvbnMsIHNldCkge1xuXHQvLyBcdFx0XHR2YXIgdHlwZSA9IHR5cGVzLmdldCh2YWx1ZSk7XG5cdC8vIFx0XHRcdGlmICh0eXBlKSB7XG5cdC8vIFx0XHRcdFx0dHlwZS5nZXQoXCJrZXl3b3Jkc1wiKS5wdXNoKHRoaXMpO1xuXHQvLyBcdFx0XHRcdHNldChcInR5cGVcIiwgdHlwZSwgb3B0aW9ucyk7XG5cdC8vIFx0XHRcdH1cblx0Ly8gXHRcdFx0c2V0KGtleSwgdmFsdWUsIG9wdGlvbnMpO1xuXHQvLyBcdFx0fVxuXHQvLyBcdH0sXG5cdC8vIH1cbn0pO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbVxuICogQHJlcXVpcmVzIG1vZHVsZTpiYWNrYm9uZVxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtfSAqL1xudmFyIEJhc2VJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9CYXNlSXRlbVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL1NvdXJjZUl0ZW19ICovXG52YXIgU291cmNlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9ufSAqL1xudmFyIFNlbGVjdGFibGVDb2xsZWN0aW9uID0gcmVxdWlyZShcImFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvblwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdXRpbHMvc3RyaW5ncy9zdHJpcFRhZ3N9ICovXG52YXIgc3RyaXBUYWdzID0gcmVxdWlyZShcInV0aWxzL3N0cmluZ3Mvc3RyaXBUYWdzXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL3BhcnNlU3ltQXR0cnN9ICovXG4vLyB2YXIgcGFyc2VTeW1BdHRycyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvcGFyc2VTeW1BdHRyc1wiKTtcblxuLy8gY29uc29sZS5sb2coR2xvYmFscy5QQVJBTVMpO1xuXG52YXIgdXJsVGVtcGxhdGVzID0ge1xuXHRcIm9yaWdpbmFsXCI6IF8udGVtcGxhdGUoR2xvYmFscy5NRURJQV9ESVIgKyBcIi88JT0gc3JjICU+XCIpLFxuXHRcImNvbnN0cmFpbi13aWR0aFwiOiBfLnRlbXBsYXRlKEdsb2JhbHMuQVBQX1JPT1QgKyBcImltYWdlLzEvPCU9IHdpZHRoICU+LzAvdXBsb2Fkcy88JT0gc3JjICU+XCIpLFxuXHRcImNvbnN0cmFpbi1oZWlnaHRcIjogXy50ZW1wbGF0ZShHbG9iYWxzLkFQUF9ST09UICsgXCJpbWFnZS8xLzAvPCU9IGhlaWdodCAlPi91cGxvYWRzLzwlPSBzcmMgJT5cIiksXG5cdFwiZGVidWctYmFuZHdpZHRoXCI6IF8udGVtcGxhdGUoR2xvYmFscy5NRURJQV9ESVIucmVwbGFjZSgvKGh0dHBzP1xcOlxcL1xcL1teXFwvXSspLywgXCIkMS9zbG93LzwlPSBrYnBzICU+XCIpICsgXCIvPCU9IHNyYyAlPlwiKSxcbn07XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbS5Tb3VyY2VDb2xsZWN0aW9ufVxuICovXG52YXIgU291cmNlQ29sbGVjdGlvbiA9IFNlbGVjdGFibGVDb2xsZWN0aW9uLmV4dGVuZCh7XG5cdG1vZGVsOiBTb3VyY2VJdGVtXG59KTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtfVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IEJhc2VJdGVtLmV4dGVuZCh7XG5cblx0X2RvbVByZWZpeDogXCJtXCIsXG5cblx0LyoqIEB0eXBlIHtPYmplY3R9ICovXG5cdGRlZmF1bHRzOiB7XG5cdFx0bmFtZTogXCI8cD48ZW0+VW50aXRsZWQ8L2VtPjwvcD5cIixcblx0XHRzdWI6IFwiXCIsXG5cdFx0bzogMCxcblx0XHRiSWQ6IC0xLFxuXHRcdHNyY0lkeDogMCxcblx0XHRnZXQgc3Jjc2V0KCkge1xuXHRcdFx0cmV0dXJuIFtdO1xuXHRcdH0sXG5cdFx0Z2V0IHNvdXJjZXMoKSB7XG5cdFx0XHRyZXR1cm4gbmV3IFNvdXJjZUNvbGxlY3Rpb24oKTtcblx0XHR9LFxuXHR9LFxuXG5cdGdldHRlcnM6IFtcIm5hbWVcIiwgXCJidW5kbGVcIiwgXCJzb3VyY2VcIiwgXCJzb3VyY2VzXCJdLFxuXG5cdG11dGF0b3JzOiB7XG5cdFx0Ly8gZGVzYzogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gXHRyZXR1cm4gdGhpcy5nZXQoXCJuYW1lXCIpO1xuXHRcdC8vIH0sXG5cdFx0aGFuZGxlOiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLmdldChcInNyY1wiKTtcblx0XHR9LFxuXHRcdHRleHQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCF0aGlzLmhhc093blByb3BlcnR5KFwiX3RleHRcIikpXG5cdFx0XHRcdHRoaXMuX3RleHQgPSBfLnVuZXNjYXBlKHN0cmlwVGFncyh0aGlzLmdldChcIm5hbWVcIikpKTtcblx0XHRcdHJldHVybiB0aGlzLl90ZXh0O1xuXHRcdH0sXG5cdFx0YXR0cnM6IHtcblx0XHRcdHNldDogZnVuY3Rpb24oa2V5LCB2YWx1ZSwgb3B0cywgc2V0KSB7XG5cdFx0XHRcdHRoaXMuX2F0dHJzID0gbnVsbDtcblx0XHRcdFx0QmFzZUl0ZW0ucHJvdG90eXBlLm11dGF0b3JzLmF0dHJzLnNldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR0aGlzLl91cGRhdGVTb3VyY2VzKCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRzcmNzZXQ6IHtcblx0XHRcdHNldDogZnVuY3Rpb24oa2V5LCB2YWx1ZSwgb3B0cywgc2V0KSB7XG5cdFx0XHRcdHNldChrZXksIHZhbHVlLCBvcHRzKTtcblx0XHRcdFx0dGhpcy5nZXQoXCJzb3VyY2VzXCIpLnJlc2V0KHZhbHVlLCBvcHRzKTtcblx0XHRcdFx0dGhpcy5fdXBkYXRlU291cmNlcygpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0c291cmNlOiB7XG5cdFx0XHR0cmFuc2llbnQ6IHRydWUsXG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5nZXQoXCJzb3VyY2VzXCIpLmF0KHRoaXMuZ2V0KFwic3JjSWR4XCIpKTtcblx0XHRcdH0sXG5cdFx0fSxcblx0fSxcblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl91cGRhdGVDb2xvcnMoKTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwiY2hhbmdlOmF0dHJzIGNoYW5nZTpidW5kbGVcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLl9hdHRycyA9IG51bGw7XG5cdFx0fSk7XG5cdH0sXG5cblx0YXR0cnM6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLl9hdHRycyB8fCAodGhpcy5fYXR0cnMgPSBfLmRlZmF1bHRzKHt9LCB0aGlzLmdldChcImJ1bmRsZVwiKS5hdHRycygpLCB0aGlzLmdldChcImF0dHJzXCIpKSk7XG5cdH0sXG5cblx0X3VwZGF0ZUNvbG9yczogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5jb2xvcnMgPSB7XG5cdFx0XHRmZ0NvbG9yOiBuZXcgQ29sb3IodGhpcy5hdHRyKFwiY29sb3JcIikpLFxuXHRcdFx0YmdDb2xvcjogbmV3IENvbG9yKHRoaXMuYXR0cihcImJhY2tncm91bmQtY29sb3JcIikpXG5cdFx0fTtcblx0XHR0aGlzLmNvbG9ycy5oYXNEYXJrQmcgPSB0aGlzLmNvbG9ycy5mZ0NvbG9yLmx1bWlub3NpdHkoKSA+IHRoaXMuY29sb3JzLmJnQ29sb3IubHVtaW5vc2l0eSgpO1xuXHR9LFxuXG5cdF91cGRhdGVTb3VyY2VzOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgc3JjT2JqID0ge1xuXHRcdFx0a2JwczogdGhpcy5hdHRyKFwiQGRlYnVnLWJhbmR3aWR0aFwiKVxuXHRcdH07XG5cdFx0dmFyIHNyY1RwbCA9IHVybFRlbXBsYXRlc1tzcmNPYmoua2JwcyA/IFwiZGVidWctYmFuZHdpZHRoXCIgOiBcIm9yaWdpbmFsXCJdO1xuXHRcdHRoaXMuZ2V0KFwic291cmNlc1wiKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdHNyY09iai5zcmMgPSBpdGVtLmdldChcInNyY1wiKTtcblx0XHRcdGl0ZW0uc2V0KFwib3JpZ2luYWxcIiwgc3JjVHBsKHNyY09iaikpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8vIF91cGRhdGVTb3VyY2VzQXJyOiBmdW5jdGlvbigpIHtcblx0Ly8gXHR2YXIgc3Jjc2V0ID0gdGhpcy5nZXQoXCJzcmNzZXRcIik7XG5cdC8vIFx0aWYgKEFycmF5LmlzQXJyYXkoc3Jjc2V0KSkge1xuXHQvLyBcdFx0dmFyIHNyY09iaiA9IHsga2JwczogdGhpcy5hdHRyKFwiQGRlYnVnLWJhbmR3aWR0aFwiKSB9O1xuXHQvLyBcdFx0dmFyIHNyY1RwbCA9IEdsb2JhbHMuTUVESUFfU1JDX1RQTFtzcmNPYmoua2Jwcz8gXCJkZWJ1Zy1iYW5kd2lkdGhcIiA6IFwib3JpZ2luYWxcIl07XG5cdC8vIFx0XHRzcmNzZXQuZm9yRWFjaChmdW5jdGlvbihvKSB7XG5cdC8vIFx0XHRcdHNyY09iai5zcmMgPSBvLnNyYztcblx0Ly8gXHRcdFx0by5vcmlnaW5hbCA9IHNyY1RwbChzcmNPYmopO1xuXHQvLyBcdFx0fSwgdGhpcyk7XG5cdC8vIFx0fVxuXHQvLyBcdHRoaXMuZ2V0KFwic291cmNlc1wiKS5yZXNldChzcmNzZXQpO1xuXHQvLyB9LFxuXG59KTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL21vZGVsL2l0ZW0vU291cmNlSXRlbVxuICogQHJlcXVpcmVzIG1vZHVsZTpiYWNrYm9uZVxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbi8vIHZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtfSAqL1xudmFyIEJhc2VJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9CYXNlSXRlbVwiKTtcblxuLyoqIEB0eXBlIHtTdHJpbmd9ICovXG52YXIgbm9DYWNoZVN1ZmZpeCA9IFwiP1wiICsgRGF0ZS5ub3coKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vU291cmNlSXRlbX1cbiAqL1xuLy8gbW9kdWxlLmV4cG9ydHMgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xubW9kdWxlLmV4cG9ydHMgPSBCYXNlSXRlbS5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdHNyYzogbnVsbCxcblx0XHRtaW1lOiBudWxsLFxuXHRcdHc6IG51bGwsXG5cdFx0aDogbnVsbCxcblx0fSxcblxuXHRnZXR0ZXJzOiBbXCJzcmNcIiwgXCJvcmlnaW5hbFwiXSxcblxuXHRtdXRhdG9yczoge1xuXHRcdHNyYzoge1xuXHRcdFx0c2V0OiBmdW5jdGlvbihrZXksIHZhbHVlLCBvcHRpb25zLCBzZXQpIHtcblx0XHRcdFx0aWYgKERFQlVHKSB7XG5cdFx0XHRcdFx0dmFsdWUgKz0gbm9DYWNoZVN1ZmZpeDtcblx0XHRcdFx0fVxuXHRcdFx0XHRzZXQoa2V5LCB2YWx1ZSwgb3B0aW9ucyk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHQvLyBvcmlnaW5hbDogeyBcblx0XHQvLyBcdHRyYW5zaWVudDogdHJ1ZSxcblx0XHQvLyBcdGdldDogZnVuY3Rpb24gKGtleSwgdmFsdWUsIG9wdGlvbnMsIHNldCkge1xuXHRcdC8vIFx0XHRyZXR1cm4gdGhpcy5hdHRyaWJ1dGVzLm9yaWdpbmFsIHx8ICh0aGlzLmF0dHJpYnV0ZXMub3JpZ2luYWwgPSB0aGlzLl9jb21wb3NlT3JpZ2luYWxTcmMoKSk7XG5cdFx0Ly8gXHR9LFxuXHRcdC8vIH0sXG5cdFx0Ly8gbWVkaWE6IHtcblx0XHQvLyBcdHRyYW5zaWVudDogdHJ1ZSxcblx0XHQvLyBcdGdldDogZnVuY3Rpb24gKCkge1xuXHRcdC8vIFx0XHR2YXIgcmV0dmFsO1xuXHRcdC8vIFx0XHRpZiAodGhpcy5fbm9SZWN1c2lvbikge1xuXHRcdC8vIFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Om1lZGlhIHJldHVybmluZyBudWxsXCIsIHRoaXMuY2lkKTtcblx0XHQvLyBcdFx0XHRyZXR2YWwgPSBudWxsOy8vdGhpcy5pZDtcblx0XHQvLyBcdFx0fSBlbHNlIHtcblx0XHQvLyBcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjptZWRpYSByZXR1cm5pbmcgT2JqZWN0XCIsIHRoaXMuY2lkKTtcblx0XHQvLyBcdFx0XHR0aGlzLl9ub1JlY3VzaW9uID0gdHJ1ZTtcblx0XHQvLyBcdFx0XHRyZXR2YWwgPSB0aGlzLmF0dHJpYnV0ZXMubWVkaWE7XG5cdFx0Ly8gXHRcdFx0dGhpcy5fbm9SZWN1c2lvbiA9IGZhbHNlO1xuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHRcdHJldHVybiByZXR2YWw7XG5cdFx0Ly8gXHR9LFxuXHRcdC8vIFx0c2V0OiBmdW5jdGlvbiAoa2V5LCB2YWx1ZSwgb3B0aW9ucywgc2V0KSB7XG5cdFx0Ly8gXHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIEJhc2VJdGVtKSB7XG5cdFx0Ly8gXHRcdFx0c2V0KGtleSwgdmFsdWUsIG9wdGlvbnMpO1xuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHR9LFxuXHRcdC8vIH0sXG5cdH0sXG5cblx0Ly8gaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdC8vIFx0aWYgKERFQlVHKSB7XG5cdC8vIFx0XHR2YXIgY2IgPSBmdW5jdGlvbigpIHtcblx0Ly8gXHRcdFx0Ly8gY29uc29sZS5sb2coXCJAZGVidWctYmFuZHdpZHRoOlwiLCBKU09OLnN0cmluZ2lmeSh0aGlzLmdldChcIm1lZGlhXCIpLmF0dHIoXCJAZGVidWctYmFuZHdpZHRoXCIpKSk7XG5cdC8vIFx0XHRcdGNvbnNvbGUubG9nKFwibWVkaWE6XCIsIEpTT04uc3RyaW5naWZ5KHRoaXMudG9KU09OKCkpKTtcblx0Ly8gXHRcdFx0Ly8gaWYgKCh0aGlzLmdldChcIm1lZGlhXCIpIGluc3RhbmNlb2YgQmFzZUl0ZW0pICYmIHRoaXMuZ2V0KFwibWVkaWFcIikuYXR0cihcIkBkZWJ1Zy1iYW5kd2lkdGhcIikpIHtcblx0Ly8gXHRcdFx0Ly8gXHRjb25zb2xlLmxvZyhcIm9yaWdpbmFsXCIsIHRoaXMuZ2V0KFwib3JpZ2luYWxcIikpO1xuXHQvLyBcdFx0XHQvLyBcdGNvbnNvbGUubG9nKFwibWVkaWE6XCIsIEpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0KFwibWVkaWFcIikudG9KU09OKCkpKTtcblx0Ly8gXHRcdFx0Ly8gfVxuXHQvLyBcdFx0fS5iaW5kKHRoaXMpO1xuXHQvLyBcdFx0d2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShjYik7XG5cdC8vIFx0fVxuXHQvLyB9LFxuXHQvLyBcblx0Ly8gX2NvbXBvc2VPcmlnaW5hbFNyYzogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dmFyIHZhbHVlcyA9IHsgc3JjOiB0aGlzLmdldChcInNyY1wiKSB9O1xuXHQvLyBcdGlmICh0aGlzLmhhcyhcIm1lZGlhXCIpICYmICh2YWx1ZXMua2JwcyA9IHRoaXMuZ2V0KFwibWVkaWFcIikuYXR0cihcIkBkZWJ1Zy1iYW5kd2lkdGhcIikpKSB7XG5cdC8vIFx0Ly8gaWYgKHRoaXMuaGFzKFwibWVkaWFcIikgJiYgdGhpcy5nZXQoXCJtZWRpYVwiKS5hdHRycygpLmhhc093blByb3BlcnR5KFwiQGRlYnVnLWJhbmR3aWR0aFwiKSkge1xuXHQvLyBcdC8vIFx0dmFsdWVzLmticHMgPSB0aGlzLmdldChcIm1lZGlhXCIpLmF0dHJzKClbXCJAZGVidWctYmFuZHdpZHRoXCJdO1xuXHQvLyBcdFx0cmV0dXJuIEdsb2JhbHMuTUVESUFfU1JDX1RQTFtcImRlYnVnLWJhbmR3aWR0aFwiXSh2YWx1ZXMpO1xuXHQvLyBcdH1cblx0Ly8gXHRyZXR1cm4gR2xvYmFscy5NRURJQV9TUkNfVFBMW1wib3JpZ2luYWxcIl0odmFsdWVzKTtcblx0Ly8gfSxcbn0pO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC9tb2RlbC9pdGVtL1R5cGVJdGVtXG4gKi9cblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9Tb3VyY2VJdGVtfSAqL1xudmFyIEJhc2VJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9CYXNlSXRlbVwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2l0ZW0vVHlwZUl0ZW19XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gQmFzZUl0ZW0uZXh0ZW5kKHtcblxuXHRfZG9tUHJlZml4OiBcInRcIixcblxuXHQvKiogQHR5cGUge09iamVjdH0gKi9cblx0ZGVmYXVsdHM6IHtcblx0XHRuYW1lOiBcIlwiLFxuXHRcdGhhbmRsZTogXCJcIixcblx0XHQvLyBnZXQga0lkcygpIHsgcmV0dXJuIFtdOyB9LFxuXHRcdC8vIGdldCBrZXl3b3JkcygpIHsgcmV0dXJuIFtdOyB9LFxuXHR9LFxuXG59KTtcbiIsIi8qKlxuLyogQG1vZHVsZSBhcHAvdmlldy9BcHBWaWV3XG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8vIC8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG4vLyB2YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC91dGlscy9kZWJ1Zy90cmFjZUFyZ3N9ICovXG52YXIgc3RyaXBUYWdzID0gcmVxdWlyZShcInV0aWxzL3N0cmluZ3Mvc3RyaXBUYWdzXCIpO1xuLy8gLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbi8vIHZhciBwcmVmaXhlZFByb3BlcnR5ID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkUHJvcGVydHlcIik7XG4vLyAvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuLy8gdmFyIHByZWZpeGVkRXZlbnQgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRFdmVudFwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1RvdWNoTWFuYWdlcn0gKi9cbnZhciBUb3VjaE1hbmFnZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9Db250cm9sbGVyfSAqL1xudmFyIGNvbnRyb2xsZXIgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvQ29udHJvbGxlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9BcHBTdGF0ZX0gKi9cbnZhciBBcHBTdGF0ZSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvQXBwU3RhdGVcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9ufSAqL1xudmFyIGJ1bmRsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvblwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9ufSAqL1xudmFyIGFydGljbGVzID0gcmVxdWlyZShcImFwcC9tb2RlbC9jb2xsZWN0aW9uL0FydGljbGVDb2xsZWN0aW9uXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9OYXZpZ2F0aW9uVmlld30gKi9cbnZhciBOYXZpZ2F0aW9uVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9OYXZpZ2F0aW9uVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L0NvbnRlbnRWaWV3fSAqL1xudmFyIENvbnRlbnRWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L0NvbnRlbnRWaWV3XCIpO1xuXG52YXIgQXBwVmlldyA9IHtcblx0Z2V0SW5zdGFuY2U6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICghKHdpbmRvdy5hcHAgaW5zdGFuY2VvZiB0aGlzKSkge1xuXHRcdFx0d2luZG93LmFwcCA9IG5ldyh0aGlzKSh7XG5cdFx0XHRcdG1vZGVsOiBuZXcgQXBwU3RhdGUoKVxuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdHJldHVybiB3aW5kb3cuYXBwO1xuXHR9XG59O1xuXG52YXIgQXBwVmlld1Byb3RvID0ge1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2lkUHJlZml4OiBcImFwcFwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGVsOiBcImh0bWxcIixcblx0Ly8gLyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwiYXBwIHdpdGhvdXQtYnVuZGxlIHdpdGhvdXQtbWVkaWEgd2l0aG91dC1hcnRpY2xlXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0bW9kZWw6IEFwcFN0YXRlLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0ZXZlbnRzOiB7XG5cdFx0XCJ2aXNpYmlsaXR5Y2hhbmdlXCI6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRjb25zb2xlLmxvZyhldi50eXBlKTtcblx0XHR9LFxuXHRcdFwiZnVsbHNjcmVlbmNoYW5nZVwiOiBmdW5jdGlvbihldikge1xuXHRcdFx0Y29uc29sZS5sb2coZXYudHlwZSk7XG5cdFx0fSxcblx0XHQvLyBcInNjcm9sbCAjY29udGFpbmVyXCI6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhldi50eXBlLCBldik7XG5cdFx0Ly8gfVxuXHR9LFxuXG5cdHByb3BlcnRpZXM6IHtcblx0XHRjb250YWluZXI6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9jb250YWluZXIgfHwgKHRoaXMuX2NvbnRhaW5lciA9XG5cdFx0XHRcdFx0Ly8gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250YWluZXJcIilcblx0XHRcdFx0XHRkb2N1bWVudC5ib2R5XG5cdFx0XHRcdCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdC8qIGNyZWF0ZSBzaW5nbGUgaGFtbWVyanMgbWFuYWdlciAqL1xuXHRcdHRoaXMudG91Y2ggPSBUb3VjaE1hbmFnZXIuaW5pdCh0aGlzLmNvbnRhaW5lcik7XG5cdFx0dGhpcy50b3VjaC5zZXQoe1xuXHRcdFx0ZW5hYmxlOiAoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLmVsLnNjcm9sbEhlaWdodCA9PSB0aGlzLmVsLmNsaWVudEhlaWdodDtcblx0XHRcdFx0Ly8gcmV0dXJuIHRoaXMuZWwuc2Nyb2xsVG9wID09PSAwO1xuXHRcdFx0XHQvLyByZXR1cm4gdGhpcy5jb250YWluZXIuc2Nyb2xsVG9wID09PSAwO1xuXHRcdFx0XHQvLyByZXR1cm4gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikgJiYgdGhpcy5tb2RlbC5nZXQoXCJ3aXRoQnVuZGxlXCIpO1xuXHRcdFx0fSkuYmluZCh0aGlzKVxuXHRcdH0pO1xuXG5cdFx0Ly8gdGhpcy5fYWZ0ZXJSZW5kZXIgPSB0aGlzLl9hZnRlclJlbmRlci5iaW5kKHRoaXMpO1xuXHRcdHRoaXMuX29uUmVzaXplID0gdGhpcy5fb25SZXNpemUuYmluZCh0aGlzKTtcblxuXHRcdC8qIHJlbmRlciBvbiByZXNpemUsIG9ub3JpZW50YXRpb25jaGFuZ2UsIHZpc2liaWxpdHljaGFuZ2UgKi9cblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9yaWVudGF0aW9uY2hhbmdlXCIsIHRoaXMuX29uUmVzaXplLCBmYWxzZSk7XG5cdFx0d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgXy5kZWJvdW5jZSh0aGlzLl9vblJlc2l6ZSwgMTAwLCBmYWxzZSAvKiBpbW1lZGlhdGU/ICovICksIGZhbHNlKTtcblxuXHRcdC8vIHZhciBoID0gZnVuY3Rpb24oZXYpIHsgY29uc29sZS5sb2coZXYudHlwZSwgZXYpIH07XG5cdFx0Ly8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgaCwgZmFsc2UpO1xuXHRcdC8vIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwid2hlZWxcIiwgaCwgZmFsc2UpO1xuXG5cdFx0LyogVE9ETzogcmVwbGFjZSByZXNpemUgdy8gbWVkaWFxdWVyeSBsaXN0ZW5lcnMuIENhdmVhdDogc29tZSBjb21wb25lbnRzXG5cdFx0KHZnLiBDYXJvdXNlbCkgcmVxdWlyZSB1cGRhdGUgb24gcmVzaXplICovXG5cdFx0Ly8gdGhpcy5fb25CcmVha3BvaW50Q2hhbmdlID0gdGhpcy5fb25CcmVha3BvaW50Q2hhbmdlLmJpbmQodGhpcyk7XG5cdFx0Ly8gT2JqZWN0LmtleXMoR2xvYmFscy5CUkVBS1BPSU5UUykuZm9yRWFjaChmdW5jdGlvbihzKSB7XG5cdFx0Ly8gXHRHbG9iYWxzLkJSRUFLUE9JTlRTW3NdLmFkZExpc3RlbmVyKHRoaXMuX29uQnJlYWtwb2ludENoYW5nZSk7XG5cdFx0Ly8gfSwgdGhpcyk7XG5cblx0XHQvKiBpbml0aWFsaXplIGNvbnRyb2xsZXIvbW9kZWwgbGlzdGVuZXJzIEJFRk9SRSB2aWV3cyByZWdpc3RlciB0aGVpciBvd24gKi9cblx0XHR0aGlzLmxpc3RlblRvKGNvbnRyb2xsZXIsIFwicm91dGVcIiwgdGhpcy5fb25Sb3V0ZSk7XG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyhjb250cm9sbGVyLCBcImNoYW5nZTphZnRlclwiLCB0aGlzLl9hZnRlckNvbnRyb2xsZXJDaGFuZ2VkKTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlXCIsIHRoaXMuX29uTW9kZWxDaGFuZ2UpOyAvKiBGSVhNRSAqL1xuXG5cdFx0LyogaW5pdGlhbGl6ZSB2aWV3cyAqL1xuXHRcdHRoaXMubmF2aWdhdGlvblZpZXcgPSBuZXcgTmF2aWdhdGlvblZpZXcoe1xuXHRcdFx0ZWw6IFwiI25hdmlnYXRpb25cIixcblx0XHRcdG1vZGVsOiB0aGlzLm1vZGVsXG5cdFx0fSk7XG5cdFx0dGhpcy5jb250ZW50VmlldyA9IG5ldyBDb250ZW50Vmlldyh7XG5cdFx0XHRlbDogXCIjY29udGVudFwiLFxuXHRcdFx0bW9kZWw6IHRoaXMubW9kZWxcblx0XHR9KTtcblxuXHRcdC8qIEdvb2dsZSBBbmFseXRpY3MgKi9cblx0XHRpZiAod2luZG93LmdhICYmIHdpbmRvdy5HQV9JRCkge1xuXHRcdFx0Y29udHJvbGxlclxuXHRcdFx0XHQub25jZShcInJvdXRlXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHdpbmRvdy5nYShcImNyZWF0ZVwiLCB3aW5kb3cuR0FfSUQsIFwiYXV0b1wiKTtcblx0XHRcdFx0XHQvLyBpZiBsb2NhbGhvc3Qgb3IgZHVtbXkgSUQsIGRpc2FibGUgYW5hbHl0aWNzXG5cdFx0XHRcdFx0aWYgKC8oPzoobG9jYWxob3N0fFxcLmxvY2FsKSkkLy50ZXN0KGxvY2F0aW9uLmhvc3RuYW1lKVxuXHRcdFx0XHRcdFx0fHwgd2luZG93LkdBX0lEID09IFwiVUEtMDAwMDAwMC0wXCIpIHtcblx0XHRcdFx0XHRcdHdpbmRvdy5nYShcInNldFwiLCBcInNlbmRIaXRUYXNrXCIsIG51bGwpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSlcblx0XHRcdFx0Lm9uKFwicm91dGVcIiwgZnVuY3Rpb24obmFtZSkge1xuXHRcdFx0XHRcdHZhciBwYWdlID0gQmFja2JvbmUuaGlzdG9yeS5nZXRGcmFnbWVudCgpO1xuXHRcdFx0XHRcdC8vIEFkZCBhIHNsYXNoIGlmIG5lY2Nlc2FyeVxuXHRcdFx0XHRcdHBhZ2UucmVwbGFjZSgvXig/IVxcLykvLCBcIi9cIik7XG5cdFx0XHRcdFx0d2luZG93LmdhKFwic2V0XCIsIFwicGFnZVwiLCBwYWdlKTtcblx0XHRcdFx0XHR3aW5kb3cuZ2EoXCJzZW5kXCIsIFwicGFnZXZpZXdcIik7XG5cdFx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdC8qIFN0YXJ0dXAgbGlzdGVuZXIsIGFkZGVkIGxhc3QgKi9cblx0XHR0aGlzLmxpc3RlblRvT25jZShjb250cm9sbGVyLCBcInJvdXRlXCIsIHRoaXMuX2FwcFN0YXJ0KTtcblxuXHRcdC8qIHN0YXJ0IHJvdXRlciwgd2hpY2ggd2lsbCByZXF1ZXN0IGFwcHJvcGlhdGUgc3RhdGUgKi9cblx0XHRCYWNrYm9uZS5oaXN0b3J5LnN0YXJ0KHtcblx0XHRcdHB1c2hTdGF0ZTogZmFsc2UsXG5cdFx0XHRoYXNoQ2hhbmdlOiB0cnVlLFxuXHRcdH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogX2FwcFN0YXJ0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfYXBwU3RhcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUuaW5mbyhcIiVzOjpfYXBwU3RhcnRcIiwgdGhpcy5jaWQsIGFyZ3VtZW50c1swXSk7XG5cdFx0dGhpcy5fYXBwU3RhcnRDaGFuZ2VkID0gdHJ1ZTtcblx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5NT0RFTF9JTlZBTElEIHwgVmlldy5TSVpFX0lOVkFMSUQpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIG1vZGVsIGNoYW5nZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uUm91dGU6IGZ1bmN0aW9uKG5hbWUsIGFyZ3MpIHtcblx0XHR2YXIgbyA9IF8uZGVmYXVsdHMoeyByb3V0ZU5hbWU6IG5hbWUgfSwgQXBwU3RhdGUucHJvdG90eXBlLmRlZmF1bHRzKTtcblx0XHRzd2l0Y2ggKG5hbWUpIHtcblx0XHRcdGNhc2UgXCJtZWRpYS1pdGVtXCI6XG5cdFx0XHRcdG8uYnVuZGxlID0gYnVuZGxlcy5zZWxlY3RlZDtcblx0XHRcdFx0by53aXRoQnVuZGxlID0gdHJ1ZTtcblx0XHRcdFx0by5tZWRpYSA9IG8uYnVuZGxlLm1lZGlhLnNlbGVjdGVkO1xuXHRcdFx0XHRvLndpdGhNZWRpYSA9IHRydWU7XG5cdFx0XHRcdG8uY29sbGFwc2VkID0gdHJ1ZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiYnVuZGxlLWl0ZW1cIjpcblx0XHRcdFx0by5idW5kbGUgPSBidW5kbGVzLnNlbGVjdGVkO1xuXHRcdFx0XHRvLndpdGhCdW5kbGUgPSB0cnVlO1xuXHRcdFx0XHRvLmNvbGxhcHNlZCA9IHRydWU7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcImFydGljbGUtaXRlbVwiOlxuXHRcdFx0XHRvLmFydGljbGUgPSBhcnRpY2xlcy5zZWxlY3RlZDtcblx0XHRcdFx0by53aXRoQXJ0aWNsZSA9IHRydWU7XG5cdFx0XHRcdG8uY29sbGFwc2VkID0gdHJ1ZTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiYnVuZGxlLWxpc3RcIjpcblx0XHRcdGNhc2UgXCJub3Rmb3VuZFwiOlxuXHRcdFx0Y2FzZSBcInJvb3RcIjpcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdG8uY29sbGFwc2VkID0gZmFsc2U7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHRjb25zb2xlLmluZm8oXCIlczo6X29uUm91dGUgJW8gLT4gJW9cIiwgdGhpcy5jaWQsIHRoaXMubW9kZWwuZ2V0KFwicm91dGVOYW1lXCIpLCBuYW1lKTtcblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpfb25Sb3V0ZSBhcmdzOiAlb1wiLCB0aGlzLmNpZCwgbmFtZSwgYXJncyk7XG5cdFx0dGhpcy5tb2RlbC5zZXQobyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogbW9kZWwgY2hhbmdlZFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25Nb2RlbENoYW5nZTogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6X29uTW9kZWxDaGFuZ2UgW1NUQVJUXVwiLCB0aGlzLmNpZCk7XG5cdFx0Y29uc29sZS5ncm91cCh0aGlzLmNpZCArIFwiOjpfb25Nb2RlbENoYW5nZSBbcmVuZGVyIHJlcXVlc3RdXCIpO1xuXHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3Lk1PREVMX0lOVkFMSUQpXG5cdFx0XHQub25jZShcInZpZXc6cmVuZGVyOmFmdGVyXCIsIGZ1bmN0aW9uKHZpZXcsIGZsYWdzKSB7XG5cdFx0XHRcdGNvbnNvbGUuaW5mbyhcIiVzOjpfb25Nb2RlbENoYW5nZSBbcmVuZGVyIGNvbXBsZXRlXVwiLCB2aWV3LmNpZCk7XG5cdFx0XHRcdGNvbnNvbGUuZ3JvdXBFbmQoKTtcblx0XHRcdFx0Ly8gLndoZW5SZW5kZXJlZCgpLnRoZW4oZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHQvLyB0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gXHRjb25zb2xlLmxvZyhcIiVzOjpfb25Nb2RlbENoYW5nZSBbbmV4dCBmcmFtZV1cIiwgdmlldy5jaWQpO1xuXHRcdFx0XHQvLyB9KTtcblx0XHRcdH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogcmVzaXplXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25SZXNpemU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol9vblJlc2l6ZSBbU1RBUlRdXCIsIHRoaXMuY2lkKTtcblx0XHRjb25zb2xlLmdyb3VwKHRoaXMuY2lkICsgXCI6Ol9vblJlc2l6ZSBbcmVuZGVyIHJlcXVlc3RdXCIpO1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcInNraXAtdHJhbnNpdGlvbnNcIik7XG5cdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXG5cdFx0Ly8gdGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEKS5yZW5kZXJOb3coKTtcblx0XHQvLyB0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcblx0XHQvLyBcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcInNraXAtdHJhbnNpdGlvbnNcIik7XG5cdFx0Ly8gfS5iaW5kKHRoaXMpKTtcblxuXHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRClcblx0XHRcdC5vbmNlKFwidmlldzpyZW5kZXI6YWZ0ZXJcIiwgZnVuY3Rpb24odmlldywgZmxhZ3MpIHtcblx0XHRcdFx0Y29uc29sZS5pbmZvKFwiJXM6Ol9vblJlc2l6ZSBbcmVuZGVyIGNvbXBsZXRlXVwiLCB2aWV3LmNpZCk7XG5cdFx0XHRcdC8vIC53aGVuUmVuZGVyZWQoKS50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0dGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0dmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwic2tpcC10cmFuc2l0aW9uc1wiKTtcblx0XHRcdFx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IGZhbHNlO1xuXHRcdFx0XHRcdGNvbnNvbGUuaW5mbyhcIiVzOjpfb25SZXNpemUgW3JlbW92ZWQgc2tpcC10eF1cIiwgdmlldy5jaWQpO1xuXHRcdFx0XHRcdGNvbnNvbGUuZ3JvdXBFbmQoKTtcblx0XHRcdFx0fSlcblx0XHRcdH0pO1xuXHR9LFxuXG5cdC8vIF9vbkJyZWFrcG9pbnRDaGFuZ2U6IGZ1bmN0aW9uKGV2KSB7XG5cdC8vIFx0Y29uc29sZS5sb2coXCIlczo6X29uQnJlYWtwb2ludENoYW5nZVwiLCB0aGlzLmNpZCwgZXYubWF0Y2hlcywgZXYubWVkaWEsIGV2LnRhcmdldC5jbGFzc05hbWUpO1xuXHQvLyBcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCkucmVuZGVyTm93KCk7XG5cdC8vIH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiByZW5kZXJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlbmRlckZyYW1lOiBmdW5jdGlvbih0c3RhbXAsIGZsYWdzKSB7XG5cdFx0Y29uc29sZS5sb2coXCIlczo6cmVuZGVyRnJhbWUgWyVzXVwiLCB0aGlzLmNpZCwgVmlldy5mbGFnc1RvU3RyaW5nKGZsYWdzKSk7XG5cdFx0aWYgKGZsYWdzICYgVmlldy5NT0RFTF9JTlZBTElEKSB7XG5cdFx0XHR0aGlzLnJlbmRlck1vZGVsQ2hhbmdlKGZsYWdzKTtcblx0XHR9XG5cdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHtcblx0XHRcdHRoaXMucmVuZGVyUmVzaXplKGZsYWdzKTtcblx0XHRcdC8vIHRoaXMucmVxdWVzdENoaWxkcmVuUmVuZGVyKGZsYWdzLCB0cnVlKTtcblx0XHR9XG5cdFx0aWYgKGZsYWdzICYgKFZpZXcuTU9ERUxfSU5WQUxJRCB8IFZpZXcuU0laRV9JTlZBTElEKSkge1xuXHRcdFx0Ly8gdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA9IDA7XG5cdFx0XHR3aW5kb3cuc2Nyb2xsKHsgdG9wOiAwLCBiZWhhdmlvcjogXCJzbW9vdGhcIiB9KTtcblx0XHRcdC8vIH0pO1xuXHRcdH1cblx0XHQvLyByZXF1ZXN0IGNoaWxkcmVuIHJlbmRlclxuXHRcdC8vIHNldCAnbm93JyBmbGFnIGlmIHNpemUgaXMgaW52YWxpZFxuXHRcdHRoaXMucmVxdWVzdENoaWxkcmVuUmVuZGVyKGZsYWdzLCB0cnVlKTtcblx0XHQvLyB0aGlzLnJlcXVlc3RDaGlsZHJlblJlbmRlcihmbGFncywgZmxhZ3MgJiBWaWV3LlNJWkVfSU5WQUxJRCk7XG5cblx0XHRpZiAodGhpcy5fYXBwU3RhcnRDaGFuZ2VkKSB7XG5cdFx0XHR0aGlzLl9hcHBTdGFydENoYW5nZWQgPSBmYWxzZTtcblx0XHRcdHRoaXMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucmVuZGVyQXBwU3RhcnQpO1xuXHRcdH1cblx0fSxcblxuXHQvLyBfYWZ0ZXJSZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gMDtcblx0Ly8gfSxcblxuXHRyZW5kZXJBcHBTdGFydDogZnVuY3Rpb24oKSB7XG5cdFx0Y29uc29sZS5sb2coXCIlczo6cmVuZGVyQXBwU3RhcnRcIiwgdGhpcy5jaWQpO1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImFwcC1pbml0aWFsXCIpO1xuXHRcdGlmICh0aGlzLmVsLmNsYXNzTGlzdC5jb250YWlucyhcInJvdXRlLWluaXRpYWxcIikpIHtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcInJvdXRlLWluaXRpYWxcIik7XG5cdFx0XHRjb25zb2xlLndhcm4oXCIncm91dGUtaW5pdGlhbCcgd2FzIHN0aWxsIHByZXNlbnRcIik7XG5cdFx0fVxuXHR9LFxuXG5cdHJlbmRlclJlc2l6ZTogZnVuY3Rpb24oZmxhZ3MpIHtcblx0XHQvLyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA9IDA7XG5cdFx0Ly8gd2luZG93LnNjcm9sbCh7IHRvcDogMCwgYmVoYXZpb3I6IFwic21vb3RoXCIgfSk7XG5cblx0XHRfLmVhY2goR2xvYmFscy5CUkVBS1BPSU5UUywgZnVuY3Rpb24obywgcykge1xuXHRcdFx0dGhpcy50b2dnbGUocywgby5tYXRjaGVzKTtcblx0XHR9LCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0KTtcblxuXHRcdC8vIHZhciBiYiA9IF8uZmlsdGVyKF8ua2V5cyhHbG9iYWxzLkJSRUFLUE9JTlRTKSwgZnVuY3Rpb24ocykge1xuXHRcdC8vIFx0cmV0dXJuIHRoaXMuY29udGFpbnMocyk7XG5cdFx0Ly8gfSwgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QpLmpvaW4oKTtcblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpyZW5kZXJSZXNpemUgbWF0Y2hlczogJXNcIiwgdGhpcy5jaWQsIGJiKTtcblxuXHRcdC8vIHRoaXMucmVxdWVzdENoaWxkcmVuUmVuZGVyKFZpZXcuU0laRV9JTlZBTElELCB0cnVlKTtcblx0XHQvLyB0aGlzLnJlcXVlc3RDaGlsZHJlblJlbmRlcihmbGFncywgdHJ1ZSk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBib2R5IGNsYXNzZXMgZXRjXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyBfY29udHJvbGxlckNoYW5nZWQ6IHRydWUsXG5cblx0cmVuZGVyTW9kZWxDaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnNvbGUubG9nKFwiJXM6OnJlbmRlck1vZGVsQ2hhbmdlXCIsIHRoaXMuY2lkKTtcblxuXHRcdHZhciBhcnRpY2xlID0gdGhpcy5tb2RlbC5nZXQoXCJhcnRpY2xlXCIpO1xuXHRcdHZhciBidW5kbGUgPSB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKTtcblx0XHR2YXIgbWVkaWEgPSB0aGlzLm1vZGVsLmdldChcIm1lZGlhXCIpO1xuXG5cdFx0dmFyIGRvY1RpdGxlID0gW11cblx0XHRkb2NUaXRsZS5wdXNoKEdsb2JhbHMuQVBQX05BTUUpO1xuXHRcdGlmIChidW5kbGUpIHtcblx0XHRcdGRvY1RpdGxlLnB1c2goc3RyaXBUYWdzKGJ1bmRsZS5nZXQoXCJuYW1lXCIpKSk7XG5cdFx0XHRpZiAobWVkaWEpIHtcblx0XHRcdFx0ZG9jVGl0bGUucHVzaChzdHJpcFRhZ3MobWVkaWEuZ2V0KFwibmFtZVwiKSkpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAoYXJ0aWNsZSkge1xuXHRcdFx0ZG9jVGl0bGUucHVzaChzdHJpcFRhZ3MoYXJ0aWNsZS5nZXQoXCJuYW1lXCIpKSk7XG5cdFx0fVxuXHRcdGRvY3VtZW50LnRpdGxlID0gXy51bmVzY2FwZShkb2NUaXRsZS5qb2luKFwiIC8gXCIpKTtcblxuXHRcdHZhciBjbHMgPSB0aGlzLmVsLmNsYXNzTGlzdDtcblx0XHR2YXIgcHJldkF0dHIgPSBudWxsO1xuXG5cdFx0Ly8gU2V0IGFydGljbGUgY2xhc3Ncblx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiYXJ0aWNsZVwiKSkge1xuXHRcdFx0cHJldkF0dHIgPSB0aGlzLm1vZGVsLnByZXZpb3VzKFwiYXJ0aWNsZVwiKTtcblx0XHRcdGlmIChwcmV2QXR0cikge1xuXHRcdFx0XHRjbHMucmVtb3ZlKHByZXZBdHRyLmdldChcImRvbWlkXCIpKTtcblx0XHRcdH1cblx0XHRcdGlmIChhcnRpY2xlKSB7XG5cdFx0XHRcdGNscy5hZGQoYXJ0aWNsZS5nZXQoXCJkb21pZFwiKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGNscy50b2dnbGUoXCJ3aXRoLWFydGljbGVcIiwgISFhcnRpY2xlKTtcblx0XHRjbHMudG9nZ2xlKFwid2l0aG91dC1hcnRpY2xlXCIsICFhcnRpY2xlKTtcblxuXHRcdC8vIFNldCBidW5kbGUgY2xhc3Ncblx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiYnVuZGxlXCIpKSB7XG5cdFx0XHRwcmV2QXR0ciA9IHRoaXMubW9kZWwucHJldmlvdXMoXCJidW5kbGVcIik7XG5cdFx0XHRpZiAocHJldkF0dHIpIHtcblx0XHRcdFx0Y2xzLnJlbW92ZShwcmV2QXR0ci5nZXQoXCJkb21pZFwiKSk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoYnVuZGxlKSB7XG5cdFx0XHRcdGNscy5hZGQoYnVuZGxlLmdldChcImRvbWlkXCIpKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0Y2xzLnRvZ2dsZShcIndpdGgtYnVuZGxlXCIsICEhYnVuZGxlKTtcblx0XHRjbHMudG9nZ2xlKFwid2l0aG91dC1idW5kbGVcIiwgIWJ1bmRsZSk7XG5cblx0XHQvLyBTZXQgbWVkaWEgY2xhc3Ncblx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwibWVkaWFcIikpIHtcblx0XHRcdHByZXZBdHRyID0gdGhpcy5tb2RlbC5wcmV2aW91cyhcIm1lZGlhXCIpO1xuXHRcdFx0aWYgKHByZXZBdHRyKSB7XG5cdFx0XHRcdGNscy5yZW1vdmUocHJldkF0dHIuZ2V0KFwiZG9taWRcIikpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKG1lZGlhKSB7XG5cdFx0XHRcdGNscy5hZGQobWVkaWEuZ2V0KFwiZG9taWRcIikpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRjbHMudG9nZ2xlKFwid2l0aC1tZWRpYVwiLCAhIW1lZGlhKTtcblx0XHRjbHMudG9nZ2xlKFwid2l0aG91dC1tZWRpYVwiLCAhbWVkaWEpO1xuXG5cdFx0Ly8gU2V0IHN0YXRlIGNsYXNzZXNcblx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwicm91dGVOYW1lXCIpKSB7XG5cdFx0XHRwcmV2QXR0ciA9IHRoaXMubW9kZWwucHJldmlvdXMoXCJyb3V0ZU5hbWVcIik7XG5cdFx0XHRpZiAocHJldkF0dHIpIHtcblx0XHRcdFx0Y2xzLnJlbW92ZShcInJvdXRlLVwiICsgcHJldkF0dHIpO1xuXHRcdFx0fVxuXHRcdFx0Y2xzLmFkZChcInJvdXRlLVwiICsgdGhpcy5tb2RlbC5nZXQoXCJyb3V0ZU5hbWVcIikpO1xuXHRcdH1cblxuXHRcdC8vIFNldCBjb2xvci1kYXJrIGNsYXNzXG5cdFx0Ly8gY2xzLnRvZ2dsZShcImNvbG9yLWRhcmtcIiwgaGFzRGFya0JnKTtcblx0XHRjbHMudG9nZ2xlKFwiY29sb3ItZGFya1wiLFxuXHRcdFx0KG1lZGlhICYmIG1lZGlhLmNvbG9ycy5oYXNEYXJrQmcpIHx8XG5cdFx0XHQoYnVuZGxlICYmIGJ1bmRsZS5jb2xvcnMuaGFzRGFya0JnKSk7XG5cdH0sXG59O1xuXG5pZiAoREVCVUcpIHtcblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvRGVidWdUb29sYmFyfSAqL1xuXHR2YXIgRGVidWdUb29sYmFyID0gcmVxdWlyZShcImFwcC92aWV3L0RlYnVnVG9vbGJhclwiKTtcblxuXHRBcHBWaWV3UHJvdG8uX29uTW9kZWxDaGFuZ2UgPSAoZnVuY3Rpb24oZm4pIHtcblx0XHRyZXR1cm4gZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgcmV0dmFsO1xuXHRcdFx0Y29uc29sZS5ncm91cCh0aGlzLmNpZCArIFwiOjpfb25Nb2RlbENoYW5nZVwiKTtcblx0XHRcdE9iamVjdC5rZXlzKHRoaXMubW9kZWwuY2hhbmdlZEF0dHJpYnV0ZXMoKSkuZm9yRWFjaChmdW5jdGlvbihrZXkpIHtcblx0XHRcdFx0dmFyIHByZXYgPSB0aGlzLm1vZGVsLnByZXZpb3VzKGtleSksXG5cdFx0XHRcdFx0Y3VyciA9IHRoaXMubW9kZWwuZ2V0KGtleSk7XG5cdFx0XHRcdGNvbnNvbGUuaW5mbyhcIiVzOjpfb25Nb2RlbENoYW5nZSAlczogJXMgLT4gJXNcIiwgdGhpcy5jaWQsIGtleSxcblx0XHRcdFx0XHRwcmV2ICYmIHByZXYudG9TdHJpbmcoKSxcblx0XHRcdFx0XHRjdXJyICYmIGN1cnIudG9TdHJpbmcoKSk7XG5cdFx0XHR9LCB0aGlzKTtcblx0XHRcdGNvbnNvbGUuZ3JvdXBFbmQoKTtcblxuXHRcdFx0cmV0dmFsID0gZm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdHJldHVybiByZXR2YWw7XG5cdFx0fTtcblx0fSkoQXBwVmlld1Byb3RvLl9vbk1vZGVsQ2hhbmdlKTtcblxuXHRBcHBWaWV3UHJvdG8uaW5pdGlhbGl6ZSA9IChmdW5jdGlvbihmbikge1xuXHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdC8vIHZhciByZXQgPSBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0dmFyIHZpZXcgPSBuZXcgRGVidWdUb29sYmFyKHtcblx0XHRcdFx0aWQ6IFwiZGVidWctdG9vbGJhclwiLFxuXHRcdFx0XHRtb2RlbDogdGhpcy5tb2RlbFxuXHRcdFx0fSk7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHZpZXcucmVuZGVyKCkuZWwpO1xuXHRcdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZTpsYXlvdXROYW1lXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gXHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQpOyAvLy5yZW5kZXJOb3coKTtcblx0XHRcdC8vIH0pO1xuXHRcdFx0Ly8gcmV0dXJuIHJldDtcblx0XHRcdHJldHVybiBmbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH07XG5cdH0pKEFwcFZpZXdQcm90by5pbml0aWFsaXplKTtcbn1cblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvQXBwVmlld31cbi8qL1xubW9kdWxlLmV4cG9ydHMgPSBWaWV3LmV4dGVuZChBcHBWaWV3UHJvdG8sIEFwcFZpZXcpOyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9OYXZpZ2F0aW9uVmlld1xuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL1RyYW5zZm9ybUhlbHBlcn0gKi9cbnZhciBUcmFuc2Zvcm1IZWxwZXIgPSByZXF1aXJlKFwidXRpbHMvVHJhbnNmb3JtSGVscGVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXJ9ICovXG52YXIgVG91Y2hNYW5hZ2VyID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVG91Y2hNYW5hZ2VyXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9Db250cm9sbGVyfSAqL1xudmFyIGNvbnRyb2xsZXIgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvQ29udHJvbGxlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb259ICovXG52YXIgYnVuZGxlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb259ICovXG52YXIgYXJ0aWNsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb25cIik7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUl0ZW19ICovXG4vLyB2YXIgQnVuZGxlSXRlbSA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvaXRlbS9CdW5kbGVJdGVtXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZVZpZXd9ICovXG52YXIgQXJ0aWNsZVZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVWaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0NvbGxlY3Rpb25TdGFja30gKi9cbnZhciBDb2xsZWN0aW9uU3RhY2sgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0NvbGxlY3Rpb25TdGFja1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Db2xsZWN0aW9uU3RhY2t9ICovXG52YXIgU2VsZWN0YWJsZUxpc3RWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9TZWxlY3RhYmxlTGlzdFZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvRG90TmF2aWdhdGlvblJlbmRlcmVyfSAqL1xudmFyIERvdE5hdmlnYXRpb25SZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvRG90TmF2aWdhdGlvblJlbmRlcmVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0Nhcm91c2VsfSAqL1xudmFyIENhcm91c2VsID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9DYXJvdXNlbFwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0Nhcm91c2VsUmVuZGVyZXJ9ICovXG52YXIgQ2Fyb3VzZWxSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvQ2Fyb3VzZWxSZW5kZXJlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9JbWFnZVJlbmRlcmVyfSAqL1xudmFyIEltYWdlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0ltYWdlUmVuZGVyZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvVmlkZW9SZW5kZXJlcn0gKi9cbnZhciBWaWRlb1JlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9WaWRlb1JlbmRlcmVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1NlcXVlbmNlUmVuZGVyZXJ9ICovXG52YXIgU2VxdWVuY2VSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvU2VxdWVuY2VSZW5kZXJlclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyfSAqL1xuLy8gdmFyIFByb2dyZXNzTWV0ZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJcIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgY2Fyb3VzZWxFbXB0eVRlbXBsYXRlID0gcmVxdWlyZShcIi4vdGVtcGxhdGUvQ2Fyb3VzZWwuRW1wdHlSZW5kZXJlci5CdW5kbGUuaGJzXCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBtZWRpYVN0YWNrVGVtcGxhdGUgPSByZXF1aXJlKFwiLi90ZW1wbGF0ZS9Db2xsZWN0aW9uU3RhY2suTWVkaWEuaGJzXCIpO1xuXG4vLyB2YXIgdHJhbnNpdGlvbkVuZCA9IFZpZXcucHJlZml4ZWRFdmVudChcInRyYW5zaXRpb25lbmRcIik7XG52YXIgdHJhbnNmb3JtUHJvcCA9IFZpZXcucHJlZml4ZWRQcm9wZXJ0eShcInRyYW5zZm9ybVwiKTtcbnZhciB0cmFuc2l0aW9uUHJvcCA9IFZpZXcucHJlZml4ZWRQcm9wZXJ0eShcInRyYW5zaXRpb25cIik7XG5cbnZhciB0eCA9IEdsb2JhbHMudHJhbnNpdGlvbnM7XG5cblxuLy8gdmFyIGNsaWNrRXZlbnQgPSB3aW5kb3cuaGFzT3duUHJvcGVydHkoXCJvbnBvaW50ZXJ1cFwiKSA/IFwicG9pbnRlcnVwXCIgOiBcIm1vdXNldXBcIixcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvQ29udGVudFZpZXd9XG4gKi9cbnZhciBDb250ZW50VmlldyA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNpZFByZWZpeDogXCJjb250ZW50Vmlld1wiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImNvbnRhaW5lci1leHBhbmRlZFwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0ZXZlbnRzOiB7XG5cdFx0XCJ0cmFuc2l0aW9uZW5kIC5hZGRpbmctY2hpbGRcIjogXCJfb25BZGRlZFRyYW5zaXRpb25FbmRcIixcblx0XHRcInRyYW5zaXRpb25lbmQgLnJlbW92aW5nLWNoaWxkXCI6IFwiX29uUmVtb3ZlZFRyYW5zaXRpb25FbmRcIixcblx0XHQvLyBcInRyYW5zaXRpb25lbmRcIjogXCJfb25UcmFuc2l0aW9uRW5kXCIsXG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0Xy5iaW5kQWxsKHRoaXMsIFwiX29uVlBhblN0YXJ0XCIsIFwiX29uVlBhbk1vdmVcIiwgXCJfb25WUGFuRmluYWxcIiwgXCJfb25Db2xsYXBzZWRFdmVudFwiKTtcblxuXHRcdHRoaXMudHJhbnNmb3JtcyA9IG5ldyBUcmFuc2Zvcm1IZWxwZXIoKTtcblx0XHR0aGlzLnRvdWNoID0gVG91Y2hNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG5cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlXCIsIHRoaXMuX29uTW9kZWxDaGFuZ2UpO1xuXG5cdFx0Ly8gZGlzY29ubmVjdCBjaGlsZHJlbiBiZWZvcmUgbGFzdCBjaGFuZ2Vcblx0XHQvLyB0aGlzLmxpc3RlblRvKGJ1bmRsZXMsIFwiZGVzZWxlY3Q6b25lXCIsIHRoaXMuX29uRGVzZWxlY3RPbmVCdW5kbGUpO1xuXG5cdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHRcdHRoaXMuaXRlbVZpZXdzID0gW107XG5cblx0XHQvLyB0aGlzLnByb2dyZXNzV3JhcHBlciA9IHRoaXMuY3JlYXRlUHJvZ3Jlc3NXcmFwcGVyKCksXG5cdFx0Ly8gdGhpcy5lbC5hcHBlbmRDaGlsZCh0aGlzLnByb2dyZXNzV3JhcHBlci5lbCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogUmVuZGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlbmRlckZyYW1lOiBmdW5jdGlvbih0c3RhbXAsIGZsYWdzKSB7XG5cdFx0Ly8gdmFsdWVzXG5cdFx0dmFyIGNvbGxhcHNlZCA9IHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpO1xuXHRcdHZhciBjb2xsYXBzZWRDaGFuZ2VkID0gKGZsYWdzICYgVmlldy5NT0RFTF9JTlZBTElEKVxuXHRcdFx0JiYgdGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiY29sbGFwc2VkXCIpO1xuXHRcdHZhciBjaGlsZHJlbkNoYW5nZWQgPSAoZmxhZ3MgJiBWaWV3Lk1PREVMX0lOVkFMSUQpXG5cdFx0XHQmJiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiYnVuZGxlXCIpIHx8IHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImFydGljbGVcIikpO1xuXG5cdFx0Ly8gZmxhZ3Ncblx0XHR2YXIgc2l6ZUNoYW5nZWQgPSAhIShmbGFncyAmIFZpZXcuU0laRV9JTlZBTElEKTtcblx0XHR2YXIgdHJhbnNmb3Jtc0NoYW5nZWQgPSAhIShmbGFncyAmIChWaWV3Lk1PREVMX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpKTtcblx0XHR0cmFuc2Zvcm1zQ2hhbmdlZCA9IHRyYW5zZm9ybXNDaGFuZ2VkIHx8IHRoaXMuX3RyYW5zZm9ybXNDaGFuZ2VkIHx8IHRoaXMuc2tpcFRyYW5zaXRpb25zO1xuXG5cdFx0Ly8gZGVidWdcblx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHQvLyBpZiAoZmxhZ3MgJiBWaWV3Lk1PREVMX0lOVkFMSUQpIHtcblx0XHQvLyBcdGNvbnNvbGUuZ3JvdXAodGhpcy5jaWQgKyBcIjo6cmVuZGVyRnJhbWUgbW9kZWwgY2hhbmdlZDpcIik7XG5cdFx0Ly8gXHRPYmplY3Qua2V5cyh0aGlzLm1vZGVsLmNoYW5nZWQpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7XG5cdFx0Ly8gXHRcdGNvbnNvbGUubG9nKFwiXFx0JXM6ICVzIC0+ICVzXCIsIGtleSwgdGhpcy5tb2RlbC5fcHJldmlvdXNBdHRyaWJ1dGVzW2tleV0sIHRoaXMubW9kZWwuY2hhbmdlZFtrZXldKTtcblx0XHQvLyBcdH0sIHRoaXMpO1xuXHRcdC8vIFx0Y29uc29sZS5ncm91cEVuZCgpO1xuXHRcdC8vIH1cblxuXHRcdC8vIG1vZGVsOmNoaWxkcmVuXG5cdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0aWYgKGNoaWxkcmVuQ2hhbmdlZCkge1xuXHRcdFx0dGhpcy5yZW1vdmVDaGlsZHJlbigpO1xuXHRcdFx0aWYgKGJ1bmRsZXMuc2VsZWN0ZWQpIHtcblx0XHRcdFx0dGhpcy5jcmVhdGVDaGlsZHJlbihidW5kbGVzLnNlbGVjdGVkKTtcblx0XHRcdH0gZWxzZVxuXHRcdFx0aWYgKGFydGljbGVzLnNlbGVjdGVkKSB7XG5cdFx0XHRcdHRoaXMuY3JlYXRlQ2hpbGRyZW4oYXJ0aWNsZXMuc2VsZWN0ZWQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIG1vZGVsOmNvbGxhcHNlZFxuXHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdGlmIChjb2xsYXBzZWRDaGFuZ2VkKSB7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjb250YWluZXItY29sbGFwc2VkXCIsIGNvbGxhcHNlZCk7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjb250YWluZXItZXhwYW5kZWRcIiwgIWNvbGxhcHNlZCk7XG5cdFx0fVxuXG5cdFx0Ly8gc2l6ZVxuXHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdGlmIChzaXplQ2hhbmdlZCkge1xuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLmNsZWFyQWxsQ2FwdHVyZXMoKTtcblx0XHR9XG5cblx0XHQvLyB0cmFuc2Zvcm1zXG5cdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0aWYgKHRyYW5zZm9ybXNDaGFuZ2VkKSB7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb250YWluZXItY2hhbmdpbmdcIik7XG5cdFx0XHRpZiAodGhpcy5za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnN0b3BBbGxUcmFuc2l0aW9ucygpO1xuXHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb250YWluZXItY2hhbmdlZFwiKTtcblx0XHRcdFx0aWYgKCFjaGlsZHJlbkNoYW5nZWQpIHtcblx0XHRcdFx0XHQvLyB0aGlzLnRyYW5zZm9ybXMuY2xlYXJBbGxPZmZzZXRzKCk7XG5cdFx0XHRcdFx0aWYgKGNvbGxhcHNlZENoYW5nZWQpIHtcblx0XHRcdFx0XHRcdHRoaXMuX3NldENoaWxkcmVuRW5hYmxlZChjb2xsYXBzZWQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKCFjaGlsZHJlbkNoYW5nZWQpIHtcblx0XHRcdFx0XHRpZiAoY29sbGFwc2VkQ2hhbmdlZCkge1xuXHRcdFx0XHRcdFx0dmFyIGFmdGVyVHJhbnNpdGlvbnNGbjtcblx0XHRcdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcImNvbnRhaW5lci1jaGFuZ2VkXCIpO1xuXHRcdFx0XHRcdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLmNsZWFyQWxsT2Zmc2V0cygpO1xuXHRcdFx0XHRcdFx0aWYgKGNvbGxhcHNlZCkge1xuXHRcdFx0XHRcdFx0XHQvLyBjb250YWluZXItY29sbGFwc2VkLCBlbmFibGUgbGFzdFxuXHRcdFx0XHRcdFx0XHRhZnRlclRyYW5zaXRpb25zRm4gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLl9zZXRDaGlsZHJlbkVuYWJsZWQodHJ1ZSk7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY29udGFpbmVyLWNoYW5nZWRcIik7XG5cdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5ydW5BbGxUcmFuc2l0aW9ucyh0eC5MQVNUKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vIGNvbnRhaW5lci1leHBhbmRlZCwgZGlzYWJsZSBmaXJzdFxuXHRcdFx0XHRcdFx0XHRhZnRlclRyYW5zaXRpb25zRm4gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb250YWluZXItY2hhbmdlZFwiKTtcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0dGhpcy5fc2V0Q2hpbGRyZW5FbmFibGVkKGZhbHNlKTtcblx0XHRcdFx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnJ1bkFsbFRyYW5zaXRpb25zKHR4LkZJUlNUKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGFmdGVyVHJhbnNpdGlvbnNGbiA9IGFmdGVyVHJhbnNpdGlvbnNGbi5iaW5kKHRoaXMpO1xuXHRcdFx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLndoZW5BbGxUcmFuc2l0aW9uc0VuZCgpLnRoZW4oYWZ0ZXJUcmFuc2l0aW9uc0ZuLCBhZnRlclRyYW5zaXRpb25zRm4pO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMuaXRlbXMuZm9yRWFjaChmdW5jdGlvbihvKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChvLmhhc09mZnNldCkge1xuXHRcdFx0XHRcdFx0XHRcdG8ucnVuVHJhbnNpdGlvbih0eC5OT1cpO1xuXHRcdFx0XHRcdFx0XHRcdC8vIG8uY2xlYXJPZmZzZXQoKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAoIWNoaWxkcmVuQ2hhbmdlZCkge1xuXHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMuY2xlYXJBbGxPZmZzZXRzKCk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0XHR9XG5cdFx0aWYgKHNpemVDaGFuZ2VkKSB7XG5cdFx0XHR0aGlzLml0ZW1WaWV3cy5mb3JFYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0dmlldy5za2lwVHJhbnNpdGlvbnMgPSB0aGlzLnNraXBUcmFuc2l0aW9ucztcblx0XHRcdFx0Ly8gdmlldy5pbnZhbGlkYXRlU2l6ZSgpO1xuXHRcdFx0XHQvLyB2aWV3LnJlbmRlck5vdygpO1xuXHRcdFx0XHR2aWV3LnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQpLnJlbmRlck5vdygpO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0fVxuXHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gdGhpcy5fdHJhbnNmb3Jtc0NoYW5nZWQgPSBmYWxzZTtcblx0fSxcblxuXHRfc2V0Q2hpbGRyZW5FbmFibGVkOiBmdW5jdGlvbihlbmFibGVkKSB7XG5cdFx0Ly8gaWYgKGVuYWJsZWQpIHtcblx0XHQvLyBcdHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX29uQ29sbGFwc2VkQ2xpY2ssIGZhbHNlKTtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0dGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5fb25Db2xsYXBzZWRDbGljaywgZmFsc2UpO1xuXHRcdC8vIH1cblx0XHR0aGlzLml0ZW1WaWV3cy5mb3JFYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdHZpZXcuc2V0RW5hYmxlZChlbmFibGVkKTtcblx0XHR9KTtcblx0fSxcblxuXHRfb25Db2xsYXBzZWRFdmVudDogZnVuY3Rpb24oZXYpIHtcblx0XHRjb25zb2xlLmxvZyhcIiVzOlslcyAtPiBfb25Db2xsYXBzZWRFdmVudF0gdGFyZ2V0OiAlc1wiLCB0aGlzLmNpZCwgZXYudHlwZSwgZXYudGFyZ2V0KTtcblx0XHRpZiAoIWV2LmRlZmF1bHRQcmV2ZW50ZWQgJiYgdGhpcy5tb2RlbC5nZXQoXCJ3aXRoQnVuZGxlXCIpICYmICF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSAmJiAhdGhpcy5lbmFibGVkKSB7XG5cdFx0XHQvLyB0aGlzLnNldEltbWVkaWF0ZShmdW5jdGlvbigpIHtcblx0XHRcdC8vIGlmIChldi50eXBlID09IFwiY2xpY2tcIikgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRldi5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dGhpcy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIGlmIChldi50eXBlID09IFwiY2xpY2tcIikgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdHRoaXMubW9kZWwuc2V0KFwiY29sbGFwc2VkXCIsIHRydWUpO1xuXHRcdFx0fSk7XG5cdFx0XHQvLyB9KTtcblx0XHR9XG5cdH0sXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIG1vZGVsIGNoYW5nZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uTW9kZWxDaGFuZ2U6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoQnVuZGxlXCIpKSB7XG5cdFx0XHRpZiAodGhpcy5tb2RlbC5nZXQoXCJ3aXRoQnVuZGxlXCIpKSB7XG5cdFx0XHRcdHRoaXMudG91Y2gub24oXCJ2cGFuc3RhcnRcIiwgdGhpcy5fb25WUGFuU3RhcnQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy50b3VjaC5vZmYoXCJ2cGFuc3RhcnRcIiwgdGhpcy5fb25WUGFuU3RhcnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiY29sbGFwc2VkXCIpIHx8IHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdGlmICh0aGlzLm1vZGVsLmdldChcIndpdGhCdW5kbGVcIikgJiYgIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHRcdHRoaXMudG91Y2gub24oXCJocGFubGVmdCBocGFucmlnaHRcIiwgdGhpcy5fb25Db2xsYXBzZWRFdmVudCk7XG5cdFx0XHRcdHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX29uQ29sbGFwc2VkRXZlbnQsIGZhbHNlKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMudG91Y2gub2ZmKFwiaHBhbmxlZnQgaHBhbnJpZ2h0XCIsIHRoaXMuX29uQ29sbGFwc2VkRXZlbnQpO1xuXHRcdFx0XHR0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9vbkNvbGxhcHNlZEV2ZW50LCBmYWxzZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3Lk1PREVMX0lOVkFMSUQpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogVmVydGljYWwgdG91Y2gvbW92ZSAoX29uVlBhbiopXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfY29sbGFwc2VkT2Zmc2V0WTogR2xvYmFscy5DT0xMQVBTRV9PRkZTRVQsXG5cblx0X29uVlBhblN0YXJ0OiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMudG91Y2gub24oXCJ2cGFubW92ZVwiLCB0aGlzLl9vblZQYW5Nb3ZlKTtcblx0XHR0aGlzLnRvdWNoLm9uKFwidnBhbmVuZCB2cGFuY2FuY2VsXCIsIHRoaXMuX29uVlBhbkZpbmFsKTtcblxuXHRcdHRoaXMudHJhbnNmb3Jtcy5zdG9wQWxsVHJhbnNpdGlvbnMoKTtcblx0XHQvLyB0aGlzLnRyYW5zZm9ybXMuY2xlYXJBbGxPZmZzZXRzKCk7XG5cdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLmNsZWFyQWxsQ2FwdHVyZXMoKTtcblxuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcImNvbnRhaW5lci1jaGFuZ2luZ1wiKTtcblx0XHR0aGlzLl9vblZQYW5Nb3ZlKGV2KTtcblx0fSxcblxuXHRfb25WUGFuTW92ZTogZnVuY3Rpb24oZXYpIHtcblx0XHR2YXIgY29sbGFwc2VkID0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdFx0dmFyIGRlbHRhID0gZXYuZGVsdGFZOyAvL2V2LnRocmVzaG9sZERlbHRhWTtcblx0XHR2YXIgbWF4RGVsdGEgPSB0aGlzLl9jb2xsYXBzZWRPZmZzZXRZOyAvLyArIE1hdGguYWJzKGV2LnRocmVzaG9sZE9mZnNldFkpO1xuXG5cdFx0Ly8gY2hlY2sgaWYgZGlyZWN0aW9uIGlzIGFsaWduZWQgd2l0aCBjb2xsYXBzZWQvZXhwYW5kXG5cdFx0dmFyIGlzVmFsaWREaXIgPSBjb2xsYXBzZWQgPyAoZGVsdGEgPiAwKSA6IChkZWx0YSA8IDApO1xuXHRcdHZhciBtb3ZlRmFjdG9yID0gY29sbGFwc2VkID8gR2xvYmFscy5WUEFOX0RSQUcgOiAxIC0gR2xvYmFscy5WUEFOX0RSQUc7XG5cblx0XHRkZWx0YSA9IE1hdGguYWJzKGRlbHRhKTsgLy8gcmVtb3ZlIHNpZ25cblx0XHRkZWx0YSAqPSBtb3ZlRmFjdG9yO1xuXHRcdG1heERlbHRhICo9IG1vdmVGYWN0b3I7XG5cblx0XHRpZiAoaXNWYWxpZERpcikge1xuXHRcdFx0aWYgKGRlbHRhID4gbWF4RGVsdGEpIHsgLy8gb3ZlcnNob290aW5nXG5cdFx0XHRcdGRlbHRhID0gKChkZWx0YSAtIG1heERlbHRhKSAqIEdsb2JhbHMuVlBBTl9PVVRfRFJBRykgKyBtYXhEZWx0YTtcblx0XHRcdH0gZWxzZSB7IC8vIG5vIG92ZXJzaG9vdGluZ1xuXHRcdFx0XHQvLyBkZWx0YSA9IGRlbHRhO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRkZWx0YSA9ICgtZGVsdGEpICogR2xvYmFscy5WUEFOX09VVF9EUkFHOyAvLyBkZWx0YSBpcyBvcHBvc2l0ZVxuXHRcdH1cblx0XHRkZWx0YSAqPSBjb2xsYXBzZWQgPyAxIDogLTE7IC8vIHJlYXBwbHkgc2lnblxuXG5cdFx0dGhpcy50cmFuc2Zvcm1zLm9mZnNldEFsbCgwLCBkZWx0YSk7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdH0sXG5cblx0X29uVlBhbkZpbmFsOiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMudG91Y2gub2ZmKFwidnBhbm1vdmVcIiwgdGhpcy5fb25WUGFuTW92ZSk7XG5cdFx0dGhpcy50b3VjaC5vZmYoXCJ2cGFuZW5kIHZwYW5jYW5jZWxcIiwgdGhpcy5fb25WUGFuRmluYWwpO1xuXG5cdFx0Ly8gRklYTUU6IG1vZGVsLmNvbGxhcHNlZCBtYXkgaGF2ZSBhbHJlYWR5IGNoYW5nZWQsIF9vblZQYW5Nb3ZlIHdvdWxkIHJ1biB3aXRoIHdyb25nIHZhbHVlczpcblx0XHQvLyBtb2RlbC5jb2xsYXBzZWQgaXMgY2hhbmdlZCBpbiBhIHNldEltbWVkaWF0ZSBjYWxsYmFjayBmcm9tIE5hdmlnYXRpb25WaWV3LlxuXG5cdFx0dGhpcy5fb25WUGFuTW92ZShldik7XG5cdFx0dGhpcy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLl90cmFuc2Zvcm1zQ2hhbmdlZCA9IHRydWU7XG5cdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoKTtcblx0XHR9KTtcblx0fSxcblxuXHQvLyB3aWxsQ29sbGFwc2VkQ2hhbmdlOiBmdW5jdGlvbihldikge1xuXHQvLyBcdHZhciBjb2xsYXBzZWQgPSB0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKTtcblx0Ly8gXHRyZXR1cm4gZXYudHlwZSA9PSBcInZwYW5lbmRcIj8gY29sbGFwc2VkP1xuXHQvLyBcdFx0ZXYudGhyZXNob2xkRGVsdGFZID4gR2xvYmFscy5DT0xMQVBTRV9USFJFU0hPTEQgOlxuXHQvLyBcdFx0ZXYudGhyZXNob2xkRGVsdGFZIDwgLUdsb2JhbHMuQ09MTEFQU0VfVEhSRVNIT0xEIDpcblx0Ly8gXHRcdGZhbHNlO1xuXHQvLyB9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogY3JlYXRlL3JlbW92ZSBjaGlsZHJlbiBvbiBidW5kbGUgc2VsZWN0aW9uXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQ3JlYXRlIGNoaWxkcmVuIG9uIGJ1bmRsZSBzZWxlY3QgKi9cblx0Y3JlYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0dmFyIHZpZXc7XG5cdFx0aWYgKG1vZGVsLl9fcHJvdG9fXy5jb25zdHJ1Y3RvciA9PT0gYnVuZGxlcy5tb2RlbCkge1xuXHRcdFx0Ly8gd2lsbCBiZSBhdHRhY2hlZCB0byBkb20gaW4gdGhpcyBvcmRlclxuXHRcdFx0dmlldyA9IHRoaXMuY3JlYXRlTWVkaWFDYXB0aW9uU3RhY2sobW9kZWwpO1xuXHRcdFx0dGhpcy5pdGVtVmlld3MucHVzaCh2aWV3KTtcblx0XHRcdHRoaXMudHJhbnNmb3Jtcy5hZGQodmlldy5lbCk7XG5cdFx0XHR2aWV3ID0gdGhpcy5jcmVhdGVNZWRpYUNhcm91c2VsKG1vZGVsKTtcblx0XHRcdHRoaXMuaXRlbVZpZXdzLnB1c2godmlldyk7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMuYWRkKHZpZXcuZWwpO1xuXHRcdFx0dmlldyA9IHRoaXMuY3JlYXRlTWVkaWFEb3ROYXZpZ2F0aW9uKG1vZGVsKTtcblx0XHRcdHRoaXMuaXRlbVZpZXdzLnB1c2godmlldyk7XG5cdFx0fSBlbHNlXG5cdFx0aWYgKG1vZGVsLl9fcHJvdG9fXy5jb25zdHJ1Y3RvciA9PT0gYXJ0aWNsZXMubW9kZWwpIHtcblx0XHRcdHZpZXcgPSB0aGlzLmNyZWF0ZUFydGljbGVWaWV3KG1vZGVsKTtcblx0XHRcdHRoaXMuaXRlbVZpZXdzLnB1c2godmlldyk7XG5cdFx0fVxuXG5cdFx0dGhpcy5pdGVtVmlld3MuZm9yRWFjaChmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRpZiAoIXRoaXMuc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0XHRcdHZpZXcuZWwuY2xhc3NMaXN0LmFkZChcImFkZGluZy1jaGlsZFwiKTtcblx0XHRcdFx0dmlldy5lbC5zdHlsZS5vcGFjaXR5ID0gMDtcblx0XHRcdH1cblx0XHRcdHRoaXMuZWwuYXBwZW5kQ2hpbGQodmlldy5lbCk7XG5cdFx0XHR2aWV3LnJlbmRlcigpO1xuXHRcdH0sIHRoaXMpO1xuXG5cdFx0aWYgKCF0aGlzLnNraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0dGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6OmNyZWF0ZUNoaWxkcmVuOjpbY2FsbGJhY2s6cmVxdWVzdEFuaW1hdGlvbkZyYW1lXVwiLCB0aGlzLmNpZCk7XG5cdFx0XHRcdHRoaXMuaXRlbVZpZXdzLmZvckVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHRcdGlmICghdGhpcy5za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdFx0XHRcdHZpZXcuZWwuc3R5bGVbdHJhbnNpdGlvblByb3BdID0gXCJvcGFjaXR5IFwiICsgdHguTEFTVC5jc3NUZXh0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR2aWV3LmVsLnN0eWxlLnJlbW92ZVByb3BlcnR5KFwib3BhY2l0eVwiKTtcblx0XHRcdFx0fSwgdGhpcyk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH0sXG5cblx0cmVtb3ZlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaXRlbVZpZXdzLmZvckVhY2goZnVuY3Rpb24odmlldywgaSwgYXJyKSB7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMucmVtb3ZlKHZpZXcuZWwpO1xuXHRcdFx0aWYgKHRoaXMuc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0XHRcdHZpZXcucmVtb3ZlKCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR2YXIgcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHZpZXcuZWwpO1xuXHRcdFx0XHRpZiAocy5vcGFjaXR5ID09IFwiMFwiIHx8IHMudmlzaWJpbGl0eSA9PSBcImhpZGRlblwiKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coXCIlczo6cmVtb3ZlQ2hpbGRyZW4gW3ZpZXc6JXNdIHJlbW92ZWQgaW1tZWRpYXRlbHkgKGludmlzaWJsZSlcIiwgdGhpcy5jaWQsIHZpZXcuY2lkKTtcblx0XHRcdFx0XHR2aWV3LnJlbW92ZSgpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHZpZXcuZWwuY2xhc3NMaXN0LmFkZChcInJlbW92aW5nLWNoaWxkXCIpO1xuXHRcdFx0XHRcdGlmIChzW3RyYW5zZm9ybVByb3BdKSB2aWV3LmVsLnN0eWxlW3RyYW5zZm9ybVByb3BdID0gc1t0cmFuc2Zvcm1Qcm9wXTtcblx0XHRcdFx0XHR2aWV3LmVsLnN0eWxlW3RyYW5zaXRpb25Qcm9wXSA9IFwib3BhY2l0eSBcIiArIHR4LkZJUlNULmNzc1RleHQ7XG5cdFx0XHRcdFx0dmlldy5lbC5zdHlsZS5vcGFjaXR5ID0gMDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0YXJyW2ldID0gbnVsbDtcblx0XHR9LCB0aGlzKTtcblx0XHR0aGlzLml0ZW1WaWV3cy5sZW5ndGggPSAwO1xuXHR9LFxuXG5cdF9vbkFkZGVkVHJhbnNpdGlvbkVuZDogZnVuY3Rpb24oZXYpIHtcblx0XHRpZiAoZXYudGFyZ2V0LmNpZCAmJiB0aGlzLmNoaWxkVmlld3MuaGFzT3duUHJvcGVydHkoZXYudGFyZ2V0LmNpZCkpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vbkFkZGVkVHJhbnNpdGlvbkVuZCBbdmlldzolc10gW3Byb3A6JXNdIFtldjolc11cIiwgdGhpcy5jaWQsIGV2LnRhcmdldC5jaWQsIGV2LnByb3BlcnR5TmFtZSwgZXYudHlwZSk7XG5cdFx0XHR2YXIgdmlldyA9IHRoaXMuY2hpbGRWaWV3c1tldi50YXJnZXQuY2lkXTtcblx0XHRcdHZpZXcuZWwuY2xhc3NMaXN0LnJlbW92ZShcImFkZGluZy1jaGlsZFwiKTtcblx0XHRcdHZpZXcuZWwuc3R5bGUucmVtb3ZlUHJvcGVydHkodHJhbnNpdGlvblByb3ApO1xuXHRcdH1cblx0fSxcblxuXHRfb25SZW1vdmVkVHJhbnNpdGlvbkVuZDogZnVuY3Rpb24oZXYpIHtcblx0XHRpZiAoZXYudGFyZ2V0LmNpZCAmJiB0aGlzLmNoaWxkVmlld3MuaGFzT3duUHJvcGVydHkoZXYudGFyZ2V0LmNpZCkpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vblJlbW92ZWRUcmFuc2l0aW9uRW5kIFt2aWV3OiVzXSBbcHJvcDolc10gW2V2OiVzXVwiLCB0aGlzLmNpZCwgZXYudGFyZ2V0LmNpZCwgZXYucHJvcGVydHlOYW1lLCBldi50eXBlKTtcblx0XHRcdHZhciB2aWV3ID0gdGhpcy5jaGlsZFZpZXdzW2V2LnRhcmdldC5jaWRdO1xuXHRcdFx0dmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwicmVtb3ZpbmctY2hpbGRcIik7XG5cdFx0XHR2aWV3LnJlbW92ZSgpO1xuXHRcdH1cblx0fSxcblxuXHQvLyBwdXJnZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0Ly8gXHR2YXIgaSwgZWwsIGVscyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcIi5yZW1vdmluZy1jaGlsZFwiKTtcblx0Ly8gXHRmb3IgKGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7XG5cdC8vIFx0XHRlbCA9IGVscy5pdGVtKGkpO1xuXHQvLyBcdFx0aWYgKGVsLnBhcmVudEVsZW1lbnQgPT09IHRoaXMuZWwpIHtcblx0Ly8gXHRcdFx0dHJ5IHtcblx0Ly8gXHRcdFx0XHRjb25zb2xlLmVycm9yKFwiJXM6OnB1cmdlQ2hpbGRyZW5cIiwgdGhpcy5jaWQsIGVsLmdldEF0dHJpYnV0ZShcImRhdGEtY2lkXCIpKTtcblx0Ly8gXHRcdFx0XHRWaWV3LmZpbmRCeUVsZW1lbnQoZWwpLnJlbW92ZSgpO1xuXHQvLyBcdFx0XHR9IGNhdGNoIChlcnIpIHtcblx0Ly8gXHRcdFx0XHRjb25zb2xlLmVycm9yKFwiczo6cHVyZ2VDaGlsZHJlblwiLCB0aGlzLmNpZCwgXCJvcnBoYW5lZCBlbGVtZW50XCIsIGVycik7XG5cdC8vIFx0XHRcdFx0dGhpcy5lbC5yZW1vdmVDaGlsZChlbCk7XG5cdC8vIFx0XHRcdH1cblx0Ly8gXHRcdH1cblx0Ly8gXHR9XG5cdC8vIH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBDb21wb25lbnRzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXG5cdC8qKlxuXHQgKiBtZWRpYS1jYXJvdXNlbFxuXHQgKi9cblx0Y3JlYXRlTWVkaWFDYXJvdXNlbDogZnVuY3Rpb24oYnVuZGxlKSB7XG5cdFx0Ly8gQ3JlYXRlIGNhcm91c2VsXG5cdFx0dmFyIEVtcHR5UmVuZGVyZXIgPSBDYXJvdXNlbFJlbmRlcmVyLmV4dGVuZCh7XG5cdFx0XHRjbGFzc05hbWU6IFwiY2Fyb3VzZWwtaXRlbSBlbXB0eS1pdGVtXCIsXG5cdFx0XHRtb2RlbDogYnVuZGxlLFxuXHRcdFx0dGVtcGxhdGU6IGNhcm91c2VsRW1wdHlUZW1wbGF0ZSxcblx0XHR9KTtcblx0XHR2YXIgcmVuZGVyZXJGdW5jdGlvbiA9IGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBhcnIpIHtcblx0XHRcdGlmIChpbmRleCA9PT0gLTEpIHtcblx0XHRcdFx0cmV0dXJuIEVtcHR5UmVuZGVyZXI7XG5cdFx0XHR9XG5cdFx0XHRzd2l0Y2ggKGl0ZW0uYXR0cihcIkByZW5kZXJlclwiKSkge1xuXHRcdFx0XHRjYXNlIFwidmlkZW9cIjpcblx0XHRcdFx0XHRyZXR1cm4gVmlkZW9SZW5kZXJlcjtcblx0XHRcdFx0Y2FzZSBcInNlcXVlbmNlXCI6XG5cdFx0XHRcdFx0cmV0dXJuIFNlcXVlbmNlUmVuZGVyZXI7XG5cdFx0XHRcdGNhc2UgXCJpbWFnZVwiOlxuXHRcdFx0XHRcdHJldHVybiBJbWFnZVJlbmRlcmVyO1xuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdHJldHVybiBJbWFnZVJlbmRlcmVyO1xuXHRcdFx0fVxuXHRcdH07XG5cdFx0dmFyIHZpZXcgPSBuZXcgQ2Fyb3VzZWwoe1xuXHRcdFx0Y2xhc3NOYW1lOiBcIm1lZGlhLWNhcm91c2VsIFwiICsgYnVuZGxlLmdldChcImRvbWlkXCIpLFxuXHRcdFx0Y29sbGVjdGlvbjogYnVuZGxlLmdldChcIm1lZGlhXCIpLFxuXHRcdFx0cmVuZGVyZXJGdW5jdGlvbjogcmVuZGVyZXJGdW5jdGlvbixcblx0XHRcdHJlcXVpcmVTZWxlY3Rpb246IGZhbHNlLFxuXHRcdFx0ZGlyZWN0aW9uOiBDYXJvdXNlbC5ESVJFQ1RJT05fSE9SSVpPTlRBTCxcblx0XHRcdHRvdWNoOiB0aGlzLnRvdWNoLFxuXHRcdH0pO1xuXHRcdGNvbnRyb2xsZXIubGlzdGVuVG8odmlldywge1xuXHRcdFx0XCJ2aWV3OnNlbGVjdDpvbmVcIjogY29udHJvbGxlci5zZWxlY3RNZWRpYSxcblx0XHRcdFwidmlldzpzZWxlY3Q6bm9uZVwiOiBjb250cm9sbGVyLmRlc2VsZWN0TWVkaWEsXG5cdFx0XHQvLyBcInZpZXc6cmVtb3ZlZFwiOiBjb250cm9sbGVyLnN0b3BMaXN0ZW5pbmdcblx0XHR9KTtcblx0XHR2aWV3Lmxpc3RlblRvKGJ1bmRsZSwgXCJkZXNlbGVjdGVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMuY29sbGVjdGlvbik7XG5cdFx0XHRjb250cm9sbGVyLnN0b3BMaXN0ZW5pbmcodGhpcyk7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyoqXG5cdCAqIG1lZGlhLWNhcHRpb24tc3RhY2tcblx0ICovXG5cdGNyZWF0ZU1lZGlhQ2FwdGlvblN0YWNrOiBmdW5jdGlvbihidW5kbGUpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBDb2xsZWN0aW9uU3RhY2soe1xuXHRcdFx0Y2xhc3NOYW1lOiBcIm1lZGlhLWNhcHRpb24tc3RhY2tcIixcblx0XHRcdGNvbGxlY3Rpb246IGJ1bmRsZS5nZXQoXCJtZWRpYVwiKSxcblx0XHRcdHRlbXBsYXRlOiBtZWRpYVN0YWNrVGVtcGxhdGVcblx0XHR9KTtcblx0XHR2aWV3Lmxpc3RlblRvKGJ1bmRsZSwgXCJkZXNlbGVjdGVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMuY29sbGVjdGlvbik7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyoqXG5cdCAqIG1lZGlhLWRvdG5hdlxuXHQgKi9cblx0Y3JlYXRlTWVkaWFEb3ROYXZpZ2F0aW9uOiBmdW5jdGlvbihidW5kbGUpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBTZWxlY3RhYmxlTGlzdFZpZXcoe1xuXHRcdFx0Y2xhc3NOYW1lOiBcIm1lZGlhLWRvdG5hdiBkb3RzLWZvbnRmYWNlIGNvbG9yLWZnMDVcIixcblx0XHRcdGNvbGxlY3Rpb246IGJ1bmRsZS5nZXQoXCJtZWRpYVwiKSxcblx0XHRcdHJlbmRlcmVyOiBEb3ROYXZpZ2F0aW9uUmVuZGVyZXJcblx0XHR9KTtcblx0XHRjb250cm9sbGVyLmxpc3RlblRvKHZpZXcsIHtcblx0XHRcdFwidmlldzpzZWxlY3Q6b25lXCI6IGNvbnRyb2xsZXIuc2VsZWN0TWVkaWEsXG5cdFx0XHRcInZpZXc6c2VsZWN0Om5vbmVcIjogY29udHJvbGxlci5kZXNlbGVjdE1lZGlhLFxuXHRcdFx0Ly8gXCJ2aWV3OnJlbW92ZWRcIjogY29udHJvbGxlci5zdG9wTGlzdGVuaW5nXG5cdFx0fSk7XG5cdFx0dmlldy5saXN0ZW5UbyhidW5kbGUsIFwiZGVzZWxlY3RlZFwiLCBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLmNvbGxlY3Rpb24pO1xuXHRcdFx0Y29udHJvbGxlci5zdG9wTGlzdGVuaW5nKHRoaXMpO1xuXHRcdH0pO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8qKlxuXHQgKiBAcGFyYW0gZWwge21vZHVsZTphcHAvbW9kZWwvaXRlbS9BcnRpY2xlVmlld31cblx0ICogQHJldHVybiB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld31cblx0ICovXG5cdGNyZWF0ZUFydGljbGVWaWV3OiBmdW5jdGlvbihhcnRpY2xlKSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgQXJ0aWNsZVZpZXcoe1xuXHRcdFx0bW9kZWw6IGFydGljbGUsXG5cdFx0fSk7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0Ly8gY3JlYXRlUHJvZ3Jlc3NXcmFwcGVyOiBmdW5jdGlvbigpIHtcblx0Ly8gXHQvLyB2YXIgdmlldyA9IG5ldyBQcm9ncmVzc01ldGVyKHtcblx0Ly8gXHQvLyBcdGlkOiBcIm1lZGlhLXByb2dyZXNzLXdyYXBwZXJcIixcblx0Ly8gXHQvLyBcdC8vIGNsYXNzTmFtZTogXCJjb2xvci1iZyBjb2xvci1mZzA1XCIsXG5cdC8vIFx0Ly8gXHR1c2VPcGFxdWU6IGZhbHNlLFxuXHQvLyBcdC8vIFx0bGFiZWxGbjogZnVuY3Rpb24oKSB7IHJldHVybiBcIjAlXCI7IH1cblx0Ly8gXHQvLyB9KTtcblx0Ly8gXHQvLyB0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMucHJvZ3Jlc3NXcmFwcGVyLmVsKTtcblx0Ly8gXHQvLyByZXR1cm4gdmlldztcblx0Ly8gXHRyZXR1cm4gbnVsbDtcblx0Ly8gfSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IENvbnRlbnRWaWV3OyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9EZWJ1Z1Rvb2xiYXJcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6Y29va2llcy1qc30gKi9cbnZhciBDb29raWVzID0gcmVxdWlyZShcImNvb2tpZXMtanNcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTptb2Rlcm5penJ9ICovXG4vLyB2YXIgTW9kZXJuaXpyID0gcmVxdWlyZShcIk1vZGVybml6clwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9Db250cm9sbGVyfSAqL1xuLy8gdmFyIGNvbnRyb2xsZXIgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvQ29udHJvbGxlclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuXG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIHZpZXdUZW1wbGF0ZSA9IHJlcXVpcmUoXCIuL3RlbXBsYXRlL0RlYnVnVG9vbGJhci5oYnNcIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgZ3JpZFRlbXBsYXRlID0gcmVxdWlyZShcIi4vdGVtcGxhdGUvRGVidWdUb29sYmFyLlNWR0dyaWQuaGJzXCIpO1xuXG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIHNpemVUZW1wbGF0ZSA9IF8udGVtcGxhdGUoXCI8JT0gdyAlPiBcXHUwMEQ3IDwlPSBoICU+XCIpO1xuXG4vLyB2YXIgYXBwU3RhdGVTeW1ib2xzID0geyB3aXRoQnVuZGxlOiBcImJcIiwgd2l0aE1lZGlhOiBcIm1cIiwgY29sbGFwc2VkOiBcImNcIn07XG4vLyB2YXIgYXBwU3RhdGVLZXlzID0gT2JqZWN0LmtleXMoYXBwU3RhdGVTeW1ib2xzKTtcblxudmFyIERlYnVnVG9vbGJhciA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNpZFByZWZpeDogXCJkZWJ1Z1Rvb2xiYXJcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0YWdOYW1lOiBcImRpdlwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJ0b29sYmFyXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGVtcGxhdGU6IHZpZXdUZW1wbGF0ZSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHByb3BlcnRpZXM6IHtcblx0XHRncmlkOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZ3JpZCB8fCAodGhpcy5fZ3JpZCA9IHRoaXMuY3JlYXRlR3JpZEVsZW1lbnQoKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRDb29raWVzLmRlZmF1bHRzID0ge1xuXHRcdFx0ZXhwaXJlczogbmV3IERhdGUoMHg3ZmZmZmZmZiAqIDFlMyksXG5cdFx0XHRkb21haW46IFN0cmluZyh3aW5kb3cubG9jYXRpb24pXG5cdFx0XHRcdC5tYXRjaCgvXmh0dHBzP1xcOlxcL1xcLyhbXlxcLzo/I10rKSg/OltcXC86PyNdfCQpL2kpWzFdXG5cdFx0fTtcblxuXHRcdHRoaXMuZWwuaW5uZXJIVE1MID0gdGhpcy50ZW1wbGF0ZSh7XG5cdFx0XHR0ZXN0czogTW9kZXJuaXpyLFxuXHRcdFx0bmF2aWdhdG9yOiB3aW5kb3cubmF2aWdhdG9yXG5cdFx0fSk7XG5cblx0XHQvKiB0b2dnbGUncyB0YXJnZXQ6IGNvbnRhaW5lclxuXHRcdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblx0XHR2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuYm9keTsgLy8ucXVlcnlTZWxlY3RvcihcIiNjb250YWluZXJcIik7XG5cblx0XHQvKiBjcmVhdGUvYXR0YWNoIHN2ZyBncmlkIGVsZW1lbnRcblx0XHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cdFx0Y29udGFpbmVyLmluc2VydEJlZm9yZSh0aGlzLmNyZWF0ZUdyaWRFbGVtZW50KCksIGNvbnRhaW5lci5maXJzdEVsZW1lbnRDaGlsZCk7XG5cblx0XHQvKiBpbmZvIGVsZW1lbnRzXG5cdFx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRcdHRoaXMuYmFja2VuZEVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI2VkaXQtYmFja2VuZCBhXCIpO1xuXHRcdHRoaXMubWVkaWFJbmZvRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjbWVkaWEtaW5mbyBzcGFuXCIpO1xuXHRcdHRoaXMuYXBwU3RhdGVFbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIiNhcHAtc3RhdGVcIik7XG5cblx0XHQvKiB0b2dnbGUgdmlzaWJpbGl0eVxuXHRcdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblx0XHR0aGlzLmluaXRpYWxpemVDbGFzc1RvZ2dsZShcInNob3ctbGlua3NcIiwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmRlYnVnLWxpbmtzICNsaW5rcy10b2dnbGVcIiksIHRoaXMuZWwsXG5cdFx0XHRmdW5jdGlvbihrZXksIHZhbHVlKSB7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcIm5vdC1cIiArIGtleSwgIXZhbHVlKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczppbml0aWFsaXplQ2xhc3NUb2dnbGU6W2NhbGxiYWNrXSAlb1wiLCB0aGlzLmNpZCwgYXJndW1lbnRzKTtcblx0XHRcdH1cblx0XHQpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNsYXNzVG9nZ2xlKFwic2hvdy10ZXN0c1wiLCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdG9nZ2xlLXRlc3RzIGFcIiksIHRoaXMuZWwpO1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNsYXNzVG9nZ2xlKFwiaGlkZS1wYXNzZWRcIiwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI3RvZ2dsZS1wYXNzZWRcIiksIHRoaXMuZWwpO1xuXG5cdFx0LyogdG9nZ2xlIGNvbnRhaW5lciBjbGFzc2VzXG5cdFx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRcdHRoaXMuaW5pdGlhbGl6ZUNsYXNzVG9nZ2xlKFwiZGVidWctZ3JpZC1iZ1wiLCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdG9nZ2xlLWdyaWQtYmcgYVwiKSwgZG9jdW1lbnQuYm9keSk7XG5cdFx0dGhpcy5pbml0aWFsaXplQ2xhc3NUb2dnbGUoXCJkZWJ1Zy1ibG9ja3NcIiwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI3RvZ2dsZS1ibG9ja3MgYVwiKSwgY29udGFpbmVyKTtcblx0XHR0aGlzLmluaXRpYWxpemVDbGFzc1RvZ2dsZShcImRlYnVnLW1kb3duXCIsIHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIiN0b2dnbGUtbWRvd24gYVwiKSwgY29udGFpbmVyKTtcblx0XHR0aGlzLmluaXRpYWxpemVDbGFzc1RvZ2dsZShcImRlYnVnLWxvZ3NcIiwgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiI3RvZ2dsZS1sb2dzIGFcIiksIGNvbnRhaW5lcik7XG5cdFx0dGhpcy5pbml0aWFsaXplQ2xhc3NUb2dnbGUoXCJkZWJ1Zy10eFwiLCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdG9nZ2xlLXR4IGFcIiksIGNvbnRhaW5lcixcblx0XHRcdGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwic2hvdy10eFwiLCB2YWx1ZSk7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcIm5vdC1zaG93LXR4XCIsICF2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0KTtcblxuXHRcdHRoaXMuaW5pdGlhbGl6ZVZpZXdwb3J0SW5mbygpO1xuXG5cdFx0Ly8gdGhpcy5pbml0aWFsaXplTGF5b3V0U2VsZWN0KCk7XG5cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlXCIsIHRoaXMuX29uTW9kZWxDaGFuZ2UpO1xuXHRcdHRoaXMuX29uTW9kZWxDaGFuZ2UoKTtcblx0fSxcblxuXHRpbml0aWFsaXplVmlld3BvcnRJbmZvOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdmlld3BvcnRJbmZvRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIjdmlld3BvcnQtaW5mbyBzcGFuXCIpO1xuXHRcdHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmlld3BvcnRJbmZvRWwudGV4dENvbnRlbnQgPSBzaXplVGVtcGxhdGUoeyB3OiB3aW5kb3cuaW5uZXJXaWR0aCwgaDogd2luZG93LmlubmVySGVpZ2h0IH0pO1xuXHRcdH07XG5cdFx0Y2FsbGJhY2suY2FsbCgpO1xuXHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIF8uZGVib3VuY2UoY2FsbGJhY2ssIDEwMCwgZmFsc2UsIGZhbHNlKSk7XG5cdH0sXG5cblx0aW5pdGlhbGl6ZVRvZ2dsZTogZnVuY3Rpb24oa2V5LCB0b2dnbGVFbCwgY2FsbGJhY2spIHtcblx0XHR2YXIgY3R4ID0gdGhpcztcblx0XHR2YXIgdG9nZ2xlVmFsdWUgPSBDb29raWVzLmdldChrZXkpID09PSBcInRydWVcIjtcblx0XHRjYWxsYmFjay5jYWxsKGN0eCwga2V5LCB0b2dnbGVWYWx1ZSk7XG5cblx0XHR0b2dnbGVFbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZXYpIHtcblx0XHRcdGlmIChldi5kZWZhdWx0UHJldmVudGVkKSByZXR1cm47XG5cdFx0XHRlbHNlIGV2LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0b2dnbGVWYWx1ZSA9ICF0b2dnbGVWYWx1ZTtcblx0XHRcdENvb2tpZXMuc2V0KGtleSwgdG9nZ2xlVmFsdWUgPyBcInRydWVcIiA6IFwiXCIpO1xuXHRcdFx0Y2FsbGJhY2suY2FsbChjdHgsIGtleSwgdG9nZ2xlVmFsdWUpO1xuXHRcdH0sIGZhbHNlKTtcblx0fSxcblxuXHRpbml0aWFsaXplQ2xhc3NUb2dnbGU6IGZ1bmN0aW9uKGtleSwgdG9nZ2xlRWwsIHRhcmdldEVsLCBjYWxsYmFjaykge1xuXHRcdHZhciBoYXNDYWxsYmFjayA9IF8uaXNGdW5jdGlvbihjYWxsYmFjayk7XG5cblx0XHR0aGlzLmluaXRpYWxpemVUb2dnbGUoa2V5LCB0b2dnbGVFbCwgZnVuY3Rpb24oa2V5LCB0b2dnbGVWYWx1ZSkge1xuXHRcdFx0dGFyZ2V0RWwuY2xhc3NMaXN0LnRvZ2dsZShrZXksIHRvZ2dsZVZhbHVlKTtcblx0XHRcdHRvZ2dsZUVsLmNsYXNzTGlzdC50b2dnbGUoXCJ0b2dnbGUtZW5hYmxlZFwiLCB0b2dnbGVWYWx1ZSk7XG5cdFx0XHR0b2dnbGVFbC5jbGFzc0xpc3QudG9nZ2xlKFwiY29sb3ItcmV2ZXJzZVwiLCB0b2dnbGVWYWx1ZSk7XG5cdFx0XHRoYXNDYWxsYmFjayAmJiBjYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdF9vbk1vZGVsQ2hhbmdlOiBmdW5jdGlvbigpIHtcblx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25Nb2RlbENoYW5nZSBjaGFuZ2VkQXR0cmlidXRlczogJW9cIiwgdGhpcy5jaWQsIHRoaXMubW9kZWwuY2hhbmdlZEF0dHJpYnV0ZXMoKSk7XG5cdFx0dmFyIGksIGlpLCBwcm9wLCBlbCwgZWxzID0gdGhpcy5hcHBTdGF0ZUVsLmNoaWxkcmVuO1xuXHRcdGZvciAoaSA9IDAsIGlpID0gZWxzLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdGVsID0gZWxzW2ldO1xuXHRcdFx0cHJvcCA9IGVsLmdldEF0dHJpYnV0ZShcImRhdGEtcHJvcFwiKTtcblx0XHRcdGVsLmNsYXNzTGlzdC50b2dnbGUoXCJoYXMtdmFsdWVcIiwgdGhpcy5tb2RlbC5nZXQocHJvcCkpO1xuXHRcdFx0ZWwuY2xhc3NMaXN0LnRvZ2dsZShcImhhcy1jaGFuZ2VkXCIsIHRoaXMubW9kZWwuaGFzQ2hhbmdlZChwcm9wKSk7XG5cdFx0XHRlbC5jbGFzc0xpc3QudG9nZ2xlKFwiY29sb3ItcmV2ZXJzZVwiLCB0aGlzLm1vZGVsLmhhc0NoYW5nZWQocHJvcCkpO1xuXHRcdH1cblxuXHRcdC8vIE5PVEU6IEFsd2F5cyBidXQgcmV3cml0ZSBDTVMgaHJlZi5cblx0XHQvLyBPbmx5IGNvbGxhcHNlZCBtYXkgaGF2ZSBjaGFuZ2VkLCBidXQgbm90IHdvcnRoIGFsbCB0aGUgbG9naWNcblx0XHR2YXIgYXR0clZhbCA9IEdsb2JhbHMuQVBQX1JPT1QgKyBcInN5bXBob255L1wiO1xuXHRcdHN3aXRjaCAodGhpcy5tb2RlbC5nZXQoXCJyb3V0ZU5hbWVcIikpIHtcblx0XHRcdGNhc2UgXCJhcnRpY2xlLWl0ZW1cIjpcblx0XHRcdFx0YXR0clZhbCArPSBcInB1Ymxpc2gvYXJ0aWNsZXMvZWRpdC9cIiArIHRoaXMubW9kZWwuZ2V0KFwiYXJ0aWNsZVwiKS5pZDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiYnVuZGxlLWl0ZW1cIjpcblx0XHRcdFx0YXR0clZhbCArPSBcInB1Ymxpc2gvYnVuZGxlcy9lZGl0L1wiICsgdGhpcy5tb2RlbC5nZXQoXCJidW5kbGVcIikuaWQ7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcIm1lZGlhLWl0ZW1cIjpcblx0XHRcdFx0YXR0clZhbCArPSBcInB1Ymxpc2gvbWVkaWEvZWRpdC9cIiArIHRoaXMubW9kZWwuZ2V0KFwibWVkaWFcIikuaWQ7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcInJvb3RcIjpcblx0XHRcdFx0YXR0clZhbCArPSBcInB1Ymxpc2gvYnVuZGxlc1wiO1xuXHRcdFx0XHRicmVhaztcblx0XHR9XG5cdFx0dGhpcy5iYWNrZW5kRWwuc2V0QXR0cmlidXRlKFwiaHJlZlwiLCBhdHRyVmFsKTtcblxuXHRcdGlmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJtZWRpYVwiKSkge1xuXHRcdFx0aWYgKHRoaXMubW9kZWwuaGFzKFwibWVkaWFcIikpIHtcblx0XHRcdFx0dGhpcy5tZWRpYUluZm9FbC50ZXh0Q29udGVudCA9IHNpemVUZW1wbGF0ZSh0aGlzLm1vZGVsLmdldChcIm1lZGlhXCIpLmdldChcInNvdXJjZVwiKS50b0pTT04oKSk7XG5cdFx0XHRcdHRoaXMubWVkaWFJbmZvRWwuc3R5bGUuZGlzcGxheSA9IFwiXCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLm1lZGlhSW5mb0VsLnRleHRDb250ZW50ID0gXCJcIjtcblx0XHRcdFx0dGhpcy5tZWRpYUluZm9FbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdGNyZWF0ZUdyaWRFbGVtZW50OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdGVsLmlkID0gXCJncmlkLXdyYXBwZXJcIjtcblx0XHRlbC5pbm5lckhUTUwgPSBncmlkVGVtcGxhdGUoKTtcblx0XHRyZXR1cm4gZWw7XG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBEZWJ1Z1Rvb2xiYXI7IiwiLyogZ2xvYmFsIE11dGF0aW9uT2JzZXJ2ZXIgKi9cbi8qKlxuLyogQG1vZHVsZSBhcHAvdmlldy9OYXZpZ2F0aW9uVmlld1xuLyovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vKiogQHR5cGUge21vZHVsZTpoYW1tZXJqc30gKi9cbnZhciBIYW1tZXIgPSByZXF1aXJlKFwiaGFtbWVyanNcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG52YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvVHJhbnNmb3JtSGVscGVyfSAqL1xudmFyIFRyYW5zZm9ybUhlbHBlciA9IHJlcXVpcmUoXCJ1dGlscy9UcmFuc2Zvcm1IZWxwZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1RvdWNoTWFuYWdlcn0gKi9cbnZhciBUb3VjaE1hbmFnZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9Ub3VjaE1hbmFnZXJcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0NvbnRyb2xsZXJ9ICovXG52YXIgY29udHJvbGxlciA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9Db250cm9sbGVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vVHlwZUNvbGxlY3Rpb259ICovXG52YXIgdHlwZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vVHlwZUNvbGxlY3Rpb25cIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvbn0gKi9cbnZhciBrZXl3b3JkcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9LZXl3b3JkQ29sbGVjdGlvblwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9jb2xsZWN0aW9uL0J1bmRsZUNvbGxlY3Rpb259ICovXG52YXIgYnVuZGxlcyA9IHJlcXVpcmUoXCJhcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9uXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb259ICovXG52YXIgYXJ0aWNsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQXJ0aWNsZUNvbGxlY3Rpb25cIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9GaWx0ZXJhYmxlTGlzdFZpZXd9ICovXG52YXIgRmlsdGVyYWJsZUxpc3RWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9GaWx0ZXJhYmxlTGlzdFZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvR3JvdXBpbmdMaXN0Vmlld30gKi9cbnZhciBHcm91cGluZ0xpc3RWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9Hcm91cGluZ0xpc3RWaWV3XCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0NvbGxlY3Rpb25QYWdlcn0gKi9cbi8vIHZhciBDb2xsZWN0aW9uUGFnZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0NvbGxlY3Rpb25QYWdlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9HcmFwaFZpZXd9ICovXG52YXIgR3JhcGhWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9HcmFwaFZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQXJ0aWNsZUJ1dHRvbn0gKi9cbnZhciBBcnRpY2xlQnV0dG9uID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9BcnRpY2xlQnV0dG9uXCIpO1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFByb3BlcnR5fSAqL1xuLy8gdmFyIHByZWZpeGVkUHJvcGVydHkgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRQcm9wZXJ0eVwiKTtcblxudmFyIHR4ID0gR2xvYmFscy50cmFuc2l0aW9ucztcblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvTmF2aWdhdGlvblZpZXd9XG4vKi9cbnZhciBOYXZpZ2F0aW9uVmlldyA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNpZFByZWZpeDogXCJuYXZpZ2F0aW9uVmlld1wiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImNvbnRhaW5lci1leHBhbmRlZFwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdF8uYmluZEFsbCh0aGlzLCBcIl9vblZQYW5TdGFydFwiLCBcIl9vblZQYW5Nb3ZlXCIsIFwiX29uVlBhbkZpbmFsXCIpO1xuXHRcdF8uYmluZEFsbCh0aGlzLCBcIl9vbkhQYW5TdGFydFwiLCBcIl9vbkhQYW5Nb3ZlXCIsIFwiX29uSFBhbkZpbmFsXCIpO1xuXHRcdF8uYmluZEFsbCh0aGlzLCBcIl93aGVuVHJhbnNpdGlvbnNFbmRcIiwgXCJfd2hlblRyYW5zaXRpb25zQWJvcnRcIik7XG5cdFx0Xy5iaW5kQWxsKHRoaXMsIFwiX29uTmF2aWdhdGlvbkNsaWNrXCIpO1xuXG5cdFx0Ly8gdGhpcy5fbWV0cmljcyA9IHtcblx0XHQvLyBcdG1pbkhlaWdodDogMFxuXHRcdC8vIH07XG5cdFx0dGhpcy5pdGVtVmlld3MgPSBbXTtcblx0XHR0aGlzLnRyYW5zZm9ybXMgPSBuZXcgVHJhbnNmb3JtSGVscGVyKCk7XG5cdFx0dGhpcy50b3VjaCA9IFRvdWNoTWFuYWdlci5nZXRJbnN0YW5jZSgpO1xuXG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZVwiLCB0aGlzLl9vbk1vZGVsQ2hhbmdlKTtcblxuXHRcdHRoaXMua2V5d29yZExpc3QgPSB0aGlzLmNyZWF0ZUtleXdvcmRMaXN0KCk7XG5cdFx0LyogTk9URTogLmxpc3QtZ3JvdXAgLmxhYmVsIG1vdmVzIGhvcml6b250YWxseSAoY2YuIHNhc3MvbGF5b3V0cy8qLnNjc3MpICovXG5cdFx0dGhpcy5oR3JvdXBpbmdzID0gdGhpcy5rZXl3b3JkTGlzdC5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLmxpc3QtZ3JvdXAgLmxhYmVsXCIpO1xuXHRcdHRoaXMudHJhbnNmb3Jtcy5hZGQodGhpcy5oR3JvdXBpbmdzLCB0aGlzLmtleXdvcmRMaXN0LmVsLCB0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpO1xuXHRcdHRoaXMuaXRlbVZpZXdzLnB1c2godGhpcy5rZXl3b3JkTGlzdCk7XG5cblx0XHR0aGlzLmJ1bmRsZUxpc3QgPSB0aGlzLmNyZWF0ZUJ1bmRsZUxpc3QoKTtcblx0XHR0aGlzLnRyYW5zZm9ybXMuYWRkKHRoaXMuYnVuZGxlTGlzdC5lbCwgdGhpcy5idW5kbGVMaXN0LndyYXBwZXIpO1xuXHRcdHRoaXMuaXRlbVZpZXdzLnB1c2godGhpcy5idW5kbGVMaXN0KTtcblxuXHRcdHRoaXMuc2l0ZW5hbWUgPSB0aGlzLmNyZWF0ZVNpdGVuYW1lQnV0dG9uKCk7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLmFkZCh0aGlzLnNpdGVuYW1lLndyYXBwZXIsIHRoaXMuc2l0ZW5hbWUuZWwpO1xuXHRcdC8vIHRoaXMudHJhbnNmb3Jtcy5hZGQodGhpcy5zaXRlbmFtZS5lbC5maXJzdEVsZW1lbnRDaGlsZCwgdGhpcy5zaXRlbmFtZS5lbCk7XG5cblx0XHR0aGlzLmFib3V0ID0gdGhpcy5jcmVhdGVBcnRpY2xlQnV0dG9uKGFydGljbGVzLmZpbmRXaGVyZSh7IGhhbmRsZTogXCJhYm91dFwiIH0pKTtcblx0XHR0aGlzLnRyYW5zZm9ybXMuYWRkKHRoaXMuYWJvdXQud3JhcHBlciwgdGhpcy5hYm91dC5lbCk7XG5cblx0XHR0aGlzLmdyYXBoID0gdGhpcy5jcmVhdGVHcmFwaFZpZXcodGhpcy5idW5kbGVMaXN0LCB0aGlzLmtleXdvcmRMaXN0KTtcblx0XHQvLyB0aGlzLnRyYW5zZm9ybXMuYWRkKHRoaXMuZ3JhcGguZWwpO1xuXHRcdC8vIHRoaXMuaXRlbVZpZXdzLnB1c2godGhpcy5ncmFwaCk7XG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLmdyYXBoLCB7XG5cdFx0Ly8gXHRcImNhbnZhczp1cGRhdGVcIjogdGhpcy5fb25HcmFwaFVwZGF0ZSxcblx0XHQvLyBcdFwiY2FudmFzOnJlZHJhd1wiOiB0aGlzLl9vbkdyYXBoUmVkcmF3LFxuXHRcdC8vIH0pO1xuXG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLmdyYXBoLCBcInZpZXc6cmVuZGVyOmJlZm9yZVwiLCBmdW5jdGlvbih2aWV3LCBmbGFncykge1xuXHRcdFx0dmFyIHZtYXg7XG5cdFx0XHRpZiAoZmxhZ3MgJiAoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3Lk1PREVMX0lOVkFMSUQpKSB7XG5cdFx0XHRcdC8vIGlmICgodGhpcy5idW5kbGVMaXN0LnJlbmRlckZsYWdzIHwgVmlldy5TSVpFX0lOVkFMSUQpIHx8XG5cdFx0XHRcdC8vIFx0KHRoaXMua2V5d29yZExpc3QucmVuZGVyRmxhZ3MgfCBWaWV3LlNJWkVfSU5WQUxJRCkpIHtcblx0XHRcdFx0Ly8gXHR2aWV3LmVsLnN0eWxlLmhlaWdodCA9IFwiXCI7XG5cdFx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHRcdHZtYXggPSBNYXRoLm1heChcblx0XHRcdFx0XHR0aGlzLmJ1bmRsZUxpc3QuX21ldHJpY3MuaGVpZ2h0LFxuXHRcdFx0XHRcdHRoaXMua2V5d29yZExpc3QuX21ldHJpY3MuaGVpZ2h0XG5cdFx0XHRcdCk7XG5cdFx0XHRcdGlmICh2bWF4KSB7XG5cdFx0XHRcdFx0dmlldy5lbC5zdHlsZS5oZWlnaHQgPSB2bWF4ICsgXCJweFwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIH1cblx0XHRcdFx0Y29uc29sZS5sb2coXCIlczolc1t2aWV3OnJlbmRlcjpiZWZvcmVdIFslc10gaDogJXMsICVzIG1heGg6ICVvXCIsXG5cdFx0XHRcdFx0dGhpcy5jaWQsIHZpZXcuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpLFxuXHRcdFx0XHRcdHRoaXMuYnVuZGxlTGlzdC5fbWV0cmljcy5oZWlnaHQsXG5cdFx0XHRcdFx0dGhpcy5rZXl3b3JkTGlzdC5fbWV0cmljcy5oZWlnaHQsXG5cdFx0XHRcdFx0dm1heCB8fCAnaW52YWxpZCcpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5idW5kbGVMaXN0LCBcInZpZXc6cmVuZGVyOmFmdGVyXCIsIGZ1bmN0aW9uKHZpZXcsIGZsYWdzKSB7XG5cdFx0Ly8gXHRjb25zb2xlLmluZm8oXCIlczpbdmlldzpyZW5kZXI6YWZ0ZXIgJXNdXCIsIHRoaXMuY2lkLCB2aWV3LmNpZCwgVmlldy5mbGFnc1RvU3RyaW5nKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpKTtcblx0XHQvLyBcdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHtcblx0XHQvLyBcdFx0XHQvLyBjb25zb2xlLmluZm8oXCIlczpbJXMgdmlldzpyZW5kZXI6YWZ0ZXJdIGJ1bmRsZUxpc3QgaGVpZ2h0XCIsIHRoaXMuY2lkLCB2aWV3LmNpZCwgdGhpcy5idW5kbGVMaXN0LmVsLnN0eWxlLmhlaWdodCk7XG5cdFx0Ly8gXHRcdFx0Ly8gdGhpcy5ncmFwaC5lbC5zdHlsZS5oZWlnaHQgPSB0aGlzLmJ1bmRsZUxpc3QuZWwuc3R5bGUuaGVpZ2h0O1xuXHRcdC8vIFx0XHRcdHRoaXMuZ3JhcGguZWwuc3R5bGUub3BhY2l0eSA9IHRoaXMuYnVuZGxlTGlzdC5jb2xsYXBzZWQ/IDAgOiAxO1xuXHRcdC8vIFx0XHRcdHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCkucmVuZGVyTm93KCk7XG5cdFx0Ly8gXHQvLyBcdH1cblx0XHQvLyB9KTtcblx0XHQvLyB0aGlzLmxpc3RlblRvKHRoaXMuYnVuZGxlTGlzdCwgXCJ2aWV3OnJlbmRlcjphZnRlclwiLCB0aGlzLl9vbkxpc3RSZXNpemUpO1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5rZXl3b3JkTGlzdCwgXCJ2aWV3OnJlbmRlcjphZnRlclwiLCB0aGlzLl9vbkxpc3RSZXNpemUpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZW5kZXJGcmFtZTogZnVuY3Rpb24odHN0YW1wLCBmbGFncykge1xuXHRcdGlmIChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkge1xuXHRcdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJjb250YWluZXItY29sbGFwc2VkXCIsIHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKTtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY29udGFpbmVyLWV4cGFuZGVkXCIsICF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiY29sbGFwc2VkXCIpXG5cdFx0XHRcdHx8IHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwiY29udGFpbmVyLWNoYW5naW5nXCIpO1xuXHRcdFx0fVxuXHRcdFx0Ly8gaWYgKHRoaXMuYnVuZGxlTGlzdC5pbnZhbGlkYXRlZCkge1xuXHRcdFx0Ly8gXHR0aGlzLmJ1bmRsZUxpc3QuaW52YWxpZGF0ZShWaWV3LlNJWkVfSU5WQUxJRCk7XG5cdFx0XHQvLyB9XG5cdFx0XHQvLyBpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiYnVuZGxlXCIpKSB7XG5cdFx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwicm91dGVOYW1lXCIpKSB7XG5cdFx0XHRcdHRoaXMuYnVuZGxlTGlzdC5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCk7XG5cdFx0XHRcdHRoaXMua2V5d29yZExpc3QucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIHRyYW5zZm9ybXNcblx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHRpZiAodGhpcy5za2lwVHJhbnNpdGlvbnMgfHxcblx0XHRcdChmbGFncyAmIChWaWV3Lk1PREVMX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpKSkge1xuXHRcdFx0Ly8gaWYgKHRyYW5zZm9ybXNDaGFuZ2VkKSB7XG5cdFx0XHRpZiAodGhpcy5za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnN0b3BBbGxUcmFuc2l0aW9ucygpO1xuXHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLmNsZWFyQWxsT2Zmc2V0cygpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5yZW5kZXJUcmFuc2l0aW9ucyhmbGFncyk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OnJlbmRlckZyYW1lICVvXCIsIHRoaXMuY2lkLFxuXHRcdFx0Ly8gXHR0aGlzLnRyYW5zZm9ybXMuaXRlbXMubWFwKGZ1bmN0aW9uKG8pIHtcblx0XHRcdC8vIFx0XHRyZXR1cm4gW28uaGFzVHJhbnNpdGlvbiwgby5lbC5sb2NhbE5hbWUsIG8uZWwuaWQgfHwgby5lbC5jbGFzc05hbWVdLmpvaW4oXCIgOiBcIik7XG5cdFx0XHQvLyBcdH0pXG5cdFx0XHQvLyApO1xuXHRcdH1cblxuXHRcdGlmIChmbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkge1xuXHRcdFx0Ly8gaWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0Ly9pZiAoKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImNvbGxhcHNlZFwiKSAmJiAhdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpIHx8ICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoQnVuZGxlXCIpICYmICF0aGlzLm1vZGVsLmdldChcIndpdGhCdW5kbGVcIikpKSB7XG5cdFx0XHRpZiAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiY29sbGFwc2VkXCIpXG5cdFx0XHRcdHx8IHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhCdW5kbGVcIilcblx0XHRcdFx0fHwgdGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwid2l0aEFydGljbGVcIikpIHtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnByb21pc2UoKS50aGVuKHRoaXMuX3doZW5UcmFuc2l0aW9uc0VuZCwgdGhpcy5fd2hlblRyYW5zaXRpb25zQWJvcnQpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIGNoaWxkcmVuIGxvb3Bcblx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHR0aGlzLml0ZW1WaWV3cy5mb3JFYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdHZpZXcuc2tpcFRyYW5zaXRpb25zID0gdmlldy5za2lwVHJhbnNpdGlvbnMgfHwgdGhpcy5za2lwVHJhbnNpdGlvbnM7XG5cdFx0XHRpZiAoZmxhZ3MgJiBWaWV3LlNJWkVfSU5WQUxJRCkge1xuXHRcdFx0XHR2aWV3LnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCF2aWV3LnNraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0XHR2aWV3LnJlbmRlck5vdygpO1xuXHRcdFx0fVxuXHRcdH0sIHRoaXMpO1xuXG5cdFx0Ly8gaWYgKChmbGFncyAmIFZpZXcuU0laRV9JTlZBTElEKSB8fCAodGhpcy5tb2RlbC5oYXNDaGFuZ2VkKFwiY29sbGFwc2VkXCIpICYmIChmbGFncyB8IFZpZXcuTU9ERUxfSU5WQUxJRCkpKSB7XG5cdFx0Ly8gXHQvLyBpZiAodGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHQvLyBcdC8vIFx0dGhpcy5lbC5zdHlsZS5taW5IZWlnaHQgPSBcIlwiO1xuXHRcdC8vIFx0Ly8gfSBlbHNlIHtcblx0XHRQcm9taXNlLmFsbChbXG5cdFx0XHR0aGlzLmJ1bmRsZUxpc3Qud2hlblJlbmRlcmVkKCksXG5cdFx0XHR0aGlzLmtleXdvcmRMaXN0LndoZW5SZW5kZXJlZCgpXG5cdFx0XSkudGhlbigoZnVuY3Rpb24oYXJyKSB7XG5cdFx0XHR2YXIgdm1heCA9IGFyci5yZWR1Y2UoZnVuY3Rpb24oYSwgbykge1xuXHRcdFx0XHRyZXR1cm4gTWF0aC5tYXgoYSwgby5fbWV0cmljcy5oZWlnaHQpO1xuXHRcdFx0fSwgMCk7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOlt3aGVuUmVuZGVyZWQgZmxhZ3M6ICVzXSBoZWlnaHQ6ICVvXCIsXG5cdFx0XHRcdHRoaXMuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpLCB2bWF4KTtcblx0XHRcdC8vIGlmICh2bWF4ICE9PSB0aGlzLl9tZXRyaWNzLm1pbkhlaWdodCkge1xuXHRcdFx0Ly8gXHR0aGlzLl9tZXRyaWNzLm1pbkhlaWdodCA9IHZtYXg7XG5cdFx0XHQvLyB0aGlzLmVsLnN0eWxlLm1pbkhlaWdodCA9IHZtYXggKyBcInB4XCI7XG5cdFx0XHQvLyB9XG5cdFx0XHR0aGlzLmdyYXBoLmVsLnN0eWxlLmhlaWdodCA9IHZtYXggKyBcInB4XCI7XG5cdFx0XHR0aGlzLmVsLnN0eWxlLm1pbkhlaWdodCA9IHZtYXggKyBcInB4XCI7XG5cdFx0XHQvLyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA9IDA7XG5cdFx0XHQvLyB3aW5kb3cuc2Nyb2xsVG8oMCwgMSlcblx0XHRcdC8vIHRoaXMucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGZ1bmN0aW9uKCkge1xuXHRcdFx0Ly8gXHR3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG5cdFx0XHQvLyB9KTtcblx0XHR9KS5iaW5kKHRoaXMpKTtcblx0XHQvLyBcdC8vIH1cblx0XHQvLyB9XG5cblx0XHQvLyBncmFwaFxuXHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdC8qIGNvbGxhcHNlZCBoYXMgbm90IGNoYW5nZWQsIG5vIGJ1bmRsZSBzZWxlY3RlZCAqL1xuXHRcdGlmICgoZmxhZ3MgJiAoVmlldy5TSVpFX0lOVkFMSUQgfCB+Vmlldy5NT0RFTF9JTlZBTElEKSlcblx0XHRcdCYmICF0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJjb2xsYXBzZWRcIilcblx0XHRcdCYmICF0aGlzLm1vZGVsLmdldChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdHRoaXMuZ3JhcGgucmVxdWVzdFJlbmRlcihWaWV3LlNJWkVfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHRcdFx0aWYgKCF0aGlzLnNraXBUcmFuc2l0aW9ucykge1xuXHRcdFx0XHR0aGlzLmdyYXBoLnJlbmRlck5vdygpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHQvKiBOYXZpZ2F0aW9uVmlldyBoYXMgcmVzaXplZCB3aGlsZSB1bmNvbGxhcHNlZCxcblx0XHQgICBidXQgbW9kZWwgaXMgdW5jaGFuZ2VkICovXG5cdFx0ZWxzZSBpZiAoKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpICYmICF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0Ly8gY29uc29sZS5pbmZvKFwiJXM6OnJlbmRlckZyYW1lXCIsIHRoaXMuY2lkLCBcIk5hdmlnYXRpb25WaWV3IGhhcyByZXNpemVkXCIpO1xuXHRcdFx0dGhpcy5ncmFwaC5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCk7XG5cdFx0fVxuXHRcdHRoaXMuc2tpcFRyYW5zaXRpb25zID0gZmFsc2U7XG5cdH0sXG5cblx0X3doZW5UcmFuc2l0aW9uc0VuZDogZnVuY3Rpb24ocmVzdWx0KSB7XG5cdFx0Y29uc29sZS5pbmZvKFwiJXM6Ol93aGVuVHJhbnNpdGlvbnNFbmRcIiwgdGhpcy5jaWQpO1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbnRhaW5lci1jaGFuZ2luZ1wiKTtcblx0XHRpZiAoR2xvYmFscy5CUkVBS1BPSU5UU1tcImRlc2t0b3Atc21hbGxcIl0ubWF0Y2hlc1xuXHRcdFx0fHwgIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHR0aGlzLmdyYXBoLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3LkxBWU9VVF9JTlZBTElEKS5yZW5kZXJOb3coKTtcblx0XHR9XG5cdH0sXG5cblx0X3doZW5UcmFuc2l0aW9uc0Fib3J0OiBmdW5jdGlvbihyZWFzb24pIHtcblx0XHRjb25zb2xlLndhcm4oXCIlczo6X3doZW5UcmFuc2l0aW9uc0Fib3J0ICVvXCIsIHRoaXMuY2lkLCByZWFzb24pO1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbnRhaW5lci1jaGFuZ2luZ1wiKTtcblx0XHRpZiAoR2xvYmFscy5CUkVBS1BPSU5UU1tcImRlc2t0b3Atc21hbGxcIl0ubWF0Y2hlc1xuXHRcdFx0fHwgIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHR0aGlzLmdyYXBoLnJlcXVlc3RSZW5kZXIoVmlldy5TSVpFX0lOVkFMSUQgfCBWaWV3LkxBWU9VVF9JTlZBTElEKS5yZW5kZXJOb3coKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiByZW5kZXJUcmFuc2l0aW9uc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cmVuZGVyVHJhbnNpdGlvbnM6IGZ1bmN0aW9uKGZsYWdzKSB7XG5cdFx0dmFyIGZyb21Sb3V0ZSA9IHRoaXMubW9kZWwucHJldmlvdXMoXCJyb3V0ZU5hbWVcIik7XG5cdFx0dmFyIHRvUm91dGUgPSB0aGlzLm1vZGVsLmdldChcInJvdXRlTmFtZVwiKTtcblxuXHRcdHZhciBtb2RlbENoYW5nZWQgPSAoZmxhZ3MgJiBWaWV3Lk1PREVMX0lOVkFMSUQpO1xuXHRcdC8qIGJ1bmRsZSAqL1xuXHRcdHZhciB3aXRoQnVuZGxlID0gdGhpcy5tb2RlbC5nZXQoXCJ3aXRoQnVuZGxlXCIpO1xuXHRcdHZhciB3aXRoQnVuZGxlQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoQnVuZGxlXCIpO1xuXHRcdHZhciBidW5kbGVDaGFuZ2VkID0gbW9kZWxDaGFuZ2VkICYmIHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcImJ1bmRsZVwiKTtcblx0XHQvKiBtZWRpYSAqL1xuXHRcdHZhciB3aXRoTWVkaWEgPSB0aGlzLm1vZGVsLmdldChcIndpdGhNZWRpYVwiKTtcblx0XHR2YXIgd2l0aE1lZGlhQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoTWVkaWFcIik7XG5cdFx0Ly92YXIgbWVkaWFDaGFuZ2VkID0gbW9kZWxDaGFuZ2VkICYmIHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIm1lZGlhXCIpO1xuXHRcdC8qIGNvbGxhcHNlZCAqL1xuXHRcdHZhciBjb2xsYXBzZWQgPSB0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKTtcblx0XHR2YXIgY29sbGFwc2VkQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJjb2xsYXBzZWRcIik7XG5cdFx0LyogYXJ0aWNsZSAqL1xuXHRcdC8vIHZhciB3aXRoQXJ0aWNsZSA9IHRoaXMubW9kZWwuZ2V0KFwid2l0aEFydGljbGVcIik7XG5cdFx0dmFyIHdpdGhBcnRpY2xlQ2hhbmdlZCA9IG1vZGVsQ2hhbmdlZCAmJiB0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJ3aXRoQXJ0aWNsZVwiKTtcblxuXHRcdHZhciB0Zjtcblx0XHQvKiB0aGlzLmJ1bmRsZUxpc3QuZWwgKi9cblx0XHR0ZiA9IHRoaXMudHJhbnNmb3Jtcy5nZXQodGhpcy5idW5kbGVMaXN0LmVsKTtcblx0XHRpZiAodGYuaGFzT2Zmc2V0KSB7XG5cdFx0XHR0Zi5ydW5UcmFuc2l0aW9uKGNvbGxhcHNlZENoYW5nZWQgPyB0eC5CRVRXRUVOIDogdHguTk9XKTtcblx0XHR9XG5cdFx0LyogdGhpcy5rZXl3b3JkTGlzdC5lbCAqL1xuXHRcdHRmID0gdGhpcy50cmFuc2Zvcm1zLmdldCh0aGlzLmtleXdvcmRMaXN0LmVsKTtcblx0XHRpZiAodGYuaGFzT2Zmc2V0KSB7XG5cdFx0XHR0Zi5ydW5UcmFuc2l0aW9uKGNvbGxhcHNlZENoYW5nZWQgPyB0eC5CRVRXRUVOIDogdHguTk9XKTtcblx0XHR9XG5cdFx0LyogdGhpcy5ncmFwaC5lbCAqL1xuXHRcdHRmID0gdGhpcy50cmFuc2Zvcm1zLmdldCh0aGlzLmdyYXBoLmVsKTtcblx0XHRpZiAodGYgJiYgdGYuaGFzT2Zmc2V0KSB7XG5cdFx0XHR0Zi5ydW5UcmFuc2l0aW9uKGNvbGxhcHNlZENoYW5nZWQgPyB0eC5CRVRXRUVOIDogdHguTk9XKTtcblx0XHRcdHRmLmNsZWFyT2Zmc2V0KCk7XG5cdFx0fVxuXG5cdFx0Lypcblx0XHQgKiBOT1RFOlxuXHRcdCAqIFZlcnRpY2FsOlxuXHRcdCAqXHRcdHNpdGUtbmFtZS13cmFwcGVyLFxuXHRcdCAqXHRcdGFydGljbGUtbGlzdC13cmFwcGVyXG5cdFx0ICogSG9yaXpvbnRhbDpcblx0XHQgKlx0XHRzaXRlLW5hbWUsXG5cdFx0ICpcdFx0YXJ0aWNsZS1idXR0b25zLFxuXHRcdCAqXHRcdGtleXdvcmRMaXN0LndyYXBwZXIsXG5cdFx0ICpcdFx0YnVuZGxlTGlzdC53cmFwcGVyLFxuXHRcdCAqXHRcdGhHcm91cGluZ3Ncblx0XHQgKi9cblx0XHRpZiAoR2xvYmFscy5CUkVBS1BPSU5UU1tcImRlc2t0b3Atc21hbGxcIl0ubWF0Y2hlcykge1xuXHRcdFx0LyogSE9SSVpPTlRBTCAqL1xuXHRcdFx0dGYgPSB0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcik7XG5cdFx0XHRpZiAoY29sbGFwc2VkQ2hhbmdlZCAmJiAhd2l0aEFydGljbGVDaGFuZ2VkKSB7XG5cdFx0XHRcdC8vIGlmIChjb2xsYXBzZWRDaGFuZ2VkKSB7XG5cdFx0XHRcdGlmICh3aXRoQnVuZGxlQ2hhbmdlZCkge1xuXHRcdFx0XHRcdGlmICh3aXRoTWVkaWFDaGFuZ2VkKVxuXHRcdFx0XHRcdFx0dGYucnVuVHJhbnNpdGlvbih3aXRoQnVuZGxlID8gdHguTEFTVCA6IHR4LkZJUlNUKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAod2l0aE1lZGlhKVxuXHRcdFx0XHRcdFx0dGYucnVuVHJhbnNpdGlvbihjb2xsYXBzZWQgPyB0eC5MQVNUIDogdHguRklSU1QpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoIXdpdGhCdW5kbGVDaGFuZ2VkICYmIHdpdGhNZWRpYUNoYW5nZWQpXG5cdFx0XHRcdFx0dGYucnVuVHJhbnNpdGlvbihidW5kbGVDaGFuZ2VkID8gdHguQkVUV0VFTiA6IHR4Lk5PVyk7XG5cdFx0XHR9XG5cdFx0XHRpZiAoY29sbGFwc2VkQ2hhbmdlZCBeIHdpdGhBcnRpY2xlQ2hhbmdlZCkge1xuXHRcdFx0XHR0aGlzLnRyYW5zZm9ybXMucnVuVHJhbnNpdGlvbihjb2xsYXBzZWQgPyB0eC5MQVNUIDogdHguRklSU1QsXG5cdFx0XHRcdFx0dGhpcy5zaXRlbmFtZS5lbCwgdGhpcy5hYm91dC5lbCwgdGhpcy5idW5kbGVMaXN0LndyYXBwZXIsIHRoaXMuaEdyb3VwaW5ncyk7XG5cdFx0XHR9XG5cdFx0XHQvKiBWRVJUSUNBTCAqL1xuXHRcdFx0aWYgKGZyb21Sb3V0ZSA9PSAncm9vdCcgfHwgdG9Sb3V0ZSA9PSAncm9vdCcpIHtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnJ1blRyYW5zaXRpb24odHguQkVUV0VFTixcblx0XHRcdFx0XHR0aGlzLnNpdGVuYW1lLndyYXBwZXIsIHRoaXMuYWJvdXQud3JhcHBlcik7XG5cdFx0XHR9XG5cdFx0XHQvKiB0aGlzLmhHcm91cGluZ3MgKi9cblx0XHRcdC8vIGlmIChjb2xsYXBzZWRDaGFuZ2VkIF4gd2l0aEFydGljbGVDaGFuZ2VkKSB7XG5cdFx0XHQvLyBcdC8vIGlmIChjb2xsYXBzZWRDaGFuZ2VkICYmICF3aXRoQXJ0aWNsZUNoYW5nZWQpIHtcblx0XHRcdC8vIFx0dGhpcy50cmFuc2Zvcm1zLnJ1blRyYW5zaXRpb24oY29sbGFwc2VkID8gdHguTEFTVCA6IHR4LkZJUlNULCB0aGlzLmhHcm91cGluZ3MpO1xuXHRcdFx0Ly8gfVxuXHRcdFx0Ly8gaWYgKGNvbGxhcHNlZENoYW5nZWQpIHtcblx0XHRcdC8vIFx0aWYgKCF3aXRoQXJ0aWNsZUNoYW5nZWQpIHtcblx0XHRcdC8vIFx0XHQvLyBpZiAoZnJvbVJvdXRlID09ICdyb290JyB8fCB0b1JvdXRlID09ICdyb290Jykge1xuXHRcdFx0Ly8gXHRcdHRoaXMudHJhbnNmb3Jtcy5ydW5UcmFuc2l0aW9uKGNvbGxhcHNlZCA/IHR4LkxBU1QgOiB0eC5GSVJTVCwgdGhpcy5idW5kbGVMaXN0LndyYXBwZXIpO1xuXHRcdFx0Ly8gXHR9XG5cdFx0XHQvLyB9IGVsc2Uge1xuXHRcdFx0Ly8gXHRpZiAod2l0aEFydGljbGVDaGFuZ2VkICYmIHdpdGhCdW5kbGVDaGFuZ2VkKSB7XG5cdFx0XHQvLyBcdFx0dGhpcy50cmFuc2Zvcm1zLnJ1blRyYW5zaXRpb24od2l0aEFydGljbGUgPyB0eC5CRVRXRUVOIDogdHguTEFTVCwgdGhpcy5idW5kbGVMaXN0LndyYXBwZXIpO1xuXHRcdFx0Ly8gXHR9XG5cdFx0XHQvLyB9XG5cdFx0fSBlbHNlIGlmIChHbG9iYWxzLkJSRUFLUE9JTlRTW1wiZnVsbHdpZHRoXCJdLm1hdGNoZXMpIHtcblx0XHRcdC8vIGlmIChjb2xsYXBzZWRDaGFuZ2VkICkge1xuXHRcdFx0aWYgKGNvbGxhcHNlZENoYW5nZWQgXiB3aXRoQXJ0aWNsZUNoYW5nZWQpIHtcblx0XHRcdFx0dGhpcy50cmFuc2Zvcm1zLnJ1blRyYW5zaXRpb24odHguQkVUV0VFTixcblx0XHRcdFx0XHR0aGlzLnNpdGVuYW1lLmVsLCB0aGlzLmFib3V0LmVsKTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKHdpdGhCdW5kbGVDaGFuZ2VkKSB7XG5cdFx0XHRcdHRoaXMudHJhbnNmb3Jtcy5ydW5UcmFuc2l0aW9uKHR4LkJFVFdFRU4sXG5cdFx0XHRcdFx0dGhpcy5zaXRlbmFtZS5lbCwgdGhpcy5hYm91dC5lbCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMudHJhbnNmb3Jtcy5jbGVhck9mZnNldCh0aGlzLmJ1bmRsZUxpc3QuZWwsIHRoaXMua2V5d29yZExpc3QuZWwsXG5cdFx0XHR0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIG93biBtb2RlbCBjaGFuZ2VkXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vbk1vZGVsQ2hhbmdlOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5NT0RFTF9JTlZBTElEKTtcblx0XHQvLyBrZXl3b3Jkcy5kZXNlbGVjdCgpO1xuXHRcdGlmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHRcdGlmICh0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0XHQvLyBjbGVhciBrZXl3b3JkIHNlbGVjdGlvblxuXHRcdFx0XHRrZXl3b3Jkcy5kZXNlbGVjdCgpO1xuXHRcdFx0XHQvLyB0aGlzLnRvdWNoLm9uKFwidGFwXCIsIHRoaXMuX29uTmF2aWdhdGlvbkNsaWNrKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIHRoaXMudG91Y2gub2ZmKFwidGFwXCIsIHRoaXMuX29uTmF2aWdhdGlvbkNsaWNrKTtcblx0XHRcdH1cblx0XHRcdHRoaXMua2V5d29yZExpc3QuY29sbGFwc2VkID0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdFx0XHR0aGlzLmJ1bmRsZUxpc3QuY29sbGFwc2VkID0gdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIik7XG5cdFx0fVxuXHRcdGlmICh0aGlzLm1vZGVsLmhhc0NoYW5nZWQoXCJidW5kbGVcIikpIHtcblx0XHRcdHRoaXMuYnVuZGxlTGlzdC5zZWxlY3RlZEl0ZW0gPSB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKTtcblx0XHRcdHRoaXMua2V5d29yZExpc3QucmVmcmVzaCgpO1xuXHRcdFx0Ly8ga2V5d29yZHMuZGVzZWxlY3QoKTtcblx0XHRcdC8vIHRoaXMuZ3JhcGggJiYgdGhpcy5ncmFwaC5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMubW9kZWwuaGFzQ2hhbmdlZChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdC8vIHRoaXMua2V5d29yZExpc3QucmVmcmVzaCgpXG5cdFx0XHRpZiAodGhpcy5tb2RlbC5nZXQoXCJ3aXRoQnVuZGxlXCIpKSB7XG5cdFx0XHRcdHRoaXMudG91Y2gub24oXCJ2cGFuc3RhcnRcIiwgdGhpcy5fb25WUGFuU3RhcnQpO1xuXHRcdFx0XHR0aGlzLnRvdWNoLm9uKFwiaHBhbnN0YXJ0XCIsIHRoaXMuX29uSFBhblN0YXJ0KTtcblx0XHRcdFx0Ly8gdGhpcy50b3VjaC5vbihcInRhcFwiLCB0aGlzLl9vblRhcCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnRvdWNoLm9mZihcInZwYW5zdGFydFwiLCB0aGlzLl9vblZQYW5TdGFydCk7XG5cdFx0XHRcdHRoaXMudG91Y2gub2ZmKFwiaHBhbnN0YXJ0XCIsIHRoaXMuX29uSFBhblN0YXJ0KTtcblx0XHRcdFx0a2V5d29yZHMuZGVzZWxlY3QoKTtcblx0XHRcdFx0Ly8gdGhpcy50b3VjaC5vZmYoXCJ0YXBcIiwgdGhpcy5fb25UYXApO1xuXHRcdFx0fVxuXHRcdFx0Ly8gdGhpcy5ncmFwaC52YWx1ZVRvKClcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0Lyoga2V5d29yZCBjb2xsZWN0aW9uIGNoYW5nZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uS2V5d29yZFNlbGVjdDogZnVuY3Rpb24oa2V5d29yZCkge1xuXHRcdC8vIHVzZSBjb2xsZWN0aW9uIGxpc3RlbmVyIHRvIGF2b2lkIHJlZHVuZGFudCByZWZyZXNoIGNhbGxzXG5cdFx0dGhpcy5idW5kbGVMaXN0LnJlZnJlc2goKTtcblx0XHRpZiAoIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpICYmIHRoaXMuZ3JhcGgpIHtcblx0XHRcdHRoaXMubGlzdGVuVG9PbmNlKHRoaXMuYnVuZGxlTGlzdCwgXCJ2aWV3OnJlbmRlcjphZnRlclwiLCBmdW5jdGlvbih2aWV3LCBmbGFncykge1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25LZXl3b3JkU2VsZWN0IC0+ICVzOlt2aWV3OnJlbmRlcjphZnRlcl0gZmxhZ3M6JXNcIiwgdGhpcy5jaWQsIHZpZXcuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpKTtcblx0XHRcdFx0dGhpcy5ncmFwaC52YWx1ZVRvKDAsIDAsIFwiYW1vdW50XCIpO1xuXHRcdFx0XHQvLyB0aGlzLmdyYXBoLnJlbmRlck5vdygpO1xuXHRcdFx0XHR0aGlzLmdyYXBoLnZhbHVlVG8oMSwgR2xvYmFscy5UUkFOU0lUSU9OX0RVUkFUSU9OLCBcImFtb3VudFwiKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBVSSBFdmVudHM6IGJ1bmRsZUxpc3Qga2V5d29yZExpc3QgYnV0dG9uc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25OYXZpZ2F0aW9uQ2xpY2s6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy5fY2hhbmdlQ29sbGFwc2VkKGZhbHNlKTtcblx0fSxcblxuXHRfb25BcnRpY2xlQ2xpY2s6IGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRzd2l0Y2ggKHRoaXMubW9kZWwuZ2V0KFwicm91dGVOYW1lXCIpKSB7XG5cdFx0XHRjYXNlIFwiYXJ0aWNsZS1pdGVtXCI6XG5cdFx0XHRcdGNvbnRyb2xsZXIuZGVzZWxlY3RBcnRpY2xlKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcInJvb3RcIjpcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdGNvbnRyb2xsZXIuc2VsZWN0QXJ0aWNsZShpdGVtKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9LFxuXG5cdF9vblNpdGVuYW1lQ2xpY2s6IGZ1bmN0aW9uKCkge1xuXHRcdHN3aXRjaCAodGhpcy5tb2RlbC5nZXQoXCJyb3V0ZU5hbWVcIikpIHtcblx0XHRcdGNhc2UgXCJtZWRpYS1pdGVtXCI6XG5cdFx0XHRjYXNlIFwiYnVuZGxlLWl0ZW1cIjpcblx0XHRcdFx0aWYgKHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHRcdFx0dGhpcy5fY2hhbmdlQ29sbGFwc2VkKGZhbHNlKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRjb250cm9sbGVyLmRlc2VsZWN0QnVuZGxlKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiYXJ0aWNsZS1pdGVtXCI6XG5cdFx0XHRcdGNvbnRyb2xsZXIuZGVzZWxlY3RBcnRpY2xlKCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSxcblxuXHRfb25CdW5kbGVMaXN0U2FtZTogZnVuY3Rpb24oYnVuZGxlKSB7XG5cdFx0dGhpcy5fY2hhbmdlQ29sbGFwc2VkKCF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSk7XG5cdH0sXG5cblx0X29uS2V5d29yZExpc3RDaGFuZ2U6IGZ1bmN0aW9uKGtleXdvcmQpIHtcblx0XHRpZiAoIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHRrZXl3b3Jkcy5zZWxlY3Qoa2V5d29yZCk7XG5cdFx0fVxuXHR9LFxuXG5cdF9jaGFuZ2VDb2xsYXBzZWQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0aWYgKHZhbHVlICE9PSB0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSkge1xuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLm9mZnNldCgwLCAxLCB0aGlzLmdyYXBoLmVsKTtcblx0XHRcdHRoaXMudHJhbnNmb3Jtcy52YWxpZGF0ZSgpO1xuXHRcdFx0dGhpcy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9jaGFuZ2VDb2xsYXBzZWRcIiwgdGhpcy5jaWQpO1xuXHRcdFx0XHR0aGlzLm1vZGVsLnNldChcImNvbGxhcHNlZFwiLCAhdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogSG9yaXpvbnRhbCB0b3VjaC9tb3ZlIChIYW1tZXJKUylcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vbkhQYW5TdGFydDogZnVuY3Rpb24oZXYpIHtcblx0XHR0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcilcblx0XHRcdC5zdG9wVHJhbnNpdGlvbigpXG5cdFx0XHQuY2xlYXJPZmZzZXQoKVxuXHRcdFx0LnZhbGlkYXRlKCk7XG5cdFx0Ly8gaWYgKHRoaXMubW9kZWwuZ2V0KFwibGF5b3V0TmFtZVwiKSAhPSBcImxlZnQtbGF5b3V0XCJcblx0XHQvLyBcdCYmIHRoaXMubW9kZWwuZ2V0KFwibGF5b3V0TmFtZVwiKSAhPSBcImRlZmF1bHQtbGF5b3V0XCIpIHtcblx0XHQvLyBcdHJldHVybjtcblx0XHQvLyB9XG5cdFx0aWYgKEdsb2JhbHMuQlJFQUtQT0lOVFNbXCJkZXNrdG9wLXNtYWxsXCJdLm1hdGNoZXNcblx0XHRcdCYmIHRoaXMubW9kZWwuZ2V0KFwiYnVuZGxlXCIpLmdldChcIm1lZGlhXCIpLnNlbGVjdGVkSW5kZXggPD0gMFxuXHRcdFx0JiYgdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpIHtcblx0XHRcdHRoaXMudHJhbnNmb3Jtcy5nZXQodGhpcy5rZXl3b3JkTGlzdC53cmFwcGVyKS5jbGVhckNhcHR1cmUoKTtcblx0XHRcdHRoaXMuX29uSFBhbk1vdmUoZXYpO1xuXG5cdFx0XHR0aGlzLnRvdWNoLm9uKFwiaHBhbm1vdmVcIiwgdGhpcy5fb25IUGFuTW92ZSk7XG5cdFx0XHR0aGlzLnRvdWNoLm9uKFwiaHBhbmVuZCBocGFuY2FuY2VsXCIsIHRoaXMuX29uSFBhbkZpbmFsKTtcblx0XHR9XG5cdH0sXG5cblx0X29uSFBhbk1vdmU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0Ly8gdmFyIEhQQU5fRFJBRyA9IDE7XG5cdFx0Ly8gdmFyIEhQQU5fRFJBRyA9IDAuNzU7XG5cdFx0dmFyIEhQQU5fRFJBRyA9IDcyMCAvIDkyMDtcblx0XHR2YXIgZGVsdGEgPSBldi5kZWx0YVg7IC8vZXYudGhyZXNob2xkRGVsdGFYO1xuXHRcdC8vIHZhciBtZWRpYUl0ZW1zID0gdGhpcy5tb2RlbC5nZXQoXCJidW5kbGVcIikuZ2V0KFwibWVkaWFcIik7XG5cblx0XHRpZiAodGhpcy5tb2RlbC5nZXQoXCJ3aXRoTWVkaWFcIikpIHtcblx0XHRcdC8vIGlmICh0aGlzLm1vZGVsLmdldChcIndpdGhNZWRpYVwiKSBeICh0aGlzLl9yZW5kZXJGbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkpIHtcblx0XHRcdC8vIGlmIChtZWRpYUl0ZW1zLnNlbGVjdGVkICE9PSBudWxsKSB7XG5cdFx0XHRkZWx0YSAqPSAoZXYub2Zmc2V0RGlyZWN0aW9uICYgSGFtbWVyLkRJUkVDVElPTl9MRUZUKSA/XG5cdFx0XHRcdDAuMCA6IEhQQU5fRFJBRztcblx0XHRcdC8vIGlmIChidW5kbGVzLnNlbGVjdGVkLmdldChcIm1lZGlhXCIpLnNlbGVjdGVkSW5kZXggPT0gLTEpIHtcblx0XHR9IGVsc2UgeyAvL2lmIChtZWRpYS5zZWxlY3RlZEluZGV4ID09IDApIHtcblx0XHRcdGRlbHRhICo9IChldi5vZmZzZXREaXJlY3Rpb24gJiBIYW1tZXIuRElSRUNUSU9OX0xFRlQpID9cblx0XHRcdFx0SFBBTl9EUkFHIDogR2xvYmFscy5IUEFOX09VVF9EUkFHO1xuXHRcdH1cblx0XHR0aGlzLnRyYW5zZm9ybXMub2Zmc2V0KGRlbHRhLCB2b2lkIDAsIHRoaXMua2V5d29yZExpc3Qud3JhcHBlcik7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdH0sXG5cblx0X29uSFBhbkZpbmFsOiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMudG91Y2gub2ZmKFwiaHBhbm1vdmVcIiwgdGhpcy5fb25IUGFuTW92ZSk7XG5cdFx0dGhpcy50b3VjaC5vZmYoXCJocGFuZW5kIGhwYW5jYW5jZWxcIiwgdGhpcy5fb25IUGFuRmluYWwpO1xuXG5cdFx0LyogTk9URTogaWYgdGhlcmUgaXMgbm8gbW9kZWwgY2hhbmdlLCBzZXQgdHggaGVyZS4gT3RoZXJ3aXNlIGp1c3Qgd2FpdCBmb3IgcmVuZGVyICovXG5cdFx0dmFyIGtUZiA9IHRoaXMudHJhbnNmb3Jtcy5nZXQodGhpcy5rZXl3b3JkTGlzdC53cmFwcGVyKTtcblx0XHRpZiAoISh0aGlzLl9yZW5kZXJGbGFncyAmIFZpZXcuTU9ERUxfSU5WQUxJRCkgJiYga1RmLmhhc09mZnNldCkge1xuXHRcdFx0aWYgKGtUZi5vZmZzZXRYICE9IDApIHtcblx0XHRcdFx0a1RmLnJ1blRyYW5zaXRpb24odHguTk9XKTtcblx0XHRcdH1cblx0XHRcdGtUZi5jbGVhck9mZnNldCgpLnZhbGlkYXRlKCk7XG5cdFx0XHQvLyBrVGYuY2xlYXJPZmZzZXQoKS5ydW5UcmFuc2l0aW9uKHR4Lk5PVykudmFsaWRhdGUoKTtcblx0XHRcdC8vIHRoaXMudHJhbnNmb3Jtcy5jbGVhck9mZnNldCh0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpO1xuXHRcdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLnJ1blRyYW5zaXRpb24odHguTk9XLCB0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpO1xuXHRcdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogVmVydGljYWwgdG91Y2gvbW92ZSAoX29uVlBhbiopXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfY29sbGFwc2VkT2Zmc2V0WTogR2xvYmFscy5DT0xMQVBTRV9PRkZTRVQsXG5cblx0X29uVlBhblN0YXJ0OiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMudG91Y2gub24oXCJ2cGFubW92ZVwiLCB0aGlzLl9vblZQYW5Nb3ZlKTtcblx0XHR0aGlzLnRvdWNoLm9uKFwidnBhbmVuZCB2cGFuY2FuY2VsXCIsIHRoaXMuX29uVlBhbkZpbmFsKTtcblxuXHRcdHRoaXMudHJhbnNmb3Jtcy5zdG9wVHJhbnNpdGlvbih0aGlzLmJ1bmRsZUxpc3QuZWwsIHRoaXMua2V5d29yZExpc3QuZWwpOyAvLywgdGhpcy5ncmFwaC5lbCk7XG5cdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLmNsZWFyT2Zmc2V0KHRoaXMuYnVuZGxlTGlzdC5lbCwgdGhpcy5rZXl3b3JkTGlzdC5lbCk7XG5cdFx0Ly8gdGhpcy50cmFuc2Zvcm1zLnZhbGlkYXRlKCk7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLmNsZWFyQ2FwdHVyZSh0aGlzLmJ1bmRsZUxpc3QuZWwsIHRoaXMua2V5d29yZExpc3QuZWwpOyAvLywgdGhpcy5ncmFwaC5lbCk7XG5cblx0XHRpZiAoIXRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpKSB7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMuc3RvcFRyYW5zaXRpb24odGhpcy5ncmFwaC5lbCk7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMuY2xlYXJDYXB0dXJlKHRoaXMuZ3JhcGguZWwpO1xuXHRcdH1cblx0XHQvLyB0aGlzLmVsLmNsYXNzTGlzdC5hZGQoXCJjb250YWluZXItY2hhbmdpbmdcIik7XG5cdFx0dGhpcy5fb25WUGFuTW92ZShldik7XG5cdH0sXG5cblx0X29uVlBhbk1vdmU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dmFyIGNvbGxhcHNlZCA9IHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpO1xuXHRcdHZhciBkZWx0YSA9IGV2LmRlbHRhWTsgLy9ldi50aHJlc2hvbGREZWx0YVk7XG5cdFx0dmFyIG1heERlbHRhID0gdGhpcy5fY29sbGFwc2VkT2Zmc2V0WTsgLy8gKyBNYXRoLmFicyhldi50aHJlc2hvbGRPZmZzZXRZKTtcblxuXHRcdC8vIGNoZWNrIGlmIGRpcmVjdGlvbiBpcyBhbGlnbmVkIHdpdGggY29sbGFwc2VkL2V4cGFuZFxuXHRcdHZhciBpc1ZhbGlkRGlyID0gY29sbGFwc2VkID8gKGRlbHRhID4gMCkgOiAoZGVsdGEgPCAwKTtcblx0XHR2YXIgbW92ZUZhY3RvciA9IGNvbGxhcHNlZCA/IDEgLSBHbG9iYWxzLlZQQU5fRFJBRyA6IEdsb2JhbHMuVlBBTl9EUkFHO1xuXG5cdFx0ZGVsdGEgPSBNYXRoLmFicyhkZWx0YSk7IC8vIHJlbW92ZSBzaWduXG5cdFx0ZGVsdGEgKj0gbW92ZUZhY3Rvcjtcblx0XHRtYXhEZWx0YSAqPSBtb3ZlRmFjdG9yO1xuXG5cdFx0aWYgKGlzVmFsaWREaXIpIHtcblx0XHRcdGlmIChkZWx0YSA+IG1heERlbHRhKSB7IC8vIG92ZXJzaG9vdGluZ1xuXHRcdFx0XHRkZWx0YSA9ICgoZGVsdGEgLSBtYXhEZWx0YSkgKiBHbG9iYWxzLlZQQU5fT1VUX0RSQUcpICsgbWF4RGVsdGE7XG5cdFx0XHR9IGVsc2UgeyAvLyBubyBvdmVyc2hvb3Rpbmdcblx0XHRcdFx0Ly8gZGVsdGEgPSBkZWx0YTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0ZGVsdGEgPSAoLWRlbHRhKSAqIEdsb2JhbHMuVlBBTl9PVVRfRFJBRzsgLy8gZGVsdGEgaXMgb3Bwb3NpdGVcblx0XHR9XG5cdFx0ZGVsdGEgKj0gY29sbGFwc2VkID8gMC41IDogLTE7IC8vIHJlYXBwbHkgc2lnblxuXG5cdFx0dGhpcy50cmFuc2Zvcm1zLm9mZnNldCgwLCBkZWx0YSwgdGhpcy5idW5kbGVMaXN0LmVsLCB0aGlzLmtleXdvcmRMaXN0LmVsKTsgLy8sIHRoaXMuZ3JhcGguZWwpO1xuXHRcdGlmICghY29sbGFwc2VkKVxuXHRcdFx0dGhpcy50cmFuc2Zvcm1zLm9mZnNldCgwLCBkZWx0YSwgdGhpcy5ncmFwaC5lbClcblx0XHR0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0fSxcblxuXHRfb25WUGFuRmluYWw6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy50b3VjaC5vZmYoXCJ2cGFubW92ZVwiLCB0aGlzLl9vblZQYW5Nb3ZlKTtcblx0XHR0aGlzLnRvdWNoLm9mZihcInZwYW5lbmQgdnBhbmNhbmNlbFwiLCB0aGlzLl9vblZQYW5GaW5hbCk7XG5cblx0XHR0aGlzLl9vblZQYW5Nb3ZlKGV2KTtcblx0XHR0aGlzLnNldEltbWVkaWF0ZShmdW5jdGlvbigpIHtcblx0XHRcdGlmICh0aGlzLndpbGxDb2xsYXBzZWRDaGFuZ2UoZXYpKSB7XG5cdFx0XHRcdHRoaXMubW9kZWwuc2V0KFwiY29sbGFwc2VkXCIsICF0aGlzLm1vZGVsLmdldChcImNvbGxhcHNlZFwiKSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5MQVlPVVRfSU5WQUxJRCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sXG5cblx0d2lsbENvbGxhcHNlZENoYW5nZTogZnVuY3Rpb24oZXYpIHtcblx0XHRyZXR1cm4gZXYudHlwZSA9PSBcInZwYW5lbmRcIiA/IHRoaXMubW9kZWwuZ2V0KFwiY29sbGFwc2VkXCIpID9cblx0XHRcdGV2LmRlbHRhWSA+IEdsb2JhbHMuQ09MTEFQU0VfVEhSRVNIT0xEIDpcblx0XHRcdGV2LmRlbHRhWSA8IC1HbG9iYWxzLkNPTExBUFNFX1RIUkVTSE9MRCA6XG5cdFx0XHRmYWxzZTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIENvbXBvbmVudHNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGNyZWF0ZVNpdGVuYW1lQnV0dG9uOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBWaWV3KHtcblx0XHRcdGVsOiBcIiNzaXRlLW5hbWVcIixcblx0XHRcdGV2ZW50czoge1xuXHRcdFx0XHRcImNsaWNrIGFcIjogZnVuY3Rpb24oZG9tZXYpIHtcblx0XHRcdFx0XHRkb21ldi5kZWZhdWx0UHJldmVudGVkIHx8IGRvbWV2LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpjbGlja1wiKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHRoaXMubGlzdGVuVG8odmlldywgXCJ2aWV3OmNsaWNrXCIsIHRoaXMuX29uU2l0ZW5hbWVDbGljayk7XG5cdFx0dmlldy53cmFwcGVyID0gdmlldy5lbC5wYXJlbnRFbGVtZW50O1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdGNyZWF0ZUFydGljbGVCdXR0b246IGZ1bmN0aW9uKGFydGljbGVJdGVtKSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgQXJ0aWNsZUJ1dHRvbih7XG5cdFx0XHRlbDogXCIuYXJ0aWNsZS1idXR0b25bZGF0YS1oYW5kbGU9J2Fib3V0J11cIixcblx0XHRcdG1vZGVsOiBhcnRpY2xlSXRlbVxuXHRcdH0pLnJlbmRlcigpO1xuXHRcdHRoaXMubGlzdGVuVG8odmlldywgXCJ2aWV3OmNsaWNrXCIsIHRoaXMuX29uQXJ0aWNsZUNsaWNrKTtcblx0XHR2aWV3LndyYXBwZXIgPSB2aWV3LmVsLnBhcmVudEVsZW1lbnQ7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0Ly8gY3JlYXRlQXJ0aWNsZUJ1dHRvbjI6IGZ1bmN0aW9uKGFydGljbGVJdGVtKSB7XG5cdC8vIFx0dmFyIHZpZXcgPSBuZXcgVmlldyh7XG5cdC8vIFx0XHRlbDogXCIjYWJvdXRcIixcblx0Ly8gXHRcdGNsYXNzTmFtZTogXCJhcnRpY2xlLWJ1dHRvblwiLFxuXHQvLyBcdFx0Ly8gdGFnOiBcImgyXCIsXG5cdC8vIFx0XHRtb2RlbDogYXJ0aWNsZUl0ZW0sXG5cdC8vIFx0fSk7XG5cdC8vIFx0Ly8gdGhpcy5saXN0ZW5Ubyh2aWV3LCBcInZpZXc6Y2xpY2tcIiwgdGhpcy5fb25BYm91dENsaWNrKTtcblx0Ly8gXHR2aWV3LmxhYmVsID0gdmlldy5lbC5xdWVyeVNlbGVjdG9yKFwiYVwiKTtcblx0Ly8gXHR2aWV3LmxhYmVsLmlubmVySFRNTCA9IGFydGljbGVJdGVtLmdldChcIm5hbWVcIik7XG5cdC8vIFx0dmlldy53cmFwcGVyID0gdmlldy5lbC5wYXJlbnRFbGVtZW50O1xuXHQvLyBcdHJldHVybiB2aWV3O1xuXHQvLyB9LFxuXG5cdC8qKlxuXHQgKiBidW5kbGUtbGlzdFxuXHQgKi9cblx0Y3JlYXRlQnVuZGxlTGlzdDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgRmlsdGVyYWJsZUxpc3RWaWV3KHtcblx0XHRcdGVsOiBcIiNidW5kbGUtbGlzdFwiLFxuXHRcdFx0Y29sbGVjdGlvbjogYnVuZGxlcyxcblx0XHRcdGNvbGxhcHNlZDogZmFsc2UsXG5cdFx0XHRmaWx0ZXJGbjogZnVuY3Rpb24oYnVuZGxlLCBpbmRleCwgYXJyKSB7XG5cdFx0XHRcdHJldHVybiBrZXl3b3Jkcy5zZWxlY3RlZCA/XG5cdFx0XHRcdFx0YnVuZGxlLmdldChcImtJZHNcIikuaW5kZXhPZihrZXl3b3Jkcy5zZWxlY3RlZC5pZCkgIT09IC0xIDogZmFsc2U7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHRcdGNvbnRyb2xsZXIubGlzdGVuVG8odmlldywge1xuXHRcdFx0XCJ2aWV3OnNlbGVjdDpvbmVcIjogY29udHJvbGxlci5zZWxlY3RCdW5kbGUsXG5cdFx0XHRcInZpZXc6c2VsZWN0Om5vbmVcIjogY29udHJvbGxlci5kZXNlbGVjdEJ1bmRsZVxuXHRcdH0pO1xuXHRcdC8vIHZpZXcubGlzdGVuVG8oYnVuZGxlcywgXCJzZWxlY3Q6b25lIHNlbGVjdDpub25lXCIsIGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHQvLyBcdHZpZXcuc2VsZWN0ZWRJdGVtID0gaXRlbTtcblx0XHQvLyB9KTtcblx0XHR0aGlzLmxpc3RlblRvKHZpZXcsIFwidmlldzpzZWxlY3Q6c2FtZVwiLCB0aGlzLl9vbkJ1bmRsZUxpc3RTYW1lKTtcblx0XHR0aGlzLmxpc3RlblRvKGtleXdvcmRzLCBcInNlbGVjdDpvbmUgc2VsZWN0Om5vbmVcIiwgdGhpcy5fb25LZXl3b3JkU2VsZWN0KTtcblx0XHR2aWV3LndyYXBwZXIgPSB2aWV3LmVsLnBhcmVudEVsZW1lbnQ7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyoqXG5cdCAqIGtleXdvcmQtbGlzdFxuXHQgKi9cblx0Y3JlYXRlS2V5d29yZExpc3Q6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB2aWV3ID0gbmV3IEdyb3VwaW5nTGlzdFZpZXcoe1xuXHRcdFx0ZWw6IFwiI2tleXdvcmQtbGlzdFwiLFxuXHRcdFx0Y29sbGVjdGlvbjoga2V5d29yZHMsXG5cdFx0XHRjb2xsYXBzZWQ6IGZhbHNlLFxuXHRcdFx0ZmlsdGVyRm46IGZ1bmN0aW9uKGl0ZW0sIGlkeCwgYXJyKSB7XG5cdFx0XHRcdC8vIHJldHVybiAhIShpdGVtLmdldChcImJ1bmRsZVwiKS5zZWxlY3RlZCk7XG5cdFx0XHRcdHJldHVybiBidW5kbGVzLnNlbGVjdGVkID9cblx0XHRcdFx0XHQoYnVuZGxlcy5zZWxlY3RlZC5nZXQoXCJrSWRzXCIpLmluZGV4T2YoaXRlbS5pZCkgIT09IC0xKSA6IGZhbHNlO1xuXHRcdFx0fSxcblx0XHRcdGdyb3VwaW5nRm46IGZ1bmN0aW9uKGl0ZW0sIGlkeCwgYXJyKSB7XG5cdFx0XHRcdC8vIHJldHVybiBpdGVtLmdldChcInR5cGVcIik7XG5cdFx0XHRcdHJldHVybiB0eXBlcy5nZXQoaXRlbS5nZXQoXCJ0SWRcIikpO1xuXHRcdFx0fSxcblx0XHR9KTtcblx0XHR2aWV3Lmxpc3RlblRvKGtleXdvcmRzLCBcInNlbGVjdDpvbmUgc2VsZWN0Om5vbmVcIiwgZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0dmlldy5zZWxlY3RlZEl0ZW0gPSBpdGVtO1xuXHRcdH0pO1xuXHRcdHRoaXMubGlzdGVuVG8odmlldywgXCJ2aWV3OnNlbGVjdDpvbmUgdmlldzpzZWxlY3Q6bm9uZVwiLCB0aGlzLl9vbktleXdvcmRMaXN0Q2hhbmdlKTtcblx0XHR2aWV3LndyYXBwZXIgPSB2aWV3LmVsLnBhcmVudEVsZW1lbnQ7XG5cdFx0cmV0dXJuIHZpZXc7XG5cdH0sXG5cblx0LyoqXG5cdCAqIG5hdi1ncmFwaFxuXHQgKi9cblx0Y3JlYXRlR3JhcGhWaWV3OiBmdW5jdGlvbihsaXN0QSwgbGlzdEIpIHtcblx0XHR2YXIgdmlldyA9IG5ldyBHcmFwaFZpZXcoe1xuXHRcdFx0aWQ6IFwibmF2LWdyYXBoXCIsXG5cdFx0XHRsaXN0QTogbGlzdEEsXG5cdFx0XHRsaXN0QjogbGlzdEIsXG5cdFx0XHRtb2RlbDogdGhpcy5tb2RlbCxcblx0XHRcdHVzZU9wYXF1ZTogZmFsc2Vcblx0XHR9KTtcblx0XHQvLyB0aGlzLmVsLmFwcGVuZENoaWxkKHZpZXcuZWwpO1xuXHRcdHRoaXMuZWwuaW5zZXJ0QmVmb3JlKHZpZXcuZWwsIHRoaXMuZWwuZmlyc3RFbGVtZW50Q2hpbGQpO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogSG9yaXpvbnRhbCB0b3VjaC9tb3ZlIChNdXRhdGlvbk9ic2VydmVyKVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Lypcblx0X2JlZ2luVHJhbnNmb3JtT2JzZXJ2ZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCEoR2xvYmFscy5CUkVBS1BPSU5UU1tcImRlc2t0b3Atc21hbGxcIl0ubWF0Y2hlcyAmJiB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKS5nZXQoXCJtZWRpYVwiKS5zZWxlY3RlZEluZGV4IDw9IDAgJiYgdGhpcy5tb2RlbC5nZXQoXCJjb2xsYXBzZWRcIikpKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHZhciB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcm91c2VsID4gLmVtcHR5LWl0ZW1cIik7XG5cdFx0aWYgKHRhcmdldCA9PT0gbnVsbCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAoIXRoaXMuX3RyYW5zZm9ybU9ic2VydmVyKSB7XG5cdFx0XHR0aGlzLl90cmFuc2Zvcm1PYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKHRoaXMuX29uVHJhbnNmb3JtTXV0YXRpb24pO1xuXHRcdH1cblx0XHR0aGlzLl90cmFuc2Zvcm1PYnNlcnZlci5vYnNlcnZlKHRhcmdldCwgeyBhdHRyaWJ1dGVzOiB0cnVlLCBhdHRyaWJ1dGVGaWx0ZXI6IFtcInN0eWxlXCJdIH0pO1xuXHRcdHRoaXMudG91Y2gub24oXCJocGFuZW5kIGhwYW5jYW5jZWxcIiwgdGhpcy5fZW5kVHJhbnNmb3JtT2JzZXJ2ZSk7XG5cdFx0dGhpcy50cmFuc2Zvcm1zLmdldCh0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIpXG5cdFx0XHQuc3RvcFRyYW5zaXRpb24oKVxuXHRcdFx0LmNsZWFyT2Zmc2V0KClcblx0XHRcdC5jbGVhckNhcHR1cmUoKVxuXHRcdFx0LnZhbGlkYXRlKCk7XG5cdH0sXG5cblx0X2VuZFRyYW5zZm9ybU9ic2VydmU6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuX3RyYW5zZm9ybU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcblx0XHR0aGlzLnRvdWNoLm9mZihcImhwYW5lbmQgaHBhbmNhbmNlbFwiLCB0aGlzLl9lbmRUcmFuc2Zvcm1PYnNlcnZlKTtcblx0XHR0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcilcblx0XHRcdC5jbGVhck9mZnNldCgpXG5cdFx0XHQucnVuVHJhbnNpdGlvbih0eC5OT1cpXG5cdFx0XHQudmFsaWRhdGUoKTtcblx0fSxcblxuXHRfb25UcmFuc2Zvcm1NdXRhdGlvbjogZnVuY3Rpb24obXV0YXRpb25zKSB7XG5cdFx0dmFyIHRWaWV3LCB0TWV0cmljcywgdENzcywgZFR4T2JqLCBwb3M7XG5cblx0XHQvLyB0aGlzLmtleXdvcmRMaXN0LndyYXBwZXIuc3R5bGVbcHJlZml4ZWRQcm9wZXJ0eShcInRyYW5zZm9ybVwiKV07XG5cdFx0Ly8gdHJhbnNmb3JtID0gbXV0YXRpb25zWzBdLnRhcmdldC5zdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKHByZWZpeGVkUHJvcGVydHkoXCJ0cmFuc2Zvcm1cIikpO1xuXG5cdFx0dFZpZXcgPSBWaWV3LmZpbmRCeUVsZW1lbnQobXV0YXRpb25zWzBdLnRhcmdldCk7XG5cdFx0aWYgKHRWaWV3KSB7XG5cdFx0XHR0TWV0cmljcyA9IHRWaWV3Lm1ldHJpY3M7XG5cdFx0XHRkVHhPYmogPSB0aGlzLnRyYW5zZm9ybXMuZ2V0KHRoaXMua2V5d29yZExpc3Qud3JhcHBlcik7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25UcmFuc2Zvcm1NdXRhdGlvbiBbd2l0aE1lZGlhOiAlc10gdGFyZ2V0OiAoJWZcXCslZikgJWYgd3JhcHBlcjogKCVmKSAlZlwiLCB0aGlzLmNpZCxcblx0XHRcdFx0dGhpcy5tb2RlbC5oYXMoXCJtZWRpYVwiKSxcblx0XHRcdFx0dE1ldHJpY3MudHJhbnNsYXRlWCwgdE1ldHJpY3Mud2lkdGgsIHRNZXRyaWNzLnRyYW5zbGF0ZVggKyB0TWV0cmljcy53aWR0aCxcblx0XHRcdFx0ZFR4T2JqLmNhcHR1cmVkWCwgdE1ldHJpY3MudHJhbnNsYXRlWCAtIGRUeE9iai5jYXB0dXJlZFgsXG5cdFx0XHRcdHRNZXRyaWNzXG5cdFx0XHQpO1xuXG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMub2Zmc2V0KHRNZXRyaWNzLnRyYW5zbGF0ZVggLSBkVHhPYmouY2FwdHVyZWRYLCB2b2lkIDAsIHRoaXMua2V5d29yZExpc3Qud3JhcHBlcik7XG5cdFx0XHR0aGlzLnRyYW5zZm9ybXMudmFsaWRhdGUoKTtcblx0XHR9XG5cdH0sXG5cdCovXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBOYXZpZ2F0aW9uVmlldzsiLCIvKiBnbG9iYWwgUGF0aDJEICovXG4vKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL0NhbnZhc1ZpZXdcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmNvbG9yfSAqL1xuLy8gdmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvSW50ZXJwb2xhdG9yfSAqL1xudmFyIEludGVycG9sYXRvciA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL0ludGVycG9sYXRvclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL2Nzcy9nZXRCb3hFZGdlU3R5bGVzfSAqL1xudmFyIGdldEJveEVkZ2VTdHlsZXMgPSByZXF1aXJlKFwidXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXNcIik7XG5cbnZhciBNSU5fQ0FOVkFTX1JBVElPID0gMjsgLy8gL0ZpcmVmb3gvLnRlc3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpPyAyIDogMTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL0NhbnZhc1ZpZXd9XG4gKi9cbnZhciBDYW52YXNWaWV3ID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwiY2FudmFzVmlld1wiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0dGFnTmFtZTogXCJjYW52YXNcIixcblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNsYXNzTmFtZTogXCJjYW52YXMtdmlld1wiLFxuXG5cdHByb3BlcnRpZXM6IHtcblx0XHRjb250ZXh0OiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY3R4O1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0aW50ZXJwb2xhdG9yOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5faW50ZXJwb2xhdG9yO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0Y2FudmFzUmF0aW86IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9jYW52YXNSYXRpbztcblx0XHRcdH1cblx0XHR9LFxuXHR9LFxuXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdHZhbHVlczoge1xuXHRcdFx0dmFsdWU6IDBcblx0XHR9LFxuXHRcdG1heFZhbHVlczoge1xuXHRcdFx0dmFsdWU6IDFcblx0XHR9LFxuXHRcdHVzZU9wYXF1ZTogdHJ1ZSxcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBjaGlsZHJlbi9sYXlvdXRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0Ly8gVE9ETzogY2xlYW51cCB0aGlzIG9wdGlvbnMgbWVzc1xuXHRcdG9wdGlvbnMgPSBfLmRlZmF1bHRzKG9wdGlvbnMsIHRoaXMuZGVmYXVsdHMpO1xuXHRcdG9wdGlvbnMudmFsdWVzID0gXy5kZWZhdWx0cyhvcHRpb25zLnZhbHVlcywgdGhpcy5kZWZhdWx0cy52YWx1ZXMpO1xuXHRcdG9wdGlvbnMubWF4VmFsdWVzID0gXy5kZWZhdWx0cyhvcHRpb25zLm1heFZhbHVlcywgdGhpcy5kZWZhdWx0cy5tYXhWYWx1ZXMpO1xuXG5cdFx0dGhpcy5faW50ZXJwb2xhdG9yID0gbmV3IEludGVycG9sYXRvcihvcHRpb25zLnZhbHVlcywgb3B0aW9ucy5tYXhWYWx1ZXMpO1xuXHRcdHRoaXMuX3VzZU9wYXF1ZSA9IG9wdGlvbnMudXNlT3BhcXVlO1xuXHRcdHRoaXMuX29wdGlvbnMgPSBfLnBpY2sob3B0aW9ucywgXCJjb2xvclwiLCBcImJhY2tncm91bmRDb2xvclwiKTtcblxuXHRcdC8vIG9wYXF1ZSBiYWNrZ3JvdW5kXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR2YXIgY3R4T3B0cyA9IHt9O1xuXHRcdC8vIGlmICh0aGlzLl91c2VPcGFxdWUpIHtcblx0XHQvLyBcdHRoaXMuX29wYXF1ZVByb3AgPSBNb2Rlcm5penIucHJlZml4ZWQoXCJvcGFxdWVcIiwgdGhpcy5lbCwgZmFsc2UpO1xuXHRcdC8vIFx0aWYgKHRoaXMuX29wYXF1ZVByb3ApIHtcblx0XHQvLyBcdFx0dGhpcy5lbFt0aGlzLl9vcGFxdWVQcm9wXSA9IHRydWU7XG5cdFx0Ly8gXHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRjdHhPcHRzLmFscGhhID0gdHJ1ZTtcblx0XHQvLyBcdH1cblx0XHQvLyBcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcImNvbG9yLWJnXCIpO1xuXHRcdC8vIH1cblxuXHRcdC8vIGNhbnZhcycgY29udGV4dCBpbml0XG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLl9jdHggPSB0aGlzLmVsLmdldENvbnRleHQoXCIyZFwiLCBjdHhPcHRzKTtcblxuXHRcdC8vIGFkanVzdCBjYW52YXMgc2l6ZSB0byBwaXhlbCByYXRpb1xuXHRcdC8vIHVwc2NhbGUgdGhlIGNhbnZhcyBpZiB0aGUgdHdvIHJhdGlvcyBkb24ndCBtYXRjaFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIHJhdGlvID0gTUlOX0NBTlZBU19SQVRJTztcblx0XHR2YXIgY3R4UmF0aW8gPSB0aGlzLl9jdHgud2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCAxO1xuXHRcdGlmICh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyAhPT0gY3R4UmF0aW8pIHtcblx0XHRcdC8vIHJhdGlvID0gTWF0aC5tYXgod2luZG93LmRldmljZVBpeGVsUmF0aW8gLyBjdHhSYXRpbywgTUlOX0NBTlZBU19SQVRJTyk7XG5cdFx0XHRyYXRpbyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIC8gY3R4UmF0aW87XG5cdFx0XHRyYXRpbyA9IE1hdGgubWF4KHJhdGlvLCBNSU5fQ0FOVkFTX1JBVElPKTtcblx0XHR9XG5cdFx0dGhpcy5fY2FudmFzUmF0aW8gPSByYXRpbztcblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjppbml0IGNhbnZhc1JhdGlvOiAlZlwiLCB0aGlzLmNpZCwgdGhpcy5fY2FudmFzUmF0aW8pO1xuXG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLCBcInZpZXc6YXR0YWNoZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHQvLyB0aGlzLmludmFsaWRhdGVTaXplKCk7XG5cdFx0XHQvLyB0aGlzLnJlbmRlck5vdygpO1xuXHRcdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCkucmVuZGVyTm93KCk7XG5cdFx0fSk7XG5cdH0sXG5cblx0Ly8gX2NvbXB1dGVDYW52YXNSYXRpbzogZnVuY3Rpb24oKSB7XG5cdC8vIFx0dmFyIHJhdGlvID0gTUlOX0NBTlZBU19SQVRJTztcblx0Ly8gXHR2YXIgY3R4UmF0aW8gPSB0aGlzLl9jdHgud2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCAxO1xuXHQvLyBcdGlmICh3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyAhPT0gY3R4UmF0aW8pIHtcblx0Ly8gXHRcdC8vIHJhdGlvID0gTWF0aC5tYXgod2luZG93LmRldmljZVBpeGVsUmF0aW8gLyBjdHhSYXRpbywgTUlOX0NBTlZBU19SQVRJTyk7XG5cdC8vIFx0XHRyYXRpbyA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIC8gY3R4UmF0aW87XG5cdC8vIFx0XHRyYXRpbyA9IE1hdGgubWF4KHJhdGlvLCBNSU5fQ0FOVkFTX1JBVElPKTtcblx0Ly8gXHR9XG5cdC8vIFx0dGhpcy5fY2FudmFzUmF0aW8gPSByYXRpbztcblx0Ly8gfSxcblxuXHRfdXBkYXRlQ2FudmFzOiBmdW5jdGlvbigpIHtcblx0XHQvLyBhZGp1c3QgY2FudmFzIHNpemUgdG8gcGl4ZWwgcmF0aW9cblx0XHQvLyB1cHNjYWxlIHRoZSBjYW52YXMgaWYgdGhlIHR3byByYXRpb3MgZG9uJ3QgbWF0Y2hcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdFx0dmFyIHMgPSBnZXRDb21wdXRlZFN0eWxlKHRoaXMuZWwpO1xuXG5cdFx0dGhpcy5fY2FudmFzV2lkdGggPSB0aGlzLmVsLm9mZnNldFdpZHRoO1xuXHRcdHRoaXMuX2NhbnZhc0hlaWdodCA9IHRoaXMuZWwub2Zmc2V0SGVpZ2h0O1xuXG5cdFx0aWYgKHMuYm94U2l6aW5nID09PSBcImJvcmRlci1ib3hcIikge1xuXHRcdFx0dmFyIG0gPSBnZXRCb3hFZGdlU3R5bGVzKHMpO1xuXHRcdFx0dGhpcy5fY2FudmFzV2lkdGggLT0gbS5wYWRkaW5nTGVmdCArIG0ucGFkZGluZ1JpZ2h0ICsgbS5ib3JkZXJMZWZ0V2lkdGggKyBtLmJvcmRlclJpZ2h0V2lkdGg7XG5cdFx0XHR0aGlzLl9jYW52YXNIZWlnaHQgLT0gbS5wYWRkaW5nVG9wICsgbS5wYWRkaW5nQm90dG9tICsgbS5ib3JkZXJUb3BXaWR0aCArIG0uYm9yZGVyQm90dG9tV2lkdGg7XG5cdFx0fVxuXG5cdFx0dGhpcy5fY2FudmFzV2lkdGggKj0gdGhpcy5fY2FudmFzUmF0aW87XG5cdFx0dGhpcy5fY2FudmFzSGVpZ2h0ICo9IHRoaXMuX2NhbnZhc1JhdGlvO1xuXG5cdFx0dGhpcy5tZWFzdXJlQ2FudmFzKHRoaXMuX2NhbnZhc1dpZHRoLCB0aGlzLl9jYW52YXNIZWlnaHQpO1xuXHRcdHRoaXMuZWwud2lkdGggPSB0aGlzLl9jYW52YXNXaWR0aDtcblx0XHR0aGlzLmVsLmhlaWdodCA9IHRoaXMuX2NhbnZhc0hlaWdodDtcblx0XHQvLyB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IGggKyBcInB4XCI7XG5cdFx0Ly8gdGhpcy5lbC5zdHlsZS53aWR0aCA9IHcgKyBcInB4XCI7XG5cblx0XHQvLyBjb2xvcnNcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuX2NvbG9yID0gdGhpcy5fb3B0aW9ucy5jb2xvciB8fFxuXHRcdFx0cy5jb2xvciB8fCBHbG9iYWxzLkRFRkFVTFRfQ09MT1JTW1wiY29sb3JcIl07XG5cdFx0dGhpcy5fYmFja2dyb3VuZENvbG9yID0gdGhpcy5fb3B0aW9ucy5iYWNrZ3JvdW5kQ29sb3IgfHxcblx0XHRcdHMuYmFja2dyb3VuZENvbG9yIHx8IEdsb2JhbHMuREVGQVVMVF9DT0xPUlNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdO1xuXG5cdFx0Ly8gbW96T3BhcXVlXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRpZiAodGhpcy5fdXNlT3BhcXVlICYmIHRoaXMuX29wYXF1ZVByb3ApIHtcblx0XHRcdC8vIHRoaXMuZWwuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gdGhpcy5fYmFja2dyb3VuZENvbG9yO1xuXHRcdFx0dGhpcy5lbFt0aGlzLl9vcGFxdWVQcm9wXSA9IHRydWU7XG5cdFx0fVxuXG5cdFx0Ly8gZm9udFNpemVcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuX2ZvbnRTaXplID0gcGFyc2VGbG9hdChzLmZvbnRTaXplKSAqIHRoaXMuX2NhbnZhc1JhdGlvO1xuXHRcdHRoaXMuX2ZvbnRGYW1pbHkgPSBzLmZvbnRGYW1pbHk7XG5cblx0XHQvLyBwcmVwYXJlIGNhbnZhcyBjb250ZXh0XG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXG5cdFx0dGhpcy5fY3R4LmZvbnQgPSBbcy5mb250V2VpZ2h0LCBzLmZvbnRTdHlsZSwgdGhpcy5fZm9udFNpemUgKyBcInB4LzFcIiwgcy5mb250RmFtaWx5XS5qb2luKFwiIFwiKTtcblx0XHR0aGlzLl9jdHgudGV4dEFsaWduID0gXCJsZWZ0XCI7XG5cdFx0dGhpcy5fY3R4LmxpbmVDYXAgPSBcImJ1dHRcIjtcblx0XHR0aGlzLl9jdHgubGluZUpvaW4gPSBcIm1pdGVyXCI7XG5cdFx0dGhpcy5fY3R4LnN0cm9rZVN0eWxlID0gdGhpcy5fY29sb3I7XG5cdFx0dGhpcy5fY3R4LmZpbGxTdHlsZSA9IHRoaXMuX2NvbG9yO1xuXG5cdFx0dGhpcy51cGRhdGVDYW52YXModGhpcy5fY3R4KTtcblx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXG5cdFx0Ly8gY29uc29sZS5ncm91cCh0aGlzLmNpZCtcIjo6X3VwZGF0ZUNhbnZhc1wiKTtcblx0XHQvLyBjb25zb2xlLmxvZyhcInJhdGlvOiAgICAlZiAobWluOiAlZiwgZGV2aWNlOiAlZiwgY29udGV4dDogJXMpXCIsIHRoaXMuX2NhbnZhc1JhdGlvLCBNSU5fQ0FOVkFTX1JBVElPLCB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbywgdGhpcy5fY3R4LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwgXCIod2Via2l0LW9ubHkpXCIpO1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiY29sb3JzOiAgIGZnOiAlcyBiZzogJXNcIiwgdGhpcy5fY29sb3IsIHRoaXMuX2JhY2tncm91bmRDb2xvcik7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJzdHlsZTogICAgJXMsICVzLCBwYWRkaW5nOiAlcyAoJXMpXCIsIHMud2lkdGgsIHMuaGVpZ2h0LCBzLnBhZGRpbmcsIHMuYm94U2l6aW5nKTtcblx0XHQvLyBjb25zb2xlLmxvZyhcImJveDogICAgICAlZiB4ICVmIHB4XCIsIG0ud2lkdGgsIG0uaGVpZ2h0KTtcblx0XHQvLyBjb25zb2xlLmxvZyhcIm1lYXN1cmVkOiAlZiB4ICVmIHB4XCIsIHcsIGgpO1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiY2FudmFzOiAgICVmIHggJWYgcHhcIiwgdGhpcy5fY2FudmFzV2lkdGgsIHRoaXMuX2NhbnZhc0hlaWdodCk7XG5cdFx0Ly8gY29uc29sZS5ncm91cEVuZCgpO1xuXHR9LFxuXG5cdHVwZGF0ZUNhbnZhczogZnVuY3Rpb24oKSB7XG5cdFx0LyogYWJzdHJhY3QgKi9cblx0fSxcblxuXHRtZWFzdXJlQ2FudmFzOiBmdW5jdGlvbigpIHtcblx0XHQvKiBhYnN0cmFjdCAqL1xuXHR9LFxuXG5cdF9nZXRGb250TWV0cmljczogZnVuY3Rpb24oc3RyKSB7XG5cdFx0dmFyIGtleSwgaWR4LCBtT2JqLCBtSWR4ID0gc3RyLmxlbmd0aDtcblx0XHRmb3IgKGtleSBpbiBHbG9iYWxzLkZPTlRfTUVUUklDUykge1xuXHRcdFx0aWR4ID0gc3RyLmluZGV4T2Yoa2V5KTtcblx0XHRcdGlmIChpZHggIT09IC0xICYmIGlkeCA8IG1JZHgpIHtcblx0XHRcdFx0bUlkeCA9IGlkeDtcblx0XHRcdFx0bU9iaiA9IEdsb2JhbHMuRk9OVF9NRVRSSUNTW2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBtT2JqO1xuXHR9LFxuXG5cdF9jbGVhckNhbnZhczogZnVuY3Rpb24oeCwgeSwgdywgaCkge1xuXHRcdHRoaXMuX2N0eC5jbGVhclJlY3QoeCwgeSwgdywgaCk7XG5cdFx0aWYgKHRoaXMuX3VzZU9wYXF1ZSkge1xuXHRcdFx0dGhpcy5fY3R4LnNhdmUoKTtcblx0XHRcdHRoaXMuX2N0eC5maWxsU3R5bGUgPSB0aGlzLl9iYWNrZ3JvdW5kQ29sb3I7XG5cdFx0XHR0aGlzLl9jdHguZmlsbFJlY3QoeCwgeSwgdywgaCk7XG5cdFx0XHR0aGlzLl9jdHgucmVzdG9yZSgpO1xuXHRcdH1cblx0fSxcblxuXHRfc2V0U3R5bGU6IGZ1bmN0aW9uKHMpIHtcblx0XHRDYW52YXNWaWV3LnNldFN0eWxlKHRoaXMuX2N0eCwgcyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcmVuZGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5hdHRhY2hlZCkge1xuXHRcdFx0cmV0dXJuIHRoaXMucmVuZGVyTm93KCk7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyRnJhbWU6IGZ1bmN0aW9uKHRzdGFtcCwgZmxhZ3MpIHtcblx0XHRpZiAoIXRoaXMuYXR0YWNoZWQpIHtcblx0XHRcdHJldHVybiBmbGFncztcblx0XHR9XG5cdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHtcblx0XHRcdHRoaXMuX3VwZGF0ZUNhbnZhcygpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5faW50ZXJwb2xhdG9yLnZhbHVlc0NoYW5nZWQpIHtcblx0XHRcdGZsYWdzIHw9IFZpZXcuTEFZT1VUX0lOVkFMSUQ7XG5cdFx0XHR0aGlzLl9pbnRlcnBvbGF0b3IuaW50ZXJwb2xhdGUodHN0YW1wKTtcblx0XHR9XG5cdFx0aWYgKGZsYWdzICYgKFZpZXcuTEFZT1VUX0lOVkFMSUQgfCBWaWV3LlNJWkVfSU5WQUxJRCkpIHtcblx0XHRcdHRoaXMucmVkcmF3KHRoaXMuX2N0eCwgdGhpcy5faW50ZXJwb2xhdG9yKTtcblx0XHRcdGlmICh0aGlzLl9pbnRlcnBvbGF0b3IudmFsdWVzQ2hhbmdlZCkge1xuXHRcdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcHVibGljXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGdldFZhbHVlOiBmdW5jdGlvbihrZXkpIHtcblx0XHRyZXR1cm4gdGhpcy5faW50ZXJwb2xhdG9yLmdldFZhbHVlKGtleSk7XG5cdH0sXG5cblx0Z2V0UmVuZGVyZWRWYWx1ZTogZnVuY3Rpb24oa2V5KSB7XG5cdFx0cmV0dXJuIHRoaXMuX2ludGVycG9sYXRvci5nZXRSZW5kZXJlZFZhbHVlKGtleSk7XG5cdH0sXG5cblx0dmFsdWVUbzogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBrZXkpIHtcblx0XHR0aGlzLl9pbnRlcnBvbGF0b3IudmFsdWVUbyh2YWx1ZSwgZHVyYXRpb24sIGtleSk7XG5cdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuTU9ERUxfSU5WQUxJRCB8IFZpZXcuTEFZT1VUX0lOVkFMSUQpO1xuXHR9LFxuXG5cdC8vIHVwZGF0ZVZhbHVlOiBmdW5jdGlvbihrZXkpIHtcblx0Ly8gXHRyZXR1cm4gdGhpcy5faW50ZXJwb2xhdG9yLnVwZGF0ZVZhbHVlKGtleSB8fCB0aGlzLmRlZmF1bHRLZXkpO1xuXHQvLyB9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHJlZHJhd1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZWRyYXc6IGZ1bmN0aW9uKGNvbnRleHQsIGNoYW5nZWQpIHt9LFxuXG59LCB7XG5cdHNldFN0eWxlOiBmdW5jdGlvbihjdHgsIHMpIHtcblx0XHRpZiAodHlwZW9mIHMgIT0gXCJvYmplY3RcIikgcmV0dXJuO1xuXHRcdGZvciAodmFyIHAgaW4gcykge1xuXHRcdFx0c3dpdGNoICh0eXBlb2YgY3R4W3BdKSB7XG5cdFx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcImZ1bmN0aW9uXCI6XG5cdFx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkoc1twXSkpIGN0eFtwXS5hcHBseShjdHgsIHNbcF0pO1xuXHRcdFx0XHRcdGVsc2UgY3R4W3BdLmNhbGwoY3R4LCBzW3BdKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRjdHhbcF0gPSBzW3BdO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufSk7XG5cbmlmIChERUJVRykge1xuXHRDYW52YXNWaWV3LnByb3RvdHlwZS5fc2tpcExvZyA9IHRydWU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQ2FudmFzVmlldzsiLCIvLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9zZXRJbW1lZGlhdGV9ICovXG4vLyB2YXIgc2V0SW1tZWRpYXRlID0gcmVxdWlyZShcInV0aWxzL3NldEltbWVkaWF0ZVwiKTtcblxuLy8gZnVuY3Rpb24gc29ydEJ5UHJpb3JpdHkoYSwgYikge1xuLy8gXHRpZiAoYS5wcmlvcml0eSA+IGIucHJpb3JpdHkpXG4vLyBcdFx0cmV0dXJuIDE7XG4vLyBcdGlmIChhLnByaW9yaXR5IDwgYi5wcmlvcml0eSlcbi8vIFx0XHRyZXR1cm4gLTE7XG4vLyBcdHJldHVybiAwO1xuLy8gfVxuXG5mdW5jdGlvbiBSZXF1ZXN0UXVldWUob2Zmc2V0KSB7XG5cdHRoaXMuX29mZnNldCA9IG9mZnNldCB8IDA7XG5cdHRoaXMuX2l0ZW1zID0gW107XG5cdHRoaXMuX3ByaW9yaXRpZXMgPSBbXTtcblx0dGhpcy5fbnVtSXRlbXMgPSAwO1xufVxuXG5SZXF1ZXN0UXVldWUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSh7XG5cdGVucXVldWU6IGZ1bmN0aW9uKGl0ZW0sIHByaW9yaXR5KSB7XG5cdFx0dmFyIGkgPSB0aGlzLl9pdGVtcy5sZW5ndGg7XG5cdFx0dGhpcy5faXRlbXNbaV0gPSBpdGVtO1xuXHRcdHRoaXMuX3ByaW9yaXRpZXNbaV0gPSB7XG5cdFx0XHRwcmlvcml0eTogKHByaW9yaXR5IHwgMCksXG5cdFx0XHRpbmRleDogaVxuXHRcdH07XG5cdFx0dGhpcy5fbnVtSXRlbXMrKztcblx0XHQvLyBjb25zb2xlLmxvZyhcIkZyYW1lUXVldWU6OlJlcXVlc3RRdWV1ZTo6ZW5xdWV1ZSgpIFtudW1JdGVtczolaV0gSUQ6JWlcIiwgdGhpcy5fbnVtSXRlbXMsIHRoaXMuX29mZnNldCArIGkpO1xuXHRcdHJldHVybiB0aGlzLl9vZmZzZXQgKyBpO1xuXHR9LFxuXG5cdGNvbnRhaW5zOiBmdW5jdGlvbihpbmRleCkge1xuXHRcdGluZGV4IC09IHRoaXMub2Zmc2V0O1xuXHRcdHJldHVybiAwIDw9IGluZGV4ICYmIGluZGV4IDwgdGhpcy5faXRlbXMubGVuZ3RoO1xuXHR9LFxuXG5cdHNraXA6IGZ1bmN0aW9uKGluZGV4KSB7XG5cdFx0dmFyIGksIGl0ZW07XG5cdFx0aSA9IGluZGV4IC0gdGhpcy5fb2Zmc2V0O1xuXHRcdGlmICgwID4gaSB8fCBpID49IHRoaXMuX2l0ZW1zLmxlbmd0aCkge1xuXHRcdFx0Ly8gXHRjb25zb2xlLndhcm4oXCJGcmFtZVF1ZXVlOjpSZXF1ZXN0UXVldWU6OnNraXAoaWQ6JWkpIG91dCBvZiByYW5nZSAoJWktJWkpXCIsIGluZGV4LCB0aGlzLl9vZmZzZXQsIHRoaXMuX29mZnNldCArICh0aGlzLl9udW1JdGVtcyAtIDEpKTtcblx0XHRcdHJldHVybiB2b2lkIDA7XG5cdFx0fVxuXHRcdGl0ZW0gPSB0aGlzLl9pdGVtc1tpXTtcblx0XHRpZiAoaXRlbSAhPT0gbnVsbCkge1xuXHRcdFx0Ly8gaWYgKGl0ZW0gPSB0aGlzLl9pdGVtc1tpXSkge1xuXHRcdFx0dGhpcy5faXRlbXNbaV0gPSBudWxsO1xuXHRcdFx0dGhpcy5fbnVtSXRlbXMtLTtcblxuXHRcdFx0Ly8gaWYgKHRoaXMuX251bUl0ZW1zID09IDApIHtcblx0XHRcdC8vIFx0dGhpcy5fZW1wdHkodGhpcy5fb2Zmc2V0ICsgdGhpcy5faXRlbXMubGVuZ3RoKTtcblx0XHRcdC8vIH1cblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiRnJhbWVRdWV1ZTo6UmVxdWVzdFF1ZXVlOjpza2lwKGlkOiVpKSBbbnVtSXRlbXM6JWldIHNraXBwaW5nXCIsIGluZGV4LCB0aGlzLl9udW1JdGVtcyk7XG5cdFx0fVxuXHRcdC8vIGVsc2Uge1xuXHRcdC8vIFx0Y29uc29sZS53YXJuKFwiRnJhbWVRdWV1ZTo6UmVxdWVzdFF1ZXVlOjpza2lwKGlkOiVpKSBbbnVtSXRlbXM6JWldIGl0ZW0gaXMgbnVsbFwiLCBpbmRleCwgdGhpcy5fbnVtSXRlbXMpO1xuXHRcdC8vIH1cblx0XHRyZXR1cm4gaXRlbTtcblx0fSxcblxuXHQvLyBmb3JFYWNoOiBmdW5jdGlvbihmbiwgY29udGV4dCkge1xuXHQvLyBcdHJldHVybiB0aGlzLml0ZW1zLmZvckVhY2goZm4sIGNvbnRleHQpO1xuXHQvLyB9LFxuXG5cdGluZGV4ZXM6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIC5tYXAoZnVuY3Rpb24obywgaSwgYSkge1xuXHRcdC8vIFx0cmV0dXJuIHRoaXNbby5pbmRleF07XG5cdFx0Ly8gfSwgdGhpcy5faXRlbXMpO1xuXHRcdHZhciBpdGVtcyA9IHRoaXMuX3ByaW9yaXRpZXMuY29uY2F0KCk7XG5cdFx0aXRlbXMuc29ydChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHRpZiAoYS5wcmlvcml0eSA+IGIucHJpb3JpdHkpXG5cdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0aWYgKGEucHJpb3JpdHkgPCBiLnByaW9yaXR5KVxuXHRcdFx0XHRyZXR1cm4gLTE7XG5cdFx0XHRyZXR1cm4gMDtcblx0XHR9KTtcblx0XHRpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uKG8sIGksIGEpIHtcblx0XHRcdGFbaV0gPSBvLmluZGV4O1xuXHRcdH0sIHRoaXMpO1xuXHRcdHJldHVybiBpdGVtcztcblx0fSxcblxuXHRpdGVtczogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gLm1hcChmdW5jdGlvbihvLCBpLCBhKSB7XG5cdFx0Ly8gXHRyZXR1cm4gdGhpc1tvLmluZGV4XTtcblx0XHQvLyB9LCB0aGlzLl9pdGVtcyk7XG5cdFx0dmFyIGl0ZW1zID0gdGhpcy5fcHJpb3JpdGllcy5jb25jYXQoKTtcblx0XHRpdGVtcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdGlmIChhLnByaW9yaXR5ID4gYi5wcmlvcml0eSlcblx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHRpZiAoYS5wcmlvcml0eSA8IGIucHJpb3JpdHkpXG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdHJldHVybiAwO1xuXHRcdH0pO1xuXHRcdGl0ZW1zLmZvckVhY2goZnVuY3Rpb24obywgaSwgYSkge1xuXHRcdFx0YVtpXSA9IHRoaXMuX2l0ZW1zW28uaW5kZXhdO1xuXHRcdH0sIHRoaXMpO1xuXHRcdHJldHVybiBpdGVtcztcblx0fSxcblxuXHRfZW1wdHk6IGZ1bmN0aW9uKG9mZnNldCkge1xuXHRcdHRoaXMuX29mZnNldCA9IG9mZnNldDtcblx0XHR0aGlzLl9pdGVtcy5sZW5ndGggPSAwO1xuXHRcdHRoaXMuX3ByaW9yaXRpZXMubGVuZ3RoID0gMDtcblx0XHR0aGlzLl9udW1JdGVtcyA9IDA7XG5cdH1cbn0sIHtcblxuXHRvZmZzZXQ6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX29mZnNldDtcblx0XHR9XG5cdH0sXG5cblx0bGVuZ3RoOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9pdGVtcy5sZW5ndGg7XG5cdFx0fVxuXHR9LFxuXG5cdG51bUl0ZW1zOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9udW1JdGVtcztcblx0XHR9XG5cdH0sXG59KTtcblxudmFyIF9uZXh0UXVldWUgPSBuZXcgUmVxdWVzdFF1ZXVlKDApO1xudmFyIF9jdXJyUXVldWUgPSBudWxsO1xuXG52YXIgX3BlbmRpbmcgPSBmYWxzZTtcbnZhciBfcnVubmluZyA9IGZhbHNlO1xudmFyIF9yYWZJZCA9IC0xO1xuXG4vKipcbi8qIEBwYXJhbSB0c3RhbXAge2ludH1cbi8qL1xudmFyIF9ydW5RdWV1ZSA9IGZ1bmN0aW9uKHRzdGFtcCkge1xuXHRpZiAoX3J1bm5pbmcpIHRocm93IG5ldyBFcnJvcihcInd0ZiEhIVwiKTtcblxuXHRfcmFmSWQgPSAtMTtcblx0X3J1bm5pbmcgPSB0cnVlO1xuXHRfY3VyclF1ZXVlID0gX25leHRRdWV1ZTtcblx0X25leHRRdWV1ZSA9IG5ldyBSZXF1ZXN0UXVldWUoX2N1cnJRdWV1ZS5vZmZzZXQgKyBfY3VyclF1ZXVlLmxlbmd0aCk7XG5cblx0Ly8gX2N1cnJRdWV1ZS5pdGVtcygpLmZvckVhY2goZnVuY3Rpb24oZm4sIGksIGEpIHtcblx0Ly8gXHRpZiAoZm4gIT09IG51bGwpIHtcblx0Ly8gXHRcdGZuKHRzdGFtcCk7XG5cdC8vIFx0fVxuXHQvLyB9KTtcblx0X2N1cnJRdWV1ZS5pbmRleGVzKCkuZm9yRWFjaChmdW5jdGlvbihpbmRleCwgaSwgYSkge1xuXHRcdHZhciBmbiA9IF9jdXJyUXVldWUuX2l0ZW1zW2luZGV4XTtcblx0XHRpZiAoZm4gIT09IG51bGwpIHtcblx0XHRcdGZuKHRzdGFtcCk7XG5cdFx0fVxuXHR9KTtcblx0X3J1bm5pbmcgPSBmYWxzZTtcblx0X2N1cnJRdWV1ZSA9IG51bGw7XG5cblx0aWYgKF9uZXh0UXVldWUubnVtSXRlbXMgPiAwKSB7XG5cdFx0X3JhZklkID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShfcnVuUXVldWUpO1xuXHR9XG59O1xuXG52YXIgRnJhbWVRdWV1ZSA9IE9iamVjdC5jcmVhdGUoe1xuXHQvKipcblx0LyogQHBhcmFtIGZuIHtGdW5jdGlvbn1cblx0LyogQHBhcmFtIHByaW9yaXR5IHtpbnR9XG5cdC8qIEByZXR1cm4ge2ludH1cblx0LyovXG5cdHJlcXVlc3Q6IGZ1bmN0aW9uKGZuLCBwcmlvcml0eSkge1xuXHRcdC8vIGlmICghX3J1bm5pbmcgJiYgIV9wZW5kaW5nKSB7XG5cdFx0Ly8gXHRfcGVuZGluZyA9IHRydWU7XG5cdFx0Ly8gXHRjb25zb2xlLndhcm4oXCJGcmFtZVF1ZXVlOjpyZXF1ZXN0IHNldEltbWVkaWF0ZTogcGVuZGluZ1wiKTtcblx0XHQvLyBcdHNldEltbWVkaWF0ZShmdW5jdGlvbigpIHtcblx0XHQvLyBcdFx0X3BlbmRpbmcgPSBmYWxzZTtcblx0XHQvLyBcdFx0aWYgKF9uZXh0UXVldWUubnVtSXRlbXMgPiAwKSB7XG5cdFx0Ly8gXHRcdFx0X3JhZklkID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZShfcnVuUXVldWUpO1xuXHRcdC8vIFx0XHRcdGNvbnNvbGUud2FybihcIkZyYW1lUXVldWU6OnJlcXVlc3Qgc2V0SW1tZWRpYXRlOiByYWY6JWkgZm9yICVpIGl0ZW1zXCIsIF9yYWZJZCwgX25leHRRdWV1ZS5udW1JdGVtcyk7XG5cdFx0Ly8gXHRcdH0gZWxzZSB7XG5cdFx0Ly8gXHRcdFx0Y29uc29sZS53YXJuKFwiRnJhbWVRdWV1ZTo6cmVxdWVzdCBzZXRJbW1lZGlhdGU6IG5vIGl0ZW1zXCIpO1xuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHR9KTtcblx0XHQvLyB9XG5cdFx0aWYgKCFfcnVubmluZyAmJiBfcmFmSWQgPT09IC0xKSB7XG5cdFx0XHRfcmFmSWQgPSB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKF9ydW5RdWV1ZSk7XG5cdFx0fVxuXHRcdHJldHVybiBfbmV4dFF1ZXVlLmVucXVldWUoZm4sIHByaW9yaXR5KTtcblx0fSxcblxuXHQvKipcblx0LyogQHBhcmFtIGlkIHtpbnR9XG5cdC8qIEByZXR1cm4ge0Z1bmN0aW9uP31cblx0LyovXG5cdGNhbmNlbDogZnVuY3Rpb24oaWQpIHtcblx0XHR2YXIgZm47XG5cdFx0aWYgKF9ydW5uaW5nKSB7XG5cdFx0XHRmbiA9IF9jdXJyUXVldWUuc2tpcChpZCkgfHwgX25leHRRdWV1ZS5za2lwKGlkKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Zm4gPSBfbmV4dFF1ZXVlLnNraXAoaWQpO1xuXHRcdFx0aWYgKChfcmFmSWQgIT09IC0xKSAmJiAoX25leHRRdWV1ZS5udW1JdGVtcyA9PT0gMCkpIHtcblx0XHRcdFx0d2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKF9yYWZJZCk7XG5cdFx0XHRcdF9yYWZJZCA9IC0xO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gZm47XG5cdH0sXG59LCB7XG5cdHJ1bm5pbmc6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIF9ydW5uaW5nO1xuXHRcdH1cblx0fVxufSk7XG5cbmlmIChERUJVRykge1xuXHQvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuXHR2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG5cdC8vIGNvbnNvbGUuaW5mbyhcIlVzaW5nIGFwcC92aWV3L2Jhc2UvRnJhbWVRdWV1ZVwiKTtcblxuXHQvLyBcdC8vIC8vIGxvZyBmcmFtZSBleGVjIHRpbWVcblx0Ly8gXHQvLyB2YXIgX25vdyA9IHdpbmRvdy5wZXJmb3JtYW5jZT9cblx0Ly8gXHQvLyBcdHdpbmRvdy5wZXJmb3JtYW5jZS5ub3cuYmluZCh3aW5kb3cucGVyZm9ybWFuY2UpIDpcblx0Ly8gXHQvLyBcdERhdGUubm93LmJpbmQoRGF0ZSk7XG5cdC8vIFx0Ly8gX3J1blF1ZXVlID0gXy53cmFwKF9ydW5RdWV1ZSwgZnVuY3Rpb24oZm4sIHRzdGFtcCkge1xuXHQvLyBcdC8vIFx0dmFyIHJldHZhbCwgdGZyYW1lO1xuXHQvLyBcdC8vIFx0Y29uc29sZS5sb2coXCJbRlJBTUUgQkVHSU5dIFslaW1zXSAlaSBpdGVtcyBbaWRzOiVpLSVpXVwiLCB0c3RhbXAsIF9uZXh0UXVldWUubnVtSXRlbXMsIF9uZXh0UXVldWUub2Zmc2V0LCBfbmV4dFF1ZXVlLm9mZnNldCArIF9uZXh0UXVldWUubGVuZ3RoKTtcblx0Ly8gXHQvLyBcdHRmcmFtZSA9IF9ub3coKTtcblx0Ly8gXHQvLyBcdHJldHZhbCA9IGZuKHRzdGFtcCk7XG5cdC8vIFx0Ly8gXHR0ZnJhbWUgPSBfbm93KCkgLSB0ZnJhbWU7XG5cdC8vIFx0Ly8gXHRjb25zb2xlLmxvZyhcIltGUkFNRSBFTkRFRF0gWyVpbXNdIHRvb2sgJWltc1xcbi0tLVxcblwiLCB0c3RhbXAgKyB0ZnJhbWUsIHRmcmFtZSk7XG5cdC8vIFx0Ly8gXHRpZiAoX25leHRRdWV1ZS5udW1JdGVtcyAhPSAwKSBjb25zb2xlLmluZm8oXCJbRlJBTUUgRU5ERURdICVpIGl0ZW1zIHNjaGVkdWxlZCBmb3IgW3JhZjolaV1cIiwgX25leHRRdWV1ZS5udW1JdGVtcywgX3JhZklkKTtcblx0Ly8gXHQvLyBcdHJldHVybiByZXR2YWw7XG5cdC8vIFx0Ly8gfSk7XG5cblx0Ly8gbG9nIGZyYW1lIGVuZFxuXHRfcnVuUXVldWUgPSBfLndyYXAoX3J1blF1ZXVlLCBmdW5jdGlvbihmbiwgdHN0YW1wKSB7XG5cdFx0dmFyIHJldHZhbDtcblx0XHRjb25zb2xlLmdyb3VwKFwiRnJhbWVRdWV1ZSBcIiArIF9yYWZJZCk7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJGcmFtZVF1ZXVlOjpfcnVuUXVldWUgJWkgaXRlbXMgKElEIHJhbmdlOiVpLSVpKVwiLCBfbmV4dFF1ZXVlLm51bUl0ZW1zLCBfbmV4dFF1ZXVlLm9mZnNldCwgX25leHRRdWV1ZS5vZmZzZXQgKyBfbmV4dFF1ZXVlLmxlbmd0aCAtIDEpO1xuXHRcdHJldHZhbCA9IGZuKHRzdGFtcCk7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJbRnJhbWUgZXhpdF1cXG4tLS1cXG5cIik7XG5cdFx0Y29uc29sZS5ncm91cEVuZCgpO1xuXHRcdHJldHVybiByZXR2YWw7XG5cdH0pO1xuXG5cdC8vIC8vIHVzZSBsb2cgcHJlZml4XG5cdC8vIGlmIChjb25zb2xlLnByZWZpeCkge1xuXHQvLyBcdF9ydW5RdWV1ZSA9IF8ud3JhcChfcnVuUXVldWUsIGZ1bmN0aW9uKGZuLCB0c3RhbXApIHtcblx0Ly8gXHRcdHZhciByZXR2YWwsIGxvZ3ByZWZpeDtcblx0Ly8gXHRcdGxvZ3ByZWZpeCA9IGNvbnNvbGUucHJlZml4O1xuXHQvLyBcdFx0Y29uc29sZS5wcmVmaXggKz0gXCJbcmFmOlwiICsgX3JhZklkICsgXCJdIFwiO1xuXHQvLyBcdFx0cmV0dmFsID0gZm4odHN0YW1wKTtcblx0Ly8gXHRcdGNvbnNvbGUucHJlZml4ID0gbG9ncHJlZml4O1xuXHQvLyBcdFx0cmV0dXJuIHJldHZhbDtcblx0Ly8gXHR9KTtcblx0Ly8gfVxuXG5cdC8vIEZyYW1lUXVldWUuY2FuY2VsID0gXy53cmFwKEZyYW1lUXVldWUuY2FuY2VsLCBmdW5jdGlvbihmbiwgaWQpIHtcblx0Ly8gXHRpZiAoKF9jdXJyUXVldWUgIT09IG51bGwpICYmIChfY3VyclF1ZXVlLm9mZnNldCA+PSBpZCkgJiYgKGlkIDwgX25leHRRdWV1ZS5vZmZzZXQpKSB7XG5cdC8vIFx0XHRjb25zb2xlLmluZm8oXCJGcmFtZVF1ZXVlOjpjYW5jZWwgSUQ6JWkgaW4gcnVubmluZyByYW5nZSAoJWktJWkpXCIsIGlkLCBfY3VyclF1ZXVlLm9mZnNldCwgX25leHRRdWV1ZS5vZmZzZXQgLSAxKTtcblx0Ly8gXHR9XG5cdC8vIFx0dmFyIHJhZklkID0gX3JhZklkO1xuXHQvLyBcdHZhciByZXR2YWwgPSBmbihpZCk7XG5cdC8vIFx0aWYgKHJldHZhbCA9PT0gdm9pZCAwKSB7XG5cdC8vIFx0XHRjb25zb2xlLndhcm4oXCJGcmFtZVF1ZXVlOjpjYW5jZWwgSUQ6JWkgbm90IGZvdW5kXCIsIGlkKTtcblx0Ly8gXHR9IGVsc2UgaWYgKHJldHZhbCA9PT0gbnVsbCkge1xuXHQvLyBcdFx0Y29uc29sZS53YXJuKFwiRnJhbWVRdWV1ZTo6Y2FuY2VsIElEOiVpIGFscmVhZHkgY2FuY2VsbGVkXCIsIGlkKTtcblx0Ly8gXHR9IGVsc2Uge1xuXHQvLyBcdFx0aWYgKCFfcnVubmluZyAmJiBfbmV4dFF1ZXVlLm51bUl0ZW1zID09IDApIHtcblx0Ly8gXHRcdFx0Y29uc29sZS5pbmZvKFwiRnJhbWVRdWV1ZTo6Y2FuY2VsIHJhZjolaSBjYW5jZWxsZWQgKElEOiVpIGNhbmNlbGxlZCwgZW1wdHkgcXVldWUpXCIsIHJhZklkLCBpZCk7XG5cdC8vIFx0XHR9XG5cdC8vIFx0fVxuXHQvLyBcdHJldHVybiByZXR2YWw7XG5cdC8vIH0pO1xufVxuXG5cbm1vZHVsZS5leHBvcnRzID0gRnJhbWVRdWV1ZTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvYmFzZS9JbnRlcnBvbGF0b3JcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL2Vhc2UvbGluZWFyfSAqL1xudmFyIGxpbmVhciA9IHJlcXVpcmUoXCJ1dGlscy9lYXNlL2xpbmVhclwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9JbnRlcnBvbGF0b3J9XG4gKi9cbmZ1bmN0aW9uIEludGVycG9sYXRvcih2YWx1ZXMsIG1heFZhbHVlcykge1xuXHR0aGlzLl92YWx1ZURhdGEgPSB7fTtcblx0dGhpcy5fbWF4VmFsdWVzID0ge307XG5cdHRoaXMuX3JlbmRlcmFibGVLZXlzID0gW107XG5cblx0dmFyIGtleSwgdmFsLCBtYXhWYWw7XG5cdGZvciAoa2V5IGluIHZhbHVlcykge1xuXHRcdHZhbCA9IHZhbHVlc1trZXldO1xuXHRcdG1heFZhbCA9IG1heFZhbHVlc1trZXldIHx8IG51bGw7XG5cdFx0Ly8gY3JlYXRlIHZhbHVlIG9iamVjdCBhbmQgc3RvcmUgaXRcblx0XHR0aGlzLl92YWx1ZURhdGFba2V5XSA9IHRoaXMuX2luaXRWYWx1ZSh2YWwsIDAsIG1heFZhbCk7XG5cdFx0Ly8gYWRkIG1heFZhbHVlIHRvIHN0b3JlXG5cdFx0dGhpcy5fbWF4VmFsdWVzW2tleV0gPSBtYXhWYWw7XG5cdFx0Ly8gYWRkIHRvIG5leHQgcmVuZGVyIGxpc3Rcblx0XHR0aGlzLl9yZW5kZXJhYmxlS2V5cy5wdXNoKGtleSk7XG5cdH1cblx0dGhpcy5fdmFsdWVzQ2hhbmdlZCA9IHRoaXMuX3JlbmRlcmFibGVLZXlzLmxlbmd0aCA+IDA7XG59XG5cbkludGVycG9sYXRvci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHtcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBwdWJsaWMgaW50ZXJmYWNlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGlzQXRUYXJnZXQ6IGZ1bmN0aW9uKGtleSkge1xuXHRcdHJldHVybiB0aGlzLl9yZW5kZXJhYmxlS2V5cy5pbmRleE9mKGtleSkgPT09IC0xO1xuXHR9LFxuXG5cdGdldFZhbHVlOiBmdW5jdGlvbihrZXkpIHtcblx0XHRyZXR1cm4gdGhpcy5fdmFsdWVEYXRhW2tleV0uX3ZhbHVlO1xuXHR9LFxuXG5cdGdldFJlbmRlcmVkVmFsdWU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdHJldHVybiB0aGlzLl92YWx1ZURhdGFba2V5XS5fcmVuZGVyZWRWYWx1ZTtcblx0fSxcblxuXHR2YWx1ZVRvOiBmdW5jdGlvbih2YWx1ZSwgZHVyYXRpb24sIGtleSkge1xuXHRcdHZhciBjaGFuZ2VkLCBkYXRhT2JqID0gdGhpcy5fdmFsdWVEYXRhW2tleV07XG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6dmFsdWVUbyBbJXNdXCIsIFwiW2ludGVycG9sYXRvcl1cIiwga2V5LCB2YWx1ZSk7XG5cdFx0aWYgKEFycmF5LmlzQXJyYXkoZGF0YU9iaikpIHtcblx0XHRcdGNoYW5nZWQgPSB2YWx1ZS5yZWR1Y2UoZnVuY3Rpb24ocHJldkNoYW5nZWQsIGl0ZW1WYWx1ZSwgaSkge1xuXHRcdFx0XHRpZiAoZGF0YU9ialtpXSkge1xuXHRcdFx0XHRcdGRhdGFPYmpbaV0gPSB0aGlzLl9pbml0TnVtYmVyKGl0ZW1WYWx1ZSwgZHVyYXRpb24sIHRoaXMuX21heFZhbHVlc1trZXldKTtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gdGhpcy5fc2V0VmFsdWUoaXRlbVZhbHVlLCBkdXJhdGlvbiwgZGF0YU9ialtpXSkgfHwgcHJldkNoYW5nZWQ7XG5cdFx0XHRcdH1cblx0XHRcdH0uYmluZCh0aGlzKSwgY2hhbmdlZCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNoYW5nZWQgPSB0aGlzLl9zZXRWYWx1ZSh2YWx1ZSwgZHVyYXRpb24sIGRhdGFPYmopO1xuXHRcdH1cblx0XHRpZiAoY2hhbmdlZCkge1xuXHRcdFx0dGhpcy5fcmVuZGVyYWJsZUtleXMuaW5kZXhPZihrZXkpICE9PSAtMSB8fCB0aGlzLl9yZW5kZXJhYmxlS2V5cy5wdXNoKGtleSk7XG5cdFx0XHR0aGlzLl92YWx1ZXNDaGFuZ2VkID0gdHJ1ZTtcblx0XHRcdC8vIHRoaXMucmVuZGVyKCk7XG5cdFx0XHQvLyB0aGlzLnJlcXVlc3RSZW5kZXIoKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0dXBkYXRlVmFsdWU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdC8vIENhbGwgX2ludGVycG9sYXRlVmFsdWUgb25seSBpZiBuZWVkZWQuIF9pbnRlcnBvbGF0ZVZhbHVlKCkgcmV0dXJucyBmYWxzZVxuXHRcdC8vIG9uY2UgaW50ZXJwb2xhdGlvbiBpcyBkb25lLCBpbiB3aGljaCBjYXNlIHJlbW92ZSBrZXkgZnJvbSBfcmVuZGVyYWJsZUtleXMuXG5cdFx0dmFyIGtJbmRleCA9IHRoaXMuX3JlbmRlcmFibGVLZXlzLmluZGV4T2Yoa2V5KTtcblx0XHRpZiAoa0luZGV4ICE9PSAtMSAmJiAhdGhpcy5faW50ZXJwb2xhdGVWYWx1ZShrZXkpKSB7XG5cdFx0XHR0aGlzLl9yZW5kZXJhYmxlS2V5cy5zcGxpY2Uoa0luZGV4LCAxKTtcblx0XHRcdHRoaXMuX3ZhbHVlc0NoYW5nZWQgPSB0aGlzLl9yZW5kZXJhYmxlS2V5cy5sZW5ndGggPiAwO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBwcml2YXRlOiB2YWx1ZURhdGFcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2luaXRWYWx1ZTogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBtYXhWYWwpIHtcblx0XHRpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcblx0XHRcdHJldHVybiB2YWx1ZS5tYXAoZnVuY3Rpb24odmFsKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9pbml0TnVtYmVyKHZhbCwgMCwgbWF4VmFsKTtcblx0XHRcdH0sIHRoaXMpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5faW5pdE51bWJlcih2YWx1ZSwgMCwgbWF4VmFsKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gX2luaXRBcnJheTogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBtYXhWYWwpIHtcblx0Ly8gXHRyZXR1cm4gdmFsLm1hcChmdW5jdGlvbih2YWwpIHtcblx0Ly8gXHRcdHJldHVybiB0aGlzLl9pbml0TnVtYmVyKHZhbCwgMCwgbWF4VmFsKTtcblx0Ly8gXHR9LCB0aGlzKTtcblx0Ly8gfSxcblxuXHRfaW5pdE51bWJlcjogZnVuY3Rpb24odmFsdWUsIGR1cmF0aW9uLCBtYXhWYWwpIHtcblx0XHR2YXIgbyA9IHt9O1xuXHRcdG8uX3ZhbHVlID0gdmFsdWU7XG5cdFx0by5fc3RhcnRWYWx1ZSA9IHZhbHVlO1xuXHRcdG8uX3ZhbHVlRGVsdGEgPSAwO1xuXG5cdFx0by5fZHVyYXRpb24gPSBkdXJhdGlvbiB8fCAwO1xuXHRcdG8uX3N0YXJ0VGltZSA9IC0xO1xuXHRcdG8uX2VsYXBzZWRUaW1lID0gMDtcblxuXHRcdG8uX2xhc3RSZW5kZXJlZFZhbHVlID0gby5fcmVuZGVyZWRWYWx1ZSA9IG51bGw7XG5cblx0XHRvLl9tYXhWYWwgPSBtYXhWYWw7XG5cdFx0Ly8gaWYgKG1heFZhbCAhPT0gdm9pZCAwKSBvLl9tYXhWYWwgPSBtYXhWYWw7XG5cdFx0Ly8gby5fbWF4VmFsID0gdGhpcy5fbWF4VmFsdWVzW2tleV07XG5cdFx0Ly8gby5fbWF4VmFsID0gdGhpcy5fbWF4VmFsOy8vIEZJWE1FXG5cdFx0cmV0dXJuIG87XG5cdH0sXG5cblx0X3NldFZhbHVlOiBmdW5jdGlvbih2YWx1ZSwgZHVyYXRpb24sIG8pIHtcblx0XHRpZiAoby5fdmFsdWUgIT0gdmFsdWUpIHtcblx0XHRcdG8uX3N0YXJ0VmFsdWUgPSBvLl92YWx1ZTtcblx0XHRcdG8uX3ZhbHVlRGVsdGEgPSB2YWx1ZSAtIG8uX3ZhbHVlO1xuXHRcdFx0by5fdmFsdWUgPSB2YWx1ZTtcblxuXHRcdFx0by5fZHVyYXRpb24gPSBkdXJhdGlvbiB8fCAwO1xuXHRcdFx0by5fc3RhcnRUaW1lID0gLTE7XG5cdFx0XHRvLl9lbGFwc2VkVGltZSA9IDA7XG5cblx0XHRcdG8uX2xhc3RSZW5kZXJlZFZhbHVlID0gby5fcmVuZGVyZWRWYWx1ZTtcblxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBwcml2YXRlOiBpbnRlcnBvbGF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGludGVycG9sYXRlOiBmdW5jdGlvbih0c3RhbXApIHtcblx0XHRpZiAodGhpcy5fdmFsdWVzQ2hhbmdlZCkge1xuXHRcdFx0dGhpcy5fdmFsdWVzQ2hhbmdlZCA9IGZhbHNlO1xuXG5cdFx0XHR2YXIgY2hhbmdlZEtleXMgPSB0aGlzLl9yZW5kZXJhYmxlS2V5cztcblx0XHRcdHRoaXMuX3RzdGFtcCA9IHRzdGFtcDtcblx0XHRcdHRoaXMuX3JlbmRlcmFibGVLZXlzID0gY2hhbmdlZEtleXMuZmlsdGVyKHRoaXMuX2ludGVycG9sYXRlVmFsdWUsIHRoaXMpO1xuXHRcdFx0dGhpcy5fcmVuZGVyZWRLZXlzID0gY2hhbmdlZEtleXM7XG5cblx0XHRcdGlmICh0aGlzLl9yZW5kZXJhYmxlS2V5cy5sZW5ndGggIT09IDApIHtcblx0XHRcdFx0dGhpcy5fdmFsdWVzQ2hhbmdlZCA9IHRydWU7XG5cdFx0XHRcdC8vIFx0Ly8gdGhpcy5yZXF1ZXN0UmVuZGVyKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OmludGVycG9sYXRlIHZhbHVlc0NoYW5nZWQ6JXMgdHN0YW1wOiVmXCIsIFwiW2ludGVycG9sYXRvcl1cIiwgdGhpcy5fdmFsdWVzQ2hhbmdlZCwgdHN0YW1wKTtcblx0XHQvLyByZXR1cm4gdGhpcy5fdmFsdWVzQ2hhbmdlZDtcblx0XHQvLyByZXR1cm4gdGhpcy52YWx1ZXNDaGFuZ2VkO1xuXG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X2ludGVycG9sYXRlVmFsdWU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdHZhciBkYXRhT2JqID0gdGhpcy5fdmFsdWVEYXRhW2tleV07XG5cdFx0aWYgKEFycmF5LmlzQXJyYXkoZGF0YU9iaikpIHtcblx0XHRcdHJldHVybiBkYXRhT2JqLnJlZHVjZShmdW5jdGlvbihjb250aW51ZU5leHQsIG8sIGluZGV4LCBhcnIpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2ludGVycG9sYXRlTnVtYmVyKHRoaXMuX3RzdGFtcCwgbykgfHwgY29udGludWVOZXh0O1xuXHRcdFx0fS5iaW5kKHRoaXMpLCBmYWxzZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB0aGlzLl9pbnRlcnBvbGF0ZU51bWJlcih0aGlzLl90c3RhbXAsIGRhdGFPYmopO1xuXHRcdH1cblx0fSxcblxuXHRfaW50ZXJwb2xhdGVOdW1iZXI6IGZ1bmN0aW9uKHRzdGFtcCwgbykge1xuXHRcdGlmIChvLl9zdGFydFRpbWUgPCAwKSB7XG5cdFx0XHRvLl9zdGFydFRpbWUgPSB0c3RhbXA7XG5cdFx0fVxuXHRcdHZhciBlbGFwc2VkID0gdHN0YW1wIC0gby5fc3RhcnRUaW1lO1xuXHRcdG8uX2VsYXBzZWRUaW1lID0gZWxhcHNlZDtcblx0XHRvLl9sYXN0UmVuZGVyZWRWYWx1ZSA9IG8uX3JlbmRlcmVkVmFsdWU7XG5cdFx0aWYgKGVsYXBzZWQgPCBvLl9kdXJhdGlvbikge1xuXHRcdFx0aWYgKG8uX21heFZhbCAmJiBvLl92YWx1ZURlbHRhIDwgMCkge1xuXHRcdFx0XHQvLyB1cHBlci1ib3VuZCB2YWx1ZXNcblx0XHRcdFx0by5fcmVuZGVyZWRWYWx1ZSA9IGxpbmVhcihlbGFwc2VkLCBvLl9zdGFydFZhbHVlLFxuXHRcdFx0XHRcdG8uX3ZhbHVlRGVsdGEgKyBvLl9tYXhWYWwsIG8uX2R1cmF0aW9uKSAtIG8uX21heFZhbDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIHVuYm91bmQgdmFsdWVzXG5cdFx0XHRcdG8uX3JlbmRlcmVkVmFsdWUgPSBsaW5lYXIoZWxhcHNlZCwgby5fc3RhcnRWYWx1ZSxcblx0XHRcdFx0XHRvLl92YWx1ZURlbHRhLCBvLl9kdXJhdGlvbik7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0by5fcmVuZGVyZWRWYWx1ZSA9IG8uX3ZhbHVlO1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fSxcbn0sIHtcblx0dmFsdWVzQ2hhbmdlZDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fdmFsdWVzQ2hhbmdlZDtcblx0XHR9XG5cdH0sXG5cdHJlbmRlcmFibGVLZXlzOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9yZW5kZXJhYmxlS2V5cztcblx0XHR9XG5cdH0sXG5cdHJlbmRlcmVkS2V5czoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fcmVuZGVyZWRLZXlzO1xuXHRcdH1cblx0fSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEludGVycG9sYXRvcjtcbiIsIi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkRXZlbnR9ICovXG52YXIgcHJlZml4ZWRFdmVudCA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZEV2ZW50XCIpO1xuXG52YXIgZXZlbnRNYXAgPSB7XG5cdFwidHJhbnNpdGlvbmVuZFwiOiBwcmVmaXhlZEV2ZW50KFwidHJhbnNpdGlvbmVuZFwiKSxcblx0XCJmdWxsc2NyZWVuY2hhbmdlXCI6IHByZWZpeGVkRXZlbnQoXCJmdWxsc2NyZWVuY2hhbmdlXCIsIGRvY3VtZW50KSxcblx0XCJmdWxsc2NyZWVuZXJyb3JcIjogcHJlZml4ZWRFdmVudChcImZ1bGxzY3JlZW5lcnJvclwiLCBkb2N1bWVudCksXG5cdFwidmlzaWJpbGl0eWNoYW5nZVwiOiBwcmVmaXhlZEV2ZW50KFwidmlzaWJpbGl0eWNoYW5nZVwiLCBkb2N1bWVudCwgXCJoaWRkZW5cIilcbn07XG5cbnZhciBldmVudE51bSA9IDA7XG5mb3IgKHZhciBldmVudE5hbWUgaW4gZXZlbnRNYXApIHtcblx0aWYgKGV2ZW50TmFtZSA9PT0gZXZlbnRNYXBbZXZlbnROYW1lXSkge1xuXHRcdGRlbGV0ZSBldmVudE1hcFtldmVudE5hbWVdO1xuXHR9IGVsc2Uge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShldmVudE1hcCwgZXZlbnROYW1lLCB7XG5cdFx0XHR2YWx1ZTogZXZlbnRNYXBbZXZlbnROYW1lXSxcblx0XHRcdGVudW1lcmFibGU6IHRydWVcblx0XHR9KTtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnRNYXAsIGV2ZW50TnVtLCB7XG5cdFx0XHR2YWx1ZTogZXZlbnROYW1lLFxuXHRcdFx0ZW51bWVyYWJsZTogZmFsc2Vcblx0XHR9KTtcblx0XHRldmVudE51bSsrO1xuXHR9XG59XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXZlbnRNYXAsIFwibGVuZ3RoXCIsIHtcblx0dmFsdWU6IGV2ZW50TnVtXG59KTtcblxuaWYgKERFQlVHKSB7XG5cdGNvbnNvbGUubG9nKFwicHJlZml4ZXMgZW5hYmxlZCBmb3IgJWkgZXZlbnRzXCIsIGV2ZW50TWFwLmxlbmd0aCwgT2JqZWN0LmtleXMoZXZlbnRNYXApKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBldmVudE1hcDtcblxuLy8gbW9kdWxlLmV4cG9ydHMgPSBldmVudE51bSA+IDA/IGV2ZW50TWFwIDogbnVsbDtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9iYXNlL1RvdWNoTWFuYWdlclxuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG4vLyB2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6aGFtbWVyanN9ICovXG52YXIgSGFtbWVyID0gcmVxdWlyZShcImhhbW1lcmpzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzLlRhcH0gKi9cbnZhciBUYXAgPSBIYW1tZXIuVGFwO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvdG91Y2gvU21vb3RoUGFuUmVjb2duaXplcn0gKi9cbnZhciBQYW4gPSByZXF1aXJlKFwidXRpbHMvdG91Y2gvU21vb3RoUGFuUmVjb2duaXplclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzLlBhbn0gKi9cbi8vIHZhciBQYW4gPSBIYW1tZXIuUGFuO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBTdGF0aWMgcHJpdmF0ZVxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vKipcbiAqIEBwYXJhbSBlbCBIVE1MRWxlbWVudFxuICogQHJldHVybiB7SGFtbWVyLk1hbmFnZXJ9XG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUluc3RhbmNlKGVsKSB7XG5cdHZhciBtYW5hZ2VyLCBocGFuLCB2cGFuLCB0YXA7XG5cdGhwYW4gPSBuZXcgUGFuKHtcblx0XHQvLyB0aHJlc2hvbGQ6IEdsb2JhbHMuUEFOX1RIUkVTSE9MRCxcblx0XHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fSE9SSVpPTlRBTCxcblx0XHRldmVudDogXCJocGFuXCIsXG5cdH0pO1xuXHR2cGFuID0gbmV3IFBhbih7XG5cdFx0Ly8gdGhyZXNob2xkOiBHbG9iYWxzLlBBTl9USFJFU0hPTEQsXG5cdFx0ZGlyZWN0aW9uOiBIYW1tZXIuRElSRUNUSU9OX1ZFUlRJQ0FMLFxuXHRcdGV2ZW50OiBcInZwYW5cIixcblx0fSk7XG5cdHRhcCA9IG5ldyBUYXAoe1xuXHRcdC8vIHRocmVzaG9sZDogR2xvYmFscy5QQU5fVEhSRVNIT0xEIC0gMVxuXHR9KTtcblx0bWFuYWdlciA9IG5ldyBIYW1tZXIuTWFuYWdlcihlbCk7XG5cdG1hbmFnZXIuYWRkKFt0YXAsIGhwYW4sIHZwYW5dKTtcblx0dnBhbi5yZXF1aXJlRmFpbHVyZShocGFuKTtcblx0Ly8gbWFuYWdlci5zZXQoeyBkb21ldmVudHM6IHRydWUgfSk7XG5cdHJldHVybiBtYW5hZ2VyO1xufVxuXG4vLyBmdW5jdGlvbiBjcmVhdGVJbnN0YW5jZShlbCkge1xuLy8gXHRyZXR1cm4gbmV3IEhhbW1lcihlbCwge1xuLy8gXHRcdHJlY29nbml6ZXJzOiBbXG4vLyBcdFx0XHRbVGFwXSxcbi8vIFx0XHRcdFtQYW4sIHtcbi8vIFx0XHRcdFx0ZXZlbnQ6ICdocGFuJyxcbi8vIFx0XHRcdFx0ZGlyZWN0aW9uOiBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUwsXG4vLyBcdFx0XHRcdHRocmVzaG9sZDogR2xvYmFscy5USFJFU0hPTERcbi8vIFx0XHRcdH1dLFxuLy8gXHRcdFx0W1Bhbiwge1xuLy8gXHRcdFx0XHRldmVudDogJ3ZwYW4nLFxuLy8gXHRcdFx0XHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwsXG4vLyBcdFx0XHRcdHRocmVzaG9sZDogR2xvYmFscy5USFJFU0hPTERcbi8vIFx0XHRcdH0sIFsnaHBhbiddXVxuLy8gXHRcdF1cbi8vIFx0fSk7XG4vLyB9XG5cbi8vIGZ1bmN0aW9uIGNyZWF0ZUluc3RhbmNlKGVsKSB7XG4vLyBcdHZhciByZWNvZ25pemVycyA9IFtdO1xuLy8gXHR2YXIgbWFuYWdlciA9IG5ldyBIYW1tZXIuTWFuYWdlcihlbCk7XG4vL1xuLy8gXHR2YXIgaHBhbiA9IG5ldyBQYW4oe1xuLy8gXHRcdGV2ZW50OiBcImhwYW5cIixcbi8vIFx0XHR0aHJlc2hvbGQ6IEdsb2JhbHMuVEhSRVNIT0xELFxuLy8gXHRcdGRpcmVjdGlvbjogSGFtbWVyLkRJUkVDVElPTl9IT1JJWk9OVEFMXG4vLyBcdH0pO1xuLy9cbi8vIFx0dmFyIHZwYW4gPSBuZXcgUGFuKHtcbi8vIFx0XHRldmVudDogXCJ2cGFuXCIsXG4vLyBcdFx0dGhyZXNob2xkOiBHbG9iYWxzLlRIUkVTSE9MRCxcbi8vIFx0XHRkaXJlY3Rpb246IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUxcbi8vIFx0fSk7XG4vL1xuLy8gXHR2YXIgdGFwID0gbmV3IEhhbW1lci5UYXAoKTtcbi8vIFx0Ly8gdmFyIHRhcCA9IG5ldyBIYW1tZXIuVGFwKHtcbi8vIFx0Ly8gXHR0aHJlc2hvbGQ6IEdsb2JhbHMuVEhSRVNIT0xEIC0gMSxcbi8vIFx0Ly8gXHRpbnRlcnZhbDogNTAsXG4vLyBcdC8vIFx0dGltZTogMjAwXG4vLyBcdC8vIH0pO1xuLy8gXHRyZWNvZ25pemVycy5wdXNoKHZwYW4pO1xuLy8gXHRyZWNvZ25pemVycy5wdXNoKGhwYW4pO1xuLy8gXHRyZWNvZ25pemVycy5wdXNoKHRhcCk7XG4vLyBcdG1hbmFnZXIuYWRkKHJlY29nbml6ZXJzKTtcbi8vXG4vLyBcdGhwYW4ucmVjb2duaXplV2l0aChbdnBhbl0pO1xuLy8gXHRocGFuLnJlcXVpcmVGYWlsdXJlKFt2cGFuXSk7XG4vLyBcdHRhcC5yZWNvZ25pemVXaXRoKFt2cGFuLCBocGFuXSk7XG4vL1xuLy8gXHQvLyB0YXAucmVxdWlyZUZhaWx1cmUodnBhbik7XG4vL1xuLy8gXHQvLyBtYW5hZ2VyLnNldCh7IGRvbWV2ZW50czogdHJ1ZSB9KTtcbi8vIFx0cmV0dXJuIG1hbmFnZXI7XG4vLyB9XG5cbi8qaHR0cHM6Ly9naXN0LmdpdGh1YnVzZXJjb250ZW50LmNvbS9qdGFuZ2VsZGVyLzM2MTA1Mjk3NmYwNDQyMDBlYTE3L3Jhdy9mNTRjMmNlZjc4ZDU5ZGEzZjM4Mjg2ZmFkNjgzNDcxZTFjOTc2MDcyL1ByZXZlbnRHaG9zdENsaWNrLmpzKi9cblxuLy8gZnVuY3Rpb25cdGxvZ0V2ZW50KG1lc3NhZ2UpIHtcbi8vIFx0Y29uc29sZS5sb2cobWVzc2FnZSwgZG9tZXYudHlwZSxcbi8vIFx0XHRcInBhblNlc3Npb25PcGVuZWQ6IFwiICsgcGFuU2Vzc2lvbk9wZW5lZCxcbi8vIFx0XHRcImRlZmF1bHRQcmV2ZW50ZWQ6IFwiICsgZG9tZXYuZGVmYXVsdFByZXZlbnRlZFxuLy8gXHQpO1xuLy8gfVxuXG52YXIgbGFzdFRpbWVTdGFtcCA9IC0xO1xudmFyIHBhblNlc3Npb25PcGVuZWQgPSBmYWxzZTtcbnZhciB1cEV2ZW50TmFtZSA9IHdpbmRvdy5oYXNPd25Qcm9wZXJ0eShcIm9ucG9pbnRlcnVwXCIpID8gXCJwb2ludGVydXBcIiA6IFwibW91c2V1cFwiO1xuXG52YXIgdG91Y2hIYW5kbGVycyA9IHt9O1xudG91Y2hIYW5kbGVyc1tcInZwYW5zdGFydCB2cGFuZW5kIHZwYW5jYW5jZWwgaHBhbnN0YXJ0IGhwYW5lbmQgaHBhbmNhbmNlbFwiXSA9IGZ1bmN0aW9uKGhldikge1xuXHQvLyBjb25zb2xlLmxvZyhcIlRvdWNoTWFuYWdlcjpbJXNdXCIsIGhldi5zcmNFdmVudC50eXBlKTtcblx0cGFuU2Vzc2lvbk9wZW5lZCA9ICFoZXYuaXNGaW5hbDtcblx0aWYgKGhldi5pc0ZpbmFsKVxuXHRcdGxhc3RUaW1lU3RhbXAgPSBoZXYuc3JjRXZlbnQudGltZVN0YW1wO1xufTtcbi8vIHRvdWNoSGFuZGxlcnNbXCJoYW1tZXIuaW5wdXQgdGFwIHZwYW5tb3ZlIGhwYW5tb3ZlXCJdID0gZnVuY3Rpb24oaGV2KSB7XG4vLyBcdGNvbnNvbGUubG9nKFwiVG91Y2hNYW5hZ2VyOlslcyAtPiAlc11cIiwgaGV2LnNyY0V2ZW50LnR5cGUsIGhldi50eXBlKTtcbi8vIH07XG5cbnZhciBjYXB0dXJlSGFuZGxlcnMgPSB7fTtcbmNhcHR1cmVIYW5kbGVyc1tcImNsaWNrXCJdID0gZnVuY3Rpb24oZG9tZXYpIHtcblx0aWYgKGxhc3RUaW1lU3RhbXAgPT0gZG9tZXYudGltZVN0YW1wKSB7XG5cdFx0bGFzdFRpbWVTdGFtcCA9IC0xO1xuXHRcdGRvbWV2LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZG9tZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRkb21ldi5zdG9wUHJvcGFnYXRpb24oKTtcblx0fVxufTtcbmNhcHR1cmVIYW5kbGVyc1tcImRyYWdzdGFydFwiXSA9IGZ1bmN0aW9uKGRvbWV2KSB7XG5cdGlmIChkb21ldi50YXJnZXQubm9kZU5hbWUgPT0gXCJJTUdcIikge1xuXHRcdGRvbWV2LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZG9tZXYucHJldmVudERlZmF1bHQoKTtcblx0fVxufTtcbmNhcHR1cmVIYW5kbGVyc1t1cEV2ZW50TmFtZV0gPSBmdW5jdGlvbihkb21ldikge1xuXHRwYW5TZXNzaW9uT3BlbmVkICYmIGRvbWV2LnByZXZlbnREZWZhdWx0KCk7XG59O1xuXG52YXIgYnViYmxpbmdIYW5kbGVycyA9IHt9O1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vL1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5mdW5jdGlvbiBhZGRIYW5kbGVycygpIHtcblx0dmFyIGV2ZW50TmFtZSwgZWwgPSBpbnN0YW5jZS5lbGVtZW50O1xuXHRmb3IgKGV2ZW50TmFtZSBpbiB0b3VjaEhhbmRsZXJzKVxuXHRcdGlmICh0b3VjaEhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2ZW50TmFtZSkpXG5cdFx0XHRpbnN0YW5jZS5vbihldmVudE5hbWUsIHRvdWNoSGFuZGxlcnNbZXZlbnROYW1lXSk7XG5cdGZvciAoZXZlbnROYW1lIGluIGNhcHR1cmVIYW5kbGVycylcblx0XHRpZiAoY2FwdHVyZUhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2ZW50TmFtZSkpXG5cdFx0XHRlbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgY2FwdHVyZUhhbmRsZXJzW2V2ZW50TmFtZV0sIHRydWUpO1xuXHRmb3IgKGV2ZW50TmFtZSBpbiBidWJibGluZ0hhbmRsZXJzKVxuXHRcdGlmIChidWJibGluZ0hhbmRsZXJzLmhhc093blByb3BlcnR5KGV2ZW50TmFtZSkpXG5cdFx0XHRlbC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgYnViYmxpbmdIYW5kbGVyc1tldmVudE5hbWVdLCBmYWxzZSk7XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUhhbmRsZXJzKCkge1xuXHR2YXIgZXZlbnROYW1lLCBlbCA9IGluc3RhbmNlLmVsZW1lbnQ7XG5cdGZvciAoZXZlbnROYW1lIGluIGNhcHR1cmVIYW5kbGVycylcblx0XHRpZiAoY2FwdHVyZUhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2ZW50TmFtZSkpXG5cdFx0XHRlbC5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgY2FwdHVyZUhhbmRsZXJzW2V2ZW50TmFtZV0sIHRydWUpO1xuXHRmb3IgKGV2ZW50TmFtZSBpbiBidWJibGluZ0hhbmRsZXJzKVxuXHRcdGlmIChjYXB0dXJlSGFuZGxlcnMuaGFzT3duUHJvcGVydHkoZXZlbnROYW1lKSlcblx0XHRcdGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBidWJibGluZ0hhbmRsZXJzW2V2ZW50TmFtZV0sIHRydWUpO1xufVxuXG4vKiogQHR5cGUge0hhbW1lci5NYW5hZ2VyfSAqL1xudmFyIGluc3RhbmNlID0gbnVsbDtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogU3RhdGljIHB1YmxpY1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG52YXIgVG91Y2hNYW5hZ2VyID0ge1xuXHRpbml0OiBmdW5jdGlvbih0YXJnZXQpIHtcblx0XHRpZiAoaW5zdGFuY2UgPT09IG51bGwpIHtcblx0XHRcdGluc3RhbmNlID0gY3JlYXRlSW5zdGFuY2UodGFyZ2V0KTtcblx0XHRcdGFkZEhhbmRsZXJzKCk7XG5cdFx0fSBlbHNlIGlmIChpbnN0YW5jZS5lbGVtZW50ICE9PSB0YXJnZXQpIHtcblx0XHRcdGNvbnNvbGUud2FybihcIlRvdWNoTWFuYWdlciBhbHJlYWR5IGluaXRpYWxpemVkIHdpdGggYW5vdGhlciBlbGVtZW50XCIpO1xuXHRcdH1cblx0XHRyZXR1cm4gaW5zdGFuY2U7XG5cdH0sXG5cblx0ZGVzdHJveTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKGluc3RhbmNlICE9PSBudWxsKSB7XG5cdFx0XHRyZW1vdmVIYW5kbGVycygpO1xuXHRcdFx0aW5zdGFuY2UuZGVzdHJveSgpO1xuXHRcdFx0aW5zdGFuY2UgPSBudWxsO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJubyBpbnN0YW5jZSB0byBkZXN0cm95XCIpO1xuXHRcdH1cblx0fSxcblxuXHRnZXRJbnN0YW5jZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKGluc3RhbmNlID09PSBudWxsKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiVG91Y2hNYW5hZ2VyIGhhcyBub3QgYmVlbiBpbml0aWFsaXplZFwiKTtcblx0XHR9XG5cdFx0cmV0dXJuIGluc3RhbmNlO1xuXHR9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRvdWNoTWFuYWdlcjsiLCIvKiBnbG9iYWwgSFRNTEVsZW1lbnQsIE11dGF0aW9uT2JzZXJ2ZXIgKi9cbi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9iYXNlL1ZpZXdcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vKiBNdXRhdGlvbk9ic2VydmVyXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbnZhciBfY2lkU2VlZCA9IDE7XG52YXIgX3ZpZXdzQnlDaWQgPSB7fTtcblxuZnVuY3Rpb24gYWRkQ2hpbGRWaWV3cyhlbCkge1xuXHR2YXIgdmlldywgZWxzID0gZWwucXVlcnlTZWxlY3RvckFsbChcIipbZGF0YS1jaWRdXCIpO1xuXHRmb3IgKHZhciBpID0gMCwgaWkgPSBlbHMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdHZpZXcgPSBWaWV3LmZpbmRCeUVsZW1lbnQoZWxzLml0ZW0oaSkpO1xuXHRcdGlmICh2aWV3KSB7XG5cdFx0XHRpZiAoIXZpZXcuYXR0YWNoZWQpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJWaWV3OjpbYXR0YWNoZWQgKHBhcmVudCldICVzXCIsIHZpZXcuY2lkKTtcblx0XHRcdFx0dmlldy5fZWxlbWVudEF0dGFjaGVkKCk7XG5cdFx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHRcdC8vIFx0Y29uc29sZS53YXJuKFwiVmlldzo6W2F0dGFjaGVkIChwYXJlbnQpXSAlcyAoaWdub3JlZClcIiwgdmlldy5jaWQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG5mdW5jdGlvbiByZW1vdmVDaGlsZFZpZXdzKGVsKSB7XG5cdHZhciB2aWV3LCBlbHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKFwiKltkYXRhLWNpZF1cIik7XG5cdGZvciAodmFyIGkgPSAwLCBpaSA9IGVscy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0dmlldyA9IFZpZXcuZmluZEJ5RWxlbWVudChlbHMuaXRlbShpKSk7XG5cdFx0aWYgKHZpZXcpIHtcblx0XHRcdGlmICh2aWV3LmF0dGFjaGVkKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiVmlldzo6W2RldGFjaGVkIChwYXJlbnQpXSAlc1wiLCB2aWV3LmNpZCk7XG5cdFx0XHRcdHZpZXcuX2VsZW1lbnREZXRhY2hlZCgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiVmlldzo6W2RldGFjaGVkIChwYXJlbnQpXSAlcyAoaWdub3JlZClcIiwgdmlldy5jaWQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG52YXIgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihtbSkge1xuXHQvLyBjb25zb2xlLmxvZyhcIlZpZXc6Om11dGF0aW9ucyAlc1wiLCBKU09OLnN0cmluZ2lmeShtbSwgbnVsbCwgXCIgXCIpKTtcblx0dmFyIGksIGlpLCBtO1xuXHR2YXIgaiwgamosIGU7XG5cdHZhciB2aWV3O1xuXHRmb3IgKGkgPSAwLCBpaSA9IG1tLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRtID0gbW1baV07XG5cdFx0aWYgKG0udHlwZSA9PSBcImNoaWxkTGlzdFwiKSB7XG5cdFx0XHRmb3IgKGogPSAwLCBqaiA9IG0uYWRkZWROb2Rlcy5sZW5ndGg7IGogPCBqajsgaisrKSB7XG5cdFx0XHRcdGUgPSBtLmFkZGVkTm9kZXMuaXRlbShqKTtcblx0XHRcdFx0dmlldyA9IFZpZXcuZmluZEJ5RWxlbWVudChlKTtcblx0XHRcdFx0aWYgKHZpZXcpIHtcblx0XHRcdFx0XHRpZiAoIXZpZXcuYXR0YWNoZWQpIHtcblx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiVmlldzo6W2F0dGFjaGVkIChjaGlsZExpc3QpXSAlc1wiLCB2aWV3LmNpZCk7XG5cdFx0XHRcdFx0XHR2aWV3Ll9lbGVtZW50QXR0YWNoZWQoKTtcblx0XHRcdFx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBcdGNvbnNvbGUud2FybihcIlZpZXc6OlthdHRhY2hlZCAoY2hpbGRMaXN0KV0gJXMgKGlnbm9yZWQpXCIsIHZpZXcuY2lkKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkgYWRkQ2hpbGRWaWV3cyhlKTtcblx0XHRcdH1cblx0XHRcdGZvciAoaiA9IDAsIGpqID0gbS5yZW1vdmVkTm9kZXMubGVuZ3RoOyBqIDwgamo7IGorKykge1xuXHRcdFx0XHRlID0gbS5yZW1vdmVkTm9kZXMuaXRlbShqKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJWaWV3OjpbZGV0YWNoZWQgKGNoaWxkTGlzdCldICVzXCIsIGUuY2lkKTtcblx0XHRcdFx0dmlldyA9IFZpZXcuZmluZEJ5RWxlbWVudChlKTtcblx0XHRcdFx0aWYgKHZpZXcpIHtcblx0XHRcdFx0XHRpZiAodmlldy5hdHRhY2hlZCkge1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coXCJWaWV3OjpbZGV0YWNoZWQgKGNoaWxkTGlzdCldICVzXCIsIHZpZXcuY2lkLCB2aWV3LmF0dGFjaGVkKTtcblx0XHRcdFx0XHRcdHZpZXcuX2VsZW1lbnREZXRhY2hlZCgpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJWaWV3OjpbZGV0YWNoZWQgKGNoaWxkTGlzdCldICVzIChpZ25vcmVkKVwiLCB2aWV3LmNpZCwgdmlldy5hdHRhY2hlZCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHJlbW92ZUNoaWxkVmlld3MoZSk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChtLnR5cGUgPT0gXCJhdHRyaWJ1dGVzXCIpIHtcblx0XHRcdHZpZXcgPSBWaWV3LmZpbmRCeUVsZW1lbnQobS50YXJnZXQpO1xuXHRcdFx0aWYgKHZpZXcpIHtcblx0XHRcdFx0aWYgKCF2aWV3LmF0dGFjaGVkKSB7XG5cdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCJWaWV3OjpbYXR0YWNoZWQgKGF0dHJpYnV0ZSldICVzXCIsIHZpZXcuY2lkKTtcblx0XHRcdFx0XHR2aWV3Ll9lbGVtZW50QXR0YWNoZWQoKTtcblx0XHRcdFx0XHQvLyB9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIFx0Y29uc29sZS53YXJuKFwiVmlldzo6W2F0dGFjaGVkIChhdHRyaWJ1dGUpXSAlcyAoaWdub3JlZClcIiwgdmlldy5jaWQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHQvLyBlbHNlIHtcblx0XHRcdC8vIFx0Y29uc29sZS53YXJuKFwiVmlldzo6W2F0dHJpYnV0ZXNdIHRhcmdldCBoYXMgbm8gY2lkICglcz0nJXMnKVwiLCBtLmF0dHJpYnV0ZU5hbWUsIG0udGFyZ2V0LmdldEF0dHJpYnV0ZShtLmF0dHJpYnV0ZU5hbWUpLCBtKTtcblx0XHRcdC8vIH1cblx0XHR9XG5cdH1cbn0pO1xuXG5vYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcblx0YXR0cmlidXRlczogdHJ1ZSxcblx0Y2hpbGRMaXN0OiB0cnVlLFxuXHRzdWJ0cmVlOiB0cnVlLFxuXHRhdHRyaWJ1dGVGaWx0ZXI6IFtcImRhdGEtY2lkXCJdXG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogc3RhdGljIHByaXZhdGVcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9GcmFtZVF1ZXVlfSAqL1xudmFyIEZyYW1lUXVldWUgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9GcmFtZVF1ZXVlXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ByZWZpeGVkRXZlbnRzfSAqL1xudmFyIFByZWZpeGVkRXZlbnRzID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvUHJlZml4ZWRFdmVudHNcIik7XG5cbnZhciBfbm93ID0gd2luZG93LnBlcmZvcm1hbmNlID9cblx0d2luZG93LnBlcmZvcm1hbmNlLm5vdy5iaW5kKHdpbmRvdy5wZXJmb3JtYW5jZSkgOlxuXHREYXRlLm5vdy5iaW5kKERhdGUpO1xuLy8gdmFyIF9ub3cgPSB3aW5kb3cucGVyZm9ybWFuY2U/XG4vLyBcdGZ1bmN0aW9uKCkgeyByZXR1cm4gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpOyB9OlxuLy8gXHRmdW5jdGlvbigpIHsgcmV0dXJuIERhdGUubm93KCk7IH07XG5cbnZhciBhcHBseUV2ZW50UHJlZml4ZXMgPSBmdW5jdGlvbihldmVudHMpIHtcblx0dmFyIHNlbGVjdG9yLCB1bnByZWZpeGVkO1xuXHRmb3IgKHNlbGVjdG9yIGluIGV2ZW50cykge1xuXHRcdHVucHJlZml4ZWQgPSBzZWxlY3Rvci5tYXRjaCgvXlxcdysvaSlbMF07XG5cdFx0aWYgKFByZWZpeGVkRXZlbnRzLmhhc093blByb3BlcnR5KHVucHJlZml4ZWQpKSB7XG5cdFx0XHRldmVudHNbc2VsZWN0b3IucmVwbGFjZSh1bnByZWZpeGVkLCBQcmVmaXhlZEV2ZW50c1t1bnByZWZpeGVkXSldID0gZXZlbnRzW3NlbGVjdG9yXTtcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiYXBwbHlFdmVudFByZWZpeGVzXCIsIHVucHJlZml4ZWQsIHByZWZpeGVkRXZlbnRzW3VucHJlZml4ZWRdKTtcblx0XHRcdGRlbGV0ZSBldmVudHNbc2VsZWN0b3JdO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gZXZlbnRzO1xufTtcblxudmFyIGdldFZpZXdEZXB0aCA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0aWYgKCF2aWV3KSB7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cblx0aWYgKCF2aWV3LmF0dGFjaGVkKSB7XG5cdFx0cmV0dXJuIE5hTjtcblx0fVxuXHRpZiAodmlldy5wYXJlbnRWaWV3ID09PSBudWxsKSB7XG5cdFx0cmV0dXJuIDA7XG5cdH1cblx0cmV0dXJuIHZpZXcucGFyZW50Vmlldy52aWV3RGVwdGggKyAxO1xufTtcblxuZnVuY3Rpb24gbG9nQXR0YWNoSW5mbyh2aWV3LCBuYW1lLCBsZXZlbCkge1xuXHRpZiAoW1wibG9nXCIsIFwiaW5mb1wiLCBcIndhcm5cIiwgXCJlcnJvclwiXS5pbmRleE9mKGxldmVsKSAhPSAtMSkge1xuXHRcdGxldmVsID0gXCJsb2dcIjtcblx0fVxuXHRjb25zb2xlW2xldmVsXS5jYWxsKGNvbnNvbGUsIFwiJXM6OiVzIFtwYXJlbnQ6JXMgJXMgJXMgZGVwdGg6JXNdXCIsIHZpZXcuY2lkLCBuYW1lLCB2aWV3LnBhcmVudFZpZXcgJiYgdmlldy5wYXJlbnRWaWV3LmNpZCwgdmlldy5hdHRhY2hlZCA/IFwiYXR0YWNoZWRcIiA6IFwiZGV0YWNoZWRcIiwgdmlldy5fdmlld1BoYXNlLCB2aWV3LnZpZXdEZXB0aCk7XG59XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIHN0YXRpYyBwdWJsaWNcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXG52YXIgVmlldyA9IHtcblxuXHQvKiogQGNvbnN0ICovXG5cdE5PTkVfSU5WQUxJRDogMCxcblx0LyoqIEBjb25zdCAqL1xuXHRDSElMRFJFTl9JTlZBTElEOiAxLFxuXG5cdC8qKiBAY29uc3QgKi9cblx0TU9ERUxfSU5WQUxJRDogMixcblx0LyoqIEBjb25zdCAqL1xuXHRTVFlMRVNfSU5WQUxJRDogNCxcblx0LyoqIEBjb25zdCAqL1xuXHRTSVpFX0lOVkFMSUQ6IDgsXG5cdC8qKiBAY29uc3QgKi9cblx0TEFZT1VUX0lOVkFMSUQ6IDE2LFxuXG5cdC8qKiBAY29uc3QgKi9cblx0Ly8gUkVOREVSX0lOVkFMSUQ6IDggfCAxNixcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXdFcnJvcn0gKi9cblx0Vmlld0Vycm9yOiByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3RXJyb3JcIiksXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRQcm9wZXJ0eX0gKi9cblx0cHJlZml4ZWRQcm9wZXJ0eTogcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkUHJvcGVydHlcIiksXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRTdHlsZU5hbWV9ICovXG5cdHByZWZpeGVkU3R5bGVOYW1lOiByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRTdHlsZU5hbWVcIiksXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRFdmVudH0gKi9cblx0cHJlZml4ZWRFdmVudDogcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkRXZlbnRcIiksXG5cblx0Ly8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvc2V0SW1tZWRpYXRlfSAqL1xuXHQvLyBzZXRJbW1lZGlhdGU6IHJlcXVpcmUoXCJ1dGlscy9zZXRJbW1lZGlhdGVcIiksXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS93aGVuVmlld0lzQXR0YWNoZWR9ICovXG5cdHdoZW5WaWV3SXNBdHRhY2hlZDogcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblZpZXdJc0F0dGFjaGVkXCIpLFxuXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS93aGVuVmlld0lzUmVuZGVyZWR9ICovXG5cdHdoZW5WaWV3SXNSZW5kZXJlZDogcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblZpZXdJc1JlbmRlcmVkXCIpLFxuXG5cdC8qKlxuXHQvKiBAcGFyYW0gZWwge0hUTUxFbGVtZW50fVxuXHQvKiBAcmV0dXJuIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fVxuXHQvKi9cblx0ZmluZEJ5RWxlbWVudDogZnVuY3Rpb24oZWwpIHtcblx0XHRpZiAoX3ZpZXdzQnlDaWRbZWwuY2lkXSkge1xuXHRcdFx0cmV0dXJuIF92aWV3c0J5Q2lkW2VsLmNpZF07XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9LFxuXG5cdC8qKlxuXHQvKiBAcGFyYW0gZWwge0hUTUxFbGVtZW50fVxuXHQvKiBAcmV0dXJuIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fVxuXHQvKi9cblx0ZmluZEJ5RGVzY2VuZGFudDogZnVuY3Rpb24oZWwpIHtcblx0XHRkbyB7XG5cdFx0XHRpZiAoX3ZpZXdzQnlDaWRbZWwuY2lkXSkge1xuXHRcdFx0XHRyZXR1cm4gX3ZpZXdzQnlDaWRbZWwuY2lkXTtcblx0XHRcdH1cblx0XHR9IHdoaWxlICgoZWwgPSBlbC5wYXJlbnRFbGVtZW50IHx8IGVsLnBhcmVudE5vZGUpKTtcblx0XHRyZXR1cm4gbnVsbDtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGV4dGVuZDogZnVuY3Rpb24ocHJvdG8sIG9iaikge1xuXHRcdGlmIChQcmVmaXhlZEV2ZW50cy5sZW5ndGggJiYgcHJvdG8uZXZlbnRzKSB7XG5cdFx0XHRpZiAoXy5pc0Z1bmN0aW9uKHByb3RvLmV2ZW50cykpIHtcblx0XHRcdFx0cHJvdG8uZXZlbnRzID0gXy53cmFwKHByb3RvLmV2ZW50cywgZnVuY3Rpb24oZm4pIHtcblx0XHRcdFx0XHRyZXR1cm4gYXBwbHlFdmVudFByZWZpeGVzKGZuLmFwcGx5KHRoaXMpKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Vcblx0XHRcdGlmIChfLmlzT2JqZWN0KHByb3RvLmV2ZW50cykpIHtcblx0XHRcdFx0cHJvdG8uZXZlbnRzID0gYXBwbHlFdmVudFByZWZpeGVzKHByb3RvLmV2ZW50cyk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChwcm90by5wcm9wZXJ0aWVzICYmIHRoaXMucHJvdG90eXBlLnByb3BlcnRpZXMpIHtcblx0XHRcdF8uZGVmYXVsdHMocHJvdG8ucHJvcGVydGllcywgdGhpcy5wcm90b3R5cGUucHJvcGVydGllcyk7XG5cdFx0fVxuXHRcdHJldHVybiBCYWNrYm9uZS5WaWV3LmV4dGVuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHR9LFxuXG5cdF9mbGFnc1RvU3RyaW5nczogW1wiLVwiXSxcblxuXHRmbGFnc1RvU3RyaW5nOiBmdW5jdGlvbihmbGFncykge1xuXHRcdHZhciBzID0gVmlldy5fZmxhZ3NUb1N0cmluZ3NbZmxhZ3MgfCAwXTtcblx0XHRpZiAoIXMpIHtcblx0XHRcdHMgPSBbXTtcblx0XHRcdGlmIChmbGFncyAmIFZpZXcuQ0hJTERSRU5fSU5WQUxJRCkgcy5wdXNoKFwiY2hpbGRyZW5cIik7XG5cdFx0XHRpZiAoZmxhZ3MgJiBWaWV3Lk1PREVMX0lOVkFMSUQpIHMucHVzaChcIm1vZGVsXCIpO1xuXHRcdFx0aWYgKGZsYWdzICYgVmlldy5TVFlMRVNfSU5WQUxJRCkgcy5wdXNoKFwic3R5bGVzXCIpO1xuXHRcdFx0aWYgKGZsYWdzICYgVmlldy5TSVpFX0lOVkFMSUQpIHMucHVzaChcInNpemVcIik7XG5cdFx0XHRpZiAoZmxhZ3MgJiBWaWV3LkxBWU9VVF9JTlZBTElEKSBzLnB1c2goXCJsYXlvdXRcIik7XG5cdFx0XHRWaWV3Ll9mbGFnc1RvU3RyaW5nc1tmbGFnc10gPSBzID0gcy5qb2luKFwiIFwiKTtcblx0XHR9XG5cdFx0cmV0dXJuIHM7XG5cdFx0Ly8gcmV0dXJuIChmbGFncyB8IDApLnRvU3RyaW5nKDIpO1xuXHR9LFxufTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KFZpZXcsIFwiaW5zdGFuY2VzXCIsIHtcblx0dmFsdWU6IF92aWV3c0J5Q2lkLFxuXHRlbnVtZXJhYmxlOiB0cnVlXG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogcHJvdG90eXBlXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbnZhciBWaWV3UHJvdG8gPSB7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJ2aWV3XCIsXG5cdC8qKiBAdHlwZSB7Qm9vbGVhbn0gKi9cblx0X2F0dGFjaGVkOiBmYWxzZSxcblx0LyoqIEB0eXBlIHtIVE1MRWxlbWVudHxudWxsfSAqL1xuXHRfcGFyZW50VmlldzogbnVsbCxcblx0LyoqIEB0eXBlIHtpbnR8bnVsbH0gKi9cblx0X3ZpZXdEZXB0aDogbnVsbCxcblx0LyoqIEB0eXBlIHtzdHJpbmd9IGluaXRpYWxpemluZyA+IGluaXRpYWxpemVkID4gZGlzcG9zaW5nID4gZGlzcG9zZWQgKi9cblx0X3ZpZXdQaGFzZTogXCJpbml0aWFsaXppbmdcIixcblx0LyoqIEB0eXBlIHtpbnR9ICovXG5cdF9mcmFtZVF1ZXVlSWQ6IC0xLFxuXHQvKiogQHR5cGUge2ludH0gKi9cblx0X3JlbmRlckZsYWdzOiAwLFxuXG5cdC8qKiBAdHlwZSB7b2JqZWN0fSAqL1xuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0Y2lkOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY2lkIHx8ICh0aGlzLl9jaWQgPSB0aGlzLmNpZFByZWZpeCArIF9jaWRTZWVkKyspO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0YXR0YWNoZWQ6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9hdHRhY2hlZDtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHBhcmVudFZpZXc6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9wYXJlbnRWaWV3O1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0dmlld0RlcHRoOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZ2V0Vmlld0RlcHRoKCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRpbnZhbGlkYXRlZDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2ZyYW1lUXVldWVJZCAhPT0gLTE7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRlbmFibGVkOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZW5hYmxlZDtcblx0XHRcdH0sXG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKGVuYWJsZWQpIHtcblx0XHRcdFx0dGhpcy5zZXRFbmFibGVkKGVuYWJsZWQpO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0cmVuZGVyRmxhZ3M6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9yZW5kZXJGbGFncztcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0LyoqXG5cdCAqIEBjb25zdHJ1Y3RvclxuXHQgKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld31cblx0ICovXG5cdGNvbnN0cnVjdG9yOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dGhpcy50cmFuc2Zvcm0gPSB7fTtcblx0XHR0aGlzLmNoaWxkVmlld3MgPSB7fTtcblx0XHR0aGlzLl9hcHBseVJlbmRlciA9IHRoaXMuX2FwcGx5UmVuZGVyLmJpbmQodGhpcyk7XG5cblx0XHRpZiAodGhpcy5wcm9wZXJ0aWVzKSB7XG5cdFx0XHQvLyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCBnZXRQcm90b3R5cGVDaGFpblZhbHVlKHRoaXMsIFwicHJvcGVydGllc1wiLCBCYWNrYm9uZS5WaWV3KSk7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0aGlzLCB0aGlzLnByb3BlcnRpZXMpO1xuXHRcdH1cblx0XHRpZiAob3B0aW9ucyAmJiBvcHRpb25zLmNsYXNzTmFtZSAmJiB0aGlzLmNsYXNzTmFtZSkge1xuXHRcdFx0b3B0aW9ucy5jbGFzc05hbWUgKz0gXCIgXCIgKyBfLnJlc3VsdCh0aGlzLCBcImNsYXNzTmFtZVwiKTtcblx0XHR9XG5cdFx0aWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5wYXJlbnRWaWV3KSB7XG5cdFx0XHR0aGlzLl9zZXRQYXJlbnRWaWV3KG9wdGlvbnMucGFyZW50VmlldywgdHJ1ZSk7XG5cdFx0fVxuXHRcdEJhY2tib25lLlZpZXcuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OmluaXRpYWxpemUgdmlld1BoYXNlOlslcyA9PiBpbml0aWFsaXplZF1cIiwgdGhpcy5jaWQsIHRoaXMuX3ZpZXdQaGFzZSk7XG5cdFx0dGhpcy5fdmlld1BoYXNlID0gXCJpbml0aWFsaXplZFwiO1xuXG5cdFx0aWYgKHRoaXMucGFyZW50VmlldyAhPT0gbnVsbCkge1xuXHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpwYXJlbnRDaGFuZ2VcIiwgdGhpcy5wYXJlbnRWaWV3LCBudWxsKTtcblx0XHR9XG5cdFx0aWYgKHRoaXMuYXR0YWNoZWQpIHtcblx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6YXR0YWNoZWRcIiwgdGhpcyk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogcmVtb3ZlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbW92ZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX3ZpZXdQaGFzZSA9PSBcImRpc3Bvc2luZ1wiKSB7XG5cdFx0XHRsb2dBdHRhY2hJbmZvKHRoaXMsIFwicmVtb3ZlXCIsIFwid2FyblwiKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gbG9nQXR0YWNoSW5mbyh0aGlzLCBcInJlbW92ZVwiLCBcImxvZ1wiKTtcblx0XHR9XG5cblx0XHQvLyBiZWZvcmUgcmVtb3ZhbFxuXHRcdHRoaXMuX3ZpZXdQaGFzZSA9IFwiZGlzcG9zaW5nXCI7XG5cdFx0dGhpcy5fY2FuY2VsUmVuZGVyKCk7XG5cblx0XHQvLyBjYWxsIEJhY2tib25lIGltcGxcblx0XHQvLyBCYWNrYm9uZS5WaWV3LnByb3RvdHlwZS5yZW1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdC8vIE5PVEU6IGZyb20gQmFja2JvbmUgaW1wbFxuXHRcdHRoaXMuJGVsLnJlbW92ZSgpOyAvLyBmcm9tIEJhY2tib25lIGltcGxcblxuXHRcdHRoaXMuX2F0dGFjaGVkID0gZmFsc2U7XG5cdFx0dGhpcy50cmlnZ2VyKFwidmlldzpyZW1vdmVkXCIsIHRoaXMpO1xuXG5cdFx0Ly8gcmVtb3ZlIHBhcmVudC9jaGlsZCByZWZlcmVuY2VzXG5cdFx0dGhpcy5fc2V0UGFyZW50VmlldyhudWxsKTtcblxuXHRcdC8vIE5PVEU6IGZyb20gQmFja2JvbmUgaW1wbC4gTm8gbW9yZSBldmVudHMgYWZ0ZXIgdGhpc1xuXHRcdHRoaXMuc3RvcExpc3RlbmluZygpO1xuXG5cdFx0Ly8gY2hlY2sgZm9yIGludmFsaWRhdGlvbnMgdGhhdCBtYXkgaGF2ZSBiZWVuIHRyaWdnZXJlZCBieSBcInZpZXc6cmVtb3ZlZFwiXG5cdFx0aWYgKHRoaXMuaW52YWxpZGF0ZWQpIHtcblx0XHRcdGNvbnNvbGUud2FybihcIiVzOjpyZW1vdmUgaW52YWxpZGF0ZWQgYWZ0ZXIgcmVtb3ZlKClcIiwgdGhpcy5jaWQpO1xuXHRcdFx0dGhpcy5fY2FuY2VsUmVuZGVyKCk7XG5cdFx0fVxuXHRcdC8vIC8vIGNoZWNrIGZvciBjaGlsZHJlbiBzdGlsbCBoZXJlXG5cdFx0Ly8gdmFyIGNjaWRzID0gT2JqZWN0LmtleXModGhpcy5jaGlsZFZpZXdzKTtcblx0XHQvLyBpZiAoY2NpZHMubGVuZ3RoKSB7XG5cdFx0Ly8gXHRjb25zb2xlLndhcm4oXCIlczo6cmVtb3ZlICVpIGNoaWxkcmVuIG5vdCByZW1vdmVkIFslc11cIiwgdGhpcy5jaWQsIGNjaWRzLmxlbmd0aCwgY2NpZHMuam9pbihcIiwgXCIpLCB0aGlzLmNoaWxkVmlld3MpO1xuXHRcdC8vIH1cblx0XHQvLyAvLyByZW1vdmUgY2hpbGRWaWV3c1xuXHRcdC8vIGZvciAodmFyIGNpZCBpbiB0aGlzLmNoaWxkVmlld3MpIHtcblx0XHQvLyBcdHRoaXMuY2hpbGRWaWV3c1tjaWRdLnJlbW92ZSgpO1xuXHRcdC8vIH1cblx0XHQvLyBjbGVhciByZWZlcmVuY2UgaW4gdmlldyBtYXBcblx0XHRkZWxldGUgX3ZpZXdzQnlDaWRbdGhpcy5jaWRdO1xuXHRcdC8vIGRlbGV0ZSB0aGlzLmVsLmNpZDtcblx0XHQvLyB1cGRhdGUgcGhhc2Vcblx0XHR0aGlzLl92aWV3UGhhc2UgPSBcImRpc3Bvc2VkXCI7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBfZWxlbWVudEF0dGFjaGVkIF9lbGVtZW50RGV0YWNoZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9lbGVtZW50QXR0YWNoZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHRoaXMuX2FkZFRvUGFyZW50VmlldygpO1xuXHRcdHRoaXMuX2F0dGFjaGVkID0gdHJ1ZTtcblx0XHR0aGlzLl92aWV3RGVwdGggPSBudWxsO1xuXHRcdHRoaXMuX3NldFBhcmVudFZpZXcoVmlldy5maW5kQnlEZXNjZW5kYW50KHRoaXMuZWwucGFyZW50RWxlbWVudCkpO1xuXG5cdFx0Ly8gaWYgKHRoaXMucGFyZW50Vmlldykge1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCJbYXR0YWNoXSBbJWldICVzID4gJXM6Ol9lbGVtZW50QXR0YWNoZWRcIiwgdGhpcy52aWV3RGVwdGgsIHRoaXMucGFyZW50Vmlldy5jaWQsIHRoaXMuY2lkKTtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCJbYXR0YWNoXSBbJWldICVzOjpfZWxlbWVudEF0dGFjaGVkXCIsIHRoaXMudmlld0RlcHRoLCB0aGlzLmNpZCk7XG5cdFx0Ly8gfVxuXG5cdFx0Ly8gaWYgKHRoaXMuX3ZpZXdQaGFzZSA9PSBcImluaXRpYWxpemluZ1wiKSB7XG5cdFx0Ly8gXHQvLyB0aGlzLnRyaWdnZXIoXCJ2aWV3OmF0dGFjaGVkXCIsIHRoaXMpO1xuXHRcdC8vIH0gZWxzZVxuXHRcdGlmICh0aGlzLl92aWV3UGhhc2UgPT0gXCJpbml0aWFsaXplZFwiKSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OmF0dGFjaGVkXCIsIHRoaXMpO1xuXHRcdH0gZWxzZVxuXHRcdGlmICh0aGlzLl92aWV3UGhhc2UgPT0gXCJyZXBsYWNpbmdcIikge1xuXHRcdFx0dGhpcy5fdmlld1BoYXNlID0gXCJpbml0aWFsaXplZFwiO1xuXHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpyZXBsYWNlZFwiLCB0aGlzKTtcblx0XHR9XG5cdH0sXG5cblx0X2VsZW1lbnREZXRhY2hlZDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCF0aGlzLmF0dGFjaGVkIHx8ICh0aGlzLl92aWV3UGhhc2UgPT0gXCJkaXNwb3NpbmdcIikgfHwgKHRoaXMuX3ZpZXdQaGFzZSA9PSBcImRpc3Bvc2VkXCIpKSB7XG5cdFx0XHRsb2dBdHRhY2hJbmZvKHRoaXMsIFwiX2VsZW1lbnREZXRhY2hlZFwiLCBcImVycm9yXCIpO1xuXHRcdFx0Ly8gfSBlbHNlIHtcblx0XHRcdC8vIFx0bG9nQXR0YWNoSW5mbyh0aGlzLCBcIl9lbGVtZW50RGV0YWNoZWRcIiwgXCJsb2dcIik7XG5cdFx0fVxuXHRcdHRoaXMuX2F0dGFjaGVkID0gZmFsc2U7XG5cdFx0dGhpcy5fdmlld0RlcHRoID0gbnVsbDtcblxuXHRcdGlmICh0aGlzLl92aWV3UGhhc2UgIT0gXCJkaXNwb3NpbmdcIiB8fCB0aGlzLl92aWV3UGhhc2UgPT0gXCJkaXNwb3NlZFwiKSB7XG5cdFx0XHR0aGlzLnJlbW92ZSgpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHBhcmVudFZpZXdcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9zZXRQYXJlbnRWaWV3OiBmdW5jdGlvbihuZXdQYXJlbnQsIHNpbGVudCkge1xuXHRcdGlmIChuZXdQYXJlbnQgPT09IHZvaWQgMCkge1xuXHRcdFx0Y29uc29sZS53YXJuKFwiJHM6Ol9zZXRQYXJlbnRWaWV3IGludmFsaWQgdmFsdWUgJyVzJ1wiLCB0aGlzLmNpZCwgbmV3UGFyZW50KTtcblx0XHRcdG5ld1BhcmVudCA9IG51bGw7XG5cdFx0fVxuXHRcdHZhciBvbGRQYXJlbnQgPSB0aGlzLl9wYXJlbnRWaWV3O1xuXHRcdHRoaXMuX3BhcmVudFZpZXcgPSBuZXdQYXJlbnQ7XG5cblx0XHQvLyBmb3JjZSB1cGRhdGUgb2YgX3ZpZXdEZXB0aFxuXHRcdHRoaXMuX3ZpZXdEZXB0aCA9IG51bGw7IC8vZ2V0Vmlld0RlcHRoKHRoaXMpO1xuXG5cdFx0Ly8gc2tpcCB0aGUgcmVzdCBpZiBhcmcgaXMgdGhlIHNhbWVcblx0XHRpZiAobmV3UGFyZW50ID09PSBvbGRQYXJlbnQpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKG9sZFBhcmVudCAhPT0gbnVsbCkge1xuXHRcdFx0aWYgKHRoaXMuY2lkIGluIG9sZFBhcmVudC5jaGlsZFZpZXdzKSB7XG5cdFx0XHRcdGRlbGV0ZSBvbGRQYXJlbnQuY2hpbGRWaWV3c1t0aGlzLmNpZF07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChuZXdQYXJlbnQgIT09IG51bGwpIHtcblx0XHRcdG5ld1BhcmVudC5jaGlsZFZpZXdzW3RoaXMuY2lkXSA9IHRoaXM7XG5cdFx0fVxuXHRcdGlmICghc2lsZW50KVxuXHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpwYXJlbnRDaGFuZ2VcIiwgdGhpcywgbmV3UGFyZW50LCBvbGRQYXJlbnQpO1xuXHR9LFxuXG5cdHdoZW5BdHRhY2hlZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIFZpZXcud2hlblZpZXdJc0F0dGFjaGVkKHRoaXMpO1xuXHR9LFxuXG5cdF9nZXRWaWV3RGVwdGg6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl92aWV3RGVwdGggPT09IG51bGwpIHtcblx0XHRcdHRoaXMuX3ZpZXdEZXB0aCA9IGdldFZpZXdEZXB0aCh0aGlzKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuX3ZpZXdEZXB0aDtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIEJhY2tib25lLlZpZXcgb3ZlcnJpZGVzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHNldEVsZW1lbnQ6IGZ1bmN0aW9uKGVsZW1lbnQsIGRlbGVnYXRlKSB7XG5cdFx0Ly8gc2V0RWxlbWVudCBhbHdheXMgaW5pdGlhbGl6ZXMgdGhpcy5lbCwgc28gY2hlY2sgaXQgdG8gYmUgbm9uLW51bGwgYmVmb3JlIGNhbGxpbmcgc3VwZXJcblx0XHRpZiAodGhpcy5lbCkge1xuXHRcdFx0aWYgKHRoaXMuZWwgIT09IGVsZW1lbnQgJiYgdGhpcy5lbC5wYXJlbnRFbGVtZW50KSB7XG5cdFx0XHRcdC8vIEVsZW1lbnQgaXMgYmVpbmcgcmVwbGFjZWRcblx0XHRcdFx0aWYgKHRoaXMuYXR0YWNoZWQpIHtcblx0XHRcdFx0XHQvLyBTaW5jZSBvbGQgZWxlbWVudCBpcyBhdHRhY2hlZCB0byBkb2N1bWVudCB0cmVlLCBfZWxlbWVudEF0dGFjaGVkIHdpbGwgYmVcblx0XHRcdFx0XHQvLyB0cmlnZ2VyZWQgYnkgcmVwbGFjZUNoaWxkOiBzZXQgX3ZpZXdQaGFzZSA9IFwicmVwbGFjaW5nXCIgdG8gZmxhZyB0aGlzXG5cdFx0XHRcdFx0Ly8gY2hhbmdlIGFuZCB0cmlnZ2VyICd2aWV3OnJlcGxhY2VkJyBpbnN0ZWFkIG9mICd2aWV3OmFkZGVkJy5cblx0XHRcdFx0XHR0aGlzLl92aWV3UGhhc2UgPSBcInJlcGxhY2luZ1wiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuZWwucGFyZW50RWxlbWVudC5yZXBsYWNlQ2hpbGQoZWxlbWVudCwgdGhpcy5lbCk7XG5cdFx0XHR9XG5cdFx0XHRCYWNrYm9uZS5WaWV3LnByb3RvdHlwZS5zZXRFbGVtZW50LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHQvLyBNZXJnZSBjbGFzc2VzIHNwZWNpZmllZCBieSB0aGlzIHZpZXcgd2l0aCB0aGUgb25lcyBhbHJlYWR5IGluIHRoZSBlbGVtZW50LFxuXHRcdFx0Ly8gYXMgYmFja2JvbmUgd2lsbCBub3Q6XG5cdFx0XHRpZiAodGhpcy5jbGFzc05hbWUpIHtcblx0XHRcdFx0Xy5yZXN1bHQodGhpcywgXCJjbGFzc05hbWVcIikuc3BsaXQoXCIgXCIpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChpdGVtKTtcblx0XHRcdFx0fSwgdGhpcyk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdEJhY2tib25lLlZpZXcucHJvdG90eXBlLnNldEVsZW1lbnQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5lbCA9PT0gdm9pZCAwKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJCYWNrYm9uZSB2aWV3IGhhcyBubyBlbGVtZW50XCIpO1xuXHRcdH1cblx0XHRfdmlld3NCeUNpZFt0aGlzLmNpZF0gPSB0aGlzO1xuXHRcdHRoaXMuZWwuY2lkID0gdGhpcy5jaWQ7XG5cdFx0dGhpcy5lbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWNpZFwiLCB0aGlzLmNpZCk7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdC8qIHJlcXVlc3RBbmltYXRpb25GcmFtZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lOiBmdW5jdGlvbihjYWxsYmFjaywgcHJpb3JpdHksIGN0eCkge1xuXHRcdHJldHVybiBGcmFtZVF1ZXVlLnJlcXVlc3QoY2FsbGJhY2suYmluZChjdHggfHwgdGhpcyksIHByaW9yaXR5KTtcblx0fSxcblxuXHRjYW5jZWxBbmltYXRpb25GcmFtZTogZnVuY3Rpb24oaWQpIHtcblx0XHRyZXR1cm4gRnJhbWVRdWV1ZS5jYW5jZWwoaWQpO1xuXHR9LFxuXG5cdHNldEltbWVkaWF0ZTogZnVuY3Rpb24oY2FsbGJhY2ssIGN0eCkge1xuXHRcdHdpbmRvdy5zZXRJbW1lZGlhdGUoY2FsbGJhY2suYmluZChjdHggfHwgdGhpcykpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogZGVmZXJyZWQgcmVuZGVyOiBwcml2YXRlIG1ldGhvZHNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRfYXBwbHlSZW5kZXI6IGZ1bmN0aW9uKHRzdGFtcCkge1xuXHRcdGlmIChERUJVRykge1xuXHRcdFx0aWYgKCF0aGlzLl9za2lwTG9nKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9hcHBseVJlbmRlciBbJXNdIFslcywgJXMsICVzXVwiLCB0aGlzLmNpZCxcblx0XHRcdFx0XHRWaWV3LmZsYWdzVG9TdHJpbmcodGhpcy5fcmVuZGVyRmxhZ3MpLFxuXHRcdFx0XHRcdCh0aGlzLl9mcmFtZVF1ZXVlSWQgIT0gLTEgPyBcImFzeW5jICNcIiArIHRoaXMuX2ZyYW1lUXVldWVJZCA6IFwic3luY1wiKSxcblx0XHRcdFx0XHQodGhpcy5hdHRhY2hlZCA/IFwiYXR0YWNoZWRcIiA6IFwiZGV0YWNoZWRcIiksXG5cdFx0XHRcdFx0KHRoaXMuc2tpcFRyYW5zaXRpb25zID8gXCJza2lwXCIgOiBcInJ1blwiKSArIFwiIHR4XCJcblx0XHRcdFx0KTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR2YXIgZmxhZ3MgPSB0aGlzLl9yZW5kZXJGbGFncztcblx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnJlbmRlcjpiZWZvcmVcIiwgdGhpcywgZmxhZ3MpO1xuXHRcdHRoaXMuX3JlbmRlckZsYWdzID0gMDtcblx0XHR0aGlzLl9mcmFtZVF1ZXVlSWQgPSAtMTtcblx0XHR0aGlzLl9yZW5kZXJGbGFncyB8PSB0aGlzLnJlbmRlckZyYW1lKHRzdGFtcCwgZmxhZ3MpO1xuXHRcdHRoaXMudHJpZ2dlcihcInZpZXc6cmVuZGVyOmFmdGVyXCIsIHRoaXMsIGZsYWdzKTtcblxuXHRcdGlmICh0aGlzLl9yZW5kZXJGbGFncyAhPSAwKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCIlczo6X2FwcGx5UmVuZGVyIFtyZXR1cm5lZF0gZmxhZ3M6ICVzXCIsIHRoaXMuY2lkLCBWaWV3LmZsYWdzVG9TdHJpbmcodGhpcy5fcmVuZGVyRmxhZ3MpLCB0aGlzLl9yZW5kZXJGbGFncyk7XG5cdFx0fVxuXHR9LFxuXG5cdF9jYW5jZWxSZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9mcmFtZVF1ZXVlSWQgIT0gLTEpIHtcblx0XHRcdHZhciBjYW5jZWxJZCwgY2FuY2VsRm47XG5cblx0XHRcdGNhbmNlbElkID0gdGhpcy5fZnJhbWVRdWV1ZUlkO1xuXHRcdFx0dGhpcy5fZnJhbWVRdWV1ZUlkID0gLTE7XG5cdFx0XHRjYW5jZWxGbiA9IEZyYW1lUXVldWUuY2FuY2VsKGNhbmNlbElkKTtcblxuXHRcdFx0aWYgKGNhbmNlbEZuID09PSB2b2lkIDApIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiJXM6Ol9jYW5jZWxSZW5kZXIgSUQ6JWkgbm90IGZvdW5kXCIsIHRoaXMuY2lkLCBjYW5jZWxJZCk7XG5cdFx0XHR9IGVsc2UgaWYgKGNhbmNlbEZuID09PSBudWxsKSB7XG5cdFx0XHRcdGNvbnNvbGUud2FybihcIiVzOjpfY2FuY2VsUmVuZGVyIElEOiVpIGFscmVhZHkgY2FuY2VsbGVkXCIsIHRoaXMuY2lkLCBjYW5jZWxJZCk7XG5cdFx0XHRcdC8vIH0gZWxzZSB7XG5cdFx0XHRcdC8vIFx0aWYgKCF0aGlzLl9za2lwTG9nICYmICFGcmFtZVF1ZXVlLnJ1bm5pbmcpXG5cdFx0XHRcdC8vIFx0XHRjb25zb2xlLmxvZyhcIiVzOjpfY2FuY2VsUmVuZGVyIElEOiVpIGNhbmNlbGxlZFwiLCB0aGlzLmNpZCwgY2FuY2VsSWQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRfcmVxdWVzdFJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKEZyYW1lUXVldWUucnVubmluZykge1xuXHRcdFx0dGhpcy5fY2FuY2VsUmVuZGVyKCk7XG5cdFx0XHRpZiAoREVCVUcpIHtcblx0XHRcdFx0aWYgKCF0aGlzLl9za2lwTG9nKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5pbmZvKFwiJXM6Ol9yZXF1ZXN0UmVuZGVyIHJlc2NoZWR1bGVkIFslcyAoJXMpXVwiLCB0aGlzLmNpZCwgVmlldy5mbGFnc1RvU3RyaW5nKHRoaXMuX3JlbmRlckZsYWdzKSwgdGhpcy5fcmVuZGVyRmxhZ3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmICh0aGlzLl9mcmFtZVF1ZXVlSWQgPT0gLTEpIHtcblx0XHRcdHRoaXMuX2ZyYW1lUXVldWVJZCA9IEZyYW1lUXVldWUucmVxdWVzdCh0aGlzLl9hcHBseVJlbmRlciwgaXNOYU4odGhpcy52aWV3RGVwdGgpID8gTnVtYmVyLk1BWF9WQUxVRSA6IHRoaXMudmlld0RlcHRoKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiByZW5kZXI6IHB1YmxpYyAvIGFic3RyYWN0IG1ldGhvZHNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGludmFsaWRhdGU6IGZ1bmN0aW9uKGZsYWdzKSB7XG5cdFx0aWYgKGZsYWdzICE9PSB2b2lkIDApIHtcblx0XHRcdGlmIChERUJVRykge1xuXHRcdFx0XHRpZiAoIXRoaXMuX3NraXBMb2cpIHtcblx0XHRcdFx0XHRpZiAodGhpcy5fcmVuZGVyRmxhZ3MgPiAwKSB7XG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIiVzOjppbnZhbGlkYXRlIFslcyAoJXMpXSArIFslcyAoJXMpXVwiLCB0aGlzLmNpZCwgVmlldy5mbGFnc1RvU3RyaW5nKHRoaXMuX3JlbmRlckZsYWdzKSwgdGhpcy5fcmVuZGVyRmxhZ3MsIFZpZXcuZmxhZ3NUb1N0cmluZyhmbGFncyksIGZsYWdzKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2coXCIlczo6aW52YWxpZGF0ZSBbJXMgKCVzKV1cIiwgdGhpcy5jaWQsIFZpZXcuZmxhZ3NUb1N0cmluZyhmbGFncyksIGZsYWdzKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHRoaXMuX3JlbmRlckZsYWdzIHw9IGZsYWdzO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRyZXF1ZXN0UmVuZGVyOiBmdW5jdGlvbihmbGFncykge1xuXHRcdC8vIGlmIChmbGFncyAhPT0gdm9pZCAwKSB7XG5cdFx0Ly8gXHR0aGlzLl9yZW5kZXJGbGFncyB8PSBmbGFncztcblx0XHQvLyB9XG5cdFx0dGhpcy5pbnZhbGlkYXRlKGZsYWdzKTtcblx0XHR0aGlzLl9yZXF1ZXN0UmVuZGVyKCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyoqIEBhYnN0cmFjdCAqL1xuXHRyZW5kZXJGcmFtZTogZnVuY3Rpb24odHN0YW1wLCBmbGFncykge1xuXHRcdC8vIHN1YmNsYXNzZXMgc2hvdWxkIG92ZXJyaWRlIHRoaXMgbWV0aG9kXG5cdFx0cmV0dXJuIFZpZXcuTk9ORV9JTlZBTElEO1xuXHR9LFxuXG5cdHJlbmRlck5vdzogZnVuY3Rpb24oYWx3YXlzUnVuKSB7XG5cdFx0aWYgKHRoaXMuX2ZyYW1lUXVldWVJZCAhPSAtMSkge1xuXHRcdFx0dGhpcy5fY2FuY2VsUmVuZGVyKCk7XG5cdFx0XHRhbHdheXNSdW4gPSB0cnVlO1xuXHRcdH1cblx0XHQvLyBpZiAoYWx3YXlzUnVuID09PSB0cnVlKSB7XG5cdFx0aWYgKGFsd2F5c1J1bikge1xuXHRcdFx0dGhpcy5fYXBwbHlSZW5kZXIoX25vdygpKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0d2hlblJlbmRlcmVkOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gVmlldy53aGVuVmlld0lzUmVuZGVyZWQodGhpcyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiByZW5kZXIgYml0d2lzZSBmbGFnc1xuXHQvKiAtIGNoZWNrOiB0aGlzLl9yZW5kZXJGbGFncyAmIGZsYWdzXG5cdC8qIC0gYWRkOiB0aGlzLl9yZW5kZXJGbGFncyB8PSBmbGFnc1xuXHQvKiAtIHJlbW92ZTogdGhpcy5fcmVuZGVyRmxhZ3MgJj0gfmZsYWdzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiBoZWxwZXJzIC0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlcXVlc3RDaGlsZHJlblJlbmRlcjogZnVuY3Rpb24oZmxhZ3MsIG5vdywgZm9yY2UpIHtcblx0XHR2YXIgY2NpZCwgdmlldztcblx0XHRmb3IgKGNjaWQgaW4gdGhpcy5jaGlsZFZpZXdzKSB7XG5cdFx0XHR2aWV3ID0gdGhpcy5jaGlsZFZpZXdzW2NjaWRdO1xuXHRcdFx0dmlldy5za2lwVHJhbnNpdGlvbnMgPSAhIShmbGFncyAmIFZpZXcuU0laRV9JTlZBTElEKTtcblx0XHRcdHZpZXcucmVxdWVzdFJlbmRlcihmbGFncyk7XG5cdFx0XHRpZiAobm93KSB7XG5cdFx0XHRcdHZpZXcucmVuZGVyTm93KGZvcmNlKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5yZW5kZXJOb3codHJ1ZSk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBjb21tb24gYWJzdHJhY3Rcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRfZW5hYmxlZDogdW5kZWZpbmVkLFxuXG5cdC8qKlxuXHQvKiBAcGFyYW0ge0Jvb2xlYW59XG5cdC8qL1xuXHRzZXRFbmFibGVkOiBmdW5jdGlvbihlbmFibGUpIHtcblx0XHR0aGlzLl9lbmFibGVkID0gZW5hYmxlO1xuXHR9LFxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZChWaWV3UHJvdG8sIFZpZXcpOyIsImZ1bmN0aW9uIFZpZXdFcnJvcih2aWV3LCBlcnIpIHtcblx0dGhpcy52aWV3ID0gdmlldztcblx0dGhpcy5lcnIgPSBlcnI7XG5cdHRoaXMubWVzc2FnZSA9IGVyci5tZXNzYWdlO1xufVxuVmlld0Vycm9yLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoRXJyb3IucHJvdG90eXBlKTtcblZpZXdFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBWaWV3RXJyb3I7XG5WaWV3RXJyb3IucHJvdG90eXBlLm5hbWUgPSBcIlZpZXdFcnJvclwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFZpZXdFcnJvcjtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxLCBoZWxwZXIsIGFsaWFzMT1kZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LCBhbGlhczI9aGVscGVycy5oZWxwZXJNaXNzaW5nLCBhbGlhczM9Y29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb24sIGFsaWFzND1cImZ1bmN0aW9uXCI7XG5cbiAgcmV0dXJuIFwiPGEgaHJlZj1cXFwiXCJcbiAgICArIGFsaWFzMygoaGVscGVycy5nbG9iYWwgfHwgKGRlcHRoMCAmJiBkZXB0aDAuZ2xvYmFsKSB8fCBhbGlhczIpLmNhbGwoYWxpYXMxLFwiQVBQX1JPT1RcIix7XCJuYW1lXCI6XCJnbG9iYWxcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkpXG4gICAgKyBcIiNcIlxuICAgICsgYWxpYXMzKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuaGFuZGxlIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5oYW5kbGUgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXM0ID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcImhhbmRsZVwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiPlwiXG4gICAgKyAoKHN0YWNrMSA9ICgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMubmFtZSB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAubmFtZSA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczQgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwibmFtZVwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKSAhPSBudWxsID8gc3RhY2sxIDogXCJcIilcbiAgICArIFwiPC9hPlxcblwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvKipcbi8qIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVWaWV3XG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciB2aWV3VGVtcGxhdGUgPSByZXF1aXJlKFwiLi9BcnRpY2xlQnV0dG9uLmhic1wiKTtcblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVCdXR0b259XG4vKi9cbnZhciBBcnRpY2xlQnV0dG9uID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwiYXJ0aWNsZUJ1dHRvblwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwiaDJcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwiYXJ0aWNsZS1idXR0b25cIixcblx0LyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cblx0dGVtcGxhdGU6IHZpZXdUZW1wbGF0ZSxcblxuXHRldmVudHM6IHtcblx0XHRcImNsaWNrIGFcIjogZnVuY3Rpb24oZG9tZXYpIHtcblx0XHRcdGRvbWV2LmRlZmF1bHRQcmV2ZW50ZWQgfHwgZG9tZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6Y2xpY2tcIiwgdGhpcy5tb2RlbCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIC8qKiBAb3ZlcnJpZGUgKi9cblx0Ly8gaW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge30sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogUmVuZGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlbmRlckZyYW1lOiBmdW5jdGlvbih0c3RhbXAsIGZsYWdzKSB7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwudG9KU09OKCkpO1xuXHR9LFxufSk7XG5tb2R1bGUuZXhwb3J0cyA9IEFydGljbGVCdXR0b247IiwiLyoqXG4vKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9BcnRpY2xlVmlld1xuLyovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvbmV0L3RvQWJzb2x1dGVVUkx9ICovXG4vLyB2YXIgdG9BYnNvbHV0ZVVSTCA9IHJlcXVpcmUoXCJ1dGlscy9uZXQvdG9BYnNvbHV0ZVVSTFwiKTtcbi8vXG4vLyAvKiogQHR5cGUge3N0cmluZ30gKi9cbi8vIHZhciBBQlNfQVBQX1JPT1QgPSB0b0Fic29sdXRlVVJMKHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpLkFQUF9ST09UKTtcblxuLyoqXG4vKiBAY29uc3RydWN0b3Jcbi8qIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0FydGljbGVWaWV3fVxuLyovXG52YXIgQXJ0aWNsZVZpZXcgPSBWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJhcnRpY2xlVmlld1wiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRhZ05hbWU6IFwiYXJ0aWNsZVwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJhcnRpY2xlLXZpZXcgbWRvd25cIixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHt9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZW5kZXJGcmFtZTogZnVuY3Rpb24odHN0YW1wLCBmbGFncykge1xuXHRcdHRoaXMuZWwuaW5uZXJIVE1MID0gdGhpcy5tb2RlbC5nZXQoXCJ0ZXh0XCIpO1xuXHRcdC8vIEZJWE1FOiBub3cgZG9uZSBpbiB4c2x0XG5cdFx0Ly8gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiYVtocmVmXVwiKS5mb3JFYWNoKGZ1bmN0aW9uKGVsKSB7XG5cdFx0Ly8gXHR2YXIgdXJsID0gdG9BYnNvbHV0ZVVSTChlbC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpKTtcblx0XHQvLyBcdGlmICh1cmwuaW5kZXhPZihBQlNfQVBQX1JPT1QpICE9PSAwKSB7XG5cdFx0Ly8gXHRcdGVsLnNldEF0dHJpYnV0ZShcInRhcmdldFwiLCBcIl9ibGFua1wiKTtcblx0XHQvLyBcdH1cblx0XHQvLyB9KTtcblx0fSxcbn0pO1xubW9kdWxlLmV4cG9ydHMgPSBBcnRpY2xlVmlldzsiLCIvKipcbi8qIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L0Nhcm91c2VsXG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmhhbW1lcmpzfSAqL1xudmFyIEhhbW1lciA9IHJlcXVpcmUoXCJoYW1tZXJqc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lLmJhYnlzaXR0ZXJ9ICovXG52YXIgQ29udGFpbmVyID0gcmVxdWlyZShcImJhY2tib25lLmJhYnlzaXR0ZXJcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG52YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9EZWZlcnJlZFZpZXd9ICovXG4vLyB2YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL0RlZmVycmVkVmlld1wiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0Nhcm91c2VsUmVuZGVyZXJ9ICovXG52YXIgQ2Fyb3VzZWxSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvQ2Fyb3VzZWxSZW5kZXJlclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRQcm9wZXJ0eX0gKi9cbnZhciBwcmVmaXhlZFByb3BlcnR5ID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkUHJvcGVydHlcIik7XG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFN0eWxlTmFtZX0gKi9cbnZhciBwcmVmaXhlZFN0eWxlTmFtZSA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFN0eWxlTmFtZVwiKTtcblxudmFyIHRyYW5zZm9ybVN0eWxlTmFtZSA9IHByZWZpeGVkU3R5bGVOYW1lKFwidHJhbnNmb3JtXCIpO1xudmFyIHRyYW5zZm9ybVByb3BlcnR5ID0gcHJlZml4ZWRQcm9wZXJ0eShcInRyYW5zZm9ybVwiKTtcbnZhciB0cmFuc2xhdGVUZW1wbGF0ZSA9IEdsb2JhbHMuVFJBTlNMQVRFX1RFTVBMQVRFO1xuXG4vLyB2YXIgY3NzVG9QeCA9IGZ1bmN0aW9uKGNzc1ZhbCwgZWwpIHtcbi8vIFx0cmV0dXJuIHBhcnNlSW50KGNzc1ZhbCk7XG4vLyB9O1xuXG4vLyB2YXIgZGVmYXVsdFJlbmRlcmVyRnVuY3Rpb24gPSAoZnVuY3Rpb24oKSB7XG4vLyBcdHZhciBkZWZhdWx0UmVuZGVyZXIgPSBDYXJvdXNlbFJlbmRlcmVyLmV4dGVuZCh7IGNsYXNzTmFtZTogXCJjYXJvdXNlbC1pdGVtIGRlZmF1bHQtcmVuZGVyZXJcIn0pLFxuLy8gXHRcdGVtcHR5UmVuZGVyZXIgPSBDYXJvdXNlbFJlbmRlcmVyLmV4dGVuZCh7IGNsYXNzTmFtZTogXCJjYXJvdXNlbC1pdGVtIGVtcHR5LXJlbmRlcmVyXCJ9KTtcbi8vIFx0cmV0dXJuIGZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBhcnIpIHtcbi8vIFx0XHRyZXR1cm4gKGluZGV4ID09PSAtMSk/IGVtcHR5UmVuZGVyZXI6IGRlZmF1bHRSZW5kZXJlcjtcbi8vIFx0fTtcbi8vIH0pKCk7XG5cbi8qKiBAY29uc3QgKi9cbnZhciBNQVhfU0VMRUNUX1RIUkVTSE9MRCA9IDIwO1xuXG4vLyAvKiogQGNvbnN0ICovXG4vLyB2YXIgQ0hJTERSRU5fSU5WQUxJRCA9IFZpZXcuQ0hJTERSRU5fSU5WQUxJRCxcbi8vIFx0U1RZTEVTX0lOVkFMSUQgPSBWaWV3LlNUWUxFU19JTlZBTElELFxuLy8gXHRNT0RFTF9JTlZBTElEID0gVmlldy5NT0RFTF9JTlZBTElELFxuLy8gXHRTSVpFX0lOVkFMSUQgPSBWaWV3LlNJWkVfSU5WQUxJRCxcbi8vIFx0TEFZT1VUX0lOVkFMSUQgPSBWaWV3LkxBWU9VVF9JTlZBTElEO1xuXG52YXIgVkVSVElDQUwgPSBIYW1tZXIuRElSRUNUSU9OX1ZFUlRJQ0FMLFxuXHRIT1JJWk9OVEFMID0gSGFtbWVyLkRJUkVDVElPTl9IT1JJWk9OVEFMO1xuXG4vLyB4OiBbXCJ4XCIsIFwieVwiXSxcbi8vIHk6IFtcInlcIiwgXCJ4XCJdLFxuLy8gb2Zmc2V0TGVmdDogW1wib2Zmc2V0TGVmdFwiLCBcIm9mZnNldFRvcFwiXSxcbi8vIG9mZnNldFRvcDogW1wib2Zmc2V0VG9wXCIsIFwib2Zmc2V0TGVmdFwiXSxcbi8vIG9mZnNldFdpZHRoOiBbXCJvZmZzZXRXaWR0aFwiLCBcIm9mZnNldEhlaWdodFwiXSxcbi8vIG9mZnNldEhlaWdodDogW1wib2Zmc2V0SGVpZ2h0XCIsIFwib2Zmc2V0V2lkdGhcIl0sXG4vLyB3aWR0aDogW1wid2lkdGhcIixcImhlaWdodFwiXSxcbi8vIGhlaWdodDogW1wiaGVpZ2h0XCIsXCJ3aWR0aFwiXSxcbi8vIG1hcmdpbkxlZnQ6IFtcIm1hcmdpbkxlZnRcIixcIm1hcmdpblRvcFwiXSxcbi8vIG1hcmdpblJpZ2h0OiBbXCJtYXJnaW5SaWdodFwiLFwibWFyZ2luQm90dG9tXCJdLFxuXG4vKlxudmFyIEhPUklaT05UQUxfUFJPUFMgPSB7XG5cdHBvczogXCJ4XCIsXG5cdHNpemU6IFwid2lkdGhcIixcblx0b2Zmc2V0UG9zOiBcIm9mZnNldExlZnRcIixcblx0b2Zmc2V0U2l6ZTogXCJvZmZzZXRXaWR0aFwiLFxuXHRtYXJnaW5CZWZvcmU6IFwibWFyZ2luTGVmdFwiLFxuXHRtYXJnaW5BZnRlcjogXCJtYXJnaW5SaWdodFwiLFxufTtcbnZhciBWRVJUSUNBTF9QUk9QUyA9IHtcblx0cG9zOiBcInlcIixcblx0c2l6ZTogXCJoZWlnaHRcIixcblx0b2Zmc2V0UG9zOiBcIm9mZnNldFRvcFwiLFxuXHRvZmZzZXRTaXplOiBcIm9mZnNldEhlaWdodFwiLFxuXHRtYXJnaW5CZWZvcmU6IFwibWFyZ2luVG9wXCIsXG5cdG1hcmdpbkFmdGVyOiBcIm1hcmdpbkJvdHRvbVwiLFxufTtcbiovXG5cbi8vIHZhciBESVJFQ1RJT05fTk9ORSA9IDE7XG4vLyB2YXIgRElSRUNUSU9OX0xFRlQgPSAyO1xuLy8gdmFyIERJUkVDVElPTl9SSUdIVCA9IDQ7XG4vLyB2YXIgRElSRUNUSU9OX1VQID0gODtcbi8vIHZhciBESVJFQ1RJT05fRE9XTiA9IDE2O1xuXG4vLyBmdW5jdGlvbiBkaXJUb1N0cihkaXIpIHtcbi8vIFx0aWYgKGRpciA9PT0gSGFtbWVyLkRJUkVDVElPTl9OT05FKSByZXR1cm4gJ05PTkUnO1xuLy8gXHRpZiAoZGlyID09PSBIYW1tZXIuRElSRUNUSU9OX0xFRlQpIHJldHVybiAnTEVGVCc7XG4vLyBcdGlmIChkaXIgPT09IEhhbW1lci5ESVJFQ1RJT05fUklHSFQpIHJldHVybiAnUklHSFQnO1xuLy8gXHRpZiAoZGlyID09PSBIYW1tZXIuRElSRUNUSU9OX1VQKSByZXR1cm4gJ1VQJztcbi8vIFx0aWYgKGRpciA9PT0gSGFtbWVyLkRJUkVDVElPTl9ET1dOKSByZXR1cm4gJ0RPV04nO1xuLy8gXHRpZiAoZGlyID09PSBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUwpIHJldHVybiAnSE9SSVpPTlRBTCc7XG4vLyBcdGlmIChkaXIgPT09IEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwpIHJldHVybiAnVkVSVElDQUwnO1xuLy8gXHRpZiAoZGlyID09PSBIYW1tZXIuRElSRUNUSU9OX0FMTCkgcmV0dXJuICdBTEwnO1xuLy8gXHRyZXR1cm4gJ1VOUkVDT0dOSVpFRCc7XG4vLyB9XG5cbnZhciBpc1ZhbGlkVG91Y2hNYW5hZ2VyID0gZnVuY3Rpb24odG91Y2gsIGRpcmVjdGlvbikge1xuXHQvLyB2YXIgcmV0dmFsO1xuXHR0cnkge1xuXHRcdHJldHVybiB0b3VjaC5nZXQoXCJocGFuXCIpLm9wdGlvbnMuZGlyZWN0aW9uID09IGRpcmVjdGlvbjtcblx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cdC8vIHJldHVybiByZXR2YWw7XG59O1xuXG4vLyAvKiogQHR5cGUge2ludH0gSW4gcGl4ZWxzICovXG4vLyB2YXIgcGFuVGhyZXNob2xkOiAxNTtcblxudmFyIGNyZWF0ZVRvdWNoTWFuYWdlciA9IGZ1bmN0aW9uKGVsLCBkaXIsIHRocmVzKSB7XG5cdHZhciB0b3VjaCA9IG5ldyBIYW1tZXIuTWFuYWdlcihlbCk7XG5cdHZhciBwYW4gPSBuZXcgSGFtbWVyLlBhbih7XG5cdFx0dGhyZXNob2xkOiAxNSxcblx0XHRkaXJlY3Rpb246IGRpcixcblx0fSk7XG5cdHZhciB0YXAgPSBuZXcgSGFtbWVyLlRhcCh7XG5cdFx0dGhyZXNob2xkOiB0aHJlcyAtIDEsXG5cdFx0aW50ZXJ2YWw6IDUwLFxuXHRcdHRpbWU6IDIwMCxcblx0fSk7XG5cdHRhcC5yZWNvZ25pemVXaXRoKHBhbik7XG5cdHRvdWNoLmFkZChbcGFuLCB0YXBdKTtcblx0cmV0dXJuIHRvdWNoO1xufTtcblxuXG52YXIgQ2Fyb3VzZWwgPSB7XG5cdC8qKiBjb25zdCAqL1xuXHRBTklNQVRFRDogZmFsc2UsXG5cdC8qKiBjb25zdCAqL1xuXHRJTU1FRElBVEU6IHRydWUsXG5cblx0LyoqIGNvcHkgb2YgSGFtbWVyLkRJUkVDVElPTl9WRVJUSUNBTCAqL1xuXHRESVJFQ1RJT05fVkVSVElDQUw6IFZFUlRJQ0FMLFxuXHQvKiogY29weSBvZiBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUwgKi9cblx0RElSRUNUSU9OX0hPUklaT05UQUw6IEhPUklaT05UQUwsXG5cdC8qKiBAdHlwZSB7T2JqZWN0fSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cblx0XHRzZWxlY3RPblNjcm9sbEVuZDogZmFsc2UsXG5cdFx0LyoqIEB0eXBlIHtib29sZWFufSAqL1xuXHRcdHJlcXVpcmVTZWxlY3Rpb246IGZhbHNlLFxuXHRcdC8qKiBAdHlwZSB7aW50fSAqL1xuXHRcdGRpcmVjdGlvbjogSE9SSVpPTlRBTCxcblx0XHQvKiogQHR5cGUge2ludH0gSW4gcGl4ZWxzICovXG5cdFx0c2VsZWN0VGhyZXNob2xkOiAyMCxcblx0XHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHRcdHJlbmRlcmVyRnVuY3Rpb246IChmdW5jdGlvbigpIHtcblx0XHRcdHZhciBkZWZhdWx0UmVuZGVyZXIgPSBDYXJvdXNlbFJlbmRlcmVyLmV4dGVuZCh7XG5cdFx0XHRcdFx0Y2xhc3NOYW1lOiBcImNhcm91c2VsLWl0ZW0gZGVmYXVsdC1yZW5kZXJlclwiXG5cdFx0XHRcdH0pLFxuXHRcdFx0XHRlbXB0eVJlbmRlcmVyID0gQ2Fyb3VzZWxSZW5kZXJlci5leHRlbmQoe1xuXHRcdFx0XHRcdGNsYXNzTmFtZTogXCJjYXJvdXNlbC1pdGVtIGVtcHR5LXJlbmRlcmVyXCJcblx0XHRcdFx0fSk7XG5cdFx0XHRyZXR1cm4gZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycikge1xuXHRcdFx0XHRyZXR1cm4gKGluZGV4ID09PSAtMSkgPyBlbXB0eVJlbmRlcmVyIDogZGVmYXVsdFJlbmRlcmVyO1xuXHRcdFx0fTtcblx0XHR9KSgpLFxuXHR9LFxufTtcbkNhcm91c2VsLnZhbGlkT3B0aW9ucyA9IF8ua2V5cyhDYXJvdXNlbC5kZWZhdWx0cyk7XG5cbi8qKlxuLyogQGNvbnN0cnVjdG9yXG4vKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9DYXJvdXNlbH1cbi8qL1xudmFyIENhcm91c2VsUHJvdG8gPSB7XG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjaWRQcmVmaXg6IFwiY2Fyb3VzZWxcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0YWdOYW1lOiBcImRpdlwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJjYXJvdXNlbCBza2lwLXRyYW5zaXRpb25zXCIsXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcHJvcGVydGllc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0c2Nyb2xsaW5nOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fc2Nyb2xsaW5nO1xuXHRcdFx0fVxuXHRcdH0sXG5cdFx0c2VsZWN0ZWRJdGVtOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fc2VsZWN0ZWRWaWV3Lm1vZGVsO1xuXHRcdFx0fSxcblx0XHRcdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0aWYgKHZhbHVlKVxuXHRcdFx0XHRcdHRoaXMuX29uU2VsZWN0T25lKHZhbHVlKVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0dGhpcy5fb25TZWxlY3ROb25lKCk7XG5cdFx0XHR9XG5cdFx0fSxcblx0fSxcblxuXHRldmVudHM6IHtcblx0XHQvLyBcIm1vdXNlZG93blwiOiBcIl9vbk1vdXNlRG93blwiLCBcIm1vdXNldXBcIjogXCJfb25Nb3VzZVVwXCIsXG5cdFx0XCJ0cmFuc2l0aW9uZW5kIC5jYXJvdXNlbC1pdGVtLnNlbGVjdGVkXCI6IFwiX29uU2Nyb2xsVHJhbnNpdGlvbkVuZFwiLFxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdF8uYmluZEFsbCh0aGlzLCBcIl9vblRvdWNoRXZlbnRcIik7XG5cblx0XHR0aGlzLml0ZW1WaWV3cyA9IG5ldyBDb250YWluZXIoKTtcblx0XHR0aGlzLm1ldHJpY3MgPSB7fTtcblxuXHRcdF8uZXh0ZW5kKHRoaXMsIF8uZGVmYXVsdHMoXy5waWNrKG9wdGlvbnMsIENhcm91c2VsLnZhbGlkT3B0aW9ucyksIENhcm91c2VsLmRlZmF1bHRzKSk7XG5cblx0XHQvLyB0aGlzLmNoaWxkR2FwID0gMDsgLy90aGlzLmRpclByb3AoMjAsIDE4KTtcblx0XHR0aGlzLl9wcmVjZWRpbmdEaXIgPSAoSGFtbWVyLkRJUkVDVElPTl9MRUZUIHwgSGFtbWVyLkRJUkVDVElPTl9VUCkgJiB0aGlzLmRpcmVjdGlvbjtcblx0XHR0aGlzLl9mb2xsb3dpbmdEaXIgPSAoSGFtbWVyLkRJUkVDVElPTl9SSUdIVCB8IEhhbW1lci5ESVJFQ1RJT05fRE9XTikgJiB0aGlzLmRpcmVjdGlvbjtcblxuXHRcdC8vIHVzZSBzdXBwbGllZCB0b3VjaCBtZ3Igb3IgY3JlYXRlIHByaXZhdGVcblx0XHRpZiAoaXNWYWxpZFRvdWNoTWFuYWdlcihvcHRpb25zLnRvdWNoLCB0aGlzLmRpcmVjdGlvbikpIHtcblx0XHRcdHRoaXMudG91Y2ggPSBvcHRpb25zLnRvdWNoO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCIlczo6aW5pdGlhbGl6ZUhhbW1lciB1c2luZyBwcml2YXRlIEhhbW1lciBpbnN0YW5jZVwiLCB0aGlzLmNpZCk7XG5cdFx0XHR0aGlzLnRvdWNoID0gY3JlYXRlVG91Y2hNYW5hZ2VyKHRoaXMuZWwsIHRoaXMuZGlyZWN0aW9uKTtcblx0XHRcdC8vIHRoaXMub24oXCJ2aWV3OnJlbW92ZWRcIiwgdGhpcy50b3VjaC5kZXN0cm95LCB0aGlzLnRvdWNoKTtcblx0XHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnJlbW92ZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMudG91Y2guZGVzdHJveSgpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0LyogY3JlYXRlIGNoaWxkcmVuIGFuZCBwcm9wcyAqL1xuXHRcdHRoaXMuc2V0RW5hYmxlZCh0cnVlKTtcblx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdFx0dGhpcy5fcmVuZGVyRmxhZ3MgPSBWaWV3LkNISUxEUkVOX0lOVkFMSUQ7XG5cdFx0Ly8gdGhpcy5pbnZhbGlkYXRlQ2hpbGRyZW4oKTtcblxuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OmF0dGFjaGVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHRcdFx0Ly8gdGhpcy5pbnZhbGlkYXRlU2l6ZSgpO1xuXHRcdFx0Ly8gdGhpcy5yZW5kZXJOb3coKTtcblx0XHRcdC8vIHRoaXMucmVxdWVzdFJlbmRlcigpO1xuXHRcdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCk7XG5cdFx0fSk7XG5cblx0XHQvKiBjb2xsZWN0aW9uIGxpc3RlbmVycyAqL1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCB7XG5cdFx0XHRcInJlc2V0XCI6IHRoaXMuX29uUmVzZXQsXG5cdFx0XHRcInNlbGVjdDpvbmVcIjogdGhpcy5fb25TZWxlY3RPbmUsXG5cdFx0XHRcInNlbGVjdDpub25lXCI6IHRoaXMuX29uU2VsZWN0Tm9uZSxcblx0XHRcdFwiZGVzZWxlY3Q6b25lXCI6IHRoaXMuX29uRGVzZWxlY3RBbnksXG5cdFx0XHRcImRlc2VsZWN0Om5vbmVcIjogdGhpcy5fb25EZXNlbGVjdEFueSxcblx0XHR9KTtcblx0fSxcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogSGFtbWVyIGluaXRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gdmFsaWRhdGVUb3VjaE1hbmFnZXI6IGZ1bmN0aW9uKHRvdWNoLCBkaXJlY3Rpb24pIHtcblx0Ly8gXHR0cnkge1xuXHQvLyBcdFx0cmV0dXJuIHRvdWNoLmdldChcInBhblwiKS5vcHRpb25zLmRpcmVjdGlvbiA9PT0gZGlyZWN0aW9uKTtcblx0Ly8gXHR9IGNhdGNoIChlcnIpIHtcblx0Ly8gXHRcdHJldHVybiBmYWxzZTtcblx0Ly8gXHR9XG5cdC8vIH0sXG5cblx0Ly8gaW5pdGlhbGl6ZUhhbW1lcjogZnVuY3Rpb24ob3B0aW9ucykge1xuXHQvLyBcdC8vIGRpcmVjdGlvbiBmcm9tIG9wdHMvZGVmYXVsdHNcblx0Ly8gXHRpZiAob3B0aW9ucy5kaXJlY3Rpb24gPT09IFZFUlRJQ0FMKSB7XG5cdC8vIFx0XHR0aGlzLmRpcmVjdGlvbiA9IFZFUlRJQ0FMO1xuXHQvLyBcdH0gLy8gZG8gbm90aGluZzogdGhlIGRlZmF1bHQgaXMgaG9yaXpvbnRhbFxuXHQvL1xuXHQvLyBcdC8vIHZhbGlkYXRlIGhhbW1lciBpbnN0YW5jZSBvciBjcmVhdGUgbG9jYWxcblx0Ly8gXHRpZiAoKHRvdWNoID0gb3B0aW9ucy50b3VjaCkgJiYgKHBhbiA9IHRvdWNoLmdldChcInBhblwiKSkpIHtcblx0Ly8gXHRcdC8vIE92ZXJyaWRlIGRpcmVjdGlvbiBvbmx5IGlmIHNwZWNpZmljXG5cdC8vIFx0XHRpZiAocGFuLm9wdGlvbnMuZGlyZWN0aW9uICE9PSBIYW1tZXIuRElSRUNUSU9OX0FMTCkge1xuXHQvLyBcdFx0XHR0aGlzLmRpcmVjdGlvbiA9IHBhbi5vcHRpb25zLmRpcmVjdGlvbjtcblx0Ly8gXHRcdH1cblx0Ly8gXHRcdHRoaXMucGFuVGhyZXNob2xkID0gcGFuLm9wdGlvbnMudGhyZXNob2xkO1xuXHQvLyBcdH0gZWxzZSB7XG5cdC8vIFx0XHRjb25zb2xlLndhcm4oXCIlczo6aW5pdGlhbGl6ZUhhbW1lciB1c2luZyBwcml2YXRlIEhhbW1lciBpbnN0YW5jZVwiLCB0aGlzLmNpZCk7XG5cdC8vIFx0XHR0b3VjaCA9IGNyZWF0ZUhhbW1lckluc3RhbmNlKHRoaXMuZWwsIHRoaXMucGFuVGhyZXNob2xkLCB0aGlzLmRpcmVjdGlvbik7XG5cdC8vIFx0XHR0aGlzLm9uKFwidmlldzpyZW1vdmVkXCIsIHRvdWNoLmRlc3Ryb3ksIHRvdWNoKTtcblx0Ly8gXHR9XG5cdC8vIFx0dGhpcy50b3VjaCA9IHRvdWNoO1xuXHQvLyB9LFxuXG5cdHJlbW92ZTogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gdGhpcy5fc2Nyb2xsUGVuZGluZ0FjdGlvbiAmJiB0aGlzLl9zY3JvbGxQZW5kaW5nQWN0aW9uKHRydWUpO1xuXHRcdC8vIGlmICh0aGlzLl9lbmFibGVkKSB7XG5cdFx0Ly8gXHR0aGlzLnRvdWNoLm9mZihcInRhcFwiLCB0aGlzLl9vblRhcCk7XG5cdFx0Ly8gXHR0aGlzLnRvdWNoLm9mZihcImhwYW5zdGFydCBocGFubW92ZSBocGFuZW5kIGhwYW5jYW5jZWxcIiwgdGhpcy5fb25QYW4pO1xuXHRcdC8vIH1cblx0XHR0aGlzLl90b2dnbGVUb3VjaEV2ZW50cyhmYWxzZSk7XG5cdFx0dGhpcy5yZW1vdmVDaGlsZHJlbigpO1xuXHRcdFZpZXcucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogaGVscGVyIGZ1bmN0aW9uc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRkaXJQcm9wOiBmdW5jdGlvbihoUHJvcCwgdlByb3ApIHtcblx0XHRyZXR1cm4gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyBoUHJvcCA6IHZQcm9wO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvLyByZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdGlmICh0aGlzLmF0dGFjaGVkKSB7XG5cdC8vIFx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IHRydWU7XG5cdC8vIFx0XHQvLyB0aGlzLmludmFsaWRhdGVTaXplKCk7XG5cdC8vIFx0XHR0aGlzLnJlbmRlck5vdyh0cnVlKTtcblx0Ly8gXHR9XG5cdC8vIH0sXG5cblx0Ly8gLyoqIEBvdmVycmlkZSAqL1xuXHQvLyByZW5kZXI6IGZ1bmN0aW9uICgpIHtcblx0Ly8gXHRpZiAoIXRoaXMuYXR0YWNoZWQpIHtcblx0Ly8gXHRcdGlmICghdGhpcy5fcmVuZGVyUGVuZGluZykge1xuXHQvLyBcdFx0XHR0aGlzLl9yZW5kZXJQZW5kaW5nID0gdHJ1ZTtcblx0Ly8gXHRcdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLCBcInZpZXc6YXR0YWNoZWRcIiwgdGhpcy5yZW5kZXIpO1xuXHQvLyBcdFx0fVxuXHQvLyBcdH0gZWxzZSB7XG5cdC8vIFx0XHRpZiAodGhpcy5fcmVuZGVyUGVuZGluZykge1xuXHQvLyBcdFx0XHR0aGlzLl9yZW5kZXJQZW5kaW5nID0gZmFsc2U7XG5cdC8vIFx0XHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLCBcInZpZXc6YXR0YWNoZWRcIiwgdGhpcy5yZW5kZXIpO1xuXHQvLyBcdFx0fVxuXHQvLyBcdFx0dGhpcy5fZGVsdGEgPSAwO1xuXHQvLyBcdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHQvLyBcdFx0dGhpcy5pbnZhbGlkYXRlU2l6ZSgpO1xuXHQvLyBcdFx0Ly8gdGhpcy5pbnZhbGlkYXRlTGF5b3V0KCk7XG5cdC8vIFx0XHR0aGlzLnJlbmRlck5vdygpO1xuXHQvLyBcdH1cblx0Ly8gXHRyZXR1cm4gdGhpcztcblx0Ly8gfSxcblxuXHQvLyByZW5kZXI6IGZ1bmN0aW9uICgpIHtcblx0Ly8gXHR0aGlzLm1lYXN1cmVMYXRlcigpO1xuXHQvLyBcdHRoaXMuc2Nyb2xsQnkoMCwgQ2Fyb3VzZWwuSU1NRURJQVRFKTtcblx0Ly9cblx0Ly8gXHRpZiAodGhpcy5lbC5wYXJlbnRFbGVtZW50KSB7XG5cdC8vIFx0XHR0aGlzLnJlbmRlck5vdygpO1xuXHQvLyBcdH1cblx0Ly8gXHRyZXR1cm4gdGhpcztcblx0Ly8gfSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlckZyYW1lOiBmdW5jdGlvbih0c3RhbXAsIGZsYWdzKSB7XG5cdFx0aWYgKGZsYWdzICYgVmlldy5DSElMRFJFTl9JTlZBTElEKSB7XG5cdFx0XHR0aGlzLl9jcmVhdGVDaGlsZHJlbigpO1xuXHRcdFx0Ly8gY2xlYXIgdGhpcyBmbGFnIG5vdzogcmVuZGVyIG1heSBiZSBkZWZlcnJlZCB1bnRpbCBhdHRhY2hlZFxuXHRcdFx0ZmxhZ3MgJj0gflZpZXcuQ0hJTERSRU5fSU5WQUxJRDtcblx0XHR9XG5cdFx0aWYgKHRoaXMuYXR0YWNoZWQpIHtcblx0XHRcdGlmIChmbGFncyAmIFZpZXcuU0laRV9JTlZBTElEKSB7XG5cdFx0XHRcdHRoaXMuX21lYXN1cmUoKTtcblx0XHRcdH1cblx0XHRcdGlmIChmbGFncyAmIChWaWV3LkxBWU9VVF9JTlZBTElEIHwgVmlldy5TSVpFX0lOVkFMSUQpKSB7XG5cdFx0XHRcdHRoaXMuX3Njcm9sbEJ5KHRoaXMuX2RlbHRhLCB0aGlzLnNraXBUcmFuc2l0aW9ucyk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChmbGFncykge1xuXHRcdFx0dGhpcy5saXN0ZW5Ub09uY2UodGhpcywgXCJ2aWV3OmF0dGFjaGVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoZmxhZ3MpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGVuYWJsZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRfZW5hYmxlZDogdW5kZWZpbmVkLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0c2V0RW5hYmxlZDogZnVuY3Rpb24oZW5hYmxlZCkge1xuXHRcdGlmICh0aGlzLl9lbmFibGVkICE9PSBlbmFibGVkKSB7XG5cdFx0XHR0aGlzLl9lbmFibGVkID0gZW5hYmxlZDtcblx0XHRcdC8vIHRvZ2dsZSBldmVudHMgaW1tZWRpYXRlbHlcblx0XHRcdHRoaXMuX3RvZ2dsZVRvdWNoRXZlbnRzKGVuYWJsZWQpO1xuXHRcdFx0Ly8gZG9tIG1hbmlwdWxhdGlvbiBvbiByZW5kZXIgKF9yZW5kZXJFbmFibGVkKVxuXHRcdFx0Ly8gdGhpcy5fcmVuZGVyRmxhZ3MgfD0gVmlldy5TVFlMRVNfSU5WQUxJRDtcblx0XHRcdC8vIHRoaXMucmVxdWVzdFJlbmRlcigpO1xuXG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJkaXNhYmxlZFwiLCAhdGhpcy5lbmFibGVkKTtcblx0XHRcdHRoaXMuaXRlbVZpZXdzLmVhY2goZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHR2aWV3LnNldEVuYWJsZWQodGhpcy5lbmFibGVkKTtcblx0XHRcdH0sIHRoaXMpO1xuXHRcdH1cblx0fSxcblxuXHRfcmVuZGVyRW5hYmxlZDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZGlzYWJsZWRcIiwgIXRoaXMuZW5hYmxlZCk7XG5cdFx0dGhpcy5pdGVtVmlld3MuZWFjaChmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHR2aWV3LnNldEVuYWJsZWQodGhpcy5lbmFibGVkKTtcblx0XHR9LCB0aGlzKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBDcmVhdGUgY2hpbGRyZW5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2NyZWF0ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHQvLyB2YXIgc0luZGV4O1xuXHRcdHZhciBidWZmZXIsIHJlbmRlcmVyLCB2aWV3LCB2aWV3T3B0cztcblxuXHRcdHRoaXMucmVtb3ZlQ2hpbGRyZW4oKTtcblxuXHRcdGlmICh0aGlzLmNvbGxlY3Rpb24ubGVuZ3RoKSB7XG5cdFx0XHR2aWV3T3B0cyA9IHtcblx0XHRcdFx0Ly8gdmlld0RlcHRoOiB0aGlzLnZpZXdEZXB0aCArIDEsXG5cdFx0XHRcdC8vIHBhcmVudFZpZXc6IHRoaXMsXG5cdFx0XHRcdGVuYWJsZWQ6IHRoaXMuZW5hYmxlZFxuXHRcdFx0fTtcblx0XHRcdGJ1ZmZlciA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcblx0XHRcdC8vIGJ1ZmZlciA9IHRoaXMuZWw7XG5cblx0XHRcdGlmICghdGhpcy5yZXF1aXJlU2VsZWN0aW9uKSB7XG5cdFx0XHRcdHJlbmRlcmVyID0gdGhpcy5yZW5kZXJlckZ1bmN0aW9uKG51bGwsIC0xLCB0aGlzLmNvbGxlY3Rpb24pO1xuXHRcdFx0XHR2aWV3ID0gbmV3IHJlbmRlcmVyKHZpZXdPcHRzKTtcblx0XHRcdFx0dGhpcy5pdGVtVmlld3MuYWRkKHZpZXcpO1xuXHRcdFx0XHRidWZmZXIuYXBwZW5kQ2hpbGQodmlldy5lbCk7XG5cdFx0XHRcdHRoaXMuZW1wdHlWaWV3ID0gdmlldztcblx0XHRcdH1cblxuXHRcdFx0dGhpcy5jb2xsZWN0aW9uLmVhY2goZnVuY3Rpb24oaXRlbSwgaW5kZXgsIGFycikge1xuXHRcdFx0XHR2aWV3T3B0cy5tb2RlbCA9IGl0ZW07XG5cdFx0XHRcdHJlbmRlcmVyID0gdGhpcy5yZW5kZXJlckZ1bmN0aW9uKGl0ZW0sIGluZGV4LCBhcnIpO1xuXHRcdFx0XHR2aWV3ID0gbmV3IHJlbmRlcmVyKHZpZXdPcHRzKTtcblx0XHRcdFx0dGhpcy5pdGVtVmlld3MuYWRkKHZpZXcpO1xuXHRcdFx0XHRidWZmZXIuYXBwZW5kQ2hpbGQodmlldy5lbCk7XG5cdFx0XHR9LCB0aGlzKTtcblxuXHRcdFx0Ly8gaWYgKCF0aGlzLnJlcXVpcmVTZWxlY3Rpb24pIHtcblx0XHRcdC8vIFx0YnVmZmVyID0gdGhpcy5hcHBlbmRJdGVtVmlldyhidWZmZXIsIHRoaXMubW9kZWwsIC0xLCB0aGlzLmNvbGxlY3Rpb24pO1xuXHRcdFx0Ly8gXHR0aGlzLmVtcHR5VmlldyA9IHRoaXMuaXRlbVZpZXdzLmZpcnN0KCk7XG5cdFx0XHQvLyB9XG5cdFx0XHQvLyBidWZmZXIgPSB0aGlzLmNvbGxlY3Rpb24ucmVkdWNlKHRoaXMuYXBwZW5kSXRlbVZpZXcsIGJ1ZmZlciwgdGhpcyk7XG5cblx0XHRcdHRoaXMuYWRqdXN0VG9TZWxlY3Rpb24oKTtcblx0XHRcdHRoaXMuX3NlbGVjdGVkVmlldy5lbC5jbGFzc0xpc3QuYWRkKFwic2VsZWN0ZWRcIik7XG5cblx0XHRcdHRoaXMuZWwuYXBwZW5kQ2hpbGQoYnVmZmVyKTtcblx0XHR9XG5cdH0sXG5cblx0Ly8gYXBwZW5kSXRlbVZpZXc6IGZ1bmN0aW9uIChwYXJlbnRFbCwgbW9kZWwsIGluZGV4LCBhcnIpIHtcblx0Ly8gXHR2YXIgcmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyRnVuY3Rpb24obW9kZWwsIGluZGV4LCBhcnIpO1xuXHQvLyBcdHZhciB2aWV3ID0gbmV3IHJlbmRlcmVyKHtcblx0Ly8gXHRcdG1vZGVsOiBtb2RlbCxcblx0Ly8gXHRcdHBhcmVudFZpZXc6IHRoaXMsXG5cdC8vIFx0XHRlbmFibGVkOiB0aGlzLmVuYWJsZWRcblx0Ly8gXHR9KTtcblx0Ly8gXHR0aGlzLml0ZW1WaWV3cy5hZGQodmlldyk7XG5cdC8vIFx0cGFyZW50RWwuYXBwZW5kQ2hpbGQodmlldy5lbCk7XG5cdC8vIFx0cmV0dXJuIHBhcmVudEVsO1xuXHQvLyB9LFxuXG5cdC8vIGNyZWF0ZUl0ZW1WaWV3OiBmdW5jdGlvbiAocmVuZGVyZXIsIG9wdHMpIHtcblx0Ly8gXHR2YXIgdmlldyA9IG5ldyByZW5kZXJlcihvcHRzKTtcblx0Ly8gXHR0aGlzLml0ZW1WaWV3cy5hZGQodmlldyk7XG5cdC8vIFx0cmV0dXJuIHZpZXc7XG5cdC8vIH0sXG5cblx0cmVtb3ZlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuaXRlbVZpZXdzLmVhY2godGhpcy5yZW1vdmVJdGVtVmlldywgdGhpcyk7XG5cdFx0dGhpcy5lbXB0eVZpZXcgPSB2b2lkIDA7XG5cdH0sXG5cblx0cmVtb3ZlSXRlbVZpZXc6IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHR0aGlzLml0ZW1WaWV3cy5yZW1vdmUodmlldyk7XG5cdFx0dmlldy5yZW1vdmUoKTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBtZWFzdXJlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9tZWFzdXJlOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgbSwgbW07XG5cdFx0dmFyIHBvcyA9IDAsXG5cdFx0XHRwb3NJbm5lciA9IDA7XG5cdFx0dmFyIG1heEFjcm9zcyA9IDAsXG5cdFx0XHRtYXhPdXRlciA9IDA7XG5cdFx0dmFyIG1heE91dGVyVmlldywgbWF4QWNyb3NzVmlldztcblxuXHRcdG1heE91dGVyVmlldyA9IG1heEFjcm9zc1ZpZXcgPSB0aGlzLmVtcHR5VmlldyB8fCB0aGlzLml0ZW1WaWV3cy5maXJzdCgpO1xuXG5cdFx0Ly8gY2hpZHJlbiBtZXRyaWNzXG5cdFx0dGhpcy5pdGVtVmlld3MuZWFjaChmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHR2aWV3LnJlbmRlcigpO1xuXHRcdH0pO1xuXG5cdFx0dGhpcy5pdGVtVmlld3MuZWFjaChmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRtID0gdGhpcy5tZWFzdXJlSXRlbVZpZXcodmlldyk7XG5cdFx0XHRtLnBvcyA9IHBvcztcblx0XHRcdHBvcyArPSBtLm91dGVyOyAvLyArIHRoaXMuY2hpbGRHYXA7XG5cdFx0XHRtLnBvc0lubmVyID0gcG9zSW5uZXI7XG5cdFx0XHRwb3NJbm5lciArPSBtLmlubmVyOyAvLysgdGhpcy5jaGlsZEdhcDtcblx0XHRcdGlmICh2aWV3ICE9PSB0aGlzLmVtcHR5Vmlldykge1xuXHRcdFx0XHRpZiAobS5hY3Jvc3MgPiBtYXhBY3Jvc3MpIHtcblx0XHRcdFx0XHRtYXhBY3Jvc3MgPSBtLmFjcm9zcztcblx0XHRcdFx0XHRtYXhBY3Jvc3NWaWV3ID0gdmlldztcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAobS5vdXRlciA+IG1heE91dGVyKSB7XG5cdFx0XHRcdFx0bWF4T3V0ZXIgPSBtLm91dGVyO1xuXHRcdFx0XHRcdG1heE91dGVyVmlldyA9IHZpZXc7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9LCB0aGlzKTtcblxuXHRcdC8vIG1lYXN1cmUgc2VsZiArIG1heCBjaGlsZCBtZXRyaWNzXG5cdFx0bW0gPSB0aGlzLm1ldHJpY3NbdGhpcy5jaWRdIHx8ICh0aGlzLm1ldHJpY3NbdGhpcy5jaWRdID0ge30pO1xuXHRcdG1tLm91dGVyID0gdGhpcy5lbFt0aGlzLmRpclByb3AoXCJvZmZzZXRXaWR0aFwiLCBcIm9mZnNldEhlaWdodFwiKV07XG5cdFx0bW0uYmVmb3JlID0gbWF4T3V0ZXJWaWV3LmVsW3RoaXMuZGlyUHJvcChcIm9mZnNldExlZnRcIiwgXCJvZmZzZXRUb3BcIildO1xuXHRcdG1tLmlubmVyID0gbWF4T3V0ZXJWaWV3LmVsW3RoaXMuZGlyUHJvcChcIm9mZnNldFdpZHRoXCIsIFwib2Zmc2V0SGVpZ2h0XCIpXTtcblx0XHRtbS5hZnRlciA9IG1tLm91dGVyIC0gKG1tLmlubmVyICsgbW0uYmVmb3JlKTtcblx0XHRtbS5hY3Jvc3MgPSBtYXhBY3Jvc3M7XG5cblx0XHQvLyBtID0gdGhpcy5tZXRyaWNzW21heE91dGVyVmlldy5jaWRdO1xuXHRcdC8vIG1tLmlubmVyID0gbS5pbm5lcjtcblxuXHRcdC8vIHRhcCBhcmVhXG5cdFx0dGhpcy5fdGFwQWNyb3NzQmVmb3JlID0gbWF4QWNyb3NzVmlldy5lbFt0aGlzLmRpclByb3AoXCJvZmZzZXRUb3BcIiwgXCJvZmZzZXRMZWZ0XCIpXTtcblx0XHR0aGlzLl90YXBBY3Jvc3NBZnRlciA9IHRoaXMuX3RhcEFjcm9zc0JlZm9yZSArIG1heEFjcm9zcztcblx0XHR0aGlzLl90YXBCZWZvcmUgPSBtbS5iZWZvcmUgKyB0aGlzLl90YXBHcm93O1xuXHRcdHRoaXMuX3RhcEFmdGVyID0gbW0uYmVmb3JlICsgbW0uaW5uZXIgLSB0aGlzLl90YXBHcm93O1xuXG5cdFx0dGhpcy5zZWxlY3RUaHJlc2hvbGQgPSBNYXRoLm1pbihNQVhfU0VMRUNUX1RIUkVTSE9MRCwgbW0ub3V0ZXIgKiAwLjEpO1xuXHR9LFxuXG5cdG1lYXN1cmVJdGVtVmlldzogZnVuY3Rpb24odmlldykge1xuXHRcdHZhciBtLCB2aWV3RWw7XG5cdFx0Ly8gdmFyIHMsIHNpemVFbDtcblxuXHRcdHZpZXdFbCA9IHZpZXcuZWw7XG5cdFx0bSA9IHRoaXMubWV0cmljc1t2aWV3LmNpZF0gfHwgKHRoaXMubWV0cmljc1t2aWV3LmNpZF0gPSB7fSk7XG5cblx0XHRtLm91dGVyID0gdmlld0VsW3RoaXMuZGlyUHJvcChcIm9mZnNldFdpZHRoXCIsIFwib2Zmc2V0SGVpZ2h0XCIpXTtcblx0XHRtLmFjcm9zcyA9IHZpZXdFbFt0aGlzLmRpclByb3AoXCJvZmZzZXRIZWlnaHRcIiwgXCJvZmZzZXRXaWR0aFwiKV07XG5cblx0XHRpZiAodmlldy5tZXRyaWNzKSB7XG5cdFx0XHRtLmJlZm9yZSA9IHZpZXcubWV0cmljc1t0aGlzLmRpclByb3AoXCJtYXJnaW5MZWZ0XCIsIFwibWFyZ2luVG9wXCIpXTtcblx0XHRcdG0ub3V0ZXIgKz0gbS5iZWZvcmU7XG5cdFx0XHRtLm91dGVyICs9IHZpZXcubWV0cmljc1t0aGlzLmRpclByb3AoXCJtYXJnaW5SaWdodFwiLCBcIm1hcmdpbkJvdHRvbVwiKV07XG5cdFx0XHRtLmlubmVyID0gdmlldy5tZXRyaWNzLmNvbnRlbnRbdGhpcy5kaXJQcm9wKFwid2lkdGhcIiwgXCJoZWlnaHRcIildO1xuXHRcdFx0bS5iZWZvcmUgKz0gdmlldy5tZXRyaWNzLmNvbnRlbnRbdGhpcy5kaXJQcm9wKFwieFwiLCBcInlcIildO1xuXHRcdFx0bS5hZnRlciA9IG0ub3V0ZXIgLSAobS5pbm5lciArIG0uYmVmb3JlKTtcblxuXHRcdFx0Ly8gdmFyIG1hcmdpbkJlZm9yZSA9IHZpZXcubWV0cmljc1t0aGlzLmRpclByb3AoXCJtYXJnaW5MZWZ0XCIsXCJtYXJnaW5Ub3BcIildO1xuXHRcdFx0Ly8gdmFyIG1hcmdpbkFmdGVyID0gdmlldy5tZXRyaWNzW3RoaXMuZGlyUHJvcChcIm1hcmdpblJpZ2h0XCIsXCJtYXJnaW5Cb3R0b21cIildO1xuXHRcdFx0Ly8gdmFyIHBvcyA9IHZpZXcubWV0cmljcy5jb250ZW50W3RoaXMuZGlyUHJvcChcInhcIixcInlcIildO1xuXHRcdFx0Ly9cblx0XHRcdC8vIG0uaW5uZXIgPSB2aWV3Lm1ldHJpY3MuY29udGVudFt0aGlzLmRpclByb3AoXCJ3aWR0aFwiLFwiaGVpZ2h0XCIpXTtcblx0XHRcdC8vIG0uYmVmb3JlID0gbWFyZ2luQmVmb3JlICsgcG9zO1xuXHRcdFx0Ly8gbS5vdXRlciArPSBtYXJnaW5CZWZvcmUgKyBtYXJnaW5BZnRlcjtcblx0XHRcdC8vIG0uYWZ0ZXIgPSBtLm91dGVyIC0gKG0uaW5uZXIgKyBtLmJlZm9yZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIHRocm93IG5ldyBFcnJvcihcInJlbmRlcmVyIGhhcyBubyBtZXRyaWNzXCIpO1xuXHRcdFx0Y29uc29sZS53YXJuKFwiJXM6Om1lYXN1cmVJdGVtVmlldyB2aWV3ICclcycgaGFzIG5vIG1ldHJpY3NcIiwgdGhpcy5jaWQsIHZpZXcuY2lkKTtcblx0XHRcdG0uaW5uZXIgPSBtLm91dGVyO1xuXHRcdFx0bS5hZnRlciA9IG0uYmVmb3JlID0gMDtcblx0XHR9XG5cblx0XHRyZXR1cm4gbTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBzY3JvbGxpbmcgcHJvcGVydHlcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2RlbHRhOiAwLFxuXG5cdF9zY3JvbGxpbmc6IGZhbHNlLFxuXG5cdF9zZXRTY3JvbGxpbmc6IGZ1bmN0aW9uKHNjcm9sbGluZykge1xuXHRcdC8vIGNvbnNvbGUud2FybihcIl9zZXRTY3JvbGxpbmcgY3VycmVudC9yZXF1ZXN0ZWRcIiwgdGhpcy5fc2Nyb2xsaW5nLCBzY3JvbGxpbmcpO1xuXHRcdGlmICh0aGlzLl9zY3JvbGxpbmcgIT0gc2Nyb2xsaW5nKSB7XG5cdFx0XHR0aGlzLl9zY3JvbGxpbmcgPSBzY3JvbGxpbmc7XG5cdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJzY3JvbGxpbmdcIiwgc2Nyb2xsaW5nKTtcblx0XHRcdHRoaXMudHJpZ2dlcihzY3JvbGxpbmcgPyBcInZpZXc6c2Nyb2xsc3RhcnRcIiA6IFwidmlldzpzY3JvbGxlbmRcIik7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFNjcm9sbC9sYXlvdXRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0c2Nyb2xsQnk6IGZ1bmN0aW9uKGRlbHRhLCBza2lwVHJhbnNpdGlvbnMpIHtcblx0XHR0aGlzLl9kZWx0YSA9IGRlbHRhIHx8IDA7XG5cdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSAhIXNraXBUcmFuc2l0aW9ucztcblx0XHQvLyB0aGlzLmludmFsaWRhdGVMYXlvdXQoKTtcblx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5MQVlPVVRfSU5WQUxJRCk7XG5cdH0sXG5cblx0X3Njcm9sbEJ5OiBmdW5jdGlvbihkZWx0YSwgc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0dmFyIHNNZXRyaWNzLCBtZXRyaWNzLCBwb3M7XG5cblx0XHRzTWV0cmljcyA9IHRoaXMubWV0cmljc1sodGhpcy5fc2Nyb2xsQ2FuZGlkYXRlVmlldyB8fCB0aGlzLl9zZWxlY3RlZFZpZXcpLmNpZF07XG5cdFx0dGhpcy5pdGVtVmlld3MuZWFjaChmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRtZXRyaWNzID0gdGhpcy5tZXRyaWNzW3ZpZXcuY2lkXTtcblx0XHRcdHBvcyA9IE1hdGguZmxvb3IodGhpcy5fZ2V0U2Nyb2xsT2Zmc2V0KGRlbHRhLCBtZXRyaWNzLCBzTWV0cmljcykpO1xuXHRcdFx0dmlldy5tZXRyaWNzLnRyYW5zbGF0ZVggPSAodGhpcy5kaXJlY3Rpb24gJiBIT1JJWk9OVEFMKSA/IHBvcyA6IDA7XG5cdFx0XHR2aWV3Lm1ldHJpY3MudHJhbnNsYXRlWSA9ICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpID8gMCA6IHBvcztcblx0XHRcdHZpZXcubWV0cmljcy5fdHJhbnNmb3JtID0gdHJhbnNsYXRlVGVtcGxhdGUodmlldy5tZXRyaWNzLnRyYW5zbGF0ZVgsIHZpZXcubWV0cmljcy50cmFuc2xhdGVZKTtcblx0XHRcdHZpZXcuZWwuc3R5bGVbdHJhbnNmb3JtUHJvcGVydHldID0gdmlldy5tZXRyaWNzLl90cmFuc2Zvcm07XG5cdFx0XHQvLyB2aWV3LmVsLnN0eWxlW3RyYW5zZm9ybVByb3BlcnR5XSA9ICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpP1xuXHRcdFx0Ly8gXHRcInRyYW5zbGF0ZTNkKFwiICsgcG9zICsgXCJweCwwLDApXCI6XG5cdFx0XHQvLyBcdFwidHJhbnNsYXRlM2QoMCxcIiArIHBvcyArIFwicHgsMClcIjtcblx0XHR9LCB0aGlzKTtcblxuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcInNraXAtdHJhbnNpdGlvbnNcIiwgc2tpcFRyYW5zaXRpb25zKTtcblx0XHR0aGlzLnNlbGVjdEZyb21WaWV3KCk7XG5cdH0sXG5cblx0X2dldFNjcm9sbE9mZnNldDogZnVuY3Rpb24oZGVsdGEsIG1DdXJyLCBtU2VsKSB7XG5cdFx0dmFyIHBvcywgb2Zmc2V0ID0gMDtcblxuXHRcdHBvcyA9IG1DdXJyLnBvcyAtIG1TZWwucG9zICsgZGVsdGE7XG5cdFx0aWYgKHBvcyA8IDApIHtcblx0XHRcdGlmIChNYXRoLmFicyhwb3MpIDwgbUN1cnIub3V0ZXIpIHtcblx0XHRcdFx0b2Zmc2V0ICs9ICgtbUN1cnIuYWZ0ZXIpIC8gbUN1cnIub3V0ZXIgKiBwb3M7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRvZmZzZXQgKz0gbUN1cnIuYWZ0ZXI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlXG5cdFx0aWYgKDAgPD0gcG9zKSB7XG5cdFx0XHRpZiAoTWF0aC5hYnMocG9zKSA8IG1DdXJyLm91dGVyKSB7XG5cdFx0XHRcdG9mZnNldCAtPSBtQ3Vyci5iZWZvcmUgLyBtQ3Vyci5vdXRlciAqIHBvcztcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdG9mZnNldCAtPSBtQ3Vyci5iZWZvcmU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBwb3MgKyBvZmZzZXQ7XG5cdH0sXG5cblx0X29uU2Nyb2xsVHJhbnNpdGlvbkVuZDogZnVuY3Rpb24oZXYpIHtcblx0XHRpZiAoZXYucHJvcGVydHlOYW1lID09PSB0cmFuc2Zvcm1TdHlsZU5hbWUgJiYgdGhpcy5zY3JvbGxpbmcpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vblNjcm9sbFRyYW5zaXRpb25FbmQgc2VsZWN0ZWQ6ICVzXCIsIHRoaXMuY2lkLCBldi50YXJnZXQuY2lkKTtcblx0XHRcdHRoaXMuX3NldFNjcm9sbGluZyhmYWxzZSk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHRvZ2dsZSB0b3VjaCBldmVudHNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X3RvZ2dsZVRvdWNoRXZlbnRzOiBmdW5jdGlvbihlbmFibGUpIHtcblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpfdG9nZ2xlVG91Y2hFdmVudHNcIiwgdGhpcy5jaWQsIGVuYWJsZSk7XG5cdFx0aWYgKHRoaXMuX3RvdWNoRXZlbnRzRW5hYmxlZCAhPT0gZW5hYmxlKSB7XG5cdFx0XHR0aGlzLl90b3VjaEV2ZW50c0VuYWJsZWQgPSBlbmFibGU7XG5cdFx0XHRpZiAoZW5hYmxlKSB7XG5cdFx0XHRcdHRoaXMudG91Y2gub24oXCJocGFuc3RhcnQgaHBhbm1vdmUgaHBhbmVuZCBocGFuY2FuY2VsIHRhcFwiLCB0aGlzLl9vblRvdWNoRXZlbnQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy50b3VjaC5vZmYoXCJocGFuc3RhcnQgaHBhbm1vdmUgaHBhbmVuZCBocGFuY2FuY2VsIHRhcFwiLCB0aGlzLl9vblRvdWNoRXZlbnQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRfb25Ub3VjaEV2ZW50OiBmdW5jdGlvbihldikge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol9vblRvdWNoRXZlbnRcIiwgdGhpcy5jaWQsIGV2LnR5cGUpO1xuXHRcdHN3aXRjaCAoZXYudHlwZSkge1xuXHRcdFx0Y2FzZSBcInRhcFwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fb25UYXAoZXYpO1xuXHRcdFx0Y2FzZSBcImhwYW5zdGFydFwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fb25QYW5TdGFydChldik7XG5cdFx0XHRjYXNlIFwiaHBhbm1vdmVcIjpcblx0XHRcdFx0cmV0dXJuIHRoaXMuX29uUGFuTW92ZShldik7XG5cdFx0XHRjYXNlIFwiaHBhbmVuZFwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fb25QYW5GaW5hbChldik7XG5cdFx0XHRjYXNlIFwiaHBhbmNhbmNlbFwiOlxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fb25QYW5GaW5hbChldik7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHRvdWNoIGV2ZW50OiBwYW5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gX3BhbkNhcHR1cmVkT2Zmc2V0OiAwLFxuXG5cdC8qKiBAcGFyYW0ge09iamVjdH0gZXYgKi9cblx0X29uUGFuU3RhcnQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy5zZWxlY3RGcm9tVmlldygpO1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChcInBhbm5pbmdcIik7XG5cdFx0dGhpcy5fc2V0U2Nyb2xsaW5nKHRydWUpO1xuXHR9LFxuXG5cdC8qKiBAcGFyYW0ge09iamVjdH0gZXYgKi9cblx0X29uUGFuTW92ZTogZnVuY3Rpb24oZXYpIHtcblx0XHR2YXIgdmlldyA9IHRoaXMuZ2V0Vmlld0F0UGFuRGlyKGV2Lm9mZnNldERpcmVjdGlvbik7XG5cdFx0dmFyIGRlbHRhID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyBldi50aHJlc2hvbGREZWx0YVggOiBldi50aHJlc2hvbGREZWx0YVk7XG5cdFx0Ly8gdmFyIGRlbHRhID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyBldi5kZWx0YVggOiBldi5kZWx0YVk7XG5cblx0XHRpZiAodGhpcy5fcGFuQ2FuZGlkYXRlVmlldyAhPT0gdmlldykge1xuXHRcdFx0dGhpcy5fcGFuQ2FuZGlkYXRlVmlldyAmJiB0aGlzLl9wYW5DYW5kaWRhdGVWaWV3LmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjYW5kaWRhdGVcIik7XG5cdFx0XHR0aGlzLl9wYW5DYW5kaWRhdGVWaWV3ID0gdmlldztcblx0XHRcdHRoaXMuX3BhbkNhbmRpZGF0ZVZpZXcgJiYgdGhpcy5fcGFuQ2FuZGlkYXRlVmlldy5lbC5jbGFzc0xpc3QuYWRkKFwiY2FuZGlkYXRlXCIpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fcGFuQ2FuZGlkYXRlVmlldyA9PT0gdm9pZCAwKSB7XG5cdFx0XHRkZWx0YSAqPSBHbG9iYWxzLkhQQU5fT1VUX0RSQUc7XG5cdFx0fVxuXG5cdFx0aWYgKHRoaXMuX3JlbmRlclJhZklkICE9PSAtMSkge1xuXHRcdFx0dGhpcy5zY3JvbGxCeShkZWx0YSwgQ2Fyb3VzZWwuSU1NRURJQVRFKTtcblx0XHRcdHRoaXMucmVuZGVyTm93KCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuX3Njcm9sbEJ5KGRlbHRhLCBDYXJvdXNlbC5JTU1FRElBVEUpO1xuXHRcdH1cblx0fSxcblxuXHQvKiogQHBhcmFtIHtPYmplY3R9IGV2ICovXG5cdF9vblBhbkZpbmFsOiBmdW5jdGlvbihldikge1xuXHRcdHZhciBzY3JvbGxDYW5kaWRhdGU7XG5cdFx0Ly8gTk9URTogdGhpcyBkZWx0YSBpcyB1c2VkIGZvciBkZXRlcm1pbmluZyBzZWxlY3Rpb24sIE5PVCBmb3IgbGF5b3V0XG5cdFx0dmFyIGRlbHRhID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyBldi50aHJlc2hvbGREZWx0YVggOiBldi50aHJlc2hvbGREZWx0YVk7XG5cdFx0Ly8gdmFyIGRlbHRhID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCkgPyBldi5kZWx0YVggOiBldi5kZWx0YVk7XG5cblx0XHRpZiAoKGV2LnR5cGUgPT0gXCJocGFuZW5kXCIpXG5cdFx0XHQvKiBwYW4gZGlyZWN0aW9uIChjdXJyZW50IGV2ZW50KSBhbmQgb2Zmc2V0RGlyZWN0aW9uICh3aG9sZSBnZXN0dXJlKSBtdXN0IG1hdGNoICovXG5cdFx0XHQmJiAoZXYuZGlyZWN0aW9uIF4gZXYub2Zmc2V0RGlyZWN0aW9uIF4gdGhpcy5kaXJlY3Rpb24pXG5cdFx0XHQvLyAmJiAoZXYuZGlyZWN0aW9uICYgZXYub2Zmc2V0RGlyZWN0aW9uICYgdGhpcy5kaXJlY3Rpb24pXG5cdFx0XHQvKiBnZXN0dXJlIG11c3Qgb3ZlcnNob290IHNlbGVjdFRocmVzaG9sZCAqL1xuXHRcdFx0JiYgKE1hdGguYWJzKGRlbHRhKSA+IHRoaXMuc2VsZWN0VGhyZXNob2xkKSkge1xuXHRcdFx0LyogY2hvb3NlIG5leHQgc2Nyb2xsIHRhcmdldCAqL1xuXHRcdFx0c2Nyb2xsQ2FuZGlkYXRlID0gdGhpcy5nZXRWaWV3QXRQYW5EaXIoZXYub2Zmc2V0RGlyZWN0aW9uKTtcblx0XHR9XG5cdFx0dGhpcy5fc2Nyb2xsQ2FuZGlkYXRlVmlldyA9IHNjcm9sbENhbmRpZGF0ZSB8fCB2b2lkIDA7XG5cblx0XHRpZiAodGhpcy5fcGFuQ2FuZGlkYXRlVmlldyAmJiAodGhpcy5fcGFuQ2FuZGlkYXRlVmlldyAhPT0gc2Nyb2xsQ2FuZGlkYXRlKSkge1xuXHRcdFx0dGhpcy5fcGFuQ2FuZGlkYXRlVmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FuZGlkYXRlXCIpO1xuXHRcdH1cblx0XHR0aGlzLl9wYW5DYW5kaWRhdGVWaWV3ID0gdm9pZCAwO1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcInBhbm5pbmdcIik7XG5cblx0XHR0aGlzLnNjcm9sbEJ5KDAsIENhcm91c2VsLkFOSU1BVEVEKTtcblx0XHR0aGlzLnNlbGVjdEZyb21WaWV3KCk7XG5cblx0XHQvLyBpZiAodGhpcy5fcmVuZGVyUmFmSWQgIT09IC0xKSB7XG5cdFx0Ly8gXHR0aGlzLnNjcm9sbEJ5KDAsIENhcm91c2VsLkFOSU1BVEVEKTtcblx0XHQvLyBcdHRoaXMucmVuZGVyTm93KCk7XG5cdFx0Ly8gfSBlbHNlIHtcblx0XHQvLyBcdHRoaXMuX3Njcm9sbEJ5KDAsIENhcm91c2VsLkFOSU1BVEVEKTtcblx0XHQvLyB9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogdG91Y2ggZXZlbnQ6IHRhcFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRnZXRWaWV3QXRQYW5EaXI6IGZ1bmN0aW9uKGRpcikge1xuXHRcdC8vIHJldHVybiAoZGlyICYgdGhpcy5fcHJlY2VkaW5nRGlyKSA/IHRoaXMuX3ByZWNlZGluZ1ZpZXcgOiB0aGlzLl9mb2xsb3dpbmdWaWV3O1xuXHRcdHJldHVybiAoZGlyICYgdGhpcy5fZm9sbG93aW5nRGlyKSA/IHRoaXMuX3ByZWNlZGluZ1ZpZXcgOiB0aGlzLl9mb2xsb3dpbmdWaWV3O1xuXHR9LFxuXG5cdC8qKiBAdHlwZSB7aW50fSBJbiBwaXhlbHMgKi9cblx0X3RhcEdyb3c6IDEwLFxuXG5cdGdldFZpZXdBdFRhcFBvczogZnVuY3Rpb24ocG9zLCBwb3NBY3Jvc3MpIHtcblx0XHRpZiAodGhpcy5fdGFwQWNyb3NzQmVmb3JlIDwgcG9zQWNyb3NzICYmIHBvc0Fjcm9zcyA8IHRoaXMuX3RhcEFjcm9zc0FmdGVyKSB7XG5cdFx0XHRpZiAocG9zIDwgdGhpcy5fdGFwQmVmb3JlKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9wcmVjZWRpbmdWaWV3O1xuXHRcdFx0fSBlbHNlIGlmIChwb3MgPiB0aGlzLl90YXBBZnRlcikge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZm9sbG93aW5nVmlldztcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHZvaWQgMDtcblx0fSxcblxuXHRfb25UYXA6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dmFyIHRhcmdldFZpZXcgPSBWaWV3LmZpbmRCeURlc2NlbmRhbnQoZXYudGFyZ2V0KTtcblx0XHQvLyBpZiAoIXRoaXMuaXRlbVZpZXdzLmNvbnRhaW5zKHRhcmdldFZpZXcpKSB7XG5cdFx0Ly8gXHRyZXR1cm47XG5cdFx0Ly8gfVxuXHRcdGRvIHtcblx0XHRcdGlmICh0aGlzLl9zZWxlY3RlZFZpZXcgPT09IHRhcmdldFZpZXcpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlcyB0YXAgb2N1cnJlZCBvbiBzZWxlY3RlZDogJW9cIiwgdGhpcy5jaWQsIHRhcmdldFZpZXcpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMgPT09IHRhcmdldFZpZXcpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlcyB0YXAgb2N1cnJlZCBvbiBjYXJvdXNlbDogJW9cIiwgdGhpcy5jaWQsIHRhcmdldFZpZXcpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9IHdoaWxlICgodGFyZ2V0VmlldyA9IHRhcmdldFZpZXcucGFyZW50VmlldykpXG5cblx0XHQvLyB0aGlzLnNlbGVjdEZyb21WaWV3KCk7XG5cblx0XHR2YXIgYm91bmRzID0gdGhpcy5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHR2YXIgdGFwWCA9IGV2LmNlbnRlci54IC0gYm91bmRzLmxlZnQ7XG5cdFx0dmFyIHRhcFkgPSBldi5jZW50ZXIueSAtIGJvdW5kcy50b3A7XG5cdFx0dmFyIHRhcENhbmRpZGF0ZSA9IHRoaXMuZ2V0Vmlld0F0VGFwUG9zKFxuXHRcdFx0dGhpcy5kaXJQcm9wKHRhcFgsIHRhcFkpLFxuXHRcdFx0dGhpcy5kaXJQcm9wKHRhcFksIHRhcFgpXG5cdFx0KTtcblxuXHRcdGlmICh0YXBDYW5kaWRhdGUpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9vblRhcCAlb1wiLCB0aGlzLmNpZCwgZXYpO1xuXHRcdFx0ZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdC8vIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0XHQvLyB0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3ID0gdGFwQ2FuZGlkYXRlO1xuXHRcdFx0Ly8gdGhpcy5fc2V0U2Nyb2xsaW5nKHRydWUpO1xuXHRcdFx0Ly8gdGhpcy5zY3JvbGxCeSgwLCBDYXJvdXNlbC5BTklNQVRFRCk7XG5cdFx0XHQvLyB0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3LmVsLmNsYXNzTGlzdC5hZGQoXCJjYW5kaWRhdGVcIik7XG5cdFx0XHQvLyB0aGlzLnNlbGVjdEZyb21WaWV3KCk7XG5cblx0XHRcdC8vLy8gTk9UIHVzaW5nIGludGVybmFsU2VsZWN0aW9uXG5cdFx0XHQvLyB0aGlzLnRyaWdnZXJTZWxlY3Rpb25FdmVudHModGFwQ2FuZGlkYXRlLCBmYWxzZSk7XG5cblx0XHRcdC8vIHVzaW5nIGludGVybmFsU2VsZWN0aW9uXG5cdFx0XHR0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3ID0gdGFwQ2FuZGlkYXRlO1xuXHRcdFx0dGhpcy5fc2V0U2Nyb2xsaW5nKHRydWUpO1xuXHRcdFx0dGhpcy5zY3JvbGxCeSgwLCBDYXJvdXNlbC5BTklNQVRFRCk7XG5cblx0XHRcdHRoaXMudHJpZ2dlclNlbGVjdGlvbkV2ZW50cyh0YXBDYW5kaWRhdGUsIHRydWUpO1xuXHRcdFx0Ly8gdGhpcy5yZW5kZXJOb3coKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogUHJpdmF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHR0cmlnZ2VyU2VsZWN0aW9uRXZlbnRzOiBmdW5jdGlvbih2aWV3LCBpbnRlcm5hbCkge1xuXHRcdGlmICh2aWV3ID09PSB2b2lkIDAgfHwgdGhpcy5faW50ZXJuYWxTZWxlY3Rpb24pIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLl9pbnRlcm5hbFNlbGVjdGlvbiA9ICEhaW50ZXJuYWw7XG5cdFx0aWYgKHZpZXcgPT09IHRoaXMuZW1wdHlWaWV3KSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpub25lXCIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpvbmVcIiwgdmlldy5tb2RlbCk7XG5cdFx0fVxuXHRcdHRoaXMuX2ludGVybmFsU2VsZWN0aW9uID0gZmFsc2U7XG5cdH0sXG5cblx0c2VsZWN0RnJvbVZpZXc6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3ID09PSB2b2lkIDApIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0dmFyIHZpZXcgPSB0aGlzLl9zY3JvbGxDYW5kaWRhdGVWaWV3O1xuXHRcdHRoaXMuX3Njcm9sbENhbmRpZGF0ZVZpZXcgPSB2b2lkIDA7XG5cdFx0dmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FuZGlkYXRlXCIpO1xuXG5cdFx0dGhpcy50cmlnZ2VyU2VsZWN0aW9uRXZlbnRzKHZpZXcsIHRydWUpO1xuXHR9LFxuXG5cdGFkanVzdFRvU2VsZWN0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgbSwgaSA9IHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZEluZGV4O1xuXHRcdC8vIGFzc3VtZSAtMSA8IGluZGV4IDwgdGhpcy5jb2xsZWN0aW9uLmxlbmd0aFxuXHRcdGlmICh0aGlzLnJlcXVpcmVTZWxlY3Rpb24pIHtcblx0XHRcdChpID09IC0xKSAmJiBpKys7IC8vIGlmIHNlbGVjdGlvbiBpcyBudWxsIChpbmRleCAtMSksIHNldCBfc2VsZWN0ZWRWaWV3IHRvIGZpcnN0IGl0ZW0gKGluZGV4IDApXG5cdFx0XHR0aGlzLl9zZWxlY3RlZFZpZXcgPSAobSA9IHRoaXMuY29sbGVjdGlvbi5hdChpKSkgJiYgdGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwobSk7XG5cdFx0XHR0aGlzLl9wcmVjZWRpbmdWaWV3ID0gKG0gPSB0aGlzLmNvbGxlY3Rpb24uYXQoaSAtIDEpKSAmJiB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChtKTtcblx0XHRcdHRoaXMuX2ZvbGxvd2luZ1ZpZXcgPSAobSA9IHRoaXMuY29sbGVjdGlvbi5hdChpICsgMSkpICYmIHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKG0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9zZWxlY3RlZFZpZXcgPSAobSA9IHRoaXMuY29sbGVjdGlvbi5hdChpKSkgPyB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChtKSA6IHRoaXMuZW1wdHlWaWV3O1xuXHRcdFx0dGhpcy5fcHJlY2VkaW5nVmlldyA9IG0gJiYgKChtID0gdGhpcy5jb2xsZWN0aW9uLmF0KGkgLSAxKSkgPyB0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChtKSA6IHRoaXMuZW1wdHlWaWV3KTtcblx0XHRcdHRoaXMuX2ZvbGxvd2luZ1ZpZXcgPSAobSA9IHRoaXMuY29sbGVjdGlvbi5hdChpICsgMSkpICYmIHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKG0pO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBNb2RlbCBsaXN0ZW5lcnNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBwcml2YXRlICovXG5cdF9vblNlbGVjdE9uZTogZnVuY3Rpb24obW9kZWwpIHtcblx0XHRpZiAobW9kZWwgPT09IHRoaXMuX3NlbGVjdGVkVmlldy5tb2RlbCkge1xuXHRcdFx0Ly8gY29uc29sZS5pbmZvKFwiSU5URVJOQUxcIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHRoaXMuX29uU2VsZWN0QW55KG1vZGVsKTtcblx0fSxcblxuXHQvKiogQHByaXZhdGUgKi9cblx0X29uU2VsZWN0Tm9uZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCh0aGlzLnJlcXVpcmVTZWxlY3Rpb24gPyB0aGlzLml0ZW1WaWV3cy5maXJzdCgpIDogdGhpcy5lbXB0eVZpZXcpID09PSB0aGlzLl9zZWxlY3RlZFZpZXcpIHtcblx0XHRcdC8vIGNvbnNvbGUuaW5mbyhcIklOVEVSTkFMXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLl9vblNlbGVjdEFueSgpO1xuXHR9LFxuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRfb25TZWxlY3RBbnk6IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0dGhpcy5fc2VsZWN0ZWRWaWV3LmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJzZWxlY3RlZFwiKTtcblx0XHR0aGlzLmFkanVzdFRvU2VsZWN0aW9uKCk7XG5cdFx0dGhpcy5fc2VsZWN0ZWRWaWV3LmVsLmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZFwiKTtcblxuXHRcdGlmICghdGhpcy5faW50ZXJuYWxTZWxlY3Rpb24pIHtcblx0XHRcdHRoaXMuX3NldFNjcm9sbGluZyh0cnVlKTtcblx0XHRcdHRoaXMuc2Nyb2xsQnkoMCwgQ2Fyb3VzZWwuQU5JTUFURUQpO1xuXHRcdH1cblx0fSxcblxuXHQvLyBfb25EZXNlbGVjdEFueTogZnVuY3Rpb24gKG1vZGVsKSB7fSxcblxuXHQvKiogQHByaXZhdGUgKi9cblx0X29uUmVzZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHRoaXMuX2NyZWF0ZUNoaWxkcmVuKCk7XG5cdFx0Ly8gdGhpcy5pbnZhbGlkYXRlQ2hpbGRyZW4oKTtcblx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5DSElMRFJFTl9JTlZBTElEIHwgVmlldy5NT0RFTF9JTlZBTElEKTtcblx0fSxcblxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFRFTVBcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gX3Njcm9sbEJ5MjogZnVuY3Rpb24gKGRlbHRhLCBza2lwVHJhbnNpdGlvbnMpIHtcblx0Ly8gXHR2YXIgbWV0cmljcywgcG9zO1xuXHQvLyBcdHZhciBzTWV0cmljcyA9IHRoaXMubWV0cmljc1sodGhpcy5fc2Nyb2xsQ2FuZGlkYXRlVmlldyB8fCB0aGlzLl9zZWxlY3RlZFZpZXcpLmNpZF07XG5cdC8vIFx0dmFyIGNNZXRyaWNzID0gdGhpcy5tZXRyaWNzWyh0aGlzLl9wYW5DYW5kaWRhdGVWaWV3IHx8IHRoaXMuX3NlbGVjdGVkVmlldykuY2lkXTtcblx0Ly9cblx0Ly8gXHR0aGlzLml0ZW1WaWV3cy5lYWNoKGZ1bmN0aW9uICh2aWV3KSB7XG5cdC8vIFx0XHRtZXRyaWNzID0gdGhpcy5tZXRyaWNzW3ZpZXcuY2lkXTtcblx0Ly8gXHRcdHBvcyA9IE1hdGguZmxvb3IodGhpcy5fZ2V0U2Nyb2xsT2Zmc2V0KGRlbHRhLCBtZXRyaWNzLCBzTWV0cmljcywgY01ldHJpY3MpKTtcblx0Ly8gXHRcdHZpZXcuZWwuc3R5bGVbdHJhbnNmb3JtUHJvcGVydHldID0gKHRoaXMuZGlyZWN0aW9uICYgSE9SSVpPTlRBTCk/XG5cdC8vIFx0XHRcdFx0XCJ0cmFuc2xhdGUzZChcIiArIHBvcyArIFwicHgsMCwwKVwiIDogXCJ0cmFuc2xhdGUzZCgwLFwiICsgcG9zICsgXCJweCwwKVwiO1xuXHQvLyBcdFx0XHRcdC8vIFwidHJhbnNsYXRlKFwiICsgcG9zICsgXCJweCwwKVwiIDogXCJ0cmFuc2xhdGUoMCxcIiArIHBvcyArIFwicHgpXCI7XG5cdC8vIFx0XHRcdFx0Ly8gXCJ0cmFuc2xhdGVYKFwiICsgcG9zICsgXCJweClcIiA6IFwidHJhbnNsYXRlWShcIiArIHBvcyArIFwicHgpXCI7XG5cdC8vIFx0fSwgdGhpcyk7XG5cdC8vIFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwic2tpcC10cmFuc2l0aW9uc1wiLCBza2lwVHJhbnNpdGlvbnMpO1xuXHQvLyBcdHRoaXMuc2VsZWN0RnJvbVZpZXcoKTtcblx0Ly8gfSxcblxuXHQvLyBfZ2V0U2Nyb2xsT2Zmc2V0MjogZnVuY3Rpb24gKGRlbHRhLCBtQ3VyciwgbVNlbCwgbUNhbikge1xuXHQvLyBcdHZhciBvZmZzZXQgPSAwO1xuXHQvLyBcdHZhciBwb3NJbm5lciA9IG1DdXJyLnBvc0lubmVyIC0gbVNlbC5wb3NJbm5lciArIGRlbHRhO1xuXHQvL1xuXHQvLyBcdGlmIChwb3NJbm5lciA8IC1tU2VsLmlubmVyKSB7XG5cdC8vIFx0XHRvZmZzZXQgPSAtKG1DdXJyLmJlZm9yZSk7XG5cdC8vIFx0fSBlbHNlIGlmIChwb3NJbm5lciA+IG1TZWwuaW5uZXIpIHtcblx0Ly8gXHRcdG9mZnNldCA9IChtU2VsLmFmdGVyKTtcblx0Ly8gXHR9IGVsc2Uge1xuXHQvLyBcdFx0aWYgKHBvc0lubmVyIDwgMCkge1xuXHQvLyBcdFx0XHRvZmZzZXQgPSAobUN1cnIuYmVmb3JlKSAvIChtQ3Vyci5pbm5lcikgKiBwb3NJbm5lcjtcblx0Ly8gXHRcdH0gZWxzZSB7XG5cdC8vIFx0XHRcdG9mZnNldCA9IChtU2VsLmFmdGVyKSAvIChtQ2FuLmlubmVyKSAqIHBvc0lubmVyO1xuXHQvLyBcdFx0fVxuXHQvLyBcdH1cblx0Ly8gXHRyZXR1cm4gcG9zSW5uZXIgKyBvZmZzZXQ7XG5cdC8vIH0sXG5cblx0Ly8gY2FwdHVyZVNlbGVjdGVkT2Zmc2V0OiBmdW5jdGlvbigpIHtcblx0Ly8gXHR2YXIgdmFsLCB2aWV3LCBjc3N2YWwsIG0sIG1tO1xuXHQvL1xuXHQvLyBcdHZhbCA9IDA7XG5cdC8vIFx0dmlldyA9IHRoaXMuX3Njcm9sbENhbmRpZGF0ZVZpZXcgfHwgdGhpcy5fc2VsZWN0ZWRWaWV3O1xuXHQvLyBcdGNzc3ZhbCA9IGdldENvbXB1dGVkU3R5bGUodmlldy5lbClbdHJhbnNmb3JtUHJvcGVydHldO1xuXHQvL1xuXHQvLyBcdG1tID0gY3NzdmFsLm1hdGNoKC8obWF0cml4fG1hdHJpeDNkKVxcKChbXlxcKV0rKVxcKS8pO1xuXHQvLyBcdGlmIChtbSkge1xuXHQvLyBcdFx0bSA9IG1tWzJdLnNwbGl0KFwiLFwiKTtcblx0Ly8gXHRcdGlmICh0aGlzLmRpcmVjdGlvbiAmIEhPUklaT05UQUwpIHtcblx0Ly8gXHRcdFx0dmFsID0gbVttbVsxXT09XCJtYXRyaXhcIj8gNCA6IDEyXTtcblx0Ly8gXHRcdH0gZWxzZSB7XG5cdC8vIFx0XHRcdHZhbCA9IG1bbW1bMV09PVwibWF0cml4XCI/IDUgOiAxM107XG5cdC8vIFx0XHR9XG5cdC8vIFx0XHR2YWwgPSBwYXJzZUZsb2F0KHZhbCk7XG5cdC8vIFx0fVxuXHQvL1xuXHQvLyBcdGNvbnNvbGUubG9nKFwiJXM6OmNhcHR1cmVTZWxlY3RlZE9mZnNldFwiLCB0aGlzLmNpZCwgY3NzdmFsLCB2YWwsIGNzc3ZhbC5tYXRjaCgvbWF0cml4XFwoKD86XFxkXFwsKXszfShcXGQpXFwsKFxcZCl8bWF0cml4M2RcXCgoPzpcXGRcXCwpezExfShcXGQpXFwsKFxcZCkvKSk7XG5cdC8vXG5cdC8vIFx0cmV0dXJuIHZhbDtcblx0Ly8gfSxcblxuXHQvLyBfb25TY3JvbGxFbmQ6IGZ1bmN0aW9uKGV4ZWMpIHtcblx0Ly8gXHR0aGlzLl9zY3JvbGxFbmRDYW5jZWxsYWJsZSA9IHZvaWQgMDtcblx0Ly8gXHQvLyB0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJkaXNhYmxlZC1jaGFuZ2luZ1wiKTtcblx0Ly8gXHRpZiAoZXhlYykge1xuXHQvLyBcdFx0dGhpcy5fc2V0U2Nyb2xsaW5nKGZhbHNlKTtcblx0Ly8gXHRcdC8vIHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcInNjcm9sbGluZ1wiKTtcblx0Ly8gXHRcdC8vIHRoaXMudHJpZ2dlcihcInZpZXc6c2Nyb2xsZW5kXCIpO1xuXHQvLyBcdFx0Y29uc29sZS5sb2coXCIlczo6X29uU2Nyb2xsRW5kXCIsIHRoaXMuY2lkKTtcblx0Ly8gXHR9XG5cdC8vIH0sXG5cdC8vIF9vbk1vdXNlRG93bjogZnVuY3Rpb24oZXYpIHtcblx0Ly8gXHRpZiAodGhpcy5fc2Nyb2xsaW5nKSB7XG5cdC8vIFx0XHR0aGlzLl9wYW5DYXB0dXJlZE9mZnNldCA9IHRoaXMuY2FwdHVyZVNlbGVjdGVkT2Zmc2V0KCk7XG5cdC8vIFx0XHRjb25zb2xlLmxvZyhcIiVzOjpldmVudHNbbW91c2Vkb3duXSBzY3JvbGxpbmcgaW50ZXJydXB0ZWQgKHBvcyAlZilcIiwgdGhpcy5jaWQsIHRoaXMuX3BhbkNhcHR1cmVkT2Zmc2V0KTtcblx0Ly8gXHR9XG5cdC8vIH0sXG5cdC8vIF9vbk1vdXNlVXA6ZnVuY3Rpb24oZXYpIHtcblx0Ly8gXHR0aGlzLl9wYW5DYXB0dXJlZE9mZnNldCA9IDA7XG5cdC8vIH0sXG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ2Fyb3VzZWwgPSBWaWV3LmV4dGVuZChDYXJvdXNlbFByb3RvLCBDYXJvdXNlbCk7IiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcImNvbXBpbGVyXCI6WzcsXCI+PSA0LjAuMFwiXSxcIm1haW5cIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBoZWxwZXI7XG5cbiAgcmV0dXJuIGNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuaWQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmlkIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGhlbHBlcnMuaGVscGVyTWlzc2luZyksKHR5cGVvZiBoZWxwZXIgPT09IFwiZnVuY3Rpb25cIiA/IGhlbHBlci5jYWxsKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge30se1wibmFtZVwiOlwiaWRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSk7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9jb21wb25lbnQvQ29sbGVjdGlvblN0YWNrXG4gKi9cblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbi8vIHZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbi8vIHZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vLyAvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuLy8gdmFyIHRyYW5zaXRpb25FbmQgPSByZXF1aXJlKFwidXRpbHMvZXZlbnQvdHJhbnNpdGlvbkVuZFwiKTtcbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgc2V0SW1tZWRpYXRlID0gcmVxdWlyZShcInV0aWxzL3NldEltbWVkaWF0ZVwiKTtcblxuLyoqIEB0eXBlIHtzdHJpbmd9ICovXG52YXIgdmlld1RlbXBsYXRlID0gcmVxdWlyZShcIi4vQ29sbGVjdGlvblN0YWNrLmhic1wiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL2NvbXBvbmVudC9Db2xsZWN0aW9uU3RhY2t9XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2lkUHJlZml4OiBcInN0YWNrXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJkaXZcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwic3RhY2tcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0ZW1wbGF0ZTogdmlld1RlbXBsYXRlLFxuXG5cdGV2ZW50czoge1xuXHRcdFwidHJhbnNpdGlvbmVuZFwiOiBmdW5jdGlvbihldikge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6dHJhbnNpdGlvbmVuZCBbaW52YWxpZDogJXNdIFt0cmFuc2l0aW9uOiAlc11cIiwgdGhpcy5jaWQsIHRoaXMuX2NvbnRlbnRJbnZhbGlkLCAodGhpcy5fc2tpcFRyYW5zaXRpb25zPyBcInNraXBcIjogXCJydW5cIiksIGV2LnRhcmdldC5pZCwgZXYudGFyZ2V0LmNsYXNzTmFtZSk7XG5cdFx0XHR0aGlzLl9yZW5kZXJDb250ZW50KCk7XG5cdFx0fVxuXHR9LFxuXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLl9lbmFibGVkID0gdHJ1ZTtcblx0XHR0aGlzLl9za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHRcdHRoaXMuX2NvbnRlbnRJbnZhbGlkID0gdHJ1ZTtcblxuXHRcdG9wdGlvbnMudGVtcGxhdGUgJiYgKHRoaXMudGVtcGxhdGUgPSBvcHRpb25zLnRlbXBsYXRlKTtcblx0XHR0aGlzLmNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdHRoaXMuY29udGVudC5jbGFzc05hbWUgPSBcInN0YWNrLWl0ZW1cIjtcblx0XHR0aGlzLmVsLmFwcGVuZENoaWxkKHRoaXMuY29udGVudCk7XG5cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMuY29sbGVjdGlvbiwgXCJzZWxlY3Q6b25lIHNlbGVjdDpub25lXCIsIHRoaXMuX29uU2VsZWN0Q2hhbmdlKTtcblx0fSxcblxuXHRzZXRFbmFibGVkOiBmdW5jdGlvbihlbmFibGVkKSB7XG5cdFx0aWYgKHRoaXMuX2VuYWJsZWQgIT09IGVuYWJsZWQpIHtcblx0XHRcdHRoaXMuX2VuYWJsZWQgPSBlbmFibGVkO1xuXHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZGlzYWJsZWRcIiwgIXRoaXMuX2VuYWJsZWQpO1xuXHRcdH1cblx0fSxcblxuXHRfb25TZWxlY3RDaGFuZ2U6IGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRpZiAodGhpcy5fcmVuZGVyZWRJdGVtID09PSB0aGlzLmNvbGxlY3Rpb24uc2VsZWN0ZWQpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcImNoYW5nZSBldmVudCByZWNlaXZlZCBidXQgaXRlbSBpcyBpZGVudGljYWxcIik7XG5cdFx0fVxuXHRcdHRoaXMuX3JlbmRlcmVkSXRlbSA9IHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZDtcblxuXHRcdHRoaXMuX2NvbnRlbnRJbnZhbGlkID0gdHJ1ZTtcblx0XHR0aGlzLnJlbmRlcigpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9za2lwVHJhbnNpdGlvbnMpIHtcblx0XHRcdC8vIGV4ZWN1dGUgZXZlbiBpZiBjb250ZW50IGhhcyBub3QgY2hhbmdlZCB0byBhcHBseSBzdHlsZXMgaW1tZWRpYXRlbHlcblx0XHRcdHRoaXMuX3NraXBUcmFuc2l0aW9ucyA9IGZhbHNlO1xuXHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QuYWRkKFwic2tpcC10cmFuc2l0aW9uc1wiKTtcblx0XHRcdHNldEltbWVkaWF0ZShmdW5jdGlvbigpIHtcblx0XHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwic2tpcC10cmFuc2l0aW9uc1wiKTtcblx0XHRcdH0uYmluZCh0aGlzKSk7XG5cblx0XHRcdC8vIHJlbmRlciBjaGFuZ2VkIGNvbnRlbnQgaW1tZWRpYXRlbHlcblx0XHRcdGlmICh0aGlzLl9jb250ZW50SW52YWxpZCkge1xuXHRcdFx0XHR0aGlzLl9yZW5kZXJDb250ZW50KCk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIGVsc2UgcmVtb3ZlICdjdXJyZW50JyBjbGFzcyBhbmQgcmVuZGVyIG9uIHRyYW5zaXRpb25lbmRcblx0XHRcdGlmICh0aGlzLl9jb250ZW50SW52YWxpZCkge1xuXHRcdFx0XHR0aGlzLmNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZShcImN1cnJlbnRcIik7XG5cdFx0XHRcdC8vIHRoaXMuY29udGVudC5jbGFzc05hbWUgPSBcInN0YWNrLWl0ZW1cIjtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0X3JlbmRlckNvbnRlbnQ6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9jb250ZW50SW52YWxpZCkge1xuXHRcdFx0dGhpcy5fY29udGVudEludmFsaWQgPSBmYWxzZTtcblx0XHRcdHZhciBpdGVtID0gdGhpcy5jb2xsZWN0aW9uLnNlbGVjdGVkO1xuXHRcdFx0dGhpcy5jb250ZW50LmlubmVySFRNTCA9IGl0ZW0gPyB0aGlzLnRlbXBsYXRlKGl0ZW0udG9KU09OKCkpIDogXCJcIjtcblx0XHRcdHRoaXMuY29udGVudC5jbGFzc0xpc3QuYWRkKFwiY3VycmVudFwiKTtcblx0XHRcdC8vIHRoaXMuY29udGVudC5jbGFzc05hbWUgPSBcInN0YWNrLWl0ZW0gY3VycmVudFwiO1xuXHRcdH1cblx0fSxcbn0pO1xuIiwiLyoqXG4vKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9GaWx0ZXJhYmxlTGlzdFZpZXdcbi8qL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmUuYmFieXNpdHRlcn0gKi9cbnZhciBDb250YWluZXIgPSByZXF1aXJlKFwiYmFja2JvbmUuYmFieXNpdHRlclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0NsaWNrYWJsZVJlbmRlcmVyfSAqL1xudmFyIENsaWNrYWJsZVJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9DbGlja2FibGVSZW5kZXJlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkUHJvcGVydHl9ICovXG52YXIgcHJlZml4ZWRQcm9wZXJ0eSA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFByb3BlcnR5XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXN9ICovXG52YXIgZ2V0Qm94RWRnZVN0eWxlcyA9IHJlcXVpcmUoXCJ1dGlscy9jc3MvZ2V0Qm94RWRnZVN0eWxlc1wiKTtcblxudmFyIGRpZmYgPSBmdW5jdGlvbihhMSwgYTIsIGRlc3QpIHtcblx0cmV0dXJuIGExLnJlZHVjZShmdW5jdGlvbihyZXMsIG8sIGksIGEpIHtcblx0XHRpZiAoYTIuaW5kZXhPZihvKSA9PSAtMSkgcmVzLnB1c2gobyk7XG5cdFx0cmV0dXJuIHJlcztcblx0fSwgZGVzdCB8fCBbXSk7XG59O1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzLlRSQU5TTEFURV9URU1QTEFURX0gKi9cbnZhciB0cmFuc2xhdGVDc3NWYWx1ZSA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpLlRSQU5TTEFURV9URU1QTEFURTtcblxuLyoqIEBjb25zdCAqL1xudmFyIHRyYW5zZm9ybVByb3AgPSBwcmVmaXhlZFByb3BlcnR5KFwidHJhbnNmb3JtXCIpO1xuXG4vKipcbi8qIEBjb25zdHJ1Y3RvclxuLyogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvRmlsdGVyYWJsZUxpc3RWaWV3fVxuLyovXG52YXIgRmlsdGVyYWJsZUxpc3RWaWV3ID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwiZmlsdGVyYWJsZUxpc3RcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0YWdOYW1lOiBcInVsXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImxpc3Qgc2VsZWN0YWJsZSBmaWx0ZXJhYmxlXCIsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRkZWZhdWx0czoge1xuXHRcdGNvbGxhcHNlZDogdHJ1ZSxcblx0XHRmaWx0ZXJGbjogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9LFxuXHRcdHJlbmRlcmVyOiBDbGlja2FibGVSZW5kZXJlci5leHRlbmQoe1xuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0Y2lkUHJlZml4OiBcImxpc3RJdGVtXCIsXG5cdFx0fSksXG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0Y29sbGFwc2VkOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY29sbGFwc2VkO1xuXHRcdFx0fSxcblx0XHRcdHNldDogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRcdFx0dGhpcy5fc2V0Q29sbGFwc2VkKHZhbHVlKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHNlbGVjdGVkSXRlbToge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3NlbGVjdGVkSXRlbTtcblx0XHRcdH0sXG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHRoaXMuX3NldFNlbGVjdGlvbih2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRmaWx0ZXJlZEl0ZW1zOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZmlsdGVyZWRJdGVtcztcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRldmVudHM6IHtcblx0XHRcInRyYW5zaXRpb25lbmQgLmxpc3QtaXRlbVwiOiBmdW5jdGlvbihldikge1xuXHRcdFx0aWYgKHRoaXMuX2NvbGxhcHNlZFRyYW5zaXRpb25pbmcgJiYgZXYucHJvcGVydHlOYW1lID09PSBcInZpc2liaWxpdHlcIiAvKiYmIHRoaXMuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY29sbGFwc2VkLWNoYW5nZWRcIikqLyApIHtcblx0XHRcdFx0dGhpcy5fY29sbGFwc2VkVHJhbnNpdGlvbmluZyA9IGZhbHNlO1xuXHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb2xsYXBzZWQtY2hhbmdlZFwiKTtcblx0XHRcdFx0Y29uc29sZS5sb2coXCIlczo6ZXZlbnRzW3RyYW5zaXRpb25lbmQgLmxpc3QtaXRlbV0gY29sbGFwc2VkLWNoYW5nZWQgZW5kXCIsIHRoaXMuY2lkKTtcblx0XHRcdH1cblx0XHR9LFxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHRoaXMuX21ldHJpY3MgPSB7fTtcblx0XHR0aGlzLl9pdGVtTWV0cmljcyA9IFtdO1xuXHRcdHRoaXMuaXRlbVZpZXdzID0gbmV3IENvbnRhaW5lcigpO1xuXG5cdFx0Xy5kZWZhdWx0cyhvcHRpb25zLCB0aGlzLmRlZmF1bHRzKTtcblx0XHR0aGlzLnJlbmRlcmVyID0gb3B0aW9ucy5yZW5kZXJlcjtcblx0XHR0aGlzLl9maWx0ZXJGbiA9IG9wdGlvbnMuZmlsdGVyRm47XG5cdFx0dGhpcy5fZmlsdGVyZWRJdGVtcyA9IFtdO1xuXG5cdFx0dGhpcy5jb2xsZWN0aW9uLmVhY2godGhpcy5jcmVhdGVJdGVtVmlldywgdGhpcyk7XG5cdFx0dGhpcy5yZWZyZXNoKCk7XG5cdFx0dGhpcy5fc2V0U2VsZWN0aW9uKHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZCk7XG5cdFx0dGhpcy5fc2V0Q29sbGFwc2VkKG9wdGlvbnMuY29sbGFwc2VkKTtcblxuXHRcdC8vIHdpbGwgdHJpZ2dlciBvbiByZXR1cm4gaWYgdGhpcy5lbCBpcyBhbHJlYWR5IGF0dGFjaGVkXG5cdFx0Ly8gdGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OmF0dGFjaGVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5za2lwVHJhbnNpdGlvbnMgPSB0cnVlO1xuXHRcdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuU0laRV9JTlZBTElEIHwgVmlldy5MQVlPVVRfSU5WQUxJRCk7IC8vLnJlbmRlck5vdygpO1xuXHRcdH0pO1xuXG5cdFx0Ly8gdGhpcy5saXN0ZW5Ubyh0aGlzLmNvbGxlY3Rpb24sIFwic2VsZWN0Om9uZSBzZWxlY3Q6bm9uZVwiLCB0aGlzLl9zZXRTZWxlY3Rpb24pO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCBcInJlc2V0XCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5fYWxsSXRlbXMgPSBudWxsO1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwibm90IGltcGxlbWVudGVkXCIpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIFJlbmRlclxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlckZyYW1lOiBmdW5jdGlvbih0c3RhbXAsIGZsYWdzKSB7XG5cdFx0aWYgKERFQlVHKSB7XG5cdFx0XHR2YXIgY2hhbmdlZCA9IFtdO1xuXHRcdFx0dGhpcy5fY29sbGFwc2VkQ2hhbmdlZCAmJiBjaGFuZ2VkLnB1c2goXCJjb2xsYXBzZWRcIik7XG5cdFx0XHR0aGlzLl9zZWxlY3Rpb25DaGFuZ2VkICYmIGNoYW5nZWQucHVzaChcInNlbGVjdGlvblwiKTtcblx0XHRcdHRoaXMuX2ZpbHRlckNoYW5nZWQgJiYgY2hhbmdlZC5wdXNoKFwiZmlsdGVyXCIpO1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczo6cmVuZGVyRnJhbWUgWyVzXVwiLCB0aGlzLmNpZCwgY2hhbmdlZC5qb2luKFwiIFwiKSk7XG5cdFx0fVxuXG5cdFx0Ly8gY29sbGFwc2VkIHRyYW5zaXRpb24gZmxhZ1xuXHRcdGlmICh0aGlzLl9jb2xsYXBzZWRUcmFuc2l0aW9uaW5nKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCIlczo6cmVuZGVyRnJhbWUgY29sbGFwc2VkIHR4IGludGVycnVwdGVkXCIsIHRoaXMuY2lkKTtcblx0XHR9XG5cblx0XHR0aGlzLl9jb2xsYXBzZWRUcmFuc2l0aW9uaW5nID0gIXRoaXMuc2tpcFRyYW5zaXRpb25zICYmIHRoaXMuX2NvbGxhcHNlZENoYW5nZWQ7XG5cblx0XHQvLyB0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJhbmltYXRlXCIsICF0aGlzLnNraXBUcmFuc2l0aW9ucyk7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY29sbGFwc2VkLWNoYW5nZWRcIiwgdGhpcy5fY29sbGFwc2VkVHJhbnNpdGlvbmluZyk7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwic2tpcC10cmFuc2l0aW9uc1wiLCB0aGlzLnNraXBUcmFuc2l0aW9ucyk7XG5cdFx0aWYgKHRoaXMuc2tpcFRyYW5zaXRpb25zKSB7XG5cdFx0XHR0aGlzLnNraXBUcmFuc2l0aW9ucyA9IGZhbHNlO1xuXHRcdFx0Ly8gSW52YWxpZGF0ZSBhZ2FpbiBhZnRlciBmcmFtZSByZW5kZXIgbG9vcCB0byByZWFwcGx5IHRyYW5zZm9ybXM6XG5cdFx0XHQvLyB0aGF0IHNob3VsZCBraWxsIGFueSBydW5uaW5nIHRyYW5zaXRpb25zLlxuXHRcdFx0dGhpcy5zZXRJbW1lZGlhdGUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcihWaWV3LkxBWU9VVF9JTlZBTElEKTtcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fY29sbGFwc2VkQ2hhbmdlZCkge1xuXHRcdFx0ZmxhZ3MgfD0gKFZpZXcuU0laRV9JTlZBTElEKTtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImNvbGxhcHNlZFwiLCB0aGlzLl9jb2xsYXBzZWQpO1xuXHRcdH1cblx0XHRpZiAodGhpcy5fc2VsZWN0aW9uQ2hhbmdlZCkge1xuXHRcdFx0ZmxhZ3MgfD0gVmlldy5MQVlPVVRfSU5WQUxJRDtcblx0XHRcdHRoaXMucmVuZGVyU2VsZWN0aW9uKHRoaXMuY29sbGVjdGlvbi5zZWxlY3RlZCwgdGhpcy5jb2xsZWN0aW9uLmxhc3RTZWxlY3RlZCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLl9maWx0ZXJDaGFuZ2VkKSB7XG5cdFx0XHRmbGFncyB8PSBWaWV3LkxBWU9VVF9JTlZBTElEO1xuXHRcdFx0dGhpcy5yZW5kZXJGaWx0ZXJGbigpO1xuXHRcdH1cblx0XHRpZiAoZmxhZ3MgJiBWaWV3LlNJWkVfSU5WQUxJRCkge1xuXHRcdFx0dGhpcy5tZWFzdXJlKCk7XG5cdFx0fVxuXHRcdGlmIChmbGFncyAmIChWaWV3LkxBWU9VVF9JTlZBTElEIHwgVmlldy5TSVpFX0lOVkFMSUQpKSB7XG5cdFx0XHR0aGlzLnJlbmRlckxheW91dCgpO1xuXHRcdH1cblx0XHR0aGlzLl9jb2xsYXBzZWRDaGFuZ2VkID0gdGhpcy5fc2VsZWN0aW9uQ2hhbmdlZCA9IHRoaXMuX2ZpbHRlckNoYW5nZWQgPSBmYWxzZTtcblx0fSxcblxuXHRtZWFzdXJlOiBmdW5jdGlvbigpIHtcblx0XHQvLyB2YXIgaSwgaWksIGVsLCBlbHMsIG0sIG1tO1xuXHRcdC8vIGVscyA9IHRoaXMuZWwuY2hpbGRyZW47XG5cdFx0Ly8gaWkgPSBlbHMubGVuZ3RoO1xuXHRcdC8vIG1tID0gdGhpcy5faXRlbU1ldHJpY3M7XG5cdFx0Ly8gZm9yIChpID0gMDsgaSA8IGlpOyBpKyspIHtcblx0XHQvLyBcdG1tW2ldID0gXy5waWNrKGVsc1tpXSwgXCJvZmZzZXRUb3BcIiwgXCJvZmZzZXRIZWlnaHRcIik7XG5cdFx0Ly8gfVxuXG5cdFx0dGhpcy5fbWV0cmljcyA9IGdldEJveEVkZ2VTdHlsZXModGhpcy5lbCwgdGhpcy5fbWV0cmljcyk7XG5cblx0XHQvLyB2YXIgaXRlbUVsLCBpdGVtVmlldywgYmFzZWxpbmUgPSAwO1xuXHRcdC8vIGlmIChpdGVtRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIubGlzdC1pdGVtOm5vdCguZXhjbHVkZWQpIC5sYWJlbFwiKSkge1xuXHRcdC8vIFx0Ly8gaXRlbVZpZXcgPSB0aGlzLml0ZW1WaWV3cy5maW5kQnlDaWQoaXRlbUVsLmNpZCk7XG5cdFx0Ly8gXHR2YXIgZWxBID0gaXRlbUVsLCBlbEIgPSBpdGVtRWwucGFyZW50RWxlbWVudDtcblx0XHQvLyBcdHZhciB5QSA9IGVsQS5vZmZzZXRUb3AsXG5cdFx0Ly8gXHRcdGhBID0gZWxBLm9mZnNldEhlaWdodCxcblx0XHQvLyBcdFx0eUIgPSBlbEIub2Zmc2V0VG9wLFxuXHRcdC8vIFx0XHRoQiA9IGVsQi5vZmZzZXRIZWlnaHQ7XG5cdFx0Ly8gXHRiYXNlbGluZSA9ICgoeUEgKyBoQSkgLSAoeUIgKyBoQikpO1xuXHRcdC8vIFx0Y29uc29sZS5sb2coXCIlczo6bWVhc3VyZSBmb250U2l6ZTogJXNweCAoJXMrJXMpLSglcyslcyk9JXNcIiwgdGhpcy5jaWQsIHRoaXMuX21ldHJpY3MuZm9udFNpemUsXG5cdFx0Ly8gXHRcdHlBLCBoQSwgeUIsIGhCLCBiYXNlbGluZVxuXHRcdC8vIFx0KTtcblx0XHQvLyB9XG5cblx0XHR0aGlzLml0ZW1WaWV3cy5mb3JFYWNoKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdGlmICghdmlldy5fbWV0cmljcykgdmlldy5fbWV0cmljcyA9IHt9O1xuXHRcdFx0Ly8gdmlldy5fbWV0cmljcy5iYXNlbGluZSA9IHRoaXMuX21ldHJpY3MuZm9udFNpemUgLSBiYXNlbGluZTtcblx0XHRcdHZpZXcuX21ldHJpY3Mub2Zmc2V0VG9wID0gdmlldy5lbC5vZmZzZXRUb3A7XG5cdFx0XHR2aWV3Ll9tZXRyaWNzLm9mZnNldEhlaWdodCA9IHZpZXcuZWwub2Zmc2V0SGVpZ2h0O1xuXHRcdFx0dmlldy5fbWV0cmljcy5vZmZzZXRMZWZ0ID0gdmlldy5lbC5vZmZzZXRMZWZ0O1xuXHRcdFx0dmlldy5fbWV0cmljcy5vZmZzZXRXaWR0aCA9IHZpZXcuZWwub2Zmc2V0V2lkdGg7XG5cdFx0XHRpZiAoIXRoaXMuX2NvbGxhcHNlZCAmJiB2aWV3LmxhYmVsKSB7XG5cdFx0XHRcdHZpZXcuX21ldHJpY3MudGV4dExlZnQgPSB2aWV3LmxhYmVsLm9mZnNldExlZnQ7XG5cdFx0XHRcdHZpZXcuX21ldHJpY3MudGV4dFdpZHRoID0gdmlldy5sYWJlbC5vZmZzZXRXaWR0aDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHZpZXcuX21ldHJpY3MudGV4dExlZnQgPSB2aWV3Ll9tZXRyaWNzLm9mZnNldExlZnQ7XG5cdFx0XHRcdHZpZXcuX21ldHJpY3MudGV4dFdpZHRoID0gdmlldy5fbWV0cmljcy5vZmZzZXRXaWR0aDtcblx0XHRcdH1cblx0XHR9LCB0aGlzKTtcblxuXHRcdC8vIHRoaXMuX21ldHJpY3MuYmFzZWxpbmUgPSB0aGlzLl9tZXRyaWNzLmZvbnRTaXplIC0gYmFzZWxpbmU7XG5cdH0sXG5cblx0cmVuZGVyTGF5b3V0OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgcG9zWCwgcG9zWTtcblx0XHRwb3NYID0gdGhpcy5fbWV0cmljcy5wYWRkaW5nTGVmdDtcblx0XHRwb3NZID0gdGhpcy5fbWV0cmljcy5wYWRkaW5nVG9wO1xuXG5cdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5lbC5jaGlsZHJlbi5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHR2YXIgdmlldyA9IHRoaXMuaXRlbVZpZXdzLmZpbmRCeUNpZCh0aGlzLmVsLmNoaWxkcmVuW2ldLmNpZCk7XG5cdFx0XHRpZiAoKCh0aGlzLmNvbGxlY3Rpb24uc2VsZWN0ZWQgJiYgIXZpZXcubW9kZWwuc2VsZWN0ZWQpIHx8XG5cdFx0XHRcdFx0dmlldy5lbC5jbGFzc0xpc3QuY29udGFpbnMoXCJleGNsdWRlZFwiKSkgJiYgdGhpcy5fY29sbGFwc2VkKSB7XG5cdFx0XHRcdHZpZXcudHJhbnNmb3JtLnR4ID0gcG9zWDtcblx0XHRcdFx0dmlldy50cmFuc2Zvcm0udHkgPSBwb3NZO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKHZpZXcuX21ldHJpY3Mub2Zmc2V0SGVpZ2h0ID09IDApXG5cdFx0XHRcdFx0cG9zWSAtPSB2aWV3Ll9tZXRyaWNzLm9mZnNldFRvcDtcblx0XHRcdFx0dmlldy50cmFuc2Zvcm0udHggPSBwb3NYO1xuXHRcdFx0XHR2aWV3LnRyYW5zZm9ybS50eSA9IHBvc1k7XG5cdFx0XHRcdHBvc1kgKz0gdmlldy5fbWV0cmljcy5vZmZzZXRIZWlnaHQgKyB2aWV3Ll9tZXRyaWNzLm9mZnNldFRvcDtcblx0XHRcdH1cblx0XHRcdHZpZXcuZWwuc3R5bGVbdHJhbnNmb3JtUHJvcF0gPSB0cmFuc2xhdGVDc3NWYWx1ZSh2aWV3LnRyYW5zZm9ybS50eCwgdmlldy50cmFuc2Zvcm0udHkpO1xuXHRcdH1cblxuXHRcdC8vIHBvc1kgKz0gdGhpcy5fbWV0cmljcy5wYWRkaW5nQm90dG9tO1xuXHRcdHRoaXMuX21ldHJpY3MuaGVpZ2h0ID0gTWF0aC5tYXgoMCwgcG9zWSArIHRoaXMuX21ldHJpY3MucGFkZGluZ0JvdHRvbSk7XG5cdFx0dGhpcy5lbC5zdHlsZS5oZWlnaHQgPSB0aGlzLl9tZXRyaWNzLmhlaWdodCArIFwicHhcIjtcblx0XHQvLyB0aGlzLmVsLnN0eWxlLmhlaWdodCA9IChwb3NZID4gMCkgPyBwb3NZICsgXCJweFwiIDogXCJcIjtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBDaGlsZCB2aWV3c1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQHByaXZhdGUgKi9cblx0Y3JlYXRlSXRlbVZpZXc6IGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG5cdFx0dmFyIHZpZXcgPSBuZXcgdGhpcy5yZW5kZXJlcih7XG5cdFx0XHRtb2RlbDogaXRlbSxcblx0XHRcdGVsOiB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIubGlzdC1pdGVtW2RhdGEtaWQ9XFxcIlwiICsgaXRlbS5pZCArIFwiXFxcIl1cIilcblx0XHR9KTtcblx0XHRpdGVtLnNldChcImV4Y2x1ZGVkXCIsIGZhbHNlLCB7IHNpbGVudDogdHJ1ZSB9KTtcblx0XHR0aGlzLmxpc3RlblRvKHZpZXcsIFwicmVuZGVyZXI6Y2xpY2tcIiwgdGhpcy5fb25SZW5kZXJlckNsaWNrKTtcblx0XHR2aWV3Lmxpc3RlblRvKGl0ZW0sIFwiY2hhbmdlOmV4Y2x1ZGVkXCIsIGZ1bmN0aW9uKGl0ZW0sIG5ld1ZhbCkge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coYXJndW1lbnRzKTtcblx0XHRcdGlmICh0aGlzLmVsLmNsYXNzTGlzdC5jb250YWlucyhcImV4Y2x1ZGVkXCIpICE9PSBuZXdWYWwpIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiJXM6W2NoYW5nZTpleGNsdWRlZF0gbTolbyBjc3M6ICVvXCIsIHRoaXMuY2lkLCBuZXdWYWwsIHRoaXMuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZXhjbHVkZWRcIikpO1xuXHRcdFx0fVxuXHRcdFx0Ly8gdGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZXhjbHVkZWRcIiwgZXhjbHVkZWQpO1xuXHRcdH0pO1xuXHRcdHRoaXMuaXRlbVZpZXdzLmFkZCh2aWV3KTtcblx0XHRyZXR1cm4gdmlldztcblx0fSxcblxuXHQvKiogQHByaXZhdGUgKi9cblx0X29uUmVuZGVyZXJDbGljazogZnVuY3Rpb24oaXRlbSwgZXYpIHtcblx0XHRpZiAodGhpcy5fY29sbGFwc2VkVHJhbnNpdGlvbmluZ1xuXHRcdFx0fHwgKHRoaXMuX2NvbGxhcHNlZCAmJiBpdGVtLmdldChcImV4Y2x1ZGVkXCIpKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAodGhpcy5jb2xsZWN0aW9uLnNlbGVjdGVkICE9PSBpdGVtKSB7XG5cdFx0XHR0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpvbmVcIiwgaXRlbSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGlmIChldi5hbHRLZXkpIHtcblx0XHRcdFx0dGhpcy50cmlnZ2VyKFwidmlldzpzZWxlY3Q6bm9uZVwiKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6c2VsZWN0OnNhbWVcIiwgaXRlbSk7XG5cdFx0XHR9XG5cdFx0XHQvLyB0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpub25lXCIpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBDb2xsYXBzZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBwcml2YXRlICovXG5cdF9jb2xsYXBzZWQ6IHVuZGVmaW5lZCxcblxuXHQvKipcblx0LyogQHBhcmFtIHtCb29sZWFufVxuXHQvKi9cblx0X3NldENvbGxhcHNlZDogZnVuY3Rpb24oY29sbGFwc2VkKSB7XG5cdFx0aWYgKGNvbGxhcHNlZCAhPT0gdGhpcy5fY29sbGFwc2VkKSB7XG5cdFx0XHR0aGlzLl9jb2xsYXBzZWQgPSBjb2xsYXBzZWQ7XG5cdFx0XHR0aGlzLl9jb2xsYXBzZWRDaGFuZ2VkID0gdHJ1ZTtcblx0XHRcdHRoaXMucmVxdWVzdFJlbmRlcigpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBTZWxlY3Rpb25cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBwcml2YXRlICovXG5cdF9zZWxlY3RlZEl0ZW06IHVuZGVmaW5lZCxcblxuXHQvKiogQHBhcmFtIHtCYWNrYm9uZS5Nb2RlbHxudWxsfSAqL1xuXHRfc2V0U2VsZWN0aW9uOiBmdW5jdGlvbihpdGVtKSB7XG5cdFx0aWYgKGl0ZW0gIT09IHRoaXMuX3NlbGVjdGVkSXRlbSkge1xuXHRcdFx0dGhpcy5fc2VsZWN0ZWRJdGVtID0gaXRlbTtcblx0XHRcdHRoaXMuX3NlbGVjdGlvbkNoYW5nZWQgPSB0cnVlO1xuXHRcdFx0dGhpcy5yZXF1ZXN0UmVuZGVyKFZpZXcuTU9ERUxfSU5WQUxJRCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRyZW5kZXJTZWxlY3Rpb246IGZ1bmN0aW9uKG5ld0l0ZW0sIG9sZEl0ZW0pIHtcblx0XHR2YXIgdmlldztcblx0XHRpZiAob2xkSXRlbSkge1xuXHRcdFx0dmlldyA9IHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKG9sZEl0ZW0pO1xuXHRcdFx0dmlldy5lbC5jbGFzc0xpc3QucmVtb3ZlKFwic2VsZWN0ZWRcIik7XG5cdFx0XHQvLyB2aWV3LmxhYmVsLmNsYXNzTGlzdC5yZW1vdmUoXCJjb2xvci1mZ1wiKTtcblx0XHRcdC8vIHZpZXcubGFiZWwuY2xhc3NMaXN0LnJlbW92ZShcImNvbG9yLXJldmVyc2VcIik7XG5cdFx0fVxuXHRcdGlmIChuZXdJdGVtKSB7XG5cdFx0XHR2aWV3ID0gdGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwobmV3SXRlbSk7XG5cdFx0XHR2aWV3LmVsLmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZFwiKTtcblx0XHRcdC8vIHZpZXcubGFiZWwuY2xhc3NMaXN0LmFkZChcImNvbG9yLWZnXCIpO1xuXHRcdFx0Ly8gdmlldy5sYWJlbC5jbGFzc0xpc3QuYWRkKFwiY29sb3ItcmV2ZXJzZVwiKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogRmlsdGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHJlZnJlc2g6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9maWx0ZXJGbikge1xuXHRcdFx0dGhpcy5fZmlsdGVyQ2hhbmdlZCA9IHRydWU7XG5cdFx0XHR0aGlzLnJlcXVlc3RSZW5kZXIoVmlldy5NT0RFTF9JTlZBTElEKTtcblx0XHR9XG5cdH0sXG5cblx0cmVuZGVyRmlsdGVyRm46IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBpdGVtcyA9IHRoaXMuX2ZpbHRlckZuID8gdGhpcy5jb2xsZWN0aW9uLmZpbHRlcih0aGlzLl9maWx0ZXJGbiwgdGhpcykgOiB0aGlzLl9nZXRBbGxJdGVtcygpO1xuXHRcdHRoaXMucmVuZGVyRmlsdGVycyhpdGVtcywgdGhpcy5fZmlsdGVyZWRJdGVtcyk7XG5cdFx0dGhpcy5fZmlsdGVyZWRJdGVtcyA9IGl0ZW1zO1xuXHR9LFxuXG5cdHJlbmRlckZpbHRlcnM6IGZ1bmN0aW9uKG5ld0l0ZW1zLCBvbGRJdGVtcykge1xuXHRcdHZhciBoYXNOZXcgPSAhIShuZXdJdGVtcyAmJiBuZXdJdGVtcy5sZW5ndGgpO1xuXHRcdHZhciBoYXNPbGQgPSAhIShvbGRJdGVtcyAmJiBvbGRJdGVtcy5sZW5ndGgpO1xuXG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6cmVuZGVyRmlsdGVyRm5cIiwgdGhpcy5jaWQsIG5ld0l0ZW1zKTtcblxuXHRcdGlmIChoYXNOZXcpIHtcblx0XHRcdGRpZmYoKGhhc09sZCA/IG9sZEl0ZW1zIDogdGhpcy5fZ2V0QWxsSXRlbXMoKSksIG5ld0l0ZW1zKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0dGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoaXRlbSkuZWwuY2xhc3NMaXN0LmFkZChcImV4Y2x1ZGVkXCIpO1xuXHRcdFx0XHRpdGVtLnNldChcImV4Y2x1ZGVkXCIsIHRydWUpO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0fVxuXHRcdGlmIChoYXNPbGQpIHtcblx0XHRcdGRpZmYoKGhhc05ldyA/IG5ld0l0ZW1zIDogdGhpcy5fZ2V0QWxsSXRlbXMoKSksIG9sZEl0ZW1zKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0dGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoaXRlbSkuZWwuY2xhc3NMaXN0LnJlbW92ZShcImV4Y2x1ZGVkXCIpO1xuXHRcdFx0XHRpdGVtLnNldChcImV4Y2x1ZGVkXCIsIGZhbHNlKTtcblx0XHRcdH0sIHRoaXMpO1xuXHRcdH1cblx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJoYXMtZXhjbHVkZWRcIiwgaGFzTmV3KTtcblx0fSxcblxuXHRfZ2V0QWxsSXRlbXM6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLl9hbGxJdGVtcyB8fCAodGhpcy5fYWxsSXRlbXMgPSB0aGlzLmNvbGxlY3Rpb24uc2xpY2UoKSk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogRmlsdGVyIDJcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gY29tcHV0ZUZpbHRlcmVkOiBmdW5jdGlvbigpIHtcblx0Ly8gXHR0aGlzLl9maWx0ZXJSZXN1bHQgPSB0aGlzLmNvbGxlY3Rpb24ubWFwKHRoaXMuX2ZpbHRlckZuLCB0aGlzKTtcblx0Ly8gfSxcblx0Ly9cblx0Ly8gcmVuZGVyRmlsdGVyZWQ6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdHRoaXMuY29sbGVjdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGluZGV4KSB7XG5cdC8vIFx0XHR0aGlzLml0ZW1WaWV3cy5maW5kQnlNb2RlbChpdGVtKS5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZXhjbHVkZWRcIiwgIXRoaXMuX2ZpbHRlclJlc3VsdFtpbmRleF0pO1xuXHQvLyBcdH0sIHRoaXMpO1xuXHQvLyB9LFxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBGaWx0ZXJhYmxlTGlzdFZpZXc7IiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L2NvbXBvbmVudC9HcmFwaFZpZXdcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBDb2xvciA9IHJlcXVpcmUoXCJjb2xvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3fSAqL1xudmFyIENhbnZhc1ZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9DYW52YXNWaWV3XCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY2FudmFzL2NhbGNBcmNIQ29ubmVjdG9yfSAqL1xudmFyIGNhbGNBcmNIQ29ubmVjdG9yID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9jYWxjQXJjSENvbm5lY3RvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvY2FudmFzL0NhbnZhc0hlbHBlcn0gKi9cbnZhciBDYW52YXNIZWxwZXIgPSByZXF1aXJlKFwidXRpbHMvY2FudmFzL0NhbnZhc0hlbHBlclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvZ2VvbS9pbmZsYXRlUmVjdH0gKi9cbnZhciBpbmZsYXRlUmVjdCA9IHJlcXVpcmUoXCJ1dGlscy9nZW9tL2luZmxhdGVSZWN0XCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9kb20vZ2V0QWJzb2x1dGVDbGllbnRSZWN0fSAqL1xudmFyIGdldEFic29sdXRlQ2xpZW50UmVjdCA9IHJlcXVpcmUoXCJ1dGlscy9kb20vZ2V0QWJzb2x1dGVDbGllbnRSZWN0XCIpO1xuXG5cbi8vIHZhciBCRVpJRVJfQ0lSQ0xFID0gMC41NTE5MTUwMjQ0OTQ7XG4vLyB2YXIgTUlOX0NBTlZBU19SQVRJTyA9IDI7XG4vLyB2YXIgUEkyID0gTWF0aC5QSSAqIDI7XG5cbnZhciBzdHlsZUJhc2UgPSB7XG5cdGxpbmVDYXA6IFwiYnV0dFwiLCAvLyByb3VuZCwgYnV0dCwgc3F1YXJlXG5cdGxpbmVXaWR0aDogMC43NSxcblx0bGluZURhc2hPZmZzZXQ6IDAsXG5cdHNldExpbmVEYXNoOiBbW11dLFxuXHRyYWRpdXNCYXNlOiAwLjc1LFxuXHQvKiBmYWN0b3JlZCB0byByZW0gdW5pdCAqLyAvLzYsXG5cdHJhZGl1c0luY3JlbWVudDogMC4yMSwgLy8zLCAvLzAuMjUsXG5cdC8qIHVzZXMgbGluZVdpZHRoIG11bHRpcGxpZXIgKi9cblx0b3V0bGluZVdpZHRoOiAxLjUsXG5cdGFycm93U2l6ZTogMC4zXG59O1xuXG5pZiAoREVCVUcpIHtcblx0LyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMgKi9cblx0dmFyIF9kU3R5bGVzID0ge307XG5cdF9kU3R5bGVzW1wiZGVmYXVsdHNcIl0gPSB7XG5cdFx0bGluZVdpZHRoOiAwLFxuXHRcdGZpbGxTdHlsZTogXCJ0cmFuc3BhcmVudFwiLFxuXHRcdHN0cm9rZVN0eWxlOiBcInRyYW5zcGFyZW50XCIsXG5cdFx0bGluZURhc2hPZmZzZXQ6IDAsXG5cdFx0c2V0TGluZURhc2g6IFtbXV1cblx0fTtcblxuXHQvKiBTdHJva2UgKi9cblx0W1xuXHRcdFwicmVkXCIsIFwic2FsbW9uXCIsIFwic2llbm5hXCIsXG5cdFx0XCJncmVlblwiLCBcInllbGxvd2dyZWVuXCIsIFwib2xpdmVcIixcblx0XHRcImJsdWVcIiwgXCJsaWdodHNreWJsdWVcIiwgXCJtaWRuaWdodGJsdWVcIixcblx0XHRcImdyZXlcIiwgXCJzaWx2ZXJcIlxuXHRdXG5cdC5mb3JFYWNoKGZ1bmN0aW9uKGNvbG9yTmFtZSkge1xuXHRcdHZhciByZ2JhVmFsdWUgPSBDb2xvcihjb2xvck5hbWUpLmFscGhhKDAuNzUpLnJnYmFTdHJpbmcoKTtcblxuXHRcdF9kU3R5bGVzW2NvbG9yTmFtZV0gPSBfLmRlZmF1bHRzKHtcblx0XHRcdGxpbmVXaWR0aDogMC43NSxcblx0XHRcdHN0cm9rZVN0eWxlOiByZ2JhVmFsdWVcblx0XHR9LCBfZFN0eWxlc1tcImRlZmF1bHRzXCJdKTtcblxuXHRcdF9kU3R5bGVzW2NvbG9yTmFtZSArIFwiX2ZpbGxcIl0gPSBfLmRlZmF1bHRzKHtcblx0XHRcdGZpbGxTdHlsZTogcmdiYVZhbHVlXG5cdFx0fSwgX2RTdHlsZXNbXCJkZWZhdWx0c1wiXSk7XG5cdH0pXG5cdC8qIGVzbGludC1lbmFibGUgbm8tdW51c2VkLXZhcnMgKi9cbn1cblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0dyYXBoVmlld31cbiAqL1xudmFyIEdyYXBoVmlldyA9IENhbnZhc1ZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcImdyYXBoXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJjYW52YXNcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjbGFzc05hbWU6IFwiZ3JhcGhcIixcblx0Ly8gLyoqIEBvdmVycmlkZSAqL1xuXHQvLyBtb2RlbDogQmFja2JvbmUuTW9kZWwsXG5cblx0ZGVmYXVsdEtleTogXCJhbW91bnRcIixcblxuXHRkZWZhdWx0czoge1xuXHRcdHZhbHVlczoge1xuXHRcdFx0YW1vdW50OiAwLFxuXHRcdFx0Ly8gYXZhaWxhYmxlOiAwLFxuXHRcdFx0Ly8gX2xvb3A6IDAsXG5cdFx0fSxcblx0XHRtYXhWYWx1ZXM6IHtcblx0XHRcdGFtb3VudDogMSxcblx0XHRcdC8vIGF2YWlsYWJsZTogMSxcblx0XHR9LFxuXHRcdC8vIHVzZU9wYXF1ZTogdHJ1ZSxcblx0XHQvLyBsYWJlbEZuOiBmdW5jdGlvbih2YWx1ZSwgbWF4KSB7XG5cdFx0Ly8gXHRyZXR1cm4gKCh2YWx1ZSAvIG1heCkgKiAxMDApIHwgMDtcblx0XHQvLyB9LFxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdENhbnZhc1ZpZXcucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdHRoaXMuX2xpc3RBID0gb3B0aW9ucy5saXN0QTtcblx0XHR0aGlzLl9saXN0QiA9IG9wdGlvbnMubGlzdEI7XG5cdFx0dGhpcy5fYTJiID0ge1xuXHRcdFx0c3JjVmlldzogb3B0aW9ucy5saXN0QSxcblx0XHRcdGRlc3RWaWV3OiBvcHRpb25zLmxpc3RCLFxuXHRcdFx0czogXy5kZWZhdWx0cyh7XG5cdFx0XHRcdGxpbmVXaWR0aDogMS4yNVxuXHRcdFx0XHQvLyByYWRpdXNJbmNyZW1lbnQ6IDAuMjUsXG5cdFx0XHR9LCBzdHlsZUJhc2UpLFxuXHRcdFx0c3Ryb2tlU3R5bGVGbjogZnVuY3Rpb24oZmcsIGJnLCBsbikge1xuXHRcdFx0XHRyZXR1cm4gQ29sb3IobG4pLm1peChiZywgMC45KS5oZXhTdHJpbmcoKTtcblx0XHRcdFx0Ly8gcmV0dXJuIENvbG9yKGZnKS5taXgoYmcsIDAuOSkuaGV4U3RyaW5nKCk7XG5cdFx0XHR9XG5cdFx0fTtcblx0XHR0aGlzLl9iMmEgPSB7XG5cdFx0XHRzcmNWaWV3OiBvcHRpb25zLmxpc3RCLFxuXHRcdFx0ZGVzdFZpZXc6IG9wdGlvbnMubGlzdEEsXG5cdFx0XHRzOiBfLmRlZmF1bHRzKHtcblx0XHRcdFx0bGluZVdpZHRoOiAwLjcsXG5cdFx0XHRcdC8vIGFycm93U2l6ZTogMC4yNSxcblx0XHRcdFx0Ly8gcmFkaXVzSW5jcmVtZW50OiAwLFxuXHRcdFx0XHQvLyBvdXRsaW5lV2lkdGg6IDAsXG5cdFx0XHR9LCBzdHlsZUJhc2UpLFxuXHRcdFx0c3Ryb2tlU3R5bGVGbjogZnVuY3Rpb24oZmcsIGJnLCBsbikge1xuXHRcdFx0XHRyZXR1cm4gQ29sb3IoZmcpLm1peChiZywgMC42KS5oZXhTdHJpbmcoKTtcblx0XHRcdH1cblx0XHR9O1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnJlbmRlcjpiZWZvcmVcIiwgdGhpcy5fYmVmb3JlVmlld1JlbmRlcik7XG5cblx0XHR2YXIgdmlld3BvcnRDaGFuZ2VkID0gZnVuY3Rpb24oZXYpIHtcblx0XHRcdC8vIHRoaXMucmVxdWVzdFJlbmRlcihDYW52YXNWaWV3LlNJWkVfSU5WQUxJRCk7XG5cdFx0XHQvLyB0aGlzLnJlcXVlc3RSZW5kZXIoQ2FudmFzVmlldy5MQVlPVVRfSU5WQUxJRCk7XG5cdFx0XHRjb25zb2xlLmxvZyhcIiVzOlslc106IHdpbmRvdy5zY3JvbGxZOiVzIGJvZHkuc2Nyb2xsVG9wOiVzIGh0bWwuc2Nyb2xsVG9wOiVzXCIsXG5cdFx0XHRcdHRoaXMuY2lkLCBldi50eXBlLFxuXHRcdFx0XHR3aW5kb3cuc2Nyb2xsWSxcblx0XHRcdFx0ZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AsXG5cdFx0XHRcdGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApO1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczpbJXNdOiBib2R5LnNjcm9sbEhlaWdodDolcyBib2R5LmNsaWVudEhlaWdodDolcyBodG1sLnNjcm9sbEhlaWdodDolcyBodG1sLmNsaWVudEhlaWdodDolc1wiLFxuXHRcdFx0XHR0aGlzLmNpZCwgZXYudHlwZSxcblx0XHRcdFx0ZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQsIGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0LFxuXHRcdFx0XHRkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsSGVpZ2h0LCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KTtcblx0XHRcdHRoaXMuX2dyb3VwUmVjdHMgPSBudWxsO1xuXHRcdH0uYmluZCh0aGlzKTtcblxuXHRcdC8vIHZpZXdwb3J0Q2hhbmdlZCA9IF8uZGVib3VuY2Uodmlld3BvcnRDaGFuZ2VkLCAxMDAsIGZhbHNlKTtcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInNjcm9sbFwiLCBfLmRlYm91bmNlKHZpZXdwb3J0Q2hhbmdlZCwgMTAwLCBmYWxzZSksIGZhbHNlKTtcblx0XHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIndoZWVsXCIsIF8uZGVib3VuY2Uodmlld3BvcnRDaGFuZ2VkLCAxMDAsIGZhbHNlKSwgZmFsc2UpO1xuXG5cdFx0Ly8gdGhpcy5fYWRkTGlzdExpc3RlbmVycyh0aGlzLl9hMmIpO1xuXHRcdC8vIHRoaXMuX2FkZExpc3RMaXN0ZW5lcnModGhpcy5fYjJhKTtcblx0fSxcblxuXHQvLyBfYWRkTGlzdExpc3RlbmVyczogZnVuY3Rpb24oZCkge1xuXHQvLyBcdHRoaXMubGlzdGVuVG8oZC5zcmNWaWV3LCB7XG5cdC8vIFx0XHRcInNlbGVjdDpvbmVcIjogZnVuY3Rpb24obW9kZWwpIHtcblx0Ly8gXHRcdFx0dGhpcy5saXN0ZW5Ub09uY2UoZC5kZXN0VmlldywgXCJ2aWV3OnJlbmRlcjphZnRlclwiLFxuXHQvLyBcdFx0XHRcdGZ1bmN0aW9uKHZpZXcpIHtcblx0Ly8gXHRcdFx0XHRcdGQuc3JjSXRlbSA9IGQuc3JjVmlldy5jb2xsZWN0aW9uLnNlbGVjdGVkO1xuXHQvLyBcdFx0XHRcdFx0ZC5kZXN0SXRlbXMgPSBkLmRlc3RWaWV3LmZpbHRlcmVkSXRlbXM7XG5cdC8vIFx0XHRcdFx0fSk7XG5cdC8vIFx0XHR9LFxuXHQvLyBcdFx0XCJzZWxlY3Q6bm9uZVwiOiBmdW5jdGlvbigpIHtcblx0Ly8gXHRcdFx0ZC5zcmNJdGVtID0gZC5kZXN0SXRlbXMgPSBudWxsO1xuXHQvLyBcdFx0fVxuXHQvLyBcdH0pO1xuXHQvLyB9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0bWVhc3VyZUNhbnZhczogZnVuY3Rpb24odywgaCkge1xuXHRcdGNvbnNvbGUubG9nKFwiJXM6Om1lYXN1cmVDYW52YXMgc3R5bGU6JW8gb2Zmc2V0OiVvIGFyZzolb1wiLCB0aGlzLmNpZCxcblx0XHRcdHBhcnNlSW50KHRoaXMuZWwuc3R5bGUuaGVpZ2h0KSwgdGhpcy5lbC5vZmZzZXRIZWlnaHQsIGgpO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dXBkYXRlQ2FudmFzOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl91cGRhdGVNZXRyaWNzKCk7XG5cdFx0dGhpcy5fdXBkYXRlU3R5bGVzKCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0Lyogc3R5bGVzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF91cGRhdGVTdHlsZXM6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBiLCBiZ0NvbG9yLCBsbkNvbG9yO1xuXHRcdGlmICh0aGlzLm1vZGVsLmdldChcIndpdGhCdW5kbGVcIikpIHtcblx0XHRcdGIgPSB0aGlzLm1vZGVsLmdldChcImJ1bmRsZVwiKTtcblx0XHRcdGxuQ29sb3IgPSBiLmNvbG9ycy5sbkNvbG9yLmNsb25lKCk7XG5cdFx0XHRiZ0NvbG9yID0gYi5jb2xvcnMuYmdDb2xvci5jbG9uZSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRiZ0NvbG9yID0gQ29sb3IoR2xvYmFscy5ERUZBVUxUX0NPTE9SU1tcImJhY2tncm91bmQtY29sb3JcIl0pO1xuXHRcdFx0bG5Db2xvciA9IENvbG9yKEdsb2JhbHMuREVGQVVMVF9DT0xPUlNbXCItLWxpbmstY29sb3JcIl0pO1xuXHRcdH1cblxuXHRcdHRoaXMuX2EyYi5zLnN0cm9rZVN0eWxlID0gdGhpcy5fYTJiLnMuZmlsbFN0eWxlID1cblx0XHRcdHRoaXMuX2EyYi5zdHJva2VTdHlsZUZuKHRoaXMuX2NvbG9yLCBiZ0NvbG9yLCBsbkNvbG9yKTtcblx0XHR0aGlzLl9iMmEucy5zdHJva2VTdHlsZSA9IHRoaXMuX2IyYS5zLmZpbGxTdHlsZSA9XG5cdFx0XHR0aGlzLl9iMmEuc3Ryb2tlU3R5bGVGbih0aGlzLl9jb2xvciwgYmdDb2xvciwgbG5Db2xvcilcblx0fSxcblxuXHRfc2V0U3R5bGU6IGZ1bmN0aW9uKHMpIHtcblx0XHRpZiAodHlwZW9mIHMgPT0gXCJzdHJpbmdcIikge1xuXHRcdFx0cyA9IHRoaXMuX3N0eWxlRGF0YVtzXTtcblx0XHR9XG5cdFx0Q2FudmFzVmlldy5zZXRTdHlsZSh0aGlzLl9jdHgsIHMpO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIG1ldHJpY3Ncblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X3VwZGF0ZU1ldHJpY3M6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBib3VuZHM7XG5cdFx0dmFyIGksIGlpLCBlbHM7XG5cdFx0dmFyIGFSZWN0LCBiUmVjdDtcblx0XHR2YXIgYU1pbiwgYk1pbjtcblxuXHRcdHRoaXMuX3Jvb3RGb250U2l6ZSA9IHBhcnNlRmxvYXQoXG5cdFx0XHRnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuZm9udFNpemUpO1xuXG5cdFx0Ym91bmRzID0gdGhpcy5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHQvLyBib3VuZHMgPSBnZXRBYnNvbHV0ZUNsaWVudFJlY3QodGhpcy5lbCk7XG5cdFx0dGhpcy5fY3R4LnNldFRyYW5zZm9ybSh0aGlzLl9jYW52YXNSYXRpbywgMCwgMCwgdGhpcy5fY2FudmFzUmF0aW8sXG5cdFx0XHQoLWJvdW5kcy5sZWZ0ICogdGhpcy5fY2FudmFzUmF0aW8pIC0gMC41LFxuXHRcdFx0KC1ib3VuZHMudG9wICogdGhpcy5fY2FudmFzUmF0aW8pIC0gMC41XG5cdFx0KTtcblxuXHRcdGFSZWN0ID0gdGhpcy5fbGlzdEEuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0YU1pbiA9IGFSZWN0LmxlZnQ7XG5cdFx0ZWxzID0gdGhpcy5fbGlzdEEuZWwucXVlcnlTZWxlY3RvckFsbChcIi5sYWJlbFwiKTtcblx0XHRmb3IgKGkgPSAwLCBpaSA9IGVscy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHRhTWluID0gTWF0aC5tYXgoYU1pbixcblx0XHRcdFx0ZWxzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnJpZ2h0KTtcblx0XHR9XG5cblx0XHRiUmVjdCA9IHRoaXMuX2xpc3RCLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdGJNaW4gPSBiUmVjdC5sZWZ0O1xuXHRcdGVscyA9IHRoaXMuX2xpc3RCLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubGFiZWxcIik7XG5cdFx0Zm9yIChpID0gMCwgaWkgPSBlbHMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0Yk1pbiA9IE1hdGgubWluKGJNaW4sXG5cdFx0XHRcdGVsc1tpXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0KTtcblx0XHR9XG5cdFx0dGhpcy5fYjJhLmRlc3RSZWN0ID0gdGhpcy5fYTJiLnJlY3QgPSBhUmVjdDtcblx0XHR0aGlzLl9iMmEuZGVzdE1pblggPSB0aGlzLl9hMmIueE1pbiA9IGFNaW47XG5cdFx0dGhpcy5fYTJiLmRlc3RSZWN0ID0gdGhpcy5fYjJhLnJlY3QgPSBiUmVjdDtcblx0XHR0aGlzLl9hMmIuZGVzdE1pblggPSB0aGlzLl9iMmEueE1pbiA9IGJNaW47XG5cblx0XHQvLyB2YXIgcyA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KTtcblx0XHQvLyB0aGlzLl9yb290Rm9udFNpemUgPSBwYXJzZUZsb2F0KHMuZm9udFNpemUpOyAvLyAqIHRoaXMuX2NhbnZhc1JhdGlvO1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol91cGRhdGVNZXRyaWNzIF9yb290Rm9udFNpemU6ICVzICVvXCIsIHRoaXMuY2lkLCB0aGlzLl9yb290Rm9udFNpemUsIHMpO1xuXG5cdFx0Ly8gdmFyIGMgPSBNYXRoLmFicyhzRGF0YS54TWluIC0gZERhdGEueE1pbikgLyA2O1xuXHRcdC8vIHNNaW4gPSBzRGF0YS54TWluICsgYyAqIHF4O1xuXHRcdC8vIGRNaW4gPSBkRGF0YS54TWluIC0gYyAqIHF4O1xuXG5cdFx0Ly8gdGhpcy5fYTJiLnRhcmdldHMgPSB0aGlzLl9tZWFzdXJlTGlzdEl0ZW1zKGxpc3RWaWV3KTtcblx0XHQvLyB0aGlzLl9iMmEudGFyZ2V0cyA9IHRoaXMuX21lYXN1cmVMaXN0SXRlbXMobGlzdFZpZXcpO1xuXG5cdFx0Ly8gLy8gY29ubmVjdG9yIG1pbmltdW0gYnJhbmNoIHgyXG5cdFx0Ly8gbGlzdFZpZXcgPSB0aGlzLl9saXN0Qjtcblx0XHQvLyBmb3IgKGkgPSAwLCBpaSA9IGxpc3RWaWV3Lmdyb3Vwcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0Ly8gXHRpdGVtVmlldyA9IGxpc3RWaWV3Lml0ZW1WaWV3cy5maW5kQnlNb2RlbChsaXN0Vmlldy5ncm91cHNbaV0pO1xuXHRcdC8vIFx0aXRlbVJlY3QgPSAoaXRlbVZpZXcubGFiZWwgfHwgaXRlbVZpZXcuZWwpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdC8vIFx0dGhpcy5fYjJhLnhNaW4gPSBNYXRoLm1pbih0aGlzLl9iMmEueE1pbiwgaXRlbVJlY3QubGVmdCk7XG5cdFx0Ly8gXHQvLyBpZiAoaXRlbVZpZXcuX21ldHJpY3MpIHRoaXMuX2IyYS5yZWN0LmxlZnQgKyBpdGVtVmlldy50cmFuc2Zvcm0udHggKyBpdGVtVmlldy5fbWV0cmljcy50ZXh0TGVmdDtcblx0XHQvLyB9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcmVkcmF3XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9iZWZvcmVWaWV3UmVuZGVyOiBmdW5jdGlvbih2aWV3LCBmbGFncykge1xuXHRcdGlmIChmbGFncyAmIChDYW52YXNWaWV3LlNJWkVfSU5WQUxJRCB8IENhbnZhc1ZpZXcuTU9ERUxfSU5WQUxJRCkpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiJXM6Ol9iZWZvcmVWaWV3UmVuZGVyIFtmbGFnczogJXNdXCIsIHRoaXMuY2lkLCBDYW52YXNWaWV3LmZsYWdzVG9TdHJpbmcoZmxhZ3MpKTtcblxuXHRcdFx0dGhpcy5fYTJiLnBvaW50c091dCA9IHRoaXMuX2EyYi5wb2ludHM7XG5cdFx0XHR0aGlzLl9hMmIucm9vdE91dCA9IHRoaXMuX2EyYi5yb290O1xuXHRcdFx0dGhpcy5fYTJiLnBvaW50cyA9IG51bGw7XG5cdFx0XHR0aGlzLl9hMmIucm9vdCA9IG51bGw7XG5cblx0XHRcdHRoaXMuX2IyYS5wb2ludHNPdXQgPSB0aGlzLl9iMmEucG9pbnRzO1xuXHRcdFx0dGhpcy5fYjJhLnJvb3RPdXQgPSB0aGlzLl9iMmEucm9vdDtcblx0XHRcdHRoaXMuX2IyYS5wb2ludHMgPSBudWxsO1xuXHRcdFx0dGhpcy5fYjJhLnJvb3QgPSBudWxsO1xuXG5cdFx0XHR0aGlzLl9ncm91cFJlY3RzID0gbnVsbDtcblx0XHR9XG5cdH0sXG5cblx0cmVkcmF3OiBmdW5jdGlvbihjdHgsIGludGVycG9sYXRvcikge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OnJlZHJhdyBbdmFsdWVzQ2hhbmdlZDogJXNdXCIsIHRoaXMuY2lkLCBpbnRlcnBvbGF0b3IudmFsdWVzQ2hhbmdlZCk7XG5cdFx0dGhpcy5fY2xlYXJDYW52YXMoMCwgMCwgdGhpcy5fY2FudmFzV2lkdGgsIHRoaXMuX2NhbnZhc0hlaWdodCk7XG5cdFx0Y3R4LnNhdmUoKTtcblx0XHR0aGlzLl9yZWRyYXdfZnJvbUVsZW1lbnRzKGN0eCwgaW50ZXJwb2xhdG9yKTtcblx0XHQvLyB0aGlzLl9yZWRyYXdfZnJvbVZpZXdzKGN0eCwgaW50ZXJwb2xhdG9yKTtcblx0XHRjdHgucmVzdG9yZSgpO1xuXHR9LFxuXG5cdF9yZWRyYXdfZnJvbUVsZW1lbnRzOiBmdW5jdGlvbihjdHgsIGludGVycG9sYXRvcikge1xuXHRcdC8vIGIyYToga2V5d29yZCB0byBidW5kbGVzLCByaWdodCB0byBsZWZ0XG5cdFx0Ly8gYTJiOiBidW5kbGUgdG8ga2V5d29yZHMsIGxlZnQgdG8gcmlnaHRcblx0XHRpZiAodGhpcy5fYjJhLnBvaW50cyA9PT0gbnVsbCkge1xuXHRcdFx0dGhpcy5fY29tcHV0ZUNvbm5lY3RvcnModGhpcy5fYjJhKTsgLy8sIHRoaXMuX2xpc3RCLCB0aGlzLl9saXN0QSk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLl9hMmIucG9pbnRzID09PSBudWxsKSB7XG5cdFx0XHR0aGlzLl9jb21wdXRlQ29ubmVjdG9ycyh0aGlzLl9hMmIpOyAvLywgdGhpcy5fbGlzdEEsIHRoaXMuX2xpc3RCKTtcblx0XHR9XG5cblx0XHQvKiBsaW5lIGRhc2ggdmFsdWUgaW50ZXJwb2xhdGlvbiAqL1xuXHRcdHZhciBsVmFsID0gaW50ZXJwb2xhdG9yLl92YWx1ZURhdGFbXCJhbW91bnRcIl0uX3JlbmRlcmVkVmFsdWUgLyBpbnRlcnBvbGF0b3IuX3ZhbHVlRGF0YVtcImFtb3VudFwiXS5fbWF4VmFsO1xuXG5cdFx0LyogZHJhdyAqL1xuXHRcdHRoaXMuX2RyYXdDb25uZWN0b3JzKHRoaXMuX2IyYS5yb290LCB0aGlzLl9iMmEucG9pbnRzLCB0aGlzLl9iMmEucywgbFZhbCwgMSk7XG5cdFx0dGhpcy5fZHJhd0Nvbm5lY3RvcnModGhpcy5fYjJhLnJvb3RPdXQsIHRoaXMuX2IyYS5wb2ludHNPdXQsIHRoaXMuX2IyYS5zLCAxIC0gbFZhbCwgMSk7XG5cdFx0dGhpcy5fZHJhd0Nvbm5lY3RvcnModGhpcy5fYTJiLnJvb3QsIHRoaXMuX2EyYi5wb2ludHMsIHRoaXMuX2EyYi5zLCAxLCAyKTtcblxuXHRcdC8vIHRoaXMuX2RyYXdPdmVybGF5cyh0aGlzLl9hMmIuZGVzdFZpZXcsIHRoaXMuX2EyYi5kZXN0UmVjdCk7XG5cblx0XHQvLyBjbGVhciBzb21lIGxhYmVsIGJhY2tncm91bmRzXG5cdFx0aWYgKHRoaXMuX2dyb3VwUmVjdHMgPT09IG51bGwpIHtcblx0XHRcdHRoaXMuX2dyb3VwUmVjdHMgPSBbXTtcblx0XHRcdHZhciBlbHMgPSB0aGlzLl9saXN0Qi5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLmxpc3QtZ3JvdXAgLmxhYmVsIHNwYW5cIik7XG5cdFx0XHRmb3IgKHZhciBpID0gMCwgaWkgPSBlbHMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0XHR0aGlzLl9ncm91cFJlY3RzW2ldID0gZWxzW2ldLmdldEJvdW5kaW5nQ2xpZW50UmVjdChlbHNbaV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAobFZhbCA9PT0gMSkge1xuXHRcdFx0Y29uc29sZS5sb2coXCIlczo6X3JlZHJhdyBcIiArXG5cdFx0XHRcdFwid2luZG93LnNjcm9sbFk6ICVzIFwiICtcblx0XHRcdFx0XCJ3aW5kb3cucGFnZVlPZmZzZXQ6ICVzIFwiICtcblx0XHRcdFx0XCJib2R5LnNjcm9sbFRvcDogJXMgXCIgK1xuXHRcdFx0XHRcImh0bWwuc2Nyb2xsVG9wOiAlcyBcIiArXG5cdFx0XHRcdFwiI2NvbnRhaW5lci5zY3JvbGxUb3A6ICVzXCIsXG5cdFx0XHRcdHRoaXMuY2lkLFxuXHRcdFx0XHR3aW5kb3cuc2Nyb2xsWSxcblx0XHRcdFx0d2luZG93LnBhZ2VZT2Zmc2V0LFxuXHRcdFx0XHRkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wLFxuXHRcdFx0XHRkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCxcblx0XHRcdFx0ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmZpcnN0RWxlbWVudENoaWxkLnNjcm9sbFRvcFxuXHRcdFx0KTtcblx0XHR9XG5cblx0XHR0aGlzLl9ncm91cFJlY3RzLmZvckVhY2goZnVuY3Rpb24ocikge1xuXHRcdFx0Ly8gVE9ETzogaW1wbGVtZW50IERPTVJlY3QuaW5mbGF0ZSgpXG5cdFx0XHQvLyBDYW52YXNIZWxwZXIuZHJhd1JlY3QodGhpcy5fY3R4LCBfZFN0eWxlc1tcInJlZF9maWxsXCJdLFxuXHRcdFx0Ly8gXHRyLmxlZnQgKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQsXG5cdFx0XHQvLyBcdHIudG9wICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AsXG5cdFx0XHQvLyBcdHIud2lkdGgsIHIuaGVpZ2h0KTtcblx0XHRcdC8vIHIgPSBpbmZsYXRlUmVjdChyLCAtOC41LCAtNC41KTtcblx0XHRcdHRoaXMuX2N0eC5jbGVhclJlY3QoXG5cdFx0XHRcdHIubGVmdCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdCxcblx0XHRcdFx0ci50b3AgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCxcblx0XHRcdFx0ci53aWR0aCwgci5oZWlnaHQpO1xuXG5cdFx0fSwgdGhpcyk7XG5cdH0sXG5cblx0X2RyYXdPdmVybGF5czogZnVuY3Rpb24obGlzdCwgcmVjdCkge1xuXHRcdHZhciBpdGVtcyA9IGxpc3QuZ3JvdXBzO1xuXHRcdGZvciAodmFyIGkgPSAwLCBudW0gPSBpdGVtcy5sZW5ndGgsIGl0ZW07IGkgPCBudW07IGkrKykge1xuXHRcdFx0aXRlbSA9IGxpc3QuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKGl0ZW1zW2ldKTtcblx0XHRcdGlmIChpdGVtLl9tZXRyaWNzICYmIGl0ZW0udHJhbnNmb3JtKSB7XG5cdFx0XHRcdGNvbnNvbGUubG9nKFwibGlzdC5maWx0ZXJlZEdyb3Vwcy5sZW5ndGhbJW9dICVvXCIsIGksXG5cdFx0XHRcdFx0aXRlbS5fbWV0cmljcywgaXRlbS50cmFuc2Zvcm0pO1xuXHRcdFx0XHR0aGlzLl9jdHguY2xlYXJSZWN0KFxuXHRcdFx0XHRcdHJlY3QubGVmdCArIGl0ZW0udHJhbnNmb3JtLnR4ICsgaXRlbS5fbWV0cmljcy5vZmZzZXRMZWZ0LFxuXHRcdFx0XHRcdHJlY3QudG9wICsgaXRlbS50cmFuc2Zvcm0udHkgKyBpdGVtLl9tZXRyaWNzLm9mZnNldFRvcCAtIDUsXG5cdFx0XHRcdFx0aXRlbS5fbWV0cmljcy5vZmZzZXRXaWR0aCxcblx0XHRcdFx0XHQxMCAvLyBpdGVtLl9tZXRyaWNzLm9mZnNldEhlaWdodFxuXHRcdFx0XHQpO1xuXHRcdFx0XHQvLyBDYW52YXNIZWxwZXIuZHJhd1JlY3QodGhpcy5fY3R4LCBfZFN0eWxlc1tcInJlZF9maWxsXCJdLFxuXHRcdFx0XHQvLyBcdHJlY3QubGVmdCArIGl0ZW0udHJhbnNmb3JtLnR4ICsgaXRlbS5fbWV0cmljcy5vZmZzZXRMZWZ0LFxuXHRcdFx0XHQvLyBcdHJlY3QudG9wICsgaXRlbS50cmFuc2Zvcm0udHkgKyBpdGVtLl9tZXRyaWNzLm9mZnNldFRvcCAtIDUsXG5cdFx0XHRcdC8vIFx0aXRlbS5fbWV0cmljcy5vZmZzZXRXaWR0aCwgMTBcblx0XHRcdFx0Ly8gKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0X2NvbXB1dGVDb25uZWN0b3JzOiBmdW5jdGlvbihkKSB7XG5cdFx0dmFyIHNNaW4gPSBkLnhNaW47XG5cdFx0dmFyIGRNaW4gPSBkLmRlc3RNaW5YO1xuXG5cdFx0dmFyIHJvb3QgPSB7fTtcblx0XHR2YXIgcCwgcG9pbnRzID0gW107XG5cdFx0dmFyIHF4LCB4MSwgeTEsIHR4O1xuXHRcdHZhciByQmFzZSwgckluYztcblxuXHRcdHJCYXNlID0gdGhpcy5fcm91bmRUbyhkLnMucmFkaXVzQmFzZSAqIHRoaXMuX3Jvb3RGb250U2l6ZSwgMC41KTtcblx0XHRySW5jID0gdGhpcy5fcm91bmRUbyhkLnMucmFkaXVzSW5jcmVtZW50ICogdGhpcy5fcm9vdEZvbnRTaXplLCAwLjUpO1xuXG5cdFx0aWYgKGQucmVjdC5yaWdodCA8IGQuZGVzdFJlY3QubGVmdCkge1xuXHRcdFx0cXggPSAxO1xuXHRcdH0gZWxzZSBpZiAoZC5kZXN0UmVjdC5yaWdodCA8IGQucmVjdC5sZWZ0KSB7XG5cdFx0XHRxeCA9IC0xO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRxeCA9IDA7XG5cdFx0fVxuXG5cdFx0dmFyIHNWaWV3LCBkZFZpZXcsIGRkSXRlbXMsIGRkTnVtLCBpO1xuXHRcdGlmIChkLnNyY1ZpZXcuY29sbGVjdGlvbi5zZWxlY3RlZCAmJiBkLmRlc3RWaWV3LmZpbHRlcmVkSXRlbXMpIHtcblx0XHRcdHNWaWV3ID0gZC5zcmNWaWV3Lml0ZW1WaWV3cy5maW5kQnlNb2RlbChkLnNyY1ZpZXcuY29sbGVjdGlvbi5zZWxlY3RlZCk7XG5cblx0XHRcdC8vIHZhciByZWN0ID0gc1ZpZXcubGFiZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHQvLyB4MSA9IHJlY3QubGVmdDtcblx0XHRcdC8vIHkxID0gcmVjdC50b3AgKyByZWN0LmhlaWdodCAvIDI7XG5cdFx0XHQvLyBpZiAocXggPiAwKSB4MSArPSByZWN0LndpZHRoO1xuXHRcdFx0Ly8geDEgKz0gZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0O1xuXHRcdFx0Ly8geTEgKz0gZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7XG5cdFx0XHRpZiAoIXNWaWV3Ll9tZXRyaWNzKSByZXR1cm47XG5cblx0XHRcdHgxID0gZC5yZWN0LmxlZnQgKyBzVmlldy50cmFuc2Zvcm0udHhcblx0XHRcdFx0KyBzVmlldy5fbWV0cmljcy50ZXh0TGVmdDtcblx0XHRcdHkxID0gZC5yZWN0LnRvcCArIHNWaWV3LnRyYW5zZm9ybS50eVxuXHRcdFx0XHQrIHNWaWV3Ll9tZXRyaWNzLm9mZnNldEhlaWdodCAvIDI7XG5cdFx0XHRpZiAocXggPiAwKSB4MSArPSBzVmlldy5fbWV0cmljcy50ZXh0V2lkdGg7XG5cblx0XHRcdGRkSXRlbXMgPSBkLmRlc3RWaWV3LmZpbHRlcmVkSXRlbXM7XG5cdFx0XHRkZE51bSA9IGQuZGVzdFZpZXcuZmlsdGVyZWRJdGVtcy5sZW5ndGg7XG5cblx0XHRcdGZvciAoaSA9IDA7IGkgPCBkZE51bTsgaSsrKSB7XG5cdFx0XHRcdHAgPSB7fTtcblx0XHRcdFx0ZGRWaWV3ID0gZC5kZXN0Vmlldy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoZGRJdGVtc1tpXSk7XG5cblx0XHRcdFx0Ly8gcmVjdCA9IGRkVmlldy5sYWJlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRcdFx0Ly8gcC54MiA9IHJlY3QubGVmdDtcblx0XHRcdFx0Ly8gcC55MiA9IHJlY3QudG9wICsgcmVjdC5oZWlnaHQgLyAyO1xuXHRcdFx0XHQvLyBpZiAocXggPCAwKSBwLngyICs9IHJlY3Qud2lkdGg7XG5cdFx0XHRcdC8vIHAueDIgKz0gZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0O1xuXHRcdFx0XHQvLyBwLnkyICs9IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wO1xuXG5cdFx0XHRcdHAueDIgPSBkLmRlc3RSZWN0LmxlZnQgKyBkZFZpZXcudHJhbnNmb3JtLnR4XG5cdFx0XHRcdFx0KyBkZFZpZXcuX21ldHJpY3MudGV4dExlZnQ7XG5cdFx0XHRcdHAueTIgPSBkLmRlc3RSZWN0LnRvcCArIGRkVmlldy50cmFuc2Zvcm0udHlcblx0XHRcdFx0XHQrIGRkVmlldy5fbWV0cmljcy5vZmZzZXRIZWlnaHQgLyAyO1xuXHRcdFx0XHRpZiAocXggPCAwKSBwLngyICs9IGRkVmlldy5fbWV0cmljcy50ZXh0V2lkdGg7XG5cblx0XHRcdFx0cC54MSA9IHgxO1xuXHRcdFx0XHRwLnkxID0geTE7XG5cdFx0XHRcdHAucXggPSBxeDtcblx0XHRcdFx0cG9pbnRzW2ldID0gcDtcblx0XHRcdH1cblx0XHRcdHBvaW50cy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcblx0XHRcdFx0cmV0dXJuIGEueTIgLSBiLnkyO1xuXHRcdFx0fSk7XG5cdFx0XHR2YXIgc2kgPSAwOyAvLyBzc0VsJ3MgbnVtYmVyIG9mIGl0ZW1zIGFib3ZlIGluIHRoZSBZIGF4aXNcblx0XHRcdHZhciByTWF4MCA9IGRkTnVtICogMC41ICogckluYzsgLy8gZmlyc3QgYXJjIChyMCkgbWF4IHJhZGl1cyAoY3gwKVxuXHRcdFx0dmFyIGE7IC8vIGN5MSBvZmZzZXQgZnJvbSB5MVxuXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgZGROdW07IGkrKykge1xuXHRcdFx0XHRwID0gcG9pbnRzW2ldO1xuXG5cdFx0XHRcdGEgPSAoaSAtIChkZE51bSAtIDEpIC8gMikgKiBySW5jO1xuXHRcdFx0XHRwLmN5MSA9IHAueTEgKyBhO1xuXHRcdFx0XHRwLmN5MiA9IHAueTI7XG5cblx0XHRcdFx0YSA9IE1hdGguYWJzKGEpO1xuXHRcdFx0XHRwLnIwID0gYTtcblx0XHRcdFx0cC5jeDAgPSBwLngxICsgKHJNYXgwIC0gYSkgKiBxeDtcblxuXHRcdFx0XHQvLyBwLmR4ID0geDEgLSBwLngyO1xuXHRcdFx0XHQvLyBwLmR5ID0geTEgLSBwLnkyO1xuXG5cdFx0XHRcdHAuZGkgPSAoKHAuY3kxIC0gcC55MikgPiAwKSA/IGkgOiBkZE51bSAtIChpICsgMSk7XG5cdFx0XHRcdHNpID0gTWF0aC5tYXgoc2ksIHAuZGkpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBOT1RFXG5cdFx0XHQvL3NNaW4gPSBwLngxICsgKHJNYXgwICogcXgpO1xuXG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgZGROdW07IGkrKykge1xuXHRcdFx0XHRwID0gcG9pbnRzW2ldO1xuXHRcdFx0XHRwLnIxID0gcC5kaSAqIHJJbmMgKyByQmFzZTtcblx0XHRcdFx0cC5yMiA9IHJCYXNlO1xuXHRcdFx0XHQvLyBwLnIyID0gckJhc2UgKyAoc2kgLSBwLmRpKSAqIHJJbmM7XG5cblx0XHRcdFx0cC5jeDEgPSBzTWluICsgKHJNYXgwICogcXgpO1xuXHRcdFx0XHRwLmN4MiA9IGRNaW4gLSAoKHNpIC0gcC5kaSkgKiBySW5jKSAqIHF4O1xuXHRcdFx0XHQvLyBwLmN4MiA9IGRNaW47XG5cblx0XHRcdFx0dHggPSBjYWxjQXJjSENvbm5lY3RvcihwLmN4MSwgcC5jeTEsIHAucjEsIHAuY3gyLCBwLmN5MiwgcC5yMiwgMC45KTtcblx0XHRcdFx0aWYgKHR4KSB7XG5cdFx0XHRcdFx0cC50eDEgPSB0eFswXTtcblx0XHRcdFx0XHRwLnR4MiA9IHR4WzFdO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHAudHgxID0gcC5jeDE7XG5cdFx0XHRcdFx0cC50eDIgPSBwLmN4Mjtcblx0XHRcdFx0fVxuXHRcdFx0XHRwLmxlbmd0aCA9IE1hdGguYWJzKHAueDEgLSBwLngyKSArIE1hdGguYWJzKHAuY3kxIC0gcC5jeTIpO1xuXG5cdFx0XHRcdC8vIEZpbmQgb3V0IGxvbmdlc3Qgbm9kZSBjb25uZWN0aW9uIGZvciBzZXRMaW5lRGFzaFxuXHRcdFx0XHRyb290Lm1heExlbmd0aCA9IE1hdGgubWF4KHJvb3QubWF4TGVuZ3RoLCBwLmxlbmd0aCk7XG5cdFx0XHR9XG5cdFx0XHRwb2ludHMuc29ydChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHRcdHJldHVybiBhLmRpIC0gYi5kaTsgLy8gU29ydCBieSBkaXN0YW5jZSB0byBzZWxlY3RlZCB2aWV3XG5cdFx0XHR9KTtcblxuXHRcdFx0cm9vdC54ID0geDE7XG5cdFx0XHRyb290LnkgPSB5MTtcblx0XHRcdHJvb3QucXggPSBxeDtcblx0XHRcdHJvb3QucjAgPSBzaSAqIHJJbmM7XG5cdFx0fVxuXHRcdGQucG9pbnRzID0gcG9pbnRzO1xuXHRcdGQucm9vdCA9IHJvb3Q7XG5cdH0sXG5cblx0X2RyYXdDb25uZWN0b3JzOiBmdW5jdGlvbihyb290LCBwcCwgcywgbFZhbCwgZGlyKSB7XG5cdFx0dmFyIGksIGlpLCBwO1xuXHRcdHZhciBvdywgcmExLCByYTIsIHRhO1xuXG5cdFx0aWYgKCEocHAgJiYgcHAubGVuZ3RoICYmIGxWYWwpKSByZXR1cm47XG5cblx0XHRpaSA9IHBwLmxlbmd0aDtcblxuXHRcdC8qIG91dGxpbmUgd2lkdGggKi9cblx0XHQvLyBvdyA9IHMubGluZVdpZHRoICsgcy5vdXRsaW5lV2lkdGg7XG5cdFx0b3cgPSBNYXRoLm1pbihcblx0XHRcdHRoaXMuX3JvdW5kVG8ocy5yYWRpdXNJbmNyZW1lbnQgKiB0aGlzLl9yb290Rm9udFNpemUsIDAuNSksXG5cdFx0XHR0aGlzLl9yb3VuZFRvKHMubGluZVdpZHRoICogKDEgKyBzLm91dGxpbmVXaWR0aCksIDAuNSlcblx0XHQpO1xuXG5cdFx0LyogYXJyb3cgcmFkaXVzZXMsIGRpcmVjdGlvbiAqL1xuXHRcdC8vIHJhMSA9IChzLnJhZGl1c0luY3JlbWVudCAqIHRoaXMuX3Jvb3RGb250U2l6ZSkgKyBzLmxpbmVXaWR0aDtcblx0XHRyYTEgPSBzLmFycm93U2l6ZSAqIHRoaXMuX3Jvb3RGb250U2l6ZTtcblx0XHRyYTIgPSByYTEgKyAob3cgLSBzLmxpbmVXaWR0aCk7XG5cdFx0dGEgPSBNYXRoLlBJICogZGlyO1xuXG5cdFx0dGhpcy5fc2V0U3R5bGUocyk7XG5cblx0XHQvLyBpZiAobFZhbCA8IDEpIHtcblx0XHQvLyBcdHRoaXMuX2N0eC5saW5lRGFzaE9mZnNldCA9IGxNYXggKiAoMSArIGxWYWwpO1xuXHRcdC8vIFx0dGhpcy5fY3R4LnNldExpbmVEYXNoKFtsTWF4LCBsTWF4XSlcblx0XHQvLyBcdC8vIHRoaXMuX2N0eC5saW5lRGFzaE9mZnNldCA9IGxNYXggKiAoMSArIGxWYWwpOztcblx0XHQvLyBcdC8vIHRoaXMuX2N0eC5zZXRMaW5lRGFzaChbbE1heCAqICgxIC0gbFZhbCksIGxNYXhdKTtcblx0XHQvLyB9XG5cblx0XHQvLyBmb3IgKGkgPSAwOyBpIDwgaWk7IGkrKykge1xuXHRcdC8vIHAgPSBwcFtpXTtcblx0XHRpZiAocy5vdXRsaW5lV2lkdGgpIHtcblx0XHRcdHRoaXMuX2N0eC5zYXZlKCk7XG5cdFx0XHR0aGlzLl9jdHguZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gXCJkZXN0aW5hdGlvbi1vdXRcIjtcblx0XHRcdHRoaXMuX2N0eC5saW5lV2lkdGggPSBvdztcblx0XHRcdGZvciAoaSA9IDA7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHRcdHAgPSBwcFtpXTtcblxuXHRcdFx0XHRpZiAobFZhbCA8IDEpIHtcblx0XHRcdFx0XHR0aGlzLl9jdHgubGluZURhc2hPZmZzZXQgPSBwLmxlbmd0aCAqICgxICsgbFZhbCk7XG5cdFx0XHRcdFx0dGhpcy5fY3R4LnNldExpbmVEYXNoKFtwLmxlbmd0aCwgcC5sZW5ndGhdKVxuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuX2RyYXdDb25uZWN0b3IocCwgaSwgcHApO1xuXHRcdFx0XHRpZiAobFZhbCA9PSAxKSB7XG5cdFx0XHRcdFx0Q2FudmFzSGVscGVyLmFycm93aGVhZCh0aGlzLl9jdHgsIHAueDIsIHAueTIsIHJhMiwgdGEpO1xuXHRcdFx0XHRcdHRoaXMuX2N0eC5maWxsKCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHRoaXMuX2N0eC5yZXN0b3JlKCk7XG5cdFx0fVxuXG5cdFx0Zm9yIChpID0gMDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHAgPSBwcFtpXTtcblx0XHRcdGlmIChsVmFsIDwgMSkge1xuXHRcdFx0XHR0aGlzLl9jdHgubGluZURhc2hPZmZzZXQgPSBwLmxlbmd0aCAqICgxICsgbFZhbCk7XG5cdFx0XHRcdHRoaXMuX2N0eC5zZXRMaW5lRGFzaChbcC5sZW5ndGgsIHAubGVuZ3RoXSlcblx0XHRcdH1cblx0XHRcdHRoaXMuX2RyYXdDb25uZWN0b3IocCwgaSwgcHApO1xuXHRcdFx0aWYgKGxWYWwgPT0gMSkge1xuXHRcdFx0XHRDYW52YXNIZWxwZXIuYXJyb3doZWFkKHRoaXMuX2N0eCwgcC54MiwgcC55MiwgcmExLCB0YSk7XG5cdFx0XHRcdHRoaXMuX2N0eC5maWxsKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF9kcmF3Q29ubmVjdG9yOiBmdW5jdGlvbihwLCBpLCBwcCkge1xuXG5cdFx0dGhpcy5fY3R4LmJlZ2luUGF0aCgpO1xuXHRcdHRoaXMuX2N0eC5tb3ZlVG8ocC54MiwgcC5jeTIpO1xuXHRcdHRoaXMuX2N0eC5hcmNUbyhwLnR4MiwgcC5jeTIsIHAudHgxLCBwLmN5MSwgcC5yMik7XG5cdFx0dGhpcy5fY3R4LmFyY1RvKHAudHgxLCBwLmN5MSwgcC5jeDEsIHAuY3kxLCBwLnIxKTtcblx0XHR0aGlzLl9jdHguYXJjVG8ocC5jeDAsIHAuY3kxLCBwLmN4MCwgcC55MSwgcC5yMCk7XG5cblx0XHQvLyBwLmN4MDAgPSBwLngxICsgKChwLnIwICsgcC5kaSkgKiBwLnF4KTtcblx0XHQvLyBwLmN5MDAgPSAocC5jeTEgKyBwLnkxKSAvIDI7XG5cdFx0Ly8gdGhpcy5fY3R4LmFyY1RvKHAuY3gwMCwgcC5jeTEsIHAuY3gwMCwgcC5jeTAwLCBwLnIwIC8gMik7XG5cdFx0Ly8gdGhpcy5fY3R4LmFyY1RvKHAuY3gwMCwgcC55MSwgcC54MSwgcC55MSwgcC5yMCAvIDIpO1xuXHRcdC8vIHRoaXMuX2N0eC5saW5lVG8ocC54MSwgcC55MSk7XG5cblx0XHQvLyBwLmN4MDAgPSBwLngxICsgKHAucjAgKiBwLnF4ICogMik7XG5cdFx0Ly8gdGhpcy5fY3R4LmxpbmVUbyhwLmN4MDAsIHAuY3kxKTtcblx0XHQvLyB0aGlzLl9jdHgucXVhZHJhdGljQ3VydmVUbyhwLmN4MCwgcC5jeTEsIHAuY3gwLCBwLnkxKTtcblxuXHRcdC8vIHRoaXMuX2N0eC5saW5lVG8ocC5jeDAsIHAueTEpO1xuXG5cdFx0dGhpcy5fY3R4LnN0cm9rZSgpO1xuXG5cdFx0Ly8gaWYgKERFQlVHKSB7XG5cdFx0Ly8gXHRDYW52YXNIZWxwZXIuZHJhd0Nyb3NzaGFpcih0aGlzLl9jdHgsIF9kU3R5bGVzW1wiYmx1ZVwiXSxcblx0XHQvLyBcdFx0cC54MSArICgocC5yMCArIHAuZGkpICogcC5xeCksIHAuY3kxLCAzKTtcblx0XHQvLyBcdGlmIChpID09PSAwKSB7XG5cdFx0Ly8gXHRcdENhbnZhc0hlbHBlci5kcmF3Vkd1aWRlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJibHVlXCJdLCBwLngxKTtcblx0XHQvLyBcdFx0Q2FudmFzSGVscGVyLmRyYXdDaXJjbGUodGhpcy5fY3R4LCBfZFN0eWxlc1tcIm1pZG5pZ2h0Ymx1ZVwiXSwgcC54MSwgcC55MSwgMTApO1xuXHRcdC8vIFx0XHRDYW52YXNIZWxwZXIuZHJhd1ZHdWlkZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wibGlnaHRza3libHVlXCJdLCBwLmN4MSk7XG5cdFx0Ly8gXHRcdENhbnZhc0hlbHBlci5kcmF3SEd1aWRlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJncmV5XCJdLCBwLnkxKTtcblx0XHQvLyBcdH1cblx0XHQvLyBcdENhbnZhc0hlbHBlci5kcmF3SEd1aWRlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJzaWx2ZXJcIl0sIHAuY3kyKTtcblx0XHQvLyBcdC8vIF9kU3R5bGVzW3AuZHkgPiAwID8gXCJsaWdodGdyZWVuXCIgOiBcInNhbG1vblwiXSwgcC5jeTIpO1xuXHRcdC8vIFx0Q2FudmFzSGVscGVyLmRyYXdTcXVhcmUodGhpcy5fY3R4LCBfZFN0eWxlc1tcIm1pZG5pZ2h0Ymx1ZVwiXSwgcC5jeDAsIHAuY3kxLCAyKTtcblx0XHQvLyBcdENhbnZhc0hlbHBlci5kcmF3Q2lyY2xlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJibHVlXCJdLCBwLmN4MSwgcC5jeTEsIDEpO1xuXHRcdC8vIFx0Q2FudmFzSGVscGVyLmRyYXdTcXVhcmUodGhpcy5fY3R4LCBfZFN0eWxlc1tcImJsdWVcIl0sIHAudHgxLCBwLmN5MSwgMik7XG5cdFx0Ly8gXHRDYW52YXNIZWxwZXIuZHJhd1NxdWFyZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wiZ3JlZW5cIl0sIHAudHgyLCBwLmN5MiwgMik7XG5cdFx0Ly8gXHRDYW52YXNIZWxwZXIuZHJhd0NpcmNsZSh0aGlzLl9jdHgsIF9kU3R5bGVzW1wiZ3JlZW5cIl0sIHAuY3gyLCBwLmN5MiwgMSk7XG5cdFx0Ly9cblx0XHQvLyBcdENhbnZhc0hlbHBlci5kcmF3Vkd1aWRlKHRoaXMuX2N0eCwgX2RTdHlsZXNbXCJ5ZWxsb3dncmVlblwiXSwgcC5jeDIpO1xuXHRcdC8vIFx0Q2FudmFzSGVscGVyLmRyYXdDaXJjbGUodGhpcy5fY3R4LCBfZFN0eWxlc1tcIm9saXZlXCJdLCBwLngyLCBwLmN5MiwgMyk7XG5cdFx0Ly8gXHRDYW52YXNIZWxwZXIuZHJhd0Nyb3NzaGFpcih0aGlzLl9jdHgsIF9kU3R5bGVzW1wib2xpdmVcIl0sIHAueDIsIHAueTIsIDYpO1xuXHRcdC8vIH1cblx0fSxcblxuXHRfcm91bmRUbzogZnVuY3Rpb24obiwgcCkge1xuXHRcdGlmIChwID4gMSkgcCA9IDEgLyBwO1xuXHRcdHJldHVybiBNYXRoLnJvdW5kKG4gLyBwKSAqIHA7XG5cdH0sXG5cblx0LyogX2NvbXB1dGVDb25uZWN0b3JzOiBmdW5jdGlvbihkKSB7XG5cdFx0dmFyIHJCYXNlID0gZC5zLnJhZGl1c0Jhc2U7XG5cdFx0dmFyIHJJbmMgPSBkLnMucmFkaXVzSW5jcmVtZW50O1xuXHRcdHZhciBzTWluID0gZC54TWluO1xuXHRcdHZhciBkTWluID0gZC5kZXN0TWluWDtcblxuXHRcdHZhciBsTWF4ID0gMDtcblx0XHR2YXIgcCwgcG9pbnRzID0gW107XG5cdFx0dmFyIHF4LCB4MSwgeTEsIHR4O1xuXHRcdHZhciBzaTsgLy8gc3NFbCdzIG51bWJlciBvZiBpdGVtcyBhYm92ZSBpbiB0aGUgWSBheGlzXG5cblx0XHRpZiAoZC5yZWN0LnJpZ2h0IDwgZC5kZXN0UmVjdC5sZWZ0KSB7XG5cdFx0XHRxeCA9IDE7XG5cdFx0fSBlbHNlIGlmIChkLmRlc3RSZWN0LnJpZ2h0IDwgZC5yZWN0LmxlZnQpIHtcblx0XHRcdHF4ID0gLTE7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHF4ID0gMDtcblx0XHR9XG5cblx0XHR2YXIgc3NFbCwgZGRFbHMsIGRkTnVtLCBzc1JlY3QsIGRkUmVjdCwgaTtcblx0XHRzc0VsID0gZC5zcmNWaWV3LmVsLnF1ZXJ5U2VsZWN0b3IoXCIubGlzdC1pdGVtLnNlbGVjdGVkIC5sYWJlbFwiKTtcblx0XHRpZiAoc3NFbCkge1xuXHRcdFx0c3NSZWN0ID0gc3NFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRcdHgxID0gc3NSZWN0LmxlZnQ7XG5cdFx0XHRpZiAocXggPiAwKSB4MSArPSBzc1JlY3Qud2lkdGg7XG5cdFx0XHR5MSA9IHNzUmVjdC50b3AgKyBzc1JlY3QuaGVpZ2h0IC8gMjtcblx0XHRcdC8vIHIyID0gckJhc2U7XG5cdFx0XHQvLyBjeDEgPSBkLnhNaW47XG5cblx0XHRcdHNpID0gMDtcblx0XHRcdGRkRWxzID0gZC5kZXN0Vmlldy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiLmxpc3QtaXRlbTpub3QoLmV4Y2x1ZGVkKSAubGFiZWxcIik7XG5cdFx0XHRkZE51bSA9IGRkRWxzLmxlbmd0aDtcblx0XHRcdC8vIGR4ID0gTWF0aC5hYnMoZC54TWluIC0gZERhdGEueE1pbik7XG5cblx0XHRcdGZvciAoaSA9IDA7IGkgPCBkZE51bTsgaSsrKSB7XG5cdFx0XHRcdHAgPSB7fTtcblx0XHRcdFx0ZGRSZWN0ID0gZGRFbHNbaV0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHRcdHAueDIgPSBkZFJlY3QubGVmdDtcblx0XHRcdFx0aWYgKHF4IDwgMCkgcC54MiArPSBkZFJlY3Qud2lkdGg7XG5cdFx0XHRcdHAueTIgPSBkZFJlY3QudG9wICsgZGRSZWN0LmhlaWdodCAvIDI7XG5cdFx0XHRcdHAueDEgPSB4MTtcblx0XHRcdFx0cC55MSA9IHkxO1xuXHRcdFx0XHRwLmR4ID0gcC54MSAtIHAueDI7XG5cdFx0XHRcdHAuZHkgPSBwLnkxIC0gcC55Mjtcblx0XHRcdFx0cC5xeCA9IHF4O1xuXHRcdFx0XHRwLnF5ID0gTWF0aC5zaWduKHAuZHkpO1xuXHRcdFx0XHQvLyBwLmRMZW5ndGggPSBNYXRoLmFicyhwLngpICsgTWF0aC5hYnMocC55KTtcblx0XHRcdFx0cC5kaSA9IHAuZHkgPiAwID8gaSA6IGRkTnVtIC0gKGkgKyAxKTtcblx0XHRcdFx0c2kgPSBNYXRoLm1heChzaSwgcC5kaSk7XG5cdFx0XHRcdHBvaW50c1tpXSA9IHA7XG5cdFx0XHR9XG5cblx0XHRcdHZhciBhLCByTWF4MCA9IGRkTnVtICogMC41ICogckluYztcblx0XHRcdGZvciAoaSA9IDA7IGkgPCBkZE51bTsgaSsrKSB7XG5cdFx0XHRcdHAgPSBwb2ludHNbaV07XG5cdFx0XHRcdHAucjEgPSBwLmRpICogckluYyArIHJCYXNlO1xuXHRcdFx0XHRwLnIyID0gckJhc2U7XG5cdFx0XHRcdC8vIHAucjIgPSAoc2kgLSBwLmRpKSAqIHJJbmMgKyByQmFzZTtcblxuXHRcdFx0XHRwLmN4MSA9IHNNaW47XG5cdFx0XHRcdHAuY3gyID0gZE1pbiAtICgoc2kgLSBwLmRpKSAqIHJJbmMpICogcXg7XG5cdFx0XHRcdC8vIHAuY3gyID0gZE1pbjtcblxuXHRcdFx0XHRhID0gKGkgLSAoZGROdW0gLSAxKSAvIDIpICogckluYztcblx0XHRcdFx0cC5jeTEgPSBwLnkxICsgYTtcblx0XHRcdFx0cC5jeTIgPSBwLnkyO1xuXG5cdFx0XHRcdGEgPSBNYXRoLmFicyhhKTtcblx0XHRcdFx0cC5yMCA9IGE7XG5cdFx0XHRcdHAuY3gwID0gcC54MSArIChyTWF4MCAtIGEpICogcXg7XG5cblx0XHRcdFx0dHggPSBjYWxjQXJjSENvbm5lY3RvcihwLmN4MSwgcC5jeTEsIHAucjEsIHAuY3gyLCBwLmN5MiwgcC5yMiwgMC44KTtcblx0XHRcdFx0cC50eDEgPSB0eFswXTtcblx0XHRcdFx0cC50eDIgPSB0eFsxXTtcblxuXHRcdFx0XHQvLyBGaW5kIG91dCBsb25nZXN0IG5vZGUgY29ubmVjdGlvbiBmb3Igc2V0TGluZURhc2hcblx0XHRcdFx0bE1heCA9IE1hdGgubWF4KGxNYXgsIE1hdGguYWJzKHAueDEgLSBwLngyKSArIE1hdGguYWJzKHAuY3kxIC0gcC5jeTIpKTtcblx0XHRcdH1cblx0XHRcdC8vIFNvcnQgYnkgZGlzdGFuY2UgeTEgKG9yaWdpbmFsKSA+IGN5MSAockluYyBvZmZzZXQpIGRpc3RhbmNlXG5cdFx0XHRwb2ludHMuc29ydChmdW5jdGlvbihhLCBiKSB7XG5cdFx0XHRcdC8vIHJldHVybiBNYXRoLmFicyhiLnkxIC0gYi5jeTEpIC0gTWF0aC5hYnMoYS55MSAtIGEuY3kxKTtcblx0XHRcdFx0Ly8gcmV0dXJuIGEucjAgLSBiLnIwO1xuXHRcdFx0XHRyZXR1cm4gYi5kaSAtIGEuZGk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdFx0ZC5wb2ludHMgPSBwb2ludHM7XG5cdFx0ZC5tYXhMZW5ndGggPSBsTWF4O1xuXHRcdGQubWF4TGVuZ3RoID0gcXg7XG5cdH0sICovXG5cbn0pO1xuXG5pZiAoREVCVUcpIHtcblx0R3JhcGhWaWV3LnByb3RvdHlwZS5fc2tpcExvZyA9IGZhbHNlO1xuXG5cdHZhciBkZWJvdW5jZWRMb2cgPSBfLmRlYm91bmNlKF8uYmluZChjb25zb2xlLmxvZywgY29uc29sZSksIDUwMCwgdHJ1ZSk7XG5cdHZhciBhcHBseU1ldGhvZCA9IGZ1bmN0aW9uKGNvbnRleHQsIGFyZ3MpIHtcblx0XHRyZXR1cm4gQXJyYXkucHJvdG90eXBlLnNoaWZ0LmFwcGx5KGFyZ3MpLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuXHR9XG5cdGlmICghR3JhcGhWaWV3LnByb3RvdHlwZS5fc2tpcExvZykge1xuXHRcdC8vIEdyYXBoVmlldy5wcm90b3R5cGUuX3JlcXVlc3RSZW5kZXIgPSBfLndyYXAoQ2FudmFzVmlldy5wcm90b3R5cGUuX3JlcXVlc3RSZW5kZXIsIGZ1bmN0aW9uKGZuKSB7XG5cdFx0Ly8gXHRkZWJvdW5jZWRMb2coXCIlczo6X3JlcXVlc3RSZW5kZXJcIiwgdGhpcy5jaWQpO1xuXHRcdC8vIFx0cmV0dXJuIGFwcGx5TWV0aG9kKHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0Ly8gfSk7XG5cdFx0R3JhcGhWaWV3LnByb3RvdHlwZS5fYXBwbHlSZW5kZXIgPSBfLndyYXAoQ2FudmFzVmlldy5wcm90b3R5cGUuX2FwcGx5UmVuZGVyLCBmdW5jdGlvbihmbikge1xuXHRcdFx0dGhpcy5fc2tpcExvZyA9IHRydWU7XG5cdFx0XHRkZWJvdW5jZWRMb2coXCIlczo6X2FwcGx5UmVuZGVyIFtkZWJvdW5jZWRdXCIsIHRoaXMuY2lkKTtcblx0XHRcdHZhciByZXR2YWwgPSBhcHBseU1ldGhvZCh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0dGhpcy5fc2tpcExvZyA9IGZhbHNlO1xuXHRcdFx0cmV0dXJuIHJldHZhbDtcblxuXHRcdH0pO1xuXHR9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gR3JhcGhWaWV3OyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9jb21wb25lbnQvR3JvdXBpbmdMaXN0Vmlld1xuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZS5iYWJ5c2l0dGVyfSAqL1xuLy8gdmFyIENvbnRhaW5lciA9IHJlcXVpcmUoXCJiYWNrYm9uZS5iYWJ5c2l0dGVyXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xuLy8gdmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0ZpbHRlcmFibGVMaXN0Vmlld30gKi9cbnZhciBGaWx0ZXJhYmxlTGlzdFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L0ZpbHRlcmFibGVMaXN0Vmlld1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9DbGlja2FibGVSZW5kZXJlcn0gKi9cbnZhciBDbGlja2FibGVSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXJcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvTGFiZWxSZW5kZXJlcn0gKi9cbnZhciBMYWJlbFJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9MYWJlbFJlbmRlcmVyXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvR3JvdXBpbmdMaXN0Vmlld31cbiAqL1xudmFyIEdyb3VwaW5nTGlzdFZpZXcgPSBGaWx0ZXJhYmxlTGlzdFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcImdyb3VwaW5nTGlzdFwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJkbFwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImdyb3VwZWRcIixcblxuXHQvKiogQHR5cGUge0Z1bmN0aW9ufG51bGx9IGVtcHR5IGFycmF5ICovXG5cdF9ncm91cGluZ0ZuOiBudWxsLCAvL2Z1bmN0aW9uKCkgeyByZXR1cm4gbnVsbDsgfSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGRlZmF1bHRzOiBfLmRlZmF1bHRzKHtcblx0XHQvLyBkZWZhdWx0czoge1xuXHRcdHJlbmRlcmVyOiBDbGlja2FibGVSZW5kZXJlci5leHRlbmQoe1xuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0Y2lkUHJlZml4OiBcImdyb3VwaW5nTGlzdEl0ZW1cIixcblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdHRhZ05hbWU6IFwiZGxcIixcblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGNsYXNzTmFtZTogXCJsaXN0LWl0ZW0gbGlzdC1sYWJlbFwiLFxuXHRcdH0pLFxuXHRcdGdyb3VwaW5nUmVuZGVyZXI6IExhYmVsUmVuZGVyZXIuZXh0ZW5kKHtcblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGNpZFByZWZpeDogXCJncm91cGluZ0xpc3RHcm91cFwiLFxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0dGFnTmFtZTogXCJkdFwiLFxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0Y2xhc3NOYW1lOiBcImxpc3QtZ3JvdXAgbGlzdC1sYWJlbFwiLFxuXHRcdH0pLFxuXHRcdGdyb3VwaW5nRm46IG51bGwsXG5cdFx0Ly8gfSxcblx0fSwgRmlsdGVyYWJsZUxpc3RWaWV3LnByb3RvdHlwZS5kZWZhdWx0cyksXG5cblx0cHJvcGVydGllczoge1xuXHRcdGdyb3Vwczoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2dyb3Vwcztcblx0XHRcdH1cblx0XHR9LFxuXHRcdGZpbHRlcmVkR3JvdXBzOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZmlsdGVyZWRHcm91cHM7XG5cdFx0XHR9XG5cdFx0fSxcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRGaWx0ZXJhYmxlTGlzdFZpZXcucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdHRoaXMuX2dyb3VwcyA9IFtdO1xuXHRcdHRoaXMuX2ZpbHRlcmVkR3JvdXBzID0gW107XG5cblx0XHR0aGlzLl9ncm91cHNCeUl0ZW1DaWQgPSB7fTtcblx0XHR0aGlzLl9ncm91cGluZ0ZuID0gb3B0aW9ucy5ncm91cGluZ0ZuO1xuXHRcdHRoaXMuZ3JvdXBpbmdSZW5kZXJlciA9IG9wdGlvbnMuZ3JvdXBpbmdSZW5kZXJlcjtcblxuXHRcdHRoaXMuX3JlZnJlc2hHcm91cHMoKTtcblx0XHRpZiAodGhpcy5fZ3JvdXBpbmdGbikge1xuXHRcdFx0dGhpcy5fZ3JvdXBzLmZvckVhY2godGhpcy5jcmVhdGVHcm91cGluZ1ZpZXcsIHRoaXMpO1xuXHRcdH1cblx0fSxcblxuXHRfcmVmcmVzaEdyb3VwczogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gdGhpcy5fZ3JvdXBzID0gXy51bmlxKHRoaXMuY29sbGVjdGlvbi5tYXAodGhpcy5fZ3JvdXBpbmdGbiwgdGhpcykpO1xuXHRcdHRoaXMuX2dyb3Vwcy5sZW5ndGggPSAwO1xuXHRcdC8vIHRoaXMuX2dyb3VwSXRlbXMubGVuZ3RoID0gMDtcblx0XHRpZiAodGhpcy5fZ3JvdXBpbmdGbikge1xuXHRcdFx0dGhpcy5jb2xsZWN0aW9uLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0XHR2YXIgZ0lkeCwgZ09iaiA9IHRoaXMuX2dyb3VwaW5nRm4uYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcblx0XHRcdFx0aWYgKGdPYmopIHtcblx0XHRcdFx0XHRnSWR4ID0gdGhpcy5fZ3JvdXBzLmluZGV4T2YoZ09iaik7XG5cdFx0XHRcdFx0aWYgKGdJZHggPT0gLTEpIHtcblx0XHRcdFx0XHRcdGdJZHggPSB0aGlzLl9ncm91cHMubGVuZ3RoO1xuXHRcdFx0XHRcdFx0dGhpcy5fZ3JvdXBzW2dJZHhdID0gZ09iajtcblx0XHRcdFx0XHRcdC8vIHRoaXMuX2dyb3VwSXRlbXNbZ0lkeF0gPSBbXTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Ly8gdGhpcy5fZ3JvdXBJdGVtc1tnSWR4XS5wdXNoKGl0ZW0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuX2dyb3Vwc0J5SXRlbUNpZFtpdGVtLmNpZF0gPSBnT2JqO1xuXHRcdFx0fSwgdGhpcyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY29sbGVjdGlvbi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRcdFx0dGhpcy5fZ3JvdXBzQnlJdGVtQ2lkW2l0ZW0uY2lkXSA9IG51bGw7XG5cdFx0XHR9LCB0aGlzKTtcblx0XHR9XG5cdH0sXG5cblx0cmVuZGVyRmlsdGVyRm46IGZ1bmN0aW9uKCkge1xuXHRcdEZpbHRlcmFibGVMaXN0Vmlldy5wcm90b3R5cGUucmVuZGVyRmlsdGVyRm4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdGlmICh0aGlzLl9ncm91cGluZ0ZuKSB7XG5cdFx0XHRpZiAodGhpcy5fZmlsdGVyZWRJdGVtcy5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHR0aGlzLl9maWx0ZXJlZEdyb3VwcyA9IFtdO1xuXHRcdFx0XHR0aGlzLl9ncm91cHMuZm9yRWFjaChmdW5jdGlvbihncm91cCkge1xuXHRcdFx0XHRcdHRoaXMuaXRlbVZpZXdzLmZpbmRCeU1vZGVsKGdyb3VwKS5lbC5jbGFzc0xpc3QucmVtb3ZlKFwiZXhjbHVkZWRcIik7XG5cdFx0XHRcdH0sIHRoaXMpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5fZmlsdGVyZWRHcm91cHMgPSBfLnVuaXEodGhpcy5fZmlsdGVyZWRJdGVtcy5tYXAoZnVuY3Rpb24oaXRlbSkge1xuXHRcdFx0XHRcdHJldHVybiB0aGlzLl9ncm91cHNCeUl0ZW1DaWRbaXRlbS5jaWRdO1xuXHRcdFx0XHR9LCB0aGlzKSk7XG5cdFx0XHRcdHRoaXMuX2dyb3Vwcy5mb3JFYWNoKGZ1bmN0aW9uKGdyb3VwKSB7XG5cdFx0XHRcdFx0dGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoZ3JvdXApLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJleGNsdWRlZFwiLCB0aGlzLl9maWx0ZXJlZEdyb3Vwcy5pbmRleE9mKGdyb3VwKSA9PSAtMSk7XG5cdFx0XHRcdH0sIHRoaXMpO1xuXHRcdFx0fVxuXHRcdFx0Ly8gdGhpcy5fZ3JvdXBzRXhjbHVzaW9uSW5kZXggPSB0aGlzLl9ncm91cHMubWFwKGZ1bmN0aW9uIChncm91cCkge1xuXHRcdFx0Ly8gXHRyZXR1cm4gZ3JvdXBzLmluZGV4T2YoZ3JvdXApID09IC0xKTtcblx0XHRcdC8vIH0sIHRoaXMpO1xuXHRcdH1cblx0fSxcblxuXHQvKiogQHByaXZhdGUgQ3JlYXRlIGNoaWxkcmVuIHZpZXdzICovXG5cdGNyZWF0ZUdyb3VwaW5nVmlldzogZnVuY3Rpb24oaXRlbSkge1xuXHRcdHZhciB2aWV3ID0gbmV3IHRoaXMuZ3JvdXBpbmdSZW5kZXJlcih7XG5cdFx0XHRtb2RlbDogaXRlbSxcblx0XHRcdGVsOiB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIubGlzdC1ncm91cFtkYXRhLWlkPVxcXCJcIiArIGl0ZW0uaWQgKyBcIlxcXCJdXCIpXG5cdFx0fSk7XG5cdFx0dGhpcy5pdGVtVmlld3MuYWRkKHZpZXcpO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIEZpbHRlciAyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIGNvbXB1dGVGaWx0ZXJlZDogZnVuY3Rpb24oKSB7XG5cdC8vIFx0RmlsdGVyYWJsZUxpc3RWaWV3LnByb3RvdHlwZS5jb21wdXRlRmlsdGVyZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0Ly8gfSxcblx0Ly9cblx0Ly8gcmVuZGVyRmlsdGVyZWQ6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdEZpbHRlcmFibGVMaXN0Vmlldy5wcm90b3R5cGUucmVuZGVyRmlsdGVyZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0Ly8gfSxcblxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gR3JvdXBpbmdMaXN0VmlldzsiLCIvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvcHJvZ3Jlc3MvQ2FudmFzUHJvZ3Jlc3NNZXRlcn0gKi9cbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9wcm9ncmVzcy9DYW52YXNQcm9ncmVzc01ldGVyM1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9wcm9ncmVzcy9TVkdQYXRoUHJvZ3Jlc3NNZXRlcn0gKi9cbi8vIG1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9wcm9ncmVzcy9TVkdQYXRoUHJvZ3Jlc3NNZXRlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9wcm9ncmVzcy9TVkdDaXJjbGVQcm9ncmVzc01ldGVyfSAqL1xuLy8gbW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL1NWR0NpcmNsZVByb2dyZXNzTWV0ZXJcIik7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L1NlbGVjdGFibGVMaXN0Vmlld1xuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG4vLyB2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZS5iYWJ5c2l0dGVyfSAqL1xudmFyIENvbnRhaW5lciA9IHJlcXVpcmUoXCJiYWNrYm9uZS5iYWJ5c2l0dGVyXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xudmFyIFZpZXcgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvY29tcG9uZW50L0RlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXJ9ICovXG52YXIgRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9DbGlja2FibGVSZW5kZXJlcn0gKi9cbnZhciBDbGlja2FibGVSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXJcIik7XG5cbnZhciBTZWxlY3RhYmxlTGlzdFZpZXcgPSBWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJzZWxlY3RhYmxlTGlzdFwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJ1bFwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImxpc3Qgc2VsZWN0YWJsZVwiLFxuXG5cdC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9EZWZhdWx0U2VsZWN0YWJsZVJlbmRlcmVyfSAqL1xuXHRyZW5kZXJlcjogRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlcixcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHR0aGlzLl9lbmFibGVkID0gdHJ1ZTtcblx0XHR0aGlzLl9jaGlsZHJlbkludmFsaWQgPSB0cnVlO1xuXG5cdFx0b3B0aW9ucy5yZW5kZXJlciAmJiAodGhpcy5yZW5kZXJlciA9IG9wdGlvbnMucmVuZGVyZXIpO1xuXHRcdHRoaXMuc2hvd0VtcHR5ID0gISFvcHRpb25zLnNob3dFbXB0eTtcblx0XHR0aGlzLml0ZW1WaWV3cyA9IG5ldyBDb250YWluZXIoKTtcblxuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5jb2xsZWN0aW9uLCBcImFkZCByZW1vdmUgcmVzZXRcIiwgdGhpcy5fb25Db2xsZWN0aW9uQ2hhbmdlKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbW92ZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5yZW1vdmVDaGlsZHJlbigpO1xuXHRcdFZpZXcucHJvdG90eXBlLnJlbW92ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdF9vbkNvbGxlY3Rpb25DaGFuZ2U6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0dGhpcy5fY2hpbGRyZW5JbnZhbGlkID0gdHJ1ZTtcblx0XHR0aGlzLnJlbmRlcigpO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fY2hpbGRyZW5JbnZhbGlkKSB7XG5cdFx0XHR0aGlzLl9jaGlsZHJlbkludmFsaWQgPSBmYWxzZTtcblx0XHRcdHRoaXMuY3JlYXRlQ2hpbGRyZW4oKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRzZXRFbmFibGVkOiBmdW5jdGlvbihlbmFibGVkKSB7XG5cdFx0aWYgKHRoaXMuX2VuYWJsZWQgIT09IGVuYWJsZWQpIHtcblx0XHRcdHRoaXMuX2VuYWJsZWQgPSBlbmFibGVkO1xuXHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiZGlzYWJsZWRcIiwgIXRoaXMuX2VuYWJsZWQpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBDaGlsZCB2aWV3c1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRjcmVhdGVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGVsdEJ1ZmZlciwgdmlldztcblxuXHRcdHRoaXMucmVtb3ZlQ2hpbGRyZW4oKTtcblx0XHR0aGlzLmVsLmlubmVySFRNTCA9IFwiXCI7XG5cblx0XHRpZiAodGhpcy5jb2xsZWN0aW9uLmxlbmd0aCkge1xuXHRcdFx0ZWx0QnVmZmVyID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXHRcdFx0aWYgKHRoaXMuc2hvd0VtcHR5KSB7XG5cdFx0XHRcdHZpZXcgPSB0aGlzLmNyZWF0ZUVtcHR5VmlldygpO1xuXHRcdFx0XHRlbHRCdWZmZXIuYXBwZW5kQ2hpbGQodmlldy5yZW5kZXIoKS5lbCk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLmNvbGxlY3Rpb24uZWFjaChmdW5jdGlvbihtb2RlbCwgaW5kZXgsIGFycikge1xuXHRcdFx0XHR2aWV3ID0gdGhpcy5jcmVhdGVJdGVtVmlldyhtb2RlbCwgaW5kZXgpO1xuXHRcdFx0XHRlbHRCdWZmZXIuYXBwZW5kQ2hpbGQodmlldy5yZW5kZXIoKS5lbCk7XG5cdFx0XHR9LCB0aGlzKTtcblx0XHRcdHRoaXMuZWwuYXBwZW5kQ2hpbGQoZWx0QnVmZmVyKTtcblx0XHR9XG5cdH0sXG5cblx0Y3JlYXRlSXRlbVZpZXc6IGZ1bmN0aW9uKG1vZGVsLCBpbmRleCkge1xuXHRcdHZhciB2aWV3ID0gbmV3KHRoaXMucmVuZGVyZXIpKHtcblx0XHRcdG1vZGVsOiBtb2RlbFxuXHRcdH0pO1xuXHRcdHRoaXMuaXRlbVZpZXdzLmFkZCh2aWV3KTtcblx0XHR0aGlzLmxpc3RlblRvKHZpZXcsIFwicmVuZGVyZXI6Y2xpY2tcIiwgdGhpcy5vbkl0ZW1WaWV3Q2xpY2spO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdHJlbW92ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLml0ZW1WaWV3cy5lYWNoKHRoaXMucmVtb3ZlSXRlbVZpZXcsIHRoaXMpO1xuXHR9LFxuXG5cdHJlbW92ZUl0ZW1WaWV3OiBmdW5jdGlvbih2aWV3KSB7XG5cdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHZpZXcpO1xuXHRcdHRoaXMuaXRlbVZpZXdzLnJlbW92ZSh2aWV3KTtcblx0XHR2aWV3LnJlbW92ZSgpO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIENoaWxkIGV2ZW50IGhhbmRsZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAcHJpdmF0ZSAqL1xuXHRvbkl0ZW1WaWV3Q2xpY2s6IGZ1bmN0aW9uKGl0ZW0pIHtcblx0XHRpZiAodGhpcy5jb2xsZWN0aW9uLnNlbGVjdGVkICE9PSBpdGVtICYmIHRoaXMuX2VuYWJsZWQpIHtcblx0XHRcdHRoaXMudHJpZ2dlcihcInZpZXc6c2VsZWN0Om9uZVwiLCBpdGVtKTtcblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogRW1wdHkgdmlld1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRjcmVhdGVFbXB0eVZpZXc6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB2aWV3ID0gbmV3IFNlbGVjdGFibGVMaXN0Vmlldy5FbXB0eVJlbmRlcmVyKHtcblx0XHRcdG1vZGVsOiB0aGlzLmNvbGxlY3Rpb25cblx0XHR9KTtcblx0XHR0aGlzLml0ZW1WaWV3cy5hZGQodmlldyk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh2aWV3LCBcInJlbmRlcmVyOmNsaWNrXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5fZW5hYmxlZCAmJiB0aGlzLnRyaWdnZXIoXCJ2aWV3OnNlbGVjdDpub25lXCIpO1xuXHRcdH0pO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxufSwge1xuXHRFbXB0eVJlbmRlcmVyOiBDbGlja2FibGVSZW5kZXJlci5leHRlbmQoe1xuXG5cdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdHRhZ05hbWU6IFwibGlcIixcblx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0Y2xhc3NOYW1lOiBcImxpc3QtaXRlbSBlbXB0eS1pdGVtXCIsXG5cblx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkIGRlc2VsZWN0ZWRcIiwgdGhpcy5yZW5kZXJDbGFzc0xpc3QpO1xuXHRcdFx0dGhpcy5yZW5kZXJDbGFzc0xpc3QoKTtcblx0XHR9LFxuXG5cdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0XHR0aGlzLmVsLmlubmVySFRNTCA9IFwiPGEgaHJlZj1cXFwiI2NsZWFyXFxcIj48Yj4gPC9iPjwvYT5cIjtcblx0XHRcdHRoaXMucmVuZGVyQ2xhc3NMaXN0KCk7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9LFxuXG5cdFx0cmVuZGVyQ2xhc3NMaXN0OiBmdW5jdGlvbigpIHtcblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcInNlbGVjdGVkXCIsIHRoaXMubW9kZWwuc2VsZWN0ZWRJbmRleCA9PT0gLTEpO1xuXHRcdH0sXG5cdH0pXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBTZWxlY3RhYmxlTGlzdFZpZXc7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L3Byb2dyZXNzL0NhbnZhc1Byb2dyZXNzTWV0ZXJcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbi8vIHZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL0NhbnZhc1ZpZXd9ICovXG52YXIgQ2FudmFzVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL0NhbnZhc1ZpZXdcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL0ludGVycG9sYXRvcn0gKi9cbi8vIHZhciBJbnRlcnBvbGF0b3IgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9JbnRlcnBvbGF0b3JcIik7XG5cbi8vIHZhciBBUkNfRVJSID0gMC4wMDAwMTtcbi8vIHZhciBBUkNfRVJSID0gMC4wO1xuLy8gdmFyIFBJID0gTWF0aC5QSTtcbnZhciBQSTIgPSBNYXRoLlBJICogMjtcblxudmFyIEdBUF9BUkMgPSBQSTIgLyA0ODtcbi8vIHZhciBDQVBfU0NBTEUgPSAyOyAvLyBjYXAgYXJjID0gR0FQX0FSQyAqIENBUF9TQ0FMRVxuLy8gdmFyIFdBSVRfQ1lDTEVfVkFMVUUgPSAxO1xuLy8gdmFyIFdBSVRfQ1lDTEVfTVMgPSAzMDA7IC8vIG1pbGxpc2Vjb25kcyBwZXIgaW50ZXJwb2xhdGlvbiBsb29wXG5cbnZhciBBUkNfREVGQVVMVFMgPSB7XG5cdFwiYW1vdW50XCI6IHtcblx0XHRsaW5lV2lkdGg6IDAuOCxcblx0XHRyYWRpdXNPZmZzZXQ6IDBcblx0fSxcblx0XCJub3QtYXZhaWxhYmxlXCI6IHtcblx0XHRsaW5lV2lkdGg6IDEuMCxcblx0XHRsaW5lRGFzaDogWzAuMywgMC43XVxuXHR9LFxuXHRcImF2YWlsYWJsZVwiOiB7XG5cdFx0bGluZVdpZHRoOiAwLjgsXG5cdFx0aW52ZXJzZTogXCJub3QtYXZhaWxhYmxlXCJcblx0fSxcbn07XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9wcm9ncmVzcy9DYW52YXNQcm9ncmVzc01ldGVyfVxuICovXG52YXIgQ2FudmFzUHJvZ3Jlc3NNZXRlciA9IENhbnZhc1ZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcImNhbnZhc1Byb2dyZXNzTWV0ZXJcIixcblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNsYXNzTmFtZTogXCJwcm9ncmVzcy1tZXRlciBjYW52YXMtcHJvZ3Jlc3MtbWV0ZXJcIixcblxuXHRkZWZhdWx0S2V5OiBcImFtb3VudFwiLFxuXG5cdGRlZmF1bHRzOiB7XG5cdFx0dmFsdWVzOiB7XG5cdFx0XHRhbW91bnQ6IDAsXG5cdFx0XHRhdmFpbGFibGU6IDAsXG5cdFx0XHRfbG9vcDogMCxcblx0XHR9LFxuXHRcdG1heFZhbHVlczoge1xuXHRcdFx0YW1vdW50OiAxLFxuXHRcdFx0YXZhaWxhYmxlOiAxLFxuXHRcdH0sXG5cdFx0dXNlT3BhcXVlOiB0cnVlLFxuXHRcdGxhYmVsRm46IGZ1bmN0aW9uKHZhbHVlLCBtYXgpIHtcblx0XHRcdHJldHVybiAoKHZhbHVlIC8gbWF4KSAqIDEwMCkgfCAwO1xuXHRcdH0sXG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogY2hpbGRyZW4vbGF5b3V0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdC8vIFRPRE86IGNsZWFudXAgb3B0aW9ucyBtZXNzIGluIENhbnZhc1ZpZXdcblx0XHRDYW52YXNWaWV3LnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0Ly8gb3B0aW9ucyA9IF8uZGVmYXVsdHMob3B0aW9ucywgdGhpcy5kZWZhdWx0cyk7XG5cblx0XHR0aGlzLl9sYWJlbEZuID0gb3B0aW9ucy5sYWJlbEZuO1xuXHRcdHRoaXMuX3ZhbHVlU3R5bGVzID0ge307XG5cdFx0dGhpcy5fY2FudmFzU2l6ZSA9IG51bGw7XG5cdFx0dGhpcy5fY2FudmFzT3JpZ2luID0gbnVsbDtcblx0fSxcblxuXHRtZWFzdXJlQ2FudmFzOiBmdW5jdGlvbih3LCBoKSB7XG5cdFx0dGhpcy5fY2FudmFzSGVpZ2h0ID0gdGhpcy5fY2FudmFzV2lkdGggPSBNYXRoLm1pbih0aGlzLl9jYW52YXNXaWR0aCwgdGhpcy5fY2FudmFzSGVpZ2h0KTtcblx0fSxcblxuXHRfdXBkYXRlQ2FudmFzOiBmdW5jdGlvbigpIHtcblx0XHRDYW52YXNWaWV3LnByb3RvdHlwZS5fdXBkYXRlQ2FudmFzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHQvLyBzaXplLCBsaW5lcywgZ2FwcywgZGFzaGVzICh0aGlzLl92YWx1ZVN0eWxlcywgR0FQX0FSQywgdGhpcy5fYXJjUmFkaXVzKVxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIGFyY05hbWUsIGFyY09iaiwgYXJjRGVmYXVsdDtcblx0XHR2YXIgbWFwTGluZURhc2ggPSBmdW5jdGlvbihuKSB7XG5cdFx0XHRyZXR1cm4gbiAqIHRoaXMucmFkaXVzICogR0FQX0FSQztcblx0XHR9O1xuXHRcdHZhciBzdW1GbiA9IGZ1bmN0aW9uKHMsIG4pIHtcblx0XHRcdHJldHVybiBzICsgbjtcblx0XHR9O1xuXG5cdFx0dGhpcy5fY2FudmFzU2l6ZSA9IE1hdGgubWluKHRoaXMuX2NhbnZhc1dpZHRoLCB0aGlzLl9jYW52YXNIZWlnaHQpOyAvLyAvIHRoaXMuX2NhbnZhc1JhdGlvO1xuXHRcdHRoaXMuX21heERhc2hBcmMgPSAwO1xuXG5cdFx0Zm9yIChhcmNOYW1lIGluIEFSQ19ERUZBVUxUUykge1xuXHRcdFx0YXJjRGVmYXVsdCA9IEFSQ19ERUZBVUxUU1thcmNOYW1lXTtcblx0XHRcdGFyY09iaiA9IHRoaXMuX3ZhbHVlU3R5bGVzW2FyY05hbWVdID0ge307XG5cdFx0XHRhcmNPYmouaW52ZXJzZSA9IGFyY0RlZmF1bHQuaW52ZXJzZTsgLy8gY29weSBpbnZlcnNlIGtleVxuXHRcdFx0Ly8gYXJjT2JqLmludmVyc2UyID0gYXJjRGVmYXVsdC5pbnZlcnNlMjtcblx0XHRcdGFyY09iai5saW5lV2lkdGggPSBhcmNEZWZhdWx0LmxpbmVXaWR0aCAqIHRoaXMuX2NhbnZhc1JhdGlvO1xuXHRcdFx0YXJjT2JqLnJhZGl1cyA9ICh0aGlzLl9jYW52YXNTaXplIC0gYXJjT2JqLmxpbmVXaWR0aCkgLyAyO1xuXHRcdFx0aWYgKGFyY0RlZmF1bHQucmFkaXVzT2Zmc2V0KSB7XG5cdFx0XHRcdGFyY09iai5yYWRpdXMgKz0gYXJjRGVmYXVsdC5yYWRpdXNPZmZzZXQgKiB0aGlzLl9jYW52YXNSYXRpbztcblx0XHRcdH1cblx0XHRcdGlmIChhcmNEZWZhdWx0LmxpbmVEYXNoICYmIGFyY0RlZmF1bHQubGluZURhc2gubGVuZ3RoKSB7XG5cdFx0XHRcdGFyY09iai5saW5lRGFzaCA9IGFyY0RlZmF1bHQubGluZURhc2gubWFwKG1hcExpbmVEYXNoLCBhcmNPYmopO1xuXHRcdFx0XHRhcmNPYmoubGluZURhc2hBcmMgPSBhcmNEZWZhdWx0LmxpbmVEYXNoWzBdICogR0FQX0FSQztcblx0XHRcdFx0YXJjT2JqLmxpbmVEYXNoTGVuZ3RoID0gYXJjT2JqLmxpbmVEYXNoLnJlZHVjZShzdW1Gbik7XG5cdFx0XHRcdHRoaXMuX21heERhc2hBcmMgPSBNYXRoLm1heCh0aGlzLl9tYXhEYXNoQXJjLCBhcmNPYmoubGluZURhc2hBcmMpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YXJjT2JqLmxpbmVEYXNoQXJjID0gMDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBiYXNlbGluZVNoaWZ0XG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvLyBOT1RFOiBDZW50ZXIgYmFzZWxpbmU6IHVzZSBhc2NlbnQgZGF0YSB0byBjZW50ZXIgdG8geC1oZWlnaHQsIG9yIHNvcnQtb2YuXG5cdFx0Ly8gd2l0aCBhc2NlbnQvZGVzY2VudCB2YWx1ZXMgKDAuNywgLTAuMyksIHgtaGVpZ2h0IGlzIDAuNFxuXHRcdHZhciBtT2JqID0gdGhpcy5fZ2V0Rm9udE1ldHJpY3ModGhpcy5fZm9udEZhbWlseSk7XG5cdFx0dGhpcy5fYmFzZWxpbmVTaGlmdCA9IG1PYmogPyAobU9iai5hc2NlbnQgKyBtT2JqLmRlc2NlbnQpIC8gbU9iai51bml0c1BlckVtIDogMC43OyAvLyBkZWZhdWx0IHZhbHVlXG5cdFx0dGhpcy5fYmFzZWxpbmVTaGlmdCAqPSB0aGlzLl9mb250U2l6ZSAqIDAuNTsgLy8gYXBwbHkgdG8gZm9udC1zaXplLCBoYWx2ZSBpdFxuXHRcdHRoaXMuX2Jhc2VsaW5lU2hpZnQgPSBNYXRoLnJvdW5kKHRoaXMuX2Jhc2VsaW5lU2hpZnQpO1xuXG5cdFx0Ly8gc2F2ZSBjYW52YXMgY29udGV4dFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ly8gcmVzZXQgbWF0cml4IGFuZCB0cmFuc2xhdGUgMCwwIHRvIGNlbnRlclxuXHRcdHRoaXMuX2N0eC5yZXN0b3JlKCk7XG5cdFx0dGhpcy5fY3R4LnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCB0aGlzLl9jYW52YXNXaWR0aCAvIDIsIHRoaXMuX2NhbnZhc0hlaWdodCAvIDIpO1xuXHRcdHRoaXMuX2N0eC5zYXZlKCk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogcHJpdmF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlZHJhdzogZnVuY3Rpb24oY29udGV4dCwgaW50ZXJwb2xhdG9yKSB7XG5cdFx0dGhpcy5fY2xlYXJDYW52YXMoLXRoaXMuX2NhbnZhc1dpZHRoIC8gMiwgLXRoaXMuX2NhbnZhc0hlaWdodCAvIDIsIHRoaXMuX2NhbnZhc1dpZHRoLCB0aGlzLl9jYW52YXNIZWlnaHQpO1xuXG5cdFx0dmFyIGxvb3BWYWx1ZSA9IGludGVycG9sYXRvci5fdmFsdWVEYXRhW1wiX2xvb3BcIl0uX3JlbmRlcmVkVmFsdWUgfHwgMDtcblx0XHR2YXIgYW1vdW50RGF0YSA9IGludGVycG9sYXRvci5fdmFsdWVEYXRhW1wiYW1vdW50XCJdO1xuXHRcdHZhciBhdmFpbGFibGVEYXRhID0gaW50ZXJwb2xhdG9yLl92YWx1ZURhdGFbXCJhdmFpbGFibGVcIl07XG5cblx0XHR2YXIgYW1vdW50U3R5bGUgPSB0aGlzLl92YWx1ZVN0eWxlc1tcImFtb3VudFwiXTtcblx0XHR2YXIgYXZhaWxhYmxlU3R5bGUgPSB0aGlzLl92YWx1ZVN0eWxlc1tcImF2YWlsYWJsZVwiXTtcblxuXHRcdC8vIGFtb3VudCBsYWJlbFxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dGhpcy5kcmF3TGFiZWwodGhpcy5fbGFiZWxGbihhbW91bnREYXRhLl9yZW5kZXJlZFZhbHVlLCBhbW91bnREYXRhLl9tYXhWYWwpKTtcblxuXHRcdC8vIHNhdmUgY3R4IGJlZm9yZSBkcmF3aW5nIGFyY3Ncblx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXG5cdFx0Ly8gbG9vcCByb3RhdGlvblxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ly8gaWYgKGludGVycG9sYXRvci5yZW5kZXJlZEtleXMgJiYgKGludGVycG9sYXRvci5yZW5kZXJlZEtleXMuaW5kZXhPZihcImFtb3VudFwiKSAhPT0gLTEpKSB7XG5cdFx0Ly8gXHRjb25zb2xlLmxvZyhcIiVzOjpyZWRyYXcgKF9sb29wKSBtYXg6ICVzIGxhc3Q6ICVzIGN1cnI6ICVzXCIsIHRoaXMuY2lkLFxuXHRcdC8vIFx0XHRhbW91bnREYXRhLl9tYXhWYWwsXG5cdFx0Ly8gXHRcdGFtb3VudERhdGEuX2xhc3RSZW5kZXJlZFZhbHVlLFxuXHRcdC8vIFx0XHRhbW91bnREYXRhLl9yZW5kZXJlZFZhbHVlXG5cdFx0Ly8gXHQpO1xuXHRcdC8vIH1cblx0XHRpZiAoaW50ZXJwb2xhdG9yLnJlbmRlcmVkS2V5cyAmJiAoaW50ZXJwb2xhdG9yLnJlbmRlcmVkS2V5cy5pbmRleE9mKFwiYW1vdW50XCIpICE9PSAtMSkgJiYgKGFtb3VudERhdGEuX2xhc3RSZW5kZXJlZFZhbHVlID4gYW1vdW50RGF0YS5fcmVuZGVyZWRWYWx1ZSkpIHtcblx0XHRcdC8vIHRyaWdnZXIgbG9vcFxuXHRcdFx0aW50ZXJwb2xhdG9yLnZhbHVlVG8oMSwgMCwgXCJfbG9vcFwiKTtcblx0XHRcdGludGVycG9sYXRvci52YWx1ZVRvKDAsIDc1MCwgXCJfbG9vcFwiKTtcblx0XHRcdGludGVycG9sYXRvci51cGRhdGVWYWx1ZShcIl9sb29wXCIpO1xuXHRcdH1cblx0XHR0aGlzLl9jdHgucm90YXRlKFBJMiAqICgoMSAtIGxvb3BWYWx1ZSkgLSAwLjI1KSk7XG5cblx0XHQvLyBhbW91bnQgYXJjXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR2YXIgYW1vdW50R2FwQXJjID0gR0FQX0FSQztcblx0XHR2YXIgYW1vdW50RW5kQXJjID0gMDtcblx0XHR2YXIgYW1vdW50VmFsdWUgPSBsb29wVmFsdWUgKyBhbW91bnREYXRhLl9yZW5kZXJlZFZhbHVlIC8gYW1vdW50RGF0YS5fbWF4VmFsO1xuXG5cdFx0aWYgKGFtb3VudFZhbHVlID4gMCkge1xuXHRcdFx0YW1vdW50RW5kQXJjID0gdGhpcy5kcmF3QXJjKGFtb3VudFN0eWxlLCBhbW91bnRWYWx1ZSwgYW1vdW50R2FwQXJjLCBQSTIgLSBhbW91bnRHYXBBcmMpO1xuXHRcdFx0dGhpcy5kcmF3RW5kQ2FwKGFtb3VudFN0eWxlLCBhbW91bnRFbmRBcmMpO1xuXHRcdFx0YW1vdW50RW5kQXJjID0gYW1vdW50RW5kQXJjICsgYW1vdW50R2FwQXJjICogMjtcblx0XHR9XG5cblx0XHQvLyBhdmFpbGFibGUgYXJjXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR2YXIgc3RlcHNOdW0gPSBhdmFpbGFibGVEYXRhLmxlbmd0aCB8fCAxO1xuXHRcdHZhciBzdGVwQmFzZUFyYyA9IFBJMiAvIHN0ZXBzTnVtO1xuXHRcdHZhciBzdGVwQWRqdXN0QXJjID0gc3RlcEJhc2VBcmMgJSBHQVBfQVJDO1xuXHRcdHZhciBzdGVwR2FwQXJjID0gR0FQX0FSQyArIChzdGVwQWRqdXN0QXJjIC0gYXZhaWxhYmxlU3R5bGUubGluZURhc2hBcmMpIC8gMjtcblxuXHRcdGlmIChBcnJheS5pc0FycmF5KGF2YWlsYWJsZURhdGEpKSB7XG5cdFx0XHRmb3IgKHZhciBvLCBpID0gMDsgaSA8IHN0ZXBzTnVtOyBpKyspIHtcblx0XHRcdFx0byA9IGF2YWlsYWJsZURhdGFbaV07XG5cdFx0XHRcdHRoaXMuZHJhd0FyYyhhdmFpbGFibGVTdHlsZSwgby5fcmVuZGVyZWRWYWx1ZSAvIChvLl9tYXhWYWwgLyBzdGVwc051bSksIChpICogc3RlcEJhc2VBcmMpICsgc3RlcEdhcEFyYywgKChpICsgMSkgKiBzdGVwQmFzZUFyYykgLSBzdGVwR2FwQXJjLCBhbW91bnRFbmRBcmMpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmRyYXdBcmMoYXZhaWxhYmxlU3R5bGUsIGF2YWlsYWJsZURhdGEuX3JlbmRlcmVkVmFsdWUgLyBhdmFpbGFibGVEYXRhLl9tYXhWYWwsIHN0ZXBHYXBBcmMsIFBJMiAtIHN0ZXBHYXBBcmMsIGFtb3VudEVuZEFyYyk7XG5cdFx0fVxuXHRcdC8vIHJlc3RvcmUgY3R4IGFmdGVyIGRyYXdpbmcgYXJjc1xuXHRcdHRoaXMuX2N0eC5yZXN0b3JlKCk7XG5cdH0sXG5cblx0ZHJhd0FyYzogZnVuY3Rpb24odmFsdWVTdHlsZSwgdmFsdWUsIHN0YXJ0QXJjLCBlbmRBcmMsIHByZXZBcmMpIHtcblx0XHR2YXIgdmFsQXJjLCBpbnZTdHlsZSxcblx0XHRcdHZhbFN0YXJ0QXJjLCB2YWxFbmRBcmMsXG5cdFx0XHRpbnZTdGFydEFyYywgaW52RW5kQXJjO1xuXHRcdHByZXZBcmMgfHwgKHByZXZBcmMgPSAwKTtcblxuXHRcdHZhbEFyYyA9IGVuZEFyYyAtIHN0YXJ0QXJjO1xuXHRcdHZhbEVuZEFyYyA9IHN0YXJ0QXJjICsgKHZhbEFyYyAqIHZhbHVlKTtcblx0XHR2YWxTdGFydEFyYyA9IE1hdGgubWF4KHN0YXJ0QXJjLCBwcmV2QXJjKTtcblx0XHRpZiAodmFsRW5kQXJjID4gdmFsU3RhcnRBcmMpIHtcblx0XHRcdHRoaXMuX2N0eC5zYXZlKCk7XG5cdFx0XHR0aGlzLmFwcGx5VmFsdWVTdHlsZSh2YWx1ZVN0eWxlKTtcblx0XHRcdHRoaXMuX2N0eC5iZWdpblBhdGgoKTtcblx0XHRcdHRoaXMuX2N0eC5hcmMoMCwgMCwgdmFsdWVTdHlsZS5yYWRpdXMsIHZhbEVuZEFyYywgdmFsU3RhcnRBcmMsIHRydWUpO1xuXHRcdFx0dGhpcy5fY3R4LnN0cm9rZSgpO1xuXHRcdFx0dGhpcy5fY3R4LnJlc3RvcmUoKTtcblx0XHR9XG5cdFx0Ly8gaWYgdGhlcmUncyB2YWx1ZVN0eWxlLCBkcmF3IHJlc3Qgb2Ygc3BhbiwgbWludXMgcHJldkFyYyBvdmVybGFwIHRvb1xuXHRcdGlmICh2YWx1ZVN0eWxlLmludmVyc2UgIT09IHZvaWQgMCkge1xuXHRcdFx0aW52U3R5bGUgPSB0aGlzLl92YWx1ZVN0eWxlc1t2YWx1ZVN0eWxlLmludmVyc2VdO1xuXHRcdFx0aW52RW5kQXJjID0gdmFsRW5kQXJjICsgKHZhbEFyYyAqICgxIC0gdmFsdWUpKTtcblx0XHRcdGludlN0YXJ0QXJjID0gTWF0aC5tYXgodmFsRW5kQXJjLCBwcmV2QXJjKTtcblx0XHRcdGlmIChpbnZFbmRBcmMgPiBpbnZTdGFydEFyYykge1xuXHRcdFx0XHR0aGlzLl9jdHguc2F2ZSgpO1xuXHRcdFx0XHR0aGlzLmFwcGx5VmFsdWVTdHlsZShpbnZTdHlsZSk7XG5cdFx0XHRcdHRoaXMuX2N0eC5iZWdpblBhdGgoKTtcblx0XHRcdFx0dGhpcy5fY3R4LmFyYygwLCAwLCBpbnZTdHlsZS5yYWRpdXMsIGludkVuZEFyYywgaW52U3RhcnRBcmMsIHRydWUpO1xuXHRcdFx0XHR0aGlzLl9jdHguc3Ryb2tlKCk7XG5cdFx0XHRcdHRoaXMuX2N0eC5yZXN0b3JlKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2YWxFbmRBcmM7XG5cdH0sXG5cblx0YXBwbHlWYWx1ZVN0eWxlOiBmdW5jdGlvbihzdHlsZU9iaikge1xuXHRcdHRoaXMuX2N0eC5saW5lV2lkdGggPSBzdHlsZU9iai5saW5lV2lkdGg7XG5cdFx0aWYgKHN0eWxlT2JqLmxpbmVEYXNoKSB7XG5cdFx0XHR0aGlzLl9jdHguc2V0TGluZURhc2goc3R5bGVPYmoubGluZURhc2gpO1xuXHRcdH1cblx0XHRpZiAoc3R5bGVPYmoubGluZURhc2hPZmZzZXQpIHtcblx0XHRcdHRoaXMuX2N0eC5saW5lRGFzaE9mZnNldCA9IHN0eWxlT2JqLmxpbmVEYXNoT2Zmc2V0O1xuXHRcdH1cblx0fSxcblxuXHRkcmF3TGFiZWw6IGZ1bmN0aW9uKGxhYmVsU3RyaW5nKSB7XG5cdFx0dmFyIGxhYmVsV2lkdGggPSB0aGlzLl9jdHgubWVhc3VyZVRleHQobGFiZWxTdHJpbmcpLndpZHRoO1xuXHRcdHRoaXMuX2N0eC5maWxsVGV4dChsYWJlbFN0cmluZyxcblx0XHRcdGxhYmVsV2lkdGggKiAtMC41LFxuXHRcdFx0dGhpcy5fYmFzZWxpbmVTaGlmdCwgbGFiZWxXaWR0aCk7XG5cdH0sXG5cblx0ZHJhd0VuZENhcDogZnVuY3Rpb24odmFsdWVTdHlsZSwgYXJjUG9zKSB7XG5cdFx0dmFyIHJhZGl1cyA9IHZhbHVlU3R5bGUucmFkaXVzO1xuXHRcdHRoaXMuX2N0eC5zYXZlKCk7XG5cdFx0dGhpcy5fY3R4LmxpbmVXaWR0aCA9IHZhbHVlU3R5bGUubGluZVdpZHRoO1xuXG5cdFx0dGhpcy5fY3R4LnJvdGF0ZShhcmNQb3MgLSBHQVBfQVJDICogMS41KTtcblx0XHR0aGlzLl9jdHguYmVnaW5QYXRoKCk7XG5cdFx0dGhpcy5fY3R4LmFyYygwLCAwLCByYWRpdXMsIEdBUF9BUkMgKiAwLjUsIEdBUF9BUkMgKiAyLCBmYWxzZSk7XG5cdFx0dGhpcy5fY3R4LmxpbmVUbyhyYWRpdXMgLSAoR0FQX0FSQyAqIHJhZGl1cyksIDApO1xuXHRcdHRoaXMuX2N0eC5jbG9zZVBhdGgoKTtcblxuXHRcdHRoaXMuX2N0eC5maWxsKCk7XG5cdFx0dGhpcy5fY3R4LnN0cm9rZSgpO1xuXHRcdHRoaXMuX2N0eC5yZXN0b3JlKCk7XG5cdH0sXG59KTtcblxuaWYgKERFQlVHKSB7XG5cdENhbnZhc1Byb2dyZXNzTWV0ZXIucHJvdG90eXBlLl9za2lwTG9nID0gdHJ1ZTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBDYW52YXNQcm9ncmVzc01ldGVyO1xuIiwiLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbnZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvY29sbGVjdGlvbi9CdW5kbGVDb2xsZWN0aW9ufSAqL1xudmFyIGJ1bmRsZXMgPSByZXF1aXJlKFwiYXBwL21vZGVsL2NvbGxlY3Rpb24vQnVuZGxlQ29sbGVjdGlvblwiKTtcblxuLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuLy8gIHV0aWxzXG4vLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cbmZ1bmN0aW9uIGluc2VydENTU1J1bGUoc2hlZXQsIHNlbGVjdG9yLCBzdHlsZSkge1xuXHR2YXIgY3NzVGV4dCA9IFwiXCI7XG5cdGZvciAodmFyIHByb3AgaW4gc3R5bGUpIHtcblx0XHRjc3NUZXh0ICs9IHByb3AgKyBcIjpcIiArIHN0eWxlW3Byb3BdICsgXCI7XCI7XG5cdH1cblx0c2hlZXQuaW5zZXJ0UnVsZShzZWxlY3RvciArIFwie1wiICsgY3NzVGV4dCArIFwifVwiLCBzaGVldC5jc3NSdWxlcy5sZW5ndGgpO1xufVxuXG5mdW5jdGlvbiBzZWxmQW5kRGVzY2VuZGFudChzZWxmQ2xzLCBjbHMpIHtcblx0cmV0dXJuIHNlbGZDbHMgKyBcIiBcIiArIGNscyArIFwiLCBcIiArIHNlbGZDbHMgKyBjbHM7XG59XG5cbi8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cbi8vICByb290IHJ1bGVzXG4vLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cbnZhciByb290U3R5bGVzID0gW1wiYmFja2dyb3VuZFwiLCBcImJhY2tncm91bmQtY29sb3JcIiwgXCJjb2xvclwiLCBcIi0tbGluay1jb2xvclwiXTtcblxuZnVuY3Rpb24gaW5pdFJvb3RTdHlsZXMoc2hlZXQsIHJvb3RTZWxlY3RvciwgYXR0cnMsIGZnQ29sb3IsIGJnQ29sb3IsIGxuQ29sb3IsIGhhc0RhcmtCZykge1xuXHR2YXIgcywgcmV2U2VsZWN0b3IsIGZnQ29sb3JWYWwsIGJnQ29sb3JWYWw7XG5cdC8vIHZhciByZXZGZ0NvbG9yVmFsLCByZXZCZ0NvbG9yVmFsO1xuXG5cdHMgPSBfLnBpY2soYXR0cnMsIHJvb3RTdHlsZXMpO1xuXHRzW1wiLXdlYmtpdC1mb250LXNtb290aGluZ1wiXSA9IChoYXNEYXJrQmcgPyBcImFudGlhbGlhc2VkXCIgOiBcImF1dG9cIik7XG5cdC8qIE5PVEU6IEluIEZpcmVmb3ggJy1tb3otb3N4LWZvbnQtc21vb3RoaW5nOiBncmF5c2NhbGU7J1xuXHQvKiB3b3JrcyBib3RoIGluIGxpZ2h0IG92ZXIgZGFyayBhbmQgZGFyayBvdmVyIGxpZ2h0LCBoYXJkY29kZWQgaW4gX2Jhc2Uuc2NzcyAqL1xuXHQvL3NbXCItbW96LW9zeC1mb250LXNtb290aGluZ1wiXSA9IChoYXNEYXJrQmc/IFwiZ3JheXNjYWxlXCIgOiBcImF1dG9cIik7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHJvb3RTZWxlY3Rvciwgcyk7XG5cblx0Ly8gQSBlbGVtZW50XG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0cyA9IHt9XG5cdHNbXCJjb2xvclwiXSA9IGxuQ29sb3IucmdiU3RyaW5nKCk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHJvb3RTZWxlY3RvciArIFwiIGFcIiwgcyk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHJvb3RTZWxlY3RvciArIFwiIC5jb2xvci1sblwiLCBzKTtcblxuXHQvLyAuY29sb3ItZmcwNVxuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdHMgPSB7fTtcblx0c1tcImNvbG9yXCJdID0gZmdDb2xvci5jbG9uZSgpLm1peChiZ0NvbG9yLCAwLjUpLnJnYlN0cmluZygpO1xuXHRzW1wiYm9yZGVyLWNvbG9yXCJdID0gZmdDb2xvci5jbG9uZSgpLm1peChiZ0NvbG9yLCAwLjcpLnJnYlN0cmluZygpO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCByb290U2VsZWN0b3IgKyBcIiAuY29sb3ItZmcwNVwiLCBzKTtcblxuXHRmZ0NvbG9yVmFsID0gZmdDb2xvci5yZ2JTdHJpbmcoKTtcblx0YmdDb2xvclZhbCA9IGJnQ29sb3IucmdiU3RyaW5nKCk7XG5cdC8vIHJldkZnQ29sb3JWYWwgPSBiZ0NvbG9yLmNsb25lKCkubWl4KGZnQ29sb3IsIDAuOSkucmdiU3RyaW5nKCk7XG5cdC8vIHJldkJnQ29sb3JWYWwgPSBmZ0NvbG9yLmNsb25lKCkubWl4KGJnQ29sb3IsIDAuNikucmdiU3RyaW5nKCk7XG5cdHJldlNlbGVjdG9yID0gcm9vdFNlbGVjdG9yICsgXCIgLmNvbG9yLXJldmVyc2VcIjtcblxuXHQvLyAuY29sb3ItZmcgLmNvbG9yLWJnXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0cyA9IHtcblx0XHRcImNvbG9yXCI6IGZnQ29sb3JWYWxcblx0fTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yICsgXCIgLmNvbG9yLWZnXCIsIHMpO1xuXHRzID0ge1xuXHRcdFwiYmFja2dyb3VuZC1jb2xvclwiOiBiZ0NvbG9yVmFsXG5cdH07XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHJvb3RTZWxlY3RvciArIFwiIC5jb2xvci1iZ1wiLCBzKTtcblx0Ly8gaHRtbCBpbnZlcnRlZCB0ZXh0L2JhY2tncm91bmRcblx0cyA9IHtcblx0XHRcImNvbG9yXCI6IGJnQ29sb3JWYWxcblx0fTsgLy8gcyA9IHsgXCJjb2xvclwiIDogcmV2RmdDb2xvclZhbCB9O1xuXHRzW1wiLXdlYmtpdC1mb250LXNtb290aGluZ1wiXSA9IChoYXNEYXJrQmcgPyBcImF1dG9cIiA6IFwiYW50aWFsaWFzZWRcIik7XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJldlNlbGVjdG9yICsgXCIgLmNvbG9yLWZnXCIsIHMpO1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByZXZTZWxlY3RvciArIFwiLmNvbG9yLWZnXCIsIHMpO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCBzZWxmQW5kRGVzY2VuZGFudChyZXZTZWxlY3RvciwgXCIuY29sb3ItZmdcIiksIHMpO1xuXG5cdHMgPSB7XG5cdFx0XCJiYWNrZ3JvdW5kLWNvbG9yXCI6IGZnQ29sb3JWYWxcblx0fTtcblx0Ly8gcyA9IHsgXCJiYWNrZ3JvdW5kLWNvbG9yXCIgOiByZXZCZ0NvbG9yVmFsIH07XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJldlNlbGVjdG9yICsgXCIgLmNvbG9yLWJnXCIsIHMpO1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByZXZTZWxlY3RvciArIFwiLmNvbG9yLWJnXCIsIHMpO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCBzZWxmQW5kRGVzY2VuZGFudChyZXZTZWxlY3RvciwgXCIuY29sb3ItYmdcIiksIHMpO1xuXG5cdC8vIC5jb2xvci1zdHJva2UgLmNvbG9yLWZpbGwgKFNWRylcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRzID0ge1xuXHRcdFwic3Ryb2tlXCI6IGZnQ29sb3JWYWxcblx0fTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yICsgXCIgLmNvbG9yLXN0cm9rZVwiLCBzKTtcblx0cyA9IHtcblx0XHRcImZpbGxcIjogYmdDb2xvclZhbFxuXHR9O1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCByb290U2VsZWN0b3IgKyBcIiAuY29sb3ItZmlsbFwiLCBzKTtcblx0Ly8gc3ZnIGludmVydGVkIGZpbGwvc3Ryb2tlXG5cdHMgPSB7XG5cdFx0XCJzdHJva2VcIjogYmdDb2xvclZhbFxuXHR9O1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByZXZTZWxlY3RvciArIFwiIC5jb2xvci1zdHJva2VcIiwgcyk7XG5cdC8vIGluc2VydENTU1J1bGUoc2hlZXQsIHJldlNlbGVjdG9yICsgXCIuY29sb3Itc3Ryb2tlXCIsIHMpO1xuXHRpbnNlcnRDU1NSdWxlKHNoZWV0LCBzZWxmQW5kRGVzY2VuZGFudChyZXZTZWxlY3RvciwgXCIuY29sb3Itc3Ryb2tlXCIpLCBzKTtcblx0cyA9IHtcblx0XHRcImZpbGxcIjogZmdDb2xvclZhbFxuXHR9O1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByZXZTZWxlY3RvciArIFwiIC5jb2xvci1maWxsXCIsIHMpO1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByZXZTZWxlY3RvciArIFwiLmNvbG9yLWZpbGxcIiwgcyk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIHNlbGZBbmREZXNjZW5kYW50KHJldlNlbGVjdG9yLCBcIi5jb2xvci1maWxsXCIpLCBzKTtcblxuXHQvLyAudGV4dC1vdXRsaW5lXG5cdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0Ly8gcyA9IHtcblx0Ly8gXHRcInRleHQtc2hhZG93XCI6IFwiLTFweCAtMXB4IDAgXCIgKyBiZ0NvbG9yVmFsICtcblx0Ly8gXHRcdFwiLCAxcHggLTFweCAwIFwiICsgYmdDb2xvclZhbCArXG5cdC8vIFx0XHRcIiwgLTFweCAxcHggMCBcIiArIGJnQ29sb3JWYWwgK1xuXHQvLyBcdFx0XCIsIDFweCAxcHggMCBcIiArIGJnQ29sb3JWYWxcblx0Ly8gfTtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcm9vdFNlbGVjdG9yICsgXCIgOm5vdCguY29sbGFwc2VkLWNoYW5nZWQpIC50ZXh0LW91dGxpbmUtYmdcIiwgcyk7XG5cbn1cblxuLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuLy8gY2Fyb3VzZWwgc3R5bGVzXG4vLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cbnZhciBjYXJvdXNlbFN0eWxlcyA9IFtcImJveC1zaGFkb3dcIiwgXCJib3JkZXJcIiwgXCJib3JkZXItcmFkaXVzXCJdO1xuXG5mdW5jdGlvbiBpbml0Q2Fyb3VzZWxTdHlsZXMoc2hlZXQsIGNhcm91c2VsU2VsZWN0b3IsIGF0dHJzLCBmZ0NvbG9yLCBiZ0NvbG9yLCBsbkNvbG9yLCBoYXNEYXJrQmcpIHtcblx0dmFyIHMgPSBfLnBpY2soYXR0cnMsIGNhcm91c2VsU3R5bGVzKTsgLy8sIFwiYmFja2dyb3VuZC1jb2xvclwiXSk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIGNhcm91c2VsU2VsZWN0b3IgKyBcIiAubWVkaWEtaXRlbSAuY29udGVudFwiLCBzKTtcblxuXHQvLyAubWVkaWEtaXRlbSAuY29sb3ItYmcwOVxuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdHMgPSB7fTtcblx0c1tcImJhY2tncm91bmQtY29sb3JcIl0gPSBiZ0NvbG9yLmNsb25lKCkubWl4KGZnQ29sb3IsIDAuOTUpLnJnYlN0cmluZygpO1xuXHQvLyBzW1wiYmFja2dyb3VuZC1jb2xvclwiXSA9IGJnQ29sb3IuY2xvbmUoKVtoYXNEYXJrQmcgPyBcImRhcmtlblwiIDogXCJsaWdodGVuXCJdKDAuMDQ1KS5yZ2JTdHJpbmcoKTtcblx0Ly8gc1tcImJhY2tncm91bmQtY29sb3JcIl0gPSBiZ0NvbG9yLmNsb25lKClbaGFzRGFya0JnID8gXCJsaWdodGVuXCIgOiBcImRhcmtlblwiXSgwLjAzKS5yZ2JTdHJpbmcoKTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgY2Fyb3VzZWxTZWxlY3RvciArIFwiIC5tZWRpYS1pdGVtIC5jb2xvci1iZzA5XCIsIHMpO1xuXG5cdC8vIC5tZWRpYS1pdGVtIC5wbGFjZWhvbGRlclxuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdHMgPSB7fTtcblx0c1tcIi13ZWJraXQtZm9udC1zbW9vdGhpbmdcIl0gPSAoaGFzRGFya0JnID8gXCJhdXRvXCIgOiBcImFudGlhbGlhc2VkXCIpO1xuXHQvLyB0ZXh0IGNvbG9yIGx1bWlub3NpdHkgaXMgaW52ZXJzZSBmcm9tIGJvZHksIGFwcGx5IG9wb3NpdGUgcmVuZGVyaW5nIG1vZGVcblx0c1tcImNvbG9yXCJdID0gYmdDb2xvci5yZ2JTdHJpbmcoKTtcblx0Ly8gc1tcImNvbG9yXCJdID0gYmdDb2xvci5jbG9uZSgpW2hhc0RhcmtCZyA/IFwiZGFya2VuXCIgOiBcImxpZ2h0ZW5cIl0oMC4wNDUpLnJnYlN0cmluZygpO1xuXHRzW1wiYmFja2dyb3VuZC1jb2xvclwiXSA9IGJnQ29sb3IuY2xvbmUoKS5taXgoZmdDb2xvciwgMC45NSkucmdiU3RyaW5nKCk7XG5cdC8vIHNbXCJiYWNrZ3JvdW5kLWNvbG9yXCJdID0gYmdDb2xvci5jbG9uZSgpLm1peChmZ0NvbG9yLCAwLjgpLmFscGhhKDAuMykucmdiYVN0cmluZygpO1xuXHQvLyBzW1wiYmFja2dyb3VuZC1jb2xvclwiXSA9IGJnQ29sb3IuY2xvbmUoKVtoYXNEYXJrQmcgPyBcImxpZ2h0ZW5cIiA6IFwiZGFya2VuXCJdKDAuMDMpLnJnYlN0cmluZygpO1xuXHQoXCJib3JkZXItcmFkaXVzXCIgaW4gYXR0cnMpICYmIChzW1wiYm9yZGVyLXJhZGl1c1wiXSA9IGF0dHJzW1wiYm9yZGVyLXJhZGl1c1wiXSk7XG5cdGluc2VydENTU1J1bGUoc2hlZXQsIGNhcm91c2VsU2VsZWN0b3IgKyBcIiAubWVkaWEtaXRlbSAucGxhY2Vob2xkZXJcIiwgcyk7XG5cblx0Ly8gLmVtcHR5LWl0ZW0gQVxuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdHMgPSB7fTtcblx0c1tcInRleHQtZGVjb3JhdGlvbi1jb2xvclwiXSA9IGZnQ29sb3IuY2xvbmUoKS5taXgoYmdDb2xvciwgMC4zKS5yZ2JTdHJpbmcoKTtcblx0aW5zZXJ0Q1NTUnVsZShzaGVldCwgY2Fyb3VzZWxTZWxlY3RvciArIFwiIC5lbXB0eS1pdGVtIEFcIiwgcyk7XG5cdC8vIC8vIC5jb2xvci1ncmFkaWVudFxuXHQvLyAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdC8vIHMgPSB7fTtcblx0Ly8gc1tcImJhY2tncm91bmQtY29sb3JcIl0gPSBcInRyYW5zcGFyZW50XCI7XG5cdC8vIHNbXCJiYWNrZ3JvdW5kXCJdID0gXCJsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCBcIiArXG5cdC8vIFx0XHRiZ0NvbG9yLmNsb25lKCkuYWxwaGEoMC4wMCkucmdiYVN0cmluZygpICsgXCIgMCUsIFwiICtcblx0Ly8gXHRcdGJnQ29sb3IuY2xvbmUoKS5hbHBoYSgwLjExKS5yZ2JhU3RyaW5nKCkgKyBcIiAxMDAlKVwiO1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByb290U2VsZWN0b3IgKyBcIiAuY29sb3ItZ3JhZGllbnRcIiwgcyk7XG5cdC8vIHMgPSB7fTtcblx0Ly8gc1tcImJhY2tncm91bmQtY29sb3JcIl0gPSBcInRyYW5zcGFyZW50XCI7XG5cdC8vIHNbXCJiYWNrZ3JvdW5kXCJdID0gXCJsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCBcIiArXG5cdC8vIFx0XHRmZ0NvbG9yLmNsb25lKCkuYWxwaGEoMC4wMCkucmdiYVN0cmluZygpICsgXCIgMCUsIFwiICtcblx0Ly8gXHRcdGZnQ29sb3IuY2xvbmUoKS5hbHBoYSgwLjExKS5yZ2JhU3RyaW5nKCkgKyBcIiAxMDAlKVwiO1xuXHQvLyBpbnNlcnRDU1NSdWxlKHNoZWV0LCByZXZTZWxlY3RvciArIFwiIC5jb2xvci1ncmFkaWVudFwiLCBzKTtcblx0Ly8gaW5zZXJ0Q1NTUnVsZShzaGVldCwgcmV2U2VsZWN0b3IgKyBcIi5jb2xvci1ncmFkaWVudFwiLCBzKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbigpIHtcblx0dmFyIGF0dHJzLCBmZ0NvbG9yLCBiZ0NvbG9yLCBsbkNvbG9yLCBoYXNEYXJrQmc7XG5cblx0YXR0cnMgPSBHbG9iYWxzLkRFRkFVTFRfQ09MT1JTO1xuXHRmZ0NvbG9yID0gbmV3IENvbG9yKEdsb2JhbHMuREVGQVVMVF9DT0xPUlNbXCJjb2xvclwiXSk7XG5cdGJnQ29sb3IgPSBuZXcgQ29sb3IoR2xvYmFscy5ERUZBVUxUX0NPTE9SU1tcImJhY2tncm91bmQtY29sb3JcIl0pO1xuXHRsbkNvbG9yID0gbmV3IENvbG9yKEdsb2JhbHMuREVGQVVMVF9DT0xPUlNbXCItLWxpbmstY29sb3JcIl0pXG5cdGhhc0RhcmtCZyA9IGZnQ29sb3IubHVtaW5vc2l0eSgpID4gYmdDb2xvci5sdW1pbm9zaXR5KCk7XG5cblx0dmFyIGNvbG9yU3R5bGVzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuXHRjb2xvclN0eWxlcy5pZCA9IFwiY29sb3JzXCI7XG5cdGNvbG9yU3R5bGVzLnR5cGUgPSBcInRleHQvY3NzXCI7XG5cdGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoY29sb3JTdHlsZXMpO1xuXHQvLyB2YXIgY29sb3JTdHlsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwibGluayNmb2xpb1wiKTtcblxuXHRpbml0Um9vdFN0eWxlcyhjb2xvclN0eWxlcy5zaGVldCwgXCIuYXBwXCIsXG5cdFx0YXR0cnMsIGZnQ29sb3IsIGJnQ29sb3IsIGxuQ29sb3IsIGhhc0RhcmtCZyk7XG5cdGluaXRDYXJvdXNlbFN0eWxlcyhjb2xvclN0eWxlcy5zaGVldCwgXCIuY2Fyb3VzZWxcIixcblx0XHRhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnKTtcblxuXHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdC8vIHBlci1idW5kbGUgcnVsZXNcblx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRidW5kbGVzLmVhY2goZnVuY3Rpb24oYnVuZGxlKSB7XG5cdFx0YXR0cnMgPSBidW5kbGUuYXR0cnMoKTsgLy9nZXQoXCJhdHRyc1wiKTtcblx0XHRmZ0NvbG9yID0gYnVuZGxlLmNvbG9ycy5mZ0NvbG9yO1xuXHRcdGJnQ29sb3IgPSBidW5kbGUuY29sb3JzLmJnQ29sb3I7XG5cdFx0bG5Db2xvciA9IGJ1bmRsZS5jb2xvcnMubG5Db2xvcjtcblx0XHRoYXNEYXJrQmcgPSBidW5kbGUuY29sb3JzLmhhc0RhcmtCZztcblxuXHRcdGluaXRSb290U3R5bGVzKGNvbG9yU3R5bGVzLnNoZWV0LFxuXHRcdFx0XCIuYXBwLlwiICsgYnVuZGxlLmdldChcImRvbWlkXCIpLFxuXHRcdFx0YXR0cnMsIGZnQ29sb3IsIGJnQ29sb3IsIGxuQ29sb3IsIGhhc0RhcmtCZyk7XG5cdFx0aW5pdENhcm91c2VsU3R5bGVzKGNvbG9yU3R5bGVzLnNoZWV0LFxuXHRcdFx0XCIuY2Fyb3VzZWwuXCIgKyBidW5kbGUuZ2V0KFwiZG9taWRcIiksXG5cdFx0XHRhdHRycywgZmdDb2xvciwgYmdDb2xvciwgbG5Db2xvciwgaGFzRGFya0JnKTtcblx0fSk7XG59OyIsIi8qZ2xvYmFsIFhNTEh0dHBSZXF1ZXN0ICovXG5cbi8vIHZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZy9scGFkfSAqL1xuLy8gdmFyIGNsYXNzaWZ5ID0gcmVxdWlyZShcInVuZGVyc2NvcmUuc3RyaW5nL2NsYXNzaWZ5XCIpO1xuXG4vLyB2YXIgc3RhdHVzTXNnID0gXy50ZW1wbGF0ZShcIjwlPSBzdGF0dXMgJT4gcmVjZWl2ZWQgZnJvbSA8JT0gdXJsICU+ICg8JT0gc3RhdHVzVGV4dCAlPilcIik7XG4vLyB2YXIgZXJyTXNnID0gXy50ZW1wbGF0ZShcIic8JT0gZXJyTmFtZSAlPicgb2N1cnJlZCBkdXJpbmcgcmVxdWVzdCA8JT0gdXJsICU+XCIpO1xuXG5pZiAod2luZG93LlhNTEh0dHBSZXF1ZXN0ICYmIHdpbmRvdy5VUkwgJiYgd2luZG93LkJsb2IpIHtcblx0bW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih1cmwsIHByb2dyZXNzRm4pIHtcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHR2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXHRcdFx0cmVxdWVzdC5vcGVuKFwiR0VUXCIsIHVybCwgdHJ1ZSk7XG5cdFx0XHQvLyByZXF1ZXN0LnRpbWVvdXQgPSAxMDAwMDsgLy8gaW4gbWlsbGlzZWNvbmRzXG5cdFx0XHRyZXF1ZXN0LnJlc3BvbnNlVHlwZSA9IFwiYmxvYlwiO1xuXG5cdFx0XHQvLyBpZiBwcm9ncmVzc0ZuIGlzIHN1cHBsaWVkXG5cdFx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdFx0aWYgKHByb2dyZXNzRm4pIHtcblx0XHRcdFx0cmVxdWVzdC5vbnByb2dyZXNzID0gZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0XHRwcm9ncmVzc0ZuKGV2LmxvYWRlZCAvIGV2LnRvdGFsKTtcblx0XHRcdFx0fTtcblx0XHRcdH1cblx0XHRcdC8vIHJlc29sdmVkL3N1Y2Nlc3Ncblx0XHRcdC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cdFx0XHRyZXF1ZXN0Lm9ubG9hZCA9IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRcdC8vIFdoZW4gdGhlIHJlcXVlc3QgbG9hZHMsIGNoZWNrIHdoZXRoZXIgaXQgd2FzIHN1Y2Nlc3NmdWxcblx0XHRcdFx0aWYgKHJlcXVlc3Quc3RhdHVzID09IDIwMCkge1xuXHRcdFx0XHRcdC8vIElmIHN1Y2Nlc3NmdWwsIHJlc29sdmUgdGhlIHByb21pc2UgYnkgcGFzc2luZyBiYWNrIGEgcmVmZXJlbmNlIHVybFxuXHRcdFx0XHRcdHJlc29sdmUoVVJMLmNyZWF0ZU9iamVjdFVSTChyZXF1ZXN0LnJlc3BvbnNlKSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dmFyIGVyciA9IG5ldyBFcnJvcigoXCJodHRwX1wiICsgcmVxdWVzdC5zdGF0dXNUZXh0LnJlcGxhY2UoL1xccy9nLCBcIl9cIikpLnRvVXBwZXJDYXNlKCkpO1xuXHRcdFx0XHRcdGVyci5pbmZvQ29kZSA9IHJlcXVlc3Quc3RhdHVzO1xuXHRcdFx0XHRcdGVyci5pbmZvU3JjID0gdXJsO1xuXHRcdFx0XHRcdGVyci5sb2dFdmVudCA9IGV2O1xuXHRcdFx0XHRcdGVyci5sb2dNZXNzYWdlID0gXCJfbG9hZEltYWdlQXNPYmplY3RVUkw6OlwiICsgZXYudHlwZSArIFwiIFtyZWplY3RdXCI7XG5cdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHQvLyByZWplY3QvZmFpbHVyZVxuXHRcdFx0Ly8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblx0XHRcdHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRcdHZhciBlcnIgPSBuZXcgRXJyb3IoKGV2LnR5cGUgKyBcIl9ldmVudFwiKS50b1VwcGVyQ2FzZSgpKTtcblx0XHRcdFx0ZXJyLmluZm9Db2RlID0gLTE7XG5cdFx0XHRcdGVyci5pbmZvU3JjID0gdXJsO1xuXHRcdFx0XHRlcnIubG9nRXZlbnQgPSBldjtcblx0XHRcdFx0ZXJyLmxvZ01lc3NhZ2UgPSBcIl9sb2FkSW1hZ2VBc09iamVjdFVSTDo6XCIgKyBldi50eXBlICsgXCIgW3JlamVjdF1cIjtcblx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHR9O1xuXHRcdFx0cmVxdWVzdC5vbmFib3J0ID0gcmVxdWVzdC5vbnRpbWVvdXQgPSByZXF1ZXN0Lm9uZXJyb3I7XG5cdFx0XHQvLyBmaW5hbGx5XG5cdFx0XHQvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXHRcdFx0cmVxdWVzdC5vbmxvYWRlbmQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmVxdWVzdC5vbmFib3J0ID0gcmVxdWVzdC5vbnRpbWVvdXQgPSByZXF1ZXN0Lm9uZXJyb3IgPSB2b2lkIDA7XG5cdFx0XHRcdHJlcXVlc3Qub25sb2FkID0gcmVxdWVzdC5vbmxvYWRlbmQgPSB2b2lkIDA7XG5cdFx0XHRcdGlmIChwcm9ncmVzc0ZuKSB7XG5cdFx0XHRcdFx0cmVxdWVzdC5vbnByb2dyZXNzID0gdm9pZCAwO1xuXHRcdFx0XHR9XG5cdFx0XHR9O1xuXG5cdFx0XHRyZXF1ZXN0LnNlbmQoKTtcblx0XHR9KTtcblx0fTtcbn0gZWxzZSB7XG5cdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odXJsKSB7XG5cdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSh1cmwpO1xuXHR9O1xufSIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oaW1hZ2UsIHJlc29sdmVFbXB0eSkge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0aWYgKCEoaW1hZ2UgaW5zdGFuY2VvZiB3aW5kb3cuSFRNTEltYWdlRWxlbWVudCkpIHtcblx0XHRcdC8vcmVqZWN0KG5ldyBFcnJvcihcIm5vdCBhbiBIVE1MSW1hZ2VFbGVtZW50XCIpKTtcblx0XHRcdHJlamVjdChcIkVycm9yOiBub3QgYW4gSFRNTEltYWdlRWxlbWVudFwiKTtcblx0XHR9IGVsc2UgaWYgKGltYWdlLmNvbXBsZXRlICYmIChpbWFnZS5zcmMubGVuZ3RoID4gMCB8fCByZXNvbHZlRW1wdHkpKSB7XG5cdFx0XHQvLyBpZiAoaW1hZ2Uuc3JjID09PSBcIlwiKSBjb25zb2xlLndhcm4oXCJfd2hlbkltYWdlTG9hZHMgcmVzb2x2ZWQgd2l0aCBlbXB0eSBzcmNcIik7XG5cdFx0XHQvLyBlbHNlIGNvbnNvbGUubG9nKFwiX3doZW5JbWFnZUxvYWRzIHJlc29sdmUtc3luY1wiLCBpbWFnZS5zcmMpO1xuXHRcdFx0cmVzb2x2ZShpbWFnZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBoYW5kbGVycyA9IHtcblx0XHRcdFx0bG9hZDogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIl93aGVuSW1hZ2VMb2Fkc19kb20gcmVzb2x2ZS1hc3luY1wiLCBldi50eXBlLCBpbWFnZS5zcmMpO1xuXHRcdFx0XHRcdHJlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0cmVzb2x2ZShpbWFnZSk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbihldikge1xuXHRcdFx0XHRcdHZhciBlcnIgPSBuZXcgRXJyb3IoXCJMb2FkaW5nIGZhaWxlZCAoXCIgKyBldi50eXBlICsgXCIgZXZlbnQpXCIpO1xuXHRcdFx0XHRcdGVyci5pbmZvQ29kZSA9IC0xO1xuXHRcdFx0XHRcdGVyci5pbmZvU3JjID0gaW1hZ2Uuc3JjO1xuXHRcdFx0XHRcdGVyci5sb2dFdmVudCA9IGV2O1xuXHRcdFx0XHRcdGVyci5sb2dNZXNzYWdlID0gXCJfd2hlbkltYWdlTG9hZHM6OlwiICsgZXYudHlwZSArIFwiIFtyZWplY3RdXCI7XG5cdFx0XHRcdFx0cmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcdFx0XHRyZWplY3QoZXJyKTtcblx0XHRcdFx0fVxuXHRcdFx0fTtcblx0XHRcdGhhbmRsZXJzLmFib3J0ID0gaGFuZGxlcnMuZXJyb3I7XG5cdFx0XHR2YXIgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0Zm9yICh2YXIgZXZlbnQgaW4gaGFuZGxlcnMpIHtcblx0XHRcdFx0XHRpZiAoaGFuZGxlcnMuaGFzT3duUHJvcGVydHkoZXZlbnQpKSB7XG5cdFx0XHRcdFx0XHRpbWFnZS5yZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50LCBoYW5kbGVyc1tldmVudF0sIGZhbHNlKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHRmb3IgKHZhciBldmVudCBpbiBoYW5kbGVycykge1xuXHRcdFx0XHRpZiAoaGFuZGxlcnMuaGFzT3duUHJvcGVydHkoZXZlbnQpKSB7XG5cdFx0XHRcdFx0aW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlcnNbZXZlbnRdLCBmYWxzZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH0pO1xufTtcbiIsIi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS9fd2hlbkltYWdlTG9hZHN9ICovXG52YXIgX3doZW5JbWFnZUxvYWRzID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2UvX3doZW5JbWFnZUxvYWRzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS9fbG9hZEltYWdlQXNPYmplY3RVUkx9ICovXG52YXIgX2xvYWRJbWFnZUFzT2JqZWN0VVJMID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2UvX2xvYWRJbWFnZUFzT2JqZWN0VVJMXCIpO1xuXG4vLyB2YXIgaXNCbG9iUkUgPSAvXmJsb2JcXDouKi87XG5cbi8vIHZhciBsb2dNZXNzYWdlID0gXCIlczo6d2hlbkRlZmF1bHRJbWFnZUxvYWRzIFslc106ICVzXCI7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odmlldykge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dmFyIHNvdXJjZSA9IHZpZXcubW9kZWwuZ2V0KFwic291cmNlXCIpO1xuXHRcdGlmIChzb3VyY2UuaGFzKFwicHJlZmV0Y2hlZFwiKSkge1xuXHRcdFx0dmlldy5kZWZhdWx0SW1hZ2Uuc3JjID0gc291cmNlLmdldChcInByZWZldGNoZWRcIik7XG5cdFx0XHRfd2hlbkltYWdlTG9hZHModmlldy5kZWZhdWx0SW1hZ2UpXG5cdFx0XHRcdC50aGVuKFxuXHRcdFx0XHRcdGZ1bmN0aW9uKHRhcmdldEVsKSB7XG5cdFx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhsb2dNZXNzYWdlLCB2aWV3LmNpZCwgXCJyZXNvbHZlZFwiLCBcInByZWZldGNoZWRcIik7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2aWV3Lm1lZGlhU3RhdGUgPSBcInBlbmRpbmdcIjtcblxuXHRcdFx0dmFyIHNVcmwgPSBzb3VyY2UuZ2V0KFwib3JpZ2luYWxcIik7XG5cdFx0XHR2YXIgcHJvZ3Jlc3NGbiA9IGZ1bmN0aW9uKHByb2dyZXNzKSB7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKGxvZ01lc3NhZ2UsIHZpZXcuY2lkLCBcInByb2dyZXNzXCIsIHByb2dyZXNzKTtcblx0XHRcdFx0dmlldy51cGRhdGVNZWRpYVByb2dyZXNzKHByb2dyZXNzLCBzVXJsKTtcblx0XHRcdH07XG5cdFx0XHRwcm9ncmVzc0ZuID0gXy50aHJvdHRsZShwcm9ncmVzc0ZuLCAxMDAsIHtcblx0XHRcdFx0bGVhZGluZzogdHJ1ZSxcblx0XHRcdFx0dHJhaWxpbmc6IGZhbHNlXG5cdFx0XHR9KTtcblx0XHRcdF9sb2FkSW1hZ2VBc09iamVjdFVSTChzVXJsLCBwcm9ncmVzc0ZuKVxuXHRcdFx0XHQudGhlbihcblx0XHRcdFx0XHRmdW5jdGlvbih1cmwpIHtcblx0XHRcdFx0XHRcdGlmICgvXmJsb2JcXDouKi8udGVzdCh1cmwpKSB7XG5cdFx0XHRcdFx0XHRcdHNvdXJjZS5zZXQoXCJwcmVmZXRjaGVkXCIsIHVybCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR2aWV3LmRlZmF1bHRJbWFnZS5zcmMgPSB1cmw7XG5cdFx0XHRcdFx0XHQvLyBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdmlldy5kZWZhdWx0SW1hZ2U7XG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0LnRoZW4oX3doZW5JbWFnZUxvYWRzKVxuXHRcdFx0XHQudGhlbihcblx0XHRcdFx0XHRmdW5jdGlvbih0YXJnZXRFbCkge1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2cobG9nTWVzc2FnZSwgdmlldy5jaWQsIFwicmVzb2x2ZWRcIiwgdGFyZ2V0RWwuc3JjKTtcblx0XHRcdFx0XHRcdHZpZXcub24oXCJ2aWV3OnJlbW92ZWRcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBwcmVmZXRjaGVkID0gc291cmNlLmdldChcInByZWZldGNoZWRcIik7XG5cdFx0XHRcdFx0XHRcdGlmIChwcmVmZXRjaGVkICYmIC9eYmxvYlxcOi8udGVzdChwcmVmZXRjaGVkKSkge1xuXHRcdFx0XHRcdFx0XHRcdHNvdXJjZS51bnNldChcInByZWZldGNoZWRcIiwge1xuXHRcdFx0XHRcdFx0XHRcdFx0c2lsZW50OiB0cnVlXG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFx0VVJMLnJldm9rZU9iamVjdFVSTChwcmVmZXRjaGVkKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHQvLyB2aWV3LnBsYWNlaG9sZGVyLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHJvZ3Jlc3NcIik7XG5cdFx0XHRcdFx0XHQvLyB2aWV3LnVwZGF0ZU1lZGlhUHJvZ3Jlc3MoaW1hZ2VVcmwsIFwiY29tcGxldGVcIik7XG5cdFx0XHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0Ly8gXHR9KVxuXHRcdFx0XHRcdC8vIC5jYXRjaChcblx0XHRcdFx0XHRmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0XHRcdC8vIGNvbnNvbGUud2Fybihsb2dNZXNzYWdlLCB2aWV3LmNpZCwgXCJyZWplY3RlZFwiLCBlcnIubWVzc2FnZSk7XG5cdFx0XHRcdFx0XHQvLyB2aWV3LnBsYWNlaG9sZGVyLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHJvZ3Jlc3NcIik7XG5cdFx0XHRcdFx0XHQvLyB2aWV3LnVwZGF0ZU1lZGlhUHJvZ3Jlc3MoaW1hZ2VVcmwsIHByb2dyZXNzKTtcblx0XHRcdFx0XHRcdHJlamVjdChlcnIpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdH1cblx0fSk7XG59OyIsIi8qIGdsb2JhbCBQcm9taXNlICovXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXdFcnJvcn0gKi9cbnZhciBWaWV3RXJyb3IgPSByZXF1aXJlKFwiYXBwL3ZpZXcvYmFzZS9WaWV3RXJyb3JcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld0Vycm9yfSAqL1xudmFyIHdoZW5WaWV3SXNBdHRhY2hlZCA9IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL3doZW5WaWV3SXNBdHRhY2hlZFwiKTtcblxuZnVuY3Rpb24gd2hlblNjcm9sbGluZ0VuZHModmlldykge1xuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0dmFyIHBhcmVudCA9IHZpZXcucGFyZW50Vmlldztcblx0XHRpZiAocGFyZW50ID09PSBudWxsKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiJXM6OndoZW5TY3JvbGxpbmdFbmRzIFslc10gKHN5bmMpXCIsIHZpZXcuY2lkLCBcInJlamVjdGVkXCIsIHZpZXcuYXR0YWNoZWQpO1xuXHRcdFx0cmVqZWN0KG5ldyBWaWV3RXJyb3IodmlldywgbmV3IEVycm9yKFwid2hlblNjcm9sbGluZ0VuZHM6IHZpZXcgaGFzIG5vIHBhcmVudFwiKSkpO1xuXHRcdH0gZWxzZSBpZiAoIXBhcmVudC5zY3JvbGxpbmcpIHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OndoZW5TY3JvbGxpbmdFbmRzIFslc10gKHN5bmMpXCIsIHZpZXcuY2lkLCBcInJlc29sdmVkXCIsIHZpZXcuYXR0YWNoZWQpO1xuXHRcdFx0cmVzb2x2ZSh2aWV3KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dmFyIGNsZWFudXAgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0cGFyZW50Lm9mZihcInZpZXc6c2Nyb2xsZW5kXCIsIG9uU2Nyb2xsZW5kKTtcblx0XHRcdFx0cGFyZW50Lm9mZihcInZpZXc6cmVtb3ZlXCIsIG9uUmVtb3ZlKTtcblx0XHRcdH07XG5cdFx0XHR2YXIgb25TY3JvbGxlbmQgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6d2hlblNjcm9sbGluZ0VuZHMgWyVzXVwiLCB2aWV3LmNpZCwgXCJyZXNvbHZlZFwiLCB2aWV3LmF0dGFjaGVkKTtcblx0XHRcdFx0Y2xlYW51cCgpO1xuXHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0fTtcblx0XHRcdHZhciBvblJlbW92ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp3aGVuU2Nyb2xsaW5nRW5kcyBbJXNdXCIsIHZpZXcuY2lkLCBcInJlamVjdGVkXCIsIHZpZXcuYXR0YWNoZWQpO1xuXHRcdFx0XHRjbGVhbnVwKCk7XG5cdFx0XHRcdHJlamVjdChuZXcgVmlld0Vycm9yKHZpZXcsIG5ldyBFcnJvcihcIndoZW5TY3JvbGxpbmdFbmRzOiB2aWV3IHdhcyByZW1vdmVkXCIpKSk7XG5cdFx0XHR9O1xuXHRcdFx0cGFyZW50Lm9uKFwidmlldzpzY3JvbGxlbmRcIiwgb25TY3JvbGxlbmQpO1xuXHRcdFx0cGFyZW50Lm9uKFwidmlldzpyZW1vdmVcIiwgb25SZW1vdmUpO1xuXHRcdH1cblx0fSk7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24odmlldykge1xuXHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHZpZXcpXG5cdFx0LnRoZW4od2hlblZpZXdJc0F0dGFjaGVkKVxuXHRcdC50aGVuKHdoZW5TY3JvbGxpbmdFbmRzKTtcbn07XG5cbi8qXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSh2aWV3KVxuXHRcdC50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdGlmICh2aWV3LmF0dGFjaGVkKSB7XG5cdFx0XHRcdHJldHVybiB2aWV3O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0XHRcdHZpZXcub25jZShcInZpZXc6YXR0YWNoZWRcIiwgZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHRcdFx0cmVzb2x2ZSh2aWV3KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSlcblx0XHQudGhlbihmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRpZiAoIXZpZXcucGFyZW50Vmlldy5zY3JvbGxpbmcpIHtcblx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRcdFx0dmFyIHJlc29sdmVPblNjcm9sbGVuZCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6d2hlblNjcm9sbGluZ0VuZHMgWyVzXVwiLCB2aWV3LmNpZCwgXCJyZXNvbHZlZFwiKTtcblx0XHRcdFx0XHRcdHZpZXcub2ZmKFwidmlldzpyZW1vdmVcIiwgcmVqZWN0T25SZW1vdmUpO1xuXHRcdFx0XHRcdFx0cmVzb2x2ZSh2aWV3KTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdHZhciByZWplY3RPblJlbW92ZSA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6OndoZW5TY3JvbGxpbmdFbmRzIFslc11cIiwgdmlldy5jaWQsIFwicmVqZWN0ZWRcIik7XG5cdFx0XHRcdFx0XHR2aWV3LnBhcmVudFZpZXcub2ZmKFwidmlldzpzY3JvbGxlbmRcIiwgcmVzb2x2ZU9uU2Nyb2xsZW5kKTtcblx0XHRcdFx0XHRcdHJlamVjdChuZXcgVmlld0Vycm9yKHZpZXcsXG5cdFx0XHRcdFx0XHRcdG5ldyBFcnJvcihcIndoZW5TZWxlY3RTY3JvbGxpbmdFbmRzOiB2aWV3IHdhcyByZW1vdmVkIChcIisgdmlldy5jaWQgK1wiKVwiKSkpO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0dmlldy5wYXJlbnRWaWV3Lm9uY2UoXCJ2aWV3OnNjcm9sbGVuZFwiLCByZXNvbHZlT25TY3JvbGxlbmQpO1xuXHRcdFx0XHRcdHZpZXcub25jZShcInZpZXc6cmVtb3ZlXCIsIHJlamVjdE9uUmVtb3ZlKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG59O1xuKi9cbiIsIi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld0Vycm9yfSAqL1xudmFyIFZpZXdFcnJvciA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdFcnJvclwiKTtcblxuLy8gdmFyIGxvZ01lc3NhZ2UgPSBcIiVzOjp3aGVuU2VsZWN0aW9uRGlzdGFuY2VJcyBbJXNdOiAlc1wiO1xuXG4vKipcbiAqIEBwYXJhbSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld31cbiAqIEBwYXJhbSB7bnVtYmVyfSBkaXN0YW5jZVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHZpZXcsIGRpc3RhbmNlKSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHQvLyBpZiAoISh2aWV3Lm1vZGVsICYmIHZpZXcubW9kZWwuY29sbGVjdGlvbikpIHtcblx0XHQvLyBcdHJlamVjdChuZXcgVmlld0Vycm9yKHZpZXcsIG5ldyBFcnJvcihcIndoZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXM6IG1vZGVsLmNvbGxlY3Rpb24gaXMgZW1wdHlcIikpKTtcblx0XHQvLyB9XG5cdFx0dmFyIG1vZGVsID0gdmlldy5tb2RlbDtcblx0XHR2YXIgY29sbGVjdGlvbiA9IG1vZGVsLmNvbGxlY3Rpb247XG5cblx0XHR2YXIgY2hlY2sgPSBmdW5jdGlvbihuKSB7IC8vIENoZWNrIGluZGljZXMgZm9yIGNvbnRpZ3VpdHlcblx0XHRcdHJldHVybiBNYXRoLmFicyhjb2xsZWN0aW9uLmluZGV4T2YobW9kZWwpIC0gY29sbGVjdGlvbi5zZWxlY3RlZEluZGV4KSA8PSBkaXN0YW5jZTtcblx0XHR9O1xuXG5cdFx0aWYgKGNoZWNrKCkpIHtcblx0XHRcdC8vIGNvbnNvbGUubG9nKGxvZ01lc3NhZ2UsIHZpZXcuY2lkLCBcInJlc29sdmVcIiwgXCJzeW5jXCIpO1xuXHRcdFx0cmVzb2x2ZSh2aWV3KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dmFyIGNsZWFudXBPblNldHRsZSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhsb2dNZXNzYWdlLCB2aWV3LmNpZCwgXCJjbGVhbnVwXCIsIFwiYXN5bmNcIik7XG5cdFx0XHRcdGNvbGxlY3Rpb24ub2ZmKFwic2VsZWN0Om9uZSBzZWxlY3Q6bm9uZVwiLCByZXNvbHZlT25TZWxlY3QpO1xuXHRcdFx0XHR2aWV3Lm9mZihcInZpZXc6cmVtb3ZlZFwiLCByZWplY3RPblJlbW92ZSk7XG5cdFx0XHR9O1xuXHRcdFx0dmFyIHJlc29sdmVPblNlbGVjdCA9IGZ1bmN0aW9uKG1vZGVsKSB7XG5cdFx0XHRcdGlmIChjaGVjaygpKSB7XG5cdFx0XHRcdFx0Ly8gY29uc29sZS5sb2cobG9nTWVzc2FnZSwgdmlldy5jaWQsIFwicmVzb2x2ZVwiLCBcImFzeW5jXCIpO1xuXHRcdFx0XHRcdGNsZWFudXBPblNldHRsZSgpO1xuXHRcdFx0XHRcdHJlc29sdmUodmlldyk7XG5cdFx0XHRcdH1cblx0XHRcdH07XG5cdFx0XHR2YXIgcmVqZWN0T25SZW1vdmUgPSBmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdGNsZWFudXBPblNldHRsZSgpO1xuXHRcdFx0XHRyZWplY3QobmV3IFZpZXdFcnJvcih2aWV3LCBuZXcgRXJyb3IoXCJ3aGVuU2VsZWN0aW9uRGlzdGFuY2VJczogdmlldyB3YXMgcmVtb3ZlZFwiKSkpO1xuXHRcdFx0fTtcblx0XHRcdGNvbGxlY3Rpb24ub24oXCJzZWxlY3Q6b25lIHNlbGVjdDpub25lXCIsIHJlc29sdmVPblNlbGVjdCk7XG5cdFx0XHR2aWV3Lm9uKFwidmlldzpyZW1vdmVkXCIsIHJlamVjdE9uUmVtb3ZlKTtcblx0XHR9XG5cdH0pO1xufTtcbiIsIi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld0Vycm9yfSAqL1xuLy8gdmFyIFZpZXdFcnJvciA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdFcnJvclwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS93aGVuU2VsZWN0aW9uRGlzdGFuY2VJc30gKi9cbnZhciB3aGVuU2VsZWN0aW9uRGlzdGFuY2VJcyA9IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3Rpb25EaXN0YW5jZUlzXCIpO1xuXG4vKiogQHBhcmFtIHttb2R1bGU6YXBwL3ZpZXcvYmFzZS9WaWV3fSAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih2aWV3KSB7XG5cdHJldHVybiB3aGVuU2VsZWN0aW9uRGlzdGFuY2VJcyh2aWV3LCAxKTtcbn07IiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbih2aWV3KSB7XG5cdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0XHRpZiAodmlldy5hdHRhY2hlZCkge1xuXHRcdFx0cmVzb2x2ZSh2aWV3KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dmlldy5vbihcInZpZXc6YXR0YWNoZWRcIiwgZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHRyZXNvbHZlKHZpZXcpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHZpZXcpIHtcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdGlmICghdmlldy5pbnZhbGlkYXRlZCkge1xuXHRcdFx0cmVzb2x2ZSh2aWV3KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dmlldy5vbmNlKFwidmlldzpyZW5kZXI6YWZ0ZXJcIiwgZnVuY3Rpb24odmlldywgZmxhZ3MpIHtcblx0XHRcdFx0cmVzb2x2ZSh2aWV3KTtcblx0XHRcdH0pO1xuXHRcdH1cblx0fSk7XG59OyIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvQ2Fyb3VzZWxSZW5kZXJlclxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIGdldEJveEVkZ2VTdHlsZXMgPSByZXF1aXJlKFwidXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXNcIik7XG5cbi8vIEZJWE1FOiB0aGlzIGZpeHVwIHNob3VsZCBub3QgYmUgZG9uZSBoZXJlXG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9uZXQvdG9BYnNvbHV0ZVVSTH0gKi9cbi8vIHZhciB0b0Fic29sdXRlVVJMID0gcmVxdWlyZShcInV0aWxzL25ldC90b0Fic29sdXRlVVJMXCIpO1xuLy8gLyoqIEB0eXBlIHtzdHJpbmd9ICovXG4vLyB2YXIgQUJTX0FQUF9ST09UID0gdG9BYnNvbHV0ZVVSTChyZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKS5BUFBfUk9PVCk7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9DYXJvdXNlbFJlbmRlcmVyfVxuICovXG52YXIgQ2Fyb3VzZWxSZW5kZXJlciA9IFZpZXcuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcImNhcm91c2VsUmVuZGVyZXJcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0YWdOYW1lOiBcImRpdlwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJjYXJvdXNlbC1pdGVtXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGVtcGxhdGU6IF8udGVtcGxhdGUoXCI8ZGl2IGNsYXNzPVxcXCJjb250ZW50IHNpemluZ1xcXCI+PCU9IG5hbWUgJT48L2Rpdj5cIiksXG5cblx0cHJvcGVydGllczoge1xuXHRcdGNvbnRlbnQ6IHtcblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9jb250ZW50IHx8ICh0aGlzLl9jb250ZW50ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRlbnRcIikpO1xuXHRcdFx0fSxcblx0XHR9LFxuXHRcdHNpemluZzoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX3NpemluZyB8fCAodGhpcy5fc2l6aW5nID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnNpemluZ1wiKSk7XG5cdFx0XHR9LFxuXHRcdH1cblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRpZiAodGhpcy5tb2RlbC5hdHRyKFwiQGNsYXNzbmFtZVwiKSAhPT0gdm9pZCAwKSB7XG5cdFx0XHR2YXIgY2xzQXR0ciA9IHRoaXMubW9kZWwuYXR0cihcIkBjbGFzc25hbWVcIikuc3BsaXQoXCIgXCIpO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjbHNBdHRyLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChjbHNBdHRyW2ldKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0b3B0aW9ucy5wYXJlbnRWaWV3ICYmICh0aGlzLnBhcmVudFZpZXcgPSBvcHRpb25zLnBhcmVudFZpZXcpO1xuXHRcdHRoaXMubWV0cmljcyA9IHt9O1xuXHRcdHRoaXMubWV0cmljcy5jb250ZW50ID0ge307XG5cdFx0dGhpcy5jcmVhdGVDaGlsZHJlbigpO1xuXHRcdC8vIHRoaXMuZW5hYmxlZCA9ICEhb3B0aW9ucy5lbmFibGVkOyAvLyBmb3JjZSBib29sXG5cdFx0dGhpcy5zZXRFbmFibGVkKCEhb3B0aW9ucy5lbmFibGVkKTtcblx0fSxcblxuXHRjcmVhdGVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwudG9KU09OKCkpO1xuXHRcdC8vIEZJWE1FOiB0aGlzIGZpeHVwIHNob3VsZCBub3QgYmUgZG9uZSBoZXJlXG5cdFx0Ly8gRklYRUQ6IG5vdyBkb25lIGluIHhzbHRcblx0XHQvKnRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcImFbaHJlZl1cIikuZm9yRWFjaChmdW5jdGlvbihlbCkge1xuXHRcdFx0dmFyIHVybCA9IHRvQWJzb2x1dGVVUkwoZWwuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKSk7XG5cdFx0XHRpZiAodXJsLmluZGV4T2YoQUJTX0FQUF9ST09UKSAhPT0gMCkge1xuXHRcdFx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJ0YXJnZXRcIiwgXCJfYmxhbmtcIik7XG5cdFx0XHR9XG5cdFx0fSk7Ki9cblx0fSxcblxuXHQvKiogQHJldHVybiB7SFRNTEVsZW1lbnR9ICovXG5cdGdldFNpemluZ0VsOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5fc2l6aW5nIHx8ICh0aGlzLl9zaXppbmcgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIuc2l6aW5nXCIpKTtcblx0fSxcblxuXHQvKiogQHJldHVybiB7SFRNTEVsZW1lbnR9ICovXG5cdGdldENvbnRlbnRFbDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuX2NvbnRlbnQgfHwgKHRoaXMuX2NvbnRlbnQgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudFwiKSk7XG5cdH0sXG5cblx0LyoqIEByZXR1cm4ge3RoaXN9ICovXG5cdG1lYXN1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBzaXppbmcgPSB0aGlzLmdldFNpemluZ0VsKCk7XG5cblx0XHR0aGlzLm1ldHJpY3MgPSBnZXRCb3hFZGdlU3R5bGVzKHRoaXMuZWwsIHRoaXMubWV0cmljcyk7XG5cdFx0dGhpcy5tZXRyaWNzLmNvbnRlbnQgPSBnZXRCb3hFZGdlU3R5bGVzKHRoaXMuZ2V0Q29udGVudEVsKCksIHRoaXMubWV0cmljcy5jb250ZW50KTtcblxuXHRcdHNpemluZy5zdHlsZS5tYXhXaWR0aCA9IFwiXCI7XG5cdFx0c2l6aW5nLnN0eWxlLm1heEhlaWdodCA9IFwiXCI7XG5cblx0XHR0aGlzLm1ldHJpY3MuY29udGVudC54ID0gc2l6aW5nLm9mZnNldExlZnQgKyBzaXppbmcuY2xpZW50TGVmdDtcblx0XHR0aGlzLm1ldHJpY3MuY29udGVudC55ID0gc2l6aW5nLm9mZnNldFRvcCArIHNpemluZy5jbGllbnRUb3A7XG5cdFx0dGhpcy5tZXRyaWNzLmNvbnRlbnQud2lkdGggPSBzaXppbmcuY2xpZW50V2lkdGg7XG5cdFx0dGhpcy5tZXRyaWNzLmNvbnRlbnQuaGVpZ2h0ID0gc2l6aW5nLmNsaWVudEhlaWdodDtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLm1lYXN1cmUoKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRnZXRTZWxlY3Rpb25EaXN0YW5jZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIE1hdGguYWJzKHRoaXMubW9kZWwuY29sbGVjdGlvbi5pbmRleE9mKHRoaXMubW9kZWwpIC0gdGhpcy5tb2RlbC5jb2xsZWN0aW9uLnNlbGVjdGVkSW5kZXgpO1xuXHR9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQ2Fyb3VzZWxSZW5kZXJlcjsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL0NsaWNrYWJsZVJlbmRlcmVyXG4gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0xhYmVsUmVuZGVyZXJ9ICovXG52YXIgTGFiZWxSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvTGFiZWxSZW5kZXJlclwiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0NsaWNrYWJsZVJlbmRlcmVyfVxuICovXG52YXIgQ2xpY2thYmxlUmVuZGVyZXIgPSBMYWJlbFJlbmRlcmVyLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJjbGlja2FibGVSZW5kZXJlclwiLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0ZXZlbnRzOiB7XG5cdFx0XCJjbGlja1wiOiBmdW5jdGlvbihldikge1xuXHRcdFx0dGhpcy50cmlnZ2VyKFwicmVuZGVyZXI6Y2xpY2tcIiwgdGhpcy5tb2RlbCwgZXYpO1xuXHRcdH0sXG5cdFx0XCJjbGljayBhXCI6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRldi5kZWZhdWx0UHJldmVudGVkIHx8IGV2LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0fVxuXHR9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQ2xpY2thYmxlUmVuZGVyZXI7XG4iLCIvLyBoYnNmeSBjb21waWxlZCBIYW5kbGViYXJzIHRlbXBsYXRlXG52YXIgSGFuZGxlYmFyc0NvbXBpbGVyID0gcmVxdWlyZSgnaGJzZnkvcnVudGltZScpO1xubW9kdWxlLmV4cG9ydHMgPSBIYW5kbGViYXJzQ29tcGlsZXIudGVtcGxhdGUoe1wiY29tcGlsZXJcIjpbNyxcIj49IDQuMC4wXCJdLFwibWFpblwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIHN0YWNrMSwgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWhlbHBlcnMuaGVscGVyTWlzc2luZywgYWxpYXMzPVwiZnVuY3Rpb25cIjtcblxuICByZXR1cm4gXCI8YSBocmVmPVxcXCIjXCJcbiAgICArIGNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuZG9taWQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmRvbWlkIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJkb21pZFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiPjxzcGFuIGNsYXNzPVxcXCJsYWJlbFxcXCI+XCJcbiAgICArICgoc3RhY2sxID0gKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5uYW1lIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5uYW1lIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJuYW1lXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpICE9IG51bGwgPyBzdGFjazEgOiBcIlwiKVxuICAgICsgXCI8L3NwYW4+PC9hPlwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL0RlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXJcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvQ2xpY2thYmxlUmVuZGVyZXJ9ICovXG52YXIgQ2xpY2thYmxlUmVuZGVyZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcmVuZGVyL0NsaWNrYWJsZVJlbmRlcmVyXCIpO1xuXG4vKipcbiAqIEBjb25zdHJ1Y3RvclxuICogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlcn1cbiAqL1xudmFyIERlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXIgPSBDbGlja2FibGVSZW5kZXJlci5leHRlbmQoe1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dGFnTmFtZTogXCJsaVwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNsYXNzTmFtZTogXCJsaXN0LWl0ZW1cIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0ZW1wbGF0ZTogcmVxdWlyZShcIi4vRGVmYXVsdFNlbGVjdGFibGVSZW5kZXJlci5oYnNcIiksXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJzZWxlY3RlZCBkZXNlbGVjdGVkXCIsIHRoaXMuX3JlbmRlckNsYXNzTGlzdCk7XG5cdFx0dGhpcy5fcmVuZGVyQ2xhc3NMaXN0KCk7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuZWwuaW5uZXJIVE1MID0gdGhpcy50ZW1wbGF0ZSh0aGlzLm1vZGVsLnRvSlNPTigpKTtcblx0XHR0aGlzLl9yZW5kZXJDbGFzc0xpc3QoKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRfcmVuZGVyQ2xhc3NMaXN0OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLmVsLmNsYXNzTGlzdC50b2dnbGUoXCJzZWxlY3RlZFwiLCB0aGlzLm1vZGVsLnNlbGVjdGVkKTtcblx0fSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IERlZmF1bHRTZWxlY3RhYmxlUmVuZGVyZXI7XG4iLCIvLyBoYnNmeSBjb21waWxlZCBIYW5kbGViYXJzIHRlbXBsYXRlXG52YXIgSGFuZGxlYmFyc0NvbXBpbGVyID0gcmVxdWlyZSgnaGJzZnkvcnVudGltZScpO1xubW9kdWxlLmV4cG9ydHMgPSBIYW5kbGViYXJzQ29tcGlsZXIudGVtcGxhdGUoe1wiY29tcGlsZXJcIjpbNyxcIj49IDQuMC4wXCJdLFwibWFpblwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIGhlbHBlciwgYWxpYXMxPWRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge30sIGFsaWFzMj1oZWxwZXJzLmhlbHBlck1pc3NpbmcsIGFsaWFzMz1cImZ1bmN0aW9uXCIsIGFsaWFzND1jb250YWluZXIuZXNjYXBlRXhwcmVzc2lvbjtcblxuICByZXR1cm4gXCI8c3BhbiBjbGFzcz1cXFwibGFiZWxcXFwiPlwiXG4gICAgKyBhbGlhczQoKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5uYW1lIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5uYW1lIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJuYW1lXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIjwvc3Bhbj48YSBocmVmPVxcXCIjXCJcbiAgICArIGFsaWFzNCgoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLmRvbWlkIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5kb21pZCA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwiZG9taWRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiXFxcIj48Yj4gPC9iPjwvYT5cIjtcbn0sXCJ1c2VEYXRhXCI6dHJ1ZX0pO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L3JlbmRlci9Eb3ROYXZpZ2F0aW9uUmVuZGVyZXJcbiAqL1xuXG4vLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xuLy8gdmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmJhY2tib25lfSAqL1xuLy8gdmFyIEJhY2tib25lID0gcmVxdWlyZShcImJhY2tib25lXCIpO1xuLyoqIEB0eXBlIHtzdHJpbmd9ICovXG52YXIgdmlld1RlbXBsYXRlID0gcmVxdWlyZShcIi4vRG90TmF2aWdhdGlvblJlbmRlcmVyLmhic1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9DbGlja2FibGVSZW5kZXJlcn0gKi9cbnZhciBDbGlja2FibGVSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvQ2xpY2thYmxlUmVuZGVyZXJcIik7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9Eb3ROYXZpZ2F0aW9uUmVuZGVyZXJ9XG4gKi9cbnZhciBEb3ROYXZpZ2F0aW9uUmVuZGVyZXIgPSBDbGlja2FibGVSZW5kZXJlci5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwiZG90UmVuZGVyZXJcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0YWdOYW1lOiBcImxpXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2xhc3NOYW1lOiBcImxpc3QtaXRlbVwiLFxuXHQvKiogQG92ZXJyaWRlICovXG5cdHRlbXBsYXRlOiB2aWV3VGVtcGxhdGUsXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkIGRlc2VsZWN0ZWRcIiwgdGhpcy5yZW5kZXJDbGFzc0xpc3QpO1xuXHRcdHRoaXMucmVuZGVyQ2xhc3NMaXN0KCk7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuZWwuaW5uZXJIVE1MID0gdGhpcy50ZW1wbGF0ZSh0aGlzLm1vZGVsLnRvSlNPTigpKTtcblx0XHR0aGlzLnJlbmRlckNsYXNzTGlzdCgpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHJlbmRlckNsYXNzTGlzdDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwic2VsZWN0ZWRcIiwgdGhpcy5tb2RlbC5zZWxlY3RlZCk7XG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBEb3ROYXZpZ2F0aW9uUmVuZGVyZXI7XG4iLCIvLyBoYnNmeSBjb21waWxlZCBIYW5kbGViYXJzIHRlbXBsYXRlXG52YXIgSGFuZGxlYmFyc0NvbXBpbGVyID0gcmVxdWlyZSgnaGJzZnkvcnVudGltZScpO1xubW9kdWxlLmV4cG9ydHMgPSBIYW5kbGViYXJzQ29tcGlsZXIudGVtcGxhdGUoe1wiY29tcGlsZXJcIjpbNyxcIj49IDQuMC4wXCJdLFwibWFpblwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIGhlbHBlciwgYWxpYXMxPWRlcHRoMCAhPSBudWxsID8gZGVwdGgwIDoge30sIGFsaWFzMj1oZWxwZXJzLmhlbHBlck1pc3NpbmcsIGFsaWFzMz1cImZ1bmN0aW9uXCIsIGFsaWFzND1jb250YWluZXIuZXNjYXBlRXhwcmVzc2lvbjtcblxuICByZXR1cm4gXCI8ZGl2IGNsYXNzPVxcXCJwbGFjZWhvbGRlciBzaXppbmdcXFwiPjwvZGl2PlxcbjxpbWcgY2xhc3M9XFxcImNvbnRlbnQgbWVkaWEtYm9yZGVyIGRlZmF1bHRcXFwiIGFsdD1cXFwiXCJcbiAgICArIGFsaWFzNCgoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLnRleHQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLnRleHQgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcInRleHRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiXFxcIiBsb25nZGVzYz1cXFwiI2Rlc2NfbVwiXG4gICAgKyBhbGlhczQoKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5pZCB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuaWQgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcImlkXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIlxcXCIgLz5cXG5cIjtcbn0sXCJ1c2VEYXRhXCI6dHJ1ZX0pO1xuIiwiLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L3JlbmRlci9JbWFnZVJlbmRlcmVyXG4gKi9cblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbi8vIHZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL2NvbnRyb2wvR2xvYmFsc30gKi9cbi8vIHZhciBHbG9iYWxzID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTphcHAvbW9kZWwvaXRlbS9NZWRpYUl0ZW19ICovXG4vLyB2YXIgTWVkaWFJdGVtID0gcmVxdWlyZShcImFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbVwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvTWVkaWFSZW5kZXJlcn0gKi9cbnZhciBNZWRpYVJlbmRlcmVyID0gcmVxdWlyZShcIi4vTWVkaWFSZW5kZXJlclwiKTtcblxuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciB2aWV3VGVtcGxhdGUgPSByZXF1aXJlKFwiLi9JbWFnZVJlbmRlcmVyLmhic1wiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0ltYWdlUmVuZGVyZXJ9XG4gKi9cbnZhciBJbWFnZVJlbmRlcmVyID0gTWVkaWFSZW5kZXJlci5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwiaW1hZ2VSZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2xhc3NOYW1lOiBNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5jbGFzc05hbWUgKyBcIiBpbWFnZS1yZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHR0ZW1wbGF0ZTogdmlld1RlbXBsYXRlLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0cykge1xuXHRcdE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHQvLyB0aGlzLmNyZWF0ZUNoaWxkcmVuKCk7XG5cdFx0Ly8gdGhpcy5pbml0aWFsaXplQXN5bmMoKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBjaGlsZHJlbi9sYXlvdXRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjcmVhdGVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0TWVkaWFSZW5kZXJlci5wcm90b3R5cGUuY3JlYXRlQ2hpbGRyZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHQvLyB0aGlzLmVsLmlubmVySFRNTCA9IHRoaXMudGVtcGxhdGUodGhpcy5tb2RlbC50b0pTT04oKSk7XG5cdFx0dGhpcy5wbGFjZWhvbGRlciA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5wbGFjZWhvbGRlclwiKTtcblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0TWVkaWFSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHQvLyB0aGlzLm1lYXN1cmUoKTtcblxuXHRcdHZhciBpbWcgPSB0aGlzLmdldERlZmF1bHRJbWFnZSgpO1xuXHRcdGltZy5zZXRBdHRyaWJ1dGUoXCJ3aWR0aFwiLCB0aGlzLm1ldHJpY3MubWVkaWEud2lkdGgpO1xuXHRcdGltZy5zZXRBdHRyaWJ1dGUoXCJoZWlnaHRcIiwgdGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCk7XG5cblx0XHR2YXIgY29udGVudCA9IHRoaXMuZ2V0Q29udGVudEVsKCk7XG5cdFx0Y29udGVudC5zdHlsZS5sZWZ0ID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQueCArIFwicHhcIjtcblx0XHRjb250ZW50LnN0eWxlLnRvcCA9IHRoaXMubWV0cmljcy5jb250ZW50LnkgKyBcInB4XCI7XG5cblx0XHQvLyB2YXIgc2l6aW5nID0gdGhpcy5nZXRTaXppbmdFbCgpO1xuXHRcdC8vIHNpemluZy5zdHlsZS5tYXhXaWR0aCA9IHRoaXMubWV0cmljcy5jb250ZW50LndpZHRoICsgXCJweFwiO1xuXHRcdC8vIHNpemluZy5zdHlsZS5tYXhIZWlnaHQgPSB0aGlzLm1ldHJpY3MuY29udGVudC5oZWlnaHQgKyBcInB4XCI7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBpbml0aWFsaXplQXN5bmNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0aW5pdGlhbGl6ZUFzeW5jOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gTWVkaWFSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cylcblx0XHQvLyByZXR1cm4gTWVkaWFSZW5kZXJlci53aGVuU2VsZWN0aW9uSXNDb250aWd1b3VzKHRoaXMpXG5cdFx0Ly8gLy8gcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzKVxuXHRcdC8vIC8vIFx0LnRoZW4oTWVkaWFSZW5kZXJlci53aGVuU2VsZWN0aW9uSXNDb250aWd1b3VzKVxuXHRcdC8vIFx0LnRoZW4oTWVkaWFSZW5kZXJlci53aGVuU2VsZWN0VHJhbnNpdGlvbkVuZHMpXG5cdFx0Ly8gXHQudGhlbihNZWRpYVJlbmRlcmVyLndoZW5EZWZhdWx0SW1hZ2VMb2Fkcylcblx0XHQvLyAudGhlbihcblx0XHQvLyBcdGZ1bmN0aW9uKHZpZXcpIHtcblx0XHQvLyBcdFx0dmlldy5tZWRpYVN0YXRlID0gXCJyZWFkeVwiO1xuXHRcdC8vIFx0fSlcblx0XHQvLyAuY2F0Y2goXG5cdFx0Ly8gXHRmdW5jdGlvbihlcnIpIHtcblx0XHQvLyBcdFx0aWYgKGVyciBpbnN0YW5jZW9mIFZpZXdFcnJvcikge1xuXHRcdC8vIFx0XHRcdC8vIE5PVEU6IGlnbm9yZSBWaWV3RXJyb3IgdHlwZVxuXHRcdC8vIFx0XHRcdC8vIGNvbnNvbGUubG9nKGVyci52aWV3LmNpZCwgZXJyLnZpZXcubW9kZWwuY2lkLCBcIkltYWdlUmVuZGVyZXI6IFwiICsgZXJyLm1lc3NhZ2UpO1xuXHRcdC8vIFx0XHR9IGVsc2Uge1xuXHRcdC8vIFx0XHRcdGNvbnNvbGUuZXJyb3IodGhpcy5jaWQsIGVyci5uYW1lLCBlcnIpO1xuXHRcdC8vIFx0XHRcdHRoaXMucGxhY2Vob2xkZXIuaW5uZXJIVE1MID0gXCI8cCBjbGFzcz1cXFwiY29sb3ItZmdcXFwiIHN0eWxlPVxcXCJwb3NpdGlvbjphYnNvbHV0ZTtib3R0b206MDtwYWRkaW5nOjNyZW07XFxcIj48c3Ryb25nPlwiICsgZXJyLm5hbWUgKyBcIjwvc3Ryb25nPiBcIiArIGVyci5tZXNzYWdlICsgXCI8L3A+XCI7XG5cdFx0Ly8gXHRcdFx0dGhpcy5tZWRpYVN0YXRlID0gXCJlcnJvclwiO1xuXHRcdC8vIFx0XHR9XG5cdFx0Ly8gXHR9LmJpbmQodGhpcykpXG5cdFx0O1xuXHR9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gSW1hZ2VSZW5kZXJlcjtcbiIsIi8qKlxuICogQG1vZHVsZSBhcHAvdmlldy9yZW5kZXIvTGFiZWxSZW5kZXJlclxuICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2Jhc2UvVmlld30gKi9cbnZhciBWaWV3ID0gcmVxdWlyZShcImFwcC92aWV3L2Jhc2UvVmlld1wiKTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL0xhYmVsUmVuZGVyZXJ9XG4gKi9cbnZhciBMYWJlbFJlbmRlcmVyID0gVmlldy5leHRlbmQoe1xuXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjaWRQcmVmaXg6IFwibGFiZWxSZW5kZXJlclwiLFxuXG5cdHByb3BlcnRpZXM6IHtcblx0XHRsYWJlbDoge1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2xhYmVsIHx8ICh0aGlzLl9sYWJlbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5sYWJlbFwiKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIG1lYXN1cmVkV2lkdGg6IHtcblx0XHQvLyBcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gXHRcdHJldHVybiB0aGlzLl9tZWFzdXJlZFdpZHRoO1xuXHRcdC8vIFx0fVxuXHRcdC8vIH0sXG5cdFx0Ly8gbWVhc3VyZWRIZWlnaHQ6IHtcblx0XHQvLyBcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gXHRcdHJldHVybiB0aGlzLl9tZWFzdXJlZEhlaWdodDtcblx0XHQvLyBcdH1cblx0XHQvLyB9LFxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogbWVhc3VyZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gX21lYXN1cmVkV2lkdGg6IG51bGwsXG5cdC8vIF9tZWFzdXJlZEhlaWdodDogbnVsbCxcblx0Ly8gbWVhc3VyZTogZnVuY3Rpb24oKSB7fSxcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IExhYmVsUmVuZGVyZXI7XG4iLCIvKmdsb2JhbCBYTUxIdHRwUmVxdWVzdCwgSFRNTE1lZGlhRWxlbWVudCwgTWVkaWFFcnJvciovXG4vKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL01lZGlhUmVuZGVyZXJcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmUuc3RyaW5ncy9scGFkfSAqL1xudmFyIGxwYWQgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvbHBhZFwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL2Nzcy9nZXRCb3hFZGdlU3R5bGVzfSAqL1xuLy8gdmFyIGdldEJveEVkZ2VTdHlsZXMgPSByZXF1aXJlKFwidXRpbHMvY3NzL2dldEJveEVkZ2VTdHlsZXNcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9tb2RlbC9pdGVtL01lZGlhSXRlbX0gKi9cbnZhciBNZWRpYUl0ZW0gPSByZXF1aXJlKFwiYXBwL21vZGVsL2l0ZW0vTWVkaWFJdGVtXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvQ2Fyb3VzZWxSZW5kZXJlcn0gKi9cbnZhciBDYXJvdXNlbFJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9DYXJvdXNlbFJlbmRlcmVyXCIpO1xuXG52YXIgZXJyb3JUZW1wbGF0ZSA9IHJlcXVpcmUoXCIuLi90ZW1wbGF0ZS9FcnJvckJsb2NrLmhic1wiKTtcblxudmFyIE1lZGlhUmVuZGVyZXIgPSBDYXJvdXNlbFJlbmRlcmVyLmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNpZFByZWZpeDogXCJtZWRpYVJlbmRlcmVyXCIsXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xuXHRjbGFzc05hbWU6IENhcm91c2VsUmVuZGVyZXIucHJvdG90eXBlLmNsYXNzTmFtZSArIFwiIG1lZGlhLWl0ZW1cIixcblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL01lZGlhSXRlbX0gKi9cblx0bW9kZWw6IE1lZGlhSXRlbSxcblxuXHRwcm9wZXJ0aWVzOiB7XG5cdFx0ZGVmYXVsdEltYWdlOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fZGVmYXVsdEltYWdlIHx8ICh0aGlzLl9kZWZhdWx0SW1hZ2UgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCJpbWcuZGVmYXVsdFwiKSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHRtZWRpYVN0YXRlOiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fbWVkaWFTdGF0ZTtcblx0XHRcdH0sXG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKHN0YXRlKSB7XG5cdFx0XHRcdHRoaXMuX3NldE1lZGlhU3RhdGUoc3RhdGUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcblx0XHQvLyBpZiAodGhpcy5tb2RlbC5hdHRycygpLmhhc093blByb3BlcnR5KFwiQGNsYXNzbmFtZVwiKSkge1xuXHRcdC8vIFx0dGhpcy5lbC5jbGFzc05hbWUgKz0gXCIgXCIgKyB0aGlzLm1vZGVsLmF0dHIoXCJAY2xhc3NuYW1lXCIpO1xuXHRcdC8vIH1cblxuXHRcdC8vIE5PVEU6IEBjbGFzc25hbWUgYXR0ciBoYW5kbGluZyBtb3ZlZCB0byBDYXJvdXNlbFJlbmRlcmVyXG5cdFx0Ly8gaWYgKHRoaXMubW9kZWwuYXR0cihcIkBjbGFzc25hbWVcIikgIT09IHZvaWQgMCkge1xuXHRcdC8vIFx0dmFyIGNsc0F0dHIgPSB0aGlzLm1vZGVsLmF0dHIoXCJAY2xhc3NuYW1lXCIpLnNwbGl0KFwiIFwiKTtcblx0XHQvLyBcdGZvciAodmFyIGkgPSAwOyBpIDwgY2xzQXR0ci5sZW5ndGg7IGkrKykge1xuXHRcdC8vIFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5hZGQoY2xzQXR0cltpXSk7XG5cdFx0Ly8gXHR9XG5cdFx0Ly8gfVxuXHRcdENhcm91c2VsUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdHRoaXMubWV0cmljcy5tZWRpYSA9IHt9O1xuXHRcdHRoaXMubWVkaWFTdGF0ZSA9IFwiaWRsZVwiO1xuXG5cdFx0dGhpcy5pbml0aWFsaXplQXN5bmMoKVxuXHRcdFx0LnRoZW4odGhpcy53aGVuSW5pdGlhbGl6ZWQpXG5cdFx0XHQuY2F0Y2godGhpcy53aGVuSW5pdGlhbGl6ZUVycm9yLmJpbmQodGhpcykpO1xuXHR9LFxuXG5cdGluaXRpYWxpemVBc3luYzogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gdmFyIE1lZGlhUmVuZGVyZXIgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcykuY29uc3RydWN0b3I7XG5cdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzKVxuXHRcdFx0LnRoZW4oTWVkaWFSZW5kZXJlci53aGVuU2VsZWN0aW9uSXNDb250aWd1b3VzKVxuXHRcdFx0LnRoZW4oTWVkaWFSZW5kZXJlci53aGVuU2Nyb2xsaW5nRW5kcylcblx0XHRcdC50aGVuKE1lZGlhUmVuZGVyZXIud2hlbkRlZmF1bHRJbWFnZUxvYWRzKTtcblx0fSxcblxuXHR3aGVuSW5pdGlhbGl6ZWQ6IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp3aGVuSW5pdGlhbGl6ZWQgWyVzXVwiLCB2aWV3LmNpZCwgXCJyZXNvbHZlZFwiKTtcblx0XHR2aWV3Lm1lZGlhU3RhdGUgPSBcInJlYWR5XCI7XG5cdFx0dmlldy5wbGFjZWhvbGRlci5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXByb2dyZXNzXCIpO1xuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdHdoZW5Jbml0aWFsaXplRXJyb3I6IGZ1bmN0aW9uKGVycikge1xuXHRcdGlmIChlcnIgaW5zdGFuY2VvZiBDYXJvdXNlbFJlbmRlcmVyLlZpZXdFcnJvcikge1xuXHRcdFx0Ly8gTk9URTogaWdub3JlIFZpZXdFcnJvciB0eXBlXG5cdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp3aGVuSW5pdGlhbGl6ZUVycm9yXCIsIGVyci52aWV3LmNpZCwgZXJyLm1lc3NhZ2UpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH0gZWxzZSBpZiAoZXJyIGluc3RhbmNlb2YgRXJyb3IpIHtcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyLnN0YWNrKTtcblx0XHR9XG5cdFx0dGhpcy5yZW5kZXJNZWRpYUVycm9yKGVycik7XG5cdFx0dGhpcy5wbGFjZWhvbGRlci5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXByb2dyZXNzXCIpO1xuXHRcdHRoaXMubWVkaWFTdGF0ZSA9IFwiZXJyb3JcIjtcblx0XHQvLyB0aGlzLnBsYWNlaG9sZGVyLmlubmVySFRNTCA9IGVycm9yVGVtcGxhdGUoZXJyKTtcblx0XHQvLyB0aGlzLnBsYWNlaG9sZGVyLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHJvZ3Jlc3NcIik7XG5cdFx0Ly8gdGhpcy5tZWRpYVN0YXRlID0gXCJlcnJvclwiO1xuXG5cdFx0Y29uc29sZS5lcnJvcihcIiVzOjppbml0aWFsaXplQXN5bmMgWyVzIChjYXVnaHQpXTogJXNcIiwgdGhpcy5jaWQsIGVyci5uYW1lLFxuXHRcdFx0KGVyci5pbmZvICYmIGVyci5pbmZvLmxvZ01lc3NhZ2UpIHx8IGVyci5tZXNzYWdlKTtcblx0XHRlcnIubG9nRXZlbnQgJiYgY29uc29sZS5sb2coZXJyLmxvZ0V2ZW50KTtcblx0fSxcblxuXHRyZW5kZXJNZWRpYUVycm9yOiBmdW5jdGlvbihlcnIpIHtcblx0XHR0aGlzLnBsYWNlaG9sZGVyLmlubmVySFRNTCA9IGVyciA/IGVycm9yVGVtcGxhdGUoZXJyKSA6IFwiXCI7XG5cdH0sXG5cblx0dXBkYXRlTWVkaWFQcm9ncmVzczogZnVuY3Rpb24ocHJvZ3Jlc3MsIGlkKSB7XG5cdFx0aWYgKF8uaXNOdW1iZXIocHJvZ3Jlc3MpKSB7XG5cdFx0XHR0aGlzLnBsYWNlaG9sZGVyLnNldEF0dHJpYnV0ZShcImRhdGEtcHJvZ3Jlc3NcIiwgbHBhZChNYXRoLmZsb29yKHByb2dyZXNzICogMTAwKSwgMiwgJzAnKSk7XG5cdFx0fVxuXHRcdC8vIGVsc2UgaWYgKHByb2dyZXNzID09PSBcImNvbXBsZXRlXCIpIHtcblx0XHQvLyBcdHRoaXMucGxhY2Vob2xkZXIucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcm9ncmVzc1wiKTtcblx0XHQvLyB9XG5cdH0sXG5cblx0Ly8gd2hlbk1lZGlhSXNSZWFkeTogZnVuY3Rpb24odmlldykge1xuXHQvLyBcdHJldHVybiBNZWRpYVJlbmRlcmVyLndoZW5EZWZhdWx0SW1hZ2VMb2Fkcyh0aGlzLCB0aGlzLnVwZGF0ZU1lZGlhUHJvZ3Jlc3MuYmluZCh0aGlzKSk7XG5cdC8vIH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICpcblx0LyogY2hpbGQgZ2V0dGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQHJldHVybiB7SFRNTEVsZW1lbnR9ICovXG5cdGdldERlZmF1bHRJbWFnZTogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuZGVmYXVsdEltYWdlO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGNoaWxkcmVuL2xheW91dFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRjcmVhdGVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5pbm5lckhUTUwgPSB0aGlzLnRlbXBsYXRlKHRoaXMubW9kZWwudG9KU09OKCkpO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0bWVhc3VyZTogZnVuY3Rpb24oKSB7XG5cdFx0Q2Fyb3VzZWxSZW5kZXJlci5wcm90b3R5cGUubWVhc3VyZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0dmFyIHN3LCBzaDsgLy8gc291cmNlIGRpbWVuc2lvbnNcblx0XHR2YXIgcGN3LCBwY2g7IC8vIG1lYXN1cmVkIHZhbHVlc1xuXHRcdHZhciBjeCwgY3ksIGN3LCBjaCwgY3M7IC8vIGNvbXB1dGVkIHZhbHVlc1xuXHRcdHZhciBldywgZWg7IC8vIGNvbnRlbnQgZWRnZSB0b3RhbHNcblx0XHR2YXIgY207IC8vIGNvbnRlbnQgbWV0cmljc1xuXG5cdFx0Y20gPSB0aGlzLm1ldHJpY3MuY29udGVudDtcblx0XHRjeCA9IGNtLng7XG5cdFx0Y3kgPSBjbS55O1xuXHRcdHBjdyA9IGNtLndpZHRoO1xuXHRcdHBjaCA9IGNtLmhlaWdodDtcblxuXHRcdGV3ID0gKGNtLnBhZGRpbmdMZWZ0ICsgY20ucGFkZGluZ1JpZ2h0ICsgY20uYm9yZGVyTGVmdFdpZHRoICsgY20uYm9yZGVyUmlnaHRXaWR0aCk7XG5cdFx0ZWggPSAoY20ucGFkZGluZ1RvcCArIGNtLnBhZGRpbmdCb3R0b20gKyBjbS5ib3JkZXJUb3BXaWR0aCArIGNtLmJvcmRlckJvdHRvbVdpZHRoKTtcblx0XHRwY3cgLT0gZXc7XG5cdFx0cGNoIC09IGVoO1xuXG5cdFx0c3cgPSB0aGlzLm1vZGVsLmdldChcInNvdXJjZVwiKS5nZXQoXCJ3XCIpO1xuXHRcdHNoID0gdGhpcy5tb2RlbC5nZXQoXCJzb3VyY2VcIikuZ2V0KFwiaFwiKTtcblxuXHRcdC8vIFVubGVzcyBib3RoIGNsaWVudCBkaW1lbnNpb25zIGFyZSBsYXJnZXIgdGhhbiB0aGUgc291cmNlJ3Ncblx0XHQvLyBjaG9vc2UgY29uc3RyYWludCBkaXJlY3Rpb24gYnkgYXNwZWN0IHJhdGlvXG5cdFx0aWYgKHN3IDwgcGN3ICYmIHNoIDwgcGNoKSB7XG5cdFx0XHRjcyA9IDE7XG5cdFx0XHRjdyA9IHN3O1xuXHRcdFx0Y2ggPSBzaDtcblx0XHRcdHRoaXMubWV0cmljcy5maXREaXJlY3Rpb24gPSBcImJvdGhcIjtcblx0XHR9IGVsc2UgaWYgKChwY3cgLyBwY2gpIDwgKHN3IC8gc2gpKSB7XG5cdFx0XHQvLyBmaXQgd2lkdGhcblx0XHRcdGN3ID0gcGN3O1xuXHRcdFx0Y3MgPSBjdyAvIHN3O1xuXHRcdFx0Ly8gY2ggPSBjcyAqIHNoO1xuXHRcdFx0Y2ggPSBNYXRoLnJvdW5kKGNzICogc2gpO1xuXHRcdFx0dGhpcy5tZXRyaWNzLmZpdERpcmVjdGlvbiA9IFwid2lkdGhcIjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gZml0IGhlaWdodFxuXHRcdFx0Y2ggPSBwY2g7XG5cdFx0XHRjcyA9IGNoIC8gc2g7XG5cdFx0XHQvLyBjdyA9IGNzICogc3c7XG5cdFx0XHRjdyA9IE1hdGgucm91bmQoY3MgKiBzdyk7XG5cdFx0XHR0aGlzLm1ldHJpY3MuZml0RGlyZWN0aW9uID0gXCJoZWlnaHRcIjtcblx0XHR9XG5cblx0XHR0aGlzLm1ldHJpY3MuY29udGVudC54ID0gY3g7XG5cdFx0dGhpcy5tZXRyaWNzLmNvbnRlbnQueSA9IGN5O1xuXHRcdHRoaXMubWV0cmljcy5jb250ZW50LndpZHRoID0gY3cgKyBldztcblx0XHR0aGlzLm1ldHJpY3MuY29udGVudC5oZWlnaHQgPSBjaCArIGVoO1xuXG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhLnggPSBjeCArIGNtLnBhZGRpbmdMZWZ0ICsgY20uYm9yZGVyTGVmdFdpZHRoO1xuXHRcdHRoaXMubWV0cmljcy5tZWRpYS55ID0gY3kgKyBjbS5wYWRkaW5nVG9wICsgY20uYm9yZGVyVG9wV2lkdGg7XG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoID0gY3c7XG5cdFx0dGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCA9IGNoO1xuXHRcdHRoaXMubWV0cmljcy5tZWRpYS5zY2FsZSA9IGNzO1xuXG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6bWVhc3VyZSBjb25zdHJhaW50OiAlcyBtZXRyaWNzOiAlb1wiLCB0aGlzLmNpZCwgdGhpcy5tZXRyaWNzLmNvbnN0cmFpbnQsIHRoaXMubWV0cmljcyk7XG5cdFx0Ly8gdmFyIHNpemluZyA9IHRoaXMuZ2V0U2l6aW5nRWwoKTtcblx0XHQvLyBzaXppbmcuc3R5bGUubWF4V2lkdGggPSAoY3cgKyBldykgKyBcInB4XCI7XG5cdFx0Ly8gc2l6aW5nLnN0eWxlLm1heEhlaWdodCA9IChjaCArIGVoKSArIFwicHhcIjtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gTk9URTogbm90IGNhbGxpbmcgc3VwZXIucmVuZGVyLCBjYWxsaW5nIG1lYXN1cmUgb3Vyc2VsdmVzXG5cdFx0dGhpcy5tZWFzdXJlKCk7XG5cblx0XHR2YXIgc2l6aW5nID0gdGhpcy5nZXRTaXppbmdFbCgpO1xuXHRcdHNpemluZy5zdHlsZS5tYXhXaWR0aCA9IHRoaXMubWV0cmljcy5jb250ZW50LndpZHRoICsgXCJweFwiO1xuXHRcdHNpemluZy5zdHlsZS5tYXhIZWlnaHQgPSB0aGlzLm1ldHJpY3MuY29udGVudC5oZWlnaHQgKyBcInB4XCI7XG5cblx0XHR0aGlzLmVsLnNldEF0dHJpYnV0ZShcImRhdGEtZml0LWRpclwiLCB0aGlzLm1ldHJpY3MuZml0RGlyZWN0aW9uKTtcblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIG1lZGlhU3RhdGVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X21lZGlhU3RhdGVFbnVtOiBbXCJpZGxlXCIsIFwicGVuZGluZ1wiLCBcInJlYWR5XCIsIFwiZXJyb3JcIl0sXG5cblx0X3NldE1lZGlhU3RhdGU6IGZ1bmN0aW9uKGtleSkge1xuXHRcdGlmICh0aGlzLl9tZWRpYVN0YXRlRW51bS5pbmRleE9mKGtleSkgPT09IC0xKSB7XG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJBcmd1bWVudCBcIiArIGtleSArIFwiIGludmFsaWQuIE11c3QgYmUgb25lIG9mOiBcIiArIHRoaXMuX21lZGlhU3RhdGVFbnVtLmpvaW4oXCIsIFwiKSk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLl9tZWRpYVN0YXRlICE9PSBrZXkpIHtcblx0XHRcdGlmICh0aGlzLl9tZWRpYVN0YXRlKSB7XG5cdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9tZWRpYVN0YXRlKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LmFkZChrZXkpO1xuXHRcdFx0dGhpcy5fbWVkaWFTdGF0ZSA9IGtleTtcblx0XHRcdHRoaXMudHJpZ2dlcihcIm1lZGlhOlwiICsga2V5KTtcblx0XHR9XG5cdH0sXG59LCB7XG5cdExPR19UT19TQ1JFRU46IHRydWUsXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS93aGVuU2VsZWN0aW9uSXNDb250aWd1b3VzfSAqL1xuXHR3aGVuU2VsZWN0aW9uSXNDb250aWd1b3VzOiByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuU2VsZWN0aW9uSXNDb250aWd1b3VzXCIpLFxuXG5cdC8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3Byb21pc2Uvd2hlblNlbGVjdFRyYW5zaXRpb25FbmRzfSAqL1xuXHQvLyB3aGVuU2VsZWN0VHJhbnNpdGlvbkVuZHM6IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL3doZW5TZWxlY3RUcmFuc2l0aW9uRW5kc1wiKSxcblxuXHQvKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9wcm9taXNlL3doZW5TY3JvbGxpbmdFbmRzfSAqL1xuXHR3aGVuU2Nyb2xsaW5nRW5kczogcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblNjcm9sbGluZ0VuZHNcIiksXG5cblx0LyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcHJvbWlzZS93aGVuRGVmYXVsdEltYWdlTG9hZHN9ICovXG5cdHdoZW5EZWZhdWx0SW1hZ2VMb2FkczogcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlbkRlZmF1bHRJbWFnZUxvYWRzXCIpLFxufSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyogbG9nIHRvIHNjcmVlblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5pZiAoREVCVUcpIHtcblxuXHRNZWRpYVJlbmRlcmVyID0gKGZ1bmN0aW9uKE1lZGlhUmVuZGVyZXIpIHtcblx0XHRpZiAoIU1lZGlhUmVuZGVyZXIuTE9HX1RPX1NDUkVFTikgcmV0dXJuIE1lZGlhUmVuZGVyZXI7XG5cblx0XHQvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuXHRcdHZhciBDb2xvciA9IHJlcXVpcmUoXCJjb2xvclwiKTtcblx0XHQvLyAvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZy9scGFkfSAqL1xuXHRcdC8vIHZhciBscGFkID0gcmVxdWlyZShcInVuZGVyc2NvcmUuc3RyaW5nL2xwYWRcIik7XG5cdFx0Ly8gLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZS5zdHJpbmcvcnBhZH0gKi9cblx0XHQvLyB2YXIgcnBhZCA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlLnN0cmluZy9ycGFkXCIpO1xuXG5cdFx0cmV0dXJuIE1lZGlhUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdFx0XHR2YXIgZmdDb2xvciA9IG5ldyBDb2xvcih0aGlzLm1vZGVsLmF0dHIoXCJjb2xvclwiKSk7XG5cdFx0XHRcdHZhciBiZ0NvbG9yID0gbmV3IENvbG9yKHRoaXMubW9kZWwuYXR0cihcImJhY2tncm91bmQtY29sb3JcIikpO1xuXHRcdFx0XHR0aGlzLl9fbG9nQ29sb3JzID0ge1xuXHRcdFx0XHRcdG5vcm1hbDogZmdDb2xvci5jbG9uZSgpLm1peChiZ0NvbG9yLCAwLjc1KS5oc2xTdHJpbmcoKSxcblx0XHRcdFx0XHRpZ25vcmVkOiBmZ0NvbG9yLmNsb25lKCkubWl4KGJnQ29sb3IsIDAuMjUpLmhzbFN0cmluZygpLFxuXHRcdFx0XHRcdGVycm9yOiBcImJyb3duXCIsXG5cdFx0XHRcdFx0YWJvcnQ6IFwib3JhbmdlXCJcblx0XHRcdFx0fTtcblx0XHRcdFx0dGhpcy5fX2xvZ0ZyYW1lU3R5bGUgPSBcIjFweCBkYXNoZWQgXCIgKyBmZ0NvbG9yLmNsb25lKCkubWl4KGJnQ29sb3IsIDAuNSkuaHNsU3RyaW5nKCk7XG5cdFx0XHRcdHRoaXMuX19sb2dTdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuXHRcdFx0XHR0aGlzLl9fcmFmSWQgPSAtMTtcblx0XHRcdFx0dGhpcy5fX29uRnJhbWUgPSB0aGlzLl9fb25GcmFtZS5iaW5kKHRoaXMpO1xuXHRcdFx0fSxcblxuXHRcdFx0aW5pdGlhbGl6ZUFzeW5jOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemVBc3luYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpLmNhdGNoKGZ1bmN0aW9uKGVycikge1xuXHRcdFx0XHRcdGlmICghKGVyciBpbnN0YW5jZW9mIE1lZGlhUmVuZGVyZXIuVmlld0Vycm9yKSkge1xuXHRcdFx0XHRcdFx0dGhpcy5fX2xvZ01lc3NhZ2UoZXJyLm1lc3NhZ2UsIGVyci5uYW1lLCB0aGlzLl9fbG9nQ29sb3JzW1wiZXJyb3JcIl0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyKTtcblx0XHRcdFx0fS5iaW5kKHRoaXMpKTtcblx0XHRcdH0sXG5cblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGNyZWF0ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0dmFyIHJldCA9IE1lZGlhUmVuZGVyZXIucHJvdG90eXBlLmNyZWF0ZUNoaWxkcmVuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHRcdFx0dGhpcy5fX2xvZ0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5jbGFzc05hbWUgPSBcImRlYnVnLWxvZ1wiO1xuXHRcdFx0XHR0aGlzLl9fbG9nSGVhZGVyRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicHJlXCIpO1xuXHRcdFx0XHR0aGlzLl9fbG9nSGVhZGVyRWwuY2xhc3NOYW1lID0gXCJsb2ctaGVhZGVyIGNvbG9yLWJnXCI7XG5cdFx0XHRcdC8vIHRoaXMubW9kZWwuY29sb3JzLmZnQ29sb3IuY2xvbmUoKS5taXgoZmdDb2xvciwgMC45KS5yZ2JTdHJpbmcoKVxuXHRcdFx0XHQvLyB0aGlzLm1vZGVsLmNvbG9ycy5mZ0NvbG9yLmNsb25lKCkuYWxwaGFcblx0XHRcdFx0dGhpcy5fX2xvZ0hlYWRlckVsLnRleHRDb250ZW50ID0gdGhpcy5fX2dldEhlYWRlclRleHQoKTtcblx0XHRcdFx0dGhpcy5fX2xvZ0VsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5fX2xvZ0hlYWRlckVsKTtcblx0XHRcdFx0dGhpcy5lbC5pbnNlcnRCZWZvcmUodGhpcy5fX2xvZ0VsZW1lbnQsIHRoaXMuZWwuZmlyc3RFbGVtZW50Q2hpbGQpO1xuXHRcdFx0XHRyZXR1cm4gcmV0O1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0cmVuZGVyOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0TWVkaWFSZW5kZXJlci5wcm90b3R5cGUucmVuZGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cblx0XHRcdFx0dGhpcy5fX2xvZ0VsZW1lbnQuc3R5bGUubWFyZ2luVG9wID0gXCIzcmVtXCI7XG5cdFx0XHRcdHRoaXMuX19sb2dFbGVtZW50LnN0eWxlLm1heEhlaWdodCA9IFwiY2FsYygxMDAlIC0gXCIgKyAodGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCkgKyBcInB4IC0gM3JlbSlcIjtcblx0XHRcdFx0Ly90aGlzLl9fbG9nRWxlbWVudC5zdHlsZS53aWR0aCA9IHRoaXMubWV0cmljcy5tZWRpYS53aWR0aCArIFwicHhcIjtcblx0XHRcdFx0dGhpcy5fX2xvZ0VsZW1lbnQuc2Nyb2xsVG9wID0gdGhpcy5fX2xvZ0VsZW1lbnQuc2Nyb2xsSGVpZ2h0O1xuXG5cdFx0XHRcdHJldHVybiB0aGlzO1xuXHRcdFx0fSxcblxuXHRcdFx0X19sb2dNZXNzYWdlOiBmdW5jdGlvbihtc2csIGxvZ3R5cGUsIGNvbG9yKSB7XG5cdFx0XHRcdHZhciBsb2dFbnRyeUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInByZVwiKTtcblxuXHRcdFx0XHRsb2dFbnRyeUVsLnRleHRDb250ZW50ID0gdGhpcy5fX2dldFRTdGFtcCgpICsgXCIgXCIgKyBtc2c7XG5cdFx0XHRcdGxvZ0VudHJ5RWwuc2V0QXR0cmlidXRlKFwiZGF0YS1sb2d0eXBlXCIsIGxvZ3R5cGUgfHwgXCItXCIpO1xuXHRcdFx0XHRsb2dFbnRyeUVsLnN0eWxlLmNvbG9yID0gY29sb3IgfHwgdGhpcy5fX2xvZ0NvbG9yc1tsb2d0eXBlXSB8fCB0aGlzLl9fbG9nQ29sb3JzLm5vcm1hbDtcblxuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5hcHBlbmRDaGlsZChsb2dFbnRyeUVsKTtcblx0XHRcdFx0dGhpcy5fX2xvZ0VsZW1lbnQuc2Nyb2xsVG9wID0gdGhpcy5fX2xvZ0VsZW1lbnQuc2Nyb2xsSGVpZ2h0O1xuXG5cdFx0XHRcdGlmICh0aGlzLl9fcmFmSWQgPT0gLTEpIHtcblx0XHRcdFx0XHR0aGlzLl9fcmFmSWQgPSB0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9fb25GcmFtZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdF9fb25GcmFtZTogZnVuY3Rpb24odHN0YW1wKSB7XG5cdFx0XHRcdHRoaXMuX19yYWZJZCA9IC0xO1xuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5sYXN0RWxlbWVudENoaWxkLnN0eWxlLmJvcmRlckJvdHRvbSA9IHRoaXMuX19sb2dGcmFtZVN0eWxlO1xuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5sYXN0RWxlbWVudENoaWxkLnN0eWxlLnBhZGRpbmdCb3R0b20gPSBcIjJweFwiO1xuXHRcdFx0XHR0aGlzLl9fbG9nRWxlbWVudC5sYXN0RWxlbWVudENoaWxkLnN0eWxlLm1hcmdpbkJvdHRvbSA9IFwiMnB4XCI7XG5cdFx0XHR9LFxuXG5cdFx0XHRfX2dldFRTdGFtcDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdC8vIHJldHVybiBuZXcgRGF0ZShEYXRlLm5vdygpIC0gdGhpcy5fX2xvZ1N0YXJ0VGltZSkudG9JU09TdHJpbmcoKS5zdWJzdHIoMTEsIDEyKTtcblx0XHRcdFx0cmV0dXJuIGxwYWQoKChEYXRlLm5vdygpIC0gdGhpcy5fX2xvZ1N0YXJ0VGltZSkgLyAxMDAwKS50b0ZpeGVkKDMpLCA4LCBcIjBcIik7XG5cdFx0XHR9LFxuXG5cdFx0XHRfX2dldEhlYWRlclRleHQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gJyc7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHR9KShNZWRpYVJlbmRlcmVyKTtcblxufSAvLyBlbmQgZGVidWdcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL01lZGlhUmVuZGVyZXJ9XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gTWVkaWFSZW5kZXJlcjsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL1BsYXlhYmxlUmVuZGVyZXJcbiAqL1xuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG4vLyB2YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L01lZGlhUmVuZGVyZXJ9ICovXG52YXIgTWVkaWFSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvTWVkaWFSZW5kZXJlclwiKTtcbi8vIC8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyfSAqL1xuLy8gdmFyIFByb2dyZXNzTWV0ZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJcIik7XG5cbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgcHJlZml4ZWRQcm9wZXJ0eSA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFByb3BlcnR5XCIpO1xuLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cbnZhciBwcmVmaXhlZEV2ZW50ID0gcmVxdWlyZShcInV0aWxzL3ByZWZpeGVkRXZlbnRcIik7XG5cbi8vIHZhciB2aXNpYmlsaXR5SGlkZGVuUHJvcCA9IHByZWZpeGVkUHJvcGVydHkoXCJoaWRkZW5cIiwgZG9jdW1lbnQpO1xuLyoqIEB0eXBlIHtTdHJpbmd9ICovXG52YXIgdmlzaWJpbGl0eVN0YXRlUHJvcCA9IHByZWZpeGVkUHJvcGVydHkoXCJ2aXNpYmlsaXR5U3RhdGVcIiwgZG9jdW1lbnQpO1xuLyoqIEB0eXBlIHtTdHJpbmd9ICovXG52YXIgdmlzaWJpbGl0eUNoYW5nZUV2ZW50ID0gcHJlZml4ZWRFdmVudChcInZpc2liaWxpdHljaGFuZ2VcIiwgZG9jdW1lbnQsIFwiaGlkZGVuXCIpO1xuXG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuLy8gdmFyIGR1b3RvbmUgPSByZXF1aXJlKFwidXRpbHMvY2FudmFzL2JpdG1hcC9kdW90b25lXCIpO1xuLy8gdmFyIHN0YWNrQmx1clJHQiA9IHJlcXVpcmUoXCJ1dGlscy9jYW52YXMvYml0bWFwL3N0YWNrQmx1clJHQlwiKTtcbi8vIHZhciBzdGFja0JsdXJNb25vID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9iaXRtYXAvc3RhY2tCbHVyTW9ub1wiKTtcbi8vIHZhciBnZXRBdmVyYWdlUkdCQSA9IHJlcXVpcmUoXCJ1dGlscy9jYW52YXMvYml0bWFwL2dldEF2ZXJhZ2VSR0JBXCIpO1xuLy8gdmFyIGdldEF2ZXJhZ2VSR0IgPSByZXF1aXJlKFwidXRpbHMvY2FudmFzL2JpdG1hcC9nZXRBdmVyYWdlUkdCXCIpO1xuXG4vLyAvKiogQHR5cGUge0hUTUxDYW52YXNFbGVtZW50fSAqL1xuLy8gdmFyIF9zaGFyZWRDYW52YXMgPSBudWxsO1xuLy8gLyoqIEByZXR1cm4ge0hUTUxDYW52YXNFbGVtZW50fSAqL1xuLy8gdmFyIGdldFNoYXJlZENhbnZhcyA9IGZ1bmN0aW9uKCkge1xuLy8gXHRpZiAoX3NoYXJlZENhbnZhcyA9PT0gbnVsbCkge1xuLy8gXHRcdF9zaGFyZWRDYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuLy8gXHR9XG4vLyBcdHJldHVybiBfc2hhcmVkQ2FudmFzO1xuLy8gfTtcblxuLy8gZnVuY3Rpb24gbG9nQXR0YWNoSW5mbyh2aWV3LCBuYW1lLCBsZXZlbCkge1xuLy8gXHRpZiAoW1wibG9nXCIsIFwiaW5mb1wiLCBcIndhcm5cIiwgXCJlcnJvclwiXS5pbmRleE9mKGxldmVsKSAhPSAtMSkge1xuLy8gXHRcdGxldmVsID0gXCJsb2dcIjtcbi8vIFx0fVxuLy8gXHRjb25zb2xlW2xldmVsXS5jYWxsKGNvbnNvbGUsIFwiJXM6OiVzIFtwYXJlbnQ6JXMgJXMgJXMgZGVwdGg6JXNdXCIsIHZpZXcuY2lkLCBuYW1lLCB2aWV3LnBhcmVudFZpZXcgJiYgdmlldy5wYXJlbnRWaWV3LmNpZCwgdmlldy5hdHRhY2hlZCA/IFwiYXR0YWNoZWRcIiA6IFwiZGV0YWNoZWRcIiwgdmlldy5fdmlld1BoYXNlLCB2aWV3LnZpZXdEZXB0aCk7XG4vLyB9XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9QbGF5YWJsZVJlbmRlcmVyfVxuICovXG52YXIgUGxheWFibGVSZW5kZXJlciA9IE1lZGlhUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcInBsYXlhYmxlUmVuZGVyZXJcIixcblxuXHQvKiogQHR5cGUge3N0cmluZ3xGdW5jdGlvbn0gKi9cblx0Y2xhc3NOYW1lOiBNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5jbGFzc05hbWUgKyBcIiBwbGF5YWJsZS1yZW5kZXJlclwiLFxuXG5cdHByb3BlcnRpZXM6IHtcblx0XHRwYXVzZWQ6IHtcblx0XHRcdC8qKiBAcmV0dXJuIHtCb29sZWFufSAqL1xuXHRcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2lzTWVkaWFQYXVzZWQoKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHBsYXliYWNrUmVxdWVzdGVkOiB7XG5cdFx0XHQvKiogQHJldHVybiB7Qm9vbGVhbn0gKi9cblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9wbGF5YmFja1JlcXVlc3RlZDtcblx0XHRcdH0sXG5cdFx0XHRzZXQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0XHRcdHRoaXMuX3NldFBsYXliYWNrUmVxdWVzdGVkKHZhbHVlKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdHBsYXlUb2dnbGU6IHtcblx0XHRcdC8qKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gKi9cblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9wbGF5VG9nZ2xlIHx8ICh0aGlzLl9wbGF5VG9nZ2xlID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnBsYXktdG9nZ2xlXCIpKTtcblx0XHRcdH1cblx0XHR9LFxuXHRcdG92ZXJsYXk6IHtcblx0XHRcdC8qKiBAcmV0dXJuIHtIVE1MRWxlbWVudH0gKi9cblx0XHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiB0aGlzLl9vdmVybGF5IHx8ICh0aGlzLl9vdmVybGF5ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLm92ZXJsYXlcIikpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGluaXRpYWxpemU6IGZ1bmN0aW9uKG9wdHMpIHtcblx0XHRNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0Xy5iaW5kQWxsKHRoaXMsXG5cdFx0XHRcIl9vblBsYXliYWNrVG9nZ2xlXCIsXG5cdFx0XHRcIl9vblZpc2liaWxpdHlDaGFuZ2VcIlxuXHRcdCk7XG5cdFx0dGhpcy5fc2V0UGxheWJhY2tSZXF1ZXN0ZWQodGhpcy5fcGxheWJhY2tSZXF1ZXN0ZWQpO1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnBhcmVudENoYW5nZVwiLCBmdW5jdGlvbihjaGlsZFZpZXcsIG5ld1BhcmVudCwgb2xkUGFyZW50KSB7XG5cdFx0Ly8gXHQvLyBsb2dBdHRhY2hJbmZvKHRoaXMsIFwiW3ZpZXc6cGFyZW50Q2hhbmdlXVwiLCBcImluZm9cIik7XG5cdFx0Ly8gXHRjb25zb2xlLmluZm8oXCIlczo6W3ZpZXc6cGFyZW50Q2hhbmdlXSAnJXMnIHRvICclcydcIiwgdGhpcy5jaWQsIG9sZFBhcmVudCAmJiBvbGRQYXJlbnQuY2lkLCBuZXdQYXJlbnQgJiYgbmV3UGFyZW50LmNpZCk7XG5cdFx0Ly8gfSk7XG5cdH0sXG5cblx0Ly8gLyoqIEBvdmVycmlkZSAqL1xuXHQvLyBpbml0aWFsaXplQXN5bmM6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdHJldHVybiBNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplLmluaXRpYWxpemVBc3luYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHQvLyB9LFxuXG5cdC8vIC8qKiBAb3ZlcnJpZGUgKi9cblx0Ly8gcmVtb3ZlOiBmdW5jdGlvbigpIHtcblx0Ly8gXHRNZWRpYVJlbmRlcmVyLnByb3RvdHlwZS5yZW1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0Ly8gXHRyZXR1cm4gdGhpcztcblx0Ly8gfSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBjaGlsZHJlbi9sYXlvdXRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0Ly8gY3JlYXRlQ2hpbGRyZW46IGZ1bmN0aW9uKCkge1xuXHQvLyBcdHRoaXMuZWwuaW5uZXJIVE1MID0gdGhpcy50ZW1wbGF0ZSh0aGlzLm1vZGVsLnRvSlNPTigpKTtcblx0Ly8gXHR0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnBsYWNlaG9sZGVyXCIpO1xuXHQvLyBcdHRoaXMuY29udGVudCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5jb250ZW50XCIpO1xuXHQvLyBcdHRoaXMuaW1hZ2UgPSB0aGlzLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcImltZy5jdXJyZW50XCIpO1xuXHQvLyB9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHNldEVuYWJsZWRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRzZXRFbmFibGVkOiBmdW5jdGlvbihlbmFibGVkKSB7XG5cdFx0TWVkaWFSZW5kZXJlci5wcm90b3R5cGUuc2V0RW5hYmxlZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdC8vIHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soZW5hYmxlZCk7XG5cdFx0Ly8gaWYgKGVuYWJsZWQpIHtcblx0XHR0aGlzLl92YWxpZGF0ZVBsYXliYWNrKCk7XG5cdFx0Ly8gfSBlbHNlIHtcblx0XHQvLyBcdC8vIGlmIHNlbGVjdGVkLCBwYXVzZSBtZWRpYVxuXHRcdC8vIFx0dGhpcy5tb2RlbC5zZWxlY3RlZCAmJiB0aGlzLnRvZ2dsZVBsYXliYWNrKGZhbHNlKTtcblx0XHQvLyBcdC8vIHRoaXMudG9nZ2xlUGxheWJhY2soZmFsc2UpO1xuXHRcdC8vIH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0Lyogc2VsZWN0aW9uIGhhbmRsZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGFkZFNlbGVjdGlvbkxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX3ZpZXdQaGFzZSAhPSBcImluaXRpYWxpemVkXCIpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IodGhpcy5jaWQgKyBcIjo6YWRkU2VsZWN0aW9uTGlzdGVuZXJzIGNhbGxlZCB3aGlsZSBcIiArIHRoaXMuX3ZpZXdQaGFzZSk7XG5cblx0XHQvLyBsb2dBdHRhY2hJbmZvKHRoaXMsIFwiYWRkU2VsZWN0aW9uTGlzdGVuZXJzXCIsIFwibG9nXCIpO1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcywgXCJ2aWV3OnJlbW92ZWRcIiwgdGhpcy5yZW1vdmVTZWxlY3Rpb25MaXN0ZW5lcnMpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJzZWxlY3RlZFwiLCB0aGlzLl9vbk1vZGVsU2VsZWN0ZWQpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJkZXNlbGVjdGVkXCIsIHRoaXMuX29uTW9kZWxEZXNlbGVjdGVkKTtcblx0XHRpZiAodGhpcy5tb2RlbC5zZWxlY3RlZCkge1xuXHRcdFx0dGhpcy5fb25Nb2RlbFNlbGVjdGVkKCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8vIHJlbW92ZVNlbGVjdGlvbkxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG5cdC8vIFx0Ly8gbG9nQXR0YWNoSW5mbyh0aGlzLCBcInJlbW92ZVNlbGVjdGlvbkxpc3RlbmVyc1wiLCBcImxvZ1wiKTtcblx0Ly8gXHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcywgXCJ2aWV3OnJlbW92ZWRcIiwgdGhpcy5yZW1vdmVTZWxlY3Rpb25MaXN0ZW5lcnMpO1xuXHQvLyBcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLm1vZGVsLCBcInNlbGVjdGVkXCIsIHRoaXMuX29uTW9kZWxTZWxlY3RlZCk7XG5cdC8vIFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMubW9kZWwsIFwiZGVzZWxlY3RlZFwiLCB0aGlzLl9vbk1vZGVsRGVzZWxlY3RlZCk7XG5cdC8vIFx0aWYgKHRoaXMubW9kZWwuc2VsZWN0ZWQpIHtcblx0Ly8gXHRcdHRoaXMuX29uTW9kZWxEZXNlbGVjdGVkKCk7XG5cdC8vIFx0fVxuXHQvLyB9LFxuXG5cdC8qIG1vZGVsIHNlbGVjdGVkIGhhbmRsZXJzOlxuXHQvKiBtb2RlbCBzZWxlY3Rpb24gdG9nZ2xlcyBwbGF5YmFja1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25Nb2RlbFNlbGVjdGVkOiBmdW5jdGlvbigpIHtcblx0XHRjb25zb2xlLmxvZyhcIiVzOjpfb25Nb2RlbFNlbGVjdGVkIF9wbGF5YmFja1JlcXVlc3RlZDogJXMsIGV2ZW50OiAlc1wiLCB0aGlzLmNpZCwgdGhpcy5fcGxheWJhY2tSZXF1ZXN0ZWQsIHRoaXMuX3RvZ2dsZUV2ZW50KTtcblx0XHQvLyBsb2dBdHRhY2hJbmZvKHRoaXMsIFwiX29uTW9kZWxTZWxlY3RlZFwiLCBcImxvZ1wiKTtcblx0XHQvLyB0aGlzLl9hZGRQYXJlbnRMaXN0ZW5lcnMoKTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwidmlldzpwYXJlbnRDaGFuZ2VcIiwgdGhpcy5fb25QYXJlbnRDaGFuZ2UpO1xuXHRcdGlmICh0aGlzLnBhcmVudFZpZXcpIHRoaXMuX29uUGFyZW50Q2hhbmdlKHRoaXMsIHRoaXMucGFyZW50VmlldywgbnVsbCk7XG5cblx0XHR0aGlzLl9hZGRET01MaXN0ZW5lcnMoKTtcblx0XHR0aGlzLl92YWxpZGF0ZVBsYXliYWNrKCk7XG5cdH0sXG5cblx0X29uTW9kZWxEZXNlbGVjdGVkOiBmdW5jdGlvbigpIHtcblx0XHQvLyBsb2dBdHRhY2hJbmZvKHRoaXMsIFwiX29uTW9kZWxEZXNlbGVjdGVkXCIsIFwibG9nXCIpO1xuXHRcdC8vIHRoaXMuX3JlbW92ZVBhcmVudExpc3RlbmVycygpO1xuXHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLCBcInZpZXc6cGFyZW50Q2hhbmdlXCIsIHRoaXMuX29uUGFyZW50Q2hhbmdlKTtcblx0XHRpZiAodGhpcy5wYXJlbnRWaWV3KSB0aGlzLl9vblBhcmVudENoYW5nZSh0aGlzLCBudWxsLCB0aGlzLnBhcmVudFZpZXcpO1xuXG5cdFx0dGhpcy5fcmVtb3ZlRE9NTGlzdGVuZXJzKCk7XG5cdFx0dGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdFx0Ly8gdGhpcy5fdmFsaWRhdGVQbGF5YmFjayh0aGlzLm1vZGVsLnNlbGVjdGVkKTtcblx0XHQvLyB0aGlzLl92YWxpZGF0ZVBsYXliYWNrKCk7XG5cdH0sXG5cblx0LyogdmlldzpwYXJlbnRDaGFuZ2UgaGFuZGxlcnMgM1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25QYXJlbnRDaGFuZ2U6IGZ1bmN0aW9uKGNoaWxkVmlldywgbmV3UGFyZW50LCBvbGRQYXJlbnQpIHtcblx0XHQvLyBjb25zb2xlLmxvZyhcIltzY3JvbGxdICVzOjpfb25QYXJlbnRDaGFuZ2UgJyVzJyB0byAnJXMnXCIsIHRoaXMuY2lkLCBvbGRQYXJlbnQgJiYgb2xkUGFyZW50LmNpZCwgbmV3UGFyZW50ICYmIG5ld1BhcmVudC5jaWQpO1xuXHRcdGlmIChvbGRQYXJlbnQpIHRoaXMuc3RvcExpc3RlbmluZyhvbGRQYXJlbnQsIFwidmlldzpzY3JvbGxzdGFydCB2aWV3OnNjcm9sbGVuZFwiLCB0aGlzLl9vblNjcm9sbENoYW5nZSk7XG5cdFx0aWYgKG5ld1BhcmVudCkgdGhpcy5saXN0ZW5UbyhuZXdQYXJlbnQsIFwidmlldzpzY3JvbGxzdGFydCB2aWV3OnNjcm9sbGVuZFwiLCB0aGlzLl9vblNjcm9sbENoYW5nZSk7XG5cdH0sXG5cblx0X29uU2Nyb2xsQ2hhbmdlOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5wYXJlbnRWaWV3ID09PSBudWxsKSB7XG5cdFx0XHR0aGlzLnRvZ2dsZVBsYXliYWNrKGZhbHNlKTtcblx0XHRcdHRocm93IG5ldyBFcnJvcih0aGlzLmNpZCArIFwiOjpfb25TY3JvbGxDaGFuZ2UgcGFyZW50VmlldyBpcyBudWxsXCIpO1xuXHRcdH1cblx0XHQvLyBjb25zb2xlLmxvZyhcIltzY3JvbGxdICVzOjpfb25TY3JvbGxDaGFuZ2UgJXMuc2Nyb2xsaW5nOiAlc1wiLCB0aGlzLmNpZCwgdGhpcy5wYXJlbnRWaWV3LmNpZCwgdGhpcy5wYXJlbnRWaWV3LnNjcm9sbGluZyk7XG5cblx0XHQvLyB0aGlzLl92YWxpZGF0ZVBsYXliYWNrKCF0aGlzLnBhcmVudFZpZXcuc2Nyb2xsaW5nKTtcblx0XHQvLyBpZiAoIXRoaXMucGFyZW50Vmlldy5zY3JvbGxpbmcpIHtcblx0XHR0aGlzLl92YWxpZGF0ZVBsYXliYWNrKCk7XG5cdFx0Ly8gfSBlbHNlIHtcblx0XHQvLyBcdHRoaXMudG9nZ2xlUGxheWJhY2soZmFsc2UpO1xuXHRcdC8vIH1cblx0fSxcblxuXHQvKiB2aWV3OnBhcmVudENoYW5nZSBoYW5kbGVyc1xuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKl9hZGRQYXJlbnRMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICghdGhpcy5wYXJlbnRWaWV3KSB7XG5cdFx0XHRsb2dBdHRhY2hJbmZvKHRoaXMsIFwiX2FkZFBhcmVudExpc3RlbmVyc1wiLCBcImVycm9yXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwidmlldzpyZW1vdmVcIiwgdGhpcy5fcmVtb3ZlUGFyZW50TGlzdGVuZXJzKTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMucGFyZW50VmlldywgXCJ2aWV3OnJlbW92ZVwiLCB0aGlzLl9yZW1vdmVQYXJlbnRMaXN0ZW5lcnMpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5wYXJlbnRWaWV3LCBcInZpZXc6c2Nyb2xsc3RhcnRcIiwgdGhpcy5fb25TY3JvbGxTdGFydCk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLnBhcmVudFZpZXcsIFwidmlldzpzY3JvbGxlbmRcIiwgdGhpcy5fb25TY3JvbGxFbmQpO1xuXHR9LFxuXG5cdF9yZW1vdmVQYXJlbnRMaXN0ZW5lcnM6IGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRpZiAoIXRoaXMucGFyZW50Vmlldykge1xuXHRcdFx0bG9nQXR0YWNoSW5mbyh0aGlzLCBcIl9yZW1vdmVQYXJlbnRMaXN0ZW5lcnNcIiwgXCJlcnJvclwiKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKHZpZXcgIT09IHZvaWQgMCkge1xuXHRcdFx0bG9nQXR0YWNoSW5mbyh0aGlzLCBcIl9yZW1vdmVQYXJlbnRMaXN0ZW5lcnMgW2V2ZW50IHNvdXJjZSB2aWV3XVwiLCBcImluZm9cIik7XG5cdFx0XHQvLyBjb25zb2xlLmluZm8oXCIlc1twbGF5YWJsZV06Ol9yZW1vdmVQYXJlbnRMaXN0ZW5lcnMgZXZlbnQgc291cmNlIHZpZXc6ICVzXCIsIHRoaXMuY2lkLCB2aWV3ICYmIHZpZXcuY2lkKTtcblx0XHR9XG5cblx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcywgXCJ2aWV3OnJlbW92ZVwiLCB0aGlzLl9yZW1vdmVQYXJlbnRMaXN0ZW5lcnMpO1xuXHRcdHRoaXMuc3RvcExpc3RlbmluZyh0aGlzLnBhcmVudFZpZXcsIFwidmlldzpyZW1vdmVcIiwgdGhpcy5fcmVtb3ZlUGFyZW50TGlzdGVuZXJzKTtcblx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy5wYXJlbnRWaWV3LCBcInZpZXc6c2Nyb2xsc3RhcnRcIiwgdGhpcy5fb25TY3JvbGxTdGFydCk7XG5cdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMucGFyZW50VmlldywgXCJ2aWV3OnNjcm9sbGVuZFwiLCB0aGlzLl9vblNjcm9sbEVuZCk7XG5cdH0sKi9cblxuXHQvKiB2aWV3OnNjcm9sbHN0YXJ0IHZpZXc6c2Nyb2xsZW5kXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qX29uU2Nyb2xsU3RhcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMudG9nZ2xlUGxheWJhY2soZmFsc2UpO1xuXHR9LFxuXG5cdF9vblNjcm9sbEVuZDogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5fdmFsaWRhdGVQbGF5YmFjaygpO1xuXHR9LCovXG5cblx0LyogbGlzdGVuIHRvIERPTSBldmVudHNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2FkZERPTUxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLCBcInZpZXc6cmVtb3ZlZFwiLCB0aGlzLl9yZW1vdmVET01MaXN0ZW5lcnMpO1xuXHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIodmlzaWJpbGl0eUNoYW5nZUV2ZW50LCB0aGlzLl9vblZpc2liaWxpdHlDaGFuZ2UsIGZhbHNlKTtcblx0XHR0aGlzLnBsYXlUb2dnbGUuYWRkRXZlbnRMaXN0ZW5lcih0aGlzLl90b2dnbGVFdmVudCwgdGhpcy5fb25QbGF5YmFja1RvZ2dsZSwgdHJ1ZSk7XG5cdH0sXG5cblx0X3JlbW92ZURPTUxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5zdG9wTGlzdGVuaW5nKHRoaXMsIFwidmlldzpyZW1vdmVkXCIsIHRoaXMuX3JlbW92ZURPTUxpc3RlbmVycyk7XG5cdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcih2aXNpYmlsaXR5Q2hhbmdlRXZlbnQsIHRoaXMuX29uVmlzaWJpbGl0eUNoYW5nZSwgZmFsc2UpO1xuXHRcdHRoaXMucGxheVRvZ2dsZS5yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuX3RvZ2dsZUV2ZW50LCB0aGlzLl9vblBsYXliYWNrVG9nZ2xlLCB0cnVlKTtcblx0fSxcblxuXHQvKiB2aXNpYmlsaXR5IGRvbSBldmVudFxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblx0X29uVmlzaWJpbGl0eUNoYW5nZTogZnVuY3Rpb24oZXYpIHtcblx0XHQvLyB0aGlzLl92YWxpZGF0ZVBsYXliYWNrKCFkb2N1bWVudFt2aXNpYmlsaXR5SGlkZGVuUHJvcF0pO1xuXHRcdC8vIHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soZG9jdW1lbnRbdmlzaWJpbGl0eVN0YXRlUHJvcF0gIT0gXCJoaWRkZW5cIik7XG5cdFx0Ly8gaWYgKGRvY3VtZW50W3Zpc2liaWxpdHlTdGF0ZVByb3BdICE9IFwiaGlkZGVuXCIpIHtcblx0XHR0aGlzLl92YWxpZGF0ZVBsYXliYWNrKCk7XG5cdFx0Ly8gfSBlbHNlIHtcblx0XHQvLyBcdHRoaXMudG9nZ2xlUGxheWJhY2soZmFsc2UpO1xuXHRcdC8vIH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBwbGF5LXRvZ2dsZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQHR5cGUge1N0cmluZ30gKi9cblx0X3RvZ2dsZUV2ZW50OiB3aW5kb3cuaGFzT3duUHJvcGVydHkoXCJvbnBvaW50ZXJ1cFwiKSA/IFwicG9pbnRlcnVwXCIgOiBcIm1vdXNldXBcIixcblxuXHRfb25QbGF5YmFja1RvZ2dsZTogZnVuY3Rpb24oZXYpIHtcblx0XHRjb25zb2xlLmxvZyhcIiVzWyVzYWJsZWRdOjpfb25QbGF5YmFja1RvZ2dsZVslc10gZGVmYXVsdFByZXZlbnRlZDogJXNcIiwgdGhpcy5jaWQsIHRoaXMuZW5hYmxlZCA/IFwiZW5cIiA6IFwiZGlzXCIsIGV2LnR5cGUsIGV2LmRlZmF1bHRQcmV2ZW50ZWQpO1xuXHRcdC8vIE5PVEU6IFBlcmZvcm0gYWN0aW9uIGlmIE1vdXNlRXZlbnQuYnV0dG9uIGlzIDAgb3IgdW5kZWZpbmVkICgwOiBsZWZ0LWJ1dHRvbilcblx0XHRpZiAodGhpcy5lbmFibGVkICYmICFldi5kZWZhdWx0UHJldmVudGVkICYmICFldi5idXR0b24pIHtcblx0XHRcdGV2LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR0aGlzLnBsYXliYWNrUmVxdWVzdGVkID0gIXRoaXMucGxheWJhY2tSZXF1ZXN0ZWQ7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHBsYXliYWNrUmVxdWVzdGVkXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAdHlwZSB7Qm9vbGVhbj99ICovXG5cdF9wbGF5YmFja1JlcXVlc3RlZDogbnVsbCxcblxuXHRfc2V0UGxheWJhY2tSZXF1ZXN0ZWQ6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0dGhpcy5fcGxheWJhY2tSZXF1ZXN0ZWQgPSB2YWx1ZTtcblxuXHRcdHZhciBjbGFzc0xpc3QgPSB0aGlzLmNvbnRlbnQuY2xhc3NMaXN0O1xuXHRcdGNsYXNzTGlzdC50b2dnbGUoXCJwbGF5aW5nXCIsIHZhbHVlID09PSB0cnVlKTtcblx0XHRjbGFzc0xpc3QudG9nZ2xlKFwicGF1c2VkXCIsIHZhbHVlID09PSBmYWxzZSk7XG5cdFx0Y2xhc3NMaXN0LnRvZ2dsZShcInJlcXVlc3RlZFwiLCB2YWx1ZSA9PT0gdHJ1ZSB8fCB2YWx1ZSA9PT0gZmFsc2UpO1xuXG5cdFx0Ly8gdGhpcy5fdmFsaWRhdGVQbGF5YmFjayh0aGlzLnBsYXliYWNrUmVxdWVzdGVkKTtcblx0XHQvLyBpZiAodGhpcy5wbGF5YmFja1JlcXVlc3RlZCkge1xuXHRcdHRoaXMuX3ZhbGlkYXRlUGxheWJhY2soKTtcblx0XHQvLyB9IGVsc2Uge1xuXHRcdC8vIFx0dGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdFx0Ly8gfVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHRvZ2dsZVBsYXliYWNrXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0dG9nZ2xlUGxheWJhY2s6IGZ1bmN0aW9uKG5ld1BsYXlTdGF0ZSkge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiW3Njcm9sbF0gJXM6OnRvZ2dsZVBsYXliYWNrIFslcyAtPiAlc10gKHJlcXVlc3RlZDogJXMpXCIsIHRoaXMuY2lkLFxuXHRcdC8vIFx0XHQodGhpcy5faXNNZWRpYVBhdXNlZCgpPyBcInBhdXNlXCIgOiBcInBsYXlcIiksXG5cdFx0Ly8gXHRcdChuZXdQbGF5U3RhdGU/IFwicGxheVwiIDogXCJwYXVzZVwiKSxcblx0XHQvLyBcdFx0dGhpcy5wbGF5YmFja1JlcXVlc3RlZFxuXHRcdC8vIFx0KTtcblx0XHRpZiAoXy5pc0Jvb2xlYW4obmV3UGxheVN0YXRlKSAmJiBuZXdQbGF5U3RhdGUgIT09IHRoaXMuX2lzTWVkaWFQYXVzZWQoKSkge1xuXHRcdFx0cmV0dXJuOyAvLyByZXF1ZXN0ZWQgc3RhdGUgaXMgY3VycmVudCwgZG8gbm90aGluZ1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXdQbGF5U3RhdGUgPSB0aGlzLl9pc01lZGlhUGF1c2VkKCk7XG5cdFx0fVxuXHRcdGlmIChuZXdQbGF5U3RhdGUpIHsgLy8gY2hhbmdpbmcgdG8gd2hhdD9cblx0XHRcdHRoaXMuX3BsYXlNZWRpYSgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLl9wYXVzZU1lZGlhKCk7XG5cdFx0fVxuXHR9LFxuXG5cdF9jYW5SZXN1bWVQbGF5YmFjazogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICEhKFxuXHRcdFx0dGhpcy5lbmFibGVkICYmXG5cdFx0XHR0aGlzLm1vZGVsLnNlbGVjdGVkICYmXG5cdFx0XHR0aGlzLnBsYXliYWNrUmVxdWVzdGVkICYmXG5cdFx0XHQodGhpcy5tZWRpYVN0YXRlID09PSBcInJlYWR5XCIpICYmXG5cdFx0XHR0aGlzLmF0dGFjaGVkICYmXG5cdFx0XHQodGhpcy5wYXJlbnRWaWV3ICE9PSBudWxsKSAmJlxuXHRcdFx0KCF0aGlzLnBhcmVudFZpZXcuc2Nyb2xsaW5nKSAmJlxuXHRcdFx0KGRvY3VtZW50W3Zpc2liaWxpdHlTdGF0ZVByb3BdICE9IFwiaGlkZGVuXCIpXG5cdFx0KTtcblx0fSxcblxuXHRfdmFsaWRhdGVQbGF5YmFjazogZnVuY3Rpb24oc2hvcnRjaXJjdWl0KSB7XG5cdFx0Ly8gYSAnc2hvcnRjaXJjdWl0JyBib29sZWFuIGFyZ3VtZW50IGNhbiBiZSBwYXNzZWQsIGFuZCBpZiBmYWxzZSxcblx0XHQvLyBza2lwIF9jYW5SZXN1bWVQbGF5YmFjayBhbmQgcGF1c2UgcGxheWJhY2sgcmlnaHQgYXdheVxuXHRcdGlmIChhcmd1bWVudHMubGVuZ3RoICE9IDAgJiYgIXNob3J0Y2lyY3VpdCkge1xuXHRcdFx0dGhpcy50b2dnbGVQbGF5YmFjayhmYWxzZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMudG9nZ2xlUGxheWJhY2sodGhpcy5fY2FuUmVzdW1lUGxheWJhY2soKSk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGFic3RyYWN0XG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9pc01lZGlhUGF1c2VkOiBmdW5jdGlvbigpIHtcblx0XHRjb25zb2xlLndhcm4oXCIlczo6X2lzTWVkaWFQYXVzZWQgTm90IGltcGxlbWVudGVkXCIsIHRoaXMuY2lkKTtcblx0XHRyZXR1cm4gdHJ1ZTtcblx0fSxcblxuXHRfcGxheU1lZGlhOiBmdW5jdGlvbigpIHtcblx0XHRjb25zb2xlLndhcm4oXCIlczo6X3BsYXlNZWRpYSBOb3QgaW1wbGVtZW50ZWRcIiwgdGhpcy5jaWQpO1xuXHR9LFxuXG5cdF9wYXVzZU1lZGlhOiBmdW5jdGlvbigpIHtcblx0XHRjb25zb2xlLndhcm4oXCIlczo6X3BhdXNlTWVkaWEgTm90IGltcGxlbWVudGVkXCIsIHRoaXMuY2lkKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiB1dGlsXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdHVwZGF0ZU92ZXJsYXk6IGZ1bmN0aW9uKG1lZGlhRWwsIHRhcmdldEVsLCByZWN0RWwpIHtcblx0XHQvLyAvLyB0aGlzIG1ldGhvZCBpcyBub3QgY3JpdGljYWwsIGp1c3QgY2F0Y2ggYW5kIGxvZyBhbGwgZXJyb3JzXG5cdFx0Ly8gdHJ5IHtcblx0XHQvLyBcdHRoaXMuX3VwZGF0ZU92ZXJsYXkobWVkaWFFbCwgdGFyZ2V0RWwsIHJlY3RFbClcblx0XHQvLyB9IGNhdGNoIChlcnIpIHtcblx0XHQvLyBcdGNvbnNvbGUuZXJyb3IoXCIlczo6dXBkYXRlT3ZlcmxheVwiLCB0aGlzLmNpZCwgZXJyKTtcblx0XHQvLyB9XG5cdH0sXG5cblx0X2RyYXdNZWRpYUVsZW1lbnQ6IGZ1bmN0aW9uKGNvbnRleHQsIG1lZGlhRWwsIGRlc3QpIHtcblx0XHQvLyBkZXN0aW5hdGlvbiByZWN0XG5cdFx0Ly8gTk9URTogbWVkaWFFbCBpcyBleHBlY3RlZCB0byBoYXZlIHRoZSBzYW1lIGRpbWVuc2lvbnMgaW4gdGhpcy5tZXRyaWNzLm1lZGlhXG5cdFx0bWVkaWFFbCB8fCAobWVkaWFFbCA9IHRoaXMuZGVmYXVsdEltYWdlKTtcblx0XHRkZXN0IHx8IChkZXN0ID0ge1xuXHRcdFx0eDogMCxcblx0XHRcdHk6IDAsXG5cdFx0XHR3aWR0aDogdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoLFxuXHRcdFx0aGVpZ2h0OiB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0XG5cdFx0fSk7XG5cblx0XHQvLyBuYXRpdmUvZGlzcGxheSBzY2FsZVxuXHRcdHZhciBzVyA9IHRoaXMubW9kZWwuZ2V0KFwic291cmNlXCIpLmdldChcIndcIiksXG5cdFx0XHRzSCA9IHRoaXMubW9kZWwuZ2V0KFwic291cmNlXCIpLmdldChcImhcIiksXG5cdFx0XHRyc1ggPSBzVyAvIHRoaXMubWV0cmljcy5tZWRpYS53aWR0aCxcblx0XHRcdHJzWSA9IHNIIC8gdGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodDtcblxuXHRcdC8vIGRlc3QsIHNjYWxlZCB0byBuYXRpdmVcblx0XHR2YXIgc3JjID0ge1xuXHRcdFx0eDogTWF0aC5tYXgoMCwgZGVzdC54ICogcnNYKSxcblx0XHRcdHk6IE1hdGgubWF4KDAsIGRlc3QueSAqIHJzWSksXG5cdFx0XHR3aWR0aDogTWF0aC5taW4oc1csIGRlc3Qud2lkdGggKiByc1gpLFxuXHRcdFx0aGVpZ2h0OiBNYXRoLm1pbihzSCwgZGVzdC5oZWlnaHQgKiByc1kpXG5cdFx0fTtcblxuXHRcdC8vIHJlc2l6ZSBjYW52YXNcblx0XHQvLyB2YXIgY2FudmFzID0gY29udGV4dC5jYW52YXM7XG5cdFx0Ly8gaWYgKGNhbnZhcy53aWR0aCAhPT0gZGVzdC53aWR0aCB8fCBjYW52YXMuaGVpZ2h0ICE9PSBkZXN0LmhlaWdodCkge1xuXHRcdC8vIFx0Y2FudmFzLndpZHRoID0gZGVzdC53aWR0aDtcblx0XHQvLyBcdGNhbnZhcy5oZWlnaHQgPSBkZXN0LmhlaWdodDtcblx0XHQvLyB9XG5cdFx0Y29udGV4dC5jYW52YXMud2lkdGggPSBkZXN0LndpZHRoO1xuXHRcdGNvbnRleHQuY2FudmFzLmhlaWdodCA9IGRlc3QuaGVpZ2h0O1xuXG5cdFx0Ly8gY29weSBpbWFnZSB0byBjYW52YXNcblx0XHRjb250ZXh0LmNsZWFyUmVjdCgwLCAwLCBkZXN0LndpZHRoLCBkZXN0LmhlaWdodCk7XG5cdFx0Y29udGV4dC5kcmF3SW1hZ2UobWVkaWFFbCxcblx0XHRcdHNyYy54LCBzcmMueSwgc3JjLndpZHRoLCBzcmMuaGVpZ2h0LFxuXHRcdFx0MCwgMCwgZGVzdC53aWR0aCwgZGVzdC5oZWlnaHQgLy8gZGVzdGluYXRpb24gcmVjdFxuXHRcdCk7XG5cblx0XHRyZXR1cm4gY29udGV4dDtcblx0fSxcblxuXHQvKlxuXHRfdXBkYXRlT3ZlcmxheTogZnVuY3Rpb24obWVkaWFFbCwgdGFyZ2V0RWwsIHJlY3RFbCkge1xuXHRcdC8vIHNyYy9kZXN0IHJlY3RzXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0cmVjdEVsIHx8IChyZWN0RWwgPSB0YXJnZXRFbCk7XG5cblx0XHQvLyBOT1RFOiBkb2VzIG5vdCB3b3JrIHdpdGggc3ZnIGVsZW1lbnRcblx0XHQvLyB2YXIgdFJlY3QgPSByZWN0RWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0Ly8gdmFyIGNSZWN0ID0gbWVkaWFFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHQvLyB2YXIgdFggPSB0UmVjdC54IC0gY1JlY3QueCxcblx0XHQvLyBcdHRZID0gdFJlY3QueSAtIGNSZWN0LnksXG5cdFx0Ly8gXHR0VyA9IHRSZWN0LndpZHRoLFxuXHRcdC8vIFx0dEggPSB0UmVjdC5oZWlnaHQ7XG5cblx0XHQvLyB0YXJnZXQgYm91bmRzXG5cdFx0dmFyIHRYID0gcmVjdEVsLm9mZnNldExlZnQsXG5cdFx0XHR0WSA9IHJlY3RFbC5vZmZzZXRUb3AsXG5cdFx0XHR0VyA9IHJlY3RFbC5vZmZzZXRXaWR0aCxcblx0XHRcdHRIID0gcmVjdEVsLm9mZnNldEhlaWdodDtcblxuXHRcdGlmICh0WCA9PT0gdm9pZCAwIHx8IHRZID09PSB2b2lkIDAgfHwgdFcgPT09IHZvaWQgMCB8fCB0SCA9PT0gdm9pZCAwKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gZGVzdGluYXRpb24gcmVjdFxuXHRcdHZhciBSRUNUX0dST1cgPSAyMDtcblx0XHR2YXIgZGVzdCA9IHtcblx0XHRcdHg6IHRYIC0gUkVDVF9HUk9XLFxuXHRcdFx0eTogdFkgLSBSRUNUX0dST1csXG5cdFx0XHR3aWR0aDogdFcgKyBSRUNUX0dST1cgKiAyLFxuXHRcdFx0aGVpZ2h0OiB0SCArIFJFQ1RfR1JPVyAqIDJcblx0XHR9O1xuXG5cdFx0Ly8gbmF0aXZlL2Rpc3BsYXkgc2NhbGVcblx0XHR2YXIgc1cgPSB0aGlzLm1vZGVsLmdldChcIndcIiksXG5cdFx0XHRzSCA9IHRoaXMubW9kZWwuZ2V0KFwiaFwiKSxcblx0XHRcdHJzWCA9IHNXL3RoaXMubWV0cmljcy5tZWRpYS53aWR0aCxcblx0XHRcdHJzWSA9IHNIL3RoaXMubWV0cmljcy5tZWRpYS5oZWlnaHQ7XG5cblx0XHQvLyBkZXN0LCBzY2FsZWQgdG8gbmF0aXZlXG5cdFx0dmFyIHNyYyA9IHtcblx0XHRcdHg6IE1hdGgubWF4KDAsIGRlc3QueCAqIHJzWCksXG5cdFx0XHR5OiBNYXRoLm1heCgwLCBkZXN0LnkgKiByc1kpLFxuXHRcdFx0d2lkdGg6IE1hdGgubWluKHNXLCBkZXN0LndpZHRoICogcnNYKSxcblx0XHRcdGhlaWdodDogTWF0aC5taW4oc0gsIGRlc3QuaGVpZ2h0ICogcnNZKVxuXHRcdH07XG5cblx0XHQvLyBDb3B5IGltYWdlIHRvIGNhbnZhc1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHZhciBjYW52YXMsIGNvbnRleHQsIGltYWdlRGF0YTtcblxuXHRcdC8vIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJjYW52YXNcIik7XG5cdFx0Ly8gY2FudmFzLnN0eWxlLndpZHRoICA9IGRlc3Qud2lkdGggKyBcInB4XCI7XG5cdFx0Ly8gY2FudmFzLnN0eWxlLmhlaWdodCA9IGRlc3QuaGVpZ2h0ICsgXCJweFwiO1xuXG5cdFx0Y2FudmFzID0gZ2V0U2hhcmVkQ2FudmFzKCk7XG5cdFx0aWYgKGNhbnZhcy53aWR0aCAhPT0gZGVzdC53aWR0aCB8fCBjYW52YXMuaGVpZ2h0ICE9PSBkZXN0LmhlaWdodCkge1xuXHRcdFx0Y2FudmFzLndpZHRoID0gZGVzdC53aWR0aDtcblx0XHRcdGNhbnZhcy5oZWlnaHQgPSBkZXN0LmhlaWdodDtcblx0XHR9XG5cdFx0Y29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5cdFx0Y29udGV4dC5jbGVhclJlY3QoMCwgMCwgZGVzdC53aWR0aCwgZGVzdC5oZWlnaHQpO1xuXHRcdGNvbnRleHQuZHJhd0ltYWdlKG1lZGlhRWwsXG5cdFx0XHRzcmMueCwgc3JjLnksIHNyYy53aWR0aCwgc3JjLmhlaWdodCxcblx0XHRcdDAsIDAsIGRlc3Qud2lkdGgsIGRlc3QuaGVpZ2h0IC8vIGRlc3RpbmF0aW9uIHJlY3Rcblx0XHQpO1xuXHRcdGltYWdlRGF0YSA9IGNvbnRleHQuZ2V0SW1hZ2VEYXRhKDAsIDAsIGRlc3Qud2lkdGgsIGRlc3QuaGVpZ2h0KTtcblxuXHRcdHZhciBhdmdDb2xvciA9IENvbG9yKCkucmdiKGdldEF2ZXJhZ2VSR0IoaW1hZ2VEYXRhKSk7XG5cdFx0Ly8gdmFyIGF2Z0hleCA9IGF2Z0NvbG9yLmhleFN0cmluZygpLCBlbHMgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCJpbWcsIHZpZGVvXCIpO1xuXHRcdC8vIGZvciAodmFyIGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7XG5cdFx0Ly8gXHRlbHMuaXRlbShpKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBhdmdIZXg7XG5cdFx0Ly8gfVxuXG5cdFx0dGFyZ2V0RWwuY2xhc3NMaXN0LnRvZ2dsZShcIm92ZXItZGFya1wiLCBhdmdDb2xvci5kYXJrKCkpO1xuXG5cdFx0Ly8gY29uc29sZS5sb2coXCIlczo6dXBkYXRlT3ZlcmxheSgpIGF2Z0NvbG9yOiVzICglcylcIiwgdGhpcy5jaWQsIGF2Z0NvbG9yLnJnYlN0cmluZygpLCBhdmdDb2xvci5kYXJrKCk/XCJkYXJrXCI6XCJsaWdodFwiLCB0YXJnZXRFbCk7XG5cblx0XHQvLyBDb2xvciwgZmlsdGVyIG9wdHNcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHRcdC8vIHRoaXMuZmdDb2xvciB8fCAodGhpcy5mZ0NvbG9yID0gbmV3IENvbG9yKHRoaXMubW9kZWwuYXR0cihcImNvbG9yXCIpKSk7XG5cdFx0Ly8gdGhpcy5iZ0NvbG9yIHx8ICh0aGlzLmJnQ29sb3IgPSBuZXcgQ29sb3IodGhpcy5tb2RlbC5hdHRyKFwiYmFja2dyb3VuZC1jb2xvclwiKSkpO1xuXHRcdC8vXG5cdFx0Ly8gdmFyIG9wdHMgPSB7IHJhZGl1czogMjAgfTtcblx0XHQvLyB2YXIgaXNGZ0RhcmsgPSB0aGlzLmZnQ29sb3IubHVtaW5vc2l0eSgpIDwgdGhpcy5iZ0NvbG9yLmx1bWlub3NpdHkoKTtcblx0XHQvLyBvcHRzLngwMCA9IGlzRmdEYXJrPyB0aGlzLmZnQ29sb3IuY2xvbmUoKS5saWdodGVuKDAuNSkgOiB0aGlzLmJnQ29sb3IuY2xvbmUoKS5kYXJrZW4oMC41KTtcblx0XHQvLyBvcHRzLnhGRiA9IGlzRmdEYXJrPyB0aGlzLmJnQ29sb3IuY2xvbmUoKS5saWdodGVuKDAuNSkgOiB0aGlzLmZnQ29sb3IuY2xvbmUoKS5kYXJrZW4oMC41KTtcblx0XHQvL1xuXHRcdC8vIHN0YWNrQmx1ck1vbm8oaW1hZ2VEYXRhLCBvcHRzKTtcblx0XHQvLyBkdW90b25lKGltYWdlRGF0YSwgb3B0cyk7XG5cdFx0Ly8gc3RhY2tCbHVyUkdCKGltYWdlRGF0YSwgeyByYWRpdXM6IDIwIH0pO1xuXHRcdC8vXG5cdFx0Ly8gY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2VEYXRhLCAwLCAwKTtcblx0XHQvLyB0YXJnZXRFbC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybChcIiArIGNhbnZhcy50b0RhdGFVUkwoKSArIFwiKVwiO1xuXHR9Ki9cbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIEdvb2dsZSBBbmFseXRpY3Ncbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuaWYgKEdBKSB7XG5cdFBsYXlhYmxlUmVuZGVyZXIgPSAoZnVuY3Rpb24oUGxheWFibGVSZW5kZXJlcikge1xuXG5cdFx0LyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZS5zdHJpbmdzL2Rhc2hlcml6ZX0gKi9cblx0XHR2YXIgZGFzaGVyaXplID0gcmVxdWlyZShcInVuZGVyc2NvcmUuc3RyaW5nL2Rhc2hlcml6ZVwiKTtcblxuXHRcdC8vIHZhciByZWFkeUV2ZW50cyA9IFtcInBsYXlpbmdcIiwgXCJ3YWl0aW5nXCIsIFwiZW5kZWRcIl07XG5cdFx0Ly8gdmFyIHVzZXJFdmVudHMgPSBbXCJwbGF5XCIsIFwicGF1c2VcIl07XG5cblxuXHRcdHJldHVybiBQbGF5YWJsZVJlbmRlcmVyLmV4dGVuZCh7XG5cblx0XHRcdC8qKiBAb3ZlcnJpZGUgKi9cblx0XHRcdGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgcmV0dmFsID0gUGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR0aGlzLl9wbGF5YmFja1JlcXVlc3RlZERlZmF1bHQgPSB0aGlzLnBsYXliYWNrUmVxdWVzdGVkO1xuXHRcdFx0XHRyZXR1cm4gcmV0dmFsO1xuXHRcdFx0fSxcblxuXHRcdFx0X29uUGxheWJhY2tUb2dnbGU6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRcdHZhciByZXR2YWwgPSBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5fb25QbGF5YmFja1RvZ2dsZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR2YXIgbyA9IHtcblx0XHRcdFx0XHRoaXRUeXBlOiBcImV2ZW50XCIsXG5cdFx0XHRcdFx0ZXZlbnRDYXRlZ29yeTogZGFzaGVyaXplKHRoaXMuY2lkUHJlZml4KSxcblx0XHRcdFx0XHRldmVudEFjdGlvbjogdGhpcy5wbGF5YmFja1JlcXVlc3RlZCA/IFwicGxheVwiIDogXCJwYXVzZVwiLFxuXHRcdFx0XHRcdGV2ZW50TGFiZWw6IHRoaXMubW9kZWwuZ2V0KFwidGV4dFwiKSxcblx0XHRcdFx0fTtcblx0XHRcdFx0aWYgKHRoaXMuX3BsYXliYWNrUmVxdWVzdGVkRGVmYXVsdClcblx0XHRcdFx0XHRvLmV2ZW50QWN0aW9uICs9IFwiLWF1dG9wbGF5XCI7XG5cdFx0XHRcdHdpbmRvdy5nYShcInNlbmRcIiwgbyk7XG5cdFx0XHRcdHJldHVybiByZXR2YWw7XG5cdFx0XHR9LFxuXG5cdFx0XHQvLyAvKiogQG92ZXJyaWRlICovXG5cdFx0XHQvLyB0b2dnbGVQbGF5YmFjazogZnVuY3Rpb24obmV3UGxheVN0YXRlKSB7XG5cdFx0XHQvLyBcdHZhciByZXR2YWwgPSBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS50b2dnbGVQbGF5YmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0Ly8gXHR3aW5kb3cuZ2EoXCJzZW5kXCIsIHtcblx0XHRcdC8vIFx0XHRoaXRUeXBlOiBcImV2ZW50XCIsXG5cdFx0XHQvLyBcdFx0ZXZlbnRDYXRlZ29yeTogXCJQbGF5YWJsZVwiLFxuXHRcdFx0Ly8gXHRcdGV2ZW50QWN0aW9uOiB0aGlzLnBsYXliYWNrUmVxdWVzdGVkID8gXCJwbGF5XCIgOiBcInBhdXNlXCIsXG5cdFx0XHQvLyBcdFx0ZXZlbnRMYWJlbDogdGhpcy5tb2RlbC5nZXQoXCJ0ZXh0XCIpLFxuXHRcdFx0Ly8gXHR9KTtcblx0XHRcdC8vIFx0cmV0dXJuIHJldHZhbDtcblx0XHRcdC8vIH0sXG5cdFx0fSk7XG5cdH0pKFBsYXlhYmxlUmVuZGVyZXIpO1xufVxuXG4vLyBpZiAoREVCVUcpIHtcbi8vXG4vLyBQbGF5YWJsZVJlbmRlcmVyID0gKGZ1bmN0aW9uKFBsYXlhYmxlUmVuZGVyZXIpIHtcbi8vIFx0aWYgKCFQbGF5YWJsZVJlbmRlcmVyLkxPR19UT19TQ1JFRU4pIHJldHVybiBQbGF5YWJsZVJlbmRlcmVyO1xuLy9cbi8vIFx0LyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZS5zdHJpbmdzL2xwYWR9ICovXG4vLyBcdHZhciBscGFkID0gcmVxdWlyZShcInVuZGVyc2NvcmUuc3RyaW5nL2xwYWRcIik7XG4vL1xuLy8gXHRyZXR1cm4gUGxheWFibGVSZW5kZXJlci5leHRlbmQoe1xuLy8gXHRcdF9jYW5SZXN1bWVQbGF5YmFjazogZnVuY3Rpb24oKSB7XG4vLyBcdFx0XHR2YXIgcmV0dmFsID0gUGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUuX2NhblJlc3VtZVBsYXliYWNrLmFwcGx5KHRoaXMuYXJndW1lbnRzKTtcbi8vIFx0XHRcdGNvbnNvbGUubG9nKFwiW3Njcm9sbF0gJXM6Ol9jYW5SZXN1bWVQbGF5YmFjaygpOiVzXCIsIHRoaXMuY2lkLCByZXR2YWwsXG4vLyBcdFx0XHR7XG4vLyBcdFx0XHRcdFwiZW5hYmxlZFwiOiB0aGlzLmVuYWJsZWQsXG4vLyBcdFx0XHRcdFwic2VsZWN0ZWRcIjogKCEhdGhpcy5tb2RlbC5zZWxlY3RlZCksXG4vLyBcdFx0XHRcdFwicGxheWJhY2tSZXF1ZXN0ZWRcIjogdGhpcy5wbGF5YmFja1JlcXVlc3RlZCxcbi8vIFx0XHRcdFx0XCJhdHRhY2hlZFwiOiB0aGlzLmF0dGFjaGVkLFxuLy8gXHRcdFx0XHRcInBhcmVudFZpZXdcIjogKHRoaXMucGFyZW50VmlldyAmJiB0aGlzLnBhcmVudFZpZXcuY2lkKSxcbi8vIFx0XHRcdFx0XCIhc2Nyb2xsaW5nXCI6ICh0aGlzLnBhcmVudFZpZXcgJiYgIXRoaXMucGFyZW50Vmlldy5zY3JvbGxpbmcpLFxuLy8gXHRcdFx0XHRcIm1lZGlhU3RhdGVcIjogdGhpcy5tZWRpYVN0YXRlLFxuLy8gXHRcdFx0XHQvLyBcIiFkb2N1bWVudC5oaWRkZW5cIjogIWRvY3VtZW50W3Zpc2liaWxpdHlIaWRkZW5Qcm9wXSxcbi8vIFx0XHRcdFx0XCJ2aXNpYmlsaXR5U3RhdGVcIjogZG9jdW1lbnRbdmlzaWJpbGl0eVN0YXRlUHJvcF1cbi8vIFx0XHRcdH0pO1xuLy8gXHRcdFx0cmV0dXJuIHJldHZhbDtcbi8vIFx0XHR9LFxuLy8gXHR9KTtcbi8vIH0pKFBsYXlhYmxlUmVuZGVyZXIpO1xuLy9cbi8vIH1cblxubW9kdWxlLmV4cG9ydHMgPSBQbGF5YWJsZVJlbmRlcmVyOyIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWhlbHBlcnMuaGVscGVyTWlzc2luZywgYWxpYXMzPVwiZnVuY3Rpb25cIiwgYWxpYXM0PWNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uO1xuXG4gIHJldHVybiBcIjxkaXYgY2xhc3M9XFxcInBsYWNlaG9sZGVyIHNpemluZ1xcXCI+PC9kaXY+XFxuPGRpdiBjbGFzcz1cXFwiY29udGVudFxcXCI+XFxuXHQ8ZGl2IGNsYXNzPVxcXCJtZWRpYS1ib3JkZXIgY29udGVudC1zaXplXFxcIj48L2Rpdj5cXG5cdDxkaXYgY2xhc3M9XFxcImNvbnRyb2xzIGNvbnRlbnQtc2l6ZVxcXCI+XFxuXHRcdDxjYW52YXMgY2xhc3M9XFxcInByb2dyZXNzLW1ldGVyXFxcIj48L2NhbnZhcz5cXG5cdDwvZGl2Plxcblx0PGRpdiBjbGFzcz1cXFwic2VxdWVuY2UgbWVkaWEtc2l6ZVxcXCI+XFxuXHRcdDxpbWcgY2xhc3M9XFxcInNlcXVlbmNlLXN0ZXAgY3VycmVudCBkZWZhdWx0XFxcIiBhbHQ9XFxcIlwiXG4gICAgKyBhbGlhczQoKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy50ZXh0IHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC50ZXh0IDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJ0ZXh0XCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIlxcXCIgbG9uZ2Rlc2M9XFxcIiNkZXNjX21cIlxuICAgICsgYWxpYXM0KCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuaWQgfHwgKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmlkIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJpZFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCJcXFwiIC8+XFxuXHQ8L2Rpdj5cXG5cdDxkaXYgY2xhc3M9XFxcIm92ZXJsYXkgbWVkaWEtc2l6ZVxcXCI+XFxuXHRcdDxkaXYgY2xhc3M9XFxcInBsYXktdG9nZ2xlLWhpdGFyZWEgcGxheS10b2dnbGVcXFwiPlxcblx0XHQ8L2Rpdj5cXG5cdDwvZGl2PlxcbjwvZGl2PlxcblwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvcmVuZGVyL1NlcXVlbmNlUmVuZGVyZXJcbiAqL1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuLyogSW1wb3J0c1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG52YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YmFja2JvbmV9ICovXG4vLyB2YXIgQmFja2JvbmUgPSByZXF1aXJlKFwiYmFja2JvbmVcIik7XG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZS5iYWJ5c2l0dGVyfSAqL1xudmFyIENvbnRhaW5lciA9IHJlcXVpcmUoXCJiYWNrYm9uZS5iYWJ5c2l0dGVyXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9iYXNlL1ZpZXd9ICovXG52YXIgVmlldyA9IHJlcXVpcmUoXCJhcHAvdmlldy9iYXNlL1ZpZXdcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9yZW5kZXIvUGxheWFibGVSZW5kZXJlcn0gKi9cbnZhciBQbGF5YWJsZVJlbmRlcmVyID0gcmVxdWlyZShcImFwcC92aWV3L3JlbmRlci9QbGF5YWJsZVJlbmRlcmVyXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6YXBwL21vZGVsL1NlbGVjdGFibGVDb2xsZWN0aW9ufSAqL1xuLy8gdmFyIFNlbGVjdGFibGVDb2xsZWN0aW9uID0gcmVxdWlyZShcImFwcC9tb2RlbC9TZWxlY3RhYmxlQ29sbGVjdGlvblwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG52YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTphcHAvdmlldy9jb21wb25lbnQvUHJvZ3Jlc3NNZXRlcn0gKi9cbnZhciBQcm9ncmVzc01ldGVyID0gcmVxdWlyZShcImFwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyXCIpO1xuXG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9UaW1lcn0gKi9cbnZhciBUaW1lciA9IHJlcXVpcmUoXCJ1dGlscy9UaW1lclwiKTtcbi8vIC8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG4vLyB2YXIgdHJhbnNpdGlvbkVuZCA9IHJlcXVpcmUoXCJ1dGlscy9ldmVudC90cmFuc2l0aW9uRW5kXCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRQcm9wZXJ0eX0gKi9cbi8vIHZhciBwcmVmaXhlZCA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFByb3BlcnR5XCIpO1xuXG4vKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xudmFyIF93aGVuSW1hZ2VMb2FkcyA9IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL193aGVuSW1hZ2VMb2Fkc1wiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3Byb21pc2UvX2xvYWRJbWFnZUFzT2JqZWN0VVJMfSAqL1xudmFyIF9sb2FkSW1hZ2VBc09iamVjdFVSTCA9IHJlcXVpcmUoXCJhcHAvdmlldy9wcm9taXNlL19sb2FkSW1hZ2VBc09iamVjdFVSTFwiKTtcbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgd2hlblNlbGVjdGlvbkRpc3RhbmNlSXMgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuU2VsZWN0aW9uRGlzdGFuY2VJc1wiKTtcbi8vIHZhciB3aGVuU2VsZWN0VHJhbnNpdGlvbkVuZHMgPSByZXF1aXJlKFwiYXBwL3ZpZXcvcHJvbWlzZS93aGVuU2VsZWN0VHJhbnNpdGlvbkVuZHNcIik7XG4vLyB2YXIgd2hlbkRlZmF1bHRJbWFnZUxvYWRzID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlbkRlZmF1bHRJbWFnZUxvYWRzXCIpO1xuXG4vLyAvKiogQHR5cGUge0Z1bmN0aW9ufSAqL1xuLy8gdmFyIENvbG9yID0gcmVxdWlyZShcImNvbG9yXCIpO1xuLy8gdmFyIGR1b3RvbmUgPSByZXF1aXJlKFwidXRpbHMvY2FudmFzL2JpdG1hcC9kdW90b25lXCIpO1xuLy8gdmFyIHN0YWNrQmx1clJHQiA9IHJlcXVpcmUoXCJ1dGlscy9jYW52YXMvYml0bWFwL3N0YWNrQmx1clJHQlwiKTtcbi8vIHZhciBzdGFja0JsdXJNb25vID0gcmVxdWlyZShcInV0aWxzL2NhbnZhcy9iaXRtYXAvc3RhY2tCbHVyTW9ub1wiKTtcbi8vIHZhciBnZXRBdmVyYWdlUkdCQSA9IHJlcXVpcmUoXCJ1dGlscy9jYW52YXMvYml0bWFwL2dldEF2ZXJhZ2VSR0JBXCIpO1xuXG52YXIgZXJyb3JUZW1wbGF0ZSA9IHJlcXVpcmUoXCIuLi90ZW1wbGF0ZS9FcnJvckJsb2NrLmhic1wiKTtcblxudmFyIE1JTl9TVEVQX0lOVEVSVkFMID0gMiAqIEdsb2JhbHMuVFJBTlNJVElPTl9EVVJBVElPTiArIEdsb2JhbHMuVFJBTlNJVElPTl9ERUxBWV9JTlRFUlZBTDtcbnZhciBERUZBVUxUX1NURVBfSU5URVJWQUwgPSA2ICogR2xvYmFscy5UUkFOU0lUSU9OX0RVUkFUSU9OICsgR2xvYmFscy5UUkFOU0lUSU9OX0RFTEFZX0lOVEVSVkFMO1xuXG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG4vKiBQcml2YXRlIGNsYXNzZXNcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vLyAvKipcbi8vICogQGNvbnN0cnVjdG9yXG4vLyAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1NlcXVlbmNlUmVuZGVyZXIuU291cmNlQ29sbGVjdGlvbn1cbi8vICovXG4vLyB2YXIgU291cmNlQ29sbGVjdGlvbiA9IFNlbGVjdGFibGVDb2xsZWN0aW9uLmV4dGVuZCh7XG4vLyBcdG1vZGVsOiBCYWNrYm9uZS5Nb2RlbFxuLy8gfSk7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9TZXF1ZW5jZVJlbmRlcmVyLlByZWZldGVjaGVkU291cmNlUmVuZGVyZXJ9XG4gKi9cbnZhciBQcmVmZXRlY2hlZFNvdXJjZVJlbmRlcmVyID0gVmlldy5leHRlbmQoe1xuXG5cdGNpZFByZWZpeDogXCJzZXF1ZW5jZVN0ZXBSZW5kZXJlclwiLFxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2xhc3NOYW1lOiBcInNlcXVlbmNlLXN0ZXBcIixcblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdHRhZ05hbWU6IFwiaW1nXCIsXG5cblx0cHJvcGVydGllczoge1xuXHRcdHJlYWR5OiB7XG5cdFx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gdGhpcy5fcmVhZHk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24ob3B0aW9ucykge1xuXHRcdCF0aGlzLmVsLmhhc0F0dHJpYnV0ZShcImFsdFwiKSAmJiB0aGlzLmVsLnNldEF0dHJpYnV0ZShcImFsdFwiLCB0aGlzLm1vZGVsLmdldChcInNyY1wiKSk7XG5cdFx0Ly8gdGhpcy5lbC5zZXRBdHRyaWJ1dGUoXCJsb25nZGVzY1wiLCB0aGlzLm1vZGVsLmdldChcIm9yaWdpbmFsXCIpKTtcblxuXHRcdGlmICh0aGlzLm1vZGVsLmhhcyhcInByZWZldGNoZWRcIikpIHtcblx0XHRcdHRoaXMuX3JlbmRlclByZWZldGNoZWQoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLm1vZGVsLCBcImNoYW5nZTpwcmVmZXRjaGVkXCIsIHRoaXMuX3JlbmRlclByZWZldGNoZWQpO1xuXHRcdH1cblx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwic2VsZWN0ZWQgZGVzZWxlY3RlZFwiLCB0aGlzLl9yZW5kZXJTZWxlY3Rpb24pO1xuXHRcdHRoaXMuX3JlbmRlclNlbGVjdGlvbigpO1xuXHR9LFxuXG5cdF9yZW5kZXJTZWxlY3Rpb246IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImN1cnJlbnRcIiwgISF0aGlzLm1vZGVsLnNlbGVjdGVkKTtcblx0fSxcblxuXHRfcmVuZGVyUHJlZmV0Y2hlZDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHByZWZldGNoZWQgPSB0aGlzLm1vZGVsLmdldChcInByZWZldGNoZWRcIik7XG5cdFx0aWYgKHByZWZldGNoZWQgIT09IHRoaXMuZWwuc3JjKSB7XG5cdFx0XHR0aGlzLmVsLnNyYyA9IHByZWZldGNoZWQ7XG5cdFx0fVxuXHRcdF93aGVuSW1hZ2VMb2Fkcyh0aGlzLmVsKS50aGVuKFxuXHRcdFx0ZnVuY3Rpb24oZWwpIHtcblx0XHRcdFx0dGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24odHN0YW1wKSB7XG5cdFx0XHRcdFx0dGhpcy5fc2V0UmVhZHkodHJ1ZSk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fS5iaW5kKHRoaXMpLFxuXHRcdFx0ZnVuY3Rpb24oZXJyKSB7XG5cdFx0XHRcdC8vIHRoaXMuX3NldFJlYWR5KGZhbHNlKTtcblx0XHRcdFx0KGVyciBpbnN0YW5jZW9mIEVycm9yKSB8fCAoZXJyID0gbmV3IEVycm9yKFwiY2Fubm90IGxvYWQgcHJlZmV0Y2hlZCB1cmxcIikpO1xuXHRcdFx0XHR0aHJvdyBlcnI7XG5cdFx0XHR9LmJpbmQodGhpcylcblx0XHQpO1xuXHR9LFxuXG5cdC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cblx0X3JlYWR5OiBmYWxzZSxcblxuXHRfc2V0UmVhZHk6IGZ1bmN0aW9uKHJlYWR5KSB7XG5cdFx0aWYgKHRoaXMuX3JlYWR5ID09PSByZWFkeSkgcmV0dXJuO1xuXHRcdHRoaXMuX3JlYWR5ID0gISEocmVhZHkpOyAvLyBtYWtlIGJvb2xcblx0XHR0aGlzLnRyaWdnZXIoXCJyZW5kZXJlcjpyZWFkeVwiLCB0aGlzKTtcblx0fSxcblxuXHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGlmICh0aGlzLm1vZGVsLmhhcyhcInByZWZldGNoZWRcIikpIHtcblx0XHQvLyBcdHRoaXMuX3JlbmRlclByZWZldGNoZWQoKTtcblx0XHQvLyB9XG5cdFx0Ly8gdGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCAhIXRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHRcdGNvbnNvbGUubG9nKFwiJXM6OnJlbmRlclwiLCB0aGlzLmNpZCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG59KTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1NlcXVlbmNlUmVuZGVyZXIuU2ltcGxlU291cmNlUmVuZGVyZXJ9XG4gKi9cbi8vIHZhciBTaW1wbGVTb3VyY2VSZW5kZXJlciA9IFZpZXcuZXh0ZW5kKHtcbi8vXG4vLyBcdGNpZFByZWZpeDogXCJzZXF1ZW5jZVN0ZXBSZW5kZXJlclwiLFxuLy8gXHQvKiogQHR5cGUge3N0cmluZ30gKi9cbi8vIFx0Y2xhc3NOYW1lOiBcInNlcXVlbmNlLXN0ZXBcIixcbi8vIFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG4vLyBcdHRhZ05hbWU6IFwiaW1nXCIsXG4vL1xuLy8gXHQvKiogQG92ZXJyaWRlICovXG4vLyBcdGluaXRpYWxpemU6IGZ1bmN0aW9uIChvcHRpb25zKSB7XG4vLyBcdFx0Ly8gdGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCB0aGlzLm1vZGVsLmhhc093blByb3BlcnR5KFwic2VsZWN0ZWRcIikpO1xuLy8gXHRcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImN1cnJlbnRcIiwgISF0aGlzLm1vZGVsLnNlbGVjdGVkKTtcbi8vIFx0XHR0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIHtcbi8vIFx0XHRcdFwic2VsZWN0ZWRcIjogZnVuY3Rpb24gKCkge1xuLy8gXHRcdFx0XHR0aGlzLmVsLmNsYXNzTGlzdC5hZGQoXCJjdXJyZW50XCIpO1xuLy8gXHRcdFx0fSxcbi8vIFx0XHRcdFwiZGVzZWxlY3RlZFwiOiBmdW5jdGlvbiAoKSB7XG4vLyBcdFx0XHRcdHRoaXMuZWwuY2xhc3NMaXN0LnJlbW92ZShcImN1cnJlbnRcIik7XG4vLyBcdFx0XHR9XG4vLyBcdFx0fSk7XG4vLyBcdFx0aWYgKHRoaXMuZWwuc3JjID09PSBcIlwiKSB7XG4vLyBcdFx0XHR0aGlzLmVsLnNyYyA9IEdsb2JhbHMuTUVESUFfRElSICsgXCIvXCIgKyB0aGlzLm1vZGVsLmdldChcInNyY1wiKTtcbi8vIFx0XHR9XG4vL1xuLy8gXHRcdGlmICh0aGlzLm1vZGVsLmhhcyhcImVycm9yXCIpKSB7XG4vLyBcdFx0XHR0aGlzLl9vbk1vZGVsRXJyb3IoKTtcbi8vIFx0XHR9IGVsc2Uge1xuLy8gXHRcdFx0dGhpcy5saXN0ZW5Ub09uY2UodGhpcy5tb2RlbCwgXCJjaGFuZ2U6ZXJyb3JcIiwgdGhpcy5fb25Nb2RlbEVycm9yKTtcbi8vIFx0XHRcdC8vIHRoaXMubGlzdGVuVG9PbmNlKHRoaXMubW9kZWwsIHtcbi8vIFx0XHRcdC8vIFx0XCJjaGFuZ2U6c291cmNlXCI6IHRoaXMuX29uTW9kZWxTb3VyY2UsXG4vLyBcdFx0XHQvLyBcdFwiY2hhbmdlOmVycm9yXCI6IHRoaXMuX29uTW9kZWxFcnJvcixcbi8vIFx0XHRcdC8vIH0pO1xuLy8gXHRcdH1cbi8vIFx0fSxcbi8vXG4vLyBcdC8vIF9vbk1vZGVsU291cmNlOiBmdW5jdGlvbigpIHtcbi8vIFx0Ly8gXHR0aGlzLmVsLnNyYyA9IEdsb2JhbHMuTUVESUFfRElSICsgXCIvXCIgKyB0aGlzLm1vZGVsLmdldChcInNyY1wiKTtcbi8vIFx0Ly8gXHQvLyBjb25zb2xlLmxvZyhcIiVzOjpjaGFuZ2U6c3JjXCIsIHRoaXMuY2lkLCB0aGlzLm1vZGVsLmdldChcInNyY1wiKSk7XG4vLyBcdC8vIH0sXG4vL1xuLy8gXHRfb25Nb2RlbEVycm9yOiBmdW5jdGlvbigpIHtcbi8vIFx0XHR2YXIgZXJyID0gdGhpcy5tb2RlbC5nZXQoXCJlcnJvclwiKTtcbi8vIFx0XHR2YXIgZXJyRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuLy8gXHRcdGVyckVsLmNsYXNzTmFtZSA9IFwiZXJyb3IgY29sb3ItYmdcIiArICh0aGlzLm1vZGVsLnNlbGVjdGVkPyBcIiBjdXJyZW50XCIgOiBcIlwiKTtcbi8vIFx0XHRlcnJFbC5pbm5lckhUTUwgPSBlcnJvclRlbXBsYXRlKGVycik7XG4vLyBcdFx0dGhpcy5zZXRFbGVtZW50KGVyckVsLCB0cnVlKTtcbi8vIFx0XHRjb25zb2xlLmxvZyhcIiVzOjpjaGFuZ2U6ZXJyb3JcIiwgdGhpcy5jaWQsIGVyci5tZXNzYWdlLCBlcnIuaW5mb1NyYyk7XG4vLyBcdH0sXG4vLyB9KTtcblxudmFyIFNvdXJjZUVycm9yUmVuZGVyZXIgPSBWaWV3LmV4dGVuZCh7XG5cblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNsYXNzTmFtZTogXCJzZXF1ZW5jZS1zdGVwIGVycm9yXCIsXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0Y2lkUHJlZml4OiBcInNvdXJjZUVycm9yUmVuZGVyZXJcIixcblx0LyoqIEBvdmVycmlkZSAqL1xuXHR0ZW1wbGF0ZTogZXJyb3JUZW1wbGF0ZSxcblx0LyoqIEB0eXBlIHtib29sZWFufSAqL1xuXHRyZWFkeTogdHJ1ZSxcblxuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cdFx0Ly8gdmFyIGhhbmRsZVNlbGVjdGlvbkNoYW5nZSA9IGZ1bmN0aW9uIG9uU2VsZWN0aW9uQ2hhbmdlICgpIHtcblx0XHQvLyBcdHRoaXMuZWwuY2xhc3NMaXN0LnRvZ2dsZShcImN1cnJlbnRcIiwgISF0aGlzLm1vZGVsLnNlbGVjdGVkKTtcblx0XHQvLyB9O1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJzZWxlY3RlZCBkZXNlbGVjdGVkXCIsIGhhbmRsZVNlbGVjdGlvbkNoYW5nZSk7XG5cdFx0Ly8gLy8gdGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCAhIXRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHRcdC8vIGhhbmRsZVNlbGVjdGlvbkNoYW5nZS5jYWxsKHRoaXMpO1xuXHRcdHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJzZWxlY3RlZCBkZXNlbGVjdGVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCAhIXRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHRcdH0pO1xuXHR9LFxuXG5cdHJlbmRlcjogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5lbC5jbGFzc0xpc3QudG9nZ2xlKFwiY3VycmVudFwiLCAhIXRoaXMubW9kZWwuc2VsZWN0ZWQpO1xuXHRcdHRoaXMuZWwuaW5uZXJIVE1MID0gdGhpcy50ZW1wbGF0ZSh0aGlzLm1vZGVsLmdldChcImVycm9yXCIpKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcbn0pO1xuXG52YXIgU2VxdWVuY2VTdGVwUmVuZGVyZXIgPSBQcmVmZXRlY2hlZFNvdXJjZVJlbmRlcmVyO1xuLy8gdmFyIFNlcXVlbmNlU3RlcFJlbmRlcmVyID0gU2ltcGxlU291cmNlUmVuZGVyZXI7XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9TZXF1ZW5jZVJlbmRlcmVyfVxuICovXG52YXIgU2VxdWVuY2VSZW5kZXJlciA9IFBsYXlhYmxlUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcInNlcXVlbmNlUmVuZGVyZXJcIixcblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNsYXNzTmFtZTogUGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUuY2xhc3NOYW1lICsgXCIgc2VxdWVuY2UtcmVuZGVyZXJcIixcblx0LyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cblx0dGVtcGxhdGU6IHJlcXVpcmUoXCIuL1NlcXVlbmNlUmVuZGVyZXIuaGJzXCIpLFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIGluaXRpYWxpemVcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0aW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5zb3VyY2VzID0gdGhpcy5tb2RlbC5nZXQoXCJzb3VyY2VzXCIpO1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLmluaXRpYWxpemUuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0fSxcblxuXHRpbml0aWFsaXplQXN5bmM6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5pbml0aWFsaXplQXN5bmMuYXBwbHkodGhpcywgYXJndW1lbnRzKVxuXHRcdFx0LnRoZW4oXG5cdFx0XHRcdGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0XHRyZXR1cm4gdmlldy53aGVuQXR0YWNoZWQoKTtcblx0XHRcdFx0fSlcblx0XHRcdC50aGVuKGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0dmlldy5pbml0aWFsaXplUGxheWFibGUoKTtcblx0XHRcdFx0dmlldy51cGRhdGVPdmVybGF5KHZpZXcuZGVmYXVsdEltYWdlLCB2aWV3Lm92ZXJsYXkpO1xuXHRcdFx0XHR2aWV3LmFkZFNlbGVjdGlvbkxpc3RlbmVycygpO1xuXHRcdFx0XHRyZXR1cm4gdmlldztcblx0XHRcdH0pO1xuXHR9LFxuXG5cdHdoZW5Jbml0aWFsaXplZDogZnVuY3Rpb24odmlldykge1xuXHRcdHZhciByZXR2YWwgPSBQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS53aGVuSW5pdGlhbGl6ZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHR2aWV3Ll92YWxpZGF0ZVBsYXliYWNrKCk7XG5cdFx0cmV0dXJuIHJldHZhbDtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBjaGlsZHJlblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlICovXG5cdGNyZWF0ZUNoaWxkcmVuOiBmdW5jdGlvbigpIHtcblx0XHRQbGF5YWJsZVJlbmRlcmVyLnByb3RvdHlwZS5jcmVhdGVDaGlsZHJlbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0dGhpcy5wbGFjZWhvbGRlciA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5wbGFjZWhvbGRlclwiKTtcblx0XHR0aGlzLnNlcXVlbmNlID0gdGhpcy5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2VxdWVuY2VcIik7XG5cblx0XHR0aGlzLmNvbnRlbnQuY2xhc3NMaXN0LmFkZChcInN0YXJ0ZWRcIik7XG5cblx0XHQvLyBzdHlsZXNcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR2YXIgcywgYXR0cnMgPSB0aGlzLm1vZGVsLmF0dHJzKCk7XG5cdFx0Ly8gdmFyIHMsIGF0dHJzID0gdGhpcy5tb2RlbC5nZXQoXCJhdHRyc1wiKTtcblx0XHRzID0gXy5waWNrKGF0dHJzLCBcImJveC1zaGFkb3dcIiwgXCJib3JkZXJcIiwgXCJib3JkZXItcmFkaXVzXCIpO1xuXHRcdF8uZXh0ZW5kKHRoaXMuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLm1lZGlhLWJvcmRlclwiKS5zdHlsZSwgcyk7XG5cdFx0cyA9IF8ucGljayhhdHRycywgXCJib3JkZXItcmFkaXVzXCIpO1xuXHRcdF8uZXh0ZW5kKHRoaXMuc2VxdWVuY2Uuc3R5bGUsIHMpO1xuXHRcdF8uZXh0ZW5kKHRoaXMucGxhY2Vob2xkZXIuc3R5bGUsIHMpO1xuXG5cdFx0Ly8gbW9kZWxcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLnNvdXJjZXMuc2VsZWN0KHRoaXMubW9kZWwuZ2V0KFwic291cmNlXCIpKTtcblxuXHRcdC8vIGl0ZW1WaWV3c1xuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMuaXRlbVZpZXdzID0gbmV3IENvbnRhaW5lcigpO1xuXHRcdC8vIGFkZCBkZWZhdWx0IGltYWdlIGFzIHJlbmRlcmVyIChhbHJlYWR5IGluIERPTSlcblx0XHR0aGlzLml0ZW1WaWV3cy5hZGQobmV3IFNlcXVlbmNlU3RlcFJlbmRlcmVyKHtcblx0XHRcdGVsOiB0aGlzLmdldERlZmF1bHRJbWFnZSgpLFxuXHRcdFx0bW9kZWw6IHRoaXMuc291cmNlcy5zZWxlY3RlZFxuXHRcdH0pKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBsYXlvdXRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0dmFyIGVscywgZWwsIGksIGNzc1csIGNzc0g7XG5cdFx0dmFyIGNvbnRlbnQgPSB0aGlzLmNvbnRlbnQ7XG5cblx0XHQvLyBtZWRpYS1zaXplXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Y3NzVyA9IHRoaXMubWV0cmljcy5tZWRpYS53aWR0aCArIFwicHhcIjtcblx0XHRjc3NIID0gdGhpcy5tZXRyaWNzLm1lZGlhLmhlaWdodCArIFwicHhcIjtcblxuXHRcdGVscyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcIi5tZWRpYS1zaXplXCIpO1xuXHRcdGZvciAoaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGVsID0gZWxzLml0ZW0oaSk7XG5cdFx0XHRlbC5zdHlsZS53aWR0aCA9IGNzc1c7XG5cdFx0XHRlbC5zdHlsZS5oZWlnaHQgPSBjc3NIO1xuXHRcdH1cblx0XHRjb250ZW50LnN0eWxlLndpZHRoID0gY3NzVztcblx0XHRjb250ZW50LnN0eWxlLmhlaWdodCA9IGNzc0g7XG5cblx0XHQvLyBjb250ZW50LXBvc2l0aW9uXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIGNzc1gsIGNzc1k7XG5cdFx0Y3NzWCA9IHRoaXMubWV0cmljcy5jb250ZW50LnggKyBcInB4XCI7XG5cdFx0Y3NzWSA9IHRoaXMubWV0cmljcy5jb250ZW50LnkgKyBcInB4XCI7XG5cdFx0Y29udGVudC5zdHlsZS5sZWZ0ID0gY3NzWDtcblx0XHRjb250ZW50LnN0eWxlLnRvcCA9IGNzc1k7XG5cblx0XHRlbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5jb250cm9sc1wiKTtcblx0XHQvLyBlbC5zdHlsZS5sZWZ0ID0gY3NzWDtcblx0XHQvLyBlbC5zdHlsZS50b3AgPSBjc3NZO1xuXHRcdGVsLnN0eWxlLndpZHRoID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQud2lkdGggKyBcInB4XCI7XG5cdFx0ZWwuc3R5bGUuaGVpZ2h0ID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQuaGVpZ2h0ICsgXCJweFwiO1xuXG5cdFx0Ly8gLy8gY29udGVudC1zaXplXG5cdFx0Ly8gLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ly8gY3NzVyA9IHRoaXMubWV0cmljcy5jb250ZW50LndpZHRoICsgXCJweFwiO1xuXHRcdC8vIGNzc0ggPSB0aGlzLm1ldHJpY3MuY29udGVudC5oZWlnaHQgKyBcInB4XCI7XG5cdFx0Ly9cblx0XHQvLyBlbHMgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29udGVudC1zaXplXCIpO1xuXHRcdC8vIGZvciAoaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspIHtcblx0XHQvLyBcdGVsID0gZWxzLml0ZW0oaSk7XG5cdFx0Ly8gXHRlbC5zdHlsZS53aWR0aCA9IGNzc1c7XG5cdFx0Ly8gXHRlbC5zdHlsZS5oZWlnaHQgPSBjc3NIO1xuXHRcdC8vIH1cblxuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGluaXRpYWxpemVQbGF5YWJsZTogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gU2VxdWVuY2UgbW9kZWxcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvLyB0aGlzLnNvdXJjZXMgPSB0aGlzLl9jcmVhdGVTb3VyY2VDb2xsZWN0aW9uKHRoaXMubW9kZWwpO1xuXHRcdHdoZW5TZWxlY3Rpb25EaXN0YW5jZUlzKHRoaXMsIDApLnRoZW4odGhpcy5fcHJlbG9hZEFsbEl0ZW1zLCBmdW5jdGlvbihlcnIpIHtcblx0XHRcdGlmIChlcnIgaW5zdGFuY2VvZiBWaWV3LlZpZXdFcnJvcikgeyAvLyBJZ25vcmUgVmlld0Vycm9yXG5cdFx0XHRcdC8vIGNvbnNvbGUud2FybihlcnIubmFtZSwgZXJyLm1lc3NhZ2UpOy8vLCBlcnIudmlldy5jaWQpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gZXJyO1xuXHRcdH0pO1xuXG5cdFx0Ly8gdGltZXJcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLl9zZXF1ZW5jZUludGVydmFsID0gTWF0aC5tYXgocGFyc2VJbnQodGhpcy5tb2RlbC5hdHRyKFwiQHNlcXVlbmNlLWludGVydmFsXCIpKSwgTUlOX1NURVBfSU5URVJWQUwpIHx8IERFRkFVTFRfU1RFUF9JTlRFUlZBTDtcblxuXHRcdHRoaXMudGltZXIgPSBuZXcgVGltZXIoKTtcblx0XHR0aGlzLmxpc3RlblRvKHRoaXMsIFwidmlldzpyZW1vdmVkXCIsIGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpcy50aW1lci5zdG9wKCk7XG5cdFx0XHR0aGlzLnN0b3BMaXN0ZW5pbmcodGhpcy50aW1lcik7XG5cdFx0fSk7XG5cdFx0dGhpcy5saXN0ZW5Ubyh0aGlzLnRpbWVyLCB7XG5cdFx0XHRcInN0YXJ0XCI6IHRoaXMuX29uVGltZXJTdGFydCxcblx0XHRcdFwicmVzdW1lXCI6IHRoaXMuX29uVGltZXJSZXN1bWUsXG5cdFx0XHRcInBhdXNlXCI6IHRoaXMuX29uVGltZXJQYXVzZSxcblx0XHRcdFwiZW5kXCI6IHRoaXMuX29uVGltZXJFbmQsXG5cdFx0XHQvLyBcInN0b3BcIjogZnVuY3Rpb24gKCkgeyAvLyBzdG9wIGlzIG9ubHkgY2FsbGVkIG9uIHZpZXcgcmVtb3ZlfSxcblx0XHR9KTtcblxuXHRcdC8vIHByb2dyZXNzLW1ldGVyIG1vZGVsXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dGhpcy5fc291cmNlUHJvZ3Jlc3NCeUlkeCA9IHRoaXMuc291cmNlcy5tYXAoZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gMDtcblx0XHR9KTtcblx0XHR0aGlzLl9zb3VyY2VQcm9ncmVzc0J5SWR4WzBdID0gMTsgLy8gZmlyc3QgaXRlbSBpcyBhbHJlYWR5IGxvYWRlZFxuXG5cdFx0Ly8gcHJvZ3Jlc3MtbWV0ZXJcblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLnByb2dyZXNzTWV0ZXIgPSBuZXcgUHJvZ3Jlc3NNZXRlcih7XG5cdFx0XHRlbDogdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiLnByb2dyZXNzLW1ldGVyXCIpLFxuXHRcdFx0dmFsdWVzOiB7XG5cdFx0XHRcdGF2YWlsYWJsZTogdGhpcy5fc291cmNlUHJvZ3Jlc3NCeUlkeC5jb25jYXQoKSxcblx0XHRcdH0sXG5cdFx0XHRtYXhWYWx1ZXM6IHtcblx0XHRcdFx0YW1vdW50OiB0aGlzLnNvdXJjZXMubGVuZ3RoLFxuXHRcdFx0XHRhdmFpbGFibGU6IHRoaXMuc291cmNlcy5sZW5ndGgsXG5cdFx0XHR9LFxuXHRcdFx0Y29sb3I6IHRoaXMubW9kZWwuYXR0cihcImNvbG9yXCIpLFxuXHRcdFx0YmFja2dyb3VuZENvbG9yOiB0aGlzLm1vZGVsLmF0dHIoXCJiYWNrZ3JvdW5kLWNvbG9yXCIpLFxuXHRcdFx0bGFiZWxGbjogdGhpcy5fcHJvZ3Jlc3NMYWJlbEZuLmJpbmQodGhpcylcblx0XHR9KTtcblxuXHRcdC8vIHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi50b3AtYmFyXCIpXG5cdFx0Ly9cdFx0LmFwcGVuZENoaWxkKHRoaXMucHJvZ3Jlc3NNZXRlci5yZW5kZXIoKS5lbCk7XG5cdH0sXG5cblx0X3Byb2dyZXNzTGFiZWxGbjogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQgPT09IGZhbHNlKSByZXR1cm4gR2xvYmFscy5QQVVTRV9DSEFSO1xuXHRcdHJldHVybiAodGhpcy5zb3VyY2VzLnNlbGVjdGVkSW5kZXggKyAxKSArIFwiL1wiICsgdGhpcy5zb3VyY2VzLmxlbmd0aDtcblx0fSxcblxuXHRfcHJlbG9hZEFsbEl0ZW1zOiBmdW5jdGlvbih2aWV3KSB7XG5cdFx0dmlldy5vbmNlKFwidmlldzpyZW1vdmVcIiwgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgc2lsZW50ID0ge1xuXHRcdFx0XHRzaWxlbnQ6IHRydWVcblx0XHRcdH07XG5cdFx0XHR2aWV3LnNvdXJjZXMuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpbmRleCwgc291cmNlcykge1xuXHRcdFx0XHR2YXIgcHJlZmV0Y2hlZCA9IGl0ZW0uZ2V0KFwicHJlZmV0Y2hlZFwiKTtcblx0XHRcdFx0aWYgKHByZWZldGNoZWQgJiYgL15ibG9iXFw6Ly50ZXN0KHByZWZldGNoZWQpKSB7XG5cdFx0XHRcdFx0aXRlbS51bnNldChcInByZWZldGNoZWRcIiwgc2lsZW50KTtcblx0XHRcdFx0XHRpdGVtLnNldChcInByb2dyZXNzXCIsIDAsIHNpbGVudCk7XG5cdFx0XHRcdFx0VVJMLnJldm9rZU9iamVjdFVSTChwcmVmZXRjaGVkKTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdFx0cmV0dXJuIHZpZXcuc291cmNlcy5yZWR1Y2UoZnVuY3Rpb24obGFzdFByb21pc2UsIGl0ZW0sIGluZGV4LCBzb3VyY2VzKSB7XG5cdFx0XHRyZXR1cm4gbGFzdFByb21pc2UudGhlbihmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdGlmIChpdGVtLmhhcyhcInByZWZldGNoZWRcIikpIHtcblx0XHRcdFx0XHR2aWV3Ll91cGRhdGVJdGVtUHJvZ3Jlc3MoMSwgaW5kZXgpO1xuXHRcdFx0XHRcdHJldHVybiB2aWV3O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiBfbG9hZEltYWdlQXNPYmplY3RVUkwoaXRlbS5nZXQoXCJvcmlnaW5hbFwiKSxcblx0XHRcdFx0XHRcdFx0ZnVuY3Rpb24ocHJvZ3Jlc3MpIHtcblx0XHRcdFx0XHRcdFx0XHR2aWV3Ll91cGRhdGVJdGVtUHJvZ3Jlc3MocHJvZ3Jlc3MsIGluZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRpdGVtLnNldChcInByb2dyZXNzXCIsIHByb2dyZXNzKTtcblx0XHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0XHRcdC50aGVuKFxuXHRcdFx0XHRcdFx0XHRmdW5jdGlvbihwVXJsKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmlldy5fdXBkYXRlSXRlbVByb2dyZXNzKDEsIGluZGV4KTtcblx0XHRcdFx0XHRcdFx0XHRpdGVtLnNldCh7XG5cdFx0XHRcdFx0XHRcdFx0XHRwcmVmZXRjaGVkOiBwVXJsLFxuXHRcdFx0XHRcdFx0XHRcdFx0cHJvZ3Jlc3M6IDFcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHQvLyBpdGVtLnNldChcInByZWZldGNoZWRcIiwgcFVybCk7XG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdFx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRcdGZ1bmN0aW9uKGVycikge1xuXHRcdFx0XHRcdFx0XHRcdHZpZXcuX3VwZGF0ZUl0ZW1Qcm9ncmVzcygwLCBpbmRleCk7XG5cdFx0XHRcdFx0XHRcdFx0aXRlbS5zZXQoe1xuXHRcdFx0XHRcdFx0XHRcdFx0ZXJyb3I6IGVycixcblx0XHRcdFx0XHRcdFx0XHRcdHByb2dyZXNzOiAwXG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gaXRlbS5zZXQoXCJlcnJvclwiLCBlcnIpO1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB2aWV3O1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9LCBQcm9taXNlLnJlc29sdmUodmlldykpO1xuXHR9LFxuXG5cdC8vIF9wcmVsb2FkQWxsSXRlbXMyOiBmdW5jdGlvbih2aWV3KSB7XG5cdC8vIFx0cmV0dXJuIHZpZXcuc291cmNlcy5yZWR1Y2UoZnVuY3Rpb24obGFzdFByb21pc2UsIGl0ZW0sIGluZGV4LCBzb3VyY2VzKSB7XG5cdC8vIFx0XHRyZXR1cm4gbGFzdFByb21pc2UudGhlbihmdW5jdGlvbih2aWV3KSB7XG5cdC8vIFx0XHRcdHZhciBpdGVtVmlldyA9IHZpZXcuX2dldEl0ZW1SZW5kZXJlcihpdGVtKTtcblx0Ly8gXHRcdFx0cmV0dXJuIF93aGVuSW1hZ2VMb2FkcyhpdGVtVmlldy5lbCkudGhlbihmdW5jdGlvbih1cmwpe1xuXHQvLyBcdFx0XHRcdHZpZXcuX3VwZGF0ZUl0ZW1Qcm9ncmVzcygxLCBpbmRleCk7XG5cdC8vIFx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdC8vIFx0XHRcdH0sIGZ1bmN0aW9uKGVycikge1xuXHQvLyBcdFx0XHRcdHZpZXcuX3VwZGF0ZUl0ZW1Qcm9ncmVzcygwLCBpbmRleCk7XG5cdC8vIFx0XHRcdFx0aXRlbS5zZXQoXCJlcnJvclwiLCBlcnIpO1xuXHQvLyBcdFx0XHRcdHJldHVybiB2aWV3O1xuXHQvLyBcdFx0XHR9KTtcblx0Ly8gXHRcdH0pO1xuXHQvLyBcdH0sIFByb21pc2UucmVzb2x2ZSh2aWV3KSk7XG5cdC8vIH0sXG5cblx0Ly8gX2dldEl0ZW1SZW5kZXJlcjogZnVuY3Rpb24oaXRlbSkge31cblxuXHRfdXBkYXRlSXRlbVByb2dyZXNzOiBmdW5jdGlvbihwcm9ncmVzcywgaW5kZXgpIHtcblx0XHR0aGlzLl9zb3VyY2VQcm9ncmVzc0J5SWR4W2luZGV4XSA9IHByb2dyZXNzO1xuXHRcdGlmICh0aGlzLnByb2dyZXNzTWV0ZXIpIHtcblx0XHRcdHRoaXMucHJvZ3Jlc3NNZXRlci52YWx1ZVRvKHRoaXMuX3NvdXJjZVByb2dyZXNzQnlJZHgsIDMwMCwgXCJhdmFpbGFibGVcIik7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBQbGF5YWJsZVJlbmRlcmVyIGltcGxlbWVudGF0aW9uXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qKiBAb3ZlcnJpZGUgaW5pdGlhbCB2YWx1ZSAqL1xuXHRfcGxheWJhY2tSZXF1ZXN0ZWQ6IHRydWUsXG5cblx0LyoqIEB0eXBlIHtCb29sZWFufSBpbnRlcm5hbCBzdG9yZSAqL1xuXHRfcGF1c2VkOiB0cnVlLFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0X2lzTWVkaWFQYXVzZWQ6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0aGlzLl9wYXVzZWQ7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRfcGxheU1lZGlhOiBmdW5jdGlvbigpIHtcblx0XHRpZiAoIXRoaXMuX3BhdXNlZCkgcmV0dXJuO1xuXHRcdHRoaXMuX3BhdXNlZCA9IGZhbHNlO1xuXHRcdGlmICh0aGlzLnRpbWVyLnN0YXR1cyA9PSBUaW1lci5QQVVTRUQpIHtcblx0XHRcdHRoaXMudGltZXIuc3RhcnQoKTsgLy8gcmVzdW1lLCBhY3R1YWxseVxuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLnRpbWVyLnN0YXJ0KHRoaXMuX3NlcXVlbmNlSW50ZXJ2YWwpO1xuXHRcdH1cblx0fSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdF9wYXVzZU1lZGlhOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5fcGF1c2VkKSByZXR1cm47XG5cdFx0dGhpcy5fcGF1c2VkID0gdHJ1ZTtcblx0XHRpZiAodGhpcy50aW1lci5zdGF0dXMgPT0gVGltZXIuU1RBUlRFRCkge1xuXHRcdFx0dGhpcy50aW1lci5wYXVzZSgpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBzZXF1ZW5jZSBwcml2YXRlXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdF9vblRpbWVyU3RhcnQ6IGZ1bmN0aW9uKGR1cmF0aW9uKSB7XG5cdFx0dGhpcy5wcm9ncmVzc01ldGVyLnZhbHVlVG8odGhpcy5zb3VyY2VzLnNlbGVjdGVkSW5kZXggKyAxLCBkdXJhdGlvbiwgXCJhbW91bnRcIik7XG5cdFx0Ly8gaW5pdCBuZXh0IHJlbmRlcmVyIG5vdyB0byBoYXZlIHNtb290aCB0cmFuc2l0aW9uc1xuXHRcdHRoaXMuX2dldEl0ZW1SZW5kZXJlcih0aGlzLnNvdXJjZXMuZm9sbG93aW5nT3JGaXJzdCgpKTtcblx0fSxcblxuXHRfb25UaW1lclJlc3VtZTogZnVuY3Rpb24oZHVyYXRpb24pIHtcblx0XHR0aGlzLnByb2dyZXNzTWV0ZXIudmFsdWVUbyh0aGlzLnNvdXJjZXMuc2VsZWN0ZWRJbmRleCArIDEsIGR1cmF0aW9uLCBcImFtb3VudFwiKTtcblx0fSxcblxuXHRfb25UaW1lclBhdXNlOiBmdW5jdGlvbihkdXJhdGlvbikge1xuXHRcdC8vIHZhciBtZXRlckR1ciA9IHRoaXMucHJvZ3Jlc3NNZXRlci5fdmFsdWVEYXRhW1wiYW1vdW50XCJdLl9kdXJhdGlvbiAtIHRoaXMucHJvZ3Jlc3NNZXRlci5fdmFsdWVEYXRhW1wiYW1vdW50XCJdLl9lbGFwc2VkVGltZTtcblx0XHQvLyB2YXIgbWV0ZXJWYWwgPSB0aGlzLnByb2dyZXNzTWV0ZXIuZ2V0UmVuZGVyZWRWYWx1ZShcImFtb3VudFwiKTtcblx0XHQvLyB2YXIgdGltZXJWYWwgPSAodGhpcy5fc2VxdWVuY2VJbnRlcnZhbCAtIGR1cmF0aW9uKSAvIHRoaXMuX3NlcXVlbmNlSW50ZXJ2YWwgKyB0aGlzLnNvdXJjZXMuc2VsZWN0ZWRJbmRleDtcblx0XHQvL1xuXHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol9vblRpbWVyUGF1c2UgW2ludGVydmFsOiVzbXNdXFxuXFx0bWV0ZXI6JXMgKCVzbXMpXFxuXFx0dGltZXI6JXMgKCVzbXMpXFxuXFx0ZGlmZnM6JXMgKCVzbXMpXCIsXG5cdFx0Ly8gXHRcdHRoaXMuY2lkLCB0aGlzLl9zZXF1ZW5jZUludGVydmFsLFxuXHRcdC8vIFx0XHRtZXRlclZhbCwgbWV0ZXJEdXIsXG5cdFx0Ly8gXHRcdHRpbWVyVmFsLCBkdXJhdGlvbixcblx0XHQvLyBcdFx0TWF0aC5hYnMobWV0ZXJWYWwtdGltZXJWYWwpLCBNYXRoLmFicyhtZXRlckR1ci1kdXJhdGlvbikpO1xuXG5cdFx0Ly8gdGhpcy5wcm9ncmVzc01ldGVyLnZhbHVlVG8odGltZXJWYWwpO1xuXHRcdC8vIHRoaXMucHJvZ3Jlc3NNZXRlci52YWx1ZVRvKG1ldGVyVmFsKTtcblxuXHRcdHRoaXMucHJvZ3Jlc3NNZXRlci52YWx1ZVRvKHRoaXMucHJvZ3Jlc3NNZXRlci5nZXRSZW5kZXJlZFZhbHVlKFwiYW1vdW50XCIpLCAwLCBcImFtb3VudFwiKTtcblx0fSxcblxuXHRfb25UaW1lckVuZDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGNvbnRleHQgPSB0aGlzO1xuXHRcdHZhciBuZXh0U291cmNlLCBuZXh0VmlldztcblxuXHRcdG5leHRTb3VyY2UgPSB0aGlzLnNvdXJjZXMuZm9sbG93aW5nT3JGaXJzdCgpO1xuXHRcdC8vIGluaXQgbmV4dCByZW5kZXJlclxuXHRcdG5leHRWaWV3ID0gdGhpcy5fZ2V0SXRlbVJlbmRlcmVyKG5leHRTb3VyY2UpO1xuXHRcdC8vIGluaXQgc2Vjb25kIG5leHQgcmVuZGVyZXJcblx0XHQvLyB0aGlzLl9nZXRJdGVtUmVuZGVyZXIodGhpcy5zb3VyY2VzLmZvbGxvd2luZ09yRmlyc3QobmV4dFNvdXJjZSkpO1xuXG5cdFx0dmFyIHNob3dOZXh0VmlldyA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0Y29udGV4dC5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdGNvbnRleHQuY29udGVudC5jbGFzc0xpc3QucmVtb3ZlKFwid2FpdGluZ1wiKTtcblx0XHRcdFx0aWYgKCFjb250ZXh0Ll9wYXVzZWQpIHtcblx0XHRcdFx0XHQvLyBpZiAoY29udGV4dC5wbGF5YmFja1JlcXVlc3RlZCkge1xuXHRcdFx0XHRcdGNvbnRleHQuY29udGVudC5jbGFzc0xpc3QudG9nZ2xlKFwicGxheWJhY2stZXJyb3JcIiwgbmV4dFNvdXJjZS5oYXMoXCJlcnJvclwiKSk7XG5cdFx0XHRcdFx0Y29udGV4dC5zb3VyY2VzLnNlbGVjdChuZXh0U291cmNlKTsgLy8gTk9URTogc3RlcCBpbmNyZWFzZSBkb25lIGhlcmVcblx0XHRcdFx0XHQvLyB2aWV3LnVwZGF0ZU92ZXJsYXkobmV4dFZpZXcuZWwsIHZpZXcub3ZlcmxheSk7XG5cdFx0XHRcdFx0Y29udGV4dC50aW1lci5zdGFydChjb250ZXh0Ll9zZXF1ZW5jZUludGVydmFsKTtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpzaG93TmV4dFZpZXcgJXNtcyAlc1wiLCBjb250ZXh0LmNpZCwgY29udGV4dC5fc2VxdWVuY2VJbnRlcnZhbCwgbmV4dFNvdXJjZS5jaWQpXG5cdFx0XHRcdH1cblx0XHRcdH0pO1xuXHRcdH07XG5cblx0XHRpZiAobmV4dFNvdXJjZS5oYXMoXCJwcmVmZXRjaGVkXCIpKSB7XG5cdFx0XHQvLyBuZXh0VmlldyA9IGNvbnRleHQuX2dldEl0ZW1SZW5kZXJlcihuZXh0U291cmNlKS5lbDtcblx0XHRcdF93aGVuSW1hZ2VMb2FkcyhuZXh0Vmlldy5lbCkudGhlbihzaG93TmV4dFZpZXcsIHNob3dOZXh0Vmlldyk7XG5cdFx0fSBlbHNlIGlmIChuZXh0U291cmNlLmhhcyhcImVycm9yXCIpKSB7XG5cdFx0XHRzaG93TmV4dFZpZXcoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jb250ZW50LmNsYXNzTGlzdC5hZGQoXCJ3YWl0aW5nXCIpO1xuXHRcdFx0LyogVE9ETzogYWRkIGdhIGV2ZW50ICdtZWRpYS13YWl0aW5nJyAqL1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczpbd2FpdGluZ10gJXNtcyAlc1wiLCBjb250ZXh0LmNpZCwgbmV4dFNvdXJjZS5jaWQpO1xuXHRcdFx0d2luZG93LmdhKFwic2VuZFwiLCBcImV2ZW50XCIsIFwic2VxdWVuY2UtcmVuZGVyZXJcIiwgXCJ3YWl0aW5nXCIsIHRoaXMubW9kZWwuZ2V0KFwidGV4dFwiKSk7XG5cdFx0XHR0aGlzLmxpc3RlblRvKG5leHRTb3VyY2UsIFwiY2hhbmdlOnByZWZldGNoZWQgY2hhbmdlOmVycm9yXCIsXG5cdFx0XHRcdGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdHRoaXMuc3RvcExpc3RlbmluZyhuZXh0U291cmNlLCBcImNoYW5nZTpwcmVmZXRjaGVkIGNoYW5nZTplcnJvclwiKTtcblx0XHRcdFx0XHQvKiBUT0RPOiBhZGQgZ2EgZXZlbnQgJ21lZGlhLXBsYXlpbmcnICovXG5cdFx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczpbcGxheWluZ10gJXNtcyAlc1wiLCBjb250ZXh0LmNpZCwgbmV4dFNvdXJjZS5jaWQpO1xuXHRcdFx0XHRcdHdpbmRvdy5nYShcInNlbmRcIiwgXCJldmVudFwiLCBcInNlcXVlbmNlLXJlbmRlcmVyXCIsIFwicGxheWluZ1wiLCB0aGlzLm1vZGVsLmdldChcInRleHRcIikpO1xuXHRcdFx0XHRcdF93aGVuSW1hZ2VMb2FkcyhuZXh0Vmlldy5lbCkudGhlbihzaG93TmV4dFZpZXcsIHNob3dOZXh0Vmlldyk7XG5cdFx0XHRcdFx0Ly8gY29udGV4dC5jb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJ3YWl0aW5nXCIpO1xuXHRcdFx0XHRcdC8vIG5leHRWaWV3ID0gY29udGV4dC5fZ2V0SXRlbVJlbmRlcmVyKG5leHRTb3VyY2UpLmVsO1xuXHRcdFx0XHR9KTtcblx0XHR9XG5cdH0sXG5cblx0X2dldEl0ZW1SZW5kZXJlcjogZnVuY3Rpb24oaXRlbSkge1xuXHRcdHZhciB2aWV3ID0gdGhpcy5pdGVtVmlld3MuZmluZEJ5TW9kZWwoaXRlbSk7XG5cdFx0aWYgKCF2aWV3KSB7XG5cdFx0XHR2YXIgcmVuZGVyZXIgPSBpdGVtLmhhcyhcImVycm9yXCIpID8gU291cmNlRXJyb3JSZW5kZXJlciA6IFNlcXVlbmNlU3RlcFJlbmRlcmVyO1xuXHRcdFx0dmlldyA9IG5ldyByZW5kZXJlcih7XG5cdFx0XHRcdG1vZGVsOiBpdGVtXG5cdFx0XHR9KTtcblx0XHRcdC8vIHZpZXcgPSBuZXcgU2VxdWVuY2VTdGVwUmVuZGVyZXIoeyBtb2RlbDogaXRlbSB9KTtcblx0XHRcdHRoaXMuaXRlbVZpZXdzLmFkZCh2aWV3KTtcblx0XHRcdHRoaXMuc2VxdWVuY2UuYXBwZW5kQ2hpbGQodmlldy5yZW5kZXIoKS5lbCk7XG5cdFx0fVxuXHRcdHJldHVybiB2aWV3O1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG5cdC8qIHByb2dyZXNzIG1ldGVyXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIF9jcmVhdGVEZWZhdWx0SXRlbURhdGE6IGZ1bmN0aW9uKCkge1xuXHQvLyBcdHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xuXHQvLyBcdHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcblx0Ly8gXHR2YXIgaW1hZ2VEYXRhID0gdGhpcy5fZHJhd01lZGlhRWxlbWVudChjb250ZXh0KS5nZXRJbWFnZURhdGEoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcblx0Ly9cblx0Ly8gXHR2YXIgb3B0cyA9IHsgcmFkaXVzOiAyMCB9O1xuXHQvLyBcdHZhciBmZ0NvbG9yID0gbmV3IENvbG9yKHRoaXMubW9kZWwuYXR0cihcImNvbG9yXCIpKTtcblx0Ly8gXHR2YXIgYmdDb2xvciA9IG5ldyBDb2xvcih0aGlzLm1vZGVsLmF0dHIoXCJiYWNrZ3JvdW5kLWNvbG9yXCIpKTtcblx0Ly8gXHR2YXIgaXNGZ0RhcmsgPSBmZ0NvbG9yLmx1bWlub3NpdHkoKSA8IGJnQ29sb3IubHVtaW5vc2l0eSgpO1xuXHQvLyBcdG9wdHMueDAwID0gaXNGZ0Rhcms/IGZnQ29sb3IuY2xvbmUoKS5saWdodGVuKDAuMzMpIDogYmdDb2xvci5jbG9uZSgpLmRhcmtlbigwLjMzKTtcblx0Ly8gXHRvcHRzLnhGRiA9IGlzRmdEYXJrPyBiZ0NvbG9yLmNsb25lKCkubGlnaHRlbigwLjMzKSA6IGZnQ29sb3IuY2xvbmUoKS5kYXJrZW4oMC4zMyk7XG5cdC8vXG5cdC8vIFx0c3RhY2tCbHVyTW9ubyhpbWFnZURhdGEsIG9wdHMpO1xuXHQvLyBcdGR1b3RvbmUoaW1hZ2VEYXRhLCBvcHRzKTtcblx0Ly8gXHQvLyBzdGFja0JsdXJSR0IoaW1hZ2VEYXRhLCBvcHRzKTtcblx0Ly9cblx0Ly8gXHRjb250ZXh0LnB1dEltYWdlRGF0YShpbWFnZURhdGEsIDAsIDApO1xuXHQvLyBcdHJldHVybiBjYW52YXMudG9EYXRhVVJMKCk7XG5cdC8vIH0sXG59KTtcblxuaWYgKERFQlVHKSB7XG5cblx0U2VxdWVuY2VSZW5kZXJlciA9IChmdW5jdGlvbihTZXF1ZW5jZVJlbmRlcmVyKSB7XG5cdFx0aWYgKCFTZXF1ZW5jZVJlbmRlcmVyLkxPR19UT19TQ1JFRU4pIHJldHVybiBTZXF1ZW5jZVJlbmRlcmVyO1xuXG5cdFx0LyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZS5zdHJpbmdzL2xwYWR9ICovXG5cdFx0dmFyIGxwYWQgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvbHBhZFwiKTtcblxuXHRcdHJldHVybiBTZXF1ZW5jZVJlbmRlcmVyLmV4dGVuZCh7XG5cdFx0XHRfX2xvZ1RpbWVyRXZlbnQ6IGZ1bmN0aW9uKGV2bmFtZSwgbXNnKSB7XG5cdFx0XHRcdHZhciBsb2dNc2cgPSBbXG5cdFx0XHRcdFwic291cmNlOiBcIiwgbHBhZCh0aGlzLnNvdXJjZXMuc2VsZWN0ZWRJbmRleCwgMiksXG5cdFx0XHRcdFwiZHVyYXRpb246XCIsIGxwYWQodGhpcy50aW1lci5nZXREdXJhdGlvbigpLCA0KSxcblx0XHRcdFx0XCJwYXVzZWQ6XCIsIHRoaXMucGF1c2VkLFxuXHRcdFx0XHRcInJlcXVlc3RlZDpcIiwgdGhpcy5wbGF5YmFja1JlcXVlc3RlZCxcblx0XHRcdFx0XCJzdGF0dXM6XCIsIHRoaXMudGltZXIuZ2V0U3RhdHVzKCksXG5cdFx0XHRdO1xuXHRcdFx0XHRtc2cgJiYgbG9nTXNnLnB1c2gobXNnKTtcblx0XHRcdFx0bG9nTXNnID0gbG9nTXNnLmpvaW4oXCIgXCIpO1xuXG5cdFx0XHRcdHRoaXMuX19sb2dNZXNzYWdlKGxvZ01zZywgZXZuYW1lKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coXCIlczo6WyVzXSAlc1wiLCB0aGlzLmNpZCwgZXZuYW1lLCBsb2dNc2cpO1xuXHRcdFx0fSxcblx0XHRcdF9wbGF5TWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLl9fbG9nVGltZXJFdmVudChcInBsYXliYWNrXCIpO1xuXHRcdFx0XHRTZXF1ZW5jZVJlbmRlcmVyLnByb3RvdHlwZS5fcGxheU1lZGlhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdC8vIGNvbnNvbGUubG9nKFwiJXM6Ol9wbGF5TWVkaWEoKVwiLCB0aGlzLmNpZCk7XG5cdFx0XHR9LFxuXHRcdFx0X3BhdXNlTWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLl9fbG9nVGltZXJFdmVudChcInBsYXliYWNrXCIpO1xuXHRcdFx0XHRTZXF1ZW5jZVJlbmRlcmVyLnByb3RvdHlwZS5fcGF1c2VNZWRpYS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjpfcGF1c2VNZWRpYSgpXCIsIHRoaXMuY2lkKTtcblx0XHRcdH0sXG5cblx0XHRcdF9vblRpbWVyU3RhcnQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLl9fbG9nVGltZXJFdmVudChcInRpbWVyOnN0YXJ0XCIpO1xuXHRcdFx0XHRTZXF1ZW5jZVJlbmRlcmVyLnByb3RvdHlwZS5fb25UaW1lclN0YXJ0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LFxuXHRcdFx0X29uVGltZXJSZXN1bWU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLl9fbG9nVGltZXJFdmVudChcInRpbWVyOnJlc3VtZVwiKTtcblx0XHRcdFx0U2VxdWVuY2VSZW5kZXJlci5wcm90b3R5cGUuX29uVGltZXJTdGFydC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0fSxcblx0XHRcdF9vblRpbWVyUGF1c2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLl9fbG9nVGltZXJFdmVudChcInRpbWVyOnBhdXNlXCIpO1xuXHRcdFx0XHRTZXF1ZW5jZVJlbmRlcmVyLnByb3RvdHlwZS5fb25UaW1lclBhdXNlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LFxuXHRcdFx0X29uVGltZXJFbmQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR0aGlzLl9fbG9nVGltZXJFdmVudChcInRpbWVyOmVuZFwiKTtcblx0XHRcdFx0U2VxdWVuY2VSZW5kZXJlci5wcm90b3R5cGUuX29uVGltZXJFbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0XHRcdH0sXG5cblx0XHRcdF91cGRhdGVJdGVtUHJvZ3Jlc3M6IGZ1bmN0aW9uKHByb2dyZXNzLCBzcmNJZHgpIHtcblx0XHRcdFx0aWYgKHByb2dyZXNzID09IDEpIHtcblx0XHRcdFx0XHR0aGlzLl9fbG9nTWVzc2FnZShcImlkeDpcIiArIHNyY0lkeCArIFwiIHByb2dyZXNzOlwiICsgcHJvZ3Jlc3MsIFwibG9hZDpwcm9ncmVzc1wiKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRTZXF1ZW5jZVJlbmRlcmVyLnByb3RvdHlwZS5fdXBkYXRlSXRlbVByb2dyZXNzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LFxuXG5cdFx0XHRfcHJlbG9hZEFsbEl0ZW1zOiBmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdHZpZXcuX19sb2dNZXNzYWdlKHZpZXcuY2lkICsgXCI6Ol9wcmVsb2FkQWxsSXRlbXNcIiwgXCJsb2FkOnN0YXJ0XCIpO1xuXHRcdFx0XHRTZXF1ZW5jZVJlbmRlcmVyLnByb3RvdHlwZS5fcHJlbG9hZEFsbEl0ZW1zLmFwcGx5KHZpZXcsIGFyZ3VtZW50cyk7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHR9KShTZXF1ZW5jZVJlbmRlcmVyKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBTZXF1ZW5jZVJlbmRlcmVyOyIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgaGVscGVyO1xuXG4gIHJldHVybiBcIjxkaXYgY2xhc3M9XFxcInBsYWNlaG9sZGVyIHNpemluZ1xcXCI+PC9kaXY+XFxuPGRpdiBjbGFzcz1cXFwiY29udGVudCBtZWRpYS1ib3JkZXJcXFwiPlxcblx0PGRpdiBjbGFzcz1cXFwiY29udHJvbHMgY29udGVudC1zaXplXFxcIj5cXG5cdFx0XHQ8Y2FudmFzIGNsYXNzPVxcXCJwcm9ncmVzcy1tZXRlclxcXCI+PC9jYW52YXM+XFxuXHRcdFx0PGEgY2xhc3M9XFxcImZ1bGxzY3JlZW4tdG9nZ2xlXFxcIiBocmVmPVxcXCJqYXZhc2NyaXB0Oih2b2lkIDApXFxcIj5cXG5cdFx0XHRcdDxzdmcgdmVyc2lvbj1cXFwiMS4xXFxcIiB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHByZXNlcnZlQXNwZWN0UmF0aW89XFxcInhNaWRZTWlkIG1lZXRcXFwiIHZpZXdCb3g9XFxcIi0yMSAtMjEgNDIgNDJcXFwiIHN0eWxlPVxcXCJtYXgtd2lkdGg6MTRweDttYXgtaGVpZ2h0OjE0cHhcXFwiPlxcblx0XHRcdFx0XHQ8cGF0aCBkPVxcXCJNLTUsNSBMLTIwLDIwIE0tNywyMCBMLTIwLDIwIEwtMjAsNyBNNSwtNSBMMjAsLTIwIE03LC0yMCBMMjAsLTIwIEwyMCwtN1xcXCIgY2xhc3M9XFxcImNvbG9yLXN0cm9rZVxcXCIgc3R5bGU9XFxcInN0cm9rZS13aWR0aDoxO2ZpbGw6bm9uZTtcXFwiIHZlY3Rvci1lZmZlY3Q9XFxcIm5vbi1zY2FsaW5nLXN0cm9rZVxcXCIgLz5cXG5cdFx0XHRcdDwvc3ZnPlxcblx0XHRcdDwvYT5cXG5cdDwvZGl2Plxcblx0PGRpdiBjbGFzcz1cXFwiY3JvcC1ib3ggbWVkaWEtc2l6ZVxcXCI+XFxuXHRcdDx2aWRlbyBwcmVsb2FkPVxcXCJub25lXFxcIiB3aWR0aD1cXFwiMjQwXFxcIiBoZWlnaHQ9XFxcIjE4MFxcXCI+PC92aWRlbz5cXG5cdFx0PGltZyBjbGFzcz1cXFwicG9zdGVyIGRlZmF1bHRcXFwiIGFsdD1cXFwiXCJcbiAgICArIGNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMudGV4dCB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAudGV4dCA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBoZWxwZXJzLmhlbHBlck1pc3NpbmcpLCh0eXBlb2YgaGVscGVyID09PSBcImZ1bmN0aW9uXCIgPyBoZWxwZXIuY2FsbChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LHtcIm5hbWVcIjpcInRleHRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiXFxcIiB3aWR0aD1cXFwiMjQwXFxcIiBoZWlnaHQ9XFxcIjE4MFxcXCIgLz5cXG5cdDwvZGl2Plxcblx0PGRpdiBjbGFzcz1cXFwib3ZlcmxheSBtZWRpYS1zaXplXFxcIj5cXG5cdFx0PGRpdiBjbGFzcz1cXFwicGxheS10b2dnbGUtaGl0YXJlYSBwbGF5LXRvZ2dsZVxcXCI+XFxuXHRcdDwvZGl2Plxcblx0PC9kaXY+XFxuPC9kaXY+XFxuXCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8qZ2xvYmFsIEhUTUxNZWRpYUVsZW1lbnQsIE1lZGlhRXJyb3IqL1xuLyoqXG4gKiBAbW9kdWxlIGFwcC92aWV3L3JlbmRlci9WaWRlb1JlbmRlcmVyXG4gKlxuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVE1ML0VsZW1lbnQvdmlkZW9cbiAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL0hUTUxNZWRpYUVsZW1lbnRcbiAqIEBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvR3VpZGUvRXZlbnRzL01lZGlhX2V2ZW50c1xuICogQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9HdWlkZS9IVE1ML1VzaW5nX0hUTUw1X2F1ZGlvX2FuZF92aWRlb1xuICovXG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqXG4vKiBJbXBvcnRzXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbi8vIHZhciBCYWNrYm9uZSA9IHJlcXVpcmUoXCJiYWNrYm9uZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC9jb250cm9sL0dsb2JhbHN9ICovXG52YXIgR2xvYmFscyA9IHJlcXVpcmUoXCJhcHAvY29udHJvbC9HbG9iYWxzXCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6YXBwL3ZpZXcvcmVuZGVyL1BsYXlhYmxlUmVuZGVyZXJ9ICovXG52YXIgUGxheWFibGVSZW5kZXJlciA9IHJlcXVpcmUoXCJhcHAvdmlldy9yZW5kZXIvUGxheWFibGVSZW5kZXJlclwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L2NvbXBvbmVudC9Qcm9ncmVzc01ldGVyfSAqL1xudmFyIFByb2dyZXNzTWV0ZXIgPSByZXF1aXJlKFwiYXBwL3ZpZXcvY29tcG9uZW50L1Byb2dyZXNzTWV0ZXJcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFN0eWxlTmFtZX0gKi9cbi8vIHZhciBwcmVmaXhlZFN0eWxlTmFtZSA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFN0eWxlTmFtZVwiKTtcbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkRXZlbnR9ICovXG52YXIgcHJlZml4ZWRFdmVudCA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZEV2ZW50XCIpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuLyogcHJpdmF0ZSBzdGF0aWNcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4vLyB2YXIgd2hlblZpZXdJc0F0dGFjaGVkID0gcmVxdWlyZShcImFwcC92aWV3L3Byb21pc2Uvd2hlblZpZXdJc0F0dGFjaGVkXCIpO1xuXG52YXIgZnVsbHNjcmVlbkNoYW5nZUV2ZW50ID0gcHJlZml4ZWRFdmVudChcImZ1bGxzY3JlZW5jaGFuZ2VcIiwgZG9jdW1lbnQpO1xuLy8gdmFyIGZ1bGxzY3JlZW5FcnJvckV2ZW50ID0gcHJlZml4ZWRFdmVudChcImZ1bGxzY3JlZW5lcnJvclwiLCBkb2N1bWVudCk7XG5cbnZhciBmb3JtYXRUaW1lY29kZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdGlmIChpc05hTih2YWx1ZSkpIHJldHVybiBcIlwiOyAvL3ZhbHVlID0gMDtcblx0aWYgKHZhbHVlID49IDM2MDApIHJldHVybiAoKHZhbHVlIC8gMzYwMCkgfCAwKSArIFwiSFwiO1xuXHRpZiAodmFsdWUgPj0gNjApIHJldHVybiAoKHZhbHVlIC8gNjApIHwgMCkgKyBcIk1cIjtcblx0Ly8gaWYgKHZhbHVlID49IDEwKSByZXR1cm4gXCIwXCIgKyAodmFsdWUgfCAwKSArIFwiU1wiO1xuXHRyZXR1cm4gKHZhbHVlIHwgMCkgKyBcIlNcIjtcbn07XG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKiBAdHlwZSB7bW9kdWxlOmFwcC92aWV3L3JlbmRlci9WaWRlb1JlbmRlcmVyfVxuICovXG52YXIgVmlkZW9SZW5kZXJlciA9IFBsYXlhYmxlUmVuZGVyZXIuZXh0ZW5kKHtcblxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cblx0Y2lkUHJlZml4OiBcInZpZGVvUmVuZGVyZXJcIixcblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXG5cdGNsYXNzTmFtZTogUGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUuY2xhc3NOYW1lICsgXCIgdmlkZW8tcmVuZGVyZXJcIixcblx0LyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cblx0dGVtcGxhdGU6IHJlcXVpcmUoXCIuL1ZpZGVvUmVuZGVyZXIuaGJzXCIpLFxuXG5cdGV2ZW50czogKGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB3aW5kb3cuaGFzT3duUHJvcGVydHkoXCJvbnBvaW50ZXJ1cFwiKVxuXHRcdFx0PyB7IFwicG9pbnRlcnVwIC5mdWxsc2NyZWVuLXRvZ2dsZVwiOiBcIl9vbkZ1bGxzY3JlZW5Ub2dnbGVcIiB9XG5cdFx0XHQ6IHsgXCJtb3VzZXVwIC5mdWxsc2NyZWVuLXRvZ2dsZVwiOiBcIl9vbkZ1bGxzY3JlZW5Ub2dnbGVcIiB9XG5cdH0oKSksXG5cblx0Ly8gZXZlbnRzOiB7XG5cdC8vIFx0XCJjbGljayAuZnVsbHNjcmVlbi10b2dnbGVcIjogXCJfb25GdWxsc2NyZWVuVG9nZ2xlXCIsXG5cdC8vIH0sXG5cblx0Ly8gcHJvcGVydGllczoge1xuXHQvLyBcdHBhdXNlZDoge1xuXHQvLyBcdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0Ly8gXHRcdFx0cmV0dXJuIHRoaXMudmlkZW8ucGF1c2VkO1xuXHQvLyBcdFx0fVxuXHQvLyBcdH0sXG5cdC8vIH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRpbml0aWFsaXplOiBmdW5jdGlvbihvcHRzKSB7XG5cdFx0UGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0Xy5iaW5kQWxsKHRoaXMsXG5cdFx0XHRcIl91cGRhdGVQbGF5YmFja1N0YXRlXCIsXG5cdFx0XHRcIl91cGRhdGVQbGF5ZWRWYWx1ZVwiLFxuXHRcdFx0XCJfdXBkYXRlQnVmZmVyZWRWYWx1ZVwiLFxuXHRcdFx0XCJfb25NZWRpYUVycm9yXCIsXG5cdFx0XHRcIl9vbk1lZGlhRW5kZWRcIixcblx0XHRcdFwiX29uTWVkaWFQbGF5aW5nT25jZVwiLFxuXHRcdFx0XCJfb25GdWxsc2NyZWVuQ2hhbmdlXCJcblx0XHQpO1xuXHRcdC8vIHZhciBvblBlZXJTZWxlY3QgPSBmdW5jdGlvbigpIHtcblx0XHQvLyBcdHRoaXMuY29udGVudC5zdHlsZS5kaXNwbGF5ID0gKHRoaXMuZ2V0U2VsZWN0aW9uRGlzdGFuY2UoKSA+IDEpPyBcIm5vbmVcIjogXCJcIjtcblx0XHQvLyB9O1xuXHRcdC8vIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbC5jb2xsZWN0aW9uLCBcInNlbGVjdDpvbmUgc2VsZWN0Om5vbmVcIiwgb25QZWVyU2VsZWN0KTtcblx0XHQvLyBvblBlZXJTZWxlY3QoKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBjaGlsZHJlbi9sYXlvdXRcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRjcmVhdGVDaGlsZHJlbjogZnVuY3Rpb24oKSB7XG5cdFx0UGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUuY3JlYXRlQ2hpbGRyZW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblxuXHRcdHRoaXMucGxhY2Vob2xkZXIgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIucGxhY2Vob2xkZXJcIik7XG5cdFx0Ly8gdGhpcy5vdmVybGF5ID0gdGhpcy5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIub3ZlcmxheVwiKTtcblx0XHR0aGlzLnZpZGVvID0gdGhpcy5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCJ2aWRlb1wiKTtcblx0XHQvLyB0aGlzLnZpZGVvLmxvb3AgPSB0aGlzLm1vZGVsLmF0dHJzKCkuaGFzT3duUHJvcGVydHkoXCJAdmlkZW8tbG9vcFwiKTtcblx0XHR0aGlzLnZpZGVvLmxvb3AgPSB0aGlzLm1vZGVsLmF0dHIoXCJAdmlkZW8tbG9vcFwiKSAhPT0gdm9pZCAwO1xuXHRcdHRoaXMudmlkZW8uc3JjID0gdGhpcy5maW5kUGxheWFibGVTb3VyY2UodGhpcy52aWRlbyk7XG5cdH0sXG5cblx0bWVhc3VyZTogZnVuY3Rpb24oKSB7XG5cdFx0UGxheWFibGVSZW5kZXJlci5wcm90b3R5cGUubWVhc3VyZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0Ly8gTk9URTogVG9wL2JvdHRvbSAxcHggdmlkZW8gY3JvcFxuXHRcdC8vIC0gQ3JvcHBlZCBpbiBDU1M6IHZpZGVvLCAucG9zdGVyIHsgbWFyZ2luLXRvcDogLTFweDsgbWFyZ2luLWJvdHRvbTogLTFweDt9XG5cdFx0Ly8gLSBDcm9wcGVkIGhlaWdodCBpcyBhZGp1c3RlZCBpbiBtZXRyaWNzIG9ialxuXHRcdC8vIC0gQ3JvcCBhbW91bnQgYWRkZWQgYmFjayB0byBhY3R1YWwgdmlkZW8gb24gcmVuZGVyKClcblx0XHR0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0IC09IDI7XG5cdFx0dGhpcy5tZXRyaWNzLmNvbnRlbnQuaGVpZ2h0IC09IDI7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRyZW5kZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFBsYXlhYmxlUmVuZGVyZXIucHJvdG90eXBlLnJlbmRlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0dmFyIGVscywgZWwsIGksIGNzc1csIGNzc0g7XG5cdFx0dmFyIGltZyA9IHRoaXMuZGVmYXVsdEltYWdlO1xuXHRcdHZhciBjb250ZW50ID0gdGhpcy5jb250ZW50O1xuXG5cdFx0Ly8gbWVkaWEtc2l6ZVxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdGNzc1cgPSB0aGlzLm1ldHJpY3MubWVkaWEud2lkdGggKyBcInB4XCI7XG5cdFx0Y3NzSCA9IHRoaXMubWV0cmljcy5tZWRpYS5oZWlnaHQgKyBcInB4XCI7XG5cblx0XHRlbHMgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubWVkaWEtc2l6ZVwiKTtcblx0XHRmb3IgKGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRlbCA9IGVscy5pdGVtKGkpO1xuXHRcdFx0ZWwuc3R5bGUud2lkdGggPSBjc3NXO1xuXHRcdFx0ZWwuc3R5bGUuaGVpZ2h0ID0gY3NzSDtcblx0XHR9XG5cblx0XHRjb250ZW50LnN0eWxlLndpZHRoID0gY3NzVztcblx0XHRjb250ZW50LnN0eWxlLmhlaWdodCA9ICh0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0IC0gMSkgKyBcInB4XCI7XG5cblx0XHQvLyBjb250ZW50LXBvc2l0aW9uXG5cdFx0Ly8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0dmFyIGNzc1gsIGNzc1k7XG5cdFx0Y3NzWCA9IHRoaXMubWV0cmljcy5jb250ZW50LnggKyBcInB4XCI7XG5cdFx0Y3NzWSA9IHRoaXMubWV0cmljcy5jb250ZW50LnkgKyBcInB4XCI7XG5cdFx0Y29udGVudC5zdHlsZS5sZWZ0ID0gY3NzWDtcblx0XHRjb250ZW50LnN0eWxlLnRvcCA9IGNzc1k7XG5cblx0XHRlbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcihcIi5jb250cm9sc1wiKTtcblx0XHQvLyBlbC5zdHlsZS5sZWZ0ID0gY3NzWDtcblx0XHQvLyBjb250cm9scy5zdHlsZS50b3AgPSBjc3NZO1xuXHRcdGVsLnN0eWxlLndpZHRoID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQud2lkdGggKyBcInB4XCI7XG5cdFx0ZWwuc3R5bGUuaGVpZ2h0ID0gdGhpcy5tZXRyaWNzLmNvbnRlbnQuaGVpZ2h0ICsgXCJweFwiO1xuXG5cdFx0Ly8gLy8gY29udGVudC1zaXplXG5cdFx0Ly8gLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ly8gY3NzVyA9IHRoaXMubWV0cmljcy5jb250ZW50LndpZHRoICsgXCJweFwiO1xuXHRcdC8vIGNzc0ggPSB0aGlzLm1ldHJpY3MuY29udGVudC5oZWlnaHQgKyBcInB4XCI7XG5cdFx0Ly9cblx0XHQvLyBlbHMgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29udGVudC1zaXplXCIpO1xuXHRcdC8vIGZvciAoaSA9IDA7IGkgPCBlbHMubGVuZ3RoOyBpKyspIHtcblx0XHQvLyBcdGVsID0gZWxzLml0ZW0oaSk7XG5cdFx0Ly8gXHRlbC5zdHlsZS53aWR0aCA9IGNzc1c7XG5cdFx0Ly8gXHRlbC5zdHlsZS5oZWlnaHQgPSBjc3NIO1xuXHRcdC8vIH1cblxuXHRcdC8vIE5PVEU6IGVsZW1lbnRzIGJlbG93IG11c3QgdXNlIHZpZGVvJ3MgVU5DUk9QUEVEIGhlaWdodCwgc28gKzJweFxuXHRcdHRoaXMudmlkZW8uc2V0QXR0cmlidXRlKFwid2lkdGhcIiwgdGhpcy5tZXRyaWNzLm1lZGlhLndpZHRoKTtcblx0XHR0aGlzLnZpZGVvLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0ICsgMik7XG5cdFx0aW1nLnNldEF0dHJpYnV0ZShcIndpZHRoXCIsIHRoaXMubWV0cmljcy5tZWRpYS53aWR0aCk7XG5cdFx0aW1nLnNldEF0dHJpYnV0ZShcImhlaWdodFwiLCB0aGlzLm1ldHJpY3MubWVkaWEuaGVpZ2h0ICsgMik7XG5cblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKlxuXHQvKiBpbml0aWFsaXplQXN5bmNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0aW5pdGlhbGl6ZUFzeW5jOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMpXG5cdFx0XHQudGhlbihQbGF5YWJsZVJlbmRlcmVyLndoZW5TZWxlY3Rpb25Jc0NvbnRpZ3VvdXMpXG5cdFx0XHQudGhlbihQbGF5YWJsZVJlbmRlcmVyLndoZW5TY3JvbGxpbmdFbmRzKVxuXHRcdFx0LnRoZW4oXG5cdFx0XHRcdGZ1bmN0aW9uKHZpZXcpIHtcblx0XHRcdFx0XHRyZXR1cm4gUHJvbWlzZS5hbGwoW1xuXHRcdFx0XHRcdFx0dmlldy53aGVuVmlkZW9IYXNNZXRhZGF0YSh2aWV3KSxcblx0XHRcdFx0XHRcdFBsYXlhYmxlUmVuZGVyZXIud2hlbkRlZmF1bHRJbWFnZUxvYWRzKHZpZXcpLFxuXHRcdFx0XHRcdF0pLnRoZW4oXG5cdFx0XHRcdFx0XHRmdW5jdGlvbihhcnIpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVzb2x2ZSh2aWV3KTtcblx0XHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0XHRmdW5jdGlvbihlcnIpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIFByb21pc2UucmVqZWN0KGVycik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fSlcblx0XHRcdC50aGVuKFxuXHRcdFx0XHRmdW5jdGlvbih2aWV3KSB7XG5cdFx0XHRcdFx0cmV0dXJuIHZpZXcud2hlbkF0dGFjaGVkKCk7XG5cdFx0XHRcdH0pXG5cdFx0XHQudGhlbihcblx0XHRcdFx0ZnVuY3Rpb24odmlldykge1xuXHRcdFx0XHRcdHZpZXcuaW5pdGlhbGl6ZVBsYXlhYmxlKCk7XG5cdFx0XHRcdFx0dmlldy51cGRhdGVPdmVybGF5KHZpZXcuZGVmYXVsdEltYWdlLCB2aWV3Lm92ZXJsYXkpO1xuXHRcdFx0XHRcdHZpZXcuYWRkU2VsZWN0aW9uTGlzdGVuZXJzKCk7XG5cdFx0XHRcdFx0cmV0dXJuIHZpZXc7XG5cdFx0XHRcdH0pO1xuXHR9LFxuXG5cdGluaXRpYWxpemVQbGF5YWJsZTogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gdmlkZW9cblx0XHQvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHR0aGlzLmFkZE1lZGlhTGlzdGVuZXJzKCk7XG5cblx0XHQvLyBwcm9ncmVzcy1tZXRlclxuXHRcdC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdHRoaXMucHJvZ3Jlc3NNZXRlciA9IG5ldyBQcm9ncmVzc01ldGVyKHtcblx0XHRcdGVsOiB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZ3Jlc3MtbWV0ZXJcIiksXG5cdFx0XHRtYXhWYWx1ZXM6IHtcblx0XHRcdFx0YW1vdW50OiB0aGlzLnZpZGVvLmR1cmF0aW9uLFxuXHRcdFx0XHRhdmFpbGFibGU6IHRoaXMudmlkZW8uZHVyYXRpb24sXG5cdFx0XHR9LFxuXHRcdFx0Y29sb3I6IHRoaXMubW9kZWwuYXR0cihcImNvbG9yXCIpLFxuXHRcdFx0YmFja2dyb3VuZENvbG9yOiB0aGlzLm1vZGVsLmF0dHIoXCJiYWNrZ3JvdW5kLWNvbG9yXCIpLFxuXHRcdFx0bGFiZWxGbjogdGhpcy5fcHJvZ3Jlc3NMYWJlbEZuLmJpbmQodGhpcylcblx0XHR9KTtcblx0XHQvLyB2YXIgcGFyZW50RWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCIudG9wLWJhclwiKTtcblx0XHQvLyBwYXJlbnRFbC5pbnNlcnRCZWZvcmUodGhpcy5wcm9ncmVzc01ldGVyLnJlbmRlcigpLmVsLCBwYXJlbnRFbC5maXJzdENoaWxkKTtcblx0fSxcblxuXHRfcHJvZ3Jlc3NMYWJlbEZuOiBmdW5jdGlvbih2YWx1ZSwgdG90YWwpIHtcblx0XHRpZiAoIXRoaXMuX3N0YXJ0ZWQgfHwgdGhpcy52aWRlby5lbmRlZCB8fCBpc05hTih2YWx1ZSkpIHtcblx0XHRcdHJldHVybiBmb3JtYXRUaW1lY29kZSh0b3RhbCk7XG5cdFx0fSBlbHNlIGlmICghdGhpcy5wbGF5YmFja1JlcXVlc3RlZCkge1xuXHRcdFx0cmV0dXJuIEdsb2JhbHMuUEFVU0VfQ0hBUjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIGZvcm1hdFRpbWVjb2RlKHRvdGFsIC0gdmFsdWUpO1xuXHRcdH1cblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0Lyogd2hlblZpZGVvSGFzTWV0YWRhdGEgcHJvbWlzZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHR3aGVuVmlkZW9IYXNNZXRhZGF0YTogZnVuY3Rpb24odmlldykge1xuXHRcdC8vIE5PVEU6IG5vdCBwcmV0dHkgISEhXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuXHRcdFx0dmFyIG1lZGlhRWwgPSB2aWV3LnZpZGVvO1xuXHRcdFx0dmFyIGV2ZW50SGFuZGxlcnMgPSB7XG5cdFx0XHRcdGxvYWRlZG1ldGFkYXRhOiBmdW5jdGlvbihldikge1xuXHRcdFx0XHRcdGlmIChldikgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZyhcIiVzOjp3aGVuVmlkZW9IYXNNZXRhZGF0YSBbJXNdICVzXCIsIHZpZXcuY2lkLCBcInJlc29sdmVkXCIsIGV2PyBldi50eXBlIDogXCJzeW5jXCIpO1xuXHRcdFx0XHRcdHJlc29sdmUodmlldyk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGFib3J0OiBmdW5jdGlvbihldikge1xuXHRcdFx0XHRcdGlmIChldikgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcdFx0XHRyZWplY3QobmV3IFBsYXlhYmxlUmVuZGVyZXIuVmlld0Vycm9yKHZpZXcsIG5ldyBFcnJvcihcIndoZW5WaWRlb0hhc01ldGFkYXRhOiB2aWV3IHdhcyByZW1vdmVkXCIpKSk7XG5cdFx0XHRcdH0sXG5cdFx0XHRcdGVycm9yOiBmdW5jdGlvbihldikge1xuXHRcdFx0XHRcdGlmIChldikgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcblx0XHRcdFx0XHR2YXIgZXJyO1xuXHRcdFx0XHRcdGlmIChtZWRpYUVsLmVycm9yKSB7XG5cdFx0XHRcdFx0XHRlcnIgPSBuZXcgRXJyb3IoXy5pbnZlcnQoTWVkaWFFcnJvcilbbWVkaWFFbC5lcnJvci5jb2RlXSk7XG5cdFx0XHRcdFx0XHRlcnIuaW5mb0NvZGUgPSBtZWRpYUVsLmVycm9yLmNvZGU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGVyciA9IG5ldyBFcnJvcihcIlVuc3BlY2lmaWVkIGVycm9yXCIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlcnIuaW5mb1NyYyA9IG1lZGlhRWwuc3JjO1xuXHRcdFx0XHRcdGVyci5sb2dNZXNzYWdlID0gXCJ3aGVuVmlkZW9IYXNNZXRhZGF0YTogXCIgKyBlcnIubmFtZSArIFwiIFwiICsgZXJyLmluZm9TcmM7XG5cdFx0XHRcdFx0ZXJyLmxvZ0V2ZW50ID0gZXY7XG5cdFx0XHRcdFx0cmVqZWN0KGVycik7XG5cdFx0XHRcdH0sXG5cdFx0XHR9O1xuXHRcdFx0Ly8gIChtZWRpYUVsLnByZWxvYWQgPT0gXCJhdXRvXCIgJiYgbWVkaWFFbC5yZWFkeVN0YXRlID49IEhUTUxNZWRpYUVsZW1lbnQuSEFWRV9DVVJSRU5UX0RBVEEpXG5cdFx0XHQvLyBcdChtZWRpYUVsLnByZWxvYWQgPT0gXCJtZXRhZGF0YVwiICYmIG1lZGlhRWwucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfTUVUQURBVEEpXG5cdFx0XHRpZiAobWVkaWFFbC5lcnJvcikge1xuXHRcdFx0XHRldmVudEhhbmRsZXJzLmVycm9yKCk7XG5cdFx0XHR9IGVsc2UgaWYgKG1lZGlhRWwucmVhZHlTdGF0ZSA+PSBIVE1MTWVkaWFFbGVtZW50LkhBVkVfTUVUQURBVEEpIHtcblx0XHRcdFx0ZXZlbnRIYW5kbGVycy5sb2FkZWRtZXRhZGF0YSgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFyIHNvdXJjZXMgPSBtZWRpYUVsLnF1ZXJ5U2VsZWN0b3JBbGwoXCJzb3VyY2VcIik7XG5cdFx0XHRcdHZhciBlcnJUYXJnZXQgPSBzb3VyY2VzLmxlbmd0aCA+IDAgPyBzb3VyY2VzLml0ZW0oc291cmNlcy5sZW5ndGggLSAxKSA6IG1lZGlhRWw7XG5cdFx0XHRcdHZhciBlcnJDYXB0dXJlID0gZXJyVGFyZ2V0ID09PSBtZWRpYUVsOyAvLyB1c2UgY2FwdHVyZSB3aXRoIEhUTUxNZWRpYUVsZW1lbnRcblxuXHRcdFx0XHR2YXIgcmVtb3ZlRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRlcnJUYXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsIGV2ZW50SGFuZGxlcnMuZXJyb3IsIGVyckNhcHR1cmUpO1xuXHRcdFx0XHRcdGZvciAodmFyIGV2IGluIGV2ZW50SGFuZGxlcnMpIHtcblx0XHRcdFx0XHRcdGlmIChldiAhPT0gXCJlcnJvclwiICYmIGV2ZW50SGFuZGxlcnMuaGFzT3duUHJvcGVydHkoZXYpKSB7XG5cdFx0XHRcdFx0XHRcdG1lZGlhRWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihldiwgZXZlbnRIYW5kbGVyc1tldl0sIGZhbHNlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH07XG5cdFx0XHRcdGVyclRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgZXZlbnRIYW5kbGVycy5lcnJvciwgZXJyQ2FwdHVyZSk7XG5cdFx0XHRcdGZvciAodmFyIGV2IGluIGV2ZW50SGFuZGxlcnMpIHtcblx0XHRcdFx0XHRpZiAoZXYgIT09IFwiZXJyb3JcIiAmJiBldmVudEhhbmRsZXJzLmhhc093blByb3BlcnR5KGV2KSkge1xuXHRcdFx0XHRcdFx0bWVkaWFFbC5hZGRFdmVudExpc3RlbmVyKGV2LCBldmVudEhhbmRsZXJzW2V2XSwgZmFsc2UpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRtZWRpYUVsLnByZWxvYWQgPSBcIm1ldGFkYXRhXCI7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0sXG5cblx0ZmluZFBsYXlhYmxlU291cmNlOiBmdW5jdGlvbih2aWRlbykge1xuXHRcdHZhciBwbGF5YWJsZSA9IHRoaXMubW9kZWwuZ2V0KFwic291cmNlc1wiKS5maW5kKGZ1bmN0aW9uKHNvdXJjZSkge1xuXHRcdFx0cmV0dXJuIC9edmlkZW9cXC8vLnRlc3Qoc291cmNlLmdldChcIm1pbWVcIikpICYmIHZpZGVvLmNhblBsYXlUeXBlKHNvdXJjZS5nZXQoXCJtaW1lXCIpKSAhPSBcIlwiO1xuXHRcdH0pO1xuXHRcdHJldHVybiBwbGF5YWJsZSA/IHBsYXlhYmxlLmdldChcIm9yaWdpbmFsXCIpIDogXCJcIjtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogUGxheWFibGVSZW5kZXJlciBpbXBsZW1lbnRhdGlvblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHQvKiogQG92ZXJyaWRlIGluaXRpYWwgdmFsdWUgKi9cblx0X3BsYXliYWNrUmVxdWVzdGVkOiBmYWxzZSxcblxuXHQvKiogQG92ZXJyaWRlICovXG5cdF9pc01lZGlhUGF1c2VkOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy52aWRlby5wYXVzZWQ7XG5cdH0sXG5cblx0LyoqIEBvdmVycmlkZSAqL1xuXHRfcGxheU1lZGlhOiBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy52aWRlby5yZWFkeVN0YXRlID49IEhUTUxNZWRpYUVsZW1lbnQuSEFWRV9DVVJSRU5UX0RBVEEgJiYgdGhpcy52aWRlby5zZWVrYWJsZS5sZW5ndGggPT0gMCkge1xuXHRcdFx0Y29uc29sZS53YXJuKHRoaXMuY2lkLCBcIldURiEgZ290IHZpZGVvIGRhdGEsIGJ1dCBjYW5ub3Qgc2VlaywgY2FsbGluZyBsb2FkKClcIik7XG5cdFx0XHQvLyB0aGlzLl9sb2dNZXNzYWdlKFwiY2FsbDpsb2FkXCIsIFwiZ290IHZpZGVvIGRhdGEsIGJ1dCBjYW5ub3Qgc2VlaywgY2FsbGluZyBsb2FkKClcIiwgXCJvcmFuZ2VcIik7XG5cdFx0XHR0aGlzLnZpZGVvLmxvYWQoKTtcblx0XHRcdC8vIHRoaXMudmlkZW8uY3VycmVudFRpbWUgPSAwO1xuXHRcdH0gZWxzZSBpZiAodGhpcy52aWRlby5lbmRlZCkge1xuXHRcdFx0dGhpcy52aWRlby5jdXJyZW50VGltZSA9IHRoaXMudmlkZW8uc2Vla2FibGUuc3RhcnQoMCk7XG5cdFx0fVxuXHRcdHRoaXMudmlkZW8ucGxheSgpO1xuXHR9LFxuXG5cdC8qKiBAb3ZlcnJpZGUgKi9cblx0X3BhdXNlTWVkaWE6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMudmlkZW8ucGF1c2UoKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogbWVkaWEgZXZlbnRzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8vIHVwZGF0ZVBsYXliYWNrRXZlbnRzOiBcInBsYXkgcGxheWluZyB3YWl0aW5nIHBhdXNlIHNlZWtpbmcgc2Vla2VkIGVuZGVkXCIsXG5cdC8vIHVwZGF0ZUJ1ZmZlcmVkRXZlbnRzOiBcInByb2dyZXNzIGNhbnBsYXkgY2FucGxheXRocm91Z2ggcGxheWluZyB0aW1ldXBkYXRlXCIsLy9sb2FkZWRkYXRhXG5cdHVwZGF0ZVBsYXliYWNrRXZlbnRzOiBcInBsYXlpbmcgd2FpdGluZyBwYXVzZVwiLFxuXHR1cGRhdGVCdWZmZXJlZEV2ZW50czogXCJwcm9ncmVzcyBjYW5wbGF5IGNhbnBsYXl0aHJvdWdoIHBsYXkgcGxheWluZ1wiLFxuXHR1cGRhdGVQbGF5ZWRFdmVudHM6IFwidGltZXVwZGF0ZSBzZWVrZWRcIixcblxuXHRhZGRNZWRpYUxpc3RlbmVyczogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCF0aGlzLl9zdGFydGVkKSB0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJwbGF5aW5nXCIsIHRoaXMuX29uTWVkaWFQbGF5aW5nT25jZSwgZmFsc2UpO1xuXHRcdHRoaXMuYWRkTGlzdGVuZXIodGhpcy52aWRlbywgdGhpcy51cGRhdGVQbGF5YmFja0V2ZW50cywgdGhpcy5fdXBkYXRlUGxheWJhY2tTdGF0ZSk7XG5cdFx0dGhpcy5hZGRMaXN0ZW5lcih0aGlzLnZpZGVvLCB0aGlzLnVwZGF0ZUJ1ZmZlcmVkRXZlbnRzLCB0aGlzLl91cGRhdGVCdWZmZXJlZFZhbHVlKTtcblx0XHR0aGlzLmFkZExpc3RlbmVyKHRoaXMudmlkZW8sIHRoaXMudXBkYXRlUGxheWVkRXZlbnRzLCB0aGlzLl91cGRhdGVQbGF5ZWRWYWx1ZSk7XG5cdFx0dGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKFwiZW5kZWRcIiwgdGhpcy5fb25NZWRpYUVuZGVkLCBmYWxzZSk7XG5cdFx0dGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgdGhpcy5fb25NZWRpYUVycm9yLCB0cnVlKTtcblxuXHRcdHRoaXMub24oXCJ2aWV3OnJlbW92ZWRcIiwgdGhpcy5yZW1vdmVNZWRpYUxpc3RlbmVycywgdGhpcyk7XG5cdH0sXG5cblx0cmVtb3ZlTWVkaWFMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMub2ZmKFwidmlldzpyZW1vdmVkXCIsIHRoaXMucmVtb3ZlTWVkaWFMaXN0ZW5lcnMsIHRoaXMpO1xuXG5cdFx0aWYgKCF0aGlzLl9zdGFydGVkKSB0aGlzLnZpZGVvLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwbGF5aW5nXCIsIHRoaXMuX29uTWVkaWFQbGF5aW5nT25jZSwgZmFsc2UpO1xuXHRcdHRoaXMucmVtb3ZlTGlzdGVuZXIodGhpcy52aWRlbywgdGhpcy51cGRhdGVQbGF5YmFja0V2ZW50cywgdGhpcy5fdXBkYXRlUGxheWJhY2tTdGF0ZSk7XG5cdFx0dGhpcy5yZW1vdmVMaXN0ZW5lcih0aGlzLnZpZGVvLCB0aGlzLnVwZGF0ZUJ1ZmZlcmVkRXZlbnRzLCB0aGlzLl91cGRhdGVCdWZmZXJlZFZhbHVlKTtcblx0XHR0aGlzLnJlbW92ZUxpc3RlbmVyKHRoaXMudmlkZW8sIHRoaXMudXBkYXRlUGxheWVkRXZlbnRzLCB0aGlzLl91cGRhdGVQbGF5ZWRWYWx1ZSk7XG5cdFx0dGhpcy52aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwiZW5kZWRcIiwgdGhpcy5fb25NZWRpYUVuZGVkLCBmYWxzZSk7XG5cdFx0dGhpcy52aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgdGhpcy5fb25NZWRpYUVycm9yLCB0cnVlKTtcblx0fSxcblxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogbWVkaWEgZXZlbnQgaGFuZGxlcnNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X29uTWVkaWFFcnJvcjogZnVuY3Rpb24oZXYpIHtcblx0XHR0aGlzLnJlbW92ZU1lZGlhTGlzdGVuZXJzKCk7XG5cdFx0dGhpcy5yZW1vdmVTZWxlY3Rpb25MaXN0ZW5lcnMoKTtcblxuXHRcdHRoaXMuX29uTWVkaWFFbmRlZChldik7XG5cdFx0dGhpcy5jb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJlbmRlZFwiKTtcblx0XHR0aGlzLmNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZShcIndhaXRpbmdcIik7XG5cdFx0dGhpcy5jb250ZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJzdGFydGVkXCIpO1xuXHRcdHRoaXMuX3N0YXJ0ZWQgPSBmYWxzZTtcblxuXHRcdHRoaXMubWVkaWFTdGF0ZSA9IFwiZXJyb3JcIjtcblx0fSxcblxuXHRfb25NZWRpYVBsYXlpbmdPbmNlOiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMudmlkZW8ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBsYXlpbmdcIiwgdGhpcy5fb25NZWRpYVBsYXlpbmdPbmNlLCBmYWxzZSk7XG5cdFx0aWYgKCF0aGlzLl9zdGFydGVkKSB7XG5cdFx0XHR0aGlzLl9zdGFydGVkID0gdHJ1ZTtcblx0XHRcdHRoaXMuY29udGVudC5jbGFzc0xpc3QuYWRkKFwic3RhcnRlZFwiKTtcblx0XHR9XG5cdH0sXG5cblx0X29uTWVkaWFFbmRlZDogZnVuY3Rpb24oZXYpIHtcblx0XHR0aGlzLnBsYXliYWNrUmVxdWVzdGVkID0gZmFsc2U7XG5cdFx0aWYgKHRoaXMudmlkZW8ud2Via2l0RGlzcGxheWluZ0Z1bGxzY3JlZW4pIHtcblx0XHRcdHRoaXMudmlkZW8ud2Via2l0RXhpdEZ1bGxzY3JlZW4oKTtcblx0XHR9XG5cdFx0aWYgKGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50ID09PSB0aGlzLnZpZGVvKSB7XG5cdFx0XHR0aGlzLnZpZGVvLmV4aXRGdWxsc2NyZWVuKCk7XG5cdFx0fVxuXHR9LFxuXG5cdF91cGRhdGVQbGF5YmFja1N0YXRlOiBmdW5jdGlvbihldikge1xuXHRcdHZhciBjbGFzc0xpc3QgPSB0aGlzLmNvbnRlbnQuY2xhc3NMaXN0O1xuXHRcdGlmICh0aGlzLnBsYXliYWNrUmVxdWVzdGVkKSB7XG5cdFx0XHRzd2l0Y2ggKGV2LnR5cGUpIHtcblx0XHRcdFx0Y2FzZSBcInBhdXNlXCI6XG5cdFx0XHRcdGNhc2UgXCJwbGF5aW5nXCI6XG5cdFx0XHRcdFx0Y2xhc3NMaXN0LnJlbW92ZShcIndhaXRpbmdcIik7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJ3YWl0aW5nXCI6XG5cdFx0XHRcdFx0Y2xhc3NMaXN0LmFkZChcIndhaXRpbmdcIik7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdGNsYXNzTGlzdC5yZW1vdmUoXCJ3YWl0aW5nXCIpO1xuXHRcdH1cblx0XHRjbGFzc0xpc3QudG9nZ2xlKFwiZW5kZWRcIiwgdGhpcy52aWRlby5lbmRlZCk7XG5cblx0XHR0aGlzLl91cGRhdGVQbGF5ZWRWYWx1ZShldik7XG5cdH0sXG5cblx0X3VwZGF0ZVBsYXllZFZhbHVlOiBmdW5jdGlvbihldikge1xuXHRcdHRoaXMuX2N1cnJlbnRUaW1lVmFsdWUgPSB0aGlzLnZpZGVvLmN1cnJlbnRUaW1lO1xuXHRcdGlmICh0aGlzLnByb2dyZXNzTWV0ZXIpIHtcblx0XHRcdHRoaXMucHJvZ3Jlc3NNZXRlci52YWx1ZVRvKHRoaXMuX2N1cnJlbnRUaW1lVmFsdWUsIDAsIFwiYW1vdW50XCIpO1xuXHRcdH1cblx0fSxcblxuXHRfdXBkYXRlQnVmZmVyZWRWYWx1ZTogZnVuY3Rpb24oZXYpIHtcblx0XHR2YXIgYlJhbmdlcyA9IHRoaXMudmlkZW8uYnVmZmVyZWQ7XG5cdFx0aWYgKGJSYW5nZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0dGhpcy5fYnVmZmVyZWRWYWx1ZSA9IGJSYW5nZXMuZW5kKGJSYW5nZXMubGVuZ3RoIC0gMSk7XG5cdFx0XHRpZiAodGhpcy5wcm9ncmVzc01ldGVyICYmICgodGhpcy52aWRlby5yZWFkeVN0YXRlID09IEhUTUxNZWRpYUVsZW1lbnQuSEFWRV9FTk9VR0hfREFUQSkgLyp8fCAodGhpcy52aWRlby5yZWFkeVN0YXRlID49IEhUTUxNZWRpYUVsZW1lbnQuSEFWRV9DVVJSRU5UX0RBVEEgJiYgdGhpcy52aWRlby5uZXR3b3JrU3RhdGUgPT0gSFRNTE1lZGlhRWxlbWVudC5ORVRXT1JLX0xPQURJTkcpKi8gKSkge1xuXHRcdFx0XHR0aGlzLnByb2dyZXNzTWV0ZXIudmFsdWVUbyh0aGlzLl9idWZmZXJlZFZhbHVlLCAzMDAsIFwiYXZhaWxhYmxlXCIpO1xuXHRcdFx0XHQvLyB0aGlzLnByb2dyZXNzTWV0ZXIudmFsdWVUbyh0aGlzLl9idWZmZXJlZFZhbHVlLCBNYXRoLm1heCgwLCAxMDAwICogKHRoaXMuX2J1ZmZlcmVkVmFsdWUgLSAodGhpcy5wcm9ncmVzc01ldGVyLmdldFZhbHVlKFwiYXZhaWxhYmxlXCIpIHwgMCkpKSwgXCJhdmFpbGFibGVcIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBmdWxsc2NyZWVuIGFwaVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfb25GdWxsc2NyZWVuVG9nZ2xlOiBmdW5jdGlvbihldikge1xuXHRcdC8vIE5PVEU6IElnbm9yZSBpZiBNb3VzZUV2ZW50LmJ1dHRvbiBpcyAwIG9yIHVuZGVmaW5lZCAoMDogbGVmdC1idXR0b24pXG5cdFx0aWYgKCFldi5kZWZhdWx0UHJldmVudGVkICYmICFldi5idXR0b24gJiYgdGhpcy5tb2RlbC5zZWxlY3RlZCkge1xuXHRcdFx0Ly8gZXYucHJldmVudERlZmF1bHQoKTtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGlmIChkb2N1bWVudC5oYXNPd25Qcm9wZXJ0eShcImZ1bGxzY3JlZW5FbGVtZW50XCIpICYmXG5cdFx0XHRcdFx0ZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgIT09IHRoaXMudmlkZW8pIHtcblx0XHRcdFx0XHRkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGZ1bGxzY3JlZW5DaGFuZ2VFdmVudCwgdGhpcy5fb25GdWxsc2NyZWVuQ2hhbmdlLCBmYWxzZSk7XG5cdFx0XHRcdFx0dGhpcy52aWRlby5yZXF1ZXN0RnVsbHNjcmVlbigpO1xuXHRcdFx0XHR9IGVsc2Vcblx0XHRcdFx0aWYgKHRoaXMudmlkZW8ud2Via2l0U3VwcG9ydHNGdWxsc2NyZWVuICYmICF0aGlzLnZpZGVvLndlYmtpdERpc3BsYXlpbmdGdWxsc2NyZWVuKSB7XG5cdFx0XHRcdFx0dGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKFwid2Via2l0YmVnaW5mdWxsc2NyZWVuXCIsIHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSwgZmFsc2UpO1xuXHRcdFx0XHRcdHRoaXMudmlkZW8ud2Via2l0RW50ZXJGdWxsU2NyZWVuKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2ggKGVycikge1xuXHRcdFx0XHR0aGlzLnZpZGVvLmNvbnRyb2xzID0gZmFsc2U7XG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0X29uRnVsbHNjcmVlbkNoYW5nZTogZnVuY3Rpb24oZXYpIHtcblx0XHRzd2l0Y2ggKGV2LnR5cGUpIHtcblx0XHRcdGNhc2UgZnVsbHNjcmVlbkNoYW5nZUV2ZW50OlxuXHRcdFx0XHQvLyB2YXIgaXNPd25GdWxsc2NyZWVuID0gTW9kZXJuaXpyLnByZWZpeGVkKFwiZnVsbHNjcmVlbkVsZW1lbnRcIiwgZG9jdW1lbnQpID09PSB0aGlzLnZpZGVvO1xuXHRcdFx0XHR2YXIgaXNPd25GdWxsc2NyZWVuID0gZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgPT09IHRoaXMudmlkZW87XG5cdFx0XHRcdHRoaXMudmlkZW8uY29udHJvbHMgPSBpc093bkZ1bGxzY3JlZW47XG5cdFx0XHRcdGlmICghaXNPd25GdWxsc2NyZWVuKSB7XG5cdFx0XHRcdFx0ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihmdWxsc2NyZWVuQ2hhbmdlRXZlbnQsIHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSwgZmFsc2UpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcIndlYmtpdGJlZ2luZnVsbHNjcmVlblwiOlxuXHRcdFx0XHR0aGlzLnZpZGVvLmNvbnRyb2xzID0gdHJ1ZTtcblx0XHRcdFx0dGhpcy52aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwid2Via2l0YmVnaW5mdWxsc2NyZWVuXCIsIHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSwgZmFsc2UpO1xuXHRcdFx0XHR0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJ3ZWJraXRlbmRmdWxsc2NyZWVuXCIsIHRoaXMuX29uRnVsbHNjcmVlbkNoYW5nZSwgZmFsc2UpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJ3ZWJraXRlbmRmdWxsc2NyZWVuXCI6XG5cdFx0XHRcdHRoaXMudmlkZW8uY29udHJvbHMgPSBmYWxzZTtcblx0XHRcdFx0dGhpcy52aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwid2Via2l0ZW5kZnVsbHNjcmVlblwiLCB0aGlzLl9vbkZ1bGxzY3JlZW5DaGFuZ2UsIGZhbHNlKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBldmVudCBoZWxwZXJzXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdGFkZExpc3RlbmVyOiBmdW5jdGlvbih0YXJnZXQsIGV2ZW50cywgaGFuZGxlciwgdXNlQ2FwdHVyZSkge1xuXHRcdCh0eXBlb2YgZXZlbnRzID09PSBcInN0cmluZ1wiKSAmJiAoZXZlbnRzID0gZXZlbnRzLnNwbGl0KFwiIFwiKSk7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHRhcmdldC5hZGRFdmVudExpc3RlbmVyKGV2ZW50c1tpXSwgaGFuZGxlciwgISF1c2VDYXB0dXJlKTtcblx0XHR9XG5cdH0sXG5cblx0cmVtb3ZlTGlzdGVuZXI6IGZ1bmN0aW9uKHRhcmdldCwgZXZlbnRzLCBoYW5kbGVyLCB1c2VDYXB0dXJlKSB7XG5cdFx0KHR5cGVvZiBldmVudHMgPT09IFwic3RyaW5nXCIpICYmIChldmVudHMgPSBldmVudHMuc3BsaXQoXCIgXCIpKTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGV2ZW50cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dGFyZ2V0LnJlbW92ZUV2ZW50TGlzdGVuZXIoZXZlbnRzW2ldLCBoYW5kbGVyLCAhIXVzZUNhcHR1cmUpO1xuXHRcdH1cblx0fSxcbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIGxvZyB0byBzY3JlZW5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuaWYgKERFQlVHKSB7XG5cblx0VmlkZW9SZW5kZXJlciA9IChmdW5jdGlvbihWaWRlb1JlbmRlcmVyKSB7XG5cdFx0aWYgKCFWaWRlb1JlbmRlcmVyLkxPR19UT19TQ1JFRU4pIHJldHVybiBWaWRlb1JlbmRlcmVyO1xuXG5cdFx0LyoqIEB0eXBlIHtGdW5jdGlvbn0gKi9cblx0XHR2YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG5cdFx0LyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZS5zdHJpbmdzL2xwYWR9ICovXG5cdFx0dmFyIGxwYWQgPSByZXF1aXJlKFwidW5kZXJzY29yZS5zdHJpbmcvbHBhZFwiKTtcblx0XHQvKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlLnN0cmluZ3MvcnBhZH0gKi9cblx0XHR2YXIgcnBhZCA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlLnN0cmluZy9ycGFkXCIpO1xuXG5cdFx0Ly8gdmFyIGZ1bGxzY3JlZW5FdmVudHMgPSBbXG5cdFx0Ly8gXHRmdWxsc2NyZWVuQ2hhbmdlRXZlbnQsIGZ1bGxzY3JlZW5FcnJvckV2ZW50LFxuXHRcdC8vIFx0XCJ3ZWJraXRiZWdpbmZ1bGxzY3JlZW5cIiwgXCJ3ZWJraXRlbmRmdWxsc2NyZWVuXCIsXG5cdFx0Ly8gXTtcblxuXHRcdHZhciBtZWRpYUV2ZW50cyA9IHJlcXVpcmUoXCJ1dGlscy9ldmVudC9tZWRpYUV2ZW50c0VudW1cIik7XG5cdFx0dmFyIHVwZGF0ZVBsYXliYWNrU3RhdGVFdmVudHMsIHVwZGF0ZUJ1ZmZlcmVkRXZlbnRzLCB1cGRhdGVQbGF5ZWRFdmVudHM7XG5cblx0XHQvLyB1cGRhdGVQbGF5YmFja1N0YXRlRXZlbnRzID0gW1wicGxheWluZ1wiLCBcIndhaXRpbmdcIiwgXCJlbmRlZFwiLCBcInBhdXNlXCIsIFwic2Vla2luZ1wiLCBcInNlZWtlZFwiXTtcblx0XHQvLyB1cGRhdGVCdWZmZXJlZEV2ZW50cyA9IFtcInByb2dyZXNzXCIsIFwiZHVyYXRpb25jaGFuZ2VcIiwgXCJjYW5wbGF5XCIsIFwicGxheVwiXTtcblx0XHQvLyB1cGRhdGVQbGF5ZWRFdmVudHMgPSBbXCJwbGF5aW5nXCIsIFwidGltZXVwZGF0ZVwiXTtcblxuXHRcdHVwZGF0ZVBsYXliYWNrU3RhdGVFdmVudHMgPSBbXG5cdFx0XHRcImxvYWRzdGFydFwiLFxuXHRcdFx0XCJwcm9ncmVzc1wiLFxuXHRcdFx0XCJzdXNwZW5kXCIsXG5cdFx0XHRcImFib3J0XCIsXG5cdFx0XHRcImVycm9yXCIsXG5cdFx0XHRcImVtcHRpZWRcIixcblx0XHRcdFwic3RhbGxlZFwiLFxuXHRcdF07XG5cdFx0dXBkYXRlQnVmZmVyZWRFdmVudHMgPSBbXG5cdFx0XHRcImxvYWRlZG1ldGFkYXRhXCIsXG5cdFx0XHRcImxvYWRlZGRhdGFcIixcblx0XHRcdFwiY2FucGxheVwiLFxuXHRcdFx0XCJjYW5wbGF5dGhyb3VnaFwiLFxuXHRcdFx0XCJwbGF5aW5nXCIsXG5cdFx0XHRcIndhaXRpbmdcIixcblx0XHRcdFwic2Vla2luZ1wiLCAvLyBzZWVraW5nIGNoYW5nZWQgdG8gdHJ1ZVxuXHRcdFx0XCJzZWVrZWRcIiwgLy8gc2Vla2luZyBjaGFuZ2VkIHRvIGZhbHNlXG5cdFx0XHRcImVuZGVkXCIsIC8vIGVuZGVkIGlzIHRydWVcblx0XHRdO1xuXHRcdHVwZGF0ZVBsYXllZEV2ZW50cyA9IFtcInBsYXlcIiwgXCJwYXVzZVwiXTtcblxuXHRcdC8vIEV4Y2x1ZGUgc29tZSBldmVudHMgZnJvbSBsb2dcblx0XHRtZWRpYUV2ZW50cyA9IF8ud2l0aG91dChtZWRpYUV2ZW50cywgXCJyZXNpemVcIiwgXCJlcnJvclwiKTtcblx0XHQvLyBNYWtlIHN1cmUgZXZlbnQgc3Vic2V0cyBleGlzdCBpbiB0aGUgbWFpbiBzZXRcblx0XHR1cGRhdGVQbGF5YmFja1N0YXRlRXZlbnRzID0gXy5pbnRlcnNlY3Rpb24obWVkaWFFdmVudHMsIHVwZGF0ZVBsYXliYWNrU3RhdGVFdmVudHMpO1xuXHRcdHVwZGF0ZUJ1ZmZlcmVkRXZlbnRzID0gXy5pbnRlcnNlY3Rpb24obWVkaWFFdmVudHMsIHVwZGF0ZUJ1ZmZlcmVkRXZlbnRzKTtcblx0XHR1cGRhdGVQbGF5ZWRFdmVudHMgPSBfLmludGVyc2VjdGlvbihtZWRpYUV2ZW50cywgdXBkYXRlUGxheWVkRXZlbnRzKTtcblxuXHRcdHZhciByZWFkeVN0YXRlU3ltYm9scyA9IF8uaW52ZXJ0KF8ucGljayhIVE1MTWVkaWFFbGVtZW50LFxuXHRcdFx0ZnVuY3Rpb24odmFsLCBrZXksIG9iaikge1xuXHRcdFx0XHRyZXR1cm4gL15IQVZFXy8udGVzdChrZXkpO1xuXHRcdFx0fSkpO1xuXHRcdHZhciByZWFkeVN0YXRlVG9TdHJpbmcgPSBmdW5jdGlvbihlbCkge1xuXHRcdFx0cmV0dXJuIHJlYWR5U3RhdGVTeW1ib2xzW2VsLnJlYWR5U3RhdGVdICsgXCIoXCIgKyBlbC5yZWFkeVN0YXRlICsgXCIpXCI7XG5cdFx0fTtcblxuXHRcdHZhciBuZXR3b3JrU3RhdGVTeW1ib2xzID0gXy5pbnZlcnQoXy5waWNrKEhUTUxNZWRpYUVsZW1lbnQsXG5cdFx0XHRmdW5jdGlvbih2YWwsIGtleSwgb2JqKSB7XG5cdFx0XHRcdHJldHVybiAvXk5FVFdPUktfLy50ZXN0KGtleSk7XG5cdFx0XHR9KSk7XG5cdFx0dmFyIG5ldHdvcmtTdGF0ZVRvU3RyaW5nID0gZnVuY3Rpb24oZWwpIHtcblx0XHRcdHJldHVybiBuZXR3b3JrU3RhdGVTeW1ib2xzW2VsLm5ldHdvcmtTdGF0ZV0gKyBcIihcIiArIGVsLm5ldHdvcmtTdGF0ZSArIFwiKVwiO1xuXHRcdH07XG5cblx0XHR2YXIgbWVkaWFFcnJvclN5bWJvbHMgPSBfLmludmVydChNZWRpYUVycm9yKTtcblx0XHR2YXIgbWVkaWFFcnJvclRvU3RyaW5nID0gZnVuY3Rpb24oZWwpIHtcblx0XHRcdHJldHVybiBlbC5lcnJvciA/IG1lZGlhRXJyb3JTeW1ib2xzW2VsLmVycm9yLmNvZGVdICsgXCIoXCIgKyBlbC5lcnJvci5jb2RlICsgXCIpXCIgOiBcIltNZWRpYUVycm9yIG51bGxdXCI7XG5cdFx0fTtcblxuXHRcdHZhciBmaW5kUmFuZ2VJbmRleCA9IGZ1bmN0aW9uKHJhbmdlLCBjdXJyVGltZSkge1xuXHRcdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gcmFuZ2UubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0XHRpZiAocmFuZ2Uuc3RhcnQoaSkgPD0gY3VyclRpbWUgJiYgY3VyclRpbWUgPD0gcmFuZ2UuZW5kKGkpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiAtMTtcblx0XHR9O1xuXG5cdFx0dmFyIGZvcm1hdFZpZGVvRXJyb3IgPSBmdW5jdGlvbih2aWRlbykge1xuXHRcdFx0cmV0dXJuIFtcblx0XHRcdFx0bWVkaWFFcnJvclRvU3RyaW5nKHZpZGVvKSxcblx0XHRcdFx0bmV0d29ya1N0YXRlVG9TdHJpbmcodmlkZW8pLFxuXHRcdFx0XHRyZWFkeVN0YXRlVG9TdHJpbmcodmlkZW8pLFxuXHRcdFx0XS5qb2luKFwiIFwiKTtcblx0XHR9O1xuXG5cdFx0dmFyIGdldFZpZGVvU3RhdHNDb2xzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gXCIwMDAwLjAwMCBbQ3VycmVudC9Ub3RhbF0gW1NlZWthYmxlICAgXSBbQnVmZmVyZWQgICBdIG5ldHdvcmtTdGF0ZSByZWFkeVN0YXRlICAgICAgUGxheWluZ1wiO1xuXHRcdFx0Ly8gcmV0dXJuIFwiMDAwMC42MjAgW3Q6ICAwLjAgIDI3LjRdIFtzOiAyNy40IDAvMV0gW2I6ICAwLjUgMC8xXSBMT0FESU5HKDIpICAgRlVUVVJFX0RBVEEoMykgIDo6ICg6OilcIjtcblx0XHR9XG5cblx0XHR2YXIgZm9ybWF0VmlkZW9TdGF0cyA9IGZ1bmN0aW9uKHZpZGVvKSB7XG5cdFx0XHR2YXIgY3VyclRpbWUgPSB2aWRlby5jdXJyZW50VGltZSxcblx0XHRcdFx0ZHVyVGltZSA9IHZpZGVvLmR1cmF0aW9uLFxuXHRcdFx0XHRiUmFuZ2VzID0gdmlkZW8uYnVmZmVyZWQsXG5cdFx0XHRcdGJSYW5nZUlkeCxcblx0XHRcdFx0c1JhbmdlcyA9IHZpZGVvLnNlZWthYmxlLFxuXHRcdFx0XHRzUmFuZ2VJZHg7XG5cblx0XHRcdGJSYW5nZUlkeCA9IGZpbmRSYW5nZUluZGV4KGJSYW5nZXMsIGN1cnJUaW1lKTtcblx0XHRcdHNSYW5nZUlkeCA9IGZpbmRSYW5nZUluZGV4KHNSYW5nZXMsIGN1cnJUaW1lKTtcblx0XHRcdHJldHVybiBbXG5cdFx0XHRcdFwiW3Q6XCIgKyBscGFkKGN1cnJUaW1lLnRvRml4ZWQoMSksIDUpICtcblx0XHRcdFx0XHRcIiBcIiArIGxwYWQoKCFpc05hTihkdXJUaW1lKSA/IGR1clRpbWUudG9GaXhlZCgxKSA6IFwiLVwiKSwgNSkgKyBcIl1cIixcblx0XHRcdFx0XCJbczpcIiArIGxwYWQoKHNSYW5nZUlkeCA+PSAwID8gc1Jhbmdlcy5lbmQoc1JhbmdlSWR4KS50b0ZpeGVkKDEpIDogXCItXCIpLCA1KSArXG5cdFx0XHRcdFx0XCIgXCIgKyAoc1JhbmdlSWR4ID49IDAgPyBzUmFuZ2VJZHggOiBcIi1cIikgKyBcIi9cIiArIHNSYW5nZXMubGVuZ3RoICsgXCJdXCIsXG5cdFx0XHRcdFwiW2I6XCIgKyBscGFkKChiUmFuZ2VJZHggPj0gMCA/IGJSYW5nZXMuZW5kKGJSYW5nZUlkeCkudG9GaXhlZCgxKSA6IFwiLVwiKSwgNSkgK1xuXHRcdFx0XHRcdFwiIFwiICsgKGJSYW5nZUlkeCA+PSAwID8gYlJhbmdlSWR4IDogXCItXCIpICsgXCIvXCIgKyBiUmFuZ2VzLmxlbmd0aCArIFwiXVwiLFxuXHRcdFx0XHRycGFkKG5ldHdvcmtTdGF0ZVRvU3RyaW5nKHZpZGVvKS5zdWJzdHIoOCksIDEyKSxcblx0XHRcdFx0cnBhZChyZWFkeVN0YXRlVG9TdHJpbmcodmlkZW8pLnN1YnN0cig1KSwgMTUpLFxuXHRcdFx0XHQodmlkZW8uZW5kZWQgPyBcIj46XCIgOiAodmlkZW8ucGF1c2VkID8gXCI6OlwiIDogXCI+PlwiKSksXG5cdFx0XHRdLmpvaW4oXCIgXCIpO1xuXHRcdH07XG5cblx0XHRyZXR1cm4gVmlkZW9SZW5kZXJlci5leHRlbmQoe1xuXG5cdFx0XHQvKiogQG92ZXJyaWRlICovXG5cdFx0XHRpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0VmlkZW9SZW5kZXJlci5wcm90b3R5cGUuaW5pdGlhbGl6ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXG5cdFx0XHRcdF8uYmluZEFsbCh0aGlzLCBcIl9faGFuZGxlTWVkaWFFdmVudFwiKTtcblxuXHRcdFx0XHR2YXIgZmdDb2xvciA9IHRoaXMubW9kZWwuYXR0cihcImNvbG9yXCIpLFxuXHRcdFx0XHRcdHJlZCA9IG5ldyBDb2xvcihcInJlZFwiKSxcblx0XHRcdFx0XHRibHVlID0gbmV3IENvbG9yKFwiYmx1ZVwiKSxcblx0XHRcdFx0XHRncmVlbiA9IG5ldyBDb2xvcihcImdyZWVuXCIpO1xuXG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbWVkaWFFdmVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHR2YXIgZXYgPSBtZWRpYUV2ZW50c1tpXTtcblx0XHRcdFx0XHR0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoZXYsIHRoaXMuX19oYW5kbGVNZWRpYUV2ZW50LCBmYWxzZSk7XG5cblx0XHRcdFx0XHR2YXIgYyA9IG5ldyBDb2xvcihmZ0NvbG9yKSxcblx0XHRcdFx0XHRcdGNjID0gMTtcblx0XHRcdFx0XHRpZiAodXBkYXRlQnVmZmVyZWRFdmVudHMuaW5kZXhPZihldikgIT0gLTEpIGMubWl4KGdyZWVuLCAoY2MgLz0gMikpO1xuXHRcdFx0XHRcdGlmICh1cGRhdGVQbGF5ZWRFdmVudHMuaW5kZXhPZihldikgIT0gLTEpIGMubWl4KHJlZCwgKGNjIC89IDIpKTtcblx0XHRcdFx0XHRpZiAodXBkYXRlUGxheWJhY2tTdGF0ZUV2ZW50cy5pbmRleE9mKGV2KSAhPSAtMSkgYy5taXgoYmx1ZSwgKGNjIC89IDIpKTtcblx0XHRcdFx0XHR0aGlzLl9fbG9nQ29sb3JzW2V2XSA9IGMucmdiU3RyaW5nKCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgdGhpcy5fX2hhbmRsZU1lZGlhRXZlbnQsIHRydWUpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0cmVtb3ZlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0VmlkZW9SZW5kZXJlci5wcm90b3R5cGUucmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbWVkaWFFdmVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0XHRpZiAobWVkaWFFdmVudHNbaV0gPT0gXCJlcnJvclwiKSBjb250aW51ZTtcblx0XHRcdFx0XHR0aGlzLnZpZGVvLnJlbW92ZUV2ZW50TGlzdGVuZXIobWVkaWFFdmVudHNbaV0sIHRoaXMuX19oYW5kbGVNZWRpYUV2ZW50LCBmYWxzZSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy52aWRlby5yZW1vdmVFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgdGhpcy5fX2hhbmRsZU1lZGlhRXZlbnQsIHRydWUpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0X29uVmlzaWJpbGl0eUNoYW5nZTogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0VmlkZW9SZW5kZXJlci5wcm90b3R5cGUuX29uVmlzaWJpbGl0eUNoYW5nZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR2YXIgc3RhdGVWYWwgPSBNb2Rlcm5penIucHJlZml4ZWQoXCJ2aXNpYmlsaXR5U3RhdGVcIiwgZG9jdW1lbnQpO1xuXHRcdFx0XHR0aGlzLl9fbG9nRXZlbnQoXCJ2aXNpYmlsaXR5U3RhdGU6XCIgKyBzdGF0ZVZhbCwgZXYudHlwZSArIFwiOlwiICsgc3RhdGVWYWwpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0X29uRnVsbHNjcmVlbkNoYW5nZTogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0VmlkZW9SZW5kZXJlci5wcm90b3R5cGUuX29uRnVsbHNjcmVlbkNoYW5nZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHR2YXIgbG9ndHlwZSA9IChkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCA9PT0gdGhpcy52aWRlbyA/IFwiZW50ZXI6XCIgOiBcImV4aXQ6XCIpICsgZXYudHlwZTtcblx0XHRcdFx0dGhpcy5fX2xvZ0V2ZW50KFwiZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQ6IFwiICsgdGhpcy5jaWQsIGxvZ3R5cGUpO1xuXHRcdFx0fSxcblxuXHRcdFx0LyoqIEBvdmVycmlkZSAqL1xuXHRcdFx0X29uRnVsbHNjcmVlblRvZ2dsZTogZnVuY3Rpb24oZXYpIHtcblx0XHRcdFx0VmlkZW9SZW5kZXJlci5wcm90b3R5cGUuX29uRnVsbHNjcmVlblRvZ2dsZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuXHRcdFx0XHRpZiAoIWV2LmRlZmF1bHRQcmV2ZW50ZWQgJiYgdGhpcy5tb2RlbC5zZWxlY3RlZCkge1xuXHRcdFx0XHRcdHRoaXMuX19sb2dFdmVudChcImZ1bGxzY3JlZW4tdG9nZ2xlXCIsIGV2LnR5cGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXG5cdFx0XHRfX2hhbmRsZU1lZGlhRXZlbnQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0XHRcdHZhciBldm1zZzsgLy8sIGVycm1zZztcblx0XHRcdFx0Ly8gZXZtc2cgPSBmb3JtYXRWaWRlb1N0YXRzKHRoaXMudmlkZW8pICsgXCIgXCIgKyBycGFkKHRoaXMuX2xhc3RQbGF5YmFja1N0YXRlcyB8fCBcIi1cIiwgOSk7XG5cdFx0XHRcdGV2bXNnID0gZm9ybWF0VmlkZW9TdGF0cyh0aGlzLnZpZGVvKTtcblx0XHRcdFx0aWYgKHRoaXMucGxheWJhY2tSZXF1ZXN0ZWQgPT09IHRydWUpIHtcblx0XHRcdFx0XHRldm1zZyArPSBcIiAoPj4pXCI7XG5cdFx0XHRcdH0gZWxzZSBpZiAodGhpcy5wbGF5YmFja1JlcXVlc3RlZCA9PT0gZmFsc2UpIHtcblx0XHRcdFx0XHRldm1zZyArPSBcIiAoOjopXCI7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0ZXZtc2cgKz0gXCIgKC0tKVwiO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuX19sb2dFdmVudChldm1zZywgZXYudHlwZSk7XG5cdFx0XHRcdGlmIChldi50eXBlID09PSBcImVycm9yXCIgfHwgZXYudHlwZSA9PT0gXCJhYm9ydFwiKSB7XG5cdFx0XHRcdFx0dGhpcy5fX2xvZ01lc3NhZ2UoZm9ybWF0VmlkZW9FcnJvcih0aGlzLnZpZGVvKSwgZXYudHlwZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdF9fbG9nRXZlbnQ6IGZ1bmN0aW9uKG1zZywgbG9ndHlwZSwgY29sb3IpIHtcblx0XHRcdFx0dmFyIGxvZ0VudHJ5RWwgPSB0aGlzLl9fbG9nRWxlbWVudC5sYXN0RWxlbWVudENoaWxkO1xuXHRcdFx0XHRpZiAoKGxvZ0VudHJ5RWwgJiYgbG9nRW50cnlFbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWxvZ3R5cGVcIikgPT0gbG9ndHlwZSkgJiZcblx0XHRcdFx0XHQoKGxvZ3R5cGUgPT09IFwidGltZXVwZGF0ZVwiKSB8fCAobG9ndHlwZSA9PT0gXCJwcm9ncmVzc1wiKSkpIHtcblx0XHRcdFx0XHR2YXIgbG9nUmVwZWF0VmFsID0gcGFyc2VJbnQobG9nRW50cnlFbC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWxvZ3JlcGVhdFwiKSk7XG5cdFx0XHRcdFx0bG9nRW50cnlFbC50ZXh0Q29udGVudCA9IHRoaXMuX19nZXRUU3RhbXAoKSArIFwiIFwiICsgbXNnO1xuXHRcdFx0XHRcdGxvZ0VudHJ5RWwuc2V0QXR0cmlidXRlKFwiZGF0YS1sb2dyZXBlYXRcIiwgaXNOYU4obG9nUmVwZWF0VmFsKSA/IDIgOiArK2xvZ1JlcGVhdFZhbCk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dGhpcy5fX2xvZ01lc3NhZ2UobXNnLCBsb2d0eXBlLCBjb2xvcik7XG5cdFx0XHRcdH1cblx0XHRcdH0sXG5cblx0XHRcdF9fZ2V0SGVhZGVyVGV4dDogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdHJldHVybiBnZXRWaWRlb1N0YXRzQ29scygpO1xuXHRcdFx0fSxcblx0XHR9KTtcblx0fSkoVmlkZW9SZW5kZXJlcik7XG5cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBWaWRlb1JlbmRlcmVyOyIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxLCBoZWxwZXIsIGFsaWFzMT1kZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LCBhbGlhczI9aGVscGVycy5oZWxwZXJNaXNzaW5nLCBhbGlhczM9XCJmdW5jdGlvblwiO1xuXG4gIHJldHVybiBcIjxkaXYgaWQ9XFxcImRlc2NfYlwiXG4gICAgKyBjb250YWluZXIuZXNjYXBlRXhwcmVzc2lvbigoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLmlkIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5pZCA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwiaWRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiXFxcIiBjbGFzcz1cXFwiY29udGVudCBzaXppbmcgbWRvd25cXFwiPlwiXG4gICAgKyAoKHN0YWNrMSA9ICgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuZGVzYyB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuZGVzYyA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwiZGVzY1wiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKSAhPSBudWxsID8gc3RhY2sxIDogXCJcIilcbiAgICArIFwiPC9kaXY+XFxuXCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxLCBoZWxwZXIsIGFsaWFzMT1kZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LCBhbGlhczI9aGVscGVycy5oZWxwZXJNaXNzaW5nLCBhbGlhczM9XCJmdW5jdGlvblwiO1xuXG4gIHJldHVybiBcIjxkaXYgaWQ9XFxcImRlc2NfbVwiXG4gICAgKyBjb250YWluZXIuZXNjYXBlRXhwcmVzc2lvbigoKGhlbHBlciA9IChoZWxwZXIgPSBoZWxwZXJzLmlkIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5pZCA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwiaWRcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiXFxcIiBjbGFzcz1cXFwiY29udGVudCBzaXppbmdcXFwiPjxwPlwiXG4gICAgKyAoKHN0YWNrMSA9ICgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMubmFtZSB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAubmFtZSA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwibmFtZVwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKSAhPSBudWxsID8gc3RhY2sxIDogXCJcIilcbiAgICArIFwiPC9wPlwiXG4gICAgKyAoKHN0YWNrMSA9ICgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuc3ViIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5zdWIgOiBkZXB0aDApKSAhPSBudWxsID8gaGVscGVyIDogYWxpYXMyKSwodHlwZW9mIGhlbHBlciA9PT0gYWxpYXMzID8gaGVscGVyLmNhbGwoYWxpYXMxLHtcIm5hbWVcIjpcInN1YlwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKSAhPSBudWxsID8gc3RhY2sxIDogXCJcIilcbiAgICArIFwiPC9kaXY+XFxuXCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8vIGhic2Z5IGNvbXBpbGVkIEhhbmRsZWJhcnMgdGVtcGxhdGVcbnZhciBIYW5kbGViYXJzQ29tcGlsZXIgPSByZXF1aXJlKCdoYnNmeS9ydW50aW1lJyk7XG5tb2R1bGUuZXhwb3J0cyA9IEhhbmRsZWJhcnNDb21waWxlci50ZW1wbGF0ZSh7XCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICByZXR1cm4gXCI8c3ZnIGlkPVxcXCJkZWJ1Zy1ncmlkXFxcIiB2ZXJzaW9uPVxcXCIxLjFcXFwiIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgeG1sbnM6eGxpbms9XFxcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcXFwiIHByZXNlcnZlQXNwZWN0UmF0aW89XFxcInhNYXhZTWlkIHNsaWNlXFxcIiB2aWV3cG9ydC1maWxsPVxcXCJoc2woMCwwJSwxMDAlKVxcXCIgdmlld3BvcnQtZmlsbC1vcGFjaXR5PVxcXCIxXFxcIiBzdHlsZT1cXFwiZmlsbDpub25lO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxcHg7ZmlsbDpub25lO2ZpbGwtcnVsZTpldmVub2RkO1xcXCI+XFxuPGRlZnM+XFxuXHQ8cGF0dGVybiBpZD1cXFwicGF0LWJhc2VsaW5lLTEycHhcXFwiIGNsYXNzPVxcXCJiYXNlbGluZSBiYXNlMTJcXFwiIHg9XFxcIjBcXFwiIHk9XFxcIjBcXFwiIHdpZHRoPVxcXCIyMFxcXCIgaGVpZ2h0PVxcXCIxMlxcXCIgcGF0dGVyblVuaXRzPVxcXCJ1c2VyU3BhY2VPblVzZVxcXCI+XFxuXHRcdDxsaW5lIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIwXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMS4wXFxcIi8+XFxuXHRcdDxsaW5lIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjNcXFwiIHkyPVxcXCIzXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC4xMjVcXFwiLz5cXG5cdFx0PGxpbmUgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiNlxcXCIgeTI9XFxcIjZcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIwLjM3NVxcXCIvPlxcblx0XHQ8bGluZSB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCI5XFxcIiB5Mj1cXFwiOVxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuMTI1XFxcIi8+XFxuXHQ8L3BhdHRlcm4+XFxuXFxuXHQ8cGF0dGVybiBpZD1cXFwicGF0LWJhc2VsaW5lLTI0cHhcXFwiIGNsYXNzPVxcXCJiYXNlbGluZSBiYXNlMTJcXFwiIHg9XFxcIjBcXFwiIHk9XFxcIjBcXFwiIHdpZHRoPVxcXCIyMFxcXCIgaGVpZ2h0PVxcXCIyNFxcXCIgcGF0dGVyblVuaXRzPVxcXCJ1c2VyU3BhY2VPblVzZVxcXCI+XFxuXHRcdDxsaW5lIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIwXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMS4wXFxcIi8+XFxuXHQ8L3BhdHRlcm4+XFxuXFxuXHQ8cGF0dGVybiBpZD1cXFwicGF0LWJhc2VsaW5lLTEwcHhcXFwiIGNsYXNzPVxcXCJiYXNlbGluZSBiYXNlMTBcXFwiIHg9XFxcIjBcXFwiIHk9XFxcIjBcXFwiIHdpZHRoPVxcXCIyMFxcXCIgaGVpZ2h0PVxcXCIxMFxcXCIgcGF0dGVyblVuaXRzPVxcXCJ1c2VyU3BhY2VPblVzZVxcXCI+XFxuXHRcdDxsaW5lIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIwXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMS4wMFxcXCIvPlxcblx0XHQ8bGluZSB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCI1XFxcIiB5Mj1cXFwiNVxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuNzVcXFwiLz5cXG5cdDwvcGF0dGVybj5cXG5cdDxwYXR0ZXJuIGlkPVxcXCJwYXQtYmFzZWxpbmUtMjBweFxcXCIgY2xhc3M9XFxcImJhc2VsaW5lIGJhc2UxMFxcXCIgeD1cXFwiMFxcXCIgeT1cXFwiMFxcXCIgd2lkdGg9XFxcIjIwXFxcIiBoZWlnaHQ9XFxcIjIwXFxcIiBwYXR0ZXJuVW5pdHM9XFxcInVzZXJTcGFjZU9uVXNlXFxcIj5cXG5cdFx0PGxpbmUgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjBcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIxLjBcXFwiLz5cXG5cdDwvcGF0dGVybj5cXG5cdDxwYXR0ZXJuIGlkPVxcXCJwYXQtY29scy0yMjBweFxcXCIgeD1cXFwiMFxcXCIgeT1cXFwiMFxcXCIgd2lkdGg9XFxcIjIyMFxcXCIgaGVpZ2h0PVxcXCIzNlxcXCIgcGF0dGVyblVuaXRzPVxcXCJ1c2VyU3BhY2VPblVzZVxcXCI+XFxuXHRcdDxyZWN0IHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDAsMClcXFwiIHg9XFxcIjBcXFwiIHk9XFxcIjBcXFwiIHdpZHRoPVxcXCIyMFxcXCIgaGVpZ2h0PVxcXCIxMDAlXFxcIiBmaWxsPVxcXCJoc2woMzM2LDUwJSw0MCUpXFxcIiBmaWxsLW9wYWNpdHk9XFxcIjAuMVxcXCIvPlxcblx0XHQ8cmVjdCB0cmFuc2Zvcm09XFxcInRyYW5zbGF0ZSgyMDAsMClcXFwiIHg9XFxcIjBcXFwiIHk9XFxcIjBcXFwiIHdpZHRoPVxcXCIyMFxcXCIgaGVpZ2h0PVxcXCIxMDAlXFxcIiBmaWxsPVxcXCJoc2woMzM2LDUwJSw0MCUpXFxcIiBmaWxsLW9wYWNpdHk9XFxcIjAuMVxcXCIvPlxcblx0XHQ8bGluZSB0cmFuc2Zvcm09XFxcInRyYW5zbGF0ZSgyMCAwKVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiIHN0cm9rZT1cXFwiaHNsKDMzNiw1MCUsNjAlKVxcXCIgc3Ryb2tlLW9wYWNpdHk9XFxcIjAuMlxcXCIvPlxcblx0XHQ8bGluZSB0cmFuc2Zvcm09XFxcInRyYW5zbGF0ZSgyMDAgMClcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMFxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIiBzdHJva2U9XFxcImhzbCgzMzYsNTAlLDQwJSlcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIwLjJcXFwiLz5cXG5cXG5cdFx0PGxpbmUgdHJhbnNmb3JtPVxcXCJ0cmFuc2xhdGUoMTQwIDApXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIgc3Ryb2tlPVxcXCJoc2woMzM2LDUwJSw0MCUpXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC4zXFxcIi8+XFxuXHRcdDxsaW5lIHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDgwIDApXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIgc3Ryb2tlPVxcXCJoc2woMzM2LDUwJSw0MCUpXFxcIiBzdHJva2Utb3BhY2l0eT1cXFwiMC4zXFxcIi8+XFxuXFxuXHRcdDxsaW5lIHRyYW5zZm9ybT1cXFwidHJhbnNsYXRlKDAgMClcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMFxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIiBzdHJva2U9XFxcImhzbCgyMzYsNTAlLDQwJSlcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIwLjRcXFwiIHN0cm9rZS13aWR0aD1cXFwiMVxcXCIvPlxcblx0XHQ8bGluZSB0cmFuc2Zvcm09XFxcInRyYW5zbGF0ZSgyMjAgMClcXFwiIHgxPVxcXCIwXFxcIiB4Mj1cXFwiMFxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIiBzdHJva2U9XFxcImhzbCgyMzYsNTAlLDQwJSlcXFwiIHN0cm9rZS1vcGFjaXR5PVxcXCIwLjRcXFwiIHN0cm9rZS13aWR0aD1cXFwiMVxcXCIvPlxcblx0PC9wYXR0ZXJuPlxcbjwvZGVmcz5cXG48ZyBpZD1cXFwiZGVidWctZ3JpZC1ib2R5XFxcIiB0cmFuc2Zvcm09XFxcInRyYW5zbGF0ZSgwIDAuNSlcXFwiPlxcblx0PHJlY3QgaWQ9XFxcImJhc2VsaW5lXFxcIiB4PVxcXCIwXFxcIiB5PVxcXCIwXFxcIiB3aWR0aD1cXFwiMTAwJVxcXCIgaGVpZ2h0PVxcXCIxMDAlXFxcIi8+XFxuXHQ8ZyBpZD1cXFwiZGVidWctZ3JpZC1jb250YWluZXJcXFwiPlxcblx0XHQ8ZyBpZD1cXFwiZGVidWctZ3JpZC1jb250ZW50XFxcIj5cXG5cdFx0XHQ8cmVjdCBpZD1cXFwiYmFzZWxpbmUtY29udGVudFxcXCIgeD1cXFwiMFxcXCIgeT1cXFwiMFxcXCIgd2lkdGg9XFxcIjEwMCVcXFwiIGhlaWdodD1cXFwiMTAwJVxcXCIvPlxcblx0XHRcdDxsaW5lIGlkPVxcXCJnY3QwXFxcIiBjbGFzcz1cXFwiaGd1aWRlXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMFxcXCIvPlxcblx0XHRcdDxsaW5lIGlkPVxcXCJnY3QxXFxcIiBjbGFzcz1cXFwiaGd1aWRlXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMFxcXCIvPlxcblx0XHQ8L2c+XFxuXHRcdDxsaW5lIGlkPVxcXCJnbnYwXFxcIiBjbGFzcz1cXFwiaGd1aWRlXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMFxcXCIvPlxcblx0XHQ8bGluZSBpZD1cXFwiZ252MVxcXCIgY2xhc3M9XFxcImhndWlkZVxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIxMDAlXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjBcXFwiLz5cXG5cdDwvZz5cXG5cdDxyZWN0IGlkPVxcXCJjb2x1bW5zXFxcIiB4PVxcXCIwXFxcIiB5PVxcXCIwXFxcIiB3aWR0aD1cXFwiMTAwJVxcXCIgaGVpZ2h0PVxcXCIxMDAlXFxcIi8+XFxuXHQ8bGluZSBpZD1cXFwiZ2wwXFxcIiBjbGFzcz1cXFwidmd1aWRlXFxcIiB4MT1cXFwiMFxcXCIgeDI9XFxcIjBcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIvPlxcblx0PGxpbmUgaWQ9XFxcImdsMVxcXCIgY2xhc3M9XFxcInZndWlkZSBndXR0ZXIgbGdhcFxcXCIgeDE9XFxcIjBcXFwiIHgyPVxcXCIwXFxcIiB5MT1cXFwiMFxcXCIgeTI9XFxcIjEwMCVcXFwiLz5cXG5cdDxsaW5lIGlkPVxcXCJncjBcXFwiIGNsYXNzPVxcXCJ2Z3VpZGVcXFwiIHgxPVxcXCIxMDAlXFxcIiB4Mj1cXFwiMTAwJVxcXCIgeTE9XFxcIjBcXFwiIHkyPVxcXCIxMDAlXFxcIi8+XFxuXHQ8bGluZSBpZD1cXFwiZ3IxXFxcIiBjbGFzcz1cXFwidmd1aWRlIGd1dHRlciByZ2FwXFxcIiB4MT1cXFwiMTAwJVxcXCIgeDI9XFxcIjEwMCVcXFwiIHkxPVxcXCIwXFxcIiB5Mj1cXFwiMTAwJVxcXCIvPlxcbjwvZz5cXG48L3N2Zz5cXG5cIjtcbn0sXCJ1c2VEYXRhXCI6dHJ1ZX0pO1xuIiwiLy8gaGJzZnkgY29tcGlsZWQgSGFuZGxlYmFycyB0ZW1wbGF0ZVxudmFyIEhhbmRsZWJhcnNDb21waWxlciA9IHJlcXVpcmUoJ2hic2Z5L3J1bnRpbWUnKTtcbm1vZHVsZS5leHBvcnRzID0gSGFuZGxlYmFyc0NvbXBpbGVyLnRlbXBsYXRlKHtcIjFcIjpmdW5jdGlvbihjb250YWluZXIsZGVwdGgwLGhlbHBlcnMscGFydGlhbHMsZGF0YSkge1xuICAgIHZhciBzdGFjazE7XG5cbiAgcmV0dXJuIFwiXHQ8ZGQgaWQ9XFxcInNlbGVjdC1sYXlvdXRcXFwiPlxcblx0XHQ8c2VsZWN0IHNpemU9MT5cXG5cIlxuICAgICsgKChzdGFjazEgPSBoZWxwZXJzLmVhY2guY2FsbChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5sYXlvdXRzIDogZGVwdGgwKSx7XCJuYW1lXCI6XCJlYWNoXCIsXCJoYXNoXCI6e30sXCJmblwiOmNvbnRhaW5lci5wcm9ncmFtKDIsIGRhdGEsIDApLFwiaW52ZXJzZVwiOmNvbnRhaW5lci5ub29wLFwiZGF0YVwiOmRhdGF9KSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIlx0XHQ8L3NlbGVjdD5cXG5cdDwvZGQ+XFxuXCI7XG59LFwiMlwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIGFsaWFzMT1jb250YWluZXIubGFtYmRhLCBhbGlhczI9Y29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb247XG5cbiAgcmV0dXJuIFwiXHRcdFx0PG9wdGlvbiB2YWx1ZT1cXFwiXCJcbiAgICArIGFsaWFzMihhbGlhczEoZGVwdGgwLCBkZXB0aDApKVxuICAgICsgXCJcXFwiPlwiXG4gICAgKyBhbGlhczIoYWxpYXMxKGRlcHRoMCwgZGVwdGgwKSlcbiAgICArIFwiPC9vcHRpb24+XFxuXCI7XG59LFwiNFwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIHN0YWNrMSwgaGVscGVyLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fTtcblxuICByZXR1cm4gXCJcdFx0PGxpIGNsYXNzPVxcXCJcIlxuICAgICsgKChzdGFjazEgPSBoZWxwZXJzW1wiaWZcIl0uY2FsbChhbGlhczEsZGVwdGgwLHtcIm5hbWVcIjpcImlmXCIsXCJoYXNoXCI6e30sXCJmblwiOmNvbnRhaW5lci5wcm9ncmFtKDUsIGRhdGEsIDApLFwiaW52ZXJzZVwiOmNvbnRhaW5lci5wcm9ncmFtKDcsIGRhdGEsIDApLFwiZGF0YVwiOmRhdGF9KSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIlxcXCI+XCJcbiAgICArIGNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMua2V5IHx8IChkYXRhICYmIGRhdGEua2V5KSkgIT0gbnVsbCA/IGhlbHBlciA6IGhlbHBlcnMuaGVscGVyTWlzc2luZyksKHR5cGVvZiBoZWxwZXIgPT09IFwiZnVuY3Rpb25cIiA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJrZXlcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiPC9saT5cXG5cIjtcbn0sXCI1XCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICByZXR1cm4gXCJwYXNzZWRcIjtcbn0sXCI3XCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICByZXR1cm4gXCJmYWlsZWRcIjtcbn0sXCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxLCBhbGlhczE9ZGVwdGgwICE9IG51bGwgPyBkZXB0aDAgOiB7fSwgYWxpYXMyPWNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uO1xuXG4gIHJldHVybiBcIjxkbCBjbGFzcz1cXFwiZGVidWctbGlua3MgY29sb3ItYmdcXFwiPlxcblx0PGR0IGlkPVxcXCJsaW5rcy10b2dnbGVcXFwiPlxcblx0XHQ8c3ZnIGNsYXNzPVxcXCJpY29uXFxcIiB2aWV3Qm94PVxcXCItMTAwIC0xMDAgMjAwIDIwMFxcXCIgdmVyc2lvbj1cXFwiMS4xXFxcIiB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHhtbG5zOnhsaW5rPVxcXCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXFxcIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPVxcXCJ4TWlkWU1pZCBtZWV0XFxcIj5cXG5cdFx0XHQ8cGF0aCBpZD1cXFwiY29nXFxcIiBkPVxcXCJNMTEuNzU0LC05OS4zMDdjLTcuODA5LC0wLjkyNCAtMTUuNjk5LC0wLjkyNCAtMjMuNTA4LDBsLTMuNzMsMjAuODJjLTYuMjU0LDEuMjM0IC0xMi4zMzgsMy4yMSAtMTguMTIzLDUuODg4bC0xNS4yNTUsLTE0LjY1MWMtNi44NjEsMy44NDIgLTEzLjI0NCw4LjQ4IC0xOS4wMTgsMTMuODE4bDkuMjIsMTkuMDM2Yy00LjMzNSw0LjY3NCAtOC4wOTUsOS44NDkgLTExLjIwMSwxNS40MTZsLTIwLjk1MywtMi44ODZjLTMuMjkyLDcuMTQxIC01LjczMSwxNC42NDUgLTcuMjY1LDIyLjM1N2wxOC42NDgsOS45ODFjLTAuNzU5LDYuMzI5IC0wLjc1OSwxMi43MjcgMCwxOS4wNTZsLTE4LjY0OCw5Ljk4MWMxLjUzNCw3LjcxMiAzLjk3MywxNS4yMTYgNy4yNjUsMjIuMzU3bDIwLjk1MywtMi44ODZjMy4xMDYsNS41NjcgNi44NjYsMTAuNzQyIDExLjIwMSwxNS40MTZsLTkuMjIsMTkuMDM2YzUuNzc0LDUuMzM4IDEyLjE1Nyw5Ljk3NiAxOS4wMTgsMTMuODE4bDE1LjI1NSwtMTQuNjUxYzUuNzg1LDIuNjc4IDExLjg2OSw0LjY1NCAxOC4xMjMsNS44ODhsMy43MywyMC44MmM3LjgwOSwwLjkyNCAxNS42OTksMC45MjQgMjMuNTA4LDBsMy43MywtMjAuODJjNi4yNTQsLTEuMjM0IDEyLjMzOCwtMy4yMSAxOC4xMjMsLTUuODg4bDE1LjI1NSwxNC42NTFjNi44NjEsLTMuODQyIDEzLjI0NCwtOC40OCAxOS4wMTgsLTEzLjgxOGwtOS4yMiwtMTkuMDM2YzQuMzM1LC00LjY3NCA4LjA5NSwtOS44NDkgMTEuMjAxLC0xNS40MTZsMjAuOTUzLDIuODg2YzMuMjkyLC03LjE0MSA1LjczMSwtMTQuNjQ1IDcuMjY1LC0yMi4zNTdsLTE4LjY0OCwtOS45ODFjMC43NTksLTYuMzI5IDAuNzU5LC0xMi43MjcgMCwtMTkuMDU2bDE4LjY0OCwtOS45ODFjLTEuNTM0LC03LjcxMiAtMy45NzMsLTE1LjIxNiAtNy4yNjUsLTIyLjM1N2wtMjAuOTUzLDIuODg2Yy0zLjEwNiwtNS41NjcgLTYuODY2LC0xMC43NDIgLTExLjIwMSwtMTUuNDE2bDkuMjIsLTE5LjAzNmMtNS43NzQsLTUuMzM4IC0xMi4xNTcsLTkuOTc2IC0xOS4wMTgsLTEzLjgxOGwtMTUuMjU1LDE0LjY1MWMtNS43ODUsLTIuNjc4IC0xMS44NjksLTQuNjU0IC0xOC4xMjMsLTUuODg4bC0zLjczLC0yMC44MlpNMCwtMzNjMTguMjEzLDAgMzMsMTQuNzg3IDMzLDMzYzAsMTguMjEzIC0xNC43ODcsMzMgLTMzLDMzYy0xOC4yMTMsMCAtMzMsLTE0Ljc4NyAtMzMsLTMzYzAsLTE4LjIxMyAxNC43ODcsLTMzIDMzLC0zM1pcXFwiIHN0eWxlPVxcXCJmaWxsOmN1cnJlbnRDb2xvcjtmaWxsLXJ1bGU6ZXZlbm9kZDtcXFwiLz5cXG5cdFx0PC9zdmc+XFxuXHQ8L2R0Plxcblx0PGR0IGlkPVxcXCJhcHAtc3RhdGVcXFwiPlxcblx0XHQ8c3BhbiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiIGRhdGEtcHJvcD1cXFwiY29sbGFwc2VkXFxcIj5jPC9zcGFuPjxzcGFuIGNsYXNzPVxcXCJjb2xvci1mZyBjb2xvci1iZ1xcXCIgZGF0YS1wcm9wPVxcXCJ3aXRoQnVuZGxlXFxcIj5iPC9zcGFuPjxzcGFuIGNsYXNzPVxcXCJjb2xvci1mZyBjb2xvci1iZ1xcXCIgZGF0YS1wcm9wPVxcXCJ3aXRoTWVkaWFcXFwiPm08L3NwYW4+PHNwYW4gY2xhc3M9XFxcImNvbG9yLWZnIGNvbG9yLWJnXFxcIiBkYXRhLXByb3A9XFxcIndpdGhBcnRpY2xlXFxcIj5hPC9zcGFuPlxcblx0PC9kdD5cXG5cIlxuICAgICsgKChzdGFjazEgPSBoZWxwZXJzW1wiaWZcIl0uY2FsbChhbGlhczEsKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLmxheW91dHMgOiBkZXB0aDApLHtcIm5hbWVcIjpcImlmXCIsXCJoYXNoXCI6e30sXCJmblwiOmNvbnRhaW5lci5wcm9ncmFtKDEsIGRhdGEsIDApLFwiaW52ZXJzZVwiOmNvbnRhaW5lci5ub29wLFwiZGF0YVwiOmRhdGF9KSkgIT0gbnVsbCA/IHN0YWNrMSA6IFwiXCIpXG4gICAgKyBcIlx0PGRkIGlkPVxcXCJlZGl0LWJhY2tlbmRcXFwiPlxcblx0XHQ8YSBocmVmPVxcXCJcIlxuICAgICsgYWxpYXMyKChoZWxwZXJzLmdsb2JhbCB8fCAoZGVwdGgwICYmIGRlcHRoMC5nbG9iYWwpIHx8IGhlbHBlcnMuaGVscGVyTWlzc2luZykuY2FsbChhbGlhczEsXCJBUFBfUk9PVFwiLHtcIm5hbWVcIjpcImdsb2JhbFwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSlcbiAgICArIFwic3ltcGhvbnkvXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiIHRhcmdldD1cXFwiX2JsYW5rXFxcIj5DTVM8L2E+XFxuXHQ8L2RkPlxcblx0PGRkIGlkPVxcXCJ0b2dnbGUtdGVzdHNcXFwiPlxcblx0XHQ8YSBocmVmPVxcXCIjdG9nZ2xlLXRlc3RzXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiPlRlc3RzPC9hPlxcblx0PC9kZD5cXG5cdDxkZCBpZD1cXFwidG9nZ2xlLWJsb2Nrc1xcXCI+XFxuXHRcdDxhIGhyZWY9XFxcIiN0b2dnbGUtYmxvY2tzXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiPkJsb2NrczwvYT5cXG5cdDwvZGQ+XFxuXHQ8ZGQgaWQ9XFxcInRvZ2dsZS10eFxcXCI+XFxuXHRcdDxhIGhyZWY9XFxcIiN0b2dnbGUtYmxvY2tzXFxcIiBjbGFzcz1cXFwiY29sb3ItZmcgY29sb3ItYmdcXFwiPlRYL0ZYPC9hPlxcblx0PC9kZD5cXG5cdDxkZCBpZD1cXFwidG9nZ2xlLWdyaWQtYmdcXFwiPlxcblx0XHQ8YSBocmVmPVxcXCIjdG9nZ2xlLWdyaWQtYmdcXFwiIGNsYXNzPVxcXCJjb2xvci1mZyBjb2xvci1iZ1xcXCI+R3JpZDwvYT5cXG5cdDwvZGQ+XFxuXHQ8ZGQgaWQ9XFxcInRvZ2dsZS1tZG93blxcXCI+XFxuXHRcdDxhIGhyZWY9XFxcIiN0b2dnbGUtbWRvd25cXFwiIGNsYXNzPVxcXCJjb2xvci1mZyBjb2xvci1iZ1xcXCI+TWFya2Rvd248L2E+XFxuXHQ8L2RkPlxcblx0PGRkIGlkPVxcXCJ0b2dnbGUtbG9nc1xcXCI+XFxuXHRcdDxhIGhyZWY9XFxcIiN0b2dnbGUtbG9nc1xcXCIgY2xhc3M9XFxcImNvbG9yLWZnIGNvbG9yLWJnXFxcIj5Mb2dzPC9hPlxcblx0PC9kZD5cXG5cdDxkZCBpZD1cXFwibWVkaWEtaW5mb1xcXCI+XFxuXHRcdDxzcGFuPjwvc3Bhbj5cXG5cdDwvZGQ+XFxuXHQ8ZGQgaWQ9XFxcInZpZXdwb3J0LWluZm9cXFwiPlxcblx0XHQ8c3Bhbj48L3NwYW4+XFxuXHQ8L2RkPlxcbjwvZGw+XFxuPGRpdiBpZD1cXFwidGVzdC1yZXN1bHRzXFxcIj5cXG5cdDxoNj5UZXN0cyA8YSBpZD1cXFwidG9nZ2xlLXBhc3NlZFxcXCIgaHJlZj1cXFwiI3RvZ2dsZS1wYXNzZWRcXFwiPlBhc3NlZDwvYT48L2g2Plxcblx0PHA+XCJcbiAgICArIGFsaWFzMihjb250YWluZXIubGFtYmRhKCgoc3RhY2sxID0gKGRlcHRoMCAhPSBudWxsID8gZGVwdGgwLm5hdmlnYXRvciA6IGRlcHRoMCkpICE9IG51bGwgPyBzdGFjazEudXNlckFnZW50IDogc3RhY2sxKSwgZGVwdGgwKSlcbiAgICArIFwiPC9wPlxcblx0PHVsPlxcblwiXG4gICAgKyAoKHN0YWNrMSA9IGhlbHBlcnMuZWFjaC5jYWxsKGFsaWFzMSwoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAudGVzdHMgOiBkZXB0aDApLHtcIm5hbWVcIjpcImVhY2hcIixcImhhc2hcIjp7fSxcImZuXCI6Y29udGFpbmVyLnByb2dyYW0oNCwgZGF0YSwgMCksXCJpbnZlcnNlXCI6Y29udGFpbmVyLm5vb3AsXCJkYXRhXCI6ZGF0YX0pKSAhPSBudWxsID8gc3RhY2sxIDogXCJcIilcbiAgICArIFwiXHQ8L3VsPlxcbjwvZGl2PlxcblwiO1xufSxcInVzZURhdGFcIjp0cnVlfSk7XG4iLCIvLyBoYnNmeSBjb21waWxlZCBIYW5kbGViYXJzIHRlbXBsYXRlXG52YXIgSGFuZGxlYmFyc0NvbXBpbGVyID0gcmVxdWlyZSgnaGJzZnkvcnVudGltZScpO1xubW9kdWxlLmV4cG9ydHMgPSBIYW5kbGViYXJzQ29tcGlsZXIudGVtcGxhdGUoe1wiMVwiOmZ1bmN0aW9uKGNvbnRhaW5lcixkZXB0aDAsaGVscGVycyxwYXJ0aWFscyxkYXRhKSB7XG4gICAgdmFyIGhlbHBlcjtcblxuICByZXR1cm4gXCJcdFx0PHA+PGNvZGU+XCJcbiAgICArIGNvbnRhaW5lci5lc2NhcGVFeHByZXNzaW9uKCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMuaW5mb1NyYyB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuaW5mb1NyYyA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBoZWxwZXJzLmhlbHBlck1pc3NpbmcpLCh0eXBlb2YgaGVscGVyID09PSBcImZ1bmN0aW9uXCIgPyBoZWxwZXIuY2FsbChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LHtcIm5hbWVcIjpcImluZm9TcmNcIixcImhhc2hcIjp7fSxcImRhdGFcIjpkYXRhfSkgOiBoZWxwZXIpKSlcbiAgICArIFwiPC9jb2RlPjwvcD5cXG5cIjtcbn0sXCJjb21waWxlclwiOls3LFwiPj0gNC4wLjBcIl0sXCJtYWluXCI6ZnVuY3Rpb24oY29udGFpbmVyLGRlcHRoMCxoZWxwZXJzLHBhcnRpYWxzLGRhdGEpIHtcbiAgICB2YXIgc3RhY2sxLCBoZWxwZXIsIGFsaWFzMT1kZXB0aDAgIT0gbnVsbCA/IGRlcHRoMCA6IHt9LCBhbGlhczI9aGVscGVycy5oZWxwZXJNaXNzaW5nLCBhbGlhczM9XCJmdW5jdGlvblwiLCBhbGlhczQ9Y29udGFpbmVyLmVzY2FwZUV4cHJlc3Npb247XG5cbiAgcmV0dXJuIFwiPGRpdiBjbGFzcz1cXFwiZXJyb3ItbWVzc2FnZSBjb2xvci1mZ1xcXCI+XFxuXHQ8cD48c3Ryb25nPlwiXG4gICAgKyBhbGlhczQoKChoZWxwZXIgPSAoaGVscGVyID0gaGVscGVycy5uYW1lIHx8IChkZXB0aDAgIT0gbnVsbCA/IGRlcHRoMC5uYW1lIDogZGVwdGgwKSkgIT0gbnVsbCA/IGhlbHBlciA6IGFsaWFzMiksKHR5cGVvZiBoZWxwZXIgPT09IGFsaWFzMyA/IGhlbHBlci5jYWxsKGFsaWFzMSx7XCJuYW1lXCI6XCJuYW1lXCIsXCJoYXNoXCI6e30sXCJkYXRhXCI6ZGF0YX0pIDogaGVscGVyKSkpXG4gICAgKyBcIjwvc3Ryb25nPiA8Y29kZT5cIlxuICAgICsgYWxpYXM0KCgoaGVscGVyID0gKGhlbHBlciA9IGhlbHBlcnMubWVzc2FnZSB8fCAoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAubWVzc2FnZSA6IGRlcHRoMCkpICE9IG51bGwgPyBoZWxwZXIgOiBhbGlhczIpLCh0eXBlb2YgaGVscGVyID09PSBhbGlhczMgPyBoZWxwZXIuY2FsbChhbGlhczEse1wibmFtZVwiOlwibWVzc2FnZVwiLFwiaGFzaFwiOnt9LFwiZGF0YVwiOmRhdGF9KSA6IGhlbHBlcikpKVxuICAgICsgXCI8L2NvZGU+PC9wPlxcblwiXG4gICAgKyAoKHN0YWNrMSA9IGhlbHBlcnNbXCJpZlwiXS5jYWxsKGFsaWFzMSwoZGVwdGgwICE9IG51bGwgPyBkZXB0aDAuaW5mb1NyYyA6IGRlcHRoMCkse1wibmFtZVwiOlwiaWZcIixcImhhc2hcIjp7fSxcImZuXCI6Y29udGFpbmVyLnByb2dyYW0oMSwgZGF0YSwgMCksXCJpbnZlcnNlXCI6Y29udGFpbmVyLm5vb3AsXCJkYXRhXCI6ZGF0YX0pKSAhPSBudWxsID8gc3RhY2sxIDogXCJcIilcbiAgICArIFwiPC9kaXY+XCI7XG59LFwidXNlRGF0YVwiOnRydWV9KTtcbiIsIi8vIHZhciBIYW5kbGViYXJzID0gcmVxdWlyZShcImhhbmRsZWJhcnNcIilbXCJkZWZhdWx0XCJdO1xudmFyIEhhbmRsZWJhcnMgPSByZXF1aXJlKFwiaGJzZnkvcnVudGltZVwiKTtcbi8qKiBAdHlwZSB7RnVuY3Rpb259ICovXG52YXIgQ29sb3IgPSByZXF1aXJlKFwiY29sb3JcIik7XG4vKiogQHR5cGUge21vZHVsZTphcHAvY29udHJvbC9HbG9iYWxzfSAqL1xudmFyIEdsb2JhbHMgPSByZXF1aXJlKFwiYXBwL2NvbnRyb2wvR2xvYmFsc1wiKTtcblxuLy8gKGZ1bmN0aW9uKCkge1xudmFyIGhlbHBlcnMgPSB7XG5cdC8qXG5cdC8qIEFyaXRobWV0aWMgaGVscGVyc1xuXHQvKi9cblx0YWRkOiBmdW5jdGlvbih2YWx1ZSwgYWRkaXRpb24pIHtcblx0XHRyZXR1cm4gdmFsdWUgKyBhZGRpdGlvbjtcblx0fSxcblx0c3VidHJhY3Q6IGZ1bmN0aW9uKHZhbHVlLCBzdWJzdHJhY3Rpb24pIHtcblx0XHRyZXR1cm4gdmFsdWUgLSBzdWJzdHJhY3Rpb247XG5cdH0sXG5cdGRpdmlkZTogZnVuY3Rpb24odmFsdWUsIGRpdmlzb3IpIHtcblx0XHRyZXR1cm4gdmFsdWUgLyBkaXZpc29yO1xuXHR9LFxuXHRtdWx0aXBseTogZnVuY3Rpb24odmFsdWUsIG11bHRpcGxpZXIpIHtcblx0XHRyZXR1cm4gdmFsdWUgKiBtdWx0aXBsaWVyO1xuXHR9LFxuXHRmbG9vcjogZnVuY3Rpb24odmFsdWUpIHtcblx0XHRyZXR1cm4gTWF0aC5mbG9vcih2YWx1ZSk7XG5cdH0sXG5cdGNlaWw6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0cmV0dXJuIE1hdGguY2VpbCh2YWx1ZSk7XG5cdH0sXG5cdHJvdW5kOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdHJldHVybiBNYXRoLnJvdW5kKHZhbHVlKTtcblx0fSxcblx0Z2xvYmFsOiBmdW5jdGlvbih2YWx1ZSkge1xuXHRcdHJldHVybiBHbG9iYWxzW3ZhbHVlXTtcblx0fSxcblxuXHQvKlxuXHQvKiBGbG93IGNvbnRyb2wgaGVscGVyc1xuXHQvKi9cblx0aXM6IGZ1bmN0aW9uKGEsIGIsIG9wdHMpIHtcblx0XHRyZXR1cm4gKGEgPT09IGIpID8gb3B0cy5mbih0aGlzKSA6IG9wdHMuaW52ZXJzZSh0aGlzKTtcblx0fSxcblx0aXNub3Q6IGZ1bmN0aW9uKGEsIGIsIG9wdHMpIHtcblx0XHRyZXR1cm4gKGEgIT09IGIpID8gb3B0cy5mbih0aGlzKSA6IG9wdHMuaW52ZXJzZSh0aGlzKTtcblx0fSxcblx0aXNhbnk6IGZ1bmN0aW9uKHZhbHVlKSB7XG5cdFx0dmFyIGkgPSAwLFxuXHRcdFx0aWkgPSBhcmd1bWVudHMubGVuZ3RoIC0gMixcblx0XHRcdG9wdHMgPSBhcmd1bWVudHNbaWkgKyAxXTtcblx0XHRkb1xuXHRcdFx0aWYgKHZhbHVlID09PSBhcmd1bWVudHNbKytpXSkge1xuXHRcdFx0XHRyZXR1cm4gb3B0cy5mbih0aGlzKTtcblx0XHRcdH1cblx0XHR3aGlsZSAoaSA8IGlpKTtcblx0XHRyZXR1cm4gb3B0cy5pbnZlcnNlKHRoaXMpO1xuXHR9LFxuXHRjb250YWluczogZnVuY3Rpb24oYSwgYiwgb3B0cykge1xuXHRcdHJldHVybiAoYS5pbmRleE9mKGIpICE9PSAtMSkgPyBvcHRzLmZuKHRoaXMpIDogb3B0cy5pbnZlcnNlKHRoaXMpO1xuXHR9LFxuXHRpZ25vcmU6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBcIlwiO1xuXHR9LFxuXG5cdC8qXG5cdC8qIENvbG9yIGhlbHBlcnNcblx0LyovXG5cdG1peDogZnVuY3Rpb24oY29sb3JhLCBjb2xvcmIsIGFtb3VudCkge1xuXHRcdHJldHVybiBuZXcgQ29sb3IoY29sb3JhKS5taXgobmV3IENvbG9yKGNvbG9yYiksIGFtb3VudCkucmdiU3RyaW5nKCk7XG5cdH0sXG5cdGxpZ2h0ZW46IGZ1bmN0aW9uKGNvbG9yLCBhbW91bnQpIHtcblx0XHRyZXR1cm4gbmV3IENvbG9yKGNvbG9yKS5saWdodGVuKGFtb3VudCkucmdiU3RyaW5nKCk7XG5cdH0sXG5cdGRhcmtlbjogZnVuY3Rpb24oY29sb3IsIGFtb3VudCkge1xuXHRcdHJldHVybiBuZXcgQ29sb3IoY29sb3IpLmRhcmtlbihhbW91bnQpLnJnYlN0cmluZygpO1xuXHR9LFxuXHQvLyBjb2xvckZvcm1hdDogZnVuY3Rpb24oY29sb3IsIGZtdCkge1xuXHQvLyBcdHN3aXRjaCAoZm10KSB7XG5cdC8vIFx0XHRjYXNlIFwicmdiXCI6XG5cdC8vIFx0XHRcdHJldHVybiBuZXcgQ29sb3IoY29sb3IpLnJnYlN0cmluZygpO1xuXHQvLyBcdFx0Y2FzZSBcImhzbFwiOlxuXHQvLyBcdFx0XHRyZXR1cm4gbmV3IENvbG9yKGNvbG9yKS5oc2xTdHJpbmcoKTtcblx0Ly8gXHRcdGNhc2UgXCJoZXhcIjogZGVmYXVsdDpcblx0Ly8gXHRcdFx0cmV0dXJuIG5ldyBDb2xvcihjb2xvcikuaGV4U3RyaW5nKCk7XG5cdC8vIFx0fVxuXHQvLyB9LFxufTtcbmZvciAodmFyIGhlbHBlciBpbiBoZWxwZXJzKSB7XG5cdGlmIChoZWxwZXJzLmhhc093blByb3BlcnR5KGhlbHBlcikpIHtcblx0XHRIYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKGhlbHBlciwgaGVscGVyc1toZWxwZXJdKTtcblx0fVxufVxuLy8gfSkoKTtcblxuLy8gbW9kdWxlLmV4cG9ydHMgPSBIYW5kbGViYXJzO1xuIiwiLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG4vKiogQHR5cGUge21vZHVsZTpiYWNrYm9uZX0gKi9cbnZhciBFdmVudHMgPSByZXF1aXJlKFwiYmFja2JvbmVcIikuRXZlbnRzO1xuXG5cbi8vIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbi8vIFx0dGljazogMSxcbi8vIFx0b25zdGFydDogbnVsbCxcbi8vIFx0b250aWNrOiBudWxsLFxuLy8gXHRvbnBhdXNlOiBudWxsLFxuLy8gXHRvbnN0b3A6IG51bGwsXG4vLyBcdG9uZW5kOiBudWxsXG4vLyB9XG52YXIgaWRTZWVkID0gMDtcblxudmFyIFRpbWVyID0gZnVuY3Rpb24ob3B0aW9ucykge1xuXHQvLyBpZiAoISh0aGlzIGluc3RhbmNlb2YgVGltZXIpKSB7XG5cdC8vIFx0cmV0dXJuIG5ldyBUaW1lcihvcHRpb25zKTtcblx0Ly8gfVxuXHR0aGlzLl9pZCA9IGlkU2VlZCsrO1xuXHQvLyB0aGlzLl9vcHRpb25zID0ge307XG5cdHRoaXMuX2R1cmF0aW9uID0gMDtcblx0dGhpcy5fc3RhdHVzID0gXCJpbml0aWFsaXplZFwiO1xuXHR0aGlzLl9zdGFydCA9IDA7XG5cdC8vIHRoaXMuX21lYXN1cmVzID0gW107XG5cblx0Ly8gZm9yICh2YXIgcHJvcCBpbiBkZWZhdWx0T3B0aW9ucykge1xuXHQvLyBcdHRoaXMuX29wdGlvbnNbcHJvcF0gPSBkZWZhdWx0T3B0aW9uc1twcm9wXTtcblx0Ly8gfVxuXHQvLyB0aGlzLm9wdGlvbnMob3B0aW9ucyk7XG59O1xuXG5fLmV4dGVuZChUaW1lci5wcm90b3R5cGUsIEV2ZW50cywge1xuXG5cdHN0YXJ0OiBmdW5jdGlvbihkdXJhdGlvbikge1xuXHRcdGlmICghXy5pc051bWJlcihkdXJhdGlvbikgJiYgIXRoaXMuX2R1cmF0aW9uKSB7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdFx0Ly8gZHVyYXRpb24gJiYgKGR1cmF0aW9uICo9IDEwMDApXG5cdFx0aWYgKHRoaXMuX3RpbWVvdXQgJiYgdGhpcy5fc3RhdHVzID09PSBcInN0YXJ0ZWRcIikge1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHRcdHZhciBldk5hbWUgPSAodGhpcy5fc3RhdHVzID09PSBcInN0b3BwZWRcIikgPyBcInN0YXJ0XCIgOiBcInJlc3VtZVwiO1xuXHRcdHRoaXMuX2R1cmF0aW9uID0gZHVyYXRpb24gfHwgdGhpcy5fZHVyYXRpb247XG5cdFx0dGhpcy5fdGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KGVuZC5iaW5kKHRoaXMpLCB0aGlzLl9kdXJhdGlvbik7XG5cdFx0Ly8gaWYgKHR5cGVvZiB0aGlzLl9vcHRpb25zLm9udGljayA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdFx0Ly8gXHR0aGlzLl9pbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuXHRcdC8vIFx0XHR0aGlzLnRyaWdnZXIoXCJ0aWNrXCIsIHRoaXMuZ2V0RHVyYXRpb24oKSlcblx0XHQvLyBcdH0uYmluZCh0aGlzKSwgK3RoaXMuX29wdGlvbnMudGljayAqIDEwMDApXG5cdFx0Ly8gfVxuXHRcdHRoaXMuX3N0YXJ0ID0gX25vdygpO1xuXHRcdHRoaXMuX3N0YXR1cyA9IFwic3RhcnRlZFwiO1xuXHRcdHRoaXMudHJpZ2dlcihldk5hbWUsIHRoaXMuZ2V0RHVyYXRpb24oKSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0cGF1c2U6IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl9zdGF0dXMgIT09IFwic3RhcnRlZFwiKSB7XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cdFx0dGhpcy5fZHVyYXRpb24gLT0gKF9ub3coKSAtIHRoaXMuX3N0YXJ0KTtcblx0XHRjbGVhci5jYWxsKHRoaXMsIGZhbHNlKTtcblx0XHR0aGlzLl9zdGF0dXMgPSBcInBhdXNlZFwiO1xuXHRcdHRoaXMudHJpZ2dlcihcInBhdXNlXCIsIHRoaXMuZ2V0RHVyYXRpb24oKSk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0c3RvcDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCEvc3RhcnRlZHxwYXVzZWQvLnRlc3QodGhpcy5fc3RhdHVzKSkge1xuXHRcdFx0cmV0dXJuIHRoaXM7XG5cdFx0fVxuXHRcdGNsZWFyLmNhbGwodGhpcywgdHJ1ZSk7XG5cdFx0dGhpcy5fc3RhdHVzID0gXCJzdG9wcGVkXCI7XG5cdFx0dGhpcy50cmlnZ2VyKFwic3RvcFwiKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRnZXREdXJhdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX3N0YXR1cyA9PT0gXCJzdGFydGVkXCIpIHtcblx0XHRcdHJldHVybiB0aGlzLl9kdXJhdGlvbiAtIChfbm93KCkgLSB0aGlzLl9zdGFydCk7XG5cdFx0fVxuXHRcdGlmICh0aGlzLl9zdGF0dXMgPT09IFwicGF1c2VkXCIpIHtcblx0XHRcdHJldHVybiB0aGlzLl9kdXJhdGlvbjtcblx0XHR9XG5cdFx0cmV0dXJuIDA7XG5cdH0sXG5cblx0Z2V0U3RhdHVzOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5fc3RhdHVzO1xuXHR9LFxufSk7XG5cbnZhciBfbm93ID0gd2luZG93LnBlcmZvcm1hbmNlID9cblx0d2luZG93LnBlcmZvcm1hbmNlLm5vdy5iaW5kKHdpbmRvdy5wZXJmb3JtYW5jZSkgOlxuXHREYXRlLm5vdy5iaW5kKERhdGUpO1xuXG5mdW5jdGlvbiBlbmQoKSB7XG5cdGNsZWFyLmNhbGwodGhpcyk7XG5cdHRoaXMuX3N0YXR1cyA9IFwic3RvcHBlZFwiO1xuXHR0aGlzLnRyaWdnZXIoXCJlbmRcIik7XG59XG5cbmZ1bmN0aW9uIGNsZWFyKGNsZWFyRHVyYXRpb24pIHtcblx0d2luZG93LmNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0KTtcblx0Ly8gd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5faW50ZXJ2YWwpO1xuXHRpZiAoY2xlYXJEdXJhdGlvbiA9PT0gdHJ1ZSkge1xuXHRcdHRoaXMuX2R1cmF0aW9uID0gMDtcblx0fVxufVxuXG5PYmplY3QuZGVmaW5lUHJvcGVydGllcyhUaW1lci5wcm90b3R5cGUsIHtcblx0ZHVyYXRpb246IHtcblx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5nZXREdXJhdGlvbigpO1xuXHRcdH1cblx0fSxcblx0c3RhdHVzOiB7XG5cdFx0ZW51bWVyYWJsZTogdHJ1ZSxcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuZ2V0U3RhdHVzKCk7XG5cdFx0fVxuXHR9XG59KTtcblxuT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoVGltZXIsIHtcblx0U1RPUFBFRDoge1xuXHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0dmFsdWU6IFwic3RvcHBlZFwiXG5cdH0sXG5cdFNUQVJURUQ6IHtcblx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdHZhbHVlOiBcInN0YXJ0ZWRcIlxuXHR9LFxuXHRQQVVTRUQ6IHtcblx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdHZhbHVlOiBcInBhdXNlZFwiXG5cdH0sXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBUaW1lcjtcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIEltcG9ydHNcbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXG4vKiogQHR5cGUge21vZHVsZTp1bmRlcnNjb3JlfSAqL1xudmFyIF8gPSByZXF1aXJlKFwidW5kZXJzY29yZVwiKTtcblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvVHJhbnNmb3JtSXRlbX0gKi9cbnZhciBUcmFuc2Zvcm1JdGVtID0gcmVxdWlyZShcIi4vVHJhbnNmb3JtSXRlbVwiKTtcblxudmFyIGlkU2VlZCA9IDA7XG52YXIgY2lkU2VlZCA9IDEwMDtcbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcblxuLyoqXG4gKiBAY29uc3RydWN0b3JcbiAqIEB0eXBlIHttb2R1bGU6YXBwL2hlbHBlci9UcmFuc2Zvcm1IZWxwZXJ9XG4gKi9cbmZ1bmN0aW9uIFRyYW5zZm9ybUhlbHBlcigpIHtcblx0dGhpcy5pZCA9IGlkU2VlZCsrO1xuXHR0aGlzLl9pdGVtcyA9IFtdO1xuXHR0aGlzLl9pdGVtc0J5SWQgPSB7fTtcbn1cblxuVHJhbnNmb3JtSGVscGVyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoe1xuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogUHJpdmF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X2dldDogZnVuY3Rpb24oZWwpIHtcblx0XHRpZiAodGhpcy5oYXMoZWwpKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5faXRlbXNCeUlkW2VsLmVpZF07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB0aGlzLl9hZGQoZWwpO1xuXHRcdH1cblx0fSxcblxuXHRfYWRkOiBmdW5jdGlvbihlbCkge1xuXHRcdHZhciBpdGVtLCBpZDtcblx0XHQvLyBpZCA9IGVsLmVpZCB8fCBlbC5jaWQgfHwgZWwuaWQ7XG5cdFx0Ly8gaWYgKCFpZCB8fCAodGhpcy5faXRlbXNCeUlkW2lkXSAmJiAodGhpcy5faXRlbXNCeUlkW2lkXS5lbCAhPT0gZWwpKSkge1xuXHRcdC8vIFx0aWQgPSBcImVsdFwiICsgY2lkU2VlZCsrO1xuXHRcdC8vIH1cblx0XHQvLyBpZiAoIWVsLmVpZCkge1xuXHRcdC8vIFx0aWQgPSBlbC5laWQgfHwgZWwuY2lkIHx8IChcImVsdFwiICsgY2lkU2VlZCsrKTtcblx0XHQvLyB9XG5cdFx0aWQgPSBlbC5laWQgfHwgZWwuY2lkIHx8IChcImVsdFwiICsgY2lkU2VlZCsrKTtcblx0XHRpdGVtID0gbmV3IFRyYW5zZm9ybUl0ZW0oZWwsIGlkKTtcblx0XHR0aGlzLl9pdGVtc0J5SWRbaWRdID0gaXRlbTtcblx0XHR0aGlzLl9pdGVtcy5wdXNoKGl0ZW0pO1xuXHRcdHJldHVybiBpdGVtO1xuXHR9LFxuXG5cdF9yZW1vdmU6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0aWYgKHRoaXMuaGFzKGVsKSkge1xuXHRcdFx0dmFyIG8gPSB0aGlzLl9pdGVtc0J5SWRbZWwuZWlkXTtcblx0XHRcdHRoaXMuX2l0ZW1zLnNwbGljZSh0aGlzLl9pdGVtcy5pbmRleE9mKG8pLCAxKTtcblx0XHRcdG8uZGVzdHJveSgpO1xuXHRcdFx0ZGVsZXRlIHRoaXMuX2l0ZW1zQnlJZFtlbC5laWRdO1xuXHRcdH1cblx0fSxcblxuXHRfaW52b2tlOiBmdW5jdGlvbihmdW5jTmFtZSwgYXJncywgc3RhcnRJbmRleCkge1xuXHRcdHZhciBpLCBpaSwgaiwgamosIGVsLCBvLCBycjtcblx0XHR2YXIgZnVuY0FyZ3MgPSBudWxsO1xuXHRcdGlmIChzdGFydEluZGV4ICE9PSB2b2lkIDApIHtcblx0XHRcdGZ1bmNBcmdzID0gc2xpY2UuY2FsbChhcmdzLCAwLCBzdGFydEluZGV4KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0c3RhcnRJbmRleCA9IDA7XG5cdFx0fVxuXHRcdGZvciAoaSA9IHN0YXJ0SW5kZXgsIGlpID0gYXJncy5sZW5ndGgsIHJyID0gW107IGkgPCBpaTsgKytpKSB7XG5cdFx0XHRlbCA9IGFyZ3NbaV07XG5cdFx0XHQvLyBpdGVyYXRlIG9uIE5vZGVMaXN0LCBBcmd1bWVudHMsIEFycmF5Li4uXG5cdFx0XHRpZiAoZWwubGVuZ3RoKSB7XG5cdFx0XHRcdGZvciAoaiA9IDAsIGpqID0gZWwubGVuZ3RoOyBqIDwgamo7ICsraikge1xuXHRcdFx0XHRcdG8gPSB0aGlzLl9nZXQoZWxbal0pO1xuXHRcdFx0XHRcdHJyLnB1c2gob1tmdW5jTmFtZV0uYXBwbHkobywgZnVuY0FyZ3MpKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0byA9IHRoaXMuX2dldChlbCk7XG5cdFx0XHRcdHJyLnB1c2gob1tmdW5jTmFtZV0uYXBwbHkobywgZnVuY0FyZ3MpKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHJyO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogUHVibGljXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRoYXM6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0cmV0dXJuIGVsLmVpZCAmJiB0aGlzLl9pdGVtc0J5SWRbZWwuZWlkXSAhPT0gdm9pZCAwO1xuXHR9LFxuXG5cdGdldEl0ZW1zOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgaSwgaiwgZWwsIHJldCA9IFtdO1xuXHRcdGZvciAoaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyArK2kpIHtcblx0XHRcdGVsID0gYXJndW1lbnRzW2ldO1xuXHRcdFx0aWYgKGVsLmxlbmd0aCkge1xuXHRcdFx0XHRmb3IgKGogPSAwOyBqIDwgZWwubGVuZ3RoOyArK2opIHtcblx0XHRcdFx0XHRyZXQucHVzaCh0aGlzLl9nZXQoZWxbal0pKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0LnB1c2godGhpcy5fZ2V0KGVsKSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXQ7XG5cdH0sXG5cblx0Z2V0OiBmdW5jdGlvbihlbCkge1xuXHRcdHJldHVybiB0aGlzLl9nZXQoZWwpO1xuXHR9LFxuXG5cdGFkZDogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIGksIGosIGVsO1xuXHRcdGZvciAoaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyArK2kpIHtcblx0XHRcdGVsID0gYXJndW1lbnRzW2ldO1xuXHRcdFx0aWYgKGVsLmxlbmd0aCkge1xuXHRcdFx0XHRmb3IgKGogPSAwOyBqIDwgZWwubGVuZ3RoOyArK2opIHtcblx0XHRcdFx0XHR0aGlzLl9nZXQoZWxbal0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLl9nZXQoZWwpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSxcblxuXHRyZW1vdmU6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBpLCBqLCBlbDtcblx0XHRmb3IgKGkgPSAwOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgKytpKSB7XG5cdFx0XHRlbCA9IGFyZ3VtZW50c1tpXTtcblx0XHRcdGlmIChlbC5sZW5ndGgpIHtcblx0XHRcdFx0Zm9yIChqID0gMDsgaiA8IGVsLmxlbmd0aDsgKytqKSB7XG5cdFx0XHRcdFx0dGhpcy5fcmVtb3ZlKGVsW2pdKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5fcmVtb3ZlKGVsKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogcHVibGljXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0LyogcHVibGljOiBzaW5nbGUgYXJnXG5cdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblxuXHRoYXNPZmZzZXQ6IGZ1bmN0aW9uKGVsKSB7XG5cdFx0cmV0dXJuIHRoaXMuaGFzKGVsKSA/IHRoaXMuX2l0ZW1zQnlJZFtlbC5laWRdLmhhc09mZnNldCA6ICh2b2lkIDApO1xuXHR9LFxuXG5cdC8qIHB1YmxpYzogY2FwdHVyZVxuXHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cblx0Y2FwdHVyZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5faW52b2tlKFwiY2FwdHVyZVwiLCBhcmd1bWVudHMpO1xuXHR9LFxuXHRjYXB0dXJlQWxsOiBmdW5jdGlvbigpIHtcblx0XHRmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLl9pdGVtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHR0aGlzLl9pdGVtc1tpXS5jYXB0dXJlKCk7XG5cdFx0fVxuXHR9LFxuXG5cdGNsZWFyQ2FwdHVyZTogZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy5faW52b2tlKFwiY2xlYXJDYXB0dXJlXCIsIGFyZ3VtZW50cyk7XG5cdH0sXG5cdGNsZWFyQWxsQ2FwdHVyZXM6IGZ1bmN0aW9uKCkge1xuXHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMuX2l0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHRoaXMuX2l0ZW1zW2ldLmNsZWFyQ2FwdHVyZSgpO1xuXHRcdH1cblx0fSxcblxuXHQvKiBwdWJsaWM6IG9mZnNldFxuXHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cdG9mZnNldDogZnVuY3Rpb24oeCwgeSkge1xuXHRcdHRoaXMuX2ludm9rZShcIm9mZnNldFwiLCBhcmd1bWVudHMsIDIpO1xuXHR9LFxuXHRvZmZzZXRBbGw6IGZ1bmN0aW9uKHgsIHkpIHtcblx0XHRmb3IgKHZhciBpID0gMCwgaWkgPSB0aGlzLl9pdGVtcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0XHR0aGlzLl9pdGVtc1tpXS5vZmZzZXQoeCwgeSk7XG5cdFx0fVxuXHR9LFxuXG5cdGNsZWFyT2Zmc2V0OiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9pbnZva2UoXCJjbGVhck9mZnNldFwiLCBhcmd1bWVudHMpO1xuXHR9LFxuXHRjbGVhckFsbE9mZnNldHM6IGZ1bmN0aW9uKCkge1xuXHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMuX2l0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHRoaXMuX2l0ZW1zW2ldLmNsZWFyT2Zmc2V0KCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIHB1YmxpYzogdHJhbnNpdGlvbnNcblx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXG5cdHJ1blRyYW5zaXRpb246IGZ1bmN0aW9uKHRyYW5zaXRpb24pIHtcblx0XHR0aGlzLl9pbnZva2UoXCJydW5UcmFuc2l0aW9uXCIsIGFyZ3VtZW50cywgMSk7XG5cdH0sXG5cdHJ1bkFsbFRyYW5zaXRpb25zOiBmdW5jdGlvbih0cmFuc2l0aW9uKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5faXRlbXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0dGhpcy5faXRlbXNbaV0ucnVuVHJhbnNpdGlvbih0cmFuc2l0aW9uKTtcblx0XHR9XG5cdH0sXG5cblx0Y2xlYXJUcmFuc2l0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9pbnZva2UoXCJjbGVhclRyYW5zaXRpb25cIiwgYXJndW1lbnRzKTtcblx0fSxcblx0Y2xlYXJBbGxUcmFuc2l0aW9uczogZnVuY3Rpb24oKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5faXRlbXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0dGhpcy5faXRlbXNbaV0uY2xlYXJUcmFuc2l0aW9uKCk7XG5cdFx0fVxuXHR9LFxuXG5cdHN0b3BUcmFuc2l0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl9pbnZva2UoXCJzdG9wVHJhbnNpdGlvblwiLCBhcmd1bWVudHMpO1xuXHR9LFxuXHRzdG9wQWxsVHJhbnNpdGlvbnM6IGZ1bmN0aW9uKCkge1xuXHRcdGZvciAodmFyIGkgPSAwLCBpaSA9IHRoaXMuX2l0ZW1zLmxlbmd0aDsgaSA8IGlpOyBpKyspIHtcblx0XHRcdHRoaXMuX2l0ZW1zW2ldLnN0b3BUcmFuc2l0aW9uKCk7XG5cdFx0fVxuXHR9LFxuXG5cdHdoZW5UcmFuc2l0aW9uRW5kczogZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHJlcyA9IHRoaXMuX2ludm9rZShcIndoZW5UcmFuc2l0aW9uRW5kc1wiLCBhcmd1bWVudHMpO1xuXHRcdHJldHVybiByZXMubGVuZ3RoICE9IDAgP1xuXHRcdFx0UHJvbWlzZS5hbGwocmVzKSA6XG5cdFx0XHRQcm9taXNlLnJlc29sdmUobnVsbCk7XG5cdH0sXG5cdHdoZW5BbGxUcmFuc2l0aW9uc0VuZDogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICh0aGlzLl9pdGVtcy5sZW5ndGggIT0gMCkgPyBQcm9taXNlLmFsbCh0aGlzLl9pdGVtcy5tYXAoZnVuY3Rpb24obykge1xuXHRcdFx0cmV0dXJuIG8ud2hlblRyYW5zaXRpb25FbmRzKCk7XG5cdFx0fSkpIDogUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuXHR9LFxuXG5cdHByb21pc2U6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09IDAgP1xuXHRcdFx0dGhpcy53aGVuQWxsVHJhbnNpdGlvbnNFbmQoKSA6XG5cdFx0XHR0aGlzLndoZW5UcmFuc2l0aW9uRW5kcy5jYWxsKHRoaXMsIGFyZ3VtZW50cyk7XG5cdH0sXG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiB2YWxpZGF0aW9uXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHR2YWxpZGF0ZTogZnVuY3Rpb24oKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDAsIGlpID0gdGhpcy5faXRlbXMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdFx0dGhpcy5faXRlbXNbaV0udmFsaWRhdGUoKTtcblx0XHR9XG5cdH0sXG59LCB7XG5cdGl0ZW1zOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9pdGVtcztcblx0XHR9XG5cdH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRyYW5zZm9ybUhlbHBlcjtcbiIsIi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAqIEltcG9ydHNcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dW5kZXJzY29yZX0gKi9cbnZhciBfID0gcmVxdWlyZShcInVuZGVyc2NvcmVcIik7XG5cbi8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL3ByZWZpeGVkUHJvcGVydHl9ICovXG52YXIgcHJlZml4ZWRQcm9wZXJ0eSA9IHJlcXVpcmUoXCJ1dGlscy9wcmVmaXhlZFByb3BlcnR5XCIpO1xuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZWRTdHlsZU5hbWV9ICovXG52YXIgcHJlZml4ZWRTdHlsZU5hbWUgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRTdHlsZU5hbWVcIik7XG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZEV2ZW50fSAqL1xudmFyIHByZWZpeGVkRXZlbnQgPSByZXF1aXJlKFwidXRpbHMvcHJlZml4ZWRFdmVudFwiKTtcblxuLyoqIEB0eXBlIHtTdHJpbmd9ICovXG52YXIgdHJhbnNpdGlvbkVuZCA9IHByZWZpeGVkRXZlbnQoXCJ0cmFuc2l0aW9uZW5kXCIpOyAvL3JlcXVpcmUoXCJ1dGlscy9ldmVudC90cmFuc2l0aW9uRW5kXCIpO1xuLy8gLyoqIEB0eXBlIHtGdW5jdGlvbn0gKi8vLyB2YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnV0aWxzL2RlYnVnL3RyYWNlRWxlbWVudH0gKi9cbi8vIHZhciB0cmFjZUVsdCA9IHJlcXVpcmUoXCIuL2RlYnVnL3RyYWNlRWxlbWVudFwiKTtcbi8vIHZhciB0cmFjZUVsdENhY2hlID0ge307XG4vLyB2YXIgbG9nID0gZnVuY3Rpb24oKSB7XG4vLyBcdHZhciBsb2dGbiA9IFwibG9nXCI7XG4vLyBcdHZhciBhcmdzID0gc2xpY2UuYXBwbHkoYXJndW1lbnRzKTtcbi8vIFx0c3dpdGNoKGFyZ3NbMF0pIHtcbi8vIFx0XHRjYXNlIFwiZXJyb3JcIjpcbi8vIFx0XHRjYXNlIFwid2FyblwiOlxuLy8gXHRcdGNhc2UgXCJpbmZvXCI6XG4vLyBcdFx0XHRsb2dGbiA9IGFyZ3Muc2hpZnQoKTtcbi8vIFx0XHRcdGJyZWFrO1xuLy8gXHRcdGRlZmF1bHQ6XG4vLyBcdFx0XHQvLyBicmVhaztcbi8vIFx0XHRcdHJldHVybjtcbi8vIFx0fVxuLy8gXHR2YXIgZWwsIHR4SWQ7XG4vLyBcdGlmICgoZWwgPSBhcmdzWzBdKSAmJiAodHhJZCA9IGVsLmVpZCkpIHtcbi8vIFx0XHRhcmdzWzBdID0gdHJhY2VFbHRDYWNoZVt0eElkXSB8fCAodHJhY2VFbHRDYWNoZVt0eElkXSA9IGVsKTtcbi8vIFx0fVxuLy8gXHRhcmdzWzBdID0gXCJcXHRcIiArIGFyZ3NbMF07XG4vLyBcdGNvbnNvbGVbbG9nRm5dLmFwcGx5KGNvbnNvbGUsIGFyZ3MpO1xuLy8gfTtcblxuLyoganNoaW50IC1XMDc5ICovXG4vLyB2YXIgY29uc29sZSA9IChmdW5jdGlvbih0YXJnZXQpIHtcbi8vIFx0cmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRhcmdldCkucmVkdWNlKGZ1bmN0aW9uKHByb3h5LCBwcm9wKSB7XG4vLyBcdFx0aWYgKCh0eXBlb2YgdGFyZ2V0W3Byb3BdKSA9PSBcImZ1bmN0aW9uXCIpIHtcbi8vIFx0XHRcdHN3aXRjaCAocHJvcCkge1xuLy8gXHRcdFx0XHRjYXNlIFwiZXJyb3JcIjpcbi8vIFx0XHRcdFx0Y2FzZSBcIndhcm5cIjpcbi8vIFx0XHRcdFx0Y2FzZSBcImluZm9cIjpcbi8vIFx0XHRcdFx0XHRwcm94eVtwcm9wXSA9IGZ1bmN0aW9uICgpIHtcbi8vIFx0XHRcdFx0XHRcdHZhciBhcmdzID0gc2xpY2UuYXBwbHkoYXJndW1lbnRzKTtcbi8vIFx0XHRcdFx0XHRcdGlmICh0eXBlb2YgYXJnc1swXSA9PSBcInN0cmluZ1wiKSB7XG4vLyBcdFx0XHRcdFx0XHRcdGFyZ3NbMF0gPSBwcm9wICsgXCI6OlwiICsgYXJnc1swXTtcbi8vIFx0XHRcdFx0XHRcdH1cbi8vIFx0XHRcdFx0XHRcdHJldHVybiB0YXJnZXRbcHJvcF0uYXBwbHkodGFyZ2V0LCBhcmdzKTtcbi8vIFx0XHRcdFx0XHR9O1xuLy8gXHRcdFx0XHRcdGJyZWFrO1xuLy8gXHRcdFx0XHRjYXNlIFwibG9nXCI6XG4vLyBcdFx0XHRcdFx0cHJveHlbcHJvcF0gPSBmdW5jdGlvbigpIHt9O1xuLy8gXHRcdFx0XHRcdGJyZWFrO1xuLy8gXHRcdFx0XHRkZWZhdWx0OlxuLy8gXHRcdFx0XHRcdHByb3h5W3Byb3BdID0gdGFyZ2V0W3Byb3BdLmJpbmQodGFyZ2V0KTtcbi8vIFx0XHRcdFx0XHRicmVhaztcbi8vIFx0XHRcdH1cbi8vIFx0XHR9IGVsc2Uge1xuLy8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3h5LCBwcm9wLCB7XG4vLyBcdFx0XHRcdGdldDogZnVuY3Rpb24oKSB7IHJldHVybiB0YXJnZXRbcHJvcF07IH0sXG4vLyBcdFx0XHRcdHNldDogZnVuY3Rpb24odmFsKSB7IHRhcmdldFtwcm9wXSA9IHZhbDsgfVxuLy8gXHRcdFx0fSk7XG4vLyBcdFx0fVxuLy8gXHRcdHJldHVybiBwcm94eTtcbi8vIFx0fSwge30pO1xuLy8gfSkod2luZG93LmNvbnNvbGUpO1xuLyoganNoaW50ICtXMDc5ICovXG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8qIFByaXZhdGUgc3RhdGljXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbnZhciBOT19UUkFOU0lUSU9OID0gXCJub25lIDBzIHN0ZXAtc3RhcnQgMHNcIjtcblxuXG4vLyB2YXIgdHJhbnNsYXRlVGVtcGxhdGUgPSBmdW5jdGlvbihvKSB7XG4vLyBcdC8vIHJldHVybiBcInRyYW5zbGF0ZShcIiArIG8uX3JlbmRlcmVkWCArIFwicHgsIFwiICsgby5fcmVuZGVyZWRZICsgXCJweClcIjtcbi8vIFx0Ly8gcmV0dXJuIFwidHJhbnNsYXRlM2QoXCIgKyBvLl9yZW5kZXJlZFggKyBcInB4LCBcIiArIG8uX3JlbmRlcmVkWSArIFwicHgsIDBweClcIjtcbi8vIH07XG5cbnZhciB0cmFuc2xhdGVUZW1wbGF0ZSA9IChmdW5jdGlvbigpIHtcblx0dmFyIGZuID0gcmVxdWlyZShcImFwcC9jb250cm9sL0dsb2JhbHNcIikuVFJBTlNMQVRFX1RFTVBMQVRFO1xuXHRyZXR1cm4gZnVuY3Rpb24obykge1xuXHRcdHJldHVybiBmbihvLl9yZW5kZXJlZFgsIG8uX3JlbmRlcmVkWSk7XG5cdH07XG59KCkpO1xuXG52YXIgdHJhbnNpdGlvblRlbXBsYXRlID0gZnVuY3Rpb24obykge1xuXHRyZXR1cm4gby5wcm9wZXJ0eSArIFwiIFwiICsgby5kdXJhdGlvbiAvIDEwMDAgKyBcInMgXCIgKyBvLmVhc2luZyArIFwiIFwiICsgby5kZWxheSAvIDEwMDAgKyBcInNcIjtcbn07XG5cbnZhciBVTlNFVF9UUkFOU0lUSU9OID0ge1xuXHRuYW1lOiBcInVuc2V0XCIsXG5cdGNsYXNzTmFtZTogXCJ0eC11bnNldFwiLFxuXHRwcm9wZXJ0eTogXCJub25lXCIsXG5cdGVhc2luZzogXCJlYXNlXCIsXG5cdGRlbGF5OiAwLFxuXHRkdXJhdGlvbjogMCxcblx0Y3NzVGV4dDogXCJ1bnNldFwiLFxufTtcblxuLy8gdmFyIHRyYW5zaXRpb25UZW1wbGF0ZSA9IF8udGVtcGxhdGUoXCI8JT0gcHJvcGVydHkgJT4gPCUgZHVyYXRpb24vMTAwMCAlPnMgPCU9IGVhc2luZyAlPiA8JSBkZWxheS8xMDAwICU+c1wiKTtcbi8vIHZhciBOT19UUkFOU0lUSU9OID0gXCJhbGwgMC4wMDFzIHN0ZXAtc3RhcnQgMC4wMDFzXCI7XG5cbnZhciBwcm9wRGVmYXVsdHMgPSB7XG5cdFwib3BhY2l0eVwiOiBcIjFcIixcblx0XCJ2aXNpYmlsaXR5XCI6IFwidmlzaWJsZVwiLFxuXHRcInRyYW5zZm9ybVwiOiBcIm1hdHJpeCgxLCAwLCAwLCAxLCAwLCAwKVwiLFxuXHRcInRyYW5zZm9ybVN0eWxlXCI6IFwiXCIsXG5cdFwidHJhbnNpdGlvblwiOiBcIlwiLFxuXHQvLyBcIndpbGxDaGFuZ2VcIjogXCJcIixcblx0Ly8gXCJ0cmFuc2l0aW9uRHVyYXRpb25cIjogXCIwc1wiLFxuXHQvLyBcInRyYW5zaXRpb25EZWxheVwiOiBcIjBzXCIsXG5cdC8vIFwidHJhbnNpdGlvblByb3BlcnR5XCI6IFwibm9uZVwiLFxuXHQvLyBcInRyYW5zaXRpb25UaW1pbmdGdW5jdGlvblwiOiBcImVhc2VcIlxufTtcbnZhciBwcm9wS2V5cyA9IE9iamVjdC5rZXlzKHByb3BEZWZhdWx0cyk7XG52YXIgcHJvcE5hbWVzID0gcHJvcEtleXMucmVkdWNlKGZ1bmN0aW9uKG9iaiwgcHJvcE5hbWUpIHtcblx0b2JqW3Byb3BOYW1lXSA9IHByZWZpeGVkUHJvcGVydHkocHJvcE5hbWUpO1xuXHRyZXR1cm4gb2JqO1xufSwge30pO1xuXG4vKiogQHR5cGUge21vZHVsZTp1dGlscy9zdHJpbmdzL2NhbWVsVG9EYXNoZWR9ICovXG52YXIgY2FtZWxUb0Rhc2hlZCA9IHJlcXVpcmUoXCJ1dGlscy9zdHJpbmdzL2NhbWVsVG9EYXNoZWRcIik7XG52YXIgc3R5bGVOYW1lcyA9IHByb3BLZXlzLm1hcChjYW1lbFRvRGFzaGVkKS5yZWR1Y2UoZnVuY3Rpb24ob2JqLCBwcm9wTmFtZSkge1xuXHRvYmpbcHJvcE5hbWVdID0gcHJlZml4ZWRTdHlsZU5hbWUocHJvcE5hbWUpO1xuXHRyZXR1cm4gb2JqO1xufSwge30pO1xuXG52YXIgcmVzb2x2ZUFsbCA9IGZ1bmN0aW9uKHBwLCByZXN1bHQpIHtcblx0aWYgKHBwLmxlbmd0aCAhPSAwKSB7XG5cdFx0cHAuZm9yRWFjaChmdW5jdGlvbihwLCBpLCBhKSB7XG5cdFx0XHRwLnJlc29sdmUocmVzdWx0KTtcblx0XHRcdGFbaV0gPSBudWxsO1xuXHRcdH0pO1xuXHRcdHBwLmxlbmd0aCA9IDA7XG5cdH1cblx0cmV0dXJuIHBwO1xufTtcblxudmFyIHJlamVjdEFsbCA9IGZ1bmN0aW9uKHBwLCByZWFzb24pIHtcblx0aWYgKHBwLmxlbmd0aCAhPSAwKSB7XG5cdFx0cHAuZm9yRWFjaChmdW5jdGlvbihwLCBpLCBhKSB7XG5cdFx0XHRwLnJlamVjdChyZWFzb24pO1xuXHRcdFx0YVtpXSA9IG51bGw7XG5cdFx0fSk7XG5cdFx0cHAubGVuZ3RoID0gMDtcblx0fVxuXHRyZXR1cm4gcHA7XG59O1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiBUcmFuc2Zvcm1JdGVtXG4gKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbi8qKlxuICogQGNvbnN0cnVjdG9yXG4gKi9cbmZ1bmN0aW9uIFRyYW5zZm9ybUl0ZW0oZWwsIGlkKSB7XG5cdF8uYmluZEFsbCh0aGlzLCBcIl9vblRyYW5zaXRpb25FbmRcIik7XG5cblx0dGhpcy5lbCA9IGVsO1xuXHR0aGlzLmlkID0gaWQ7XG5cdHRoaXMuZWwuZWlkID0gaWQ7XG5cdHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kLCB0aGlzLl9vblRyYW5zaXRpb25FbmQsIGZhbHNlKTtcblxuXHR0aGlzLl9jYXB0dXJlSW52YWxpZCA9IGZhbHNlO1xuXHR0aGlzLl9jYXB0dXJlZENoYW5nZWQgPSBmYWxzZTtcblx0dGhpcy5fY2FwdHVyZWRYID0gbnVsbDtcblx0dGhpcy5fY2FwdHVyZWRZID0gbnVsbDtcblx0dGhpcy5fY3VyckNhcHR1cmUgPSB7fTtcblx0dGhpcy5fbGFzdENhcHR1cmUgPSB7fTtcblxuXHR0aGlzLl9oYXNPZmZzZXQgPSBmYWxzZTtcblx0dGhpcy5fb2Zmc2V0SW52YWxpZCA9IGZhbHNlO1xuXHR0aGlzLl9vZmZzZXRYID0gbnVsbDtcblx0dGhpcy5fb2Zmc2V0WSA9IG51bGw7XG5cblx0dGhpcy5fcmVuZGVyZWRYID0gbnVsbDtcblx0dGhpcy5fcmVuZGVyZWRZID0gbnVsbDtcblxuXHR0aGlzLl9oYXNUcmFuc2l0aW9uID0gZmFsc2U7XG5cdHRoaXMuX3RyYW5zaXRpb25JbnZhbGlkID0gZmFsc2U7XG5cdHRoaXMuX3RyYW5zaXRpb25SdW5uaW5nID0gZmFsc2U7XG5cdHRoaXMuX3RyYW5zaXRpb24gPSBfLmV4dGVuZCh7fSwgVU5TRVRfVFJBTlNJVElPTik7IC8ve307XG5cblx0dGhpcy5fcHJvbWlzZXMgPSBbXTtcblx0dGhpcy5fcGVuZGluZ1Byb21pc2VzID0gW107XG59XG5cblRyYW5zZm9ybUl0ZW0ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSh7XG5cblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHQvKiBQdWJsaWNcblx0LyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5cdC8qIGRlc3Ryb3lcblx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRkZXN0cm95OiBmdW5jdGlvbigpIHtcblx0XHQvLyBOT1RFOiBzdHlsZSBwcm9wZXJ0eSBtYXkgaGF2ZSBiZWVuIG1vZGlmaWVkOyBjbGVhck9mZnNldChlbGVtZW50KSBzaG91bGRcblx0XHQvLyBiZSBjYWxsZWQgZXhwbGljaXRseSBpZiBjbGVhbiB1cCBpcyByZXF1aXJlZC5cblx0XHR0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIodHJhbnNpdGlvbkVuZCwgdGhpcy5fb25UcmFuc2l0aW9uRW5kLCBmYWxzZSk7XG5cdFx0cmVqZWN0QWxsKHRoaXMuX3BlbmRpbmdQcm9taXNlcywgdGhpcy5lbCk7XG5cdFx0cmVqZWN0QWxsKHRoaXMuX3Byb21pc2VzLCB0aGlzLmVsKTtcblx0XHQvLyBkZWxldGUgdGhpcy5lbC5laWQ7XG5cdH0sXG5cblx0LyogY2FwdHVyZVxuXHQvKiAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cdGNhcHR1cmU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIGNvbnNvbGUubG9nKFwidHhbJXNdOjpjYXB0dXJlXCIsIHRoaXMuaWQpO1xuXHRcdHRoaXMuX3ZhbGlkYXRlQ2FwdHVyZSgpO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdGNsZWFyQ2FwdHVyZTogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106OmNsZWFyQ2FwdHVyZVwiLCB0aGlzLmlkKTtcblx0XHQvLyB0aGlzLl9oYXNPZmZzZXQgPSBmYWxzZTtcblx0XHR0aGlzLl9jYXB0dXJlSW52YWxpZCA9IHRydWU7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0Lyogb2Zmc2V0L2NsZWFyXG5cdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblx0b2Zmc2V0OiBmdW5jdGlvbih4LCB5KSB7XG5cdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106Om9mZnNldFwiLCB0aGlzLmlkKTtcblxuXHRcdHRoaXMuX2hhc09mZnNldCA9IHRydWU7XG5cdFx0dGhpcy5fb2Zmc2V0SW52YWxpZCA9IHRydWU7XG5cdFx0dGhpcy5fb2Zmc2V0WCA9IHggfHwgMDtcblx0XHR0aGlzLl9vZmZzZXRZID0geSB8fCAwO1xuXHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRjbGVhck9mZnNldDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX2hhc09mZnNldCkge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106OmNsZWFyT2Zmc2V0XCIsIHRoaXMuaWQpO1xuXG5cdFx0XHR0aGlzLl9oYXNPZmZzZXQgPSBmYWxzZTtcblx0XHRcdHRoaXMuX29mZnNldEludmFsaWQgPSB0cnVlO1xuXHRcdFx0dGhpcy5fb2Zmc2V0WCA9IG51bGw7XG5cdFx0XHR0aGlzLl9vZmZzZXRZID0gbnVsbDtcblx0XHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJ0eFslc106OmNsZWFyT2Zmc2V0IG5vIG9mZnNldCB0byBjbGVhclwiLCB0aGlzLmlkKTtcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0LyogdHJhbnNpdGlvbnNcblx0LyogLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAqL1xuXHRydW5UcmFuc2l0aW9uOiBmdW5jdGlvbih0cmFuc2l0aW9uKSB7XG5cdFx0aWYgKCF0cmFuc2l0aW9uKSB7IC8vIHx8ICh0cmFuc2l0aW9uLmR1cmF0aW9uICsgdHJhbnNpdGlvbi5kZWxheSkgPT0gMCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuY2xlYXJUcmFuc2l0aW9uKCk7XG5cdFx0fVxuXHRcdHZhciBsYXN0VmFsdWUgPSB0aGlzLl90cmFuc2l0aW9uVmFsdWU7XG5cdFx0dmFyIGxhc3ROYW1lID0gdGhpcy5fdHJhbnNpdGlvbi5uYW1lO1xuXHRcdHRoaXMuX3RyYW5zaXRpb24ucHJvcGVydHkgPSBzdHlsZU5hbWVzW1widHJhbnNmb3JtXCJdO1xuXHRcdHRoaXMuX3RyYW5zaXRpb24gPSBfLmV4dGVuZCh0aGlzLl90cmFuc2l0aW9uLCB0cmFuc2l0aW9uKTtcblx0XHR0aGlzLl90cmFuc2l0aW9uVmFsdWUgPSB0cmFuc2l0aW9uVGVtcGxhdGUodGhpcy5fdHJhbnNpdGlvbik7XG5cblx0XHRpZiAodGhpcy5fdHJhbnNpdGlvbkludmFsaWQpIHtcblx0XHRcdGNvbnNvbGUud2FybihcInR4WyVzXTo6cnVuVHJhbnNpdGlvbiBzZXQgb3ZlciAoJXM6JyVzJyA9PiAlczonJXMnKVwiLCB0aGlzLmlkLFxuXHRcdFx0XHRsYXN0TmFtZSwgbGFzdFZhbHVlLCB0aGlzLl90cmFuc2l0aW9uLm5hbWUsIHRoaXMuX3RyYW5zaXRpb25WYWx1ZSk7XG5cdFx0fVxuXG5cdFx0dGhpcy5faGFzVHJhbnNpdGlvbiA9IHRydWU7XG5cdFx0dGhpcy5fdHJhbnNpdGlvbkludmFsaWQgPSB0cnVlO1xuXHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVUcmFuc2l0aW9uKCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0Y2xlYXJUcmFuc2l0aW9uOiBmdW5jdGlvbigpIHtcblx0XHR0aGlzLl90cmFuc2l0aW9uID0gXy5leHRlbmQodGhpcy5fdHJhbnNpdGlvbiwgVU5TRVRfVFJBTlNJVElPTik7XG5cdFx0dGhpcy5fdHJhbnNpdGlvblZhbHVlID0gTk9fVFJBTlNJVElPTjtcblxuXHRcdHRoaXMuX2hhc1RyYW5zaXRpb24gPSBmYWxzZTtcblx0XHR0aGlzLl90cmFuc2l0aW9uSW52YWxpZCA9IHRydWU7XG5cdFx0Ly8gaWYgKHRoaXMuaW1tZWRpYXRlKSB0aGlzLl92YWxpZGF0ZVRyYW5zaXRpb24oKTtcblx0XHRyZXR1cm4gdGhpcztcblx0fSxcblxuXHRzdG9wVHJhbnNpdGlvbjogZnVuY3Rpb24oKSB7XG5cdFx0Ly8gdGhpcy5fdHJhbnNpdGlvbi5uYW1lID0gXCJbbm9uZV1cIjtcblx0XHQvLyB0aGlzLl90cmFuc2l0aW9uLnByb3BlcnR5ID0gXCJub25lXCI7XG5cdFx0dGhpcy5fdHJhbnNpdGlvbiA9IF8uZXh0ZW5kKHRoaXMuX3RyYW5zaXRpb24sIFVOU0VUX1RSQU5TSVRJT04pO1xuXHRcdHRoaXMuX3RyYW5zaXRpb25WYWx1ZSA9IE5PX1RSQU5TSVRJT047XG5cblx0XHR0aGlzLl9oYXNUcmFuc2l0aW9uID0gZmFsc2U7XG5cdFx0dGhpcy5fdHJhbnNpdGlvbkludmFsaWQgPSB0cnVlO1xuXHRcdC8vIGlmICh0aGlzLmltbWVkaWF0ZSkgdGhpcy5fdmFsaWRhdGVUcmFuc2l0aW9uKCk7XG5cdFx0cmV0dXJuIHRoaXM7XG5cdH0sXG5cblx0d2hlblRyYW5zaXRpb25FbmRzOiBmdW5jdGlvbigpIHtcblx0XHR2YXIgZCwgcCwgcHA7XG5cdFx0aWYgKHRoaXMuX3RyYW5zaXRpb25JbnZhbGlkIHx8IHRoaXMuX3RyYW5zaXRpb25SdW5uaW5nKSB7XG5cdFx0XHRkID0ge307XG5cdFx0XHRwID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdFx0XHRcdGQucmVzb2x2ZSA9IHJlc29sdmU7XG5cdFx0XHRcdGQucmVqZWN0ID0gcmVqZWN0O1xuXHRcdFx0fSk7XG5cdFx0XHRwcCA9IHRoaXMuX3RyYW5zaXRpb25JbnZhbGlkID8gdGhpcy5fcGVuZGluZ1Byb21pc2VzIDogdGhpcy5fcHJvbWlzZXM7XG5cdFx0XHRwcC5wdXNoKGQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRwID0gUHJvbWlzZS5yZXNvbHZlKHRoaXMuZWwpO1xuXHRcdH1cblx0XHRyZXR1cm4gcDtcblx0fSxcblxuXHQvKiB2YWxpZGF0aW9uXG5cdC8qIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblx0dmFsaWRhdGU6IGZ1bmN0aW9uKCkge1xuXHRcdC8vIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRW5kLCB0aGlzLl9vblRyYW5zaXRpb25FbmQsIGZhbHNlKTtcblx0XHR0aGlzLl9pZ25vcmVFdmVudCA9IHRydWU7XG5cblx0XHRpZiAodGhpcy5fY2FwdHVyZUludmFsaWQpIHtcblx0XHRcdHZhciBsYXN0WCA9ICh0aGlzLl9yZW5kZXJlZFggIT09IG51bGwgPyB0aGlzLl9yZW5kZXJlZFggOiB0aGlzLl9jYXB0dXJlZFgpLFxuXHRcdFx0XHRsYXN0WSA9ICh0aGlzLl9yZW5kZXJlZFkgIT09IG51bGwgPyB0aGlzLl9yZW5kZXJlZFkgOiB0aGlzLl9jYXB0dXJlZFkpO1xuXG5cdFx0XHQvLyB0aGlzLl92YWxpZGF0ZVRyYW5zaXRpb24oKTtcblx0XHRcdHRoaXMuX3ZhbGlkYXRlQ2FwdHVyZSgpO1xuXHRcdFx0dGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblxuXHRcdFx0dmFyIGN1cnJYID0gKHRoaXMuX3JlbmRlcmVkWCAhPT0gbnVsbCA/IHRoaXMuX3JlbmRlcmVkWCA6IHRoaXMuX2NhcHR1cmVkWCksXG5cdFx0XHRcdGN1cnJZID0gKHRoaXMuX3JlbmRlcmVkWSAhPT0gbnVsbCA/IHRoaXMuX3JlbmRlcmVkWSA6IHRoaXMuX2NhcHR1cmVkWSk7XG5cblx0XHRcdGlmIChsYXN0WCA9PT0gY3VyclggJiYgbGFzdFkgPT09IGN1cnJZKSB7XG5cdFx0XHRcdHRoaXMuX2hhc1RyYW5zaXRpb24gJiYgY29uc29sZS53YXJuKFwidHhbJXNdOjp2YWxpZGF0ZSB1bmNoYW5nZWQ6IGxhc3Q6WyVpLCVpXSBjdXJyOlslaSwlaV1cIiwgdGhpcy5lbC5pZCB8fCB0aGlzLmlkLCBsYXN0WCwgbGFzdFksIGN1cnJYLCBjdXJyWSk7XG5cdFx0XHRcdC8vIGNvbnNvbGUuaW5mbyhcInR4WyVzXTo6dmFsaWRhdGUgdW5jaGFuZ2VkOiBsYXN0OlslZiwlZl0gY3VycjpbJWYsJWZdIHJlbmRlcjpbJWYsJWZdIGNhcHR1cmVkWyVmLCVmXVwiLCB0aGlzLmVsLmlkIHx8IHRoaXMuaWQsIGxhc3RYLCBsYXN0WSwgY3VyclgsIGN1cnJZLCB0aGlzLl9yZW5kZXJlZFgsIHRoaXMuX3JlbmRlcmVkWSwgdGhpcy5fY2FwdHVyZWRYLCB0aGlzLl9jYXB0dXJlZFkpO1xuXHRcdFx0XHR0aGlzLmNsZWFyVHJhbnNpdGlvbigpO1xuXHRcdFx0XHQvLyB0aGlzLl92YWxpZGF0ZVRyYW5zaXRpb24oKTtcblx0XHRcdH1cblx0XHRcdHRoaXMuX3ZhbGlkYXRlVHJhbnNpdGlvbigpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyB0aGlzLl92YWxpZGF0ZUNhcHR1cmUoKTtcblx0XHRcdHRoaXMuX3ZhbGlkYXRlVHJhbnNpdGlvbigpO1xuXHRcdFx0dGhpcy5fdmFsaWRhdGVPZmZzZXQoKTtcblx0XHR9XG5cblx0XHQvLyB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIodHJhbnNpdGlvbkVuZCwgdGhpcy5fb25UcmFuc2l0aW9uRW5kLCBmYWxzZSk7XG5cdFx0dGhpcy5faWdub3JlRXZlbnQgPSBmYWxzZTtcblxuXHRcdC8vIGlmICh0aGlzLl9jYXB0dXJlZENoYW5nZWQpIHtcblx0XHQvLyBcdGNvbnNvbGUuZXJyb3IoXCJ0eFslc106OnZhbGlkYXRlIGNhcHR1cmUgY2hhbmdlZDogWyVmLCVmXVwiLCB0aGlzLmlkLCB0aGlzLl9jYXB0dXJlZFgsIHRoaXMuX2NhcHR1cmVkWSk7XG5cdFx0Ly8gfVxuXHRcdHRoaXMuX2NhcHR1cmVkQ2hhbmdlZCA9IGZhbHNlO1xuXHRcdHJldHVybiB0aGlzO1xuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogUHJpdmF0ZVxuXHQvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cblx0X3ZhbGlkYXRlQ2FwdHVyZTogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKCF0aGlzLl9jYXB0dXJlSW52YWxpZCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHQvLyB2YXIgY29tcHV0ZWQsIGNhcHR1cmVkVmFsdWVzO1xuXHRcdHZhciB0cmFuc2Zvcm1WYWx1ZSA9IG51bGw7XG5cblx0XHRpZiAodGhpcy5faGFzT2Zmc2V0ICYmICF0aGlzLl9vZmZzZXRJbnZhbGlkKSB7XG5cdFx0XHQvLyB0aGlzIGlzIGFuIGV4cGxpY2l0IGNhbGwgdG8gY2FwdHVyZSgpIGluc3RlYWQgb2YgYSBzdWJjYWxsIGZyb20gX3ZhbGlkYXRlT2Zmc2V0KClcblx0XHRcdHRyYW5zZm9ybVZhbHVlID0gdGhpcy5fZ2V0Q1NTUHJvcChcInRyYW5zZm9ybVwiKTtcblx0XHRcdGlmICh0cmFuc2Zvcm1WYWx1ZSA9PT0gXCJcIikge1xuXHRcdFx0XHRjb25zb2xlLmVycm9yKFwidHhbJXNdOjpfY2FwdHVyZSB2YWxpZCBvZmZzZXQgKCVpLCRpKSBidXQgdHJhbnNmb3JtVmFsdWU9XFxcIlxcXCJcIiwgdGhpcy5pZCwgdGhpcy5fb2Zmc2V0WCwgdGhpcy5fb2Zmc2V0WSk7XG5cdFx0XHR9XG5cdFx0XHR0aGlzLl9yZW1vdmVDU1NQcm9wKFwidHJhbnNmb3JtXCIpO1xuXHRcdH1cblxuXHRcdC8vIE5PVEU6IHJldXNpbmcgb2JqZWN0LCBhbGwgcHJvcHMgd2lsbCBiZSBvdmVyd3JpdHRlblxuXHRcdHRoaXMuX2xhc3RDYXB0dXJlID0gdGhpcy5fY3VyckNhcHR1cmU7XG5cdFx0dGhpcy5fY3VyckNhcHR1cmUgPSB0aGlzLl9nZXRDb21wdXRlZENTU1Byb3BzKCk7XG5cblx0XHRpZiAodGhpcy5fY3VyckNhcHR1cmUudHJhbnNmb3JtICE9PSB0aGlzLl9sYXN0Q2FwdHVyZS50cmFuc2Zvcm0pIHtcblx0XHRcdHZhciBtLCBtbTsgLy8sIHJldCA9IHt9O1xuXHRcdFx0bW0gPSB0aGlzLl9jdXJyQ2FwdHVyZS50cmFuc2Zvcm0ubWF0Y2goLyhtYXRyaXh8bWF0cml4M2QpXFwoKFteXFwpXSspXFwpLyk7XG5cdFx0XHRpZiAobW0pIHtcblx0XHRcdFx0bSA9IG1tWzJdLnNwbGl0KFwiLFwiKTtcblx0XHRcdFx0aWYgKG1tWzFdID09PSBcIm1hdHJpeFwiKSB7XG5cdFx0XHRcdFx0dGhpcy5fY2FwdHVyZWRYID0gcGFyc2VGbG9hdChtWzRdKTtcblx0XHRcdFx0XHR0aGlzLl9jYXB0dXJlZFkgPSBwYXJzZUZsb2F0KG1bNV0pO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHRoaXMuX2NhcHR1cmVkWCA9IHBhcnNlRmxvYXQobVsxMl0pO1xuXHRcdFx0XHRcdHRoaXMuX2NhcHR1cmVkWSA9IHBhcnNlRmxvYXQobVsxM10pO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLl9jYXB0dXJlZFggPSAwO1xuXHRcdFx0XHR0aGlzLl9jYXB0dXJlZFkgPSAwO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5fY2FwdHVyZWRDaGFuZ2VkID0gdHJ1ZTtcblx0XHR9XG5cdFx0aWYgKHRyYW5zZm9ybVZhbHVlICE9PSBudWxsKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcInR4WyVzXTo6X2NhcHR1cmUgcmVhcHBseWluZyAnJXMnXCIsIHRoaXMuaWQsIHRyYW5zZm9ybVZhbHVlKTtcblx0XHRcdHRoaXMuX3NldENTU1Byb3AoXCJ0cmFuc2Zvcm1cIiwgdHJhbnNmb3JtVmFsdWUpO1xuXHRcdH1cblx0XHR0aGlzLl9jYXB0dXJlSW52YWxpZCA9IGZhbHNlO1xuXHR9LFxuXG5cdF92YWxpZGF0ZU9mZnNldDogZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuX29mZnNldEludmFsaWQpIHtcblx0XHRcdC8vIHRoaXMuX3ZhbGlkYXRlQ2FwdHVyZSgpO1xuXHRcdFx0dGhpcy5fb2Zmc2V0SW52YWxpZCA9IGZhbHNlO1xuXHRcdFx0aWYgKHRoaXMuX2hhc09mZnNldCkge1xuXHRcdFx0XHR2YXIgdHggPSB0aGlzLl9vZmZzZXRYICsgdGhpcy5fY2FwdHVyZWRYO1xuXHRcdFx0XHR2YXIgdHkgPSB0aGlzLl9vZmZzZXRZICsgdGhpcy5fY2FwdHVyZWRZO1xuXHRcdFx0XHRpZiAodHggIT09IHRoaXMuX3JlbmRlcmVkWCB8fCB0eSAhPT0gdGhpcy5fcmVuZGVyZWRZKSB7XG5cdFx0XHRcdFx0dGhpcy5fcmVuZGVyZWRYID0gdHg7XG5cdFx0XHRcdFx0dGhpcy5fcmVuZGVyZWRZID0gdHk7XG5cdFx0XHRcdFx0dGhpcy5fc2V0Q1NTUHJvcChcInRyYW5zZm9ybVwiLCB0cmFuc2xhdGVUZW1wbGF0ZSh0aGlzKSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRoaXMuX3JlbmRlcmVkWCA9IG51bGw7XG5cdFx0XHRcdHRoaXMuX3JlbmRlcmVkWSA9IG51bGw7XG5cdFx0XHRcdHRoaXMuX3JlbW92ZUNTU1Byb3AoXCJ0cmFuc2Zvcm1cIik7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF92YWxpZGF0ZVRyYW5zaXRpb246IGZ1bmN0aW9uKCkge1xuXHRcdGlmICh0aGlzLl90cmFuc2l0aW9uSW52YWxpZCkge1xuXHRcdFx0Ly8gdGhpcy5fdmFsaWRhdGVDYXB0dXJlKCk7XG5cdFx0XHR0aGlzLl90cmFuc2l0aW9uSW52YWxpZCA9IGZhbHNlO1xuXG5cdFx0XHQvLyBzYXZlIHByb21pc2VzIG1hZGUgd2hpbGUgaW52YWxpZFxuXHRcdFx0dmFyIHJlamVjdCA9IHRoaXMuX3Byb21pc2VzO1xuXHRcdFx0Ly8gcHJlcGFyZSBfcHJvbWlzZXMgYW5kIHB1c2ggaW4gbmV3IG9uZXNcblx0XHRcdHRoaXMuX3Byb21pc2VzID0gdGhpcy5fcGVuZGluZ1Byb21pc2VzO1xuXHRcdFx0Ly8gd2hhdGV2ZXIgc3RpbGwgaGVyZSBpcyB0byBiZSByZWplY3RlZC4gcmV1c2UgYXJyYXlcblx0XHRcdHRoaXMuX3BlbmRpbmdQcm9taXNlcyA9IHJlamVjdEFsbChyZWplY3QsIHRoaXMuZWwpO1xuXG5cdFx0XHR0aGlzLl90cmFuc2l0aW9uUnVubmluZyA9IHRoaXMuX2hhc1RyYW5zaXRpb247XG5cdFx0XHR0aGlzLl9zZXRDU1NQcm9wKFwidHJhbnNpdGlvblwiLCB0aGlzLl90cmFuc2l0aW9uVmFsdWUpO1xuXG5cdFx0XHRpZiAoIXRoaXMuX2hhc1RyYW5zaXRpb24pIHtcblx0XHRcdFx0Ly8gbm8gdHJhbnNpdGlvbiwgcmVzb2x2ZSBub3dcblx0XHRcdFx0cmVzb2x2ZUFsbCh0aGlzLl9wcm9taXNlcywgdGhpcy5lbCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9LFxuXG5cdF9vblRyYW5zaXRpb25FbmQ6IGZ1bmN0aW9uKGV2KSB7XG5cdFx0aWYgKHRoaXMuX2lnbm9yZUV2ZW50KSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdGlmICh0aGlzLl90cmFuc2l0aW9uUnVubmluZyAmJiAodGhpcy5lbCA9PT0gZXYudGFyZ2V0KSAmJlxuXHRcdFx0KHRoaXMuX3RyYW5zaXRpb24ucHJvcGVydHkgPT0gZXYucHJvcGVydHlOYW1lKSkge1xuXHRcdFx0dGhpcy5faGFzVHJhbnNpdGlvbiA9IGZhbHNlO1xuXHRcdFx0dGhpcy5fdHJhbnNpdGlvblJ1bm5pbmcgPSBmYWxzZTtcblx0XHRcdHRoaXMuX3JlbW92ZUNTU1Byb3AoXCJ0cmFuc2l0aW9uXCIpO1xuXHRcdFx0cmVzb2x2ZUFsbCh0aGlzLl9wcm9taXNlcywgdGhpcy5lbCk7XG5cdFx0fVxuXHR9LFxuXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0LyogQ1NTXG5cdC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXHRfZ2V0Q1NTUHJvcDogZnVuY3Rpb24ocHJvcCkge1xuXHRcdHJldHVybiB0aGlzLmVsLnN0eWxlW3Byb3BOYW1lc1twcm9wXV07XG5cdFx0Ly8gcmV0dXJuIHRoaXMuZWwuc3R5bGVbcHJlZml4ZWRQcm9wZXJ0eShwcm9wKV07XG5cdFx0Ly8gcmV0dXJuIHRoaXMuZWwuc3R5bGUuZ2V0UHJvcGVydHlWYWx1ZShzdHlsZU5hbWVzW3Byb3BdKTtcblx0fSxcblxuXHRfc2V0Q1NTUHJvcDogZnVuY3Rpb24ocHJvcCwgdmFsdWUpIHtcblx0XHRpZiAocHJvcCA9PT0gXCJ0cmFuc2l0aW9uXCIgJiYgdmFsdWUgPT0gTk9fVFJBTlNJVElPTikge1xuXHRcdFx0dmFsdWUgPSBcIlwiO1xuXHRcdH1cblx0XHRpZiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHZvaWQgMCB8fCB2YWx1ZSA9PT0gXCJcIikge1xuXHRcdFx0dGhpcy5fcmVtb3ZlQ1NTUHJvcChwcm9wKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5lbC5zdHlsZVtwcm9wTmFtZXNbcHJvcF1dID0gdmFsdWU7XG5cdFx0XHQvLyB0aGlzLmVsLnN0eWxlLnNldFByb3BlcnR5KHN0eWxlTmFtZXNbcHJvcF0sIHZhbHVlKTtcblx0XHR9XG5cdH0sXG5cblx0X3JlbW92ZUNTU1Byb3A6IGZ1bmN0aW9uKHByb3ApIHtcblx0XHR0aGlzLmVsLnN0eWxlW3Byb3BOYW1lc1twcm9wXV0gPSBcIlwiO1xuXHRcdC8vIHRoaXMuZWwuc3R5bGUucmVtb3ZlUHJvcGVydHkoc3R5bGVOYW1lc1twcm9wXSk7XG5cdH0sXG5cblx0X2dldENvbXB1dGVkQ1NTUHJvcHM6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciB2YWx1ZXMgPSB7fTtcblx0XHR2YXIgY29tcHV0ZWQgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLmVsKTtcblx0XHRmb3IgKHZhciBwIGluIHByb3BOYW1lcykge1xuXHRcdFx0dmFsdWVzW3BdID0gY29tcHV0ZWRbcHJvcE5hbWVzW3BdXTtcblx0XHR9XG5cdFx0cmV0dXJuIHZhbHVlcztcblx0fSxcbn0sIHtcblx0dHJhbnNpdGlvbjoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fdHJhbnNpdGlvbjtcblx0XHR9XG5cdH0sXG5cdGhhc1RyYW5zaXRpb246IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2hhc1RyYW5zaXRpb247XG5cdFx0fVxuXHR9LFxuXHRjYXB0dXJlZENoYW5nZWQ6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX2NhcHR1cmVkQ2hhbmdlZDtcblx0XHR9XG5cdH0sXG5cdGNhcHR1cmVkWDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fY2FwdHVyZWRYO1xuXHRcdH1cblx0fSxcblx0Y2FwdHVyZWRZOiB7XG5cdFx0Z2V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiB0aGlzLl9jYXB0dXJlZFk7XG5cdFx0fVxuXHR9LFxuXG5cdGhhc09mZnNldDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5faGFzT2Zmc2V0O1xuXHRcdH1cblx0fSxcblx0b2Zmc2V0WDoge1xuXHRcdGdldDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5fb2Zmc2V0WDtcblx0XHR9XG5cdH0sXG5cdG9mZnNldFk6IHtcblx0XHRnZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMuX29mZnNldFk7XG5cdFx0fVxuXHR9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gVHJhbnNmb3JtSXRlbTsiLCJ2YXIgUEkyID0gTWF0aC5QSSAqIDI7XG5cbnZhciBzcGxpY2UgPSBBcnJheS5wcm90b3R5cGUuc3BsaWNlO1xuLy8gdmFyIGNvbmNhdCA9IEFycmF5LnByb3RvdHlwZS5jb25jYXQ7XG5cbnZhciBzZXRTdHlsZSA9IGZ1bmN0aW9uKGN0eCwgcykge1xuXHRpZiAodHlwZW9mIHMgIT0gXCJvYmplY3RcIikgcmV0dXJuO1xuXHRmb3IgKHZhciBwIGluIHMpIHtcblx0XHRzd2l0Y2ggKHR5cGVvZiBjdHhbcF0pIHtcblx0XHRcdGNhc2UgXCJ1bmRlZmluZWRcIjpcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiZnVuY3Rpb25cIjpcblx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkoc1twXSkpIGN0eFtwXS5hcHBseShjdHgsIHNbcF0pO1xuXHRcdFx0XHRlbHNlIGN0eFtwXS5jYWxsKGN0eCwgc1twXSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0Y3R4W3BdID0gc1twXTtcblx0XHR9XG5cdH1cbn07XG5cbnZhciBfZHJhd1NoYXBlID0gZnVuY3Rpb24oZm4sIHMsIGN0eCkge1xuXHRjdHguc2F2ZSgpO1xuXHRpZiAocykgc2V0U3R5bGUoY3R4LCBzKTtcblx0Zm4uYXBwbHkobnVsbCwgc3BsaWNlLmNhbGwoYXJndW1lbnRzLCAyKSk7XG5cdGlmIChjdHgubGluZVdpZHRoICE9PSBcInRyYW5zcGFyZW50XCIpIGN0eC5zdHJva2UoKTtcblx0aWYgKGN0eC5maWxsU3R5bGUgIT09IFwidHJhbnNwYXJlbnRcIikgY3R4LmZpbGwoKTtcblx0Y3R4LnJlc3RvcmUoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuXHRzZXRTdHlsZTogc2V0U3R5bGUsXG5cblx0dkd1aWRlOiBmdW5jdGlvbihjdHgsIHgpIHtcblx0XHRjdHguYmVnaW5QYXRoKCk7XG5cdFx0Y3R4Lm1vdmVUbyh4LCAwKTtcblx0XHRjdHgubGluZVRvKHgsIGN0eC5jYW52YXMuaGVpZ2h0KTtcblx0fSxcblx0ZHJhd1ZHdWlkZTogZnVuY3Rpb24oY3R4LCBzLCB4KSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLnZHdWlkZSwgcywgY3R4LCB4KTtcblx0fSxcblxuXHRoR3VpZGU6IGZ1bmN0aW9uKGN0eCwgeSkge1xuXHRcdGN0eC5iZWdpblBhdGgoKTtcblx0XHRjdHgubW92ZVRvKDAsIHkpO1xuXHRcdGN0eC5saW5lVG8oY3R4LmNhbnZhcy53aWR0aCwgeSk7XG5cdH0sXG5cdGRyYXdIR3VpZGU6IGZ1bmN0aW9uKGN0eCwgcywgeSkge1xuXHRcdF9kcmF3U2hhcGUodGhpcy5oR3VpZGUsIHMsIGN0eCwgeSk7XG5cdH0sXG5cblx0Y3Jvc3NoYWlyOiBmdW5jdGlvbihjdHgsIHgsIHksIHIpIHtcblx0XHRjdHguc2F2ZSgpO1xuXHRcdGN0eC50cmFuc2xhdGUoeCwgeSk7XG5cdFx0Y3R4LnJvdGF0ZShNYXRoLlBJIC8gNCk7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5tb3ZlVG8oMCwgLXIpO1xuXHRcdGN0eC5saW5lVG8oMCwgcik7XG5cdFx0Y3R4Lm1vdmVUbygtciwgMCk7XG5cdFx0Y3R4LmxpbmVUbyhyLCAwKTtcblx0XHRjdHgucmVzdG9yZSgpO1xuXHR9LFxuXHRkcmF3Q3Jvc3NoYWlyOiBmdW5jdGlvbihjdHgsIHMsIHgsIHksIHIpIHtcblx0XHRfZHJhd1NoYXBlKHRoaXMuY3Jvc3NoYWlyLCBzLCBjdHgsIHgsIHksIHIpO1xuXHR9LFxuXG5cdGNpcmNsZTogZnVuY3Rpb24oY3R4LCB4LCB5LCByKSB7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5hcmMoeCwgeSwgciwgMCwgUEkyKTtcblx0fSxcblx0ZHJhd0NpcmNsZTogZnVuY3Rpb24oY3R4LCBzLCB4LCB5LCByKSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLmNpcmNsZSwgcywgY3R4LCB4LCB5LCByKTtcblx0fSxcblxuXHRzcXVhcmU6IGZ1bmN0aW9uKGN0eCwgeCwgeSwgcikge1xuXHRcdHIgPSBNYXRoLmZsb29yKHIgLyAyKSAqIDI7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5yZWN0KHggLSByLCB5IC0gciwgciAqIDIsIHIgKiAyKTtcblx0fSxcblx0ZHJhd1NxdWFyZTogZnVuY3Rpb24oY3R4LCBzLCB4LCB5LCByKSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLnNxdWFyZSwgcywgY3R4LCB4LCB5LCByKTtcblx0fSxcblxuXHRhcnJvd2hlYWQ6IGZ1bmN0aW9uKGN0eCwgeCwgeSwgciwgdCkge1xuXHRcdGN0eC5zYXZlKCk7XG5cdFx0Y3R4LnRyYW5zbGF0ZSh4LCB5KTtcblx0XHRjdHgucm90YXRlKHQpOyAvLyAtIE1hdGguUEkgKiAwLjUpO1xuXHRcdGN0eC50cmFuc2xhdGUociAqIDAuNSwgMCk7XG5cdFx0Y3R4LmJlZ2luUGF0aCgpO1xuXHRcdGN0eC5tb3ZlVG8oMCwgMCk7XG5cdFx0Ly8gY3R4LmxpbmVUbygtciwgciAqIE1hdGguU1FSVDFfMik7XG5cdFx0Ly8gY3R4LmxpbmVUbygtciwgLXIgKiBNYXRoLlNRUlQxXzIpO1xuXHRcdGN0eC5saW5lVG8oLXIgKiBNYXRoLlNRUlQyLCByICogTWF0aC5TUVJUMV8yKTtcblx0XHRjdHguYXJjVG8oMCwgMCwgLXIgKiBNYXRoLlNRUlQyLCAtciAqIE1hdGguU1FSVDFfMiwgcik7XG5cdFx0Ly8gY3R4LnF1YWRyYXRpY0N1cnZlVG8oMCwgMCwgLXIgKiBNYXRoLlNRUlQyLCAtciAqIE1hdGguU1FSVDFfMik7XG5cdFx0Y3R4LmxpbmVUbygwLCAwKTtcblx0XHRjdHguY2xvc2VQYXRoKCk7XG5cdFx0Y3R4LnJlc3RvcmUoKTtcblx0fSxcblx0ZHJhd0Fycm93aGVhZDogZnVuY3Rpb24oY3R4LCBzLCB4LCB5LCByLCB0KSB7XG5cdFx0X2RyYXdTaGFwZSh0aGlzLmFycm93aGVhZCwgcywgY3R4LCB4LCB5LCByLCB0KTtcblx0fSxcblxuXHRyZWN0OiBmdW5jdGlvbihjdHgsIGExLCBhMiwgYTMsIGE0KSB7XG5cblx0XHRjdHguYmVnaW5QYXRoKCk7XG5cdFx0aWYgKGlzTmFOKGExKSkge1xuXHRcdFx0Y3R4LnJlY3QoYTEubGVmdCwgYTEudG9wLCBhMS53aWR0aCwgYTEuaGVpZ2h0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y3R4LnJlY3QoYTEsIGEyLCBhMywgYTQpO1xuXHRcdH1cblx0fSxcblx0ZHJhd1JlY3Q6IGZ1bmN0aW9uKGN0eCwgcywgYTEsIGEyLCBhMywgYTQpIHtcblx0XHRfZHJhd1NoYXBlKHRoaXMucmVjdCwgcywgY3R4LCBhMSwgYTIsIGEzLCBhNCk7XG5cdH0sXG59OyIsIi8qKlxuICogQG1vZHVsZSB1dGlscy9jYW52YXMvY2FsY0FyY0hDb25uZWN0b3JcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHgxLCB5MSwgcjEsIHgyLCB5MiwgcjIsIHJvKSB7XG5cdHZhciBxeCA9IHgyID4geDEgPyAxIDogLTE7XG5cdHZhciBxeSA9IHkyID4geTEgPyAxIDogLTE7XG5cdHZhciBkeSA9IE1hdGguYWJzKHkyIC0geTEpO1xuXHR2YXIgZHggPSBNYXRoLmFicyh4MiAtIHgxKTtcblx0dmFyIHJyID0gcjEgKyByMjtcblx0dmFyIHR4MSwgdHgyLCBjLCB0eCwgdHk7XG5cblx0aWYgKGR5IDwgMSkge1xuXHRcdC8vIHBvaW50cyBhcmUgYWxpZ25lZCBob3Jpem9udGFsbHksIG5vIGFyY3MgbmVlZGVkXG5cdFx0dHgxID0gMDtcblx0XHR0eDIgPSBkeFxuXHRcdC8vIHJldHVybiBbeDEsIHgyXTtcblx0fVxuXG5cdGlmIChkeSA+PSByciAmJiBkeCA+PSBycikge1xuXHRcdC8vIGFyY3MgZml0IGhvcml6b250YWxseTpcblx0XHQvLyBzZWNvbmQgY2lyY2xlIGNlbnRlciBpcyByMStyMiwgdGFuZ2VudCBpbnRlcnNlY3QgYXQgeD1yMVxuXHRcdGMgPSBycjtcblx0XHR0eDEgPSByMTtcblx0XHR0eDIgPSByMTtcblx0fSBlbHNlIHtcblx0XHQvLyBhcmNzIG92ZXJsYXAgaG9yaXpvbnRhbGx5OlxuXHRcdC8vIGZpbmQgc2Vjb25kIGNpcmNsZSBjZW50ZXJcblx0XHRjID0gTWF0aC5zcXJ0KGR5ICogcjIgKiAyICsgZHkgKiByMSAqIDIgLSBkeSAqIGR5KTtcblxuXHRcdC8vIGNpcmNsZXMgdGFuZ2VudCBwb2ludFxuXHRcdHR4ID0gKGMgKiByMSkgLyBycjtcblx0XHR0eSA9IChkeSAqIHIxKSAvIHJyO1xuXG5cdFx0aWYgKHIxIDwgdHkgfHwgYyA+IGR4KSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gdGFuZ2VudCBwZXJwZW5kaWN1bGFyIHNsb3BlXG5cdFx0dmFyIHNsb3BlID0gKHJyIC0gZHkpIC8gYztcblx0XHQvLyB0YW5nZW50IGludGVyc2VjdGlvbnNcblx0XHR0eDEgPSB0eCAtICh0eSAqIHNsb3BlKTtcblx0XHR0eDIgPSAoZHkgKiBzbG9wZSkgKyB0eDE7XG5cblx0XHQvKlxuXHRcdC8vIGNpcmNsZSBjZW50ZXJzXG5cdFx0dmFyIGNjeDEsIGNjeTEsIGNjeDIsIGNjeTI7XG5cdFx0Y2N4MSA9IDA7XG5cdFx0Y2N5MSA9IHIxO1xuXHRcdGNjeDIgPSBjO1xuXHRcdGNjeTIgPSBkeSAtIHIyO1xuXHRcdC8vIHRhbmdlbnQgcGVycGVuZGljdWxhciBzbG9wZVxuXHRcdHZhciBzbG9wZSA9IChjY3kxIC0gY2N5MikgLyAoY2N4MiAtIGNjeDEpO1xuXHRcdHZhciB4U2VjID0gdHggLSAodHkgKiBzbG9wZSk7XG5cdFx0Ly8gdGFuZ2VudCBpbnRlcnNlY3Rpb25zXG5cdFx0dHgxID0geFNlYztcblx0XHR0eDIgPSAoZHkgKiBzbG9wZSkgKyB4U2VjO1xuXHRcdCovXG5cdH1cblxuXHQvLyBvZmZzZXQgYXJjVG8ncyBpbiB4LWF4aXNcblx0aWYgKHJvID4gMCkge1xuXHRcdGlmIChybyA+IDEpIHtcblx0XHRcdHJvID0gTWF0aC5taW4oZHggLSByciwgcm8pO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRybyAqPSBkeCAtIHJyO1xuXHRcdH1cblx0XHR0eDEgKz0gcm87XG5cdFx0dHgyICs9IHJvO1xuXHR9XG5cblx0cmV0dXJuIFt0eDEgKiBxeCArIHgxLCB0eDIgKiBxeCArIHgxLCB0eDEsIHR4Ml07XG59O1xuXG4vKlxudmFyIGRyYXdBcmNDb25uZWN0b3IgPSBmdW5jdGlvbihjdHgsIHgxLCB5MSwgeDIsIHkyLCByKSB7XG5cdHZhciBkeCwgZHksIGh4LCBoeSwgZ3gsIGd5O1xuXG5cdGh4ID0gMDtcblx0aHkgPSAwO1xuXHRneCA9ICh4MSArIHgyKSAvIDI7XG5cdGd5ID0gKHkxICsgeTIpIC8gMjtcblx0ZHggPSBNYXRoLmFicyh4MSAtIGd4KTtcblx0ZHkgPSBNYXRoLmFicyh5MSAtIGd5KTtcblxuXHRpZiAoZHggPCByICYmIGR5IDwgcikge1xuXHRcdHIgPSBNYXRoLm1pbihkeCAqIE1hdGguU1FSVDFfMiwgZHkgKiBNYXRoLlNRUlQxXzIpO1xuXHR9IGVsc2Uge1xuXHRcdGlmIChkeCA8IHIpIHtcblx0XHRcdGh5ID0gTWF0aC5hY29zKGR4IC8gcikgKiByICogMC41O1xuXHRcdFx0aWYgKHkxID4geTIpIGh5ICo9IC0xO1xuXHRcdH1cblx0XHRpZiAoZHkgPCByKSB7XG5cdFx0XHRoeCA9IE1hdGguYWNvcyhkeSAvIHIpICogciAqIDAuNTtcblx0XHRcdGlmICh4MSA+IHgyKSBoeCAqPSAtMTtcblx0XHR9XG5cdH1cblx0Y3R4LmFyY1RvKGd4IC0gaHgsIHkxLCBneCArIGh4LCB5Miwgcik7XG5cdGN0eC5hcmNUbyhneCArIGh4LCB5MiwgeDIsIHkyLCByKTtcbn07XG5cbnZhciBkcmF3QXJjQ29ubmVjdG9yMiA9IGZ1bmN0aW9uKGN0eCwgeDEsIHkxLCB4MiwgeTIsIHIpIHtcblx0dmFyIGR4LCBkeSwgaHgsIGh5LCBjeDEsIGN4MjtcblxuXHRoeCA9IDA7XG5cdGh5ID0gMDtcblx0ZHggPSBNYXRoLmFicyh4MiAtIHgxKSAvIDI7XG5cdGR5ID0gTWF0aC5hYnMoeTEgLSB5MikgLyAyO1xuXG5cdGlmIChkeCA8IHIgJiYgZHkgPCByKSB7XG5cdFx0ciA9IE1hdGgubWluKGR4ICogTWF0aC5TUVJUMV8yLCBkeSAqIE1hdGguU1FSVDFfMik7XG5cdH0gZWxzZSB7XG5cdFx0aWYgKGR4IDwgcikge1xuXHRcdFx0aHkgPSBNYXRoLmFjb3MoZHggLyByKSAqIHI7XG5cdFx0fVxuXHRcdGlmIChkeSA8IHIpIHtcblx0XHRcdGh4ID0gTWF0aC5hY29zKGR5IC8gcikgKiByO1xuXHRcdH1cblx0fVxuXHRjeDEgPSB4MSArIGR4O1xuXHRjeDIgPSB4MiAtIChkeCAtIGh4IC8gMik7XG5cdGN0eC5hcmNUbyhjeDEsIHkxLCBjeDIsIHkyLCByKTtcblx0Y3R4LmFyY1RvKGN4MiwgeTIsIHgyLCB5Miwgcik7XG59O1xuXG52YXIgZHJhd0FyY0Nvbm5lY3RvcjEgPSBmdW5jdGlvbihjdHgsIHgxLCB5MSwgeDIsIHkyLCByKSB7XG5cdHZhciBkeCwgZHksIGN4O1xuXG5cdGR4ID0gTWF0aC5hYnMoeDIgLSB4MSkgLyAyO1xuXHRkeSA9IE1hdGguYWJzKHkxIC0geTIpIC8gMjtcblx0ciA9IE1hdGgubWluKHIsIGR5ICogTWF0aC5TUVJUMV8yKTtcblx0aWYgKHgxIDwgeDIpIHtcblx0XHRjeCA9IHgxICsgZHggKyByO1xuXHR9IGVsc2Uge1xuXHRcdGN4ID0geDIgLSBkeCAtIHI7XG5cdH1cblx0Ly8gY3ggPSAoeDIgKyB4MSkgLyAyO1xuXHQvLyBjeCArPSB4MSA8IHgyID8gciA6IC1yO1xuXG5cdGN0eC5hcmNUbyhjeCwgeTEsIGN4LCB5Miwgcik7XG5cdGN0eC5hcmNUbyhjeCwgeTIsIHgyLCB5Miwgcik7XG59O1xuKi9cbiIsIi8qIGdsb2JhbCBIVE1MRWxlbWVudCwgQ1NTU3R5bGVEZWNsYXJhdGlvbiAqL1xuXG4vLyB2YXIgcGFyc2VTaXplID0gcmVxdWlyZShcIi4vcGFyc2VTaXplXCIpO1xuXG52YXIgQ1NTX0JPWF9QUk9QUyA9IFtcblx0XCJib3hTaXppbmdcIiwgXCJwb3NpdGlvblwiLCBcIm9iamVjdEZpdFwiXG5dO1xudmFyIENTU19FREdFX1BST1BTID0gW1xuXHRcIm1hcmdpblRvcFwiLCBcIm1hcmdpbkJvdHRvbVwiLCBcIm1hcmdpbkxlZnRcIiwgXCJtYXJnaW5SaWdodFwiLFxuXHRcImJvcmRlclRvcFdpZHRoXCIsIFwiYm9yZGVyQm90dG9tV2lkdGhcIiwgXCJib3JkZXJMZWZ0V2lkdGhcIiwgXCJib3JkZXJSaWdodFdpZHRoXCIsXG5cdFwicGFkZGluZ1RvcFwiLCBcInBhZGRpbmdCb3R0b21cIiwgXCJwYWRkaW5nTGVmdFwiLCBcInBhZGRpbmdSaWdodFwiLFxuXTtcbnZhciBDU1NfUE9TX1BST1BTID0gW1widG9wXCIsIFwiYm90dG9tXCIsIFwibGVmdFwiLCBcInJpZ2h0XCJdO1xudmFyIENTU19TSVpFX1BST1BTID0gW1wid2lkdGhcIiwgXCJoZWlnaHRcIiwgXCJtaW5XaWR0aFwiLCBcIm1pbkhlaWdodFwiLCBcIm1heFdpZHRoXCIsIFwibWF4SGVpZ2h0XCJdO1xudmFyIENTU19BTExfUFJPUFMgPSBDU1NfRURHRV9QUk9QUy5jb25jYXQoQ1NTX1NJWkVfUFJPUFMsIENTU19QT1NfUFJPUFMpO1xuXG4vLyB2YXIgQ09NUFVURURfUFJPUFMgPSBbXG4vLyBcdFwiY2xpZW50TGVmdFwiLCBcImNsaWVudFRvcFwiLCBcImNsaWVudFdpZHRoXCIsIFwiY2xpZW50SGVpZ2h0XCIsXG4vLyBcdFwib2Zmc2V0TGVmdFwiLCBcIm9mZnNldFRvcFwiLCBcIm9mZnNldFdpZHRoXCIsIFwib2Zmc2V0SGVpZ2h0XCJcbi8vIF07XG4vLyB2YXIgbyA9IF8ucGljayhlbGVtZW50LCBmdW5jdGlvbih2YWwpIHtcbi8vIFx0cmV0dXJuIC9eKG9mZnNldHxjbGllbnQpKExlZnR8VG9wfFdpZHRofEhlaWdodCkvLnRlc3QodmFsKTtcbi8vIH0pO1xuXG52YXIgY3NzRGltZW5zaW9uUkUgPSAvXigtP1tcXGRcXC5dKykocHh8ZW18cmVtKSQvO1xuLy8gdmFyIGNzc0RpbVJlID0gL14oWy1cXC4wLTldKykoW3JlbV0rKSQvO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHMsIG0sIGluY2x1ZGVTaXplUG9zKSB7XG5cdGlmIChzIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcblx0XHRzID0gZ2V0Q29tcHV0ZWRTdHlsZShzKTtcblx0fVxuXHRpZiAoREVCVUcpIHtcblx0XHRpZiAoIShzIGluc3RhbmNlb2YgQ1NTU3R5bGVEZWNsYXJhdGlvbikpIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihcIk5vdCBhIENTU1N0eWxlRGVjbGFyYXRpb24gbm9yIEhUTUxFbGVtZW50XCIpO1xuXHRcdH1cblx0fVxuXHR2YXIgdiwgcCwgaSwgaWksIGVtUHgsIHJlbVB4O1xuXHRtIHx8IChtID0ge30pO1xuXG5cdGVtUHggPSBtLmZvbnRTaXplID0gcGFyc2VGbG9hdChzLmZvbnRTaXplKTtcblxuXHRmb3IgKGkgPSAwLCBpaSA9IENTU19CT1hfUFJPUFMubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuXHRcdHAgPSBDU1NfQk9YX1BST1BTW2ldO1xuXHRcdGlmIChwIGluIHMpIHtcblx0XHRcdG1bcF0gPSBzW3BdO1xuXHRcdH1cblx0fVxuXHR2YXIgY3NzUHJvcHMgPSBpbmNsdWRlU2l6ZVBvcyA/IENTU19FREdFX1BST1BTIDogQ1NTX0FMTF9QUk9QUztcblx0Zm9yIChpID0gMCwgaWkgPSBjc3NQcm9wcy5sZW5ndGg7IGkgPCBpaTsgaSsrKSB7XG5cdFx0cCA9IGNzc1Byb3BzW2ldO1xuXHRcdG1bXCJfXCIgKyBwXSA9IHNbcF07XG5cdFx0aWYgKHNbcF0gJiYgKHYgPSBjc3NEaW1lbnNpb25SRS5leGVjKHNbcF0pKSkge1xuXHRcdFx0aWYgKHZbMl0gPT09IFwicHhcIikge1xuXHRcdFx0XHRtW3BdID0gcGFyc2VGbG9hdCh2WzFdKTtcblx0XHRcdH0gZWxzZSBpZiAodlsyXSA9PT0gXCJlbVwiKSB7XG5cdFx0XHRcdG1bcF0gPSBwYXJzZUZsb2F0KHZbMV0pICogZW1QeDtcblx0XHRcdH0gZWxzZSBpZiAodlsyXSA9PT0gXCJyZW1cIikge1xuXHRcdFx0XHRyZW1QeCB8fCAocmVtUHggPSBwYXJzZUZsb2F0KGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5mb250U2l6ZSkpO1xuXHRcdFx0XHRtW3BdID0gcGFyc2VGbG9hdCh2WzFdKSAqIHJlbVB4O1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiSWdub3JpbmcgdmFsdWVcIiwgcCwgdlsxXSwgdlsyXSk7XG5cdFx0XHRcdG1bcF0gPSBudWxsO1xuXHRcdFx0fVxuXHRcdH0gLy8gZWxzZSB7XG5cdFx0Ly9cdGNvbnNvbGUud2FybihcIklnbm9yaW5nIHVuaXRsZXNzIHZhbHVlXCIsIHAsIHYpO1xuXHRcdC8vfVxuXHR9XG5cdHJldHVybiBtO1xufTtcbiIsIi8qKlxuUmV0dXJucyBhIGJvdW5kaW5nIHJlY3QgZm9yIF9lbF8gd2l0aCBhYnNvbHV0ZSBjb29yZGluYXRlcyBjb3JyZWN0ZWQgZm9yXG5zY3JvbGwgcG9zaXRpb25zLlxuXG5UaGUgbmF0aXZlIGBnZXRCb3VuZGluZ0NsaWVudFJlY3QoKWAgcmV0dXJucyBjb29yZGluYXRlcyBmb3IgYW4gZWxlbWVudCdzXG52aXN1YWwgcG9zaXRpb24gcmVsYXRpdmUgdG8gdGhlIHRvcCBsZWZ0IG9mIHRoZSB2aWV3cG9ydCwgc28gaWYgdGhlIGVsZW1lbnRcbmlzIHBhcnQgb2YgYSBzY3JvbGxhYmxlIHJlZ2lvbiB0aGF0IGhhcyBiZWVuIHNjcm9sbGVkLCBpdHMgY29vcmRpbmF0ZXMgd2lsbFxuYmUgZGlmZmVyZW50IHRoYW4gaWYgdGhlIHJlZ2lvbiBoYWRuJ3QgYmVlbiBzY3JvbGxlZC5cblxuVGhpcyBtZXRob2QgY29ycmVjdHMgZm9yIHNjcm9sbCBvZmZzZXRzIGFsbCB0aGUgd2F5IHVwIHRoZSBub2RlIHRyZWUsIHNvIHRoZVxucmV0dXJuZWQgYm91bmRpbmcgcmVjdCB3aWxsIHJlcHJlc2VudCBhbiBhYnNvbHV0ZSBwb3NpdGlvbiBvbiBhIHZpcnR1YWxcbmNhbnZhcywgcmVnYXJkbGVzcyBvZiBzY3JvbGxpbmcuXG5cbkBtZXRob2QgZ2V0QWJzb2x1dGVDbGllbnRSZWN0XG5AcGFyYW0ge0hUTUxFbGVtZW50fSBlbCBIVE1MIGVsZW1lbnQuXG5AcmV0dXJuIHtPYmplY3R9IEFic29sdXRlIGJvdW5kaW5nIHJlY3QgZm9yIF9lbF8uXG4qKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihlbCkge1xuXHR2YXIgZG9jID0gZG9jdW1lbnQsXG5cdFx0d2luID0gd2luZG93LFxuXHRcdGJvZHkgPSBkb2MuYm9keSxcblxuXHRcdC8vIHBhZ2VYT2Zmc2V0IGFuZCBwYWdlWU9mZnNldCB3b3JrIGV2ZXJ5d2hlcmUgZXhjZXB0IElFIDw5LlxuXHRcdG9mZnNldFggPSB3aW4ucGFnZVhPZmZzZXQgIT09IHVuZGVmaW5lZCA/IHdpbi5wYWdlWE9mZnNldCA6XG5cdFx0KGRvYy5kb2N1bWVudEVsZW1lbnQgfHwgYm9keS5wYXJlbnROb2RlIHx8IGJvZHkpLnNjcm9sbExlZnQsXG5cdFx0b2Zmc2V0WSA9IHdpbi5wYWdlWU9mZnNldCAhPT0gdW5kZWZpbmVkID8gd2luLnBhZ2VZT2Zmc2V0IDpcblx0XHQoZG9jLmRvY3VtZW50RWxlbWVudCB8fCBib2R5LnBhcmVudE5vZGUgfHwgYm9keSkuc2Nyb2xsVG9wLFxuXG5cdFx0cmVjdCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG5cdGlmIChlbCAhPT0gYm9keSkge1xuXHRcdHZhciBwYXJlbnQgPSBlbC5wYXJlbnROb2RlO1xuXG5cdFx0Ly8gVGhlIGVsZW1lbnQncyByZWN0IHdpbGwgYmUgYWZmZWN0ZWQgYnkgdGhlIHNjcm9sbCBwb3NpdGlvbnMgb2Zcblx0XHQvLyAqYWxsKiBvZiBpdHMgc2Nyb2xsYWJsZSBwYXJlbnRzLCBub3QganVzdCB0aGUgd2luZG93LCBzbyB3ZSBoYXZlXG5cdFx0Ly8gdG8gd2FsayB1cCB0aGUgdHJlZSBhbmQgY29sbGVjdCBldmVyeSBzY3JvbGwgb2Zmc2V0LiBHb29kIHRpbWVzLlxuXHRcdHdoaWxlIChwYXJlbnQgIT09IG51bGwgJiYgcGFyZW50ICE9PSBib2R5KSB7XG5cdFx0XHRvZmZzZXRYICs9IHBhcmVudC5zY3JvbGxMZWZ0O1xuXHRcdFx0b2Zmc2V0WSArPSBwYXJlbnQuc2Nyb2xsVG9wO1xuXHRcdFx0cGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGU7XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIHtcblx0XHRfc3JjOiByZWN0LFxuXHRcdGJvdHRvbTogcmVjdC5ib3R0b20gKyBvZmZzZXRZLFxuXHRcdGhlaWdodDogcmVjdC5oZWlnaHQsXG5cdFx0bGVmdDogcmVjdC5sZWZ0ICsgb2Zmc2V0WCxcblx0XHRyaWdodDogcmVjdC5yaWdodCArIG9mZnNldFgsXG5cdFx0dG9wOiByZWN0LnRvcCArIG9mZnNldFksXG5cdFx0d2lkdGg6IHJlY3Qud2lkdGhcblx0fTtcbn07IiwiLyoqXG4gKiBAcGFyYW0ge251bWJlcn0gaSBjdXJyZW50IGl0ZXJhdGlvblxuICogQHBhcmFtIHtudW1iZXJ9IHMgc3RhcnQgdmFsdWVcbiAqIEBwYXJhbSB7bnVtYmVyfSBkIGNoYW5nZSBpbiB2YWx1ZVxuICogQHBhcmFtIHtudW1iZXJ9IHQgdG90YWwgaXRlcmF0aW9uc1xuICogQHJldHVybiB7bnVtYmVyfVxuICovXG52YXIgbGluZWFyID0gZnVuY3Rpb24oaSwgcywgZCwgdCkge1xuXHRyZXR1cm4gZCAqIGkgLyB0ICsgcztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gbGluZWFyO1xuIiwiLyogaHR0cHM6Ly9odG1sLnNwZWMud2hhdHdnLm9yZy9tdWx0aXBhZ2UvbWVkaWEuaHRtbCNldmVudC1tZWRpYS1jYW5wbGF5XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gW1xuXHQvLyBuZXR3b3JrU3RhdGVcblx0XCJsb2Fkc3RhcnRcIixcblx0XCJwcm9ncmVzc1wiLFxuXHRcInN1c3BlbmRcIixcblx0XCJhYm9ydFwiLFxuXHRcImVycm9yXCIsXG5cdFwiZW1wdGllZFwiLFxuXHRcInN0YWxsZWRcIixcblx0Ly8gcmVhZHlTdGF0ZVxuXHRcImxvYWRlZG1ldGFkYXRhXCIsXG5cdFwibG9hZGVkZGF0YVwiLFxuXHRcImNhbnBsYXlcIixcblx0XCJjYW5wbGF5dGhyb3VnaFwiLFxuXHRcInBsYXlpbmdcIixcblx0XCJ3YWl0aW5nXCIsXG5cdC8vXG5cdFwic2Vla2luZ1wiLCAvLyBzZWVraW5nIGNoYW5nZWQgdG8gdHJ1ZVxuXHRcInNlZWtlZFwiLCAvLyBzZWVraW5nIGNoYW5nZWQgdG8gZmFsc2Vcblx0XCJlbmRlZFwiLCAvLyBlbmRlZCBpcyB0cnVlXG5cdC8vXG5cdFwiZHVyYXRpb25jaGFuZ2VcIiwgLy8gZHVyYXRpb24gdXBkYXRlZFxuXHRcInRpbWV1cGRhdGVcIiwgLy8gY3VycmVudFRpbWUgdXBkYXRlZFxuXHRcInBsYXlcIiwgLy8gcGF1c2VkIGlzIGZhbHNlXG5cdFwicGF1c2VcIiwgLy8gcGF1c2VkIGlzIGZhbHNlXG5cdFwicGF1c2VkXCIsIC8vID8/XG5cdFwicmF0ZWNoYW5nZVwiLFxuXHQvL1xuXHRcInJlc2l6ZVwiLFxuXHRcInZvbHVtZWNoYW5nZVwiLFxuXTsiLCIvKipcbiAqIEBtb2R1bGUgYXBwL3ZpZXcvY29tcG9uZW50L0dyYXBoVmlld1xuICovXG5cbi8vIC8qKiBAdHlwZSB7bW9kdWxlOnVuZGVyc2NvcmV9ICovXG4vLyB2YXIgXyA9IHJlcXVpcmUoXCJ1bmRlcnNjb3JlXCIpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHJlY3QsIGR4LCBkeSkge1xuXHRkeSB8fCAoZHkgPSBkeCk7XG5cdHZhciByID0ge1xuXHRcdHdpZHRoOiByZWN0LndpZHRoICsgZHggKiAyLFxuXHRcdGhlaWdodDogcmVjdC5oZWlnaHQgKyBkeSAqIDJcblx0fTtcblx0aWYgKHIud2lkdGggPj0gMCkge1xuXHRcdHIubGVmdCA9IHJlY3QubGVmdCAtIGR4O1xuXHRcdHIucmlnaHQgPSByLmxlZnQgKyByLndpZHRoO1xuXHRcdHIueCA9IHIubGVmdDtcblx0fSBlbHNlIHtcblx0XHRyLnJpZ2h0ID0gcmVjdC5yaWdodCArIGR4O1xuXHRcdHIubGVmdCA9IHJlY3QucmlnaHQgLSByLndpZHRoO1xuXHRcdHIueSA9IHIucmlnaHQ7XG5cdH1cblx0aWYgKHIuaGVpZ2h0ID49IDApIHtcblx0XHRyLnRvcCA9IHJlY3QudG9wIC0gZHk7XG5cdFx0ci5ib3R0b20gPSByLnRvcCArIHIuaGVpZ2h0O1xuXHRcdHIueSA9IHIudG9wO1xuXHR9IGVsc2Uge1xuXHRcdHIuYm90dG9tID0gcmVjdC5ib3R0b20gKyBkeTtcblx0XHRyLnRvcCA9IHJlY3QuYm90dG9tIC0gci5oZWlnaHQ7XG5cdFx0ci55ID0gci5ib3R0b207XG5cdH1cblxuXHRyZXR1cm4gcjtcbn07XG4iLCIvKiogQHR5cGUge0FycmF5fSBsb3dlcmNhc2UgcHJlZml4ZXMgKi9cbnZhciBsY1ByZWZpeGVzID0gW1wiXCJdLmNvbmNhdChyZXF1aXJlKFwiLi9wcmVmaXhlc1wiKSk7XG5cbi8qKiBAdHlwZSB7QXJyYXl9IGNhcGl0YWxpemVkIHByZWZpeGVzICovXG52YXIgdWNQcmVmaXhlcyA9IGxjUHJlZml4ZXMubWFwKGZ1bmN0aW9uKHMpIHtcblx0cmV0dXJuIChzID09PSBcIlwiKSA/IHMgOiBzLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgcy5zdWJzdHIoMSk7XG59KTtcblxuLyoqIEB0eXBlIHtPYmplY3R9IHNwZWNpZmljIGV2ZW50IHNvbHZlcnMgKi9cbnZhciBfc29sdmVycyA9IHt9O1xuXG4vKiogQHR5cGUge09iamVjdH0gY2FjaGVkIHZhbHVlcyAqL1xudmFyIF9jYWNoZSA9IHt9O1xuXG4vKipcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIFVucHJlZml4ZWQgZXZlbnQgbmFtZVxuICogQHBhcmFtIHs/T2JqZWN0fSBvYmogUHJlZml4IHRlc3QgdGFyZ2V0XG4gKiBAcGFyYW0gez9TdHJpbmd9IHRlc3RQcm9wIFByb3h5IHByb3BlcnR5IHRvIHRlc3QgcHJlZml4ZXNcbiAqIEByZXR1cm4ge1N0cmluZ3xudWxsfVxuICovXG52YXIgX3ByZWZpeGVkRXZlbnQgPSBmdW5jdGlvbihuYW1lLCBvYmosIHRlc3RQcm9wKSB7XG5cdHZhciBwcmVmaXhlcyA9IC9eW0EtWl0vLnRlc3QobmFtZSkgPyB1Y1ByZWZpeGVzIDogbGNQcmVmaXhlcztcblx0b2JqIHx8IChvYmogPSBkb2N1bWVudCk7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpKyspIHtcblx0XHRpZiAodGVzdFByb3ApIHtcblx0XHRcdGlmICgocHJlZml4ZXNbaV0gKyB0ZXN0UHJvcCkgaW4gb2JqKSB7XG5cdFx0XHRcdHJldHVybiBwcmVmaXhlc1tpXSArIG5hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmICgoXCJvblwiICsgcHJlZml4ZXNbaV0gKyBuYW1lKSBpbiBvYmopIHtcblx0XHRcdHJldHVybiBwcmVmaXhlc1tpXSArIG5hbWU7XG5cdFx0fVxuXHR9XG5cdHJldHVybiBudWxsO1xufTtcblxuLy8gdHJhbnNpdGlvbmVuZFxuX3NvbHZlcnNbXCJ0cmFuc2l0aW9uZW5kXCJdID0gZnVuY3Rpb24oKSB7XG5cdHZhciBwcm9wLCBzdHlsZSA9IGRvY3VtZW50LmJvZHkuc3R5bGUsXG5cdFx0bWFwID0ge1xuXHRcdFx0XCJ0cmFuc2l0aW9uXCI6IFwidHJhbnNpdGlvbmVuZFwiLFxuXHRcdFx0XCJXZWJraXRUcmFuc2l0aW9uXCI6IFwid2Via2l0VHJhbnNpdGlvbkVuZFwiLFxuXHRcdFx0XCJNb3pUcmFuc2l0aW9uXCI6IFwidHJhbnNpdGlvbmVuZFwiLFxuXHRcdFx0Ly8gXCJtc1RyYW5zaXRpb25cIiA6IFwiTVNUcmFuc2l0aW9uRW5kXCIsXG5cdFx0XHRcIk9UcmFuc2l0aW9uXCI6IFwib1RyYW5zaXRpb25FbmRcIlxuXHRcdH07XG5cdGZvciAocHJvcCBpbiBtYXApIHtcblx0XHRpZiAocHJvcCBpbiBzdHlsZSkge1xuXHRcdFx0cmV0dXJuIG1hcFtwcm9wXTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIG51bGw7XG59O1xuXG4vKipcbiAqIGdldCB0aGUgcHJlZml4ZWQgcHJvcGVydHlcbiAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wZXJ0eSBuYW1lXG4gKiBAcGFyYW0ge09iamVjdH0gbG9vay11cCBvYmplY3RcbiAqIEByZXR1cm5zIHtTdHJpbmd8bnVsbH0gcHJlZml4ZWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihldk5hbWUpIHtcblx0aWYgKCFfY2FjaGUuaGFzT3duUHJvcGVydHkoZXZOYW1lKSkge1xuXHRcdF9jYWNoZVtldk5hbWVdID0gX3NvbHZlcnMuaGFzT3duUHJvcGVydHkoZXZOYW1lKSA/IF9zb2x2ZXJzW2V2TmFtZV0oKSA6IF9wcmVmaXhlZEV2ZW50LmFwcGx5KG51bGwsIGFyZ3VtZW50cyk7XG5cdFx0aWYgKF9jYWNoZVtldk5hbWVdID09PSBudWxsKSB7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJFdmVudCAnJXMnIG5vdCBmb3VuZFwiLCBldk5hbWUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50ICclcycgZm91bmQgYXMgJyVzJ1wiLCBldk5hbWUsIF9jYWNoZVtldk5hbWVdKTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIF9jYWNoZVtldk5hbWVdO1xuXHQvLyByZXR1cm4gX2NhY2hlW2V2TmFtZV0gfHwgKF9jYWNoZVtldk5hbWVdID0gX3NvbHZlcnNbZXZOYW1lXT8gX3NvbHZlcnNbZXZOYW1lXS5jYWxsKCkgOiBfcHJlZml4ZWRQcm9wZXJ0eS5hcHBseShudWxsLCBhcmd1bWVudHMpKTtcbn07XG5cbi8qXG52YXIgZGVmYXVsdFRlc3QgPSBmdW5jdGlvbihuYW1lLCBvYmopIHtcblx0dmFyIHByZWZpeGVzID0gL15bQS1aXS8udGVzdChuYW1lKT8gdWNQcmVmaXhlcyA6IGxjUHJlZml4ZXM7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgcHJlZml4ZXMubGVuZ3RoOyBpKyspIHtcblx0XHRpZiAoKFwib25cIiArIHByZWZpeGVzW2ldICsgbmFtZSkgaW4gb2JqKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50ICclcycgZm91bmQgYXMgJyVzJ1wiLCBuYW1lLCBwcmVmaXhlc1tpXSArIG5hbWUpO1xuXHRcdFx0cmV0dXJuIHByZWZpeGVzW2ldICsgbmFtZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIG51bGw7XG59O1xuXG52YXIgcHJveHlUZXN0ID0gZnVuY3Rpb24obmFtZSwgb2JqLCB0ZXN0UHJvcCkge1xuXHR2YXIgcHJlZml4ZXMgPSAvXltBLVpdLy50ZXN0KG5hbWUpPyB1Y1ByZWZpeGVzIDogbGNQcmVmaXhlcztcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBwcmVmaXhlcy5sZW5ndGg7IGkrKykge1xuXHRcdGlmICgocHJlZml4ZXNbaV0gKyB0ZXN0UHJvcCkgaW4gb2JqKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIkV2ZW50ICVzIGluZmVycmVkIGFzICclcycgZnJvbSBwcm9wZXJ0eSAnJXMnXCIsIG5hbWUsIHByZWZpeGVzW2ldICsgbmFtZSwgdGVzdFByb3ApO1xuXHRcdFx0cmV0dXJuIHByZWZpeGVzW2ldICsgbmFtZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIG51bGw7XG59O1xuKi9cbiIsIi8qKlxuLyogQG1vZHVsZSB1dGlscy9wcmVmaXhlZFByb3BlcnR5XG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZXN9ICovXG52YXIgcHJlZml4ZXMgPSByZXF1aXJlKFwiLi9wcmVmaXhlc1wiKTtcbi8qKiBAdHlwZSB7TnVtYmVyfSBwcmVmaXggY291bnQgKi9cbnZhciBfcHJlZml4TnVtID0gcHJlZml4ZXMubGVuZ3RoO1xuLyoqIEB0eXBlIHtBcnJheX0gY2FjaGVkIHZhbHVlcyAqL1xudmFyIF9jYWNoZSA9IHt9O1xuXG52YXIgX3ByZWZpeGVkUHJvcGVydHkgPSBmdW5jdGlvbihwcm9wLCBvYmopIHtcblx0dmFyIHByZWZpeGVkUHJvcCwgY2FtZWxQcm9wO1xuXG5cdGlmIChwcm9wIGluIG9iaikge1xuXHRcdGNvbnNvbGUubG9nKFwiUHJvcGVydHkgJyVzJyBmb3VuZCB1bnByZWZpeGVkXCIsIHByb3ApO1xuXHRcdHJldHVybiBwcm9wO1xuXHR9XG5cdGNhbWVsUHJvcCA9IHByb3BbMF0udG9VcHBlckNhc2UoKSArIHByb3Auc2xpY2UoMSk7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgX3ByZWZpeE51bTsgaSsrKSB7XG5cdFx0cHJlZml4ZWRQcm9wID0gcHJlZml4ZXNbaV0gKyBjYW1lbFByb3A7XG5cdFx0aWYgKHByZWZpeGVkUHJvcCBpbiBvYmopIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiUHJvcGVydHkgJyVzJyBmb3VuZCBhcyAnJXMnXCIsIHByb3AsIHByZWZpeGVkUHJvcCk7XG5cdFx0XHRyZXR1cm4gcHJlZml4ZWRQcm9wO1xuXHRcdH1cblx0fVxuXHRjb25zb2xlLmVycm9yKFwiUHJvcGVydHkgJyVzJyBub3QgZm91bmRcIiwgcHJvcCk7XG5cdHJldHVybiBudWxsO1xufTtcblxuLyoqXG4gKiBnZXQgdGhlIHByZWZpeGVkIHByb3BlcnR5XG4gKiBAcGFyYW0ge1N0cmluZ30gcHJvcGVydHkgbmFtZVxuICogQHBhcmFtIHtPYmplY3R9IGxvb2stdXAgb2JqZWN0XG4gKiBAcmV0dXJucyB7U3RyaW5nfG51bGx9IHByZWZpeGVkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocHJvcCwgb2JqKSB7XG5cdHJldHVybiBfY2FjaGVbcHJvcF0gfHwgKF9jYWNoZVtwcm9wXSA9IF9wcmVmaXhlZFByb3BlcnR5KHByb3AsIG9iaiB8fCBkb2N1bWVudC5ib2R5LnN0eWxlKSk7XG59O1xuIiwiLyoqXG4vKiBAbW9kdWxlIHV0aWxzL3ByZWZpeGVkU3R5bGVOYW1lXG4vKi9cblxuLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvcHJlZml4ZXN9ICovXG52YXIgcHJlZml4ZXMgPSByZXF1aXJlKFwiLi9wcmVmaXhlc1wiKTsgLy8ubWFwKGZ1bmN0aW9uKHByZWZpeCkgeyByZXR1cm4gXCItXCIgKyBwcmVmaXggKyBcIi1cIjsgfSk7XG4vKiogQHR5cGUge051bWJlcn0gcHJlZml4IGNvdW50ICovXG52YXIgX3ByZWZpeE51bSA9IHByZWZpeGVzLmxlbmd0aDtcbi8qKiBAdHlwZSB7QXJyYXl9IGNhY2hlZCB2YWx1ZXMgKi9cbnZhciBfY2FjaGUgPSB7fTtcblxudmFyIF9wcmVmaXhlZFN0eWxlTmFtZSA9IGZ1bmN0aW9uKHN0eWxlLCBzdHlsZU9iaikge1xuXHR2YXIgcHJlZml4ZWRTdHlsZTtcblxuXHRpZiAoc3R5bGUgaW4gc3R5bGVPYmopIHtcblx0XHRjb25zb2xlLmxvZyhcIkNTUyBzdHlsZSAnJXMnIGZvdW5kIHVucHJlZml4ZWRcIiwgc3R5bGUpO1xuXHRcdHJldHVybiBzdHlsZTtcblx0fVxuXHRmb3IgKHZhciBpID0gMDsgaSA8IF9wcmVmaXhOdW07IGkrKykge1xuXHRcdHByZWZpeGVkU3R5bGUgPSBcIi1cIiArIHByZWZpeGVzW2ldICsgXCItXCIgKyBzdHlsZTtcblx0XHQvLyBwcmVmaXhlZFN0eWxlID0gcHJlZml4ZXNbaV0gKyBzdHlsZTtcblx0XHRpZiAocHJlZml4ZWRTdHlsZSBpbiBzdHlsZU9iaikge1xuXHRcdFx0Y29uc29sZS5sb2coXCJDU1Mgc3R5bGUgJyVzJyBmb3VuZCBhcyAnJXMnXCIsIHN0eWxlLCBwcmVmaXhlZFN0eWxlKTtcblx0XHRcdHJldHVybiBwcmVmaXhlZFN0eWxlO1xuXHRcdH1cblx0fVxuXHRjb25zb2xlLndhcm4oXCJDU1Mgc3R5bGUgJyVzJyBub3QgZm91bmRcIiwgc3R5bGUpO1xuXHRyZXR1cm4gbnVsbDtcbn07XG5cbi8qKlxuICogZ2V0IHRoZSBwcmVmaXhlZCBzdHlsZSBuYW1lXG4gKiBAcGFyYW0ge1N0cmluZ30gc3R5bGUgbmFtZVxuICogQHBhcmFtIHtPYmplY3R9IGxvb2stdXAgc3R5bGUgb2JqZWN0XG4gKiBAcmV0dXJucyB7U3RyaW5nfFVuZGVmaW5lZH0gcHJlZml4ZWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbihzdHlsZSwgc3R5bGVPYmopIHtcblx0Ly8gcmV0dXJuIF9jYWNoZVtzdHlsZV0gfHwgKF9jYWNoZVtzdHlsZV0gPSBfcHJlZml4ZWRTdHlsZU5hbWVfcmV2ZXJzZShzdHlsZSwgc3R5bGVPYmogfHwgZG9jdW1lbnQuYm9keS5zdHlsZSkpO1xuXHRyZXR1cm4gX2NhY2hlW3N0eWxlXSB8fCAoX2NhY2hlW3N0eWxlXSA9IF9wcmVmaXhlZFN0eWxlTmFtZShzdHlsZSwgc3R5bGVPYmogfHwgZG9jdW1lbnQuYm9keS5zdHlsZSkpO1xufTtcblxuLy8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvc3RyaW5ncy9jYW1lbFRvRGFzaGVkfSAqL1xuLy8gdmFyIGNhbWVsVG9EYXNoZWQgPSByZXF1aXJlKFwiLi9zdHJpbmdzL2NhbWVsVG9EYXNoZWRcIik7XG4vLyAvKiogQHR5cGUge21vZHVsZTp1dGlscy9wcmVmaXhlZFByb3BlcnR5fSAqL1xuLy8gdmFyIHByZWZpeGVkUHJvcGVydHkgPSByZXF1aXJlKFwiLi9wcmVmaXhlZFByb3BlcnR5XCIpO1xuLy8gLyoqIEB0eXBlIHttb2R1bGU6dXRpbHMvc3RyaW5ncy9kYXNoZWRUb0NhbWVsfSAqL1xuLy8gdmFyIGRhc2hlZFRvQ2FtZWwgPSByZXF1aXJlKFwiLi9zdHJpbmdzL2Rhc2hlZFRvQ2FtZWxcIik7XG4vL1xuLy8gdmFyIF9wcmVmaXhlZFN0eWxlTmFtZV9yZXZlcnNlID0gZnVuY3Rpb24gKHN0eWxlLCBzdHlsZU9iaikge1xuLy8gXHR2YXIgY2FtZWxQcm9wLCBwcmVmaXhlZFByb3A7XG4vLyBcdGNhbWVsUHJvcCA9IGRhc2hlZFRvQ2FtZWwoc3R5bGUpO1xuLy8gXHRwcmVmaXhlZFByb3AgPSBwcmVmaXhlZFByb3BlcnR5KGNhbWVsUHJvcCwgc3R5bGVPYmopO1xuLy8gXHRyZXR1cm4gcHJlZml4ZWRQcm9wPyAoY2FtZWxQcm9wID09PSBwcmVmaXhlZFByb3A/IFwiXCIgOiBcIi1cIikgKyBjYW1lbFRvRGFzaGVkKHByZWZpeGVkUHJvcCkgOiBudWxsO1xuLy8gfTtcbiIsIm1vZHVsZS5leHBvcnRzID0gW1wid2Via2l0XCIsIFwibW96XCIsIFwibXNcIiwgXCJvXCJdO1xuIiwiLyoganNoaW50IGlnbm9yZTpzdGFydCAqL1xuLypcblRha2VuIGZyb206XG5odHRwczovL2dpdGh1Yi5jb20vd2ViY29tcG9uZW50cy93ZWJjb21wb25lbnRzanMvYmxvYi9tYXN0ZXIvc3JjL011dGF0aW9uT2JzZXJ2ZXIvTXV0YXRpb25PYnNlcnZlci5qc1xuKi9cbi8qXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IChjKSAyMDE0IFRoZSBQb2x5bWVyIFByb2plY3QgQXV0aG9ycy4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqIFRoaXMgY29kZSBtYXkgb25seSBiZSB1c2VkIHVuZGVyIHRoZSBCU0Qgc3R5bGUgbGljZW5zZSBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vTElDRU5TRS50eHRcbiAqIFRoZSBjb21wbGV0ZSBzZXQgb2YgYXV0aG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0FVVEhPUlMudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGNvbnRyaWJ1dG9ycyBtYXkgYmUgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0NPTlRSSUJVVE9SUy50eHRcbiAqIENvZGUgZGlzdHJpYnV0ZWQgYnkgR29vZ2xlIGFzIHBhcnQgb2YgdGhlIHBvbHltZXIgcHJvamVjdCBpcyBhbHNvXG4gKiBzdWJqZWN0IHRvIGFuIGFkZGl0aW9uYWwgSVAgcmlnaHRzIGdyYW50IGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9QQVRFTlRTLnR4dFxuICovXG5cbnZhciBzZXRJbW1lZGlhdGU7XG5cbi8vIEFzIG11Y2ggYXMgd2Ugd291bGQgbGlrZSB0byB1c2UgdGhlIG5hdGl2ZSBpbXBsZW1lbnRhdGlvbiwgSUVcbi8vIChhbGwgdmVyc2lvbnMpIHN1ZmZlcnMgYSByYXRoZXIgYW5ub3lpbmcgYnVnIHdoZXJlIGl0IHdpbGwgZHJvcCBvciBkZWZlclxuLy8gY2FsbGJhY2tzIHdoZW4gaGVhdnkgRE9NIG9wZXJhdGlvbnMgYXJlIGJlaW5nIHBlcmZvcm1lZCBjb25jdXJyZW50bHkuXG4vL1xuLy8gRm9yIGEgdGhvcm91Z2ggZGlzY3Vzc2lvbiBvbiB0aGlzLCBzZWU6XG4vLyBodHRwOi8vY29kZWZvcmhpcmUuY29tLzIwMTMvMDkvMjEvc2V0aW1tZWRpYXRlLWFuZC1tZXNzYWdlY2hhbm5lbC1icm9rZW4tb24taW50ZXJuZXQtZXhwbG9yZXItMTAvXG5pZiAoL1RyaWRlbnR8RWRnZS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuXHQvLyBTYWRseSwgdGhpcyBidWcgYWxzbyBhZmZlY3RzIHBvc3RNZXNzYWdlIGFuZCBNZXNzYWdlUXVldWVzLlxuXHQvL1xuXHQvLyBXZSB3b3VsZCBsaWtlIHRvIHVzZSB0aGUgb25yZWFkeXN0YXRlY2hhbmdlIGhhY2sgZm9yIElFIDw9IDEwLCBidXQgaXQgaXNcblx0Ly8gZGFuZ2Vyb3VzIGluIHRoZSBwb2x5ZmlsbGVkIGVudmlyb25tZW50IGR1ZSB0byByZXF1aXJpbmcgdGhhdCB0aGVcblx0Ly8gb2JzZXJ2ZWQgc2NyaXB0IGVsZW1lbnQgYmUgaW4gdGhlIGRvY3VtZW50LlxuXHRzZXRJbW1lZGlhdGUgPSBzZXRUaW1lb3V0O1xuXG5cdC8vIElmIHNvbWUgb3RoZXIgYnJvd3NlciBldmVyIGltcGxlbWVudHMgaXQsIGxldCdzIHByZWZlciB0aGVpciBuYXRpdmVcblx0Ly8gaW1wbGVtZW50YXRpb246XG59IGVsc2UgaWYgKHdpbmRvdy5zZXRJbW1lZGlhdGUpIHtcblx0c2V0SW1tZWRpYXRlID0gd2luZG93LnNldEltbWVkaWF0ZTtcblxuXHQvLyBPdGhlcndpc2UsIHdlIGZhbGwgYmFjayB0byBwb3N0TWVzc2FnZSBhcyBhIG1lYW5zIG9mIGVtdWxhdGluZyB0aGUgbmV4dFxuXHQvLyB0YXNrIHNlbWFudGljcyBvZiBzZXRJbW1lZGlhdGUuXG59IGVsc2Uge1xuXHR2YXIgc2V0SW1tZWRpYXRlUXVldWUgPSBbXTtcblx0dmFyIHNlbnRpbmVsID0gU3RyaW5nKE1hdGgucmFuZG9tKCkpO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgZnVuY3Rpb24oZSkge1xuXHRcdGlmIChlLmRhdGEgPT09IHNlbnRpbmVsKSB7XG5cdFx0XHR2YXIgcXVldWUgPSBzZXRJbW1lZGlhdGVRdWV1ZTtcblx0XHRcdHNldEltbWVkaWF0ZVF1ZXVlID0gW107XG5cdFx0XHRxdWV1ZS5mb3JFYWNoKGZ1bmN0aW9uKGZ1bmMpIHtcblx0XHRcdFx0ZnVuYygpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9KTtcblx0c2V0SW1tZWRpYXRlID0gZnVuY3Rpb24oZnVuYykge1xuXHRcdHNldEltbWVkaWF0ZVF1ZXVlLnB1c2goZnVuYyk7XG5cdFx0d2luZG93LnBvc3RNZXNzYWdlKHNlbnRpbmVsLCBcIipcIik7XG5cdH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gc2V0SW1tZWRpYXRlO1xuLyoganNoaW50IGlnbm9yZTplbmQgKi9cbiIsIm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oc3RyKSB7XG5cdHJldHVybiBzdHIucmVwbGFjZSgvW0EtWl0vZywgZnVuY3Rpb24oJDApIHtcblx0XHRyZXR1cm4gXCItXCIgKyAkMC50b0xvd2VyQ2FzZSgpO1xuXHR9KTtcbn07XG4iLCJtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKHMpIHtcblx0cmV0dXJuIHMucmVwbGFjZSgvPFtePl0rPi9nLCBcIlwiKTtcbn07XG4iLCIvKiogQHR5cGUge21vZHVsZTpoYW1tZXJqc30gKi9cbnZhciBIYW1tZXIgPSByZXF1aXJlKFwiaGFtbWVyanNcIik7XG5cbi8vIC8qKlxuLy8gICogZ2V0IGEgdXNhYmxlIHN0cmluZywgdXNlZCBhcyBldmVudCBwb3N0Zml4XG4vLyAgKiBAcGFyYW0ge0NvbnN0fSBzdGF0ZVxuLy8gICogQHJldHVybnMge1N0cmluZ30gc3RhdGVcbi8vICAqL1xuLy8gZnVuY3Rpb24gc3RhdGVTdHIoc3RhdGUpIHtcbi8vIFx0aWYgKHN0YXRlICYgSGFtbWVyLlNUQVRFX0NBTkNFTExFRCkge1xuLy8gXHRcdHJldHVybiBcImNhbmNlbFwiO1xuLy8gXHR9IGVsc2UgaWYgKHN0YXRlICYgSGFtbWVyLlNUQVRFX0VOREVEKSB7XG4vLyBcdFx0cmV0dXJuIFwiZW5kXCI7XG4vLyBcdH0gZWxzZSBpZiAoc3RhdGUgJiBIYW1tZXIuU1RBVEVfQ0hBTkdFRCkge1xuLy8gXHRcdHJldHVybiBcIm1vdmVcIjtcbi8vIFx0fSBlbHNlIGlmIChzdGF0ZSAmIEhhbW1lci5TVEFURV9CRUdBTikge1xuLy8gXHRcdHJldHVybiBcInN0YXJ0XCI7XG4vLyBcdH1cbi8vIFx0cmV0dXJuIFwiXCI7XG4vLyB9XG5cbi8qKlxuICogZGlyZWN0aW9uIGNvbnMgdG8gc3RyaW5nXG4gKiBAcGFyYW0ge0NvbnN0fSBkaXJlY3Rpb25cbiAqIEByZXR1cm5zIHtTdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGRpclN0cihkaXJlY3Rpb24pIHtcblx0aWYgKGRpcmVjdGlvbiA9PSBIYW1tZXIuRElSRUNUSU9OX0RPV04pIHtcblx0XHRyZXR1cm4gXCJkb3duXCI7XG5cdH0gZWxzZSBpZiAoZGlyZWN0aW9uID09IEhhbW1lci5ESVJFQ1RJT05fVVApIHtcblx0XHRyZXR1cm4gXCJ1cFwiO1xuXHR9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PSBIYW1tZXIuRElSRUNUSU9OX0xFRlQpIHtcblx0XHRyZXR1cm4gXCJsZWZ0XCI7XG5cdH0gZWxzZSBpZiAoZGlyZWN0aW9uID09IEhhbW1lci5ESVJFQ1RJT05fUklHSFQpIHtcblx0XHRyZXR1cm4gXCJyaWdodFwiO1xuXHR9XG5cdHJldHVybiBcIlwiO1xufVxuXG4vLy8qKlxuLy8gKiBQYW5cbi8vICogUmVjb2duaXplZCB3aGVuIHRoZSBwb2ludGVyIGlzIGRvd24gYW5kIG1vdmVkIGluIHRoZSBhbGxvd2VkIGRpcmVjdGlvbi5cbi8vICogQGNvbnN0cnVjdG9yXG4vLyAqIEBleHRlbmRzIEF0dHJSZWNvZ25pemVyXG4vLyAqL1xuLy9mdW5jdGlvbiBQYW5SZWNvZ25pemVyKCkge1xuLy9cdEhhbW1lci5BdHRyUmVjb2duaXplci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuLy9cbi8vXHR0aGlzLnBYID0gbnVsbDtcbi8vXHR0aGlzLnBZID0gbnVsbDtcbi8vfVxuLy9cbi8vaW5oZXJpdChQYW5SZWNvZ25pemVyLCBIYW1tZXIuQXR0clJlY29nbml6ZXIsIHtcbi8vXHQvKipcbi8vXHQvKiBAbmFtZXNwYWNlXG4vL1x0LyogQG1lbWJlcm9mIFBhblJlY29nbml6ZXJcbi8vXHQvKi9cbi8vXHRkZWZhdWx0czoge1xuLy9cdFx0ZXZlbnQ6IFwicGFuXCIsXG4vL1x0XHR0aHJlc2hvbGQ6IDEwLFxuLy9cdFx0cG9pbnRlcnM6IDEsXG4vL1x0XHRkaXJlY3Rpb246IERJUkVDVElPTl9BTExcbi8vXHR9LFxuLy9cbi8vXHRnZXRUb3VjaEFjdGlvbjogZnVuY3Rpb24oKSB7XG4vL1x0XHR2YXIgZGlyZWN0aW9uID0gdGhpcy5vcHRpb25zLmRpcmVjdGlvbjtcbi8vXHRcdHZhciBhY3Rpb25zID0gW107XG4vL1x0XHRpZiAoZGlyZWN0aW9uICYgRElSRUNUSU9OX0hPUklaT05UQUwpIHtcbi8vXHRcdFx0YWN0aW9ucy5wdXNoKFRPVUNIX0FDVElPTl9QQU5fWSk7XG4vL1x0XHR9XG4vL1x0XHRpZiAoZGlyZWN0aW9uICYgRElSRUNUSU9OX1ZFUlRJQ0FMKSB7XG4vL1x0XHRcdGFjdGlvbnMucHVzaChUT1VDSF9BQ1RJT05fUEFOX1gpO1xuLy9cdFx0fVxuLy9cdFx0cmV0dXJuIGFjdGlvbnM7XG4vL1x0fSxcbi8vXG4vL1x0ZGlyZWN0aW9uVGVzdDogZnVuY3Rpb24oaW5wdXQpIHtcbi8vXHRcdHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zO1xuLy9cdFx0dmFyIGhhc01vdmVkID0gdHJ1ZTtcbi8vXHRcdHZhciBkaXN0YW5jZSA9IGlucHV0LmRpc3RhbmNlO1xuLy9cdFx0dmFyIGRpcmVjdGlvbiA9IGlucHV0LmRpcmVjdGlvbjtcbi8vXHRcdHZhciB4ID0gaW5wdXQuZGVsdGFYO1xuLy9cdFx0dmFyIHkgPSBpbnB1dC5kZWx0YVk7XG4vL1xuLy9cdFx0Ly8gbG9jayB0byBheGlzP1xuLy9cdFx0aWYgKCEoZGlyZWN0aW9uICYgb3B0aW9ucy5kaXJlY3Rpb24pKSB7XG4vL1x0XHRcdGlmIChvcHRpb25zLmRpcmVjdGlvbiAmIERJUkVDVElPTl9IT1JJWk9OVEFMKSB7XG4vL1x0XHRcdFx0ZGlyZWN0aW9uID0gKHggPT09IDApID8gRElSRUNUSU9OX05PTkUgOiAoeCA8IDApID8gRElSRUNUSU9OX0xFRlQgOiBESVJFQ1RJT05fUklHSFQ7XG4vL1x0XHRcdFx0aGFzTW92ZWQgPSB4ICE9IHRoaXMucFg7XG4vL1x0XHRcdFx0ZGlzdGFuY2UgPSBNYXRoLmFicyhpbnB1dC5kZWx0YVgpO1xuLy9cdFx0XHR9IGVsc2Uge1xuLy9cdFx0XHRcdGRpcmVjdGlvbiA9ICh5ID09PSAwKSA/IERJUkVDVElPTl9OT05FIDogKHkgPCAwKSA/IERJUkVDVElPTl9VUCA6IERJUkVDVElPTl9ET1dOO1xuLy9cdFx0XHRcdGhhc01vdmVkID0geSAhPSB0aGlzLnBZO1xuLy9cdFx0XHRcdGRpc3RhbmNlID0gTWF0aC5hYnMoaW5wdXQuZGVsdGFZKTtcbi8vXHRcdFx0fVxuLy9cdFx0fVxuLy9cdFx0aW5wdXQuZGlyZWN0aW9uID0gZGlyZWN0aW9uO1xuLy9cdFx0cmV0dXJuIGhhc01vdmVkICYmIGRpc3RhbmNlID4gb3B0aW9ucy50aHJlc2hvbGQgJiYgZGlyZWN0aW9uICYgb3B0aW9ucy5kaXJlY3Rpb247XG4vL1x0fSxcbi8vXG4vL1x0YXR0clRlc3Q6IGZ1bmN0aW9uKGlucHV0KSB7XG4vL1x0XHRyZXR1cm4gQXR0clJlY29nbml6ZXIucHJvdG90eXBlLmF0dHJUZXN0LmNhbGwodGhpcywgaW5wdXQpICYmXG4vL1x0XHRcdCh0aGlzLnN0YXRlICYgU1RBVEVfQkVHQU4gfHwgKCEodGhpcy5zdGF0ZSAmIFNUQVRFX0JFR0FOKSAmJiB0aGlzLmRpcmVjdGlvblRlc3QoaW5wdXQpKSk7XG4vL1x0fSxcbi8vXG4vL1x0ZW1pdDogZnVuY3Rpb24oaW5wdXQpIHtcbi8vXHRcdHRoaXMucFggPSBpbnB1dC5kZWx0YVg7XG4vL1x0XHR0aGlzLnBZID0gaW5wdXQuZGVsdGFZO1xuLy9cbi8vXHRcdHZhciBkaXJlY3Rpb24gPSBkaXJTdHIoaW5wdXQuZGlyZWN0aW9uKTtcbi8vXHRcdGlmIChkaXJlY3Rpb24pIHtcbi8vXHRcdFx0dGhpcy5tYW5hZ2VyLmVtaXQodGhpcy5vcHRpb25zLmV2ZW50ICsgZGlyZWN0aW9uLCBpbnB1dCk7XG4vL1x0XHR9XG4vL1xuLy9cdFx0dGhpcy5fc3VwZXIuZW1pdC5jYWxsKHRoaXMsIGlucHV0KTtcbi8vXHR9XG4vL30pO1xuXG4vKipcbiAqIFNtb290aFBhblxuICogQGNvbnN0cnVjdG9yXG4gKiBAZXh0ZW5kcyBIYW1tZXIuUGFuXG4gKi9cbmZ1bmN0aW9uIFNtb290aFBhbigpIHtcblx0dmFyIHJldCA9IEhhbW1lci5QYW4uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcblx0dGhpcy50aHJlc2hvbGRPZmZzZXRYID0gbnVsbDtcblx0dGhpcy50aHJlc2hvbGRPZmZzZXRZID0gbnVsbDtcblx0dGhpcy50aHJlc2hvbGRPZmZzZXQgPSBudWxsO1xuXHRyZXR1cm4gcmV0O1xufVxuXG5IYW1tZXIuaW5oZXJpdChTbW9vdGhQYW4sIEhhbW1lci5QYW4sIHtcblx0ZW1pdDogZnVuY3Rpb24oaW5wdXQpIHtcblx0XHQvLyBJbmhlcml0YW5jZSBicmVha3MsIHNvIHRoaXMgY29kZSBpcyB0YWtlbiBmcm9tIFBhblJlY29nbml6ZXIuZW1pdFxuXHRcdC8vXHR0aGlzLl9zdXBlci5lbWl0LmNhbGwodGhpcywgaW5wdXQpOyAvLyBUcmlnZ2VycyBpbmZpbml0ZSByZWN1cnNpb25cblx0XHQvL1x0SGFtbWVyLlBhbi5wcm90b3R5cGUuZW1pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyAvLyBUaGlzIGJyZWFrcyB0b29cblxuXHRcdHZhciB0aHJlc2hvbGQgPSB0aGlzLm9wdGlvbnMudGhyZXNob2xkO1xuXHRcdHZhciBkaXJlY3Rpb24gPSBpbnB1dC5kaXJlY3Rpb247XG5cblx0XHRpZiAodGhpcy5zdGF0ZSA9PSBIYW1tZXIuU1RBVEVfQkVHQU4pIHtcblx0XHRcdHRoaXMudGhyZXNob2xkT2Zmc2V0WCA9IChkaXJlY3Rpb24gJiBIYW1tZXIuRElSRUNUSU9OX0hPUklaT05UQUwpID8gKChkaXJlY3Rpb24gJiBIYW1tZXIuRElSRUNUSU9OX0xFRlQpID8gdGhyZXNob2xkIDogLXRocmVzaG9sZCkgOiAwO1xuXHRcdFx0dGhpcy50aHJlc2hvbGRPZmZzZXRZID0gKGRpcmVjdGlvbiAmIEhhbW1lci5ESVJFQ1RJT05fVkVSVElDQUwpID8gKChkaXJlY3Rpb24gJiBIYW1tZXIuRElSRUNUSU9OX1VQKSA/IHRocmVzaG9sZCA6IC10aHJlc2hvbGQpIDogMDtcblx0XHRcdC8vIHRoaXMudGhyZXNob2xkT2Zmc2V0ID0gKGRpcmVjdGlvbiAmIEhhbW1lci5ESVJFQ1RJT05fSE9SSVpPTlRBTCk/IGlucHV0LnRocmVzaG9sZE9mZnNldFggOiBpbnB1dC50aHJlc2hvbGRPZmZzZXRZO1xuXHRcdFx0Ly8gY29uc29sZS5sb2coXCJSRUNPR05JWkVSIFNUQVRFXCIsIGRpclN0cihkaXJlY3Rpb24pLCBzdGF0ZVN0cih0aGlzLnN0YXRlKSwgdGhpcy50aHJlc2hvbGRPZmZzZXRYKTtcblx0XHR9XG5cdFx0aW5wdXQudGhyZXNob2xkT2Zmc2V0WCA9IHRoaXMudGhyZXNob2xkT2Zmc2V0WDtcblx0XHRpbnB1dC50aHJlc2hvbGRPZmZzZXRZID0gdGhpcy50aHJlc2hvbGRPZmZzZXRZO1xuXHRcdGlucHV0LnRocmVzaG9sZERlbHRhWCA9IGlucHV0LmRlbHRhWCArIHRoaXMudGhyZXNob2xkT2Zmc2V0WDtcblx0XHRpbnB1dC50aHJlc2hvbGREZWx0YVkgPSBpbnB1dC5kZWx0YVkgKyB0aGlzLnRocmVzaG9sZE9mZnNldFk7XG5cblx0XHR0aGlzLnBYID0gaW5wdXQuZGVsdGFYO1xuXHRcdHRoaXMucFkgPSBpbnB1dC5kZWx0YVk7XG5cblx0XHRkaXJlY3Rpb24gPSBkaXJTdHIoZGlyZWN0aW9uKTtcblx0XHRpZiAoZGlyZWN0aW9uKSB7XG5cdFx0XHR0aGlzLm1hbmFnZXIuZW1pdCh0aGlzLm9wdGlvbnMuZXZlbnQgKyBkaXJlY3Rpb24sIGlucHV0KTtcblx0XHR9XG5cdFx0cmV0dXJuIEhhbW1lci5SZWNvZ25pemVyLnByb3RvdHlwZS5lbWl0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cdH1cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNtb290aFBhbjtcbiIsIm1vZHVsZS5leHBvcnRzPXtcblx0XCJ1bml0c1wiOiB7XG5cdFx0XCJodV9weFwiOiBcIjIwXCIsXG5cdFx0XCJ2dV9weFwiOiBcIjEyXCJcblx0fSxcblx0XCJ0cmFuc2l0aW9uc1wiOiB7XG5cdFx0XCJtaW5fZGVsYXlfbXNcIjogXCIzNFwiLFxuXHRcdFwiZGVsYXlfaW50ZXJ2YWxfbXNcIjogXCIxMzRcIixcblx0XHRcImR1cmF0aW9uX21zXCI6IFwiNDAwXCIsXG5cdFx0XCJlYXNlXCI6IFwiZWFzZVwiXG5cdH0sXG5cdFwiYnJlYWtwb2ludHNcIjoge1xuXHRcdFwiZnVsbHdpZHRoLXNtYWxsXCI6IFwiJ25vdCBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDQ2MHB4KSdcIixcblx0XHRcImZ1bGx3aWR0aFwiOiBcIidub3Qgc2NyZWVuIGFuZCAobWluLXdpZHRoOiA3MDRweCksIG5vdCBzY3JlZW4gYW5kIChtaW4taGVpZ2h0OiA1NDBweCknXCIsXG5cdFx0XCJkZXNrdG9wLXNtYWxsXCI6IFwiJ29ubHkgc2NyZWVuIGFuZCAobWluLXdpZHRoOiAxMDI0cHgpIGFuZCAobWluLWhlaWdodDogNTQwcHgpJ1wiLFxuXHRcdFwiZGVza3RvcC1tZWRpdW1cIjogXCInb25seSBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDEyMjRweCkgYW5kIChtaW4taGVpZ2h0OiA3MDRweCknXCIsXG5cdFx0XCJkZXNrdG9wLWxhcmdlXCI6IFwiJ29ubHkgc2NyZWVuIGFuZCAobWluLXdpZHRoOiAxODI0cHgpIGFuZCAobWluLWhlaWdodDogMTAyNHB4KSdcIlxuXHR9LFxuXHRcImRlZmF1bHRfY29sb3JzXCI6IHtcblx0XHRcImNvbG9yXCI6IFwiaHNsKDQ3LCA1JSwgMTUlKVwiLFxuXHRcdFwiYmFja2dyb3VuZC1jb2xvclwiOiBcImhzbCg0NywgNSUsIDk1JSlcIixcblx0XHRcIi0tbGluay1jb2xvclwiOiBcImhzbCgxMCwgODAlLCA1MCUpXCJcblx0fSxcblx0XCJ0ZW1wXCI6IHtcblx0XHRcImNvbGxhcHNlX29mZnNldFwiOiBcIjM2MFwiXG5cdH0sXG5cdFwiX2lnbm9yZVwiOiB7XG5cblx0XHRcImJyZWFrcG9pbnRzXCI6IHtcblx0XHRcdFwibW9iaWxlXCI6IFwiJ25vdCBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDcwNHB4KSwgbm90IHNjcmVlbiBhbmQgKG1pbi1oZWlnaHQ6IDU0MHB4KSdcIixcblx0XHRcdFwidW5zdXBwb3J0ZWRcIjogXCInbm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpJ1wiLFxuXHRcdFx0XCJ1bnF1b3RlZFwiOiBcIm9ubHkgc2NyZWVuIGFuZCAobWluLXdpZHRoOiAxODI0cHgpXCIsXG5cdFx0XHRcInVucXVvdGVkX25lZ1wiOiBcIm5vdCBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDcwNHB4KVwiLFxuXHRcdFx0XCJxdW90ZWRfY29tYmluZWRcIjogXCInbm90IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNzA0cHgpLCBub3Qgc2NyZWVuIGFuZCAobWluLWhlaWdodDogNTQwcHgpJ1wiLFxuXHRcdFx0XCJhcnJheVwiOiBbXG5cdFx0XHRcdFwib25seSBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDcwNHB4KVwiLFxuXHRcdFx0XHRcIm5vdCBzY3JlZW4gYW5kIChtaW4td2lkdGg6IDcwNHB4KVwiLFxuXHRcdFx0XHRcIm5vdCBzY3JlZW4gYW5kIChtaW4taGVpZ2h0OiA1NDBweClcIlxuXHRcdFx0XVxuXHRcdH0sXG5cdFx0XCJkZWZhdWx0X2NvbG9yc1wiOiB7XG5cdFx0XHRcIi0tYWx0LWJhY2tncm91bmQtY29sb3JcIjogXCJ1bnNldFwiXG5cdFx0fVxuXHR9XG59XG4iXX0=
